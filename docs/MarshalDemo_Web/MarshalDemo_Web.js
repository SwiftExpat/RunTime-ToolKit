var pas={$libimports:{}},rtl={version:20301,quiet:!1,debug_load_units:!1,debug_rtti:!1,$res:{},debug:function(){!rtl.quiet&&console&&console.log&&console.log(arguments)},error:function(t){throw rtl.debug("Error: ",t),t},warn:function(t){rtl.debug("Warn: ",t)},checkVersion:function(t){if(rtl.version!=t)throw"expected rtl version "+t+", but found "+rtl.version},hiInt:Math.pow(2,53),hasString:function(t){return rtl.isString(t)&&t.length>0},isArray:function(t){return Array.isArray(t)},isFunction:function(t){return"function"==typeof t},isModule:function(t){return rtl.isObject(t)&&rtl.hasString(t.$name)&&pas[t.$name]===t},isImplementation:function(t){return rtl.isObject(t)&&rtl.isModule(t.$module)&&t.$module.$impl===t},isNumber:function(t){return"number"==typeof t},isObject:function(t){return"object"==typeof t&&null!=t},isString:function(t){return"string"==typeof t},getNumber:function(t){return"number"==typeof t?t:NaN},getChar:function(t){return"string"==typeof t&&1===t.length?t:""},getObject:function(t){return"object"==typeof t||"function"==typeof t?t:null},isTRecord:function(t){return rtl.isObject(t)&&t.hasOwnProperty("$new")&&"function"==typeof t.$new},isPasClass:function(t){return rtl.isObject(t)&&t.hasOwnProperty("$classname")&&rtl.isObject(t.$module)},isPasClassInstance:function(t){return rtl.isObject(t)&&rtl.isPasClass(t.$class)},hexStr:function(t,e){return("000000000000000"+t.toString(16).toUpperCase()).slice(-e)},m_loading:0,m_loading_intf:1,m_intf_loaded:2,m_loading_impl:3,m_initializing:4,m_initialized:5,module:function(t,e,i,s){rtl.debug_load_units&&rtl.debug('rtl.module name="'+t+'" intfuses='+e+" impluses="+s),rtl.hasString(t)||rtl.error('invalid module name "'+t+'"'),rtl.isArray(e)||rtl.error('invalid interface useslist of "'+t+'"'),rtl.isFunction(i)||rtl.error('invalid interface code of "'+t+'"'),null==s||rtl.isArray(s)||rtl.error('invalid implementation useslist of "'+t+'"'),pas[t]&&rtl.error('module "'+t+'" is already registered');var o=Object.create(rtl.tSectionRTTI),n=o.$module=pas[t]={$name:t,$intfuseslist:e,$impluseslist:s,$state:rtl.m_loading,$intfcode:i,$implcode:null,$impl:null,$rtti:o};s&&(n.$impl={$module:n,$rtti:o})},exitcode:0,run:function(t){try{rtl.hasString(t)||(t="program"),rtl.debug_load_units&&rtl.debug('rtl.run module="'+t+'"'),rtl.initRTTI();var e=pas[t];if(e||rtl.error('rtl.run module "'+t+'" missing'),rtl.loadintf(e),rtl.loadimpl(e),"program"==t||"library"==t){rtl.debug_load_units&&rtl.debug("running $main");var i=pas[t].$main();rtl.isNumber(i)&&(rtl.exitcode=i)}}catch(t){if(!rtl.showUncaughtExceptions)throw t;rtl.handleUncaughtException(t)||(rtl.showException(t),rtl.exitcode=216)}return rtl.exitcode},showException:function(t){var e=rtl.hasString(t.$classname)?t.$classname:"";e+=(e?": ":"")+(t.hasOwnProperty("fMessage")?t.fMessage:t),alert("Uncaught Exception : "+e)},handleUncaughtException:function(t){if(!rtl.onUncaughtException)return!1;try{return rtl.onUncaughtException(t),!0}catch(t){return!1}},loadintf:function(t){t.$state>rtl.m_loading_intf||(rtl.debug_load_units&&rtl.debug('loadintf: "'+t.$name+'"'),t.$state===rtl.m_loading_intf&&rtl.error('unit cycle detected "'+t.$name+'"'),t.$state=rtl.m_loading_intf,rtl.loaduseslist(t,t.$intfuseslist,rtl.loadintf),rtl.debug_load_units&&rtl.debug('loadintf: run intf of "'+t.$name+'"'),t.$intfcode(t.$intfuseslist),t.$state=rtl.m_intf_loaded)},loaduseslist:function(t,e,i){if(null!=e)for(var s=e.length,o=0;o<s;o++){var n=e[o];rtl.debug_load_units&&rtl.debug('loaduseslist of "'+t.$name+'" uses="'+n+'"'),null==pas[n]&&rtl.error('module "'+t.$name+'" misses "'+n+'"'),i(pas[n])}},loadimpl:function(t){t.$state>=rtl.m_loading_impl||(t.$state<rtl.m_intf_loaded&&rtl.error('loadimpl: interface not loaded of "'+t.$name+'"'),rtl.debug_load_units&&rtl.debug('loadimpl: load uses of "'+t.$name+'"'),t.$state=rtl.m_loading_impl,rtl.loaduseslist(t,t.$impluseslist,rtl.loadintf),rtl.loaduseslist(t,t.$intfuseslist,rtl.loadimpl),rtl.loaduseslist(t,t.$impluseslist,rtl.loadimpl),rtl.debug_load_units&&rtl.debug('loadimpl: run impl of "'+t.$name+'"'),rtl.isFunction(t.$implcode)&&t.$implcode(t.$impluseslist),rtl.debug_load_units&&rtl.debug('loadimpl: run init of "'+t.$name+'"'),t.$state=rtl.m_initializing,rtl.isFunction(t.$init)&&t.$init(),t.$state=rtl.m_initialized)},createCallback:function(t,e){var i;if("string"==typeof e){if(t.hasOwnProperty("$events")||(t.$events={}),i=t.$events[e])return i;t.$events[e]=i=function(){return t[e].apply(t,arguments)}}else i=function(){return e.apply(t,arguments)};return i.scope=t,i.fn=e,i},createSafeCallback:function(t,e){var i;if("string"==typeof e){if(t.hasOwnProperty("$events")||(t.$events={}),i=t.$events[e])return i;t.$events[e]=i=function(){try{return t[e].apply(t,arguments)}catch(t){if(!rtl.handleUncaughtException(t))throw t}}}else i=function(){try{return e.apply(t,arguments)}catch(t){if(!rtl.handleUncaughtException(t))throw t}};return i.scope=t,i.fn=e,i},eqCallback:function(t,e){return t===e||null!=t&&null!=e&&t.fn&&t.scope===e.scope&&t.fn===e.fn},initStruct:function(t,e,i){return e.$module&&e.$module.$impl===e&&(e=e.$module),t.$parent=e,rtl.isModule(e)?(t.$module=e,t.$name=i):(t.$module=e.$module,t.$name=e.$name+"."+i),e},initClass:function(t,e,i,s,o){e[i]=t,t.$class=t,t.$classname=o||i,e=rtl.initStruct(t,e,i),t.$fullname=e.$name+"."+i,rtl.debug_rtti&&rtl.debug("initClass "+t.$fullname);var n=t.$module.$rtti.$Class(t.$classname,{class:t});t.$rtti=n,rtl.isObject(t.$ancestor)&&(n.ancestor=t.$ancestor.$rtti),n.ancestor||(n.ancestor=null),s.call(t)},createClass:function(t,e,i,s,o){var n=null;null!=i?(n=Object.create(i)).$ancestor=i:((n={$ancestor:null}).$create=function(t,e){null==e&&(e=[]);var i=Object.create(this);i.$init();try{"string"==typeof t?i[t].apply(i,e):t.apply(i,e),i.AfterConstruction()}catch(t){throw i.Destroy&&i.Destroy(),i.$final(),t}return i},n.$destroy=function(t){this.BeforeDestruction(),this[t]&&this[t](),this.$final()}),rtl.initClass(n,t,e,s,o)},createClassExt:function(t,e,i,s,o,n){var r=rtl.isFunction(i),a=null;if(r?((a=Object.create(i.prototype)).$ancestorfunc=i,a.$ancestor=null):i.$func?(r=!0,(a=Object.create(i)).$ancestor=i):(a=Object.create(i)).$ancestor=null,a.$create=function(t,e){null==e&&(e=[]);var i=null;(i=s.length>0?this[s](t,e):r?new this.$func(e):Object.create(a)).$init&&i.$init();try{"string"==typeof t?this[t].apply(i,e):t.apply(i,e),i.AfterConstruction&&i.AfterConstruction()}catch(t){throw i.Destroy&&i.Destroy(),i.$final&&i.$final(),t}return i},a.$destroy=function(t){this.BeforeDestruction&&this.BeforeDestruction(),this[t]&&this[t](),this.$final&&this.$final()},rtl.initClass(a,t,e,o,n),r){function l(){}l.prototype=a,a.$func=l}},createHelper:function(t,e,i,s,o){var n=null;null!=i?(n=Object.create(i)).$ancestor=i:n={$ancestor:null},t[e]=n,n.$class=n,n.$classname=o||e,t=rtl.initStruct(n,t,e),n.$fullname=t.$name+"."+e;var r=n.$module.$rtti.$Helper(n.$classname,{helper:n});n.$rtti=r,rtl.isObject(i)&&(r.ancestor=i.$rtti),r.ancestor||(r.ancestor=null),s.call(n)},tObjectDestroy:"Destroy",free:function(t,e){if(null==t[e])return null;t[e].$destroy(rtl.tObjectDestroy),t[e]=null},freeLoc:function(t){return null==t||t.$destroy(rtl.tObjectDestroy),null},hideProp:function(t,e,i){Object.defineProperty(t,e,{enumerable:!1,configurable:!0,writable:!0}),arguments.length>2&&(t[e]=i)},recNewT:function(t,e,i,s){var o={};t&&(t[e]=o);var n=rtl.hideProp;return s&&(rtl.initStruct(o,t,e),o.$record=o,n(o,"$record"),n(o,"$name"),n(o,"$parent"),n(o,"$module"),n(o,"$initSpec")),i.call(o),o.$new||(o.$new=function(){return Object.create(o)}),o.$clone=function(t){return o.$new().$assign(t)},n(o,"$new"),n(o,"$clone"),n(o,"$eq"),n(o,"$assign"),o},is:function(t,e){return e.isPrototypeOf(t)||t===e},isExt:function(t,e,i){return null!=t&&(("object"==typeof e||"function"==typeof e)&&(t===e?1!==i&&(2!==i||rtl.isPasClass(t)):e.isPrototypeOf&&e.isPrototypeOf(t)?1===i?rtl.isPasClassInstance(t):2!==i||rtl.isPasClass(t):"function"==typeof e&&t instanceof e))},Exception:null,EInvalidCast:null,EAbstractError:null,ERangeError:null,EIntOverflow:null,EPropWriteOnly:null,raiseE:function(t){var e=rtl[t];if(null==e){var i=pas.SysUtils;i||(i=pas.sysutils),i&&((e=i[t])||(e=i[t.toLowerCase()]),e||(e=i.Exception),e||(e=i.exception))}if(e){if(e.Create)throw e.$create("Create");if(e.create)throw e.$create("create")}if("EInvalidCast"===t)throw"invalid type cast";if("EAbstractError"===t)throw"Abstract method called";if("ERangeError"===t)throw"range error";throw t},as:function(t,e){if(null===t||rtl.is(t,e))return t;rtl.raiseE("EInvalidCast")},asExt:function(t,e,i){if(null===t||rtl.isExt(t,e,i))return t;rtl.raiseE("EInvalidCast")},createInterface:function(t,e,i,s,o,n){var r=o?Object.create(o):{};if(t[e]=r,r.$module=t,r.$name=e,r.$fullname=t.$name+"."+e,r.$guid=i,r.$guidr=null,r.$names=s||[],rtl.isFunction(n)){rtl.debug_rtti&&rtl.debug("createInterface "+r.$fullname);var a=r.$module.$rtti.$Interface(e,{interface:r,module:t});r.$rtti=a,o&&(a.ancestor=o.$rtti),a.ancestor||(a.ancestor=null),n.call(r)}return r},strToGUIDR:function(t,e){var i=0;function s(e){var s=t.substr(i,e);return i+=e,parseInt(s,16)}i+=1,e.D1=s(8),i+=1,e.D2=s(4),i+=1,e.D3=s(4),i+=1,e.D4||(e.D4=[]),e.D4[0]=s(2),e.D4[1]=s(2),i+=1;for(var o=2;o<8;o++)e.D4[o]=s(2);return e},guidrToStr:function(t){if(t.$intf)return t.$intf.$guid;for(var e=rtl.hexStr,i="{"+e(t.D1,8)+"-"+e(t.D2,4)+"-"+e(t.D3,4)+"-"+e(t.D4[0],2)+e(t.D4[1],2)+"-",s=2;s<8;s++)i+=e(t.D4[s],2);return i+="}"},createTGUID:function(t){var e=pas.System?pas.System.TGuid:pas.system.tguid;return rtl.strToGUIDR(t,e.$new())},getIntfGUIDR:function(t){if(!t)return null;if(!t.$guidr){var e=rtl.createTGUID(t.$guid);t.hasOwnProperty("$guid")||(t=Object.getPrototypeOf(t)),e.$intf=t,t.$guidr=e}return t.$guidr},addIntf:function(t,e,i){function s(t){return"function"==typeof t?function(){return t.apply(this.$o,arguments)}:function(){rtl.raiseE("EAbstractError")}}i||(i={});var o=e,n=Object.create(o);t.hasOwnProperty("$intfmaps")||(t.$intfmaps={}),t.$intfmaps[e.$guid]=n;do{var r=o.$names;if(!r)break;for(var a=0;a<r.length;a++){var l=r[a],h=i[l];h||(h=l),n[l]=s(t[h])}o=Object.getPrototypeOf(o)}while(null!=o)},getIntfG:function(t,e,i){if(!t)return null;var s=t.$intfmaps;if(!s)return null;var o=s[e];if(!o)return null;if("function"==typeof o)return o.call(t);var n=null;if(t.$interfaces&&(n=t.$interfaces[e]),n||((n=Object.create(o)).$o=t,t.$interfaces||(t.$interfaces={}),t.$interfaces[e]=n),"object"==typeof i){var r=null;return 0===n.QueryInterface(rtl.getIntfGUIDR(i),{get:function(){return r},set:function(t){r=t}})?r:null}return 2===i&&"com"===n.$kind&&n._AddRef(),n},getIntfT:function(t,e){return rtl.getIntfG(t,e.$guid)},queryIntfT:function(t,e){return rtl.getIntfG(t,e.$guid,e)},queryIntfIsT:function(t,e){var i=rtl.getIntfG(t,e.$guid);return!!i&&("com"===i.$kind&&i._Release(),!0)},asIntfT:function(t,e){var i=rtl.getIntfG(t,e.$guid);if(null!==i)return i;rtl.raiseEInvalidCast()},intfIsIntfT:function(t,e){return null!==t&&rtl.queryIntfIsT(t.$o,e)},intfAsIntfT:function(t,e){if(!t)return null;var i=rtl.getIntfG(t.$o,e.$guid);if(i)return i;rtl.raiseEInvalidCast()},intfIsClass:function(t,e){return null!=t&&rtl.is(t.$o,e)},intfAsClass:function(t,e){return null==t?null:rtl.as(t.$o,e)},intfToClass:function(t,e){return null!==t&&rtl.is(t.$o,e)?t.$o:null},intfRefs:{ref:function(t,e){var i=this[t];return i&&(delete this[t],i._Release()),e&&(this[t]=e),e},free:function(){for(var t in this)if(this.hasOwnProperty(t)){var e=this[t];e&&e._Release()}}},createIntfRefs:function(){return Object.create(rtl.intfRefs)},setIntfP:function(t,e,i,s){var o=t[e];o!==i&&(null!==o&&(t[e]=null,o._Release()),null!==i&&(s||i._AddRef(),t[e]=i))},setIntfL:function(t,e,i){return t!==e?(null!==e&&(i||e._AddRef()),null!==t&&t._Release()):i&&null!==t&&t._Release(),e},_AddRef:function(t){return t&&t._AddRef(),t},_Release:function(t){return t&&t._Release(),t},_ReleaseArray:function(t,e){if(!t)return null;for(var i=0;i<t.length;i++)e<=1?t[i]&&t[i]._Release():rtl._ReleaseArray(t[i],e-1);return null},trunc:function(t){return t<0?Math.ceil(t):Math.floor(t)},checkMethodCall:function(t,e){rtl.isObject(t)&&rtl.is(t,e)||rtl.raiseE("EInvalidCast")},oc:function(t){if(Math.floor(t)===t&&t>=-9007199254740991&&t<=9007199254740991)return t;rtl.raiseE("EIntOverflow")},rc:function(t,e,i){if(Math.floor(t)===t&&t>=e&&t<=i)return t;rtl.raiseE("ERangeError")},rcc:function(t,e,i){if("string"==typeof t&&1===t.length){var s=t.charCodeAt(0);if(s>=e&&s<=i)return t}rtl.raiseE("ERangeError")},rcSetCharAt:function(t,e,i){return("string"!=typeof t||e<0||e>=t.length)&&rtl.raiseE("ERangeError"),rtl.setCharAt(t,e,i)},rcCharAt:function(t,e){return("string"!=typeof t||e<0||e>=t.length)&&rtl.raiseE("ERangeError"),t.charAt(e)},rcArrR:function(t,e){if(Array.isArray(t)&&"number"==typeof e&&e>=0&&e<t.length){if(arguments.length>2){t=t[e];for(var i=2;i<arguments.length;i++)t=rtl.rcArrR(t,arguments[i]);return t}return t[e]}rtl.raiseE("ERangeError")},rcArrW:function(t,e,i){for(var s=3;s<arguments.length;s++)t=rtl.rcArrR(t,e),e=arguments[s-1],i=arguments[s];if(Array.isArray(t)&&"number"==typeof e&&e>=0&&e<t.length)return t[e]=i;rtl.raiseE("ERangeError")},length:function(t){return null==t?0:t.length},arrayRef:function(t){return null!=t&&rtl.hideProp(t,"$pas2jsrefcnt",1),t},arraySetLength:function(t,e,i){for(var s=[],o=9999,n=2;n<arguments.length;n++){var r=arguments[n];"s"===r?o=n-2:s.push({dim:r+0,a:null,i:0,src:null})}for(var a=s.length-1,l=0,h=0,F=null,p=null,c=t,u=0,C=0;;)if(l>0&&(c=(F=s[l-1]).src&&F.src.length>F.i?F.src[F.i]:null),c?c.$pas2jsrefcnt>0||l>=o?(p=[],C=u=c.length):(u=0,C=(p=c).length):(p=[],u=0,C=0),h=s[l].dim,p.length=h,!(l>0&&(F.a[F.i]=p,F.i++,0===h&&F.i<F.a.length))){if(h>0){if(l<a){(F=s[l]).a=p,F.i=0,F.src=c,l++;continue}if(u>h&&(u=h),rtl.isArray(e)){for(n=0;n<u;n++)p[n]=c[n];for(n=C;n<h;n++)p[n]=[]}else if(rtl.isObject(e))if(rtl.isTRecord(e)){for(n=0;n<u;n++)p[n]=e.$clone(c[n]);for(n=C;n<h;n++)p[n]=e.$new()}else{for(n=0;n<u;n++)p[n]=rtl.refSet(c[n]);for(n=C;n<h;n++)p[n]={}}else{for(n=0;n<u;n++)p[n]=c[n];for(n=C;n<h;n++)p[n]=e}}for(;l>0&&s[l-1].i>=s[l-1].dim;)l--;if(0===l)return 0===a?p:s[0].a}},arrayEq:function(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.length!==e.length)return!1;for(var i=0;i<t.length;i++)if(t[i]!==e[i])return!1;return!0},arrayClone:function(t,e,i,s,o,n){if("refSet"===t)for(;i<s;i++)o[n++]=rtl.refSet(e[i]);else if("slice"===t)for(;i<s;i++)o[n++]=e[i].slice(0);else if("function"==typeof t)for(;i<s;i++)o[n++]=t(e[i]);else if(rtl.isTRecord(t))for(;i<s;i++)o[n++]=t.$clone(e[i]);else for(;i<s;i++)o[n++]=e[i]},arrayConcat:function(t){for(var e=[],i=0,s=1;s<arguments.length;s++){null!==(o=arguments[s])&&(i+=o.length)}e.length=i,i=0;for(s=1;s<arguments.length;s++){var o;null!==(o=arguments[s])&&(rtl.arrayClone(t,o,0,o.length,e,i),i+=o.length)}return e},arrayConcatN:function(){for(var t=null,e=0;e<arguments.length;e++){var i=arguments[e];if(null!==i)if(null===t)t=rtl.arrayRef(i);else if(t.$pas2jsrefcnt)t=t.concat(i);else for(e=0;e<i.length;e++)t.push(i[e])}return t},arrayPush:function(t,e){return null===e?e=[]:e.$pas2jsrefcnt&&(e=rtl.arrayCopy(t,e,0,e.length)),rtl.arrayClone(t,arguments,2,arguments.length,e,e.length),e},arrayPushN:function(t){null===t?t=[]:t.$pas2jsrefcnt&&(t=t.concat());for(var e=1;e<arguments.length;e++)t.push(arguments[e]);return t},arrayCopy:function(t,e,i,s){if(null===e)return[];i<0&&(i=0),void 0===s&&(s=e.length);var o=i+s;if(o>e.length&&(o=e.length),i>=o)return[];if(0===t)return e.slice(i,o);var n=[];return n.length=o-i,rtl.arrayClone(t,e,i,o,n,0),n},arrayInsert:function(t,e,i){return e?(e.splice(i,0,t),e):[t]},setCharAt:function(t,e,i){return t.substr(0,e)+i+t.substr(e+1)},getResStr:function(t,e){var i=t.$resourcestrings[e];return i.current?i.current:i.org},createSet:function(){for(var t={},e=0;e<arguments.length;e++)if(null!=arguments[e])t[arguments[e]]=!0;else for(var i=arguments[e+=1],s=arguments[e+=1],o=i;o<=s;o++)t[o]=!0;return t},cloneSet:function(t){var e={};for(var i in t)e[i]=!0;return e},refSet:function(t){return rtl.hideProp(t,"$shared",!0),t},includeSet:function(t,e){return t.$shared&&(t=rtl.cloneSet(t)),t[e]=!0,t},excludeSet:function(t,e){return t.$shared&&(t=rtl.cloneSet(t)),delete t[e],t},diffSet:function(t,e){var i={};for(var s in t)e[s]||(i[s]=!0);return i},unionSet:function(t,e){var i={};for(var s in t)i[s]=!0;for(var s in e)i[s]=!0;return i},intersectSet:function(t,e){var i={};for(var s in t)e[s]&&(i[s]=!0);return i},symDiffSet:function(t,e){var i={};for(var s in t)e[s]||(i[s]=!0);for(var s in e)t[s]||(i[s]=!0);return i},eqSet:function(t,e){for(var i in t)if(!e[i])return!1;for(var i in e)if(!t[i])return!1;return!0},neSet:function(t,e){return!rtl.eqSet(t,e)},leSet:function(t,e){for(var i in t)if(!e[i])return!1;return!0},geSet:function(t,e){for(var i in e)if(!t[i])return!1;return!0},strSetLength:function(t,e){var i=t.length;if(i>e)return t.substring(0,e);if(t.repeat)return t+" ".repeat(e-i);for(;i<e;)t+=" ",i++;return t},spaceLeft:function(t,e){var i=t.length;if(i>=e)return t;if(t.repeat)return" ".repeat(e-i)+t;for(;i<e;)t=" "+t,i++;return t},floatToStr:function(t,e,i){if(arguments.length>2)return rtl.spaceLeft(t.toFixed(i),e);var s="",o=Math.abs(t);o>1&&o<1e10||o>1e-10&&o<1?s="00":(o>1&&o<1e100||o<1e-10)&&(s="0"),arguments.length<2?e=24:e<9&&(e=9);i=e-8;var n=(t>0?" ":"")+t.toExponential(i);return n=n.replace(/e(.)/,"E$1"+s),rtl.spaceLeft(n,e)},valEnum:function(t,e,i){for(var s in t=t.toLowerCase(),e)if("string"==typeof s&&s.toLowerCase()===t)return i(0),e[s];return i(1),0},lw:function(t){return t<0?t+4294967296:t},and:function(t,e){var i=2147483648;return(t/i&e/i)*i+(2147483647&t&e)},or:function(t,e){var i=2147483648;return(t/i|e/i)*i+(2147483647&t|2147483647&e)},xor:function(t,e){var i=2147483648;return(t/i^e/i)*i+(2147483647&t^2147483647&e)},shr:function(t,e){return t<0&&(t+=rtl.hiInt),t<2147483648?t>>e:e<=0?t:e>54?0:Math.floor(t/Math.pow(2,e))},shl:function(t,e){if(t<0&&(t+=rtl.hiInt),e<=0)return t;if(e>54)return 0;var i=t*Math.pow(2,e);return i<=rtl.hiInt?i:i%rtl.hiInt},initRTTI:function(){function t(t,e,i){i||(i=rtl.tTypeInfo),rtl.debug_rtti&&rtl.debug('initRTTI.newBaseTI "'+t+'" '+e+' ("'+i.name+'")');var s=Object.create(i);return s.name=t,s.kind=e,rtl[t]=s,s}function e(e,i,s,o){var n=t(e,1,rtl.tTypeInfoInteger);return n.minvalue=i,n.maxvalue=s,n.ordtype=o,n}function i(t,e){var i=Object.create(rtl.tTypeMember);i.name=t,i.kind=e,rtl[t]=i}rtl.debug_rtti&&rtl.debug("initRTTI"),rtl.tTypeInfo={name:"tTypeInfo",kind:0,$module:null,attr:null},t("tTypeInfoInteger",1),e("shortint",-128,127,0),e("byte",0,255,1),e("smallint",-32768,32767,2),e("word",0,65535,3),e("longint",-2147483648,2147483647,4),e("longword",0,4294967295,5),e("nativeint",-4503599627370496,0xfffffffffffff,6),e("nativeuint",0,0xfffffffffffff,7),t("char",2),t("string",3),t("tTypeInfoEnum",4,rtl.tTypeInfoInteger),t("tTypeInfoSet",5),t("double",6),t("boolean",7),t("tTypeInfoProcVar",8),t("tTypeInfoMethodVar",9,rtl.tTypeInfoProcVar),t("tTypeInfoArray",10),t("tTypeInfoDynArray",11),t("tTypeInfoPointer",15),t("pointer",15,rtl.tTypeInfoPointer).reftype=null,t("jsvalue",16),t("tTypeInfoRefToProcVar",17,rtl.tTypeInfoProcVar),rtl.tTypeMember={attr:null},i("tTypeMemberField",1),i("tTypeMemberMethod",2),i("tTypeMemberProperty",3),rtl.tTypeMembers={};var s=t("tTypeInfoStruct",0);s.$addMember=function(t,e,i){if(rtl.debug_rtti){if(!rtl.hasString(t)||"$"===t.charAt())throw'invalid member "'+t+'", this="'+this.name+'"';if(!rtl.is(e,rtl.tTypeMember))throw'invalid ancestor "'+e+":"+e.name+'", "'+this.name+"."+t+'"';if(null!=i&&"object"!=typeof i)throw'invalid options "'+i+'", "'+this.name+"."+t+'"'}var s=Object.create(e);if(s.name=t,this.members[t]=s,this.names.push(t),rtl.isObject(i))for(var o in i)i.hasOwnProperty(o)&&(s[o]=i[o]);return s},s.addField=function(t,e,i){var s=this.$addMember(t,rtl.tTypeMemberField,i);if(rtl.debug_rtti&&!rtl.is(e,rtl.tTypeInfo))throw'invalid type "'+e+'", "'+this.name+"."+t+'"';return s.typeinfo=e,this.fields.push(t),s},s.addFields=function(){for(var t=0;t<arguments.length;){var e=arguments[t++],i=arguments[t++];t<arguments.length&&"object"==typeof arguments[t]?this.addField(e,i,arguments[t++]):this.addField(e,i)}},s.addMethod=function(t,e,i,s,o,n){var r=this.$addMember(t,rtl.tTypeMemberMethod,n);return r.methodkind=e,r.procsig=rtl.newTIProcSig(i,s,o),this.methods.push(t),r},s.addProperty=function(t,e,i,s,o,n){var r=this.$addMember(t,rtl.tTypeMemberProperty,n);return r.flags=e,r.typeinfo=i,r.getter=s,r.setter=o,r.params=rtl.isArray(r.params)?rtl.newTIParams(r.params):null,this.properties.push(t),rtl.isString(r.stored)||(r.stored=""),r},s.getField=function(t){return this.members[this.fields[t]]},s.getMethod=function(t){return this.members[this.methods[t]]},s.getProperty=function(t){return this.members[this.properties[t]]},t("tTypeInfoRecord",12,rtl.tTypeInfoStruct),t("tTypeInfoClass",13,rtl.tTypeInfoStruct),t("tTypeInfoClassRef",14),t("tTypeInfoInterface",18,rtl.tTypeInfoStruct),t("tTypeInfoHelper",19,rtl.tTypeInfoStruct),t("tTypeInfoExtClass",20,rtl.tTypeInfoClass)},tSectionRTTI:{$module:null,$inherited:function(t,e,i){rtl.debug_rtti&&rtl.debug('tSectionRTTI.newTI "'+(this.$module?this.$module.$name:"(no module)")+'"."'+t+'" ('+e.name+") "+(i?"init":"forward"));var s=this[t];if(s){if(!s.$forward)throw'duplicate type "'+t+'"';if(!e.isPrototypeOf(s))throw'typeinfo ancestor mismatch "'+t+'" ancestor="'+e.name+'" t.name="'+s.name+'"'}else(s=Object.create(e)).name=t,s.$module=this.$module,this[t]=s;if(i)for(var o in delete s.$forward,i)i.hasOwnProperty(o)&&(s[o]=i[o]);else s.$forward=!0;return s},$Scope:function(t,e,i){var s=this.$inherited(t,e,i);return s.members={},s.names=[],s.fields=[],s.methods=[],s.properties=[],s},$TI:function(t,e,i){var s=this.$inherited(t,rtl.tTypeInfo,i);return s.kind=e,s},$Int:function(t,e){return this.$inherited(t,rtl.tTypeInfoInteger,e)},$Enum:function(t,e){return this.$inherited(t,rtl.tTypeInfoEnum,e)},$Set:function(t,e){return this.$inherited(t,rtl.tTypeInfoSet,e)},$StaticArray:function(t,e){return this.$inherited(t,rtl.tTypeInfoArray,e)},$DynArray:function(t,e){return this.$inherited(t,rtl.tTypeInfoDynArray,e)},$ProcVar:function(t,e){return this.$inherited(t,rtl.tTypeInfoProcVar,e)},$RefToProcVar:function(t,e){return this.$inherited(t,rtl.tTypeInfoRefToProcVar,e)},$MethodVar:function(t,e){return this.$inherited(t,rtl.tTypeInfoMethodVar,e)},$Record:function(t,e){return this.$Scope(t,rtl.tTypeInfoRecord,e)},$Class:function(t,e){return this.$Scope(t,rtl.tTypeInfoClass,e)},$ClassRef:function(t,e){return this.$inherited(t,rtl.tTypeInfoClassRef,e)},$Pointer:function(t,e){return this.$inherited(t,rtl.tTypeInfoPointer,e)},$Interface:function(t,e){return this.$Scope(t,rtl.tTypeInfoInterface,e)},$Helper:function(t,e){return this.$Scope(t,rtl.tTypeInfoHelper,e)},$ExtClass:function(t,e){return this.$Scope(t,rtl.tTypeInfoExtClass,e)}},newTIParam:function(t){return{name:t[0],typeinfo:t[1],flags:rtl.isNumber(t[2])?t[2]:0}},newTIParams:function(t){var e=[];if(rtl.isArray(t))for(var i=0;i<t.length;i++)e.push(rtl.newTIParam(t[i]));return e},newTIProcSig:function(t,e,i){return{params:rtl.newTIParams(t),resulttype:e||null,flags:i||0}},addResource:function(t){rtl.$res[t.name]=t},getResource:function(t){var e=rtl.$res[t];return void 0!==e?e:null},getResourceList:function(){return Object.keys(rtl.$res)}};rtl.module("System",[],(function(){"use strict";var t=this,e=t.$impl;this.LineEnding="\n",this.sLineBreak=this.LineEnding,this.PathDelim="/",this.MaxLongint=2147483647,this.Maxint=2147483647,this.$rtti.$inherited("TDateTime",rtl.double,{}),this.$rtti.$inherited("TTime",this.$rtti.TDateTime,{}),this.$rtti.$inherited("TDate",this.$rtti.TDateTime,{}),this.TTextLineBreakStyle={0:"tlbsLF",tlbsLF:0,1:"tlbsCRLF",tlbsCRLF:1,2:"tlbsCR",tlbsCR:2},rtl.recNewT(this,"TGuid",(function(){this.D1=0,this.D2=0,this.D3=0,this.$new=function(){var t=Object.create(this);return t.D4=rtl.arraySetLength(null,0,8),t},this.$eq=function(t){return this.D1===t.D1&&this.D2===t.D2&&this.D3===t.D3&&rtl.arrayEq(this.D4,t.D4)},this.$assign=function(t){return this.D1=t.D1,this.D2=t.D2,this.D3=t.D3,this.D4=t.D4.slice(0),this}})),rtl.recNewT(this,"TMethod",(function(){this.Code=null,this.Data=null,this.$eq=function(t){return this.Code===t.Code&&this.Data===t.Data},this.$assign=function(t){return this.Code=t.Code,this.Data=t.Data,this}})),this.$rtti.$Class("TObject"),this.$rtti.$ClassRef("TClass",{instancetype:this.$rtti.TObject}),rtl.createClass(this,"TObject",null,(function(){this.$init=function(){},this.$final=function(){},this.Create=function(){return this},this.Destroy=function(){},this.Free=function(){this.$destroy("Destroy")},this.ClassType=function(){return this},this.InheritsFrom=function(t){return null!=t&&(this==t||t.isPrototypeOf(this))},this.MethodName=function(t){var e="";if(e="",null===t)return e;if("function"!=typeof t)return"";var i=0,s=this.$rtti;if(rtl.isObject(t.scope)){if("string"==typeof t.fn)return t.fn;t=t.fn}for(;""===e&&null!=s;){for(i=0;""===e&&i<s.methods.length;)this[s.getMethod(i).name]===t&&(e=s.getMethod(i).name),i+=1;""===e&&(s=s.ancestor)}return e},this.MethodAddress=function(t){var e=null;if(e=null,""===t)return e;var i,s=0,o=this.$rtti,n="";for(i=t.toLowerCase();""===n&&null!=o;){for(s=0;""===n&&s<o.methods.length;)o.getMethod(s).name.toLowerCase()===i&&(n=o.getMethod(s).name),s+=1;""===n&&(o=o.ancestor)}return""!==n&&(e=this[n]),e},this.FieldAddress=function(t){if(null,""===t)return null;for(var e=this.$class,i=null,s=t.toLowerCase(),o=null;null!==e;){for(var n=0,r=(i=e.$rtti).fields.length-1;n<=r;n++)if((o=i.getField(n)).name.toLowerCase()===s)return o;e=e.$ancestor?e.$ancestor:null}return null},this.ClassInfo=function(){return this.$rtti},this.QualifiedClassName=function(){return this.$module.$name+"."+this.$classname},this.AfterConstruction=function(){},this.BeforeDestruction=function(){},this.GetInterface=function(t,e){var i=t.$intf;return i&&(i=rtl.getIntfG(this,i.$guid,2))?(e.set(i),!0):this.GetInterfaceByStr(rtl.guidrToStr(t),e)},this.GetInterfaceByStr=function(e,i){if(!1,t.IObjectInstance.$str||(t.IObjectInstance.$str=rtl.guidrToStr(t.IObjectInstance)),e==t.IObjectInstance.$str)return i.set(this),!0;var s=rtl.getIntfG(this,e,2);return i.set(s),null!==s},this.Equals=function(t){return t===this}})),rtl.createClass(this,"TCustomAttribute",this.TObject,(function(){})),this.S_OK=0,this.E_NOINTERFACE=-2147467262,rtl.createInterface(this,"IUnknown","{00000000-0000-0000-C000-000000000046}",["QueryInterface","_AddRef","_Release"],null,(function(){this.$kind="com"})),rtl.createClass(this,"TInterfacedObject",this.TObject,(function(){this.$init=function(){t.TObject.$init.call(this),this.fRefCount=0},this.QueryInterface=function(t,e){return this.GetInterface(t,e)?0:-2147467262},this._AddRef=function(){return this.fRefCount+=1,this.fRefCount},this._Release=function(){var t;return this.fRefCount-=1,t=this.fRefCount,0===this.fRefCount&&this.$destroy("Destroy"),t},this.BeforeDestruction=function(){0!==this.fRefCount&&rtl.raiseE("EHeapMemoryError")},rtl.addIntf(this,t.IUnknown)})),this.IObjectInstance=this.TGuid.$clone({D1:3642530548,D2:15507,D3:16911,D4:[163,3,191,91,168,43,253,35]}),this.TTypeKind={0:"tkUnknown",tkUnknown:0,1:"tkInteger",tkInteger:1,2:"tkChar",tkChar:2,3:"tkString",tkString:3,4:"tkEnumeration",tkEnumeration:4,5:"tkSet",tkSet:5,6:"tkDouble",tkDouble:6,7:"tkBool",tkBool:7,8:"tkProcVar",tkProcVar:8,9:"tkMethod",tkMethod:9,10:"tkArray",tkArray:10,11:"tkDynArray",tkDynArray:11,12:"tkRecord",tkRecord:12,13:"tkClass",tkClass:13,14:"tkClassRef",tkClassRef:14,15:"tkPointer",tkPointer:15,16:"tkJSValue",tkJSValue:16,17:"tkRefToProcVar",tkRefToProcVar:17,18:"tkInterface",tkInterface:18,19:"tkHelper",tkHelper:19,20:"tkExtClass",tkExtClass:20},this.$rtti.$Enum("TTypeKind",{minvalue:0,maxvalue:20,ordtype:1,enumtype:this.TTypeKind}),this.tkFloat=6,this.tkProcedure=8,this.tkAny=rtl.createSet(null,this.TTypeKind.tkUnknown,this.TTypeKind.tkExtClass),this.vtInteger=0,this.vtExtended=3,this.vtWideChar=9,this.vtCurrency=12,this.vtUnicodeString=18,this.vtNativeInt=19,rtl.recNewT(this,"TVarRec",(function(){this.VType=0,this.VJSValue=void 0,this.$eq=function(t){return this.VType===t.VType&&this.VJSValue===t.VJSValue&&this.VJSValue===t.VJSValue&&this.VJSValue===t.VJSValue&&this.VJSValue===t.VJSValue&&this.VJSValue===t.VJSValue&&this.VJSValue===t.VJSValue&&this.VJSValue===t.VJSValue},this.$assign=function(t){return this.VType=t.VType,this.VJSValue=t.VJSValue,this.VJSValue=t.VJSValue,this.VJSValue=t.VJSValue,this.VJSValue=t.VJSValue,this.VJSValue=t.VJSValue,this.VJSValue=t.VJSValue,this.VJSValue=t.VJSValue,this}})),this.VarRecs=function(){var e=[],i=0,s=null;for(e=[];i<arguments.length;)(s=t.TVarRec.$new()).VType=rtl.trunc(arguments[i]),i+=1,s.VJSValue=arguments[i],i+=1,e.push(t.TVarRec.$clone(s));return e},this.Frac=function(t){return t%1},this.Odd=function(t){return!0&t},this.Random=function(t){return Math.floor(Math.random()*t)},this.Sqr$1=function(t){return t*t},this.Trunc=function(e){return Math.trunc||(Math.trunc=function(t){return t=+t,isFinite(t)?t-t%1||(t<0?-0:0===t?t:0):t}),t.Trunc=Math.trunc,Math.trunc(e)},this.DefaultTextLineBreakStyle=0,this.Int=function(e){return t.Trunc(e)},this.Copy=function(t,e,i){return e<1&&(e=1),i>0?t.substring(e-1,e+i-1):""},this.Copy$1=function(t,e){return e<1&&(e=1),t.substr(e-1)},this.Delete=function(e,i,s){var o;i<1||i>e.get().length||s<=0||(o=e.get(),e.set(t.Copy(o,1,i-1)+t.Copy$1(o,i+s)))},this.Pos=function(t,e){return e.indexOf(t)+1},this.Pos$1=function(t,e,i){return e.indexOf(t,i-1)+1},this.Insert=function(e,i,s){var o;""!==e&&(o=i.get(),s<1?i.set(e+o):s>o.length?i.set(o+e):i.set(t.Copy(o,1,s-1)+e+t.Copy(o,s,o.length)))},this.upcase=function(t){return t.toUpperCase()},this.val=function(t,i,s){i.set(e.valint(t,-9007199254740991,9007199254740991,s))},this.val$5=function(t,i,s){i.set(e.valint(t,0,65535,s))},this.val$6=function(t,i,s){i.set(e.valint(t,-2147483648,2147483647,s))},this.val$8=function(t,e,i){var s;""!==t?(s=Number(t),isNaN(s)?i.set(1):(i.set(0),e.set(s))):i.set(1)},this.StringOfChar=function(t,e){var i="";if(e>0&&t.repeat)return t.repeat(e);i="";for(var s=1,o=e;s<=o;s++)s,i+=t;return i},this.Writeln=function(){var t=0,i=0,s="";if(i=arguments.length-1,null!=e.WriteCallBack)for(var o=0,n=i;o<=n;o++)t=o,e.WriteCallBack(arguments[t],t===i);else{s=e.WriteBuf;for(var r=0,a=i;r<=a;r++)s=s+""+arguments[t=r];console.log(s),e.WriteBuf=""}},this.Assigned=function(t){return null!=t&&null!=t&&(!rtl.isArray(t)||t.length>0)},t.$implcode=function(){e.WriteBuf="",e.WriteCallBack=null,e.valint=function(e,i,s,o){var n=0,r=0;if(""===e)return o.set(1),n;if(r=Number(e),isNaN(r)){var a=t.Copy(e,1,1);if("$"===a)r=Number("0x"+t.Copy$1(e,2));else if("&"===a)r=Number("0o"+t.Copy$1(e,2));else{if("%"!==a)return o.set(1),n;r=Number("0b"+t.Copy$1(e,2))}}return isNaN(r)||r!==t.Int(r)?o.set(1):r<i||r>s?o.set(2):(n=t.Trunc(r),o.set(0)),n}},t.$init=function(){rtl.exitcode=0}}),[]),rtl.module("RTLConsts",["System"],(function(){"use strict";this.$resourcestrings={SArgumentMissing:{org:'Missing argument in format "%s"'},SInvalidFormat:{org:'Invalid format specifier : "%s"'},SInvalidArgIndex:{org:'Invalid argument index in format: "%s"'},SListCapacityError:{org:"List capacity (%s) exceeded."},SListCountError:{org:"List count (%s) out of bounds."},SListIndexError:{org:"List index (%s) out of bounds"},SSortedListError:{org:"Operation not allowed on sorted list"},SDuplicateString:{org:"String list does not allow duplicates"},SErrFindNeedsSortedList:{org:"Cannot use find on unsorted list"},SInvalidName:{org:'Invalid component name: "%s"'},SInvalidBoolean:{org:'"%s" is not a valid boolean.'},SDuplicateName:{org:'Duplicate component name: "%s"'},SErrInvalidDate:{org:'Invalid date: "%s"'},SErrInvalidTimeFormat:{org:'Invalid time format: "%s"'},SInvalidDateFormat:{org:'Invalid date format: "%s"'},SCantReadPropertyS:{org:'Cannot read property "%s"'},SCantWritePropertyS:{org:'Cannot write property "%s"'},SErrPropertyNotFound:{org:'Unknown property: "%s"'},SIndexedPropertyNeedsParams:{org:'Indexed property "%s" needs parameters'},SErrInvalidInteger:{org:'Invalid integer value: "%s"'},SErrInvalidFloat:{org:'Invalid floating-point value: "%s"'},SInvalidCurrency:{org:"Invalid currency value: %s"},SErrInvalidTimeStamp:{org:'Invalid date/timestamp : "%s"'},SInvalidGUID:{org:'"%s" is not a valid GUID value'},SInvalidPropertyValue:{org:"Invalid value for property"},SInvalidImage:{org:"Invalid stream format"},SUnsupportedPropertyVariantType:{org:"Unsupported property variant type %d"},SEmptyStreamIllegalWriter:{org:"Illegal Nil stream for TWriter constructor"},SErrInvalidPropertyType:{org:"Invalid property type from streamed property: %d"}}})),rtl.module("Types",["System"],(function(){"use strict";var t=this;this.TDirection={0:"FromBeginning",FromBeginning:0,1:"FromEnd",FromEnd:1},this.TDuplicates={0:"dupIgnore",dupIgnore:0,1:"dupAccept",dupAccept:1,2:"dupError",dupError:2},rtl.recNewT(this,"TPoint",(function(){this.x=0,this.y=0,this.$eq=function(t){return this.x===t.x&&this.y===t.y},this.$assign=function(t){return this.x=t.x,this.y=t.y,this};var e=t.$rtti.$Record("TPoint",{});e.addField("x",rtl.longint),e.addField("y",rtl.longint)})),rtl.recNewT(this,"TRect",(function(){this.Left=0,this.Top=0,this.Right=0,this.Bottom=0,this.$eq=function(t){return this.Left===t.Left&&this.Top===t.Top&&this.Right===t.Right&&this.Bottom===t.Bottom},this.$assign=function(t){return this.Left=t.Left,this.Top=t.Top,this.Right=t.Right,this.Bottom=t.Bottom,this};var e=t.$rtti.$Record("TRect",{});e.addField("Left",rtl.longint),e.addField("Top",rtl.longint),e.addField("Right",rtl.longint),e.addField("Bottom",rtl.longint)})),this.Rect=function(e,i,s,o){var n=t.TRect.$new();return n.Left=e,n.Top=i,n.Right=s,n.Bottom=o,n},this.Point=function(e,i){var s=t.TPoint.$new();return s.x=e,s.y=i,s}})),rtl.module("JS",["System","Types"],(function(){"use strict";var t=this;this.$rtti.$ExtClass("TJSObject",{jsclass:"Object"}),this.JSDelete=function(t,e){return delete t[e]},this.isBoolean=function(t){return"boolean"==typeof t},this.isDate=function(t){return t instanceof Date},this.isInteger=function(t){return Math.floor(t)===t},this.isNull=function(t){return null===t},this.isUndefined=function(t){return null==t},this.toNumber=function(t){return t-0},this.TJSValueType={0:"jvtNull",jvtNull:0,1:"jvtBoolean",jvtBoolean:1,2:"jvtInteger",jvtInteger:2,3:"jvtFloat",jvtFloat:3,4:"jvtString",jvtString:4,5:"jvtObject",jvtObject:5,6:"jvtArray",jvtArray:6},this.GetValueType=function(e){var i=0,s="";return t.isNull(e)?i=0:"string"===(s=typeof e)?i=4:"boolean"===s?i=1:"object"===s?i=rtl.isArray(e)?6:5:"number"===s&&(i=t.isInteger(e)?2:3),i}})),rtl.module("SysUtils",["System","RTLConsts","JS"],(function(){"use strict";var t=this,e=t.$impl;this.FreeAndNil=function(t){var e=null;null!==(e=t.get())&&(t.set(null),e.$destroy("Destroy"))},this.FloatRecDigits=19,rtl.recNewT(this,"TFloatRec",(function(){this.Exponent=0,this.Negative=!1,this.$new=function(){var t=Object.create(this);return t.Digits=rtl.arraySetLength(null,"",19),t},this.$eq=function(t){return this.Exponent===t.Exponent&&this.Negative===t.Negative&&rtl.arrayEq(this.Digits,t.Digits)},this.$assign=function(t){return this.Exponent=t.Exponent,this.Negative=t.Negative,this.Digits=t.Digits.slice(0),this}})),this.TEndian={0:"Little",Little:0,1:"Big",Big:1},rtl.recNewT(this,"TFormatSettings",(function(){this.CurrencyDecimals=0,this.CurrencyFormat=0,this.CurrencyString="",this.DateSeparator="",this.DecimalSeparator="",this.LongDateFormat="",this.LongTimeFormat="",this.NegCurrFormat=0,this.ShortDateFormat="",this.ShortTimeFormat="",this.ThousandSeparator="",this.TimeAMString="",this.TimePMString="",this.TimeSeparator="",this.TwoDigitYearCenturyWindow=0,this.InitLocaleHandler=null,this.$new=function(){var t=Object.create(this);return t.DateTimeToStrFormat=rtl.arraySetLength(null,"",2),t.LongDayNames=rtl.arraySetLength(null,"",7),t.LongMonthNames=rtl.arraySetLength(null,"",12),t.ShortDayNames=rtl.arraySetLength(null,"",7),t.ShortMonthNames=rtl.arraySetLength(null,"",12),t},this.$eq=function(t){return this.CurrencyDecimals===t.CurrencyDecimals&&this.CurrencyFormat===t.CurrencyFormat&&this.CurrencyString===t.CurrencyString&&this.DateSeparator===t.DateSeparator&&rtl.arrayEq(this.DateTimeToStrFormat,t.DateTimeToStrFormat)&&this.DecimalSeparator===t.DecimalSeparator&&this.LongDateFormat===t.LongDateFormat&&rtl.arrayEq(this.LongDayNames,t.LongDayNames)&&rtl.arrayEq(this.LongMonthNames,t.LongMonthNames)&&this.LongTimeFormat===t.LongTimeFormat&&this.NegCurrFormat===t.NegCurrFormat&&this.ShortDateFormat===t.ShortDateFormat&&rtl.arrayEq(this.ShortDayNames,t.ShortDayNames)&&rtl.arrayEq(this.ShortMonthNames,t.ShortMonthNames)&&this.ShortTimeFormat===t.ShortTimeFormat&&this.ThousandSeparator===t.ThousandSeparator&&this.TimeAMString===t.TimeAMString&&this.TimePMString===t.TimePMString&&this.TimeSeparator===t.TimeSeparator&&this.TwoDigitYearCenturyWindow===t.TwoDigitYearCenturyWindow},this.$assign=function(t){return this.CurrencyDecimals=t.CurrencyDecimals,this.CurrencyFormat=t.CurrencyFormat,this.CurrencyString=t.CurrencyString,this.DateSeparator=t.DateSeparator,this.DateTimeToStrFormat=t.DateTimeToStrFormat.slice(0),this.DecimalSeparator=t.DecimalSeparator,this.LongDateFormat=t.LongDateFormat,this.LongDayNames=t.LongDayNames.slice(0),this.LongMonthNames=t.LongMonthNames.slice(0),this.LongTimeFormat=t.LongTimeFormat,this.NegCurrFormat=t.NegCurrFormat,this.ShortDateFormat=t.ShortDateFormat,this.ShortDayNames=t.ShortDayNames.slice(0),this.ShortMonthNames=t.ShortMonthNames.slice(0),this.ShortTimeFormat=t.ShortTimeFormat,this.ThousandSeparator=t.ThousandSeparator,this.TimeAMString=t.TimeAMString,this.TimePMString=t.TimePMString,this.TimeSeparator=t.TimeSeparator,this.TwoDigitYearCenturyWindow=t.TwoDigitYearCenturyWindow,this},this.GetJSLocale=function(){return Intl.DateTimeFormat().resolvedOptions().locale},this.GetLocaleDecimalSeparator=function(t){var e=1.1;return e=e.toLocaleString(t).substring(1,2)},this.GetLocaleLongDayName=function(t,e){var i=new Date(2017,0,1);return i.setDate(i.getDate()+t-1),i.toLocaleDateString(e,{weekday:"long"})},this.GetLocaleLongMonthName=function(t,e){return new Date(2017,t-1,1).toLocaleDateString(e,{month:"long"})},this.GetLocaleLongTimeFormat=function(e){var i="";return i="hh:nn:ss","EN-US"===t.UpperCase(e)&&(i="hh:nn:ss AMPM"),i};this.GetLocaleShortDateFormat=function(e){var i;t.TStringHelper.Empty,e=t.TStringHelper.ToLower.call({get:function(){return e},set:function(t){e=t}}),(i=t.TStringHelper.IndexOf.call({get:function(){return e},set:function(t){e=t}},"-"))>=0?e=t.TStringHelper.Substring$1.call({get:function(){return e},set:function(t){e=t}},0,i)+t.TStringHelper.ToUpper.call({a:t.TStringHelper.Substring.call({get:function(){return e},set:function(t){e=t}},i),get:function(){return this.a},set:function(t){this.a=t}}):2===t.TStringHelper.GetLength.call({get:function(){return e},set:function(t){e=t}})&&(e=e+"-"+t.TStringHelper.ToUpper.call({get:function(){return e},set:function(t){e=t}}));return{"ar-SA":"dd/MM/yy","bg-BG":"dd.M.yyyy","ca-ES":"dd/MM/yyyy","zh-TW":"yyyy/M/d","cs-CZ":"d.M.yyyy","da-DK":"dd-MM-yyyy","de-DE":"dd.MM.yyyy","el-GR":"d/M/yyyy","en-US":"M/d/yyyy","fi-FI":"d.M.yyyy","fr-FR":"dd/MM/yyyy","he-IL":"dd/MM/yyyy","hu-HU":"yyyy. MM. dd.","is-IS":"d.M.yyyy","it-IT":"dd/MM/yyyy","ja-JP":"yyyy/MM/dd","ko-KR":"yyyy-MM-dd","nl-NL":"d-M-yyyy","nb-NO":"dd.MM.yyyy","pl-PL":"yyyy-MM-dd","pt-BR":"d/M/yyyy","ro-RO":"dd.MM.yyyy","ru-RU":"dd.MM.yyyy","hr-HR":"d.M.yyyy","sk-SK":"d. M. yyyy","sq-AL":"yyyy-MM-dd","sv-SE":"yyyy-MM-dd","th-TH":"d/M/yyyy","tr-TR":"dd.MM.yyyy","ur-PK":"dd/MM/yyyy","id-ID":"dd/MM/yyyy","uk-UA":"dd.MM.yyyy","be-BY":"dd.MM.yyyy","sl-SI":"d.M.yyyy","et-EE":"d.MM.yyyy","lv-LV":"yyyy.MM.dd.","lt-LT":"yyyy.MM.dd","fa-IR":"MM/dd/yyyy","vi-VN":"dd/MM/yyyy","hy-AM":"dd.MM.yyyy","az-Latn-AZ":"dd.MM.yyyy","eu-ES":"yyyy/MM/dd","mk-MK":"dd.MM.yyyy","af-ZA":"yyyy/MM/dd","ka-GE":"dd.MM.yyyy","fo-FO":"dd-MM-yyyy","hi-IN":"dd-MM-yyyy","ms-MY":"dd/MM/yyyy","kk-KZ":"dd.MM.yyyy","ky-KG":"dd.MM.yy","sw-KE":"M/d/yyyy","uz-Latn-UZ":"dd/MM yyyy","tt-RU":"dd.MM.yyyy","pa-IN":"dd-MM-yy","gu-IN":"dd-MM-yy","ta-IN":"dd-MM-yyyy","te-IN":"dd-MM-yy","kn-IN":"dd-MM-yy","mr-IN":"dd-MM-yyyy","sa-IN":"dd-MM-yyyy","mn-MN":"yy.MM.dd","gl-ES":"dd/MM/yy","kok-IN":"dd-MM-yyyy","syr-SY":"dd/MM/yyyy","dv-MV":"dd/MM/yy","ar-IQ":"dd/MM/yyyy","zh-CN":"yyyy/M/d","de-CH":"dd.MM.yyyy","en-GB":"dd/MM/yyyy","es-MX":"dd/MM/yyyy","fr-BE":"d/MM/yyyy","it-CH":"dd.MM.yyyy","nl-BE":"d/MM/yyyy","nn-NO":"dd.MM.yyyy","pt-PT":"dd-MM-yyyy","sr-Latn-CS":"d.M.yyyy","sv-FI":"d.M.yyyy","az-Cyrl-AZ":"dd.MM.yyyy","ms-BN":"dd/MM/yyyy","uz-Cyrl-UZ":"dd.MM.yyyy","ar-EG":"dd/MM/yyyy","zh-HK":"d/M/yyyy","de-AT":"dd.MM.yyyy","en-AU":"d/MM/yyyy","es-ES":"dd/MM/yyyy","fr-CA":"yyyy-MM-dd","sr-Cyrl-CS":"d.M.yyyy","ar-LY":"dd/MM/yyyy","zh-SG":"d/M/yyyy","de-LU":"dd.MM.yyyy","en-CA":"dd/MM/yyyy","es-GT":"dd/MM/yyyy","fr-CH":"dd.MM.yyyy","ar-DZ":"dd-MM-yyyy","zh-MO":"d/M/yyyy","de-LI":"dd.MM.yyyy","en-NZ":"d/MM/yyyy","es-CR":"dd/MM/yyyy","fr-LU":"dd/MM/yyyy","ar-MA":"dd-MM-yyyy","en-IE":"dd/MM/yyyy","es-PA":"MM/dd/yyyy","fr-MC":"dd/MM/yyyy","ar-TN":"dd-MM-yyyy","en-ZA":"yyyy/MM/dd","es-DO":"dd/MM/yyyy","ar-OM":"dd/MM/yyyy","en-JM":"dd/MM/yyyy","es-VE":"dd/MM/yyyy","ar-YE":"dd/MM/yyyy","en-029":"MM/dd/yyyy","es-CO":"dd/MM/yyyy","ar-SY":"dd/MM/yyyy","en-BZ":"dd/MM/yyyy","es-PE":"dd/MM/yyyy","ar-JO":"dd/MM/yyyy","en-TT":"dd/MM/yyyy","es-AR":"dd/MM/yyyy","ar-LB":"dd/MM/yyyy","en-ZW":"M/d/yyyy","es-EC":"dd/MM/yyyy","ar-KW":"dd/MM/yyyy","en-PH":"M/d/yyyy","es-CL":"dd-MM-yyyy","ar-AE":"dd/MM/yyyy","es-UY":"dd/MM/yyyy","ar-BH":"dd/MM/yyyy","es-PY":"dd/MM/yyyy","ar-QA":"dd/MM/yyyy","es-BO":"dd/MM/yyyy","es-SV":"dd/MM/yyyy","es-HN":"dd/MM/yyyy","es-NI":"dd/MM/yyyy","es-PR":"dd/MM/yyyy","am-ET":"d/M/yyyy","tzm-Latn-DZ":"dd-MM-yyyy","iu-Latn-CA":"d/MM/yyyy","sma-NO":"dd.MM.yyyy","mn-Mong-CN":"yyyy/M/d","gd-GB":"dd/MM/yyyy","en-MY":"d/M/yyyy","prs-AF":"dd/MM/yy","bn-BD":"dd-MM-yy","wo-SN":"dd/MM/yyyy","rw-RW":"M/d/yyyy","qut-GT":"dd/MM/yyyy","sah-RU":"MM.dd.yyyy","gsw-FR":"dd/MM/yyyy","co-FR":"dd/MM/yyyy","oc-FR":"dd/MM/yyyy","mi-NZ":"dd/MM/yyyy","ga-IE":"dd/MM/yyyy","se-SE":"yyyy-MM-dd","br-FR":"dd/MM/yyyy","smn-FI":"d.M.yyyy","moh-CA":"M/d/yyyy","arn-CL":"dd-MM-yyyy","ii-CN":"yyyy/M/d","dsb-DE":"d. M. yyyy","ig-NG":"d/M/yyyy","kl-GL":"dd-MM-yyyy","lb-LU":"dd/MM/yyyy","ba-RU":"dd.MM.yy","nso-ZA":"yyyy/MM/dd","quz-BO":"dd/MM/yyyy","yo-NG":"d/M/yyyy","ha-Latn-NG":"d/M/yyyy","fil-PH":"M/d/yyyy","ps-AF":"dd/MM/yy","fy-NL":"d-M-yyyy","ne-NP":"M/d/yyyy","se-NO":"dd.MM.yyyy","iu-Cans-CA":"d/M/yyyy","sr-Latn-RS":"d.M.yyyy","si-LK":"yyyy-MM-dd","sr-Cyrl-RS":"d.M.yyyy","lo-LA":"dd/MM/yyyy","km-KH":"yyyy-MM-dd","cy-GB":"dd/MM/yyyy","bo-CN":"yyyy/M/d","sms-FI":"d.M.yyyy","as-IN":"dd-MM-yyyy","ml-IN":"dd-MM-yy","en-IN":"dd-MM-yyyy","or-IN":"dd-MM-yy","bn-IN":"dd-MM-yy","tk-TM":"dd.MM.yy","bs-Latn-BA":"d.M.yyyy","mt-MT":"dd/MM/yyyy","sr-Cyrl-ME":"d.M.yyyy","se-FI":"d.M.yyyy","zu-ZA":"yyyy/MM/dd","xh-ZA":"yyyy/MM/dd","tn-ZA":"yyyy/MM/dd","hsb-DE":"d. M. yyyy","bs-Cyrl-BA":"d.M.yyyy","tg-Cyrl-TJ":"dd.MM.yy","sr-Latn-BA":"d.M.yyyy","smj-NO":"dd.MM.yyyy","rm-CH":"dd/MM/yyyy","smj-SE":"yyyy-MM-dd","quz-EC":"dd/MM/yyyy","quz-PE":"dd/MM/yyyy","hr-BA":"d.M.yyyy.","sr-Latn-ME":"d.M.yyyy","sma-SE":"yyyy-MM-dd","en-SG":"d/M/yyyy","ug-CN":"yyyy-M-d","sr-Cyrl-BA":"d.M.yyyy","es-US":"M/d/yyyy"}[e]||"dd/MM/yyyy"},this.GetLocaleShortDayName=function(t,e){var i=new Date(2017,0,1);i.setDate(i.getDate()+t-1);var s="";return s=""==e?navigator.language:e,i.toLocaleDateString(s,{weekday:"short"})},this.GetLocaleShortMonthName=function(t,e){var i=new Date(2017,t-1,1),s="";return s=""==e?navigator.language:e,i.toLocaleDateString(s,{month:"short"})},this.GetLocaleShortTimeFormat=function(e){var i="";return i="hh:nn","EN-US"===t.UpperCase(e)&&(i="h:nn AMPM"),i},this.Create=function(){var e=t.TFormatSettings.$new();return e.$assign(t.TFormatSettings.Create$1(t.TFormatSettings.GetJSLocale())),e};var i=["/",".","-"],s=[":",".","-"],o=[",","."],n=[".",","];this.Create$1=function(e){var r=t.TFormatSettings.$new(),a="",l=0,h="";h=t.UpperCase(e),1===pas.System.Pos("DE-",h)?(r.LongDayNames[0]="Sonntag",r.LongDayNames[1]="Montag",r.LongDayNames[2]="Dienstag",r.LongDayNames[3]="Mittwoch",r.LongDayNames[4]="Donnerstag",r.LongDayNames[5]="Freitag",r.LongDayNames[6]="Samstag",r.ShortDayNames[0]="Son",r.ShortDayNames[1]="Mon",r.ShortDayNames[2]="Die",r.ShortDayNames[3]="Mit",r.ShortDayNames[4]="Don",r.ShortDayNames[5]="Fre",r.ShortDayNames[6]="Sam",r.ShortMonthNames[0]="Jan",r.ShortMonthNames[1]="Feb",r.ShortMonthNames[2]="M�r",r.ShortMonthNames[3]="Apr",r.ShortMonthNames[4]="Mai",r.ShortMonthNames[5]="Jun",r.ShortMonthNames[6]="Jul",r.ShortMonthNames[7]="Aug",r.ShortMonthNames[8]="Sep",r.ShortMonthNames[9]="Okt",r.ShortMonthNames[10]="Nov",r.ShortMonthNames[11]="Dez",r.LongMonthNames[0]="Januar",r.LongMonthNames[1]="Februar",r.LongMonthNames[2]="M�rz",r.LongMonthNames[3]="April",r.LongMonthNames[4]="Mai",r.LongMonthNames[5]="Juni",r.LongMonthNames[6]="Juli",r.LongMonthNames[7]="August",r.LongMonthNames[8]="September",r.LongMonthNames[9]="Oktober",r.LongMonthNames[10]="November",r.LongMonthNames[11]="Dezember"):1===pas.System.Pos("FR-",t.UpperCase(e))?(r.LongDayNames[0]="Dimanche",r.LongDayNames[1]="Lundi",r.LongDayNames[2]="Mardi",r.LongDayNames[3]="Mecredi",r.LongDayNames[4]="Jeudi",r.LongDayNames[5]="Vendredi",r.LongDayNames[6]="Samedi",r.ShortDayNames[0]="Dim",r.ShortDayNames[1]="Lun",r.ShortDayNames[2]="Mar",r.ShortDayNames[3]="Mer",r.ShortDayNames[4]="Jeu",r.ShortDayNames[5]="Ven",r.ShortDayNames[6]="Sam",r.ShortMonthNames[0]="Jan",r.ShortMonthNames[1]="F�v",r.ShortMonthNames[2]="Mar",r.ShortMonthNames[3]="Avr",r.ShortMonthNames[4]="Mai",r.ShortMonthNames[5]="Jun",r.ShortMonthNames[6]="Jul",r.ShortMonthNames[7]="Ao�",r.ShortMonthNames[8]="Sep",r.ShortMonthNames[9]="Oct",r.ShortMonthNames[10]="Nov",r.ShortMonthNames[11]="Dec",r.LongMonthNames[0]="Janvier",r.LongMonthNames[1]="F�vrier",r.LongMonthNames[2]="Mars",r.LongMonthNames[3]="Avril",r.LongMonthNames[4]="Mai",r.LongMonthNames[5]="Juin",r.LongMonthNames[6]="Juillet",r.LongMonthNames[7]="Ao�t",r.LongMonthNames[8]="Septembre",r.LongMonthNames[9]="Octobre",r.LongMonthNames[10]="Novembre",r.LongMonthNames[11]="D�cembre"):1===pas.System.Pos("ES-",t.UpperCase(e))?(r.LongDayNames[0]="Domingo",r.LongDayNames[1]="Lunes",r.LongDayNames[2]="Martes",r.LongDayNames[3]="Mi�rcoles",r.LongDayNames[4]="Jueves",r.LongDayNames[5]="Viernes",r.LongDayNames[6]="S�bado",r.ShortDayNames[0]="Dom",r.ShortDayNames[1]="Lun",r.ShortDayNames[2]="Mar",r.ShortDayNames[3]="Mi�",r.ShortDayNames[4]="Jue",r.ShortDayNames[5]="Vie",r.ShortDayNames[6]="Sab",r.ShortMonthNames[0]="Ene",r.ShortMonthNames[1]="Feb",r.ShortMonthNames[2]="Mar",r.ShortMonthNames[3]="Abr",r.ShortMonthNames[4]="May",r.ShortMonthNames[5]="Jun",r.ShortMonthNames[6]="Jul",r.ShortMonthNames[7]="Ago",r.ShortMonthNames[8]="Sep",r.ShortMonthNames[9]="Oct",r.ShortMonthNames[10]="Nov",r.ShortMonthNames[11]="Dic",r.LongMonthNames[0]="January",r.LongMonthNames[1]="Febrero",r.LongMonthNames[2]="Marzi",r.LongMonthNames[3]="Abril",r.LongMonthNames[4]="Mayo",r.LongMonthNames[5]="Junio",r.LongMonthNames[6]="Julio",r.LongMonthNames[7]="Agusto",r.LongMonthNames[8]="Septiembre",r.LongMonthNames[9]="Octubre",r.LongMonthNames[10]="Noviembre",r.LongMonthNames[11]="Diciembre"):(r.LongDayNames[0]="Sunday",r.LongDayNames[1]="Monday",r.LongDayNames[2]="Tuesday",r.LongDayNames[3]="Wednesday",r.LongDayNames[4]="Thursday",r.LongDayNames[5]="Friday",r.LongDayNames[6]="Saturday",r.ShortDayNames[0]="Sun",r.ShortDayNames[1]="Mon",r.ShortDayNames[2]="Tue",r.ShortDayNames[3]="Wed",r.ShortDayNames[4]="Thu",r.ShortDayNames[5]="Fri",r.ShortDayNames[6]="Sat",r.ShortMonthNames[0]="Jan",r.ShortMonthNames[1]="Feb",r.ShortMonthNames[2]="Mar",r.ShortMonthNames[3]="Apr",r.ShortMonthNames[4]="May",r.ShortMonthNames[5]="Jun",r.ShortMonthNames[6]="Jul",r.ShortMonthNames[7]="Aug",r.ShortMonthNames[8]="Sep",r.ShortMonthNames[9]="Oct",r.ShortMonthNames[10]="Nov",r.ShortMonthNames[11]="Dec",r.LongMonthNames[0]="January",r.LongMonthNames[1]="February",r.LongMonthNames[2]="March",r.LongMonthNames[3]="April",r.LongMonthNames[4]="May",r.LongMonthNames[5]="June",r.LongMonthNames[6]="July",r.LongMonthNames[7]="August",r.LongMonthNames[8]="September",r.LongMonthNames[9]="October",r.LongMonthNames[10]="November",r.LongMonthNames[11]="December"),r.DateTimeToStrFormat[0]="c",r.DateTimeToStrFormat[1]="f",r.DateSeparator="-",r.TimeSeparator=":",r.ShortDateFormat="yyyy-mm-dd",r.LongDateFormat="ddd, yyyy-mm-dd",r.DecimalSeparator=".",r.ThousandSeparator=",",r.TimeAMString="AM",r.TimePMString="PM",r.TwoDigitYearCenturyWindow=50,r.ShortTimeFormat=t.TFormatSettings.GetLocaleShortTimeFormat(e),r.LongTimeFormat=t.TFormatSettings.GetLocaleLongTimeFormat(e),r.ShortDateFormat=t.TFormatSettings.GetLocaleShortDateFormat(e);for(var F=0,p=rtl.length(i)-1;F<=p;F++)l=F,t.TStringHelper.IndexOf.call({p:r,get:function(){return this.p.ShortDateFormat},set:function(t){this.p.ShortDateFormat=t}},i[l])>=0&&(r.DateSeparator=i[l]);var c=new Date("Jan 1, 1980 06:07:08 GMT+00:00");h="";h=""==e?navigator.language:e,a=c.toLocaleTimeString(h);for(var u=0,C=rtl.length(s)-1;u<=C;u++)l=u,t.TStringHelper.IndexOf.call({get:function(){return a},set:function(t){a=t}},s[l])>=0&&(r.TimeSeparator=s[l]);for(l=1;l<=7;l++)r.ShortDayNames[l-1]=t.TFormatSettings.GetLocaleShortDayName(l,e);for(l=1;l<=7;l++)r.LongDayNames[l-1]=t.TFormatSettings.GetLocaleLongDayName(l,e);for(l=1;l<=12;l++)r.ShortMonthNames[l-1]=t.TFormatSettings.GetLocaleShortMonthName(l,e);for(l=1;l<=12;l++)r.LongMonthNames[l-1]=t.TFormatSettings.GetLocaleLongMonthName(l,e);r.DecimalSeparator=t.TFormatSettings.GetLocaleDecimalSeparator(e);for(var T=0,S=rtl.length(o)-1;T<=S;T++)if(l=T,r.DecimalSeparator===o[l]){r.ThousandSeparator=n[l];break}return null!=t.TFormatSettings.InitLocaleHandler&&t.TFormatSettings.InitLocaleHandler(t.UpperCase(e),t.TFormatSettings.$clone(r)),r},this.Invariant=function(){var i=t.TFormatSettings.$new();return e.FInvariantCreated||(e.FInvariant.$assign(t.TFormatSettings.Create$1("EN-US")),e.FInvariant.CurrencyString="¤",e.FInvariant.CurrencyFormat=0,e.FInvariant.CurrencyDecimals=2,e.FInvariant.DateSeparator="/",e.FInvariant.TimeSeparator=":",e.FInvariant.ShortDateFormat="MM/dd/yyyy",e.FInvariant.LongDateFormat="dddd, dd MMMMM yyyy HH:mm:ss",e.FInvariant.TimeAMString="AM",e.FInvariant.TimePMString="PM",e.FInvariant.ShortTimeFormat="HH:mm",e.FInvariant.LongTimeFormat="HH:mm:ss",e.FInvariant.ShortMonthNames=e.DefaultShortMonthNames.slice(0),e.FInvariant.LongMonthNames=e.DefaultLongMonthNames.slice(0),e.FInvariant.ShortDayNames=e.DefaultShortDayNames.slice(0),e.FInvariant.LongDayNames=e.DefaultLongDayNames.slice(0),e.FInvariant.ThousandSeparator=",",e.FInvariant.DecimalSeparator=".",e.FInvariant.TwoDigitYearCenturyWindow=50,e.FInvariant.NegCurrFormat=0,e.FInvariantCreated=!0),i.$assign(e.FInvariant),i}}),!0),rtl.createClass(this,"Exception",pas.System.TObject,(function(){this.LogMessageOnCreate=!1,this.$init=function(){pas.System.TObject.$init.call(this),this.FMessage="",this.FJSError=null,this.FStack=void 0},this.$final=function(){this.FJSError=void 0,pas.System.TObject.$final.call(this)},this.Create$1=function(t){return this.FMessage=t,this.FJSError=new Error(t),this.FStack=this.FJSError.stack,this.LogMessageOnCreate&&pas.System.Writeln("Created exception ",this.$classname," with message: ",t),this},this.CreateFmt=function(e,i){return this.Create$1(t.Format(e,i)),this}})),rtl.createClass(this,"EExternal",this.Exception,(function(){})),rtl.createClass(this,"EAbort",this.Exception,(function(){})),rtl.createClass(this,"EConvertError",this.Exception,(function(){})),rtl.createClass(this,"EIntError",this.EExternal,(function(){})),rtl.createClass(this,"ERangeError",this.EIntError,(function(){})),rtl.createClass(this,"EVariantError",this.Exception,(function(){})),rtl.createClass(this,"EArgumentException",this.Exception,(function(){})),rtl.createClass(this,"EArgumentOutOfRangeException",this.EArgumentException,(function(){})),this.Trim=function(t){return t.replace(/^[\s\uFEFF\xA0\x00-\x1f]+/,"").replace(/[\s\uFEFF\xA0\x00-\x1f]+$/,"")},this.TrimLeft=function(t){return t.replace(/^[\s\uFEFF\xA0\x00-\x1f]+/,"")},this.UpperCase=function(t){return t.toUpperCase()},this.LowerCase=function(t){return t.toLowerCase()},this.CompareStr=function(t,e){var i,s=t.length,o=e.length;return s<=o?t<(i=e.substr(0,s))?-1:t>i?1:s<o?-1:0:(i=t.substr(0,o))<e?-1:1},this.SameStr=function(t,e){return t==e},this.CompareText=function(t,e){var i=t.toLowerCase(),s=e.toLowerCase();return i>s?1:i<s?-1:0},this.SameText=function(t,e){return t.toLowerCase()==e.toLowerCase()},this.AnsiSameText=function(t,e){return t.toLowerCase()==e.toLowerCase()},this.AnsiCompareStr=function(e,i){return t.CompareText(e,i)},this.Format=function(e,i){return t.Format$1(e,i,t.FormatSettings)},this.Format$1=function(i,s,o){var n="",r=0,a=0,l=0,h=0,F=0,p="",c="",u=0,C=0,T=0,S=!1,d=0;function m(){var t=0;function o(){var o=0,n=0;if(-1===t){for(a=r;r<=F&&i.charAt(r-1)<="9"&&i.charAt(r-1)>="0";)r+=1;if(r>F&&e.DoFormatError(1,i),"*"===i.charAt(r-1)){255===u?n=l:(n=u,u+=1),(r>a||n>rtl.length(s)-1)&&e.DoFormatError(1,i),l=n+1;var h=s[n].VType;0===h||19===h?t=s[n].VJSValue:e.DoFormatError(1,i),r+=1}else a<r?(pas.System.val(pas.System.Copy(i,a,r-a),{get:function(){return t},set:function(e){t=e}},{get:function(){return o},set:function(t){o=t}}),o>0&&e.DoFormatError(1,i)):t=-1}}return u=255,C=-1,T=-1,t=-1,r+=1,"%"===i.charAt(r-1)?"%":(":"!==i.charAt(r-1)?o():t=0,":"===i.charAt(r-1)&&(-1===t&&e.DoFormatError(2,i),u=t,t=-1,r+=1),"-"===i.charAt(r-1)?(S=!0,r+=1):S=!1,o(),-1!==t&&(C=t,t=-1),"."===i.charAt(r-1)&&(r+=1,o(),-1===t&&(t=0),T=t),pas.System.upcase(i.charAt(r-1)))}function f(t,o){var n=!1;return n=!1,l=(h=255===u?l:u)+1,h>rtl.length(s)-1||s[h].VType!==t?(o&&e.DoFormatError(3,i),l-=1,n):n=!0}for(n="",F=i.length,r=1,a=1,l=0;r<=F;){for(;r<=F&&"%"!==i.charAt(r-1);)r+=1;if(r>a&&(n+=pas.System.Copy(i,a,r-a)),r<F){var g=m();if("D"===g)(f(0,!1)||f(19,!0))&&(c=t.IntToStr(s[h].VJSValue)),C=Math.abs(C),u=T-c.length,"-"!==c.charAt(0)?c=pas.System.StringOfChar("0",u)+c:pas.System.Insert(pas.System.StringOfChar("0",u+1),{get:function(){return c},set:function(t){c=t}},2);else if("U"===g)f(0,!1)?c=t.IntToStr(s[h].VJSValue>>>0):f(19,!0)&&(c=t.IntToStr(s[h].VJSValue)),C=Math.abs(C),u=T-c.length,c=pas.System.StringOfChar("0",u)+c;else if("E"===g)f(12,!1)?c=t.FloatToStrF$1(s[h].VJSValue/1e4,2,3,T,o):f(3,!0)&&(c=t.FloatToStrF$1(s[h].VJSValue,2,3,T,o));else if("F"===g)f(12,!1)?c=t.FloatToStrF$1(s[h].VJSValue/1e4,0,9999,T,o):(f(0,!1)||f(3,!0))&&(c=t.FloatToStrF$1(s[h].VJSValue,0,9999,T,o));else if("G"===g)f(12,!1)?c=t.FloatToStrF$1(s[h].VJSValue/1e4,1,T,3,o):f(3,!0)&&(c=t.FloatToStrF$1(s[h].VJSValue,1,T,3,o));else if("N"===g)f(12,!1)?c=t.FloatToStrF$1(s[h].VJSValue/1e4,3,9999,T,o):f(3,!0)&&(c=t.FloatToStrF$1(s[h].VJSValue,3,9999,T,o));else if("M"===g)f(12,!1)?c=t.FloatToStrF$1(s[h].VJSValue/1e4,4,9999,T,o):f(3,!0)&&(c=t.FloatToStrF$1(s[h].VJSValue,4,9999,T,o));else if("S"===g)(f(18,!1)||f(9,!0))&&(p=s[h].VJSValue),u=p.length,-1!==T&&u>T&&(u=T),c=pas.System.Copy(p,1,u);else if("P"===g)f(0,!1)?c=t.IntToHex(s[h].VJSValue,8):f(0,!0)&&(c=t.IntToHex(s[h].VJSValue,16));else if("X"===g)if(f(0,!1)?(d=s[h].VJSValue,u=16):f(19,!0)&&(d=s[h].VJSValue,u=31),T>u)c=t.IntToHex(d,u);else{for(u=1;rtl.shl(1,4*u)<=d&&u<16;)u+=1;u>T&&(T=u),c=t.IntToHex(d,T)}else"%"===g&&(c="%");-1!==C&&c.length<C&&(S?c+=pas.System.StringOfChar(" ",C-c.length):c=pas.System.StringOfChar(" ",C-c.length)+c),n+=c}a=r+=1}return n},this.BytesOf=function(t){var e=[],i=0;e=rtl.arraySetLength(e,0,t.length);for(var s=0,o=t.length-1;s<=o;s++)e[i=s]=t.charCodeAt(i+1-1);return e},this.StringOf=function(t){var e="",i=0;e="";for(var s=0,o=rtl.length(t)-1;s<=o;s++)i=s,e+=String.fromCharCode(t[i]);return e};var i=rtl.createSet(null,65,90,null,97,122,95),s=rtl.unionSet(i,rtl.createSet(null,48,57));this.IsValidIdent=function(t,e,o){var n,r=!1,a=!1,l=0;if((n=t.length)<1)return!1;for(a=!0,r=!1,l=1;l<=n;){if(a){if(!(t.charCodeAt(l-1)in i))return r;a=!1}else if(e&&"."===t.charAt(l-1)){if(o){if(l>=n)return r;a=!0}}else if(!(t.charCodeAt(l-1)in s))return r;l+=1}return r=!0},this.TStringReplaceFlag={0:"rfReplaceAll",rfReplaceAll:0,1:"rfIgnoreCase",rfIgnoreCase:1},this.StringReplace=function(t,i,s,o){var n,r="";return r="",0 in o&&(r="g"),1 in o&&(r+="i"),n=i.replace(new RegExp(e.RESpecials,"g"),"\\$1"),t.replace(new RegExp(n,r),s)},this.QuoteString=function(e,i){return i+t.StringReplace(e,i,i+i,rtl.createSet(0))+i},this.IntToStr=function(t){return""+t},this.TryStrToInt=function(e,i){return t.TryStrToInt$1(e,i,t.FormatSettings)},this.TryStrToInt$1=function(e,i,s){var o=!1,n=0;return(o=(o=t.TryStrToInt$3(e,{get:function(){return n},set:function(t){n=t}},s))&&-2147483648<=n&&n<=2147483647)&&i.set(n),o},this.TryStrToInt$2=function(i,s){return e.IntTryStrToInt(i,s,t.FormatSettings.DecimalSeparator)},this.TryStrToInt$3=function(t,i,s){return e.IntTryStrToInt(t,i,s.DecimalSeparator)},this.StrToIntDef=function(e,i){var s=0;return t.TryStrToInt$2(e,{get:function(){return s},set:function(t){s=t}})?s:i},this.StrToIntDef$1=function(e,i){var s=0;return t.TryStrToInt$2(e,{get:function(){return s},set:function(t){s=t}})?s:i},this.StrToInt=function(e){var i=0;if(!t.TryStrToInt$2(e,{get:function(){return i},set:function(t){i=t}}))throw t.EConvertError.$create("CreateFmt",[rtl.getResStr(pas.RTLConsts,"SErrInvalidInteger"),pas.System.VarRecs(18,e)]);return i},this.StrToInt64=function(e){var i=0;if(!t.TryStrToInt$2(e,{get:function(){return i},set:function(t){i=t}}))throw t.EConvertError.$create("CreateFmt",[rtl.getResStr(pas.RTLConsts,"SErrInvalidInteger"),pas.System.VarRecs(18,e)]);return i},this.TryStrToInt64=function(e,i){var s,o=0;return(s=t.TryStrToInt$2(e,{get:function(){return o},set:function(t){o=t}}))&&i.set(o),s},this.IntToHex=function(e,i){var s="";for(s="",e<0&&e<0&&(e=4294967295+e+1),s=e.toString(16),s=t.UpperCase(s);s.length<i;)s="0"+s;return s},this.TFloatFormat={0:"ffFixed",ffFixed:0,1:"ffGeneral",ffGeneral:1,2:"ffExponent",ffExponent:2,3:"ffNumber",ffNumber:3,4:"ffCurrency",ffCurrency:4};this.FloatToDecimal=function(e,i,s){var o=t.TFloatRec.$new(),n="",r="",a=0,l=0,h=0,F=0,p=0,c=!1,u=!1;for(o.Negative=!1,o.Exponent=0,p=0;p<=19;p++)o.Digits[p]="0";if(0===e)return o;for(h=1,F=(n=rtl.floatToStr(e,24)).length;" "===n.charAt(h-1);)h+=1;if(o.Negative="-"===n.charAt(h-1),(o.Negative||"+"===n.charAt(h-1))&&(h+=1),F>=h+2){if("Inf"===(r=pas.System.Copy(n,h,3)))return o.Digits[0]="\0",o.Exponent=32767,o;if("Nan"===r)return o.Digits[0]="\0",o.Exponent=-32768,o}for(a=0,o.Exponent=0,u=!0,c=!1;F>=h&&"E"!==n.charAt(h-1);)"."===n.charAt(h-1)?u=!1:(u?(o.Exponent+=1,o.Digits[a]=n.charAt(h-1),"0"!==n.charAt(h-1)&&(c=!0)):o.Digits[a]=n.charAt(h-1),a+=1),h+=1;for((h+=1)<=F&&(pas.System.val$6(pas.System.Copy(n,h,F-h+1),{get:function(){return p},set:function(t){p=t}},{get:function(){return l},set:function(t){l=t}}),o.Exponent+=p),h=a,F=19;h<F;)o.Digits[h]="0",h+=1;if((h=s+o.Exponent<i?s+o.Exponent:i)>=F&&(h=F-1),0===h)o.Digits[0]>="5"?(o.Digits[0]="1",o.Digits[1]="\0",o.Exponent+=1):o.Digits[0]="\0";else if(h>0)if(o.Digits[h]>="5"){do{o.Digits[h]="\0",h-=1,o.Digits[h]="123456789:".charAt(t.StrToInt(o.Digits[h])+1-1)}while(!(0===h||o.Digits[h]<":"));":"===o.Digits[0]&&(o.Digits[0]="1",o.Exponent+=1)}else for(o.Digits[h]="0";h>-1&&"0"===o.Digits[h];)o.Digits[h]="\0",h-=1;else o.Digits[0]="\0";return"\0"!==o.Digits[0]||c||(o.Exponent=0,o.Negative=!1),o},this.FloatToStr=function(e){return t.FloatToStr$1(e,t.FormatSettings)},this.FloatToStr$1=function(e,i){return t.FloatToStrF$1(e,1,15,0,i)},this.FloatToStrF=function(e,i,s,o){return t.FloatToStrF$1(e,i,s,o,t.FormatSettings)},this.FloatToStrF$1=function(t,i,s,o,n){var r,a,l="";a=n.DecimalSeparator,r=n.ThousandSeparator;var h=i;return 1===h?l=e.FormatGeneralFloat(t,s,a):2===h?l=e.FormatExponentFloat(t,s,o,a):0===h?l=e.FormatFixedFloat(t,o,a):3===h?l=e.FormatNumberFloat(t,o,a,r):4===h&&(l=e.FormatNumberCurrency(1e4*t,o,n)),4!==i&&l.length>1&&"-"===l.charAt(0)&&e.RemoveLeadingNegativeSign({get:function(){return l},set:function(t){l=t}},a,r),l},this.TryStrToFloat=function(e,i){return t.TryStrToFloat$2(e,i)},this.TryStrToFloat$2=function(e,i){return t.TryStrToFloat$3(e,i,t.FormatSettings)};this.TryStrToFloat$3=function(e,i,s){var o,n,r=!1,a=0,l=0,h="",F=0;for(r=!1,h=e,""!==s.ThousandSeparator&&(h=t.StringReplace(h,s.ThousandSeparator,"",rtl.createSet(0))),"."!==s.DecimalSeparator&&(h=t.StringReplace(h,s.DecimalSeparator,".",{})),F=0,a=1,l=1,n=h.length;a<=n;){var p=h.charAt(a-1);if("+"===p||"-"===p){if(1===F)return r;if(0===F){if(a>l)return r}else if(2===F&&a>l+1)return r}else if(p>="0"&&p<="9");else if("."===p){if(0!==F)return r;F=1,l=a}else{if("E"!==p&&"e"!==p)return r;if(2===F)return r;F=2,l=a}a+=1}return o=parseFloat(h),(r=!isNaN(o))&&i.set(rtl.getNumber(o)),r},this.StrToFloatDef=function(e,i){var s=0;return t.TryStrToFloat$3(e,{get:function(){return s},set:function(t){s=t}},t.FormatSettings)||(s=i),s},this.StrToFloat=function(e){return t.StrToFloat$1(e,t.FormatSettings)},this.StrToFloat$1=function(e,i){var s=0;if(!t.TryStrToFloat$3(e,{get:function(){return s},set:function(t){s=t}},i))throw t.EConvertError.$create("CreateFmt",[rtl.getResStr(pas.RTLConsts,"SErrInvalidFloat"),pas.System.VarRecs(18,e)]);return s},this.FormatFloat=function(e,i){return t.FormatFloat$1(e,i,t.TFormatSettings.$clone(t.FormatSettings))};this.FormatFloat$1=function(e,i,s){var o="",n=0,r=t.TFloatRec.$new(),a="",l=0,h=!1,F=!1,p=0,c=0,u=0,C=0,T=0,S=0,d=0,m=0,f=0;function g(t){o+=t}function y(t){o+=t}function M(t){"\0"!==t&&(-1===(f-=1)?(y(s.DecimalSeparator),g(t)):(g(t),h&&f%3==0&&f>1&&y(s.ThousandSeparator)))}function b(){var t="";return t="\0",d<=S?(t=r.Digits[d],d+=1):f<=u?f-=1:t="0",t}function N(){if(0===m)M(b());else if(m<0)m+=1,f<=c?M("0"):f-=1;else{for(;m>0;)M(b()),m-=1;M(b())}}function B(e,i){var s="";return s=t.IntToStr(i),s=pas.System.StringOfChar("0",T-s.length)+s,i<0?s="-"+s:i>0&&"+"===e&&(s=e+s),s}var E=0,D=0,L="",G="",A=[],I=!1;for(A=rtl.arraySetLength(A,0,4),o="",a="",l=0,h=!1,F=!1,p=0,c=2147483647,u=0,C=0,T=0,S=-1,D=(n=i)>0?1:n<0?2:3,A[0]=0,((E=function(i){var s,o=0,n=0,r="",a="",l=!1;for(o=1,i.get()[1]=-1,i.get()[2]=-1,i.get()[3]=-1,l=!1,a="\0",n=1,s=e.length;n<=s;){var h=r=e.charAt(n-1);if(";"===h){if(!l){if(o>3)throw t.Exception.$create("Create$1",["Invalid float format"]);i.get()[o]=n,o+=1}}else'"'!==h&&"'"!==h||(l?l=r!==a:(l=!0,a=r));n+=1}return-1===i.get()[o]&&(i.get()[o]=s+1),o}({get:function(){return A},set:function(t){A=t}}))<D||A[D]-A[D-1]==0)&&(D=1),l=A[D]-A[D-1]-1,a=pas.System.Copy(e,A[D-1]+1,l),a=rtl.strSetLength(a,l),function(){var t,e=0,i="",o="",n=!1;for(t=a.length,e=1,n=!1,i="\0";e<=t;){if((o=a.charAt(e-1)).charCodeAt()in rtl.createSet(34,39))n?n=o!==i:(n=!0,i=o);else if(!n){var r=o;if("."===r)0===p&&(p=C+1);else if(","===r)h="\0"!==s.ThousandSeparator;else if("e"===r||"E"===r){if((e+=1)<t){if(o=a.charAt(e-1),F=o.charCodeAt()in rtl.createSet(45,43))for(;e<t&&"0"===a.charAt(e+1-1);)T+=1,e+=1;T>4&&(T=4)}}else"#"===r?C+=1:"0"===r&&(C<c&&(c=C+1),u=(C+=1)+1)}e+=1}0===p&&(p=C+1),(u=p-u)>0&&(u=0),(c=p-c)<0&&(c=0)}(),function(){var e=0,s=0;for(F?(s=C,e=9999):(s=18,e=C-p+1),r.$assign(t.FloatToDecimal(i,s,e)),f=p-1,F?m=0:(m=r.Exponent-(p-1))>=0&&(f=r.Exponent),S=-1;S<18&&"\0"!==r.Digits[S+1];)S+=1}(),(0===l||r.Exponent>=18&&!F||2047===r.Exponent||2048===r.Exponent)&&(a=n.toPrecision(15),o=a),E=1,d=0,G=" ",I=!1,r.Negative&&1===D&&g("-");E<=l;){if((L=a.charAt(E-1)).charCodeAt()in rtl.createSet(34,39))I?I=L!==G:(I=!0,G=L);else if(I)g(L);else{var P=L;if("0"===P||"#"===P)N();else if("."===P||","===P);else if("e"===P||"E"===P){if(g(L),(E+=1)<=a.length&&(L=a.charAt(E-1)).charCodeAt()in rtl.createSet(43,45))for(y(B(L,r.Exponent-p+1));E<l&&"0"===a.charAt(E+1-1);)E+=1}else g(L)}E+=1}return o},this.TrueBoolStrs=[],this.FalseBoolStrs=[],this.StrToBool=function(e){var i=!1;if(!t.TryStrToBool(e,{get:function(){return i},set:function(t){i=t}}))throw t.EConvertError.$create("CreateFmt",[rtl.getResStr(pas.RTLConsts,"SInvalidBoolean"),pas.System.VarRecs(18,e)]);return i},this.BoolToStr=function(i,s){var o="";return s?(e.CheckBoolStrs(),o=i?t.TrueBoolStrs[0]:t.FalseBoolStrs[0]):o=i?"-1":"0",o},this.StrToBoolDef=function(e,i){var s=!1;return t.TryStrToBool(e,{get:function(){return s},set:function(t){s=t}})||(s=i),s},this.TryStrToBool=function(i,s){var o,n=!1,r=0,a=0,l=0;if(o=t.UpperCase(i),pas.System.val$8(o,{get:function(){return a},set:function(t){a=t}},{get:function(){return l},set:function(t){l=t}}),n=!0,0===l)s.set(0!==a);else{e.CheckBoolStrs();for(var h=0,F=rtl.length(t.TrueBoolStrs)-1;h<=F;h++)if(r=h,o===t.UpperCase(t.TrueBoolStrs[r]))return s.set(!0),n;for(var p=0,c=rtl.length(t.FalseBoolStrs)-1;p<=c;p++)if(r=p,o===t.UpperCase(t.FalseBoolStrs[r]))return s.set(!1),n;n=!1}return n},this.OnShowException=null,this.ShowException=function(i,s){var o="";o=rtl.getResStr(t,"SApplicationException")+i.$classname,t.Exception.isPrototypeOf(i)&&(o=o+" : "+i.FMessage),e.DoShowException(o)},this.Abort=function(){throw t.EAbort.$create("Create$1",[rtl.getResStr(t,"SAbortError")])},rtl.recNewT(this,"TTimeStamp",(function(){this.Time=0,this.Date=0,this.$eq=function(t){return this.Time===t.Time&&this.Date===t.Date},this.$assign=function(t){return this.Time=t.Time,this.Date=t.Date,this}})),this.TimeSeparator="",this.DateSeparator="",this.ShortDateFormat="",this.LongDateFormat="",this.ShortTimeFormat="",this.LongTimeFormat="",this.DecimalSeparator="",this.ThousandSeparator="",this.TimeAMString="",this.TimePMString="",this.HoursPerDay=24,this.MinsPerHour=60,this.SecsPerMin=60,this.MSecsPerSec=1e3,this.MinsPerDay=1440,this.SecsPerDay=86400,this.MSecsPerDay=864e5,this.MaxDateTime=2958465.99999999,this.DateDelta=693594,this.MonthDays$a$clone=function(t){var e=[];e.length=2;for(var i=0;i<2;i++)e[i]=t[i].slice(0);return e},this.MonthDays=[[31,28,31,30,31,30,31,31,30,31,30,31],[31,29,31,30,31,30,31,31,30,31,30,31]],this.ShortMonthNames=rtl.arraySetLength(null,"",12),this.LongMonthNames=rtl.arraySetLength(null,"",12),this.ShortDayNames=rtl.arraySetLength(null,"",7),this.LongDayNames=rtl.arraySetLength(null,"",7),this.FormatSettings=this.TFormatSettings.$new(),this.TwoDigitYearCenturyWindow=50,this.JSDateToDateTime=function(e){return t.EncodeDate(e.getFullYear(),e.getMonth()+1,e.getDate())+t.EncodeTime(e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds())},this.DateTimeToTimeStamp=function(e){var i=t.TTimeStamp.$new(),s=0;return(s=864e5*e)<0?s-=.5:s+=.5,i.Time=pas.System.Trunc(Math.abs(pas.System.Trunc(s))%864e5),i.Date=693594+rtl.trunc(pas.System.Trunc(s)/864e5),i},this.TryEncodeDate=function(e,i,s,o){var n,r=0,a=0;return(n=e>0&&e<1e4&&i>=1&&i<=12&&s>0&&s<=t.MonthDays[+t.IsLeapYear(e)][i-1])&&(i>2?i-=3:(i+=9,e-=1),a=e-100*(r=rtl.trunc(e/100)),o.set((146097*r>>>2)+(1461*a>>>2)+rtl.trunc((153*i+2)/5)+s),o.set(o.get()-693900)),n},this.TryEncodeTime=function(t,e,i,s,o){var n;return(n=t<24&&e<60&&i<60&&s<1e3)&&o.set((36e5*t+6e4*e+1e3*i+s)/864e5),n},this.EncodeDate=function(e,i,s){var o=0;if(!t.TryEncodeDate(e,i,s,{get:function(){return o},set:function(t){o=t}}))throw t.EConvertError.$create("CreateFmt",["%s-%s-%s is not a valid date specification",pas.System.VarRecs(18,t.IntToStr(e),18,t.IntToStr(i),18,t.IntToStr(s))]);return o},this.EncodeTime=function(e,i,s,o){var n=0;if(!t.TryEncodeTime(e,i,s,o,{get:function(){return n},set:function(t){n=t}}))throw t.EConvertError.$create("CreateFmt",["%s:%s:%s.%s is not a valid time specification",pas.System.VarRecs(18,t.IntToStr(e),18,t.IntToStr(i),18,t.IntToStr(s),18,t.IntToStr(o))]);return n},this.DecodeDate=function(e,i,s,o){var n=0,r=0,a=0,l=0;e<=-693594?(i.set(0),s.set(0),o.set(0)):(e>0?e+=1/1728e5:e-=1/1728e5,e>t.MaxDateTime&&(e=t.MaxDateTime),l=rtl.shl(pas.System.Trunc(e)+693900,2)-1,l-=146097*(n=rtl.trunc(l/146097)),r=rtl.lw(l>>>2),l=rtl.trunc((rtl.lw(r<<2)+3)/1461),r=rtl.lw(rtl.lw(r<<2)+7-1461*l>>>2),a=rtl.trunc((5*r-3)/153),r=rtl.trunc((5*r+2-153*a)/5),n=100*n+l,a<10?a+=3:(a-=9,n+=1),i.set(n),s.set(a),o.set(r))},this.DecodeTime=function(e,i,s,o,n){var r=0;r=t.DateTimeToTimeStamp(e).Time,i.set(rtl.trunc(r/36e5)),r%=36e5,s.set(rtl.trunc(r/6e4)),r%=6e4,o.set(rtl.trunc(r/1e3)),r%=1e3,n.set(r)},this.DecodeDateFully=function(e,i,s,o,n){return t.DecodeDate(e,i,s,o),n.set(t.DayOfWeek(e)),t.IsLeapYear(i.get())},this.ComposeDateTime=function(t,e){return t<0?pas.System.Trunc(t)-Math.abs(pas.System.Frac(e)):pas.System.Trunc(t)+Math.abs(pas.System.Frac(e))},this.Date=function(){return pas.System.Trunc(t.Now())},this.Time=function(){return t.Now()-t.Date()},this.Now=function(){return t.JSDateToDateTime(new Date)},this.DayOfWeek=function(t){var e=0;return(e=1+(pas.System.Trunc(t)-1)%7)<=0&&(e+=7),e},this.IncMonth=function(i,s){var o=0,n=0,r=0;return t.DecodeDate(i,{get:function(){return o},set:function(t){o=t}},{get:function(){return n},set:function(t){n=t}},{get:function(){return r},set:function(t){r=t}}),t.IncAMonth({get:function(){return o},set:function(t){o=t}},{get:function(){return n},set:function(t){n=t}},{get:function(){return r},set:function(t){r=t}},s),t.ComposeDateTime(e.DoEncodeDate(o,n,r),i)},this.IncAMonth=function(e,i,s,o){var n=0,r=0;r=o>=0?1:-1,e.set(e.get()+rtl.trunc(o/12)),((n=i.get()+o%12-1)>11||n<0)&&(n-=12*r,e.set(e.get()+r)),i.set(n+1),s.get()>t.MonthDays[+t.IsLeapYear(e.get())][i.get()-1]&&s.set(t.MonthDays[+t.IsLeapYear(e.get())][i.get()-1])},this.IsLeapYear=function(t){return t%4==0&&(t%100!=0||t%400==0)},this.DateToStr=function(e){return t.DateToStr$1(e,t.FormatSettings)},this.DateToStr$1=function(e,i){return t.FormatDateTime$1("ddddd",e,i)},this.StrToDate=function(e){return t.StrToDate$3(e,t.FormatSettings)},this.StrToDate$2=function(i,s,o){var n,r="";if(n=e.IntStrToDate({get:function(){return r},set:function(t){r=t}},i,s,o),""!==r)throw t.EConvertError.$create("Create$1",[r]);return n},this.StrToDate$3=function(e,i){return t.StrToDate$2(e,i.ShortDateFormat,i.DateSeparator)},this.TryStrToDate=function(e,i){return t.TryStrToDate$1(e,i,t.FormatSettings)},this.TryStrToDate$1=function(e,i,s){return t.TryStrToDate$3(e,i,s.ShortDateFormat,s.DateSeparator)},this.TryStrToDate$2=function(e,i,s){return t.TryStrToDate$3(e,i,t.FormatSettings.ShortDateFormat,s)},this.TryStrToDate$3=function(t,i,s,o){var n=!1,r="";return(n=0!==t.length)&&(i.set(e.IntStrToDate({get:function(){return r},set:function(t){r=t}},t,s,o)),n=""===r),n},this.StrToDateDef=function(e,i){return t.StrToDateDef$1(e,i,"\0")},this.StrToDateDef$1=function(e,i,s){var o=0;return t.TryStrToDate$2(e,{get:function(){return o},set:function(t){o=t}},s)||(o=i),o},this.TimeToStr=function(e){return t.TimeToStr$1(e,t.FormatSettings)},this.TimeToStr$1=function(e,i){return t.FormatDateTime$1("tt",e,i)},this.StrToTime=function(e){return t.StrToTime$2(e,t.FormatSettings)},this.StrToTime$2=function(i,s){var o,n="";if(o=e.IntStrToTime({get:function(){return n},set:function(t){n=t}},i,i.length,s),""!==n)throw t.EConvertError.$create("Create$1",[n]);return o},this.TryStrToTime=function(e,i){return t.TryStrToTime$1(e,i,t.TFormatSettings.$clone(t.FormatSettings))},this.TryStrToTime$1=function(t,i,s){var o=!1,n="";return(o=0!==t.length)&&(i.set(e.IntStrToTime({get:function(){return n},set:function(t){n=t}},t,t.length,s)),o=""===n),o},this.TryStrToTime$2=function(e,i,s){var o=t.TFormatSettings.$new();return o.$assign(t.TFormatSettings.Create()),o.TimeSeparator=s,t.TryStrToTime$1(e,i,t.TFormatSettings.$clone(o))},this.StrToTimeDef=function(e,i){return t.StrToTimeDef$1(e,i,"\0")},this.StrToTimeDef$1=function(e,i,s){var o=0;return t.TryStrToTime$2(e,{get:function(){return o},set:function(t){o=t}},s)||(o=i),o},this.DateTimeToStr=function(e,i){return t.DateTimeToStr$1(e,t.FormatSettings,i)},this.DateTimeToStr$1=function(i,s,o){return t.FormatDateTime$1(e.DateTimeToStrFormat[+o],i,s)},this.StrToDateTime=function(e){return t.StrToDateTime$1(e,t.FormatSettings)},this.StrToDateTime$1=function(i,s){var o=0,n="",r="",a=e.SplitDateTimeStr(i,{get:function(){return r},set:function(t){r=t}},{get:function(){return n},set:function(t){n=t}},s);return 0===a?o=t.StrToDate(""):1===a?o=r.length>0?t.StrToDate$2(r,s.ShortDateFormat,s.DateSeparator):t.StrToTime(n):2===a&&(o=t.ComposeDateTime(t.StrToDate$2(r,s.ShortDateFormat,s.DateSeparator),t.StrToTime(n))),o},this.TryStrToDateTime=function(e,i){return t.TryStrToDateTime$1(e,i,t.FormatSettings)},this.TryStrToDateTime$1=function(e,i,s){var o=!1,n=0,r=0,a=0;if(o=!1,(n=pas.System.Pos(s.TimeSeparator,e))>0){for(;n>0&&" "!==e.charAt(n-1);)n-=1;if(n>0){if(!t.TryStrToDate$1(pas.System.Copy(e,1,n-1),{get:function(){return r},set:function(t){r=t}},s))return o;if(!t.TryStrToTime$1(pas.System.Copy(e,n+1,e.length-n),{get:function(){return a},set:function(t){a=t}},t.TFormatSettings.$clone(s)))return o;i.set(t.ComposeDateTime(r,a)),o=!0}else o=t.TryStrToTime$1(e,i,t.TFormatSettings.$clone(s))}else o=t.TryStrToDate$1(e,i,s);return o},this.StrToDateTimeDef=function(e,i){return t.StrToDateTimeDef$1(e,i,t.TFormatSettings.$clone(t.FormatSettings))},this.StrToDateTimeDef$1=function(e,i,s){var o=0;return t.TryStrToDateTime$1(e,{get:function(){return o},set:function(t){o=t}},s)||(o=i),o},this.FormatDateTime=function(e,i){return t.FormatDateTime$1(e,i,t.FormatSettings)},this.FormatDateTime$1=function(e,i,s){var o="";function n(t,e,i){o+=pas.System.Copy(t,e,i)}function r(t){o+=t}function a(e,i){var s="";for(s=t.IntToStr(e);s.length<i;)s="0"+s;r(s)}var l=0,h=0,F=0,p=0,c=0,u=0,C=0,T=0;function S(e,i,o){var d,m="",f="",g=0,y=!1,M=0,b=0,N=0;if(!(i>1)){for(N=1,d=e.length,y=!1,!1,b=1;b<=d;){var B=m=e.charAt(b-1);if("'"===B||'"'===B)for(b+=1;b<d&&e.charAt(b-1)!==m;)b+=1;else if(!("A"!==B&&"a"!==B||0!==t.CompareText(pas.System.Copy(e,b,3),"A/P")&&0!==t.CompareText(pas.System.Copy(e,b,4),"AMPM")&&0!==t.CompareText(pas.System.Copy(e,b,5),"AM/PM"))){y=!0;break}b+=1}for(m="ÿ",f=" ","H";N<=d;){g=1,b=N+1;var E=m=t.UpperCase(e.charAt(N-1)).charAt(0);if("'"===E||'"'===E){for(;b<d&&e.charAt(b-1)!==m;)b+=1;n(e,N+1,(g=(b+=1)-N)-2)}else if("A"===E)if(0===t.CompareText(pas.System.Copy(e,N,4),"AMPM"))g=4,r(c<12?s.TimeAMString:s.TimePMString);else if(0===t.CompareText(pas.System.Copy(e,N,5),"AM/PM"))g=5,n(e,c<12?N:N+3,2);else{if(0!==t.CompareText(pas.System.Copy(e,N,3),"A/P"))throw t.EConvertError.$create("Create$1",["Illegal character in format string"]);g=3,n(e,c<12?N:N+2,1)}else if("/"===E)r(s.DateSeparator);else if(":"===E)r(s.TimeSeparator);else if(" "===E||"C"===E||"D"===E||"H"===E||"M"===E||"N"===E||"S"===E||"T"===E||"Y"===E||"Z"===E||"F"===E){for(;b<=d&&t.UpperCase(e.charAt(b-1))===m;)b+=1;g=b-N;var D=m;if(" "===D)n(e,N,g);else if("Y"===D)g>2?a(l,4):a(l%100,2);else if("M"===D)if("H"===f||o)a(u,1===g?0:2);else{var L=g;1===L?a(h,0):2===L?a(h,2):r(3===L?s.ShortMonthNames[h-1]:s.LongMonthNames[h-1])}else if("D"===D){var G=g;1===G?a(F,0):2===G?a(F,2):3===G?r(s.ShortDayNames[p-1]):4===G?r(s.LongDayNames[p-1]):S(5===G?s.ShortDateFormat:s.LongDateFormat,i+1,!1)}else"H"===D?y?(0===(M=c%12)&&(M=12),a(M,1===g?0:2)):a(c,1===g?0:2):"N"===D?a(u,1===g?0:2):"S"===D?a(C,1===g?0:2):"Z"===D?a(T,1===g?0:3):"T"===D?S(1===g?s.ShortTimeFormat:s.LongTimeFormat,i+1,!0):"C"===D?(S(s.ShortDateFormat,i+1,!1),0===c&&0===u&&0===C||(r(" "),S(s.LongTimeFormat,i+1,!0))):"F"===D&&(S(s.ShortDateFormat,i+1,!1),r(" "),S(s.LongTimeFormat,i+1,!0));f,f=m}else r(m);N+=g}}}return t.DecodeDateFully(i,{get:function(){return l},set:function(t){l=t}},{get:function(){return h},set:function(t){h=t}},{get:function(){return F},set:function(t){F=t}},{get:function(){return p},set:function(t){p=t}}),t.DecodeTime(i,{get:function(){return c},set:function(t){c=t}},{get:function(){return u},set:function(t){u=t}},{get:function(){return C},set:function(t){C=t}},{get:function(){return T},set:function(t){T=t}}),S(""!==e?e:"C",0,!1),o},this.CurrencyFormat=0,this.NegCurrFormat=0,this.CurrencyDecimals=0,this.CurrencyString="",this.CurrToStr=function(e){return t.FloatToStrF$1(e/1e4,1,-1,0,t.FormatSettings)},this.StrToCurr=function(e){var i=0;if(!t.TryStrToCurr(e,{get:function(){return i},set:function(t){i=t}}))throw t.EConvertError.$create("CreateFmt",[rtl.getResStr(pas.RTLConsts,"SInvalidCurrency"),pas.System.VarRecs(18,e)]);return i},this.TryStrToCurr=function(e,i){var s,o=0;return(s=t.TryStrToFloat$3(e,{get:function(){return o},set:function(t){o=t}},t.FormatSettings))&&i.set(rtl.trunc(1e4*o)),s},this.Supports$1=function(t,e,i){return null!==t&&0===t.QueryInterface(e,i)},this.Supports$3=function(t,e,i){return null!==t&&t.GetInterfaceByStr(e,i)},this.TryStringToGUID=function(t,e){var i=!1;return 38===t.length&&((i=new RegExp("^\\{[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}\\}$").test(t))?(rtl.strToGUIDR(t,e),i=!0):(e.D1=0,i))},this.StringToGUID=function(e){var i=pas.System.TGuid.$new();if(!t.TryStringToGUID(e,i))throw t.EConvertError.$create("CreateFmt",[rtl.getResStr(pas.RTLConsts,"SInvalidGUID"),pas.System.VarRecs(18,e)]);return i},this.GUIDToString=function(t){return rtl.guidrToStr(t)},this.CreateGUID=function(t){function e(t){var e=0;for(e=pas.System.Random(256);t>1;)e=256*e+pas.System.Random(256),t-=1;return e}var i=0;for(0,t.D1=e(4),t.D2=e(2),t.D3=e(2),i=0;i<=7;i++)t.D4[i]=e(1);return 0},rtl.createHelper(this,"TGuidHelper",null,(function(){this.NewGuid=function(){var e=pas.System.TGuid.$new();return t.CreateGUID(e),e},this.ToString=function(e){var i="";return i=t.GUIDToString(this),e&&(i=pas.System.Copy(i,2,i.length-2)),i}})),rtl.createHelper(this,"TStringHelper",null,(function(){this.Empty="",this.GetChar=function(t){return this.get().charAt(t+1-1)},this.GetLength=function(){return this.get().length},this.LowerCase=function(e){return t.LowerCase(e)},this.UpperCase=function(e){return t.UpperCase(e)},this.Contains=function(t){return""!==t&&pas.System.Pos(t,this.get())>0},this.IndexOf=function(e){return t.TStringHelper.IndexOf$4.call(this,e,0,t.TStringHelper.GetLength.call(this))},this.IndexOf$2=function(e,i){return t.TStringHelper.IndexOf$4.call(this,e,i,t.TStringHelper.GetLength.call(this))},this.IndexOf$4=function(t,e,i){var s,o=0;return s=pas.System.Copy(this.get(),e+1,i),-1!==(o=pas.System.Pos(t,s)-1)&&(o+=e),o},this.IsEmpty=function(){return 0===t.TStringHelper.GetLength.call(this)},this.Replace=function(e,i){return t.TStringHelper.Replace$1.call(this,e,i,rtl.createSet(0))},this.Replace$1=function(e,i,s){return t.StringReplace(this.get(),e,i,rtl.refSet(s))},this.Replace$2=function(e,i){return t.TStringHelper.Replace$3.call(this,e,i,rtl.createSet(0))},this.Replace$3=function(e,i,s){return t.StringReplace(this.get(),e,i,rtl.refSet(s))},this.StartsWith=function(e){return t.TStringHelper.StartsWith$1.call(this,e,!1)},this.StartsWith$1=function(e,i){var s,o=!1,n="";return(o=(s=e.length)<=0)||(o=(n=pas.System.Copy(this.get(),1,s)).length===s)&&(o=i?t.SameText(n,e):t.SameStr(n,e)),o},this.Substring=function(e){return t.TStringHelper.Substring$1.call(this,e,t.TStringHelper.GetLength.call(this)-e)},this.Substring$1=function(t,e){return pas.System.Copy(this.get(),t+1,e)},this.ToInteger$1=function(){return t.StrToInt(this.get())},this.ToLower=function(){return t.TStringHelper.LowerCase(this.get())},this.ToUpper=function(){return t.TStringHelper.UpperCase(this.get())},this.Trim=function(){return t.Trim(this.get())}})),rtl.createHelper(this,"TDoubleHelper",null,(function(){this.ToString$3=function(){return t.FloatToStr(this.get())}})),rtl.createHelper(this,"TIntegerHelper",null,(function(){this.ToString$1=function(){return t.IntToStr(this.get())}})),rtl.createHelper(this,"TNativeIntHelper",null,(function(){this.ToString$1=function(){return t.IntToStr(this.get())}})),t.$implcode=function(){e.DefaultShortMonthNames=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],e.DefaultLongMonthNames=["January","February","March","April","May","June","July","August","September","October","November","December"],e.DefaultShortDayNames=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],e.DefaultLongDayNames=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],e.FInvariant=t.TFormatSettings.$new(),e.FInvariantCreated=!1,e.DoShowException=function(e){null!=t.OnShowException?t.OnShowException(e):window.alert(e)},e.CheckBoolStrs=function(){0===rtl.length(t.TrueBoolStrs)&&(t.TrueBoolStrs=rtl.arraySetLength(t.TrueBoolStrs,"",1),t.TrueBoolStrs[0]="True"),0===rtl.length(t.FalseBoolStrs)&&(t.FalseBoolStrs=rtl.arraySetLength(t.FalseBoolStrs,"",1),t.FalseBoolStrs[0]="False")},e.feInvalidFormat=1,e.feMissingArgument=2,e.feInvalidArgIndex=3,e.DoFormatError=function(e,i){var s=e;if(1===s)throw t.EConvertError.$create("CreateFmt",[rtl.getResStr(pas.RTLConsts,"SInvalidFormat"),pas.System.VarRecs(18,i)]);if(2===s)throw t.EConvertError.$create("CreateFmt",[rtl.getResStr(pas.RTLConsts,"SArgumentMissing"),pas.System.VarRecs(18,i)]);if(3===s)throw t.EConvertError.$create("CreateFmt",[rtl.getResStr(pas.RTLConsts,"SInvalidArgIndex"),pas.System.VarRecs(18,i)])},e.maxdigits=15,e.ReplaceDecimalSep=function(t,e){var i;return(i=pas.System.Pos(".",t))>0?pas.System.Copy(t,1,i-1)+e+pas.System.Copy(t,i+1,t.length-i):t},e.FormatGeneralFloat=function(i,s,o){var n="",r=0,a=0,l=0,h=0;if((-1===s||s>15)&&(s=15),n=rtl.floatToStr(i,s+7),n=t.TrimLeft(n),0===(r=pas.System.Pos(".",n)))return n;if(0===(a=pas.System.Pos("E",n)))return n=e.ReplaceDecimalSep(n,o);for(l=a+2,h=0;l<=n.length;)h=10*h+n.charCodeAt(l-1)-48,l+=1;if("-"===n.charAt(a+1-1)&&(h=-h),r+h<a&&h>-6){if(n=rtl.strSetLength(n,a-1),h>=0){for(var F=0,p=h-1;F<=p;F++)l=F,n=rtl.setCharAt(n,r-1,n.charAt(r+1-1)),r+=1;for(n=rtl.setCharAt(n,r-1,"."),r=1,"-"===n.charAt(r-1)&&(r+=1);"0"===n.charAt(r-1)&&r<n.length&&pas.System.Copy(n,r+1,o.length)!==o;)pas.System.Delete({get:function(){return n},set:function(t){n=t}},r,1)}else pas.System.Insert(pas.System.Copy("00000",1,-h),{get:function(){return n},set:function(t){n=t}},r-1),n=rtl.setCharAt(n,r-h-1,n.charAt(r-h-1-1)),n=rtl.setCharAt(n,r-1,"."),-1!==h&&(n=rtl.setCharAt(n,r-h-1-1,"0"));for(l=n.length;l>0&&"0"===n.charAt(l-1);)l-=1;"."===n.charAt(l-1)&&(l-=1),n=0===l||1===l&&"-"===n.charAt(0)?"0":rtl.strSetLength(n,l)}else{for(;"0"===n.charAt(a-1-1);)pas.System.Delete({get:function(){return n},set:function(t){n=t}},a-1,1),a-=1;for(n.charAt(a-1-1)===o&&(pas.System.Delete({get:function(){return n},set:function(t){n=t}},a-1,1),a-=1),"+"===n.charAt(a+1-1)?pas.System.Delete({get:function(){return n},set:function(t){n=t}},a+1,1):a+=1;"0"===n.charAt(a+1-1);)pas.System.Delete({get:function(){return n},set:function(t){n=t}},a+1,1)}return n=e.ReplaceDecimalSep(n,o)},e.FormatExponentFloat=function(i,s,o,n){var r="",a=0;for(n=t.FormatSettings.DecimalSeparator,(-1===s||s>15)&&(s=15),r=rtl.floatToStr(i,s+7);" "===r.charAt(0);)pas.System.Delete({get:function(){return r},set:function(t){r=t}},1,1);if(0===(a=pas.System.Pos("E",r)))return r=e.ReplaceDecimalSep(r,n);if(a+=2,o>4&&(o=4),(o=r.length-a-o+1)<0)pas.System.Insert(pas.System.Copy("0000",1,-o),{get:function(){return r},set:function(t){r=t}},a);else for(;o>0&&"0"===r.charAt(a-1);){if(pas.System.Delete({get:function(){return r},set:function(t){r=t}},a,1),a>r.length){pas.System.Delete({get:function(){return r},set:function(t){r=t}},a-2,2);break}o-=1}return r=e.ReplaceDecimalSep(r,n)},e.FormatFixedFloat=function(t,i,s){var o="";return-1===i?i=2:i>18&&(i=18),""!==(o=rtl.floatToStr(t,0,i))&&" "===o.charAt(0)&&pas.System.Delete({get:function(){return o},set:function(t){o=t}},1,1),o=e.ReplaceDecimalSep(o,s)},e.FormatNumberFloat=function(t,i,s,o){var n="",r=0;if(-1===i?i=2:i>15&&(i=15),""!==(n=rtl.floatToStr(t,0,i))&&" "===n.charAt(0)&&pas.System.Delete({get:function(){return n},set:function(t){n=t}},1,1),(r=pas.System.Pos(".",n))<=0&&(r=n.length+1),n=e.ReplaceDecimalSep(n,s),r-=3,""!==o&&"\0"!==o)for(;r>1;)"-"!==n.charAt(r-1-1)&&pas.System.Insert(o,{get:function(){return n},set:function(t){n=t}},r),r-=3;return n},e.RemoveLeadingNegativeSign=function(t,e,i){var s,o=!1,n=0;o=!1,s=i;for(var r=2,a=t.get().length;r<=a&&(n=r,o=t.get().charCodeAt(n-1)in rtl.createSet(48,e.charCodeAt(),69,43)||t.get().charAt(n-1)===s);r++);return o&&"-"===t.get().charAt(0)&&pas.System.Delete(t,1,1),o},e.FormatNumberCurrency=function(t,i,s){var o,n,r,a,l="",h=0;if(r=s.DecimalSeparator,a=s.ThousandSeparator,n=s.CurrencyString,-1===i?i=s.CurrencyDecimals:i>18&&(i=18),(o="-"===(l=rtl.floatToStr(t/1e4,0,i)).charAt(0))&&pas.System.Delete({get:function(){return l},set:function(t){l=t}},1,1),h=pas.System.Pos(".",l),""!==a)for(0!==h?l=e.ReplaceDecimalSep(l,r):h=l.length+1,h-=3;h>1;)pas.System.Insert(a,{get:function(){return l},set:function(t){l=t}},h),h-=3;if(o&&e.RemoveLeadingNegativeSign({get:function(){return l},set:function(t){l=t}},r,a),o){var F=s.NegCurrFormat;0===F?l="("+n+l+")":1===F?l="-"+n+l:2===F?l=n+"-"+l:3===F?l=n+l+"-":4===F?l="("+l+n+")":5===F?l="-"+l+n:6===F?l=l+"-"+n:7===F?l=l+n+"-":8===F?l="-"+l+" "+n:9===F?l="-"+n+" "+l:10===F?l=l+" "+n+"-":11===F?l=n+" "+l+"-":12===F?l=n+" -"+l:13===F?l=l+"- "+n:14===F?l="("+n+" "+l+")":15===F&&(l="("+l+" "+n+")")}else{var p=s.CurrencyFormat;0===p?l=n+l:1===p?l+=n:2===p?l=n+" "+l:3===p&&(l=l+" "+n)}return l},e.RESpecials="([\\$\\+\\[\\]\\(\\)\\\\\\.\\*\\^\\?\\|])",e.DoEncodeDate=function(e,i,s){var o=0;return t.TryEncodeDate(e,i,s,{get:function(){return o},set:function(t){o=t}})?pas.System.Trunc(o):0},e.DateTimeToStrFormat=["c","f"];e.IntStrToDate=function(e,i,s,o){var n=0;function r(i){e.set(t.Format(rtl.getResStr(pas.RTLConsts,"SInvalidDateFormat"),pas.System.VarRecs(18,i)))}var a="",l=0,h=0,F=0,p=0,c=0,u=0,C=0,T=0,S=0,d=0,m=0,f=0,g=0,y=0,M="",b=[],N=!1;for(b=rtl.arraySetLength(b,0,4),n=0,S=i.length,e.set("");S>0&&pas.System.Pos(i.charAt(S-1)," \b\t\n\f\r")>0;)S-=1;if(0===S)return r(i),n;for(N=!1,"\0"===o&&(o="\0"!==t.FormatSettings.DateSeparator?t.FormatSettings.DateSeparator:"-"),a=t.UpperCase(s),g=0,f=0,m=0,y=0,T=0;T<a.length&&y<3;){T+=1;var B=a.charAt(T-1);"Y"===B?0===g&&(g=y+=1):"M"===B?0===f&&(f=y+=1):"D"===B&&0===m&&(m=y+=1)}for(T=1;T<=3;T++)b[T]=0;M="",C=0;for(var E=1,D=S;E<=D;E++)if(T=E,pas.System.Pos(i.charAt(T-1),"0123456789")>0&&(M+=i.charAt(T-1))," "===o||" "!==i.charAt(T-1))if(i.charAt(T-1)===o||T===S&&pas.System.Pos(i.charAt(T-1),"0123456789")>0){if((C+=1)>3)return r(i),n;if(C===g&&M.length>2&&(N=!0),pas.System.val$6(M,{a:C,p:b,get:function(){return this.p[this.a]},set:function(t){this.p[this.a]=t}},{get:function(){return d},set:function(t){d=t}}),0!==d)return r(i),n;M=""}else if(0===pas.System.Pos(i.charAt(T-1),"0123456789"))return r(i),n;return y<3&&C>y?(r(i),n):(t.DecodeDate(t.Date(),{get:function(){return p},set:function(t){p=t}},{get:function(){return u},set:function(t){u=t}},{get:function(){return c},set:function(t){c=t}}),3===C?(F=b[g],h=b[f],l=b[m]):(F=p,C<2?(l=b[1],h=u):m<f?(l=b[1],h=b[2]):(l=b[2],h=b[1])),F>=0&&F<100&&!N&&(p-=t.TwoDigitYearCenturyWindow,F+=100*rtl.trunc(p/100),t.TwoDigitYearCenturyWindow>0&&F<p&&(F+=100)),t.TryEncodeDate(F,h,l,{get:function(){return n},set:function(t){n=t}})||e.set(rtl.getResStr(pas.RTLConsts,"SErrInvalidDate")),n)};e.IntStrToTime=function(e,i,s,o){var n=0,r=0,a=[];return a=rtl.arraySetLength(a,0,4),r=0,function(e,n){var r=!1,a=0,l=0,h=0,F=0,p=0,c=0,u=0,C=!1,T=!1,S="",d="",m=0,f="";for(r=!1,n.set(0),T=!1,p=0,m=0;m<=3;m++)e.get()[m]=0;for(a=1;a<s&&" "===i.charAt(a-1);)a+=1;if(l=a,a>s-1||i.charAt(a-1)===o.TimeSeparator||i.charAt(a-1)===o.DecimalSeparator)return r;for(C=pas.System.Pos(i.charAt(a-1),"0123456789")>0;a<=s;){if(d=i.charAt(a-1),pas.System.Pos(d,"0123456789")>0){if(!C||p>3)return r;for(l=a,c="0"!==d?l:-1;a<s&&pas.System.Pos(i.charAt(a+1-1),"0123456789")>0;)-1===c&&"0"!==i.charAt(a-1)&&(c=a),a+=1;if(-1===c&&(c=a),!((h=1+a-c)<=2||h<=3&&3===p))return r;pas.System.val$6(pas.System.Copy(i,c,h),{get:function(){return u},set:function(t){u=t}},{get:function(){return F},set:function(t){F=t}}),e.get()[p]=u,p+=1,C=!1}else if(" "===d);else if(d===o.TimeSeparator){if(C||p>2)return r;C=!0,T=!1}else if(d===o.DecimalSeparator){if(C||T||3!==p)return r;C=!0,T=!0}else{if(0!==n.get()||C)return r;for(l=a,f=o.DecimalSeparator+" ","\0"!==o.TimeSeparator&&(f+=o.TimeSeparator);a<s&&0===pas.System.Pos(i.charAt(a+1-1),f)&&0===pas.System.Pos(i.charAt(a+1-1),"0123456789");)a+=1;if(h=1+a-l,S=pas.System.Copy(i,l,h),0===t.CompareText(S,o.TimeAMString))n.set(1);else if(0===t.CompareText(S,o.TimePMString))n.set(2);else if(0===t.CompareText(S,"AM"))n.set(1);else{if(0!==t.CompareText(S,"PM"))return r;n.set(2)}0===p?C=!0:(p=4,C=!1)}a+=1}return 0===p||0!==n.get()&&(e.get()[0]>12||0===e.get()[0])||C?r:r=!0}({get:function(){return a},set:function(t){a=t}},{get:function(){return r},set:function(t){r=t}})?(2===r&&12!==a[0]?a[0]+=12:1===r&&12===a[0]&&(a[0]=0),t.TryEncodeTime(a[0],a[1],a[2],a[3],{get:function(){return n},set:function(t){n=t}})||e.set(t.Format(rtl.getResStr(pas.RTLConsts,"SErrInvalidTimeFormat"),pas.System.VarRecs(18,i))),n):(e.set(t.Format(rtl.getResStr(pas.RTLConsts,"SErrInvalidTimeFormat"),pas.System.VarRecs(18,i))),n)};e.SplitDateTimeStr=function(e,i,s,o){var n=0,r=0,a=0;if(n=0,i.set(""),s.set(""),0===(e=t.Trim(e)).length)return n;if(" "===o.DateSeparator&&" "===o.TimeSeparator&&pas.System.Pos(" ",e)>0)return i.set(e),1;if(r=1," "!==o.DateSeparator)for(;r<e.length&&!(pas.System.Pos(e.charAt(r+1-1),"\t\n\r ")>0);)r+=1;else if(0!==(r=pas.System.Pos(o.TimeSeparator,e)))do{r-=1}while(!(0===r||pas.System.Pos(e.charAt(r-1),"\t\n\r ")>0));return 0===r&&(r=e.length),i.set(pas.System.Copy(e,1,r)),s.set(t.Trim(pas.System.Copy(e,r+1,100))),0!==s.get().length?n=2:(n=1,(o.DateSeparator!==o.TimeSeparator&&pas.System.Pos(o.TimeSeparator,i.get())>0||o.DateSeparator===o.TimeSeparator&&!t.TryStrToDate(i.get(),{get:function(){return a},set:function(t){a=t}}))&&(s.set(i.get()),i.set(""))),n},e.IntTryStrToInt=function(e,i,s){var o,n,r=10,a="";if(a=e,0!==pas.System.Pos(s,a)||0!==pas.System.Pos(".",a))return!1;var l=pas.System.Copy(a,1,1);return"$"===l?r=16:"&"===l?r=8:"%"===l&&(r=2),(16===r||0===pas.System.Pos("e",t.LowerCase(a)))&&(10!==r&&pas.System.Delete({get:function(){return a},set:function(t){a=t}},1,1),n=parseInt(a,r),(o=!isNaN(n))&&i.set(rtl.trunc(n)),o)},e.InitGlobalFormatSettings=function(){t.FormatSettings.$assign(t.TFormatSettings.Create()),t.TimeSeparator=t.FormatSettings.TimeSeparator,t.DateSeparator=t.FormatSettings.DateSeparator,t.ShortDateFormat=t.FormatSettings.ShortDateFormat,t.LongDateFormat=t.FormatSettings.LongDateFormat,t.ShortTimeFormat=t.FormatSettings.ShortTimeFormat,t.LongTimeFormat=t.FormatSettings.LongTimeFormat,t.DecimalSeparator=t.FormatSettings.DecimalSeparator,t.ThousandSeparator=t.FormatSettings.ThousandSeparator,t.TimeAMString=t.FormatSettings.TimeAMString,t.TimePMString=t.FormatSettings.TimePMString,t.CurrencyFormat=t.FormatSettings.CurrencyFormat,t.NegCurrFormat=t.FormatSettings.NegCurrFormat,t.CurrencyDecimals=t.FormatSettings.CurrencyDecimals,t.CurrencyString=t.FormatSettings.CurrencyString},t.$resourcestrings={SAbortError:{org:"Operation aborted"},SApplicationException:{org:"Application raised an exception: "}}},t.$init=function(){e.InitGlobalFormatSettings(),t.ShortMonthNames=e.DefaultShortMonthNames.slice(0),t.LongMonthNames=e.DefaultLongMonthNames.slice(0),t.ShortDayNames=e.DefaultShortDayNames.slice(0),t.LongDayNames=e.DefaultLongDayNames.slice(0)}}),[]),rtl.module("TypInfo",["System","SysUtils","Types","RTLConsts","JS"],(function(){"use strict";var t=this,e=t.$impl;this.pfGetFunction=1,this.pfSetProcedure=2,this.pfHasIndex=16,this.$rtti.$ExtClass("TTypeMemberProperty",{ancestor:this.$rtti.TTypeMember,jsclass:"rtl.tTypeMemberProperty"}),rtl.createClass(this,"EPropertyError",pas.SysUtils.Exception,(function(){})),this.GetPropInfos=function(t){var e=[],i=null,s=0,o=null,n="";for(e=[],i=t,o=new Object;null!==i;){for(var r=0,a=i.properties.length-1;r<=a;r++)s=r,n=i.properties[s],o.hasOwnProperty(n)||(e.push(i.members[n]),o[n]=!0);if(!rtl.isExt(i,rtl.tTypeInfoClass))break;i=i.ancestor}return e},this.GetPropList=function(t,e,i){var s=[];var o=null,n=0,r=null,a="",l=null;for(s=[],o=t,r=new Object;null!==o;){for(var h=0,F=o.properties.length-1;h<=F;h++)n=h,a=o.properties[n],r.hasOwnProperty(a)||(l=o.members[a]).typeinfo.kind in e&&(s.push(l),r[a]=!0);if(!rtl.isExt(o,rtl.tTypeInfoClass))break;o=o.ancestor}return i&&s.sort((function(t,e){return t.name<e.name?-1:t.name>e.name?1:0})),s},this.GetPropList$2=function(e){return t.GetPropInfos(e.$rtti)},this.GetPropList$3=function(e){return t.GetPropList$2(e.$class.ClassType())},this.GetPropInfo=function(t,e){var i=null,s=null,o=0,n=null;for(n=t;null!==n;){if(s=n.members[e],rtl.isExt(s,rtl.tTypeMemberProperty))return s;if(!rtl.isExt(n,rtl.tTypeInfoClass))break;n=n.ancestor}i=null;do{for(var r=0,a=t.properties.length-1;r<=a;r++)if(o=r,0===pas.SysUtils.CompareText(e,t.properties[o]))return s=t.members[t.properties[o]],rtl.isExt(s,rtl.tTypeMemberProperty)&&(i=s),i;if(!rtl.isExt(t,rtl.tTypeInfoClass))break;t=t.ancestor}while(null!==t);return i},this.GetPropInfo$1=function(e,i,s){var o=null;return o=t.GetPropInfo(e,i),rtl.neSet(s,{})&&null!==o&&!(o.typeinfo.kind in s)&&(o=null),o},this.GetPropInfo$2=function(e,i){return t.GetPropInfo$1(e.$rtti,i,{})},this.FindPropInfo=function(e,i){var s;if(null===(s=t.GetPropInfo(e.$rtti,i)))throw t.EPropertyError.$create("CreateFmt",[rtl.getResStr(pas.RTLConsts,"SErrPropertyNotFound"),pas.System.VarRecs(18,i)]);return s},this.IsStoredProp=function(t,e){var i=12&e.flags;return 0===i||4!==i&&(8===i?!(0==t[e.stored]):t[e.stored]())},this.GetJSValueProp$1=function(i,s){var o=void 0,n=e.GetPropGetterKind(s);if(0===n)throw t.EPropertyError.$create("CreateFmt",[rtl.getResStr(pas.RTLConsts,"SCantReadPropertyS"),pas.System.VarRecs(18,s.name)]);if(1===n)o=i[s.getter];else if(2===n)o=(16&s.flags)>0?i[s.getter](s.index):i[s.getter]();else if(3===n)throw t.EPropertyError.$create("CreateFmt",[rtl.getResStr(pas.RTLConsts,"SIndexedPropertyNeedsParams"),pas.System.VarRecs(18,s.name)]);return o},this.GetJSValueProp$3=function(e,i){return t.GetJSValueProp$1(e,i)},this.SetJSValueProp$1=function(i,s,o){var n=e.GetPropSetterKind(s);if(0===n)throw t.EPropertyError.$create("CreateFmt",[rtl.getResStr(pas.RTLConsts,"SCantWritePropertyS"),pas.System.VarRecs(18,s.name)]);if(1===n)i[s.setter]=o;else if(2===n)(16&s.flags)>0?i[s.setter](s.index,o):i[s.setter](o);else if(3===n)throw t.EPropertyError.$create("CreateFmt",[rtl.getResStr(pas.RTLConsts,"SIndexedPropertyNeedsParams"),pas.System.VarRecs(18,s.name)])},this.SetJSValueProp$3=function(e,i,s){t.SetJSValueProp$1(e,i,s)},this.GetOrdProp$1=function(e,i){var s=0,o="",n=0,r=void 0;if(5===i.typeinfo.kind)for(o in s=0,t.GetJSValueProp$3(e,i))(n=parseInt(o,10))<32&&(s+=1<<n);else 2===i.typeinfo.kind?(r=t.GetJSValueProp$3(e,i),s=rtl.isNumber(r)?rtl.trunc(r):""===(o=""+r)?0:o.charCodeAt(0)):s=rtl.trunc(t.GetJSValueProp$3(e,i));return s},this.SetOrdProp=function(e,i,s){t.SetOrdProp$1(e,t.FindPropInfo(e,i),s)},this.SetOrdProp$1=function(e,i,s){var o=null,n=0;if(5===i.typeinfo.kind){for(o=new Object,n=0;n<=31;n++)(1<<n&s)>0&&(o[""+n]=!0);t.SetJSValueProp$3(e,i,o)}else 2===i.typeinfo.kind?t.SetJSValueProp$3(e,i,String.fromCharCode(s)):t.SetJSValueProp$3(e,i,s)},this.GetEnumName=function(t,e){return t.enumtype[e]},this.GetBoolProp$1=function(e,i){return!(0==t.GetJSValueProp$3(e,i))},this.SetBoolProp$1=function(e,i,s){t.SetJSValueProp$3(e,i,s)},this.GetStrProp$1=function(e,i){return""+t.GetJSValueProp$3(e,i)},this.SetStrProp$1=function(e,i,s){t.SetJSValueProp$3(e,i,s)},this.GetFloatProp$1=function(e,i){return rtl.getNumber(t.GetJSValueProp$3(e,i))},this.SetFloatProp$1=function(e,i,s){t.SetJSValueProp$3(e,i,s)},this.GetObjectProp=function(e,i){return t.GetObjectProp$2(e,t.FindPropInfo(e,i))},this.GetObjectProp$2=function(e,i){return t.GetObjectProp$3(e,i,null)},this.GetObjectProp$3=function(e,i,s){var o=null;return o=rtl.getObject(t.GetJSValueProp$3(e,i)),null===s||o.$class.InheritsFrom(s)?o:null},this.SetObjectProp=function(e,i,s){t.SetObjectProp$1(e,t.FindPropInfo(e,i),s)},this.SetObjectProp$1=function(e,i,s){t.SetJSValueProp$3(e,i,s)},this.GetMethodProp=function(e,i){var s,o,n=pas.System.TMethod.$new();return n.Code=null,n.Data=null,s=t.GetJSValueProp$3(e,i),rtl.isFunction(s)?(n.Data=s.scope,o=s.fn,rtl.isString(o)?null!==n.Data?n.Code=n.Data[""+o]:n.Code=s:n.Code=o,n):n},this.GetMethodProp$1=function(e,i){var s=pas.System.TMethod.$new();return s.$assign(t.GetMethodProp(e,t.FindPropInfo(e,i))),s},this.SetMethodProp=function(e,i,s){var o,n=null;n=null===(o=s.Code)?null:rtl.isFunction(o)?o.scope===s.Data&&(rtl.isFunction(o.fn)||rtl.isString(o.fn))?o:rtl.isString(o.fn)?rtl.createCallback(s.Data,""+o.fn):rtl.createCallback(s.Data,o):rtl.createCallback(s.Data,o),t.SetJSValueProp$3(e,i,n)},this.SetMethodProp$1=function(e,i,s){t.SetMethodProp(e,t.FindPropInfo(e,i),s)},t.$implcode=function(){e.TGetterKind={0:"gkNone",gkNone:0,1:"gkField",gkField:1,2:"gkFunction",gkFunction:2,3:"gkFunctionWithParams",gkFunctionWithParams:3},e.GetPropGetterKind=function(t){return""===t.getter?0:(1&t.flags)>0?rtl.length(t.params)>0?3:2:1},e.TSetterKind={0:"skNone",skNone:0,1:"skField",skField:1,2:"skProcedure",skProcedure:2,3:"skProcedureWithParams",skProcedureWithParams:3},e.GetPropSetterKind=function(t){return""===t.setter?0:(2&t.flags)>0?rtl.length(t.params)>0?3:2:1}}}),[]),rtl.module("Web",["System","Types","JS"],(function(){"use strict";rtl.createClassExt(this,"TJSFocusEvent",Event,"",(function(){this.$init=function(){},this.$final=function(){}})),this.$rtti.$ExtClass("TJSHTMLElement",{ancestor:this.$rtti.TJSElement,jsclass:"HTMLElement"}),this.$rtti.$ExtClass("TJSXMLHttpRequest",{ancestor:this.$rtti.TJSXMLHttpRequestEventTarget,jsclass:"XMLHttpRequest"}),rtl.createClass(this,"TJSKeyNames",pas.System.TObject,(function(){this.Alt="Alt",this.CapsLock="CapsLock",this.Control="Control",this.Shift="Shift",this.Enter="Enter",this.Tab="Tab",this.ArrowDown="ArrowDown",this.ArrowLeft="ArrowLeft",this.ArrowRight="ArrowRight",this.ArrowUp="ArrowUp",this._End="End",this.Home="Home",this.PageDown="PageDown",this.PageUp="PageUp",this.BackSpace="Backspace",this.Delete="Delete",this.Insert="Insert",this.Escape="Escape",this.Pause="Pause",this.F1="F1",this.F2="F2",this.F3="F3",this.F4="F4",this.F5="F5",this.F6="F6",this.F7="F7",this.F8="F8",this.F9="F9",this.F10="F10",this.F11="F11",this.F12="F12",this.F13="F13",this.F14="F14",this.F15="F15",this.F16="F16",this.F17="F17",this.F18="F18",this.F19="F19",this.F20="F20"}))})),rtl.module("Classes",["System","RTLConsts","Types","SysUtils","JS","TypInfo"],(function(){"use strict";var t=this,e=t.$impl;this.$rtti.$MethodVar("TNotifyEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject]]),methodkind:0}),rtl.createClass(this,"EStreamError",pas.SysUtils.Exception,(function(){})),rtl.createClass(this,"EFilerError",this.EStreamError,(function(){})),rtl.createClass(this,"EReadError",this.EFilerError,(function(){})),rtl.createClass(this,"EWriteError",this.EFilerError,(function(){})),rtl.createClass(this,"EListError",pas.SysUtils.Exception,(function(){})),rtl.createClass(this,"EStringListError",this.EListError,(function(){})),rtl.createClass(this,"EComponentError",pas.SysUtils.Exception,(function(){})),this.TAlignment={0:"taLeftJustify",taLeftJustify:0,1:"taRightJustify",taRightJustify:1,2:"taCenter",taCenter:2},this.$rtti.$Enum("TAlignment",{minvalue:0,maxvalue:2,ordtype:1,enumtype:this.TAlignment}),rtl.createClass(this,"TFPList",pas.System.TObject,(function(){this.$init=function(){pas.System.TObject.$init.call(this),this.FList=[],this.FCount=0,this.FCapacity=0},this.$final=function(){this.FList=void 0,pas.System.TObject.$final.call(this)},this.Get=function(t){return(t<0||t>=this.FCount)&&this.RaiseIndexError(t),this.FList[t]},this.Put=function(t,e){(t<0||t>=this.FCount)&&this.RaiseIndexError(t),this.FList[t]=e},this.SetCapacity=function(t){t<this.FCount&&this.$class.Error(rtl.getResStr(pas.RTLConsts,"SListCapacityError"),""+t),t!==this.FCapacity&&(this.FList=rtl.arraySetLength(this.FList,void 0,t),this.FCapacity=t)},this.SetCount=function(t){t<0&&this.$class.Error(rtl.getResStr(pas.RTLConsts,"SListCountError"),""+t),t>this.FCount&&t>this.FCapacity&&this.SetCapacity(t),this.FCount=t},this.RaiseIndexError=function(t){this.$class.Error(rtl.getResStr(pas.RTLConsts,"SListIndexError"),""+t)},this.Destroy=function(){this.Clear(),pas.System.TObject.Destroy.call(this)},this.Add=function(t){var e;return this.FCount===this.FCapacity&&this.Expand(),this.FList[this.FCount]=t,e=this.FCount,this.FCount+=1,e},this.Clear=function(){rtl.length(this.FList)>0&&(this.SetCount(0),this.SetCapacity(0))},this.Delete=function(t){(t<0||t>=this.FCount)&&this.$class.Error(rtl.getResStr(pas.RTLConsts,"SListIndexError"),""+t),this.FCount=this.FCount-1,this.FList.splice(t,1),this.FCapacity-=1},this.Error=function(e,i){throw t.EListError.$create("CreateFmt",[e,pas.System.VarRecs(18,i)])},this.Expand=function(){var t=0;return this.FCount<this.FCapacity||(t=4,this.FCapacity>3&&(t+=4),this.FCapacity>8&&(t+=8),this.FCapacity>127&&(t+=this.FCapacity>>>2),this.SetCapacity(this.FCapacity+t),this),this},this.IndexOf=function(t){var e,i=0;for(i=0,e=this.FCount;i<e&&this.FList[i]!=t;)i+=1;return i>=e&&(i=-1),i},this.IndexOfItem=function(t,e){var i=0;if(0===e)i=this.IndexOf(t);else for(i=this.FCount-1;i>=0&&this.FList[i]!=t;)i-=1;return i},this.Insert=function(t,e){(t<0||t>this.FCount)&&this.$class.Error(rtl.getResStr(pas.RTLConsts,"SListIndexError"),""+t),this.FList.splice(t,0,e),this.FCapacity+=1,this.FCount+=1},this.Last=function(){return 0===this.FCount?null:this.Get(this.FCount-1)},this.Move=function(t,e){var i;(t<0||t>this.FCount-1)&&this.$class.Error(rtl.getResStr(pas.RTLConsts,"SListIndexError"),""+t),(e<0||e>this.FCount-1)&&this.$class.Error(rtl.getResStr(pas.RTLConsts,"SListIndexError"),""+e),t!==e&&(i=this.FList[t],this.FList.splice(t,1),this.FList.splice(e,0,i))},this.Remove=function(t){var e;return-1!==(e=this.IndexOf(t))&&this.Delete(e),e}})),this.TListNotification={0:"lnAdded",lnAdded:0,1:"lnExtracted",lnExtracted:1,2:"lnDeleted",lnDeleted:2},rtl.createClass(this,"TList",pas.System.TObject,(function(){this.$init=function(){pas.System.TObject.$init.call(this),this.FList=null},this.$final=function(){this.FList=void 0,pas.System.TObject.$final.call(this)},this.Get=function(t){return this.FList.Get(t)},this.Put=function(t,e){var i;i=this.Get(t),this.FList.Put(t,e),pas.System.Assigned(i)&&this.Notify(i,2),pas.System.Assigned(e)&&this.Notify(e,0)},this.Notify=function(t,e){pas.System.Assigned(t)},this.SetCount=function(t){if(t<this.FList.FCount)for(;this.FList.FCount>t;)this.Delete(this.FList.FCount-1);else this.FList.SetCount(t)},this.GetCount=function(){return this.FList.FCount},this.Create$1=function(){return pas.System.TObject.Create.call(this),this.FList=t.TFPList.$create("Create"),this},this.Destroy=function(){null!=this.FList&&this.Clear(),pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FList},set:function(t){this.p.FList=t}})},this.Add=function(t){var e;return e=this.FList.Add(t),pas.System.Assigned(t)&&this.Notify(t,0),e},this.Clear=function(){for(;this.FList.FCount>0;)this.Delete(this.GetCount()-1)},this.Delete=function(t){var e;e=this.FList.Get(t),this.FList.Delete(t),pas.System.Assigned(e)&&this.Notify(e,2)},this.IndexOf=function(t){return this.FList.IndexOf(t)},this.Insert=function(t,e){this.FList.Insert(t,e),pas.System.Assigned(e)&&this.Notify(e,0)},this.Last=function(){return this.FList.Last()},this.Move=function(t,e){this.FList.Move(t,e)},this.Remove=function(t){var e;return-1!==(e=this.IndexOf(t))&&this.Delete(e),e}})),rtl.createClass(this,"TPersistent",pas.System.TObject,(function(){this.AssignError=function(t){var e="";throw e=null!==t?t.$classname:"Nil",pas.SysUtils.EConvertError.$create("Create$1",["Cannot assign a "+e+" to a "+this.$classname+"."])},this.DefineProperties=function(t){},this.AssignTo=function(t){t.AssignError(this)},this.GetOwner=function(){return null,null},this.Assign=function(t){null!==t?t.AssignTo(this):this.AssignError(null)},this.SetEvent=function(t,e,i){this.SetEvent$1(this,t,e,i)},this.SetEvent$1=function(t,e,i,s){var o=pas.System.TMethod.$new();if(o.Code=e.$class.MethodAddress(s),null===o.Code)throw pas.SysUtils.Exception.$create("Create$1",[e.$classname+' has no published method "'+s+'"']);o.Data=e,pas.TypInfo.SetMethodProp$1(t,i,o)}})),rtl.createClass(this,"TInterfacedPersistent",this.TPersistent,(function(){this.$init=function(){t.TPersistent.$init.call(this),this.FOwnerInterface=null},this.$final=function(){rtl.setIntfP(this,"FOwnerInterface",null),t.TPersistent.$final.call(this)},this._AddRef=function(){var t=0;return t=-1,null!=this.FOwnerInterface&&(t=this.FOwnerInterface._AddRef()),t},this._Release=function(){var t=0;return t=-1,null!=this.FOwnerInterface&&(t=this.FOwnerInterface._Release()),t},this.QueryInterface=function(t,e){var i=0;return i=-2147467262,this.GetInterface(t,e)&&(i=0),i},this.AfterConstruction=function(){try{pas.System.TObject.AfterConstruction.call(this),null!==this.GetOwner()&&this.GetOwner().GetInterface(rtl.getIntfGUIDR(pas.System.IUnknown),{p:this,get:function(){return this.p.FOwnerInterface},set:function(t){this.p.FOwnerInterface=t}})}finally{rtl._Release(this.FOwnerInterface)}},rtl.addIntf(this,pas.System.IUnknown)})),this.$rtti.$Class("TStrings"),rtl.createClass(this,"TStringsEnumerator",pas.System.TObject,(function(){this.$init=function(){pas.System.TObject.$init.call(this),this.FStrings=null,this.FPosition=0},this.$final=function(){this.FStrings=void 0,pas.System.TObject.$final.call(this)},this.Create$1=function(t){return pas.System.TObject.Create.call(this),this.FStrings=t,this.FPosition=-1,this},this.GetCurrent=function(){return this.FStrings.Get(this.FPosition)},this.MoveNext=function(){return this.FPosition+=1,this.FPosition<this.FStrings.GetCount()}})),rtl.createClass(this,"TStrings",this.TPersistent,(function(){this.$init=function(){t.TPersistent.$init.call(this),this.FSpecialCharsInited=!1,this.FAlwaysQuote=!1,this.FQuoteChar="",this.FDelimiter="",this.FNameValueSeparator="",this.FUpdateCount=0,this.FLBS=0,this.FSkipLastLineBreak=!1,this.FStrictDelimiter=!1,this.FLineBreak=""},this.GetValue=function(t){var e,i="",s="";return i="",-1!==(e=this.IndexOfName(t))&&this.GetNameValue(e,{get:function(){return s},set:function(t){s=t}},{get:function(){return i},set:function(t){i=t}}),i},this.SetDelimiter=function(t){this.CheckSpecialChars(),this.FDelimiter=t},this.SetQuoteChar=function(t){this.CheckSpecialChars(),this.FQuoteChar=t},this.DoSetTextStr=function(t,e){var i="",s=0;try{for(this.BeginUpdate(),e&&this.Clear(),s=1;this.GetNextLinebreak(t,{get:function(){return i},set:function(t){i=t}},{get:function(){return s},set:function(t){s=t}});)this.Add(i)}finally{this.EndUpdate()}},this.GetDelimiter=function(){return this.CheckSpecialChars(),this.FDelimiter},this.GetNameValueSeparator=function(){return this.CheckSpecialChars(),this.FNameValueSeparator},this.GetQuoteChar=function(){return this.CheckSpecialChars(),this.FQuoteChar},this.SetLineBreak=function(t){this.CheckSpecialChars(),this.FLineBreak=t},this.GetSkipLastLineBreak=function(){return this.CheckSpecialChars(),this.FSkipLastLineBreak},this.SetSkipLastLineBreak=function(t){this.CheckSpecialChars(),this.FSkipLastLineBreak=t},this.ReadData=function(t){t.ReadListBegin(),this.BeginUpdate();try{for(this.Clear();!t.EndOfList();)this.Add(t.ReadString())}finally{this.EndUpdate()}t.ReadListEnd()},this.WriteData=function(t){var e=0;t.WriteListBegin();for(var i=0,s=this.GetCount()-1;i<=s;i++)e=i,t.WriteString(this.Get(e));t.WriteListEnd()},this.DefineProperties=function(e){var i=!1;i=null!=e.FAncestor?!e.FAncestor.$class.InheritsFrom(t.TStrings)||!this.Equals$2(e.FAncestor):this.GetCount()>0,e.DefineProperty("Strings",rtl.createCallback(this,"ReadData"),rtl.createCallback(this,"WriteData"),i)},this.Error=function(e,i){throw t.EStringListError.$create("CreateFmt",[e,pas.System.VarRecs(18,pas.SysUtils.IntToStr(i))])},this.GetCapacity=function(){return this.GetCount()},this.GetObject=function(t){return null,null},this.GetTextStr=function(){var t="",e=0,i="";if(this.CheckSpecialChars(),this.FLineBreak!==pas.System.sLineBreak)i=this.FLineBreak;else{var s=this.FLBS;0===s?i="\n":1===s?i="\r\n":2===s&&(i="\r")}t="";for(var o=0,n=this.GetCount()-1;o<=n;o++)e=o,t+=this.Get(e),(e<this.GetCount()-1||!this.GetSkipLastLineBreak())&&(t+=i);return t},this.Put=function(t,e){var i;i=this.GetObject(t),this.Delete(t),this.InsertObject(t,e,i)},this.PutObject=function(t,e){},this.SetTextStr=function(t){this.CheckSpecialChars(),this.DoSetTextStr(t,!0)},this.SetUpdateState=function(t){},this.DoCompareText=function(t,e){return pas.SysUtils.CompareText(t,e)},this.GetDelimitedText=function(){var t="",e=0,i="",s="";this.CheckSpecialChars(),t="",i=this.GetQuoteChar()+"|"+this.GetDelimiter(),this.FStrictDelimiter||(i=" |"+i),i="/"+i+"/";for(var o=0,n=this.GetCount()-1;o<=n;o++)e=o,s=this.Get(e),t+=this.FAlwaysQuote||-1!==s.search(i)?pas.SysUtils.QuoteString(s,this.GetQuoteChar()):s,e<this.GetCount()-1&&(t+=this.GetDelimiter());return 0===t.length&&1===this.GetCount()&&(t=this.GetQuoteChar()+this.GetQuoteChar()),t},this.SetDelimitedText=function(t){var e=0,i=0,s=!1;this.CheckSpecialChars(),this.BeginUpdate(),e=1,i=1,s=!1;try{if(this.Clear(),this.FStrictDelimiter)for(;e<=t.length;){if(s&&e<=t.length&&t.charAt(e-1)===this.FDelimiter&&(e+=1),e<=t.length)if(t.charAt(e-1)===this.FQuoteChar){for(i=e+1;i<=t.length&&(t.charAt(i-1)!==this.FQuoteChar||i+1<=t.length&&t.charAt(i+1-1)===this.FQuoteChar);)i<=t.length&&t.charAt(i-1)===this.FQuoteChar?i+=2:i+=1;this.Add(pas.SysUtils.StringReplace(pas.System.Copy(t,e+1,i-e-1),this.FQuoteChar+this.FQuoteChar,this.FQuoteChar,rtl.createSet(0))),e=i+1}else{for(i=e;i<=t.length&&t.charAt(i-1)!==this.FDelimiter;)i+=1;this.Add(pas.System.Copy(t,e,i-e)),e=i}else s&&this.Add("");s=!0}else for(;e<=t.length;){for(s&&e<=t.length&&t.charAt(e-1)===this.FDelimiter&&(e+=1);e<=t.length&&t.charCodeAt(e-1)<=32;)e+=1;if(e<=t.length)if(t.charAt(e-1)===this.FQuoteChar){for(i=e+1;i<=t.length&&(t.charAt(i-1)!==this.FQuoteChar||i+1<=t.length&&t.charAt(i+1-1)===this.FQuoteChar);)i<=t.length&&t.charAt(i-1)===this.FQuoteChar?i+=2:i+=1;this.Add(pas.SysUtils.StringReplace(pas.System.Copy(t,e+1,i-e-1),this.FQuoteChar+this.FQuoteChar,this.FQuoteChar,rtl.createSet(0))),e=i+1}else{for(i=e;i<=t.length&&t.charCodeAt(i-1)>32&&t.charAt(i-1)!==this.FDelimiter;)i+=1;this.Add(pas.System.Copy(t,e,i-e)),e=i}else s&&this.Add("");for(;e<=t.length&&t.charCodeAt(e-1)<=32;)e+=1;s=!0}}finally{this.EndUpdate()}},this.CheckSpecialChars=function(){this.FSpecialCharsInited||(this.FQuoteChar='"',this.FDelimiter=",",this.FNameValueSeparator="=",this.FLBS=pas.System.DefaultTextLineBreakStyle,this.FSpecialCharsInited=!0,this.FLineBreak=pas.System.sLineBreak)},this.GetNextLinebreak=function(t,e,i){var s,o,n=!1,r=0,a=0;return e.set(""),n=!1,t.length-i.get()<0?n:(s=t.indexOf("\n",i.get()-1)+1,o=t.indexOf("\r",i.get()-1)+1,a=1,s>0&&o>0?(s-o==1&&(a=2),r=s<o?s:o):r=s>0&&o<1?s:o>0&&s<1?o:t.length+1,e.set(pas.System.Copy(t,i.get(),r-i.get())),i.set(r+a),n=!0)},this.Create$1=function(){return pas.System.TObject.Create.call(this),this.FAlwaysQuote=!1,this},this.Destroy=function(){pas.System.TObject.Destroy.call(this)},this.Add=function(t){var e;return e=this.GetCount(),this.Insert(this.GetCount(),t),e},this.AddObject=function(t,e){var i;return i=this.Add(t),this.PutObject(i,e),i},this.AddStrings=function(t){for(var e=0,i=0,s=t.GetCount()-1;i<=s;i++)e=i,this.AddObject(t.Get(e),t.GetObject(e))},this.Assign=function(e){var i=null;if(t.TStrings.isPrototypeOf(e)){i=e,this.BeginUpdate();try{this.Clear(),this.FSpecialCharsInited=i.FSpecialCharsInited,this.FQuoteChar=i.FQuoteChar,this.FDelimiter=i.FDelimiter,this.FNameValueSeparator=i.FNameValueSeparator,this.FLBS=i.FLBS,this.FLineBreak=i.FLineBreak,this.AddStrings(i)}finally{this.EndUpdate()}}else t.TPersistent.Assign.call(this,e)},this.BeginUpdate=function(){0===this.FUpdateCount&&this.SetUpdateState(!0),this.FUpdateCount+=1},this.EndUpdate=function(){this.FUpdateCount>0&&(this.FUpdateCount-=1),0===this.FUpdateCount&&this.SetUpdateState(!1)},this.Equals=function(e){return t.TStrings.isPrototypeOf(e)?this.Equals$2(e):pas.System.TObject.Equals.call(this,e)},this.Equals$2=function(t){var e,i=!1,s=0;if(i=!1,(e=this.GetCount())!==t.GetCount())return i;for(var o=0,n=e-1;o<=n;o++)if(s=o,this.Get(s)!==t.Get(s))return i;return i=!0},this.GetEnumerator=function(){return t.TStringsEnumerator.$create("Create$1",[this])},this.IndexOf=function(t){var e=0;for(e=0;e<this.GetCount()&&0!==this.DoCompareText(this.Get(e),t);)e+=1;return e===this.GetCount()&&(e=-1),e},this.IndexOfName=function(t){var e=0,i=0,s="";for(this.CheckSpecialChars(),e=0;e<this.GetCount();){if(s=this.Get(e),(i=pas.System.Pos(this.FNameValueSeparator,s)-1)>=0&&0===this.DoCompareText(t,pas.System.Copy(s,1,i)))return e;e+=1}return e=-1},this.InsertObject=function(t,e,i){this.Insert(t,e),this.PutObject(t,i)},this.GetNameValue=function(t,e,i){var s;this.CheckSpecialChars(),i.set(this.Get(t)),0!==(s=pas.System.Pos(this.FNameValueSeparator,i.get()))?(e.set(pas.System.Copy(i.get(),1,s-1)),i.set(pas.System.Copy(i.get(),s+1,i.get().length-s))):e.set("")}})),rtl.recNewT(this,"TStringItem",(function(){this.FString="",this.FObject=null,this.$eq=function(t){return this.FString===t.FString&&this.FObject===t.FObject},this.$assign=function(t){return this.FString=t.FString,this.FObject=t.FObject,this}})),this.$rtti.$Class("TStringList"),this.TStringsSortStyle={0:"sslNone",sslNone:0,1:"sslUser",sslUser:1,2:"sslAuto",sslAuto:2},rtl.createClass(this,"TStringList",this.TStrings,(function(){this.$init=function(){t.TStrings.$init.call(this),this.FList=[],this.FCount=0,this.FOnChange=null,this.FOnChanging=null,this.FDuplicates=0,this.FCaseSensitive=!1,this.FForceSort=!1,this.FOwnsObjects=!1,this.FSortStyle=0},this.$final=function(){this.FList=void 0,this.FOnChange=void 0,this.FOnChanging=void 0,t.TStrings.$final.call(this)},this.ExchangeItemsInt=function(t,e){var i,s;i=this.FList[t].FString,s=this.FList[t].FObject,this.FList[t].FString=this.FList[e].FString,this.FList[t].FObject=this.FList[e].FObject,this.FList[e].FString=i,this.FList[e].FObject=s},this.GetSorted=function(){return this.FSortStyle in rtl.createSet(1,2)},this.Grow=function(){var t=0;(t=this.GetCapacity())>=256?t+=rtl.trunc(t/4):0===t?t=4:t*=4,this.SetCapacity(t)},this.InternalClear=function(t,e){var i=0;if(t<this.FCount){if(this.FOwnsObjects)for(var s=t,o=this.FCount-1;s<=o;s++)i=s,this.FList[i].FString="",pas.SysUtils.FreeAndNil({p:this.FList[i],get:function(){return this.p.FObject},set:function(t){this.p.FObject=t}});else for(var n=t,r=this.FCount-1;n<=r;n++)i=n,this.FList[i].FString="";this.FCount=t}e||this.SetCapacity(0)},this.QuickSort=function(t,e,i){var s=0,o=0,n=0;if(e-t<=1)t<e&&i(this,t,e)>0&&this.ExchangeItems(t,e);else{for(o=t,n=e,s=t+pas.System.Random(e-t);o<n;){for(;o<s&&i(this,o,s)<=0;)o+=1;for(;n>s&&i(this,n,s)>0;)n-=1;this.ExchangeItems(o,n),s===o?s=n:s===n&&(s=o)}s-1>=t&&this.QuickSort(t,s-1,i),s+1<=e&&this.QuickSort(s+1,e,i)}},this.SetSorted=function(t){t?this.SetSortStyle(2):this.SetSortStyle(0)},this.SetCaseSensitive=function(t){if(t!==this.FCaseSensitive&&(this.FCaseSensitive=t,2===this.FSortStyle)){this.FForceSort=!0;try{this.Sort()}finally{this.FForceSort=!1}}},this.SetSortStyle=function(t){this.FSortStyle!==t&&(2===t&&this.Sort(),this.FSortStyle=t)},this.CheckIndex=function(t){(t<0||t>=this.FCount)&&this.Error(rtl.getResStr(pas.RTLConsts,"SListIndexError"),t)},this.ExchangeItems=function(t,e){this.ExchangeItemsInt(t,e)},this.Changed=function(){0===this.FUpdateCount&&null!=this.FOnChange&&this.FOnChange(this)},this.Changing=function(){0===this.FUpdateCount&&null!=this.FOnChanging&&this.FOnChanging(this)},this.Get=function(t){return this.CheckIndex(t),this.FList[t].FString},this.GetCapacity=function(){return rtl.length(this.FList)},this.GetCount=function(){return this.FCount},this.GetObject=function(t){return this.CheckIndex(t),this.FList[t].FObject},this.Put=function(t,e){this.GetSorted()&&this.Error(rtl.getResStr(pas.RTLConsts,"SSortedListError"),0),this.CheckIndex(t),this.Changing(),this.FList[t].FString=e,this.Changed()},this.PutObject=function(t,e){this.CheckIndex(t),this.Changing(),this.FList[t].FObject=e,this.Changed()},this.SetCapacity=function(e){e<0&&this.Error(rtl.getResStr(pas.RTLConsts,"SListCapacityError"),e),e!==this.GetCapacity()&&(this.FList=rtl.arraySetLength(this.FList,t.TStringItem,e))},this.SetUpdateState=function(t){t?this.Changing():this.Changed()},this.InsertItem=function(t,e){this.InsertItem$1(t,e,null)},this.InsertItem$1=function(e,i,s){var o=t.TStringItem.$new();this.Changing(),this.FCount===this.GetCapacity()&&this.Grow(),o.FString=i,o.FObject=s,this.FList.splice(e,0,o),this.FCount+=1,this.Changed()},this.DoCompareText=function(t,e){return this.FCaseSensitive?pas.SysUtils.CompareStr(t,e):pas.SysUtils.CompareText(t,e)},this.Destroy=function(){this.InternalClear(0,!1),t.TStrings.Destroy.call(this)},this.Add=function(t){var e=0;if(2!==this.FSortStyle)e=this.FCount;else if(this.Find(t,{get:function(){return e},set:function(t){e=t}})){var i=this.FDuplicates;if(0===i)return e;2===i&&this.Error(rtl.getResStr(pas.RTLConsts,"SDuplicateString"),0)}return this.InsertItem(e,t),e},this.Clear=function(){0!==this.FCount&&(this.Changing(),this.InternalClear(0,!1),this.Changed())},this.Delete=function(t){this.CheckIndex(t),this.Changing(),this.FOwnsObjects&&pas.SysUtils.FreeAndNil({p:this.FList[t],get:function(){return this.p.FObject},set:function(t){this.p.FObject=t}}),this.FList.splice(t,1),this.FList[this.GetCount()-1].FString="",this.FList[this.GetCount()-1].FObject=null,this.FCount-=1,this.Changed()},this.Find=function(e,i){var s=!1,o=0,n=0,r=0,a=0;if(s=!1,i.set(-1),!this.GetSorted())throw t.EListError.$create("Create$1",[rtl.getResStr(pas.RTLConsts,"SErrFindNeedsSortedList")]);for(o=0,n=this.GetCount()-1;o<=n;)r=o+rtl.trunc((n-o)/2),(a=this.DoCompareText(e,this.FList[r].FString))>0?o=r+1:(n=r-1,0===a&&(s=!0,1!==this.FDuplicates&&(o=r)));return i.set(o),s},this.IndexOf=function(e){var i=0;return this.GetSorted()?this.Find(e,{get:function(){return i},set:function(t){i=t}})||(i=-1):i=t.TStrings.IndexOf.call(this,e),i},this.Insert=function(t,e){2===this.FSortStyle?this.Error(rtl.getResStr(pas.RTLConsts,"SSortedListError"),0):((t<0||t>this.FCount)&&this.Error(rtl.getResStr(pas.RTLConsts,"SListIndexError"),t),this.InsertItem(t,e))},this.Sort=function(){this.CustomSort(e.StringListAnsiCompare)},this.CustomSort=function(t){(this.FForceSort||2!==this.FSortStyle)&&this.FCount>1&&(this.Changing(),this.QuickSort(0,this.FCount-1,t),this.Changed())}})),rtl.createClass(this,"TCollectionItem",this.TPersistent,(function(){this.$init=function(){t.TPersistent.$init.call(this),this.FCollection=null,this.FID=0},this.$final=function(){this.FCollection=void 0,t.TPersistent.$final.call(this)},this.GetIndex=function(){return null!=this.FCollection?this.FCollection.FItems.IndexOf(this):-1},this.SetCollection=function(t){t!==this.FCollection&&(null!=this.FCollection&&this.FCollection.RemoveItem(this),null!=t&&t.InsertItem(this))},this.Changed=function(t){null!==this.FCollection&&0===this.FCollection.FUpdateCount&&(t?this.FCollection.Update(null):this.FCollection.Update(this))},this.GetOwner=function(){return this.FCollection},this.SetIndex=function(t){var e;(e=this.GetIndex())>-1&&e!==t&&(this.FCollection.FItems.Move(e,t),this.Changed(!0))},this.SetDisplayName=function(t){this.Changed(!1)},this.Create$1=function(t){return pas.System.TObject.Create.call(this),this.SetCollection(t),this},this.Destroy=function(){this.SetCollection(null),pas.System.TObject.Destroy.call(this)}})),this.TCollectionNotification={0:"cnAdded",cnAdded:0,1:"cnExtracting",cnExtracting:1,2:"cnDeleting",cnDeleting:2},rtl.createClass(this,"TCollection",this.TPersistent,(function(){this.$init=function(){t.TPersistent.$init.call(this),this.FItemClass=null,this.FItems=null,this.FUpdateCount=0,this.FNextID=0,this.FPropName=""},this.$final=function(){this.FItemClass=void 0,this.FItems=void 0,t.TPersistent.$final.call(this)},this.GetCount=function(){return this.FItems.FCount},this.InsertItem=function(t){this.FItemClass.isPrototypeOf(t)&&(this.FItems.Add(t),t.FCollection=this,t.FID=this.FNextID,this.FNextID+=1,this.SetItemName(t),this.Notify(t,0),this.Changed())},this.RemoveItem=function(t){var e;this.Notify(t,1),-1!==(e=this.FItems.IndexOfItem(t,1))&&this.FItems.Delete(e),t.FCollection=null,this.Changed()},this.DoClear=function(){for(var t=null;this.FItems.FCount>0;)null!=(t=rtl.getObject(this.FItems.Last()))&&t.$destroy("Destroy")},this.Changed=function(){0===this.FUpdateCount&&this.Update(null)},this.GetItem=function(t){return rtl.getObject(this.FItems.Get(t))},this.SetItemName=function(t){},this.Update=function(t){},this.Notify=function(t,e){},this.Create$1=function(e){return pas.System.TObject.Create.call(this),this.FItemClass=e,this.FItems=t.TFPList.$create("Create"),this},this.Destroy=function(){this.FUpdateCount=1;try{this.DoClear()}finally{this.FUpdateCount=0}null!=this.FItems&&this.FItems.$destroy("Destroy"),pas.System.TObject.Destroy.call(this)},this.Owner=function(){return this.GetOwner()},this.Add=function(){return this.FItemClass.$create("Create$1",[this])},this.Assign=function(e){var i=0;if(t.TCollection.isPrototypeOf(e)){this.Clear();for(var s=0,o=e.GetCount()-1;s<=o;s++)i=s,this.Add().Assign(e.GetItem(i))}else t.TPersistent.Assign.call(this,e)},this.BeginUpdate=function(){this.FUpdateCount+=1},this.Clear=function(){if(0!==this.FItems.FCount){this.BeginUpdate();try{this.DoClear()}finally{this.EndUpdate()}}},this.EndUpdate=function(){this.FUpdateCount>0&&(this.FUpdateCount-=1),0===this.FUpdateCount&&this.Changed()},this.Delete=function(t){var e=null;e=rtl.getObject(this.FItems.Get(t)),this.Notify(e,2),null!=e&&e.$destroy("Destroy")},this.Insert=function(t){var e=null;return(e=this.Add()).SetIndex(t),e}})),rtl.createClass(this,"TOwnedCollection",this.TCollection,(function(){this.$init=function(){t.TCollection.$init.call(this),this.FOwner=null},this.$final=function(){this.FOwner=void 0,t.TCollection.$final.call(this)},this.GetOwner=function(){return this.FOwner},this.Create$2=function(e,i){return this.FOwner=e,t.TCollection.Create$1.call(this,i),this}})),this.$rtti.$Class("TComponent"),this.TOperation={0:"opInsert",opInsert:0,1:"opRemove",opRemove:1},this.TComponentStateItem={0:"csLoading",csLoading:0,1:"csReading",csReading:1,2:"csWriting",csWriting:2,3:"csDestroying",csDestroying:3,4:"csDesigning",csDesigning:4,5:"csAncestor",csAncestor:5,6:"csUpdating",csUpdating:6,7:"csFixups",csFixups:7,8:"csFreeNotification",csFreeNotification:8,9:"csInline",csInline:9,10:"csDesignInstance",csDesignInstance:10},this.TComponentStyleItem={0:"csInheritable",csInheritable:0,1:"csCheckPropAvail",csCheckPropAvail:1,2:"csSubComponent",csSubComponent:2,3:"csTransient",csTransient:3},rtl.createClass(this,"TComponent",this.TPersistent,(function(){this.$init=function(){t.TPersistent.$init.call(this),this.FOwner=null,this.FName="",this.FTag=0,this.FComponents=null,this.FFreeNotifies=null,this.FDesignInfo=0,this.FComponentState={},this.FComponentStyle={},this.FLeft=0,this.FTop=0},this.$final=function(){this.FOwner=void 0,this.FComponents=void 0,this.FFreeNotifies=void 0,this.FComponentState=void 0,this.FComponentStyle=void 0,t.TPersistent.$final.call(this)},this.GetComponent=function(t){return null==this.FComponents?null:rtl.getObject(this.FComponents.Get(t))},this.GetComponentCount=function(){return null==this.FComponents?0:this.FComponents.FCount},this.GetComponentIndex=function(){return null!=this.FOwner&&null!=this.FOwner.FComponents?this.FOwner.FComponents.IndexOf(this):-1},this.Insert=function(e){null==this.FComponents&&(this.FComponents=t.TFPList.$create("Create")),this.FComponents.Add(e),e.FOwner=this},this.ReadLeft=function(t){this.FDesignInfo=4294901760&this.FDesignInfo|65535&t.ReadInteger()},this.ReadTop=function(t){this.FDesignInfo=(65535&t.ReadInteger())<<16|65535&this.FDesignInfo},this.Remove=function(t){t.FOwner=null,null!=this.FComponents&&(this.FComponents.Remove(t),0===this.FComponents.FCount&&(this.FComponents.$destroy("Destroy"),this.FComponents=null))},this.RemoveNotification=function(t){null!==this.FFreeNotifies&&(this.FFreeNotifies.Remove(t),0===this.FFreeNotifies.FCount&&(this.FFreeNotifies.$destroy("Destroy"),this.FFreeNotifies=null,this.FComponentState=rtl.excludeSet(this.FComponentState,8)))},this.SetReference=function(t){var e=null,i=null,s=null;""!==this.FName&&null!=this.FOwner&&(s=this.FOwner,null!=(e=this.FOwner.$class.FieldAddress(this.FName))&&(i=t?this:null,s[""+e.name]=i))},this.WriteLeft=function(t){t.WriteInteger(65535&this.FDesignInfo)},this.WriteTop=function(t){t.WriteInteger(this.FDesignInfo>>>16&65535)},this.ChangeName=function(t){this.FName=t},this.DefineProperties=function(t){var e,i=0;i=null!=(e=t.FAncestor)?e.FDesignInfo:0,t.DefineProperty("Left",rtl.createCallback(this,"ReadLeft"),rtl.createCallback(this,"WriteLeft"),(65535&this.FDesignInfo)!=(65535&i)),t.DefineProperty("Top",rtl.createCallback(this,"ReadTop"),rtl.createCallback(this,"WriteTop"),(4294901760&this.FDesignInfo)!=(4294901760&i))},this.GetChildren=function(t,e){},this.GetOwner=function(){return this.FOwner},this.Loaded=function(){this.FComponentState=rtl.excludeSet(this.FComponentState,0)},this.Loading=function(){this.FComponentState=rtl.includeSet(this.FComponentState,0)},this.Notification=function(t,e){var i=0;if(1===e&&this.RemoveFreeNotification(t),null!=this.FComponents)for(i=this.FComponents.FCount-1;i>=0;)rtl.getObject(this.FComponents.Get(i)).Notification(t,e),(i-=1)>=this.FComponents.FCount&&(i=this.FComponents.FCount-1)},this.SetDesigning=function(t,e){var i=0;if(this.FComponentState=t?rtl.includeSet(this.FComponentState,4):rtl.excludeSet(this.FComponentState,4),null!=this.FComponents&&e)for(var s=0,o=this.FComponents.FCount-1;s<=o;s++)i=s,rtl.getObject(this.FComponents.Get(i)).SetDesigning(t,!0)},this.SetName=function(e){if(this.FName!==e){if(""!==e&&!pas.SysUtils.IsValidIdent(e,!1,!1))throw t.EComponentError.$create("CreateFmt",[rtl.getResStr(pas.RTLConsts,"SInvalidName"),pas.System.VarRecs(18,e)]);null!=this.FOwner?this.FOwner.ValidateRename(this,this.FName,e):this.ValidateRename(null,this.FName,e),this.SetReference(!1),this.ChangeName(e),this.SetReference(!0)}},this.SetChildOrder=function(t,e){},this.SetParentComponent=function(t){},this.ValidateRename=function(e,i,s){if(null!==e&&0!==pas.SysUtils.CompareText(i,s)&&e.FOwner===this&&null!==this.FindComponent(s))throw t.EComponentError.$create("CreateFmt",[rtl.getResStr(pas.RTLConsts,"SDuplicateName"),pas.System.VarRecs(18,s)]);4 in this.FComponentState&&null!==this.FOwner&&this.FOwner.ValidateRename(e,i,s)},this.ValidateContainer=function(t){t.ValidateInsert(this)},this.ValidateInsert=function(t){},this._AddRef=function(){return-1,-1},this.GetLeft=function(){return this.FLeft},this.GetTop=function(){return this.FTop},this.SetLeft=function(t){this.FLeft=t},this.SetTop=function(t){this.FTop=t},this._Release=function(){return-1,-1},this.Create$1=function(t){return this.FComponentStyle=rtl.createSet(0),null!=t&&t.InsertComponent(this),this},this.Destroy=function(){var t=0,e=null;if(this.Destroying(),null!=this.FFreeNotifies){for(t=this.FFreeNotifies.FCount-1;t>=0;)e=rtl.getObject(this.FFreeNotifies.Get(t)),this.FFreeNotifies.Delete(t),e.Notification(this,1),null===this.FFreeNotifies?t=0:t>this.FFreeNotifies.FCount&&(t=this.FFreeNotifies.FCount),t-=1;pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FFreeNotifies},set:function(t){this.p.FFreeNotifies=t}})}this.DestroyComponents(),null!==this.FOwner&&this.FOwner.RemoveComponent(this),pas.System.TObject.Destroy.call(this)},this.BeforeDestruction=function(){3 in this.FComponentState||this.Destroying()},this.DestroyComponents=function(){for(var t=null;null!=this.FComponents;)t=rtl.getObject(this.FComponents.Last()),this.Remove(t),t.$destroy("Destroy")},this.Destroying=function(){var t=0;if(!(3 in this.FComponentState)&&(this.FComponentState=rtl.includeSet(this.FComponentState,3),null!=this.FComponents))for(var e=0,i=this.FComponents.FCount-1;e<=i;e++)t=e,rtl.getObject(this.FComponents.Get(t)).Destroying()},this.QueryInterface=function(t,e){return this.GetInterface(t,e)?0:-2147467262},this.AfterLoadDFMValues=function(){this.EndUpdate(),this.Loaded()},this.BeforeLoadDFMValues=function(){4 in this.FComponentState||this.Loading(),this.BeginUpdate()},this.BeginUpdate=function(){},this.EndUpdate=function(){},this.WriteState=function(t){t.WriteComponentData(this)},this.FindComponent=function(t){var e=null,i=0;if(e=null,""===t||null==this.FComponents)return e;for(var s=0,o=this.FComponents.FCount-1;s<=o;s++)if(i=s,0===pas.SysUtils.CompareText(rtl.getObject(this.FComponents.Get(i)).FName,t))return e=rtl.getObject(this.FComponents.Get(i));return e},this.FreeNotification=function(e){null!==this.FOwner&&e===this.FOwner||(null==this.FFreeNotifies&&(this.FFreeNotifies=t.TFPList.$create("Create")),-1===this.FFreeNotifies.IndexOf(e)&&(this.FFreeNotifies.Add(e),e.FreeNotification(this)))},this.RemoveFreeNotification=function(t){this.RemoveNotification(t),t.RemoveNotification(this)},this.GetParentComponent=function(){return null,null},this.HasParent=function(){return!1,!1},this.InsertComponent=function(t){t.ValidateContainer(this),this.ValidateRename(t,"",t.FName),null!==t.FOwner&&t.FOwner.RemoveComponent(t),this.Insert(t),4 in this.FComponentState&&t.SetDesigning(!0,!0),this.Notification(t,0)},this.RemoveComponent=function(t){this.Notification(t,1),this.Remove(t),t.SetDesigning(!1,!0),this.ValidateRename(t,t.FName,"")},rtl.addIntf(this,pas.System.IUnknown);var e=this.$rtti;e.addProperty("Name",6,rtl.string,"FName","SetName"),e.addProperty("Tag",0,rtl.nativeint,"FTag","FTag",{Default:0})})),this.TSeekOrigin={0:"soBeginning",soBeginning:0,1:"soCurrent",soCurrent:1,2:"soEnd",soEnd:2},rtl.createClass(this,"TStream",pas.System.TObject,(function(){this.$init=function(){pas.System.TObject.$init.call(this),this.FEndian=0},this.MakeInt=function(t,e,i){var s,o,n=0,r=null;if(o=0===this.FEndian,s=new ArrayBuffer(rtl.length(t)),new Uint8Array(s).set(t),r=new DataView(s),i){var a=e;1===a?n=r.getInt8(0):2===a?n=r.getInt16(0,o):4===a?n=r.getInt32(0,o):8===a&&(n=Math.round(r.getFloat64(0,o)))}else{var l=e;1===l?n=r.getUint8(0):2===l?n=r.getUint16(0,o):4===l?n=r.getUint32(0,o):8===l&&(n=Math.round(r.getFloat64(0,o)))}return n},this.MakeBytes=function(e,i,s){var o,n,r,a=[],l=null;if(r=0===this.FEndian,o=new ArrayBuffer(i),l=new DataView(o),s){var h=i;1===h?l.setInt8(0,e):2===h?l.setInt16(0,e,r):4===h?l.setInt32(0,e,r):8===h&&l.setFloat64(0,e,r)}else{var F=i;1===F?l.setUint8(0,e):2===F?l.setUint16(0,e,r):4===F?l.setUint32(0,e,r):8===F&&l.setFloat64(0,e,r)}return a=rtl.arraySetLength(a,0,i),n=new Uint8Array(o),a=t.TMemoryStream.MemoryToBytes$1(n)},this.GetPosition=function(){return this.Seek(0,1)},this.SetPosition=function(t){this.Seek(t,0)},this.GetSize=function(){var t,e;return e=this.Seek(0,1),t=this.Seek(0,2),this.Seek(e,0),t},this.ReadMaxSizeData=function(t,e,i){var s=0,o=0;return i<=e?s=this.Read({get:function(){return t},set:function(e){t=e}},i):(s=this.Read({get:function(){return t},set:function(e){t=e}},e),o=this.GetPosition(),s=s+this.Seek(i-e,1)-o),s},this.WriteMaxSizeData=function(t,e,i){var s=0,o=0;return i<=e?s=this.Write(t,i):(s=this.Write(t,e),o=this.GetPosition(),s=s+this.Seek(i-e,1)-o),s},this.Read=function(t,e){return this.Read$1(rtl.arrayRef(t.get()),0,e)},this.Write=function(t,e){return this.Write$1(t,0,e)},this.ReadData$4=function(t,e){var i,s=0;return 2===(i=this.ReadData$12({get:function(){return s},set:function(t){s=t}},e))&&t.set(String.fromCharCode(s)),i},this.ReadData$8=function(t,e){var i,s=[];return s=rtl.arraySetLength(s,0,e),(i=this.ReadMaxSizeData(rtl.arrayRef(s),1,e))>=1&&t.set(this.MakeInt(rtl.arrayRef(s),1,!1)),i},this.ReadData$12=function(t,e){var i,s=[];return s=rtl.arraySetLength(s,0,e),(i=this.ReadMaxSizeData(rtl.arrayRef(s),2,e))>=2&&t.set(this.MakeInt(rtl.arrayRef(s),2,!1)),i},this.ReadData$14=function(t,e){var i,s=[];return s=rtl.arraySetLength(s,0,e),(i=this.ReadMaxSizeData(rtl.arrayRef(s),4,e))>=4&&t.set(this.MakeInt(rtl.arrayRef(s),4,!0)),i},this.ReadData$16=function(t,e){var i,s=[];return s=rtl.arraySetLength(s,0,e),(i=this.ReadMaxSizeData(rtl.arrayRef(s),4,e))>=4&&t.set(this.MakeInt(rtl.arrayRef(s),4,!1)),i},this.ReadData$18=function(t,e){var i,s=[];return s=rtl.arraySetLength(s,0,e),(i=this.ReadMaxSizeData(rtl.arrayRef(s),8,8))>=8&&t.set(this.MakeInt(rtl.arrayRef(s),8,!0)),i},this.ReadData$22=function(t,e){var i,s=[],o=null,n=null;return s=rtl.arraySetLength(s,0,e),(i=this.ReadMaxSizeData(rtl.arrayRef(s),8,e))>=8&&(o=new ArrayBuffer(8),new Uint8Array(o).set(s),n=new DataView(o),t.set(n.getFloat64(0))),i},this.ReadBuffer=function(t,e){this.ReadBuffer$1(t,0,e)},this.ReadBuffer$1=function(e,i,s){if(this.Read$1(rtl.arrayRef(e.get()),i,s)!==s)throw t.EStreamError.$create("Create$1",[rtl.getResStr(t,"SReadError")])},this.ReadBufferData$2=function(t){this.ReadBufferData$3(t,2)},this.ReadBufferData$3=function(e,i){if(this.ReadData$4(e,i)!==i)throw t.EStreamError.$create("Create$1",[rtl.getResStr(t,"SReadError")])},this.ReadBufferData$6=function(t){this.ReadBufferData$7(t,1)},this.ReadBufferData$7=function(e,i){if(this.ReadData$8(e,i)!==i)throw t.EStreamError.$create("Create$1",[rtl.getResStr(t,"SReadError")])},this.ReadBufferData$10=function(t){this.ReadBufferData$11(t,2)},this.ReadBufferData$11=function(e,i){if(this.ReadData$12(e,i)!==i)throw t.EStreamError.$create("Create$1",[rtl.getResStr(t,"SReadError")])},this.ReadBufferData$12=function(t){this.ReadBufferData$13(t,4)},this.ReadBufferData$13=function(e,i){if(this.ReadData$14(e,i)!==i)throw t.EStreamError.$create("Create$1",[rtl.getResStr(t,"SReadError")])},this.ReadBufferData$14=function(t){this.ReadBufferData$15(t,4)},this.ReadBufferData$15=function(e,i){if(this.ReadData$16(e,i)!==i)throw t.EStreamError.$create("Create$1",[rtl.getResStr(t,"SReadError")])},this.ReadBufferData$16=function(t){this.ReadBufferData$17(t,8)},this.ReadBufferData$17=function(e,i){if(this.ReadData$18(e,i)!==i)throw t.EStreamError.$create("Create$1",[rtl.getResStr(t,"SReadError")])},this.ReadBufferData$20=function(t){this.ReadBufferData$21(t,8)},this.ReadBufferData$21=function(e,i){if(this.ReadData$22(e,i)!==i)throw t.EStreamError.$create("Create$1",[rtl.getResStr(t,"SReadError")])},this.WriteBuffer=function(t,e){this.WriteBuffer$1(t,0,e)},this.WriteBuffer$1=function(e,i,s){if(this.Write$1(e,i,s)!==s)throw t.EStreamError.$create("Create$1",[rtl.getResStr(t,"SWriteError")])},this.WriteData$4=function(t,e){var i;return i=t.charCodeAt(),this.WriteData$12(i,e)},this.WriteData$6=function(t,e){return this.WriteMaxSizeData(this.MakeBytes(t,1,!0),1,e)},this.WriteData$8=function(t,e){return this.WriteMaxSizeData(this.MakeBytes(t,1,!1),1,e)},this.WriteData$12=function(t,e){return this.WriteMaxSizeData(this.MakeBytes(t,2,!0),2,e)},this.WriteData$16=function(t,e){return this.WriteMaxSizeData(this.MakeBytes(t,4,!1),4,e)},this.WriteData$18=function(t,e){return this.WriteMaxSizeData(this.MakeBytes(t,8,!0),8,e)},this.WriteData$22=function(t,e){var i,s,o=[],n=0;for(i=new ArrayBuffer(8),new DataView(i).setFloat64(0,t),o=rtl.arraySetLength(o,0,8),s=new Uint8Array(i),n=0;n<=7;n++)o[n]=s[n];return this.WriteMaxSizeData(o,8,e)},this.WriteBufferData$4=function(t){this.WriteBufferData$5(t,2)},this.WriteBufferData$5=function(e,i){if(this.WriteData$4(e,i)!==i)throw t.EStreamError.$create("Create$1",[rtl.getResStr(t,"SWriteError")])},this.WriteBufferData$6=function(t){this.WriteBufferData$7(t,1)},this.WriteBufferData$7=function(e,i){if(this.WriteData$6(e,i)!==i)throw t.EStreamError.$create("Create$1",[rtl.getResStr(t,"SWriteError")])},this.WriteBufferData$8=function(t){this.WriteBufferData$9(t,1)},this.WriteBufferData$9=function(e,i){if(this.WriteData$8(e,i)!==i)throw t.EStreamError.$create("Create$1",[rtl.getResStr(t,"SWriteError")])},this.WriteBufferData$12=function(t){this.WriteBufferData$13(t,2)},this.WriteBufferData$13=function(e,i){if(this.WriteData$12(e,i)!==i)throw t.EStreamError.$create("Create$1",[rtl.getResStr(t,"SWriteError")])},this.WriteBufferData$14=function(t){this.WriteBufferData$15(t,4)},this.WriteBufferData$15=function(e,i){if(this.WriteData$16(e,i)!==i)throw t.EStreamError.$create("Create$1",[rtl.getResStr(t,"SWriteError")])},this.WriteBufferData$16=function(t){this.WriteBufferData$17(t,8)},this.WriteBufferData$17=function(e,i){if(this.WriteData$18(e,i)!==i)throw t.EStreamError.$create("Create$1",[rtl.getResStr(t,"SWriteError")])},this.WriteBufferData$20=function(t){this.WriteBufferData$21(t,8)},this.WriteBufferData$21=function(e,i){if(this.WriteData$22(e,i)!==i)throw t.EStreamError.$create("Create$1",[rtl.getResStr(t,"SWriteError")])};this.CopyFrom=function(t,e){var i=0,s=[],o=0,n=0;if(i=0,0===e&&t.SetPosition(0),o=131072,e>0&&e<o&&(o=e),s=rtl.arraySetLength(s,0,o),0===e)do{(n=t.Read({get:function(){return s},set:function(t){s=t}},o))>0&&this.WriteBuffer(s,n),i+=n}while(!(n<o));else for(;e>0;)n=e>o?o:e,t.ReadBuffer({get:function(){return s},set:function(t){s=t}},n),this.WriteBuffer(s,n),e-=n,i+=n;return i},this.WriteComponent=function(t){this.WriteDescendent(t,null)},this.WriteDescendent=function(e,i){var s=null,o=null;s=t.TBinaryObjectWriter.$create("Create$1",[this]);try{o=t.TWriter.$create("Create$1",[s]);try{o.WriteDescendent(e,i)}finally{o.$destroy("Destroy")}}finally{s=rtl.freeLoc(s)}},this.ReadByte=function(){var t=0;return this.ReadBufferData$7({get:function(){return t},set:function(e){t=e}},1),t}})),rtl.createClass(this,"TCustomMemoryStream",this.TStream,(function(){this.$init=function(){t.TStream.$init.call(this),this.FMemory=null,this.FDataView=null,this.FDataArray=null,this.FSize=0,this.FPosition=0,this.FSizeBoundsSeek=!1},this.$final=function(){this.FMemory=void 0,this.FDataView=void 0,this.FDataArray=void 0,t.TStream.$final.call(this)},this.GetDataArray=function(){return null===this.FDataArray&&(this.FDataArray=new Uint8Array(this.FMemory)),this.FDataArray},this.GetDataView=function(){return null===this.FDataView&&(this.FDataView=new DataView(this.FMemory)),this.FDataView},this.GetSize=function(){return this.FSize},this.GetPosition=function(){return this.FPosition},this.SetPointer=function(t,e){this.FMemory=t,this.FSize=e,this.FDataView=null,this.FDataArray=null},this.MemoryToBytes=function(t){return this.MemoryToBytes$1(new Uint8Array(t))},this.MemoryToBytes$1=function(t){for(var e=[],i=0,s=0,o=t.length-1;s<=o;s++)e[i=s]=t[i];return e},this.BytesToMemory=function(t){var e;return e=new ArrayBuffer(rtl.length(t)),new Uint8Array(e).set(t),e},this.Read$1=function(t,e,i){var s=0,o=0,n=0,r=0;if(s=0,this.FSize>0&&this.FPosition<this.FSize&&this.FPosition>=0){for((s=i)>this.FSize-this.FPosition&&(s=this.FSize-this.FPosition),n=this.FPosition,r=e,o=0;o<s;)t[r]=this.GetDataView().getUint8(n),n+=1,r+=1,o+=1;this.FPosition=this.FPosition+s}return s},this.Seek=function(t,e){var i=e;return 0===i?this.FPosition=t:2===i?this.FPosition=this.FSize+t:1===i&&(this.FPosition=this.FPosition+t),this.FSizeBoundsSeek&&this.FPosition>this.FSize&&(this.FPosition=this.FSize),this.FPosition}})),rtl.createClass(this,"TMemoryStream",this.TCustomMemoryStream,(function(){this.$init=function(){t.TCustomMemoryStream.$init.call(this),this.FCapacity=0},this.SetCapacity=function(t){this.SetPointer(this.Realloc({get:function(){return t},set:function(e){t=e}}),this.FSize),this.FCapacity=t},this.Realloc=function(e){var i=null,s=0;if(e.get()<0?e.set(0):(s=this.FCapacity+rtl.trunc(this.FCapacity/4),e.get()>this.FCapacity&&e.get()<s&&e.set(s),e.set(e.get()+4095&-4096)),e.get()===this.FCapacity)i=this.FMemory;else if(0===e.get())i=null;else{if(null===(i=new ArrayBuffer(e.get())))throw t.EStreamError.$create("Create$1",[rtl.getResStr(t,"SMemoryStreamError")]);new Uint8Array(i).set(this.GetDataArray())}return i},this.Destroy=function(){this.Clear(),pas.System.TObject.Destroy.call(this)},this.Clear=function(){this.FSize=0,this.FPosition=0,this.SetCapacity(0)},this.Write$1=function(t,e,i){var s;return 0===i||this.FPosition<0?0:((s=this.FPosition+i)>this.FSize&&(s>this.FCapacity&&this.SetCapacity(s),this.FSize=s),this.GetDataArray().set(rtl.arrayCopy(0,t,e,i),this.FPosition),this.FPosition=s,i)},this.Write=function(t,e){return this.Write$1(t,0,e)}})),rtl.createClass(this,"TBytesStream",this.TMemoryStream,(function(){this.GetBytes=function(){return t.TMemoryStream.MemoryToBytes(this.FMemory)}})),rtl.createClass(this,"TStringStream",this.TMemoryStream,(function(){this.$init=function(){t.TMemoryStream.$init.call(this),this.FEncoding=null,this.FOwnsEncoding=!1},this.$final=function(){this.FEncoding=void 0,t.TMemoryStream.$final.call(this)};this.GetDataString=function(){var e="",i=null,s=null,o=0;if(e="",this.FEncoding===t.TEncoding.GetUnicode()){if(null!==(i=new Uint16Array(this.FMemory.slice(0,this.GetSize()))))for(var n=0,r=rtl.trunc(i.length/8192);n<=r;n++)o=n,e+=String.fromCharCode.apply(null,i.slice(8192*o,8192*(o+1)))}else if(null!==(s=new Uint8Array(this.FMemory.slice(0,this.GetSize()))))return s.reduce((function(t,e){return t+String.fromCharCode(e)}),"");return e},this.Create$2=function(e){return this.Create$3(e,t.TEncoding.GetUnicode(),!0),this},this.Create$3=function(e,i,s){var o;return pas.System.TObject.Create.call(this),this.FEncoding=i,o=e.length,this.FEncoding===t.TEncoding.GetUnicode()?(this.SetPointer(t.StringToBuffer$1(e,o,this.FEncoding),2*o),this.FCapacity=2*o):(this.SetPointer(t.StringToBuffer$1(e,o,this.FEncoding),o),this.FCapacity=o),this},this.Destroy=function(){this.FOwnsEncoding&&rtl.free(this,"FEncoding"),t.TMemoryStream.Destroy.call(this)},this.ReadString=function(e){var i,s="",o=[],n=null;return i=this.GetSize()-this.GetPosition(),this.FEncoding===t.TEncoding.GetUnicode()?(i<2*e&&(e=i),o=rtl.arraySetLength(o,0,2*e),this.ReadBuffer$1({get:function(){return o},set:function(t){o=t}},0,2*e),n=this.$class.BytesToMemory(rtl.arrayRef(o)),s=t.BufferToString$1(n,0,2*e,this.FEncoding)):(i<e&&(e=i),o=rtl.arraySetLength(o,0,e),this.ReadBuffer$1({get:function(){return o},set:function(t){o=t}},0,e),n=this.$class.BytesToMemory(rtl.arrayRef(o)),s=t.BufferToString$1(n,0,e,this.FEncoding)),s},this.WriteString=function(e){var i,s;i=t.StringToBuffer$1(e,e.length,this.FEncoding),s=this.$class.MemoryToBytes(i),this.WriteBuffer(s,rtl.length(s))}})),this.TFilerFlag={0:"ffInherited",ffInherited:0,1:"ffChildPos",ffChildPos:1,2:"ffInline",ffInline:2},rtl.createClass(this,"TFiler",pas.System.TObject,(function(){this.$init=function(){pas.System.TObject.$init.call(this),this.FRoot=null,this.FLookupRoot=null,this.FAncestor=null,this.FIgnoreChildren=!1},this.$final=function(){this.FRoot=void 0,this.FLookupRoot=void 0,this.FAncestor=void 0,pas.System.TObject.$final.call(this)},this.SetRoot=function(t){this.FRoot=t}})),this.TValueType={0:"vaNull",vaNull:0,1:"vaList",vaList:1,2:"vaInt8",vaInt8:2,3:"vaInt16",vaInt16:3,4:"vaInt32",vaInt32:4,5:"vaDouble",vaDouble:5,6:"vaString",vaString:6,7:"vaIdent",vaIdent:7,8:"vaFalse",vaFalse:8,9:"vaTrue",vaTrue:9,10:"vaBinary",vaBinary:10,11:"vaSet",vaSet:11,12:"vaNil",vaNil:12,13:"vaCollection",vaCollection:13,14:"vaCurrency",vaCurrency:14,15:"vaDate",vaDate:15,16:"vaNativeInt",vaNativeInt:16},rtl.createClass(this,"TAbstractObjectReader",pas.System.TObject,(function(){})),rtl.createClass(this,"TReader",this.TFiler,(function(){this.$init=function(){t.TFiler.$init.call(this),this.FDriver=null,this.FPropName=""},this.$final=function(){this.FDriver=void 0,t.TFiler.$final.call(this)},this.Destroy=function(){rtl.free(this,"FDriver"),pas.System.TObject.Destroy.call(this)},this.CheckValue=function(e){if(this.FDriver.NextValue()!==e)throw t.EReadError.$create("Create$1",[rtl.getResStr(pas.RTLConsts,"SInvalidPropertyValue")]);this.FDriver.ReadValue()},this.DefineProperty=function(t,e,i,s){null!=e&&pas.SysUtils.SameText(t,this.FPropName)&&(e(this),this.FPropName=rtl.strSetLength(this.FPropName,0))},this.EndOfList=function(){return 0===this.FDriver.NextValue()},this.ReadInteger=function(){var e=0,i=this.FDriver.ReadValue();if(2===i)e=this.FDriver.ReadInt8();else if(3===i)e=this.FDriver.ReadInt16();else{if(4!==i)throw t.EReadError.$create("Create$1",[rtl.getResStr(pas.RTLConsts,"SInvalidPropertyValue")]);e=this.FDriver.ReadInt32()}return e},this.ReadListBegin=function(){this.CheckValue(1)},this.ReadListEnd=function(){this.CheckValue(0)},this.ReadString=function(){var e;if(6!==(e=this.FDriver.ReadValue()))throw t.EReadError.$create("Create$1",[rtl.getResStr(pas.RTLConsts,"SInvalidPropertyValue")]);return this.FDriver.ReadString(e)}})),rtl.createClass(this,"TAbstractObjectWriter",pas.System.TObject,(function(){})),rtl.createClass(this,"TBinaryObjectWriter",this.TAbstractObjectWriter,(function(){this.$init=function(){t.TAbstractObjectWriter.$init.call(this),this.FStream=null},this.$final=function(){this.FStream=void 0,t.TAbstractObjectWriter.$final.call(this)},this.WriteWord=function(t){this.FStream.WriteBufferData$12(t)},this.WriteDWord=function(t){this.FStream.WriteBufferData$14(t)},this.WriteValue=function(t){var e;e=t,this.FStream.WriteBufferData$8(e)},this.Create$1=function(e){if(pas.System.TObject.Create.call(this),null===e)throw t.EWriteError.$create("Create$1",[rtl.getResStr(pas.RTLConsts,"SEmptyStreamIllegalWriter")]);return this.FStream=e,this},this.WriteSignature=function(){this.FStream.WriteBufferData$14(809914452)},this.BeginCollection=function(){this.WriteValue(13)},this.BeginComponent=function(t,e,i){var s=0;rtl.neSet(e,{})&&(s=0,0 in e&&(s|=1),1 in e&&(s|=2),2 in e&&(s|=4),s|=240,this.FStream.WriteBufferData$8(s),1 in e&&this.WriteInteger(i)),this.WriteStr(t.$classname),this.WriteStr(t.FName)},this.BeginList=function(){this.WriteValue(1)},this.EndList=function(){this.WriteValue(0)},this.BeginProperty=function(t){this.WriteStr(t)},this.EndProperty=function(){},this.WriteBoolean=function(t){t?this.WriteValue(9):this.WriteValue(8)},this.WriteFloat=function(t){this.WriteValue(5),this.FStream.WriteBufferData$20(t)},this.WriteIdent=function(t){"NIL"===pas.SysUtils.UpperCase(t)?this.WriteValue(12):"FALSE"===pas.SysUtils.UpperCase(t)?this.WriteValue(8):"TRUE"===pas.SysUtils.UpperCase(t)?this.WriteValue(9):"NULL"===pas.SysUtils.UpperCase(t)?this.WriteValue(0):(this.WriteValue(7),this.WriteStr(t))},this.WriteInteger=function(e){var i=0,s=0,o=0;e>=-128&&e<=127?(this.WriteValue(2),i=e,this.FStream.WriteBufferData$6(i)):e>=-32768&&e<=32767?(this.WriteValue(3),s=e,this.WriteWord(65535&s)):e>=-2147483648&&e<=2147483647?(this.WriteValue(4),o=e,this.WriteDWord(o>>>0)):(this.WriteValue(t.TValueType.vaNativeInt),this.FStream.WriteBufferData$16(e))},this.WriteMethodName=function(t){t.length>0?(this.WriteValue(7),this.WriteStr(t)):this.WriteValue(12)},this.WriteSet=function(t,e){var i=0,s=0;for(this.WriteValue(11),s=1,i=0;i<=31;i++)0!=(t&s)&&this.WriteStr(pas.TypInfo.GetEnumName(e,i)),s<<=1;this.WriteStr("")},this.WriteStr=function(t){var e,i=0,s=0;(i=t.length)>255&&(i=255),e=i,this.FStream.WriteBufferData$8(e);for(var o=1,n=i;o<=n;o++)s=o,this.FStream.WriteBufferData$4(t.charAt(s-1))},this.WriteString=function(t){var e,i=0;e=t.length,this.WriteValue(6),this.WriteDWord(e);for(var s=1,o=e;s<=o;s++)i=s,this.FStream.WriteBufferData$4(t.charAt(i-1))},this.WriteVariant=function(e){if(pas.JS.isUndefined(e))this.WriteValue(12);else if(pas.JS.isNull(e))this.WriteValue(0);else if(rtl.isNumber(e))0===pas.System.Frac(rtl.getNumber(e))?this.WriteInteger(rtl.trunc(e)):this.WriteFloat(rtl.getNumber(e));else if(pas.JS.isBoolean(e))this.WriteBoolean(!(0==e));else{if(!rtl.isString(e))throw t.EWriteError.$create("Create$1",[rtl.getResStr(pas.RTLConsts,"SUnsupportedPropertyVariantType")]);this.WriteString(""+e)}}})),rtl.createClass(this,"TWriter",this.TFiler,(function(){this.$init=function(){t.TFiler.$init.call(this),this.FDriver=null,this.FDestroyDriver=!1,this.FRootAncestor=null,this.FPropPath="",this.FAncestors=null,this.FAncestorPos=0,this.FCurrentPos=0,this.FOnFindAncestor=null,this.FOnWriteMethodProperty=null,this.FOnWriteStringProperty=null},this.$final=function(){this.FDriver=void 0,this.FRootAncestor=void 0,this.FAncestors=void 0,this.FOnFindAncestor=void 0,this.FOnWriteMethodProperty=void 0,this.FOnWriteStringProperty=void 0,t.TFiler.$final.call(this)},this.AddToAncestorList=function(t){this.FAncestors.AddObject(t.FName,e.TPosComponent.$create("Create$1",[this.FAncestors.GetCount(),t]))},this.WriteComponentData=function(t){var e={};e={},null!=this.FAncestor&&(!(9 in t.FComponentState)||5 in t.FComponentState&&null!==this.FAncestors)?e=rtl.createSet(0):9 in t.FComponentState&&(e=rtl.createSet(2)),null===this.FAncestors||this.FCurrentPos===this.FAncestorPos&&null!==this.FAncestor||(e=rtl.includeSet(e,1)),this.FDriver.BeginComponent(t,rtl.refSet(e),this.FCurrentPos),null!==this.FAncestors&&(this.FCurrentPos+=1),this.WriteProperties(t),this.WriteListEnd(),this.FIgnoreChildren||this.WriteChildren(t)},this.DetermineAncestor=function(t){var e;if(null!=this.FAncestors)if(-1===(e=this.FAncestors.IndexOf(t.FName)))this.FAncestor=null,this.FAncestorPos=-1;else{var i=this.FAncestors.GetObject(e);this.FAncestor=i.FComponent,this.FAncestorPos=i.FPos}},this.DoFindAncestor=function(e){var i=null;null!=this.FOnFindAncestor&&(null===this.FAncestor||t.TComponent.isPrototypeOf(this.FAncestor))&&(i=this.FAncestor,this.FOnFindAncestor(this,e,e.FName,{get:function(){return i},set:function(t){i=t}},{p:this,get:function(){return this.p.FRootAncestor},set:function(t){this.p.FRootAncestor=t}}),this.FAncestor=i)},this.SetRoot=function(e){t.TFiler.SetRoot.call(this,e),this.FLookupRoot=e},this.WriteProperty=function(e,i){var s,o,n=0,r=0,a=0,l="",h=null,F=0,p=0,c=pas.System.TMethod.$new(),u=pas.System.TMethod.$new(),C="",T="",S=null,d=null,m=null,f=null,g=null,y="",M="",b="",N="",B=void 0,E=!1,D=!1,L=!1;if(""!==i.getter){if(o=i.typeinfo,""===i.setter){if(13!==o.kind)return;if(!(f=pas.TypInfo.GetObjectProp$2(e,i)).$class.InheritsFrom(t.TComponent)||!(2 in f.FComponentStyle))return}s=null!=this.FAncestor&&(e===this.FRoot||e.$class.ClassType()===this.FAncestor.$class.ClassType());var G=o.kind;if(1===G||2===G||4===G||5===G){if(r=pas.TypInfo.GetOrdProp$1(e,i),s)a=pas.TypInfo.GetOrdProp$1(this.FAncestor,i);else if(5!==o.kind)a=rtl.trunc(i.Default);else for(y in a=0,i.Default)(n=parseInt(y,10))<32&&(a+=1<<n);if(r!==a||2147483648===a){this.FDriver.BeginProperty(this.FPropPath+i.name);var A=o.kind;1===A?null!=(h=t.FindIntToIdent(i.typeinfo))&&h(r,{get:function(){return l},set:function(t){l=t}})?this.WriteIdent(l):this.WriteInteger(r):2===A?this.WriteChar(String.fromCharCode(r)):5===A?this.FDriver.WriteSet(r,o.comptype):4===A&&this.WriteIdent(pas.TypInfo.GetEnumName(o,r)),this.FDriver.EndProperty()}}else if(G===pas.System.TTypeKind.tkDouble)((F=pas.TypInfo.GetFloatProp$1(e,i))!==(p=s?pas.TypInfo.GetFloatProp$1(this.FAncestor,i):rtl.getNumber(i.Default))||!s&&2147483648===pas.System.Int(p))&&(this.FDriver.BeginProperty(this.FPropPath+i.name),this.WriteFloat(F),this.FDriver.EndProperty());else if(9===G)c.$assign(pas.TypInfo.GetMethodProp(e,i)),s?u.$assign(pas.TypInfo.GetMethodProp(this.FAncestor,i)):(u.Data=null,u.Code=null),L=!1,null!=this.FOnWriteMethodProperty&&this.FOnWriteMethodProperty(this,e,i,c,u,{get:function(){return L},set:function(t){L=t}}),N=rtl.isString(c.Code)?c.Code:this.FLookupRoot.$class.MethodName(c.Code),!L&&c.Code!==u.Code&&(null==c.Code||N.length>0)&&(this.FDriver.BeginProperty(this.FPropPath+i.name),null!=c.Code?this.FDriver.WriteMethodName(N):this.FDriver.WriteMethodName(""),this.FDriver.EndProperty());else if(3===G)C=pas.TypInfo.GetStrProp$1(e,i),s?T=pas.TypInfo.GetStrProp$1(this.FAncestor,i):(a=rtl.trunc(i.Default),T=rtl.strSetLength(T,0)),(C!==T||!s&&2147483648===a)&&(this.FDriver.BeginProperty(this.FPropPath+i.name),null!=this.FOnWriteStringProperty&&this.FOnWriteStringProperty(this,e,i,{get:function(){return C},set:function(t){C=t}}),this.WriteString(C),this.FDriver.EndProperty());else if(16===G)(B=pas.TypInfo.GetJSValueProp$3(e,i))!=(s?pas.TypInfo.GetJSValueProp$3(this.FAncestor,i):null)&&(this.FDriver.BeginProperty(this.FPropPath+i.name),this.WriteVariant(B),this.FDriver.EndProperty());else if(13===G){if(f=pas.TypInfo.GetObjectProp$2(e,i),s?(S=pas.TypInfo.GetObjectProp$2(this.FAncestor,i),t.TComponent.isPrototypeOf(S)&&t.TComponent.isPrototypeOf(f)&&S!==f&&S.FOwner===this.FRootAncestor&&f.FOwner===this.FRoot&&pas.SysUtils.UpperCase(S.FName)===pas.SysUtils.UpperCase(f.FName)&&(S=f)):S=null,null==f)f!==S&&(this.FDriver.BeginProperty(this.FPropPath+i.name),this.FDriver.WriteIdent("NIL"),this.FDriver.EndProperty());else if(f.$class.InheritsFrom(t.TPersistent))if(f.$class.InheritsFrom(t.TComponent)&&(!(2 in f.FComponentStyle)||f.FOwner!==e&&null!==f.FOwner)){if(m=f,f!==S&&!(3 in m.FComponentStyle)){for(b="",d=m;null!==d&&""!==d.FName;){if(""!==b&&(b="."+b),d.FOwner===this.FLookupRoot){b=d.FName+b;break}if(d===this.FLookupRoot){b="Owner"+b;break}b=d.FName+b,d=d.FOwner}null===d&&null===m.FOwner&&""!==b&&(b+=".Owner"),b.length>0&&(this.FDriver.BeginProperty(this.FPropPath+i.name),this.WriteIdent(b),this.FDriver.EndProperty())}}else{g=this.FAncestor,M=this.FPropPath;try{this.FPropPath=this.FPropPath+i.name+".",s&&(this.FAncestor=pas.TypInfo.GetObjectProp$2(this.FAncestor,i)),this.WriteProperties(f)}finally{this.FAncestor=g,this.FPropPath=M}if(f.$class.InheritsFrom(t.TCollection)&&(!s||!t.CollectionsEqual$1(f,pas.TypInfo.GetObjectProp$2(this.FAncestor,i),this.FRoot,this.FRootAncestor))){this.FDriver.BeginProperty(this.FPropPath+i.name),M=this.FPropPath;try{this.FPropPath=rtl.strSetLength(this.FPropPath,0),this.WriteCollection(f)}finally{this.FPropPath=M,this.FDriver.EndProperty()}}}}else 7===G&&(E=0!==pas.TypInfo.GetOrdProp$1(e,i),s?D=0!==pas.TypInfo.GetOrdProp$1(this.FAncestor,i):(D=0!=i.Default,a=rtl.trunc(i.Default)),E===D&&2147483648!==a||(this.FDriver.BeginProperty(this.FPropPath+i.name),this.WriteBoolean(E),this.FDriver.EndProperty()))}},this.WriteProperties=function(t){var e,i,s=0;if(i=pas.TypInfo.GetPropList$3(t),(e=rtl.length(i))>0)for(var o=0,n=e-1;o<=n;o++)s=o,pas.TypInfo.IsStoredProp(t,i[s])&&this.WriteProperty(t,i[s]);t.DefineProperties(this)},this.WriteChildren=function(e){var i,s,o,n,r,a=0,l=null;i=this.FRoot,s=this.FRootAncestor,o=this.FAncestors,n=this.FCurrentPos,r=this.FAncestorPos;try{this.FAncestors=null,this.FCurrentPos=0,this.FAncestorPos=-1,9 in e.FComponentState&&(this.FRoot=e),t.TComponent.isPrototypeOf(this.FAncestor)&&(this.FAncestors=t.TStringList.$create("Create$1"),9 in this.FAncestor.FComponentState&&(this.FRootAncestor=this.FAncestor),this.FAncestor.GetChildren(rtl.createCallback(this,"AddToAncestorList"),this.FRootAncestor),this.FAncestors.SetSorted(!0));try{e.GetChildren(rtl.createCallback(this,"WriteComponent"),this.FRoot)}finally{if(null!=this.FAncestors)for(var h=0,F=this.FAncestors.GetCount()-1;h<=F;h++)a=h,l=this.FAncestors.GetObject(a),this.FAncestors.PutObject(a,null),l=rtl.freeLoc(l);pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FAncestors},set:function(t){this.p.FAncestors=t}})}}finally{this.FAncestors=o,this.FRoot=i,this.FRootAncestor=s,this.FCurrentPos=n,this.FAncestorPos=r}},this.CreateDriver=function(e){return t.TBinaryObjectWriter.$create("Create$1",[e])},this.Create$1=function(t){return pas.System.TObject.Create.call(this),this.FDriver=t,this},this.Create$2=function(e){if(pas.System.TObject.Create.call(this),null===e)throw t.EWriteError.$create("Create$1",[rtl.getResStr(pas.RTLConsts,"SEmptyStreamIllegalWriter")]);return this.FDriver=this.CreateDriver(e),this.FDestroyDriver=!0,this},this.Destroy=function(){this.FDestroyDriver&&rtl.free(this,"FDriver"),pas.System.TObject.Destroy.call(this)},this.DefineProperty=function(t,e,i,s){s&&null!=i&&(this.FDriver.BeginProperty(this.FPropPath+t),i(this),this.FDriver.EndProperty())},this.WriteBoolean=function(t){this.FDriver.WriteBoolean(t)},this.WriteCollection=function(t){var e=0;if(this.FDriver.BeginCollection(),null!=t)for(var i=0,s=t.GetCount()-1;i<=s;i++)e=i,this.WriteListBegin(),this.WriteProperties(t.GetItem(e)),this.WriteListEnd();this.WriteListEnd()},this.WriteComponent=function(t){var e,i,s;i=this.FRoot,e=this.FAncestor,s=this.FRootAncestor;try{t.FComponentState=rtl.unionSet(t.FComponentState,rtl.createSet(2));try{this.DetermineAncestor(t),this.DoFindAncestor(t),t.WriteState(this),this.FDriver.EndList()}finally{t.FComponentState=rtl.diffSet(t.FComponentState,rtl.createSet(2))}}finally{this.FAncestor=e,this.FRoot=i,this.FRootAncestor=s}},this.WriteChar=function(t){this.WriteString(t)},this.WriteDescendent=function(t,e){this.FRoot=t,this.FAncestor=e,this.FRootAncestor=e,this.FLookupRoot=t,this.WriteSignature(),this.WriteComponent(t)},this.WriteFloat=function(t){this.FDriver.WriteFloat(t)},this.WriteIdent=function(t){this.FDriver.WriteIdent(t)},this.WriteInteger=function(t){this.FDriver.WriteInteger(t)},this.WriteListBegin=function(){this.FDriver.BeginList()},this.WriteListEnd=function(){this.FDriver.EndList()},this.WriteSignature=function(){this.FDriver.WriteSignature()},this.WriteString=function(t){this.FDriver.WriteString(t)},this.WriteVariant=function(t){this.FDriver.WriteVariant(t)}})),this.TObjectTextEncoding={0:"oteDFM",oteDFM:0,1:"oteLFM",oteLFM:1},rtl.createClass(this,"TObjectStreamConverter",pas.System.TObject,(function(){this.$init=function(){pas.System.TObject.$init.call(this),this.FIndent="",this.FInput=null,this.FOutput=null,this.FEncoding=0,this.FPlainStrings=!1},this.$final=function(){this.FInput=void 0,this.FOutput=void 0,pas.System.TObject.$final.call(this)},this.Outchars=function(t){var e="",i="",s=0,o=0,n=0,r=!1,a=!1;if(""===t)e="''";else{for(e="",r=!1,o=t.length,s=0;s<o;)a=r,39===(n=t.charCodeAt(s))?(r||(a=!0),i="''"):n>=32&&n<127?(r||(a=!0),i=String.fromCharCode(n)):(r&&(a=!1),i="#"+pas.SysUtils.IntToStr(n)),a!==r&&(i="'"+i,r=a),e+=i,s+=1;r&&(e+="'")}this.OutStr(e)},this.OutLn=function(t){this.OutStr(t+pas.System.LineEnding)},this.OutStr=function(t){for(var e=0,i=1,s=t.length;i<=s;i++)e=i,this.FOutput.WriteBufferData$4(t.charAt(e-1))},this.OutString=function(t){this.Outchars(t)},this.ReadWord=function(){var t=0;return this.FInput.ReadBufferData$10({get:function(){return t},set:function(e){t=e}}),t},this.ReadDWord=function(){var t=0;return this.FInput.ReadBufferData$14({get:function(){return t},set:function(e){t=e}}),t},this.ReadDouble=function(){var t=0;return this.FInput.ReadBufferData$20({get:function(){return t},set:function(e){t=e}}),t},this.ReadInt=function(t){var e=0,i=t;return 2===i?e=(255&this.FInput.ReadByte())<<24>>24:3===i?e=(65535&this.ReadWord())<<16>>16:4===i?e=4294967295&this.ReadDWord():16===i&&(e=this.ReadNativeInt()),e},this.ReadInt$1=function(){return this.ReadInt(this.FInput.ReadByte())},this.ReadNativeInt=function(){var t=0;return this.FInput.ReadBufferData$16({get:function(){return t},set:function(e){t=e}}),t},this.ReadStr=function(){var t="",e=0,i=0,s="";this.FInput.ReadBufferData$6({get:function(){return e},set:function(t){e=t}}),t=rtl.strSetLength(t,e);for(var o=1,n=e;o<=n;o++)i=o,this.FInput.ReadBufferData$2({get:function(){return s},set:function(t){s=t}}),t=rtl.setCharAt(t,i-1,s);return t},this.ReadString=function(e){var i="",s=0,o="";if(i="",6!==e)throw t.EFilerError.$create("Create$1",["Invalid string type passed to ReadString"]);s=this.ReadDWord();for(var n=1,r=(i=rtl.strSetLength(i,s)).length;n<=r;n++)s=n,this.FInput.ReadBufferData$2({get:function(){return o},set:function(t){o=t}}),i=rtl.setCharAt(i,s-1,o);return i},this.ProcessBinary=function(){var t=0,e=0,i=0,s=[],o="";for(t=this.ReadDWord(),s=rtl.arraySetLength(s,0,32),this.OutLn("{");t>0;){(e=t)>32&&(e=32),t-=e,o=this.FIndent+"  ",this.FInput.ReadBuffer({get:function(){return s},set:function(t){s=t}},e);for(var n=0,r=e-1;n<=r;n++)i=n,o+=pas.SysUtils.IntToHex(s[i],2);this.OutLn(o)}this.OutLn(this.FIndent+"}")},this.ProcessValue=function(e,i){var s="",o=!1,n=0,r=e;if(1===r){for(this.OutStr("("),o=!0;0!==(e=this.FInput.ReadByte());)o&&(this.OutLn(""),o=!1),this.OutStr(i+"  "),this.ProcessValue(e,i+"  ");this.OutLn(i+")")}else if(2===r)this.OutLn(pas.SysUtils.IntToStr((255&this.FInput.ReadByte())<<24>>24));else if(3===r)this.OutLn(pas.SysUtils.IntToStr((65535&this.ReadWord())<<16>>16));else if(4===r)this.OutLn(pas.SysUtils.IntToStr(4294967295&this.ReadDWord()));else if(16===r)this.OutLn(pas.SysUtils.IntToStr(this.ReadNativeInt()));else if(5===r)n=this.ReadDouble(),s=rtl.floatToStr(n),this.OutLn(s);else if(6===r)this.FPlainStrings?this.OutStr("'"+pas.SysUtils.StringReplace(this.ReadString(6),"'","''",rtl.createSet(0))+"'"):this.OutString(this.ReadString(6)),this.OutLn("");else if(7===r)this.OutLn(this.ReadStr());else if(8===r)this.OutLn("False");else if(9===r)this.OutLn("True");else if(10===r)this.ProcessBinary();else if(11===r){for(this.OutStr("["),o=!0;0!==(s=this.ReadStr()).length;)o||this.OutStr(", "),o=!1,this.OutStr(s);this.OutLn("]")}else if(12===r)this.OutLn("nil");else{if(13!==r)throw t.EReadError.$create("CreateFmt",[rtl.getResStr(pas.RTLConsts,"SErrInvalidPropertyType"),pas.System.VarRecs(0,e)]);for(this.OutStr("<");0!==this.FInput.ReadByte();)this.OutLn(i),this.FInput.Seek(-1,1),this.OutStr(i+"  item"),1!==(e=this.FInput.ReadByte())&&this.OutStr("["+pas.SysUtils.IntToStr(this.ReadInt(e))+"]"),this.OutLn(""),this.ReadPropList(i+"    "),this.OutStr(i+"  end");this.OutLn(">")}},this.ReadObject=function(t){var e,i,s=0,o=0;for(240==(240&(s=this.FInput.ReadByte()))?0!=(2&s)&&(o=this.ReadInt$1()):(s=0,this.FInput.Seek(-1,1)),e=this.ReadStr(),i=this.ReadStr(),this.OutStr(t),0!=(1&s)?this.OutStr("inherited"):0!=(4&s)?this.OutStr("inline"):this.OutStr("object"),this.OutStr(" "),""!==i&&this.OutStr(i+": "),this.OutStr(e),0!=(2&s)&&this.OutStr("["+pas.SysUtils.IntToStr(o)+"]"),this.OutLn(""),this.ReadPropList(t+"  ");0!==this.FInput.ReadByte();)this.FInput.Seek(-1,1),this.ReadObject(t+"  ");this.OutLn(t+"end")},this.ReadPropList=function(t){for(;0!==this.FInput.ReadByte();)this.FInput.Seek(-1,1),this.OutStr(t+this.ReadStr()+" = "),this.ProcessValue(this.FInput.ReadByte(),t)},this.ObjectBinaryToText$1=function(t,e,i){this.FInput=t,this.FOutput=e,this.FEncoding=i,this.Execute()},this.Execute=function(){var e=0;if(""===this.FIndent&&(this.FIndent="  "),null==this.FInput)throw t.EReadError.$create("Create$1",["Missing input stream"]);if(null==this.FOutput)throw t.EReadError.$create("Create$1",["Missing output stream"]);if(this.FInput.ReadBufferData$12({get:function(){return e},set:function(t){e=t}}),809914452!==e)throw t.EReadError.$create("Create$1",[rtl.getResStr(pas.RTLConsts,"SInvalidImage")]);this.ReadObject("")}})),rtl.createClass(this,"TLoadHelper",pas.System.TObject,(function(){})),rtl.createClass(this,"TEncoding",pas.System.TObject,(function(){this.FANSI=null,this.FUnicode=null,this.FUTF8=null,this.GetANSI=function(){return null==this.FANSI&&(t.TEncoding.FANSI=t.TANSIEncoding.$create("Create")),this.FANSI},this.GetUTF8=function(){return null==this.FUTF8&&(t.TEncoding.FUTF8=t.TUTF8Encoding.$create("Create")),this.FUTF8},this.GetUnicode=function(){return null==this.FUnicode&&(t.TEncoding.FUnicode=t.TUnicodeEncoding.$create("Create")),this.FUnicode}})),rtl.createClass(this,"TANSIEncoding",this.TEncoding,(function(){})),rtl.createClass(this,"TUTF8Encoding",this.TEncoding,(function(){})),rtl.createClass(this,"TUnicodeEncoding",this.TEncoding,(function(){})),this.TMSPlatformsWeb=1,rtl.createClass(this,"ComponentPlatformsAttribute",pas.System.TCustomAttribute,(function(){this.$init=function(){pas.System.TCustomAttribute.$init.call(this),this.FPlatforms=0},this.Create$1=function(t){return this.FPlatforms=t,this}})),this.TShiftState$a={0:"ssShift",ssShift:0,1:"ssAlt",ssAlt:1,2:"ssCtrl",ssCtrl:2,3:"ssLeft",ssLeft:3,4:"ssRight",ssRight:4,5:"ssMIDdle",ssMIDdle:5,6:"ssDouble",ssDouble:6,7:"ssTouch",ssTouch:7,8:"ssPen",ssPen:8,9:"ssCommand",ssCommand:9},this.$rtti.$Enum("TShiftState$a",{minvalue:0,maxvalue:9,ordtype:1,enumtype:this.TShiftState$a}),this.$rtti.$Set("TShiftState",{comptype:this.$rtti.TShiftState$a}),this.RegisterClass=function(t){e.ClassList[t.$classname]=t},this.RegisterClasses=function(e){for(var i=null,s=e,o=0,n=rtl.length(s)-1;o<=n;o++)i=s[o],t.RegisterClass(i)},this.GetClass=function(t){var i=null;return i=null,""===t?i:e.ClassList.hasOwnProperty(t)?i=rtl.getObject(e.ClassList[t]):i},this.FindIntToIdent=function(t){var i=0;if(null,null==e.IntConstList)return null;for(var s=e.IntConstList,o=0,n=s.FCount-1;o<=n;o++)if(i=o,rtl.getObject(s.Get(i)).IntegerType===t)return rtl.getObject(s.Get(i)).IntToIdentFn;return null},this.CollectionsEqual$1=function(e,i,s,o){var n=!1;function r(e,i,s){var o=null;o=t.TWriter.$create("Create$2",[e]);try{o.SetRoot(s),o.FLookupRoot=s,o.WriteCollection(i)}finally{o=rtl.freeLoc(o)}}var a=null,l=null,h=[],F=[],p=0,c=0;if(n=!1,e.$class.ClassType()!==i.$class.ClassType()||e.GetCount()!==i.GetCount())return n;if(0===e.GetCount())return n=!0;l=null,a=t.TBytesStream.$create("Create");try{if(l=t.TBytesStream.$create("Create"),r(a,e,s),r(l,i,o),n=a.GetSize()===l.GetSize())for(h=a.GetBytes(),F=l.GetBytes(),p=0,c=a.GetSize();n&&p<c;)n=h[p]===F[p],p+=1}finally{l=rtl.freeLoc(l),a=rtl.freeLoc(a)}return n},this.ObjectBinaryToText=function(e,i){t.ObjectBinaryToText$1(e,i,1)},this.ObjectBinaryToText$1=function(e,i,s){var o=null;o=t.TObjectStreamConverter.$create("Create");try{o.ObjectBinaryToText$1(e,i,s)}finally{o=rtl.freeLoc(o)}},this.SetLoadHelperClass=function(t){var i;return i=e.GlobalLoadHelper,e.GlobalLoadHelper=t,i},this.StringToBuffer$1=function(e,i,s){var o=null,n=0;if(s===t.TEncoding.GetUnicode()){o=new ArrayBuffer(2*i);for(var r=new Uint16Array(o),a=0,l=i-1;a<=l;a++)r[n=a]=e.charCodeAt(n)}else{o=new ArrayBuffer(i);for(var h=new Uint8Array(o),F=0,p=i-1;F<=p;F++)h[n=F]=e.charCodeAt(n)}return o},this.BufferToString$1=function(e,i,s,o){var n="",r=null,a=null;return n="",o===t.TEncoding.GetUnicode()?null!==(r=new Uint16Array(e.slice(i,s)))&&(n=""+String.fromCharCode.apply(null,r)):null!==(a=new Uint8Array(e.slice(i,s)))&&(n=""+String.fromCharCode.apply(null,a)),n},this.vaInt64=16,t.$implcode=function(){e.IntConstList=null,e.GlobalLoadHelper=null,rtl.createClass(e,"TIntConst",pas.System.TObject,(function(){this.$init=function(){pas.System.TObject.$init.call(this),this.IntegerType=null,this.IntToIdentFn=null},this.$final=function(){this.IntToIdentFn=void 0,pas.System.TObject.$final.call(this)}})),e.StringListAnsiCompare=function(t,e,i){return t.DoCompareText(t.FList[e].FString,t.FList[i].FString)},e.TMSGrow=4096,e.FilerSignatureInt=809914452,rtl.createClass(e,"TPosComponent",pas.System.TObject,(function(){this.$init=function(){pas.System.TObject.$init.call(this),this.FPos=0,this.FComponent=null},this.$final=function(){this.FComponent=void 0,pas.System.TObject.$final.call(this)},this.Create$1=function(t,e){return this.FPos=t,this.FComponent=e,this}})),e.ClassList=null,t.$resourcestrings={SReadError:{org:"Could not read data from stream"},SWriteError:{org:"Could not write data to stream"},SMemoryStreamError:{org:"Could not allocate memory"}}},t.$init=function(){e.ClassList=new Object}}),["Web"]),rtl.module("WEBLib.Menus",["System","Classes","SysUtils","WEBLib.Controls","WEBLib.Graphics","Web"],(function(){"use strict";var t=this,e=t.$impl;this.$rtti.$Class("TMainMenu"),this.$rtti.$Class("TMenuItem"),this.$rtti.$Class("TCustomMainMenu"),this.TMenuItemAutoFlag={0:"maAutomatic",maAutomatic:0,1:"maManual",maManual:1,2:"maParent",maParent:2},this.$rtti.$Enum("TMenuItemAutoFlag",{minvalue:0,maxvalue:2,ordtype:1,enumtype:this.TMenuItemAutoFlag}),this.TMenuBreak={0:"mbNone",mbNone:0,1:"mbBreak",mbBreak:1,2:"mbBarBreak",mbBarBreak:2},this.$rtti.$Enum("TMenuBreak",{minvalue:0,maxvalue:2,ordtype:1,enumtype:this.TMenuBreak}),this.$rtti.$Int("THelpContext",{minvalue:-2147483647,maxvalue:2147483647,ordtype:4}),this.$rtti.$inherited("TShortCut",rtl.word,{}),this.TMainMenuHamburgerMenuVisible={0:"hmAlways",hmAlways:0,1:"hmNever",hmNever:1,2:"hmResponsive",hmResponsive:2},this.$rtti.$Enum("TMainMenuHamburgerMenuVisible",{minvalue:0,maxvalue:2,ordtype:1,enumtype:this.TMainMenuHamburgerMenuVisible}),this.$rtti.$MethodVar("TMainMenuChangeEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["Source",this.$rtti.TMenuItem],["Rebuild",rtl.boolean]]),methodkind:0}),rtl.createClass(this,"TMenuItemList",pas.Classes.TList,(function(){this.GetItem=function(t){return rtl.getObject(this.Get(t))}})),rtl.createClass(this,"TMenuItem",pas.Classes.TComponent,(function(){this.$init=function(){pas.Classes.TComponent.$init.call(this),this.FOwner$1=null,this.FCaption="",this.FItems=null,this.FParentItem=null,this.FOnClick=null,this.FChecked=!1,this.FEnabled=!1,this.FDefault=!1,this.FAutoCheck=!1,this.FHint="",this.FAutoHotkeys=0,this.FRadioItem=!1,this.FGroupIndex=0,this.FVisible=!1,this.FShortCut=0,this.FBreak=0,this.FImageIndex=0,this.FAutoLineReduction=0,this.FHelpContext=0,this.FElementClassName="",this.FParentMenu=null},this.$final=function(){this.FOwner$1=void 0,this.FItems=void 0,this.FParentItem=void 0,this.FOnClick=void 0,this.FParentMenu=void 0,pas.Classes.TComponent.$final.call(this)},this.SetChecked=function(e){var i=null,s=null,o=null,n=null,r=0;if(this.FChecked!==e){if(this.FChecked=e,null!=(n=this.FParentMenu)){if(t.TMenuItem.isPrototypeOf(n)&&e)for(var a=0,l=(s=n).FItems.GetCount()-1;a<=l;a++)r=a,(o=s.FItems.GetItem(r)).FRadioItem&&o!==this&&o.SetChecked(!1);for(;!t.TCustomMainMenu.isPrototypeOf(n)&&null!=n;)n=n.FOwner}null!=(i=this.GetParentMenu())&&i.UpdateElement()}},this.SetCaption=function(t){var e=null;this.FCaption=t,null!=(e=this.GetParentMenu())&&e.UpdateElement()},this.SetImageIndex=function(t){var e=null;this.FImageIndex=t,null!=(e=this.GetParentMenu())&&e.UpdateElement()},this.SetEnabled=function(t){this.FEnabled!==t&&(this.FEnabled=t,this.GetParentMenu().UpdateElement())},this.GetCount=function(){return null===this.FItems?0:this.FItems.GetCount()},this.Create$1=function(e){return this.FParentMenu=null,t.TMainMenu.isPrototypeOf(e)&&(this.FParentMenu=e),pas.Classes.TComponent.Create$1.call(this,e),this.FAutoHotkeys=2,this.FAutoLineReduction=2,this.FImageIndex=-1,this.FHint="",this.FCaption="MenuItem",this.FChecked=!1,this.FEnabled=!0,this.FDefault=!1,this.FRadioItem=!1,this.FVisible=!0,this.FOwner$1=e,this},this.Destroy=function(){var t=0,e=null,i=null;if(e=this.GetParentMenu(),null!=this.FParentItem&&null!=e){e.BeginUpdate();for(var s=this.FParentItem.FItems.GetCount()-1;s>=0;s--)t=s,this.FParentItem.FItems.GetItem(t)===this&&this.FParentItem.FItems.Delete(t);e.EndUpdate()}if(null!=this.FItems)for(var o=this.FItems.GetCount()-1;o>=0;o--)t=o,(i=this.FItems.GetItem(t)).FParentItem=null,i=rtl.freeLoc(i),this.FItems.Delete(t);pas.Classes.TComponent.Destroy.call(this)},this.Assign=function(e){var i=0,s=null,o=null,n=null;if(t.TMenuItem.isPrototypeOf(e)&&(s=rtl.as(e,t.TMenuItem),this.FAutoCheck=s.FAutoCheck,this.FAutoHotkeys=s.FAutoHotkeys,this.FAutoLineReduction=s.FAutoLineReduction,this.FBreak=s.FBreak,this.FCaption=s.FCaption,this.FChecked=s.FChecked,this.FDefault=s.FDefault,this.FEnabled=s.FEnabled,this.FGroupIndex=s.FGroupIndex,this.FHelpContext=s.FHelpContext,this.FHint=s.FHint,this.FImageIndex=s.FImageIndex,this.FRadioItem=s.FRadioItem,this.FShortCut=s.FShortCut,this.FVisible=s.FVisible,this.FElementClassName=s.FElementClassName,n=this.GetParentMenu(),null!=this.FParentItem&&this.SetName(n.GetUniqueName(s.FCaption)),null!=s.FItems)){if(null!=this.FItems){for(var r=this.FItems.GetCount()-1;r>=0;r--)i=r,this.RemoveItem(this.GetParentMenu().FParent,this.FItems.GetItem(i));this.FItems.Clear()}else this.FItems=t.TMenuItemList.$create("Create$1");for(var a=0,l=s.FItems.GetCount()-1;a<=l;a++)i=a,(o=t.TMenuItem.$create("Create$1",[n.FOwner])).FParentMenu=n,o.FParentItem=this,o.Assign(s.FItems.GetItem(i)),this.FItems.Add(o)}},this.SetParentComponent=function(e){pas.Classes.TComponent.SetParentComponent.apply(this,arguments),this.FParentMenu=e,null!==e&&(t.TCustomMainMenu.isPrototypeOf(e)?e.FItems.IsChild(this)||e.FItems.Add(this):t.TMenuItem.isPrototypeOf(e)&&(e.IsChild(this)||e.Add(this)))},this.Add=function(t){this.Insert$1(this.GetCount(),t)},this.Insert$1=function(e,i){null===this.FItems&&(this.FItems=t.TMenuItemList.$create("Create$1")),this.FItems.Insert(e,i),i.FParentItem=this,null!=i.GetParentMenu()&&i.GetParentMenu().UpdateElement()},this.IsChild=function(t){var e=!1,i=0;if(e=!1,null==this.FItems)return e;for(var s=0,o=this.FItems.GetCount()-1;s<=o;s++)i=s,this.FItems.GetItem(i)===t&&(e=!0);return e},this.GetOwner=function(){return this.FOwner$1},this.GetParentMenu=function(){var e=null,i=null;for(e=null,i=this.FParentMenu;null!=i&&t.TMenuItem.isPrototypeOf(i);)i=i.FParentMenu;return null!=i&&(e=i),e},this.GetChildren=function(t,e){var i=0;if(null!=this.FItems)for(var s=0,o=this.FItems.GetCount()-1;s<=o;s++)i=s,t(this.FItems.GetItem(i))},this.SetChildOrder=function(t,e){var i;(i=this.FItems.IndexOf(t))>=0&&e<this.FItems.GetCount()&&this.FItems.Move(i,e)},this.RemoveItem=function(t,e){var i=0;if(null!=e.FItems)for(var s=e.FItems.GetCount()-1;s>=0;s--)i=s,this.RemoveItem(t,e.FItems.GetItem(i));t.RemoveComponent(e)},this.Click=function(){null!=this.FOnClick&&this.FOnClick(this)},rtl.addIntf(this,pas.System.IUnknown);var e=this.$rtti;e.addProperty("AutoCheck",0,rtl.boolean,"FAutoCheck","FAutoCheck",{Default:!1}),e.addProperty("AutoHotkeys",0,t.$rtti.TMenuItemAutoFlag,"FAutoHotkeys","FAutoHotkeys",{Default:t.TMenuItemAutoFlag.maParent}),e.addProperty("AutoLineReduction",0,t.$rtti.TMenuItemAutoFlag,"FAutoLineReduction","FAutoLineReduction",{Default:t.TMenuItemAutoFlag.maParent}),e.addProperty("Break",0,t.$rtti.TMenuBreak,"FBreak","FBreak",{Default:t.TMenuBreak.mbNone}),e.addProperty("Caption",2,rtl.string,"FCaption","SetCaption"),e.addProperty("Checked",2,rtl.boolean,"FChecked","SetChecked",{Default:!1}),e.addProperty("Default",0,rtl.boolean,"FDefault","FDefault",{Default:!1}),e.addProperty("Enabled",2,rtl.boolean,"FEnabled","SetEnabled",{Default:!0}),e.addProperty("GroupIndex",0,rtl.byte,"FGroupIndex","FGroupIndex",{Default:0}),e.addProperty("HelpContext",0,t.$rtti.THelpContext,"FHelpContext","FHelpContext",{Default:0}),e.addProperty("Hint",0,rtl.string,"FHint","FHint"),e.addProperty("ImageIndex",2,rtl.longint,"FImageIndex","SetImageIndex",{Default:-1}),e.addProperty("RadioItem",0,rtl.boolean,"FRadioItem","FRadioItem",{Default:!1}),e.addProperty("ShortCut",0,t.$rtti.TShortCut,"FShortCut","FShortCut",{Default:0}),e.addProperty("Visible",0,rtl.boolean,"FVisible","FVisible",{Default:!0}),e.addProperty("ElementClassName",0,pas["WEBLib.Controls"].$rtti.TElementClassName,"FElementClassName","FElementClassName"),e.addProperty("OnClick",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnClick","FOnClick")})),this.$rtti.$Class("TMainMenuAppearance"),rtl.createClass(this,"THamburgerMenu",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FOwner=null,this.FVisible=0,this.FCaption="",this.FBackgroundColor=0,this.FCaptionColor=0,this.FResponsiveMaxWidth=0},this.$final=function(){this.FOwner=void 0,pas.Classes.TPersistent.$final.call(this)},this.SetVisible=function(t){this.FVisible!==t&&(this.FVisible=t,this.FOwner.FOwner.UpdateElement())},this.SetBackgroundColor=function(t){this.FBackgroundColor!==t&&(this.FBackgroundColor=t,this.FOwner.FOwner.UpdateElement())},this.SetCaption=function(t){this.FCaption!==t&&(this.FCaption=t,this.FOwner.FOwner.UpdateElement())},this.SetCaptionColor=function(t){this.FCaptionColor!==t&&(this.FCaptionColor=t,this.FOwner.FOwner.UpdateElement())},this.SetResponsiveMaxWidth=function(t){this.FResponsiveMaxWidth!==t&&(this.FResponsiveMaxWidth=t,this.FOwner.FOwner.UpdateElement())},this.Create$1=function(t){return this.FBackgroundColor=12632256,this.FCaption="Menu",this.FCaptionColor=16777215,this.FVisible=2,this.FResponsiveMaxWidth=768,this.FOwner=t,this},this.Destroy=function(){pas.System.TObject.Destroy.call(this)},this.Assign=function(e){pas.Classes.TPersistent.Assign.apply(this,arguments),t.THamburgerMenu.isPrototypeOf(e)&&(this.FBackgroundColor=rtl.as(e,t.THamburgerMenu).FBackgroundColor,this.FCaption=rtl.as(e,t.THamburgerMenu).FCaption,this.FCaptionColor=rtl.as(e,t.THamburgerMenu).FCaptionColor,this.FVisible=rtl.as(e,t.THamburgerMenu).FVisible,this.FResponsiveMaxWidth=rtl.as(e,t.THamburgerMenu).FResponsiveMaxWidth)},this.GetOwner=function(){return this.FOwner};var e=this.$rtti;e.addProperty("Caption",2,rtl.string,"FCaption","SetCaption"),e.addProperty("CaptionColor",2,pas["WEBLib.Graphics"].$rtti.TColor,"FCaptionColor","SetCaptionColor",{Default:16777215}),e.addProperty("BackgroundColor",2,pas["WEBLib.Graphics"].$rtti.TColor,"FBackgroundColor","SetBackgroundColor",{Default:12632256}),e.addProperty("Visible",2,t.$rtti.TMainMenuHamburgerMenuVisible,"FVisible","SetVisible",{Default:t.TMainMenuHamburgerMenuVisible.hmResponsive}),e.addProperty("ResponsiveMaxWidth",2,rtl.longint,"FResponsiveMaxWidth","SetResponsiveMaxWidth",{Default:768})})),rtl.createClass(this,"TMainMenuAppearance",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FOwner=null,this.FBackgroundColor=0,this.FHoverFontColor=0,this.FHoverColor=0,this.FImageURLs=null,this.FHamburgerMenu=null,this.FImageSize=0,this.FSubmenuIndicator=""},this.$final=function(){this.FOwner=void 0,this.FImageURLs=void 0,this.FHamburgerMenu=void 0,pas.Classes.TPersistent.$final.call(this)},this.SetBackgroundColor=function(t){this.FBackgroundColor!==t&&(this.FBackgroundColor=t,this.FOwner.UpdateElement())},this.SetHoverColor=function(t){this.FHoverColor!==t&&(this.FHoverColor=t,this.FOwner.UpdateElement())},this.SetHoverFontColor=function(t){this.FHoverFontColor!==t&&(this.FHoverFontColor=t,this.FOwner.UpdateElement())},this.SetImageURLs=function(t){this.FImageURLs.Assign(t)},this.SetImageSize=function(t){this.FImageSize!==t&&(this.FImageSize=t,this.FOwner.UpdateElement())},this.SetSubmenuIndicator=function(t){this.FSubmenuIndicator!==t&&(this.FSubmenuIndicator=t,this.FOwner.UpdateElement())},this.HandleImageURLsChanged=function(t){this.FOwner.UpdateElement()},this.Create$1=function(e){return this.FBackgroundColor=15790320,this.FHoverColor=14120960,this.FHoverFontColor=197379,this.FHamburgerMenu=t.THamburgerMenu.$create("Create$1",[this]),this.FImageURLs=pas.Classes.TStringList.$create("Create$1"),this.FImageURLs.SetSkipLastLineBreak(!0),this.FImageURLs.FOnChange=rtl.createCallback(this,"HandleImageURLsChanged"),this.FImageSize=16,this.FSubmenuIndicator="&#9658;",this.FOwner=e,this},this.Destroy=function(){rtl.free(this,"FHamburgerMenu"),rtl.free(this,"FImageURLs"),pas.System.TObject.Destroy.call(this)},this.Assign=function(e){pas.Classes.TPersistent.Assign.apply(this,arguments),t.TMainMenu.isPrototypeOf(e)&&(this.FBackgroundColor=rtl.as(e,t.TMainMenuAppearance).FBackgroundColor,this.FHoverColor=rtl.as(e,t.TMainMenuAppearance).FHoverColor,this.FHoverFontColor=rtl.as(e,t.TMainMenuAppearance).FHoverFontColor,this.FHamburgerMenu.Assign(rtl.as(e,t.TMainMenuAppearance).FHamburgerMenu),this.FImageURLs.Assign(rtl.as(e,t.TMainMenuAppearance).FImageURLs),this.FImageSize=rtl.as(e,t.TMainMenuAppearance).FImageSize,this.FSubmenuIndicator=rtl.as(e,t.TMainMenuAppearance).FSubmenuIndicator)},this.GetOwner=function(){return this.FOwner};var e=this.$rtti;e.addProperty("BackgroundColor",2,pas["WEBLib.Graphics"].$rtti.TColor,"FBackgroundColor","SetBackgroundColor",{Default:15790320}),e.addProperty("HamburgerMenu",0,t.$rtti.THamburgerMenu,"FHamburgerMenu","FHamburgerMenu"),e.addProperty("HoverColor",2,pas["WEBLib.Graphics"].$rtti.TColor,"FHoverColor","SetHoverColor",{Default:14120960}),e.addProperty("HoverFontColor",2,pas["WEBLib.Graphics"].$rtti.TColor,"FHoverFontColor","SetHoverFontColor",{Default:197379}),e.addProperty("ImageURLs",2,pas.Classes.$rtti.TStringList,"FImageURLs","SetImageURLs"),e.addProperty("ImageSize",2,rtl.longint,"FImageSize","SetImageSize",{Default:16}),e.addProperty("SubmenuIndicator",2,rtl.string,"FSubmenuIndicator","SetSubmenuIndicator")})),rtl.createClass(this,"TCustomMainMenu",pas["WEBLib.Controls"].TCustomControl,(function(){this.$init=function(){pas["WEBLib.Controls"].TCustomControl.$init.call(this),this.FItems=null,this.FOnChange=null},this.$final=function(){this.FItems=void 0,this.FOnChange=void 0,pas["WEBLib.Controls"].TCustomControl.$final.call(this)},this.Loaded=function(){pas["WEBLib.Controls"].TCustomControl.Loaded.call(this),this.IsUpdating()||null!=this.GetElementHandle()&&this.UpdateElement()},this.UpdateElement=function(){pas["WEBLib.Controls"].TControl.UpdateElement.call(this),this.IsUpdating()},this.GetUniqueName=function(t){var i="",s=0,o=0,n=!1;o=1,""===t&&(t=this.FName+"item"),t=e.MakeValidName(t);do{i=t+pas.SysUtils.IntToStr(o),n=!0;for(var r=0,a=this.FOwner.GetComponentCount()-1;r<=a;r++)if(s=r,this.FOwner.GetComponent(s).FName===i){n=!1,o+=1;break}}while(!n);return i},this.SetName=function(t){pas["WEBLib.Controls"].TCustomControl.SetName.apply(this,arguments),this.IsUpdating()||0 in this.FComponentState||this.UpdateElement()},this.CreateInitialize=function(){pas["WEBLib.Controls"].TCustomControl.CreateInitialize.call(this),this.FItems=t.TMenuItem.$create("Create$1",[this]),this.FItems.FParentMenu=this,this.SetWidthStyle(2),this.SetHeight(30)},this.Destroy=function(){rtl.free(this,"FItems"),pas["WEBLib.Controls"].TCustomControl.Destroy.call(this)},this.GetChildren=function(t,e){var i=0;if(null!=this.FItems&&null!=this.FItems.FItems)for(var s=0,o=this.FItems.FItems.GetCount()-1;s<=o;s++)i=s,t(this.FItems.FItems.GetItem(i))},this.SetChildOrder=function(t,e){var i;(i=this.FItems.FItems.IndexOf(t))>=0&&e<this.FItems.FItems.GetCount()&&this.FItems.FItems.Move(i,e)},rtl.addIntf(this,pas.System.IUnknown);var i=this.$rtti;i.addProperty("Items",0,t.$rtti.TMenuItem,"FItems",""),i.addProperty("OnChange",0,t.$rtti.TMainMenuChangeEvent,"FOnChange","FOnChange")})),rtl.createClass(this,"TMainMenu",this.TCustomMainMenu,(function(){this.$init=function(){t.TCustomMainMenu.$init.call(this),this.FMenu=null,this.FMainMenu=!1,this.FMenuIndex=0,this.FAppearance=null,this.FContainer$1=null,this.FIsPopupMenu=!1,this.FShowPopup=!1,this.FElementItemClassName=""},this.$final=function(){this.FMenu=void 0,this.FAppearance=void 0,this.FContainer$1=void 0,t.TCustomMainMenu.$final.call(this)},this.HandleChange=function(t){var e=null,i=null;return!0,this.FIsPopupMenu&&(this.FShowPopup=!1,this.UpdateElement()),(e=t.target).hasAttribute("id")||(e=e.parentElement),null!=(i=this.GetItemByName(this.FItems,e.id))&&(i.FAutoCheck&&i.SetChecked(!i.FChecked),null!=this.FOnChange&&this.FOnChange(this,i,!1),i.Click()),!0},this.Loaded=function(){t.TCustomMainMenu.Loaded.call(this),this.IsUpdating()||(null==this.FContainer$1&&pas["WEBLib.Forms"].TCustomForm.isPrototypeOf(this.FParent)&&rtl.as(this.FParent,pas["WEBLib.Forms"].TCustomForm).FMenu===this&&(this.FContainer$1=this.FParent),null!=this.GetElementHandle()&&this.UpdateElement())},this.UpdateElement=function(){var e,i="",s="",o="",n="",r="",a=null,l=null,h=null,F=null,p=null,c=null,u=null;t.TCustomMainMenu.UpdateElement.call(this),this.IsUpdating()||null==this.GetElementHandle()&&null==this.FContainer$1||(null!=this.FContainer$1?(a=this.FContainer$1.GetElementHandle(),this.SetVisible(!1)):((a=this.GetElementHandle()).style.setProperty("top",pas.SysUtils.IntToStr(this.GetTop())+"px"),a.style.setProperty("left",pas.SysUtils.IntToStr(this.GetLeft())+"px"),4 in this.FComponentState&&null==this.FContainer$1&&this.GetElementHandle().style.setProperty("background-color","silver")),this.FMenu=a.firstChild,null!=this.FMenu&&this.FMenu.parentElement.removeChild(this.FMenu),3 in this.FComponentState||(this.FMenu=document.createElement("NAV"),this.FMenu.setAttribute("id",this.GetID()+"menu"),this.FMenu.innerHTML="",null!=this.FContainer$1&&(this.FMenu.style.setProperty("top","0"),this.FMenu.style.setProperty("left","0"),this.FMenu.style.setProperty("position","absolute"),this.FMenu.style.setProperty("width","100%"),this.FMenu.style.setProperty("z-index","999997")),a.innerHTML="",a.style.setProperty("overflow","visible"),0!==this.FAppearance.FHamburgerMenu.FVisible&&(r=this.FShowPopup?"block":"none",o="  #"+this.GetID()+"menu .main-menu {\r    display: block;\r  }\r  #"+this.GetID()+"menu #toggle-menu {\r    display: none;\r  }\r  #"+this.GetID()+"menu ul span.drop-label {\r    display: inline-block;\r  }\r  #"+this.GetID()+"menu li {\r    float: left;\r    border-width: 0 1px 0 0;\r  }\r  #"+this.GetID()+"menu .popup-menu li, \r  #"+this.GetID()+"menu .sub-menu li {\r    float: none;\r  }\r  #"+this.GetID()+"menu .sub-menu {\r    top: 100%;\r  }\r  #"+this.GetID()+"menu .popup-menu { \r    top: 0;\r  }\r  #"+this.GetID()+"menu .popup-menu, \r  #"+this.GetID()+"menu .sub-menu {\r    border-width: 0;\r    margin: 0;\r    position: absolute;\r    left: 0;\r    min-width: 12em;\r    z-index: 9999999;\r\t   white-space: nowrap;\r  }\r  #"+this.GetID()+"menu .sub-menu {\r    top: 100%;\r  }\r  #"+this.GetID()+"menu .popup-menu { \r    display: "+r+";\r  }\r  #"+this.GetID()+"menu .sub-menu,\r  #"+this.GetID()+'menu input[type="checkbox"]:checked + .popup-menu,\r  #'+this.GetID()+'menu input[type="checkbox"]:checked + .sub-menu {\r    display: none;\r  }\r  #'+this.GetID()+"menu .popup-menu li, \r  #"+this.GetID()+"menu .sub-menu li {\r    border-width: 1px;\r  }\r  #"+this.GetID()+"menu .popup-menu .sub-menu, \r  #"+this.GetID()+"menu .sub-menu .sub-menu {\r    top: 0;\r    left: 100%;\r  }\r  #"+this.GetID()+'menu li:hover > input[type="checkbox"] + .popup-menu, \r  #'+this.GetID()+'menu li:hover > input[type="checkbox"] + .sub-menu {\r    display: block;\r  }\r',2===this.FAppearance.FHamburgerMenu.FVisible&&(o="@media only screen and (min-width: "+pas.SysUtils.IntToStr(this.FAppearance.FHamburgerMenu.FResponsiveMaxWidth)+"px) {\r"+o+"}")),this.FAppearance.FImageSize>0&&(n="  width: "+pas.SysUtils.IntToStr(this.FAppearance.FImageSize)+"px;\r  height: "+pas.SysUtils.IntToStr(this.FAppearance.FImageSize)+"px;\r"),i="#"+this.GetID()+"menu ul {\r  margin: 0;\r  padding: 0;\r}\r#"+this.GetID()+"menu .main-menu {\r  display: none;\r}\r#"+this.GetID()+"menu .popup-menu {\r  display: block;\r}\r#"+this.GetID()+"menu label img.icon,#"+this.GetID()+"menu label span.checked {\r"+n+"  margin-right: 10px;\r  pointer-events: none;\r}\r#tm:checked + .main-menu {\r  display: block;\r}\r#"+this.GetID()+'menu input[type="checkbox"],\r#'+this.GetID()+"menu ul span.drop-label {\r  display: none;\r}\r#"+this.GetID()+"menu li,\r#"+this.GetID()+"menu #toggle-menu,\r#"+this.GetID()+"menu .popup-menu,\r#"+this.GetID()+"menu .sub-menu {\r  border-width: 1px;\r  border-style: solid;\r  border-color: rgba(0, 0, 0, .05);\r  border-bottom: 0px;\r  border-top: 0px;\r}\r#"+this.GetID()+"menu li,\r#"+this.GetID()+"menu #toggle-menu {\r  border-width: 0 0 3px;\r}\r#"+this.GetID()+"menu .popup-menu,\r#"+this.GetID()+"menu .sub-menu {\r  border-width: 1px 1px 0;\r  margin: 0 1em;\r}\r#"+this.GetID()+"menu .popup-menu li:first-child,\r#"+this.GetID()+"menu .sub-menu li:first-child {\r  border-top: 1px solid;\r  border-color: rgba(0, 0, 0, .05);\r}\r#"+this.GetID()+"menu .popup-menu li:last-child,\r#"+this.GetID()+"menu .sub-menu li:last-child {\r  border-bottom: 1px solid;\r  border-color: rgba(0, 0, 0, .05);\r}\r#"+this.GetID()+"menu li,\r#"+this.GetID()+"menu #toggle-menu,\r#"+this.GetID()+"menu li label {\r  position: relative;\r  display: block;\r}\r#"+this.GetID()+"menu #toggle-menu,\r#"+this.GetID()+"menu li label { \r  padding: 0.75em 1.5em;\r  text-decoration: none;\r}\r#"+this.GetID()+"menu li span.menu-separator { \r  display: block;\r  width: 100%;\r  height: 1px;\r  background-color: rgba(0, 0, 0, .05);\r}\r#"+this.GetID()+"menu .popup-menu, \r#"+this.GetID()+"menu .sub-menu {\r  display: none;\r}\r#"+this.GetID()+'menu input[type="checkbox"]:checked + .popup-menu,\r#'+this.GetID()+'menu input[type="checkbox"]:checked + .sub-menu {\r  display: block;\r  z-index: 3000;\r}\r#'+this.GetID()+"menu span.drop-icon {\r  margin-left: 10px;}\r#"+this.GetID()+"menu span.hamburger-icon {\r  float: right;\r  padding: 0;\r  margin: 0;\r  font-weight: 900;\r}\r@media only screen and (max-width: 64em) and (min-width: 52.01em) {\r  #"+this.GetID()+"menu li {\r    width: auto;\r  }\r  #"+this.GetID()+"menu .sub-menu li {\r    width: auto;\r  }\r}\r",s="",""===this.FElementClassName&&(s="#"+this.GetID()+"menu .popup-menu, \r#"+this.GetID()+"menu .sub-menu {\r  background-color: "+pas["WEBLib.Graphics"].ColorToHTML(this.FAppearance.FBackgroundColor)+";\r}\r@media only screen and (max-width: 64em) and (min-width: 52.01em) {\r#"+this.GetID()+"menu .sub-menu {\r  background-color: "+pas["WEBLib.Graphics"].ColorToHTML(this.FAppearance.FHamburgerMenu.FBackgroundColor)+";\r}\r}\r#"+this.GetID()+"menu li,\r#"+this.GetID()+"menu #toggle-menu,\r#"+this.GetID()+"menu li label {\r}\r#"+this.GetID()+"menu #toggle-menu {\r  background-color: "+pas["WEBLib.Graphics"].ColorToHTML(this.FAppearance.FHamburgerMenu.FBackgroundColor)+";\r  color: "+pas["WEBLib.Graphics"].ColorToHTML(this.FAppearance.FHamburgerMenu.FCaptionColor)+";\r}\r#"+this.GetID()+"menu .main-menu li label {\r  background-color: "+pas["WEBLib.Graphics"].ColorToHTML(this.FAppearance.FBackgroundColor)+";\r}\r#"+this.GetID()+"menu li label:hover {\r  background-color: "+pas["WEBLib.Graphics"].ColorToHTML(this.FAppearance.FHoverColor)+";\r  color: "+pas["WEBLib.Graphics"].ColorToHTML(this.FAppearance.FHoverFontColor)+";\r}\r#"+this.GetID()+"menu .popup-menu label:hover, \r#"+this.GetID()+"menu .sub-menu label:hover {\r  background-color: "+pas["WEBLib.Graphics"].ColorToHTML(this.FAppearance.FHoverColor)+";\r  color: "+pas["WEBLib.Graphics"].ColorToHTML(this.FAppearance.FHoverFontColor)+";\r}\r"),i=i+s+o,this.FMainMenu=!0,this.FMenuIndex=0,(c=document.createElement("STYLE")).innerHTML=i,(u=document.createElement("SCRIPT")).innerHTML="function "+this.GetID()+'MenuClick(ctrl){  el = ctrl.parentElement.parentElement;  el.style.display = "none";  setTimeout(function(){el.style.removeProperty("display")}, 25);}function '+this.GetID()+'MenuOut(ctrl){  menuel = document.getElementById("'+this.GetID()+'");  if(menuel) {     popupel = menuel.getElementsByClassName("popup-menu");    if(popupel)       setTimeout(function(){popupel[0].style.display = "none"}, 25);  }}',(l=document.createElement("LABEL")).setAttribute("for","tm"),l.setAttribute("id","toggle-menu"),l.innerHTML=this.FAppearance.FHamburgerMenu.FCaption,h=document.createElement("SPAN"),""!==this.FElementItemClassName?h.setAttribute("class",this.FElementItemClassName):h.setAttribute("class","drop-label"),l.appendChild(h),(F=document.createElement("SPAN")).setAttribute("class","hamburger-icon"),F.innerHTML="&#9776;",h.appendChild(F),(p=document.createElement("INPUT")).setAttribute("type","checkbox"),p.setAttribute("id","tm"),this.FMenu.appendChild(c),this.FMenu.appendChild(u),this.FMenu.appendChild(l),this.FMenu.appendChild(p),null!==(e=this.GetMenuSource(this.FItems))&&this.FMenu.appendChild(e),a.appendChild(this.FMenu)))},this.GetMenuSource=function(t){var i=null,s=0,o=null,n="",r=null,a=null,l=null,h=null,F=0,p="";if(i=null,null!=t.FItems&&t.FItems.GetCount()>0){i=document.createElement("UL"),this.FMainMenu?(this.FMainMenu=!1,n=this.FIsPopupMenu?"popup-menu":"main-menu"):n="sub-menu",this.FMenuIndex=this.FMenuIndex+1,i.setAttribute("class",n);for(var c=0,u=t.FItems.GetCount()-1;c<=u;c++)s=c,F+=1,""===(o=t.FItems.GetItem(s)).FName&&(p=pas.SysUtils.StringReplace(o.FCaption," ","",rtl.createSet(0)),""===(p=e.MakeValidName(p))&&(p="MenuItem"+pas.SysUtils.IntToStr(F)),o.SetName(p+pas.SysUtils.IntToStr(F))),o.FVisible&&(r=document.createElement("LI"),"-"!==o.FCaption?(a=document.createElement("LABEL"),""!==this.FElementItemClassName?a.setAttribute("class",this.FElementItemClassName):a.setAttribute("class","drop-label"),a.setAttribute("title",o.FHint),o.FImageIndex>=0&&this.FAppearance.FImageURLs.GetCount()>o.FImageIndex?a.innerHTML='<img class="icon" src="'+this.FAppearance.FImageURLs.Get(o.FImageIndex)+'">':o.FChecked&&(o.FRadioItem?a.innerHTML='<span class="checked">&#9679;</span>':a.innerHTML='<span class="checked">&#10004;</span>'),a.innerHTML=a.innerHTML+o.FCaption):((a=document.createElement("SPAN")).setAttribute("class","menu-separator"),a.innerHTML=""),null!=o.FItems&&o.FItems.GetCount()>0?((h=document.createElement("SPAN")).setAttribute("class","drop-icon"),h.innerHTML=this.FAppearance.FSubmenuIndicator,a.setAttribute("for","sm"+pas.SysUtils.IntToStr(this.FMenuIndex)),a.appendChild(h),o.FEnabled||a.style.setProperty("color","gray"),(l=document.createElement("INPUT")).setAttribute("type","checkbox"),l.setAttribute("id","sm"+pas.SysUtils.IntToStr(this.FMenuIndex)),r.appendChild(a),r.appendChild(l),o.FEnabled&&r.appendChild(this.GetMenuSource(o))):(a.setAttribute("for","tm"),a.setAttribute("id",o.FName),o.FEnabled?("sub-menu"===n&&o.FEnabled&&a.setAttribute("onMouseUp",this.GetID()+"MenuClick(this);"),a.addEventListener("click",rtl.createSafeCallback(this,"HandleChange"))):a.style.setProperty("color","gray"),r.appendChild(a)),i.appendChild(r))}return i},this.GetItemByName=function(t,e){var i=null,s=0,o=null;if(i=null,null!=t.FItems)for(var n=0,r=t.FItems.GetCount()-1;n<=r;n++){if(s=n,(o=t.FItems.GetItem(s)).FName===e)return i=o,null!=o.FOnClick&&(i.FOnClick=o.FOnClick),i;null==i&&(i=this.GetItemByName(o,e))}return i},this.CreateInitialize=function(){t.TCustomMainMenu.CreateInitialize.call(this),this.FAppearance=t.TMainMenuAppearance.$create("Create$1",[this]),this.FContainer$1=null,this.FMainMenu=!0,this.FMenuIndex=0,this.FIsPopupMenu=!1,this.FShowPopup=!1,this.SetTop(0),this.SetLeft(0),this.SetWidth(100),4 in this.FComponentState&&(this.SetElementPosition(1),this.SetWidthPercent(100),this.SetWidthStyle(0))},this.CreateElement=function(){var t=null,e=null;return 4 in this.FComponentState?(t=document.createElement("DIV"),(e=document.createElement("DIV")).innerHTML="TWebMainMenu",this.SetBorderStyle(1),e.setAttribute("align","center"),e.style.setProperty("border","1px solid gray"),e.style.setProperty("vertical-align","middle"),e.style.setProperty("display","table-cell"),t.appendChild(e)):(t=document.createElement("DIV"),this.FIsPopupMenu&&t.setAttribute("onMouseLeave",this.GetID()+"MenuOut(this);")),t},this.Destroy=function(){rtl.free(this,"FAppearance"),t.TCustomMainMenu.Destroy.call(this)},rtl.addIntf(this,pas.System.IUnknown);var i=this.$rtti;i.addProperty("Appearance",0,t.$rtti.TMainMenuAppearance,"FAppearance","FAppearance"),i.addProperty("Container",0,pas["WEBLib.Controls"].$rtti.TControl,"FContainer$1","FContainer$1"),i.addProperty("ElementFont",2,pas["WEBLib.Controls"].$rtti.TElementFont,"FElementFont","SetElementFont",{Default:pas["WEBLib.Controls"].TElementFont.efProperty}),i.addProperty("ElementClassName",2,pas["WEBLib.Controls"].$rtti.TElementClassName,"FElementClassName","SetElementClassName"),i.addProperty("ElementItemClassName",0,pas["WEBLib.Controls"].$rtti.TElementClassName,"FElementItemClassName","FElementItemClassName"),i.addProperty("Font",2,pas["WEBLib.Graphics"].$rtti.TFont,"FFont","SetFont"),i.addProperty("ParentFont",2,rtl.boolean,"FParentFont","SetParentFont",{Default:!0})})),rtl.createClass(this,"TPopupMenu",this.TMainMenu,(function(){this.$init=function(){t.TMainMenu.$init.call(this),this.FOnPopup=null},this.$final=function(){this.FOnPopup=void 0,t.TMainMenu.$final.call(this)},this.Create$1=function(t){return pas["WEBLib.Controls"].TControl.Create$1.apply(this,arguments),pas["WEBLib.Controls"].TControl.isPrototypeOf(t)&&this.SetParent(t),this},this.CreateInitialize=function(){t.TMainMenu.CreateInitialize.call(this),this.FAppearance.FHamburgerMenu.SetVisible(1),this.FIsPopupMenu=!0},this.Popup=function(t,e){null!=this.FOnPopup&&this.FOnPopup(this),this.SetTop(e),this.SetLeft(t),this.FShowPopup=!0,this.UpdateElement(),this.FShowPopup=!1},rtl.addIntf(this,pas.System.IUnknown),this.$rtti.addProperty("OnPopup",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnPopup","FOnPopup")})),rtl.createClass(this,"TWebPopupMenu",this.TPopupMenu,(function(){rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TWebCustomControl",pas["WEBLib.Controls"].TCustomControl,(function(){this.$init=function(){pas["WEBLib.Controls"].TCustomControl.$init.call(this),this.FPopupMenu=null},this.$final=function(){this.FPopupMenu=void 0,pas["WEBLib.Controls"].TCustomControl.$final.call(this)},this.HandleDoContextMenu=function(t){var e=!1,i=pas.Types.TPoint.$new(),s=null,o=null;return pas["WEBLib.Controls"].TControl.HandleDoContextMenu.apply(this,arguments),null!=this.FPopupMenu&&(t.stopPropagation(),t.preventDefault(),i.$assign(pas.Types.Point(Math.round(t.clientX),Math.round(t.clientY))),null!=(s=pas["WEBLib.Forms"].GetParentForm(this))&&null!=s.GetContainer()&&(o=s.GetContainer().getBoundingClientRect(),i.x=i.x-Math.round(o.left),i.y=i.y-Math.round(o.top)),this.FPopupMenu.Popup(i.x,i.y),e=!0),e},this.Notification=function(t,e){pas.Classes.TComponent.Notification.apply(this,arguments),1===e&&t===this.FPopupMenu&&(this.FPopupMenu=null)},rtl.addIntf(this,pas.System.IUnknown)})),t.$implcode=function(){var t=rtl.createSet(null,65,90,null,97,122,95),i=rtl.unionSet(t,rtl.createSet(null,48,57));e.MakeValidName=function(t){var e="",s=0;e="";for(var o=1,n=t.length;o<=n;o++)s=o,t.charCodeAt(s-1)in i&&(e+=t.charAt(s-1));return e}}}),["Types","WEBLib.Forms"]),rtl.module("WEBLib.WebCtrls",["System","Classes","WEBLib.Controls","WEBLib.Graphics","SysUtils","Web","JS","WEBLib.Menus"],(function(){"use strict";rtl.createClass(this,"TYoutube",pas["WEBLib.Controls"].TCustomControl,(function(){this.$init=function(){pas["WEBLib.Controls"].TCustomControl.$init.call(this),this.FVideoID="",this.FAllowFullScreen=!1,this.FAutoPlay=!1},this.SetAllowFullScreen=function(t){this.FAllowFullScreen=t,this.UpdateElement()},this.SetVideoID=function(t){this.FVideoID=t,this.UpdateElement()},this.CreateElement=function(){var t=null,e=null;return 4 in this.FComponentState?((e=document.createElement("DIV")).style.setProperty("background-color","slategray"),e.style.setProperty("background-repeat","no-repeat"),e.style.setProperty("background-position-y","center"),e.style.setProperty("background-image","url(data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiA/PjxzdmcgdmVyc2lvbj0iMS4xIiB2aWV3Qm94PSIwIDAuNDc5OTk5OTU5NDY4ODQyIDE2OS43MDk4NjkzODQ3NjYgMTE5LjA4NTYyODA5MjI4OSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+PGRlZnM+PGxpbmVhckdyYWRpZW50IGlkPSJkZWYwIiB4MT0iMC41IiB4Mj0iMC41IiB5MT0iMSIgeTI9IjMuMTAwNzJFLTA2Ij48c3RvcCBvZmZzZXQ9IjAiIHN0b3AtY29sb3I9IiNGRjAwMDAiLz48c3RvcCBvZmZzZXQ9IjEiIHN0b3AtY29sb3I9IiNGRjZCMDAiLz48L2xpbmVhckdyYWRpZW50PjwvZGVmcz48Zz48cGF0aCBkPSJNMzEuMDI5MywxLjc3NzM0QzEzLjE0MjcsMi45OTQ2Nyw0LjE1NDY3LDYuMTIsMS40ODgsMjguNzkzM0wxLjQ4OCwyOC43OTMzQzAuNTA2NjY3LDM3LjEzNiwwLjAwOTMzMzMzLDQ4LjQwMTMsMCw1OS42OTg3TDAsNjAuMzQ1M0MwLjAwOTMzMzMzLDcxLjYyOTMsMC41MDQsODIuODg5MywxLjQ4OCw5MS4yNTA3TDEuNDg4LDkxLjI1MDdDNC4xNTQ2NywxMTMuOTI3LDEzLjE0MjcsMTE3LjA1MiwzMS4wMjkzLDExOC4yNjdMMzEuMDI5MywxMTguMjY3QzU2LjQ3NzMsMTIwLDExMy4yNTEsMTE5Ljk5NywxMzguNjgsMTE4LjI2N0wxMzguNjgsMTE4LjI2N0MxNTYuNTY4LDExNy4wNTIsMTY1LjU1NSwxMTMuOTI3LDE2OC4yMjMsOTEuMjUwN0wxNjguMjIzLDkxLjI1MDdDMTcwLjIwMyw3NC40MTczLDE3MC4yMDgsNDUuNjg2NywxNjguMjIzLDI4Ljc5MzNMMTY4LjIyMywyOC43OTMzQzE2NS41NTUsNi4xMTg2OCwxNTYuNTY4LDIuOTk0NjcsMTM4LjY4LDEuNzc3MzRMMTM4LjY4LDEuNzc3MzRDMTI1Ljk2MywwLjkxMjAxLDEwNS4zOTcsMC40ODAwMDMsODQuODQsMC40ODAwMDNMODQuODQsMC40ODAwMDNDNjQuMjkyLDAuNDc4Njc2LDQzLjc1MDcsMC45MTIwMSwzMS4wMjkzLDEuNzc3MzR6IiBmaWxsPSJ1cmwoI2RlZjApIi8+PHBhdGggZD0iTTEwOC40MjUsNjAuMDIyN0w2Mi4yNDE5LDkxLjk0NjcgNjIuMjQxOSwyOC4wOTg3IDEwOC40MjUsNjAuMDIyN3oiIGZpbGw9IiNGRkZGRkYiLz48L2c+PC9zdmc+)"),e.style.setProperty("background-position-x","center"),e.style.setProperty("background-size","128px"),t=e):((t=document.createElement("IFRAME")).setAttribute("id",this.GetID()),t.setAttribute("frameborder","0")),t},this.UpdateElement=function(){var t="";pas["WEBLib.Controls"].TControl.UpdateElement.call(this),this.IsUpdating()||(4 in this.FComponentState&&null!=this.GetElementHandle()&&this.GetElementHandle().style.setProperty("background-color","slategray"),null!=this.GetContainer()&&(""!==this.FVideoID&&(t="https://www.youtube.com/embed/"+this.FVideoID,this.FAutoPlay&&(t+="?autoplay=1"),this.GetContainer().setAttribute("src",t)),this.FAllowFullScreen?this.GetContainer().setAttribute("allowfullscreen","allowfullscreen"):this.GetContainer().removeAttribute("allowfullscreen")))},this.UpdateElementVisual=function(){pas["WEBLib.Controls"].TCustomControl.UpdateElementVisual.call(this),this.IsUpdating()||4 in this.FComponentState&&null!=this.GetElementHandle()&&this.GetElementHandle().style.setProperty("background-color","slategray")},this.CreateInitialize=function(){pas["WEBLib.Controls"].TCustomControl.CreateInitialize.call(this),this.SetWidth(400),this.SetHeight(300)},rtl.addIntf(this,pas.System.IUnknown);var t=this.$rtti;t.addProperty("Align",2,pas["WEBLib.Controls"].$rtti.TAlign,"FAlign","SetAlign",{Default:pas["WEBLib.Controls"].TAlign.alNone}),t.addProperty("AllowFullScreen",2,rtl.boolean,"FAllowFullScreen","SetAllowFullScreen"),t.addProperty("AutoPlay",0,rtl.boolean,"FAutoPlay","FAutoPlay"),t.addProperty("VideoID",2,rtl.string,"FVideoID","SetVideoID")})),rtl.createClass(this,"THTMLDiv",pas["WEBLib.Controls"].TCustomControl,(function(){this.$init=function(){pas["WEBLib.Controls"].TCustomControl.$init.call(this),this.FHTML=null,this.FOldText=""},this.$final=function(){this.FHTML=void 0,pas["WEBLib.Controls"].TCustomControl.$final.call(this)},this.SetHTML=function(t){this.FHTML.Assign(t)},this.UpdateElementData=function(){pas["WEBLib.Controls"].TControl.UpdateElementData.call(this),null!=this.GetElementHandle()?(""===this.FOldText&&""===this.FHTML.GetTextStr()||(this.GetElementHandle().innerHTML=this.FHTML.GetTextStr()),this.FOldText=this.FHTML.GetTextStr()):!this.GetIsLinked()&&4 in this.FComponentState&&this.RenderDesigning(this.$classname,this.GetContainer(),this,!0,"")},this.HTMLChanged=function(t){this.UpdateElementData()},this.CreateElement=function(){return document.createElement("DIV")},this.CreateInitialize=function(){this.FHTML=pas.Classes.TStringList.$create("Create$1"),this.FHTML.SetSkipLastLineBreak(!0),rtl.as(this.FHTML,pas.Classes.TStringList).FOnChange=rtl.createCallback(this,"HTMLChanged"),pas["WEBLib.Controls"].TCustomControl.CreateInitialize.call(this),this.FControlStyle=rtl.unionSet(this.FControlStyle,rtl.createSet(0)),this.SetClipChildren(!1),this.SetTabStop(!1)},this.Destroy=function(){rtl.free(this,"FHTML"),pas["WEBLib.Controls"].TCustomControl.Destroy.call(this)},rtl.addIntf(this,pas.System.IUnknown);var t=this.$rtti;t.addProperty("Align",2,pas["WEBLib.Controls"].$rtti.TAlign,"FAlign","SetAlign",{Default:pas["WEBLib.Controls"].TAlign.alNone}),t.addProperty("AlignWithMargins",2,rtl.boolean,"FAlignWithMargins","SetAlignWithMargins",{Default:!1}),t.addProperty("Anchors",2,pas["WEBLib.Controls"].$rtti.TAnchors,"FAnchors","SetAnchors",{Default:rtl.createSet(0,1)}),t.addProperty("ChildOrder",2,rtl.longint,"FChildOrder","SetChildOrderEx",{Default:0}),t.addProperty("DragMode",2,pas["WEBLib.Controls"].$rtti.TDragMode,"FDragMode","SetDragMode",{Default:pas["WEBLib.Controls"].TDragMode.dmManual}),t.addProperty("ElementClassName",2,pas["WEBLib.Controls"].$rtti.TElementClassName,"FElementClassName","SetElementClassName"),t.addProperty("ElementFont",2,pas["WEBLib.Controls"].$rtti.TElementFont,"FElementFont","SetElementFont",{Default:pas["WEBLib.Controls"].TElementFont.efProperty}),t.addProperty("ElementID",3,pas["WEBLib.Controls"].$rtti.TElementID,"GetID","SetID"),t.addProperty("ElementPosition",2,pas["WEBLib.Controls"].$rtti.TElementPosition,"FElementPosition","SetElementPosition",{Default:pas["WEBLib.Controls"].TElementPosition.epAbsolute}),t.addProperty("HeightPercent",2,rtl.double,"FHeightPercent","SetHeightPercent",{Default:100}),t.addProperty("HeightStyle",2,pas["WEBLib.Controls"].$rtti.TSizeStyle,"FHeightStyle","SetHeightStyle",{Default:pas["WEBLib.Controls"].TSizeStyle.ssAbsolute}),t.addProperty("HTML",2,pas.Classes.$rtti.TStrings,"FHTML","SetHTML"),t.addProperty("Role",3,rtl.string,"GetRole","SetRole"),t.addProperty("Visible",2,rtl.boolean,"FVisible","SetVisible",{Default:!0}),t.addProperty("WidthPercent",2,rtl.double,"FWidthPercent","SetWidthPercent",{Default:100}),t.addProperty("WidthStyle",2,pas["WEBLib.Controls"].$rtti.TSizeStyle,"FWidthStyle","SetWidthStyle",{Default:pas["WEBLib.Controls"].TSizeStyle.ssAbsolute}),t.addProperty("OnClick",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnClick","FOnClick"),t.addProperty("OnDblClick",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnDblClick","FOnDblClick"),t.addProperty("OnMouseDown",0,pas["WEBLib.Controls"].$rtti.TMouseEvent,"FOnMouseDown","FOnMouseDown"),t.addProperty("OnMouseUp",0,pas["WEBLib.Controls"].$rtti.TMouseEvent,"FOnMouseUp","FOnMouseUp"),t.addProperty("OnMouseMove",0,pas["WEBLib.Controls"].$rtti.TMouseMoveEvent,"FOnMouseMove","FOnMouseMove"),t.addProperty("OnMouseLeave",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnMouseLeave","FOnMouseLeave"),t.addProperty("OnMouseEnter",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnMouseEnter","FOnMouseEnter"),t.addProperty("OnTouchStart",0,pas["WEBLib.Controls"].$rtti.TTouchEvent,"FOnTouchStart","FOnTouchStart"),t.addProperty("OnTouchEnd",0,pas["WEBLib.Controls"].$rtti.TTouchEvent,"FOnTouchEnd","FOnTouchEnd"),t.addProperty("OnTouchMove",0,pas["WEBLib.Controls"].$rtti.TTouchEvent,"FOnTouchMove","FOnTouchMove"),t.addProperty("OnTouchCancel",0,pas["WEBLib.Controls"].$rtti.TTouchEvent,"FOnTouchCancel","FOnTouchCancel"),t.addProperty("OnDragDrop",0,pas["WEBLib.Controls"].$rtti.TDragDropEvent,"FOnDragDrop","FOnDragDrop"),t.addProperty("OnDragOver",0,pas["WEBLib.Controls"].$rtti.TDragOverEvent,"FOnDragOver","FOnDragOver"),t.addProperty("OnEndDrag",0,pas["WEBLib.Controls"].$rtti.TEndDragEvent,"FonEndDrag","FonEndDrag"),t.addProperty("OnStartDrag",0,pas["WEBLib.Controls"].$rtti.TStartDragEvent,"FOnStartDrag","FOnStartDrag")}))}),["WEBLib.Dialogs","WEBLib.WebTools"]),rtl.module("WEBLib.Consts",["System"],(function(){"use strict";this.$resourcestrings={SWarning:{org:"Warning"},SError:{org:"Error"},SInformation:{org:"Information"},SConfirm:{org:"Confirm"},SOK:{org:"OK"},SCancel:{org:"Cancel"},SYes:{org:"Yes"},SNo:{org:"No"},SAbort:{org:"Abort"},SRetry:{org:"Retry"},SIgnore:{org:"Ignore"},SHelp:{org:"Help"},SClose:{org:"Close"},SAll:{org:"All"},SYesToAll:{org:"Yes to all"},SNoToAll:{org:"No to all"},SWarningFR:{org:"Avertissement"},SErrorFR:{org:"Erreur"},SInformationFR:{org:"Information"},SConfirmFR:{org:"Confirmer"},SOKFR:{org:"OK"},SCancelFR:{org:"Annuler"},SYesFR:{org:"Oui"},SNoFR:{org:"Non"},SAbortFR:{org:"Interrompre"},SRetryFR:{org:"Réessayer"},SIgnoreFR:{org:"Ignorer"},SHelpFR:{org:"Aide"},SCloseFR:{org:"Fermer"},SAllFR:{org:"Tout"},SYesToAllFR:{org:"Oui à tout"},SNoToAllFR:{org:"Non à tout"},SWarningDE:{org:"Warnung"},SErrorDE:{org:"Fehler"},SInformationDE:{org:"Information"},SConfirmDE:{org:"Bestätigen"},SOKDE:{org:"OK"},SCancelDE:{org:"Verzögern"},SYesDE:{org:"Ja"},SNoDE:{org:"Nein"},SAbortDE:{org:"Abbrechen"},SRetryDE:{org:"Wiederholen"},SIgnoreDE:{org:"Ignorieren"},SHelpDE:{org:"Hilfe"},SCloseDE:{org:"Schließen"},SAllDE:{org:"Alles"},SYesToAllDE:{org:"Ja auf Alles"},SNoToAllDE:{org:"Nein auf Alles"},SWarningES:{org:"Advertencia"},SErrorES:{org:"Error"},SInformationES:{org:"Información"},SConfirmES:{org:"Confirmado"},SOKES:{org:"OK"},SCancelES:{org:"Cancelar"},SYesES:{org:"Sí"},SNoES:{org:"No"},SAbortES:{org:"Abortar"},SRetryES:{org:"Rever"},SIgnoreES:{org:"Ignorar"},SHelpES:{org:"Ayudar"},SCloseES:{org:"Cerrar"},SAllES:{org:"Todos"},SYesToAllES:{org:"Sí a todo"},SNoToAllES:{org:"No a todo"},SWarningNL:{org:"Waarschuwing"},SErrorNL:{org:"Fout"},SInformationNL:{org:"Informatie"},SConfirmNL:{org:"Bevestiging"},SOKNL:{org:"OK"},SCancelNL:{org:"Afbreken"},SYesNL:{org:"Ja"},SNoNL:{org:"Nee"},SAbortNL:{org:"Afbreken"},SRetryNL:{org:"Opnieuw"},SIgnoreNL:{org:"Negeren"},SHelpNL:{org:"Hulp"},SCloseNL:{org:"Sluiten"},SAllNL:{org:"Alles"},SYesToAllNL:{org:"Ja op alles"},SNoToAllNL:{org:"Nee op alles"}}})),rtl.module("WEBLib.Dialogs",["System","Classes","WEBLib.Controls","Web","JS","SysUtils","WEBLib.WebTools","WEBLib.WebCtrls","WEBLib.Graphics"],(function(){"use strict";var t=this,e=t.$impl;this.TMsgDlgType={0:"mtWarning",mtWarning:0,1:"mtError",mtError:1,2:"mtInformation",mtInformation:2,3:"mtConfirmation",mtConfirmation:3,4:"mtCustom",mtCustom:4},this.$rtti.$Enum("TMsgDlgType",{minvalue:0,maxvalue:4,ordtype:1,enumtype:this.TMsgDlgType}),this.TMsgDlgBtn={0:"mbYes",mbYes:0,1:"mbNo",mbNo:1,2:"mbOK",mbOK:2,3:"mbCancel",mbCancel:3,4:"mbAbort",mbAbort:4,5:"mbRetry",mbRetry:5,6:"mbIgnore",mbIgnore:6,7:"mbAll",mbAll:7,8:"mbNoToAll",mbNoToAll:8,9:"mbYesToAll",mbYesToAll:9,10:"mbHelp",mbHelp:10,11:"mbClose",mbClose:11},this.$rtti.$Enum("TMsgDlgBtn",{minvalue:0,maxvalue:11,ordtype:1,enumtype:this.TMsgDlgBtn}),this.$rtti.$Set("TMsgDlgButtons",{comptype:this.$rtti.TMsgDlgBtn}),rtl.createClass(this,"TCustomDialogButton",pas.Classes.TCollectionItem,(function(){this.$init=function(){pas.Classes.TCollectionItem.$init.call(this),this.FCaption="",this.FTag=0,this.FElementClassName=""};var t=this.$rtti;t.addProperty("Caption",0,rtl.string,"FCaption","FCaption"),t.addProperty("ElementClassName",0,pas["WEBLib.Controls"].$rtti.TElementClassName,"FElementClassName","FElementClassName"),t.addProperty("Tag",0,rtl.longint,"FTag","FTag",{Default:0})})),rtl.createClass(this,"TCustomDialogButtons",pas.Classes.TOwnedCollection,(function(){this.GetItem$1=function(t){return this.GetItem(t)}})),rtl.createClass(this,"TMessageDlg",pas["WEBLib.Controls"].TCustomControl,(function(){this.$init=function(){pas["WEBLib.Controls"].TCustomControl.$init.call(this),this.FOpacity=0,this.FLayer$1=null,this.FDlg=null,this.FCancel=null,this.FMessage="",this.FTitle="",this.FMsgDlgType=0,this.FOnButtonClick=null,this.FOnClose=null,this.FButtons={},this.FDialogProc=null,this.FDialogResult=0,this.FMdx=0,this.FMdy=0,this.FDlgX=0,this.FDlgY=0,this.FCaptured$1=!1,this.FDown=!1,this.FElementTitleClassName="",this.FElementButtonClassName="",this.FElementContentClassName="",this.FDialogText=null,this.FCustomButtons=null,this.FElementDialogClassName="",this.FAutoLanguage=!1},this.$final=function(){this.FLayer$1=void 0,this.FDlg=void 0,this.FCancel=void 0,this.FOnButtonClick=void 0,this.FOnClose=void 0,this.FButtons=void 0,this.FDialogProc=void 0,this.FDialogText=void 0,this.FCustomButtons=void 0,pas["WEBLib.Controls"].TCustomControl.$final.call(this)},this.SetDialogText=function(t){this.FDialogText.Assign(t)},this.SetCustomButtons=function(t){this.FCustomButtons.Assign(t)},this.CreateElement=function(){var t=null;return 4 in this.FComponentState?t=null:pas["WEBLib.Controls"].TCustomControl.CreateElement.call(this),t};this.GetDialogText=function(t){var e="",i="",s=0;if(e="Undefined",t<this.FDialogText.GetCount()&&(e=this.FDialogText.Get(t)),this.FAutoLanguage){i=pas["WEBLib.WebTools"].GetBrowserLocale(),s=0,1===pas.System.Pos("es",i)&&(s=3),1===pas.System.Pos("fr",i)&&(s=1),1===pas.System.Pos("de",i)&&(s=2),1===pas.System.Pos("nl",i)&&(s=4);var o=s;if(3===o){var n=t;0===n?e=rtl.getResStr(pas["WEBLib.Consts"],"SWarningES"):1===n?e=rtl.getResStr(pas["WEBLib.Consts"],"SErrorES"):2===n?e=rtl.getResStr(pas["WEBLib.Consts"],"SInformationES"):3===n?e=rtl.getResStr(pas["WEBLib.Consts"],"SConfirmES"):5===n?e=rtl.getResStr(pas["WEBLib.Consts"],"SOKES"):6===n?e=rtl.getResStr(pas["WEBLib.Consts"],"SCancelES"):7===n?e=rtl.getResStr(pas["WEBLib.Consts"],"SYesES"):8===n?e=rtl.getResStr(pas["WEBLib.Consts"],"SNoES"):9===n?e=rtl.getResStr(pas["WEBLib.Consts"],"SAbortES"):10===n?e=rtl.getResStr(pas["WEBLib.Consts"],"SRetryES"):11===n?e=rtl.getResStr(pas["WEBLib.Consts"],"SIgnoreES"):12===n?e=rtl.getResStr(pas["WEBLib.Consts"],"SAllES"):13===n?e=rtl.getResStr(pas["WEBLib.Consts"],"SYesToAllES"):14===n?e=rtl.getResStr(pas["WEBLib.Consts"],"SNoToAllES"):15===n?e=rtl.getResStr(pas["WEBLib.Consts"],"SHelpES"):16===n&&(e=rtl.getResStr(pas["WEBLib.Consts"],"SCloseES"))}else if(1===o){var r=t;0===r?e=rtl.getResStr(pas["WEBLib.Consts"],"SWarningFR"):1===r?e=rtl.getResStr(pas["WEBLib.Consts"],"SErrorFR"):2===r?e=rtl.getResStr(pas["WEBLib.Consts"],"SInformationFR"):3===r?e=rtl.getResStr(pas["WEBLib.Consts"],"SConfirmFR"):5===r?e=rtl.getResStr(pas["WEBLib.Consts"],"SOKFR"):6===r?e=rtl.getResStr(pas["WEBLib.Consts"],"SCancelFR"):7===r?e=rtl.getResStr(pas["WEBLib.Consts"],"SYesFR"):8===r?e=rtl.getResStr(pas["WEBLib.Consts"],"SNoFR"):9===r?e=rtl.getResStr(pas["WEBLib.Consts"],"SAbortFR"):10===r?e=rtl.getResStr(pas["WEBLib.Consts"],"SRetryFR"):11===r?e=rtl.getResStr(pas["WEBLib.Consts"],"SIgnoreFR"):12===r?e=rtl.getResStr(pas["WEBLib.Consts"],"SAllFR"):13===r?e=rtl.getResStr(pas["WEBLib.Consts"],"SYesToAllFR"):14===r?e=rtl.getResStr(pas["WEBLib.Consts"],"SNoToAllFR"):15===r?e=rtl.getResStr(pas["WEBLib.Consts"],"SHelpFR"):16===r&&(e=rtl.getResStr(pas["WEBLib.Consts"],"SCloseFR"))}else if(2===o){var a=t;0===a?e=rtl.getResStr(pas["WEBLib.Consts"],"SWarningDE"):1===a?e=rtl.getResStr(pas["WEBLib.Consts"],"SErrorDE"):2===a?e=rtl.getResStr(pas["WEBLib.Consts"],"SInformationDE"):3===a?e=rtl.getResStr(pas["WEBLib.Consts"],"SConfirmDE"):5===a?e=rtl.getResStr(pas["WEBLib.Consts"],"SOKDE"):6===a?e=rtl.getResStr(pas["WEBLib.Consts"],"SCancelDE"):7===a?e=rtl.getResStr(pas["WEBLib.Consts"],"SYesDE"):8===a?e=rtl.getResStr(pas["WEBLib.Consts"],"SNoDE"):9===a?e=rtl.getResStr(pas["WEBLib.Consts"],"SAbortDE"):10===a?e=rtl.getResStr(pas["WEBLib.Consts"],"SRetryDE"):11===a?e=rtl.getResStr(pas["WEBLib.Consts"],"SIgnoreDE"):12===a?e=rtl.getResStr(pas["WEBLib.Consts"],"SAllDE"):13===a?e=rtl.getResStr(pas["WEBLib.Consts"],"SYesToAllDE"):14===a?e=rtl.getResStr(pas["WEBLib.Consts"],"SNoToAllDE"):15===a?e=rtl.getResStr(pas["WEBLib.Consts"],"SHelpDE"):16===a&&(e=rtl.getResStr(pas["WEBLib.Consts"],"SCloseDE"))}else if(4===o){var l=t;0===l?e=rtl.getResStr(pas["WEBLib.Consts"],"SWarningNL"):1===l?e=rtl.getResStr(pas["WEBLib.Consts"],"SErrorNL"):2===l?e=rtl.getResStr(pas["WEBLib.Consts"],"SInformationNL"):3===l?e=rtl.getResStr(pas["WEBLib.Consts"],"SConfirmNL"):5===l?e=rtl.getResStr(pas["WEBLib.Consts"],"SOKNL"):6===l?e=rtl.getResStr(pas["WEBLib.Consts"],"SCancelNL"):7===l?e=rtl.getResStr(pas["WEBLib.Consts"],"SYesNL"):8===l?e=rtl.getResStr(pas["WEBLib.Consts"],"SNoNL"):9===l?e=rtl.getResStr(pas["WEBLib.Consts"],"SAbortNL"):10===l?e=rtl.getResStr(pas["WEBLib.Consts"],"SRetryNL"):11===l?e=rtl.getResStr(pas["WEBLib.Consts"],"SIgnoreNL"):12===l?e=rtl.getResStr(pas["WEBLib.Consts"],"SAllNL"):13===l?e=rtl.getResStr(pas["WEBLib.Consts"],"SYesToAllNL"):14===l?e=rtl.getResStr(pas["WEBLib.Consts"],"SNoToAllNL"):15===l?e=rtl.getResStr(pas["WEBLib.Consts"],"SHelpNL"):16===l&&(e=rtl.getResStr(pas["WEBLib.Consts"],"SCloseNL"))}}return e},this.BindEvents=function(){},this.SetDialogResult=function(t){this.FDialogResult=t,0!==this.FDialogResult&&this.Close()},this.CreateButton=function(t,e,i){var s=null;return(s=document.createElement("BUTTON")).innerHTML=t,1===pas["WEBLib.Forms"].Application.FMainForm.FCSSLibrary?(s.setAttribute("type","BUTTON"),s.setAttribute("class","btn "+i),s.setAttribute("data-dismiss","modal-dialog")):(s.style.setProperty("width","100px"),s.style.setProperty("margin-left","5px"),""!==this.FElementButtonClassName?s.setAttribute("class",this.FElementButtonClassName+" "+i):""!==pas["WEBLib.Forms"].Application.FThemeButtonClassName&&s.setAttribute("class",pas["WEBLib.Forms"].Application.FThemeButtonClassName+" "+i)),s.id=t,s.addEventListener("click",rtl.createCallback(this,"HandleButtonClick")),s.addEventListener("keydown",rtl.createCallback(this,"HandleKeyDown")),e.get()&&(setTimeout((function(){s.focus()}),1),e.set(!1)),s},this.HandleDocMouseMove=function(t){var e=0,i=0,s=null;return this.FDown&&(e=t.screenX-this.FMdx,i=t.screenY-this.FMdy,(s=this.FDlg).style.setProperty("transform",""),s.style.setProperty("position","absolute"),s.style.setProperty("left",pas.SysUtils.IntToStr(Math.round(this.FDlgX+e))+"px"),s.style.setProperty("top",pas.SysUtils.IntToStr(Math.round(this.FDlgY+i))+"px"),(s=this.FCancel).style.setProperty("position","absolute"),s.style.setProperty("top","0"),s.style.setProperty("right","0")),!0,!0},this.HandleDocMouseUp=function(t){return this.FDown=!1,document.body.removeEventListener("mousemove",rtl.createCallback(this,"HandleDocMouseMove")),document.body.removeEventListener("mouseup",rtl.createCallback(this,"HandleDocMouseUp")),!0,!0},this.HandleMouseDown=function(t){var e;return this.FMdx=Math.round(t.screenX),this.FMdy=Math.round(t.screenY),e=this.FDlg.getBoundingClientRect(),this.FDlgX=Math.round(pas.System.Int(e.left)),this.FDlgY=Math.round(pas.System.Int(e.top)),this.FDown=!0,this.FCaptured$1||(this.FCaptured$1=!0,document.body.addEventListener("mousemove",rtl.createCallback(this,"HandleDocMouseMove")),document.body.addEventListener("mouseup",rtl.createCallback(this,"HandleDocMouseUp"))),!0,!0},this.HandleButtonClick=function(t){var e,i=0;if(this.SetDialogResult(0),(e=t.target.getAttribute("id"))===this.GetDialogText(7)?this.SetDialogResult(6):e===this.GetDialogText(8)?this.SetDialogResult(7):e===this.GetDialogText(5)?this.SetDialogResult(1):e===this.GetDialogText(6)?this.SetDialogResult(2):e===this.GetDialogText(9)?this.SetDialogResult(3):e===this.GetDialogText(10)?this.SetDialogResult(4):e===this.GetDialogText(11)?this.SetDialogResult(5):e===this.GetDialogText(12)?this.SetDialogResult(12):e===this.GetDialogText(13)?this.SetDialogResult(13):e===this.GetDialogText(14)?this.SetDialogResult(14):e===this.GetDialogText(15)?this.SetDialogResult(9):e===this.GetDialogText(16)&&this.SetDialogResult(8),0===this.FDialogResult&&this.FCustomButtons.GetCount()>0)for(var s=0,o=this.FCustomButtons.GetCount()-1;s<=o;s++)if(i=s,e===this.FCustomButtons.GetItem$1(i).FCaption){this.SetDialogResult(100+i);break}return null!=this.FOnButtonClick&&this.FOnButtonClick(this),!0,!0},this.HandleKeyDown=function(t){var e,i=!1;return e=this.GetKeyCode(t.key,!0),pas.System.Assigned(e)?(27===e&&this.SetDialogResult(2),i=!0):i},this.InitBootstrapStyle=function(){this.FElementButtonClassName="btn",this.FElementContentClassName="text-body",this.FElementTitleClassName="text-body",this.FElementDialogClassName="shadow-lg p-3 mb-5 bg-white rounded"},this.InsertInputElement=function(t,e){},this.CreateInitialize=function(){pas["WEBLib.Controls"].TCustomControl.CreateInitialize.call(this),this.FOpacity=.2,this.FMessage="",this.FAutoLanguage=!0,this.FMsgDlgType=2,this.FDialogText=pas.Classes.TStringList.$create("Create$1"),this.FDialogText.SetSkipLastLineBreak(!0),this.FDialogText.Add(rtl.getResStr(pas["WEBLib.Consts"],"SWarning")),this.FDialogText.Add(rtl.getResStr(pas["WEBLib.Consts"],"SError")),this.FDialogText.Add(rtl.getResStr(pas["WEBLib.Consts"],"SInformation")),this.FDialogText.Add(rtl.getResStr(pas["WEBLib.Consts"],"SConfirm")),this.FDialogText.Add("Custom"),this.FDialogText.Add(rtl.getResStr(pas["WEBLib.Consts"],"SOK")),this.FDialogText.Add(rtl.getResStr(pas["WEBLib.Consts"],"SCancel")),this.FDialogText.Add(rtl.getResStr(pas["WEBLib.Consts"],"SYes")),this.FDialogText.Add(rtl.getResStr(pas["WEBLib.Consts"],"SNo")),this.FDialogText.Add(rtl.getResStr(pas["WEBLib.Consts"],"SAbort")),this.FDialogText.Add(rtl.getResStr(pas["WEBLib.Consts"],"SRetry")),this.FDialogText.Add(rtl.getResStr(pas["WEBLib.Consts"],"SIgnore")),this.FDialogText.Add(rtl.getResStr(pas["WEBLib.Consts"],"SAll")),this.FDialogText.Add(rtl.getResStr(pas["WEBLib.Consts"],"SYesToAll")),this.FDialogText.Add(rtl.getResStr(pas["WEBLib.Consts"],"SNoToAll")),this.FDialogText.Add(rtl.getResStr(pas["WEBLib.Consts"],"SHelp")),this.FDialogText.Add(rtl.getResStr(pas["WEBLib.Consts"],"SClose")),this.FMsgDlgType=4,this.FCustomButtons=t.TCustomDialogButtons.$create("Create$2",[this,t.TCustomDialogButton]),this.FCustomButtons.FPropName="CustomButtons"},this.Destroy=function(){rtl.free(this,"FDialogText"),rtl.free(this,"FCustomButtons"),pas["WEBLib.Controls"].TCustomControl.Destroy.call(this)},this.Close=function(){pas["WEBLib.Forms"].Application.UnLockForm(pas["WEBLib.Forms"].Application.FMainForm),document.body.removeChild(this.FLayer$1),document.body.removeChild(this.FDlg),this.FDown=!1,this.FCaptured$1=!1,null!=this.FOnClose&&this.FOnClose(this),null!=this.FDialogProc&&this.FDialogProc(this.FDialogResult)},this.Show$1=function(){var t=null,i=null,s=null,o=null,n=null,r=null,a=null,l=null,h=null,F=null,p=null,c=null,u="",C="",T="",S="",d="",m="",f="",g=!1,y=0;if(null!==pas["WEBLib.Forms"].Application&&null!==pas["WEBLib.Forms"].Application.FMainForm){pas["WEBLib.Forms"].Application.HasCSS(e.lMaterial)||this.AddControlLink("material",e.lMaterial),pas["WEBLib.Forms"].Application.LockForm(pas["WEBLib.Forms"].Application.FMainForm),this.FLayer$1=document.createElement("SPAN"),document.body.appendChild(this.FLayer$1),this.FLayer$1.setAttribute("tabindex","0"),this.FLayer$1.addEventListener("keydown",rtl.createCallback(this,"HandleKeyDown")),g=!0,T=this.FTitle,this.FMessage=e.StringToHTML(this.FMessage);var M=this.FMsgDlgType;0===M?(u="warning",C="orange",T=this.GetDialogText(0)):1===M?(u="cancel",C="red",T=this.GetDialogText(1)):2===M?(u="info",C="blue",T=this.GetDialogText(2)):3===M?(u="help",C="blue",T=this.GetDialogText(3)):4===M&&(u="",C="",T=this.GetDialogText(4)),1===pas["WEBLib.Forms"].Application.FMainForm.FCSSLibrary?(this.FDlg=document.createElement("DIV"),this.FDlg.setAttribute("class","modal-dialog"),this.FDlg.setAttribute("role","document"),this.FDlg.style.setProperty("z-index","1999998"),(l=document.createElement("SPAN")).style.setProperty("position","absolute"),l.style.setProperty("top","0"),l.style.setProperty("left","0"),l.style.setProperty("right","0"),l.style.setProperty("bottom","0"),l.style.setProperty("z-index","1999997"),document.body.appendChild(l),l.appendChild(this.FDlg),p=this.FDlg,(F=document.createElement("DIV")).setAttribute("class","modal-content "+this.FElementDialogClassName),p.appendChild(F),c=F,p=F,(F=document.createElement("DIV")).setAttribute("class","modal-header"),c.appendChild(F),p=F,(F=document.createElement("H5")).setAttribute("class","modal-title"),F.innerHTML=T,p.appendChild(F),3 in this.FButtons&&((F=document.createElement("BUTTON")).setAttribute("type","button"),F.setAttribute("class","close btn btn-danger"),F.setAttribute("data-dismiss","modal-dialog"),F.setAttribute("aria-label","Close"),F.setAttribute("id",this.GetDialogText(6)),F.addEventListener("click",rtl.createCallback(this,"HandleButtonClick")),p.appendChild(F),p=F,(F=document.createElement("SPAN")).setAttribute("aria-hidden","true"),F.setAttribute("id",this.GetDialogText(6)),F.innerHTML="&times;",p.appendChild(F)),(F=document.createElement("DIV")).setAttribute("class","modal-body"),c.appendChild(F),p=F,4!==this.FMsgDlgType&&((s=document.createElement("SPAN")).innerHTML='<i class="material-icons" style="color:'+C+'!important;font-size:48px!important">'+u+"</i>",s.style.setProperty("display","inline-block"),s.style.setProperty("float","left"),s.style.setProperty("padding-right","15px"),p.appendChild(s)),(F=document.createElement("H6")).innerHTML=this.FMessage,p.appendChild(F),this.InsertInputElement(p,{get:function(){return g},set:function(t){g=t}}),(F=document.createElement("DIV")).setAttribute("class","modal-footer"),c.appendChild(F),r=p=F,this.FDlg=l):(f="5",m="26",d="#f1f1f1",S="#ababab",this.FDlg=document.createElement("DIV"),document.body.appendChild(this.FDlg),a=this.FDlg,""!==this.FElementDialogClassName?a.setAttribute("class",this.FElementDialogClassName):(a.style.setProperty("background-color","white"),a.style.setProperty("border","1px solid "+S),a.style.setProperty("font-family","Arial"),a.style.setProperty("font-size","10pt")),a.style.setProperty("cursor","default"),a.style.setProperty("position","fixed"),a.style.setProperty("min-width","300px"),a.style.setProperty("min-height","125px"),a.style.setProperty("max-width","100%"),a.style.setProperty("max-height","100%"),a.style.setProperty("top","50%"),a.style.setProperty("left","50%"),a.style.setProperty("transform","translate(-50%, -50%)"),a.style.setProperty("z-index","1999998"),a.style.setProperty("box-shadow","5px 5px 5px gray"),h=document.createElement("DIV"),this.FCancel=h,h.innerHTML='<i id="Cancel" class="material-icons" style="font-size:16px!important">clear</i>',h.id="Cancel",h.style.setProperty("color",pas["WEBLib.Graphics"].ColorToHTML(pas["WEBLib.Forms"].Application.FThemeTextColor)),h.style.setProperty("position","fixed"),h.style.setProperty("top","0"),h.style.setProperty("right","0"),h.style.setProperty("padding",f+"px"),h.style.setProperty("height",m+"px"),h.style.setProperty("line-height",m+"px"),h.addEventListener("click",rtl.createCallback(this,"HandleButtonClick")),a.appendChild(h),(t=document.createElement("DIV")).innerHTML=T,""!==this.FElementTitleClassName?t.setAttribute("class",this.FElementTitleClassName):(t.style.setProperty("background-color",pas["WEBLib.Graphics"].ColorToHTML(pas["WEBLib.Forms"].Application.FThemeColor)),t.style.setProperty("color",pas["WEBLib.Graphics"].ColorToHTML(pas["WEBLib.Forms"].Application.FThemeTextColor))),t.style.setProperty("cursor","move"),t.style.setProperty("padding-left",f+"px"),t.style.setProperty("height",m+"px"),t.style.setProperty("vertical-align","middle"),t.style.setProperty("line-height",m+"px"),t.style.setProperty("border-bottom","1px solid "+S),t.style.setProperty("-moz-user-select","none"),t.style.setProperty("-webkit-user-select","none"),t.style.setProperty("-ms-user-select","none"),t.style.setProperty("user-select","none"),t.style.setProperty("-o-user-select","none"),t.addEventListener("mousedown",rtl.createCallback(this,"HandleMouseDown")),a.appendChild(t),(i=document.createElement("DIV")).style.setProperty("padding",f+"px"),i.style.setProperty("height","auto"),i.style.setProperty("min-height","50px"),i.style.setProperty("border-bottom","1px solid "+S),4!==this.FMsgDlgType&&((s=document.createElement("DIV")).innerHTML='<i class="material-icons" style="color:'+C+'!important;font-size:48px!important">'+u+"</i>",s.style.setProperty("display","inline-block"),s.style.setProperty("float","left"),s.style.setProperty("padding-right","15px"),i.appendChild(s)),this.FMessage=pas.SysUtils.StringReplace(this.FMessage,pas.System.sLineBreak,"<BR>",rtl.createSet(0)),(n=document.createElement("DIV")).innerHTML=this.FMessage,n.style.setProperty("height","auto"),n.style.setProperty("min-height","50px"),n.style.setProperty("white-space","pre-wrap"),(o=document.createElement("LABEL")).innerHTML=this.FMessage,""!==this.FElementTitleClassName&&o.setAttribute("class",this.FElementContentClassName),n.appendChild(o),i.appendChild(o),this.InsertInputElement(i,{get:function(){return g},set:function(t){g=t}}),a.appendChild(i),(r=document.createElement("DIV")).style.setProperty("background-color",d),r.style.setProperty("padding",f+"px"),r.style.setProperty("min-height",m+"px"),r.style.setProperty("height","auto"),r.style.setProperty("line-height",m+"px"),r.style.setProperty("text-align","right"),a.appendChild(r)),rtl.eqSet(this.FButtons,{})&&0===this.FCustomButtons.GetCount()?r.appendChild(this.CreateButton(this.GetDialogText(5),{get:function(){return g},set:function(t){g=t}},"")):(0 in this.FButtons&&r.appendChild(this.CreateButton(this.GetDialogText(7),{get:function(){return g},set:function(t){g=t}},"")),1 in this.FButtons&&r.appendChild(this.CreateButton(this.GetDialogText(8),{get:function(){return g},set:function(t){g=t}},"")),2 in this.FButtons&&r.appendChild(this.CreateButton(this.GetDialogText(5),{get:function(){return g},set:function(t){g=t}},"")),3 in this.FButtons&&r.appendChild(this.CreateButton(this.GetDialogText(6),{get:function(){return g},set:function(t){g=t}},"")),4 in this.FButtons&&r.appendChild(this.CreateButton(this.GetDialogText(9),{get:function(){return g},set:function(t){g=t}},"")),5 in this.FButtons&&r.appendChild(this.CreateButton(this.GetDialogText(10),{get:function(){return g},set:function(t){g=t}},"")),6 in this.FButtons&&r.appendChild(this.CreateButton(this.GetDialogText(11),{get:function(){return g},set:function(t){g=t}},"")),7 in this.FButtons&&r.appendChild(this.CreateButton(this.GetDialogText(12),{get:function(){return g},set:function(t){g=t}},"")),9 in this.FButtons&&r.appendChild(this.CreateButton(this.GetDialogText(13),{get:function(){return g},set:function(t){g=t}},"")),8 in this.FButtons&&r.appendChild(this.CreateButton(this.GetDialogText(14),{get:function(){return g},set:function(t){g=t}},"")),10 in this.FButtons&&r.appendChild(this.CreateButton(this.GetDialogText(15),{get:function(){return g},set:function(t){g=t}},"")),11 in this.FButtons&&r.appendChild(this.CreateButton(this.GetDialogText(16),{get:function(){return g},set:function(t){g=t}},"")));for(var b=0,N=this.FCustomButtons.GetCount()-1;b<=N;b++)y=b,r.appendChild(this.CreateButton(this.FCustomButtons.GetItem$1(y).FCaption,{get:function(){return g},set:function(t){g=t}},this.FCustomButtons.GetItem$1(y).FElementClassName));(l=this.FLayer$1).style.setProperty("background-color","black"),l.style.setProperty("opacity",pas["WEBLib.WebTools"].DoubleToHTML(this.FOpacity)),l.style.setProperty("top","0"),l.style.setProperty("left","0"),l.style.setProperty("right","0"),l.style.setProperty("bottom","0"),l.style.setProperty("z-index","19990"),l.style.setProperty("webkit-user-select","none"),l.style.setProperty("moz-user-select","none"),l.style.setProperty("khtml-user-select","none"),l.style.setProperty("ms-user-select","none"),l.style.setProperty("user-select","none"),l.style.setProperty("position","fixed")}},this.ShowDialog$1=function(t,e,i,s){return 0,this.FButtons=rtl.refSet(i),this.FMessage=t,this.FMsgDlgType=e,this.FDialogProc=s,this.SetDialogResult(0),this.Show$1(),0},rtl.addIntf(this,pas.System.IUnknown);var i=this.$rtti;i.addProperty("AutoLanguage",0,rtl.boolean,"FAutoLanguage","FAutoLanguage",{Default:!0}),i.addProperty("Buttons",0,t.$rtti.TMsgDlgButtons,"FButtons","FButtons",{Default:{}}),i.addProperty("CustomButtons",2,t.$rtti.TCustomDialogButtons,"FCustomButtons","SetCustomButtons"),i.addProperty("DialogText",2,pas.Classes.$rtti.TStringList,"FDialogText","SetDialogText"),i.addProperty("DialogType",0,t.$rtti.TMsgDlgType,"FMsgDlgType","FMsgDlgType",{Default:t.TMsgDlgType.mtCustom}),i.addProperty("Message",0,rtl.string,"FMessage","FMessage"),i.addProperty("Opacity",0,rtl.double,"FOpacity","FOpacity"),i.addProperty("ElementButtonClassName",0,pas["WEBLib.Controls"].$rtti.TElementClassName,"FElementButtonClassName","FElementButtonClassName"),i.addProperty("ElementDialogClassName",0,pas["WEBLib.Controls"].$rtti.TElementClassName,"FElementDialogClassName","FElementDialogClassName"),i.addProperty("ElementTitleClassName",0,pas["WEBLib.Controls"].$rtti.TElementClassName,"FElementTitleClassName","FElementTitleClassName"),i.addProperty("ElementContentClassName",0,pas["WEBLib.Controls"].$rtti.TElementClassName,"FElementContentClassName","FElementContentClassName"),i.addProperty("Title",0,rtl.string,"FTitle","FTitle"),i.addProperty("OnButtonClick",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnButtonClick","FOnButtonClick"),i.addProperty("OnClose",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnClose","FOnClose")})),this.MessageDlg=function(i,s,o,n){null==e.WebLibDlg&&(e.WebLibDlg=t.TMessageDlg.$create("Create$1",[null]),1===pas["WEBLib.Forms"].Application.FMainForm.FCSSLibrary&&e.WebLibDlg.InitBootstrapStyle()),e.WebLibDlg.ShowDialog$1(i,s,rtl.refSet(o),n)},this.ShowMessage=function(e){null!==pas["WEBLib.Forms"].Application&&null!==pas["WEBLib.Forms"].Application.FMainForm&&1===pas["WEBLib.Forms"].Application.FMainForm.FCSSLibrary?t.MessageDlg(e,2,rtl.createSet(2),null):alert(e)},t.$implcode=function(){e.lMaterial="https://fonts.googleapis.com/icon?family=Material+Icons",e.WebLibDlg=null,e.StringToHTML=function(t){var e="";return e=pas.SysUtils.StringReplace(t,"\r","<BR>",rtl.createSet(0)),e=pas.SysUtils.StringReplace(e,"\n","",rtl.createSet(0))}},t.$init=function(){e.WebLibDlg=null}}),["WEBLib.Forms","WEBLib.Consts"]),rtl.module("Math",["System"],(function(){"use strict";var t=this.$impl;this.SameValue=function(t,e,i){return 0===i&&(i=Math.max(1e-12*Math.min(Math.abs(t),Math.abs(e)),1e-12)),t>e?t-e<=i:e-t<=i},this.Ceil=function(t){return pas.System.Trunc(Math.ceil(t))},this.Floor=function(t){return pas.System.Trunc(Math.floor(t))},this.DegToRad=function(t){return t*(Math.PI/180)},this.RadToDeg=function(t){return t*(180/Math.PI)},this.EqualsValue=0,this.LessThanValue=-1,this.GreaterThanValue=1,this.$implcode=function(){t.DZeroResolution=1e-12}}),[]),rtl.module("WEBLib.Utils",["System","Types","Web","SysUtils","Math","Classes","JS"],(function(){"use strict";this.FormatProp=function(t,e){return pas.SysUtils.Format$1(t,e,pas.SysUtils.TFormatSettings.Invariant())}}),["RTLConsts","WEBLib.Consts"]),rtl.module("WEBLib.Controls",["System","Classes","WEBLib.Graphics","Types","SysUtils","Web","JS"],(function(){"use strict";var t=this,e=t.$impl;this.VK_BACK=8,this.VK_TAB=9,this.VK_RETURN=13,this.VK_SHIFT=16,this.VK_CONTROL=17,this.VK_MENU=18,this.VK_ESCAPE=27,this.VK_SPACE=32,this.VK_PRIOR=33,this.VK_NEXT=34,this.VK_END=35,this.VK_HOME=36,this.VK_LEFT=37,this.VK_UP=38,this.VK_RIGHT=39,this.VK_DOWN=40,this.VK_INSERT=45,this.VK_DELETE=46,this.VK_MULTIPLY=106,this.VK_ADD=107,this.VK_SUBTRACT=109,this.VK_DIVIDE=111,this.VK_F2=113,this.VK_F4=115,this.WHEEL_DELTA=120,this.$rtti.$inherited("TCursor",rtl.longint,{}),this.crDefault=0,this.crNone=1,this.crArrow=2,this.crCross=3,this.crIBeam=4,this.crSize=5,this.crSizeNESW=6,this.crSizeNS=7,this.crSizeNWSE=8,this.crSizeWE=9,this.crUpArrow=10,this.crHourGlass=11,this.crDrag=12,this.crNoDrop=13,this.crHSplit=14,this.crVSplit=15,this.crMultIDrag=16,this.crSQLWait=17,this.crNo=18,this.crAppStart=19,this.crHelp=20,this.crHandPoint=21,this.crSizeAll=22,this.CSSBackground="background-color",this.CSSZIndex="z-index",this.TDragState={0:"dsDragEnter",dsDragEnter:0,1:"dsDragLeave",dsDragLeave:1,2:"dsDragMove",dsDragMove:2},this.$rtti.$Enum("TDragState",{minvalue:0,maxvalue:2,ordtype:1,enumtype:this.TDragState}),this.TDragMode={0:"dmManual",dmManual:0,1:"dmAutomatic",dmAutomatic:1},this.$rtti.$Enum("TDragMode",{minvalue:0,maxvalue:1,ordtype:1,enumtype:this.TDragMode}),this.TDragKind={0:"dkDrag",dkDrag:0,1:"dkDock",dkDock:1},this.$rtti.$Enum("TDragKind",{minvalue:0,maxvalue:1,ordtype:1,enumtype:this.TDragKind}),rtl.createClass(this,"TDragObject",pas.System.TObject,(function(){})),this.TAlign={0:"alNone",alNone:0,1:"alTop",alTop:1,2:"alBottom",alBottom:2,3:"alLeft",alLeft:3,4:"alRight",alRight:4,5:"alClient",alClient:5,6:"alCustom",alCustom:6},this.$rtti.$Enum("TAlign",{minvalue:0,maxvalue:6,ordtype:1,enumtype:this.TAlign}),this.TMouseButton={0:"mbLeft",mbLeft:0,1:"mbRight",mbRight:1,2:"mbMiddle",mbMiddle:2},this.$rtti.$Enum("TMouseButton",{minvalue:0,maxvalue:2,ordtype:1,enumtype:this.TMouseButton}),this.TBorderStyle={0:"bsNone",bsNone:0,1:"bsSingle",bsSingle:1},this.$rtti.$Enum("TBorderStyle",{minvalue:0,maxvalue:1,ordtype:1,enumtype:this.TBorderStyle}),this.TSizeStyle={0:"ssPercent",ssPercent:0,1:"ssAbsolute",ssAbsolute:1,2:"ssAuto",ssAuto:2},this.$rtti.$Enum("TSizeStyle",{minvalue:0,maxvalue:2,ordtype:1,enumtype:this.TSizeStyle}),this.TScrollStyle={0:"ssNone",ssNone:0,1:"ssHorizontal",ssHorizontal:1,2:"ssVertical",ssVertical:2,3:"ssBoth",ssBoth:3},this.$rtti.$Enum("TScrollStyle",{minvalue:0,maxvalue:3,ordtype:1,enumtype:this.TScrollStyle}),this.TAnchorKind={0:"akLeft",akLeft:0,1:"akTop",akTop:1,2:"akRight",akRight:2,3:"akBottom",akBottom:3},this.$rtti.$Enum("TAnchorKind",{minvalue:0,maxvalue:3,ordtype:1,enumtype:this.TAnchorKind}),this.$rtti.$Set("TAnchors",{comptype:this.$rtti.TAnchorKind}),this.$rtti.$inherited("TElementClassName",rtl.string,{}),this.$rtti.$inherited("TElementID",rtl.string,{}),this.TElementFont={0:"efProperty",efProperty:0,1:"efCSS",efCSS:1},this.$rtti.$Enum("TElementFont",{minvalue:0,maxvalue:1,ordtype:1,enumtype:this.TElementFont}),this.TElementPosition={0:"epAbsolute",epAbsolute:0,1:"epRelative",epRelative:1,2:"epIgnore",epIgnore:2},this.$rtti.$Enum("TElementPosition",{minvalue:0,maxvalue:2,ordtype:1,enumtype:this.TElementPosition}),this.TElementEvent={0:"eeClick",eeClick:0,1:"eeMouseDown",eeMouseDown:1,2:"eeMouseUp",eeMouseUp:2,3:"eeMouseMove",eeMouseMove:3,4:"eeDblClick",eeDblClick:4,5:"eeKeyPress",eeKeyPress:5,6:"eeKeyDown",eeKeyDown:6,7:"eeKeyUp",eeKeyUp:7},this.TTextDirection={0:"tdDefault",tdDefault:0,1:"tdLeftToRight",tdLeftToRight:1,2:"tdRightToLeft",tdRightToLeft:2,3:"tdInherit",tdInherit:3},this.$rtti.$Enum("TTextDirection",{minvalue:0,maxvalue:3,ordtype:1,enumtype:this.TTextDirection}),this.TMaterialGlyphType={0:"mgNormal",mgNormal:0,1:"mgOutlined",mgOutlined:1,2:"mgTwoTone",mgTwoTone:2,3:"mgRound",mgRound:3,4:"mgSharp",mgSharp:4},this.$rtti.$Enum("TMaterialGlyphType",{minvalue:0,maxvalue:4,ordtype:1,enumtype:this.TMaterialGlyphType}),rtl.recNewT(this,"TJSXMLHttpRequestRecord",(function(){this.req=null,this.$eq=function(t){return this.req===t.req},this.$assign=function(t){return this.req=t.req,this},t.$rtti.$Record("TJSXMLHttpRequestRecord",{}).addField("req",pas.Web.$rtti.TJSXMLHttpRequest)})),rtl.recNewT(this,"TJSEventRecord",(function(){this.event=null,this.$eq=function(t){return this.event===t.event},this.$assign=function(t){return this.event=t.event,this},t.$rtti.$Record("TJSEventRecord",{}).addField("event",pas.Web.$rtti.TJSEvent)})),this.$rtti.$MethodVar("THTTPRequestResponseEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ARequest",this.$rtti.TJSXMLHttpRequestRecord],["AResponse",rtl.string]]),methodkind:0}),this.$rtti.$MethodVar("THTTPErrorEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ARequest",this.$rtti.TJSXMLHttpRequestRecord],["Event",this.$rtti.TJSEventRecord],["Handled",rtl.boolean,1]]),methodkind:0}),rtl.recNewT(this,"TJSHTMLElementRecord",(function(){this.element=null,this.$eq=function(t){return this.element===t.element},this.$assign=function(t){return this.element=t.element,this},t.$rtti.$Record("TJSHTMLElementRecord",{}).addField("element",pas.Web.$rtti.TJSHTMLElement)})),this.$rtti.$MethodVar("TNotifyEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject]]),methodkind:0}),this.$rtti.$MethodVar("TMouseEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["Button",this.$rtti.TMouseButton],["Shift",pas.Classes.$rtti.TShiftState],["X",rtl.longint],["Y",rtl.longint]]),methodkind:0}),this.$rtti.$MethodVar("TMouseWheelEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["Shift",pas.Classes.$rtti.TShiftState],["WheelDelta",rtl.longint],["MousePos",pas.Types.$rtti.TPoint],["Handled",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TMouseWheelUpDownEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["Shift",pas.Classes.$rtti.TShiftState],["MousePos",pas.Types.$rtti.TPoint],["Handled",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TMouseMoveEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["Shift",pas.Classes.$rtti.TShiftState],["X",rtl.longint],["Y",rtl.longint]]),methodkind:0}),this.$rtti.$MethodVar("TKeyEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AKey",rtl.word,1],["Shift",pas.Classes.$rtti.TShiftState]]),methodkind:0}),this.$rtti.$MethodVar("TKeyPressEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AChar",rtl.char,1]]),methodkind:0}),this.$rtti.$MethodVar("TTouchEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["X",rtl.longint],["Y",rtl.longint]]),methodkind:0}),this.TBiDiMode={0:"bdLeftToRight",bdLeftToRight:0,1:"bdRightToLeft",bdRightToLeft:1,2:"bdRightToLeftNoAlign",bdRightToLeftNoAlign:2,3:"bdRightToLeftReadingOnly",bdRightToLeftReadingOnly:3},this.$rtti.$Enum("TBiDiMode",{minvalue:0,maxvalue:3,ordtype:1,enumtype:this.TBiDiMode}),this.$rtti.$MethodVar("TDragOverEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["Source",pas.System.$rtti.TObject],["X",rtl.longint],["Y",rtl.longint],["State",this.$rtti.TDragState],["Accept",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TDragDropEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["Source",pas.System.$rtti.TObject],["X",rtl.longint],["Y",rtl.longint]]),methodkind:0}),this.$rtti.$MethodVar("TStartDragEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["DragObject",this.$rtti.TDragObject,1]]),methodkind:0}),this.$rtti.$MethodVar("TEndDragEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["Target",pas.System.$rtti.TObject],["X",rtl.longint],["Y",rtl.longint]]),methodkind:0}),this.TControlStyleValue={0:"csAcceptsControls",csAcceptsControls:0,1:"csSetCaption",csSetCaption:1},rtl.createClass(this,"TMargins",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FOnChange=null,this.FLeft=0,this.FTop=0,this.FRight=0,this.FBottom=0},this.$final=function(){this.FOnChange=void 0,pas.Classes.TPersistent.$final.call(this)},this.SetLeft=function(t){t!==this.FLeft&&(this.FLeft=t,this.DoChange())},this.SetTop=function(t){t!==this.FTop&&(this.FTop=t,this.DoChange())},this.SetRight=function(t){t!==this.FRight&&(this.FRight=t,this.DoChange())},this.SetBottom=function(t){t!==this.FBottom&&(this.FBottom=t,this.DoChange())},this.DoChange=function(){null!=this.FOnChange&&this.FOnChange(this)},this.Create$1=function(){return this.FLeft=3,this.FTop=3,this.FBottom=3,this.FRight=3,this},this.Assign=function(e){t.TMargins.isPrototypeOf(e)?(this.FLeft=rtl.as(e,t.TMargins).FLeft,this.FTop=rtl.as(e,t.TMargins).FTop,this.FBottom=rtl.as(e,t.TMargins).FBottom,this.FRight=rtl.as(e,t.TMargins).FRight):pas.Classes.TPersistent.Assign.apply(this,arguments)};var e=this.$rtti;e.addProperty("Left",2,rtl.longint,"FLeft","SetLeft",{Default:3}),e.addProperty("Top",2,rtl.longint,"FTop","SetTop",{Default:3}),e.addProperty("Right",2,rtl.longint,"FRight","SetRight",{Default:3}),e.addProperty("Bottom",2,rtl.longint,"FBottom","SetBottom",{Default:3})})),rtl.createClass(this,"TPadding",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FOnChange=null,this.FLeft=0,this.FTop=0,this.FRight=0,this.FBottom=0},this.$final=function(){this.FOnChange=void 0,pas.Classes.TPersistent.$final.call(this)},this.SetLeft=function(t){this.FLeft!==t&&(this.FLeft=t,this.DoChange())},this.SetTop=function(t){this.FTop!==t&&(this.FTop=t,this.DoChange())},this.SetRight=function(t){this.FRight!==t&&(this.FRight=t,this.DoChange())},this.SetBottom=function(t){this.FBottom!==t&&(this.FBottom=t,this.DoChange())},this.DoChange=function(){null!=this.FOnChange&&this.FOnChange(this)},this.Create$1=function(){return pas.System.TObject.Create.call(this),this.FLeft=0,this.FTop=0,this.FRight=0,this.FBottom=0,this},this.Assign=function(e){t.TPadding.isPrototypeOf(e)&&(this.FLeft=rtl.as(e,t.TPadding).FLeft,this.FRight=rtl.as(e,t.TPadding).FRight,this.FTop=rtl.as(e,t.TPadding).FTop,this.FBottom=rtl.as(e,t.TPadding).FBottom)};var e=this.$rtti;e.addProperty("Left",2,rtl.longint,"FLeft","SetLeft",{Default:0}),e.addProperty("Top",2,rtl.longint,"FTop","SetTop",{Default:0}),e.addProperty("Right",2,rtl.longint,"FRight","SetRight",{Default:0}),e.addProperty("Bottom",2,rtl.longint,"FBottom","SetBottom",{Default:0})})),rtl.createClass(this,"TControl",pas.Classes.TComponent,(function(){this.$init=function(){pas.Classes.TComponent.$init.call(this),this.FGotFocus=!1,this.FAcceptDrag=!1,this.FCaptureDown=!1,this.FMouseInsideLayer=!1,this.FLayer=null,this.FCaptured=!1,this.FControlCreated=!1,this.FUpdateCount=0,this.FBlockUpdateElement=!1,this.FElement=null,this.FID="",this.FNew=!1,this.FContainer=null,this.FElementEvent=null,this.FLastElementEvent=null,this.FElementClassName="",this.FFont=null,this.FParent=null,this.FPrevParent=null,this.FControls=[],this.FOnDragOver=null,this.FOnDragDrop=null,this.FOnStartDrag=null,this.FonEndDrag=null,this.FOnClick=null,this.FOnDblClick=null,this.FOnMouseDown=null,this.FOnMouseUp=null,this.FOnMouseMove=null,this.FOnKeyDown=null,this.FOnKeyUp=null,this.FOnKeyPress=null,this.FOnEnter=null,this.FOnExit=null,this.FEnabled=!1,this.FHint="",this.FRole="",this.FShowHint=!1,this.FTabOrder=0,this.FTabStop=!1,this.FVisible=!1,this.FWidth=0,this.FHeight=0,this.FTag$1=0,this.FAlign=0,this.FAnchors={},this.FAlignWithMargins=!1,this.FIsAligning=!1,this.FOnMouseEnter=null,this.FOnMouseLeave=null,this.FCursor=0,this.FDoubleBuffered=!1,this.FControlStyle={},this.FMargins=null,this.FOnMouseWheel=null,this.FParentDoubleBuffered=!1,this.FParentColor=!1,this.FParentFont=!1,this.FParentBiDiMode=!1,this.FOnTouchMove=null,this.FOnTouchStart=null,this.FOnTouchEnd=null,this.FOnTouchCancel=null,this.FLinkTouchEvents=!1,this.FWidthStyle=0,this.FHeightStyle=0,this.FWidthPercent=0,this.FHeightPercent=0,this.FOrigRect=pas.Types.TRect.$new(),this.FOrigParentRect=pas.Types.TRect.$new(),this.FIsResizing=!1,this.FShowFocus=!1,this.FBorderWidth=0,this.FOrigTop=0,this.FOrigLeft=0,this.FUpdateTopLeft=!1,this.FEnablePropagation=!1,this.FParentShowHint=!1,this.FScriptLoaded=!1,this.FControlScriptCountLoaded=0,this.FRequiredScripts=null,this.FElementFont=0,this.FElementPosition=0,this.FParentElement=null,this.FClipChildren=!1,this.FTextDirection=0,this.FEventStopPropagation={},this.FOnResize=null,this.FMouseMovePtr=null,this.FMouseDownPtr=null,this.FMouseUpPtr=null,this.FMouseEnterPtr=null,this.FMouseLeavePtr=null,this.FClickPtr=null,this.FDblClickPtr=null,this.FKeyDownPtr=null,this.FKeyUpPtr=null,this.FKeyPressPtr=null,this.FInputPtr=null,this.FTouchStartPtr=null,this.FTouchEndPtr=null,this.FTouchMovePtr=null,this.FTouchCancelPtr=null,this.FContextMenuPtr=null,this.FExitPtr=null,this.FEnterPtr=null,this.FWheelPtr=null,this.FLayerMouseEnterPtr=null,this.FLayerMouseLeavePtr=null,this.FScriptLoadedPtr=null,this.FDragStartPtr=null,this.FDragOverPtr=null,this.FDragEnterPtr=null,this.FDragLeavePtr=null,this.FDragEndPtr=null,this.FDragDropPtr=null,this.FChildOrder=0,this.FAllowTouch=!1,this.FWheelAccumulator=0,this.FWheelMousePos=pas.Types.TPoint.$new(),this.FBiDiMode=0,this.FOnMouseWheelDown=null,this.FOnMouseWheelUp=null,this.FNoUserSelect=!1,this.FEventsBound=!1,this.FDragMode=0,this.FToolTip=void 0,this.FColor=0},this.$final=function(){this.FLayer=void 0,this.FElement=void 0,this.FContainer=void 0,this.FElementEvent=void 0,this.FLastElementEvent=void 0,this.FFont=void 0,this.FParent=void 0,this.FPrevParent=void 0,this.FControls=void 0,this.FOnDragOver=void 0,this.FOnDragDrop=void 0,this.FOnStartDrag=void 0,this.FonEndDrag=void 0,this.FOnClick=void 0,this.FOnDblClick=void 0,this.FOnMouseDown=void 0,this.FOnMouseUp=void 0,this.FOnMouseMove=void 0,this.FOnKeyDown=void 0,this.FOnKeyUp=void 0,this.FOnKeyPress=void 0,this.FOnEnter=void 0,this.FOnExit=void 0,this.FAnchors=void 0,this.FOnMouseEnter=void 0,this.FOnMouseLeave=void 0,this.FControlStyle=void 0,this.FMargins=void 0,this.FOnMouseWheel=void 0,this.FOnTouchMove=void 0,this.FOnTouchStart=void 0,this.FOnTouchEnd=void 0,this.FOnTouchCancel=void 0,this.FOrigRect=void 0,this.FOrigParentRect=void 0,this.FRequiredScripts=void 0,this.FParentElement=void 0,this.FEventStopPropagation=void 0,this.FOnResize=void 0,this.FWheelMousePos=void 0,this.FOnMouseWheelDown=void 0,this.FOnMouseWheelUp=void 0,pas.Classes.TComponent.$final.call(this)},this.GetControlsCount=function(){return rtl.length(this.FControls)},this.GetControls=function(t){return this.FControls[t]},this.SetVisible=function(t){this.FVisible!==t&&(this.VisibleChanging(),this.FVisible=t,this.UpdateElement(),this.DoRealign(),this.AlignControl(this),this.VisibleChanged())},this.SetHint=function(t){this.FHint!==t&&(this.FHint=t,this.UpdateElement())},this.SetShowHint=function(t){this.FShowHint!==t&&(this.FShowHint=t,this.UpdateElement())},this.SetTabOrder=function(t){this.FTabOrder!==t&&(this.FTabOrder=t,this.UpdateElement())},this.SetTabStop=function(t){this.FTabStop!==t&&(this.FTabStop=t,this.UpdateElement())},this.SetAlign=function(t){this.FAlign!==t&&(this.FAlign=t,this.DoRealign())},this.SetAlignWithMargins=function(t){this.FAlignWithMargins!==t&&(this.FAlignWithMargins=t,this.DoRealign())},this.GetBoundsRect=function(){var t=pas.Types.TRect.$new();return t.Left=this.GetLeft(),t.Top=this.GetTop(),t.Right=this.GetLeft()+this.GetWidth(),t.Bottom=this.GetTop()+this.GetHeight(),t},this.SetBoundsRect=function(t){this.SetBoundsInt(t.Left,t.Top,t.Right-t.Left,t.Bottom-t.Top)},this.SetID=function(t){var e=null,i=null,s=null,o=null,n=0,r=0,a=0,l=0;if(this.FNew&&this.FID!==t&&null!=(e=document.getElementById(t)))return n=this.FLeft,r=this.FTop,a=this.FWidth,l=this.FHeight,i=null,this.UnbindEvents(),null!=this.FContainer&&(this.FParentElement=this.FContainer.parentElement,i=document.createElement("SPAN"),this.MoveElements(this.FContainer,i)),o=this.FParent,this.SetParent(null),this.CreateWithID(t),this.SetParentComponent(o),this.FID=t,this.FWidth=a,this.FHeight=l,this.UpdateElement(),4 in this.FComponentState&&(this.FLeft=n,this.FTop=r),void(null!=i&&this.MoveElementsAndFree(i,this.GetElementHandle()));if(!this.FNew&&this.FID!==t){if(a=this.FWidth,l=this.FHeight,null!=(e=document.getElementById(this.FID))&&(i=document.createElement("SPAN"),this.MoveElements(e,i),this.UnbindEvents()),""!==t&&null!=(e=document.getElementById(t)))return this.CreateWithID(t),this.FID=t,this.FWidth=a,this.FHeight=l,this.UpdateElement(),void this.MoveElementsAndFree(i,this.FContainer);this.FNew=!0,this.FElement=null,this.CreateControl(),""===t&&(this.CreateInitialize(),this.FWidth=a,this.FHeight=l),null!=this.FParentElement?this.FParentElement.appendChild(this.GetContainer()):document.body.appendChild(this.GetContainer()),null!=(s=pas["WEBLib.Forms"].GetParentForm(this))&&(this.SetParent(s),this.SetElementPosition(0),this.SetLeft(0),this.SetTop(0)),null!=i&&this.MoveElementsAndFree(i,this.FContainer),this.UpdateElement(),this.UpdateElementSize()}this.FID=t,null!=this.FContainer&&this.FContainer.setAttribute("id",t)},this.SetMargins=function(t){this.FMargins.Assign(t)},this.SetAnchors=function(t){rtl.neSet(this.FAnchors,t)&&(this.FAnchors=rtl.refSet(t),0 in this.FComponentState||this.UpdateAnchoring())},this.GetElementEvent=function(){return this.FElementEvent},this.GetClientOrigin=function(){var t=pas.Types.TPoint.$new(),e=null;return t.$assign(pas.Types.Point(0,0)),null!=this.GetElementHandle()&&(e=this.GetElementHandle().getBoundingClientRect(),t.$assign(pas.Types.Point(Math.round(e.left),Math.round(e.top)))),t},this.SetHeightStyle=function(t){this.FHeightStyle!==t&&(this.FHeightStyle=t,2===this.FHeightStyle&&null!=this.GetElementHandle()&&this.GetElementStyle().removeProperty("height"),this.UpdateElementSize(),this.ResetAnchoring(),this.DoBoundsChange())},this.SetWidthStyle=function(t){this.FWidthStyle!==t&&(this.FWidthStyle=t,2===this.FWidthStyle&&null!=this.GetElementHandle()&&this.GetElementStyle().removeProperty("width"),this.UpdateElementSize(),this.ResetAnchoring(),this.DoBoundsChange())},this.SetHeightPercent=function(t){this.FHeightPercent!==t&&(this.FHeightPercent=t,this.UpdateElementSize(),this.ResetAnchoring(),this.DoBoundsChange())},this.SetWidthPercent=function(t){this.FWidthPercent!==t&&(this.FWidthPercent=t,this.UpdateElementSize(),this.ResetAnchoring(),this.DoBoundsChange())},this.SetShowFocus=function(t){this.FShowFocus!==t&&(this.FShowFocus=t,this.UpdateElement())},this.GetIsLinked=function(){return!this.FNew},this.SetElementFont=function(t){this.FElementFont!==t&&(this.FElementFont=t,this.UpdateElementVisual())},this.SetElementPosition=function(t){this.FElementPosition!==t&&(this.FElementPosition=t,null!=this.GetElementHandle()&&(this.UpdateElementSize(),this.RecreateCanvas(),this.InternalResize()))},this.SetClipChildren=function(t){this.FClipChildren=t,this.UpdateElement()},this.GetClientHeight=function(){return this.GetHeight()},this.GetClientWidth=function(){return this.GetWidth()},this.SetClientHeight=function(t){this.SetHeight(t)},this.SetClientWidth=function(t){this.SetWidth(t)},this.SetChildOrderEx=function(t){this.FChildOrder=t},this.GetRole=function(){var t="";return t=this.FRole,null!=this.GetElementHandle()&&(t=this.GetElementHandle().getAttribute("role")),t},this.SetRole=function(t){this.FRole=t,null!=this.GetElementHandle()&&(""===t?this.GetElementHandle().removeAttribute("role"):this.GetElementHandle().setAttribute("role",t))},this.GetContainer=function(){return this.FContainer},this.GetChildContainer=function(){return this.FContainer},this.SetParentFont=function(t){t!==this.FParentFont&&t&&null!=this.FParent&&(this.BeginUpdate(),this.FFont.Assign(this.FParent.FFont),this.EndUpdate(),this.UpdateElement()),this.FParentFont=t},this.SetParentColor=function(t){this.FParentColor!==t&&t&&null!=this.FParent&&this.SetColor(this.FParent.FColor),this.FParentColor=t},this.SetDragMode=function(t){this.FDragMode=t,1===t?this.BeginDrag():this.DisableDrag()},this.SetWidth=function(t){this.FWidth!==t&&(this.FWidth=t,this.ResetAnchoring(),this.DoBoundsChange(),this.GetIsLinked()&&!this.IsUpdating()&&null!=this.GetElementHandle()&&(t>=0?this.GetElementStyle().setProperty("width",pas.SysUtils.IntToStr(t)+"px"):this.GetElementStyle().removeProperty("width")))},this.SetHeight=function(t){var e=null;this.FHeight!==t&&(this.FAlign in rtl.createSet(3,4,5)&&null!=this.GetElementHandle()&&(e=this.GetElementHandle().getBoundingClientRect()).top+t>=pas["WEBLib.Forms"].WinHeight()&&(t=Math.round(pas["WEBLib.Forms"].WinHeight()-e.top)),this.FHeight=t,this.ResetAnchoring(),this.DoBoundsChange(),this.GetIsLinked()&&!this.IsUpdating()&&null!=this.GetElementHandle()&&(t>=0?this.GetElementStyle().setProperty("height",pas.SysUtils.IntToStr(t)+"px"):this.GetElementStyle().removeProperty("height")))},this.SetWidthInt=function(t){this.FWidth=t},this.SetHeightInt=function(t){this.FHeight=t},this.SetEnabled=function(t){this.FEnabled!==t&&(this.FEnabled=t,this.UpdateElementData())},this.RecreateCanvas=function(){},this.VisibleChanging=function(){},this.VisibleChanged=function(){for(var t=0,e=0,i=this.GetControlsCount()-1;e<=i;e++)t=e,this.GetControls(t).VisibleChanged()},this.ColorChanging=function(){},this.GetWidth=function(){var t=0,e=null;return t=this.FWidth,null==this.GetElementHandle()||0 in this.FComponentState||(-1===t&&(t=Math.round(pas.System.Int(this.GetElementHandle().offsetWidth))),1!==this.FWidthStyle&&(e=this.GetElementHandle().getBoundingClientRect(),t=Math.round(pas.System.Int(e.right-e.left)))),t},this.GetHeight=function(){var t=0,e=null;return t=this.FHeight,null==this.GetElementHandle()||0 in this.FComponentState||(-1===t&&(t=Math.round(pas.System.Int(this.GetElementHandle().offsetHeight))),1!==this.FHeightStyle&&(e=this.GetElementHandle().getBoundingClientRect(),t=Math.round(pas.System.Int(e.bottom-e.top)))),t},this.GetOuterWidth=function(){return this.FWidth-this.FBorderWidth},this.GetOuterHeight=function(){return this.FHeight-this.FBorderWidth},this.GetDesignWidth=function(){return this.FWidth},this.GetDesignHeight=function(){return this.FHeight},this.GetDesignLeft=function(){return this.FLeft},this.GetDesignTop=function(){return this.FTop},this.GetLeft=function(){var t=0;return-1!==(t=this.FLeft)||null==this.GetElementHandle()||0 in this.FComponentState||(t=Math.round(this.GetElementHandle().offsetLeft)),t},this.GetTop=function(){var t=0;return-1!==(t=this.FTop)||null==this.GetElementHandle()||0 in this.FComponentState||(t=Math.round(this.GetElementHandle().offsetTop)),t},this.HandleAllocated=function(){return!0,!0},this.CreateElement=function(){return null,null},this.CreateChildElements=function(t){},this.ContainerElement=function(){return document.body},this.IsStructuralElement=function(){return!1,!1},this.IsEnabled=function(){return this.FEnabled},this.GetNewName=function(){var e,i="",s="";return i=this.$classname,pas.System.Delete({get:function(){return i},set:function(t){i=t}},1,1),s="",null!=(e=pas["WEBLib.Forms"].GetParentForm(this))&&(s=e.$classname),s+"_"+t.FindUniqueName(i)},this.IsInputControl=function(){return!1,!1},this.UseCSSFont=function(){return!(""===this.FElementClassName&&0===this.FElementFont&&!this.GetIsLinked())},this.UseCSSFontColor=function(){return!(pas["WEBLib.Forms"].Application.FThemed&&pas["WEBLib.Graphics"].ColorToRGB(this.FFont.FColor)===pas["WEBLib.Graphics"].RGB(0,0,0))},this.RecreateElement=function(){null!=this.GetContainer()&&(this.UnbindEvents(),this.GetContainer().parentNode.removeChild(this.GetContainer()),this.FElement=null,this.CreateControl(),null!=this.FParent&&null!=this.FParent.GetContainer()&&this.FParent.GetChildContainer().appendChild(this.GetContainer()))},this.BindElement=function(){},this.CreateInitialize=function(){this.FRequiredScripts=pas.Classes.TStringList.$create("Create$1"),this.FOrigRect.$assign(pas.Types.Rect(-1,-1,-1,-1)),this.FClipChildren=!0},this.DestroyControls=function(){for(var t=0,e=null,i=this.GetControlsCount()-1;i>=0;i--)t=i,e=this.GetControls(t),e=rtl.freeLoc(e)},this.ClearControls=function(){this.FControls=rtl.arraySetLength(this.FControls,null,0)},this.GetElementStyle=function(){return this.GetElementHandle().style},this.SetControlCursor=function(t){this.FCursor=t,""===this.FElementClassName&&null!=this.GetElementHandle()&&this.SetElementPointer(this.GetElementHandle(),t)},this.SetBiDiMode=function(t){null!=this.GetElementHandle()&&(0===t?this.GetElementHandle().removeAttribute("dir"):this.GetElementHandle().setAttribute("dir","rtl"))},this.GetMouseEventButton=function(t){var e=0;e=0;var i=t.button;return 0===i?e=0:1===i?e=2:2===i&&(e=1),e},this.GetMouseEventShiftState=function(t){var e={};return e={},t.shiftKey&&(e=rtl.unionSet(e,rtl.createSet(0))),t.ctrlKey&&(e=rtl.unionSet(e,rtl.createSet(2))),t.altKey&&(e=rtl.unionSet(e,rtl.createSet(1))),1==(1&t.buttons)&&(e=rtl.unionSet(e,rtl.createSet(3))),2==(2&t.buttons)&&(e=rtl.unionSet(e,rtl.createSet(4))),4==(4&t.buttons)&&(e=rtl.unionSet(e,rtl.createSet(5))),e},this.GetKeyBoardEventShiftState=function(t){var e={};return e={},t.shiftKey&&(e=rtl.unionSet(e,rtl.createSet(0))),t.ctrlKey&&(e=rtl.unionSet(e,rtl.createSet(2))),t.altKey&&(e=rtl.unionSet(e,rtl.createSet(1))),e},this.GetMouseWheelEventShiftState=function(t){var e={};return e={},t.shiftKey&&(e=rtl.unionSet(e,rtl.createSet(0))),t.ctrlKey&&(e=rtl.unionSet(e,rtl.createSet(2))),t.altKey&&(e=rtl.unionSet(e,rtl.createSet(1))),e},this.GetTouchEventShiftState=function(t){var e={};return e={},t.shiftKey&&(e=rtl.unionSet(e,rtl.createSet(0))),t.ctrlKey&&(e=rtl.unionSet(e,rtl.createSet(2))),t.altKey&&(e=rtl.unionSet(e,rtl.createSet(1))),e},this.HandleDoClick=function(t){return this.FElementEvent=t,0 in this.FEventStopPropagation&&this.StopPropagation(),this.FEnabled&&this.Click(),!0,this.FElementEvent=null,!0},this.HandleDoWheel=function(t){var e,i=!1,s=0,o=0;return this.FElementEvent=t,this.StopPropagation(),this.XYToClient(t.clientX,t.clientY,{get:function(){return s},set:function(t){s=t}},{get:function(){return o},set:function(t){o=t}}),this.FWheelMousePos.x=Math.round(s),this.FWheelMousePos.y=Math.round(o),e=rtl.refSet(this.GetMouseWheelEventShiftState(t)),i=!1,this.MouseWheel(rtl.refSet(e),pas.System.Trunc(-t.deltaY),{get:function(){return i},set:function(t){i=t}}),!0,this.FElementEvent=null,!0},this.HandleDoDblClick=function(t){return this.FElementEvent=t,4 in this.FEventStopPropagation&&this.StopPropagation(),this.FEnabled&&this.DblClick(),!0,this.FElementEvent=null,!0},this.HandleDoMouseDown=function(i){var s,o,n=!1,r=0,a=0;return this.FElementEvent=i,1 in this.FEventStopPropagation&&this.StopPropagation(),this.CanFocus()||this.PreventDefault(),e.FMouseX=Math.round(i.clientX),e.FMouseY=Math.round(i.clientY),this.XYToClient(i.clientX,i.clientY,{get:function(){return r},set:function(t){r=t}},{get:function(){return a},set:function(t){a=t}}),this.HasVertScrollBar()&&r>this.GetWidth()-t.GetScrollBarWidth()||this.HasHorzScrollBar()&&a>this.GetHeight()-t.GetScrollBarHeight()||(s=rtl.refSet(this.GetMouseEventShiftState(i)),o=this.GetMouseEventButton(i),this.MouseDown(o,rtl.refSet(s),pas.System.Trunc(r),pas.System.Trunc(a)),n=!0,this.FElementEvent=null),n},this.HandleDoMouseUp=function(e){var i,s,o=!1,n=0,r=0;return this.FElementEvent=e,2 in this.FEventStopPropagation&&this.StopPropagation(),this.XYToClient(e.clientX,e.clientY,{get:function(){return n},set:function(t){n=t}},{get:function(){return r},set:function(t){r=t}}),this.HasVertScrollBar()&&n>this.GetWidth()-t.GetScrollBarWidth()||this.HasHorzScrollBar()&&r>this.GetHeight()-t.GetScrollBarHeight()?(this.FElementEvent=null,o):(i=rtl.refSet(this.GetMouseEventShiftState(e)),s=this.GetMouseEventButton(e),0===this.FDragMode&&this.DisableDrag(),this.MouseUp(s,rtl.refSet(i),pas.System.Trunc(n),pas.System.Trunc(r)),o=!0,this.FElementEvent=null,o)},this.HandleDoMouseMove=function(t){var i,s=0,o=0;return this.FElementEvent=t,e.FCursorX=Math.round(t.clientX),e.FCursorY=Math.round(t.clientY),3 in this.FEventStopPropagation&&this.StopPropagation(),this.XYToClient(t.clientX,t.clientY,{get:function(){return s},set:function(t){s=t}},{get:function(){return o},set:function(t){o=t}}),i=rtl.refSet(this.GetMouseEventShiftState(t)),this.MouseMove(rtl.refSet(i),pas.System.Trunc(s),pas.System.Trunc(o)),!0,this.FElementEvent=null,!0},this.HandleDoMouseLeave=function(t){var e=!1;return this.Captured()?e:(t.stopPropagation(),this.DoMouseLeave(),e=!0)},this.HandleDoContextMenu=function(t){return!0,!0},this.LayerHandleDoMouseEnter=function(t){return 0===t.buttons&&this.Captured()&&!this.FMouseInsideLayer&&(this.ReleaseCapture(),this.HandleDoMouseUp(t),this.HandleDoMouseLeave(t)),this.FMouseInsideLayer=!0,!0,!0},this.LayerHandleDoMouseLeave=function(t){return this.FMouseInsideLayer=!1,!0,!0},this.HandleDoMouseEnter=function(t){var e=!1;return this.Captured()?e:(t.stopPropagation(),this.DoMouseEnter(),e=!0)},this.HandleDoKeyDown=function(t){var e=0,i={};return this.FElementEvent=t,6 in this.FEventStopPropagation&&this.StopPropagation(),null==t.key||(e=this.GetKeyCode(t.key,!0),i=rtl.refSet(this.GetKeyBoardEventShiftState(t)),this.KeyDown({get:function(){return e},set:function(t){e=t}},rtl.refSet(i))),!0,0===e&&this.PreventDefault(),this.FElementEvent=null,!0},this.HandleDoKeyUp=function(t){var e=0,i={},s="";return this.FElementEvent=t,7 in this.FEventStopPropagation&&this.StopPropagation(),null==t.key||(e=this.GetKeyCode(t.key,!0),i=rtl.refSet(this.GetKeyBoardEventShiftState(t)),27===e&&(s="",this.KeyPress({get:function(){return s},set:function(t){s=t}})),this.KeyUp({get:function(){return e},set:function(t){e=t}},rtl.refSet(i))),!0,0===e&&this.PreventDefault(),this.FElementEvent=null,!0},this.HandleDoKeyPress=function(t){var e="";return this.FElementEvent=t,5 in this.FEventStopPropagation&&this.StopPropagation(),this.IsKeyCharacter(t.key)&&(e=this.GetKeyChar(t.key),this.KeyPress({get:function(){return e},set:function(t){e=t}})),!0,"\0"===e&&this.PreventDefault(),this.FElementEvent=null,!0},this.HandleDoInput=function(e){var i=!1,s="",o="";return t.IsAndroid()&&(this.FElementEvent=e,5 in this.FEventStopPropagation&&this.StopPropagation(),s="\0",""!==e.data&&(o=e.data,s=pas.System.Assigned(o)?o.charAt(o.length-1):"\b",this.KeyPress({get:function(){return s},set:function(t){s=t}})),i=!0,"\0"===s&&this.PreventDefault(),this.FElementEvent=null),i},this.HandleDoExit=function(t){return this.DoExit(),!0,!0},this.HandleDoEnter=function(t){return this.FElementEvent=t,this.StopPropagation(),this.DoEnter(),!0,this.FElementEvent=null,this.FGotFocus=!0,!0},this.HandleDoTouchStart=function(t){var e=0,i=0,s=null,o={};return this.FElementEvent=t,this.FLastElementEvent=t,this.StopPropagation(),this.FAllowTouch||this.PreventDefault(),t.touches.length>0&&(s=t.touches.item(0),this.XYToClient(s.clientX,s.clientY,{get:function(){return e},set:function(t){e=t}},{get:function(){return i},set:function(t){i=t}}),o=rtl.refSet(this.GetTouchEventShiftState(t)),this.FLinkTouchEvents&&this.MouseDown(0,rtl.refSet(o),pas.System.Trunc(e),pas.System.Trunc(i)),this.TouchStart(pas.System.Trunc(e),pas.System.Trunc(i))),!0,this.FElementEvent=null,!0},this.HandleDoTouchMove=function(t){var e=0,i=0,s=null,o={};return this.FElementEvent=t,this.FLastElementEvent=t,this.StopPropagation(),this.FAllowTouch||this.PreventDefault(),this.Captured()&&this.PreventDefault(),t.touches.length>0&&(s=t.touches.item(0),this.XYToClient(s.clientX,s.clientY,{get:function(){return e},set:function(t){e=t}},{get:function(){return i},set:function(t){i=t}}),o=rtl.refSet(this.GetTouchEventShiftState(t)),this.FLinkTouchEvents&&this.MouseMove(rtl.refSet(o),pas.System.Trunc(e),pas.System.Trunc(i)),this.TouchMove(pas.System.Trunc(e),pas.System.Trunc(i))),this.FElementEvent=null,!0,!0},this.HandleDoTouchEnd=function(t){var e=0,i=0,s=null,o={};return this.FElementEvent=t,this.FAllowTouch||this.PreventDefault(),this.ReleaseCapture(),this.StopPropagation(),null!=this.FLastElementEvent&&this.FLastElementEvent.touches.length>0&&(s=this.FLastElementEvent.touches.item(0),this.XYToClient(s.clientX,s.clientY,{get:function(){return e},set:function(t){e=t}},{get:function(){return i},set:function(t){i=t}}),o=rtl.refSet(this.GetTouchEventShiftState(t)),this.FLinkTouchEvents&&this.MouseUp(0,rtl.refSet(o),pas.System.Trunc(e),pas.System.Trunc(i)),this.TouchEnd(pas.System.Trunc(e),pas.System.Trunc(i))),this.FElementEvent=null,!0,!0},this.HandleDoTouchCancel=function(t){var e=0,i=0,s=null,o={};return this.FElementEvent=t,this.ReleaseCapture(),this.StopPropagation(),t.touches.length>0&&(s=t.touches.item(0),this.XYToClient(s.clientX,s.clientY,{get:function(){return e},set:function(t){e=t}},{get:function(){return i},set:function(t){i=t}}),o=rtl.refSet(this.GetTouchEventShiftState(t)),this.FLinkTouchEvents&&this.MouseUp(0,rtl.refSet(o),pas.System.Trunc(e),pas.System.Trunc(i)),this.TouchCancel(pas.System.Trunc(e),pas.System.Trunc(i))),this.FElementEvent=null,!0,!0},this.HandleDoDragStart=function(t){var i=null;return this.FElementEvent=t,t.stopPropagation(),i=null,this.DoStartDrag({get:function(){return i},set:function(t){i=t}}),e.DragObject=null!=i?i:this,!0,!0},this.HandleDoDragOver=function(t){var i;return this.FElementEvent=t,t.stopPropagation(),this.DragOver(e.DragObject,t.clientX,t.clientY,2,{p:this,get:function(){return this.p.FAcceptDrag},set:function(t){this.p.FAcceptDrag=t}}),!this.FAcceptDrag||this.IsInputControl()&&0!==t.dataTransfer.items.length||t.preventDefault(),i=!this.FAcceptDrag,this.FElementEvent=null,i},this.HandleDoDragEnter=function(t){var i;return this.FElementEvent=t,t.stopPropagation(),this.FAcceptDrag=this.IsInputControl(),this.DragOver(e.DragObject,t.clientX,t.clientY,0,{p:this,get:function(){return this.p.FAcceptDrag},set:function(t){this.p.FAcceptDrag=t}}),this.FAcceptDrag&&t.preventDefault(),i=!this.FAcceptDrag,this.FElementEvent=null,i},this.HandledoDragLeave=function(t){return this.FElementEvent=t,t.stopPropagation(),this.DragOver(e.DragObject,t.clientX,t.clientY,1,{p:this,get:function(){return this.p.FAcceptDrag},set:function(t){this.p.FAcceptDrag=t}}),!0,this.FElementEvent=null,!0},this.HandleDoDragEnd=function(t){return this.FElementEvent=t,t.stopPropagation(),this.DoEndDrag(e.DragObject,t.clientX,t.clientY),!0,0===this.FDragMode&&this.DisableDrag(),this.FElementEvent=null,!0},this.HandleDoDragDrop=function(t){var i;return this.FElementEvent=t,t.stopPropagation(),this.FAcceptDrag?(this.IsInputControl()||t.preventDefault(),this.DragDrop(e.DragObject,t.clientX,t.clientY)):t.preventDefault(),i=this.FAcceptDrag,this.FElementEvent=null,i},this.HandleFontChanged=function(t){0===this.FUpdateCount&&(this.SetParentFont(!1),this.ParentFontChanged()),this.FontChanged()},this.ParentFontChanged=function(){for(var t=0,e=0,i=this.GetControlsCount()-1;e<=i;e++)t=e,this.GetControls(t).FParentFont&&(this.GetControls(t).FFont.Assign(this.FFont),this.GetControls(t).FontChanged(),this.GetControls(t).FParentFont=!0,this.GetControls(t).ParentFontChanged())},this.DoExit=function(){null!=this.FOnExit&&this.FOnExit(this)},this.DoEnter=function(){null!=this.FOnEnter&&this.FOnEnter(this)},this.Click=function(){null!=this.FOnClick&&this.IsEnabled()&&this.FOnClick(this)},this.UpdateElement=function(){this.FBlockUpdateElement||this.FUpdateCount>0||null==this.GetElementHandle()||this.GetElementHandle()===this.ContainerElement()||this.IsUpdating()||(this.UpdateElementData(),this.GetIsLinked()||this.UpdateElementVisual())},this.UpdateElementSize=function(){var t=null,e=0,i=0,s=0,o=null,n=null;if(!(this.FBlockUpdateElement||this.FUpdateCount>0||this.GetIsLinked()||null==this.GetElementHandle()||this.GetElementHandle()===this.ContainerElement())){for(t=this.GetElementStyle(),e=0,i=0,o=this.FParent;null!=o&&0===this.FElementPosition&&0!==o.FElementPosition&&!pas["WEBLib.Forms"].TCustomForm.isPrototypeOf(o);){if(o.GetIsLinked()&&null!=o.GetElementHandle()&&"absolute"!==o.GetElementHandle().getAttribute("position")){n=o.GetElementHandle().getBoundingClientRect(),e=Math.round(n.left),i=Math.round(n.top);break}o=o.FParent}null!=this.FParent&&this.FParent.IsStructuralElement()&&(e=this.FParent.GetLeft(),i=this.FParent.GetTop()),0===this.FElementPosition?(-1!==this.FTop?t.setProperty("top",pas.SysUtils.IntToStr(this.FTop+i)+"px"):t.setProperty("top",""),-1!==this.FLeft?t.setProperty("left",pas.SysUtils.IntToStr(this.FLeft+e)+"px"):t.setProperty("left","")):(t.removeProperty("top"),t.removeProperty("left")),1===this.FWidthStyle&&(s=this.GetOuterWidth(),-1!==this.FWidth?t.setProperty("width",pas.SysUtils.IntToStr(s)+"px"):t.removeProperty("width")),2===this.FWidthStyle&&t.removeProperty("width"),1===this.FHeightStyle&&(-1!==this.FHeight?t.setProperty("height",pas.SysUtils.IntToStr(this.GetOuterHeight())+"px"):t.removeProperty("height")),2===this.FHeightStyle&&t.removeProperty("height"),0===this.FWidthStyle&&(-1!==this.FWidth?t.setProperty("width",pas["WEBLib.Utils"].FormatProp("%.2f%%",pas.System.VarRecs(3,this.FWidthPercent))):t.removeProperty("width")),0===this.FHeightStyle&&(-1!==this.FHeight?t.setProperty("height",pas["WEBLib.Utils"].FormatProp("%.2f%%",pas.System.VarRecs(3,this.FHeightPercent))):t.removeProperty("height")),0===this.FElementPosition?t.setProperty("position","absolute"):1===this.FElementPosition?t.setProperty("position","relative"):t.removeProperty("position"),t.setProperty("box-sizing","border-box")}},this.UpdateElementVisual=function(){var e,i,s=null;if(null!=(e=this.GetElementHandle())&&!this.IsUpdating()){s=this.GetElementStyle(),this.FParentFont&&null!=this.FParent&&(this.FFont.FOnChange=null,this.FFont.Assign(this.FParent.FFont),this.FFont.FOnChange=rtl.createCallback(this,"HandleFontChanged")),""===this.FElementClassName&&(this.GetIsLinked()||(this.FClipChildren&&pas.SysUtils.LowerCase(e.tagName)!==pas["WEBLib.WebTools"].cBodyTag?s.setProperty("overflow","hidden"):s.setProperty("overflow","")),this.SetElementPointer(e,this.FCursor)),this.Captured()&&this.FLayer.style.setProperty("cursor",s.getPropertyValue("cursor")),""!==this.FElementClassName||this.CanShowFocus()?s.setProperty("outline",""):s.setProperty("outline","none"),this.UpdateElementSize();var o=this.FTextDirection;0===o?s.removeProperty("direction"):2===o?s.setProperty("direction","rtl"):1===o?s.setProperty("direction","ltr"):3===o&&s.setProperty("direction","inherit"),""===this.FElementClassName&&this.FNoUserSelect&&(s.setProperty("webkit-user-select","none"),s.setProperty("moz-user-select","none"),s.setProperty("khtml-user-select","none"),s.setProperty("ms-user-select","none"),s.setProperty("user-select","none"),s.setProperty("-webkit-tap-highlight-color","transparent")),this.SetElementColor(e,this.FColor),i=this.UseCSSFont(),t.SetHTMLElementFont(e,this.FFont,i),i?s.removeProperty("color"):this.IsEnabled()&&this.UseCSSFontColor()&&s.setProperty("color",pas["WEBLib.Graphics"].ColorToHTML(this.FFont.FColor))}},this.UpdateElementData=function(){var t=null,e=null,i="",s="",o="",n=0,r=0;if(null!=this.GetElementHandle()){if(4 in this.FComponentState||(this.FVisible?this.GetElementStyle().setProperty("display",""):this.GetElementStyle().setProperty("display","none")),this.EnableTab(),this.IsEnabled()?this.FContainer.removeAttribute("disabled"):this.FContainer.setAttribute("disabled",""),this.GetIsLinked()&&""===this.FHint)return;if(""!==this.GetRole()&&this.FContainer.setAttribute("role",this.FRole),null!=(t=pas["WEBLib.Forms"].GetParentForm(this))&&1===t.FCSSLibrary&&this.FShowHint&&""!==this.FHint){e=this.GetElementHandle(),i=this.FHint;var a=pas["WEBLib.Forms"].Application.FHintPosition;0===a?o="left":2===a?o="right":1===a?o="top":3===a&&(o="bottom"),s=pas["WEBLib.Forms"].Application.FHintClassName,n=pas["WEBLib.Forms"].Application.FHintPause,r=pas["WEBLib.Forms"].Application.FHintHidePause,this.FTooltip=new bootstrap.Tooltip(e,{title:i,placement:o,customClass:s,delay:{show:n,hide:r}})}else this.FShowHint&&""!==this.FHint?this.FContainer.setAttribute("title",this.FHint):this.FContainer.removeAttribute("title");this.IsEnabled()&&1!==this.FElementFont?1!==this.FElementFont&&this.UseCSSFontColor()&&this.GetElementStyle().setProperty("color",pas["WEBLib.Graphics"].ColorToHTML(this.FFont.FColor)):this.GetElementStyle().removeProperty("color")}},this.UpdateParent=function(){this.InternalUpdateParent(),this.UpdateChildren(this.FPrevParent),this.UpdateChildren(this.FParent)},this.UpdateControlSize=function(t,e){this.FWidth=t,this.FHeight=e},this.InternalUpdateParent=function(){var t=null;t=this.FPrevParent,this.FNew&&(this.CreateControl(),null!=this.GetContainer()&&(null!=this.FParent&&null==this.FParent.GetContainer()&&this.FParent.CreateControl(),this.FParent!==t&&null!=t&&null!=t.GetContainer()&&this.GetContainer().parentNode===t.GetChildContainer()&&t.GetChildContainer().removeChild(this.GetContainer()),null!=this.FParent&&null!=this.FParent.GetContainer()&&this.FParent.GetChildContainer().appendChild(this.GetContainer())))},this.UpdateChildren=function(e){var i=0,s=null;if(null!=e&&!(3 in this.FComponentState)){0!==e.FAlign&&e.DoRealign(),t.TCustomControl.isPrototypeOf(e)&&(rtl.as(e,t.TCustomControl).RecreateCanvas(),rtl.as(e,t.TCustomControl).Invalidate());for(var o=0,n=e.GetControlsCount()-1;o<=n;o++)i=o,s=e.GetControls(i),this.UpdateChildren(s)}},this.DisableTab=function(){var t=0;this.FTabStop&&this.CanFocus()||null!=this.GetContainer()&&this.GetContainer().setAttribute("tabindex","-1");for(var e=0,i=this.GetControlsCount()-1;e<=i;e++)t=e,this.GetControls(t).DisableTab()},this.EnableTab=function(){var t=0;null==this.FContainer||this.GetIsLinked()||(this.FTabStop&&this.CanFocus()?this.FContainer.setAttribute("tabindex",pas.SysUtils.IntToStr(this.FTabOrder+1)):this.FContainer.setAttribute("tabindex","-1"));for(var e=0,i=this.GetControlsCount()-1;e<=i;e++)t=e,this.GetControls(t).EnableTab()},this.SetElementClassName=function(t){this.FElementClassName!==t&&(this.FElementClassName=t,null!=this.FContainer&&this.FContainer.setAttribute("class",t),this.UpdateElement())},this.SetColor=function(t){this.FColor=t,this.UpdateElementVisual(),this.ColorChanging()},this.SetFont=function(t){this.FFont.SetName(t.FName),this.FFont.SetSize(t.FSize),this.FFont.SetStyle(rtl.refSet(t.FStyle)),this.FFont.SetColor(t.FColor)},this.SetParent=function(t){var e;null!=t&&(t=t.CanAcceptChild(this)),e=this.FNew,this.FParent!==t&&(null!=this.FParent&&this.FParent.UnRegisterParent(this),this.FPrevParent=this.FParent,this.FParent=t,this.FGotFocus=!1,this.UpdateParent(),3 in this.FComponentState||(e||this.UpdateElement(),this.InitScript()),null!=this.FParent&&this.FParent.RegisterParent(this),0 in this.FComponentState&&null!=this.FParent&&!(0 in this.FParent.FComponentState)&&this.Loaded(),null==t||null==this.FParent||this.FParent.IsUpdating()||this.Realign(),this.Invalidate())},this.RegisterParent=function(t){this.FControls=rtl.arraySetLength(this.FControls,null,rtl.length(this.FControls)+1),this.FControls[rtl.length(this.FControls)-1]=t},this.UnRegisterParent=function(t){var e=0,i=!1;i=!1;for(var s=0,o=rtl.length(this.FControls)-1;s<=o;s++)e=s,this.FControls[e]===t&&(i=!0),i&&e<rtl.length(this.FControls)-1&&(this.FControls[e]=this.FControls[e+1]);i&&(this.FControls=rtl.arraySetLength(this.FControls,null,rtl.length(this.FControls)-1))},this.CanAcceptChild=function(t){return this,this},this.SetLeft=function(t){this.FLeft!==t&&(this.FLeft=t,this.ResetAnchoring(),this.FUpdateTopLeft||(this.FOrigLeft=t),this.UpdateElementSize(),this.RecreateCanvas(),this.InternalResize(),0 in this.FComponentState||0===this.FAlign||null==this.FParent||this.DoRealign())},this.SetTop=function(t){this.FTop!==t&&(this.FTop=t,this.ResetAnchoring(),this.FUpdateTopLeft||(this.FOrigTop=t),this.UpdateElementSize(),this.RecreateCanvas(),this.InternalResize(),0 in this.FComponentState||0===this.FAlign||null==this.FParent||this.DoRealign())},this.MouseUp=function(t,e,i,s){this.FEnabled&&null!=this.FOnMouseUp&&this.FOnMouseUp(this,t,rtl.refSet(e),i,s)},this.MouseDown=function(t,e,i,s){this.FEnabled&&null!=this.FOnMouseDown&&this.FOnMouseDown(this,t,rtl.refSet(e),i,s)},this.MouseMove=function(t,e,i){this.FEnabled&&null!=this.FOnMouseMove&&this.FOnMouseMove(this,rtl.refSet(t),e,i)},this.TouchStart=function(t,e){null!=this.FOnTouchStart&&this.FOnTouchStart(this,t,e)},this.TouchMove=function(t,e){null!=this.FOnTouchMove&&this.FOnTouchMove(this,t,e)},this.TouchEnd=function(t,e){null!=this.FOnTouchEnd&&this.FOnTouchEnd(this,t,e)},this.TouchCancel=function(t,e){null!=this.FOnTouchCancel&&this.FOnTouchCancel(this,t,e)},this.DoMouseEnter=function(){null!=this.FOnMouseEnter&&this.FOnMouseEnter(this)},this.DoMouseLeave=function(){null!=this.FOnMouseLeave&&this.FOnMouseLeave(this)},this.MouseWheel=function(t,e,i){var s=!1;for(null!=this.FOnMouseWheel&&this.FOnMouseWheel(this,rtl.refSet(t),e,pas.Types.TPoint.$clone(pas.Types.Point(0,0)),i),this.FWheelAccumulator+=e;Math.abs(this.FWheelAccumulator)>=120;)s=this.FWheelAccumulator<0,this.FWheelAccumulator=Math.abs(this.FWheelAccumulator)-120,s?(0!==this.FWheelAccumulator&&(this.FWheelAccumulator=-this.FWheelAccumulator),this.DoMouseWheelDown(rtl.refSet(t),pas.Types.TPoint.$clone(this.FWheelMousePos))):this.DoMouseWheelUp(rtl.refSet(t),pas.Types.TPoint.$clone(this.FWheelMousePos))},this.DoMouseWheelDown=function(t,e){var i=!1;return i=!1,null!=this.FOnMouseWheelDown&&this.FOnMouseWheelDown(this,rtl.refSet(t),pas.Types.TPoint.$clone(e),{get:function(){return i},set:function(t){i=t}}),i},this.DoMouseWheelUp=function(t,e){var i=!1;return i=!1,null!=this.FOnMouseWheelUp&&this.FOnMouseWheelUp(this,rtl.refSet(t),pas.Types.TPoint.$clone(e),{get:function(){return i},set:function(t){i=t}}),i},this.DblClick=function(){null!=this.FOnDblClick&&this.FOnDblClick(this)},this.KeyDown=function(t,e){null!=this.FOnKeyDown&&this.FOnKeyDown(this,t,rtl.refSet(e))},this.KeyPress=function(t){null!=this.FOnKeyPress&&this.FOnKeyPress(this,t)},this.KeyUp=function(t,e){null!=this.FOnKeyUp&&this.FOnKeyUp(this,t,rtl.refSet(e))},this.SetFocus=function(){var t=null;this.CanFocus()&&null!=this.GetElementHandle()&&(t=this.GetElementHandle(),this.FGotFocus?t.focus():setTimeout((function(){t.focus()}),1))},this.DoMarginsChanged=function(t){this.DoRealign()},this.DoRealign=function(){null==this.FParent||this.FParent.IsUpdating()||this.FParent.AlignControl(this.FParent)},this.DoBoundsChange=function(){var t,e=!1;this.UpdateElementSize(),this.RecreateCanvas(),this.FIsResizing||(this.FIsResizing=!0,this.InternalResize(),this.DoRealign(),e=!1,null!=(t=pas["WEBLib.Forms"].GetParentForm(this))&&(e=(e=t.FIsResizing$1)||t.FUpdateCount>0),(e=(e=e||this.FUpdateCount>0)||this.FIsAligning)||this.UpdateChildAnchoring(),this.FIsResizing=!1)},this.DoEndDrag=function(t,e,i){null!=this.FonEndDrag&&this.FonEndDrag(this,t,e,i)},this.DoStartDrag=function(t){null!=this.FOnStartDrag&&this.FOnStartDrag(this,t)},this.DragOver=function(t,e,i,s,o){null!=this.FOnDragOver&&this.FOnDragOver(this,t,e,i,s,o)},this.IsFocused=function(){return this.FContainer===document.activeElement},this.Focused=function(){return this.FContainer===document.activeElement},this.GetID=function(){return this.FID},this.GetElementHandle=function(){var t=null;return t=null,null!=this.FContainer&&this.FControlCreated&&(t=this.FContainer),t},this.GetElementBindHandle=function(){return this.GetElementHandle()},this.GetElement=function(){return document.getElementById(this.GetID())},this.GetKeyCode=function(t,e){var i=0;i=-1;var s=t;return"Up"===s?i=38:"Down"===s?i=40:"Left"===s?i=37:"Right"===s?i=39:"!"===s?i=56:'"'===s||"#"===s?i=51:"$"===s?i=186:"%"===s?i=192:"'"===s?i=52:"("===s?i=53:")"===s?i=219:"*"===s?i=106:"+"===s?i=107:"-"===s?i=109:","===s?i=44:"."===s?i=46:"/"===s?i=111:"\\"===s?i=226:"="===s?i=187:"<"===s||">"===s?i=226:s===pas.Web.TJSKeyNames.BackSpace?i=8:s===pas.Web.TJSKeyNames.Tab?i=9:s===pas.Web.TJSKeyNames.Enter?i=13:s===pas.Web.TJSKeyNames.Shift?i=16:s===pas.Web.TJSKeyNames.Control?i=17:s===pas.Web.TJSKeyNames.Alt?i=18:s===pas.Web.TJSKeyNames.Pause?i=19:s===pas.Web.TJSKeyNames.CapsLock?i=20:s===pas.Web.TJSKeyNames.Escape?i=27:s===pas.Web.TJSKeyNames.PageUp?i=33:s===pas.Web.TJSKeyNames.PageDown?i=34:s===pas.Web.TJSKeyNames._End?i=35:s===pas.Web.TJSKeyNames.Home?i=36:s===pas.Web.TJSKeyNames.ArrowLeft?i=37:s===pas.Web.TJSKeyNames.ArrowUp?i=38:s===pas.Web.TJSKeyNames.ArrowRight?i=39:s===pas.Web.TJSKeyNames.ArrowDown?i=40:s===pas.Web.TJSKeyNames.Insert?i=45:s===pas.Web.TJSKeyNames.Delete?i=46:s===pas.Web.TJSKeyNames.F1?i=112:s===pas.Web.TJSKeyNames.F2?i=113:s===pas.Web.TJSKeyNames.F3?i=114:s===pas.Web.TJSKeyNames.F4?i=115:s===pas.Web.TJSKeyNames.F5?i=116:s===pas.Web.TJSKeyNames.F6?i=117:s===pas.Web.TJSKeyNames.F7?i=118:s===pas.Web.TJSKeyNames.F8?i=119:s===pas.Web.TJSKeyNames.F9?i=120:s===pas.Web.TJSKeyNames.F10?i=121:s===pas.Web.TJSKeyNames.F11?i=122:s===pas.Web.TJSKeyNames.F12?i=123:s===pas.Web.TJSKeyNames.F13?i=124:s===pas.Web.TJSKeyNames.F14?i=125:s===pas.Web.TJSKeyNames.F15?i=126:s===pas.Web.TJSKeyNames.F16?i=127:s===pas.Web.TJSKeyNames.F17?i=128:s===pas.Web.TJSKeyNames.F18?i=129:s===pas.Web.TJSKeyNames.F19?i=130:s===pas.Web.TJSKeyNames.F20?i=131:pas.System.Assigned(t)&&t.length>0&&(i=t.charCodeAt(0),e&&i>=97&&i<=122?i&=223:i>=65&&i<=90?i|=64:i>122&&(i|=128)),i},this.GetKeyChar=function(t){var e="",i=0;i=-1,e="\0";var s=t;return s===pas.Web.TJSKeyNames.BackSpace?i=8:s===pas.Web.TJSKeyNames.Tab?i=9:s===pas.Web.TJSKeyNames.Enter?i=13:s===pas.Web.TJSKeyNames.Shift?i=16:s===pas.Web.TJSKeyNames.Control?i=17:s===pas.Web.TJSKeyNames.Alt?i=18:s===pas.Web.TJSKeyNames.Pause?i=19:s===pas.Web.TJSKeyNames.CapsLock?i=20:s===pas.Web.TJSKeyNames.Escape?i=27:s===pas.Web.TJSKeyNames.PageUp?i=33:s===pas.Web.TJSKeyNames.PageDown?i=34:s===pas.Web.TJSKeyNames._End?i=35:s===pas.Web.TJSKeyNames.Home?i=36:s===pas.Web.TJSKeyNames.ArrowLeft?i=37:s===pas.Web.TJSKeyNames.ArrowUp?i=38:s===pas.Web.TJSKeyNames.ArrowRight?i=39:s===pas.Web.TJSKeyNames.ArrowDown?i=40:s===pas.Web.TJSKeyNames.Insert?i=45:s===pas.Web.TJSKeyNames.Delete?i=46:s===pas.Web.TJSKeyNames.F1?i=112:s===pas.Web.TJSKeyNames.F2?i=113:s===pas.Web.TJSKeyNames.F3?i=114:s===pas.Web.TJSKeyNames.F4?i=115:s===pas.Web.TJSKeyNames.F5?i=116:s===pas.Web.TJSKeyNames.F6?i=117:s===pas.Web.TJSKeyNames.F7?i=118:s===pas.Web.TJSKeyNames.F8?i=119:s===pas.Web.TJSKeyNames.F9?i=120:s===pas.Web.TJSKeyNames.F10?i=121:s===pas.Web.TJSKeyNames.F11?i=122:s===pas.Web.TJSKeyNames.F12?i=123:s===pas.Web.TJSKeyNames.F13?i=124:s===pas.Web.TJSKeyNames.F14?i=125:s===pas.Web.TJSKeyNames.F15?i=126:s===pas.Web.TJSKeyNames.F16?i=127:s===pas.Web.TJSKeyNames.F17?i=128:s===pas.Web.TJSKeyNames.F18?i=129:s===pas.Web.TJSKeyNames.F19?i=130:s===pas.Web.TJSKeyNames.F20?i=131:e=t.charAt(0),-1!==i&&(e=String.fromCharCode(i)),e},this.IsKeyCharacter=function(t){var e=t;return"Up"!==e&&"Down"!==e&&"Left"!==e&&"Right"!==e&&e!==pas.Web.TJSKeyNames.Shift&&e!==pas.Web.TJSKeyNames.Control&&e!==pas.Web.TJSKeyNames.Alt&&e!==pas.Web.TJSKeyNames.Pause&&e!==pas.Web.TJSKeyNames.CapsLock&&e!==pas.Web.TJSKeyNames.PageUp&&e!==pas.Web.TJSKeyNames.PageDown&&e!==pas.Web.TJSKeyNames._End&&e!==pas.Web.TJSKeyNames.Home&&e!==pas.Web.TJSKeyNames.ArrowLeft&&e!==pas.Web.TJSKeyNames.ArrowUp&&e!==pas.Web.TJSKeyNames.ArrowRight&&e!==pas.Web.TJSKeyNames.ArrowDown&&e!==pas.Web.TJSKeyNames.Insert&&e!==pas.Web.TJSKeyNames.Delete&&e!==pas.Web.TJSKeyNames.F1&&e!==pas.Web.TJSKeyNames.F2&&e!==pas.Web.TJSKeyNames.F3&&e!==pas.Web.TJSKeyNames.F4&&e!==pas.Web.TJSKeyNames.F5&&e!==pas.Web.TJSKeyNames.F6&&e!==pas.Web.TJSKeyNames.F7&&e!==pas.Web.TJSKeyNames.F8&&e!==pas.Web.TJSKeyNames.F9&&e!==pas.Web.TJSKeyNames.F10&&e!==pas.Web.TJSKeyNames.F11&&e!==pas.Web.TJSKeyNames.F12&&e!==pas.Web.TJSKeyNames.F13&&e!==pas.Web.TJSKeyNames.F14&&e!==pas.Web.TJSKeyNames.F15&&e!==pas.Web.TJSKeyNames.F16&&e!==pas.Web.TJSKeyNames.F17&&e!==pas.Web.TJSKeyNames.F18&&e!==pas.Web.TJSKeyNames.F19&&e!==pas.Web.TJSKeyNames.F20},this.GetClientRect=function(){var t=pas.Types.TRect.$new(),e="",i=0,s=0;return e=pas.SysUtils.UpperCase(this.GetStyle("border-width")),s=0,(i=pas.System.Pos("PX",e))>0&&(pas.System.Delete({get:function(){return e},set:function(t){e=t}},i,2),pas.System.val$6(e,{get:function(){return s},set:function(t){s=t}},{get:function(){return i},set:function(t){i=t}})),t.$assign(pas.Types.Rect(0,0,this.GetWidth()-2*s,this.GetHeight()-2*s)),t},this.CreateControl=function(){null==this.FElement&&(this.FElement=this.CreateElement(),null!=this.FElement&&(this.FControlCreated=!0,this.FContainer=this.FElement,"body"!==this.GetID()&&this.GetContainer().setAttribute("id",this.GetID()),this.GetContainer().setAttribute("zindex","0"),""!==this.FElementClassName&&this.GetContainer().setAttribute("class",this.FElementClassName),this.CreateChildElements(this.FElement),this.BindEvents(),this.UpdateElement()))},this.ClearMethodPointers=function(){this.FWheelPtr=null,this.FClickPtr=null,this.FDblClickPtr=null,this.FMouseDownPtr=null,this.FMouseUpPtr=null,this.FMouseMovePtr=null,this.FMouseLeavePtr=null,this.FMouseEnterPtr=null,this.FKeyDownPtr=null,this.FKeyUpPtr=null,this.FKeyPressPtr=null,this.FInputPtr=null,this.FEnterPtr=null,this.FExitPtr=null,this.FTouchStartPtr=null,this.FTouchEndPtr=null,this.FTouchMovePtr=null,this.FTouchCancelPtr=null,this.FLayerMouseLeavePtr=null,this.FLayerMouseEnterPtr=null,this.FScriptLoadedPtr=null,this.FContextMenuPtr=null},this.GetMethodPointers=function(){null===this.FWheelPtr&&(this.FWheelPtr=rtl.createCallback(this,"HandleDoWheel"),this.FClickPtr=rtl.createCallback(this,"HandleDoClick"),this.FDblClickPtr=rtl.createCallback(this,"HandleDoDblClick"),this.FMouseDownPtr=rtl.createCallback(this,"HandleDoMouseDown"),this.FMouseUpPtr=rtl.createCallback(this,"HandleDoMouseUp"),this.FMouseMovePtr=rtl.createCallback(this,"HandleDoMouseMove"),this.FMouseLeavePtr=rtl.createCallback(this,"HandleDoMouseLeave"),this.FMouseEnterPtr=rtl.createCallback(this,"HandleDoMouseEnter"),this.FKeyDownPtr=rtl.createCallback(this,"HandleDoKeyDown"),this.FKeyUpPtr=rtl.createCallback(this,"HandleDoKeyUp"),this.FKeyPressPtr=rtl.createCallback(this,"HandleDoKeyPress"),this.FInputPtr=rtl.createCallback(this,"HandleDoInput"),this.FEnterPtr=rtl.createCallback(this,"HandleDoEnter"),this.FExitPtr=rtl.createCallback(this,"HandleDoExit"),this.FTouchStartPtr=rtl.createCallback(this,"HandleDoTouchStart"),this.FTouchEndPtr=rtl.createCallback(this,"HandleDoTouchEnd"),this.FTouchMovePtr=rtl.createCallback(this,"HandleDoTouchMove"),this.FTouchCancelPtr=rtl.createCallback(this,"HandleDoTouchCancel"),this.FLayerMouseLeavePtr=rtl.createCallback(this,"LayerHandleDoMouseLeave"),this.FLayerMouseEnterPtr=rtl.createCallback(this,"LayerHandleDoMouseEnter"),this.FScriptLoadedPtr=rtl.createCallback(this,"RequiredScriptLoaded"),this.FDragStartPtr=rtl.createCallback(this,"HandleDoDragStart"),this.FDragOverPtr=rtl.createCallback(this,"HandleDoDragOver"),this.FDragEnterPtr=rtl.createCallback(this,"HandleDoDragEnter"),this.FDragLeavePtr=rtl.createCallback(this,"HandledoDragLeave"),this.FDragEndPtr=rtl.createCallback(this,"HandleDoDragEnd"),this.FDragDropPtr=rtl.createCallback(this,"HandleDoDragDrop"),this.FContextMenuPtr=rtl.createCallback(this,"HandleDoContextMenu"))},this.EventsBound=function(){return this.FEventsBound},this.BindEvents=function(){var t=null,e=null;null!=this.GetElementBindHandle()&&(this.GetMethodPointers(),this.FEventsBound=!0,t=this.GetElementBindHandle(),e=this.FWheelPtr,t.addEventListener("wheel",e,{passive:!0}),t.addEventListener("click",this.FClickPtr),t.addEventListener("dblclick",this.FDblClickPtr),t.addEventListener("mousedown",this.FMouseDownPtr),t.addEventListener("mouseup",this.FMouseUpPtr),t.addEventListener("mousemove",this.FMouseMovePtr),t.addEventListener("mouseleave",this.FMouseLeavePtr),t.addEventListener("mouseenter",this.FMouseEnterPtr),t.addEventListener("keydown",this.FKeyDownPtr),t.addEventListener("keyup",this.FKeyUpPtr),t.addEventListener("keypress",this.FKeyPressPtr),t.addEventListener("input",this.FInputPtr),t.addEventListener("focus",this.FEnterPtr),t.addEventListener("blur",this.FExitPtr),e=this.FTouchStartPtr,t.addEventListener("touchstart",e,{passive:!0}),e=this.FTouchMovePtr,t.addEventListener("touchmove",e,{passive:!0}),t.addEventListener("touchend",this.FTouchEndPtr),t.addEventListener("touchcancel",this.FTouchCancelPtr),t.addEventListener("contextmenu",this.FContextMenuPtr),t.addEventListener("dragstart",this.FDragStartPtr),t.addEventListener("dragover",this.FDragOverPtr),t.addEventListener("dragenter",this.FDragEnterPtr),t.addEventListener("dragleave",this.FDragLeavePtr),t.addEventListener("dragend",this.FDragEndPtr),t.addEventListener("drop",this.FDragDropPtr))},this.UnbindEvents=function(){var t=null;this.ReleaseCapture(),null!=this.GetElementBindHandle()&&((t=this.GetElementBindHandle()).removeEventListener("wheel",this.FWheelPtr),t.removeEventListener("click",this.FClickPtr),t.removeEventListener("dblclick",this.FDblClickPtr),t.removeEventListener("mousedown",this.FMouseDownPtr),t.removeEventListener("mouseup",this.FMouseUpPtr),t.removeEventListener("mousemove",this.FMouseMovePtr),t.removeEventListener("mouseleave",this.FMouseLeavePtr),t.removeEventListener("mouseenter",this.FMouseEnterPtr),t.removeEventListener("keydown",this.FKeyDownPtr),t.removeEventListener("keyup",this.FKeyUpPtr),t.removeEventListener("keypress",this.FKeyPressPtr),t.removeEventListener("focus",this.FEnterPtr),t.removeEventListener("blur",this.FExitPtr),t.removeEventListener("input",this.FInputPtr),t.removeEventListener("touchstart",this.FTouchStartPtr),t.removeEventListener("touchmove",this.FTouchMovePtr),t.removeEventListener("touchend",this.FTouchEndPtr),t.removeEventListener("touchcancel",this.FTouchEndPtr),t.removeEventListener("contextmenu",this.FContextMenuPtr))},this.AlignControls=function(t,e){var i=this,s=0;function o(t,s){var o=0,n=0,r=0,a=0;t.AnchoringInitialized()||i.InitAnchoring(),t.FUpdateTopLeft=!0,t.FAlignWithMargins?(o=t.FMargins.FLeft,n=t.FMargins.FTop,a=t.FMargins.FBottom,r=t.FMargins.FRight):(o=0,n=0,a=0,r=0);var l=s;1===l?(t.SetBoundsInt(e.Left+o,e.Top+n,e.Right-e.Left-o-r,t.GetHeight()),e.Top=e.Top+t.GetHeight()+n+a):2===l?(t.SetBoundsInt(e.Left+o,e.Bottom-t.GetHeight()-a-1,e.Right-e.Left-o-r-1,t.GetHeight()),e.Bottom=e.Bottom-t.GetHeight()-n-a):3===l?(t.SetBoundsInt(e.Left+o,e.Top+n,t.GetWidth(),e.Bottom-e.Top-n-a),e.Left=e.Left+t.GetWidth()+o+r):4===l?(t.SetBoundsInt(e.Right-t.GetWidth()-r,e.Top+n,t.GetWidth(),e.Bottom-e.Top-a-n),e.Right=e.Right-t.GetWidth()-r-o):5===l&&t.SetBoundsInt(e.Left+o,e.Top+n,e.Right-e.Left-o-r,e.Bottom-e.Top-a-n),t.FUpdateTopLeft=!1}function n(t){var e=0,s=0,n=0,r=null;r=pas.Classes.TList.$create("Create$1");for(var a=0,l=i.GetControlsCount()-1;a<=l;a++)if(e=a,i.GetControls(e).FAlign===t&&(i.GetControls(e).FVisible||4 in i.FComponentState)){n=r.GetCount();for(var h=r.GetCount()-1;h>=0;h--){s=h;var F=t;1===F?i.GetControls(e).FOrigTop<rtl.getObject(r.Get(s)).FOrigTop&&(n=s):3===F?i.GetControls(e).FOrigLeft<rtl.getObject(r.Get(s)).FOrigLeft&&(n=s):4===F?i.GetControls(e).FOrigLeft+i.GetControls(e).GetWidth()>rtl.getObject(r.Get(s)).FOrigLeft+rtl.getObject(r.Get(s)).GetWidth()&&(n=s):2===F&&i.GetControls(e).FOrigTop+i.GetControls(e).GetHeight()>rtl.getObject(r.Get(s)).FOrigTop+rtl.getObject(r.Get(s)).GetHeight()&&(n=s)}r.Insert(n,i.GetControls(e))}for(var p=0,c=r.GetCount()-1;p<=c;p++)e=p,o(rtl.getObject(r.Get(e)),t);r=rtl.freeLoc(r)}n(1),n(2),n(3),n(4),n(5),n(6);for(var r=0,a=this.GetControlsCount()-1;r<=a;r++)s=r,this.GetControls(s).AlignControl(this.GetControls(s))},this.AlignControl=function(t){var e,i=pas.Types.TRect.$new(),s=null,o="",n="",r="",a=null,l=null,h=0,F=0;this.FIsAligning||this.IsUpdating()||0 in this.FComponentState||(null==this.FParent||this.FParent.FVisible)&&(null!=(l=pas["WEBLib.Forms"].GetParentForm(this))&&l.IsUpdating()||(h=0,null!=l&&""!==l.FFormContainer&&pas["WEBLib.Forms"].TCustomForm.isPrototypeOf(t)&&null!=(a=document.getElementById(l.FFormContainer))&&(s=a.getBoundingClientRect(),h=Math.round(s.top+1)),this.FIsAligning=!0,null!=t&&(null!=(e=t.GetElementHandle())&&(o=t.GetElementStyle().getPropertyValue("overflow"),n=t.GetElementStyle().getPropertyValue("overflow-x"),r=t.GetElementStyle().getPropertyValue("overflow-y"),this.FClipChildren&&pas.SysUtils.LowerCase(e.tagName)!==pas["WEBLib.WebTools"].cBodyTag?t.GetElementStyle().setProperty("overflow","hidden"):t.GetElementStyle().setProperty("overflow","")),i.$assign(this.GetClientRect()),this.GetIsLinked()&&(s=this.GetElementHandle().getBoundingClientRect(),i.$assign(pas.Types.Rect(0,0,Math.round(s.right-s.left),Math.round(s.bottom-s.top)))),i.Bottom+h>pas["WEBLib.Forms"].WinHeight()&&1!==this.FHeightStyle&&0!==this.FElementPosition&&!this.GetIsLinked()&&null==pas["WEBLib.Forms"].VSIDE&&(null!=this.FParent&&pas["WEBLib.Forms"].TCustomForm.isPrototypeOf(this.FParent)||pas["WEBLib.Forms"].TCustomForm.isPrototypeOf(this))&&(i.Bottom=pas["WEBLib.Forms"].WinHeight()-h),null!=e&&"BODY"===e.tagName&&(F=0,document.body.scrollHeight>document.body.clientHeight&&!(4 in this.FComponentState)&&(F=16),""!==l.FFormContainer?(i.Bottom=Math.round(Math.min(i.Bottom,pas["WEBLib.Forms"].WinHeight())),i.Right=Math.round(Math.min(i.Right-F,pas["WEBLib.Forms"].WinWidth()))):(i.Bottom=l.GetHeight(),i.Right=l.GetWidth())),pas["WEBLib.Forms"].TCustomForm.isPrototypeOf(t)&&null==pas["WEBLib.Forms"].VSIDE&&(i.Bottom>pas["WEBLib.Forms"].WinHeight()&&(i.Bottom=pas["WEBLib.Forms"].WinHeight()),i.Right>pas["WEBLib.Forms"].WinWidth()&&(i.Right=pas["WEBLib.Forms"].WinWidth())),t.IsStructuralElement()&&i.$assign(this.FParent.GetClientRect()),this.AlignControls(t,i),null!=e&&(t.GetElementStyle().setProperty("overflow",o),t.GetElementStyle().setProperty("overflow-x",n),t.GetElementStyle().setProperty("overflow-y",r)),this.FIsAligning=!1)))},this.InitAnchoring=function(){var t=0,e=0,i=0;function s(e,i,s){var o;i.set(0),s.set(0),null!=(o=pas.TypInfo.GetPropInfo(e.$class.ClassInfo(),"BorderStyle"))&&((t=pas.TypInfo.GetOrdProp$1(e,o))in rtl.createSet(1,4,5)&&(i.set(4),s.set(4)),t in rtl.createSet(2,3)&&(i.set(16),s.set(16)))}if(!this.AnchoringInitialized()){e=0,i=0,pas["WEBLib.Forms"].TForm.isPrototypeOf(this)?(rtl.as(this,pas["WEBLib.Forms"].TForm).IsMiletus()&&s(this,{get:function(){return e},set:function(t){e=t}},{get:function(){return i},set:function(t){i=t}}),this.FOrigRect.$assign(pas.Types.Rect(0,0,this.GetDesignWidth()-e,this.GetDesignHeight()-i))):this.FOrigRect.$assign(pas.Types.Rect(this.GetDesignLeft(),this.GetDesignTop(),this.GetDesignLeft()+this.GetDesignWidth(),this.GetDesignTop()+this.GetDesignHeight())),null!=this.FParent&&(pas["WEBLib.Forms"].TForm.isPrototypeOf(this.FParent)?(rtl.as(this.FParent,pas["WEBLib.Forms"].TForm).IsMiletus()&&s(this.FParent,{get:function(){return e},set:function(t){e=t}},{get:function(){return i},set:function(t){i=t}}),this.FOrigParentRect.$assign(pas.Types.Rect(0,0,this.FParent.GetDesignWidth()-e,this.FParent.GetDesignHeight()-i))):(this.FParent.AnchoringInitialized()||this.FParent.InitAnchoring(),this.FOrigParentRect.$assign(pas.Types.Rect(this.FParent.GetDesignLeft(),this.FParent.GetDesignTop(),this.FParent.GetDesignLeft()+this.FParent.GetDesignWidth(),this.FParent.GetDesignTop()+this.FParent.GetDesignHeight()))));for(var o=0,n=this.GetControlsCount()-1;o<=n;o++)t=o,this.GetControls(t).InitAnchoring()}},this.AnchoringInitialized=function(){return-1!==this.FOrigRect.Left||-1!==this.FOrigRect.Top},this.InitScript=function(){},this.Realign=function(){this.AlignControl(this)},this.Loaded=function(){var t=0;if(0 in this.FComponentState){pas.Classes.TComponent.Loaded.call(this);for(var e=0,i=this.GetControlsCount()-1;e<=i;e++)t=e,this.GetControls(t).FElementPosition in rtl.createSet(1,2)&&!this.GetControls(t).GetIsLinked()&&this.GetControls(t).FChildOrder>=0&&this.GetControls(t).FChildOrder<this.GetChildContainer().childNodes.length&&this.GetChildContainer().insertBefore(this.GetControls(t).GetContainer(),this.GetChildContainer().childNodes.item(this.GetControls(t).FChildOrder)),this.GetControls(t).Loaded();for(var s=0,o=this.GetComponentCount()-1;s<=o;s++)t=s,0 in this.GetComponent(t).FComponentState&&this.GetComponent(t).Loaded();5===this.FAlign&&null!=this.FParent&&this.SetBoundsInt(0,0,this.FParent.FWidth,this.FParent.FHeight),this.Resize(),this.UpdateElement()}},this.InternalResize=function(){0 in this.FComponentState||this.Resize()},this.FontChanged=function(){this.UpdateElementVisual()},this.DisposeOf=function(){var t=null;t=this,t=rtl.freeLoc(t)},this.SetElementColor=function(e,i){var s;s=!(pas["WEBLib.Forms"].Application.FThemed||""!==this.FElementClassName),this.GetIsLinked()||t.SetHTMLElementColor(e,i,!s)},this.MoveElements=function(t,e){if(t&&e)for(;t.childNodes.length;)e.appendChild(t.firstChild)},this.MoveElementsAndFree=function(t,e){if(t&&e){for(;t.childNodes.length;)e.appendChild(t.firstChild);t.remove()}},this.CreateWithID=function(e){var i;this.ClearMethodPointers(),this.FUpdateCount=0,this.FControlCreated=!1,this.FLinkTouchEvents=!0,this.FIsResizing=!1,(null!=this.FOwner&&0 in this.FOwner.FComponentState||null==this.FOwner)&&(null!=this.FOwner&&4 in this.FOwner.FComponentState||this.Loading()),this.FElementPosition=0,this.FWidthStyle=1,this.FHeightStyle=1,i=document.getElementById(e),this.FNew=!(null!=i),this.FFont=pas["WEBLib.Graphics"].TFont.$create("Create$1"),this.FFont.FOnChange=rtl.createCallback(this,"HandleFontChanged"),this.FNew?this.FContainer=null:(this.FContainer=i,this.FControlCreated=!0,this.FElementPosition=1,this.CreateChildElements(i),this.BindElement(),this.BindEvents()),this.FID=e,this.FEnabled=!0,this.FVisible=!0,this.FLeft=0,this.FTop=0,this.FAlign=0,this.FAlignWithMargins=!1,this.FIsAligning=!1,this.FParentFont=!0,this.FParentBiDiMode=!0,this.FParentColor=!1,this.FAnchors=rtl.createSet(0,1),this.FShowFocus=!1,this.FBorderWidth=0,this.FEnablePropagation=!1,this.FToolTip=null,this.FColor=16711422,this.FMargins=t.TMargins.$create("Create$1"),this.FMargins.FOnChange=rtl.createCallback(this,"DoMarginsChanged"),this.FParent=null,this.FPrevParent=null,0 in this.FControlStyle||this.ClearControls(),this.CreateInitialize()},this.AddInstanceStyle=function(t){var e;e=this.FName+"_style",this.$class.AddInstanceStyle$1(e,t)},this.AddInstanceStyle$1=function(t,e){var i,s,o;i=t,s=e,(o=document.getElementById(i))?o.innerHTML=s:((o=document.createElement("style")).type="text/css",o.id=i,o.innerHTML=s,document.getElementsByTagName("head")[0].appendChild(o))},this.AddControlStyle=function(t){var e,i,s,o;e=this.$classname,i=e,s=t,(o=document.getElementById(i))?o.innerHTML=s:((o=document.createElement("style")).type="text/css",o.id=i,o.innerHTML=s,document.getElementsByTagName("head")[0].appendChild(o))},this.AddControlLink=function(t,e){var i,s,o;i=t,s=e,(o=document.getElementById(i))||((o=document.createElement("link")).id=i,o.setAttribute("rel","stylesheet"),o.setAttribute("type","text/css"),o.setAttribute("href",s),document.getElementsByTagName("head")[0].appendChild(o))},this.ResetAnchoring=function(){this.FOrigRect.$assign(pas.Types.Rect(-1,-1,-1,-1)),this.InitAnchoring()},this.UpdateSize=function(){var t=0;this.UpdateElementSize();for(var e=0,i=this.GetControlsCount()-1;e<=i;e++)t=e,this.GetControls(t).UpdateSize()},this.UpdateAnchoring=function(){var t=0,e=0,i=0,s=0,o=0,n=0,r=pas.Types.TRect.$new(),a=pas.Types.TRect.$new();0 in this.FComponentState||this.FControlCreated&&(-1===this.FOrigRect.Left&&-1===this.FOrigRect.Top&&this.InitAnchoring(),(null==this.FParent||this.FParent.AnchoringInitialized())&&(5!==this.FAlign&&(null==this.FParent||pas["WEBLib.Forms"].TForm.isPrototypeOf(this)||(a.$assign(this.FParent.GetBoundsRect()),t=a.Right-a.Left-(this.FOrigParentRect.Right-this.FOrigParentRect.Left),e=a.Bottom-a.Top-(this.FOrigParentRect.Bottom-this.FOrigParentRect.Top),r.$assign(this.FOrigRect),i=0,s=0,o=0,n=0,2 in this.FAnchors&&(0 in this.FAnchors?o=t:i=t),3 in this.FAnchors&&(1 in this.FAnchors?n=e:s=e),(3 in this.FAnchors||2 in this.FAnchors)&&this.SetBoundsInt(r.Left+i,r.Top+s,r.Right-r.Left+o,r.Bottom-r.Top+n))),this.UpdateChildAnchoring()))},this.UpdateChildAnchoring=function(){for(var t=0,e=0,i=this.GetControlsCount()-1;e<=i;e++)t=e,this.GetControls(t).UpdateAnchoring()},this.SetElementPointer=function(e,i){0!==i?e.style.setProperty("cursor",t.GetHTMLCursorName(i)):e.style.removeProperty("cursor")},this.IsUpdating=function(){return this.FUpdateCount>0},this.CanShowFocus=function(){return this.FShowFocus},this.RequiredScriptLoaded=function(t){rtl.asExt(t.target,HTMLScriptElement).title="tmswebloaded",this.FControlScriptCountLoaded+=1},this.StartCapture=function(){var e=null;this.FCaptureDown&&(this.Captured()&&this.ReleaseCapture(),this.FMouseInsideLayer=!0,this.FLayer=document.createElement("SPAN"),document.body.appendChild(this.FLayer),(e=this.FLayer).addEventListener("mouseenter",this.FLayerMouseEnterPtr),e.addEventListener("mouseleave",this.FLayerMouseLeavePtr),e.addEventListener("mousedown",this.FMouseDownPtr),e.addEventListener("mouseup",this.FMouseUpPtr),e.addEventListener("mousemove",this.FMouseMovePtr),e.addEventListener("touchstart",this.FTouchStartPtr),e.addEventListener("touchmove",this.FTouchMovePtr),e.addEventListener("touchend",this.FTouchEndPtr),e.addEventListener("touchcancel",this.FTouchCancelPtr),e.style.setProperty("top","0"),e.style.setProperty("left","0"),e.style.setProperty("right","0"),e.style.setProperty("bottom","0"),e.style.setProperty("webkit-user-select","none"),e.style.setProperty("moz-user-select","none"),e.style.setProperty("khtml-user-select","none"),e.style.setProperty("ms-user-select","none"),e.style.setProperty("user-select","none"),e.style.setProperty("position","absolute"),e.style.setProperty(t.CSSZIndex,"999999"),this.FCaptured=!0,this.UpdateElement())},this.GetStyle=function(t){var e,i="",s="";return s="",null==(e=this.GetElementHandle())?i:(window.getComputedStyle&&(s=getComputedStyle(e,"")[t]),e.currentStyle&&(s=e.currentStyle[t]),i=s)},this.SetBoundsInt=function(t,e,i,s){(t!==this.GetLeft()||e!==this.GetTop()||i!==this.GetWidth()&&1===this.FWidthStyle||s!==this.GetHeight()&&1===this.FHeightStyle||null!=this.FParent&&this.FParent.GetIsLinked())&&(this.FBlockUpdateElement=!0,this.FLeft=t,this.FTop=e,this.FWidth=i,this.FHeight=s,this.FBlockUpdateElement=!1,this.UpdateElementSize(),0!==this.FAlign?this.DoRealign():this.Realign(),this.RecreateCanvas(),this.DoBoundsChange(),this.Invalidate(),this.UpdateChildAnchoring())},this.MoveFirst=function(t){var e=0,i=!1;i=!1;for(var s=this.GetControlsCount()-1;s>=0;s--)e=s,this.FControls[e]===t&&(i=!0),i&&(this.FControls[e]=e>0?this.FControls[e-1]:t)},this.MoveLast=function(t){var e=0,i=!1;i=!1;for(var s=0,o=this.GetControlsCount()-1;s<=o;s++)e=s,this.FControls[e]===t&&(i=!0),i&&(e<this.GetControlsCount()-1?this.FControls[e]=this.FControls[e+1]:this.FControls[e]=t)},this.EnableDrag=function(){null!=this.GetContainer()&&this.GetContainer().setAttribute("draggable","true")},this.DisableDrag=function(){null!=this.GetContainer()&&"true"===this.GetContainer().getAttribute("draggable")&&this.GetContainer().setAttribute("draggable","false")},this.Create$2=function(t){return this.FGotFocus=!1,this.FTabStop=!0,this.FAllowTouch=!0,this.CreateWithID(t),this},this.Create$1=function(t){var e,i,s=!1;return this.FGotFocus=!1,this.FEventsBound=!1,this.FTabStop=!0,this.FAllowTouch=!0,this.FNoUserSelect=!0,this.ClearMethodPointers(),pas.Classes.TComponent.Create$1.call(this,t),this.FEventStopPropagation=rtl.createSet(0,4,2,3,1,5,6,7),this.FScriptLoaded=!1,this.FElementFont=0,this.FElementPosition=0,this.FParentElement=null,this.FTextDirection=0,s=!1,null!=(i=pas["WEBLib.Forms"].GetParentForm(this))&&(s=4 in i.FComponentState),e=this.GetNewName(),s?this.CreateWithID(""):this.CreateWithID(e),null==t||4 in t.FComponentState||this.SetName(e),this},this.Destroy=function(){this.UnbindEvents(),this.DestroyControls(),null!=this.GetContainer()&&null!=this.FParent&&null!=this.FParent.GetChildContainer()&&(this.FParent.GetChildContainer()===this.GetContainer().parentNode&&this.FParent.GetChildContainer().removeChild(this.GetContainer()),this.FContainer=null,this.SetParent(null),this.FControlCreated=!1),rtl.free(this,"FRequiredScripts"),rtl.free(this,"FMargins"),rtl.free(this,"FFont"),pas.System.Assigned(this.FToolTip)&&(FToolTip.dispose(),this.FToolTip=null),pas.Classes.TComponent.Destroy.call(this)},this.Assign=function(t){},this.DragDrop=function(t,e,i){null!=this.FOnDragDrop&&this.FOnDragDrop(this,t,e,i)},this.Resize=function(){null!=this.FOnResize&&this.FOnResize(this)},this.Capture=function(){this.FCaptureDown=!0,window.setTimeout(rtl.createSafeCallback(this,"StartCapture"),100)},this.ReleaseCapture=function(){var t=null;this.FCaptureDown=!1,this.FCaptured&&null!=this.FLayer&&((t=this.FLayer).removeEventListener("mouseenter",this.FLayerMouseEnterPtr),t.removeEventListener("mouseleave",this.FLayerMouseLeavePtr),t.removeEventListener("mousedown",this.FMouseDownPtr),t.removeEventListener("mouseup",this.FMouseUpPtr),t.removeEventListener("mousemove",this.FMouseMovePtr),t.removeEventListener("touchstart",this.FTouchStartPtr),t.removeEventListener("touchmove",this.FTouchMovePtr),t.removeEventListener("touchend",this.FTouchEndPtr),t.removeEventListener("touchcancel",this.FTouchEndPtr),document.body.removeChild(t),this.FCaptured=!1,this.FLayer=null,this.UpdateElement())},this.BringToFront=function(){if(null!=this.GetElementHandle()&&null!=this.GetElementHandle().parentElement)try{this.GetElementHandle().parentElement.appendChild(this.GetElementHandle()),null!=this.FParent&&this.FParent.MoveLast(this)}catch(t){}},this.SendToBack=function(){null!=this.GetElementHandle()&&null!=this.GetElementHandle().parentElement&&(this.GetElementHandle().parentElement.insertBefore(this.GetElementHandle(),this.GetElementHandle().parentElement.firstElementChild),null!=this.FParent&&this.FParent.MoveFirst(this))},this.PreventDefault=function(){null!=this.GetElementEvent()&&this.GetElementEvent().preventDefault()},this.StopPropagation=function(){null==this.GetElementEvent()||this.FEnablePropagation||this.GetElementEvent().stopPropagation()},this.BeginDrag=function(){this.EnableDrag()},this.BeginUpdate=function(){this.FUpdateCount+=1},this.EndUpdate=function(){this.FUpdateCount>0&&(this.FUpdateCount-=1,0===this.FUpdateCount&&this.UpdateElement())},this.Invalidate=function(){},this.SetParentComponent=function(e){this.FParent!==e&&t.TControl.isPrototypeOf(e)&&this.SetParent(e)},this.SetBounds=function(t,e,i,s){this.SetBoundsInt(t,e,i,s),this.FWidth=i,this.FHeight=s,this.FUpdateTopLeft||(this.FOrigTop=e,this.FOrigLeft=t),this.ResetAnchoring(),0 in this.FComponentState||0===this.FAlign||null==this.FParent||this.DoRealign()},this.XYToClient=function(t,e,i,s){var o=null,n=null,r=null,a=0,l=0,h=!1,F=!1,p=pas.Types.TRect.$new(),c=null,u=0,C=0,T=0,S=0;if(h=!0,F=!1,T=0,S=0,0!==this.FElementPosition)return h=!1,a=t-(n=this.GetElementHandle().getBoundingClientRect()).left,l=e-n.top,i.set(a),void s.set(l);for(T=document.body.scrollLeft+document.documentElement.scrollLeft,S=document.body.scrollTop+document.documentElement.scrollTop,a=t-this.GetLeft(),l=e-this.GetTop(),i.set(a),s.set(l),o=this.FParent,pas["WEBLib.Forms"].TCustomForm.isPrototypeOf(this)&&null==o&&null!=this.GetContainer()&&(n=this.GetContainer().getBoundingClientRect(),i.set(i.get()-n.left),s.set(s.get()-n.top));null!=o;){if(o.GetIsLinked())n=pas["WEBLib.Forms"].TCustomForm.isPrototypeOf(o)?o.GetContainer().getBoundingClientRect():o.GetElementHandle().getBoundingClientRect(),i.set(i.get()-n.left),s.set(s.get()-n.top),T=0,S=0;else if(pas["WEBLib.Forms"].TCustomForm.isPrototypeOf(o))""!==rtl.as(o,pas["WEBLib.Forms"].TCustomForm).FFormContainer&&null!=(r=document.getElementById(rtl.as(o,pas["WEBLib.Forms"].TCustomForm).FFormContainer))&&(F=!0,n=r.getBoundingClientRect(),i.set(i.get()-n.left),s.set(s.get()-n.top)),null!=rtl.as(o,pas["WEBLib.Forms"].TCustomForm).GetContainer()&&""===rtl.as(o,pas["WEBLib.Forms"].TCustomForm).FFormContainer&&rtl.as(o,pas["WEBLib.Forms"].TCustomForm).FPopup&&(n=rtl.as(o,pas["WEBLib.Forms"].TCustomForm).GetContainer().getBoundingClientRect(),i.set(i.get()-n.left),s.set(s.get()-n.top),p.$assign(rtl.as(o,pas["WEBLib.Forms"].TCustomForm).GetClientRect()),s.set(s.get()+p.Top),T=0,S=0);else if(o.FElementPosition in rtl.createSet(1,2)){if(null!=o.GetElementHandle()){n=o.GetElementHandle().getBoundingClientRect(),i.set(a-n.left),s.set(l-n.top),T=0,S=0,h&&(c=window.getComputedStyle(document.documentElement),u=parseInt(c.marginLeft,10),C=parseInt(c.marginTop,10),i.set(i.get()+u),s.set(s.get()+C)),h=!1;break}}else 0===o.FElementPosition&&h&&(i.set(i.get()-o.GetLeft()),s.set(s.get()-o.GetTop()),null!=o.GetElementHandle()&&(i.set(i.get()+o.GetElementHandle().scrollLeft),s.set(s.get()+o.GetElementHandle().scrollTop)),a=i.get(),l=s.get());o=o.FParent}0!==this.FElementPosition||F||(i.set(i.get()+T),s.set(s.get()+S))},this.GetChildren=function(t,e){for(var i=0,s=null,o=0,n=this.GetControlsCount()-1;o<=n;o++)i=o,(s=this.GetControls(i)).FOwner!==e&&null!==e||t(s)},this.Captured=function(){return this.FCaptured&&null!=this.FLayer},this.MakeScreenshot=function(){return null,null},this.ClientToScreen=function(t){var e=pas.Types.TPoint.$new(),i=pas.Types.TPoint.$new();return i.$assign(this.GetClientOrigin()),e.x=t.x+i.x,e.y=t.y+i.y,e},this.ScreenToClient=function(t){var e=pas.Types.TPoint.$new(),i=pas.Types.TPoint.$new();return i.$assign(this.GetClientOrigin()),e.x=t.x-i.x,e.y=t.y-i.y,e},this.CanFocus=function(){return!0,!0},this.HasHorzScrollBar=function(){var t=!1;return t=!1,null!=this.GetElementHandle()&&(t=this.GetElementHandle().clientWidth<this.GetElementHandle().scrollWidth),t},this.HasVertScrollBar=function(){var t=!1;return t=!1,null!=this.GetElementHandle()&&(t=this.GetElementHandle().clientHeight<this.GetElementHandle().scrollHeight),t},rtl.addIntf(this,pas.System.IUnknown)})),this.TScrollBarKind={0:"sbHorizontal",sbHorizontal:0,1:"sbVertical",sbVertical:1},this.$rtti.$Enum("TScrollBarKind",{minvalue:0,maxvalue:1,ordtype:1,enumtype:this.TScrollBarKind}),rtl.createClass(this,"TControlScrollBar",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FKind=0,this.FControl=null},this.$final=function(){this.FControl=void 0,pas.Classes.TPersistent.$final.call(this)},this.Create$1=function(t,e){return this.FControl=t,this.FKind=e,this}})),rtl.createClass(this,"TWinControl",this.TControl,(function(){rtl.addIntf(this,pas.System.IUnknown);var e=this.$rtti;e.addProperty("Cursor",2,t.$rtti.TCursor,"FCursor","SetControlCursor",{Default:0}),e.addProperty("ElementClassName",2,t.$rtti.TElementClassName,"FElementClassName","SetElementClassName"),e.addProperty("Enabled",2,rtl.boolean,"FEnabled","SetEnabled",{Default:!0}),e.addProperty("Height",3,rtl.longint,"GetHeight","SetHeight"),e.addProperty("Hint",2,rtl.string,"FHint","SetHint"),e.addProperty("Left",3,rtl.longint,"GetLeft","SetLeft"),e.addProperty("ShowHint",2,rtl.boolean,"FShowHint","SetShowHint",{Default:!1}),e.addProperty("Tag",0,rtl.longint,"FTag$1","FTag$1",{Default:0}),e.addProperty("Top",3,rtl.longint,"GetTop","SetTop"),e.addProperty("Visible",2,rtl.boolean,"FVisible","SetVisible",{Default:!0}),e.addProperty("Width",3,rtl.longint,"GetWidth","SetWidth"),e.addProperty("OnMouseDown",0,t.$rtti.TMouseEvent,"FOnMouseDown","FOnMouseDown"),e.addProperty("OnMouseUp",0,t.$rtti.TMouseEvent,"FOnMouseUp","FOnMouseUp"),e.addProperty("OnMouseMove",0,t.$rtti.TMouseMoveEvent,"FOnMouseMove","FOnMouseMove"),e.addProperty("OnMouseEnter",0,t.$rtti.TNotifyEvent,"FOnMouseEnter","FOnMouseEnter"),e.addProperty("OnMouseLeave",0,t.$rtti.TNotifyEvent,"FOnMouseLeave","FOnMouseLeave"),e.addProperty("OnKeyUp",0,t.$rtti.TKeyEvent,"FOnKeyUp","FOnKeyUp"),e.addProperty("OnKeyDown",0,t.$rtti.TKeyEvent,"FOnKeyDown","FOnKeyDown"),e.addProperty("OnKeyPress",0,t.$rtti.TKeyPressEvent,"FOnKeyPress","FOnKeyPress"),e.addProperty("OnEnter",0,t.$rtti.TNotifyEvent,"FOnEnter","FOnEnter"),e.addProperty("OnExit",0,t.$rtti.TNotifyEvent,"FOnExit","FOnExit")})),rtl.createClass(this,"TCustomControl",this.TWinControl,(function(){this.$init=function(){t.TWinControl.$init.call(this),this.FCaption="",this.FPixelRatio=0,this.FPainting=!1,this.FCanvas=null,this.FElementCanvas=null,this.FBorderStyle=0,this.FBorderColor=0,this.FCustomBorder=!1,this.FOnScreenShot=null},this.$final=function(){this.FCanvas=void 0,this.FElementCanvas=void 0,this.FOnScreenShot=void 0,t.TWinControl.$final.call(this)},this.GetCanvas=function(){return null==this.FCanvas&&(this.GetIsLinked()?(null==this.FElementCanvas&&(this.FElementCanvas=document.getElementById(this.GetID())),this.RecreateCanvas()):this.CreateControl()),this.FCanvas},this.RenderDesigning=function(t,e,i,s,o){var n,r=null,a=null,l=null;if(n=null!=(a=(r=e).firstChild)&&"DIV"===a.tagName&&"1"===a.getAttribute("data-design"),4 in i.FComponentState&&s&&""===this.FElementClassName){if(r.style.setProperty("border","1px solid gray"),""===o?r.style.setProperty("background-color","#F0F0F0"):r.style.setProperty("background-color","white"),n)return;r.innerHTML="",""!==o&&((l=document.createElement("DIV")).style.setProperty("background-color","white"),l.style.setProperty("background-repeat","no-repeat"),l.style.setProperty("background-position-y","center"),l.style.setProperty("background-image","url("+o+")"),l.style.setProperty("background-position-x","center"),l.style.setProperty("background-size","128px"),l.style.setProperty("top","50%"),l.style.setProperty("left","50%"),l.style.setProperty("height","70%"),r.appendChild(l)),(a=document.createElement("DIV")).setAttribute("data-design","1"),a.innerHTML=t,a.style.setProperty("position","relative"),a.style.setProperty("top","50%"),a.style.setProperty("left","50%"),a.style.setProperty("display","inline-block"),a.style.setProperty("transform","translateX(-50%)"),this.FCustomBorder=!0,r.appendChild(a)}else if(n){for(;null!=r.firstChild;)r.removeChild(r.firstChild);r.style.removeProperty("border"),r.style.removeProperty("background-color")}},this.GetPixelRatio=function(){var t=document.createElement("canvas").getContext("2d");return(window.devicePixelRatio||1)/(t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1)},this.RecreateCanvas=function(){var t=0,e=null,i=0,s=0;null!=this.FElementCanvas&&(this.FPainting||(null!=(e=this.GetIsLinked()?this.GetElementHandle():document.getElementById(this.GetID()+"_Canvas"))&&(this.FElementCanvas=e,rtl.free(this,"FCanvas"),this.FCanvas=null),t=this.GetPixelRatio(),i=this.GetHeight()-this.GetCanvasHeightOffset(),s=this.GetWidth()-this.GetCanvasWidthOffset(),1===this.FElementPosition?this.FElementCanvas.style.setProperty("position","relative"):this.FElementCanvas.style.setProperty("position","absolute"),this.FElementCanvas.style.setProperty("height",pas.SysUtils.IntToStr(i)+"px"),this.FElementCanvas.style.setProperty("width",pas.SysUtils.IntToStr(s)+"px"),this.FElementCanvas.height=Math.round(i*t),this.FElementCanvas.width=Math.round(s*t)),null==this.FCanvas&&(this.FCanvas=pas["WEBLib.Graphics"].TCanvas.$create("Create$1",[this.FElementCanvas])),this.FCanvas.FApplyPixelRatio=!0,this.FCanvas.SetTransform(1,0,0,1,0,0))},this.SetBorderStyle=function(t){this.FBorderStyle!==t&&(this.FBorderStyle=t,this.UpdateElement())},this.SetBorderColor=function(t){this.FBorderColor!==t&&(this.FBorderColor=t,this.UpdateElement())},this.SetName=function(e){var i={},s="";if(s="",null!=pas["WEBLib.Forms"].VSIDE&&4 in this.FComponentState||pas["WEBLib.Forms"].TFrame.isPrototypeOf(this)&&(s="F"+t.FindUniqueName(this.FName)+"_"),pas.Classes.TComponent.SetName.call(this,s+e),1 in this.FControlStyle&&4 in this.FComponentState&&!(0 in this.FComponentState)){if(null!=this.FOwner&&0 in this.FOwner.FComponentState)return;i=rtl.refSet(this.FControlStyle),this.SetCaption(e),this.FControlStyle=rtl.refSet(i)}},this.SetCaption=function(t){this.FCaption=t,this.FControlStyle=rtl.diffSet(this.FControlStyle,rtl.createSet(1))},this.CreateControl=function(){t.TControl.CreateControl.call(this),this.RecreateCanvas()},this.Loaded=function(){t.TControl.Loaded.call(this),this.Invalidate()},this.UpdateElementVisual=function(){t.TControl.UpdateElementVisual.call(this),null!=this.GetElementHandle()&&(this.GetIsLinked()||""!==this.FElementClassName||(1===this.FBorderStyle?this.FCustomBorder?(this.GetElementStyle().setProperty("border-style","solid"),this.GetElementStyle().setProperty("border-width","1px"),this.GetElementStyle().setProperty("border-color",pas["WEBLib.Graphics"].ColorToHTML(this.FBorderColor))):this.GetElementStyle().setProperty("border-style",""):this.GetElementStyle().setProperty("border-style","none")),""!==this.FElementClassName&&(this.GetElementStyle().removeProperty("border-style"),this.GetElementStyle().removeProperty("border-width"),this.GetElementStyle().removeProperty("border-color")))},this.CreateElement=function(){var t=null;return this.FElementCanvas=document.createElement("CANVAS"),0 in this.FControlStyle?((t=document.createElement("SPAN")).appendChild(this.FElementCanvas),""!==this.GetID()&&this.FElementCanvas.setAttribute("id",this.GetID()+"_Canvas"),this.FElementCanvas.setAttribute("zindex","-1")):t=this.FElementCanvas,t},this.GetCanvasHeightOffset=function(){return 0,0},this.GetCanvasWidthOffset=function(){return 0,0},this.BindElement=function(){"CANVAS"===this.GetContainer().tagName||this.FControlCreated||(this.FElementCanvas=document.createElement("CANVAS"),this.GetContainer().appendChild(this.FElementCanvas))},this.BindEvents=function(){t.TControl.BindEvents.call(this)},this.HandleScreenShot=function(t){null!=this.FOnScreenShot&&this.FOnScreenShot(this,t)},this.Paint=function(){},this.CreateInitialize=function(){t.TControl.CreateInitialize.call(this),this.FControlStyle=rtl.unionSet(this.FControlStyle,rtl.createSet(1)),this.FBorderStyle=1,this.FBorderColor=12632256,this.FPainting=!1,this.FWidth=100,this.FHeight=25,this.FWidthPercent=100,this.FHeightPercent=100,this.FCustomBorder=!1},this.Destroy=function(){null!=this.FCanvas&&rtl.free(this,"FCanvas"),t.TControl.Destroy.call(this)},this.MakeScreenshot=function(){var t=null;return(t=pas["WEBLib.Graphics"].TBitmap.$create("Create$3")).FOnChange=rtl.createCallback(this,"HandleScreenShot"),t.LoadFromCanvas(this.GetCanvas()),t},this.Resize=function(){t.TControl.Resize.call(this),this.Invalidate()},this.Invalidate=function(){var e=null;t.TControl.Invalidate.call(this),null===this.FParent||3 in this.FComponentState||this.FVisible&&(this.FUpdateCount>0||null!=(e=pas["WEBLib.Forms"].GetParentForm(this))&&e.IsUpdating()||(this.GetPixelRatio()!==this.FPixelRatio&&this.RecreateCanvas(),this.FPixelRatio=this.GetPixelRatio(),this.FPainting=!0,null!=this.FCanvas&&this.FCanvas.Clear(),this.Paint(),this.FPainting=!1))},this.SetFocus=function(){t.TControl.SetFocus.call(this)},this.Focused=function(){return t.TControl.Focused.call(this)},this.EndUpdate=function(){t.TControl.EndUpdate.call(this),0===this.FUpdateCount&&this.Invalidate()},rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TCustomHTMLDiv",this.TCustomControl,(function(){this.CreateElement=function(){return document.createElement("DIV")},rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TControlManager",pas.Classes.TComponent,(function(){this.$init=function(){pas.Classes.TComponent.$init.call(this),this.FInstanceCount=0},this.Create$1=function(t){return pas.Classes.TComponent.Create$1.apply(this,arguments),this.FInstanceCount=0,this},this.GetInstanceNumber=function(){return this.FInstanceCount+=1,this.FInstanceCount},rtl.addIntf(this,pas.System.IUnknown)})),this.FindGlobalComponent=function(t){return null,null},this.GetMousePos=function(){var t=pas.Types.TPoint.$new();return t.$assign(pas.Types.Point(e.FMouseX,e.FMouseY)),t},this.FindUniqueName=function(t){return t+pas.SysUtils.IntToStr(e.ControlManager.GetInstanceNumber())},this.GetScrollBarHeight=function(){var t=0;if(0===(t=e.ScrollBH)){var i=document.createElement("div");i.style.visibility="hidden",i.style.height="100px",i.style.msOverflowStyle="scrollbar",document.body.appendChild(i);var s=i.offsetHeight;i.style.overflow="scroll";var o=document.createElement("div");o.style.height="100%",i.appendChild(o);var n=o.offsetHeight;i.parentNode.removeChild(i),t=s-n,t=0,e.ScrollBH=t}return t},this.GetScrollBarWidth=function(){var t=0;if(0===(t=e.ScrollBW)){var i=document.createElement("div");i.style.visibility="hidden",i.style.width="100px",i.style.msOverflowStyle="scrollbar",document.body.appendChild(i);var s=i.offsetWidth;i.style.overflow="scroll";var o=document.createElement("div");o.style.width="100%",i.appendChild(o);var n=o.offsetWidth;i.parentNode.removeChild(i),t=s-n,e.ScrollBW=t}return t},this.SetHTMLElementFont=function(t,e,i){var s="";i?(t.style.removeProperty("font-family"),t.style.removeProperty("font-style"),t.style.removeProperty("font-weight"),t.style.removeProperty("font-size"),t.style.removeProperty("text-decoration")):(t.style.setProperty("font-family",e.FName),t.style.setProperty("font-style","normal"),0 in e.FStyle?t.style.setProperty("font-weight","bold"):t.style.setProperty("font-weight",""),1 in e.FStyle&&t.style.setProperty("font-style","italic"),s="",3 in e.FStyle&&(s="underline"),2 in e.FStyle&&(""!==s&&(s+=" "),s+="line-through"),""!==s?t.style.setProperty("text-decoration",s):t.style.removeProperty("text-decoration"),t.style.setProperty("font-size",pas.SysUtils.IntToStr(e.FSize)+"pt"))},this.SetHTMLElementColor=function(t,i,s){s||-1===i||16711422===i?t.style.removeProperty(e.cStyleBkgColor):t.style.setProperty(e.cStyleBkgColor,pas["WEBLib.Graphics"].ColorToHTML(i))},this.GetHTMLCursorName=function(t){var e="";e="default";return 0===t?e="default":2===t?e="auto":1===t?e="none":3===t?e="crosshair":4===t?e="text":6===t?e="nesw-resize":7===t?e="ns-resize":8===t?e="nwse-resize":9===t?e="ew-resize":10===t?e="n-resize":11===t?e="wait":12===t?e="copy":13===t?e="no-drop":14===t?e="col-resize":15===t?e="row-resize":16===t?e="copy":17===t?e="progress":18===t?e="not-allowed":19===t?e="progress":20===t?e="help":21===t?e="pointer":22!==t&&5!==t||(e="move"),e},this.GetHTMLElementAbsoluteRect=function(t){var e=pas.Types.TRect.$new(),i="";function s(t){var e=0,i=0;return t=pas.SysUtils.StringReplace(t,"px","",rtl.createSet(0)),pas.System.val$6(t,{get:function(){return e},set:function(t){e=t}},{get:function(){return i},set:function(t){i=t}}),e}return i=t.style.getPropertyValue("left"),e.Left=s(i),i=t.style.getPropertyValue("top"),e.Top=s(i),i=t.style.getPropertyValue("width"),e.Right=e.Left+s(i),i=t.style.getPropertyValue("height"),e.Bottom=e.Top+s(i),e},this.IsAndroid=function(){var t;return t=navigator.userAgent,pas.System.Pos("Android",t)>0},this.GetMaterialClass=function(t){var e="";e="material-icons";return 1===t?e="material-icons-outlined":2===t?e="material-icons-two-tone":3===t?e="material-icons-round":4===t&&(e="material-icons-sharp"),e},t.$implcode=function(){e.ControlManager=null,e.FMouseX=0,e.FMouseY=0,e.FCursorX=0,e.FCursorY=0,e.ScrollBW=0,e.ScrollBH=0,e.DragObject=null,e.cStyleBkgColor="background-color"},t.$init=function(){e.ScrollBW=0,e.ScrollBH=0,e.DragObject=null,e.ControlManager=t.TControlManager.$create("Create$1",[null])}}),["WEBLib.Dialogs","WEBLib.Forms","Math","TypInfo","WEBLib.WebTools","WEBLib.Utils"]),rtl.module("WEBLib.WebTools",["System","Classes","Web","JS","WEBLib.Controls","WEBLib.Graphics"],(function(){"use strict";var t=this;this.cBodyTag="body",this.cHTMLExt=".html",this.DoubleToHTML=function(t){return pas.SysUtils.Format$1("%g",pas.System.VarRecs(3,t),pas.SysUtils.TFormatSettings.Invariant())},this.GetLocaleShortDateFormat=function(t){return pas.SysUtils.TFormatSettings.Create$1(t).ShortDateFormat},this.GetLocaleLongDayName=function(t,e){var i=new Date(2017,0,1);i.setDate(i.getDate()+t-1);var s="";return s=""==e?navigator.language:e,i.toLocaleDateString(s,{weekday:"long"})},this.GetLocaleShortDayName=function(t,e){var i=new Date(2017,0,1);i.setDate(i.getDate()+t-1);var s="";return s=""==e?navigator.language:e,i.toLocaleDateString(s,{weekday:"short"})},this.GetLocaleLongMonthName=function(t,e){var i=new Date(2017,t-1,1),s="";return s=""==e?navigator.language:e,i.toLocaleDateString(s,{month:"long"})},this.GetLocaleShortMonthName=function(t,e){var i=new Date(2017,t-1,1),s="";return s=""==e?navigator.language:e,i.toLocaleDateString(s,{month:"short"})},this.GetLocaleDecimalSeparator=function(t){var e=1.1,i="";return i=""==t?navigator.language:t,e=e.toLocaleString(i).substring(1,2)},this.GetBrowserLocale=function(){return navigator.language},this.ProcessAccelerator=function(t,e){var i,s=0,o="";for(i=t.length,e.set(""),o="",s=1;s<=i;)"&"===t.charAt(s-1)?(s+1<=i&&"&"!==t.charAt(s+1-1)?(o=o+"<u>"+t.charAt(s+1-1)+"</u>",e.set(t.charAt(s+1-1))):s+1<=i&&"&"===t.charAt(s+1-1)&&(o+="&"),s+=2):(o+=t.charAt(s-1),s+=1);return o},this.HexImageDecode=function(t){var e,i=0,s=0,o=null,n=0,r=0,a=0;e=rtl.trunc(t.length/2),s=0,(n=t.charCodeAt(0)-48)>=10&&(n-=7),(r=t.charCodeAt(1)-48)>=10&&(r-=7),a=1+(r+(n<<4)),(i=pas.System.Pos("4A5045474",t))>1&&i<10&&(a+=4),(i=pas.System.Pos("4269746D6",t))>1&&i<10&&(a+=4),o=new Uint8Array(e-a);for(var l=a+1,h=e;l<=h;l++)i=l,(n=t.charCodeAt(2*i-1-1)-48)>=10&&(n-=7),(r=t.charCodeAt(2*i-1)-48)>=10&&(r-=7),r+=n<<4,o[s]=r,s+=1;return o},this.HexImageEncodeFromBase64=function(e){var i;return e=e.replace(/^data:image\/\S+;base64,/,""),i=Uint8Array.from(atob(e),(function(t){return t.charCodeAt(0)})),t.HexImageEncode(i)},this.HexImageEncode=function(t){var e="",i=0,s=0,o=0,n="",r="";if(e="",0===(s=t.length))return e;s=((255&s)<<24)+((65280&s)<<8)+((16711680&s)>>>8)+((4278190080&s)>>>24),r="",137===t[0]&&80===t[1]&&(o=(n="TPngImage").length),255===t[0]&&216===t[1]&&(o=(n="TJPEGImage").length,r=pas.SysUtils.IntToHex(s,8)),66===t[0]&&77===t[1]&&(o=(n="TBitmap").length,r=pas.SysUtils.IntToHex(s,8)),71===t[0]&&73===t[1]&&(o=(n="TGIFImage").length),e=pas.SysUtils.IntToHex(o,2);for(var a=1,l=n.length;a<=l;a++)i=a,o=n.charCodeAt(i-1),e+=pas.SysUtils.IntToHex(o,2);e+=r;for(var h=0,F=t.length-1;h<=F;h++)o=t[i=h],e+=pas.SysUtils.IntToHex(o,2);return e},this.HexImageDecodeAsBase64=function(e){var i;return i=t.HexImageDecode(e),e=btoa(new Uint8Array(i).reduce((function(t,e){return t+String.fromCharCode(e)}),""))},this.HTMLToString=function(t){return t=pas.SysUtils.StringReplace(t,"<","&lt;",rtl.createSet(0)),pas.SysUtils.StringReplace(t,">","&gt;",rtl.createSet(0))},this.ElementVisible=function(e){var i=!1,s=null;for(i=!1,s=e;null!=s;)pas.SysUtils.LowerCase(s.tagName)===t.cBodyTag&&(i=!0),s=s.parentElement;if(!i)return i;for(;null!=e;){if("none"===e.style.getPropertyValue("display"))return i=!1;if(s=e.parentElement,!rtl.isExt(s,HTMLElement))return i;e=s}return i}}),["SysUtils","WEBLib.Utils"]),rtl.module("contnrs",["System","SysUtils","Classes"],(function(){"use strict";var t=this,e=t.$impl;rtl.createClass(this,"TFPObjectList",pas.System.TObject,(function(){this.$init=function(){pas.System.TObject.$init.call(this),this.FFreeObjects=!1,this.FList=null},this.$final=function(){this.FList=void 0,pas.System.TObject.$final.call(this)},this.GetCount=function(){return this.FList.FCount},this.GetItem=function(t){return rtl.getObject(this.FList.Get(t))},this.SetItem=function(t,e){var i=null;this.FFreeObjects?(i=rtl.getObject(this.FList.Get(t)),this.FList.Put(t,e),i=rtl.freeLoc(i)):this.FList.Put(t,e)},this.Create$1=function(){return pas.System.TObject.Create.call(this),this.FList=pas.Classes.TFPList.$create("Create"),this.FFreeObjects=!0,this},this.Create$2=function(t){return this.Create$1(),this.FFreeObjects=t,this},this.Destroy=function(){null!==this.FList&&(this.Clear(),this.FList.$destroy("Destroy")),pas.System.TObject.Destroy.call(this)},this.Clear=function(){var t=0,e=null;if(this.FFreeObjects)for(var i=this.FList.FCount-1;i>=0;i--)t=i,e=rtl.getObject(this.FList.Get(t)),this.FList.Put(t,null),e=rtl.freeLoc(e);this.FList.Clear()},this.Add=function(t){return this.FList.Add(t)}})),rtl.createClass(this,"TObjectList",pas.Classes.TList,(function(){this.$init=function(){pas.Classes.TList.$init.call(this),this.FFreeObjects=!1},this.Notify=function(t,e){var i=null;this.FFreeObjects&&2===e&&(i=rtl.getObject(t),i=rtl.freeLoc(i)),pas.Classes.TList.Notify.call(this,t,e)},this.GetItem=function(t){return rtl.getObject(pas.Classes.TList.Get.call(this,t))},this.Create$2=function(){return pas.Classes.TList.Create$1.call(this),this.FFreeObjects=!0,this},this.Add$1=function(t){return pas.Classes.TList.Add.call(this,t)},this.Remove$1=function(t){return pas.Classes.TList.Remove.call(this,t)},this.IndexOf$1=function(t){return pas.Classes.TList.IndexOf.call(this,t)},this.Insert$1=function(t,e){pas.Classes.TList.Insert.call(this,t,e)}})),rtl.createClass(this,"TClassList",pas.Classes.TList,(function(){this.GetItems=function(t){return rtl.getObject(this.Get(t))},this.Add$1=function(t){return pas.Classes.TList.Add.call(this,t)},this.Insert$1=function(t,e){pas.Classes.TList.Insert.call(this,t,e)}})),rtl.createClass(this,"THTCustomNode",pas.System.TObject,(function(){this.$init=function(){pas.System.TObject.$init.call(this),this.FKey=""},this.CreateWith=function(t){return pas.System.TObject.Create.call(this),this.FKey=t,this}})),rtl.createClass(this,"TFPCustomHashTable",pas.System.TObject,(function(){this.$init=function(){pas.System.TObject.$init.call(this),this.FHashTable=null,this.FHashFunction=null,this.FCount=0,this.FHashTableSize=0},this.$final=function(){this.FHashTable=void 0,this.FHashFunction=void 0,pas.System.TObject.$final.call(this)},this.SetHashTableSize=function(t){var i=0,s=0;if(t!==this.FHashTableSize){for(i=0;e.PRIMELIST[i]<t&&i<27;)i+=1;s=e.PRIMELIST[i],0===this.FCount?(this.FHashTableSize=s,this.InitializeHashTable()):this.ChangeTableSize(s)}},this.InitializeHashTable=function(){if(this.FHashTableSize>0)for(var t=0,e=this.FHashTableSize-1;t<=e;t++)t,this.FHashTable.Add(null);this.FCount=0},this.Chain=function(t){return this.FHashTable.GetItem(t)},this.FindChainForAdd=function(e){var i,s=null,o=0;if(i=this.FHashFunction(e,this.FHashTableSize),null!=(s=this.Chain(i))){if(s.GetCount()>0)for(var n=0,r=s.GetCount()-1;n<=r;n++)if(o=n,s.GetItem(o).FKey===e)throw t.EDuplicate.$create("CreateFmt",[rtl.getResStr(t,"DuplicateMsg"),pas.System.VarRecs(18,e)])}else this.FHashTable.SetItem(i,t.TFPObjectList.$create("Create$2",[!0])),s=this.Chain(i);return this.FCount+=1,s},this.Create$1=function(){return this.CreateWith(196613,t.RSHash),this},this.CreateWith=function(e,i){return pas.System.TObject.Create.call(this),this.FHashTable=t.TFPObjectList.$create("Create$2",[!0]),this.SetHashTableSize(e),this.FHashFunction=i,this},this.Destroy=function(){rtl.free(this,"FHashTable"),pas.System.TObject.Destroy.call(this)},this.ChangeTableSize=function(e){var i,s=null,o=null,n=0,r=0,a=null;if(s=this.FHashTable,i=this.FHashTableSize,this.FHashTableSize=e,this.FHashTable=t.TFPObjectList.$create("Create$2",[!0]),this.InitializeHashTable(),i>0)for(var l=0,h=i-1;l<=h;l++)if(n=l,null!=(o=s.GetItem(n)))for(var F=0,p=o.GetCount()-1;F<=p;F++)r=F,a=o.GetItem(r),this.AddNode(a);s=rtl.freeLoc(s)},this.Clear=function(){var t=0;if(this.FHashTableSize>0)for(var e=0,i=this.FHashTableSize-1;e<=i;e++)t=e,null!=this.Chain(t)&&this.Chain(t).Clear();this.FCount=0},this.Find=function(t){var e,i=null,s=0;if(e=this.FHashFunction(t,this.FHashTableSize),null!=(i=this.Chain(e))&&i.GetCount()>0)for(var o=0,n=i.GetCount()-1;o<=n;o++)if(s=o,i.GetItem(s).FKey===t)return i.GetItem(s);return null,null}})),rtl.createClass(this,"THTObjectNode",this.THTCustomNode,(function(){this.$init=function(){t.THTCustomNode.$init.call(this),this.FData=null},this.$final=function(){this.FData=void 0,t.THTCustomNode.$final.call(this)}})),rtl.createClass(this,"THTOwnedObjectNode",this.THTObjectNode,(function(){this.Destroy=function(){pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FData},set:function(t){this.p.FData=t}}),pas.System.TObject.Destroy.call(this)}})),rtl.createClass(this,"TFPObjectHashTable",this.TFPCustomHashTable,(function(){this.$init=function(){t.TFPCustomHashTable.$init.call(this),this.FOwnsObjects=!1},this.CreateNewNode=function(e){return this.FOwnsObjects?t.THTOwnedObjectNode.$create("CreateWith",[e]):t.THTObjectNode.$create("CreateWith",[e])},this.AddNode=function(t){this.Add(t.FKey,t.FData)},this.GetData=function(t){var e;return null!=(e=this.Find(t))?e.FData:null},this.Create$2=function(e){return t.TFPCustomHashTable.Create$1.call(this),this.FOwnsObjects=e,this},this.Add=function(t,e){var i=null,s=null;i=this.FindChainForAdd(t),(s=this.CreateNewNode(t)).FData=e,i.Add(s)}})),rtl.createClass(this,"EDuplicate",pas.SysUtils.Exception,(function(){}));this.RSHash=function(t,e){var i=0,s=0,o=0;if(s=63689,i=0,t.length>0)for(var n=1,r=t.length;n<=r;n++)o=n,i=i*s+t.charCodeAt(o-1),s*=378551;return i=rtl.lw(2147483647&i)%e},t.$implcode=function(){e.NPRIMES=28,e.PRIMELIST=[53,97,193,389,769,1543,3079,6151,12289,24593,49157,98317,196613,393241,786433,1572869,3145739,6291469,12582917,25165843,50331653,100663319,201326611,402653189,805306457,1610612741,3221225473,4294967291],t.$resourcestrings={DuplicateMsg:{org:"An item with key %0:s already exists"}}}}),["JS"]),rtl.module("WEBLib.Graphics",["System","Classes","Types","Web","JS"],(function(){"use strict";var t=this,e=t.$impl;this.WEBDEFAULTFONT="Arial",this.SysDefault=536870912,this.clNone=-1,this.clBlack=0,this.clGray=8421504,this.clSilver=12632256,this.clWhite=16777215,this.clDefault=536870912,this.clBtnFace=15790320,this.clWindowText=65793,this.clWindow=16711422,this.clHighlight=14120960,this.clHighlightText=197379,this.DEFAULT_CHARSET=1,this.$rtti.$inherited("TColor",rtl.nativeint,{}),this.TVerticalAlignment={0:"taAlignTop",taAlignTop:0,1:"taAlignBottom",taAlignBottom:1,2:"taVerticalCenter",taVerticalCenter:2},this.TPenStyle={0:"psSolid",psSolid:0,1:"psDash",psDash:1,2:"psDot",psDot:2,3:"psDashDot",psDashDot:3,4:"psDashDotDot",psDashDotDot:4,5:"psClear",psClear:5,6:"psInsideFrame",psInsideFrame:6,7:"psUserStyle",psUserStyle:7,8:"psAlternate",psAlternate:8},this.$rtti.$Enum("TPenStyle",{minvalue:0,maxvalue:8,ordtype:1,enumtype:this.TPenStyle}),this.TPenMode={0:"pmBlack",pmBlack:0,1:"pmWhite",pmWhite:1,2:"pmNop",pmNop:2,3:"pmNot",pmNot:3,4:"pmCopy",pmCopy:4,5:"pmNotCopy",pmNotCopy:5,6:"pmMergePenNot",pmMergePenNot:6,7:"pmMaskPenNot",pmMaskPenNot:7,8:"pmMergeNotPen",pmMergeNotPen:8,9:"pmMaskNotPen",pmMaskNotPen:9,10:"pmMerge",pmMerge:10,11:"pmNotMerge",pmNotMerge:11,12:"pmMask",pmMask:12,13:"pmNotMask",pmNotMask:13,14:"pmXor",pmXor:14,15:"pmNotXor",pmNotXor:15},this.$rtti.$Enum("TPenMode",{minvalue:0,maxvalue:15,ordtype:1,enumtype:this.TPenMode}),this.TBrushStyle={0:"bsSolid",bsSolid:0,1:"bsClear",bsClear:1,2:"bsHorizontal",bsHorizontal:2,3:"bsVertical",bsVertical:3,4:"bsFDiagonal",bsFDiagonal:4,5:"bsBDiagonal",bsBDiagonal:5,6:"bsCross",bsCross:6,7:"bsDiagCross",bsDiagCross:7},this.$rtti.$Enum("TBrushStyle",{minvalue:0,maxvalue:7,ordtype:1,enumtype:this.TBrushStyle}),this.TBrushGradient={0:"bgNone",bgNone:0,1:"bgLinearVert",bgLinearVert:1,2:"bgLinearHorz",bgLinearHorz:2,3:"bgRadial",bgRadial:3},this.$rtti.$Enum("TBrushGradient",{minvalue:0,maxvalue:3,ordtype:1,enumtype:this.TBrushGradient}),this.TFontStyle={0:"fsBold",fsBold:0,1:"fsItalic",fsItalic:1,2:"fsStrikeOut",fsStrikeOut:2,3:"fsUnderline",fsUnderline:3},this.$rtti.$Enum("TFontStyle",{minvalue:0,maxvalue:3,ordtype:1,enumtype:this.TFontStyle}),this.$rtti.$Set("TFontStyles",{comptype:this.$rtti.TFontStyle}),this.$rtti.$Int("TFontCharset",{minvalue:0,maxvalue:255,ordtype:3}),this.$rtti.$inherited("TBinaryString",rtl.string,{}),rtl.recNewT(this,"TCanvasPointF",(function(){this.X=0,this.Y=0,this.$eq=function(t){return this.X===t.X&&this.Y===t.Y},this.$assign=function(t){return this.X=t.X,this.Y=t.Y,this}})),rtl.recNewT(this,"TCanvasRectF",(function(){this.Left=0,this.Top=0,this.Right=0,this.Bottom=0,this.$eq=function(t){return this.Left===t.Left&&this.Top===t.Top&&this.Right===t.Right&&this.Bottom===t.Bottom},this.$assign=function(t){return this.Left=t.Left,this.Top=t.Top,this.Right=t.Right,this.Bottom=t.Bottom,this}})),rtl.createClass(this,"TPen",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FWidth=0,this.FColor=0,this.FStyle=0,this.FMode=0},this.SetColor=function(t){this.FColor=t},this.Create$1=function(){return this.FColor=0,this.FWidth=1,this.FStyle=0,this.FMode=4,this},this.Assign=function(e){t.TPen.isPrototypeOf(e)?(this.FColor=rtl.as(e,t.TPen).FColor,this.FStyle=rtl.as(e,t.TPen).FStyle,this.FWidth=rtl.as(e,t.TPen).FWidth):pas.Classes.TPersistent.Assign.apply(this,arguments)};var e=this.$rtti;e.addProperty("Color",2,t.$rtti.TColor,"FColor","SetColor"),e.addProperty("Mode",0,t.$rtti.TPenMode,"FMode","FMode",{Default:t.TPenMode.pmCopy}),e.addProperty("Width",0,rtl.longint,"FWidth","FWidth",{Default:1}),e.addProperty("Style",0,t.$rtti.TPenStyle,"FStyle","FStyle",{Default:t.TPenStyle.psSolid})})),rtl.createClass(this,"TGradientColor",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FColor=0,this.FStop=0},this.Assign=function(e){t.TGradientColor.isPrototypeOf(e)&&(this.FColor=rtl.as(e,t.TGradientColor).FColor,this.FStop=rtl.as(e,t.TGradientColor).FStop)},this.Create$1=function(){return this.FColor=-1,this.FStop=0,this};var e=this.$rtti;e.addProperty("Stop",0,rtl.double,"FStop","FStop"),e.addProperty("Color",0,t.$rtti.TColor,"FColor","FColor",{Default:-1})})),rtl.createClass(this,"TBrush",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FColor=0,this.FStyle=0,this.FGradientColors=null,this.FGradient=0},this.$final=function(){this.FGradientColors=void 0,pas.Classes.TPersistent.$final.call(this)},this.Create$1=function(){return this.FColor=16777215,this.FStyle=0,this.FGradient=0,this.FGradientColors=pas.Classes.TList.$create("Create$1"),this},this.Destroy=function(){rtl.free(this,"FGradientColors"),pas.System.TObject.Destroy.call(this)},this.Assign=function(e){t.TBrush.isPrototypeOf(e)?(this.FColor=rtl.as(e,t.TBrush).FColor,this.FStyle=rtl.as(e,t.TBrush).FStyle):pas.Classes.TPersistent.Assign.apply(this,arguments)},this.AddGradientColor=function(e,i){var s=null;(s=t.TGradientColor.$create("Create$1")).FColor=e,s.FStop=i,this.FGradientColors.Add(s)},this.GetGradientColor=function(t,e,i){if(!(t<this.FGradientColors.GetCount()))throw pas.SysUtils.Exception.$create("Create$1",["Invalid gradient color index"]);e.set(rtl.getObject(this.FGradientColors.Get(t)).FColor),i.set(rtl.getObject(this.FGradientColors.Get(t)).FStop)},this.GradientCount=function(){return this.FGradientColors.GetCount()},this.ClearGradient=function(){for(var t=0,e=null,i=this.FGradientColors.GetCount()-1;i>=0;i--)t=i,e=rtl.getObject(this.FGradientColors.Get(t)),e=rtl.freeLoc(e),this.FGradientColors.Delete(t)};var e=this.$rtti;e.addProperty("Gradient",0,t.$rtti.TBrushGradient,"FGradient","FGradient"),e.addProperty("Color",0,t.$rtti.TColor,"FColor","FColor"),e.addProperty("Style",0,t.$rtti.TBrushStyle,"FStyle","FStyle")})),rtl.createClass(this,"TFont",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FName="",this.FSize=0,this.FColor=0,this.FStyle={},this.FOnChange=null,this.FHeight=0,this.FCharset=0},this.$final=function(){this.FStyle=void 0,this.FOnChange=void 0,pas.Classes.TPersistent.$final.call(this)},this.SetHeight=function(t){var e;e=72*-t/96,this.FSize=Math.round(e),this.FHeight!==t&&(this.FHeight=t,this.DoChange())},this.SetName=function(t){this.FName!==t&&(this.FName=t,this.DoChange())},this.SetSize=function(t){this.FSize!==t&&(this.FSize=t,this.DoChange())},this.SetColor=function(t){this.FColor!==t&&(this.FColor=t,this.DoChange())},this.SetStyle=function(t){rtl.neSet(this.FStyle,t)&&(this.FStyle=rtl.refSet(t),this.DoChange())},this.DoChange=function(){null!=this.FOnChange&&this.FOnChange(this)},this.Assign=function(e){t.TFont.isPrototypeOf(e)?(this.FName=rtl.as(e,t.TFont).FName,this.FColor=rtl.as(e,t.TFont).FColor,this.FSize=rtl.as(e,t.TFont).FSize,this.FStyle=rtl.refSet(rtl.as(e,t.TFont).FStyle),this.DoChange()):pas.Classes.TPersistent.Assign.apply(this,arguments)},this.Create$1=function(){return pas.System.TObject.Create.call(this),this.FName=t.WEBDEFAULTFONT,this.FSize=8,this.FHeight=-11,this.FStyle={},this.FColor=0,this},this.ToString=function(){var e="";return e="",0 in this.FStyle&&1 in this.FStyle?e+="bold italic":0 in this.FStyle?e+="bold":1 in this.FStyle&&(e+="italic"),e+" "+t.FontSizeToHTML(t.FontSizeToPx(this.FSize))+" "+this.FName};var e=this.$rtti;e.addProperty("Charset",0,t.$rtti.TFontCharset,"FCharset","FCharset"),e.addProperty("Name",2,rtl.string,"FName","SetName"),e.addProperty("Height",2,rtl.longint,"FHeight","SetHeight"),e.addProperty("Style",2,t.$rtti.TFontStyles,"FStyle","SetStyle"),e.addProperty("Color",2,t.$rtti.TColor,"FColor","SetColor"),e.addProperty("Size",2,rtl.longint,"FSize","SetSize")})),rtl.createClass(this,"TGraphic",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FAddToQueue=!1,this.FCanvasElement=null,this.FEmpty=!1,this.FData="",this.FDataBin="",this.FCanvas=null,this.FOnChange=null,this.FImage=null,this.FURL="",this.FLoaded=null,this.FUsedCanvas=!1},this.$final=function(){this.FCanvasElement=void 0,this.FCanvas=void 0,this.FOnChange=void 0,this.FImage=void 0,this.FLoaded=void 0,pas.Classes.TPersistent.$final.call(this)},this.SetHeight=function(t){this.FImage.height=t,this.RecreateCanvas(),this.DoChange()},this.SetWidth=function(t){this.FImage.width=t,this.RecreateCanvas(),this.DoChange()},this.GetCanvas=function(){var t;return null==this.FCanvas&&this.RecreateCanvas(),t=this.FCanvas,this.FUsedCanvas=!0,t},this.GetData=function(){return this.FDataBin},this.SetData=function(t){var e="";this.FDataBin!==t&&(this.FDataBin=t,e=pas["WEBLib.WebTools"].HexImageDecodeAsBase64(this.FDataBin),pas.System.Pos("PHN2ZyB",e)>0?this.LoadFromResource("data:image/svg+xml;base64,"+e):this.LoadFromResource("data:image/png;base64,"+e))},this.DoChange=function(){var t=0;this.FEmpty=0===this.GetWidth()&&0===this.GetHeight(),this.FEmpty||""===this.FData||e.FCache.Exists(this.FData)||(e.FCache.Add$1(e.TGraphicCache.$create("Create$1",[this.FImage,this.FData])),(t=e.FQueue.IndexOf(this.FData))>=0&&t<=e.FQueue.GetCount()-1&&e.FQueue.Delete(t),e.FCacheCount-=1,0===e.FCacheCount&&null!=pas["WEBLib.Forms"].Application.FOnImageCacheReady&&pas["WEBLib.Forms"].Application.FOnImageCacheReady(pas["WEBLib.Forms"].Application)),null!=this.FOnChange&&this.FOnChange(this),null!=this.FLoaded&&(this.FLoaded(),this.FLoaded=null)},this.SetURL=function(t){this.LoadFromURL(t,null)},this.GetWidth=function(){var t=0;return t=0,null!=this.FImage&&(t=this.FImage.width),t},this.GetHeight=function(){var t=0;return t=0,null!=this.FImage&&(t=this.FImage.height),t},this.RecreateCanvas=function(){null==this.FCanvasElement&&(this.FCanvasElement=document.createElement("CANVAS")),null!=this.FCanvasElement&&(this.FCanvasElement.height=this.GetHeight(),this.FCanvasElement.width=this.GetWidth(),null==this.FCanvas&&(this.FCanvas=t.TCanvas.$create("Create$1",[this.FCanvasElement]),this.FCanvas.FOnBeginScene=rtl.createCallback(this,"DoBeginScene"),this.FCanvas.FOnEndScene=rtl.createCallback(this,"DoEndScene")))},this.DoBeginScene=function(t){this.FCanvas.Clear()},this.DoEndScene=function(t){this.FAddToQueue=!1,this.CaptureCanvas(),this.FAddToQueue=!0},this.AssignEvents=function(){var t=this;this.FImage.onload=function(){t.DoChange()}},this.CreateImage=function(){this.FImage=new Image},this.LoadFromCache=function(t,i){var s="",o=null,n="",r=!1;this.FData=t,pas.System.Pos("DATA:",pas.SysUtils.UpperCase(t))>0&&(this.FDataBin=pas["WEBLib.WebTools"].HexImageEncodeFromBase64(t)),""!==(s=t)&&(this.FLoaded=i,this.FUsedCanvas=!1,e.FCache.Find(s,{get:function(){return o},set:function(t){o=t}})?(this.FImage=o,this.DoChange()):(!1,n="",(r=""!=(n=this.FImage.src)&&s!==n)&&(this.CreateImage(),this.AssignEvents()),!r&&-1===e.FQueue.IndexOf(s)||r?(this.FImage.src=s,s=this.FImage.src,this.FData=s,pas.System.Pos("DATA:",pas.SysUtils.UpperCase(s))>0&&(this.FDataBin=pas["WEBLib.WebTools"].HexImageEncodeFromBase64(s)),e.FCacheCount+=1,this.FAddToQueue&&e.FQueue.Add(s)):r||-1===e.FQueue.IndexOf(s)||(this.FImage.src=s)),this.FImage&&(this.FEmpty=""==this.FImage.src))},this.CreateFromResource=function(t){return this.CreateFromResource$1(t,0)},this.CreateFromResource$1=function(e,i){var s=null;return(s=t.TGraphic.$create("Create$3")).LoadFromResource(e),s},this.CreateFromURL=function(t){return this.CreateFromURL$1(t,0)},this.CreateFromURL$1=function(e,i){var s=null;return(s=t.TGraphic.$create("Create$3")).LoadFromURL(e,null),s},this.Image=function(){return this.FImage},this.Empty=function(){return this.FEmpty},this.GetBase64Image=function(){var t="";return t="",null!=this.FCanvas&&(t=this.FCanvas.GetBase64Image()),t},this.Create$3=function(){return this.FAddToQueue=!0,this.FEmpty=!0,this.FData="",this.FDataBin="",this.FUsedCanvas=!1,this.CreateImage(),this.AssignEvents(),this},this.CaptureCanvas=function(){null!=this.FCanvas&&null!=this.FCanvas.FElementCanvas&&this.LoadFromResource(this.FCanvas.FElementCanvas.toDataURL())},this.LoadFromCanvas=function(t){null!=t&&null!=t.FElementCanvas&&this.LoadFromResource(t.FElementCanvas.toDataURL())},this.SetSize=function(t,e){this.SetWidth(t),this.SetHeight(e)},this.Assign=function(e){var i="";null!=e&&t.TGraphic.isPrototypeOf(e)&&null!=rtl.as(e,t.TGraphic).FCanvas?this.LoadFromCanvas(rtl.as(e,t.TGraphic).FCanvas):null!=e&&t.TGraphic.isPrototypeOf(e)&&null!=rtl.as(e,t.TGraphic).FImage&&!rtl.as(e,t.TGraphic).Empty()?(i=e.FImage.src,this.LoadFromURL(i,null)):null==e&&(this.CreateImage(),this.DoChange())},this.LoadFromURL=function(t,e){this.LoadFromURL$1(t,0,e)},this.LoadFromURL$1=function(t,e,i){this.FEmpty=!0,this.LoadFromCache(t,i)},this.LoadFromFile=function(t,e){this.LoadFromURL$1(t,0,e)},this.LoadFromResource=function(t){this.LoadFromResource$1(t,0)},this.LoadFromResource$1=function(t,e){this.FEmpty=!0,this.LoadFromCache(t,null)},this.LoadFromStream=function(t){this.DoChange()};var i=this.$rtti;i.addProperty("OnChange",0,pas.Classes.$rtti.TNotifyEvent,"FOnChange","FOnChange"),i.addProperty("URL",2,rtl.string,"FURL","SetURL"),i.addProperty("Data",3,t.$rtti.TBinaryString,"GetData","SetData")})),rtl.createClass(this,"TBitmap",this.TGraphic,(function(){})),rtl.recNewT(this,"TMatrix",(function(){this.m11=0,this.m12=0,this.m13=0,this.m21=0,this.m22=0,this.m23=0,this.m31=0,this.m32=0,this.m33=0,this.$eq=function(t){return this.m11===t.m11&&this.m12===t.m12&&this.m13===t.m13&&this.m21===t.m21&&this.m22===t.m22&&this.m23===t.m23&&this.m31===t.m31&&this.m32===t.m32&&this.m33===t.m33},this.$assign=function(t){return this.m11=t.m11,this.m12=t.m12,this.m13=t.m13,this.m21=t.m21,this.m22=t.m22,this.m23=t.m23,this.m31=t.m31,this.m32=t.m32,this.m33=t.m33,this}})),rtl.createClass(this,"TCanvas",pas.System.TObject,(function(){this.$init=function(){pas.System.TObject.$init.call(this),this.FElementCanvas=null,this.FContext=null,this.FPen=null,this.FBrush=null,this.FFont=null,this.FPathOpen=!1,this.FPathX=0,this.FPathY=0,this.FClipRect=t.TCanvasRectF.$new(),this.FOnEndScene=null,this.FOnBeginScene=null,this.FApplyPixelRatio=!1},this.$final=function(){this.FElementCanvas=void 0,this.FContext=void 0,this.FPen=void 0,this.FBrush=void 0,this.FFont=void 0,this.FClipRect=void 0,this.FOnEndScene=void 0,this.FOnBeginScene=void 0,pas.System.TObject.$final.call(this)},this.SetClipRect=function(t){this.FClipRect.$assign(t),null!=this.FContext&&(this.FContext.beginPath(),this.FContext.rect(this.FClipRect.Left,this.FClipRect.Top,this.FClipRect.Right-this.FClipRect.Left,this.FClipRect.Bottom-this.FClipRect.Top),this.FContext.clip())},this.GetAccuOffset=function(t,e,i,s){i.set(0),s.set(0),1===this.FPen.FWidth&&5!==this.FPen.FStyle&&0===pas.System.Frac(t)&&i.set(.5),1===this.FPen.FWidth&&5!==this.FPen.FStyle&&0===pas.System.Frac(e)&&s.set(.5)},this.ApplyStroke=function(){if(null!=this.FContext){this.FContext.lineWidth=this.FPen.FWidth,this.FContext.strokeStyle=t.ColorToHTML(this.FPen.FColor);var e=this.FPen.FStyle;0===e?this.FContext.setLineDash([]):2===e?this.FContext.setLineDash([1,2]):1===e?this.FContext.setLineDash([8,2]):3===e?this.FContext.setLineDash([6,2,2,2]):4===e?this.FContext.setLineDash([6,2,2,2,2,2]):5===e&&this.FContext.setLineDash([0,65535])}},this.ApplyFill=function(){null!=this.FContext&&(this.FContext.fillStyle=t.ColorToHTML(this.FBrush.FColor))},this.ApplyBrush=function(e,i,s,o){var n=0,r=0,a=0,l=null,h=0,F="",p=0,c=0;if(this.GetAccuOffset(e,i,{get:function(){return n},set:function(t){n=t}},{get:function(){return r},set:function(t){r=t}}),this.FBrush.FStyle in rtl.createSet(2,6))for(a=i+r,this.FContext.lineWidth=1,this.FContext.strokeStyle=t.ColorToHTML(this.FBrush.FColor);a<o;)this.FContext.moveTo(e,a),this.FContext.lineTo(s,a),a+=8;if(this.FBrush.FStyle in rtl.createSet(3,6))for(a=e+n,this.FContext.lineWidth=1,this.FContext.strokeStyle=t.ColorToHTML(this.FBrush.FColor);a<s;)this.FContext.moveTo(a,i),this.FContext.lineTo(a,o),a+=8;if(this.FBrush.FStyle in rtl.createSet(4,7))for(a=e+n-(s-e),this.FContext.lineWidth=1,this.FContext.strokeStyle=t.ColorToHTML(this.FBrush.FColor);a<s;)this.FContext.moveTo(a,i),this.FContext.lineTo(a+(o-i),o),a+=8;if(this.FBrush.FStyle in rtl.createSet(5,7))for(a=e+n,this.FContext.lineWidth=1,this.FContext.strokeStyle=t.ColorToHTML(this.FBrush.FColor);a<s+(s-e);)this.FContext.moveTo(a,i),this.FContext.lineTo(a-(o-i),o),a+=8;if(0!==this.FBrush.FGradient){var u=this.FBrush.FGradient;2===u?l=this.FContext.createLinearGradient(e,i,s,i):1===u?l=this.FContext.createLinearGradient(e,i,e,o):3===u&&(l=this.FContext.createRadialGradient(e+(s-e)/2,i+(o-i)/2,0,e+(s-e)/2,i+(o-i)/2,(s-e)/2)),F=t.ColorToHTML(t.ColorToRGB(this.FBrush.FColor)),l.addColorStop(0,F);for(var C=0,T=this.FBrush.GradientCount()-1;C<=T;C++)h=C,this.FBrush.GetGradientColor(h,{get:function(){return p},set:function(t){p=t}},{get:function(){return c},set:function(t){c=t}}),F=t.ColorToHTML(t.ColorToRGB(p)),l.addColorStop(c,F);return this.FContext.fillStyle=l,void this.FContext.fillRect(e,i,s,o)}this.FContext.stroke()},this.Create$1=function(e){return this.FElementCanvas=e,this.FContext=e.getContext("2d"),this.FPen=t.TPen.$create("Create$1"),this.FBrush=t.TBrush.$create("Create$1"),this.FPathOpen=!1,this.FFont=t.TFont.$create("Create$1"),this.FApplyPixelRatio=!1,this},this.Destroy=function(){pas.System.TObject.Destroy.call(this)},this.SetTransform=function(i,s,o,n,r,a){var l=t.TMatrix.$new(),h=0;null!=this.FContext&&(l.$assign(e.MatrixIdentity()),l.m11=i,l.m12=s,l.m21=o,l.m22=n,l.m31=r,l.m32=a,this.FApplyPixelRatio&&(h=e.GetPixelRatio(this),l.$assign(e.MatrixMultiply(l,e.MatrixCreateScaling(h,h)))),this.FContext.setTransform(l.m11,l.m12,l.m21,l.m22,l.m31,l.m32))},this.Transform=function(t,e,i,s,o,n){null!=this.FContext&&this.FContext.transform(t,e,i,s,o,n)},this.AngleArc$1=function(t,e,i,s,o){null!=this.FContext&&(this.FContext.beginPath(),this.ApplyStroke(),this.FContext.arc(t,e,i,s,s+o),this.FContext.stroke())},this.MoveTo$1=function(t,e){var i=0,s=0;null!=this.FContext&&(this.FPathOpen=!0,this.FContext.beginPath(),this.ApplyStroke(),i=0,s=0,this.GetAccuOffset(t,e,{get:function(){return i},set:function(t){i=t}},{get:function(){return s},set:function(t){s=t}}),this.FContext.moveTo(t+i,e+s))},this.LineTo$1=function(e,i){var s=0,o=0,n=0;if(null!=this.FContext){s=0,o=0,this.GetAccuOffset(e,i,{get:function(){return s},set:function(t){s=t}},{get:function(){return o},set:function(t){o=t}});var r=this.FPen.FMode;0===r?this.FContext.strokeStyle=t.ColorToHTML(0):1===r?this.FContext.strokeStyle=t.ColorToHTML(16777215):14===r?this.FContext.globalCompositeOperation="xor":12===r?this.FContext.globalCompositeOperation="source-atop":5===r?(n=4294967295^t.ColorToRGB(this.FPen.FColor),this.FContext.strokeStyle=t.ColorToHTML(n)):15===r&&(n=4294967295^t.ColorToRGB(this.FPen.FColor),this.FContext.strokeStyle=t.ColorToHTML(n),this.FContext.globalCompositeOperation="xor"),this.FPathOpen||(this.FContext.beginPath(),this.ApplyStroke(),this.FContext.moveTo(this.FPathX+s,this.FPathY+o)),this.FContext.lineTo(e+s,i+o),this.FContext.stroke(),this.FPathX=e,this.FPathY=i,this.FPathOpen=!1,this.FContext.globalCompositeOperation="source-over"}},this.Rectangle=function(t,e,i,s){var o=0,n=0;if(null!=this.FContext){this.FContext.save(),this.FContext.beginPath(),this.ApplyStroke(),this.ApplyFill(),this.GetAccuOffset(t,e,{get:function(){return o},set:function(t){o=t}},{get:function(){return n},set:function(t){n=t}});let r=new Path2D;r.rect(t,e,i-t+1,s-e+1),this.FContext.clip(r,"evenodd"),this.ApplyBrush(t,e,i,s),this.FBrush.FStyle in rtl.createSet(1,2,3,6,4,5,7)||(this.FContext.rect(t+o,e+n,i-t,s-e),this.FContext.fill()),5!==this.FPen.FStyle&&(this.ApplyStroke(),this.FContext.beginPath(),this.FContext.rect(t+o,e+n,i-t,s-e),this.FContext.stroke()),this.FContext.restore()}},this.Rectangle$3=function(t){this.Rectangle(t.Left,t.Top,t.Right,t.Bottom)},this.RoundRect$1=function(t,e,i,s,o,n){var r=0,a=0;if(null!=this.FContext){this.FContext.beginPath(),this.ApplyStroke(),this.ApplyFill(),this.GetAccuOffset(t,e,{get:function(){return r},set:function(t){r=t}},{get:function(){return a},set:function(t){a=t}}),this.FContext.moveTo(t+o/2,e+a),this.FContext.lineTo(i-o/2,e+a),this.FContext.quadraticCurveTo(i+r,e+a,i+r,e+a+n/2),this.FContext.lineTo(i+r,s-n/2),this.FContext.quadraticCurveTo(i+r,s+a,i-o/2-r,s+a),this.FContext.lineTo(t+o/2,s+a),this.FContext.quadraticCurveTo(t+r,s+a,t+r,s-n/2),this.FContext.lineTo(t+r,e+n/2+a),this.FContext.quadraticCurveTo(t+r,e+a,t+o/2+r,e+a),0===this.FBrush.FStyle&&this.FContext.fill(),5!==this.FPen.FStyle&&this.FContext.stroke(),this.FContext.save();let l=new Path2D;l.moveTo(t+o/2,e+a),l.lineTo(i-o/2,e+a),l.quadraticCurveTo(i+r,e+a,i+r,e+a+n/2),l.lineTo(i+r,s-n/2),l.quadraticCurveTo(i+r,s+a,i-o/2-r,s+a),l.lineTo(t+o/2,s+a),l.quadraticCurveTo(t+r,s+a,t+r,s-n/2),l.lineTo(t+r,e+n/2+a),l.quadraticCurveTo(t+r,e+a,t+o/2+r,e+a),this.FContext.clip(l,"evenodd"),this.ApplyBrush(t,e,i,s),this.FContext.restore()}},this.RoundRect$3=function(t,e,i){this.RoundRect$1(t.Left,t.Top,t.Right,t.Bottom,e,i)},this.Ellipse$1=function(t,e,i,s){var o=0,n=0,r=0,a=0,l=0,h=0,F=0,p=0,c=0;if(null!=this.FContext){a=(o=i-t)/2*(r=.5522848),l=(n=s-e)/2*r,h=t+o,F=e+n,p=t+o/2,c=e+n/2,this.FContext.save();let u=new Path2D;u.moveTo(t,c),u.bezierCurveTo(t,c-l,p-a,e,p,e),u.bezierCurveTo(p+a,e,h,c-l,h,c),u.bezierCurveTo(h,c+l,p+a,F,p,F),u.bezierCurveTo(p-a,F,t,c+l,t,c),u.closePath(),this.FContext.clip(u,"evenodd"),this.ApplyBrush(t,e,i,s),this.FContext.restore(),this.FContext.beginPath(),this.ApplyStroke(),this.ApplyFill(),this.FContext.moveTo(t,c),this.FContext.bezierCurveTo(t,c-l,p-a,e,p,e),this.FContext.bezierCurveTo(p+a,e,h,c-l,h,c),this.FContext.bezierCurveTo(h,c+l,p+a,F,p,F),this.FContext.bezierCurveTo(p-a,F,t,c+l,t,c),this.FContext.closePath(),0===this.FBrush.FStyle&&0===this.FBrush.FGradient&&this.FContext.fill(),5!==this.FPen.FStyle&&this.FContext.stroke()}},this.Ellipse$3=function(t){this.Ellipse$1(t.Left,t.Top,t.Right,t.Bottom)},this.Polyline$1=function(t){var e=0,i=0;if(null!=this.FContext){if(0===(e=rtl.length(t)))return;for(this.FContext.beginPath(),this.ApplyStroke(),i=0,this.FContext.moveTo(t[i].X,t[i].Y);i<e-1;)i+=1,this.FContext.lineTo(t[i].X,t[i].Y);5!==this.FPen.FStyle&&this.FContext.stroke()}},this.Polygon$1=function(t){var e=0,i=0,s=0,o=0,n=0,r=0;if(null!=this.FContext){if(0===(e=rtl.length(t)))return;this.FContext.beginPath(),this.ApplyStroke(),s=65535,o=65535,n=0,r=0;for(var a=0,l=rtl.length(t)-1;a<=l;a++)t[i=a].X<s&&(s=t[i].X),t[i].X<o&&(o=t[i].Y),t[i].X>n&&(n=t[i].X),t[i].X<r&&(r=t[i].Y);for(0!==this.FBrush.FGradient?this.ApplyBrush(s,o,n,r):this.ApplyFill(),i=0,this.FContext.moveTo(t[i].X,t[i].Y);i<e-1;)i+=1,this.FContext.lineTo(t[i].X,t[i].Y);this.FContext.closePath(),1!==this.FBrush.FStyle&&this.FContext.fill(),5!==this.FPen.FStyle&&this.FContext.stroke()}},this.TextOut$1=function(e,i,s){var o=null,n="";null!=this.FContext&&(n=s.replace("\0",""),this.FContext.fillStyle=t.ColorToHTML(this.FFont.FColor),this.FContext.font=this.FFont.ToString(),this.FContext.textBaseline="top",this.FContext.fillText(n,e,i),3 in this.FFont.FStyle&&(o=this.FContext.measureText(n),this.FContext.fillRect(e,i+1.4*this.FFont.FSize,o.width,1)),2 in this.FFont.FStyle&&(o=this.FContext.measureText(n),this.FContext.fillRect(e,i+.7*this.FFont.FSize,o.width,1)))},this.StretchDraw$1=function(t,e){var i=null;null!=this.FContext&&(i=e.Image(),this.FContext.drawImage(i,0,0,e.GetWidth(),e.GetHeight(),t.Left,t.Top,t.Right-t.Left,t.Bottom-t.Top))},this.BeginScene=function(){null!=this.FOnBeginScene&&this.FOnBeginScene(this)},this.EndScene=function(){null!=this.FOnEndScene&&this.FOnEndScene(this)},this.PathBegin=function(){null!=this.FContext&&this.FContext.beginPath()},this.PathClose=function(){null!=this.FContext&&this.FContext.closePath()},this.PathStroke=function(){null!=this.FContext&&(this.ApplyStroke(),this.FContext.stroke())},this.PathFill=function(){null!=this.FContext&&(this.ApplyFill(),this.ApplyBrush(10,10,50,50),this.FContext.fill())},this.PathMoveTo$1=function(t,e){var i=0,s=0;null!=this.FContext&&(i=0,s=0,this.GetAccuOffset(t,e,{get:function(){return i},set:function(t){i=t}},{get:function(){return s},set:function(t){s=t}}),this.FContext.moveTo(t+i,e+s))},this.PathLineTo$1=function(t,e){var i=0,s=0;null!=this.FContext&&(i=0,s=0,this.GetAccuOffset(t,e,{get:function(){return i},set:function(t){i=t}},{get:function(){return s},set:function(t){s=t}}),this.FContext.lineTo(t+i,e+s))},this.Save=function(){null!=this.FContext&&this.FContext.save()},this.Restore=function(){null!=this.FContext&&this.FContext.restore()},this.Refresh=function(){},this.Clear=function(){null!=this.FContext&&null!=this.FElementCanvas&&this.FContext.clearRect(0,0,this.FElementCanvas.width,this.FElementCanvas.height)},this.TextRect$1=function(e,i,s,o,n,r){var a,l=this,h=t.TCanvasRectF.$new(),F=0,p="",c="",u="",C=0,T=0,S=0,d=!1,m=0,f=0,g=0,y=0,M=t.TCanvasRectF.$new(),b=0,N=0,B=!1,E=!1;function D(t,i,s){if(B){var o=n;2===o?l.TextOut$1(e.Left+(e.Right-e.Left-i)/2,e.Top,t):0===o?l.TextOut$1(e.Left,e.Top,t):1===o&&l.TextOut$1(e.Right-i,e.Top,t)}else{var a=n;if(2===a){var h=r;0===h?l.TextOut$1(e.Left+(e.Right-e.Left-i)/2,e.Top,t):2===h?l.TextOut$1(e.Left+(e.Right-e.Left-i)/2,e.Top+(e.Bottom-e.Top-s)/2,t):1===h&&l.TextOut$1(e.Left+(e.Right-e.Left-i)/2,e.Bottom-s,t)}else if(0===a){var F=r;0===F?l.TextOut$1(e.Left,e.Top,t):2===F?l.TextOut$1(e.Left,e.Top+(e.Bottom-e.Top-s)/2,t):1===F&&l.TextOut$1(e.Left,e.Bottom-s,t)}else if(1===a){var p=r;0===p?l.TextOut$1(e.Right-i,e.Top,t):2===p?l.TextOut$1(e.Right-i,e.Top+(e.Bottom-e.Top-s)/2,t):1===p&&l.TextOut$1(e.Right-i,e.Bottom-s,t)}}}function L(t,e){var i,s="",o=0;if(s="",i=t.length,e.get()>i)return s;for(o=e.get();;){if("\n"===t.charAt(o-1)&&"\r"===t.charAt(o-1-1)||"\r"===t.charAt(o-1)&&"\n"===t.charAt(o-1-1)||" "===t.charAt(o-1)){s=" "===t.charAt(o-1)?pas.System.Copy(t,e.get(),o-(e.get()-1)):pas.System.Copy(t,e.get(),o-e.get());break}if("\n"===t.charAt(o-1)||"\r"===t.charAt(o-1)||" "===t.charAt(o-1)){s=pas.System.Copy(t,e.get(),o-(e.get()-1));break}if(o>=i){s=pas.System.Copy(t,e.get(),o-(e.get()-1));break}o+=1}return e.set(o+1),s}if(B=s||pas.System.Pos("\r",i)>0||pas.System.Pos("\n",i)>0,a=!s&&(pas.System.Pos("\r",i)>0||pas.System.Pos("\n",i)>0),B){for(M.$assign(e),S=0,F=1,N=.5*this.FFont.FSize,y=0,b=0,f=0,p=L(i,{get:function(){return F},set:function(t){F=t}}),T=this.TextWidth(p),g=this.TextHeight(p)+N,S+=T,p.length>0&&" "===p.charAt(p.length-1)&&(S+=b),E=!1;F<=i.length&&((C=p.length)>=2&&("\n"===p.charAt(C-1)&&"\r"===p.charAt(C-1-1)||"\r"===p.charAt(C-1)&&"\n"===p.charAt(C-1-1))?(p=pas.System.Copy(p,1,C-2),d=!0):C>=1&&("\n"===p.charAt(C-1)||"\r"===p.charAt(C-1))?(p=pas.System.Copy(p,1,C-1),d=!0):d=!1,c=L(i,{get:function(){return F},set:function(t){F=t}}),T=this.TextWidth(c),g=Math.max(g,this.TextHeight(c)+N),!((e.Left+S+T>e.Right||d)&&(""===p||E||(m=p.length,u=pas.System.Copy(p,1,m),y+=1,S>f&&(f=S),o||D(u,S,g),S=0),p="",E=!1,a&&d||!a?e.Top=e.Top+g:a&&!d&&(E=!0),pas.System.Trunc(e.Top)>pas.System.Trunc(e.Bottom-g+N)&&!o)));)S+=T,c.length>0&&" "===c.charAt(c.length-1)&&(S+=b),p+=c;""!==p&&(m=p.length,u=pas.System.Copy(p,1,m),y+=1,S>f&&(f=S),o||D(u,S,g)),h.$assign(t.CreateCanvasRectF(M.Left,M.Top,M.Left+f,M.Top+y*g))}else T=this.TextWidth(i),g=this.TextHeight(i),o||D(i,T,g),h.$assign(t.CreateCanvasRectF(e.Left,e.Top,e.Left+T,e.Top+g));return h},this.TextWidth=function(t){var e=0,i="";return null!=this.FContext&&(i=this.FFont.ToString(),this.FContext.font=i,e=this.FContext.measureText(t).width),e},this.TextHeight=function(e){return t.FontSizeToPx(this.FFont.FSize)},this.GetBase64Image=function(){var t="";return t="",null!=this.FElementCanvas&&(t=this.FElementCanvas.toDataURL()),t}})),rtl.createClass(this,"TURLPicture",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FOnChange=null,this.FFilename="",this.FData="",this.FOnDataChange=null},this.$final=function(){this.FOnChange=void 0,this.FOnDataChange=void 0,pas.Classes.TPersistent.$final.call(this)},this.SetData=function(t){this.FData!==t&&(this.FData=t,this.DataChanged())},this.GetData=function(){return this.FData},this.Changed=function(){null!=this.FOnChange&&this.FOnChange(this)},this.DataChanged=function(){null!=this.FOnDataChange&&this.FOnDataChange(this)},this.Assign=function(e){t.TURLPicture.isPrototypeOf(e)?(this.FFilename=rtl.as(e,t.TURLPicture).FFilename,this.Changed()):pas.Classes.TPersistent.Assign.apply(this,arguments)};var e=this.$rtti;e.addProperty("OnChange",0,pas.Classes.$rtti.TNotifyEvent,"FOnChange","FOnChange"),e.addProperty("Data",3,t.$rtti.TBinaryString,"GetData","SetData")})),this.ColorToRGB=function(t){return t},this.ColorToHex=function(t){var e="";for(e=t.toString(16);e.length<6;)e="0"+e;return pas.System.Copy(e,5,2)+pas.System.Copy(e,3,2)+pas.System.Copy(e,1,2)},this.ColorToHTML=function(e){return 0!=(4278190080&e)?"#"+t.ColorToHex(16777215&e)+pas.SysUtils.IntToHex(255&Math.floor((4278190080&e)/16777216),2):"#"+t.ColorToHex(e)},this.FontSizeToHTML=function(t){var e="";return e=pas.SysUtils.FloatToStr(t)+"px",e=pas.SysUtils.StringReplace(e,",",".",rtl.createSet(0))},this.HexToColor=function(t){var e="",i=0;e="";for(var s=1,o=t.length;s<=o;s++)i=s,(t.charAt(i-1)>="0"&&t.charAt(i-1)<="9"||t.charAt(i-1)>="A"&&t.charAt(i-1)<="F"||t.charAt(i-1)>="a"&&t.charAt(i-1)<="f")&&(e+=t.charAt(i-1));return e=e.length>6?"$"+pas.System.Copy(e,1,2)+pas.System.Copy(e,7,2)+pas.System.Copy(e,5,2)+pas.System.Copy(e,3,2):"$"+pas.System.Copy(e,5,2)+pas.System.Copy(e,3,2)+pas.System.Copy(e,1,2),pas.SysUtils.StrToInt64(e)},this.FontSizeToPx=function(t){return 96*t/72},this.GetRValue=function(t){return 255&t},this.GetGValue=function(t){return 255&Math.floor(t/256)},this.GetBValue=function(t){return 255&Math.floor(t/65536)},this.CreateCanvasRectF=function(e,i,s,o){var n=t.TCanvasRectF.$new();return n.Left=e,n.Top=i,n.Right=s,n.Bottom=o,n},this.CreateCanvasPointF=function(e,i){var s=t.TCanvasPointF.$new();return s.X=e,s.Y=i,s},this.RGB=function(t,e,i){return t|e<<8|i<<16},t.$implcode=function(){rtl.createClass(e,"TGraphicCache",pas.System.TObject,(function(){this.$init=function(){pas.System.TObject.$init.call(this),this.FImage=null,this.FID=""},this.$final=function(){this.FImage=void 0,pas.System.TObject.$final.call(this)},this.Create$1=function(t,e){return this.FImage=t,this.FID=e,this}})),rtl.createClass(e,"TGraphicCacheList",pas.contnrs.TObjectList,(function(){this.Find=function(t,i){var s=!1,o=0,n=null;s=!1;for(var r=0,a=this.GetCount()-1;r<=a;r++)if(o=r,(n=rtl.as(this.GetItem(o),e.TGraphicCache)).FID===t&&null!=n.FImage){i.set(n.FImage),s=!0;break}return s},this.Exists=function(t){var i=!1,s=0,o=null;i=!1;for(var n=0,r=this.GetCount()-1;n<=r;n++)if(s=n,(o=rtl.as(this.GetItem(s),e.TGraphicCache)).FID===t&&null!=o.FImage){i=!0;break}return i}})),e.FCache=null,e.FQueue=null,e.FCacheCount=0,e.MatrixIdentity=function(){var e=t.TMatrix.$new();return e.m11=1,e.m12=0,e.m13=0,e.m21=0,e.m22=1,e.m23=0,e.m31=0,e.m32=0,e.m33=1,e},e.GetPixelRatio=function(t){var e=t.FContext;return(window.devicePixelRatio||1)/(e.webkitBackingStorePixelRatio||e.mozBackingStorePixelRatio||e.msBackingStorePixelRatio||e.oBackingStorePixelRatio||e.backingStorePixelRatio||1)},e.MatrixCreateScaling=function(i,s){var o=t.TMatrix.$new();return o.$assign(e.MatrixIdentity()),o.m11=i,o.m22=s,o},e.MatrixMultiply=function(e,i){var s=t.TMatrix.$new();return s.m11=e.m11*i.m11+e.m12*i.m21+e.m13*i.m31,s.m12=e.m11*i.m12+e.m12*i.m22+e.m13*i.m32,s.m13=e.m11*i.m13+e.m12*i.m23+e.m13*i.m33,s.m21=e.m21*i.m11+e.m22*i.m21+e.m23*i.m31,s.m22=e.m21*i.m12+e.m22*i.m22+e.m23*i.m32,s.m23=e.m21*i.m13+e.m22*i.m23+e.m23*i.m33,s.m31=e.m31*i.m11+e.m32*i.m21+e.m33*i.m31,s.m32=e.m31*i.m12+e.m32*i.m22+e.m33*i.m32,s.m33=e.m31*i.m13+e.m32*i.m23+e.m33*i.m33,s}},t.$init=function(){e.FCache=e.TGraphicCacheList.$create("Create$2"),e.FQueue=pas.Classes.TStringList.$create("Create$1")}}),["WEBLib.Forms","WEBLib.WebTools","Math","SysUtils","contnrs"]),rtl.module("WEBLib.Modules",["System","Classes"],(function(){"use strict";rtl.createClass(this,"TDataModule",pas.Classes.TComponent,(function(){this.$init=function(){pas.Classes.TComponent.$init.call(this),this.FHeight=0,this.FOldCreateOrder=!1,this.FOnCreate=null,this.FOnDestroy=null,this.FWidth=0},this.$final=function(){this.FOnCreate=void 0,this.FOnDestroy=void 0,pas.Classes.TComponent.$final.call(this)},this.DoCreate=function(){this.LoadDFMValues(),null!=this.FOnCreate&&this.FOnCreate(this)},this.DoDestroy=function(){null!=this.FOnDestroy&&this.FOnDestroy(this)},this.LoadDFMValues=function(){},this.AfterConstruction=function(){pas.System.TObject.AfterConstruction.call(this),this.FOldCreateOrder||this.DoCreate()},this.BeforeDestruction=function(){pas.Classes.TComponent.BeforeDestruction.call(this),this.FOldCreateOrder||this.DoDestroy()},rtl.addIntf(this,pas.System.IUnknown);var t=this.$rtti;t.addProperty("OnCreate",0,pas.Classes.$rtti.TNotifyEvent,"FOnCreate","FOnCreate"),t.addProperty("OnDestroy",0,pas.Classes.$rtti.TNotifyEvent,"FOnDestroy","FOnDestroy")}))})),rtl.module("WEBLib.Lang",["System"],(function(){"use strict";this.TUILanguage={0:"lNone",lNone:0,1:"lAfar",lAfar:1,2:"lAbkhazian",lAbkhazian:2,3:"lAvestan",lAvestan:3,4:"lAfrikaans",lAfrikaans:4,5:"lAkan",lAkan:5,6:"lAmharic",lAmharic:6,7:"lAragonese",lAragonese:7,8:"lArabic",lArabic:8,9:"lAssamese",lAssamese:9,10:"lAvaric",lAvaric:10,11:"lAymara",lAymara:11,12:"lAzerbaijani",lAzerbaijani:12,13:"lBashkir",lBashkir:13,14:"lBelarusian",lBelarusian:14,15:"lBulgarian",lBulgarian:15,16:"lBihari",lBihari:16,17:"lBislama",lBislama:17,18:"lBambara",lBambara:18,19:"lBengali",lBengali:19,20:"lTibetan",lTibetan:20,21:"lBreton",lBreton:21,22:"lBosnian",lBosnian:22,23:"lCatalan",lCatalan:23,24:"lChechen",lChechen:24,25:"lChamorro",lChamorro:25,26:"lCorsican",lCorsican:26,27:"lCree",lCree:27,28:"lCzech",lCzech:28,29:"lOldSlavic",lOldSlavic:29,30:"lChuvash",lChuvash:30,31:"lWelsh",lWelsh:31,32:"lDanish",lDanish:32,33:"lGerman",lGerman:33,34:"lDivehi",lDivehi:34,35:"lDzongkha",lDzongkha:35,36:"lEwe",lEwe:36,37:"lEnglish",lEnglish:37,38:"lEsperanto",lEsperanto:38,39:"lSpanish",lSpanish:39,40:"lEstonian",lEstonian:40,41:"lBasque",lBasque:41,42:"lPersian",lPersian:42,43:"lFulah",lFulah:43,44:"lFinnish",lFinnish:44,45:"lFijian",lFijian:45,46:"lFaroese",lFaroese:46,47:"lFrench",lFrench:47,48:"lWesternFrisian",lWesternFrisian:48,49:"lIrish",lIrish:49,50:"lGaelic",lGaelic:50,51:"lGalician",lGalician:51,52:"lGuarani",lGuarani:52,53:"lGujarati",lGujarati:53,54:"lManx",lManx:54,55:"lHausa",lHausa:55,56:"lHebrew",lHebrew:56,57:"lHindi",lHindi:57,58:"lHiriMotu",lHiriMotu:58,59:"lCroatian",lCroatian:59,60:"lHaitian",lHaitian:60,61:"lHungarian",lHungarian:61,62:"lArmenian",lArmenian:62,63:"lHerero",lHerero:63,64:"lInterlingua",lInterlingua:64,65:"lIndonesian",lIndonesian:65,66:"lInterlingue",lInterlingue:66,67:"lIgbo",lIgbo:67,68:"lSichuanYi",lSichuanYi:68,69:"lInupiaq",lInupiaq:69,70:"lIdo",lIdo:70,71:"lIcelandic",lIcelandic:71,72:"lItalian",lItalian:72,73:"lInuktitut",lInuktitut:73,74:"lJapanese",lJapanese:74,75:"lJavanese",lJavanese:75,76:"lGeorgian",lGeorgian:76,77:"lKongo",lKongo:77,78:"lKikuyu",lKikuyu:78,79:"lKuanyama",lKuanyama:79,80:"lKazakh",lKazakh:80,81:"lKalaallisut",lKalaallisut:81,82:"lCentralKhmer",lCentralKhmer:82,83:"lKannada",lKannada:83,84:"lKorean",lKorean:84,85:"lKanuri",lKanuri:85,86:"lKashmiri",lKashmiri:86,87:"lKurdish",lKurdish:87,88:"lKomi",lKomi:88,89:"lCornish",lCornish:89,90:"lKirghiz",lKirghiz:90,91:"lLatin",lLatin:91,92:"lLuxembourgish",lLuxembourgish:92,93:"lGanda",lGanda:93,94:"lLimburgan",lLimburgan:94,95:"lLingala",lLingala:95,96:"lLao",lLao:96,97:"lLithuanian",lLithuanian:97,98:"lLubaKatanga",lLubaKatanga:98,99:"lLatvian",lLatvian:99,100:"lMalagasy",lMalagasy:100,101:"lMarshallese",lMarshallese:101,102:"lMaori",lMaori:102,103:"lMacedonian",lMacedonian:103,104:"lMalayalam",lMalayalam:104,105:"lMongolian",lMongolian:105,106:"lMarathi",lMarathi:106,107:"lMalay",lMalay:107,108:"lMaltese",lMaltese:108,109:"lBurmese",lBurmese:109,110:"lNauru",lNauru:110,111:"lNdebele",lNdebele:111,112:"lNepali",lNepali:112,113:"lNdonga",lNdonga:113,114:"lDutch",lDutch:114,115:"lNorwegian",lNorwegian:115,116:"lNavajo",lNavajo:116,117:"lChichewa",lChichewa:117,118:"lOccitan",lOccitan:118,119:"lOjibwa",lOjibwa:119,120:"lOromo",lOromo:120,121:"lOriya",lOriya:121,122:"lOssetian",lOssetian:122,123:"lPanjabi",lPanjabi:123,124:"lPali",lPali:124,125:"lPolish",lPolish:125,126:"lPushto",lPushto:126,127:"lPortuguese",lPortuguese:127,128:"lQuechua",lQuechua:128,129:"lRomansh",lRomansh:129,130:"lRundi",lRundi:130,131:"lRomanian",lRomanian:131,132:"lRussian",lRussian:132,133:"lKinyarwanda",lKinyarwanda:133,134:"lSanskrit",lSanskrit:134,135:"lSardinian",lSardinian:135,136:"lSindhi",lSindhi:136,137:"lNorthernSami",lNorthernSami:137,138:"lSango",lSango:138,139:"lSinhala",lSinhala:139,140:"lSlovak",lSlovak:140,141:"lSlovenian",lSlovenian:141,142:"lSamoan",lSamoan:142,143:"lShona",lShona:143,144:"lSomali",lSomali:144,145:"lAlbanian",lAlbanian:145,146:"lSerbian",lSerbian:146,147:"lSwati",lSwati:147,148:"lSotho",lSotho:148,149:"lSundanese",lSundanese:149,150:"lSwedish",lSwedish:150,151:"lSwahili",lSwahili:151,152:"lTamil",lTamil:152,153:"lTelugu",lTelugu:153,154:"lTajik",lTajik:154,155:"lThai",lThai:155,156:"lTigrinya",lTigrinya:156,157:"lTurkmen",lTurkmen:157,158:"lTagalog",lTagalog:158,159:"lTswana",lTswana:159,160:"lTonga",lTonga:160,161:"lTurkish",lTurkish:161,162:"lTsonga",lTsonga:162,163:"lTatar",lTatar:163,164:"lTwi",lTwi:164,165:"lTahitian",lTahitian:165,166:"lUighur",lUighur:166,167:"lUkrainian",lUkrainian:167,168:"lUrdu",lUrdu:168,169:"lUzbek",lUzbek:169,170:"lVenda",lVenda:170,171:"lVietnamese",lVietnamese:171,172:"lWalloon",lWalloon:172,173:"lWolof",lWolof:173,174:"lXhosa",lXhosa:174,175:"lYiddish",lYiddish:175,176:"lYoruba",lYoruba:176,177:"lZhuang",lZhuang:177,178:"lChinese",lChinese:178,179:"lZulu",lZulu:179},this.GetLanguageISO639_1Code=function(t){var e="";return 0===t?e="":1===t?e="aa":2===t?e="ab":3===t?e="ae":4===t?e="af":5===t?e="ak":6===t?e="am":7===t?e="an":8===t?e="ar":9===t?e="as":10===t?e="av":11===t?e="ay":12===t?e="az":13===t?e="ba":14===t?e="be":15===t?e="bg":16===t?e="bh":17===t?e="bi":18===t?e="bm":19===t?e="bn":20===t?e="bo":21===t?e="br":22===t?e="bd":23===t?e="ca":24===t?e="ce":25===t?e="ch":26===t?e="co":27===t?e="cr":28===t?e="cs":29===t?e="cu":30===t?e="cv":31===t?e="cy":32===t?e="da":33===t?e="de":34===t?e="dv":35===t?e="dz":36===t?e="ee":37===t?e="en":38===t?e="eo":39===t?e="es":40===t?e="et":41===t?e="eu":42===t?e="fa":43===t?e="ff":44===t?e="fi":45===t?e="fj":46===t?e="fo":47===t?e="fr":48===t?e="fy":49===t?e="ga":50===t?e="gd":51===t?e="gl":52===t?e="gn":53===t?e="gu":54===t?e="gv":55===t?e="ha":56===t?e="he":57===t?e="hi":58===t?e="ho":59===t?e="hr":60===t?e="ht":61===t?e="hu":62===t?e="hy":63===t?e="hz":64===t?e="ia":65===t?e="id":66===t?e="ie":67===t?e="ig":68===t?e="ii":69===t?e="ik":70===t?e="id":71===t?e="is":72===t?e="it":73===t?e="iu":74===t?e="ja":75===t?e="jv":76===t?e="ka":77===t?e="kg":78===t?e="ki":79===t?e="kj":80===t?e="kk":81===t?e="kl":82===t?e="km":83===t?e="kn":84===t?e="ko":85===t?e="kr":86===t?e="ks":87===t?e="ku":88===t?e="kv":89===t?e="kw":90===t?e="ky":91===t?e="la":92===t?e="lb":93===t?e="lg":94===t?e="li":95===t?e="ln":96===t?e="lo":97===t?e="lt":98===t?e="lu":99===t?e="lv":100===t?e="mg":101===t?e="mh":102===t?e="mi":103===t?e="mk":104===t?e="ml":105===t?e="mn":106===t?e="mr":107===t?e="ms":108===t?e="mt":109===t?e="my":110===t?e="na":111===t?e="nb":112===t?e="nd":113===t?e="ng":114===t?e="nl":115===t?e="no":116===t?e="nv":117===t?e="ny":118===t?e="oc":119===t?e="oj":120===t?e="om":121===t?e="or":122===t?e="os":123===t?e="pa":124===t?e="pi":125===t?e="pl":126===t?e="ps":127===t?e="pt":128===t?e="qu":129===t?e="rm":130===t?e="rn":131===t?e="ro":132===t?e="ru":133===t?e="rw":134===t?e="sa":135===t?e="sc":136===t?e="sd":137===t?e="se":138===t?e="sg":139===t?e="si":140===t?e="sk":141===t?e="sl":142===t?e="sm":143===t?e="sn":144===t?e="so":145===t?e="sq":146===t?e="sr":147===t?e="ss":148===t?e="st":149===t?e="su":150===t?e="sv":151===t?e="sw":152===t?e="ta":153===t?e="te":154===t?e="tg":155===t?e="th":156===t?e="ti":157===t?e="tk":158===t?e="tl":159===t?e="tn":160===t?e="to":161===t?e="tr":162===t?e="ts":163===t?e="tt":164===t?e="tw":165===t?e="ty":166===t?e="ug":167===t?e="uk":168===t?e="ur":169===t?e="uz":170===t?e="ve":171===t?e="vi":172===t?e="wa":173===t?e="wo":174===t?e="xh":175===t?e="yi":176===t?e="yo":177===t?e="za":178===t?e="zh":179===t&&(e="zu"),e}})),rtl.module("Rtl.BrowserLoadHelper",["System","Classes","SysUtils","JS","Web"],(function(){"use strict";var t=this;rtl.createClass(this,"TBrowserLoadHelper",pas.Classes.TLoadHelper,(function(){})),t.$init=function(){pas.Classes.SetLoadHelperClass(t.TBrowserLoadHelper)}})),rtl.module("WEBLib.JSON",["System","Classes","Web","JS","SysUtils"],(function(){"use strict";rtl.createClass(this,"TJSONAncestor",pas.System.TObject,(function(){})),rtl.createClass(this,"TJSONValue",this.TJSONAncestor,(function(){}))})),rtl.module("WEBLib.Forms",["System","Classes","Types","SysUtils","WEBLib.Graphics","WEBLib.Controls","WEBLib.Modules","WEBLib.Lang","WEBLib.Menus","Web","JS","Rtl.BrowserLoadHelper"],(function(){"use strict";var t=this,e=t.$impl;this.WEBCOREVERSION="2.1.0.0 Rotondo",this.idOK=1,this.idCancel=2,this.idAbort=3,this.idRetry=4,this.idIgnore=5,this.idYes=6,this.idNo=7,this.idClose=8,this.idHelp=9,this.idContinue=11,this.mrNone=0,this.mrOk=1,this.mrCancel=2,this.mrAbort=3,this.mrRetry=4,this.mrIgnore=5,this.mrYes=6,this.mrNo=7,this.mrClose=8,this.mrHelp=9,this.mrContinue=11,this.mrAll=12,this.mrNoToAll=13,this.mrYesToAll=14,this.rgiFirst=-1024,this.igiLast=511,this.clTMSBlue=14917120,this.$rtti.$Int("TConstraintSize",{minvalue:0,maxvalue:2147483647,ordtype:5}),this.TCloseAction={0:"caNone",caNone:0,1:"caHide",caHide:1,2:"caFree",caFree:2,3:"caMinimize",caMinimize:3},this.$rtti.$Enum("TCloseAction",{minvalue:0,maxvalue:3,ordtype:1,enumtype:this.TCloseAction}),this.TFormStyle={0:"fsNormal",fsNormal:0,1:"fsStayOnTop",fsStayOnTop:1},this.$rtti.$Enum("TFormStyle",{minvalue:0,maxvalue:1,ordtype:1,enumtype:this.TFormStyle}),this.$rtti.$Int("TGestureID",{minvalue:-1024,maxvalue:511,ordtype:2}),this.TInteractiveGestureFlag={0:"gfBegin",gfBegin:0,1:"gfInertia",gfInertia:1,2:"gfEnd",gfEnd:2},this.$rtti.$Enum("TInteractiveGestureFlag",{minvalue:0,maxvalue:2,ordtype:1,enumtype:this.TInteractiveGestureFlag}),this.$rtti.$Set("TInteractiveGestureFlags",{comptype:this.$rtti.TInteractiveGestureFlag}),this.TMouseActivate={0:"maDefault",maDefault:0,1:"maActivate",maActivate:1,2:"maActivateAndEat",maActivateAndEat:2,3:"maNoActivate",maNoActivate:3,4:"maNoActivateAndEat",maNoActivateAndEat:4},this.$rtti.$Enum("TMouseActivate",{minvalue:0,maxvalue:4,ordtype:1,enumtype:this.TMouseActivate}),this.TScreenOrientation={0:"soPortrait",soPortrait:0,1:"soLandscape",soLandscape:1},this.$rtti.$Enum("TScreenOrientation",{minvalue:0,maxvalue:1,ordtype:1,enumtype:this.TScreenOrientation}),this.TApplicationColorScheme={0:"csNoScheme",csNoScheme:0,1:"csLight",csLight:1,2:"csDark",csDark:2},rtl.recNewT(this,"TSmallPoint",(function(){this.x=0,this.y=0,this.$eq=function(t){return this.x===t.x&&this.y===t.y},this.$assign=function(t){return this.x=t.x,this.y=t.y,this};var e=t.$rtti.$Record("TSmallPoint",{});e.addField("x",rtl.smallint),e.addField("y",rtl.smallint)})),rtl.recNewT(this,"TAlignInfo",(function(){this.AlignList=null,this.ControlIndex=0,this.Align=0,this.Scratch=0,this.$eq=function(t){return this.AlignList===t.AlignList&&this.ControlIndex===t.ControlIndex&&this.Align===t.Align&&this.Scratch===t.Scratch},this.$assign=function(t){return this.AlignList=t.AlignList,this.ControlIndex=t.ControlIndex,this.Align=t.Align,this.Scratch=t.Scratch,this};var e=t.$rtti.$Record("TAlignInfo",{});e.addField("AlignList",pas.Classes.$rtti.TList),e.addField("ControlIndex",rtl.longint),e.addField("Align",pas["WEBLib.Controls"].$rtti.TAlign),e.addField("Scratch",rtl.longint)})),rtl.recNewT(this,"TGestureEventInfo",(function(){this.GestureID=0,this.Angle=0,this.Distance=0,this.$new=function(){var e=Object.create(this);return e.Location=pas.Types.TPoint.$new(),e.Flags={},e.InertiaVector=t.TSmallPoint.$new(),e.TapLocation=t.TSmallPoint.$new(),e},this.$eq=function(t){return this.GestureID===t.GestureID&&this.Location.$eq(t.Location)&&rtl.eqSet(this.Flags,t.Flags)&&this.Angle===t.Angle&&this.InertiaVector.$eq(t.InertiaVector)&&this.Distance===t.Distance&&this.TapLocation.$eq(t.TapLocation)},this.$assign=function(t){return this.GestureID=t.GestureID,this.Location.$assign(t.Location),this.Flags=rtl.refSet(t.Flags),this.Angle=t.Angle,this.InertiaVector.$assign(t.InertiaVector),this.Distance=t.Distance,this.TapLocation.$assign(t.TapLocation),this};var e=t.$rtti.$Record("TGestureEventInfo",{});e.addField("GestureID",t.$rtti.TGestureID),e.addField("Location",pas.Types.$rtti.TPoint),e.addField("Flags",t.$rtti.TInteractiveGestureFlags),e.addField("Angle",rtl.double),e.addField("InertiaVector",t.$rtti.TSmallPoint),e.addField("Distance",rtl.longint),e.addField("TapLocation",t.$rtti.TSmallPoint)})),this.$rtti.$MethodVar("TCloseEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["Action",this.$rtti.TCloseAction,1]]),methodkind:0}),this.$rtti.$MethodVar("TCloseQueryEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["CanClose",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TOrientationChangeEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AOrientation",this.$rtti.TScreenOrientation]]),methodkind:0}),this.$rtti.$MethodVar("TBeforeUnloadEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AMessage",rtl.string,1]]),methodkind:0}),this.$rtti.$MethodVar("TAlignInsertBeforeEvent",{procsig:rtl.newTIProcSig([["Sender",pas["WEBLib.Controls"].$rtti.TWinControl],["C1",pas["WEBLib.Controls"].$rtti.TControl],["C2",pas["WEBLib.Controls"].$rtti.TControl]],rtl.boolean),methodkind:1}),this.$rtti.$MethodVar("TAlignPositionEvent",{procsig:rtl.newTIProcSig([["Sender",pas["WEBLib.Controls"].$rtti.TWinControl],["Control",pas["WEBLib.Controls"].$rtti.TControl],["NewLeft",rtl.longint,1],["NewTop",rtl.longint,1],["NewWidth",rtl.longint,1],["NewHeight",rtl.longint,1],["AlignRect",pas.Types.$rtti.TRect,1],["AlignInfo",this.$rtti.TAlignInfo]]),methodkind:0}),this.$rtti.$MethodVar("TCanResizeEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["NewWidth",rtl.longint,1],["NewHeight",rtl.longint,1],["Resize",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TConstrainedResizeEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["MinWidth",rtl.longint,1],["MinHeight",rtl.longint,1],["MaxWidth",rtl.longint,1],["MaxHeight",rtl.longint,1]]),methodkind:0}),this.$rtti.$MethodVar("TContextPopupEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["MousePos",pas.Types.$rtti.TPoint],["Handled",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TDockDropEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["Source",this.$rtti.TDragDockObject],["X",rtl.longint],["Y",rtl.longint]]),methodkind:0}),this.$rtti.$MethodVar("TDockOverEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["Source",this.$rtti.TDragDockObject],["X",rtl.longint],["Y",rtl.longint],["State",pas["WEBLib.Controls"].$rtti.TDragState],["Accept",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TGestureEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["EventInfo",this.$rtti.TGestureEventInfo,2],["Handled",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TGetSiteInfoEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["DockClient",pas["WEBLib.Controls"].$rtti.TControl],["InfluenceRect",pas.Types.$rtti.TRect,1],["MousePos",pas.Types.$rtti.TPoint],["CanDock",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TMouseActivateEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["Button",pas["WEBLib.Controls"].$rtti.TMouseButton],["Shift",pas.Classes.$rtti.TShiftState],["X",rtl.longint],["Y",rtl.longint],["HitTest",rtl.longint],["MouseActivate",this.$rtti.TMouseActivate,1]]),methodkind:0}),this.$rtti.$MethodVar("TMouseWheelUpDownEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["Shift",pas.Classes.$rtti.TShiftState],["MousePos",pas.Types.$rtti.TPoint],["Handled",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TStartDockEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["DragObject",this.$rtti.TDragDockObject,1]]),methodkind:0}),this.$rtti.$MethodVar("TUnDockEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["Client",pas["WEBLib.Controls"].$rtti.TControl],["NewTarget",pas["WEBLib.Controls"].$rtti.TWinControl],["Allow",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("THashChangeEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["oldURL",rtl.string],["newURL",rtl.string]]),methodkind:0}),this.TPopupMode={0:"pmNone",pmNone:0,1:"pmAuto",pmAuto:1,2:"pmExplicit",pmExplicit:2},this.TPopupClose={0:"pcOnDeactivate",pcOnDeactivate:0,1:"pcNever",pcNever:1},this.TPosition={0:"poDesigned",poDesigned:0,1:"poDefault",poDefault:1,2:"poDefaultPosOnly",poDefaultPosOnly:2,3:"poDefaultSizeOnly",poDefaultSizeOnly:3,4:"poScreenCenter",poScreenCenter:4,5:"poDesktopCenter",poDesktopCenter:5,6:"poMainFormCenter",poMainFormCenter:6,7:"poOwnerFormCenter",poOwnerFormCenter:7},this.TApplicationErrorType={0:"aeSilent",aeSilent:0,1:"aeDialog",aeDialog:1,2:"aeAlert",aeAlert:2,3:"aeFooter",aeFooter:3},this.TFormBorderStyle={0:"fbNone",fbNone:0,1:"fbSingle",fbSingle:1,2:"fbSizeable",fbSizeable:2,3:"fbDialog",fbDialog:3,4:"fbDialogSizeable",fbDialogSizeable:4},this.TCSSLibrary={0:"cssNone",cssNone:0,1:"cssBootstrap",cssBootstrap:1},this.$rtti.$Enum("TCSSLibrary",{minvalue:0,maxvalue:1,ordtype:1,enumtype:this.TCSSLibrary}),rtl.createClass(this,"TCustomSizeConstraints",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FControl=null,this.FMaxHeight=0,this.FMaxWidth=0,this.FMinHeight=0,this.FMinWidth=0,this.FOnChange=null},this.$final=function(){this.FControl=void 0,this.FOnChange=void 0,pas.Classes.TPersistent.$final.call(this)},this.SetConstraints=function(t,e){var i=t;0===i?e!==this.FMaxHeight&&(this.FMaxHeight=e,e>0&&e<this.FMinHeight&&(this.FMinHeight=e),this.Change()):1===i?e!==this.FMaxWidth&&(this.FMaxWidth=e,e>0&&e<this.FMinWidth&&(this.FMinWidth=e),this.Change()):2===i?e!==this.FMinHeight&&(this.FMinHeight=e,this.FMaxHeight>0&&e>this.FMaxHeight&&(this.FMaxHeight=e),this.Change()):3===i&&e!==this.FMinWidth&&(this.FMinWidth=e,this.FMaxWidth>0&&e>this.FMaxWidth&&(this.FMaxWidth=e),this.Change())},this.Change=function(){null!=this.FOnChange&&this.FOnChange(this)},this.AssignTo=function(e){t.TCustomSizeConstraints.isPrototypeOf(e)?(e.FMinHeight=this.FMinHeight,e.FMaxHeight=this.FMaxHeight,e.FMinWidth=this.FMinWidth,e.FMaxWidth=this.FMaxWidth,e.Change()):pas.Classes.TPersistent.AssignTo.call(this,e)},this.Create$1=function(t){return pas.System.TObject.Create.call(this),this.FControl=t,this}})),rtl.createClass(this,"TSizeConstraints",this.TCustomSizeConstraints,(function(){var e=this.$rtti;e.addProperty("MaxHeight",18,t.$rtti.TConstraintSize,"FMaxHeight","SetConstraints",{index:0,Default:0}),e.addProperty("MaxWidth",18,t.$rtti.TConstraintSize,"FMaxWidth","SetConstraints",{index:1,Default:0}),e.addProperty("MinHeight",18,t.$rtti.TConstraintSize,"FMinHeight","SetConstraints",{index:2,Default:0}),e.addProperty("MinWidth",18,t.$rtti.TConstraintSize,"FMinWidth","SetConstraints",{index:3,Default:0})})),rtl.createClass(this,"TDragDockObject",pas.System.TObject,(function(){this.$init=function(){pas.System.TObject.$init.call(this),this.FBrush=null},this.$final=function(){this.FBrush=void 0,pas.System.TObject.$final.call(this)},this.Destroy=function(){rtl.free(this,"FBrush"),pas.System.TObject.Destroy.call(this)}})),rtl.createClass(this,"TCustomForm",pas["WEBLib.Controls"].TWinControl,(function(){this.$init=function(){pas["WEBLib.Controls"].TWinControl.$init.call(this),this.FDesignContainer=null,this.FLayer$1=null,this.FPopup=!1,this.FPopupElement=null,this.FFormFileName="",this.FFormContainer="",this.FFormElement="",this.FFormStyle=0,this.FOnCreate=null,this.FOnShow=null,this.FModalResult=0,this.FOnPaint=null,this.FOnDeactivate=null,this.FOnCloseQuery=null,this.FOnClose=null,this.FModalProc=null,this.FCreatedProc=null,this.FCaption="",this.FIsResizing$1=!1,this.FOnScroll=null,this.FOnUnload=null,this.FOnBeforeUnload=null,this.FPopupMode=0,this.FPopupClose=0,this.FPosition=0,this.FActiveControl=null,this.FMdx=0,this.FMdy=0,this.FDlgX=0,this.FDlgY=0,this.FCaptured$1=!1,this.FDown=!1,this.FHasCaption=!1,this.FMoveSpan=null,this.FCaptionElement=null,this.FCaptionCloseElement=null,this.FBorder=0,this.FShadow=!1,this.FTimerID=0,this.FOrigWidth=0,this.FOrigHeight=0,this.FOldWidth=0,this.FOldHeight=0,this.FOnDestroy=null,this.FPopupOpacity=0,this.FCreating=!1,this.FLoadedPtr=null,this.FDOMContentLoadedPtr=null,this.FUnloadPtr=null,this.FBeforeUnloadPtr=null,this.FResizePtr=null,this.FScrollPtr=null,this.FDocMouseUpPtr=null,this.FDocMouseMovePtr=null,this.FTitleDownPtr=null,this.FDoClickPtr=null,this.FKeyDownPtr$1=null,this.FOrientationChangePtr=null,this.FHashChangePtr=null,this.FCSSLibrary=0,this.FNoHTML=!1,this.FPrevActiveForm=null,this.FElementCaptionClassName="",this.FMenu=null,this.FResizeObserver=null,this.FOnOrientationChange=null,this.FOnDOMContentLoaded=null,this.FShowClose=!1,this.FOnHashChange=null},this.$final=function(){this.FDesignContainer=void 0,this.FLayer$1=void 0,this.FPopupElement=void 0,this.FOnCreate=void 0,this.FOnShow=void 0,this.FOnPaint=void 0,this.FOnDeactivate=void 0,this.FOnCloseQuery=void 0,this.FOnClose=void 0,this.FModalProc=void 0,this.FCreatedProc=void 0,this.FOnScroll=void 0,this.FOnUnload=void 0,this.FOnBeforeUnload=void 0,this.FActiveControl=void 0,this.FMoveSpan=void 0,this.FCaptionElement=void 0,this.FCaptionCloseElement=void 0,this.FOnDestroy=void 0,this.FPrevActiveForm=void 0,this.FMenu=void 0,this.FResizeObserver=void 0,this.FOnOrientationChange=void 0,this.FOnDOMContentLoaded=void 0,this.FOnHashChange=void 0,pas["WEBLib.Controls"].TWinControl.$final.call(this)},this.SetModalResult=function(t){this.FModalResult=t,0!==this.FModalResult&&this.Close()},this.GetFormStyle=function(){return this.FFormStyle},this.SetFormStyle=function(t){this.FFormStyle=t},this.GetCanvas=function(){return null,null},this.SetCaption=function(t){this.FCaption!==t&&(this.FCaption=t,this.UpdateElement())},this.SetActiveControl=function(t){this.FActiveControl=t,null!=this.FActiveControl&&this.FActiveControl.SetFocus()},this.SetShadow=function(t){this.FShadow!==t&&(this.FShadow=t,this.UpdateElement())},this.SetBorder=function(t){this.FBorder!==t&&(this.FBorder=t,null!=this.GetContainer()&&this.AlignControl(this))},this.SetFormContainer=function(t){var e,i=null,s=0;if(e=this.GetContainer(),4 in this.FComponentState?this.FFormContainer=t:"BODY"===pas.SysUtils.UpperCase(t)?this.FFormContainer="":this.FFormContainer=t,(!(0 in this.FComponentState)||4 in this.FComponentState)&&(null!=this.FLayer$1?i=this.FLayer$1:(""===t||null==(i=document.getElementById(t)))&&(i=document.body),null!=i&&(this.FContainer=i,null!=e)))for(var o=0,n=this.GetControlsCount()-1;o<=n;o++)s=o,this.GetControls(s).FParentElement===e&&(this.GetControls(s).FParentElement=i),null!=this.GetControls(s).GetElementHandle()&&this.GetControls(s).GetElementHandle().parentElement===e&&i.appendChild(this.GetControls(s).GetElementHandle())},this.GetActiveControl=function(){var t=null,e=0;t=this.FActiveControl;for(var i=0,s=this.GetControlsCount()-1;i<=s;i++)if(e=i,this.GetControls(e).GetElementHandle()===document.activeElement){t=this.GetControls(e);break}return t},this.SetWidth=function(t){var e=null;0 in this.FComponentState&&""!==this.FFormContainer||!this.FPopup&&null==this.GetElementHandle()?this.SetWidthInt(t):(pas["WEBLib.Controls"].TControl.SetWidth.apply(this,arguments),this.FPopup&&null!=(e=this.FPopupElement)&&e.style.setProperty("width",pas.SysUtils.IntToStr(t)+"px"))},this.SetHeight=function(t){var e=null;0 in this.FComponentState&&""!==this.FFormContainer||!this.FPopup&&null==this.GetElementHandle()?this.SetHeightInt(t):(pas["WEBLib.Controls"].TControl.SetHeight.apply(this,arguments),this.FPopup&&null!=(e=this.FPopupElement)&&e.style.setProperty("height",pas.SysUtils.IntToStr(t)+"px"))},this.SetPosition=function(t){this.FPosition=t},this.HandleHashChange=function(t){var e,i;return e=t.oldURL,i=t.newURL,null!=this.FOnHashChange&&this.FOnHashChange(this,e,i),!0,!0},this.HandleLoaded=function(t){return this.Resize$1(),this.InitAnchoring(),!0,!0},this.HandleDOMContentLoaded=function(t){return null!=this.FOnDOMContentLoaded&&this.FOnDOMContentLoaded(this),!0,!0},this.HandleScroll=function(t){return null!=this.FOnScroll&&this.FOnScroll(this),!0,!0},this.HandleUnload=function(t){return null!=this.FOnUnload&&this.FOnUnload(this),!0,!0},this.HandleBeforeUnload=function(t){var e="";return e="",null!=this.FOnBeforeUnload&&this.FOnBeforeUnload(this,{get:function(){return e},set:function(t){e=t}}),""!==e?(t.returnValue=e,e):(!0,!0)},this.HandleObserver=function(){return this.Resize$1(),!0,!0},this.HandleResize=function(t){return this.FVisible&&!(3 in this.FComponentState)&&(null==this.GetContainer()&&this.CreateControl(),this.Resize$1(),this.GetElementHandle()===document.body&&window.setTimeout(rtl.createSafeCallback(this,"Resize$1"),25)),!0,!0},this.HandleDocMouseMove=function(t){var e=0,i=0,s=null,o=0,n=0;return this.FDown&&null!=this.GetContainer()&&(e=t.screenX-this.FMdx,i=t.screenY-this.FMdy,(s=this.FHasCaption&&""!==this.FFormFileName?this.GetContainer().parentNode:this.GetContainer()).style.setProperty("transform",""),s.style.setProperty("position","absolute"),o=Math.round(this.FDlgX+e),n=Math.round(this.FDlgY+i),s.style.setProperty("left",pas.SysUtils.IntToStr(o)+"px"),s.style.setProperty("top",pas.SysUtils.IntToStr(n)+"px"),this.FLeft=o,this.FTop=n),!0,!0},this.HandleDocMouseUp=function(t){return this.FDown&&(this.FCaptured$1=!1,this.FDown=!1,document.body.removeEventListener("mousemove",this.FDocMouseMovePtr),document.body.removeEventListener("mouseup",this.FDocMouseUpPtr),null!=this.FMoveSpan&&document.body.removeChild(this.FMoveSpan),this.FEventStopPropagation=rtl.unionSet(this.FEventStopPropagation,rtl.createSet(3,2)),this.FMoveSpan=null),!0,!0},this.HandleTitleDown=function(t){var e=null;return t.stopPropagation(),t.preventDefault(),this.FPopupClose=1,this.FMdx=Math.round(t.screenX),this.FMdy=Math.round(t.screenY),e=this.FHasCaption&&""!==this.FFormFileName?this.GetContainer().parentNode.getBoundingClientRect():this.GetContainer().getBoundingClientRect(),this.FDlgX=Math.round(pas.System.Int(e.left)),this.FDlgY=Math.round(pas.System.Int(e.top)),this.FDown=!0,this.FCaptured$1||(this.FCaptured$1=!0,this.FMoveSpan=document.createElement("SPAN"),this.FMoveSpan.style.setProperty("top","0"),this.FMoveSpan.style.setProperty("left","0"),this.FMoveSpan.style.setProperty("right","0"),this.FMoveSpan.style.setProperty("bottom","0"),this.FMoveSpan.style.setProperty("position","absolute"),document.body.appendChild(this.FMoveSpan),this.FEventStopPropagation=rtl.diffSet(this.FEventStopPropagation,rtl.createSet(3,2)),document.body.addEventListener("mousemove",this.FDocMouseMovePtr),document.body.addEventListener("mouseup",this.FDocMouseUpPtr)),!0,!0},this.HandleCloseClick=function(t){var e=!1;return e=!0,null!=this.FOnCloseQuery&&this.FOnCloseQuery(this,{get:function(){return e},set:function(t){e=t}}),e&&this.Close(),!0,!0},this.SetLeft=function(t){var e=null;pas["WEBLib.Controls"].TControl.SetLeft.apply(this,arguments),this.FPopup&&null!=(e=this.FPopupElement)&&e.style.setProperty("left",pas.SysUtils.IntToStr(t)+"px")},this.SetTop=function(t){var e=null;pas["WEBLib.Controls"].TControl.SetTop.apply(this,arguments),this.FPopup&&null!=(e=this.FPopupElement)&&e.style.setProperty("top",pas.SysUtils.IntToStr(t)+"px")},this.ClearMethodPointers=function(){pas["WEBLib.Controls"].TControl.ClearMethodPointers.call(this),this.FLoadedPtr=null,this.FDOMContentLoadedPtr=null,this.FUnloadPtr=null,this.FBeforeUnloadPtr=null,this.FResizePtr=null,this.FScrollPtr=null,this.FDocMouseUpPtr=null,this.FDocMouseMovePtr=null,this.FTitleDownPtr=null,this.FDoClickPtr=null,this.FKeyDownPtr$1=null,this.FOrientationChangePtr=null,this.FHashChangePtr=null},this.GetMethodPointers=function(){pas["WEBLib.Controls"].TControl.GetMethodPointers.call(this),null===this.FLoadedPtr&&(this.FLoadedPtr=rtl.createCallback(this,"HandleLoaded"),this.FDOMContentLoadedPtr=rtl.createCallback(this,"HandleDOMContentLoaded"),this.FUnloadPtr=rtl.createCallback(this,"HandleUnload"),this.FBeforeUnloadPtr=rtl.createCallback(this,"HandleBeforeUnload"),this.FResizePtr=rtl.createCallback(this,"HandleResize"),this.FScrollPtr=rtl.createCallback(this,"HandleScroll"),this.FDocMouseUpPtr=rtl.createCallback(this,"HandleDocMouseUp"),this.FDocMouseMovePtr=rtl.createCallback(this,"HandleDocMouseMove"),this.FTitleDownPtr=rtl.createCallback(this,"HandleTitleDown"),this.FDoClickPtr=rtl.createCallback(this,"HandleDoClick$1"),this.FKeyDownPtr$1=rtl.createCallback(this,"HandleKeyDown"),this.FOrientationChangePtr=rtl.createCallback(this,"HandleOrientationChange"),this.FHashChangePtr=rtl.createCallback(this,"HandleHashChange"))},this.VisibleChanged=function(){pas["WEBLib.Controls"].TControl.VisibleChanged.call(this),null!=this.FLayer$1?this.FVisible?this.FLayer$1.style.setProperty("display",""):this.FLayer$1.style.setProperty("display","none"):null!=this.GetContainer()&&""!==this.FFormContainer&&(this.FVisible?this.GetContainer().style.setProperty("display",""):this.GetContainer().style.setProperty("display","none"))},this.Resize$1=function(){var t=0,e=0,i=0,s=0,o=null;if(!(3 in this.FComponentState)&&(this.FIsResizing$1=!0,this.FPopup&&null!=this.FPopupElement?(o=this.FPopupElement.getBoundingClientRect(),i=Math.round(o.right-o.left-2),this.FBorder in rtl.createSet(3,4)?(e=this.GetCaptionHeight(),s=Math.round(o.bottom-o.top-e-2)):s=Math.round(o.bottom-o.top-2)):(i=window.innerWidth,s=window.innerHeight),this.UpdateControlSize(i,s),pas["WEBLib.Controls"].IsAndroid()&&"INPUT"===document.activeElement.tagName||this.AlignControl(this),this.DoResize(),this.FIsResizing$1=!1,!this.IsUpdating())){-1===this.FOrigRect.Left&&-1===this.FOrigRect.Top&&this.InitAnchoring();for(var n=0,r=this.GetControlsCount()-1;n<=r;n++)t=n,this.GetControls(t).UpdateAnchoring()}},this.CreateControl=function(){(this.FVisible||this.FPopup)&&(pas["WEBLib.Controls"].TControl.CreateControl.call(this),this.UpdateSize())},this.DoClose=function(t){null!=this.FModalProc&&0!==t.get()&&(this.FModalProc(this.FModalResult),this.FModalProc=null)},this.BindEvents=function(){pas["WEBLib.Controls"].TControl.BindEvents.call(this),"loading"!==document.readyState&&null!=this.FOnDOMContentLoaded&&this.FOnDOMContentLoaded(this),window.addEventListener("resize",this.FResizePtr),window.addEventListener("load",this.FLoadedPtr),window.addEventListener("DOMContentLoaded",this.FDOMContentLoadedPtr),document.addEventListener("scroll",this.FScrollPtr),window.addEventListener("unload",this.FUnloadPtr),window.addEventListener("beforeunload",this.FBeforeUnloadPtr),window.addEventListener("keydown",this.FKeyDownPtr$1),window.addEventListener("orientationchange",this.FOrientationChangePtr),window.addEventListener("hashchange",this.FHashChangePtr)},this.UnbindEvents=function(){pas["WEBLib.Controls"].TControl.UnbindEvents.call(this),null!=this.FLayer$1&&0===this.FPopupClose&&this.FLayer$1.removeEventListener("click",this.FDoClickPtr),null!=this.FResizeObserver&&this.FResizeObserver.disconnect(),window.removeEventListener("resize",this.FResizePtr),window.removeEventListener("load",this.FLoadedPtr),window.removeEventListener("DOMContentLoaded",this.FDOMContentLoadedPtr),document.removeEventListener("scroll",this.FScrollPtr),window.removeEventListener("unload",this.FUnloadPtr),window.removeEventListener("beforeunload",this.FBeforeUnloadPtr),window.removeEventListener("keydown",this.FKeyDownPtr$1),window.removeEventListener("orientationchange",this.FOrientationChangePtr),window.removeEventListener("hashchange",this.FHashChangePtr)},this.DoCreate=function(){this.BeginUpdate(),this.LoadDFMValues(),this.Loaded(),null!=this.FOnCreate&&this.FOnCreate(this),this.FCreating=!1,this.EndUpdate(),this.UpdateChildren(this),this.Realign(),this.DoResize()},this.Realign=function(){var t=null,e=null,i=pas.Types.TRect.$new();""!==this.FFormContainer&&0!==this.FAlign&&null!=(t=document.getElementById(this.FFormContainer))&&(0===(e=t.getBoundingClientRect()).width&&0===e.height&&"absolute"===t.style.getPropertyValue("position")?i.$assign(pas["WEBLib.Controls"].GetHTMLElementAbsoluteRect(t)):i.$assign(pas.Types.Rect(Math.round(e.left),Math.round(e.top),Math.round(e.right),Math.round(e.bottom))),this.SetBoundsInt(i.Left,i.Top,i.Right-i.Left,i.Bottom-i.Top)),pas["WEBLib.Controls"].TControl.Realign.call(this)},this.DoResize=function(){var t,e;t=this.GetWidth(),e=this.GetHeight(),t===this.FOldWidth&&e===this.FOldHeight||(this.FOldWidth=t,this.FOldHeight=e,null!=this.FOnResize&&this.FOnResize(this))},this.DoShow=function(){null!=this.FOnShow&&this.FOnShow(this)},this.HandleDoClick$1=function(t){return t.stopPropagation(),0===this.FPopupClose&&this.Close(),!0,!0},this.HandleKeyDown=function(t){var e,i=!1;return e=this.GetKeyCode(t.key,!0),pas.System.Assigned(e)?(27===e&&!(4 in this.FComponentState)&&this.FPopup&&this.Close(),i=!0):i},this.HandleOrientationChange=function(t){var e=0;(this.Resize$1(),this.Realign(),!0,null!=this.FOnOrientationChange)&&(e=window.matchMedia("(orientation: portrait)").matches?1:0,this.FOnOrientationChange(this,e));return null!=this.FOnResize&&this.FOnResize(this),!0},this.HandleDoResize=function(){var t,e,i=null;i=this.GetContainer().getBoundingClientRect(),t=Math.round(i.right-i.left),e=Math.round(i.bottom-i.top),t===this.FOrigWidth&&e===this.FOrigHeight||(this.SetWidth(t),this.SetHeight(e),i=this.GetContainer().getBoundingClientRect(),this.FOrigWidth=Math.round(i.right-i.left),this.FOrigHeight=Math.round(i.bottom-i.top),this.AlignControl(this))},this.GetWidth=function(){var t=0,e=null,i=null;return""!==this.FFormElement&&null!=(i=document.getElementById(this.FFormElement))?(e=i.getBoundingClientRect(),t=Math.round(e.right-e.left)):(this.GetElementHandle()===document.body?(t=window.innerWidth,e=document.documentElement.getBoundingClientRect(),(t=Math.round(e.width))>window.innerWidth&&(t=window.innerWidth)):this.FPopup?t=pas["WEBLib.Controls"].TControl.GetWidth.call(this):0===(t=Math.round(this.GetElementHandle().offsetWidth))&&(t=""!==this.FFormContainer?pas["WEBLib.Controls"].TControl.GetWidth.call(this):window.innerWidth),t)},this.GetHeight=function(){var t=0,e=0,i="",s=null,o=null;return""!==this.FFormElement&&null!=(s=document.getElementById(this.FFormElement))?(o=s.getBoundingClientRect(),t=Math.round(o.bottom-o.top)):(this.GetElementHandle()===document.body?(i=window.getComputedStyle(this.GetElementHandle()).getPropertyValue("margin-top"),i=pas.System.Copy(i,1,i.length-2),e=Math.round(pas.SysUtils.StrToFloat$1(i,pas.SysUtils.TFormatSettings.Invariant())-2),o=document.documentElement.getBoundingClientRect(),(t=Math.round(o.height))>window.innerHeight&&(t=window.innerHeight-Math.max(0,e))):this.FPopup?t=pas["WEBLib.Controls"].TControl.GetHeight.call(this):0===(t=Math.round(this.GetElementHandle().offsetHeight))&&(t=""!==this.FFormContainer?pas["WEBLib.Controls"].TControl.GetHeight.call(this):window.innerHeight),t)},this.GetLeft=function(){var t=0,e=null,i=null;return this.FPopup?t=pas["WEBLib.Controls"].TControl.GetLeft.call(this):""!==this.FFormElement?null!=(e=document.getElementById(this.FFormElement))&&(i=e.getBoundingClientRect(),t=Math.round(i.left)):(e=null,""!==this.FFormContainer&&(e=document.getElementById(this.FFormContainer)),null==e&&(e=this.GetElementHandle()),t=Math.round(e.offsetLeft)),t},this.GetTop=function(){var t=0,e=null,i=null;return this.FPopup?t=pas["WEBLib.Controls"].TControl.GetTop.call(this):""!==this.FFormElement?null!=(e=document.getElementById(this.FFormElement))&&(i=e.getBoundingClientRect(),t=Math.round(i.top)):(e=null,""!==this.FFormContainer&&(e=document.getElementById(this.FFormContainer)),null==e&&(e=this.GetElementHandle()),t=Math.round(e.offsetTop)),t},this.GetClientRect=function(){var t=pas.Types.TRect.$new();return t.$assign(pas["WEBLib.Controls"].TControl.GetClientRect.call(this)),t},this.CreateElement=function(){var e=null,i=null,s=null;return this.FPopup||null==this.FormContainerElement()?(e=document.createElement("DIV"),this.FLayer$1=this.CreateLayer(),document.body.appendChild(this.FLayer$1),i=this.FLayer$1,0===this.FPopupClose&&(this.GetMethodPointers(),i.addEventListener("click",this.FDoClickPtr)),i.style.setProperty(pas["WEBLib.Controls"].CSSZIndex,t.Application.MaxZIndexStr()),2===this.FBorder&&(e.style.setProperty("resize","both"),e.style.setProperty("overflow","auto")),this.FHasCaption=!1,this.FBorder in rtl.createSet(2,3,4)&&(s=this.CreateCaption(),e.appendChild(s)),e):e=this.FormContainerElement()},this.UpdateElement=function(){var t="",e=null;this.FCreating||(pas["WEBLib.Controls"].TControl.UpdateElement.call(this),this.IsUpdating()||(null==this.GetElementHandle()&&null==this.GetContainer()||""!==this.FCaption&&(this.FPopup?null!=this.FCaptionElement&&(null!=(e=this.FCaptionElement.childNodes.item(0))&&(e.nodeValue=this.FCaption),this.FShowClose&&null==this.FCaptionCloseElement&&(this.FCaptionCloseElement=document.createElement("SPAN"),this.FCaptionCloseElement.style.setProperty("float","right"),this.FCaptionCloseElement.style.setProperty("cursor","default"),this.FCaptionCloseElement.style.setProperty("margin-right","8px"),this.FCaptionCloseElement.innerHTML="&#x2716;",this.FCaptionElement.appendChild(this.FCaptionCloseElement),this.FCaptionCloseElement.addEventListener("click",rtl.createSafeCallback(this,"HandleCloseClick"))),pas["WEBLib.Controls"].SetHTMLElementFont(this.FCaptionElement,this.FFont,!(""===this.FElementCaptionClassName&&0===this.FElementFont))):window.document.title=this.FCaption),null!=this.GetContainer()&&(t=pas["WEBLib.Graphics"].ColorToHTML(this.FColor),null!=this.GetContainer()&&(-1===this.FColor||16777215===this.FColor||this.FPopup||""!==this.FElementClassName||this.GetContainer().style.setProperty(pas["WEBLib.Controls"].CSSBackground,t),(""!==this.FElementClassName||-1===this.FColor||16777215===this.FColor&&!this.FPopup)&&this.GetContainer().style.removeProperty(pas["WEBLib.Controls"].CSSBackground),""!==this.FElementClassName||this.FPopup||document.documentElement.style.setProperty("height","100%"),pas["WEBLib.Controls"].SetHTMLElementFont(this.GetContainer(),this.FFont,!(""===this.FElementClassName&&0===this.FElementFont))),this.FPopup?(null==this.FPopupElement&&(this.FPopupElement=this.GetContainer()),this.FShadow?this.FPopupElement.style.setProperty("box-shadow","3px 3px 3px silver"):this.FPopupElement.style.removeProperty("box-shadow"),this.FPopupElement.style.setProperty("border","1px solid gray")):this.GetContainer().style.removeProperty("box-shadow"))))},this.ContainerElement=function(){return this.FormContainerElement()},this.FormContainerElement=function(){var t=null;return 4 in this.FComponentState&&null!=this.FDesignContainer&&(t=this.FDesignContainer),""!==this.FFormContainer?null==(t=document.getElementById(this.FFormContainer))&&(t=document.body):t=document.body,t},this.GetElementBindHandle=function(){return 4 in this.FComponentState||""!==this.FFormContainer?window:this.FPopup?pas["WEBLib.Controls"].TControl.GetElementBindHandle.call(this):window},this.GetElementHandle=function(){return this.FPopup?pas["WEBLib.Controls"].TControl.GetElementHandle.call(this):this.FormContainerElement()},this.SetElementClassName=function(t){pas["WEBLib.Controls"].TControl.SetElementClassName.apply(this,arguments),this.FPopup&&null!=this.FPopupElement&&this.FPopupElement.setAttribute("class",t)},this.CloseQuery=function(){var t=!1;return t=!0,null!=this.FOnCloseQuery&&this.FOnCloseQuery(this,{get:function(){return t},set:function(e){t=e}}),t},this.LoadDFMValues=function(){},this.Init=function(){},this.IsFocused=function(){return!1,!1},this.CreateLayer=function(){var e=null;return(e=document.createElement("SPAN")).style.setProperty("top","0"),e.style.setProperty("left","0"),e.style.setProperty("right","0"),e.style.setProperty("bottom","0"),e.style.setProperty("webkit-user-select","none"),e.style.setProperty("moz-user-select","none"),e.style.setProperty("khtml-user-select","none"),e.style.setProperty("ms-user-select","none"),e.style.setProperty("user-select","none"),e.style.setProperty("position","absolute"),e.style.setProperty("z-index",t.Application.MaxZIndexStr()),e},this.CreateCaption=function(){var e;return e=pas.SysUtils.IntToStr(t.Application.FFormCaptionHeight),this.FCaptionElement=document.createElement("DIV"),this.FCaptionElement.innerHTML=this.FCaption,this.FCaptionElement.style.setProperty(pas["WEBLib.Controls"].CSSBackground,pas["WEBLib.Graphics"].ColorToHTML(t.Application.FThemeColor)),this.FCaptionElement.style.setProperty("color",pas["WEBLib.Graphics"].ColorToHTML(t.Application.FThemeTextColor)),this.FCaptionElement.style.setProperty("cursor","move"),this.FCaptionElement.style.setProperty("height",e+"px"),this.FCaptionElement.style.setProperty("line-height",e+"px"),this.FCaptionElement.style.setProperty("border-bottom","1px solid black"),this.FCaptionElement.style.setProperty("padding-left","4px"),this.FCaptionElement.style.setProperty("-moz-user-select","none"),this.FCaptionElement.style.setProperty("-webkit-user-select","none"),this.FCaptionElement.style.setProperty("-ms-user-select","none"),this.FCaptionElement.style.setProperty("user-select","none"),this.FCaptionElement.style.setProperty("-o-user-select","none"),""!==this.FElementCaptionClassName&&this.FCaptionElement.setAttribute("class",this.FElementCaptionClassName),pas["WEBLib.Controls"].SetHTMLElementFont(this.FCaptionElement,this.FFont,!(""===this.FElementCaptionClassName&&0===this.FElementFont)),null==this.FTitleDownPtr&&this.GetMethodPointers(),this.FCaptionElement.innerHTML=this.FCaption,this.FCaptionElement.addEventListener("mousedown",this.FTitleDownPtr),this.FHasCaption=!0,this.FCaptionElement},this.GetCaptionHeight=function(){var t=0,e=null;return t=0,null!=this.FCaptionElement&&this.FBorder in rtl.createSet(3,4)&&(e=this.FCaptionElement.getBoundingClientRect(),t=Math.round(e.bottom-e.top)),t},this.SetColorScheme=function(e){var i="";if(t.Application.FThemed){var s=e;2===s?(i="label,option,td,table,ul,li {background-color: #202124; color: #BEC1C6;}\r\nbody,input,textarea,select,fieldset {background-color: #202124; color: #BEC1C6; border: 1px solid gray;}\r\ninput:focus, textarea:focus, select:focus, span:focus { border: 1px solid silver; outline: none !important;}",this.AddCSS("appscheme",i)):1===s&&this.RemoveCSS("appscheme")}},this.SetFormPos=function(){null!=this.GetContainer()&&(4===this.FPosition&&(this.FLeft=Math.round((t.WinWidth()-this.GetWidth())/2)+window.scrollX,this.FTop=Math.round((t.WinHeight()-this.GetHeight())/2)+window.scrollY),this.GetContainer().style.setProperty("position","absolute"),this.GetContainer().style.setProperty("width",pas.SysUtils.IntToStr(this.GetWidth())+"px"),this.GetContainer().style.setProperty("height",pas.SysUtils.IntToStr(this.GetHeight())+"px"),this.GetContainer().style.setProperty("left",pas.SysUtils.IntToStr(this.GetLeft())+"px"),this.GetContainer().style.setProperty("top",pas.SysUtils.IntToStr(this.GetTop())+"px"))},this.GetHTMLFileName=function(){return this.$module.$name+t.Application.GetFormExtension()},this.LoadedDone=function(){t.Application.TriggerNotification()},this.Loaded=function(){pas["WEBLib.Controls"].TControl.Loaded.call(this),this.LoadedDone()},this.ColorChanging=function(){pas["WEBLib.Controls"].TControl.ColorChanging.call(this),null!=this.GetContainer()&&this.GetContainer().style.setProperty(pas["WEBLib.Controls"].CSSBackground,pas["WEBLib.Graphics"].ColorToHTML(this.FColor))},this.CreateInitialize=function(){pas["WEBLib.Controls"].TControl.CreateInitialize.call(this),this.FAllowTouch=!0,this.FModalResult=0,this.FFormStyle=0,this.FBorder=2,this.FShadow=!0,this.FShowClose=!0,this.FTimerID=-1,this.FCaptionElement=null,this.FColor=16777215,window.addEventListener("load",this.FLoadedPtr)},this.Create$2=function(t){return this.FNoHTML=!1,this.FCreating=!0,this.FFormContainer=t,""===t?pas["WEBLib.Controls"].TControl.Create$2.call(this,pas["WEBLib.WebTools"].cBodyTag):pas["WEBLib.Controls"].TControl.Create$2.call(this,t),this.FFormElement="",this.FModalResult=0,this.FFormStyle=0,this.DoCreate(),this},this.Create$5=function(t,e){return this.FCreating=!0,this.FFormContainer=t,pas["WEBLib.Controls"].TControl.Create$2.call(this,t),e.set(this),this.FFormElement="",this.FModalResult=0,this.FFormStyle=0,this.DoCreate(),this},this.Create$1=function(t){return this.FNoHTML=!1,this.FCreating=!0,this.FResizeObserver=null,pas["WEBLib.Controls"].TControl.Create$1.apply(this,arguments),this.FBorder=1,this.FFormFileName="",this.FPopupMode=0,this.FPopupClose=0,this.FPopup=!0,this.FPosition=4,this.FPopupOpacity=1,this},this.CreateNew=function(t,e){return this.Create$1(t),this},this.Load=function(){var e=this;return this.FFormFileName=this.$class.GetHTMLFileName(),""===this.FFormFileName?new Promise((function(t,i){t(e)})):new Promise((function(i,s){t.Application.LoadForm$1(e,e.FFormFileName,(function(t){i(t)}))}))},this.Execute=function(){var t=this;return new Promise((function(e,i){t.ShowModal$1((function(t){e(t)}))}))},this.Destroy=function(){this.FVisible&&this.Close(),null!=this.FOnDestroy&&this.FOnDestroy(this),pas["WEBLib.Controls"].TControl.Destroy.call(this),null!=this.FLayer$1&&(this.FormContainerElement()===this.FLayer$1.parentNode&&this.FormContainerElement().removeChild(this.FLayer$1),this.FLayer$1=null)},this.Close=function(){var i=0,s=null;this.CloseQuery()&&(this.UnbindEvents(),i=1,-1!==this.FTimerID&&(window.clearInterval(this.FTimerID),this.FTimerID=-1),null!=this.FOnClose&&this.FOnClose(this,{get:function(){return i},set:function(t){i=t}}),0!==i&&(null!=this.FLayer$1&&(this.GetContainer().parentNode===this.FLayer$1?this.FLayer$1.removeChild(this.GetContainer()):this.GetContainer().parentNode.parentNode===this.FLayer$1&&this.FLayer$1.removeChild(this.GetContainer().parentNode),this.FContainer=null,this.FormContainerElement()===this.FLayer$1.parentNode&&(this.FormContainerElement().removeChild(this.FLayer$1),t.Application.ChangeMaxZIndex(-1)),this.FLayer$1=null),""===this.FFormFileName?""!==this.FFormElement&&null!=this.GetContainer()?(this.GetContainer().innerHTML="",this.FContainer=null):null!=this.GetContainer()&&(this.FormContainerElement()===this.GetContainer().parentNode&&this.FormContainerElement().removeChild(this.GetContainer()),this.FContainer=null):""!==this.FFormElement&&(this.GetContainer().innerHTML="",this.FContainer=null),this.FFormElement!==this.FFormContainer&&""!==this.FFormElement&&null!=(s=document.getElementById(this.FFormElement))&&(s.innerHTML=""),this.DoClose({get:function(){return i},set:function(t){i=t}}),2!==i||3 in this.FComponentState||(e.ReleaseForm(this),t.Application.FMainForm===this&&(t.Application.FMainForm=null)),t.Application.FActiveForm=this.FPrevActiveForm,this.SetVisible(!1)))},this.IsMiletus=function(){var t=!1,e=null;e=this.$class.ClassType(),t=!1;do{if(null!=(e=e.$ancestor)&&"TMiletusForm"===e.$classname){t=!0;break}}while(null!=e&&"TForm"!==e.$classname);return t},this.SetBounds=function(t,e,i,s){4 in this.FComponentState?(this.Resize$1(),this.SetBoundsInt(t,e,i,s)):pas["WEBLib.Controls"].TControl.SetBounds.call(this,t,e,i,s)},this.Show$1=function(){var e=0,i=null;this.FCreating&&this.FPopup&&(t.Application.ChangeMaxZIndex(1),this.FCreating=!1,this.UpdateElement()),""===this.FFormFileName&&(null==this.GetContainer()?this.FPopup?(this.FContainer=this.CreateElement(),this.FPopupElement=this.GetContainer(),this.SetFormPos(),this.UpdateElement(),this.FLayer$1.appendChild(this.GetContainer())):(this.FContainer=this.CreateLayer(),this.GetContainer().style.setProperty(pas["WEBLib.Controls"].CSSBackground,pas["WEBLib.Graphics"].ColorToHTML(this.FColor)),document.body.appendChild(this.GetContainer())):this.FPopup?(this.SetFormPos(),this.FLayer$1.appendChild(this.GetContainer())):null!=this.FLayer$1?this.FLayer$1.appendChild(this.GetContainer()):document.body.appendChild(this.GetContainer()),this.FPopup&&(2===this.FBorder?(i=this.GetContainer().getBoundingClientRect(),this.FOrigWidth=Math.round(i.right-i.left),this.FOrigHeight=Math.round(i.bottom-i.top),this.FTimerID=window.setInterval(rtl.createSafeCallback(this,"HandleDoResize"),100)):(this.GetContainer().style.setProperty("resize",""),this.GetContainer().style.setProperty("overflow","")))),this.SetVisible(!0);for(var s=0,o=this.GetControlsCount()-1;s<=o;s++)e=s,0===this.GetControls(e).FTabOrder&&this.GetControls(e).FTabStop&&this.GetControls(e).SetFocus()},this.ShowModal=function(){return this.ShowModal$1(null)},this.ShowModal$1=function(e){return this.FNoHTML&&(this.FPrevActiveForm=t.Application.FActiveForm,t.Application.FActiveForm=this,t.Application.CreateNewForm(this,"")),0,this.FNoHTML=!1,this.FModalProc=e,this.SetModalResult(0),this.Show$1(),0},this.AddCSS=function(t,e){var i,s,o;i=t,s=e,(o=document.getElementById(i))?o.innerHTML=s:((o=document.createElement("style")).type="text/css",o.id=i,o.innerHTML=s,document.getElementsByTagName("head")[0].appendChild(o))},this.RemoveCSS=function(t){var e;null!=(e=document.getElementById(t))&&document.head.removeChild(e)},rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TForm",this.TCustomForm,(function(){rtl.addIntf(this,pas.System.IUnknown);var e=this.$rtti;e.addProperty("Align",2,pas["WEBLib.Controls"].$rtti.TAlign,"FAlign","SetAlign",{Default:pas["WEBLib.Controls"].TAlign.alNone}),e.addProperty("Caption",2,rtl.string,"FCaption","SetCaption"),e.addProperty("Color",2,pas["WEBLib.Graphics"].$rtti.TColor,"FColor","SetColor"),e.addProperty("CSSLibrary",0,t.$rtti.TCSSLibrary,"FCSSLibrary","FCSSLibrary",{Default:t.TCSSLibrary.cssNone}),e.addProperty("ElementClassName",2,pas["WEBLib.Controls"].$rtti.TElementClassName,"FElementClassName","SetElementClassName"),e.addProperty("ElementFont",2,pas["WEBLib.Controls"].$rtti.TElementFont,"FElementFont","SetElementFont",{Default:pas["WEBLib.Controls"].TElementFont.efProperty}),e.addProperty("ElementPosition",2,pas["WEBLib.Controls"].$rtti.TElementPosition,"FElementPosition","SetElementPosition",{Default:pas["WEBLib.Controls"].TElementPosition.epAbsolute}),e.addProperty("Font",2,pas["WEBLib.Graphics"].$rtti.TFont,"FFont","SetFont"),e.addProperty("FormContainer",2,pas["WEBLib.Controls"].$rtti.TElementID,"FFormContainer","SetFormContainer"),e.addProperty("FormStyle",3,t.$rtti.TFormStyle,"GetFormStyle","SetFormStyle"),e.addProperty("Menu",0,pas["WEBLib.Controls"].$rtti.TCustomControl,"FMenu","FMenu"),e.addProperty("ParentFont",2,rtl.boolean,"FParentFont","SetParentFont",{Default:!0}),e.addProperty("Shadow",2,rtl.boolean,"FShadow","SetShadow",{Default:!0}),e.addProperty("ShowClose",0,rtl.boolean,"FShowClose","FShowClose",{Default:!0}),e.addProperty("TabOrder",2,rtl.longint,"FTabOrder","SetTabOrder"),e.addProperty("TabStop",2,rtl.boolean,"FTabStop","SetTabStop",{Default:!0}),e.addProperty("OnBeforeUnload",0,t.$rtti.TBeforeUnloadEvent,"FOnBeforeUnload","FOnBeforeUnload"),e.addProperty("OnClick",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnClick","FOnClick"),e.addProperty("OnClose",0,t.$rtti.TCloseEvent,"FOnClose","FOnClose"),e.addProperty("OnCloseQuery",0,t.$rtti.TCloseQueryEvent,"FOnCloseQuery","FOnCloseQuery"),e.addProperty("OnCreate",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnCreate","FOnCreate"),e.addProperty("OnDblClick",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnDblClick","FOnDblClick"),e.addProperty("OnDeactivate",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnDeactivate","FOnDeactivate"),e.addProperty("OnDestroy",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnDestroy","FOnDestroy"),e.addProperty("OnDOMContentLoaded",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnDOMContentLoaded","FOnDOMContentLoaded"),e.addProperty("OnHashChange",0,t.$rtti.THashChangeEvent,"FOnHashChange","FOnHashChange"),e.addProperty("OnResize",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnResize","FOnResize"),e.addProperty("OnShow",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnShow","FOnShow"),e.addProperty("OnScroll",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnScroll","FOnScroll"),e.addProperty("OnOrientationChange",0,t.$rtti.TOrientationChangeEvent,"FOnOrientationChange","FOnOrientationChange"),e.addProperty("OnPaint",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnPaint","FOnPaint"),e.addProperty("OnTouchStart",0,pas["WEBLib.Controls"].$rtti.TTouchEvent,"FOnTouchStart","FOnTouchStart"),e.addProperty("OnTouchMove",0,pas["WEBLib.Controls"].$rtti.TTouchEvent,"FOnTouchMove","FOnTouchMove"),e.addProperty("OnTouchEnd",0,pas["WEBLib.Controls"].$rtti.TTouchEvent,"FOnTouchEnd","FOnTouchEnd"),e.addProperty("OnUnload",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnUnload","FOnUnload")})),rtl.createClass(this,"TCustomFrame",pas["WEBLib.Controls"].TCustomHTMLDiv,(function(){this.$init=function(){pas["WEBLib.Controls"].TCustomHTMLDiv.$init.call(this),this.FAutoScroll=!1,this.FAutoSize=!1,this.FBiDiMode$1=0,this.FConstraints=null,this.FCtl3D$1=!1,this.FDockSite=!1,this.FDragCursor=0,this.FDragKind=0,this.FDragMode$1=0,this.FOnAlignInsertBefore=null,this.FOnAlignPosition=null,this.FOnCanResize=null,this.FOnConstrainedResize=null,this.FOnContextPopup=null,this.FOnDockDrop=null,this.FOnDockOver=null,this.FOnEndDock=null,this.FOnGesture=null,this.FOnGetSiteInfo=null,this.FOnMouseActivate=null,this.FOnMouseWheelDown$1=null,this.FOnMouseWheelUp$1=null,this.FOnStartDock=null,this.FOnUnDock=null,this.FPadding=null,this.FParentBackground=!1,this.FParentCtl3D$1=!1,this.FPopupMenu=null},this.$final=function(){this.FConstraints=void 0,this.FOnAlignInsertBefore=void 0,this.FOnAlignPosition=void 0,this.FOnCanResize=void 0,this.FOnConstrainedResize=void 0,this.FOnContextPopup=void 0,this.FOnDockDrop=void 0,this.FOnDockOver=void 0,this.FOnEndDock=void 0,this.FOnGesture=void 0,this.FOnGetSiteInfo=void 0,this.FOnMouseActivate=void 0,this.FOnMouseWheelDown$1=void 0,this.FOnMouseWheelUp$1=void 0,this.FOnStartDock=void 0,this.FOnUnDock=void 0,this.FPadding=void 0,this.FPopupMenu=void 0,pas["WEBLib.Controls"].TCustomHTMLDiv.$final.call(this)},this.SetConstraints=function(t){this.FConstraints.Assign(t)},this.SetPopupMenu=function(t){this.FPopupMenu=t},this.LoadDFMValues=function(){},this.UpdateElement=function(){var t;pas["WEBLib.Controls"].TControl.UpdateElement.call(this),t=this.FColor in rtl.createSet(15790320,-1,16777215,16711422),null!=this.GetElementHandle()&&!this.IsUpdating()&&4 in this.FComponentState&&t&&this.GetElementHandle().style.setProperty("background-color",pas["WEBLib.Graphics"].ColorToHTML(15790320))},this.Create$1=function(e){return pas["WEBLib.Controls"].TControl.Create$1.call(this,e),this.FConstraints=t.TSizeConstraints.$create("Create$1",[this]),this},this.Destroy=function(){rtl.free(this,"FConstraints"),pas["WEBLib.Controls"].TCustomControl.Destroy.call(this)},this.LoadFromForm=function(){this.LoadDFMValues()},rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TFrame",this.TCustomFrame,(function(){rtl.addIntf(this,pas.System.IUnknown);var e=this.$rtti;e.addProperty("Align",2,pas["WEBLib.Controls"].$rtti.TAlign,"FAlign","SetAlign",{Default:pas["WEBLib.Controls"].TAlign.alNone}),e.addProperty("Anchors",2,pas["WEBLib.Controls"].$rtti.TAnchors,"FAnchors","SetAnchors",{Default:rtl.createSet(0,1)}),e.addProperty("AutoScroll",0,rtl.boolean,"FAutoScroll","FAutoScroll",{Default:!1}),e.addProperty("AutoSize",0,rtl.boolean,"FAutoSize","FAutoSize",{Default:!1}),e.addProperty("BiDiMode",4,pas["WEBLib.Controls"].$rtti.TBiDiMode,"FBiDiMode$1","FBiDiMode$1"),e.addProperty("Constraints",2,t.$rtti.TSizeConstraints,"FConstraints","SetConstraints"),e.addProperty("DockSite",0,rtl.boolean,"FDockSite","FDockSite",{Default:!1}),e.addProperty("DoubleBuffered",0,rtl.boolean,"FDoubleBuffered","FDoubleBuffered",{Default:!1}),e.addProperty("DragCursor",0,pas["WEBLib.Controls"].$rtti.TCursor,"FDragCursor","FDragCursor",{Default:12}),e.addProperty("DragKind",0,pas["WEBLib.Controls"].$rtti.TDragKind,"FDragKind","FDragKind",{Default:pas["WEBLib.Controls"].TDragKind.dkDrag}),e.addProperty("DragMode",0,pas["WEBLib.Controls"].$rtti.TDragMode,"FDragMode$1","FDragMode$1",{Default:pas["WEBLib.Controls"].TDragMode.dmManual}),e.addProperty("Enabled",2,rtl.boolean,"FEnabled","SetEnabled",{Default:!0}),e.addProperty("Color",2,pas["WEBLib.Graphics"].$rtti.TColor,"FColor","SetColor"),e.addProperty("Ctl3D",4,rtl.boolean,"FCtl3D$1","FCtl3D$1"),e.addProperty("Font",2,pas["WEBLib.Graphics"].$rtti.TFont,"FFont","SetFont"),e.addProperty("Padding",0,pas["WEBLib.Controls"].$rtti.TPadding,"FPadding","FPadding"),e.addProperty("ParentBackground",0,rtl.boolean,"FParentBackground","FParentBackground",{Default:!0}),e.addProperty("ParentBiDiMode",0,rtl.boolean,"FParentBiDiMode","FParentBiDiMode",{Default:!0}),e.addProperty("ParentColor",2,rtl.boolean,"FParentColor","SetParentColor",{Default:!1}),e.addProperty("ParentCtl3D",0,rtl.boolean,"FParentCtl3D$1","FParentCtl3D$1",{Default:!0}),e.addProperty("ParentDoubleBuffered",0,rtl.boolean,"FParentDoubleBuffered","FParentDoubleBuffered",{Default:!0}),e.addProperty("ParentFont",2,rtl.boolean,"FParentFont","SetParentFont",{Default:!0}),e.addProperty("ParentShowHint",0,rtl.boolean,"FParentShowHint","FParentShowHint"),e.addProperty("PopupMenu",2,pas["WEBLib.Menus"].$rtti.TPopupMenu,"FPopupMenu","SetPopupMenu"),e.addProperty("ShowHint",2,rtl.boolean,"FShowHint","SetShowHint",{Default:!1}),e.addProperty("TabOrder",2,rtl.longint,"FTabOrder","SetTabOrder"),e.addProperty("TabStop",2,rtl.boolean,"FTabStop","SetTabStop",{Default:!0}),e.addProperty("Visible",2,rtl.boolean,"FVisible","SetVisible",{Default:!0}),e.addProperty("OnAlignInsertBefore",0,t.$rtti.TAlignInsertBeforeEvent,"FOnAlignInsertBefore","FOnAlignInsertBefore"),e.addProperty("OnAlignPosition",0,t.$rtti.TAlignPositionEvent,"FOnAlignPosition","FOnAlignPosition"),e.addProperty("OnCanResize",0,t.$rtti.TCanResizeEvent,"FOnCanResize","FOnCanResize"),e.addProperty("OnClick",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnClick","FOnClick"),e.addProperty("OnConstrainedResize",0,t.$rtti.TConstrainedResizeEvent,"FOnConstrainedResize","FOnConstrainedResize"),e.addProperty("OnContextPopup",0,t.$rtti.TContextPopupEvent,"FOnContextPopup","FOnContextPopup"),e.addProperty("OnDblClick",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnDblClick","FOnDblClick"),e.addProperty("OnDockDrop",0,t.$rtti.TDockDropEvent,"FOnDockDrop","FOnDockDrop"),e.addProperty("OnDockOver",0,t.$rtti.TDockOverEvent,"FOnDockOver","FOnDockOver"),e.addProperty("OnDragDrop",0,pas["WEBLib.Controls"].$rtti.TDragDropEvent,"FOnDragDrop","FOnDragDrop"),e.addProperty("OnDragOver",0,pas["WEBLib.Controls"].$rtti.TDragOverEvent,"FOnDragOver","FOnDragOver"),e.addProperty("OnEndDock",0,pas["WEBLib.Controls"].$rtti.TEndDragEvent,"FOnEndDock","FOnEndDock"),e.addProperty("OnEndDrag",0,pas["WEBLib.Controls"].$rtti.TEndDragEvent,"FonEndDrag","FonEndDrag"),e.addProperty("OnEnter",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnEnter","FOnEnter"),e.addProperty("OnExit",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnExit","FOnExit"),e.addProperty("OnGesture",0,t.$rtti.TGestureEvent,"FOnGesture","FOnGesture"),e.addProperty("OnGetSiteInfo",0,t.$rtti.TGetSiteInfoEvent,"FOnGetSiteInfo","FOnGetSiteInfo"),e.addProperty("OnMouseActivate",0,t.$rtti.TMouseActivateEvent,"FOnMouseActivate","FOnMouseActivate"),e.addProperty("OnMouseDown",0,pas["WEBLib.Controls"].$rtti.TMouseEvent,"FOnMouseDown","FOnMouseDown"),e.addProperty("OnMouseEnter",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnMouseEnter","FOnMouseEnter"),e.addProperty("OnMouseLeave",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnMouseLeave","FOnMouseLeave"),e.addProperty("OnMouseMove",0,pas["WEBLib.Controls"].$rtti.TMouseMoveEvent,"FOnMouseMove","FOnMouseMove"),e.addProperty("OnMouseUp",0,pas["WEBLib.Controls"].$rtti.TMouseEvent,"FOnMouseUp","FOnMouseUp"),e.addProperty("OnMouseWheel",0,pas["WEBLib.Controls"].$rtti.TMouseWheelEvent,"FOnMouseWheel","FOnMouseWheel"),e.addProperty("OnMouseWheelDown",0,t.$rtti.TMouseWheelUpDownEvent,"FOnMouseWheelDown$1","FOnMouseWheelDown$1"),e.addProperty("OnMouseWheelUp",0,t.$rtti.TMouseWheelUpDownEvent,"FOnMouseWheelUp$1","FOnMouseWheelUp$1"),e.addProperty("OnResize",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnResize","FOnResize"),e.addProperty("OnStartDock",0,t.$rtti.TStartDockEvent,"FOnStartDock","FOnStartDock"),e.addProperty("OnStartDrag",0,pas["WEBLib.Controls"].$rtti.TStartDragEvent,"FOnStartDrag","FOnStartDrag"),e.addProperty("OnUnDock",0,t.$rtti.TUnDockEvent,"FOnUnDock","FOnUnDock")})),rtl.recNewT(this,"TApplicationError",(function(){this.AMessage="",this.AFile="",this.ALineNumber=0,this.AColNumber=0,this.AStack="",this.AError=null,this.$eq=function(t){return this.AMessage===t.AMessage&&this.AFile===t.AFile&&this.ALineNumber===t.ALineNumber&&this.AColNumber===t.AColNumber&&this.AStack===t.AStack&&this.AError===t.AError},this.$assign=function(t){return this.AMessage=t.AMessage,this.AFile=t.AFile,this.ALineNumber=t.ALineNumber,this.AColNumber=t.AColNumber,this.AStack=t.AStack,this.AError=t.AError,this}})),this.THintPosition={0:"hpLeft",hpLeft:0,1:"hpTop",hpTop:1,2:"hpRight",hpRight:2,3:"hpBottom",hpBottom:3},this.TOnlineStatus={0:"osOnline",osOnline:0,1:"osOffline",osOffline:1},rtl.createClass(this,"TApplication",pas["WEBLib.Controls"].TControl,(function(){this.$init=function(){pas["WEBLib.Controls"].TControl.$init.call(this),this.FAppContainer="",this.FMainFormOnTaskBar=!1,this.FCanCreateForm=!1,this.FAppInitializing=!1,this.FLastReq=null,this.FFormCaptionHeight=0,this.FActiveForm=null,this.FMainForm=null,this.FLoadForm=null,this.FInitFormClassName="",this.FFormStack=null,this.FParameters=null,this.FIsRedirect=!1,this.FLanguage=0,this.FOnImageCacheReady=null,this.FOnError=null,this.FOnHashChange=null,this.FAutoFormRoute=!1,this.FErrorType=0,this.FOnOnlineChange=null,this.FOnActivate=null,this.FThemeTextColor=0,this.FThemeColor=0,this.FThemed=!1,this.FThemeButtonClassName="",this.FOnOAuthToken=null,this.FOnOAuthCallBack=null,this.FMaxZIndex=0,this.FCreatedProc=null,this.FHintPause=0,this.FHintHidePause=0,this.FHintPosition=0,this.FHintClassName="",this.FOnExit$1=null,this.FOnException=null},this.$final=function(){this.FLastReq=void 0,this.FActiveForm=void 0,this.FMainForm=void 0,this.FLoadForm=void 0,this.FFormStack=void 0,this.FParameters=void 0,this.FOnImageCacheReady=void 0,this.FOnError=void 0,this.FOnHashChange=void 0,this.FOnOnlineChange=void 0,this.FOnActivate=void 0,this.FOnOAuthToken=void 0,this.FOnOAuthCallBack=void 0,this.FCreatedProc=void 0,this.FOnExit$1=void 0,this.FOnException=void 0,pas["WEBLib.Controls"].TControl.$final.call(this)},this.DoFormLoad=function(t){var e;return e=t.target.responseText,this.CreateNewForm(this.FLoadForm,e),null!=this.FCreatedProc&&(this.FCreatedProc(this),this.FCreatedProc=null),!0,!0},this.DoFormAbort=function(t){return pas["WEBLib.Dialogs"].ShowMessage("Failed to load form HTML template file"),!0,!0},this.DoHandleError=function(e){var i,s=!1,o=t.TApplicationError.$new(),n=null,r=null,a=null,l="",h=!1,F=void 0,p=null;if(h=!0,null==e.message&&(h=!1),"ResizeObserver loop limit exceeded"===e.message)return s;if(!h)return o.AMessage="Undefined JavaScript exception",o.AFile="",o.ALineNumber=0,o.AColNumber=0,o.AError=null,null!=this.FOnError&&this.FOnError(this,t.TApplicationError.$clone(o),{get:function(){return s},set:function(t){s=t}}),s;if(o.AMessage=e.message,o.AFile=e.filename,o.ALineNumber=e.lineno,o.AColNumber=e.colno,o.AError=e.error,o.AStack="",l="",F=null,null!=e.error){e.error.stack&&(o.AStack=e.error.stack),e.error.fMessage&&(o.AMessage=e.error.fMessage),e.error.hasOwnProperty("FJSError")&&(F=e.error.FJSError),l=function(t){var e="";for(var i in t)t.hasOwnProperty(i)&&(e+=i+"::"+t[i]+"\n");return e}(e.error)}pas.System.Assigned(F)&&(p=e.error,null!=this.FOnException&&this.FOnException(this,p)),s=!1,i="ERROR<br>"+o.AMessage+" | "+l+o.AStack+"<BR> at "+o.AFile+" ["+pas.SysUtils.IntToStr(o.ALineNumber)+":"+pas.SysUtils.IntToStr(o.AColNumber)+"]";var c=this.FErrorType;return 3===c?null!=(n=document.getElementById("tmserrormessage"))?rtl.asExt(n.firstChild,HTMLElement).innerHTML=i:((n=document.createElement("DIV")).setAttribute("id","tmserrormessage"),n.style.setProperty("position","absolute"),n.style.setProperty("font-family","Courier"),n.style.setProperty("font-size","8pt"),n.style.setProperty("bottom","0"),n.style.setProperty("width","100%"),n.style.setProperty("height","100px"),n.style.setProperty("background","#ff0000"),n.style.setProperty("color","#ffffff"),document.body.style.setProperty("padding","0"),document.body.style.setProperty("margin","0"),(r=document.createElement("SPAN")).style.setProperty("margin-left","4px"),r.style.setProperty("float","left"),r.style.setProperty("overflow","hidden"),r.style.setProperty("display","block"),r.innerHTML=i,n.appendChild(r),(a=document.createElement("SPAN")).style.setProperty("font-family","Courier"),a.style.setProperty("font-size","8pt"),a.style.setProperty("font-weight","bold"),a.style.setProperty("position","absolute"),a.style.setProperty("width","20px"),a.style.setProperty("vertical-align","top"),a.style.setProperty("cursor","pointer"),a.style.setProperty("text-align","right"),a.style.setProperty("right","4px"),a.style.setProperty("display","block"),a.innerHTML="X",a.onclick=rtl.createSafeCallback(this,"DoErrorClose"),n.appendChild(a),document.body.appendChild(n)):2===c?window.alert(i):1===c&&(this.AddControlLink("googlematerial","https://fonts.googleapis.com/icon?family=Material+Icons"),pas["WEBLib.Dialogs"].MessageDlg(i,1,rtl.createSet(2),null)),null!=this.FOnError&&this.FOnError(this,t.TApplicationError.$clone(o),{get:function(){return s},set:function(t){s=t}}),s},this.DoHandleExit=function(t){return!0,null!=this.FOnExit$1&&this.FOnExit$1(this),!0},this.DoHashChange=function(t){var e="",i=null,s=null,o=null,n=!1;return!0,!this.FAutoFormRoute||(e=location.hash,pas.System.Delete({get:function(){return e},set:function(t){e=t}},1,1),n=!1,null!=this.FOnHashChange&&this.FOnHashChange(this,e,{get:function(){return n},set:function(t){n=t}}),n||(""===e&&(e=this.FInitFormClassName),""!==e&&(""===this.FInitFormClassName&&(this.FInitFormClassName=this.FActiveForm.$classname),null!=(i=pas.Classes.GetClass(e))&&(o=document.body,this.CreateForm$6(i,o,{get:function(){return s},set:function(t){s=t}})))),!0)},this.DoErrorClose=function(t){return document.body.removeChild(t.target.parentElement),!0,!0},this.DoUpdateOnlineStatus=function(t){return!0,null!=this.FOnOnlineChange&&(window.navigator.onLine?this.FOnOnlineChange(this,0):this.FOnOnlineChange(this,1)),!0},this.DoVisibilityChange=function(t){var e;return!0,e="visible"===document.visibilityState,null!=this.FOnActivate&&this.FOnActivate(this,e),!0},this.CreateNewForm=function(e,i){var s=null,o=null,n=null,r=null,a=null,l=0,h=0,F=0,p=0,c=null,u=null,C=0,T=null;if(null===this.FMainForm&&(this.FMainForm=e),n=null,a=null,C=0,e.FPopup||""===e.FFormElement){if(e.ClearControls(),e.FLayer$1=e.CreateLayer(),document.body.appendChild(e.FLayer$1),s=e.FLayer$1,e.FPopup&&e.FPopupOpacity<1&&((o=e.CreateLayer()).style.setProperty(pas["WEBLib.Controls"].CSSBackground,"black"),o.style.setProperty("opacity",pas["WEBLib.WebTools"].DoubleToHTML(e.FPopupOpacity)),o.style.setProperty(pas["WEBLib.Controls"].CSSZIndex,t.Application.MaxZIndexStr()),s.appendChild(o)),t.Application.ChangeMaxZIndex(1),(n=document.createElement("DIV")).style.setProperty(pas["WEBLib.Controls"].CSSZIndex,t.Application.MaxZIndexStr()),e.FPopupElement=n,4===e.FBorder){n.style.setProperty("resize","both"),n.style.setProperty("overflow","auto"),T=null;try{var S=e;(T=new ResizeObserver((function(t){window.requestAnimationFrame(()=>{Array.isArray(t)&&t.length&&t.forEach((function(t){S.HandleObserver()}))})}))).observe(n)}catch(t){n.style.removeProperty("resize"),n.style.removeProperty("overflow")}e.FResizeObserver=T}""!==e.FElementClassName&&n.setAttribute("class",e.FElementClassName),e.FShadow&&e.FPopup&&n.style.setProperty("box-shadow","3px 3px 3px silver"),s.appendChild(n),e.FBorder in rtl.createSet(3,4)?(e.GetMethodPointers(),u=e.CreateCaption(),n.appendChild(u),(r=document.createElement("DIV")).style.setProperty("position","absolute"),r.style.setProperty("width","100%"),r.setAttribute("id","childspan"),n.appendChild(r),a=r,C=t.Application.FFormCaptionHeight):a=n,a.innerHTML=i,e.FContainer=a}else e.FLayer$1=null,null!=(s=document.getElementById(e.FFormElement))&&(s.innerHTML=i,""===e.FElementClassName&&s.style.setProperty(pas["WEBLib.Controls"].CSSBackground,pas["WEBLib.Graphics"].ColorToHTML(e.FColor)));e.Init(),e.LoadDFMValues(),e.FBorder in rtl.createSet(3,4)&&""!==e.FElementCaptionClassName&&(u.classList.add(e.FElementCaptionClassName),u.style.removeProperty("background-color"),u.style.removeProperty("color")),null!=e.FLayer$1&&(e.FPopup||(""===e.FElementClassName?-1!==e.FColor?s.style.setProperty(pas["WEBLib.Controls"].CSSBackground,pas["WEBLib.Graphics"].ColorToHTML(e.FColor)):s.style.setProperty(pas["WEBLib.Controls"].CSSBackground,"white"):s.setAttribute("class",e.FElementClassName))),null!=n&&""===e.FFormContainer&&e.FPopup&&(n.style.setProperty("position","absolute"),l=Math.max(0,Math.round((t.WinWidth()-e.GetWidth())/2))+window.scrollX,h=Math.max(0,Math.round((t.WinHeight()-e.GetHeight())/2))+window.scrollY,F=e.GetWidth(),p=e.GetHeight()+C,""===e.FElementClassName&&(n.style.setProperty(pas["WEBLib.Controls"].CSSBackground,pas["WEBLib.Graphics"].ColorToHTML(e.FColor)),n.style.setProperty("border","1px Black solid")),n.style.setProperty("top",pas.SysUtils.IntToStr(h)+"px"),n.style.setProperty("left",pas.SysUtils.IntToStr(l)+"px"),n.style.setProperty("width",pas.SysUtils.IntToStr(F)+"px"),n.style.setProperty("height",pas.SysUtils.IntToStr(p)+"px")),null!=a&&this.ActivateChildScripts(a),null!=e.FCreatedProc&&(c=e.FCreatedProc,e.FCreatedProc=null,c(e)),null!=e.FOnCreate&&e.FOnCreate(e),e.Loaded(),e.InitAnchoring(),e.UpdateChildAnchoring(),e.FCreating=!1,e.UpdateElement(),e.EventsBound()||e.BindEvents(),e.Resize$1(),e.DoShow()},this.GetFormExtension=function(){return 0!==this.FLanguage?"_"+pas["WEBLib.Lang"].GetLanguageISO639_1Code(this.FLanguage)+pas["WEBLib.WebTools"].cHTMLExt:pas["WEBLib.WebTools"].cHTMLExt};this.GetAuthorizationPageHTML=function(t){function e(t,e){var i=0,s="";s='<!doctype html>\r\n<html lang="en">\r\n<head>\r\n  <title>Authentication Result</title>\r\n  <meta name="viewport" content="width=device-width, initial-scale=1">\r\n</head>\r\n<body>\r\n<style>\r\n  hr\r\n  {\r\n    border: none;\r\n    height: 1px;\r\n    background-color: rgb(171, 171, 171);\r\n  }\r\n  div.container\r\n  {\r\n    position: fixed;\r\n    font-family: Arial;\r\n    font-size: 12pt;\r\n    max-width: 100%;\r\n    max-height: 100%;\r\n    top: 50%;\r\n    left: 50%;\r\n    transform: translate(-50%, -50%);\r\n  }\r\n  div.section\r\n  {\r\n    display: inline-block;\r\n    margin: 15px;\r\n    padding: 5px;\r\n    float: left;\r\n  }\r\n  div.image img\r\n  {\r\n    height: 100%;\r\n  }\r\n  div.text\r\n  {\r\n    padding-top: 15px;\r\n  }\r\n  div.text2\r\n  {\r\n    font-size: 18pt;\r\n    color: #PLACEHOLDERCOLOR#;\r\n  }\r\n  span.title\r\n  {\r\n    font-size: 26px;\r\n  }\r\n</style>\r\n  <div class="container">\r\n  <div class="section image">\r\n    <img src="#PLACEHOLDERIMAGE#">\r\n  </div>\r\n  <div class="section text">\r\n  #PLACEHOLDERTEXT#\r\n  </div>\r\n  </div>\r\n </body>\r\n</html>';for(var o=0,n=rtl.length(t)-1;o<=n;o++)i=o,s=pas.SysUtils.StringReplace(s,t[i],e[i],rtl.createSet(0));return s}return e(["#PLACEHOLDERIMAGE#","#PLACEHOLDERTEXT#","#PLACEHOLDERCOLOR#"],t?["data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAACXBIWXMAAA7DAAAOwwHHb6hkAAACC0lEQVR4nO2Zv3GDMBSHv+QyQEbICM4EOW+Q9BS4o2QTU9LZBQNkg6zgETyCR0iRkOMIAv3Xk0+/zsiI931nI3iCkpKSkpKSkpKSkpJ7SDN0x2bo3nW//xCymNhphu4E1MAN2PdVe9k6524ETODHXIHXvmpva+c9BqwpWhbgAV6Ar61zsxeggB+z+x1XJmsBG/Bj6mboWtVgtvcATfhpPvqq/ZwfzFKABTwoVobsBFjCj7kyWxmyugc4wsPCypCNAA/wY/L7C3iEP/dVe5geEC8gJDwIFxAaHgQLiAEPQgXEggeBAmLCgzABseFBkIAU8CBEQCp4ECAgJTwYChibCzYXWpmv9jCVFTwYCJgVa31BxXwucapFS4CiWOsLS4EHDQEbxRoXIAkeNgRoFqtdiDR4WBFgWOxmQRLhQdEQsSi2bobuqBqUCg8LvwDHYg991Z49zjeNd3iYCfBU7J8E6fAAT7PPOw9znpqhA3hDODz8F7Dnp2vqKmJ1O8ogQeFh+R7wjB8JrgkOD4plUICEKPCw/hyQSkI0eNh+EowtISo86L0LxJIQHR703wZDS0gCD2b9gFASksGDeUfIt4Sk8GDRE/QoITk8WDZFPUgQAQ8OXWEHCWLgwbEtbiFBFDx42BcwkCAOHjxtjGhIEAkPHneGViSIhQfPW2MLEkTDQ4C9wYmEi3T4kpKSkm+5ax+YhPsUTQAAAABJRU5ErkJggg==",'<div class="text2">Application succesfully authorized</div>You can close this browser window',"rgb(104, 164, 144)"]:["data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABtElEQVR4nO2bUY7CMAxEhz0NB+EgrDjXCg6yB+E4+9NKCAiN7XHcjf1+ED+Z6ahNHScFiqIoBNwvp+v9crpG+3hG6+sgFQFwXv7ejj+/31JBDyy+ugN4ElkJD8HqqyuAhohYjA3D12YAGyIiMSYsXx8D6BTpFmPB9NUMQCjSJcaA7ettAEqRTTErHr5eAjCKfBSz4OXryzhgizOzWCJd/Fs8HoFHzHeCtxf2JNgt3MMID8zXoMpAtDarEDIbidJklMJUQ6MDty6GNDSNRdxtluWwhReDUfONKADAx2jkZCsOAOAaXn4pY2let6oAAN/qTIG61lAHAOwmBFO1aQoACA/BXGqbAwDCQqCsOCkBAMNDoC23aQEAw0Kg9hqoAQDuIdAbLfQAALcQXFptLgEA9BDc+oxeLbF/Qz0C7AFTT4KpX4OpC6HUpXDqxVDq5fBOLn5lbEMkdUssdVM0dVs89cZI6q2x1JujqbfHUx+Q2MPFj/LidUqsKajB05NXS4y6Zl/GurHGe6QOSpLF5jgqqxSb67C0UGzO4/KdYnN/MLEhluOTmYZY+MWvDPU122dzRVHk5g+X6Lw5aVkK9AAAAABJRU5ErkJggg==",'<div class="text2">Application authorization failed</div><br/>Please try again.',"rgb(216, 99, 68)"])},this.GetColorScheme=function(){var t=0;return t=0,"not all"!==window.matchMedia("(prefers-color-scheme)").media&&(t=window.matchMedia("(prefers-color-scheme: dark)").matches?2:1),t},this.ActivateChildScripts=function(t){!function t(e){if(!0===function(t){return"SCRIPT"===t.tagName}(e))e.parentNode.replaceChild(function(t){var e=document.createElement("script");e.async=!1,e.text=t.innerHTML;for(var i=t.attributes.length-1;i>=0;i--)e.setAttribute(t.attributes[i].name,t.attributes[i].value);return e}(e),e);else for(var i=0,s=e.childNodes;i<s.length;)t(s[i++]);return e}(t)},this.ChangeMaxZIndex=function(t){this.FMaxZIndex=this.FMaxZIndex+t},this.TriggerNotification=function(){},this.LockForm=function(t){for(var e=0,i=0,s=t.GetControlsCount()-1;i<=s;i++)e=i,t.GetControls(e).DisableTab()},this.UnLockForm=function(t){for(var e=0,i=0,s=t.GetControlsCount()-1;i<=s;i++)e=i,t.GetControls(e).EnableTab()},this.Create$1=function(t){return this.FFormStack=pas.Classes.TList.$create("Create$1"),this.FParameters=pas.Classes.TStringList.$create("Create$1"),this.FAppContainer=pas["WEBLib.WebTools"].cBodyTag,this.FMainForm=null,this.FActiveForm=null,this.FInitFormClassName="",this.FIsRedirect=!1,this.FAutoFormRoute=!1,this.FThemed=!1,this.FThemeColor=14917120,this.FThemeTextColor=16777215,this.FFormCaptionHeight=22,this.FMaxZIndex=999998,this.FHintPause=200,this.FHintHidePause=250,this.FHintPosition=1,this.FHintClassName="",window.addEventListener("error",rtl.createCallback(this,"DoHandleError")),window.addEventListener("unhandledrejection",rtl.createCallback(this,"DoHandleError")),window.addEventListener("beforeunload",rtl.createSafeCallback(this,"DoHandleExit")),this.FErrorType=0,this},this.Destroy=function(){rtl.free(this,"FFormStack"),rtl.free(this,"FParameters"),pas["WEBLib.Controls"].TControl.Destroy.call(this)},this.MaxZIndexStr=function(){return pas.SysUtils.IntToStr(this.FMaxZIndex)},this.CreateForm=function(t,e){this.CreateForm$2(t,this.FAppContainer,e,null)},this.CreateForm$2=function(t,e,i,s){this.CreateForm$3(t,e,i,s,!0)},this.CreateForm$3=function(e,i,s,o,n){var r=this,a="";function l(n){var l,h=null,F=null,p="",c=!1;return(l=null!=n)?(p=n.target.responseText,(h=(c=pas.SysUtils.LowerCase(i)===pas["WEBLib.WebTools"].cBodyTag)?document.body:document.getElementById(i)).innerHTML=p):h=document.body,(F=e.$create("Create$5",[i,s])).FFormFileName=a,""===F.FFormContainer&&F.SetFormContainer(i),c||(F.FFormElement=i,F.FContainer=h),F.CreateControl(),F.Init(),F.SetColorScheme(t.Application.GetColorScheme()),F.FPrevActiveForm=r.FActiveForm,r.FActiveForm=F,null===r.FMainForm&&(r.FMainForm=F),null!=o&&o(F),!0,l&&r.ActivateChildScripts(h),r.FActiveForm.DoShow(),r.FActiveForm.Resize$1(),!0}if(!this.FIsRedirect){if(this.FAppInitializing){if(!this.FCanCreateForm)return;this.FCanCreateForm=!1}""!==(a=e.GetHTMLFileName())&&n?(this.FLastReq=new XMLHttpRequest,this.FLastReq.addEventListener("load",rtl.createSafeCallback(null,l)),this.FLastReq.open("GET",a),this.FLastReq.send()):l(null)}},this.CreateForm$4=function(t,e){var i;i=t.$create("Create$1",[this]),e.set(i)},this.CreateForm$6=function(t,e,i){this.CreateForm$2(t,e.id,i,null)},this.CreateFormDirect$1=function(t,e){this.CreateForm$4(t,e)},this.LoadForm=function(t,e){t.FPrevActiveForm=this.FActiveForm,this.FActiveForm=t,this.FLoadForm=t,null===this.FMainForm&&(this.FMainForm=t),this.FLastReq=new XMLHttpRequest,this.FLastReq.addEventListener("load",rtl.createSafeCallback(this,"DoFormLoad")),this.FLastReq.addEventListener("abort",rtl.createSafeCallback(this,"DoFormAbort")),this.FLastReq.open("GET",e),this.FLastReq.send()},this.LoadForm$1=function(t,e,i){this.FCreatedProc=i,this.LoadForm(t,e)},this.HasCSS=function(t){var e=!1,i=null,s=0,o="";e=!1;for(var n=0,r=(i=document.querySelectorAll("head > link")).length-1;n<=r;n++)if(s=n,o=i.item(s).href,0===pas.SysUtils.CompareText(o,t)){e=!0;break}return e},this.Initialize=function(){var t,e,i="",s="";if(this.FCanCreateForm=!0,this.FAppInitializing=!0,this.FParameters.Clear(),i=window.location.href,this.InitFormatSettings(pas["WEBLib.WebTools"].GetBrowserLocale()),this.FParameters.SetDelimiter("&"),this.FParameters.FStrictDelimiter=!0,(t=pas.System.Pos("?",i))>0&&(i=pas.System.Copy(i,t+1,i.length)),this.FParameters.SetDelimitedText(i),e="Authentication"==window.name,null!=this.FOnOAuthCallBack&&(-1!==this.FParameters.IndexOfName("oauthcallback")||e))return this.FOnOAuthCallBack(this,i),this.FIsRedirect=!0,void(document.body.innerHTML=this.GetAuthorizationPageHTML(!0));null!=this.FOnOAuthToken&&-1!==this.FParameters.IndexOfName("code")&&(this.FOnOAuthToken(this,i),this.FIsRedirect=!0,s=this.FParameters.GetValue("code"),window.opener&&window.opener.processAuthData&&(window.opener.processAuthData(s),window.close())),window.addEventListener("hashchange",rtl.createSafeCallback(this,"DoHashChange")),window.addEventListener("online",rtl.createSafeCallback(this,"DoUpdateOnlineStatus")),window.addEventListener("offline",rtl.createSafeCallback(this,"DoUpdateOnlineStatus")),document.addEventListener("visibilitychange",rtl.createSafeCallback(this,"DoVisibilityChange")),null!==window.opener&&-1!==this.FParameters.IndexOfName("access_token")&&(this.FIsRedirect=!0,s=this.FParameters.GetValue("access_token"),window.opener&&window.opener.processAuthData&&(window.opener.processAuthData(s),window.close()))},this.InitFormatSettings=function(t){var e,i,s=0;i=t,pas.SysUtils.FormatSettings.ShortDateFormat=pas["WEBLib.WebTools"].GetLocaleShortDateFormat(i),pas.System.Pos("/",pas.SysUtils.FormatSettings.ShortDateFormat)>0&&(pas.SysUtils.FormatSettings.DateSeparator="/"),pas.System.Pos(".",pas.SysUtils.FormatSettings.ShortDateFormat)>0&&(pas.SysUtils.FormatSettings.DateSeparator="."),pas.System.Pos("-",pas.SysUtils.FormatSettings.ShortDateFormat)>0&&(pas.SysUtils.FormatSettings.DateSeparator="-");var o=new Date("Jan 1, 1980 06:07:08 GMT+00:00"),n="";for(n=""==i?navigator.language:i,e=o.toLocaleTimeString(n),pas.System.Pos(":",e)>0&&(pas.SysUtils.FormatSettings.TimeSeparator=":"),pas.System.Pos(".",e)>0&&(pas.SysUtils.FormatSettings.TimeSeparator="."),pas.System.Pos("-",e)>0&&(pas.SysUtils.FormatSettings.TimeSeparator="-"),s=1;s<=7;s++)pas.SysUtils.FormatSettings.ShortDayNames[s-1]=pas["WEBLib.WebTools"].GetLocaleShortDayName(s,i),pas.SysUtils.FormatSettings.LongDayNames[s-1]=pas["WEBLib.WebTools"].GetLocaleLongDayName(s,i);for(s=1;s<=12;s++)pas.SysUtils.FormatSettings.ShortMonthNames[s-1]=pas["WEBLib.WebTools"].GetLocaleShortMonthName(s,i),pas.SysUtils.FormatSettings.LongMonthNames[s-1]=pas["WEBLib.WebTools"].GetLocaleLongMonthName(s,i);pas.SysUtils.FormatSettings.DecimalSeparator=pas["WEBLib.WebTools"].GetLocaleDecimalSeparator(""),"."===pas.SysUtils.FormatSettings.DecimalSeparator?pas.SysUtils.FormatSettings.ThousandSeparator=",":pas.SysUtils.FormatSettings.ThousandSeparator="."},this.Run=function(){this.FCanCreateForm=!0,this.FAppInitializing=!1},rtl.addIntf(this,pas.System.IUnknown)})),this.GetParentForm=function(e){var i=null,s=null;for(i=null,s=e;null!=s&&!t.TCustomForm.isPrototypeOf(s);)s=s===e&&null===s.FOwner?e.FParent:s.FOwner;return null!=s&&t.TCustomForm.isPrototypeOf(s)&&(i=rtl.as(s,t.TCustomForm)),i},this.WinWidth=function(){return null!=t.VSIDE?pas["WEBLib.Forms"].VSIDE.clientWidth():window.innerWidth},this.WinHeight=function(){return null!=t.VSIDE?pas["WEBLib.Forms"].VSIDE.clientHeight():window.innerHeight},this.Application=null,this.HandShakeScript=null,this.VSIDE=null,t.$implcode=function(){e.ReleaseForm=function(t){t=rtl.freeLoc(t),t=null}},t.$init=function(){t.HandShakeScript=document.createElement("script"),t.HandShakeScript.id="HandShakeScript",t.HandShakeScript.type="text/javascript",t.HandShakeScript.innerHTML='var IDE = null;\r\nvar TMSWEBCoreClientIdentifier = "unknown";\r\nvar TMSWEBCoreOAuthCallback = "unknown";\r\nfunction HandShake(cid){\r\n  TMSWEBCoreClientIdentifier = cid;\r\n}',document.body.appendChild(t.HandShakeScript),t.Application=t.TApplication.$create("Create$1",[null])}}),["WEBLib.Dialogs","WEBLib.WebTools","WEBLib.JSON","WEBLib.Utils","Math"]),rtl.module("DateUtils",["System","SysUtils","Math"],(function(){"use strict";var t=this,e=t.$impl;this.OneMillisecond=1/864e5,this.RecodeLeaveFieldAsIs=65535,this.DaysInMonth=function(t){var e=0,i=0,s=0;return pas.SysUtils.DecodeDate(t,{get:function(){return e},set:function(t){e=t}},{get:function(){return i},set:function(t){i=t}},{get:function(){return s},set:function(t){s=t}}),pas.SysUtils.MonthDays[+pas.SysUtils.IsLeapYear(e)][i-1]},this.DaysInAMonth=function(t,e){return pas.SysUtils.MonthDays[+pas.SysUtils.IsLeapYear(t)][e-1]},this.YearOf=function(t){var e=0,i=0,s=0;return pas.SysUtils.DecodeDate(t,{get:function(){return e},set:function(t){e=t}},{get:function(){return i},set:function(t){i=t}},{get:function(){return s},set:function(t){s=t}}),e},this.MonthOf=function(t){var e=0,i=0,s=0;return pas.SysUtils.DecodeDate(t,{get:function(){return i},set:function(t){i=t}},{get:function(){return e},set:function(t){e=t}},{get:function(){return s},set:function(t){s=t}}),e},this.WeekOf=function(e){return t.WeekOfTheYear(e)},this.DayOf=function(t){var e=0,i=0,s=0;return pas.SysUtils.DecodeDate(t,{get:function(){return i},set:function(t){i=t}},{get:function(){return s},set:function(t){s=t}},{get:function(){return e},set:function(t){e=t}}),e},this.StartOfAYear=function(t){return pas.SysUtils.EncodeDate(t,1,1)},this.WeekOfTheYear=function(e){var i=0,s=0,o=0;return t.DecodeDateWeek(e,{get:function(){return s},set:function(t){s=t}},{get:function(){return i},set:function(t){i=t}},{get:function(){return o},set:function(t){o=t}}),i},this.DayOfTheWeek=function(t){return e.DOWMap[pas.SysUtils.DayOfWeek(t)-1]},this.DaysBetween=function(t,i){return pas.System.Trunc(Math.abs(e.DateTimeDiff(t,i))+5.787037037037037e-9)},this.MilliSecondsBetween=function(t,i){return pas.System.Trunc(864e5*(Math.abs(e.DateTimeDiff(t,i))+5.787037037037037e-9))},this.IncYear=function(e,i){var s=0,o=0,n=0,r=0,a=0,l=0,h=0;return t.DecodeDateTime(e,{get:function(){return s},set:function(t){s=t}},{get:function(){return o},set:function(t){o=t}},{get:function(){return n},set:function(t){n=t}},{get:function(){return r},set:function(t){r=t}},{get:function(){return a},set:function(t){a=t}},{get:function(){return l},set:function(t){l=t}},{get:function(){return h},set:function(t){h=t}}),s+=i,2!==o||29!==n||pas.SysUtils.IsLeapYear(s)||(n=28),t.EncodeDateTime(s,o,n,r,a,l,h)},this.IncYear$1=function(e){return t.IncYear(e,1)},this.IncDay=function(t,i){var s=0;return s=t+i,e.MaybeSkipTimeWarp(t,{get:function(){return s},set:function(t){s=t}}),s},this.IncDay$1=function(e){return t.IncDay(e,1)},this.IncHour=function(t,i){var s=0;return s=t>=0?t+i/24:e.IncNegativeTime(t,i/24),e.MaybeSkipTimeWarp(t,{get:function(){return s},set:function(t){s=t}}),s},this.IncMinute=function(t,i){var s=0;return s=t>=0?t+i/1440:e.IncNegativeTime(t,i/1440),e.MaybeSkipTimeWarp(t,{get:function(){return s},set:function(t){s=t}}),s},this.EncodeDateTime=function(e,i,s,o,n,r,a){var l=0;return t.TryEncodeDateTime(e,i,s,o,n,r,a,{get:function(){return l},set:function(t){l=t}})||t.InvalidDateTimeError$1(e,i,s,o,n,r,a),l},this.DecodeDateTime=function(t,e,i,s,o,n,r,a){pas.SysUtils.DecodeTime(t,o,n,r,a),24===o.get()?(o.set(0),pas.SysUtils.DecodeDate(Math.round(t),e,i,s)):pas.SysUtils.DecodeDate(t,e,i,s)},this.TryEncodeDateTime=function(t,e,i,s,o,n,r,a){var l=!1,h=0;return(l=(l=pas.SysUtils.TryEncodeDate(t,e,i,a))&&pas.SysUtils.TryEncodeTime(s,o,n,r,{get:function(){return h},set:function(t){h=t}}))&&a.set(pas.SysUtils.ComposeDateTime(a.get(),h)),l},this.DecodeDateWeek=function(e,i,s,o){var n,r,a=0,l=0,h=0;i.set(t.YearOf(e)),o.set(pas.SysUtils.DayOfWeek(e)-1),0===o.get()&&o.set(7),n=t.StartOfAYear(i.get()),a=pas.System.Trunc(e-n)+1,(r=t.DayOfTheWeek(n))<5?a+=r-1:a-=8-r,a<=0?t.DecodeDateWeek(n-1,i,s,{get:function(){return l},set:function(t){l=t}}):(s.set(rtl.trunc(a/7)),a%7!=0&&s.set(s.get()+1),s.get()>52&&(h=r,pas.SysUtils.IsLeapYear(i.get())&&(h+=1)>7&&(h=1),h<4&&(i.set(i.get()+1),s.set(1))))},this.CompareDate=function(e,i){return t.SameDate(e,i)?0:e<i?-1:1},this.SameDate=function(t,e){return pas.System.Trunc(t)===pas.System.Trunc(e)},this.InvalidDateTimeError=function(e,i,s,o,n,r,a,l){function h(t,e,i){return 65535!==t?pas.SysUtils.Format("%.*d",pas.System.VarRecs(19,i.length,0,t)):0===l?i:pas.SysUtils.Format("%.*d",pas.System.VarRecs(19,i.length,0,t))}var F=0,p=0,c=0,u=0,C=0,T=0,S=0,d="";throw t.DecodeDateTime(l,{get:function(){return F},set:function(t){F=t}},{get:function(){return p},set:function(t){p=t}},{get:function(){return c},set:function(t){c=t}},{get:function(){return u},set:function(t){u=t}},{get:function(){return C},set:function(t){C=t}},{get:function(){return T},set:function(t){T=t}},{get:function(){return S},set:function(t){S=t}}),d=(d=(d=(d=(d=(d=(d=h(e,0,"????"))+pas.SysUtils.FormatSettings.DateSeparator+h(i,0,"??"))+pas.SysUtils.FormatSettings.DateSeparator+h(s,0,"??"))+" "+h(o,0,"??"))+pas.SysUtils.FormatSettings.TimeSeparator+h(n,0,"??"))+pas.SysUtils.FormatSettings.TimeSeparator+h(r,0,"??"))+pas.SysUtils.FormatSettings.DecimalSeparator+h(a,0,"???"),pas.SysUtils.EConvertError.$create("CreateFmt",[rtl.getResStr(pas.RTLConsts,"SErrInvalidTimeStamp"),pas.System.VarRecs(18,d)])},this.InvalidDateTimeError$1=function(e,i,s,o,n,r,a){t.InvalidDateTimeError(e,i,s,o,n,r,a,0)},this.DateTimeToRFC3339=function(t){return pas.SysUtils.FormatDateTime('yyyy-mm-dd"T"hh":"nn":"ss"."zzz"Z"',t)};var i=[11,1,6,9,12,15,18,21];this.TryRFC3339ToDateTime=function(t,e){var s,o,n,r=!1,a=0,l=0,h=0,F=0;return""===pas.SysUtils.Trim(t)&&(r=!0,e.set(0)),s=pas.SysUtils.StrToIntDef(pas.System.Copy(t,i[1],4),-1),o=pas.SysUtils.StrToIntDef(pas.System.Copy(t,i[2],2),-1),n=pas.SysUtils.StrToIntDef(pas.System.Copy(t,i[3],2),-1),t.length>=i[0]?(a=pas.SysUtils.StrToIntDef(pas.System.Copy(t,i[4],2),-1),l=pas.SysUtils.StrToIntDef(pas.System.Copy(t,i[5],2),-1),h=t.length>=i[6]?pas.SysUtils.StrToIntDef(pas.System.Copy(t,i[6],2),-1):0,t.length>=i[7]&&(F=pas.SysUtils.StrToIntDef(pas.System.Copy(t,i[7],3),-1))):(a=0,l=0,h=0,F=0),(r=s>=0&&o>=0&&n>=0&&a>=0&&l>=0&&h>=0&&F>=0)?0===s||0===o||0===n?e.set(pas.SysUtils.EncodeTime(a,l,h,0)):e.set(pas.SysUtils.EncodeDate(s,o,n)+pas.SysUtils.EncodeTime(a,l,h,F)):e.set(0),r},rtl.createClass(this,"TDateTimeScanner",pas.System.TObject,(function(){this.$init=function(){pas.System.TObject.$init.call(this),this.FPattern="",this.FText="",this.FPatternOffset=0,this.FLen=0,this.FPatternLen=0,this.FPatternPos=0,this.FPos=0,this.FY=0,this.FM=0,this.FD=0,this.FTimeval=0},this.ArrayMatchError=function(){e.raiseexception(pas.SysUtils.Format(e.SNoArrayMatch,pas.System.VarRecs(0,this.FPatternPos+1,0,this.FPos)))},this.DoDateTime=function(){this.MatchPattern(pas.SysUtils.FormatSettings.ShortDateFormat),this.MatchPattern("\t"),this.MatchPattern(pas.SysUtils.FormatSettings.LongTimeFormat),this.FPatternPos+=1},this.SetPattern=function(t){this.FPattern!==t&&(this.FPattern=t,this.FPatternLen=this.FPattern.length)},this.SetText=function(t){this.FText!==t&&(this.FText=t,this.FLen=this.FText.length)},this.ScanFixedInt=function(t){var i,s,o=0,n="";for(o=0,s=this.FPos,i=this.FPattern.charAt(this.FPatternPos-1);this.FPatternPos<=this.FPatternLen&&this.FPattern.charAt(this.FPatternPos-1)===i;)this.FPatternPos+=1;for(n=this.FText.charAt(this.FPos-1);t>0&&this.FPos<=this.FLen&&n.charCodeAt()in rtl.createSet(null,48,57);)o=10*o+n.charCodeAt()-48,this.FPos+=1,t-=1,this.FPos<=this.FLen&&(n=this.FText.charAt(this.FPos-1));return s===this.FPos&&e.raiseexception(pas.SysUtils.Format(e.SPatternCharMismatch,pas.System.VarRecs(9,i,0,s))),o},this.ScanPatternLength=function(){var t,e=0,i=0;for(e=this.FPatternPos,i=this.FPatternPos,t=this.FPattern.charAt(i-1);i<=this.FPatternLen&&this.FPattern.charAt(i-1)===t;)i+=1;return e=i-e},this.MatchChar=function(t){var i="";(i=this.FPos<=this.FLen?this.FText.charAt(this.FPos-1):"?")!==t&&e.raiseexception(pas.SysUtils.Format(e.SNoCharMatch,pas.System.VarRecs(9,i,9,t,0,this.FPatternPos+this.FPatternOffset,0,this.FPos))),this.FPatternPos+=1,this.FPos+=1},this.FindIMatch=function(t,e){var i,s=0,o=0;for(s=-1,i=rtl.length(t)-1,o=0;o<=i&&-1===s;)pas.SysUtils.SameText(pas.System.Copy(e,1,t[o].length),t[o])&&(s=o),o+=1;return s},this.FindMatch=function(t){var e=0;return-1===(e=this.FindIMatch(t,pas.System.Copy(this.FText,this.FPos,this.FLen-this.FPos+1)))?this.ArrayMatchError():(this.FPos+=t[e].length+1,this.FPatternPos+=t[e].length+1,e+=1),e},this.MatchPattern=function(t){var e,i;e=this.FPattern,i=this.FPatternPos,this.FPatternOffset=this.FPatternPos,this.FPattern=t,this.FPatternLen=t.length;try{this.Scan(-1)}finally{this.FPattern=e,this.FPatternLen=t.length,this.FPatternPos=i,this.FPatternOffset=0}},this.DoYear=function(){var e,i=0;e=this.ScanPatternLength(),this.FY=this.ScanFixedInt(4),e<=2&&(i=t.YearOf(pas.SysUtils.Now())-pas.SysUtils.TwoDigitYearCenturyWindow,this.FY+=100*rtl.trunc(i/100),pas.SysUtils.TwoDigitYearCenturyWindow>0&&this.FY<i&&(this.FY+=100))},this.DoMonth=function(){var t=this.ScanPatternLength();1===t||2===t?this.FM=this.ScanFixedInt(2):3===t?this.FM=this.FindMatch(pas.SysUtils.FormatSettings.ShortMonthNames):4===t&&(this.FM=this.FindMatch(pas.SysUtils.FormatSettings.LongMonthNames))},this.DoDay=function(){var t=this.ScanPatternLength();1===t||2===t?this.FD=this.ScanFixedInt(2):3===t?this.FD=this.FindMatch(pas.SysUtils.FormatSettings.ShortDayNames):4===t?this.FD=this.FindMatch(pas.SysUtils.FormatSettings.LongDayNames):5===t?this.MatchPattern(pas.SysUtils.FormatSettings.ShortDateFormat):6===t&&this.MatchPattern(pas.SysUtils.FormatSettings.LongDateFormat)},this.DoTime=function(){var t=this.ScanPatternLength();1===t?this.MatchPattern(pas.SysUtils.FormatSettings.ShortTimeFormat):2===t&&this.MatchPattern(pas.SysUtils.FormatSettings.LongTimeFormat)},this.DoAMPM=function(){var t=0,i=t=this.FindIMatch(e.AMPMformatting,pas.System.Copy(this.FPattern,this.FPatternPos,5));if(0===i){t=this.FindIMatch(["AM","PM"],pas.System.Copy(this.FText,this.FPos,2));0===t||(1===t?this.FTimeval=this.FTimeval+.5:this.ArrayMatchError()),this.FPatternPos+=e.AMPMformatting[0].length,this.FPos+=2}else if(1===i){var s=pas.System.upcase(this.FText.charAt(this.FPos-1));"A"===s||("P"===s?this.FTimeval=this.FTimeval+.5:this.ArrayMatchError()),this.FPatternPos+=e.AMPMformatting[1].length,this.FPos+=1}else if(2===i){var o=t=this.FindIMatch([pas.SysUtils.FormatSettings.TimeAMString,pas.SysUtils.FormatSettings.TimePMString],pas.System.Copy(this.FText,this.FPos,5));0===o?this.FPos+=pas.SysUtils.FormatSettings.TimeAMString.length:1===o?(this.FTimeval=this.FTimeval+.5,this.FPos+=pas.SysUtils.FormatSettings.TimePMString.length):this.ArrayMatchError(),this.FPatternPos+=e.AMPMformatting[2].length,this.FPatternPos+=2,this.FPos+=2}else this.MatchChar(this.FPattern.charAt(this.FPatternPos-1))},this.Scan=function(t){var i=0,s="",o="",n="";for(t<1&&(t=1),this.FPos<t&&(this.FPos=t),this.FPatternPos=1,o="\0",s=" ";this.FPos<=this.FLen&&this.FPatternPos<=this.FPatternLen;)if(n=pas.System.upcase(this.FPattern.charAt(this.FPatternPos-1)),"\0"!==o)o!==n?this.MatchChar(n):(o="\0",this.FPatternPos+=1);else{if("M"===n&&"H"===s)this.ScanPatternLength()>2&&e.raiseexception(pas.SysUtils.Format(e.SHHMMError,pas.System.VarRecs(0,this.FPatternOffset+this.FPatternPos+1))),this.FTimeval=this.FTimeval+.0006944444444444445*this.ScanFixedInt(2);else{var r=n;if("Y"===r)this.DoYear();else if("M"===r)this.DoMonth();else if("D"===r)this.DoDay();else if("T"===r)this.DoTime();else if("H"===r)this.FTimeval=this.FTimeval+.041666666666666664*this.ScanFixedInt(2);else if("N"===r)this.FTimeval=this.FTimeval+.0006944444444444445*this.ScanFixedInt(2);else if("S"===r)this.FTimeval=this.FTimeval+11574074074074073e-21*this.ScanFixedInt(2);else if("Z"===r)this.FTimeval=this.FTimeval+1.1574074074074074e-8*this.ScanFixedInt(3);else if("A"===r)this.DoAMPM();else if("/"===r)this.MatchChar(pas.SysUtils.FormatSettings.DateSeparator);else if(":"===r)this.MatchChar(pas.SysUtils.FormatSettings.TimeSeparator),n=s;else if("'"===r||'"'===r)o=n,this.FPatternPos+=1;else if("C"===r)this.DoDateTime();else if("?"===r)this.FPatternPos+=1,this.FPos+=1;else if("\t"===r){for(;this.FPos<=this.FLen&&this.FText.charCodeAt(this.FPos-1)in e.whitespace;)this.FPos+=1;this.FPatternPos+=1}else this.MatchChar(this.FPattern.charAt(this.FPatternPos-1))}s=n}return i=this.FTimeval,this.FY>0&&this.FM>0&&this.FD>0&&(i+=pas.SysUtils.EncodeDate(this.FY,this.FM,this.FD)),i}})),this.ScanDateTime=function(e,i,s){var o=0,n=null;n=t.TDateTimeScanner.$create("Create");try{n.SetPattern(e),n.SetText(i),o=n.Scan(s)}finally{n=rtl.freeLoc(n)}return o},t.$implcode=function(){e.TDateTimeEpsilon=22204460493e-26,e.HalfMilliSecond=5.787037037037037e-9,e.DOWMap=[7,1,2,3,4,5,6],e.DateTimeDiff=function(t,e){var i=0;return i=t-e,t>0&&e<0?i-=.5:t<-1&&e>-1&&(i+=.5),i},e.MaybeSkipTimeWarp=function(t,e){t>=0&&e.get()<-22204460493e-26?e.set(pas.System.Int(e.get()-1+22204460493e-26)-pas.System.Frac(1+pas.System.Frac(e.get()))):t<=-1&&e.get()>22204460493e-26-1&&e.set(pas.System.Int(e.get()+1-22204460493e-26)+pas.System.Frac(1-Math.abs(pas.System.Frac(1+e.get()))))},e.IncNegativeTime=function(t,e){var i=0;return i=-pas.System.Frac(t)+pas.System.Frac(e),pas.Math.SameValue(i,pas.System.Int(i)+1,22204460493e-26)?i=pas.System.Int(i)+1:pas.Math.SameValue(i,pas.System.Int(i),22204460493e-26)&&(i=pas.System.Int(i)),i<-22204460493e-26?(i=1+i,t=pas.System.Int(t)-1):i>=.9999999999999998&&(i-=1,t=pas.System.Int(t)+1),pas.System.Int(t)+pas.System.Int(e)-i},e.LFAI=65535,e.whitespace=rtl.createSet(32,13,10),e.hrfactor=1/24,e.minfactor=1/1440,e.secfactor=1/86400,e.mssecfactor=1/864e5,e.AMPMformatting=["am/pm","a/p","ampm"],e.raiseexception=function(t){throw pas.SysUtils.EConvertError.$create("Create$1",[t])},e.SPatternCharMismatch='Pattern mismatch char "%s" at position %d.',e.SNoCharMatch='Mismatch char "%s" <> "%s" at pattern position %d, string position %d.',e.SHHMMError="mm in a sequence hh:mm is interpreted as minutes. No longer versions allowed! (Position : %d).",e.SNoArrayMatch="Can't match any allowed value at pattern position %d, string position %d."}}),["JS","RTLConsts"]),rtl.module("DBConst",["System"],(function(){"use strict";this.$resourcestrings={SActiveDataset:{org:"Operation cannot be performed on an active dataset"},SDatasetReadOnly:{org:"Dataset is read-only."},SDuplicateFieldName:{org:'Duplicate fieldname : "%s"'},SFieldNotFound:{org:'Field not found : "%s"'},SInactiveDataset:{org:"Operation cannot be performed on an inactive dataset"},SInvalidDisplayValues:{org:'"%s" are not valid boolean displayvalues'},SInvalidFieldSize:{org:"Invalid field size : %d"},SInvalidTypeConversion:{org:"Invalid type conversion to %s in field %s"},SNeedField:{org:"Field %s is required, but not supplied."},SNeedFieldName:{org:"Field needs a name"},SNoDataset:{org:'No dataset asssigned for field : "%s"'},SNoSuchRecord:{org:"Could not find the requested record."},SNotABoolean:{org:'"%s" is not a valid boolean'},SNotAFloat:{org:'"%s" is not a valid float'},SNotAninteger:{org:'"%s" is not a valid integer'},SNotEditing:{org:'Operation not allowed, dataset "%s" is not in an edit or insert state.'},SRangeError:{org:"%f is not between %f and %f for %s"},SUniDirectional:{org:"Operation cannot be performed on an unidirectional dataset"},SUnknownFieldType:{org:"Unknown field type : %s"},SUnknownParamFieldType:{org:'Unknown fieldtype for parameter "%s".'},SIndexNotFound:{org:"Index '%s' not found"},SFieldValueError:{org:"Invalid value for field '%s'"},SDuplicateName:{org:"Duplicate name '%s' in %s"},SLookupInfoError:{org:"Lookup information for field '%s' is incomplete"},SDatasetEmpty:{org:"The dataset is empty"},SErrInvalidDateTime:{org:'Invalid date/time value : "%s"'},SatEOFInternalOnly:{org:"loAtEOF is for internal use only."},SErrInsertingSameRecordtwice:{org:"Attempt to insert the same record twice."},SNestedDataSetClass:{org:"Nested dataset must inherit from %s"},SCircularDataLink:{org:"Circular datalinks are not allowed"}}})),rtl.module("DB",["System","Classes","SysUtils","JS","Types","DateUtils"],(function(){"use strict";var t=this,e=t.$impl;this.YesNoChars=["N","Y"],this.TDataSetState={0:"dsInactive",dsInactive:0,1:"dsBrowse",dsBrowse:1,2:"dsEdit",dsEdit:2,3:"dsInsert",dsInsert:3,4:"dsSetKey",dsSetKey:4,5:"dsCalcFields",dsCalcFields:5,6:"dsFilter",dsFilter:6,7:"dsNewValue",dsNewValue:7,8:"dsOldValue",dsOldValue:8,9:"dsCurValue",dsCurValue:9,10:"dsBlockRead",dsBlockRead:10,11:"dsInternalCalc",dsInternalCalc:11,12:"dsOpening",dsOpening:12,13:"dsRefreshFields",dsRefreshFields:13},this.TDataEvent={0:"deFieldChange",deFieldChange:0,1:"deRecordChange",deRecordChange:1,2:"deDataSetChange",deDataSetChange:2,3:"deDataSetScroll",deDataSetScroll:3,4:"deLayoutChange",deLayoutChange:4,5:"deUpdateRecord",deUpdateRecord:5,6:"deUpdateState",deUpdateState:6,7:"deCheckBrowseMode",deCheckBrowseMode:7,8:"dePropertyChange",dePropertyChange:8,9:"deFieldListChange",deFieldListChange:9,10:"deFocusControl",deFocusControl:10,11:"deParentScroll",deParentScroll:11,12:"deConnectChange",deConnectChange:12,13:"deReconcileError",deReconcileError:13,14:"deDisabledStateChange",deDisabledStateChange:14},this.TUpdateStatus={0:"usModified",usModified:0,1:"usInserted",usInserted:1,2:"usDeleted",usDeleted:2},this.TProviderFlag={0:"pfInUpdate",pfInUpdate:0,1:"pfInWhere",pfInWhere:1,2:"pfInKey",pfInKey:2,3:"pfHidden",pfHidden:3,4:"pfRefreshOnInsert",pfRefreshOnInsert:4,5:"pfRefreshOnUpdate",pfRefreshOnUpdate:5},this.$rtti.$Enum("TProviderFlag",{minvalue:0,maxvalue:5,ordtype:1,enumtype:this.TProviderFlag}),this.$rtti.$Set("TProviderFlags",{comptype:this.$rtti.TProviderFlag}),this.$rtti.$Class("TFieldDefs"),this.$rtti.$Class("TField"),this.$rtti.$Class("TFields"),this.$rtti.$Class("TDataSet"),this.$rtti.$Class("TDataSource"),this.$rtti.$Class("TRecordUpdateDescriptor"),rtl.createClass(this,"EDatabaseError",pas.SysUtils.Exception,(function(){})),this.TFieldType={0:"ftUnknown",ftUnknown:0,1:"ftString",ftString:1,2:"ftInteger",ftInteger:2,3:"ftLargeInt",ftLargeInt:3,4:"ftBoolean",ftBoolean:4,5:"ftFloat",ftFloat:5,6:"ftDate",ftDate:6,7:"ftTime",ftTime:7,8:"ftDateTime",ftDateTime:8,9:"ftAutoInc",ftAutoInc:9,10:"ftBlob",ftBlob:10,11:"ftMemo",ftMemo:11,12:"ftFixedChar",ftFixedChar:12,13:"ftVariant",ftVariant:13,14:"ftDataset",ftDataset:14,15:"ftWideString",ftWideString:15},this.$rtti.$Enum("TFieldType",{minvalue:0,maxvalue:15,ordtype:1,enumtype:this.TFieldType}),this.TFieldAttribute={0:"faHiddenCol",faHiddenCol:0,1:"faReadonly",faReadonly:1,2:"faRequired",faRequired:2,3:"faLink",faLink:3,4:"faUnNamed",faUnNamed:4,5:"faFixed",faFixed:5},this.$rtti.$Enum("TFieldAttribute",{minvalue:0,maxvalue:5,ordtype:1,enumtype:this.TFieldAttribute}),this.$rtti.$Set("TFieldAttributes",{comptype:this.$rtti.TFieldAttribute}),rtl.createClass(this,"TNamedItem",pas.Classes.TCollectionItem,(function(){this.$init=function(){pas.Classes.TCollectionItem.$init.call(this),this.FName=""},this.GetDisplayName=function(){return this.FName},this.SetDisplayName=function(e){var i=0;this.FName!==e&&(""!==e&&t.TFieldDefs.isPrototypeOf(this.FCollection)&&(i=this.FCollection.IndexOf(e))>=0&&i!==this.GetIndex()&&t.DatabaseErrorFmt(rtl.getResStr(pas.DBConst,"SDuplicateName"),pas.System.VarRecs(18,e,18,this.FCollection.$classname)),this.FName=e,pas.Classes.TCollectionItem.SetDisplayName.call(this,e))},this.$rtti.addProperty("Name",2,rtl.string,"FName","SetDisplayName")})),rtl.createClass(this,"TDefCollection",pas.Classes.TOwnedCollection,(function(){this.$init=function(){pas.Classes.TOwnedCollection.$init.call(this),this.FDataset=null},this.$final=function(){this.FDataset=void 0,pas.Classes.TOwnedCollection.$final.call(this)},this.SetItemName=function(e){var i=null,s="";""===(i=rtl.as(e,t.TNamedItem)).FName?(s=pas.System.Copy(this.$classname,2,5)+pas.SysUtils.IntToStr(i.FID+1),null!=this.FDataset&&(s=this.FDataset.FName+s),i.SetDisplayName(s)):pas.Classes.TCollection.SetItemName.call(this,e)},this.create$3=function(t,e,i){return pas.Classes.TOwnedCollection.Create$2.call(this,e,i),this.FDataset=t,this},this.Find=function(t){var e=null,i=0;e=null;for(var s=0,o=this.GetCount()-1;s<=o;s++)if(i=s,pas.SysUtils.AnsiSameText(this.GetItem(i).FName,t)){e=this.GetItem(i);break}return e},this.IndexOf=function(t){var e=0,i=0;e=-1;for(var s=0,o=this.GetCount()-1;s<=o;s++)if(i=s,pas.SysUtils.AnsiSameText(this.GetItem(i).FName,t)){e=i;break}return e}})),rtl.createClass(this,"TFieldDef",this.TNamedItem,(function(){this.$init=function(){t.TNamedItem.$init.call(this),this.FAttributes={},this.FDataType=0,this.FFieldNo=0,this.FInternalCalcField=!1,this.FPrecision=0,this.FRequired=!1,this.FSize=0},this.$final=function(){this.FAttributes=void 0,t.TNamedItem.$final.call(this)},this.GetFieldClass=function(){return null!=this.FCollection&&t.TFieldDefs.isPrototypeOf(this.FCollection)&&null!=this.FCollection.FDataset?this.FCollection.FDataset.GetFieldClass(this.FDataType):null},this.SetAttributes=function(t){this.FAttributes=rtl.refSet(t),this.Changed(!1)},this.SetDataType=function(t){this.FDataType=t,this.Changed(!1)},this.SetPrecision=function(t){this.FPrecision=t,this.Changed(!1)},this.SetSize=function(t){this.FSize=t,this.Changed(!1)},this.Create$1=function(t){return pas.Classes.TCollectionItem.Create$1.call(this,t),this.FFieldNo=this.GetIndex()+1,this},this.Create$3=function(t,e,i,s,o,n){return pas.Classes.TCollectionItem.Create$1.call(this,t),this.SetDisplayName(e),this.FDataType=i,this.FSize=s,this.FRequired=o,this.FPrecision=-1,this.FFieldNo=n,this},this.Destroy=function(){pas.Classes.TCollectionItem.Destroy.call(this)},this.Assign=function(e){var i=null;if(i=null,t.TFieldDef.isPrototypeOf(e)&&(i=rtl.as(e,t.TFieldDef)),null!=i){this.FCollection.BeginUpdate();try{this.SetDisplayName(i.FName),this.SetDataType(i.FDataType),this.SetSize(i.FSize),this.SetPrecision(i.FPrecision),this.FRequired=i.FRequired}finally{this.FCollection.EndUpdate()}}else pas.Classes.TPersistent.Assign.call(this,e)},this.CreateField=function(e){var i=null,s=null;null===(s=this.GetFieldClass())&&t.DatabaseErrorFmt(rtl.getResStr(pas.DBConst,"SUnknownFieldType"),pas.System.VarRecs(18,this.FName)),i=s.$create("Create$1",[e]);try{i.FFieldDef=this,i.SetSize(this.FSize),i.FRequired=this.FRequired,i.FFieldName=this.FName,i.FDisplayLabel=this.GetDisplayName(),i.FFieldNo=this.FFieldNo,i.SetFieldType(this.FDataType),i.FReadOnly=1 in this.FAttributes,i.SetDataset(this.FCollection.FDataset),t.TFloatField.isPrototypeOf(i)&&i.SetPrecision(this.FPrecision)}catch(t){throw i=rtl.freeLoc(i),t}return i};var e=this.$rtti;e.addProperty("Attributes",2,t.$rtti.TFieldAttributes,"FAttributes","SetAttributes",{Default:{}}),e.addProperty("DataType",2,t.$rtti.TFieldType,"FDataType","SetDataType"),e.addProperty("Precision",2,rtl.longint,"FPrecision","SetPrecision",{Default:0}),e.addProperty("Size",2,rtl.longint,"FSize","SetSize",{Default:0})})),rtl.createClass(this,"TFieldDefs",this.TDefCollection,(function(){this.GetItem$1=function(t){return this.GetItem(t)},this.FieldDefClass=function(){return t.TFieldDef},this.Create$4=function(e){return t.TDefCollection.create$3.call(this,e,this.Owner(),this.$class.FieldDefClass()),this},this.Add$2=function(t,e,i,s,o){return this.$class.FieldDefClass().$create("Create$3",[this,t,e,i,s,o])},this.Add$3=function(e,i,s,o){0===e.length&&t.DatabaseError$1(rtl.getResStr(pas.DBConst,"SNeedFieldName"),this.FDataset),this.BeginUpdate();try{this.Add$2(e,i,s,o,this.GetCount()+1)}finally{this.EndUpdate()}},this.Add$4=function(t,e,i){this.Add$3(t,e,i,!1)},this.Add$5=function(t,e){this.Add$3(t,e,0,!1)}})),this.TFieldKind={0:"fkData",fkData:0,1:"fkCalculated",fkCalculated:1,2:"fkLookup",fkLookup:2,3:"fkInternalCalc",fkInternalCalc:3},this.$rtti.$Enum("TFieldKind",{minvalue:0,maxvalue:3,ordtype:1,enumtype:this.TFieldKind}),this.$rtti.$MethodVar("TFieldNotifyEvent",{procsig:rtl.newTIProcSig([["Sender",this.$rtti.TField]]),methodkind:0}),this.$rtti.$MethodVar("TFieldGetTextEvent",{procsig:rtl.newTIProcSig([["Sender",this.$rtti.TField],["aText",rtl.string,1],["DisplayText",rtl.boolean]]),methodkind:0}),this.$rtti.$MethodVar("TFieldSetTextEvent",{procsig:rtl.newTIProcSig([["Sender",this.$rtti.TField],["aText",rtl.string,2]]),methodkind:0}),rtl.createClass(this,"TLookupList",pas.System.TObject,(function(){this.$init=function(){pas.System.TObject.$init.call(this),this.FList=null},this.$final=function(){this.FList=void 0,pas.System.TObject.$final.call(this)},this.Create$1=function(){return this.FList=pas.Classes.TFPList.$create("Create"),this},this.Destroy=function(){this.Clear(),this.FList.$destroy("Destroy"),pas.System.TObject.Destroy.call(this)},this.Clear=function(){this.FList.Clear()}})),rtl.createClass(this,"TField",pas.Classes.TComponent,(function(){this.$init=function(){pas.Classes.TComponent.$init.call(this),this.FAlignment=0,this.FConstraintErrorMessage="",this.FCustomConstraint="",this.FDataSet=null,this.FDataType=0,this.FDefaultExpression="",this.FDisplayLabel="",this.FDisplayWidth=0,this.FFieldDef=null,this.FFieldKind=0,this.FFieldName="",this.FFieldNo=0,this.FFields=null,this.FHasConstraints=!1,this.FImportedConstraint="",this.FKeyFields="",this.FLookupCache=!1,this.FLookupDataSet=null,this.FLookupKeyfields="",this.FLookupresultField="",this.FLookupList=null,this.FOnChange=null,this.FOnGetText=null,this.FOnSetText=null,this.FOnValidate=null,this.FOrigin="",this.FReadOnly=!1,this.FRequired=!1,this.FSize=0,this.FValidChars=[],this.FValueBuffer=void 0,this.FValidating=!1,this.FVisible=!1,this.FProviderFlags={}},this.$final=function(){this.FDataSet=void 0,this.FFieldDef=void 0,this.FFields=void 0,this.FLookupDataSet=void 0,this.FLookupList=void 0,this.FOnChange=void 0,this.FOnGetText=void 0,this.FOnSetText=void 0,this.FOnValidate=void 0,this.FValidChars=void 0,this.FProviderFlags=void 0,pas.Classes.TComponent.$final.call(this)},this.GetIndex=function(){return null!=this.FDataSet?this.FDataSet.FFieldList.IndexOf(this):-1},this.SetAlignment=function(t){this.FAlignment!==t&&(this.FAlignment=t,this.PropertyChanged(!1))},this.SetIndex=function(t){null!==this.FFields&&this.FFields.SetFieldIndex(this,t)},this.GetDisplayText=function(){var t="";return t=rtl.strSetLength(t,0),null!=this.FOnGetText?this.FOnGetText(this,{get:function(){return t},set:function(e){t=e}},!0):this.GetText({get:function(){return t},set:function(e){t=e}},!0),t},this.GetEditText=function(){var t="";return t=rtl.strSetLength(t,0),null!=this.FOnGetText?this.FOnGetText(this,{get:function(){return t},set:function(e){t=e}},!1):this.GetText({get:function(){return t},set:function(e){t=e}},!1),t},this.SetEditText=function(t){null!=this.FOnSetText?this.FOnSetText(this,t):this.SetText(t)},this.SetDisplayLabel=function(t){this.FDisplayLabel!==t&&(this.FDisplayLabel=t,this.PropertyChanged(!0))},this.SetDisplayWidth=function(t){this.FDisplayWidth!==t&&(this.FDisplayWidth=t,this.PropertyChanged(!0))},this.GetDisplayWidth=function(){return 0===this.FDisplayWidth?this.GetDefaultWidth():this.FDisplayWidth},this.SetReadOnly=function(t){this.FReadOnly!==t&&(this.FReadOnly=t,this.PropertyChanged(!0))},this.SetVisible=function(t){this.FVisible!==t&&(this.FVisible=t,this.PropertyChanged(!0))},this.IsDisplayLabelStored=function(){return this.GetDisplayName()!==this.FFieldName},this.IsDisplayWidthStored=function(){return 0!==this.FDisplayWidth},this.GetLookupList=function(){return null==this.FLookupList&&(this.FLookupList=t.TLookupList.$create("Create$1")),this.FLookupList},this.CalcLookupValue=function(){null!=this.FLookupDataSet&&this.FLookupDataSet.GetActive()?this.SetAsJSValue(this.FLookupDataSet.Lookup(this.FLookupKeyfields,this.FDataSet.GetFieldValues(this.FKeyFields),this.FLookupresultField)):this.SetAsJSValue(null)},this.RaiseAccessError=function(t){throw this.AccessError(t)},this.AccessError=function(e){return t.EDatabaseError.$create("CreateFmt",[rtl.getResStr(pas.DBConst,"SInvalidTypeConversion"),pas.System.VarRecs(18,e,18,this.FFieldName)])},this.CheckInactive=function(){null!=this.FDataSet&&this.FDataSet.CheckInactive()},this.CheckTypeSize=function(e){0===e||this.IsBlob()||t.DatabaseErrorFmt(rtl.getResStr(pas.DBConst,"SInvalidFieldSize"),pas.System.VarRecs(0,e))},this.Change=function(){null!=this.FOnChange&&this.FOnChange(this)},this.Bind=function(e){e&&2===this.FFieldKind&&(null!==this.FLookupDataSet&&""!==this.FLookupKeyfields&&""!==this.FLookupresultField&&""!==this.FKeyFields||t.DatabaseErrorFmt(rtl.getResStr(pas.DBConst,"SLookupInfoError"),pas.System.VarRecs(18,this.GetDisplayName())),this.FFields.CheckFieldNames(this.FKeyFields),this.FLookupDataSet.Open(),this.FLookupDataSet.FFieldList.CheckFieldNames(this.FLookupKeyfields),this.FLookupDataSet.FieldByName(this.FLookupresultField),this.FLookupCache&&this.RefreshLookupList())},this.GetAsBoolean=function(){return this.RaiseAccessError(e.SBoolean),!1,!1},this.GetAsLargeInt=function(){return this.RaiseAccessError(e.SLargeInt),0,0},this.GetAsDateTime=function(){return this.RaiseAccessError(e.SDateTime),0,0},this.GetAsFloat=function(){return this.RaiseAccessError(e.SDateTime),0,0},this.GetAsInteger=function(){return this.RaiseAccessError(e.SInteger),0,0},this.GetAsJSValue=function(){return this.GetData()},this.GetAsString=function(){return this.GetClassDesc()},this.GetClassDesc=function(){var t;return t=pas.System.Copy(this.$classname,2,pas.System.Pos("Field",this.$classname)-2),this.GetIsNull()?"("+pas.SysUtils.LowerCase(t)+")":"("+pas.SysUtils.UpperCase(t)+")"},this.GetDataSize=function(){return 0,0},this.GetDefaultWidth=function(){return 10,10},this.GetDisplayName=function(){return""!==this.FDisplayLabel?this.FDisplayLabel:this.FFieldName},this.GetIsNull=function(){return pas.JS.isNull(this.GetData())},this.GetText=function(t,e){t.set(this.GetAsString())},this.Notification=function(t,e){pas.Classes.TComponent.Notification.call(this,t,e),1===e&&t===this.FLookupDataSet&&(this.FLookupDataSet=null)},this.PropertyChanged=function(t){null!==this.FDataSet&&this.FDataSet.GetActive()&&(t?this.FDataSet.DataEvent(4,0):this.FDataSet.DataEvent(2,0))},this.SetAsBoolean=function(t){this.RaiseAccessError(e.SBoolean)},this.SetAsDateTime=function(t){this.RaiseAccessError(e.SDateTime)},this.SetAsFloat=function(t){this.RaiseAccessError(e.SFloat)},this.SetAsInteger=function(t){this.RaiseAccessError(e.SInteger)},this.SetAsJSValue=function(e){if(pas.JS.isNull(e))this.Clear();else try{this.SetVarValue(e)}catch(e){if(!pas.SysUtils.EVariantError.isPrototypeOf(e))throw e;t.DatabaseErrorFmt(rtl.getResStr(pas.DBConst,"SFieldValueError"),pas.System.VarRecs(18,this.GetDisplayName()))}},this.SetAsString=function(t){this.RaiseAccessError(e.SString)},this.SetDataset=function(t){t!==this.FDataSet&&(null!=this.FDataSet&&(this.FDataSet.CheckInactive(),this.FDataSet.FFieldList.Remove(this)),null!=t&&(t.CheckInactive(),t.FFieldList.Add(this)),this.FDataSet=t)},this.SetDataType=function(t){this.FDataType=t},this.SetSize=function(t){this.CheckInactive(),this.$class.CheckTypeSize(t),this.FSize=t},this.SetText=function(t){this.SetAsString(t)},this.SetVarValue=function(t){this.RaiseAccessError(e.SJSValue)},this.Create$1=function(t){return pas.Classes.TComponent.Create$1.call(this,t),this.FVisible=!0,this.FValidChars=rtl.arraySetLength(this.FValidChars,"",255),this.FProviderFlags=rtl.createSet(0,1),this},this.Destroy=function(){null!=this.FDataSet&&(this.FDataSet.SetActive(!1),null!=this.FFields&&this.FFields.Remove(this)),rtl.free(this,"FLookupList"),pas.Classes.TComponent.Destroy.call(this)},this.GetParentComponent=function(){return this.FDataSet},this.SetParentComponent=function(e){this.SetDataset(rtl.as(e,t.TDataSet))},this.HasParent=function(){return!0,!0},this.Assign=function(e){null===e?this.Clear():t.TField.isPrototypeOf(e)?this.SetAsJSValue(e.GetAsJSValue()):pas.Classes.TPersistent.Assign.call(this,e)},this.Clear=function(){this.SetData(null)},this.GetData=function(){var e=void 0;return null===this.FDataSet&&t.DatabaseErrorFmt(rtl.getResStr(pas.DBConst,"SNoDataset"),pas.System.VarRecs(18,this.FFieldName)),this.FValidating?e=this.FValueBuffer:(e=this.FDataSet.GetFieldData(this),pas.JS.isUndefined(e)&&(e=null)),e},this.IsBlob=function(){return!1,!1},this.RefreshLookupList=function(){var t;if(null!=this.FLookupDataSet&&0!==this.FLookupKeyfields.length&&0!==this.FLookupresultField.length&&0!==this.FKeyFields.length){t=this.FLookupDataSet.GetActive();try{this.FLookupDataSet.SetActive(!0),this.FFields.CheckFieldNames(this.FKeyFields),this.FLookupDataSet.FFieldList.CheckFieldNames(this.FLookupKeyfields),this.FLookupDataSet.FieldByName(this.FLookupresultField),this.GetLookupList().Clear(),this.FLookupDataSet.DisableControls();try{for(this.FLookupDataSet.First();!this.FLookupDataSet.FEOF;)this.FLookupDataSet.Next()}finally{this.FLookupDataSet.EnableControls()}}finally{this.FLookupDataSet.SetActive(t)}}},this.SetData=function(e){null==this.FDataSet&&t.DatabaseErrorFmt(rtl.getResStr(pas.DBConst,"SNoDataset"),pas.System.VarRecs(18,this.FFieldName)),this.FDataSet.SetFieldData(this,e)},this.SetFieldType=function(t){},rtl.addIntf(this,pas.System.IUnknown);var i=this.$rtti;i.addProperty("Alignment",2,pas.Classes.$rtti.TAlignment,"FAlignment","SetAlignment",{Default:pas.Classes.TAlignment.taLeftJustify}),i.addProperty("CustomConstraint",0,rtl.string,"FCustomConstraint","FCustomConstraint"),i.addProperty("ConstraintErrorMessage",0,rtl.string,"FConstraintErrorMessage","FConstraintErrorMessage"),i.addProperty("DefaultExpression",0,rtl.string,"FDefaultExpression","FDefaultExpression"),i.addProperty("DisplayLabel",15,rtl.string,"GetDisplayName","SetDisplayLabel",{stored:"IsDisplayLabelStored"}),i.addProperty("DisplayWidth",15,rtl.longint,"GetDisplayWidth","SetDisplayWidth",{stored:"IsDisplayWidthStored"}),i.addProperty("FieldKind",0,t.$rtti.TFieldKind,"FFieldKind","FFieldKind"),i.addProperty("FieldName",0,rtl.string,"FFieldName","FFieldName"),i.addProperty("HasConstraints",0,rtl.boolean,"FHasConstraints",""),i.addProperty("Index",3,rtl.longint,"GetIndex","SetIndex"),i.addProperty("ImportedConstraint",0,rtl.string,"FImportedConstraint","FImportedConstraint"),i.addProperty("KeyFields",0,rtl.string,"FKeyFields","FKeyFields"),i.addProperty("LookupCache",0,rtl.boolean,"FLookupCache","FLookupCache"),i.addProperty("LookupDataSet",0,t.$rtti.TDataSet,"FLookupDataSet","FLookupDataSet"),i.addProperty("LookupKeyFields",0,rtl.string,"FLookupKeyfields","FLookupKeyfields"),i.addProperty("LookupResultField",0,rtl.string,"FLookupresultField","FLookupresultField"),i.addProperty("Origin",0,rtl.string,"FOrigin","FOrigin"),i.addProperty("ProviderFlags",0,t.$rtti.TProviderFlags,"FProviderFlags","FProviderFlags"),i.addProperty("ReadOnly",2,rtl.boolean,"FReadOnly","SetReadOnly"),i.addProperty("Required",0,rtl.boolean,"FRequired","FRequired"),i.addProperty("Visible",2,rtl.boolean,"FVisible","SetVisible",{Default:!0}),i.addProperty("OnChange",0,t.$rtti.TFieldNotifyEvent,"FOnChange","FOnChange"),i.addProperty("OnGetText",0,t.$rtti.TFieldGetTextEvent,"FOnGetText","FOnGetText"),i.addProperty("OnSetText",0,t.$rtti.TFieldSetTextEvent,"FOnSetText","FOnSetText"),i.addProperty("OnValidate",0,t.$rtti.TFieldNotifyEvent,"FOnValidate","FOnValidate")})),rtl.createClass(this,"TStringField",this.TField,(function(){this.$init=function(){t.TField.$init.call(this),this.FFixedChar=!1,this.FTransliterate=!1},this.CheckTypeSize=function(e){e<0&&t.DatabaseErrorFmt(rtl.getResStr(pas.DBConst,"SInvalidFieldSize"),pas.System.VarRecs(0,e))},this.GetAsBoolean=function(){var e="";return(e=this.GetAsString()).length>0&&pas.System.upcase(e.charAt(0)).charCodeAt()in rtl.createSet(84,t.YesNoChars[1].charCodeAt())},this.GetAsDateTime=function(){return pas.SysUtils.StrToDateTime(this.GetAsString())},this.GetAsFloat=function(){return pas.SysUtils.StrToFloat(this.GetAsString())},this.GetAsInteger=function(){return pas.SysUtils.StrToInt(this.GetAsString())},this.GetAsLargeInt=function(){return pas.SysUtils.StrToInt64(this.GetAsString())},this.GetAsString=function(){var t;return t=this.GetData(),rtl.isString(t)?""+t:""},this.GetAsJSValue=function(){return this.GetData()},this.GetDefaultWidth=function(){return this.FSize},this.GetText=function(t,e){t.set(this.GetAsString())},this.SetAsBoolean=function(t){t?this.SetAsString("T"):this.SetAsString("F")},this.SetAsDateTime=function(t){this.SetAsString(pas.SysUtils.DateTimeToStr(t,!1))},this.SetAsFloat=function(t){this.SetAsString(pas.SysUtils.FloatToStr(t))},this.SetAsInteger=function(t){this.SetAsString(pas.SysUtils.IntToStr(t))},this.SetAsString=function(t){this.SetData(t)},this.SetVarValue=function(t){rtl.isString(t)?this.SetAsString(""+t):this.RaiseAccessError(rtl.getResStr(pas.DBConst,"SFieldValueError"))},this.Create$1=function(e){return t.TField.Create$1.call(this,e),this.SetDataType(1),this.FFixedChar=!1,this.FTransliterate=!1,this.FSize=20,this},this.SetFieldType=function(t){t in rtl.createSet(1,12,15)&&this.SetDataType(t)},rtl.addIntf(this,pas.System.IUnknown),this.$rtti.addProperty("Size",2,rtl.longint,"FSize","SetSize",{Default:20})})),rtl.createClass(this,"TNumericField",this.TField,(function(){this.$init=function(){t.TField.$init.call(this),this.FDisplayFormat="",this.FEditFormat=""},this.CheckTypeSize=function(e){e>16&&t.DatabaseErrorFmt(rtl.getResStr(pas.DBConst,"SInvalidFieldSize"),pas.System.VarRecs(0,e))},this.RangeError=function(e,i,s){t.DatabaseErrorFmt(rtl.getResStr(pas.DBConst,"SRangeError"),pas.System.VarRecs(3,e,3,i,3,s,18,this.FFieldName))},this.SetDisplayFormat=function(t){this.FDisplayFormat!==t&&(this.FDisplayFormat=t,this.PropertyChanged(!0))},this.SetEditFormat=function(t){this.FEditFormat!==t&&(this.FEditFormat=t,this.PropertyChanged(!0))},this.GetAsBoolean=function(){return 0!==this.GetAsInteger()},this.SetAsBoolean=function(t){this.SetAsInteger(t+0)},this.Create$1=function(e){return t.TField.Create$1.call(this,e),this.SetAlignment(1),this},rtl.addIntf(this,pas.System.IUnknown);var e=this.$rtti;e.addProperty("Alignment",2,pas.Classes.$rtti.TAlignment,"FAlignment","SetAlignment",{Default:pas.Classes.TAlignment.taRightJustify}),e.addProperty("DisplayFormat",2,rtl.string,"FDisplayFormat","SetDisplayFormat"),e.addProperty("EditFormat",2,rtl.string,"FEditFormat","SetEditFormat")})),rtl.createClass(this,"TIntegerField",this.TNumericField,(function(){this.$init=function(){t.TNumericField.$init.call(this),this.FMinValue=0,this.FMaxValue=0,this.FMinRange=0,this.FMaxRange=0},this.SetMinValue=function(t){t>=this.FMinRange&&t<=this.FMaxRange?this.FMinValue=t:this.RangeError(t,this.FMinRange,this.FMaxRange)},this.SetMaxValue=function(t){t>=this.FMinRange&&t<=this.FMaxRange?this.FMaxValue=t:this.RangeError(t,this.FMinRange,this.FMaxRange)},this.GetAsFloat=function(){return this.GetAsInteger()},this.GetAsInteger=function(){var t=0;return this.GetValue({get:function(){return t},set:function(e){t=e}})||(t=0),t},this.GetAsString=function(){var t=0;return this.GetValue({get:function(){return t},set:function(e){t=e}})?pas.SysUtils.IntToStr(t):""},this.GetAsJSValue=function(){var t=0;return this.GetValue({get:function(){return t},set:function(e){t=e}})?t:null},this.GetText=function(t,e){var i=0,s="";t.set(""),this.GetValue({get:function(){return i},set:function(t){i=t}})&&(0!==(s=e||""===this.FEditFormat?this.FDisplayFormat:this.FEditFormat).length?t.set(pas.SysUtils.FormatFloat(s,i)):t.set(""+i))},this.GetValue=function(t){var e,i;return i=this.GetData(),(e=pas.JS.isInteger(i))&&t.set(rtl.trunc(i)),e},this.SetAsFloat=function(t){this.SetAsInteger(Math.round(t))},this.SetAsInteger=function(t){this.CheckRange(t)?this.SetData(t):0!==this.FMinValue||0!==this.FMaxValue?this.RangeError(t,this.FMinValue,this.FMaxValue):this.RangeError(t,this.FMinRange,this.FMaxRange)},this.SetAsString=function(e){var i=0,s=0;0===e.length?this.Clear():(pas.System.val$6(e,{get:function(){return i},set:function(t){i=t}},{get:function(){return s},set:function(t){s=t}}),0===s?this.SetAsInteger(i):t.DatabaseErrorFmt(rtl.getResStr(pas.DBConst,"SNotAninteger"),pas.System.VarRecs(18,e)))},this.SetVarValue=function(t){pas.JS.isInteger(t)?this.SetAsInteger(rtl.trunc(t)):this.RaiseAccessError(e.SInteger)},this.GetAsLargeInt=function(){return this.GetAsInteger()},this.Create$1=function(e){return t.TNumericField.Create$1.call(this,e),this.SetDataType(2),this.FMinRange=-2147483648,this.FMaxRange=2147483647,this},this.CheckRange=function(t){return 0!==this.FMinValue||0!==this.FMaxValue?t>=this.FMinValue&&t<=this.FMaxValue:t>=this.FMinRange&&t<=this.FMaxRange},rtl.addIntf(this,pas.System.IUnknown);var i=this.$rtti;i.addProperty("MaxValue",2,rtl.longint,"FMaxValue","SetMaxValue",{Default:0}),i.addProperty("MinValue",2,rtl.longint,"FMinValue","SetMinValue",{Default:0})})),rtl.createClass(this,"TLargeintField",this.TNumericField,(function(){this.$init=function(){t.TNumericField.$init.call(this),this.FMinValue=0,this.FMaxValue=0,this.FMinRange=0,this.FMaxRange=0},this.SetMinValue=function(t){t>=this.FMinRange&&t<=this.FMaxRange?this.FMinValue=t:this.RangeError(t,this.FMinRange,this.FMaxRange)},this.SetMaxValue=function(t){t>=this.FMinRange&&t<=this.FMaxRange?this.FMaxValue=t:this.RangeError(t,this.FMinRange,this.FMaxRange)},this.GetAsFloat=function(){return this.GetAsLargeInt()},this.GetAsInteger=function(){return this.GetAsLargeInt()},this.GetAsLargeInt=function(){var t=0;return this.GetValue({get:function(){return t},set:function(e){t=e}})||(t=0),t},this.GetAsString=function(){var t=0;return this.GetValue({get:function(){return t},set:function(e){t=e}})?pas.SysUtils.IntToStr(t):""},this.GetAsJSValue=function(){var t=0;return this.GetValue({get:function(){return t},set:function(e){t=e}})?t:null},this.GetText=function(t,e){var i=0,s="";t.set(""),this.GetValue({get:function(){return i},set:function(t){i=t}})&&(0!==(s=e||""===this.FEditFormat?this.FDisplayFormat:this.FEditFormat).length?t.set(pas.SysUtils.FormatFloat(s,i)):t.set(""+i))},this.GetValue=function(t){var e,i;return i=this.GetData(),(e=pas.JS.isInteger(i))&&t.set(rtl.trunc(i)),e},this.SetAsFloat=function(t){this.SetAsLargeInt(Math.round(t))},this.SetAsInteger=function(t){this.SetAsLargeInt(t)},this.SetAsLargeInt=function(t){this.CheckRange(t)?this.SetData(t):this.RangeError(t,this.FMinValue,this.FMaxValue)},this.SetAsString=function(e){var i=0,s=0;0===e.length?this.Clear():(pas.System.val(e,{get:function(){return i},set:function(t){i=t}},{get:function(){return s},set:function(t){s=t}}),0===s?this.SetAsLargeInt(i):t.DatabaseErrorFmt(rtl.getResStr(pas.DBConst,"SNotAninteger"),pas.System.VarRecs(18,e)))},this.SetVarValue=function(t){pas.JS.isInteger(t)?this.SetAsLargeInt(rtl.trunc(t)):this.RaiseAccessError(e.SLargeInt)},this.Create$1=function(e){return t.TNumericField.Create$1.call(this,e),this.SetDataType(3),this.FMinRange=-9007199254740991,this.FMaxRange=9007199254740991,this},this.CheckRange=function(t){return 0!==this.FMinValue||0!==this.FMaxValue?t>=this.FMinValue&&t<=this.FMaxValue:t>=this.FMinRange&&t<=this.FMaxRange},rtl.addIntf(this,pas.System.IUnknown);var i=this.$rtti;i.addProperty("MaxValue",2,rtl.nativeint,"FMaxValue","SetMaxValue",{Default:0}),i.addProperty("MinValue",2,rtl.nativeint,"FMinValue","SetMinValue",{Default:0})})),rtl.createClass(this,"TAutoIncField",this.TIntegerField,(function(){this.SetAsInteger=function(e){t.TIntegerField.SetAsInteger.apply(this,arguments)},this.Create$1=function(e){return t.TIntegerField.Create$1.call(this,e),this.SetDataType(9),this},rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TFloatField",this.TNumericField,(function(){this.$init=function(){t.TNumericField.$init.call(this),this.FCurrency=!1,this.FMaxValue=0,this.FMinValue=0,this.FPrecision=0},this.SetCurrency=function(t){this.FCurrency!==t&&(this.FCurrency=t)},this.SetPrecision=function(t){this.FPrecision=-1===t||t>1?t:2},this.GetAsFloat=function(){var t;return t=this.GetData(),rtl.isNumber(t)?rtl.getNumber(t):0},this.GetAsLargeInt=function(){return Math.round(this.GetAsFloat())},this.GetAsInteger=function(){return Math.round(this.GetAsFloat())},this.GetAsJSValue=function(){var t;return t=this.GetData(),rtl.isNumber(t)?t:null},this.GetAsString=function(){var t;return t=this.GetData(),rtl.isNumber(t)?pas.SysUtils.FloatToStr(rtl.getNumber(t)):""},this.GetText=function(t,e){var i,s,o="",n=0,r=0;t.set(""),s=this.GetData(),rtl.isNumber(s)&&(i=rtl.getNumber(s),o=e||0===this.FEditFormat.length?this.FDisplayFormat:this.FEditFormat,n=0,this.FCurrency?(n=2,r=0):r=1,""!==o?t.set(pas.SysUtils.FormatFloat(o,i)):t.set(pas.SysUtils.FloatToStrF(i,r,this.FPrecision,n)))},this.SetAsFloat=function(t){this.CheckRange(t)?this.SetData(t):this.RangeError(t,this.FMinValue,this.FMaxValue)},this.SetAsInteger=function(t){this.SetAsFloat(t)},this.SetAsString=function(e){var i=0;""===e?this.Clear():(pas.SysUtils.TryStrToFloat$2(e,{get:function(){return i},set:function(t){i=t}})||t.DatabaseErrorFmt(rtl.getResStr(pas.DBConst,"SNotAFloat"),pas.System.VarRecs(18,e)),this.SetAsFloat(i))},this.SetVarValue=function(t){rtl.isNumber(t)?this.SetAsFloat(rtl.getNumber(t)):this.RaiseAccessError("Float")},this.Create$1=function(e){return t.TNumericField.Create$1.call(this,e),this.SetDataType(5),this.FPrecision=15,this},this.CheckRange=function(t){return 0===this.FMinValue&&0===this.FMaxValue||t>=this.FMinValue&&t<=this.FMaxValue},rtl.addIntf(this,pas.System.IUnknown);var e=this.$rtti;e.addProperty("Currency",2,rtl.boolean,"FCurrency","SetCurrency",{Default:!1}),e.addProperty("MaxValue",0,rtl.double,"FMaxValue","FMaxValue"),e.addProperty("MinValue",0,rtl.double,"FMinValue","FMinValue"),e.addProperty("Precision",2,rtl.longint,"FPrecision","SetPrecision",{Default:15})})),rtl.createClass(this,"TBooleanField",this.TField,(function(){this.FDisplays$a$clone=function(t){var e=[];e.length=2;for(var i=0;i<2;i++)e[i]=t[i].slice(0);return e},this.$init=function(){t.TField.$init.call(this),this.FDisplayValues="",this.FDisplays=rtl.arraySetLength(null,"",2,2)},this.$final=function(){this.FDisplays=void 0,t.TField.$final.call(this)},this.SetDisplayValues=function(e){var i=0;this.FDisplayValues!==e&&(((i=pas.System.Pos(";",e))<2||i===e.length)&&t.DatabaseErrorFmt(rtl.getResStr(pas.DBConst,"SInvalidDisplayValues"),pas.System.VarRecs(18,e)),this.FDisplayValues=e,this.FDisplays[0][1]=pas.System.Copy(e,1,i-1),this.FDisplays[1][1]=pas.SysUtils.UpperCase(this.FDisplays[0][1]),this.FDisplays[0][0]=pas.System.Copy(e,i+1,e.length-i),this.FDisplays[1][0]=pas.SysUtils.UpperCase(this.FDisplays[0][0]),this.PropertyChanged(!0))},this.GetAsBoolean=function(){var t;return t=this.GetData(),!!pas.JS.isBoolean(t)&&!(0==t)},this.GetAsString=function(){var t;return t=this.GetData(),pas.JS.isBoolean(t)?this.FDisplays[0][+!(0==t)]:""},this.GetAsJSValue=function(){var t;return t=this.GetData(),pas.JS.isBoolean(t)?!(0==t):null},this.GetAsInteger=function(){return this.GetAsBoolean()+0},this.GetDefaultWidth=function(){var t=0;return(t=this.FDisplays[0][0].length)<this.FDisplays[0][1].length&&(t=this.FDisplays[0][1].length),t},this.SetAsBoolean=function(t){this.SetData(t)},this.SetAsString=function(e){var i;""===(i=pas.SysUtils.UpperCase(e))?this.Clear():1===pas.System.Pos(i,this.FDisplays[1][1])?this.SetAsBoolean(!0):1===pas.System.Pos(i,this.FDisplays[1][0])?this.SetAsBoolean(!1):t.DatabaseErrorFmt(rtl.getResStr(pas.DBConst,"SNotABoolean"),pas.System.VarRecs(18,e))},this.SetAsInteger=function(t){this.SetAsBoolean(0!==t)},this.SetVarValue=function(t){pas.JS.isBoolean(t)?this.SetAsBoolean(!(0==t)):rtl.isNumber(t)&&this.SetAsBoolean(0!==rtl.getNumber(t))},this.Create$1=function(e){return t.TField.Create$1.call(this,e),this.SetDataType(4),this.SetDisplayValues("True;False"),this},rtl.addIntf(this,pas.System.IUnknown),this.$rtti.addProperty("DisplayValues",2,rtl.string,"FDisplayValues","SetDisplayValues")})),rtl.createClass(this,"TDateTimeField",this.TField,(function(){this.$init=function(){t.TField.$init.call(this),this.FDisplayFormat=""},this.SetDisplayFormat=function(t){this.FDisplayFormat!==t&&(this.FDisplayFormat=t,this.PropertyChanged(!0))},this.ConvertToDateTime=function(e,i){return pas.JS.isNull(e)?0:null!=this.FDataSet?this.FDataSet.ConvertToDateTime(this,e,i):t.TDataSet.DefaultConvertToDateTime(this,e,i)},this.DateTimeToNativeDateTime=function(e){return null!=this.FDataSet?this.FDataSet.ConvertDateTimeToNative(this,e):t.TDataSet.DefaultConvertDateTimeToNative(this,e)},this.GetAsDateTime=function(){return this.ConvertToDateTime(this.GetData(),!1)},this.GetAsFloat=function(){return this.GetAsDateTime()},this.GetAsString=function(){var t="";return this.GetText({get:function(){return t},set:function(e){t=e}},!1),t},this.GetAsJSValue=function(){var t=void 0;return t=this.GetData(),rtl.isString(t)||(t=null),t},this.GetDataSize=function(){return t.TField.GetDataSize.call(this)},this.GetText=function(t,e){var i,s="";if(0===(i=this.ConvertToDateTime(this.GetData(),!1)))t.set("");else{if(e&&0!==this.FDisplayFormat.length)s=this.FDisplayFormat;else{var o=this.FDataType;s=7===o?pas.SysUtils.FormatSettings.LongTimeFormat:6===o?pas.SysUtils.FormatSettings.ShortDateFormat:"c"}t.set(pas.SysUtils.FormatDateTime(s,i))}},this.SetAsDateTime=function(t){this.SetData(this.DateTimeToNativeDateTime(t))},this.SetAsFloat=function(t){this.SetAsDateTime(t)},this.SetAsString=function(t){var e=0;""!==t?(e=pas.SysUtils.StrToDateTime(t),this.SetData(this.DateTimeToNativeDateTime(e))):this.SetData(null)},this.SetVarValue=function(t){this.SetAsDateTime(this.ConvertToDateTime(t,!0))},this.Create$1=function(e){return t.TField.Create$1.call(this,e),this.SetDataType(8),this},rtl.addIntf(this,pas.System.IUnknown),this.$rtti.addProperty("DisplayFormat",2,rtl.string,"FDisplayFormat","SetDisplayFormat")})),rtl.createClass(this,"TDateField",this.TDateTimeField,(function(){this.Create$1=function(e){return t.TDateTimeField.Create$1.call(this,e),this.SetDataType(6),this},rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TTimeField",this.TDateTimeField,(function(){this.SetAsString=function(t){var e=0;""!==t?(e=pas.SysUtils.StrToTime(t),this.SetData(this.DateTimeToNativeDateTime(e))):this.SetData(null)},this.Create$1=function(e){return t.TDateTimeField.Create$1.call(this,e),this.SetDataType(7),this},rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TBinaryField",this.TField,(function(){this.CheckTypeSize=function(e){e<1&&t.DatabaseErrorFmt(rtl.getResStr(pas.DBConst,"SInvalidFieldSize"),pas.System.VarRecs(0,e))},this.BlobToBytes=function(e){return null!=this.FDataSet?this.FDataSet.BlobDataToBytes(e):t.TDataSet.DefaultBlobDataToBytes(e)},this.BytesToBlob=function(e){return null!=this.FDataSet?this.FDataSet.BytesToBlobData(rtl.arrayRef(e)):t.TDataSet.DefaultBytesToBlobData(rtl.arrayRef(e))},this.GetAsString=function(){var t,e="",i=[],s=0;if(e="",null!=(t=this.GetData()))if(11===this.FDataType)e=""+t;else{i=this.BlobToBytes(t);for(var o=0,n=rtl.length(i)-1;o<=n;o++)s=o,e=e.concat(String.fromCharCode(i[s]))}return e},this.GetAsJSValue=function(){return this.GetData()},this.SetAsString=function(t){var e=[],i=0;if(11===this.FDataType)this.SetData(t);else{e=rtl.arraySetLength(e,0,t.length);for(var s=1,o=t.length;s<=o;s++)e[(i=s)-1]=t.charCodeAt(i-1);this.SetAsBytes(e)}},this.SetVarValue=function(t){var e=[],i=0,s=0;if(rtl.isArray(t)){s=rtl.length(t),e=rtl.arraySetLength(e,0,s);for(var o=1,n=s-1;o<=n;o++)e[i=o]=t[i];this.SetAsBytes(e)}else rtl.isString(t)?this.SetAsString(""+t):this.RaiseAccessError("Blob")},this.GetAsBytes=function(){var t,e=[];return t=this.GetData(),e=pas.System.Assigned(t)?this.BlobToBytes(t):rtl.arraySetLength(e,0,0)},this.SetAsBytes=function(t){this.SetData(this.BytesToBlob(rtl.arrayRef(t)))},this.Create$1=function(e){return t.TField.Create$1.call(this,e),this},rtl.addIntf(this,pas.System.IUnknown),this.$rtti.addProperty("Size",2,rtl.longint,"FSize","SetSize",{Default:16})})),this.TBlobDisplayValue={0:"dvClass",dvClass:0,1:"dvFull",dvFull:1,2:"dvClip",dvClip:2,3:"dvFit",dvFit:3},this.$rtti.$Enum("TBlobDisplayValue",{minvalue:0,maxvalue:3,ordtype:1,enumtype:this.TBlobDisplayValue}),this.$rtti.$Enum("TBlobType",{minvalue:10,maxvalue:11,ordtype:1,enumtype:this.TFieldType}),rtl.createClass(this,"TBlobField",this.TBinaryField,(function(){this.$init=function(){t.TBinaryField.$init.call(this),this.FDisplayValue=0,this.FModified=!1,this.FBlobType=t.TFieldType.ftBlob},this.GetBlobType=function(){var e=t.TFieldType.ftBlob;return e=this.FBlobType,10===this.FDataType?e=10:11===this.FDataType&&(e=11),e},this.SetBlobType=function(t){this.FBlobType=t,this.SetFieldType(t)},this.SetDisplayValue=function(t){this.FDisplayValue!==t&&(this.FDisplayValue=t,this.PropertyChanged(!1))},this.CheckTypeSize=function(e){e<0&&t.DatabaseErrorFmt(rtl.getResStr(pas.DBConst,"SInvalidFieldSize"),pas.System.VarRecs(0,e))},this.GetBlobSize=function(){var t;return t=this.GetAsBytes(),rtl.length(t)},this.GetIsNull=function(){return this.FModified?0===this.GetBlobSize():t.TField.GetIsNull.call(this)},this.GetText=function(t,e){var i=this.FDisplayValue;0===i?t.set(this.GetClassDesc()):1===i?t.set(this.GetAsString()):2===i?(t.set(this.GetAsString()),e&&t.get().length>this.GetDisplayWidth()&&t.set(pas.System.Copy(this.GetEditText(),1,this.GetDisplayWidth())+"...")):3===i&&(t.set(this.GetAsString()),e&&t.get().length>this.GetDisplayWidth()&&t.set(this.GetClassDesc()))},this.Create$1=function(e){return t.TBinaryField.Create$1.call(this,e),this.SetDataType(10),this},this.Clear=function(){this.SetData(null)},this.IsBlob=function(){return!0,!0},this.SetFieldType=function(t){t in rtl.createSet(10,11)&&this.SetDataType(t)},rtl.addIntf(this,pas.System.IUnknown);var e=this.$rtti;e.addProperty("DisplayValue",2,t.$rtti.TBlobDisplayValue,"FDisplayValue","SetDisplayValue",{Default:t.TBlobDisplayValue.dvClass}),e.addProperty("BlobType",3,t.$rtti.TBlobType,"GetBlobType","SetBlobType"),e.addProperty("Size",2,rtl.longint,"FSize","SetSize",{Default:0})})),rtl.createClass(this,"TMemoField",this.TBlobField,(function(){this.GetText=function(e,i){e.set(t.TBinaryField.GetAsString.call(this))},this.Create$1=function(e){return t.TBlobField.Create$1.call(this,e),this.SetDataType(11),this},rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TVariantField",this.TField,(function(){this.CheckTypeSize=function(t){},this.GetAsBoolean=function(){return 1==this.GetAsJSValue()},this.SetAsBoolean=function(t){this.SetVarValue(t)},this.GetAsDateTime=function(){var e;return e=this.GetData(),null!=this.FDataSet?this.FDataSet.ConvertToDateTime(this,e,!0):t.TDataSet.DefaultConvertToDateTime(this,e,!0)},this.SetAsDateTime=function(t){this.SetVarValue(t)},this.GetAsFloat=function(){var t,e=0;return t=this.GetData(),rtl.isNumber(t)?e=rtl.getNumber(t):rtl.isString(t)?e=parseFloat(""+t):this.RaiseAccessError("Variant"),e},this.SetAsFloat=function(t){this.SetVarValue(t)},this.GetAsInteger=function(){var t,e=0;return t=this.GetData(),pas.JS.isInteger(t)?e=rtl.trunc(t):rtl.isString(t)?e=parseInt(""+t):this.RaiseAccessError("Variant"),e},this.SetAsInteger=function(t){this.SetVarValue(t)},this.GetAsString=function(){var t,e="";return t=this.GetData(),pas.JS.isInteger(t)?e=pas.SysUtils.IntToStr(rtl.trunc(t)):rtl.isNumber(t)?e=pas.SysUtils.FloatToStr(rtl.getNumber(t)):rtl.isString(t)?e=""+t:this.RaiseAccessError("Variant"),e},this.SetAsString=function(t){this.SetVarValue(t)},this.GetAsJSValue=function(){return this.GetData()},this.SetVarValue=function(t){this.SetData(t)},this.Create$1=function(e){return t.TField.Create$1.call(this,e),this.SetDataType(13),this},rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TDataSetField",this.TField,(function(){this.$init=function(){t.TField.$init.call(this),this.FNestedDataSet=null},this.$final=function(){this.FNestedDataSet=void 0,t.TField.$final.call(this)},this.AssignNestedDataSet=function(t){null!=this.FNestedDataSet&&(this.FNestedDataSet.Close(),this.FNestedDataSet.FDataSetField=null,null!=this.FDataSet&&this.FDataSet.GetNestedDataSets().Remove(this.FNestedDataSet)),null!=t&&this.FDataSet.GetNestedDataSets().Add(t),this.FNestedDataSet=t},this.Bind=function(e){t.TField.Bind.apply(this,arguments),null!=this.FNestedDataSet&&(e?0===this.FNestedDataSet.FState&&this.FNestedDataSet.Open():this.FNestedDataSet.Close())},this.Create$1=function(e){return t.TField.Create$1.apply(this,arguments),this.SetDataType(14),this},this.Destroy=function(){this.AssignNestedDataSet(null),t.TField.Destroy.call(this)},rtl.addIntf(this,pas.System.IUnknown)})),this.TIndexOption={0:"ixPrimary",ixPrimary:0,1:"ixUnique",ixUnique:1,2:"ixDescending",ixDescending:2,3:"ixCaseInsensitive",ixCaseInsensitive:3,4:"ixExpression",ixExpression:4,5:"ixNonMaintained",ixNonMaintained:5},this.$rtti.$Enum("TIndexOption",{minvalue:0,maxvalue:5,ordtype:1,enumtype:this.TIndexOption}),this.$rtti.$Set("TIndexOptions",{comptype:this.$rtti.TIndexOption}),rtl.createClass(this,"TIndexDef",this.TNamedItem,(function(){this.$init=function(){t.TNamedItem.$init.call(this),this.FCaseinsFields="",this.FDescFields="",this.FExpression="",this.FFields="",this.FOptions={},this.FSource=""},this.$final=function(){this.FOptions=void 0,t.TNamedItem.$final.call(this)},this.GetExpression=function(){return this.FExpression},this.SetCaseInsFields=function(t){this.FCaseinsFields!==t&&(""!==t&&(this.FOptions=rtl.unionSet(this.FOptions,rtl.createSet(3))),this.FCaseinsFields=t)},this.SetDescFields=function(t){this.FDescFields!==t&&(""!==t&&(this.FOptions=rtl.unionSet(this.FOptions,rtl.createSet(2))),this.FDescFields=t)},this.SetExpression=function(t){this.FExpression=t},this.Assign=function(e){var i=null;i=null,t.TIndexDef.isPrototypeOf(e)&&(i=rtl.as(e,t.TIndexDef)),null!=i?(this.FName=i.FName,this.FFields=i.FFields,this.FOptions=rtl.refSet(i.FOptions),this.FCaseinsFields=i.FCaseinsFields,this.FDescFields=i.FDescFields,this.FSource=i.FSource,this.FExpression=i.GetExpression()):pas.Classes.TPersistent.Assign.call(this,e)};var e=this.$rtti;e.addProperty("Expression",3,rtl.string,"GetExpression","SetExpression"),e.addProperty("Fields",0,rtl.string,"FFields","FFields"),e.addProperty("CaseInsFields",2,rtl.string,"FCaseinsFields","SetCaseInsFields"),e.addProperty("DescFields",2,rtl.string,"FDescFields","SetDescFields"),e.addProperty("Options",0,t.$rtti.TIndexOptions,"FOptions","FOptions"),e.addProperty("Source",0,rtl.string,"FSource","FSource")})),rtl.createClass(this,"TIndexDefs",this.TDefCollection,(function(){this.GetItem$1=function(e){return rtl.as(pas.Classes.TCollection.GetItem.call(this,e),t.TIndexDef)},this.Find$1=function(e){var i;return null===(i=rtl.as(t.TDefCollection.Find.call(this,e),t.TIndexDef))&&t.DatabaseErrorFmt$1(rtl.getResStr(pas.DBConst,"SIndexNotFound"),pas.System.VarRecs(18,e),this.FDataset),i}})),rtl.createClass(this,"TCheckConstraint",pas.Classes.TCollectionItem,(function(){this.$init=function(){pas.Classes.TCollectionItem.$init.call(this),this.FCustomConstraint="",this.FErrorMessage="",this.FFromDictionary=!1,this.FImportedConstraint=""},this.Assign=function(t){};var t=this.$rtti;t.addProperty("CustomConstraint",0,rtl.string,"FCustomConstraint","FCustomConstraint"),t.addProperty("ErrorMessage",0,rtl.string,"FErrorMessage","FErrorMessage"),t.addProperty("FromDictionary",0,rtl.boolean,"FFromDictionary","FFromDictionary"),t.addProperty("ImportedConstraint",0,rtl.string,"FImportedConstraint","FImportedConstraint")})),rtl.createClass(this,"TCheckConstraints",pas.Classes.TCollection,(function(){this.GetOwner=function(){return null,null},this.Create$2=function(e){return pas.Classes.TCollection.Create$1.call(this,t.TCheckConstraint),this}})),rtl.createClass(this,"TFields",pas.System.TObject,(function(){this.$init=function(){pas.System.TObject.$init.call(this),this.FDataset=null,this.FFieldList=null,this.FOnChange=null,this.FValidFieldKinds={}},this.$final=function(){this.FDataset=void 0,this.FFieldList=void 0,this.FOnChange=void 0,this.FValidFieldKinds=void 0,pas.System.TObject.$final.call(this)},this.ClearFieldDefs=function(){for(var t=0,e=0,i=this.GetCount()-1;e<=i;e++)t=e,this.GetField(t).FFieldDef=null},this.Changed=function(){null===this.FDataset||3 in this.FDataset.FComponentState||this.FDataset.DataEvent(9,0),null!=this.FOnChange&&this.FOnChange(this)},this.GetCount=function(){return this.FFieldList.FCount},this.GetField=function(t){return rtl.getObject(this.FFieldList.Get(t))},this.SetFieldIndex=function(t,e){var i;-1!==(i=this.FFieldList.IndexOf(t))&&(e<0&&(e=0),e>=this.GetCount()&&(e=this.GetCount()-1),e!==i&&(this.FFieldList.Delete(i),this.FFieldList.Insert(e,t),t.PropertyChanged(!0),this.Changed()))},this.Create$1=function(t){return this.FDataset=t,this.FFieldList=pas.Classes.TFPList.$create("Create"),this.FValidFieldKinds=rtl.createSet(null,0,3),this},this.Destroy=function(){null!=this.FFieldList&&this.Clear(),pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FFieldList},set:function(t){this.p.FFieldList=t}}),pas.System.TObject.Destroy.call(this)},this.Add=function(t){this.CheckFieldName(t.FFieldName),this.FFieldList.Add(t),t.FFields=this,this.Changed()},this.CheckFieldName=function(e){null!==this.FindField(e)&&t.DatabaseErrorFmt$1(rtl.getResStr(pas.DBConst,"SDuplicateFieldName"),pas.System.VarRecs(18,e),this.FDataset)},this.CheckFieldNames=function(e){var i="",s=0;if(""!==e){s=1;do{i=t.ExtractFieldName(e,{get:function(){return s},set:function(t){s=t}}),this.FieldByName(i)}while(!(s>e.length))}},this.Clear=function(){for(var t=null;this.FFieldList.FCount>0;)(t=rtl.getObject(this.FFieldList.Last())).FDataSet=null,t=rtl.freeLoc(t),this.FFieldList.Delete(this.FFieldList.FCount-1);this.Changed()},this.FindField=function(t){var e,i=null,s=0;e=pas.SysUtils.UpperCase(t);for(var o=0,n=this.FFieldList.FCount-1;o<=n;o++)if(s=o,i=rtl.getObject(this.FFieldList.Get(s)),e===pas.SysUtils.UpperCase(i.FFieldName))return i;return i=null},this.FieldByName=function(e){var i;return null===(i=this.FindField(e))&&t.DatabaseErrorFmt$1(rtl.getResStr(pas.DBConst,"SFieldNotFound"),pas.System.VarRecs(18,e),this.FDataset),i},this.GetFieldNames=function(t){var e=0;t.Clear();for(var i=0,s=this.FFieldList.FCount-1;i<=s;i++)e=i,t.Add(rtl.getObject(this.FFieldList.Get(e)).FFieldName)},this.IndexOf=function(t){return this.FFieldList.IndexOf(t)},this.Remove=function(t){this.FFieldList.Remove(t),t.FFields=null,this.Changed()}})),this.TParamType={0:"ptUnknown",ptUnknown:0,1:"ptInput",ptInput:1,2:"ptOutput",ptOutput:2,3:"ptInputOutput",ptInputOutput:3,4:"ptResult",ptResult:4},this.$rtti.$Enum("TParamType",{minvalue:0,maxvalue:4,ordtype:1,enumtype:this.TParamType}),rtl.createClass(this,"TParam",pas.Classes.TCollectionItem,(function(){this.$init=function(){pas.Classes.TCollectionItem.$init.call(this),this.FValue=void 0,this.FPrecision=0,this.FNumericScale=0,this.FName="",this.FDataType=0,this.FBound=!1,this.FParamType=0,this.FSize=0},this.GetDataSet=function(){return null!=this.FCollection&&t.TParams.isPrototypeOf(this.FCollection)?this.FCollection.GetDataSet():null},this.IsParamStored=function(){return this.FBound},this.AssignParam=function(t){null==t?(this.Clear(),this.FDataType=0,this.FParamType=0,this.FName="",this.FSize=0,this.FPrecision=0,this.FNumericScale=0):(this.FDataType=t.FDataType,t.GetIsNull()?this.Clear():this.FValue=t.FValue,this.FBound=t.FBound,this.FName=t.FName,0===this.FParamType&&(this.FParamType=t.FParamType),this.FSize=t.FSize,this.FPrecision=t.FPrecision,this.FNumericScale=t.FNumericScale)},this.AssignTo=function(e){t.TField.isPrototypeOf(e)?this.AssignToField(e):pas.Classes.TPersistent.AssignTo.call(this,e)},this.GetAsBoolean=function(){return this.GetIsNull()||1!==this.FDataType?!this.GetIsNull()&&1==this.FValue:pas.SysUtils.StrToBool(""+this.FValue)},this.GetAsDateTime=function(){return this.GetIsNull()||1!==this.FDataType?this.GetIsNull()?0:rtl.getNumber(this.FValue):pas.SysUtils.StrToDateTime(""+this.FValue)},this.GetAsFloat=function(){return this.GetIsNull()||1!==this.FDataType?this.GetIsNull()?0:rtl.getNumber(this.FValue):pas.SysUtils.StrToFloat(""+this.FValue)},this.GetAsInteger=function(){return this.GetIsNull()||1!==this.FDataType?this.GetIsNull()||!pas.JS.isInteger(this.FValue)?0:rtl.trunc(this.FValue):pas.SysUtils.StrToInt(""+this.FValue)},this.GetAsString=function(){return this.GetIsNull()||!rtl.isString(this.FValue)?"":""+this.FValue},this.GetAsJSValue=function(){return this.GetIsNull()?null:this.FValue},this.GetIsNull=function(){return pas.JS.isNull(this.FValue)},this.SetAsMemo=function(t){this.FDataType=11,this.SetAsJSValue(t)},this.SetAsJSValue=function(t){if(this.FValue=t,this.FBound=!pas.JS.isNull(t),this.FBound){var e=pas.JS.GetValueType(t);1===e?this.FDataType=4:2===e?this.FDataType=2:3===e?this.FDataType=5:5!==e&&6!==e||(this.FDataType=10)}},this.SetDataType=function(t){this.FDataType=t},this.Create$1=function(t){return pas.Classes.TCollectionItem.Create$1.call(this,t),this.FParamType=0,this.SetDataType(0),this.FValue=null,this},this.Assign=function(e){t.TParam.isPrototypeOf(e)?this.AssignParam(e):t.TField.isPrototypeOf(e)?this.AssignField(e):pas.Classes.TStrings.isPrototypeOf(e)?this.SetAsMemo(e.GetTextStr()):pas.Classes.TPersistent.Assign.call(this,e)},this.AssignField=function(t){null!=t?(this.AssignFieldValue(t,t.GetAsJSValue()),this.FName=t.FFieldName):(this.Clear(),this.FName="")},this.AssignToField=function(e){if(null!=e){var i=this.FDataType;0===i?t.DatabaseErrorFmt$1(rtl.getResStr(pas.DBConst,"SUnknownParamFieldType"),pas.System.VarRecs(18,this.FName),this.GetDataSet()):2===i||9===i?e.SetAsInteger(this.GetAsInteger()):5===i?e.SetAsFloat(this.GetAsFloat()):4===i?e.SetAsBoolean(this.GetAsBoolean()):10===i||1===i||15===i||11===i||12===i?e.SetAsString(this.GetAsString()):7!==i&&6!==i&&8!==i||e.SetAsDateTime(this.GetAsDateTime())}},this.AssignFieldValue=function(t,e){null!=t&&(1===t.FDataType&&t.FFixedChar?this.FDataType=12:11===t.FDataType&&t.FSize>255?this.FDataType=1:this.FDataType=t.FDataType,pas.JS.isNull(e)?this.Clear():this.SetAsJSValue(e),this.FSize=t.GetDataSize(),this.FBound=!0)},this.Clear=function(){this.FValue=null};var e=this.$rtti;e.addProperty("DataType",2,t.$rtti.TFieldType,"FDataType","SetDataType"),e.addProperty("Name",0,rtl.string,"FName","FName"),e.addProperty("NumericScale",0,rtl.longint,"FNumericScale","FNumericScale",{Default:0}),e.addProperty("ParamType",0,t.$rtti.TParamType,"FParamType","FParamType"),e.addProperty("Precision",0,rtl.longint,"FPrecision","FPrecision",{Default:0}),e.addProperty("Size",0,rtl.longint,"FSize","FSize",{Default:0}),e.addProperty("Value",15,rtl.jsvalue,"GetAsJSValue","SetAsJSValue",{stored:"IsParamStored"})})),rtl.createClass(this,"TParams",pas.Classes.TCollection,(function(){this.$init=function(){pas.Classes.TCollection.$init.call(this),this.FOwner=null},this.$final=function(){this.FOwner=void 0,pas.Classes.TCollection.$final.call(this)},this.AssignTo=function(e){t.TParams.isPrototypeOf(e)?e.Assign(this):pas.Classes.TPersistent.AssignTo.call(this,e)},this.GetDataSet=function(){return t.TDataSet.isPrototypeOf(this.FOwner)?this.FOwner:null},this.GetOwner=function(){return this.FOwner}})),this.TBookmarkFlag={0:"bfCurrent",bfCurrent:0,1:"bfBOF",bfBOF:1,2:"bfEOF",bfEOF:2,3:"bfInserted",bfInserted:3},rtl.recNewT(this,"TBookmark",(function(){this.Data=void 0,this.Flag=0,this.$eq=function(t){return this.Data===t.Data&&this.Flag===t.Flag},this.$assign=function(t){return this.Data=t.Data,this.Flag=t.Flag,this}})),this.TGetMode={0:"gmCurrent",gmCurrent:0,1:"gmNext",gmNext:1,2:"gmPrior",gmPrior:2},this.TGetResult={0:"grOK",grOK:0,1:"grBOF",grBOF:1,2:"grEOF",grEOF:2,3:"grError",grError:3},this.TResyncMode$a={0:"rmExact",rmExact:0,1:"rmCenter",rmCenter:1},this.TDataAction={0:"daFail",daFail:0,1:"daAbort",daAbort:1,2:"daRetry",daRetry:2},this.$rtti.$Enum("TDataAction",{minvalue:0,maxvalue:2,ordtype:1,enumtype:this.TDataAction}),this.TLocateOption={0:"loCaseInsensitive",loCaseInsensitive:0,1:"loPartialKey",loPartialKey:1,2:"loFromCurrent",loFromCurrent:2},this.$rtti.$MethodVar("TDataSetNotifyEvent",{procsig:rtl.newTIProcSig([["DataSet",this.$rtti.TDataSet]]),methodkind:0}),this.$rtti.$MethodVar("TDataSetErrorEvent",{procsig:rtl.newTIProcSig([["DataSet",this.$rtti.TDataSet],["E",this.$rtti.EDatabaseError],["DataAction",this.$rtti.TDataAction,1]]),methodkind:0}),this.TLoadOption={0:"loNoOpen",loNoOpen:0,1:"loNoEvents",loNoEvents:1,2:"loAtEOF",loAtEOF:2,3:"loCancelPending",loCancelPending:3},this.$rtti.$MethodVar("TFilterRecordEvent",{procsig:rtl.newTIProcSig([["DataSet",this.$rtti.TDataSet],["Accept",rtl.boolean,1]]),methodkind:0}),this.TRecordState={0:"rsNew",rsNew:0,1:"rsClean",rsClean:1,2:"rsUpdate",rsUpdate:2,3:"rsDelete",rsDelete:3},rtl.recNewT(this,"TDataRecord",(function(){this.data=void 0,this.state=0,this.bookmark=void 0,this.bookmarkFlag=0,this.$eq=function(t){return this.data===t.data&&this.state===t.state&&this.bookmark===t.bookmark&&this.bookmarkFlag===t.bookmarkFlag},this.$assign=function(t){return this.data=t.data,this.state=t.state,this.bookmark=t.bookmark,this.bookmarkFlag=t.bookmarkFlag,this}})),rtl.createClass(this,"TDataSet",pas.Classes.TComponent,(function(){this.$init=function(){pas.Classes.TComponent.$init.call(this),this.FAfterLoad=null,this.FBeforeLoad=null,this.FBlockReadSize=0,this.FCalcBuffer=t.TDataRecord.$new(),this.FCalcFieldsCount=0,this.FOnLoadFail=null,this.FOpenAfterRead=!1,this.FActiveRecord=0,this.FAfterCancel=null,this.FAfterClose=null,this.FAfterDelete=null,this.FAfterEdit=null,this.FAfterInsert=null,this.FAfterOpen=null,this.FAfterPost=null,this.FAfterScroll=null,this.FAutoCalcFields=!1,this.FBOF=!1,this.FBeforeCancel=null,this.FBeforeClose=null,this.FBeforeDelete=null,this.FBeforeEdit=null,this.FBeforeInsert=null,this.FBeforeOpen=null,this.FBeforePost=null,this.FBeforeScroll=null,this.FBlobFieldCount=0,this.FBuffers=[],this.FBufferCount=0,this.FConstraints=null,this.FDisableControlsCount=0,this.FDisableControlsState=0,this.FCurrentRecord=0,this.FDataSources=null,this.FDefaultFields=!1,this.FEOF=!1,this.FEnableControlsEvent=0,this.FFieldList=null,this.FFieldDefs=null,this.FFilterText="",this.FFiltered=!1,this.FInternalCalcFields=!1,this.FModified=!1,this.FOnCalcFields=null,this.FOnDeleteError=null,this.FOnEditError=null,this.FOnFilterRecord=null,this.FOnNewRecord=null,this.FOnPostError=null,this.FRecordCount=0,this.FIsUniDirectional=!1,this.FState=0,this.FInternalOpenComplete=!1,this.FDataProxy=null,this.FDataRequestID=0,this.FChangeList=null,this.FLoadCount=0,this.FMinLoadID=0,this.FDataSetField=null,this.FNestedDataSets=null,this.FNestedDataSetClass=null},this.$final=function(){this.FAfterLoad=void 0,this.FBeforeLoad=void 0,this.FCalcBuffer=void 0,this.FOnLoadFail=void 0,this.FAfterCancel=void 0,this.FAfterClose=void 0,this.FAfterDelete=void 0,this.FAfterEdit=void 0,this.FAfterInsert=void 0,this.FAfterOpen=void 0,this.FAfterPost=void 0,this.FAfterScroll=void 0,this.FBeforeCancel=void 0,this.FBeforeClose=void 0,this.FBeforeDelete=void 0,this.FBeforeEdit=void 0,this.FBeforeInsert=void 0,this.FBeforeOpen=void 0,this.FBeforePost=void 0,this.FBeforeScroll=void 0,this.FBuffers=void 0,this.FConstraints=void 0,this.FDataSources=void 0,this.FFieldList=void 0,this.FFieldDefs=void 0,this.FOnCalcFields=void 0,this.FOnDeleteError=void 0,this.FOnEditError=void 0,this.FOnFilterRecord=void 0,this.FOnNewRecord=void 0,this.FOnPostError=void 0,this.FDataProxy=void 0,this.FChangeList=void 0,this.FDataSetField=void 0,this.FNestedDataSets=void 0,this.FNestedDataSetClass=void 0,pas.Classes.TComponent.$final.call(this)},this.DoInsertAppend=function(e){var i=this;function s(e){var s=t.TBookmark.$new(),o=t.TDataRecord.$new(),n=0;if(i.FRecordCount>0&&s.$assign(i.GetBookmark()),e)i.FRecordCount===i.FBufferCount?i.ShiftBuffersBackward():i.FRecordCount>0&&(i.FActiveRecord+=1);else if(i.FRecordCount>0){o.$assign(i.FBuffers[i.FBufferCount]);for(var r=i.FBufferCount,a=i.FActiveRecord+1;r>=a;r--)n=r,i.FBuffers[n].$assign(i.FBuffers[n-1]);i.FBuffers[i.FActiveRecord].$assign(o)}i.InitRecord(i.FBuffers[i.FActiveRecord]),i.CursorPosChanged(),0===i.FRecordCount?i.SetBookmarkFlag(i.FBuffers[i.FActiveRecord],2):(i.FBOF=!1,i.FRecordCount>0&&(i.SetBookmarkData(i.FBuffers[i.FActiveRecord],t.TBookmark.$clone(s)),i.FreeBookmark(t.TBookmark.$clone(s)))),i.InternalInsert(),i.FRecordCount<i.FBufferCount&&(i.FRecordCount+=1)}this.CheckBrowseMode(),this.GetCanModify()||t.DatabaseError$1(rtl.getResStr(pas.DBConst,"SDatasetReadOnly"),i),this.DoBeforeInsert(),this.DoBeforeScroll(),e?(this.ClearBuffers(),this.InternalLast(),this.GetPriorRecords(),this.FRecordCount>0&&(this.FActiveRecord=this.FRecordCount-1),s(!0),this.SetBookmarkFlag(this.FBuffers[this.FActiveRecord],2),this.FBOF=!1,this.FEOF=!0):s(!1),this.SetState(3);try{this.DoOnNewRecord()}catch(t){throw this.SetCurrentRecord(this.FActiveRecord),this.Resync({}),t}this.FModified=!1,this.DataEvent(2,0),this.DoAfterInsert(),this.DoAfterScroll()},this.DoInternalOpen=function(){this.InternalOpen(),this.FInternalOpenComplete=!0,this.FRecordCount=0,this.RecalcBufListSize(),this.FBOF=!0,this.FEOF=0===this.FRecordCount,this.InitChangeList()},this.GetDataProxy=function(){return null===this.FDataProxy&&this.SetDataProxy(this.DoGetDataProxy()),this.FDataProxy},this.RegisterDataSource=function(t){this.FDataSources.Add(t),this.RecalcBufListSize()},this.SetDataProxy=function(t){t!==this.FDataProxy&&(null!=this.FDataProxy&&this.FDataProxy.RemoveFreeNotification(this),this.FDataProxy=t,null!=this.FDataProxy&&this.FDataProxy.FreeNotification(this))},this.ShiftBuffersForward=function(){var e=t.TDataRecord.$new(),i=0;e.$assign(this.FBuffers[this.FBufferCount]);for(var s=this.FBufferCount;s>=1;s--)i=s,this.FBuffers[i].$assign(this.FBuffers[i-1]);this.FBuffers[0].$assign(e)},this.ShiftBuffersBackward=function(){var e=t.TDataRecord.$new(),i=0;e.$assign(this.FBuffers[0]);for(var s=1,o=this.FBufferCount;s<=o;s++)i=s,this.FBuffers[i-1].$assign(this.FBuffers[i]);this.FBuffers[this.FBufferCount].$assign(e)},this.TryDoing=function(e,i){var s=0;for(!0,s=2;2===s;)try{return this.UpdateCursorPos(),e(),!0}catch(e){if(!t.EDatabaseError.isPrototypeOf(e))throw e;s=0,null!=i&&i(this,e,{get:function(){return s},set:function(t){s=t}});if(0===s)throw e;1===s&&pas.SysUtils.Abort()}return!0},this.GetActive=function(){return 0!==this.FState&&12!==this.FState},this.UnRegisterDataSource=function(t){this.FDataSources.Remove(t)},this.HandleRequestResponse=function(t){var e=!1;if(null!=t)if(t.FRequestID<=this.FMinLoadID)t.$destroy("Destroy");else{this.FLoadCount-=1;var i=t.FSuccess;0===i?null!=this.FOnLoadFail&&this.FOnLoadFail(this,t.FRequestID,t.FErrorMsg):1!==i&&2!==i||(e=!1,null!=t.FEvent&&t.FEvent(this,t.FData),1!==t.FSuccess&&(e=this.DataPacketReceived(t)),this.GetActive()||0 in t.FLoadOptions?(2 in t.FLoadOptions&&e&&(this.FEOF=!1),1 in t.FLoadOptions||this.DoAfterLoad()):(1 in t.FLoadOptions||this.DoAfterLoad(),this.Open())),t.$destroy("Destroy")}},this.GetNestedDataSets=function(){return null==this.FNestedDataSets&&(this.FNestedDataSets=pas.Classes.TFPList.$create("Create")),this.FNestedDataSets},this.DataPacketReceived=function(t){return!1,!1},this.DoLoad=function(t,e){var i,s=null;return 1 in t||this.DoBeforeLoad(),(i=null!==this.GetDataProxy())?((s=this.GetDataProxy().GetDataRequest(rtl.refSet(t),rtl.createCallback(this,"HandleRequestResponse"),e)).FDataset=this,this.GetActive()&&s.FBookmark.$assign(this.GetBookmark()),this.FDataRequestID+=1,s.FRequestID=this.FDataRequestID,this.GetDataProxy().DoGetData(s)?this.FLoadCount+=1:s=rtl.freeLoc(s),i):i},this.DoGetDataProxy=function(){return null,null},this.InitChangeList=function(){this.DoneChangeList(),this.FChangeList=pas.Classes.TFPList.$create("Create")},this.DoneChangeList=function(){this.ClearChangeList(),pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FChangeList},set:function(t){this.p.FChangeList=t}})},this.ClearChangeList=function(){var t=0;if(null!=this.FChangeList)for(var e=0,i=this.FChangeList.FCount-1;e<=i;e++)t=e,rtl.getObject(this.FChangeList.Get(t)).$destroy("Destroy"),this.FChangeList.Put(t,null)},this.GetApplyUpdateData=function(t){return t.data},this.IndexInChangeList=function(e){var i=0;if(i=-1,null==this.FChangeList)return i;for(i=this.FChangeList.FCount-1;i>=0&&0!==this.CompareBookmarks(t.TBookmark.$clone(e),t.TBookmark.$clone(rtl.getObject(this.FChangeList.Get(i)).FBookmark));)i-=1;return i},this.AddToChangeList=function(e){var i,s=null,o=t.TBookmark.$new(),n=void 0;if(s=null,null==this.FChangeList)return s;if(o.$assign(this.GetBookmark()),-1===(i=this.IndexInChangeList(t.TBookmark.$clone(o))))n=this.GetApplyUpdateData(t.TDataRecord.$clone(this.ActiveBuffer())),s=null!=this.GetDataProxy()?this.GetDataProxy().GetUpdateDescriptor(this,t.TBookmark.$clone(o),n,e):t.TRecordUpdateDescriptor.$create("Create$1",[null,this,t.TBookmark.$clone(o),n,e]),this.FChangeList.Add(s);else{s=rtl.getObject(this.FChangeList.Get(i));var r=e;2===r?1===s.FStatus?this.FChangeList.Delete(i):s.FStatus=2:1===r?t.DatabaseError$1(rtl.getResStr(pas.DBConst,"SErrInsertingSameRecordtwice"),this):0===r&&(s.FData=this.GetApplyUpdateData(t.TDataRecord.$clone(this.ActiveBuffer())))}return s},this.RemoveFromChangeList=function(t){null!=t&&this.FChangeList},this.RecalcBufListSize=function(){var t=0,e=0,i=0,s=null;if(this.IsCursorOpen()){i=this.FIsUniDirectional?1:10;for(var o=0,n=this.FDataSources.FCount-1;o<=n;o++){t=o;for(var r=0,a=rtl.getObject(this.FDataSources.Get(t)).FDataLinks.GetCount()-1;r<=a;r++)e=r,i<(s=rtl.getObject(rtl.getObject(this.FDataSources.Get(t)).FDataLinks.Get(e))).GetBufferCount()&&(i=s.GetBufferCount())}this.FBufferCount!==i&&(this.SetBufListSize(i),this.GetNextRecords(),this.FRecordCount<this.FBufferCount&&!this.FIsUniDirectional&&(this.FActiveRecord=this.FActiveRecord+this.GetPriorRecords(),this.CursorPosChanged()))}},this.ActivateBuffers=function(){this.FBOF=!1,this.FEOF=!1,this.FActiveRecord=0},this.BindFields=function(e){var i=0,s=0,o=null,n=null;this.FCalcFieldsCount=0,this.FBlobFieldCount=0;for(var r=0,a=this.FFieldList.GetCount()-1;r<=a;r++)i=r,(n=this.FFieldList.GetField(i)).FFieldDef=null,e?n.FFieldKind in rtl.createSet(1,2)?(n.FFieldNo=-1,this.FCalcFieldsCount+=1):-1===(s=this.FFieldDefs.IndexOf(n.FFieldName))?t.DatabaseErrorFmt$1(rtl.getResStr(pas.DBConst,"SFieldNotFound"),pas.System.VarRecs(18,n.FFieldName),this):(o=this.FFieldDefs.GetItem$1(s),n.FFieldDef=o,n.FFieldNo=o.FFieldNo,o.FInternalCalcField&&(this.FInternalCalcFields=!0),n.$class.IsBlob()&&(n.FSize=o.FSize,this.FBlobFieldCount+=1)):n.FFieldNo=0,n.Bind(e)},this.BlockReadNext=function(){this.MoveBy(1)};var e=rtl.createSet(1,2,3);this.BookmarkAvailable=function(){return!this.IsEmpty()&&!this.FIsUniDirectional&&this.FState in e&&0===this.GetBookmarkFlag(t.TDataRecord.$clone(this.ActiveBuffer()))},this.CalculateFields=function(t){var e=0;if(this.FCalcBuffer.$assign(t),11!==this.FState&&(this.ClearCalcFields(this.FCalcBuffer),!this.FIsUniDirectional))for(var i=0,s=this.FFieldList.GetCount()-1;i<=s;i++)e=i,2===this.FFieldList.GetField(e).FFieldKind&&this.FFieldList.GetField(e).CalcLookupValue();this.DoOnCalcFields()},this.CheckActive=function(){this.GetActive()||t.DatabaseError$1(rtl.getResStr(pas.DBConst,"SInactiveDataset"),this)},this.CheckInactive=function(){this.GetActive()&&t.DatabaseError$1(rtl.getResStr(pas.DBConst,"SActiveDataset"),this)},this.CheckBiDirectional=function(){this.FIsUniDirectional&&t.DatabaseError$1(rtl.getResStr(pas.DBConst,"SUniDirectional"),this)},this.Loaded=function(){pas.Classes.TComponent.Loaded.call(this);try{this.FOpenAfterRead&&this.SetActive(!0)}catch(e){if(!pas.SysUtils.Exception.isPrototypeOf(e))throw e;var t=e;4 in this.FComponentState&&this.InternalHandleException(t)}},this.ClearBuffers=function(){this.FRecordCount=0,this.FActiveRecord=0,this.FCurrentRecord=-1,this.FBOF=!0,this.FEOF=!0},this.ClearCalcFields=function(t){},this.CloseCursor=function(){this.ClearBuffers(),this.SetBufListSize(0),this.FFieldList.ClearFieldDefs(),this.InternalClose(),this.FInternalOpenComplete=!1},this.CreateFields=function(){for(var t=0,e=0,i=this.FFieldDefs.GetCount()-1;e<=i;e++){t=e;var s=this.FFieldDefs.GetItem$1(t);0!==s.FDataType&&s.CreateField(this)}},this.DataEvent=function(t,e){var i=this;var s,o=0,n=t;if(0===n?((s=rtl.getObject(e)).FFieldKind in rtl.createSet(0,3)&&i.SetModified(!0),4!==i.FState&&(0===s.FFieldKind&&(i.FInternalCalcFields?i.RefreshInternalCalcFields(i.FBuffers[i.FActiveRecord]):i.FAutoCalcFields&&0!==i.FCalcFieldsCount&&i.CalculateFields(i.FBuffers[i.FActiveRecord])),s.Change())):2===n||3===n?function(){var t=0,e=null;if(3!==i.FState&&i.UpdateCursorPos(),null!=i.FNestedDataSets)for(var s=0,o=i.GetNestedDataSets().FCount-1;s<=o;s++)t=s,(e=rtl.getObject(i.GetNestedDataSets().Get(t))).GetActive()&&e.DataEvent(11,0)}():4===n&&(this.FEnableControlsEvent=4),!this.ControlsDisabled()&&10!==this.FState)for(var r=0,a=this.FDataSources.FCount-1;r<=a;r++)o=r,rtl.getObject(this.FDataSources.Get(o)).ProcessEvent(t,e)},this.DestroyFields=function(){this.FFieldList.Clear()},this.DoAfterCancel=function(){null!=this.FAfterCancel&&this.FAfterCancel(this)},this.DoAfterClose=function(){null==this.FAfterClose||3 in this.FComponentState||this.FAfterClose(this)},this.DoAfterDelete=function(){null!=this.FAfterDelete&&this.FAfterDelete(this)},this.DoAfterEdit=function(){null!=this.FAfterEdit&&this.FAfterEdit(this)},this.DoAfterInsert=function(){null!=this.FAfterInsert&&this.FAfterInsert(this)},this.DoAfterOpen=function(){null!=this.FAfterOpen&&this.FAfterOpen(this)},this.DoAfterPost=function(){null!=this.FAfterPost&&this.FAfterPost(this)},this.DoAfterScroll=function(){null!=this.FAfterScroll&&this.FAfterScroll(this)},this.DoBeforeCancel=function(){null!=this.FBeforeCancel&&this.FBeforeCancel(this)},this.DoBeforeClose=function(){null==this.FBeforeClose||3 in this.FComponentState||this.FBeforeClose(this)},this.DoBeforeDelete=function(){null!=this.FBeforeDelete&&this.FBeforeDelete(this)},this.DoBeforeEdit=function(){null!=this.FBeforeEdit&&this.FBeforeEdit(this)},this.DoBeforeInsert=function(){null!=this.FBeforeInsert&&this.FBeforeInsert(this)},this.DoBeforeOpen=function(){null!=this.FBeforeOpen&&this.FBeforeOpen(this)},this.DoBeforePost=function(){null!=this.FBeforePost&&this.FBeforePost(this)},this.DoBeforeScroll=function(){null!=this.FBeforeScroll&&this.FBeforeScroll(this)},this.DoOnCalcFields=function(){null!=this.FOnCalcFields&&this.FOnCalcFields(this)},this.DoOnNewRecord=function(){null!=this.FOnNewRecord&&this.FOnNewRecord(this)},this.DoBeforeLoad=function(){null!=this.FBeforeLoad&&this.FBeforeLoad(this)},this.DoAfterLoad=function(){null!=this.FAfterLoad&&this.FAfterLoad(this)},this.GetCalcFields=function(t){var e=0;if(this.FCalcFieldsCount>0||this.FInternalCalcFields){e=this.FState,this.FState=5;try{this.CalculateFields(t)}finally{this.FState=e}}},this.GetCanModify=function(){return!this.FIsUniDirectional},this.GetChildren=function(t,e){for(var i=0,s=null,o=0,n=this.FFieldList.GetCount()-1;o<=n;o++)i=o,(s=this.FFieldList.GetField(i)).FOwner===e&&t(s)},this.GetFieldClass=function(e){return t.DefaultFieldClasses[e]},this.GetfieldCount=function(){return this.FFieldList.GetCount()},this.GetFieldValues=function(t){var e=void 0,i=0,s=null,o=[];s=pas.Classes.TList.$create("Create$1");try{if(this.GetFieldList(s,t),s.GetCount()>1){o=rtl.arraySetLength(o,void 0,s.GetCount());for(var n=0,r=s.GetCount()-1;n<=r;n++)o[i=n]=rtl.getObject(s.Get(i)).GetAsJSValue();e=o}else e=this.FieldByName(t).GetAsJSValue()}finally{s=rtl.freeLoc(s)}return e},this.GetNextRecords=function(){var t=0;for(t=0;this.FRecordCount<this.FBufferCount&&this.GetNextRecord();)t+=1;return t},this.GetNextRecord=function(){var e,i=t.TDataRecord.$new();return this.FRecordCount>0&&this.SetCurrentRecord(this.FRecordCount-1),(e=0===this.GetRecord(this.FBuffers[this.FBufferCount],1,!0))?(0===this.FRecordCount&&this.ActivateBuffers(),this.FRecordCount===this.FBufferCount?this.ShiftBuffersBackward():(this.FRecordCount+=1,this.FCurrentRecord=this.FRecordCount-1,i.$assign(this.FBuffers[this.FCurrentRecord]),this.FBuffers[this.FCurrentRecord].$assign(this.FBuffers[this.FBufferCount]),this.FBuffers[this.FBufferCount].$assign(i))):this.CursorPosChanged(),e},this.GetPriorRecords=function(){var t=0;for(t=0;this.FRecordCount<this.FBufferCount&&this.GetPriorRecord();)t+=1;return t},this.GetPriorRecord=function(){var t;return this.CheckBiDirectional(),this.FRecordCount>0&&this.SetCurrentRecord(0),(t=0===this.GetRecord(this.FBuffers[this.FBufferCount],2,!0))?(0===this.FRecordCount&&this.ActivateBuffers(),this.ShiftBuffersForward(),this.FRecordCount<this.FBufferCount&&(this.FRecordCount+=1)):this.CursorPosChanged(),t},this.GetRecNo=function(){return-1,-1},this.InitRecord=function(t){this.InternalInitRecord(t),this.ClearCalcFields(t)},this.InternalCancel=function(){},this.InternalEdit=function(){},this.InternalInsert=function(){},this.OpenCursor=function(t){t?this.InternalInitFieldDefs():12!==this.FState&&this.DoInternalOpen()},this.OpenCursorcomplete=function(){try{12===this.FState&&this.DoInternalOpen()}finally{this.FInternalOpenComplete?(this.SetState(1),this.DoAfterOpen(),this.IsEmpty()||this.DoAfterScroll()):(this.SetState(0),this.CloseCursor())}},this.RefreshInternalCalcFields=function(t){},this.RestoreState=function(t){this.FState=t,this.FDisableControlsCount-=1},this.SetActive=function(t){if(t&&0===this.FState){if(0 in this.FComponentState)return void(this.FOpenAfterRead=!0);this.DoBeforeOpen(),this.FEnableControlsEvent=4,this.FInternalCalcFields=!1;try{this.FDefaultFields=0===this.GetfieldCount(),this.OpenCursor(!1)}finally{12!==this.FState&&this.OpenCursorcomplete()}this.FModified=!1}else t||0===this.FState||(this.DoBeforeClose(),this.SetState(0),this.FDataRequestID=0,this.DoneChangeList(),this.CloseCursor(),this.DoAfterClose(),this.FModified=!1)},this.SetBufListSize=function(e){var i=0;if(e<0&&(e=0),e!==this.FBufferCount){if(e>this.FBufferCount){this.FBuffers=rtl.arraySetLength(this.FBuffers,t.TDataRecord,e+1);for(var s=this.FBufferCount,o=e;s<=o;s++)i=s,this.FBuffers[i].$assign(this.AllocRecordBuffer())}else if(e<this.FBufferCount&&e>=0&&this.FActiveRecord>e-1){for(var n=0,r=this.FActiveRecord-e;n<=r;n++)i=n,this.ShiftBuffersBackward();this.FActiveRecord=e-1}this.FBuffers=rtl.arraySetLength(this.FBuffers,t.TDataRecord,e+1),this.FBufferCount=e,this.FRecordCount>this.FBufferCount&&(this.FRecordCount=this.FBufferCount)}},this.SetChildOrder=function(e,i){var s=null;s=rtl.as(e,t.TField),this.FFieldList.IndexOf(s)>=0&&s.SetIndex(i)},this.SetCurrentRecord=function(e){if(this.FCurrentRecord!==e){if(!this.FIsUniDirectional){var i=this.GetBookmarkFlag(t.TDataRecord.$clone(this.FBuffers[e]));0===i?this.InternalSetToRecord(t.TDataRecord.$clone(this.FBuffers[e])):1===i?this.InternalFirst():2===i&&this.InternalLast()}this.FCurrentRecord=e}},this.SetModified=function(t){this.FModified=t},this.SetName=function(t){var e=this;function i(t){var i="",s=0,o=0;for(i=t,s=0,o=0;s<e.FFieldList.GetCount();)i===e.FFieldList.GetField(s).FFieldName?(o+=1,i=t+pas.SysUtils.IntToStr(o)):s+=1;return i}var s,o=0,n="";if(e.FName!==t&&(s=e.FName,pas.Classes.TComponent.SetName.call(this,t),4 in this.FComponentState))for(var r=0,a=this.FFieldList.GetCount()-1;r<=a;r++)o=r,n=s+this.FFieldList.GetField(o).FFieldName,pas.System.Copy(this.FFieldList.GetField(o).FName,1,n.length)===n&&this.FFieldList.GetField(o).SetName(i(t+this.FFieldList.GetField(o).FFieldName))},this.SetOnFilterRecord=function(t){this.CheckBiDirectional(),this.FOnFilterRecord=t},this.SetRecNo=function(t){},this.SetState=function(t){t!==this.FState&&(this.FState=t,1===t&&(this.FModified=!1),this.DataEvent(6,0))},this.SetTempState=function(t){var e;return e=this.FState,this.FState=t,this.FDisableControlsCount+=1,e},this.AllocRecordBuffer=function(){var e=t.TDataRecord.$new();return e.data=null,e.state=0,e},this.FreeRecordBuffer=function(t){},this.GetBookmarkData=function(t,e){},this.GetBookmarkFlag=function(t){return 0,0},this.GetDataSource=function(){return null,null},this.InternalDelete=function(){},this.InternalFirst=function(){},this.InternalGotoBookmark=function(t){},this.InternalHandleException=function(t){pas.SysUtils.ShowException(t,null)},this.InternalInitRecord=function(t){},this.InternalLast=function(){},this.InternalPost=function(){var e=this;!function(){for(var i=0,s=0,o=e.FFieldList.GetCount()-1;s<=o;s++){i=s;var n=e.FFieldList.GetField(i);n.FRequired&&!n.FReadOnly&&0===n.FFieldKind&&9!==n.FDataType&&n.GetIsNull()&&t.DatabaseErrorFmt$1(rtl.getResStr(pas.DBConst,"SNeedField"),pas.System.VarRecs(18,n.GetDisplayName()),e)}}()},this.InternalSetToRecord=function(t){},this.SetBookmarkFlag=function(t,e){},this.SetBookmarkData=function(t,e){},this.Notification=function(t,e){pas.Classes.TComponent.Notification.call(this,t,e),1===e&&t===this.FDataProxy&&(this.FDataProxy=null)},this.SetDataSetField=function(e){e!==this.FDataSetField&&(null!==e&&(e.FDataSet===this||null!==e.FDataSet.GetDataSource()&&e.FDataSet.GetDataSource().FDataSet===this)&&t.DatabaseError$1(rtl.getResStr(pas.DBConst,"SCircularDataLink"),this),null==e||this.$class.InheritsFrom(e.FDataSet.FNestedDataSetClass)||t.DatabaseErrorFmt$1(rtl.getResStr(pas.DBConst,"SNestedDataSetClass"),pas.System.VarRecs(18,e.FDataSet.FNestedDataSetClass.$classname),this),this.GetActive()&&this.Close(),null!=this.FDataSetField&&this.FDataSetField.AssignNestedDataSet(null),this.FDataSetField=e,null!=e&&(e.AssignNestedDataSet(this),e.FDataSet.GetActive()&&this.Open()))},this.GetFieldData=function(e){return this.GetFieldData$1(e,t.TDataRecord.$clone(this.ActiveBuffer()))},this.SetFieldData=function(t,e){this.SetFieldData$1(t,this.FBuffers[this.FActiveRecord],e)},this.GetFieldData$1=function(t,e){var i=void 0;return i=e.data[t.FFieldName],pas.JS.isUndefined(i)&&(i=null),i},this.SetFieldData$1=function(t,e,i){e.data[t.FFieldName]=i},this.FieldDefsClass=function(){return t.TFieldDefs},this.FieldsClass=function(){return t.TFields},this.Create$1=function(e){return pas.Classes.TComponent.Create$1.call(this,e),this.FFieldDefs=this.$class.FieldDefsClass().$create("Create$4",[this]),this.FFieldList=this.$class.FieldsClass().$create("Create$1",[this]),this.FDataSources=pas.Classes.TFPList.$create("Create"),this.FConstraints=t.TCheckConstraints.$create("Create$2",[this]),this.FBuffers=rtl.arraySetLength(this.FBuffers,t.TDataRecord,1),this.FActiveRecord=0,this.FEOF=!0,this.FBOF=!0,this.FIsUniDirectional=!1,this.FAutoCalcFields=!0,this.FDataRequestID=0,this.FNestedDataSetClass=this.$class.ClassType(),this},this.Destroy=function(){var e=0;this.SetActive(!1),this.SetDataSetField(null),rtl.free(this,"FFieldDefs"),rtl.free(this,"FFieldList"),rtl.free(this,"FNestedDataSets");for(var i=this.FDataSources;i.FCount>0;)rtl.getObject(i.Get(i.FCount-1)).SetDataSet(null);i.$destroy("Destroy");for(var s=0,o=this.FBufferCount;s<=o;s++)e=s,this.FreeRecordBuffer(this.FBuffers[e]);rtl.free(this,"FConstraints"),this.FBuffers=rtl.arraySetLength(this.FBuffers,t.TDataRecord,1),pas.Classes.TComponent.Destroy.call(this)},this.ActiveBuffer=function(){var e=t.TDataRecord.$new();return-1!==this.FActiveRecord?e.$assign(this.FBuffers[this.FActiveRecord]):e.$assign(t.TDataRecord.$new()),e},this.Append=function(){this.DoInsertAppend(!0)},this.BookmarkValid=function(t){return!1,!1},this.ConvertToDateTime=function(t,e,i){return this.$class.DefaultConvertToDateTime(t,e,i)},this.ConvertDateTimeToNative=function(t,e){return this.$class.DefaultConvertDateTimeToNative(t,e)},this.DefaultConvertToDateTime=function(t,e,i){var s=0;if(s=0,rtl.isString(e)){if(!pas.DateUtils.TryRFC3339ToDateTime(""+e,{get:function(){return s},set:function(t){s=t}}))throw pas.SysUtils.EConvertError.$create("CreateFmt",[rtl.getResStr(pas.DBConst,"SErrInvalidDateTime"),pas.System.VarRecs(18,""+e)])}else rtl.isNumber(e)?s=rtl.getNumber(e):pas.JS.isDate(e)&&(s=pas.SysUtils.JSDateToDateTime(e));return s},this.DefaultConvertDateTimeToNative=function(t,e){return pas.DateUtils.DateTimeToRFC3339(e)},this.BlobDataToBytes=function(t){return this.$class.DefaultBlobDataToBytes(t)},this.DefaultBlobDataToBytes=function(t){var e=[],i="",s=0,o=0,n=0;if(e=rtl.arraySetLength(e,0,0),rtl.isString(t))for(n=(i=""+t).length,e=rtl.arraySetLength(e,0,rtl.trunc((n+1)/2)),s=1,o=0;s<n;)try{e[o]=pas.SysUtils.StrToInt("$"+pas.System.Copy(i,s,2)),s+=2,o+=1}catch(t){e[o]=i.charCodeAt(s-1),s+=1,o+=1}return e},this.BytesToBlobData=function(t){return this.$class.DefaultBytesToBlobData(rtl.arrayRef(t))},this.DefaultBytesToBlobData=function(t){var e=void 0,i="",s=0;if(0===rtl.length(t))e=null;else{i="";for(var o=0,n=rtl.length(t)-1;o<=n;o++)s=o,i=i.concat(pas.SysUtils.IntToHex(t[s],2));e=i}return e},this.Cancel=function(){this.FState in rtl.createSet(2,3)&&(this.DataEvent(7,0),this.DoBeforeCancel(),this.UpdateCursorPos(),this.InternalCancel(),3===this.FState&&1===this.FRecordCount?(this.FEOF=!0,this.FBOF=!0,this.FRecordCount=0,this.InitRecord(this.FBuffers[this.FActiveRecord]),this.SetState(1),this.DataEvent(2,0)):(this.SetState(1),this.SetCurrentRecord(this.FActiveRecord),this.Resync({})),this.DoAfterCancel())},this.CheckBrowseMode=function(){this.CheckActive(),this.DataEvent(7,0);var t=this.FState;2===t||3===t?(this.UpdateRecord(),this.FModified?this.Post():this.Cancel()):4===t&&this.Post()},this.Close=function(){this.SetActive(!1)},this.ControlsDisabled=function(){return this.FDisableControlsCount>0},this.CompareBookmarks=function(t,e){return 0,0},this.CursorPosChanged=function(){this.FCurrentRecord=-1},this.Delete=function(){var e=null;if(this.GetCanModify()||t.DatabaseError$1(rtl.getResStr(pas.DBConst,"SDatasetReadOnly"),this),this.IsEmpty()&&t.DatabaseError$1(rtl.getResStr(pas.DBConst,"SDatasetEmpty"),this),this.FState in rtl.createSet(3))this.Cancel();else{if(this.DataEvent(7,0),this.DoBeforeDelete(),this.DoBeforeScroll(),e=this.AddToChangeList(2),!this.TryDoing(rtl.createCallback(this,"InternalDelete"),this.FOnDeleteError))return void(null!=e&&this.RemoveFromChangeList(e));this.SetState(1),this.SetCurrentRecord(this.FActiveRecord),this.Resync({}),this.DoAfterDelete(),this.DoAfterScroll()}},this.DisableControls=function(){0===this.FDisableControlsCount&&(this.FDisableControlsState=this.FState,this.FEnableControlsEvent=2),this.FDisableControlsCount+=1},this.Edit=function(){this.FState in rtl.createSet(2,3)||(this.CheckBrowseMode(),this.GetCanModify()||t.DatabaseError$1(rtl.getResStr(pas.DBConst,"SDatasetReadOnly"),this),0!==this.FRecordCount?(this.DoBeforeEdit(),this.TryDoing(rtl.createCallback(this,"InternalEdit"),this.FOnEditError)&&(this.GetCalcFields(this.FBuffers[this.FActiveRecord]),this.SetState(2),this.DataEvent(1,0),this.DoAfterEdit())):this.Append())},this.EnableControls=function(){this.FDisableControlsCount>0&&(this.FDisableControlsCount-=1),0===this.FDisableControlsCount&&(this.FState!==this.FDisableControlsState&&this.DataEvent(6,0),0!==this.FState&&0!==this.FDisableControlsState&&this.DataEvent(this.FEnableControlsEvent,0))},this.FieldByName=function(e){var i;return null===(i=this.FindField(e))&&t.DatabaseErrorFmt$1(rtl.getResStr(pas.DBConst,"SFieldNotFound"),pas.System.VarRecs(18,e),this),i},this.FindField=function(t){return this.FFieldList.FindField(t)},this.First=function(){this.CheckBrowseMode(),this.DoBeforeScroll(),this.FIsUniDirectional?this.FBOF||(this.SetActive(!1),this.SetActive(!0)):this.ClearBuffers();try{this.InternalFirst(),this.FIsUniDirectional||this.GetNextRecords()}finally{this.FBOF=!0,this.DataEvent(2,0),this.DoAfterScroll()}},this.FreeBookmark=function(t){},this.GetBookmark=function(){var e=t.TBookmark.$new();return this.BookmarkAvailable()?this.GetBookmarkData(t.TDataRecord.$clone(this.ActiveBuffer()),e):e.Data=null,e},this.GetFieldList=function(e,i){var s=null,o="",n=0;if(""!==i&&null!==e){n=1;do{o=t.ExtractFieldName(i,{get:function(){return n},set:function(t){n=t}}),s=this.FieldByName(o),e.Add(s)}while(!(n>i.length))}},this.GetFieldList$1=function(e,i){var s=null,o="",n=0;if(""!==i&&null!==e){n=1;do{o=t.ExtractFieldName(i,{get:function(){return n},set:function(t){n=t}}),s=this.FieldByName(o),e.Add(s)}while(!(n>i.length))}},this.GetFieldNames=function(t){this.FFieldList.GetFieldNames(t)},this.GotoBookmark=function(e){pas.JS.isNull(e.Data)||(this.CheckBrowseMode(),this.DoBeforeScroll(),this.InternalGotoBookmark(t.TBookmark.$clone(e)),this.Resync(rtl.createSet(0,1)),this.DoAfterScroll())},this.Insert$1=function(){this.DoInsertAppend(!1)},this.IsEmpty=function(){return this.FBOF&&this.FEOF&&!(3===this.FState)},this.IsSequenced=function(){return!0,!0},this.Last=function(){this.CheckBiDirectional(),this.CheckBrowseMode(),this.DoBeforeScroll(),this.ClearBuffers();try{this.InternalLast(),this.GetPriorRecords(),this.FRecordCount>0&&(this.FActiveRecord=this.FRecordCount-1)}finally{this.FEOF=!0,this.DataEvent(2,0),this.DoAfterScroll()}},this.Load=function(e,i){return 2 in e&&t.DatabaseError$1(rtl.getResStr(pas.DBConst,"SatEOFInternalOnly"),this),3 in e&&this.CancelLoading(),this.DoLoad(rtl.refSet(e),i)},this.Lookup=function(t,e,i){return this.CheckBiDirectional(),null,null},this.MoveBy=function(t){var e=this,i=0,s=0;var o=0;if(this.CheckBrowseMode(),i=0,s=0,this.DoBeforeScroll(),0===t||t>0&&this.FEOF||t<0&&this.FBOF)return i;try{o=0,o=t>0?function(){var i=0;for(i=0,e.FBOF=!1;t>0&&!e.FEOF;)e.FActiveRecord<e.FRecordCount-1?(e.FActiveRecord+=1,t-=1,s+=1):e.GetNextRecord()?(t-=1,i-=1,s+=1):(e.FEOF=!0,e.DoLoad(rtl.createSet(0,2),null));return i}():function(){var i=0;for(e.CheckBiDirectional(),i=0,e.FEOF=!1;t<0&&!e.FBOF;)e.FActiveRecord>0?(e.FActiveRecord-=1,t+=1,s-=1):e.GetPriorRecord()?(t+=1,i+=1,s-=1):e.FBOF=!0;return i}()}finally{this.DataEvent(3,o),this.DoAfterScroll(),i=s}return i},this.Next=function(){this.FBlockReadSize>0?this.BlockReadNext():this.MoveBy(1)},this.Open=function(){this.SetActive(!0)};var i=[0,1];this.Post=function(){var e=null,s=!1;if(this.UpdateRecord(),this.FState in rtl.createSet(2,3)){if(this.DataEvent(7,0),this.DoBeforePost(),s=3===this.FState,!this.TryDoing(rtl.createCallback(this,"InternalPost"),this.FOnPostError))return;this.CursorPosChanged(),this.SetState(1),this.Resync({}),null!=(e=this.AddToChangeList(i[+s]))&&e.FBookmark.$assign(this.GetBookmark()),this.DoAfterPost()}else 4!==this.FState&&t.DatabaseErrorFmt$1(rtl.getResStr(pas.DBConst,"SNotEditing"),pas.System.VarRecs(18,this.FName),this)},this.Prior=function(){this.MoveBy(-1)},this.Resync=function(e){var i=0,s=0;if(!this.FIsUniDirectional){if(0!==this.GetRecord(this.FBuffers[0],0,!1))if(0 in e)t.DatabaseError$1(rtl.getResStr(pas.DBConst,"SNoSuchRecord"),this);else if(0!==this.GetRecord(this.FBuffers[0],1,!0)&&0!==this.GetRecord(this.FBuffers[0],2,!0))return this.ClearBuffers(),this.InternalInitRecord(this.FBuffers[this.FActiveRecord]),void this.DataEvent(2,0);this.FCurrentRecord=0,this.FEOF=!1,this.FBOF=!1,s=1 in e?rtl.trunc(this.FRecordCount/2):this.FActiveRecord,i=0,this.FRecordCount=1,this.FActiveRecord=0;for(;i<s&&this.GetPriorRecord();)i+=1;this.FActiveRecord=i,this.GetNextRecords(),this.FRecordCount<this.FBufferCount&&(this.FActiveRecord=this.FActiveRecord+this.GetPriorRecords()),this.DataEvent(2,0)}},this.CancelLoading=function(){this.FMinLoadID=this.FDataRequestID,this.FLoadCount=0},this.UpdateCursorPos=function(){this.FRecordCount>0&&this.SetCurrentRecord(this.FActiveRecord)},this.UpdateRecord=function(){this.FState in t.dsEditModes||t.DatabaseErrorFmt$1(rtl.getResStr(pas.DBConst,"SNotEditing"),pas.System.VarRecs(18,this.FName),this),this.DataEvent(5,0)},rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TDataLink",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FFirstRecord=0,this.FBufferCount=0,this.FActive=!1,this.FDataSourceFixed=!1,this.FEditing=!1,this.FReadOnly=!1,this.FUpdatingRecord=!1,this.FVisualControl=!1,this.FDataSource=null},this.$final=function(){this.FDataSource=void 0,pas.Classes.TPersistent.$final.call(this)},this.CalcFirstRecord=function(t){var e=0;return e=this.FDataSource.FDataSet.FActiveRecord>this.FFirstRecord+t+this.FBufferCount-1?this.FDataSource.FDataSet.FActiveRecord-(this.FFirstRecord+t+this.FBufferCount-1):this.FDataSource.FDataSet.FActiveRecord<this.FFirstRecord+t?this.FDataSource.FDataSet.FActiveRecord-(this.FFirstRecord+t):0,this.FFirstRecord+=t+e,e},this.CalcRange=function(){var t=0,e=0;(e=this.GetDataset().FActiveRecord-this.FBufferCount+1)<0&&(e=0),(t=this.GetDataset().FBufferCount-this.FBufferCount)<0&&(t=0),t>this.GetDataset().FActiveRecord&&(t=this.GetDataset().FActiveRecord),this.FFirstRecord<e&&(this.FFirstRecord=e),this.FFirstRecord>t&&(this.FFirstRecord=t),0!==this.FFirstRecord&&this.GetDataset().FActiveRecord-this.FFirstRecord<this.FBufferCount-1&&(this.FFirstRecord-=1)},this.CheckActiveAndEditing=function(){var e=!1;(e=null!=this.FDataSource&&!(this.FDataSource.FState in rtl.createSet(0,12)))!==this.FActive&&(this.FActive=e,this.ActiveChanged()),(e=null!=this.FDataSource&&this.FDataSource.FState in t.dsEditModes&&!this.FReadOnly)!==this.FEditing&&(this.FEditing=e,this.EditingChanged())},this.GetDataset=function(){return null!=this.FDataSource?this.FDataSource.FDataSet:null},this.SetActive=function(t){this.FActive!==t&&(this.FActive=t,this.ActiveChanged())},this.SetDataSource=function(t){this.FDataSource!==t&&(this.FDataSourceFixed||(null!=this.FDataSource&&(this.FDataSource.UnregisterDataLink(this),this.FDataSource=null,this.CheckActiveAndEditing()),this.FDataSource=t,null!=this.FDataSource&&(this.FDataSource.RegisterDataLink(this),this.CheckActiveAndEditing())))},this.ActiveChanged=function(){this.FFirstRecord=0},this.CheckBrowseMode=function(){},this.DataEvent=function(t,e){if(6===t)this.CheckActiveAndEditing();else if(this.FActive){var i=t;0===i||1===i?this.FUpdatingRecord||this.RecordChanged(rtl.getObject(e)):2===i?(this.SetActive(this.FDataSource.FDataSet.GetActive()),this.CalcRange(),this.CalcFirstRecord(rtl.trunc(e)),this.DataSetChanged()):3===i?this.DataSetScrolled(this.CalcFirstRecord(rtl.trunc(e))):4===i?(this.CalcFirstRecord(rtl.trunc(e)),this.LayoutChanged()):5===i?this.UpdateRecord():7===i?this.CheckBrowseMode():10===i&&this.FocusControl(e)}},this.DataSetChanged=function(){this.RecordChanged(null)},this.DataSetScrolled=function(t){this.DataSetChanged()},this.EditingChanged=function(){},this.FocusControl=function(t){},this.GetActiveRecord=function(){return this.GetDataset().FActiveRecord-this.FFirstRecord},this.GetBufferCount=function(){return this.FBufferCount},this.GetRecordCount=function(){var t=0;return(t=this.GetDataset().FRecordCount)>this.GetBufferCount()&&(t=this.GetBufferCount()),t},this.LayoutChanged=function(){this.DataSetChanged()},this.MoveBy=function(t){return this.GetDataset().MoveBy(t)},this.RecordChanged=function(t){},this.SetActiveRecord=function(t){this.GetDataset().FActiveRecord=t+this.FFirstRecord},this.SetBufferCount=function(t){this.FBufferCount!==t&&(this.FBufferCount=t,this.FActive&&(this.GetDataset().RecalcBufListSize(),this.CalcRange()))},this.UpdateData=function(){},this.Create$1=function(){return pas.System.TObject.Create.call(this),this.FBufferCount=1,this.FFirstRecord=0,this.FDataSource=null,this.FDataSourceFixed=!1,this},this.Destroy=function(){this.FActive=!1,this.FEditing=!1,this.FDataSourceFixed=!1,this.SetDataSource(null),pas.System.TObject.Destroy.call(this)},this.UpdateRecord=function(){this.FUpdatingRecord=!0;try{this.UpdateData()}finally{this.FUpdatingRecord=!1}}})),this.$rtti.$MethodVar("TDataChangeEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["Field",this.$rtti.TField]]),methodkind:0}),rtl.createClass(this,"TDataSource",pas.Classes.TComponent,(function(){this.$init=function(){pas.Classes.TComponent.$init.call(this),this.FDataSet=null,this.FDataLinks=null,this.FEnabled=!1,this.FAutoEdit=!1,this.FState=0,this.FOnStateChange=null,this.FOnDataChange=null,this.FOnUpdateData=null},this.$final=function(){this.FDataSet=void 0,this.FDataLinks=void 0,this.FOnStateChange=void 0,this.FOnDataChange=void 0,this.FOnUpdateData=void 0,pas.Classes.TComponent.$final.call(this)},this.DistributeEvent=function(t,e){for(var i=0,s=this.FDataLinks,o=0,n=s.GetCount()-1;o<=n;o++){i=o;var r=rtl.getObject(s.Get(i));r.FVisualControl||r.DataEvent(t,e)}for(var a=0,l=s.GetCount()-1;a<=l;a++){i=a;var h=rtl.getObject(s.Get(i));h.FVisualControl&&h.DataEvent(t,e)}},this.RegisterDataLink=function(t){this.FDataLinks.Add(t),null!=this.FDataSet&&this.FDataSet.RecalcBufListSize()};var e=rtl.createSet(1,2,3,4,6);this.ProcessEvent=function(t,i){var s=!1,o=0;if(6===t){if(s=0===this.FState,o=this.FState,null!=this.FDataSet&&this.FEnabled?this.FState=this.FDataSet.FState:this.FState=0,this.FState===o)return}else s=!0;this.DistributeEvent(t,i),3 in this.FComponentState||(6===t&&this.DoStateChange(),t in e&&s&&this.DoDataChange(null),0===t&&this.DoDataChange(i),5===t&&this.DoUpdateData())},this.SetDataSet=function(t){null!==this.FDataSet&&(this.FDataSet.UnRegisterDataSource(this),this.FDataSet=null,this.ProcessEvent(6,0)),null!==t&&(t.RegisterDataSource(this),this.FDataSet=t,this.ProcessEvent(6,0))},this.SetEnabled=function(t){this.FEnabled=t,this.ProcessEvent(6,0)},this.UnregisterDataLink=function(t){this.FDataLinks.Remove(t),null!==this.FDataSet&&this.FDataSet.RecalcBufListSize()},this.DoDataChange=function(t){null!=this.FOnDataChange&&(null!=t?this.FOnDataChange(this,t):this.FOnDataChange(this,null))},this.DoStateChange=function(){null!=this.FOnStateChange&&this.FOnStateChange(this)},this.DoUpdateData=function(){null!=this.FOnUpdateData&&this.FOnUpdateData(this)},this.Create$1=function(t){return pas.Classes.TComponent.Create$1.call(this,t),this.FDataLinks=pas.Classes.TList.$create("Create$1"),this.FEnabled=!0,this.FAutoEdit=!0,this},this.Destroy=function(){this.FOnStateChange=null,this.SetDataSet(null);for(var t=this.FDataLinks;t.GetCount()>0;)rtl.getObject(t.Get(t.GetCount()-1)).SetDataSource(null);rtl.free(this,"FDataLinks"),pas.Classes.TComponent.Destroy.call(this)},rtl.addIntf(this,pas.System.IUnknown);var i=this.$rtti;i.addProperty("AutoEdit",0,rtl.boolean,"FAutoEdit","FAutoEdit",{Default:!0}),i.addProperty("DataSet",2,t.$rtti.TDataSet,"FDataSet","SetDataSet"),i.addProperty("Enabled",2,rtl.boolean,"FEnabled","SetEnabled",{Default:!0}),i.addProperty("OnStateChange",0,pas.Classes.$rtti.TNotifyEvent,"FOnStateChange","FOnStateChange"),i.addProperty("OnDataChange",0,t.$rtti.TDataChangeEvent,"FOnDataChange","FOnDataChange"),i.addProperty("OnUpdateData",0,pas.Classes.$rtti.TNotifyEvent,"FOnUpdateData","FOnUpdateData")})),this.TDataRequestResult={0:"rrFail",rrFail:0,1:"rrEOF",rrEOF:1,2:"rrOK",rrOK:2},rtl.createClass(this,"TDataRequest",pas.System.TObject,(function(){this.$init=function(){pas.System.TObject.$init.call(this),this.FBookmark=t.TBookmark.$new(),this.FDataset=null,this.FErrorMsg="",this.FEvent=null,this.FLoadOptions={},this.FRequestID=0,this.FSuccess=0,this.FData=void 0,this.FAfterRequest=null,this.FDataProxy=null},this.$final=function(){this.FBookmark=void 0,this.FDataset=void 0,this.FEvent=void 0,this.FLoadOptions=void 0,this.FAfterRequest=void 0,this.FDataProxy=void 0,pas.System.TObject.$final.call(this)},this.DoAfterRequest=function(){null!=this.FAfterRequest&&this.FAfterRequest(this)},this.Create$1=function(t,e,i,s){return this.FDataProxy=t,this.FLoadOptions=rtl.refSet(e),this.FEvent=s,this.FAfterRequest=i,this}})),rtl.createClass(this,"TRecordUpdateDescriptor",pas.System.TObject,(function(){this.$init=function(){pas.System.TObject.$init.call(this),this.FBookmark=t.TBookmark.$new(),this.FData=void 0,this.FDataset=null,this.FProxy=null,this.FStatus=0},this.$final=function(){this.FBookmark=void 0,this.FDataset=void 0,this.FProxy=void 0,pas.System.TObject.$final.call(this)},this.Create$1=function(t,e,i,s,o){return this.FDataset=e,this.FBookmark.$assign(i),this.FData=s,this.FStatus=o,this.FProxy=t,this}})),rtl.createClass(this,"TDataProxy",pas.Classes.TComponent,(function(){this.GetDataRequestClass=function(){return t.TDataRequest},this.GetUpdateDescriptorClass=function(){return t.TRecordUpdateDescriptor},this.GetDataRequest=function(t,e,i){return this.GetDataRequestClass().$create("Create$1",[this,rtl.refSet(t),e,i])},this.GetUpdateDescriptor=function(e,i,s,o){return this.GetUpdateDescriptorClass().$create("Create$1",[this,e,t.TBookmark.$clone(i),s,o])},rtl.addIntf(this,pas.System.IUnknown)})),this.Fieldtypenames=["Unknown","String","Integer","NativeInt","Boolean","Float","Date","Time","DateTime","AutoInc","Blob","Memo","FixedChar","Variant","Dataset","WideString"],this.DefaultFieldClasses=[this.TField,this.TStringField,this.TIntegerField,this.TLargeintField,this.TBooleanField,this.TFloatField,this.TDateField,this.TTimeField,this.TDateTimeField,this.TAutoIncField,this.TBlobField,this.TMemoField,this.TStringField,this.TVariantField,null,this.TStringField],this.dsEditModes=rtl.createSet(2,3,4),this.DatabaseError=function(e){throw t.EDatabaseError.$create("Create$1",[e])},this.DatabaseError$1=function(e,i){if(null!=i&&""!==i.FName)throw t.EDatabaseError.$create("CreateFmt",["%s : %s",pas.System.VarRecs(18,i.FName,18,e)]);t.DatabaseError(e)},this.DatabaseErrorFmt=function(e,i){throw t.EDatabaseError.$create("CreateFmt",[e,i])},this.DatabaseErrorFmt$1=function(e,i,s){if(null!=s)throw t.EDatabaseError.$create("CreateFmt",[pas.SysUtils.Format("%s : %s",pas.System.VarRecs(18,s.FName,18,e)),i]);t.DatabaseErrorFmt(e,i)},this.ExtractFieldName=function(t,e){var i,s,o=0;for(o=e.get(),s=t.length;o<=s&&";"!==t.charAt(o-1);)o+=1;return i=pas.SysUtils.Trim(pas.System.Copy(t,e.get(),o-e.get())),o<=s&&";"===t.charAt(o-1)&&(o+=1),e.set(o),i},t.$implcode=function(){e.DefaultBufferCount=10,e.SBoolean="Boolean",e.SDateTime="TDateTime",e.SFloat="Float",e.SInteger="Integer",e.SLargeInt="NativeInt",e.SJSValue="JSValue",e.SString="String"}}),["DBConst","TypInfo"]),rtl.module("fpexprpars",["System","Classes","SysUtils","contnrs"],(function(){"use strict";var t=this,e=t.$impl;this.TTokenType={0:"ttPlus",ttPlus:0,1:"ttMinus",ttMinus:1,2:"ttLessThan",ttLessThan:2,3:"ttLargerThan",ttLargerThan:3,4:"ttEqual",ttEqual:4,5:"ttDiv",ttDiv:5,6:"ttMod",ttMod:6,7:"ttMul",ttMul:7,8:"ttLeft",ttLeft:8,9:"ttRight",ttRight:9,10:"ttLessThanEqual",ttLessThanEqual:10,11:"ttLargerThanEqual",ttLargerThanEqual:11,12:"ttunequal",ttunequal:12,13:"ttNumber",ttNumber:13,14:"ttString",ttString:14,15:"ttIdentifier",ttIdentifier:15,16:"ttComma",ttComma:16,17:"ttAnd",ttAnd:17,18:"ttOr",ttOr:18,19:"ttXor",ttXor:19,20:"ttTrue",ttTrue:20,21:"ttFalse",ttFalse:21,22:"ttNot",ttNot:22,23:"ttif",ttif:23,24:"ttCase",ttCase:24,25:"ttPower",ttPower:25,26:"ttEOF",ttEOF:26},this.ttComparisons=rtl.createSet(3,2,11,10,4,12),this.$rtti.$Class("TFPExpressionParser"),this.$rtti.$ClassRef("TFPExprFunctionClass",{instancetype:this.$rtti.TFPExprFunction}),this.TNumberKind={0:"nkDecimal",nkDecimal:0,1:"nkHex",nkHex:1,2:"nkOctal",nkOctal:2,3:"nkBinary",nkBinary:3},rtl.createClass(this,"TFPExpressionScanner",pas.System.TObject,(function(){this.$init=function(){pas.System.TObject.$init.call(this),this.FSource="",this.LSource=0,this.FPos=0,this.FChar="",this.FToken="",this.FTokenType=0},this.GetCurrentChar=function(){return this.FChar},this.ScanError=function(e){throw t.EExprScanner.$create("Create$1",[e])},this.SetSource=function(t){this.FSource=t,this.LSource=this.FSource.length,this.FTokenType=26,0===this.LSource?(this.FPos=0,this.FChar=e.cNull):(this.FPos=1,this.FChar=this.FSource.charAt(0)),this.FToken=""},this.DoIdentifier=function(){var i,s="";for(s=this.GetCurrentChar();!this.IsWordDelim(s)&&s!==e.cNull;){if('"'!==s)this.FToken=this.FToken+s;else{for(s=this.NextPos();!(s.charCodeAt()in rtl.createSet(e.cNull.charCodeAt(),34));)this.FToken=this.FToken+s,s=this.NextPos();'"'!==s&&this.ScanError(pas.SysUtils.Format(rtl.getResStr(t,"SErrUnterminatedIdentifier"),pas.System.VarRecs(18,this.FToken)))}s=this.NextPos()}return"or"===(i=pas.SysUtils.LowerCase(this.FToken))?18:"xor"===i?19:"and"===i?17:"true"===i?20:"false"===i?21:"not"===i?22:"if"===i?23:"case"===i?24:"mod"===i?6:15},this.DoNumber=function(i){var s=this,o="",n=0,r=0,a="";function l(t,i){var o=!1;if(!(o=s.IsDigit(t,i))){var n=i;0===n?o=""!==s.FToken&&"E"===pas.System.upcase(t)||""!==s.FToken&&t.charCodeAt()in rtl.createSet(43,45)&&"E"===a:1===n?o=t===e.cHexIdentifier&&"\0"===a:2===n?o=t===e.cOctalIdentifier&&"\0"===a:3===n&&(o=t===e.cBinaryIdentifier&&"\0"===a)}return o}for(o=this.GetCurrentChar(),a="\0";o!==e.cNull;){if(this.IsWordDelim(o)){var h=i;if(0===h){if(!(a.charCodeAt()in rtl.createSet(69,45,43)))break}else{if(1===h||2===h)break;if(3===h&&"\0"!==a)break}}l(o,i)||this.ScanError(pas.SysUtils.Format(rtl.getResStr(t,"SErrInvalidNumberChar"),pas.System.VarRecs(9,o))),this.FToken=this.FToken+o,a=pas.System.upcase(o),o=this.NextPos()}return pas.System.val$8(this.FToken,{get:function(){return n},set:function(t){n=t}},{get:function(){return r},set:function(t){r=t}}),0!==r&&this.ScanError(pas.SysUtils.Format(rtl.getResStr(t,"SErrInvalidNumber"),pas.System.VarRecs(18,this.FToken))),13,13},this.DoDelimiter=function(){var e,i,s=0,o="";if(o=this.FChar,this.FToken=o,e=o.charCodeAt()in rtl.createSet(60,62),i=o,o=this.NextPos(),e&&o.charCodeAt()in rtl.createSet(61,62))this.FToken=this.FToken+o,this.NextPos(),s=">"===i?11:">"===o?12:10;else{"+"===i?s=0:"-"===i?s=1:"<"===i?s=2:">"===i?s=3:"="===i?s=4:"/"===i?s=5:"*"===i?s=7:"("===i?s=8:")"===i?s=9:","===i?s=16:"^"===i?s=25:this.ScanError(pas.SysUtils.Format(rtl.getResStr(t,"SUnknownDelimiter"),pas.System.VarRecs(9,i)))}return s},this.DoString=function(){var i=this;function s(t){return t===e.cNull||t===e.cSingleQuote&&!(i.FPos<i.LSource&&i.FSource.charAt(i.FPos+1-1)===e.cSingleQuote)}var o="";for(this.FToken="",o=this.NextPos();!s(o);)this.FToken=this.FToken+o,o===e.cSingleQuote&&this.NextPos(),o=this.NextPos();return o===e.cNull&&this.ScanError(rtl.getResStr(t,"SBadQuotes")),14,this.FTokenType=14,this.NextPos(),14},this.NextPos=function(){return this.FPos+=1,this.FPos>this.FSource.length?this.FChar=e.cNull:this.FChar=this.FSource.charAt(this.FPos-1),this.FChar},this.SkipWhiteSpace=function(){for(;this.FChar.charCodeAt()in e.WhiteSpace&&this.FPos<=this.LSource;)this.NextPos()},this.IsWordDelim=function(t){return t.charCodeAt()in e.WordDelimiters},this.IsDelim=function(t){return t.charCodeAt()in e.Delimiters},this.IsDigit=function(t,i){var s=!1,o=i;return 0===o?s=t.charCodeAt()in e.Digits:1===o?s=t.charCodeAt()in e.HexDigits:2===o?s=t.charCodeAt()in e.OctalDigits:3===o&&(s=t.charCodeAt()in e.BinaryDigits),s},this.IsAlpha=function(t){return t.charCodeAt()in rtl.createSet(null,65,90,null,97,122)},this.Create$1=function(){return this.SetSource(""),this},this.GetToken=function(){var i,s=0;return this.FToken="",this.SkipWhiteSpace(),(i=this.FChar)===e.cNull?s=26:this.IsDelim(i)?s=this.DoDelimiter():i===e.cSingleQuote?s=this.DoString():i===e.cHexIdentifier?s=this.DoNumber(1):i===e.cOctalIdentifier?s=this.DoNumber(2):i===e.cBinaryIdentifier?s=this.DoNumber(3):this.IsDigit(i,0)?s=this.DoNumber(0):this.IsAlpha(i)||'"'===i?s=this.DoIdentifier():this.ScanError(pas.SysUtils.Format(rtl.getResStr(t,"SErrUnknownCharacter"),pas.System.VarRecs(0,this.FPos,9,i))),this.FTokenType=s,s}})),rtl.createClass(this,"EExprScanner",pas.SysUtils.Exception,(function(){})),this.TResultType={0:"rtBoolean",rtBoolean:0,1:"rtInteger",rtInteger:1,2:"rtFloat",rtFloat:2,3:"rtDateTime",rtDateTime:3,4:"rtString",rtString:4,5:"rtCurrency",rtCurrency:5},this.$rtti.$Enum("TResultType",{minvalue:0,maxvalue:5,ordtype:1,enumtype:this.TResultType}),rtl.recNewT(this,"TFPExpressionResult",(function(){this.ResultType=0,this.resValue=void 0,this.$eq=function(t){return this.ResultType===t.ResultType&&this.resValue===t.resValue},this.$assign=function(t){return this.ResultType=t.ResultType,this.resValue=t.resValue,this};var e=t.$rtti.$Record("TFPExpressionResult",{});e.addField("ResultType",t.$rtti.TResultType),e.addField("resValue",rtl.jsvalue)})),this.$rtti.$DynArray("TExprParameterArray",{eltype:this.$rtti.TFPExpressionResult}),rtl.createClass(this,"TFPExprNode",pas.System.TObject,(function(){this.CheckNodeType=function(i,s){var o="",n=0;if(null===i&&e.RaiseParserError(rtl.getResStr(t,"SErrNoNodeToCheck")),!(i.NodeType()in s)){for(o="",n=0;n<=5;n++)n in s&&(""!==o&&(o+=","),o+=t.ResultTypeName(n));e.RaiseParserError$1(rtl.getResStr(t,"SInvalidNodeType"),pas.System.VarRecs(18,t.ResultTypeName(i.NodeType()),18,o,18,i.AsString()))}}})),rtl.createClass(this,"TFPBinaryOperation",this.TFPExprNode,(function(){this.$init=function(){t.TFPExprNode.$init.call(this),this.FLeft=null,this.FRight=null},this.$final=function(){this.FLeft=void 0,this.FRight=void 0,t.TFPExprNode.$final.call(this)},this.CheckSameNodeTypes=function(){var i,s;i=this.FLeft.NodeType(),(s=this.FRight.NodeType())!==i&&e.RaiseParserError$1(rtl.getResStr(t,"SErrTypesDoNotMatch"),pas.System.VarRecs(18,t.ResultTypeName(i),18,t.ResultTypeName(s),18,this.FLeft.AsString(),18,this.FRight.AsString()))},this.Create$1=function(t,e){return this.FLeft=t,this.FRight=e,this},this.Destroy=function(){pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FLeft},set:function(t){this.p.FLeft=t}}),pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FRight},set:function(t){this.p.FRight=t}}),pas.System.TObject.Destroy.call(this)},this.Check=function(){null==this.FLeft&&e.RaiseParserError$1(rtl.getResStr(t,"SErrNoleftOperand"),pas.System.VarRecs(18,this.$classname)),null==this.FRight&&e.RaiseParserError$1(rtl.getResStr(t,"SErrNoRightOperand"),pas.System.VarRecs(18,this.$classname))}})),rtl.createClass(this,"TFPBooleanOperation",this.TFPBinaryOperation,(function(){this.Check=function(){t.TFPBinaryOperation.Check.call(this),this.CheckNodeType(this.FLeft,rtl.createSet(1,0)),this.CheckNodeType(this.FRight,rtl.createSet(1,0)),this.CheckSameNodeTypes()},this.NodeType=function(){return this.FLeft.NodeType()}})),rtl.createClass(this,"TFPBinaryAndOperation",this.TFPBooleanOperation,(function(){this.GetNodeValue=function(){var e=t.TFPExpressionResult.$new(),i=t.TFPExpressionResult.$new();e.$assign(this.FLeft.GetNodeValue()),i.$assign(this.FRight.GetNodeValue());var s=e.ResultType;return 0===s?e.resValue=!(0==e.resValue||0==i.resValue):1===s&&(e.resValue=rtl.and(rtl.trunc(e.resValue),rtl.trunc(i.resValue))),e},this.AsString=function(){return this.FLeft.AsString()+" and "+this.FRight.AsString()}})),rtl.createClass(this,"TFPBinaryOrOperation",this.TFPBooleanOperation,(function(){this.GetNodeValue=function(){var e=t.TFPExpressionResult.$new(),i=t.TFPExpressionResult.$new();e.$assign(this.FLeft.GetNodeValue()),i.$assign(this.FRight.GetNodeValue());var s=e.ResultType;return 0===s?e.resValue=!(0==e.resValue&&0==i.resValue):1===s&&(e.resValue=rtl.or(rtl.trunc(e.resValue),rtl.trunc(i.resValue))),e},this.AsString=function(){return this.FLeft.AsString()+" or "+this.FRight.AsString()}})),rtl.createClass(this,"TFPBinaryXOrOperation",this.TFPBooleanOperation,(function(){this.GetNodeValue=function(){var e=t.TFPExpressionResult.$new(),i=t.TFPExpressionResult.$new();e.$assign(this.FLeft.GetNodeValue()),i.$assign(this.FRight.GetNodeValue());var s=e.ResultType;return 0===s?e.resValue=!(0==e.resValue)^!(0==i.resValue):1===s&&(e.resValue=rtl.xor(rtl.trunc(e.resValue),rtl.trunc(i.resValue))),e},this.AsString=function(){return this.FLeft.AsString()+" xor "+this.FRight.AsString()}})),rtl.createClass(this,"TFPBooleanResultOperation",this.TFPBinaryOperation,(function(){this.Check=function(){t.TFPBinaryOperation.Check.call(this),this.CheckSameNodeTypes()},this.NodeType=function(){return 0,0}})),rtl.createClass(this,"TFPEqualOperation",this.TFPBooleanResultOperation,(function(){this.GetNodeValue=function(){var e=t.TFPExpressionResult.$new(),i=t.TFPExpressionResult.$new();return e.$assign(this.FLeft.GetNodeValue()),i.$assign(this.FRight.GetNodeValue()),e.resValue=e.resValue==i.resValue,e.ResultType=0,e},this.AsString=function(){return this.FLeft.AsString()+" = "+this.FRight.AsString()}})),rtl.createClass(this,"TFPUnequalOperation",this.TFPEqualOperation,(function(){this.GetNodeValue=function(){var e=t.TFPExpressionResult.$new();return e.$assign(t.TFPEqualOperation.GetNodeValue.call(this)),e.resValue=!e.resValue,e},this.AsString=function(){return this.FLeft.AsString()+" <> "+this.FRight.AsString()}})),rtl.createClass(this,"TFPOrderingOperation",this.TFPBooleanResultOperation,(function(){var e=rtl.createSet(1,2,5,3,4);this.Check=function(){this.CheckNodeType(this.FLeft,e),this.CheckNodeType(this.FRight,e),t.TFPBooleanResultOperation.Check.call(this)}})),rtl.createClass(this,"TFPLessThanOperation",this.TFPOrderingOperation,(function(){this.GetNodeValue=function(){var e=t.TFPExpressionResult.$new(),i=t.TFPExpressionResult.$new();e.$assign(this.FLeft.GetNodeValue()),i.$assign(this.FRight.GetNodeValue());var s=e.ResultType;return 1===s?e.resValue=rtl.trunc(e.resValue)<rtl.trunc(i.resValue):2===s?e.resValue=rtl.getNumber(e.resValue)<rtl.getNumber(i.resValue):5===s?e.resValue=rtl.trunc(1e4*e.resValue)<rtl.trunc(1e4*i.resValue):3===s?e.resValue=rtl.getNumber(e.resValue)<rtl.getNumber(i.resValue):4===s&&(e.resValue=""+e.resValue<""+i.resValue),e.ResultType=0,e},this.AsString=function(){return this.FLeft.AsString()+" < "+this.FRight.AsString()}})),rtl.createClass(this,"TFPGreaterThanOperation",this.TFPOrderingOperation,(function(){this.GetNodeValue=function(){var e=t.TFPExpressionResult.$new(),i=t.TFPExpressionResult.$new();e.$assign(this.FLeft.GetNodeValue()),i.$assign(this.FRight.GetNodeValue());var s=e.ResultType;if(1===s){var o=this.FRight.NodeType();1===o?e.resValue=rtl.trunc(e.resValue)>rtl.trunc(i.resValue):2===o?e.resValue=rtl.trunc(e.resValue)>rtl.getNumber(i.resValue):5===o&&(e.resValue=1e4*rtl.trunc(e.resValue)>rtl.trunc(1e4*i.resValue))}else if(2===s){var n=this.FRight.NodeType();1===n?e.resValue=rtl.getNumber(e.resValue)>rtl.trunc(i.resValue):2===n?e.resValue=rtl.getNumber(e.resValue)>rtl.getNumber(i.resValue):5===n&&(e.resValue=1e4*rtl.getNumber(e.resValue)>rtl.trunc(1e4*i.resValue))}else if(5===s){var r=this.FRight.NodeType();1===r?e.resValue=rtl.trunc(1e4*e.resValue)>1e4*rtl.trunc(i.resValue):2===r?e.resValue=rtl.trunc(1e4*e.resValue)>1e4*rtl.getNumber(i.resValue):5===r&&(e.resValue=rtl.trunc(1e4*e.resValue)>rtl.trunc(1e4*i.resValue))}else 3===s?e.resValue=rtl.getNumber(e.resValue)>rtl.getNumber(i.resValue):4===s&&(e.resValue=""+e.resValue>""+i.resValue);return e.ResultType=0,e},this.AsString=function(){return this.FLeft.AsString()+" > "+this.FRight.AsString()}})),rtl.createClass(this,"TFPLessThanEqualOperation",this.TFPGreaterThanOperation,(function(){this.GetNodeValue=function(){var e=t.TFPExpressionResult.$new();return e.$assign(t.TFPGreaterThanOperation.GetNodeValue.call(this)),e.resValue=!e.resValue,e},this.AsString=function(){return this.FLeft.AsString()+" <= "+this.FRight.AsString()}})),rtl.createClass(this,"TFPGreaterThanEqualOperation",this.TFPLessThanOperation,(function(){this.GetNodeValue=function(){var e=t.TFPExpressionResult.$new();return e.$assign(t.TFPLessThanOperation.GetNodeValue.call(this)),e.resValue=!e.resValue,e},this.AsString=function(){return this.FLeft.AsString()+" >= "+this.FRight.AsString()}})),rtl.createClass(this,"TIfOperation",this.TFPBinaryOperation,(function(){this.$init=function(){t.TFPBinaryOperation.$init.call(this),this.FCondition=null},this.$final=function(){this.FCondition=void 0,t.TFPBinaryOperation.$final.call(this)},this.GetNodeValue=function(){var e=t.TFPExpressionResult.$new();return e.$assign(this.FCondition.GetNodeValue()),0!=e.resValue?e.$assign(this.FLeft.GetNodeValue()):e.$assign(this.FRight.GetNodeValue()),e},this.Check=function(){t.TFPBinaryOperation.Check.call(this),0!==this.FCondition.NodeType()&&e.RaiseParserError$1(rtl.getResStr(t,"SErrIFNeedsBoolean"),pas.System.VarRecs(18,this.FCondition.AsString())),this.CheckSameNodeTypes()},this.NodeType=function(){return this.FLeft.NodeType()},this.Create$2=function(e,i,s){return t.TFPBinaryOperation.Create$1.call(this,i,s),this.FCondition=e,this},this.Destroy=function(){pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FCondition},set:function(t){this.p.FCondition=t}}),t.TFPBinaryOperation.Destroy.call(this)},this.AsString=function(){return pas.SysUtils.Format("if(%s , %s , %s)",pas.System.VarRecs(18,this.FCondition.AsString(),18,this.FLeft.AsString(),18,this.FRight.AsString()))}})),rtl.createClass(this,"TCaseOperation",this.TFPExprNode,(function(){this.$init=function(){t.TFPExprNode.$init.call(this),this.FArgs=[]},this.$final=function(){this.FArgs=void 0,t.TFPExprNode.$final.call(this)},this.GetNodeValue=function(){var e,i=t.TFPExpressionResult.$new(),s=0,o=!1,n=t.TFPExpressionResult.$new(),r=t.TFPExpressionResult.$new();for(n.$assign(this.FArgs[0].GetNodeValue()),e=rtl.length(this.FArgs),s=2,o=!1;!o&&s<e;){i.$assign(this.FArgs[s].GetNodeValue());var a=n.ResultType;(0===a||1===a||2===a||5===a||3===a||4===a)&&(o=n.resValue==r.resValue),o||(s+=2)}return i.ResultType=this.FArgs[1].NodeType(),o?i.$assign(this.FArgs[s+1].GetNodeValue()):e%2==0&&i.$assign(this.FArgs[1].GetNodeValue()),i},this.Check=function(){var i,s,o=0,n=null;rtl.length(this.FArgs)<3&&e.RaiseParserError(rtl.getResStr(t,"SErrCaseNeeds3")),rtl.length(this.FArgs)%2==1&&e.RaiseParserError(rtl.getResStr(t,"SErrCaseEvenCount")),i=this.FArgs[0].NodeType(),s=this.FArgs[1].NodeType();for(var r=2,a=rtl.length(this.FArgs)-1;r<=a;r++)o=r,n=this.FArgs[o],o%2==0?(t.TFPConstExpression.isPrototypeOf(n)||e.RaiseParserError$1(rtl.getResStr(t,"SErrCaseLabelNotAConst"),pas.System.VarRecs(0,rtl.trunc(o/2),18,n.AsString())),n.NodeType()!==i&&e.RaiseParserError$1(rtl.getResStr(t,"SErrCaseLabelType"),pas.System.VarRecs(0,rtl.trunc(o/2),18,n.AsString(),18,t.ResultTypeName(i),18,t.ResultTypeName(n.NodeType())))):n.NodeType()!==s&&e.RaiseParserError$1(rtl.getResStr(t,"SErrCaseValueType"),pas.System.VarRecs(0,rtl.trunc((o-1)/2),18,n.AsString(),18,t.ResultTypeName(s),18,t.ResultTypeName(n.NodeType())))},this.NodeType=function(){return this.FArgs[1].NodeType()},this.Create$1=function(t){return this.FArgs=rtl.arrayRef(t),this},this.Destroy=function(){for(var t=0,e=0,i=rtl.length(this.FArgs)-1;e<=i;e++)t=e,pas.SysUtils.FreeAndNil({a:t,p:this.FArgs,get:function(){return this.p[this.a]},set:function(t){this.p[this.a]=t}});pas.System.TObject.Destroy.call(this)},this.AsString=function(){var t="",e=0;t="";for(var i=0,s=rtl.length(this.FArgs)-1;i<=s;i++)e=i,""!==t&&(t+=", "),t+=this.FArgs[e].AsString();return t="Case("+t+")"}})),rtl.createClass(this,"TMathOperation",this.TFPBinaryOperation,(function(){var e=rtl.createSet(1,2,5,3,4);this.Check=function(){t.TFPBinaryOperation.Check.call(this),this.CheckNodeType(this.FLeft,e),this.CheckNodeType(this.FRight,e),this.CheckSameNodeTypes()},this.NodeType=function(){return this.FLeft.NodeType()}})),rtl.createClass(this,"TFPAddOperation",this.TMathOperation,(function(){this.GetNodeValue=function(){var e=t.TFPExpressionResult.$new(),i=t.TFPExpressionResult.$new();e.$assign(this.FLeft.GetNodeValue()),i.$assign(this.FRight.GetNodeValue());var s=e.ResultType;return 1===s?e.resValue=rtl.trunc(e.resValue)+rtl.trunc(i.resValue):4===s?e.resValue=e.resValue+""+i.resValue:3===s||2===s?e.resValue=rtl.getNumber(e.resValue)+rtl.getNumber(i.resValue):5===s&&(e.resValue=(rtl.trunc(1e4*e.resValue)+rtl.trunc(1e4*i.resValue))/1e4),e.ResultType=this.NodeType(),e},this.AsString=function(){return this.FLeft.AsString()+" + "+this.FRight.AsString()}})),rtl.createClass(this,"TFPSubtractOperation",this.TMathOperation,(function(){var e=rtl.createSet(1,2,5,3);this.Check=function(){this.CheckNodeType(this.FLeft,e),this.CheckNodeType(this.FRight,e),t.TMathOperation.Check.call(this)},this.GetNodeValue=function(){var e=t.TFPExpressionResult.$new(),i=t.TFPExpressionResult.$new();e.$assign(this.FLeft.GetNodeValue()),i.$assign(this.FRight.GetNodeValue());var s=e.ResultType;return 1===s?e.resValue=rtl.trunc(e.resValue)-rtl.trunc(i.resValue):3===s||2===s?e.resValue=rtl.getNumber(e.resValue)-rtl.getNumber(i.resValue):5===s&&(e.resValue=(rtl.trunc(1e4*e.resValue)-rtl.trunc(1e4*i.resValue))/1e4),e},this.AsString=function(){return this.FLeft.AsString()+" - "+this.FRight.AsString()}})),rtl.createClass(this,"TFPMultiplyOperation",this.TMathOperation,(function(){var e=rtl.createSet(1,5,2);this.Check=function(){this.CheckNodeType(this.FLeft,e),this.CheckNodeType(this.FRight,e),t.TMathOperation.Check.call(this)},this.AsString=function(){return this.FLeft.AsString()+" * "+this.FRight.AsString()},this.GetNodeValue=function(){var e=t.TFPExpressionResult.$new(),i=t.TFPExpressionResult.$new();e.$assign(this.FLeft.GetNodeValue()),i.$assign(this.FRight.GetNodeValue());var s=e.ResultType;return 1===s?e.resValue=rtl.trunc(e.resValue)*rtl.trunc(i.resValue):2===s?e.resValue=rtl.getNumber(e.resValue)*rtl.getNumber(i.resValue):5===s&&(e.resValue=rtl.trunc(1e4*e.resValue)*rtl.trunc(1e4*i.resValue)/1e4/1e4),e}})),rtl.createClass(this,"TFPDivideOperation",this.TMathOperation,(function(){var e=rtl.createSet(1,5,2);this.Check=function(){this.CheckNodeType(this.FLeft,e),this.CheckNodeType(this.FRight,e),t.TMathOperation.Check.call(this)},this.AsString=function(){return this.FLeft.AsString()+" / "+this.FRight.AsString()},this.NodeType=function(){return 5===this.FLeft.NodeType()&&5===this.FRight.NodeType()?5:2},this.GetNodeValue=function(){var e=t.TFPExpressionResult.$new(),i=t.TFPExpressionResult.$new();e.$assign(this.FLeft.GetNodeValue()),i.$assign(this.FRight.GetNodeValue());var s=e.ResultType;return 1===s?e.resValue=rtl.trunc(e.resValue)/rtl.trunc(i.resValue):2===s?e.resValue=rtl.getNumber(e.resValue)/rtl.getNumber(i.resValue):5===s&&(5===this.NodeType()?e.resValue=rtl.trunc(rtl.trunc(1e4*e.resValue)/rtl.trunc(1e4*i.resValue)*1e4)/1e4:e.resValue=rtl.getNumber(e.resValue)/rtl.getNumber(i.resValue)),e.ResultType=this.NodeType(),e}})),rtl.createClass(this,"TFPModuloOperation",this.TMathOperation,(function(){this.Check=function(){this.CheckNodeType(this.FLeft,rtl.createSet(1)),this.CheckNodeType(this.FRight,rtl.createSet(1)),t.TMathOperation.Check.call(this)},this.AsString=function(){return this.FLeft.AsString()+" mod "+this.FRight.AsString()},this.NodeType=function(){return 1,1},this.GetNodeValue=function(){var e=t.TFPExpressionResult.$new(),i=t.TFPExpressionResult.$new();return e.$assign(this.FLeft.GetNodeValue()),i.$assign(this.FRight.GetNodeValue()),e.resValue=rtl.trunc(e.resValue)%rtl.trunc(i.resValue),e.ResultType=1,e}})),rtl.createClass(this,"TFPPowerOperation",this.TMathOperation,(function(){var i=rtl.createSet(1,5,2);this.Check=function(){this.CheckNodeType(this.FLeft,i),this.CheckNodeType(this.FRight,i)},this.AsString=function(){return this.FLeft.AsString()+"^"+this.FRight.AsString()},this.NodeType=function(){return 2,2},this.GetNodeValue=function(){var i=t.TFPExpressionResult.$new(),s=t.TFPExpressionResult.$new();return i.$assign(this.FLeft.GetNodeValue()),s.$assign(this.FRight.GetNodeValue()),i.resValue=e.power(t.ArgToFloat(t.TFPExpressionResult.$clone(i)),t.ArgToFloat(t.TFPExpressionResult.$clone(s))),i.ResultType=2,i}})),rtl.createClass(this,"TFPUnaryOperator",this.TFPExprNode,(function(){this.$init=function(){t.TFPExprNode.$init.call(this),this.FOperand=null},this.$final=function(){this.FOperand=void 0,t.TFPExprNode.$final.call(this)},this.Create$1=function(t){return this.FOperand=t,this},this.Destroy=function(){pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FOperand},set:function(t){this.p.FOperand=t}}),pas.System.TObject.Destroy.call(this)},this.Check=function(){null==this.FOperand&&e.RaiseParserError$1(rtl.getResStr(t,"SErrNoOperand"),pas.System.VarRecs(18,this.$classname))}})),rtl.createClass(this,"TFPConvertNode",this.TFPUnaryOperator,(function(){this.AsString=function(){return this.FOperand.AsString()}})),rtl.createClass(this,"TFPNotNode",this.TFPUnaryOperator,(function(){this.Check=function(){this.FOperand.NodeType()in rtl.createSet(1,0)||e.RaiseParserError$1(rtl.getResStr(t,"SErrNoNOTOperation"),pas.System.VarRecs(18,t.ResultTypeName(this.FOperand.NodeType()),18,this.FOperand.AsString()))},this.NodeType=function(){return this.FOperand.NodeType()},this.GetNodeValue=function(){var e=t.TFPExpressionResult.$new();e.$assign(this.FOperand.GetNodeValue());var i=e.ResultType;return(1===i||0===i)&&(e.resValue=!e.resValue),e},this.AsString=function(){return"not "+this.FOperand.AsString()}})),rtl.createClass(this,"TIntConvertNode",this.TFPConvertNode,(function(){this.Check=function(){t.TFPUnaryOperator.Check.call(this),this.CheckNodeType(this.FOperand,rtl.createSet(1))}})),rtl.createClass(this,"TIntToFloatNode",this.TIntConvertNode,(function(){this.NodeType=function(){return 2,2},this.GetNodeValue=function(){var e=t.TFPExpressionResult.$new();return e.$assign(this.FOperand.GetNodeValue()),e.resValue=e.resValue,e.ResultType=2,e}})),rtl.createClass(this,"TIntToCurrencyNode",this.TIntConvertNode,(function(){this.NodeType=function(){return 5,5},this.GetNodeValue=function(){var e=t.TFPExpressionResult.$new();return e.$assign(this.FOperand.GetNodeValue()),e.resValue=e.resValue,e.ResultType=5,e}})),rtl.createClass(this,"TIntToDateTimeNode",this.TIntConvertNode,(function(){this.NodeType=function(){return 3,3},this.GetNodeValue=function(){var e=t.TFPExpressionResult.$new();return e.$assign(this.FOperand.GetNodeValue()),e.ResultType=3,e}})),rtl.createClass(this,"TFloatToDateTimeNode",this.TFPConvertNode,(function(){this.Check=function(){t.TFPUnaryOperator.Check.call(this),this.CheckNodeType(this.FOperand,rtl.createSet(2))},this.NodeType=function(){return 3,3},this.GetNodeValue=function(){var e=t.TFPExpressionResult.$new();return e.$assign(this.FOperand.GetNodeValue()),e.ResultType=3,e}})),rtl.createClass(this,"TFloatToCurrencyNode",this.TFPConvertNode,(function(){this.Check=function(){this.CheckNodeType(this.FOperand,rtl.createSet(2))},this.NodeType=function(){return 5,5},this.GetNodeValue=function(){var e=t.TFPExpressionResult.$new();return e.$assign(this.FOperand.GetNodeValue()),e.ResultType=5,e.resValue=e.resValue,e}})),rtl.createClass(this,"TCurrencyToDateTimeNode",this.TFPConvertNode,(function(){this.Check=function(){t.TFPUnaryOperator.Check.call(this),this.CheckNodeType(this.FOperand,rtl.createSet(5))},this.NodeType=function(){return 3,3},this.GetNodeValue=function(){var e=t.TFPExpressionResult.$new(),i=t.TFPExpressionResult.$new();return i.$assign(this.FOperand.GetNodeValue()),e.resValue=rtl.trunc(1e4*i.resValue)/1e4,e.ResultType=3,e}})),rtl.createClass(this,"TCurrencyToFloatNode",this.TFPConvertNode,(function(){this.Check=function(){t.TFPUnaryOperator.Check.call(this),this.CheckNodeType(this.FOperand,rtl.createSet(5))},this.NodeType=function(){return 2,2},this.GetNodeValue=function(){var e=t.TFPExpressionResult.$new();return e.$assign(this.FOperand.GetNodeValue()),e.resValue=rtl.trunc(1e4*e.resValue)/1e4,e.ResultType=2,e}})),rtl.createClass(this,"TFPNegateOperation",this.TFPUnaryOperator,(function(){this.Check=function(){t.TFPUnaryOperator.Check.call(this),this.FOperand.NodeType()in rtl.createSet(1,2,5)||e.RaiseParserError$1(rtl.getResStr(t,"SErrNoNegation"),pas.System.VarRecs(18,t.ResultTypeName(this.FOperand.NodeType()),18,this.FOperand.AsString()))},this.NodeType=function(){return this.FOperand.NodeType()},this.GetNodeValue=function(){var e=t.TFPExpressionResult.$new();e.$assign(this.FOperand.GetNodeValue());var i=e.ResultType;return 1===i?e.resValue=-rtl.trunc(e.resValue):2===i?e.resValue=-rtl.getNumber(e.resValue):5===i&&(e.resValue=-rtl.trunc(1e4*e.resValue)/1e4),e},this.AsString=function(){return"-"+pas.SysUtils.TrimLeft(this.FOperand.AsString())}})),rtl.createClass(this,"TFPConstExpression",this.TFPExprNode,(function(){this.$init=function(){t.TFPExprNode.$init.call(this),this.FValue=t.TFPExpressionResult.$new()},this.$final=function(){this.FValue=void 0,t.TFPExprNode.$final.call(this)},this.CreateString=function(t){return this.FValue.ResultType=4,this.FValue.resValue=t,this},this.CreateInteger=function(t){return this.FValue.ResultType=1,this.FValue.resValue=t,this},this.CreateFloat=function(t){return pas.System.TObject.Create.call(this),this.FValue.ResultType=2,this.FValue.resValue=t,this},this.CreateBoolean=function(t){return this.FValue.ResultType=0,this.FValue.resValue=t,this},this.Check=function(){},this.NodeType=function(){return this.FValue.ResultType},this.GetNodeValue=function(){var e=t.TFPExpressionResult.$new();return e.$assign(this.FValue),e},this.AsString=function(){var t="",e=this.NodeType();return 4===e?t="'"+this.FValue.resValue+"'":1===e?t=pas.SysUtils.IntToStr(rtl.trunc(this.FValue.resValue)):3===e?t="'"+pas.SysUtils.FormatDateTime("cccc",rtl.getNumber(this.FValue.resValue))+"'":0===e?t=0!=this.FValue.resValue?"True":"False":2===e?t=rtl.floatToStr(rtl.getNumber(this.FValue.resValue)):5===e&&(t=rtl.floatToStr(rtl.trunc(1e4*this.FValue.resValue)/1e4)),t}})),this.TIdentifierType={0:"itVariable",itVariable:0,1:"itFunctionHandler",itFunctionHandler:1,2:"itFunctionNode",itFunctionNode:2},this.$rtti.$Enum("TIdentifierType",{minvalue:0,maxvalue:2,ordtype:1,enumtype:this.TIdentifierType}),this.$rtti.$RefToProcVar("TFPExprFunctionEvent",{procsig:rtl.newTIProcSig([["Args",this.$rtti.TExprParameterArray,2]],this.$rtti.TFPExpressionResult)}),this.$rtti.$RefToProcVar("TFPExprVariableEvent",{procsig:rtl.newTIProcSig([["AName",rtl.string,2]],this.$rtti.TFPExpressionResult)}),rtl.createClass(this,"TFPExprIdentifierDef",pas.Classes.TCollectionItem,(function(){this.$init=function(){pas.Classes.TCollectionItem.$init.call(this),this.FNodeType=null,this.FOnGetVarValue=null,this.FStringValue="",this.FValue=t.TFPExpressionResult.$new(),this.FArgumentTypes="",this.FIDType=0,this.FName="",this.FOnGetValue=null},this.$final=function(){this.FNodeType=void 0,this.FOnGetVarValue=void 0,this.FValue=void 0,this.FOnGetValue=void 0,pas.Classes.TCollectionItem.$final.call(this)},this.GetResultType=function(){return this.FValue.ResultType},this.GetValue=function(){var t="",e=this.FValue.ResultType;return 0===e?t=this.FValue.resValue?"True":"False":1===e?t=pas.SysUtils.IntToStr(rtl.trunc(this.FValue.resValue)):2===e?t=pas.SysUtils.FloatToStr(rtl.getNumber(this.FValue.resValue)):5===e?t=pas.SysUtils.CurrToStr(rtl.trunc(1e4*this.FValue.resValue)):3===e?t=pas.SysUtils.FormatDateTime("cccc",rtl.getNumber(this.FValue.resValue)):4===e&&(t=""+this.FValue.resValue),t},this.SetArgumentTypes=function(e){var i=0;if(this.FArgumentTypes!==e){for(var s=1,o=e.length;s<=o;s++)i=s,t.CharToResultType(e.charAt(i-1));this.FArgumentTypes=e}},this.SetName=function(i){this.FName!==i&&(""!==i&&null!=this.FCollection&&-1!==this.FCollection.IndexOfIdentifier(i)&&e.RaiseParserError$1(rtl.getResStr(t,"SErrDuplicateIdentifier"),pas.System.VarRecs(18,i)),this.FName=i)},this.SetResultType=function(t){t!==this.FValue.ResultType&&(this.FValue.ResultType=t,this.SetValue(this.FStringValue))},this.SetValue=function(t){if(this.FStringValue=t,""!==t){var e=this.FValue.ResultType;0===e?this.FValue.resValue="True"===this.FStringValue:1===e?this.FValue.resValue=pas.SysUtils.StrToInt(t):2===e?this.FValue.resValue=pas.SysUtils.StrToFloat(t):5===e?this.FValue.resValue=pas.SysUtils.StrToCurr(t)/1e4:3===e?this.FValue.resValue=pas.SysUtils.StrToDateTime(t):4===e&&(this.FValue.resValue=t)}else{var i=this.FValue.ResultType;0===i?this.FValue.resValue=!1:1===i||2===i||5===i||3===i?this.FValue.resValue=0:4===i&&(this.FValue.resValue="")}},this.FetchValue=function(){var e,i,s=0;if(e=this.GetResultType(),null!=this.FOnGetVarValue&&this.FValue.$assign(this.FOnGetVarValue(this.FName)),(i=this.FValue.ResultType)!==e){if(1!==i||2!==e)throw this.FValue.ResultType=e,t.EExprParser.$create("CreateFmt",['Value handler for variable %s returned wrong type, expected "%s", got "%s"',pas.System.VarRecs(18,this.FName,18,pas.TypInfo.GetEnumName(t.$rtti.TResultType,e),18,pas.TypInfo.GetEnumName(t.$rtti.TResultType,i))]);this.FValue.ResultType=e,s=rtl.trunc(this.FValue.resValue),this.FValue.resValue=s}},this.ArgumentCount=function(){return this.FArgumentTypes.length},this.Assign=function(e){var i=null;t.TFPExprIdentifierDef.isPrototypeOf(e)?(i=rtl.as(e,t.TFPExprIdentifierDef),this.FStringValue=i.FStringValue,this.FValue.$assign(i.FValue),this.FArgumentTypes=i.FArgumentTypes,this.FIDType=i.FIDType,this.FName=i.FName,this.FOnGetValue=i.FOnGetValue,this.FOnGetVarValue=i.FOnGetVarValue):pas.Classes.TPersistent.Assign.call(this,e)},this.EventBasedVariable=function(){return null!=this.FOnGetVarValue};var i=this.$rtti;i.addProperty("IdentifierType",0,t.$rtti.TIdentifierType,"FIDType","FIDType"),i.addProperty("Name",2,rtl.string,"FName","SetName"),i.addProperty("Value",3,rtl.string,"GetValue","SetValue"),i.addProperty("ParameterTypes",2,rtl.string,"FArgumentTypes","SetArgumentTypes"),i.addProperty("ResultType",3,t.$rtti.TResultType,"GetResultType","SetResultType"),i.addProperty("OnGetFunctionValue",0,t.$rtti.TFPExprFunctionEvent,"FOnGetValue","FOnGetValue"),i.addProperty("OnGetVariableValue",0,t.$rtti.TFPExprVariableEvent,"FOnGetVarValue","FOnGetVarValue"),i.addProperty("NodeType",0,t.$rtti.TFPExprFunctionClass,"FNodeType","FNodeType")})),this.TBuiltInCategory={0:"bcStrings",bcStrings:0,1:"bcDateTime",bcDateTime:1,2:"bcMath",bcMath:2,3:"bcBoolean",bcBoolean:3,4:"bcConversion",bcConversion:4,5:"bcData",bcData:5,6:"bcVaria",bcVaria:6,7:"bcUser",bcUser:7,8:"bcAggregate",bcAggregate:8},this.$rtti.$Enum("TBuiltInCategory",{minvalue:0,maxvalue:8,ordtype:1,enumtype:this.TBuiltInCategory}),this.$rtti.$Set("TBuiltInCategories",{comptype:this.$rtti.TBuiltInCategory}),rtl.createClass(this,"TFPBuiltInExprIdentifierDef",this.TFPExprIdentifierDef,(function(){this.$init=function(){t.TFPExprIdentifierDef.$init.call(this),this.FCategory=0},this.Assign=function(e){t.TFPExprIdentifierDef.Assign.call(this,e),t.TFPBuiltInExprIdentifierDef.isPrototypeOf(e)&&(this.FCategory=rtl.as(e,t.TFPBuiltInExprIdentifierDef).FCategory)},this.$rtti.addProperty("Category",0,t.$rtti.TBuiltInCategory,"FCategory","FCategory")})),rtl.createClass(this,"TFPExprIdentifierDefs",pas.Classes.TCollection,(function(){this.$init=function(){pas.Classes.TCollection.$init.call(this),this.FParser=null},this.$final=function(){this.FParser=void 0,pas.Classes.TCollection.$final.call(this)},this.GetI=function(t){return this.GetItem(t)},this.Update=function(t){pas.Classes.TCollection.Update.call(this,t),null!=this.FParser&&(this.FParser.FDirty=!0)},this.IndexOfIdentifier=function(t){var e=0;for(e=this.GetCount()-1;e>=0&&0!==pas.SysUtils.CompareText(this.GetI(e).FName,t);)e-=1;return e},this.AddVariable=function(e,i,s){var o=null;return(o=rtl.as(this.Add(),t.TFPExprIdentifierDef)).FIDType=0,o.SetName(e),o.SetResultType(i),o.FOnGetVarValue=s,o},this.AddFloatVariable=function(e,i){var s=null;return(s=rtl.as(this.Add(),t.TFPExprIdentifierDef)).FIDType=0,s.SetName(e),s.SetResultType(2),s.FValue.resValue=i,s},this.AddFunction=function(e,i,s,o){var n=null;return(n=rtl.as(this.Add(),t.TFPExprIdentifierDef)).SetName(e),n.FIDType=1,n.SetArgumentTypes(s),n.SetResultType(t.CharToResultType(i)),n.FOnGetValue=o,n},this.AddFunction$1=function(e,i,s,o){var n=null;return(n=rtl.as(this.Add(),t.TFPExprIdentifierDef)).SetName(e),n.FIDType=2,n.SetArgumentTypes(s),n.SetResultType(t.CharToResultType(i)),n.FNodeType=o,n}})),rtl.createClass(this,"TFPExprIdentifierNode",this.TFPExprNode,(function(){this.$init=function(){t.TFPExprNode.$init.call(this),this.FID=null,this.PResult=null,this.FResultType=0},this.$final=function(){this.FID=void 0,t.TFPExprNode.$final.call(this)},this.CreateIdentifier=function(t){return pas.System.TObject.Create.call(this),this.FID=t,this.PResult=this.FID.FValue,this.FResultType=this.FID.GetResultType(),this},this.NodeType=function(){return this.FResultType},this.GetNodeValue=function(){var e=t.TFPExpressionResult.$new();return this.FID.EventBasedVariable()&&(this.FID.FetchValue(),this.PResult=this.FID.FValue),e.$assign(this.PResult),e.ResultType=this.FResultType,e}})),rtl.createClass(this,"TFPExprVariable",this.TFPExprIdentifierNode,(function(){this.Check=function(){},this.AsString=function(){return this.FID.FName}})),rtl.createClass(this,"TFPExprFunction",this.TFPExprIdentifierNode,(function(){this.$init=function(){t.TFPExprIdentifierNode.$init.call(this),this.FArgumentNodes=[],this.FargumentParams=[]},this.$final=function(){this.FArgumentNodes=void 0,this.FargumentParams=void 0,t.TFPExprIdentifierNode.$final.call(this)},this.CalcParams=function(){for(var t=0,e=0,i=rtl.length(this.FargumentParams)-1;e<=i;e++)t=e,this.FargumentParams[t].$assign(this.FArgumentNodes[t].GetNodeValue())},this.ConvertArgument=function(i,s,o){var n;return s===(n=t.TFPExpressionParser.ConvertNode(s,o))&&e.RaiseParserError$1(rtl.getResStr(t,"SErrInvalidArgumentType"),pas.System.VarRecs(0,i,18,t.ResultTypeName(o),18,t.ResultTypeName(s.NodeType()))),n},this.Check=function(){var i=0,s=0;rtl.length(this.FArgumentNodes)!==this.FID.ArgumentCount()&&e.RaiseParserError$1(rtl.getResStr(t,"ErrInvalidArgumentCount"),pas.System.VarRecs(18,this.FID.FName));for(var o=0,n=rtl.length(this.FArgumentNodes)-1;o<=n;o++)i=o,(s=t.CharToResultType(this.FID.FArgumentTypes.charAt(i+1-1)))!==this.FArgumentNodes[i].NodeType()&&(this.FArgumentNodes[i]=this.ConvertArgument(i+1,this.FArgumentNodes[i],s))},this.CreateFunction=function(e,i){return t.TFPExprIdentifierNode.CreateIdentifier.call(this,e),this.FArgumentNodes=rtl.arrayRef(i),this.FargumentParams=rtl.arraySetLength(this.FargumentParams,t.TFPExpressionResult,rtl.length(i)),this},this.Destroy=function(){for(var t=0,e=0,i=rtl.length(this.FArgumentNodes)-1;e<=i;e++)t=e,pas.SysUtils.FreeAndNil({a:t,p:this.FArgumentNodes,get:function(){return this.p[this.a]},set:function(t){this.p[this.a]=t}});pas.System.TObject.Destroy.call(this)},this.AsString=function(){var t="",e=0;t="";for(var i=0,s=rtl.length(this.FArgumentNodes)-1;i<=s;i++)e=i,""!==t&&(t+=","),t+=this.FArgumentNodes[e].AsString();return""!==t&&(t="("+t+")"),this.FID.FName+t}})),rtl.createClass(this,"TAggregateExpr",this.TFPExprFunction,(function(){this.$init=function(){t.TFPExprFunction.$init.call(this),this.FResult=t.TFPExpressionResult.$new()},this.$final=function(){this.FResult=void 0,t.TFPExprFunction.$final.call(this)},this.GetNodeValue=function(){var e=t.TFPExpressionResult.$new();return e.$assign(this.FResult),e}})),rtl.createClass(this,"TAggregateMin",this.TAggregateExpr,(function(){})),rtl.createClass(this,"TAggregateMax",this.TAggregateExpr,(function(){})),rtl.createClass(this,"TAggregateSum",this.TAggregateExpr,(function(){this.ConvertArgument=function(i,s,o){return s.NodeType()in rtl.createSet(2,1,5)||e.RaiseParserError$1(rtl.getResStr(t,"SErrInvalidArgumentType"),pas.System.VarRecs(0,i,18,t.ResultTypeName(o),18,t.ResultTypeName(s.NodeType()))),s}})),rtl.createClass(this,"TAggregateAvg",this.TAggregateSum,(function(){this.$init=function(){t.TAggregateSum.$init.call(this),this.FCount=0},this.GetNodeValue=function(){var e=t.TFPExpressionResult.$new();if(e.$assign(t.TAggregateExpr.GetNodeValue.call(this)),e.ResultType=this.FResult.ResultType,0===this.FCount){var i=this.FResult.ResultType;1===i?(e.ResultType=2,e.resValue=0):(2===i||5===i)&&(e.resValue=0)}else{var s=this.FResult.ResultType;1===s?(e.ResultType=2,e.resValue=rtl.trunc(this.FResult.resValue)/this.FCount):2===s?e.resValue=rtl.getNumber(this.FResult.resValue)/this.FCount:5===s&&(e.resValue=rtl.trunc(rtl.trunc(1e4*this.FResult.resValue)/this.FCount)/1e4)}return e}})),rtl.createClass(this,"TAggregateCount",this.TAggregateExpr,(function(){})),rtl.createClass(this,"TFPFunctionEventHandler",this.TFPExprFunction,(function(){this.$init=function(){t.TFPExprFunction.$init.call(this),this.FCallBack=null},this.$final=function(){this.FCallBack=void 0,t.TFPExprFunction.$final.call(this)},this.CreateFunction=function(e,i){return t.TFPExprFunction.CreateFunction.apply(this,arguments),this.FCallBack=e.FOnGetValue,this},this.GetNodeValue=function(){var e=t.TFPExpressionResult.$new();return rtl.length(this.FargumentParams)>0&&this.CalcParams(),e.$assign(this.FCallBack(this.FargumentParams)),e.ResultType=this.NodeType(),e}})),rtl.createClass(this,"TFPExpressionParser",pas.Classes.TComponent,(function(){this.$init=function(){pas.Classes.TComponent.$init.call(this),this.FBuiltIns={},this.FExpression="",this.FScanner=null,this.FExprNode=null,this.FIdentifiers=null,this.FHashList=null,this.FDirty=!1},this.$final=function(){this.FBuiltIns=void 0,this.FScanner=void 0,this.FExprNode=void 0,this.FIdentifiers=void 0,this.FHashList=void 0,pas.Classes.TComponent.$final.call(this)},this.CheckEOF=function(){26===this.TokenType()&&this.ParserError(rtl.getResStr(t,"SErrUnexpectedEndOfExpression"))},this.GetAsBoolean=function(){var e=t.TFPExpressionResult.$new();return this.EvaluateExpression(e),this.CheckResultType(e,0),!(0==e.resValue)},this.MatchNodes=function(t,e){var i,s,o=null;if(o=t,(i=t.NodeType())!==(s=e.NodeType())){var n=i;1===n?s in rtl.createSet(2,5,3)&&(o=this.$class.ConvertNode(t,s)):2===n?s in rtl.createSet(5,3)&&(o=this.$class.ConvertNode(t,s)):5===n&&s in rtl.createSet(2,3)&&(o=this.$class.ConvertNode(t,s))}return o},this.CheckNodes=function(t,e){t.set(this.MatchNodes(t.get(),e.get())),e.set(this.MatchNodes(e.get(),t.get()))},this.SetBuiltIns=function(t){rtl.eqSet(this.FBuiltIns,t)||(this.FBuiltIns=rtl.refSet(t),this.FDirty=!0)},this.SetIdentifiers=function(t){this.FIdentifiers.Assign(t)},this.ParserError=function(e){throw t.EExprParser.$create("Create$1",[e])},this.SetExpression=function(e){this.FExpression!==e&&(this.FExpression=e,this.FScanner.SetSource(e),null!=this.FExprNode&&pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FExprNode},set:function(t){this.p.FExprNode=t}}),""!==this.FExpression?(this.GetToken(),this.FExprNode=this.Level1(),26!==this.TokenType()&&this.ParserError(pas.SysUtils.Format(rtl.getResStr(t,"SErrUnterminatedExpression"),pas.System.VarRecs(0,this.FScanner.FPos,18,this.CurrentToken()))),this.FExprNode.Check()):this.FExprNode=null)},this.CheckResultType=function(i,s){i.ResultType!==s&&e.RaiseParserError$1(rtl.getResStr(t,"SErrInvalidResultType"),pas.System.VarRecs(18,t.ResultTypeName(i.ResultType)))},this.ConvertNode=function(e,i){var s=null;s=e;var o=e.NodeType();if(1===o){var n=i;2===n?s=t.TIntToFloatNode.$create("Create$1",[s]):5===n?s=t.TIntToCurrencyNode.$create("Create$1",[s]):3===n&&(s=t.TIntToDateTimeNode.$create("Create$1",[s]))}else if(2===o){var r=i;5===r?s=t.TFloatToCurrencyNode.$create("Create$1",[s]):3===r&&(s=t.TFloatToDateTimeNode.$create("Create$1",[s]))}else if(5===o){var a=i;2===a?s=t.TCurrencyToFloatNode.$create("Create$1",[s]):3===a&&(s=t.TCurrencyToDateTimeNode.$create("Create$1",[s]))}return s},this.BuiltinsManager=function(){return t.BuiltinIdentifiers()},this.Level1=function(){var e=null,i=0,s=null;22===this.TokenType()?(this.GetToken(),this.CheckEOF(),s=this.Level2(),e=t.TFPNotNode.$create("Create$1",[s])):e=this.Level2();try{for(;this.TokenType()in rtl.createSet(17,18,19);){i=this.TokenType(),this.GetToken(),this.CheckEOF(),s=this.Level2();var o=i;18===o?e=t.TFPBinaryOrOperation.$create("Create$1",[e,s]):17===o?e=t.TFPBinaryAndOperation.$create("Create$1",[e,s]):19===o?e=t.TFPBinaryXOrOperation.$create("Create$1",[e,s]):this.ParserError(rtl.getResStr(t,"SErrUnknownBooleanOp"))}}catch(t){throw e=rtl.freeLoc(e),t}return e},this.Level2=function(){var e=null,i=null,s=0,o=null;e=this.Level3();try{if(this.TokenType()in t.ttComparisons){s=this.TokenType(),this.GetToken(),this.CheckEOF(),i=this.Level3(),this.CheckNodes({get:function(){return e},set:function(t){e=t}},{get:function(){return i},set:function(t){i=t}});var n=s;2===n?o=t.TFPLessThanOperation:10===n?o=t.TFPLessThanEqualOperation:3===n?o=t.TFPGreaterThanOperation:11===n?o=t.TFPGreaterThanEqualOperation:4===n?o=t.TFPEqualOperation:12===n?o=t.TFPUnequalOperation:this.ParserError(rtl.getResStr(t,"SErrUnknownComparison")),e=o.$create("Create$1",[e,i])}}catch(t){throw e=rtl.freeLoc(e),t}return e},this.Level3=function(){var e=null,i=0,s=null;e=this.Level4();try{for(;this.TokenType()in rtl.createSet(0,1);){i=this.TokenType(),this.GetToken(),this.CheckEOF(),s=this.Level4(),this.CheckNodes({get:function(){return e},set:function(t){e=t}},{get:function(){return s},set:function(t){s=t}});var o=i;0===o?e=t.TFPAddOperation.$create("Create$1",[e,s]):1===o&&(e=t.TFPSubtractOperation.$create("Create$1",[e,s]))}}catch(t){throw e=rtl.freeLoc(e),t}return e},this.Level4=function(){var e=null,i=0,s=null;e=this.Level5();try{for(;this.TokenType()in rtl.createSet(7,5,6);){i=this.TokenType(),this.GetToken(),s=this.Level5(),this.CheckNodes({get:function(){return e},set:function(t){e=t}},{get:function(){return s},set:function(t){s=t}});var o=i;7===o?e=t.TFPMultiplyOperation.$create("Create$1",[e,s]):5===o?e=t.TFPDivideOperation.$create("Create$1",[e,s]):6===o&&(e=t.TFPModuloOperation.$create("Create$1",[e,s]))}}catch(t){throw e=rtl.freeLoc(e),t}return e},this.Level5=function(){var e=null,i=!1;return i=!1,this.TokenType()in rtl.createSet(0,1)&&(i=1===this.TokenType(),this.GetToken()),e=this.Level6(),i&&(e=t.TFPNegateOperation.$create("Create$1",[e])),e},this.Level6=function(){var e=null,i=null;e=this.Level7();try{for(;25===this.TokenType();)this.GetToken(),i=this.Level5(),this.CheckNodes({get:function(){return e},set:function(t){e=t}},{get:function(){return i},set:function(t){i=t}}),e=t.TFPPowerOperation.$create("Create$1",[e,i])}catch(t){throw e=rtl.freeLoc(e),t}return e},this.Level7=function(){var e=null;if(8===this.TokenType()){this.GetToken(),e=this.Level1();try{9!==this.TokenType()&&this.ParserError(pas.SysUtils.Format(rtl.getResStr(t,"SErrBracketExpected"),pas.System.VarRecs(0,this.FScanner.FPos,18,this.CurrentToken()))),this.GetToken()}catch(t){throw e=rtl.freeLoc(e),t}}else e=this.Primitive();return e},this.Primitive=function(){var e=null,i=0,s=0,o=0,n=0,r=!1,a=!1,l=null,h=[],F=0;if(h=rtl.arraySetLength(h,null,0),13===this.TokenType())pas.SysUtils.TryStrToInt64(this.CurrentToken(),{get:function(){return i},set:function(t){i=t}})?e=t.TFPConstExpression.$create("CreateInteger",[i]):(pas.System.val$8(this.CurrentToken(),{get:function(){return o},set:function(t){o=t}},{get:function(){return s},set:function(t){s=t}}),0===s?e=t.TFPConstExpression.$create("CreateFloat",[o]):this.ParserError(pas.SysUtils.Format(rtl.getResStr(t,"SErrInvalidFloat"),pas.System.VarRecs(18,this.CurrentToken()))));else if(14===this.TokenType())e=t.TFPConstExpression.$create("CreateString",[this.CurrentToken()]);else if(this.TokenType()in rtl.createSet(20,21))e=t.TFPConstExpression.$create("CreateBoolean",[20===this.TokenType()]);else if(this.TokenType()in rtl.createSet(15,23,24)){if(r=23===this.TokenType(),a=24===this.TokenType(),r||a||null===(l=this.IdentifierByName(this.CurrentToken()))&&this.ParserError(pas.SysUtils.Format(rtl.getResStr(t,"SErrUnknownIdentifier"),pas.System.VarRecs(18,this.CurrentToken()))),0!==(n=r?3:a?-4:l.FIDType in rtl.createSet(1,2)?l.ArgumentCount():0)){this.GetToken(),8!==this.TokenType()&&this.ParserError(pas.SysUtils.Format(rtl.getResStr(t,"SErrLeftBracketExpected"),pas.System.VarRecs(0,this.FScanner.FPos,18,this.CurrentToken()))),h=rtl.arraySetLength(h,null,Math.abs(n)),F=0;try{do{this.GetToken(),n<0&&F===rtl.length(h)&&((h=rtl.arraySetLength(h,null,F+1))[F]=null),h[F]=this.Level1(),F+=1,16!==this.TokenType()&&F<Math.abs(n)&&this.ParserError(pas.SysUtils.Format(rtl.getResStr(t,"SErrCommaExpected"),pas.System.VarRecs(0,this.FScanner.FPos,18,this.CurrentToken())))}while(!(F===n||n<0&&9===this.TokenType()));9!==this.TokenType()&&this.ParserError(pas.SysUtils.Format(rtl.getResStr(t,"SErrBracketExpected"),pas.System.VarRecs(0,this.FScanner.FPos,18,this.CurrentToken())))}catch(t){if(pas.SysUtils.Exception.isPrototypeOf(t)){for(F-=1;F>=0;)pas.SysUtils.FreeAndNil({a:F,p:h,get:function(){return this.p[this.a]},set:function(t){this.p[this.a]=t}}),F-=1;throw t}throw t}}if(r)e=t.TIfOperation.$create("Create$2",[h[0],h[1],h[2]]);else if(a)e=t.TCaseOperation.$create("Create$1",[rtl.arrayRef(h)]);else{var p=l.FIDType;0===p?e=t.TFPExprVariable.$create("CreateIdentifier",[l]):1===p?e=t.TFPFunctionEventHandler.$create("CreateFunction",[l,h]):2===p&&(e=l.FNodeType.$create("CreateFunction",[l,h]))}}else this.ParserError(pas.SysUtils.Format(rtl.getResStr(t,"SerrUnknownTokenAtPos"),pas.System.VarRecs(0,this.FScanner.FPos,18,this.CurrentToken())));return this.GetToken(),e},this.GetToken=function(){return this.FScanner.GetToken()},this.TokenType=function(){return this.FScanner.FTokenType},this.CurrentToken=function(){return this.FScanner.FToken},this.CreateHashList=function(){var t=null,e=null,i=0,s=null;if(this.FHashList.Clear(),s=this.$class.BuiltinsManager(),rtl.neSet(this.FBuiltIns,{})&&null!=s)for(var o=0,n=s.GetCount()-1;o<=n;o++)i=o,(e=s.GetI(i)).FCategory in this.FBuiltIns&&this.FHashList.Add(pas.SysUtils.LowerCase(e.FName),e);for(var r=0,a=this.FIdentifiers.GetCount()-1;r<=a;r++)i=r,t=this.FIdentifiers.GetI(i),this.FHashList.Add(pas.SysUtils.LowerCase(t.FName),t);this.FDirty=!1},this.Create$1=function(e){return pas.Classes.TComponent.Create$1.call(this,e),this.FIdentifiers=t.TFPExprIdentifierDefs.$create("Create$1",[t.TFPExprIdentifierDef]),this.FIdentifiers.FParser=this,this.FScanner=t.TFPExpressionScanner.$create("Create$1"),this.FHashList=pas.contnrs.TFPObjectHashTable.$create("Create$2",[!1]),this},this.Destroy=function(){pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FHashList},set:function(t){this.p.FHashList=t}}),pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FExprNode},set:function(t){this.p.FExprNode=t}}),pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FIdentifiers},set:function(t){this.p.FIdentifiers=t}}),pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FScanner},set:function(t){this.p.FScanner=t}}),pas.Classes.TComponent.Destroy.call(this)},this.IdentifierByName=function(t){return this.FDirty&&this.CreateHashList(),this.FHashList.GetData(pas.SysUtils.LowerCase(t))},this.EvaluateExpression=function(t){t.$assign(this.Evaluate$1())},this.Evaluate$1=function(){var e=t.TFPExpressionResult.$new();return""===this.FExpression&&this.ParserError(rtl.getResStr(t,"SErrInExpressionEmpty")),null==this.FExprNode&&this.ParserError(rtl.getResStr(t,"SErrInExpression")),e.$assign(this.FExprNode.GetNodeValue()),e},rtl.addIntf(this,pas.System.IUnknown);var i=this.$rtti;i.addProperty("Expression",2,rtl.string,"FExpression","SetExpression"),i.addProperty("Identifiers",2,t.$rtti.TFPExprIdentifierDefs,"FIdentifiers","SetIdentifiers"),i.addProperty("BuiltIns",2,t.$rtti.TBuiltInCategories,"FBuiltIns","SetBuiltIns")})),rtl.createClass(this,"TExprBuiltInManager",pas.Classes.TComponent,(function(){this.$init=function(){pas.Classes.TComponent.$init.call(this),this.FDefs=null},this.$final=function(){this.FDefs=void 0,pas.Classes.TComponent.$final.call(this)},this.GetCount=function(){return this.FDefs.GetCount()},this.GetI=function(t){return this.FDefs.GetI(t)},this.Create$1=function(e){return pas.Classes.TComponent.Create$1.call(this,e),this.FDefs=t.TFPExprIdentifierDefs.$create("Create$1",[t.TFPBuiltInExprIdentifierDef]),this},this.Destroy=function(){pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FDefs},set:function(t){this.p.FDefs=t}}),pas.Classes.TComponent.Destroy.call(this)},this.AddFloatVariable=function(t,e,i){var s=null;return(s=this.FDefs.AddFloatVariable(e,i)).FCategory=t,s},this.AddFunction=function(t,e,i,s,o){var n=null;return(n=this.FDefs.AddFunction(e,i,s,o)).FCategory=t,n},this.AddFunction$1=function(t,e,i,s,o){var n=null;return(n=this.FDefs.AddFunction$1(e,i,s,o)).FCategory=t,n},rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"EExprParser",pas.SysUtils.Exception,(function(){})),this.AllBuiltIns=rtl.createSet(0,1,2,3,4,5,6,7,8),this.ResultTypeName=function(e){return pas.TypInfo.GetEnumName(t.$rtti.TResultType,e)},this.CharToResultType=function(i){var s=0,o=pas.System.upcase(i);return"S"===o?s=4:"D"===o?s=3:"B"===o?s=0:"I"===o?s=1:"F"===o?s=2:"C"===o?s=5:e.RaiseParserError$1(rtl.getResStr(t,"SErrInvalidResultCharacter"),pas.System.VarRecs(9,i)),s},this.BuiltinIdentifiers=function(){return null===e.BuiltIns&&(e.BuiltIns=t.TExprBuiltInManager.$create("Create$1",[null])),e.BuiltIns},this.RegisterStdBuiltins=function(i,s){2 in s&&(i.AddFloatVariable(2,"pi",Math.PI),i.AddFunction(2,"cos","F","F",e.BuiltInCos),i.AddFunction(2,"sin","F","F",e.BuiltInSin),i.AddFunction(2,"abs","F","F",e.BuiltInAbs),i.AddFunction(2,"sqr","F","F",e.BuiltInSqr),i.AddFunction(2,"sqrt","F","F",e.BuiltInSqrt),i.AddFunction(2,"exp","F","F",e.BuiltInExp),i.AddFunction(2,"ln","F","F",e.BuiltInLn),i.AddFunction(2,"log","F","F",e.BuiltInLog),i.AddFunction(2,"frac","F","F",e.BuiltInFrac),i.AddFunction(2,"int","F","F",e.BuiltInInt),i.AddFunction(2,"round","I","F",e.BuiltInRound),i.AddFunction(2,"trunc","I","F",e.BuiltInTrunc)),0 in s&&(i.AddFunction(0,"length","I","S",e.BuiltInLength),i.AddFunction(0,"copy","S","SII",e.BuiltInCopy),i.AddFunction(0,"delete","S","SII",e.BuiltInDelete),i.AddFunction(0,"pos","I","SS",e.BuiltInPos),i.AddFunction(0,"lowercase","S","S",e.BuiltInLowercase),i.AddFunction(0,"uppercase","S","S",e.BuiltInUppercase),i.AddFunction(0,"stringreplace","S","SSSBB",e.BuiltInStringReplace),i.AddFunction(0,"comparetext","I","SS",e.BuiltInCompareText)),1 in s&&(i.AddFunction(1,"date","D","",e.BuiltInDate),i.AddFunction(1,"time","D","",e.BuiltInTime),i.AddFunction(1,"now","D","",e.BuiltInNow),i.AddFunction(1,"dayofweek","I","D",e.BuiltInDayofWeek),i.AddFunction(1,"extractyear","I","D",e.BuiltInExtractYear),i.AddFunction(1,"extractmonth","I","D",e.BuiltInExtractMonth),i.AddFunction(1,"extractday","I","D",e.BuiltInExtractDay),i.AddFunction(1,"extracthour","I","D",e.BuiltInExtractHour),i.AddFunction(1,"extractmin","I","D",e.BuiltInExtractMin),i.AddFunction(1,"extractsec","I","D",e.BuiltInExtractSec),i.AddFunction(1,"extractmsec","I","D",e.BuiltInExtractMSec),i.AddFunction(1,"encodedate","D","III",e.BuiltInEncodedate),i.AddFunction(1,"encodetime","D","IIII",e.BuiltInEncodeTime),i.AddFunction(1,"encodedatetime","D","IIIIIII",e.BuiltInEncodeDateTime),i.AddFunction(1,"shortdayname","S","I",e.BuiltInShortDayName),i.AddFunction(1,"shortmonthname","S","I",e.BuiltInShortMonthName),i.AddFunction(1,"longdayname","S","I",e.BuiltInLongDayName),i.AddFunction(1,"longmonthname","S","I",e.BuiltInLongMonthName)),3 in s&&(i.AddFunction(3,"shl","I","II",e.BuiltInShl),i.AddFunction(3,"shr","I","II",e.BuiltInShr),i.AddFunction(3,"IFS","S","BSS",e.BuiltinIFS),i.AddFunction(3,"IFF","F","BFF",e.BuiltinIFF),i.AddFunction(3,"IFD","D","BDD",e.BuiltinIFD),i.AddFunction(3,"IFI","I","BII",e.BuiltinIFI)),4 in s&&(i.AddFunction(4,"inttostr","S","I",e.BuiltInIntToStr),i.AddFunction(4,"strtoint","I","S",e.BuiltInStrToInt),i.AddFunction(4,"strtointdef","I","SI",e.BuiltInStrToIntDef),i.AddFunction(4,"floattostr","S","F",e.BuiltInFloatToStr),i.AddFunction(4,"strtofloat","F","S",e.BuiltInStrToFloat),i.AddFunction(4,"strtofloatdef","F","SF",e.BuiltInStrToFloatDef),i.AddFunction(4,"booltostr","S","B",e.BuiltInBoolToStr),i.AddFunction(4,"strtobool","B","S",e.BuiltInStrToBool),i.AddFunction(4,"strtobooldef","B","SB",e.BuiltInStrToBoolDef),i.AddFunction(4,"datetostr","S","D",e.BuiltInDateToStr),i.AddFunction(4,"timetostr","S","D",e.BuiltInTimeToStr),i.AddFunction(4,"strtodate","D","S",e.BuiltInStrToDate),i.AddFunction(4,"strtodatedef","D","SD",e.BuiltInStrToDateDef),i.AddFunction(4,"strtotime","D","S",e.BuiltInStrToTime),i.AddFunction(4,"strtotimedef","D","SD",e.BuiltInStrToTimeDef),i.AddFunction(4,"strtodatetime","D","S",e.BuiltInStrToDateTime),i.AddFunction(4,"strtodatetimedef","D","SD",e.BuiltInStrToDateTimeDef),i.AddFunction(4,"formatfloat","S","SF",e.BuiltInFormatFloat),i.AddFunction(4,"formatdatetime","S","SD",e.BuiltInFormatDateTime)),8 in s&&(i.AddFunction$1(8,"count","I","",t.TAggregateCount),i.AddFunction$1(8,"sum","F","F",t.TAggregateSum),i.AddFunction$1(8,"avg","F","F",t.TAggregateAvg),i.AddFunction$1(8,"min","F","F",t.TAggregateMin),i.AddFunction$1(8,"max","F","F",t.TAggregateMax))},this.ArgToFloat=function(t){return 1===t.ResultType?rtl.trunc(t.resValue):5===t.ResultType?rtl.trunc(1e4*t.resValue)/1e4:rtl.getNumber(t.resValue)},t.$implcode=function(){e.cNull="\0",e.cSingleQuote="'",e.cHexIdentifier="$",e.cOctalIdentifier="&",e.cBinaryIdentifier="%",e.Digits=rtl.createSet(null,48,57,46),e.HexDigits=rtl.createSet(null,48,57,null,65,70,null,97,102),e.OctalDigits=rtl.createSet(null,48,55),e.BinaryDigits=rtl.createSet(48,49),e.WhiteSpace=rtl.createSet(32,13,10,9),e.Operators=rtl.createSet(43,45,60,62,61,47,42,94),e.Delimiters=rtl.unionSet(e.Operators,rtl.createSet(44,40,41)),e.Symbols=rtl.unionSet(rtl.createSet(37),e.Delimiters),e.WordDelimiters=rtl.unionSet(e.WhiteSpace,e.Symbols),e.FileFormatSettings=pas.SysUtils.TFormatSettings.$new(),e.RaiseParserError=function(e){throw t.EExprParser.$create("Create$1",[e])},e.RaiseParserError$1=function(e,i){throw t.EExprParser.$create("CreateFmt",[e,i])},e.BuiltIns=null,e.power=function(t,e){var i=0,s=0;return 0===e?i=1:0===t&&e>0?i=0:t<0&&0===pas.System.Frac(e)?(s=Math.round(e),i=Math.exp(e*Math.log(-t)),pas.System.Odd(s)&&(i=-i)):i=Math.exp(e*Math.log(t)),i},e.BuiltInCos=function(e){var i=t.TFPExpressionResult.$new();return i.ResultType=2,i.resValue=Math.cos(t.ArgToFloat(t.TFPExpressionResult.$clone(e[0]))),i},e.BuiltInSin=function(e){var i=t.TFPExpressionResult.$new();return i.ResultType=2,i.resValue=Math.sin(t.ArgToFloat(t.TFPExpressionResult.$clone(e[0]))),i},e.BuiltInAbs=function(e){var i=t.TFPExpressionResult.$new();return i.ResultType=2,i.resValue=Math.abs(t.ArgToFloat(t.TFPExpressionResult.$clone(e[0]))),i},e.BuiltInSqr=function(e){var i=t.TFPExpressionResult.$new();return i.ResultType=2,i.resValue=pas.System.Sqr$1(t.ArgToFloat(t.TFPExpressionResult.$clone(e[0]))),i},e.BuiltInSqrt=function(e){var i=t.TFPExpressionResult.$new();return i.ResultType=2,i.resValue=Math.sqrt(t.ArgToFloat(t.TFPExpressionResult.$clone(e[0]))),i},e.BuiltInExp=function(e){var i=t.TFPExpressionResult.$new();return i.ResultType=2,i.resValue=Math.exp(t.ArgToFloat(t.TFPExpressionResult.$clone(e[0]))),i},e.BuiltInLn=function(e){var i=t.TFPExpressionResult.$new();return i.ResultType=2,i.resValue=Math.log(t.ArgToFloat(t.TFPExpressionResult.$clone(e[0]))),i},e.L10=0,e.BuiltInLog=function(i){var s=t.TFPExpressionResult.$new();return s.ResultType=2,s.resValue=Math.log(t.ArgToFloat(t.TFPExpressionResult.$clone(i[0])))/e.L10,s},e.BuiltInRound=function(e){var i=t.TFPExpressionResult.$new();return i.ResultType=1,i.resValue=Math.round(t.ArgToFloat(t.TFPExpressionResult.$clone(e[0]))),i},e.BuiltInTrunc=function(e){var i=t.TFPExpressionResult.$new();return i.ResultType=1,i.resValue=pas.System.Trunc(t.ArgToFloat(t.TFPExpressionResult.$clone(e[0]))),i},e.BuiltInInt=function(e){var i=t.TFPExpressionResult.$new();return i.ResultType=1,i.resValue=pas.System.Int(t.ArgToFloat(t.TFPExpressionResult.$clone(e[0]))),i},e.BuiltInFrac=function(e){var i=t.TFPExpressionResult.$new();return i.ResultType=2,i.resValue=pas.System.Frac(t.ArgToFloat(t.TFPExpressionResult.$clone(e[0]))),i},e.BuiltInLength=function(e){var i=t.TFPExpressionResult.$new();return i.ResultType=1,i.resValue=(""+e[0].resValue).length,i},e.BuiltInCopy=function(e){var i=t.TFPExpressionResult.$new();return i.ResultType=4,i.resValue=pas.System.Copy(""+e[0].resValue,rtl.trunc(e[1].resValue),rtl.trunc(e[2].resValue)),i},e.BuiltInDelete=function(e){var i=t.TFPExpressionResult.$new(),s="";return i.ResultType=4,s=""+e[0].resValue,pas.System.Delete({get:function(){return s},set:function(t){s=t}},rtl.trunc(e[1].resValue),rtl.trunc(e[2].resValue)),i.resValue=s,i},e.BuiltInPos=function(e){var i=t.TFPExpressionResult.$new();return i.ResultType=1,i.resValue=pas.System.Pos(""+e[0].resValue,""+e[1].resValue),i},e.BuiltInUppercase=function(e){var i=t.TFPExpressionResult.$new();return i.ResultType=4,i.resValue=pas.SysUtils.UpperCase(""+e[0].resValue),i},e.BuiltInLowercase=function(e){var i=t.TFPExpressionResult.$new();return i.ResultType=4,i.resValue=pas.SysUtils.LowerCase(""+e[0].resValue),i},e.BuiltInStringReplace=function(e){var i=t.TFPExpressionResult.$new(),s={};return i.ResultType=4,s={},0!=e[3].resValue&&(s=rtl.includeSet(s,0)),0!=e[4].resValue&&(s=rtl.includeSet(s,1)),i.resValue=pas.SysUtils.StringReplace(""+e[0].resValue,""+e[1].resValue,""+e[2].resValue,rtl.refSet(s)),i},e.BuiltInCompareText=function(e){var i=t.TFPExpressionResult.$new();return i.ResultType=1,i.resValue=pas.SysUtils.CompareText(""+e[0].resValue,""+e[1].resValue),i},e.BuiltInDate=function(e){var i=t.TFPExpressionResult.$new();return i.ResultType=3,i.resValue=pas.SysUtils.Date(),i},e.BuiltInTime=function(e){var i=t.TFPExpressionResult.$new();return i.ResultType=3,i.resValue=pas.SysUtils.Time(),i},e.BuiltInNow=function(e){var i=t.TFPExpressionResult.$new();return i.ResultType=3,i.resValue=pas.SysUtils.Now(),i},e.BuiltInDayofWeek=function(e){var i=t.TFPExpressionResult.$new();return i.ResultType=1,i.resValue=pas.SysUtils.DayOfWeek(rtl.getNumber(e[0].resValue)),i},e.BuiltInExtractYear=function(e){var i=t.TFPExpressionResult.$new(),s=0,o=0,n=0;return i.ResultType=1,pas.SysUtils.DecodeDate(rtl.getNumber(e[0].resValue),{get:function(){return s},set:function(t){s=t}},{get:function(){return o},set:function(t){o=t}},{get:function(){return n},set:function(t){n=t}}),i.resValue=s,i},e.BuiltInExtractMonth=function(e){var i=t.TFPExpressionResult.$new(),s=0,o=0,n=0;return i.ResultType=1,pas.SysUtils.DecodeDate(rtl.getNumber(e[0].resValue),{get:function(){return s},set:function(t){s=t}},{get:function(){return o},set:function(t){o=t}},{get:function(){return n},set:function(t){n=t}}),i.resValue=o,i},e.BuiltInExtractDay=function(e){var i=t.TFPExpressionResult.$new(),s=0,o=0,n=0;return i.ResultType=1,pas.SysUtils.DecodeDate(rtl.getNumber(e[0].resValue),{get:function(){return s},set:function(t){s=t}},{get:function(){return o},set:function(t){o=t}},{get:function(){return n},set:function(t){n=t}}),i.resValue=n,i},e.BuiltInExtractHour=function(e){var i=t.TFPExpressionResult.$new(),s=0,o=0,n=0,r=0;return i.ResultType=1,pas.SysUtils.DecodeTime(rtl.getNumber(e[0].resValue),{get:function(){return s},set:function(t){s=t}},{get:function(){return o},set:function(t){o=t}},{get:function(){return n},set:function(t){n=t}},{get:function(){return r},set:function(t){r=t}}),i.resValue=s,i},e.BuiltInExtractMin=function(e){var i=t.TFPExpressionResult.$new(),s=0,o=0,n=0,r=0;return i.ResultType=1,pas.SysUtils.DecodeTime(rtl.getNumber(e[0].resValue),{get:function(){return s},set:function(t){s=t}},{get:function(){return o},set:function(t){o=t}},{get:function(){return n},set:function(t){n=t}},{get:function(){return r},set:function(t){r=t}}),i.resValue=o,i},e.BuiltInExtractSec=function(e){var i=t.TFPExpressionResult.$new(),s=0,o=0,n=0,r=0;return i.ResultType=1,pas.SysUtils.DecodeTime(rtl.getNumber(e[0].resValue),{get:function(){return s},set:function(t){s=t}},{get:function(){return o},set:function(t){o=t}},{get:function(){return n},set:function(t){n=t}},{get:function(){return r},set:function(t){r=t}}),i.resValue=n,i},e.BuiltInExtractMSec=function(e){var i=t.TFPExpressionResult.$new(),s=0,o=0,n=0,r=0;return i.ResultType=1,pas.SysUtils.DecodeTime(rtl.getNumber(e[0].resValue),{get:function(){return s},set:function(t){s=t}},{get:function(){return o},set:function(t){o=t}},{get:function(){return n},set:function(t){n=t}},{get:function(){return r},set:function(t){r=t}}),i.resValue=r,i},e.BuiltInEncodedate=function(e){var i=t.TFPExpressionResult.$new();return i.ResultType=3,i.resValue=pas.SysUtils.EncodeDate(rtl.trunc(e[0].resValue),rtl.trunc(e[1].resValue),rtl.trunc(e[2].resValue)),i},e.BuiltInEncodeTime=function(e){var i=t.TFPExpressionResult.$new();return i.ResultType=3,i.resValue=pas.SysUtils.EncodeTime(rtl.trunc(e[0].resValue),rtl.trunc(e[1].resValue),rtl.trunc(e[2].resValue),rtl.trunc(e[3].resValue)),i},e.BuiltInEncodeDateTime=function(e){var i=t.TFPExpressionResult.$new();return i.ResultType=3,i.resValue=pas.SysUtils.EncodeDate(rtl.trunc(e[0].resValue),rtl.trunc(e[1].resValue),rtl.trunc(e[2].resValue))+pas.SysUtils.EncodeTime(rtl.trunc(e[3].resValue),rtl.trunc(e[4].resValue),rtl.trunc(e[5].resValue),rtl.trunc(e[6].resValue)),i},e.BuiltInShortDayName=function(e){var i=t.TFPExpressionResult.$new();return i.ResultType=4,i.resValue=pas.SysUtils.FormatSettings.ShortDayNames[rtl.trunc(e[0].resValue)-1],i},e.BuiltInShortMonthName=function(e){var i=t.TFPExpressionResult.$new();return i.ResultType=4,i.resValue=pas.SysUtils.FormatSettings.ShortMonthNames[rtl.trunc(e[0].resValue)-1],i},e.BuiltInLongDayName=function(e){var i=t.TFPExpressionResult.$new();return i.resValue=pas.SysUtils.FormatSettings.LongDayNames[rtl.trunc(e[0].resValue)-1],i},e.BuiltInLongMonthName=function(e){var i=t.TFPExpressionResult.$new();return i.ResultType=4,i.resValue=pas.SysUtils.FormatSettings.LongMonthNames[rtl.trunc(e[0].resValue)-1],i},e.BuiltInFormatDateTime=function(e){var i=t.TFPExpressionResult.$new();return i.ResultType=4,i.resValue=pas.SysUtils.FormatDateTime(""+e[0].resValue,rtl.getNumber(e[1].resValue)),i},e.BuiltInIntToStr=function(e){var i=t.TFPExpressionResult.$new();return i.ResultType=4,i.resValue=pas.SysUtils.IntToStr(rtl.trunc(e[0].resValue)),i},e.BuiltInStrToInt=function(e){var i=t.TFPExpressionResult.$new();return i.ResultType=1,i.resValue=pas.SysUtils.StrToInt(""+e[0].resValue),i},e.BuiltInStrToIntDef=function(e){var i=t.TFPExpressionResult.$new();return i.ResultType=1,i.resValue=pas.SysUtils.StrToIntDef$1(""+e[0].resValue,rtl.trunc(e[1].resValue)),i},e.BuiltInFloatToStr=function(e){var i=t.TFPExpressionResult.$new();return i.ResultType=4,i.resValue=pas.SysUtils.FloatToStr(rtl.getNumber(e[0].resValue)),i},e.BuiltInStrToFloat=function(e){var i=t.TFPExpressionResult.$new();return i.ResultType=2,i.resValue=pas.SysUtils.StrToFloat(""+e[0].resValue),i},e.BuiltInStrToFloatDef=function(e){var i=t.TFPExpressionResult.$new();return i.ResultType=2,i.resValue=pas.SysUtils.StrToFloatDef(""+e[0].resValue,rtl.getNumber(e[1].resValue)),i},e.BuiltInDateToStr=function(e){var i=t.TFPExpressionResult.$new();return i.ResultType=4,i.resValue=pas.SysUtils.DateToStr(rtl.getNumber(e[0].resValue)),i},e.BuiltInTimeToStr=function(e){var i=t.TFPExpressionResult.$new();return i.ResultType=4,i.resValue=pas.SysUtils.TimeToStr(rtl.getNumber(e[0].resValue)),i},e.BuiltInStrToDate=function(e){var i=t.TFPExpressionResult.$new();return i.ResultType=3,i.resValue=pas.SysUtils.StrToDate(""+e[0].resValue),i},e.BuiltInStrToDateDef=function(e){var i=t.TFPExpressionResult.$new();return i.ResultType=3,i.resValue=pas.SysUtils.StrToDateDef(""+e[0].resValue,rtl.getNumber(e[1].resValue)),i},e.BuiltInStrToTime=function(e){var i=t.TFPExpressionResult.$new();return i.ResultType=3,i.resValue=pas.SysUtils.StrToTime(""+e[0].resValue),i},e.BuiltInStrToTimeDef=function(e){var i=t.TFPExpressionResult.$new();return i.ResultType=3,i.resValue=pas.SysUtils.StrToTimeDef(""+e[0].resValue,rtl.getNumber(e[1].resValue)),i},e.BuiltInStrToDateTime=function(e){var i=t.TFPExpressionResult.$new();return i.ResultType=3,i.resValue=pas.SysUtils.StrToDateTime(""+e[0].resValue),i},e.BuiltInStrToDateTimeDef=function(e){var i=t.TFPExpressionResult.$new();return i.ResultType=3,i.resValue=pas.SysUtils.StrToDateTimeDef(""+e[0].resValue,rtl.getNumber(e[1].resValue)),i},e.BuiltInFormatFloat=function(e){var i=t.TFPExpressionResult.$new();return i.ResultType=4,i.resValue=pas.SysUtils.FormatFloat(""+e[0].resValue,rtl.getNumber(e[1].resValue)),i},e.BuiltInBoolToStr=function(e){var i=t.TFPExpressionResult.$new();return i.ResultType=4,i.resValue=pas.SysUtils.BoolToStr(!(0==e[0].resValue),!1),i},e.BuiltInStrToBool=function(e){var i=t.TFPExpressionResult.$new();return i.ResultType=0,i.resValue=pas.SysUtils.StrToBool(""+e[0].resValue),i},e.BuiltInStrToBoolDef=function(e){var i=t.TFPExpressionResult.$new();return i.resValue=pas.SysUtils.StrToBoolDef(""+e[0].resValue,!(0==e[1].resValue)),i.ResultType=0,i},e.BuiltInShl=function(e){var i=t.TFPExpressionResult.$new();return i.ResultType=1,i.resValue=rtl.shl(rtl.trunc(e[0].resValue),rtl.trunc(e[1].resValue)),i},e.BuiltInShr=function(e){var i=t.TFPExpressionResult.$new();return i.ResultType=1,i.resValue=rtl.shr(rtl.trunc(e[0].resValue),rtl.trunc(e[1].resValue)),i},e.BuiltinIFS=function(e){var i=t.TFPExpressionResult.$new();return i.ResultType=4,0!=e[0].resValue?i.resValue=e[1].resValue:i.resValue=e[2].resValue,i},e.BuiltinIFI=function(e){var i=t.TFPExpressionResult.$new();return i.ResultType=1,0!=e[0].resValue?i.resValue=e[1].resValue:i.resValue=e[2].resValue,i},e.BuiltinIFF=function(e){var i=t.TFPExpressionResult.$new();return i.ResultType=2,0!=e[0].resValue?i.resValue=e[1].resValue:i.resValue=e[2].resValue,i},e.BuiltinIFD=function(e){var i=t.TFPExpressionResult.$new();return i.ResultType=3,0!=e[0].resValue?i.resValue=e[1].resValue:i.resValue=e[2].resValue,i},e.InitFileFormatSettings=function(){e.FileFormatSettings.$assign(pas.SysUtils.FormatSettings),e.FileFormatSettings.DecimalSeparator=".",e.FileFormatSettings.DateSeparator="-",e.FileFormatSettings.TimeSeparator=":",e.FileFormatSettings.ShortDateFormat="yyyy-mm-dd",e.FileFormatSettings.LongTimeFormat="hh:nn:ss"},t.$resourcestrings={SBadQuotes:{org:"Unterminated string"},SUnknownDelimiter:{org:'Unknown delimiter character: "%s"'},SErrUnknownCharacter:{org:'Unknown character at pos %d: "%s"'},SErrUnexpectedEndOfExpression:{org:"Unexpected end of expression"},SErrUnknownComparison:{org:"Internal error: Unknown comparison"},SErrUnknownBooleanOp:{org:"Internal error: Unknown boolean operation"},SErrBracketExpected:{org:"Expected ) bracket at position %d, but got %s"},SerrUnknownTokenAtPos:{org:"Unknown token at pos %d : %s"},SErrLeftBracketExpected:{org:"Expected ( bracket at position %d, but got %s"},SErrInvalidFloat:{org:"%s is not a valid floating-point value"},SErrUnknownIdentifier:{org:"Unknown identifier: %s"},SErrInExpression:{org:"Cannot evaluate: error in expression"},SErrInExpressionEmpty:{org:"Cannot evaluate: empty expression"},SErrCommaExpected:{org:"Expected comma (,) at position %d, but got %s"},SErrInvalidNumberChar:{org:"Unexpected character in number : %s"},SErrInvalidNumber:{org:"Invalid numerical value : %s"},SErrUnterminatedIdentifier:{org:"Unterminated quoted identifier: %s"},SErrNoOperand:{org:"No operand for unary operation %s"},SErrNoleftOperand:{org:"No left operand for binary operation %s"},SErrNoRightOperand:{org:"No right operand for binary operation %s"},SErrNoNegation:{org:"Cannot negate expression of type %s : %s"},SErrNoNOTOperation:{org:'Cannot perform "not" on expression of type %s: %s'},SErrTypesDoNotMatch:{org:'Type mismatch: %s<>%s for expressions "%s" and "%s".'},SErrNoNodeToCheck:{org:"Internal error: No node to check !"},SInvalidNodeType:{org:"Node type (%s) not in allowed types (%s) for expression: %s"},SErrUnterminatedExpression:{org:"Badly terminated expression. Found token at position %d : %s"},SErrDuplicateIdentifier:{org:'An identifier with name "%s" already exists.'},SErrInvalidResultCharacter:{org:'"%s" is not a valid return type indicator'},ErrInvalidArgumentCount:{org:"Invalid argument count for function %s"},SErrInvalidArgumentType:{org:"Invalid type for argument %d: Expected %s, got %s"},SErrInvalidResultType:{org:"Invalid result type: %s"},SErrIFNeedsBoolean:{org:"First argument to IF must be of type boolean: %s"},SErrCaseNeeds3:{org:"Case statement needs to have at least 4 arguments"},SErrCaseEvenCount:{org:"Case statement needs to have an even number of arguments"},SErrCaseLabelNotAConst:{org:'Case label %d "%s" is not a constant expression'},SErrCaseLabelType:{org:'Case label %d "%s" needs type %s, but has type %s'},SErrCaseValueType:{org:'Case value %d "%s" needs type %s, but has type %s'}}},t.$init=function(){e.L10=Math.log(10),t.RegisterStdBuiltins(t.BuiltinIdentifiers(),t.AllBuiltIns),e.InitFileFormatSettings()}}),["TypInfo"]),rtl.module("JSONDataset",["System","Types","JS","DB","Classes","SysUtils","TypInfo","fpexprpars"],(function(){"use strict";var t=this;this.TJSONRowType={0:"rtJSONObject",rtJSONObject:0,1:"rtJSONArray",rtJSONArray:1},rtl.createClass(this,"TJSONFieldMapper",pas.System.TObject,(function(){this.CopyRow=function(t){return JSON.parse(JSON.stringify(t))},this.GetJSONDataForField$1=function(t,e){return this.GetJSONDataForField(t.FFieldName,t.GetIndex(),e)},this.SetJSONDataForField$1=function(t,e,i){this.SetJSONDataForField(t.FFieldName,t.GetIndex(),e,i)}})),rtl.createClass(this,"TJSONDateField",pas.DB.TDateField,(function(){this.$init=function(){pas.DB.TDateField.$init.call(this),this.FDateFormat=""},rtl.addIntf(this,pas.System.IUnknown),this.$rtti.addProperty("DateFormat",0,rtl.string,"FDateFormat","FDateFormat")})),rtl.createClass(this,"TJSONTimeField",pas.DB.TTimeField,(function(){this.$init=function(){pas.DB.TTimeField.$init.call(this),this.FTimeFormat=""},rtl.addIntf(this,pas.System.IUnknown),this.$rtti.addProperty("TimeFormat",0,rtl.string,"FTimeFormat","FTimeFormat")})),rtl.createClass(this,"TJSONDateTimeField",pas.DB.TDateTimeField,(function(){this.$init=function(){pas.DB.TDateTimeField.$init.call(this),this.FDateTimeFormat=""},rtl.addIntf(this,pas.System.IUnknown),this.$rtti.addProperty("DateTimeFormat",0,rtl.string,"FDateTimeFormat","FDateTimeFormat")})),rtl.createClass(this,"TFieldComparer",pas.System.TObject,(function(){this.$init=function(){pas.System.TObject.$init.call(this),this.FDesc=!1,this.FValue=void 0,this.FField=null,this.FOptions={},this.FDataset=null},this.$final=function(){this.FField=void 0,this.FOptions=void 0,this.FDataset=void 0,pas.System.TObject.$final.call(this)},this.Create$1=function(t,e,i,s){return this.FField=e,this.FValue=i,this.FOptions=rtl.refSet(s),this.FDataset=t,this},this.GetFieldValue=function(t){return this.FDataset.FFieldMapper.GetJSONDataForField$1(this.FField,this.FDataset.FRows[t])},this.CompareRows=function(t,e){return this.Compare(t,this.GetFieldValue(e))},this.Compare$1=function(t){return this.Compare(t,this.FValue)}})),rtl.createClass(this,"TStringFieldComparer",this.TFieldComparer,(function(){this.Compare=function(t,e){var i,s="";return s=""+this.GetFieldValue(t),i=""+e,1 in this.FOptions&&(s=pas.System.Copy(s,1,i.length)),0 in this.FOptions?pas.SysUtils.CompareText(s,i):pas.SysUtils.CompareStr(s,i)}})),rtl.createClass(this,"TNativeIntFieldComparer",this.TFieldComparer,(function(){this.Compare=function(t,e){return rtl.trunc(this.GetFieldValue(t))-rtl.trunc(e)}})),rtl.createClass(this,"TBooleanFieldComparer",this.TFieldComparer,(function(){this.Compare=function(t,e){return!(0==this.GetFieldValue(t))+0-(!(0==e)+0)}})),rtl.createClass(this,"TDateTimeFieldComparer",this.TFieldComparer,(function(){this.Compare=function(t,e){var i,s,o=this;function n(t){return pas.JS.isDate(t)?pas.SysUtils.JSDateToDateTime(t):o.FDataset.ConvertDateTimeField(""+t,o.FField)}return i=n(this.GetFieldValue(t)),s=n(e),Math.round(i-s)}})),rtl.createClass(this,"TFloatFieldComparer",this.TFieldComparer,(function(){this.Compare=function(t,e){var i,s;return i=rtl.getNumber(this.GetFieldValue(t)),s=rtl.getNumber(e),Math.round(i-s)}})),rtl.createClass(this,"TRecordComparer",pas.System.TObject,(function(){this.$init=function(){pas.System.TObject.$init.call(this),this.FDataset=null,this.FIndexBased=!1,this.FItems=[],this.FOptions={},this.FValues=[]},this.$final=function(){this.FDataset=void 0,this.FItems=void 0,this.FOptions=void 0,this.FValues=void 0,pas.System.TObject.$final.call(this)},this.ConstructItems=function(t){var e=null,i=null,s=null,o=0;e=pas.Classes.TFPList.$create("Create");try{if(this.FDataset.GetFieldList$1(e,t),!this.FIndexBased&&e.FCount!==rtl.length(this.FValues))throw pas.DB.EDatabaseError.$create("CreateFmt",["Array of values has different length (%d) from array of fields (%d)",pas.System.VarRecs(19,rtl.length(this.FValues),0,e.FCount)]);this.FItems=rtl.arraySetLength(this.FItems,null,e.FCount);for(var n=0,r=e.FCount-1;n<=r;n++){if(o=n,s=rtl.getObject(e.Get(o)),null===(i=this.DataTypeToComparerClass(s.FDataType)))throw pas.DB.EDatabaseError.$create("CreateFmt",["Cannot locate on field %s of type %s)",pas.System.VarRecs(18,s.FFieldName,18,pas.TypInfo.GetEnumName(pas.DB.$rtti.TFieldType,s.FDataType))]);this.FIndexBased?this.FItems[o]=i.$create("Create$1",[this.FDataset,s,null,rtl.refSet(this.FOptions)]):this.FItems[o]=i.$create("Create$1",[this.FDataset,s,this.FValues[o],rtl.refSet(this.FOptions)])}}finally{e=rtl.freeLoc(e)}},this.DataTypeToComparerClass=function(e){var i=e;return 11===i||12===i||1===i||15===i?t.TStringFieldComparer:9===i||2===i||3===i?t.TNativeIntFieldComparer:4===i?t.TBooleanFieldComparer:5===i?t.TFloatFieldComparer:6===i||7===i||8===i?t.TDateTimeFieldComparer:null},this.Compare=function(t){var e,i=0,s=0;for(i=0,s=0,e=rtl.length(this.FItems);0===i&&s<e;)i=this.FItems[s].Compare$1(t),s+=1;return i},this.CompareRows=function(t,e){var i,s=0,o=0;for(s=0,o=0,i=rtl.length(this.FItems);0===s&&o<i;)0!==(s=this.FItems[o].CompareRows(t,e))&&this.FItems[o].FDesc&&(s=-s),o+=1;return s},this.updateFromIndex=function(t){var e=null,i=0;e=pas.Classes.TFPList.$create("Create");try{if(""!==t.FCaseinsFields){this.FDataset.GetFieldList$1(e,t.FCaseinsFields);for(var s=0,o=rtl.length(this.FItems)-1;s<=o;s++)i=s,-1!==e.IndexOf(this.FItems[i].FField)&&(this.FItems[i].FOptions=rtl.unionSet(this.FItems[i].FOptions,rtl.createSet(0)))}e.Clear(),this.FDataset.GetFieldList$1(e,t.FDescFields);for(var n=0,r=rtl.length(this.FItems)-1;n<=r;n++)i=n,this.FItems[i].FDesc=2 in t.FOptions||-1!==e.IndexOf(this.FItems[i].FField)}finally{e=rtl.freeLoc(e)}},this.Create$1=function(t,e,i,s){return this.FDataset=t,rtl.isArray(i)?this.FValues=i:(this.FValues=rtl.arraySetLength(this.FValues,void 0,1),this.FValues[0]=i),this.FOptions=rtl.refSet(s),this.ConstructItems(e),this},this.Create$2=function(t,e){return this.FDataset=t,this.FIndexBased=!0,3 in e.FOptions&&(this.FOptions=rtl.createSet(0)),this.ConstructItems(e.FFields),this.updateFromIndex(e),this},this.Destroy=function(){for(var t=0,e=0,i=rtl.length(this.FItems)-1;e<=i;e++)t=e,rtl.free(this.FItems,t);pas.System.TObject.Destroy.call(this)}})),rtl.createClass(this,"TJSONIndex",pas.System.TObject,(function(){this.$init=function(){pas.System.TObject.$init.call(this),this.FList=null,this.FRows=null,this.FDataset=null},this.$final=function(){this.FList=void 0,this.FRows=void 0,this.FDataset=void 0,pas.System.TObject.$final.call(this)},this.GetRecordIndex=function(t){return pas.JS.isUndefined(this.FList[t])?-1:rtl.trunc(this.FList[t])},this.GetCount=function(){return this.FList.length},this.ClearIndex=function(){this.FList.length=0},this.Create$1=function(t,e){return this.FRows=e,this.FList=new Array(this.FRows.length),this.FDataset=t,this.CreateIndex(),this},this.Delete=function(t){var e;return(e=this.FList.splice(t,1)).length>0?rtl.trunc(e[0]):-1},this.DeleteByRowIndex=function(t){var e;return-1!==(e=this.IndexOfRow(t))&&this.FList.splice(e,1),e},this.Insert=function(t,e){return this.Append(e)},this.IndexOfRow=function(t){return this.FList.indexOf(t)}})),rtl.createClass(this,"TDefaultJSONIndex",this.TJSONIndex,(function(){this.CreateIndex=function(){for(var t=0,e=0,i=this.FRows.length-1;e<=i;e++)t=e,this.FList[t]=t},this.AppendToIndex=function(){var t,e=0;t=this.FList.length,this.FList.length=this.FRows.length;for(var i=t,s=this.FRows.length-1;i<=s;i++)e=i,this.FList[e]=e},this.Append=function(t){return this.FList.push(t)-1},this.Insert=function(t,e){return this.FList.splice(t,0,e),t},this.FindRecord=function(t){return this.FList.indexOf(t)},this.Update=function(t){return t}})),rtl.createClass(this,"TSortedJSONIndex",this.TJSONIndex,(function(){this.$init=function(){t.TJSONIndex.$init.call(this),this.FComparer=null,this.FUnique=!1},this.$final=function(){this.FComparer=void 0,t.TJSONIndex.$final.call(this)},this.FindPos=function(t){var e=0,i=0,s=0,o=0,n=0;if(null==this.FComparer)return e;for(i=0,s=this.GetCount()-1;i<=s;)o=i+rtl.trunc((s-i)/2),(n=this.FComparer.CompareRows(t,rtl.trunc(this.FList[o])))>0?i=o+1:(s=o-1,0===n&&this.FUnique&&(i=o));return e=i},this.MergeSort=function(t){var e,i=null,s=null,o=0,n=0,r=0,a=0,l=0,h=0,F=0,p=0;if(null===t)return null;if(e=t.length,i=new Array(e),0===e)return i;for(l=1;;){for(o=0,a=0,h=0;o<e;){for(h+=1,l<(F=e-o)&&(F=l),n=o+F,p=l;F>0||p>0&&n<e;)0===F?(r=n,n+=1,p-=1):0===p||n>=e||this.FComparer.CompareRows(rtl.trunc(t[o]),rtl.trunc(t[n]))<=0?(r=o,o+=1,F-=1):(r=n,n+=1,p-=1),i[a]=t[r],a+=1;o=n}if(h<=1)return i;l*=2,s=i,i=t,t=s}return i},this.Destroy=function(){pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FComparer},set:function(t){this.p.FComparer=t}}),pas.System.TObject.Destroy.call(this)},this.CreateComparer=function(e){pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FComparer},set:function(t){this.p.FComparer=t}}),this.FComparer=t.TRecordComparer.$create("Create$2",[this.FDataset,e])},this.CreateIndex=function(){var t,e=[],i=0,s=0;if(null!==this.FComparer){t=this.FRows.length,e=rtl.arraySetLength(e,0,t),s=0;for(var o=0,n=t-1;o<=n;o++)i=o,pas.JS.isUndefined(this.FRows[i])||(e[s]=i,s+=1);e=rtl.arraySetLength(e,0,s),this.FList=this.MergeSort(e)}},this.AppendToIndex=function(){this.CreateIndex()},this.Append=function(t){var e;return e=this.FindPos(t),this.FList.splice(e,0,t),e},this.FindRecord=function(t){return this.FList.indexOf(t)},this.Update=function(t){var e,i;return i=this.FindRecord(t),(e=this.FindPos(t))!==i&&this.FList.splice(e,0,this.FList.splice(i,1)[0]),e}})),rtl.createClass(this,"TJSONIndexDef",pas.DB.TIndexDef,(function(){this.$init=function(){pas.DB.TIndexDef.$init.call(this),this.FIndex=null},this.$final=function(){this.FIndex=void 0,pas.DB.TIndexDef.$final.call(this)},this.ClearIndex=function(){pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FIndex},set:function(t){this.p.FIndex=t}})},this.BuildIndex=function(e){null===this.FIndex?this.FIndex=t.TSortedJSONIndex.$create("Create$1",[e,e.FRows]):this.FIndex.ClearIndex(),this.FIndex.CreateComparer(this),this.FIndex.CreateIndex()}})),rtl.createClass(this,"TJSONIndexDefs",pas.DB.TIndexDefs,(function(){this.GetD=function(e){return rtl.as(this.GetItem$1(e),t.TJSONIndexDef)}})),this.TBlobFormat={0:"bfHex",bfHex:0,1:"bfBase64",bfBase64:1,2:"bfBytes",bfBytes:2,3:"bfCustom",bfCustom:3},rtl.createClass(this,"TBaseJSONDataSet",pas.DB.TDataSet,(function(){this.$init=function(){pas.DB.TDataSet.$init.call(this),this.FActiveIndex="",this.FBlobFormat=0,this.FIndexes=null,this.FOnDecodeBlobValue=null,this.FOnEncodeBlobValue=null,this.FOwnsData=!1,this.FDefaultIndex=null,this.FCurrentIndex=null,this.FCurrent=0,this.FMetaData=null,this.FRows=null,this.FDeletedRows=null,this.FFieldMapper=null,this.FEditIdx=0,this.FEditRow=void 0,this.FFilterRow=void 0,this.FUseDateTimeFormatFields=!1,this.FRowType=0,this.FFilterExpression=null},this.$final=function(){this.FIndexes=void 0,this.FOnDecodeBlobValue=void 0,this.FOnEncodeBlobValue=void 0,this.FDefaultIndex=void 0,this.FCurrentIndex=void 0,this.FMetaData=void 0,this.FRows=void 0,this.FDeletedRows=void 0,this.FFieldMapper=void 0,this.FFilterExpression=void 0,pas.DB.TDataSet.$final.call(this)},this.GetFilterField=function(t){var e=pas.fpexprpars.TFPExpressionResult.$new(),i=null,s=0;i=this.FieldByName(t),e.ResultType=this.FieldTypeToExpressionType(i.FDataType);var o=e.ResultType;return 0===o?e.resValue=i.GetAsBoolean():1===o?e.resValue=i.GetAsLargeInt():2===o?e.resValue=i.GetAsFloat():3===o?e.resValue=i.GetAsDateTime():4===o?e.resValue=i.GetAsString():5===o&&(s=1e4*i.GetAsFloat(),e.resValue=s/1e4),e},this.SetMetaData=function(t){this.CheckInactive(),this.FMetaData=t},this.RemoveCalcFields=function(t){for(var e=0,i=0,s=this.FFieldList.GetCount()-1;i<=s;i++)e=i,this.FFieldList.GetField(e).FFieldKind in rtl.createSet(1,3,2)&&this.FFieldMapper.RemoveField(this.FFieldList.GetField(e).FFieldName,this.FFieldList.GetField(e).GetIndex(),t)},this.ActivateIndex=function(e){var i=null;null===(i=""!==this.FActiveIndex?rtl.as(this.FIndexes.Find$1(this.FActiveIndex),t.TJSONIndexDef):null)?this.FCurrentIndex=this.FDefaultIndex:(null===i.FIndex&&e&&i.BuildIndex(this),this.FCurrentIndex=i.FIndex),this.GetActive()&&this.Resync(rtl.createSet(1))},this.FieldTypeToExpressionType=function(t){var e=0;return 11===t||12===t||1===t?e=4:2===t||9===t||3===t?e=1:4===t?e=0:5===t?e=2:6===t||7===t||8===t?e=3:pas.DB.DatabaseErrorFmt$1("Fields of type %s are not supported in filter expressions.",pas.System.VarRecs(18,pas.DB.Fieldtypenames[t]),this),e},this.GetFilterIsNull=function(t){var e=pas.fpexprpars.TFPExpressionResult.$new();return e.ResultType=0,e.resValue=this.FieldByName(""+t[0].resValue).GetIsNull(),e},this.FilterExpressionClass=function(){return pas.fpexprpars.TFPExpressionParser},this.CreateFilterExpression=function(){var t=null,e=0;t=this.FilterExpressionClass().$create("Create$1",[this]);for(var i=0,s=this.FFieldList.GetCount()-1;i<=s;i++)e=i,t.FIdentifiers.AddVariable(this.FFieldList.GetField(e).FFieldName,this.FieldTypeToExpressionType(this.FFieldList.GetField(e).FDataType),rtl.createCallback(this,"GetFilterField"));return t.FIdentifiers.AddFunction("IsNull","B","S",rtl.createCallback(this,"GetFilterIsNull")),t.SetExpression(this.FFilterText),t},this.DoFilterRecord=function(){var t,e=!1;e=!0,t=this.SetTempState(6);try{if(null!=this.FOnFilterRecord&&(this.FOnFilterRecord(this,{get:function(){return e},set:function(t){e=t}}),!e))return e;if(!this.FFiltered||""===this.FFilterText)return e;null===this.FFilterExpression&&(this.FFilterExpression=this.CreateFilterExpression()),e=this.FFilterExpression.GetAsBoolean()}finally{this.RestoreState(t)}return e},this.CreateIndexDefs=function(){return t.TJSONIndexDefs.$create("create$3",[this,this,t.TJSONIndexDef])},this.RecordComparerClass=function(){return t.TRecordComparer},this.LocateRecordIndex=function(t,e,i){var s=0,o=null,n=0,r=0;s=-1,o=this.RecordComparerClass().$create("Create$1",[this,t,e,rtl.refSet(i)]);try{r=2 in i?this.FCurrent:0,n=this.FCurrentIndex.GetRecordIndex(r);for(;-1===s&&-1!==n;)0===o.Compare(n)&&(s=n),r+=1,n=this.FCurrentIndex.GetRecordIndex(r)}finally{o=rtl.freeLoc(o)}return s},this.AllocRecordBuffer=function(){var t=pas.DB.TDataRecord.$new();return t.data=new Object,t.bookmark=null,t.state=0,t},this.FreeRecordBuffer=function(t){t.data=null,t.bookmark=null,t.state=0},this.InternalInitRecord=function(t){t.data=this.FFieldMapper.CreateRow(),t.bookmark=null,t.state=0},this.GetRecord=function(t,e,i){var s=0,o=0,n=!1;s=0;do{n=!0;var r=e;1===r?this.FCurrent<this.FCurrentIndex.GetCount()-1?this.FCurrent+=1:s=2:2===r?this.FCurrent>0?this.FCurrent-=1:s=1:0===r&&(this.FCurrent<0||this.FCurrent>=this.FCurrentIndex.GetCount())&&(s=2),0===s&&(o=this.FCurrentIndex.GetRecordIndex(this.FCurrent),t.data=this.FRows[o],t.bookmarkFlag=0,t.bookmark=o,this.GetCalcFields(t),this.FFiltered&&(this.FFilterRow=t.data,(n=this.DoFilterRecord())||0!==e||(n=!0,s=2)))}while(!n);return s},this.AddToRows=function(t){null===this.FRows?this.FRows=t:(this.FRows=this.FRows.concat(t),this.AppendToIndexes())},this.InternalClose=function(){this.BindFields(!1),this.FDefaultFields&&this.DestroyFields(),this.FreeData()},this.InternalDelete=function(){var t,e=0,i=null;if(-1!==(t=this.FCurrentIndex.Delete(this.FCurrent))){for(var s=0,o=this.FIndexes.GetCount()-1;s<=o;s++)e=s,(i=this.FIndexes.GetD(e).FIndex)!==this.FCurrentIndex&&i.DeleteByRowIndex(t);null==this.FDeletedRows?this.FDeletedRows=new Array(this.FRows[t]):this.FDeletedRows.push(this.FRows[t]),this.FRows[t]=void 0}},this.InternalFirst=function(){this.FCurrent=-1},this.InternalLast=function(){this.FCurrent=this.FCurrentIndex.GetCount()},this.InternalOpen=function(){pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FFieldMapper},set:function(t){this.p.FFieldMapper=t}}),this.FFieldMapper=this.CreateFieldMapper(),null===this.FRows&&(this.FRows=new Array,this.FOwnsData=!0),this.CreateIndexes(),this.InternalInitFieldDefs(),this.FDefaultFields&&this.CreateFields(),this.BindFields(!0),this.InitDateTimeFields(),""!==this.FActiveIndex&&this.ActivateIndex(!0),this.FCurrent=-1},this.InternalPost=function(){var t=0,e=0,i=0,s=0,o=pas.DB.TBookmark.$new();if(i=-1,this.GetBookmarkData(pas.DB.TDataRecord.$clone(this.ActiveBuffer()),o),3===this.FState)if(s=this.FRows.push(this.FEditRow)-1,2===this.GetBookmarkFlag(pas.DB.TDataRecord.$clone(this.ActiveBuffer()))){this.FDefaultIndex.Append(s);for(var n=0,r=this.FIndexes.GetCount()-1;n<=r;n++)t=n,null!=this.FIndexes.GetD(t).FIndex&&(e=this.FIndexes.GetD(t).FIndex.Append(s),this.FIndexes.GetD(t).FIndex===this.FCurrentIndex&&(i=e))}else{this.FCurrent=this.FDefaultIndex.Insert(this.FCurrent,s);for(var a=0,l=this.FIndexes.GetCount()-1;a<=l;a++)t=a,null!=this.FIndexes.GetD(t).FIndex&&(e=this.FIndexes.GetD(t).FIndex.Append(s),this.FIndexes.GetD(t).FIndex===this.FCurrentIndex&&(i=e))}else{-1===this.FEditIdx&&pas.DB.DatabaseErrorFmt("Failed to retrieve record index for record %d",pas.System.VarRecs(0,this.FCurrent)),s=this.FEditIdx,this.FRows[s]=this.FEditRow,this.FDefaultIndex.Update(s);for(var h=0,F=this.FIndexes.GetCount()-1;h<=F;h++)t=h,e=this.FCurrentIndex.Update(s),null!=this.FIndexes.GetD(t).FIndex&&this.FIndexes.GetD(t).FIndex===this.FCurrentIndex&&(i=e)}-1!==i&&(this.FCurrent=i),this.FEditIdx=-1,this.FEditRow=null},this.InternalInsert=function(){var t=0,e=null;this.FEditRow=this.ActiveBuffer().data;for(var i=0,s=this.FFieldDefs.GetCount()-1;i<=s;i++)t=i,e=this.FFieldDefs.GetItem$1(t),this.FFieldMapper.SetJSONDataForField(e.FName,e.GetIndex(),this.FEditRow,null)},this.InternalEdit=function(){this.FEditIdx=this.FCurrentIndex.GetRecordIndex(this.FCurrent),pas.JS.isUndefined(this.FRows[this.FEditIdx])?this.FEditRow=this.FFieldMapper.CreateRow():this.FEditRow=this.FFieldMapper.CopyRow(this.FRows[this.FEditIdx])},this.InternalCancel=function(){this.FEditIdx=-1,this.FEditRow=null},this.InternalInitFieldDefs=function(){if(null!=this.FMetaData&&this.MetaDataToFieldDefs(),0===this.FFieldDefs.GetCount())throw t.EJSONDataset.$create("Create$1",["No fields found"])},this.InternalSetToRecord=function(t){this.FCurrent=this.FCurrentIndex.FindRecord(rtl.trunc(t.bookmark))},this.GetFieldClass=function(e){var i=null;if(this.FUseDateTimeFormatFields&&e in rtl.createSet(6,8,7)){var s=e;6===s?i=t.TJSONDateField:8===s?i=t.TJSONDateTimeField:7===s&&(i=t.TJSONTimeField)}else i=pas.DB.TDataSet.GetFieldClass.call(this,e);return i},this.GetApplyUpdateData=function(t){var e;return e=this.FFieldMapper.CopyRow(t.data),this.RemoveCalcFields(e),e},this.IsCursorOpen=function(){return null!=this.FDefaultIndex},this.GetBookmarkData=function(t,e){e.Data=t.bookmark},this.GetBookmarkFlag=function(t){return t.bookmarkFlag},this.InternalGotoBookmark=function(t){rtl.isNumber(t.Data)&&(this.FCurrent=this.FCurrentIndex.FindRecord(rtl.trunc(t.Data)))},this.SetBookmarkFlag=function(t,e){t.bookmarkFlag=e},this.SetBookmarkData=function(t,e){t.bookmark=e.Data},this.SetRecNo=function(e){if(this.CheckBrowseMode(),this.DoBeforeScroll(),e<1||e>this.FCurrentIndex.GetCount())throw t.EJSONDataset.$create("CreateFmt",["%s: SetRecNo: index %d out of range",pas.System.VarRecs(18,this.FName,0,e)]);this.FCurrent=e-1,this.Resync({}),this.DoAfterScroll()},this.GetRecNo=function(){var t;return t=rtl.trunc(this.ActiveBuffer().bookmark),this.FCurrentIndex.FindRecord(t)+1},this.FreeData=function(){var t=0;this.FOwnsData&&(this.FRows=null,this.FMetaData=null);for(var e=0,i=this.FIndexes.GetCount()-1;e<=i;e++)t=e,this.FIndexes.GetD(t).ClearIndex();this.FCurrentIndex=null,pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FDefaultIndex},set:function(t){this.p.FDefaultIndex=t}}),pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FFieldMapper},set:function(t){this.p.FFieldMapper=t}}),this.FCurrentIndex=null,this.FDeletedRows=null},this.AppendToIndexes=function(){this.FDefaultIndex.AppendToIndex(),null!=this.FCurrentIndex&&this.FCurrentIndex!==this.FDefaultIndex&&this.FCurrentIndex.AppendToIndex()},this.CreateIndexes=function(){this.FDefaultIndex=t.TDefaultJSONIndex.$create("Create$1",[this,this.FRows]),this.AppendToIndexes(),null===this.FCurrentIndex&&(this.FCurrentIndex=this.FDefaultIndex)},this.InitDateTimeFields=function(){},this.ConvertDateTimeField=function(e,i){var s="";s="";var o=i.FDataType;return 6===o?t.TJSONDateField.isPrototypeOf(i)&&(s=rtl.as(i,t.TJSONDateField).FDateFormat):7===o?t.TJSONTimeField.isPrototypeOf(i)&&(s=rtl.as(i,t.TJSONTimeField).FTimeFormat):8===o&&t.TJSONDateTimeField.isPrototypeOf(i)&&(s=rtl.as(i,t.TJSONDateTimeField).FDateTimeFormat),""===s?this.$class.DefaultConvertToDateTime(i,e,!0):pas.DateUtils.ScanDateTime(s,e,1)},this.FormatDateTimeField=function(e,i){var s="";s="";var o=i.FDataType;return 6===o?t.TJSONDateField.isPrototypeOf(i)&&(s=i.FDateFormat):7===o?t.TJSONTimeField.isPrototypeOf(i)&&(s=i.FTimeFormat):8===o&&t.TJSONDateTimeField.isPrototypeOf(i)&&(s=i.FDateTimeFormat),""===s?pas.DateUtils.DateTimeToRFC3339(e):pas.SysUtils.FormatDateTime(s,e)},this.CreateFieldMapper=function(){return 1===this.FRowType?t.TJSONArrayFieldMapper.$create("Create"):t.TJSONObjectFieldMapper.$create("Create")},this.Create$1=function(t){return pas.DB.TDataSet.Create$1.apply(this,arguments),this.FOwnsData=!0,this.FUseDateTimeFormatFields=!1,this.FEditIdx=-1,this.FIndexes=this.CreateIndexDefs(),this},this.Destroy=function(){this.Close(),pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FFilterExpression},set:function(t){this.p.FFilterExpression=t}}),pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FIndexes},set:function(t){this.p.FIndexes=t}}),this.FEditIdx=-1,pas.DB.TDataSet.Destroy.call(this)},this.BlobDataToBytes=function(t){var e=[];e=[];var i=this.FBlobFormat;return 0===i?e=this.$class.DefaultBlobDataToBytes(t):1===i?e=pas.SysUtils.BytesOf(atob(""+t)):2===i?e=t:3===i&&null!=this.FOnDecodeBlobValue&&this.FOnDecodeBlobValue(this,t,{get:function(){return e},set:function(t){e=t}}),e},this.BytesToBlobData=function(t){var e=void 0;e="";var i=this.FBlobFormat;return 0===i?e=this.$class.DefaultBytesToBlobData(rtl.arrayRef(t)):1===i?e=btoa(pas.SysUtils.StringOf(t)):2===i?e=t:3===i&&null!=this.FOnEncodeBlobValue&&this.FOnEncodeBlobValue(this,rtl.arrayRef(t),{get:function(){return e},set:function(t){e=t}}),e},this.ConvertDateTimeToNative=function(t,e){return isNaN(e)?null:this.FormatDateTimeField(e,t)},this.Lookup=function(t,e,i){var s=void 0,o=0,n=0,r=null,a=[];s=null,r=pas.Classes.TFPList.$create("Create");try{if(this.GetFieldList$1(r,i),s=pas.DB.TDataSet.Lookup.call(this,t,e,i),-1!==(o=this.LocateRecordIndex(t,e,{}))){a=rtl.arraySetLength(a,void 0,r.FCount);for(var l=0,h=r.FCount-1;l<=h;l++)a[n=l]=this.FFieldMapper.GetJSONDataForField$1(rtl.getObject(r.Get(n)),this.FRows[o]);s=1===r.FCount?a[n]:a}}finally{r=rtl.freeLoc(r)}return s},this.GetFieldData$1=function(t,e){var i=void 0,s=void 0;if(this.FState in rtl.createSet(5,11))s=this.FCalcBuffer.data;else if(6===this.FState)s=this.FFilterRow;else if(this.FEditIdx==e.bookmark)s=8===this.FState?e.data:this.FEditRow;else{if(8===this.FState)return null;s=e.data}return i=this.FFieldMapper.GetJSONDataForField$1(t,s),pas.JS.isUndefined(i)&&(i=null),i},this.SetFieldData$1=function(t,e,i){var s=void 0;s=this.FState in rtl.createSet(5,11)?this.FCalcBuffer.data:this.FEditRow,this.FFieldMapper.SetJSONDataForField$1(t,s,i),this.FState in rtl.createSet(5,11,6,7)||this.DataEvent(0,t),this.SetModified(!0)},this.BookmarkValid=function(t){return rtl.isNumber(t.Data)},this.CompareBookmarks=function(t,e){return rtl.isNumber(t.Data)&&rtl.isNumber(e.Data)?rtl.trunc(e.Data)-rtl.trunc(t.Data):rtl.isNumber(t.Data)?-1:rtl.isNumber(e.Data)?1:0},rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TJSONObjectFieldMapper",this.TJSONFieldMapper,(function(){this.RemoveField=function(t,e,i){pas.JS.JSDelete(i,t)},this.SetJSONDataForField=function(t,e,i,s){i[t]=s},this.GetJSONDataForField=function(t,e,i){return null!=i?i[t]:void 0},this.CreateRow=function(){return new Object}})),rtl.createClass(this,"TJSONArrayFieldMapper",this.TJSONFieldMapper,(function(){this.RemoveField=function(t,e,i){i.splice(e,1)},this.SetJSONDataForField=function(t,e,i,s){i[e]=s},this.GetJSONDataForField=function(t,e,i){return i[e]},this.CreateRow=function(){return new Array}})),rtl.createClass(this,"EJSONDataset",pas.DB.EDatabaseError,(function(){}))}),["DateUtils"]),rtl.module("WEBLib.Storage",["System","Web","Classes"],(function(){"use strict";var t=this;this.$rtti.$MethodVar("TStorageChangeEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AKey",rtl.string],["AOldValue",rtl.string],["ANewValue",rtl.string],["AURL",rtl.string]]),methodkind:0}),rtl.createClass(this,"TLocalStorage",pas.Classes.TComponent,(function(){this.$init=function(){pas.Classes.TComponent.$init.call(this),this.FChangePtr=null,this.FOnChange=null},this.$final=function(){this.FOnChange=void 0,pas.Classes.TComponent.$final.call(this)},this.StorageChanged=function(t){var e;e=t.storageArea+" ",null!=this.FOnChange&&pas.System.Pos("OBJECT",pas.SysUtils.UpperCase(e))>0&&this.FOnChange(this,t.key,t.oldValue,t.newValue,t.url)},this.Create$1=function(t){return this.FChangePtr=rtl.createCallback(this,"StorageChanged"),pas.Classes.TComponent.Create$1.apply(this,arguments),window.addEventListener("storage",this.FChangePtr),this},this.Destroy=function(){window.removeEventListener("storage",this.FChangePtr),pas.Classes.TComponent.Destroy.call(this)},this.SetValue=function(t,e){window.localStorage.setItem(t,e)},this.GetValue=function(t){var e;return e=window.localStorage.getItem(t),pas.System.Assigned(e)?e:""},rtl.addIntf(this,pas.System.IUnknown),this.$rtti.addProperty("OnChange",0,t.$rtti.TStorageChangeEvent,"FOnChange","FOnChange")})),rtl.createClass(this,"TWebLocalStorage",this.TLocalStorage,(function(){rtl.addIntf(this,pas.System.IUnknown)}))}),["SysUtils"]),rtl.module("WEBLib.REST",["System","Classes","Web","JS","SysUtils","WEBLib.Controls","WEBLib.JSON"],(function(){"use strict";var t=this;this.THTTPCommand={0:"httpGET",httpGET:0,1:"httpPOST",httpPOST:1,2:"httpPUT",httpPUT:2,3:"httpDELETE",httpDELETE:3,4:"httpHEAD",httpHEAD:4,5:"httpPATCH",httpPATCH:5,6:"httpCUSTOM",httpCUSTOM:6},this.$rtti.$Enum("THTTPCommand",{minvalue:0,maxvalue:6,ordtype:1,enumtype:this.THTTPCommand}),this.THTTPRequestResponseType={0:"rtDefault",rtDefault:0,1:"rtText",rtText:1,2:"rtBlob",rtBlob:2,3:"rtJSON",rtJSON:3,4:"rtDocument",rtDocument:4,5:"rtArrayBuffer",rtArrayBuffer:5},this.$rtti.$Enum("THTTPRequestResponseType",{minvalue:0,maxvalue:5,ordtype:1,enumtype:this.THTTPRequestResponseType}),this.$rtti.$MethodVar("THttpResponse",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AResponse",rtl.string]]),methodkind:0}),rtl.createClass(this,"TPersistTokens",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FKey="",this.FEnabled=!1},this.Create$1=function(){return this.FEnabled=!1,this.FKey="",this},this.Assign=function(e){t.TPersistTokens.isPrototypeOf(e)&&(this.FKey=rtl.as(e,t.TPersistTokens).FKey,this.FEnabled=rtl.as(e,t.TPersistTokens).FEnabled)};var e=this.$rtti;e.addProperty("Key",0,rtl.string,"FKey","FKey"),e.addProperty("Enabled",0,rtl.boolean,"FEnabled","FEnabled",{Default:!1})})),rtl.createClass(this,"TRESTApp",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FKey="",this.FCallbackURL="",this.FSecret=""},this.Assign=function(e){t.TRESTApp.isPrototypeOf(e)&&(this.FKey=rtl.as(e,t.TRESTApp).FKey,this.FCallbackURL=rtl.as(e,t.TRESTApp).FCallbackURL,this.FSecret=rtl.as(e,t.TRESTApp).FSecret)};var e=this.$rtti;e.addProperty("Key",0,rtl.string,"FKey","FKey"),e.addProperty("CallbackURL",0,rtl.string,"FCallbackURL","FCallbackURL"),e.addProperty("Secret",0,rtl.string,"FSecret","FSecret")})),this.TAuthLocale={0:"lcDefault",lcDefault:0,1:"lcEnglish",lcEnglish:1,2:"lcDutch",lcDutch:2,3:"lcGerman",lcGerman:3,4:"lcFrench",lcFrench:4,5:"lcSpanish",lcSpanish:5,6:"lcItalian",lcItalian:6,7:"lcPortuguese",lcPortuguese:7,8:"lcGreek",lcGreek:8,9:"lcDanish",lcDanish:9,10:"lcRussian",lcRussian:10,11:"lcRomanian",lcRomanian:11,12:"lcSwedish",lcSwedish:12,13:"lcFinnish",lcFinnish:13,14:"lcTurkish",lcTurkish:14,15:"lcJapanese",lcJapanese:15},rtl.createClass(this,"TRESTClient",pas.Classes.TComponent,(function(){this.$init=function(){pas.Classes.TComponent.$init.call(this),this.FOnAccessToken=null,this.FOnResponse=null,this.FPersistTokens=null,this.FApp=null,this.FScopes=null,this.FLocale=0,this.FOnRequestResponse=null,this.FOnError=null,this.FResponseType=0},this.$final=function(){this.FOnAccessToken=void 0,this.FOnResponse=void 0,this.FPersistTokens=void 0,this.FApp=void 0,this.FScopes=void 0,this.FOnRequestResponse=void 0,this.FOnError=void 0,pas.Classes.TComponent.$final.call(this)},this.SetPersistTokens=function(t){this.FPersistTokens.Assign(t)},this.SetApp=function(t){this.FApp.Assign(t)},this.SetScopes=function(t){this.FScopes.Assign(t)},this.InstallCallback=function(){var t=document.createElement("script");t.innerHTML=' function processAuthData(access_token) {var event = new CustomEvent("oauthcallback", {\r            detail: {\r                 message: access_token\r            },\r  bubbles: true,\r  cancelable: true});\r  document.dispatchEvent(event);}',document.head.appendChild(t);var e=document.createElement("script");return e.async=!0,e.defer=!0,e.type="text/javascript",document.body.appendChild(e),!0,!0},this.Create$1=function(e){return pas.Classes.TComponent.Create$1.apply(this,arguments),this.FPersistTokens=t.TPersistTokens.$create("Create$1"),this.FApp=t.TRESTApp.$create("Create"),this.FScopes=pas.Classes.TStringList.$create("Create$1"),this.FLocale=0,this.FResponseType=0,this},this.Destroy=function(){rtl.free(this,"FApp"),rtl.free(this,"FScopes"),rtl.free(this,"FPersistTokens"),pas.Classes.TComponent.Destroy.call(this)},rtl.addIntf(this,pas.System.IUnknown);var e=this.$rtti;e.addProperty("App",2,t.$rtti.TRESTApp,"FApp","SetApp"),e.addProperty("PersistTokens",2,t.$rtti.TPersistTokens,"FPersistTokens","SetPersistTokens"),e.addProperty("ResponseType",0,t.$rtti.THTTPRequestResponseType,"FResponseType","FResponseType",{Default:t.THTTPRequestResponseType.rtDefault}),e.addProperty("Scopes",2,pas.Classes.$rtti.TStrings,"FScopes","SetScopes"),e.addProperty("OnAccessToken",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnAccessToken","FOnAccessToken"),e.addProperty("OnRequestResponse",0,pas["WEBLib.Controls"].$rtti.THTTPRequestResponseEvent,"FOnRequestResponse","FOnRequestResponse"),e.addProperty("OnResponse",0,t.$rtti.THttpResponse,"FOnResponse","FOnResponse"),e.addProperty("OnError",0,pas["WEBLib.Controls"].$rtti.THTTPErrorEvent,"FOnError","FOnError")})),this.HTTPCommand=function(t,e){var i="";return 0===t?i="GET":1===t?i="POST":2===t?i="PUT":3===t?i="DELETE":4===t?i="HEAD":5===t?i="PATCH":6===t&&(i=e),i},t.$init=function(){t.TRESTClient.InstallCallback()}}),["WEBLib.Storage"]),rtl.module("WEBLib.CDS",["System","Classes","DB","JSONDataset","Web","JS","WEBLib.Controls","WEBLib.REST"],(function(){"use strict";var t=this,e=t.$impl;this.$rtti.$MethodVar("TConnectErrorEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ErrorCode",rtl.longint]]),methodkind:0}),this.TURLType={0:"utGet",utGet:0,1:"utPost",utPost:1,2:"utPut",utPut:2,3:"utDelete",utDelete:3},this.$rtti.$Enum("TURLType",{minvalue:0,maxvalue:3,ordtype:1,enumtype:this.TURLType}),this.$rtti.$MethodVar("TClientConnectionGetURLEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["Dataset",pas.DB.$rtti.TDataSet],["urlType",this.$rtti.TURLType],["URL",rtl.string,1]]),methodkind:0}),this.$rtti.$MethodVar("TGetUpdatePayloadEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["Dataset",pas.DB.$rtti.TDataSet],["urlType",this.$rtti.TURLType],["Data",rtl.jsvalue],["aPayLoad",rtl.string,4]]),methodkind:0}),this.$rtti.$MethodVar("TGetDataPayloadEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["Dataset",pas.DB.$rtti.TDataSet],["urlType",this.$rtti.TURLType],["aPayLoad",rtl.jsvalue,1]]),methodkind:0}),this.$rtti.$MethodVar("TProcessMetaDataEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["Dataset",pas.DB.$rtti.TDataSet],["FieldDefs",pas.DB.$rtti.TFieldDefs],["aMetaData",pas.JS.$rtti.TJSObject]]),methodkind:0}),this.$rtti.$MethodVar("TDataReceivedEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ARequest",pas["WEBLib.Controls"].$rtti.TJSXMLHttpRequestRecord],["AResponse",rtl.string,1]]),methodkind:0}),rtl.createClass(this,"TClientConnection",pas.Classes.TComponent,(function(){this.$init=function(){pas.Classes.TComponent.$init.call(this),this.FDataProxy=null,this.FActive=!1,this.FURI="",this.FDS=null,this.FDataNode="",this.FAutoOpen=!1,this.FUpdateCount=0,this.FOnConnectError=null,this.FBeforeConnect=null,this.FAfterConnect=null,this.FHeaders=null,this.FPassword="",this.FUser="",this.FOnGetURL=null,this.FPageParam="",this.FOnGetUpdatePayLoad=null,this.FAppendKeyToURL=!1,this.FOnGetDataPayLoad=null,this.FMetaDataNode="",this.FOnProcessMetaData=null,this.FOnDataReceived=null,this.FXHR=null,this.FCommand=0,this.FCustomCommand="",this.FPostData=""},this.$final=function(){this.FDataProxy=void 0,this.FDS=void 0,this.FOnConnectError=void 0,this.FBeforeConnect=void 0,this.FAfterConnect=void 0,this.FHeaders=void 0,this.FOnGetURL=void 0,this.FOnGetUpdatePayLoad=void 0,this.FOnGetDataPayLoad=void 0,this.FOnProcessMetaData=void 0,this.FOnDataReceived=void 0,this.FXHR=void 0,pas.Classes.TComponent.$final.call(this)},this.SetHeaders=function(t){this.FHeaders.Assign(t)},this.GetPageURL=function(t){var e="";return e=this.GetReadBaseURL(t),""!==this.FPageParam&&(0!==pas.System.Pos("?",e)?e+="&":e+="?",e=e+this.FPageParam+"="+pas.SysUtils.IntToStr(t.FRequestID-1)),e},this.GetDataProxy=function(){return null===this.FDataProxy&&(this.FDataProxy=this.DoGetDataProxy()),this.FDataProxy},this.SetDataNode=function(t){this.FDataNode!==t&&0===this.FUpdateCount&&this.SetActive(!1),this.FDataNode=t},this.SetURI=function(t){this.FURI!==t&&0===this.FUpdateCount&&this.SetActive(!1),this.FURI=t},this.onError=function(t){return null!=this.FOnConnectError&&this.FOnConnectError(this,this.FXHR.status),!0,!0},this.onAbort=function(t){return null!=this.FOnConnectError&&this.FOnConnectError(this,this.FXHR.status),!0,!0},this.onLoad=function(t){var e=pas["WEBLib.Controls"].TJSXMLHttpRequestRecord.$new(),i="";return null!=this.FOnDataReceived&&(e.req=this.FXHR,i=this.FXHR.responseText,this.FOnDataReceived(this,pas["WEBLib.Controls"].TJSXMLHttpRequestRecord.$clone(e),{get:function(){return i},set:function(t){i=t}})),!0,!0},this.SetActive=function(t){if(this.FActive!==t){if(this.FActive=t,this.FUpdateCount>0)return;if(0 in this.FComponentState)return;t?""!==this.FURI&&this.DoConnect():this.DoDisconnect()}},this.ProcessMetadata=function(t,e,i){null!=this.FOnProcessMetaData&&this.FOnProcessMetaData(this,t,e,i)},this.GetReadBaseURL=function(t){var e="";return e=this.FURI,null!=this.FOnGetURL&&this.FOnGetURL(this,t.FDataset,0,{get:function(){return e},set:function(t){e=t}}),e},this.RegisterDataSet=function(t){this.FDS=t},this.DoRequest=function(){var t;this.FXHR=new XMLHttpRequest,this.FXHR.addEventListener("load",rtl.createSafeCallback(this,"onLoad")),this.FXHR.addEventListener("abort",rtl.createSafeCallback(this,"onAbort")),this.FXHR.addEventListener("error",rtl.createSafeCallback(this,"onError")),t=pas["WEBLib.REST"].HTTPCommand(this.FCommand,this.FCustomCommand),this.FXHR.open(t,this.FURI),this.SetupRequest(this.FXHR),this.FXHR.setRequestHeader("content-type","application/json"),""!==this.FPostData?this.FXHR.send(this.FPostData):this.FXHR.send()},this.DoConnect=function(){null!=this.FDS?(this.DoBeforeConnect(),this.FAutoOpen?(this.FDS.SetActive(!1),this.FDS.Load({},null)):this.DoRequest()):this.DoRequest()},this.DoDisconnect=function(){null!=this.FDS&&this.FAutoOpen&&(this.FDS.SetActive(!1),this.FDS.FFieldDefs.Clear())},this.DoBeforeConnect=function(){null!=this.FBeforeConnect&&this.FBeforeConnect(this)},this.DoAfterConnect=function(){null!=this.FAfterConnect&&this.FAfterConnect(this)},this.DoError=function(t){throw null!=this.FOnConnectError&&this.FOnConnectError(this,t),pas.SysUtils.Exception.$create("Create$1",["Error connecting to URI "+this.FURI])},this.DoDataReceived=function(t,e){var i=pas["WEBLib.Controls"].TJSXMLHttpRequestRecord.$new();null!=this.FOnDataReceived&&(i.req=t,this.FOnDataReceived(this,pas["WEBLib.Controls"].TJSXMLHttpRequestRecord.$clone(i),e))},this.SetupRequest=function(t){var e=0,i="",s="";""!==this.FUser&&t.setRequestHeader("X-Requested-With","XMLHttpRequest");for(var o=0,n=this.FHeaders.GetCount()-1;o<=n;o++)e=o,this.FHeaders.GetNameValue(e,{get:function(){return i},set:function(t){i=t}},{get:function(){return s},set:function(t){s=t}}),t.setRequestHeader(i,s);""!==this.FUser&&t.setRequestHeader("Authorization","Basic "+window.btoa(this.FUser+":"+this.FPassword))},this.GetDataNode=function(){var t="";return""===(t=this.FDataNode)&&(t="data"),t},this.GetMetaDataNode=function(){var t="";return""===(t=this.FMetaDataNode)&&(t="metaData"),t},this.DoGetDataProxy=function(){return t.TWebClientDataProxy.$create("Create$1",[this])},this.Create$1=function(t){return pas.Classes.TComponent.Create$1.apply(this,arguments),this.FActive=!1,this.FDS=null,this.FAutoOpen=!0,this.FCommand=0,this.FHeaders=pas.Classes.TStringList.$create("Create$1"),this.FAppendKeyToURL=!0,this},this.Destroy=function(){rtl.free(this,"FHeaders"),pas.Classes.TComponent.Destroy.call(this)},this.BeginUpdate=function(){pas.Classes.TComponent.BeginUpdate.call(this),this.FUpdateCount+=1},this.EndUpdate=function(){pas.Classes.TComponent.EndUpdate.call(this),this.FUpdateCount>0&&(this.FUpdateCount-=1)},this.AfterLoadDFMValues=function(){pas.Classes.TComponent.AfterLoadDFMValues.call(this),this.FActive&&""!==this.FURI&&this.DoConnect()},rtl.addIntf(this,pas.System.IUnknown);var e=this.$rtti;e.addProperty("Active",2,rtl.boolean,"FActive","SetActive"),e.addProperty("AppendKeyToURL",0,rtl.boolean,"FAppendKeyToURL","FAppendKeyToURL",{Default:!0}),e.addProperty("AutoOpenDataSet",0,rtl.boolean,"FAutoOpen","FAutoOpen",{Default:!0}),e.addProperty("Command",0,pas["WEBLib.REST"].$rtti.THTTPCommand,"FCommand","FCommand",{Default:pas["WEBLib.REST"].THTTPCommand.httpGET}),e.addProperty("CustomCommand",0,rtl.string,"FCustomCommand","FCustomCommand"),e.addProperty("DataNode",2,rtl.string,"FDataNode","SetDataNode"),e.addProperty("MetaDataNode",0,rtl.string,"FMetaDataNode","FMetaDataNode"),e.addProperty("PageParam",0,rtl.string,"FPageParam","FPageParam"),e.addProperty("PostData",0,rtl.string,"FPostData","FPostData"),e.addProperty("Headers",2,pas.Classes.$rtti.TStringList,"FHeaders","SetHeaders"),e.addProperty("Password",0,rtl.string,"FPassword","FPassword"),e.addProperty("User",0,rtl.string,"FUser","FUser"),e.addProperty("URI",2,rtl.string,"FURI","SetURI"),e.addProperty("AfterConnect",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FAfterConnect","FAfterConnect"),e.addProperty("BeforeConnect",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FBeforeConnect","FBeforeConnect"),e.addProperty("OnConnectError",0,t.$rtti.TConnectErrorEvent,"FOnConnectError","FOnConnectError"),e.addProperty("OnDataReceived",0,t.$rtti.TDataReceivedEvent,"FOnDataReceived","FOnDataReceived"),e.addProperty("OnGetURL",0,t.$rtti.TClientConnectionGetURLEvent,"FOnGetURL","FOnGetURL"),e.addProperty("OnGetUpdatePayLoad",0,t.$rtti.TGetUpdatePayloadEvent,"FOnGetUpdatePayLoad","FOnGetUpdatePayLoad"),e.addProperty("OnGetDataPayload",0,t.$rtti.TGetDataPayloadEvent,"FOnGetDataPayLoad","FOnGetDataPayLoad"),e.addProperty("OnProcessMetaData",0,t.$rtti.TProcessMetaDataEvent,"FOnProcessMetaData","FOnProcessMetaData")})),rtl.createClass(this,"TWebClientDataProxy",pas.DB.TDataProxy,(function(){this.$init=function(){pas.DB.TDataProxy.$init.call(this),this.FConnection=null},this.$final=function(){this.FConnection=void 0,pas.DB.TDataProxy.$final.call(this)},this.GetUpdateDescriptorClass=function(){return e.TWebClientUpdateRequest},this.DoGetData=function(t){var i,s=!1,o=null,n="";return s=!1,(o=rtl.as(t,e.TWebClientDataRequest)).FXHR=new XMLHttpRequest,""===(i=this.FConnection.GetPageURL(t))?2 in o.FLoadOptions?o.FSuccess=1:(o.FSuccess=0,o.FErrorMsg="No URL to get data",o.DoAfterRequest()):(2 in o.FLoadOptions&&""===this.FConnection.FPageParam?o.FSuccess=1:(n=pas["WEBLib.REST"].HTTPCommand(this.FConnection.FCommand,this.FConnection.FCustomCommand),o.FXHR.open(n,i,!0),this.FConnection.SetupRequest(o.FXHR),o.FXHR.addEventListener("load",rtl.createSafeCallback(o,"onLoad")),o.FXHR.addEventListener("abort",rtl.createSafeCallback(o,"onAbort")),o.FXHR.addEventListener("error",rtl.createSafeCallback(o,"onError")),""!==this.FConnection.FPostData?o.FXHR.send(this.FConnection.FPostData):o.FXHR.send()),s=!0),s},this.GetDataRequest=function(t,i,s){var o=null;return(o=e.TWebClientDataRequest.$create("Create$1",[this,rtl.refSet(t),i,s])).FConnection=this.FConnection,o},this.Create$1=function(e){return pas.Classes.TComponent.Create$1.apply(this,arguments),t.TClientConnection.isPrototypeOf(e)&&(this.FConnection=e),this},rtl.addIntf(this,pas.System.IUnknown)})),this.$rtti.$MethodVar("TUpdateRecordEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ADescriptor",pas.DB.$rtti.TRecordUpdateDescriptor]]),methodkind:0}),rtl.createClass(this,"TCustomClientDataSet",pas.JSONDataset.TBaseJSONDataSet,(function(){this.$init=function(){pas.JSONDataset.TBaseJSONDataSet.$init.call(this),this.FConnection=null,this.FOnUpdateRecord=null,this.FUpdateCount=0,this.FIDField="",this.FuseServerMetadata=!1,this.FParams=null},this.$final=function(){this.FConnection=void 0,this.FOnUpdateRecord=void 0,this.FParams=void 0,pas.JSONDataset.TBaseJSONDataSet.$final.call(this)},this.SetParams=function(t){this.FParams.Assign(t)},this.GetStringFieldLength=function(t,e,i){var s=0,o=0,n=0,r=void 0;if(s=0,r=t.maxLen,isNaN(pas.JS.toNumber(r)))for(var a=0,l=this.FRows.length-1;a<=l;a++)o=a,r=this.FFieldMapper.GetJSONDataForField(e,i,this.FRows[o]),rtl.isString(r)&&(n=(""+r).length)>s&&(s=n);else(s=pas.System.Trunc(pas.JS.toNumber(r)))<=0&&pas.DB.DatabaseErrorFmt$1("Invalid maximum length specifier for field %s",pas.System.VarRecs(18,e),this);return 0===s&&(s=20),s},this.StringToFieldType=function(t){return"int"===t?2:"bigint"===t?3:"float"===t?5:"bool"===t?4:"date"===t?6:"datetime"===t?8:"time"===t?7:"blob"===t?10:1},this.DataPacketReceived=function(t){var e=!1,i=null,s=null,o=void 0,n=null,r="",a="",l="";if(e=!1,pas.JS.isNull(t.FData))return e;if(i=null,n=null,rtl.isString(t.FData)?(o=JSON.parse(""+t.FData),rtl.isArray(o)?n=o:rtl.isObject(o)&&(i=o)):rtl.isArray(t.FData)?n=t.FData:rtl.isObject(t.FData)?i=t.FData:pas.DB.DatabaseError("Cannot handle data packet"),null!=i){for(a=this.FConnection.GetDataNode(),r=this.FConnection.GetMetaDataNode();pas.System.Pos("\\",a)>0;)l=pas.System.Copy(a,1,pas.System.Pos("\\",a)-1),a=pas.System.Copy(a,pas.System.Pos("\\",a)+1,a.length),i=i[l];""===this.FIDField&&(this.FIDField="id"),this.FuseServerMetadata&&i.hasOwnProperty(r)&&rtl.isObject(i[r])&&(s=i[r],this.GetActive()||this.SetMetaData(s),s.hasOwnProperty("root")&&rtl.isString(s.root)&&(a=""+this.FMetaData.root),s.hasOwnProperty("idField")&&rtl.isString(s.idField)&&(this.FIDField=""+s.idField)),""!==a&&i.hasOwnProperty(a)&&rtl.isArray(i[a])&&(n=i[a])}return null!=n&&n.length>0&&null!=this.FFieldDefs&&0===this.FFieldDefs.GetCount()&&this.FieldDefsFromRows(n),(e=null!==n&&n.length>0)&&this.AddToRows(n),e},this.MetaDataToFieldDefs=function(){var t,e=null,i=0,s=0,o="",n=0,r=void 0;if(this.FFieldDefs.Clear(),this.FConnection.ProcessMetadata(this,this.FFieldDefs,this.FMetaData),!(this.FFieldDefs.GetCount()>0)){if(r=this.FMetaData.fields,!rtl.isArray(r))throw pas.JSONDataset.EJSONDataset.$create("Create$1",["Invalid metadata object"]);for(var a=0,l=(t=r).length-1;a<=l;a++){if(i=a,!rtl.isObject(t[i]))throw pas.JSONDataset.EJSONDataset.$create("CreateFmt",["Field definition %d in metadata is not an object",pas.System.VarRecs(0,i)]);if(r=(e=t[i]).name,!rtl.isString(r))throw pas.JSONDataset.EJSONDataset.$create("CreateFmt",["Field definition %d in has no or invalid name property",pas.System.VarRecs(0,i)]);if(o=""+r,r=e.type,pas.JS.isNull(r)||pas.JS.isUndefined(r))n=1;else{if(!rtl.isString(r))throw pas.JSONDataset.EJSONDataset.$create("CreateFmt",["Field definition %d in has invalid type property",pas.System.VarRecs(0,i)]);n=this.StringToFieldType(""+r)}s=1===n?this.GetStringFieldLength(e,o,i):0,this.FFieldDefs.Add$4(o,n,s)}}},this.SetConnection=function(t){this.FConnection=t,null!=t&&t.RegisterDataSet(this)},this.CreateFieldMapper=function(){return pas.JSONDataset.TJSONObjectFieldMapper.$create("Create")},this.InitFieldDefs=function(){var t=this;this.FFieldDefs.Clear(),this.GetChildren((function(e){pas.DB.TStringField.isPrototypeOf(e)&&t.FFieldDefs.Add$4(rtl.as(e,pas.DB.TStringField).FFieldName,1,rtl.as(e,pas.DB.TStringField).FSize),pas.DB.TBooleanField.isPrototypeOf(e)&&t.FFieldDefs.Add$4(rtl.as(e,pas.DB.TBooleanField).FFieldName,4,0),pas.DB.TAutoIncField.isPrototypeOf(e)?t.FFieldDefs.Add$4(rtl.as(e,pas.DB.TAutoIncField).FFieldName,9,0):pas.DB.TIntegerField.isPrototypeOf(e)?t.FFieldDefs.Add$4(rtl.as(e,pas.DB.TIntegerField).FFieldName,2,0):pas.DB.TLargeintField.isPrototypeOf(e)?t.FFieldDefs.Add$4(rtl.as(e,pas.DB.TLargeintField).FFieldName,3,0):pas.DB.TFloatField.isPrototypeOf(e)?t.FFieldDefs.Add$4(rtl.as(e,pas.DB.TFloatField).FFieldName,5,0):pas.DB.TNumericField.isPrototypeOf(e)&&t.FFieldDefs.Add$4(rtl.as(e,pas.DB.TNumericField).FFieldName,2,0),pas.DB.TDateField.isPrototypeOf(e)?t.FFieldDefs.Add$4(rtl.as(e,pas.DB.TDateField).FFieldName,6,0):pas.DB.TTimeField.isPrototypeOf(e)?t.FFieldDefs.Add$4(rtl.as(e,pas.DB.TTimeField).FFieldName,6,0):pas.DB.TDateTimeField.isPrototypeOf(e)&&t.FFieldDefs.Add$4(rtl.as(e,pas.DB.TDateTimeField).FFieldName,8,0),pas.DB.TMemoField.isPrototypeOf(e)?t.FFieldDefs.Add$4(rtl.as(e,pas.DB.TMemoField).FFieldName,11,0):pas.DB.TBlobField.isPrototypeOf(e)&&t.FFieldDefs.Add$4(rtl.as(e,pas.DB.TBlobField).FFieldName,10,0)}),t)},this.InternalInitFieldDefs=function(){0===this.FFieldDefs.GetCount()&&null!=this.FRows&&this.FRows.length>0&&this.FieldDefsFromRows(this.FRows),pas.JSONDataset.TBaseJSONDataSet.InternalInitFieldDefs.call(this)},this.FieldDefsFromRows=function(t){var e=null,i=void 0,s=[],o=0;if(0===this.FFieldDefs.GetCount()&&null!=t&&t.length>0){e=t[0],s=Object.getOwnPropertyNames(e);for(var n=0,r=rtl.length(s)-1;n<=r;n++)i=e[s[o=n]],rtl.isString(i)&&this.FFieldDefs.Add$4(s[o],1,255),rtl.isNumber(i)&&this.FFieldDefs.Add$5(s[o],5),pas.JS.isBoolean(i)&&this.FFieldDefs.Add$5(s[o],4),pas.JS.isDate(i)&&this.FFieldDefs.Add$5(s[o],6),pas.JS.isNull(i)&&this.FFieldDefs.Add$4(s[o],1,255)}},this.DoAfterOpen=function(){pas.DB.TDataSet.DoAfterOpen.call(this),null!=this.FConnection&&this.FConnection.FAutoOpen&&this.FConnection.DoAfterConnect()},this.DoGetDataProxy=function(){return null!=this.FConnection?this.FConnection.GetDataProxy():null},this.SetActive=function(t){0 in this.FComponentState||0===this.FFieldList.GetCount()&&null!=this.FFieldDefs&&0===this.FFieldDefs.GetCount()||pas.DB.TDataSet.SetActive.apply(this,arguments)},this.Create$1=function(t){return pas.JSONDataset.TBaseJSONDataSet.Create$1.apply(this,arguments),this.FParams=pas.DB.TParams.$create("Create$1",[pas.DB.TParam]),this},this.Destroy=function(){pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FParams},set:function(t){this.p.FParams=t}}),pas.JSONDataset.TBaseJSONDataSet.Destroy.call(this)},this.BeginUpdate=function(){pas.Classes.TComponent.BeginUpdate.call(this),this.FUpdateCount+=1},this.EndUpdate=function(){pas.Classes.TComponent.EndUpdate.call(this),this.FUpdateCount>0&&(this.FUpdateCount-=1)},this.AfterLoadDFMValues=function(){pas.Classes.TComponent.AfterLoadDFMValues.call(this),this.InitFieldDefs()},this.GetChildren=function(t,e){for(var i=0,s=0,o=this.FFieldList.GetCount()-1;s<=o;s++)i=s,this.FFieldList.GetField(i).FOwner!==e&&this.FFieldList.GetField(i).FDataSet!==e&&null!==e||(""===this.FFieldList.GetField(i).FName&&this.FFieldList.GetField(i).SetName(this.FName+this.FFieldList.GetField(i).FFieldName),t(this.FFieldList.GetField(i)))},rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TClientDataSet",this.TCustomClientDataSet,(function(){rtl.addIntf(this,pas.System.IUnknown);var e=this.$rtti;e.addProperty("Active",3,rtl.boolean,"GetActive","SetActive",{Default:!1}),e.addProperty("Connection",2,t.$rtti.TClientConnection,"FConnection","SetConnection"),e.addProperty("Params",2,pas.DB.$rtti.TParams,"FParams","SetParams"),e.addProperty("BeforeOpen",0,pas.DB.$rtti.TDataSetNotifyEvent,"FBeforeOpen","FBeforeOpen"),e.addProperty("AfterOpen",0,pas.DB.$rtti.TDataSetNotifyEvent,"FAfterOpen","FAfterOpen"),e.addProperty("BeforeClose",0,pas.DB.$rtti.TDataSetNotifyEvent,"FBeforeClose","FBeforeClose"),e.addProperty("AfterClose",0,pas.DB.$rtti.TDataSetNotifyEvent,"FAfterClose","FAfterClose"),e.addProperty("BeforeInsert",0,pas.DB.$rtti.TDataSetNotifyEvent,"FBeforeInsert","FBeforeInsert"),e.addProperty("AfterInsert",0,pas.DB.$rtti.TDataSetNotifyEvent,"FAfterInsert","FAfterInsert"),e.addProperty("BeforeEdit",0,pas.DB.$rtti.TDataSetNotifyEvent,"FBeforeEdit","FBeforeEdit"),e.addProperty("AfterEdit",0,pas.DB.$rtti.TDataSetNotifyEvent,"FAfterEdit","FAfterEdit"),e.addProperty("BeforePost",0,pas.DB.$rtti.TDataSetNotifyEvent,"FBeforePost","FBeforePost"),e.addProperty("AfterPost",0,pas.DB.$rtti.TDataSetNotifyEvent,"FAfterPost","FAfterPost"),e.addProperty("BeforeCancel",0,pas.DB.$rtti.TDataSetNotifyEvent,"FBeforeCancel","FBeforeCancel"),e.addProperty("AfterCancel",0,pas.DB.$rtti.TDataSetNotifyEvent,"FAfterCancel","FAfterCancel"),e.addProperty("BeforeDelete",0,pas.DB.$rtti.TDataSetNotifyEvent,"FBeforeDelete","FBeforeDelete"),e.addProperty("AfterDelete",0,pas.DB.$rtti.TDataSetNotifyEvent,"FAfterDelete","FAfterDelete"),e.addProperty("BeforeScroll",0,pas.DB.$rtti.TDataSetNotifyEvent,"FBeforeScroll","FBeforeScroll"),e.addProperty("AfterScroll",0,pas.DB.$rtti.TDataSetNotifyEvent,"FAfterScroll","FAfterScroll"),e.addProperty("OnCalcFields",0,pas.DB.$rtti.TDataSetNotifyEvent,"FOnCalcFields","FOnCalcFields"),e.addProperty("OnDeleteError",0,pas.DB.$rtti.TDataSetErrorEvent,"FOnDeleteError","FOnDeleteError"),e.addProperty("OnEditError",0,pas.DB.$rtti.TDataSetErrorEvent,"FOnEditError","FOnEditError"),e.addProperty("OnFilterRecord",2,pas.DB.$rtti.TFilterRecordEvent,"FOnFilterRecord","SetOnFilterRecord"),e.addProperty("OnNewRecord",0,pas.DB.$rtti.TDataSetNotifyEvent,"FOnNewRecord","FOnNewRecord"),e.addProperty("OnPostError",0,pas.DB.$rtti.TDataSetErrorEvent,"FOnPostError","FOnPostError"),e.addProperty("OnUpdateRecord",0,t.$rtti.TUpdateRecordEvent,"FOnUpdateRecord","FOnUpdateRecord")})),t.$implcode=function(){rtl.createClass(e,"TWebClientDataRequest",pas.DB.TDataRequest,(function(){this.$init=function(){pas.DB.TDataRequest.$init.call(this),this.FXHR=null,this.FConnection=null},this.$final=function(){this.FXHR=void 0,this.FConnection=void 0,pas.DB.TDataRequest.$final.call(this)},this.onError=function(t){return this.FSuccess=0,null!=this.FConnection&&this.FConnection.DoError(this.FXHR.status),this.DoAfterRequest(),!0,!0},this.onAbort=function(t){return this.FSuccess=0,null!=this.FConnection&&this.FConnection.DoError(this.FXHR.status),this.DoAfterRequest(),!0,!0},this.onLoad=function(t){return 200===this.FXHR.status?(this.FData=this.TransformResult(),this.FSuccess=2):(this.FData=null,2 in this.FLoadOptions&&404===this.FXHR.status?this.FSuccess=1:(this.FSuccess=0,this.FErrorMsg=this.FXHR.statusText),null!=this.FConnection&&this.FConnection.DoError(this.FXHR.status)),this.DoAfterRequest(),!0,!0},this.TransformResult=function(){var t=void 0,e="";return t=this.FXHR.response,null!=this.FConnection&&null!=this.FConnection.FOnDataReceived&&(e=this.FXHR.responseText,this.FConnection.DoDataReceived(this.FXHR,{get:function(){return e},set:function(t){e=t}})),null!=this.FConnection&&null!=this.FConnection.FOnGetDataPayLoad&&this.FConnection.FOnGetDataPayLoad(this.FConnection,this.FDataset,0,{get:function(){return t},set:function(e){t=e}}),t}})),rtl.createClass(e,"TWebClientUpdateRequest",pas.DB.TRecordUpdateDescriptor,(function(){}))}}),["SysUtils","Types","WEBLib.Dialogs"]),rtl.module("dmMarshalDemoU",["System","SysUtils","Classes","JS","Web","WEBLib.Modules","DB","WEBLib.CDS"],(function(){"use strict";var t=this;rtl.createClass(this,"TDemoVideo",pas.System.TObject,(function(){this.$init=function(){pas.System.TObject.$init.call(this),this.VideoID="",this.Title="",this.Description=""}})),rtl.createClass(this,"TdmMarshalDemo",pas["WEBLib.Modules"].TDataModule,(function(){this.$init=function(){pas["WEBLib.Modules"].TDataModule.$init.call(this),this.cdsFeatures=null,this.cdsFeaturesFeatureName=null,this.cdsVideos=null,this.cdsVideosVideoID=null,this.cdsVideosTitle=null,this.cdsVideosDescription=null},this.$final=function(){this.cdsFeatures=void 0,this.cdsFeaturesFeatureName=void 0,this.cdsVideos=void 0,this.cdsVideosVideoID=void 0,this.cdsVideosTitle=void 0,this.cdsVideosDescription=void 0,pas["WEBLib.Modules"].TDataModule.$final.call(this)},this.WebDataModuleCreate=function(t){this.cdsFeatures.Open(),this.cdsVideos.Open()},this.cdsFeaturesAfterOpen=function(t){this.cdsFeaturesInsert("Feature 1"),this.cdsFeaturesInsert("Feature 2"),this.cdsFeaturesInsert("Feature 3")},this.cdsVideosAfterOpen=function(t){this.cdsVideosInsert("394wOxhvi5Y","Marshal Basics","Marshal Navigation and Object Plus are covered in detail here"),this.cdsVideosInsert("gafTIxVz4nY","Data Heuristics","Explore how to use Marshal data tools to diagnose TDataset issues"),this.cdsVideosInsert("WcJ9gEcIWHA","Visual Impact","Explore custom inspectors and learn benefits of inspectors by data types")},this.cdsFeaturesInsert=function(t){this.cdsFeatures.Insert$1(),this.cdsFeatures.FieldByName("FeatureName").SetAsString(t),this.cdsFeatures.Post()},this.cdsVideosInsert=function(t,e,i){this.cdsVideos.Append(),this.cdsVideos.FieldByName("VideoID").SetAsString(t),this.cdsVideos.FieldByName("Description").SetAsString(i),this.cdsVideos.FieldByName("Title").SetAsString(e),this.cdsVideos.Post()},this.CurrentVideo=function(){var e=null;return(e=t.TDemoVideo.$create("Create")).VideoID=this.cdsVideos.FieldByName("VideoID").GetAsString(),e.Description=this.cdsVideos.FieldByName("Description").GetAsString(),e.Title=this.cdsVideos.FieldByName("Title").GetAsString(),e},this.LoadDFMValues=function(){pas["WEBLib.Modules"].TDataModule.LoadDFMValues.call(this),this.cdsFeatures=pas["WEBLib.CDS"].TClientDataSet.$create("Create$1",[this]),this.cdsFeaturesFeatureName=pas.DB.TStringField.$create("Create$1",[this]),this.cdsVideos=pas["WEBLib.CDS"].TClientDataSet.$create("Create$1",[this]),this.cdsVideosVideoID=pas.DB.TStringField.$create("Create$1",[this]),this.cdsVideosTitle=pas.DB.TStringField.$create("Create$1",[this]),this.cdsVideosDescription=pas.DB.TStringField.$create("Create$1",[this]),this.cdsFeatures.BeforeLoadDFMValues(),this.cdsFeaturesFeatureName.BeforeLoadDFMValues(),this.cdsVideos.BeforeLoadDFMValues(),this.cdsVideosVideoID.BeforeLoadDFMValues(),this.cdsVideosTitle.BeforeLoadDFMValues(),this.cdsVideosDescription.BeforeLoadDFMValues();try{this.SetName("dmMarshalDemo"),this.SetEvent(this,"OnCreate","WebDataModuleCreate"),this.FHeight=285,this.FWidth=417,this.cdsFeatures.SetParentComponent(this),this.cdsFeatures.SetName("cdsFeatures"),this.cdsFeatures.FAfterOpen=rtl.createCallback(this,"cdsFeaturesAfterOpen"),this.cdsFeatures.SetLeft(96),this.cdsFeatures.SetTop(48),this.cdsFeaturesFeatureName.SetParentComponent(this.cdsFeatures),this.cdsFeaturesFeatureName.SetName("cdsFeaturesFeatureName"),this.cdsFeaturesFeatureName.FFieldName="FeatureName",this.cdsVideos.SetParentComponent(this),this.cdsVideos.SetName("cdsVideos"),this.cdsVideos.FAfterOpen=rtl.createCallback(this,"cdsVideosAfterOpen"),this.cdsVideos.SetLeft(192),this.cdsVideos.SetTop(128),this.cdsVideosVideoID.SetParentComponent(this.cdsVideos),this.cdsVideosVideoID.SetName("cdsVideosVideoID"),this.cdsVideosVideoID.FFieldName="VideoID",this.cdsVideosTitle.SetParentComponent(this.cdsVideos),this.cdsVideosTitle.SetName("cdsVideosTitle"),this.cdsVideosTitle.FFieldName="Title",this.cdsVideosDescription.SetParentComponent(this.cdsVideos),this.cdsVideosDescription.SetName("cdsVideosDescription"),this.cdsVideosDescription.FFieldName="Description"}finally{this.cdsFeatures.AfterLoadDFMValues(),this.cdsFeaturesFeatureName.AfterLoadDFMValues(),this.cdsVideos.AfterLoadDFMValues(),this.cdsVideosVideoID.AfterLoadDFMValues(),this.cdsVideosTitle.AfterLoadDFMValues(),this.cdsVideosDescription.AfterLoadDFMValues()}},rtl.addIntf(this,pas.System.IUnknown);var e=this.$rtti;e.addField("cdsFeatures",pas["WEBLib.CDS"].$rtti.TClientDataSet),e.addField("cdsFeaturesFeatureName",pas.DB.$rtti.TStringField),e.addField("cdsVideos",pas["WEBLib.CDS"].$rtti.TClientDataSet),e.addField("cdsVideosVideoID",pas.DB.$rtti.TStringField),e.addField("cdsVideosTitle",pas.DB.$rtti.TStringField),e.addField("cdsVideosDescription",pas.DB.$rtti.TStringField),e.addMethod("WebDataModuleCreate",0,[["Sender",pas.System.$rtti.TObject]]),e.addMethod("cdsFeaturesAfterOpen",0,[["DataSet",pas.DB.$rtti.TDataSet]]),e.addMethod("cdsVideosAfterOpen",0,[["DataSet",pas.DB.$rtti.TDataSet]])})),this.dmMarshalDemo=null})),rtl.module("WEBLib.StdCtrls",["System","Classes","WEBLib.Controls","SysUtils","Web","WEBLib.Graphics","Types","WEBLib.WebTools","WEBLib.Forms","WEBLib.Menus"],(function(){"use strict";var t=this;this.TEditCharCase={0:"wecLowerCase",wecLowerCase:0,1:"wecNormal",wecNormal:1,2:"wecMixedCase",wecMixedCase:2,3:"wecUpperCase",wecUpperCase:3},this.$rtti.$Enum("TEditCharCase",{minvalue:0,maxvalue:3,ordtype:1,enumtype:this.TEditCharCase}),this.TCheckBoxState={0:"cbChecked",cbChecked:0,1:"cbGrayed",cbGrayed:1,2:"cbUnchecked",cbUnchecked:2},this.$rtti.$Enum("TCheckBoxState",{minvalue:0,maxvalue:2,ordtype:1,enumtype:this.TCheckBoxState}),this.TDateTimeKind={0:"dtkDate",dtkDate:0,1:"dtkTime",dtkTime:1},this.$rtti.$Enum("TDateTimeKind",{minvalue:0,maxvalue:1,ordtype:1,enumtype:this.TDateTimeKind}),this.TEllipsisPosition={0:"epEndEllipsis",epEndEllipsis:0,1:"epNone",epNone:1,2:"epPathEllipsis",epPathEllipsis:2,3:"epWordEllipsis",epWordEllipsis:3},this.$rtti.$Enum("TEllipsisPosition",{minvalue:0,maxvalue:3,ordtype:1,enumtype:this.TEllipsisPosition}),this.TTextLayout={0:"tlTop",tlTop:0,1:"tlCenter",tlCenter:1,2:"tlBottom",tlBottom:2},this.$rtti.$Enum("TTextLayout",{minvalue:0,maxvalue:2,ordtype:1,enumtype:this.TTextLayout}),this.TAutoCompletion={0:"acOff",acOff:0,1:"acHonorificPrefix",acHonorificPrefix:1,2:"acGivenName",acGivenName:2,3:"acAdditionalName",acAdditionalName:3,4:"acFamilyName",acFamilyName:4,5:"acHonorificSuffix",acHonorificSuffix:5,6:"acNickName",acNickName:6,7:"acEmail",acEmail:7,8:"acUserName",acUserName:8,9:"acNewPassword",acNewPassword:9,10:"acCurrentPassword",acCurrentPassword:10,11:"acOrganizationTitle",acOrganizationTitle:11,12:"acOrganization",acOrganization:12,13:"acStreetAddress",acStreetAddress:13,14:"acAddressLine1",acAddressLine1:14,15:"acAddressLine2",acAddressLine2:15,16:"acAddressLine3",acAddressLine3:16,17:"acAddressLevel1",acAddressLevel1:17,18:"acAddressLevel2",acAddressLevel2:18,19:"acAddressLevel3",acAddressLevel3:19,20:"acAddressLevel4",acAddressLevel4:20,21:"acCountry",acCountry:21,22:"acCountryName",acCountryName:22,23:"acPostalCode",acPostalCode:23,24:"acCCName",acCCName:24,25:"acCCGivenName",acCCGivenName:25,26:"acCCAdditionalName",acCCAdditionalName:26,27:"acCCFamilyName",acCCFamilyName:27,28:"acCCNumber",acCCNumber:28,29:"acExpiry",acExpiry:29,30:"acExpiryMonth",acExpiryMonth:30,31:"acExpiryYear",acExpiryYear:31,32:"acCSC",acCSC:32,33:"acType",acType:33,34:"acTransactionCurrency",acTransactionCurrency:34,35:"acTransactionAmount",acTransactionAmount:35,36:"acLanguage",acLanguage:36,37:"acBirthday",acBirthday:37,38:"acBirthdayDay",acBirthdayDay:38,39:"acBirthDayMonth",acBirthDayMonth:39,40:"acBirthDayYear",acBirthDayYear:40,41:"acSex",acSex:41,42:"acTelephone",acTelephone:42,43:"acTelephoneCountryCode",acTelephoneCountryCode:43,44:"acTelephoneNational",acTelephoneNational:44,45:"acTelephoneAreaCode",acTelephoneAreaCode:45,46:"acTelephoneLocal",acTelephoneLocal:46,47:"acTelephoneExtension",acTelephoneExtension:47,48:"acIMPP",acIMPP:48,49:"acURL",acURL:49,50:"acPhoto",acPhoto:50,51:"acNone",acNone:51,52:"acNope",acNope:52},this.$rtti.$Enum("TAutoCompletion",{minvalue:0,maxvalue:52,ordtype:1,enumtype:this.TAutoCompletion}),this.TEditType={0:"weString",weString:0,1:"weFloat",weFloat:1,2:"weHex",weHex:2,3:"weNumeric",weNumeric:3,4:"weSignedFloat",weSignedFloat:4,5:"weSignedNumeric",weSignedNumeric:5,6:"weSearch",weSearch:6},this.$rtti.$Enum("TEditType",{minvalue:0,maxvalue:6,ordtype:1,enumtype:this.TEditType}),this.THTMLType={0:"tLABELTAG",tLABELTAG:0,1:"tSPAN",tSPAN:1,2:"tDIV",tDIV:2,3:"tH1",tH1:3,4:"tH2",tH2:4,5:"tH3",tH3:5,6:"tH4",tH4:6,7:"tH5",tH5:7,8:"tH6",tH6:8,9:"tP",tP:9},this.$rtti.$Enum("THTMLType",{minvalue:0,maxvalue:9,ordtype:1,enumtype:this.THTMLType}),rtl.createClass(this,"TCustomLabel",pas["WEBLib.Menus"].TWebCustomControl,(function(){this.$init=function(){pas["WEBLib.Menus"].TWebCustomControl.$init.call(this),this.FContent=null,this.FAutoSize=!1,this.FEllipsisPosition=0,this.FWordWrap=!1,this.FAlignment=0,this.FLayout=0,this.FTransparent=!1,this.FHTMLType=0,this.FFocusControl=null,this.FShowAccelChar=!1,this.FColor$1=0,this.FHasAccel=!1,this.FHasHTML=!1,this.FElementLabelClassName="",this.FOrigWidth=0,this.FOldWidth=0,this.FOldHeight=0,this.FHTML=""},this.$final=function(){this.FContent=void 0,this.FFocusControl=void 0,pas["WEBLib.Menus"].TWebCustomControl.$final.call(this)},this.SetLayout=function(t){this.FLayout!==t&&(this.FLayout=t,this.UpdateElementVisual())},this.SetAlignment=function(t){this.FAlignment!==t&&(this.FAlignment=t,this.UpdateElementVisual())},this.GetContentHandle=function(){return this.FContent},this.SetTransparent=function(t){this.FTransparent!==t&&(this.FTransparent=t,this.UpdateElementVisual())},this.SetHTMLType=function(t){var e=null;this.FHTMLType!==t&&(this.FHTMLType=t,this.FHTMLType in rtl.createSet(null,3,8)&&this.SetElementFont(1),null!=this.GetElementHandle()&&null!=this.FContent&&null!=(e=this.GetElementHandle().firstChild)&&"lbl"===e.getAttribute("data-lbl")&&(this.GetElementHandle().removeChild(this.FContent),this.FContent=this.CreateLabelElement(),this.GetElementHandle().appendChild(this.FContent),this.UpdateElement()))},this.SetColorEx=function(t){this.FColor$1=t,4 in this.FComponentState&&16777215!==this.FColor$1&&this.SetTransparent(!1),this.UpdateElement()},this.SetElementLabelClassName=function(t){this.FElementLabelClassName!==t&&(this.FElementLabelClassName=t,this.UpdateElement())},this.SetHTML=function(t){this.FHTML!==t&&(this.FHTML=t,this.UpdateElementData())},this.SetWidth=function(t){-1!==t&&0 in this.FComponentState&&(this.FOrigWidth=t),pas["WEBLib.Controls"].TControl.SetWidth.apply(this,arguments)},this.CreateElement=function(){var t=null;return t=document.createElement("DIV"),this.FContent=this.CreateLabelElement(),t.appendChild(this.FContent),t},this.CreateLabelElement=function(){var t=null;t=null;var e=this.FHTMLType;return 1===e?t=document.createElement("SPAN"):2===e?t=document.createElement("DIV"):3===e?t=document.createElement("H1"):4===e?t=document.createElement("H2"):5===e?t=document.createElement("H3"):6===e?t=document.createElement("H4"):7===e?t=document.createElement("H5"):8===e?t=document.createElement("H6"):0===e?t=document.createElement("LABEL"):9===e&&(t=document.createElement("P")),t.setAttribute("data-lbl","lbl"),t},this.GetDisplayText=function(){return this.FCaption},this.CanShowFocus=function(){return!1,!1},this.SetParent=function(t){pas["WEBLib.Controls"].TControl.SetParent.apply(this,arguments),this.FAutoSize&&0!==this.FAlignment&&-1!==this.FOrigWidth&&(this.SetLeft(this.GetLeft()+this.FOrigWidth-this.GetWidth()),this.FOrigWidth=-1)},this.BindElement=function(){this.FContent=this.GetContainer().firstElementChild},this.Loaded=function(){pas["WEBLib.Controls"].TCustomControl.Loaded.call(this),this.FShowAccelChar&&null!=this.FFocusControl&&this.UpdateElementData()},this.UpdateAutoSize=function(){this.FAutoSize&&0===this.FAlign&&(null!=this.GetElementHandle()&&pas["WEBLib.WebTools"].ElementVisible(this.GetElementHandle())&&(this.SetWidth(-1),this.SetHeight(-1)),this.FEllipsisPosition=1)},this.UpdateElementData=function(){var t="",e="",i=null;pas["WEBLib.Controls"].TControl.UpdateElementData.call(this),e="",t=this.FShowAccelChar?pas["WEBLib.WebTools"].ProcessAccelerator(this.GetDisplayText(),{get:function(){return e},set:function(t){e=t}}):this.GetDisplayText(),t=""===this.FHTML?pas["WEBLib.WebTools"].HTMLToString(t):this.FHTML,this.GetIsLinked()&&""===t&&0 in this.FComponentState||(null!=this.GetContentHandle()?this.GetIsLinked()?(i=this.GetContentHandle(),""!==this.GetID()&&(i=document.getElementById(this.GetID())),null!=i&&(pas.System.Assigned(this.GetContentHandle().nodeValue)?i.nodeValue=t:0===i.childElementCount&&(i.innerHTML=t))):this.GetContentHandle().childElementCount>0&&!this.FHasAccel&&!this.FHasHTML?this.GetContentHandle().nodeValue=t:this.GetContentHandle().innerHTML=t:this.GetElementHandle().innerHTML=t,this.FHasHTML=pas.System.Pos("</",t)>0,this.FHasAccel=""!==e,""!==e&&null!=this.FFocusControl&&(this.GetContentHandle().setAttribute("accesskey",e),this.GetContentHandle().setAttribute("for",this.FFocusControl.GetID())))},this.UpdateElementVisual=function(){var t=0,e=0;if(pas["WEBLib.Controls"].TCustomControl.UpdateElementVisual.call(this),!this.IsUpdating()&&(null!=this.GetElementHandle()&&(e=Math.round(this.GetElementHandle().offsetHeight),t=Math.round(this.GetElementHandle().offsetWidth),e>0&&(this.FOldHeight=e),t>0&&(this.FOldWidth=t),!this.FVisible||this.FAutoSize&&0===this.FAlign||0===this.FAlignment||this.GetElementHandle().style.setProperty("display","table"),this.GetElementHandle().setAttribute("zindex","1"),this.FAutoSize&&0===this.FAlign&&!(4 in this.FComponentState)?this.GetElementHandle().style.setProperty("overflow",""):this.GetElementHandle().style.setProperty("overflow","hidden")),null!=this.GetContentHandle())){var i=this.FLayout;0===i?this.GetContentHandle().style.setProperty("vertical-align","top"):1===i?this.GetContentHandle().style.setProperty("vertical-align","middle"):2===i&&this.GetContentHandle().style.setProperty("vertical-align","bottom");var s=this.FAlignment;0===s?this.GetContentHandle().style.removeProperty("text-align"):2===s?this.GetContentHandle().style.setProperty("text-align","center"):1===s&&this.GetContentHandle().style.setProperty("text-align","right"),pas["WEBLib.Controls"].SetHTMLElementColor(this.GetElementHandle(),this.FColor$1,this.FTransparent||-1===this.FColor$1||16711422===this.FColor$1),pas["WEBLib.Controls"].SetHTMLElementColor(this.GetContentHandle(),this.FColor$1,this.FTransparent||-1===this.FColor$1||16711422===this.FColor$1),this.GetContentHandle().style.setProperty("display","table-cell"),""===this.FElementClassName?(this.FEnabled&&0===this.FElementFont&&!this.GetIsLinked()?this.GetContentHandle().style.setProperty("color",pas["WEBLib.Graphics"].ColorToHTML(this.FFont.FColor)):this.GetContentHandle().style.removeProperty("color"),this.SetElementPointer(this.GetContentHandle(),this.FCursor),pas["WEBLib.Controls"].SetHTMLElementFont(this.GetContentHandle(),this.FFont,!(0===this.FElementFont&&!this.GetIsLinked()))):(this.GetContentHandle().style.removeProperty("color"),pas["WEBLib.Controls"].SetHTMLElementFont(this.GetContentHandle(),this.FFont,!0)),""!==this.FElementLabelClassName?this.GetContentHandle().setAttribute("class",this.FElementLabelClassName):this.GetContentHandle().removeAttribute("class"),0===this.FElementPosition||1===this.FWidthStyle?1===this.FEllipsisPosition?this.GetContentHandle().style.setProperty("text-overflow","clip"):this.GetContentHandle().style.setProperty("text-overflow","ellipsis"):this.GetContentHandle().style.removeProperty("text-overflow"),this.FWordWrap?this.GetContentHandle().style.setProperty("white-space","normal"):this.GetContentHandle().style.setProperty("white-space","nowrap"),this.GetElementHandle().style.setProperty("user-select",""),0===this.FCursor&&this.GetElementHandle().style.setProperty("cursor",""),this.FAutoSize&&0===this.FAlign&&!(4 in this.FComponentState)&&(this.GetElementHandle().style.removeProperty("width"),this.GetElementHandle().style.removeProperty("height"))}},this.UpdateElementSize=function(){pas["WEBLib.Controls"].TControl.UpdateElementSize.call(this),this.FAutoSize&&0===this.FAlign&&null!=this.GetElementHandle()&&(4 in this.FComponentState||(this.GetElementHandle().style.removeProperty("width"),this.GetElementHandle().style.removeProperty("height"))),null!=this.GetContentHandle()&&this.FAlign in rtl.createSet(3,4,5)&&!this.FAutoSize&&this.FLayout in rtl.createSet(1,2)&&this.GetContentHandle().style.setProperty("height",pas.SysUtils.TIntegerHelper.ToString$1.call({p:this.GetHeight(),get:function(){return this.p},set:function(t){this.p=t}})+"px")},this.SetAutoSize=function(t){this.FAutoSize!==t&&(this.FAutoSize=t,this.UpdateAutoSize(),this.UpdateElement())},this.SetCaption=function(t){var e=0;this.FCaption!==t&&(e=this.GetWidth(),pas["WEBLib.Controls"].TCustomControl.SetCaption.call(this,t),this.UpdateAutoSize(),this.UpdateElement(),e-=this.GetWidth(),this.FAutoSize&&0!==this.FAlignment&&0!==e&&2 in this.FAnchors&&!this.IsUpdating()&&this.SetLeft(this.GetLeft()+e))},this.SetControlCursor=function(t){pas["WEBLib.Controls"].TControl.SetControlCursor.apply(this,arguments),""===this.FElementClassName&&null!=this.GetContentHandle()&&this.SetElementPointer(this.GetContentHandle(),this.FCursor)},this.SetEllipsisPosition=function(t){this.FEllipsisPosition!==t&&(this.FEllipsisPosition=t,1!==this.FEllipsisPosition&&(this.FAutoSize=!1),this.UpdateElement())},this.GetWidth=function(){var t=0;return this.FAutoSize&&null!=this.GetElementHandle()&&null!=this.FParent?(0===(t=Math.round(this.GetElementHandle().offsetWidth))&&(t=pas["WEBLib.Controls"].TControl.GetWidth.call(this)),0===t&&""!==this.FCaption&&4 in this.FComponentState&&(t=this.FOldWidth)):t=pas["WEBLib.Controls"].TControl.GetWidth.call(this),t},this.GetHeight=function(){var t=0;return this.FAutoSize&&null!=this.GetElementHandle()&&null!=this.FParent?(0===(t=Math.round(this.GetElementHandle().offsetHeight))&&(t=pas["WEBLib.Controls"].TControl.GetHeight.call(this)),0===t&&""!==this.FCaption&&4 in this.FComponentState&&(t=this.FOldHeight)):t=pas["WEBLib.Controls"].TControl.GetHeight.call(this),t},this.CreateInitialize=function(){pas["WEBLib.Controls"].TCustomControl.CreateInitialize.call(this),this.FAutoSize=!0,this.FLayout=0,this.FEllipsisPosition=1,this.FColor$1=16777215,this.FTransparent=!0,this.FAlignment=0,this.SetTabStop(!1),this.FShowAccelChar=!0},rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TLabel",this.TCustomLabel,(function(){rtl.addIntf(this,pas.System.IUnknown);var e=this.$rtti;e.addProperty("Align",2,pas["WEBLib.Controls"].$rtti.TAlign,"FAlign","SetAlign",{Default:pas["WEBLib.Controls"].TAlign.alNone}),e.addProperty("Alignment",2,pas.Classes.$rtti.TAlignment,"FAlignment","SetAlignment",{Default:pas.Classes.TAlignment.taLeftJustify}),e.addProperty("AlignWithMargins",2,rtl.boolean,"FAlignWithMargins","SetAlignWithMargins",{Default:!1}),e.addProperty("Anchors",2,pas["WEBLib.Controls"].$rtti.TAnchors,"FAnchors","SetAnchors",{Default:rtl.createSet(0,1)}),e.addProperty("AutoSize",2,rtl.boolean,"FAutoSize","SetAutoSize",{Default:!0}),e.addProperty("Caption",2,rtl.string,"FCaption","SetCaption"),e.addProperty("ChildOrder",2,rtl.longint,"FChildOrder","SetChildOrderEx",{Default:0}),e.addProperty("Color",2,pas["WEBLib.Graphics"].$rtti.TColor,"FColor$1","SetColorEx",{Default:16777215}),e.addProperty("DragMode",2,pas["WEBLib.Controls"].$rtti.TDragMode,"FDragMode","SetDragMode",{Default:pas["WEBLib.Controls"].TDragMode.dmManual}),e.addProperty("EllipsisPosition",2,t.$rtti.TEllipsisPosition,"FEllipsisPosition","SetEllipsisPosition",{Default:t.TEllipsisPosition.epNone}),e.addProperty("Enabled",2,rtl.boolean,"FEnabled","SetEnabled",{Default:!0}),e.addProperty("ElementClassName",2,pas["WEBLib.Controls"].$rtti.TElementClassName,"FElementClassName","SetElementClassName"),e.addProperty("ElementLabelClassName",2,pas["WEBLib.Controls"].$rtti.TElementClassName,"FElementLabelClassName","SetElementLabelClassName"),e.addProperty("ElementID",3,pas["WEBLib.Controls"].$rtti.TElementID,"GetID","SetID"),e.addProperty("ElementFont",2,pas["WEBLib.Controls"].$rtti.TElementFont,"FElementFont","SetElementFont",{Default:pas["WEBLib.Controls"].TElementFont.efProperty}),e.addProperty("ElementPosition",2,pas["WEBLib.Controls"].$rtti.TElementPosition,"FElementPosition","SetElementPosition",{Default:pas["WEBLib.Controls"].TElementPosition.epAbsolute}),e.addProperty("FocusControl",0,pas["WEBLib.Controls"].$rtti.TWinControl,"FFocusControl","FFocusControl"),e.addProperty("Font",2,pas["WEBLib.Graphics"].$rtti.TFont,"FFont","SetFont"),e.addProperty("Height",3,rtl.longint,"GetHeight","SetHeight"),e.addProperty("HeightPercent",2,rtl.double,"FHeightPercent","SetHeightPercent",{Default:100}),e.addProperty("HeightStyle",2,pas["WEBLib.Controls"].$rtti.TSizeStyle,"FHeightStyle","SetHeightStyle",{Default:pas["WEBLib.Controls"].TSizeStyle.ssAbsolute}),e.addProperty("Hint",2,rtl.string,"FHint","SetHint"),e.addProperty("HTML",2,rtl.string,"FHTML","SetHTML"),e.addProperty("HTMLType",2,t.$rtti.THTMLType,"FHTMLType","SetHTMLType",{Default:t.THTMLType.tLABELTAG}),e.addProperty("Layout",2,t.$rtti.TTextLayout,"FLayout","SetLayout",{Default:t.TTextLayout.tlTop}),e.addProperty("Left",3,rtl.longint,"GetLeft","SetLeft"),e.addProperty("Margins",2,pas["WEBLib.Controls"].$rtti.TMargins,"FMargins","SetMargins"),e.addProperty("ParentFont",2,rtl.boolean,"FParentFont","SetParentFont",{Default:!0}),e.addProperty("PopupMenu",0,pas["WEBLib.Menus"].$rtti.TPopupMenu,"FPopupMenu","FPopupMenu"),e.addProperty("ShowAccelChar",0,rtl.boolean,"FShowAccelChar","FShowAccelChar",{Default:!0}),e.addProperty("ShowHint",2,rtl.boolean,"FShowHint","SetShowHint",{Default:!1}),e.addProperty("TextDirection",0,pas["WEBLib.Controls"].$rtti.TTextDirection,"FTextDirection","FTextDirection",{Default:pas["WEBLib.Controls"].TTextDirection.tdDefault}),e.addProperty("Top",3,rtl.longint,"GetTop","SetTop"),e.addProperty("Transparent",2,rtl.boolean,"FTransparent","SetTransparent",{Default:!0}),e.addProperty("Visible",2,rtl.boolean,"FVisible","SetVisible",{Default:!0}),e.addProperty("Width",3,rtl.longint,"GetWidth","SetWidth"),e.addProperty("WidthPercent",2,rtl.double,"FWidthPercent","SetWidthPercent",{Default:100}),e.addProperty("WidthStyle",2,pas["WEBLib.Controls"].$rtti.TSizeStyle,"FWidthStyle","SetWidthStyle",{Default:pas["WEBLib.Controls"].TSizeStyle.ssAbsolute}),e.addProperty("WordWrap",0,rtl.boolean,"FWordWrap","FWordWrap",{Default:!1}),e.addProperty("OnClick",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnClick","FOnClick"),e.addProperty("OnDblClick",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnDblClick","FOnDblClick"),e.addProperty("OnTouchStart",0,pas["WEBLib.Controls"].$rtti.TTouchEvent,"FOnTouchStart","FOnTouchStart"),e.addProperty("OnTouchEnd",0,pas["WEBLib.Controls"].$rtti.TTouchEvent,"FOnTouchEnd","FOnTouchEnd"),e.addProperty("OnTouchMove",0,pas["WEBLib.Controls"].$rtti.TTouchEvent,"FOnTouchMove","FOnTouchMove"),e.addProperty("OnTouchCancel",0,pas["WEBLib.Controls"].$rtti.TTouchEvent,"FOnTouchCancel","FOnTouchCancel"),e.addProperty("OnDragOver",0,pas["WEBLib.Controls"].$rtti.TDragOverEvent,"FOnDragOver","FOnDragOver"),e.addProperty("OnDragDrop",0,pas["WEBLib.Controls"].$rtti.TDragDropEvent,"FOnDragDrop","FOnDragDrop"),e.addProperty("OnStartDrag",0,pas["WEBLib.Controls"].$rtti.TStartDragEvent,"FOnStartDrag","FOnStartDrag"),e.addProperty("OnEndDrag",0,pas["WEBLib.Controls"].$rtti.TEndDragEvent,"FonEndDrag","FonEndDrag")})),rtl.createClass(this,"TWebLabel",this.TLabel,(function(){rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TCustomInput",pas["WEBLib.Menus"].TWebCustomControl,(function(){this.IsInputControl=function(){return!0,!0},this.GetInputType=function(){return"EDIT","EDIT"},this.CreateElement=function(){var t=null;return(t=document.createElement("INPUT")).setAttribute("type",this.GetInputType()),t},this.UpdateElementVisual=function(){pas["WEBLib.Controls"].TCustomControl.UpdateElementVisual.call(this),null==this.GetContainer()||this.GetIsLinked()||(this.GetContainer().style.setProperty("-moz-box-sizing","border-box"),this.GetContainer().style.setProperty("-webkit-box-sizing","border-box"),this.GetContainer().style.setProperty("box-sizing","border-box"))},this.CreateInitialize=function(){pas["WEBLib.Controls"].TCustomControl.CreateInitialize.call(this),this.SetShowFocus(!0),this.FNoUserSelect=!1},rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TCustomEdit",this.TCustomInput,(function(){this.$init=function(){t.TCustomInput.$init.call(this),this.FCharCase=0,this.FMaxLength=0,this.FReadOnly=!1,this.FText="",this.FTextHint="",this.FSelStart=0,this.FAlignment=0,this.FHideSelection=!1,this.FPasswordChar="",this.FOnChange=null,this.FAutoSize=!1,this.FAutoSelect=!1,this.FSelLength=0,this.FNumeric=!1,this.FAutoCompletion=0,this.FEditType=0,this.FRequired=!1,this.FAutoFocus=!1,this.FPattern="",this.FHandlePastePtr=null,this.FHandleCutPtr=null,this.FHandleChangePtr=null,this.FHandleInvalidPtr=null,this.FSpellCheck=!1,this.FRequiredText=""},this.$final=function(){this.FOnChange=void 0,t.TCustomInput.$final.call(this)},this.SetAlignment=function(t){this.FAlignment=t,this.UpdateElement()},this.SetHideSelection=function(t){this.FHideSelection!==t&&(this.FHideSelection=t,this.UpdateElement())},this.SetAutoSelect=function(t){this.FAutoSelect!==t&&(this.FAutoSelect=t,this.UpdateElement())},this.SetAutoSize=function(t){this.FAutoSize!==t&&(this.FAutoSize=t,this.UpdateElement())},this.SetSelLength=function(t){this.FSelLength=t,this.UpdateElement()},this.SetSelStart=function(t){this.FSelStart=t,this.UpdateElement()},this.SetPasswordChar=function(t){this.FPasswordChar=t,this.UpdateElement()},this.SetAutoCompletion=function(t){this.FAutoCompletion!==t&&(this.FAutoCompletion=t,this.UpdateElement())},this.SetAutoFocus=function(t){this.FAutoFocus!==t&&(this.FAutoFocus=t,this.UpdateElement())},this.SetRequired=function(t){this.FRequired=t,this.UpdateElement()},this.SetPattern=function(t){this.FPattern!==t&&(this.FPattern=t,this.UpdateElement())},this.GetSelLength=function(){var t=0;return t=-1,null!=this.GetElementInputHandle()&&(t=this.GetElementInputHandle().selectionEnd-this.GetElementInputHandle().selectionStart),t},this.GetSelStart=function(){var t=0;return t=-1,null!=this.GetElementInputHandle()&&(t=this.GetElementInputHandle().selectionStart),t},this.SetEditType=function(t){this.FEditType!==t&&(this.FEditType=t,this.UpdateElement())},this.SetSpellCheck=function(t){this.FSpellCheck!==t&&(this.FSpellCheck=t,this.UpdateElement())},this.GetElementInputHandle=function(){return this.GetContainer()},this.DoHandlePaste=function(t){var e;return e=(t.clipboardData||window.clipboardData).getData("Text"),this.CanPaste(e)&&this.Validate(e)||(t.preventDefault(),t.stopPropagation()),!1,!1},this.DoHandleCut=function(t){return this.CanCut()||(t.preventDefault(),t.stopPropagation()),!1,!1},this.DoHandleChange=function(t){return this.Change(),!0,""!==this.FRequiredText&&this.GetElementInputHandle().setCustomValidity(""),!0},this.DoHandleInvalid=function(t){return this.GetElementInputHandle().setCustomValidity(this.FRequiredText),!0,!0},this.IsCustomEditor=function(){return!1,!1},this.KeyPress=function(t){var e=!1;pas["WEBLib.Controls"].TControl.KeyPress.call(this,t),e=!0;var i=this.FEditType;3===i?e=t.get().charCodeAt()in rtl.createSet(null,48,57):5===i?e=t.get().charCodeAt()in rtl.createSet(null,48,57,43,45):1===i?e=t.get().charCodeAt()in rtl.createSet(null,48,57,44,46):4===i?e=t.get().charCodeAt()in rtl.createSet(null,48,57,44,46,43,45):2===i&&(e=t.get().charCodeAt()in rtl.createSet(null,48,57,null,65,70)),e||t.set("\0")},this.GetInputType=function(){return"\0"!==this.FPasswordChar?"PASSWORD":this.FNumeric?"NUMBER":this.FEditType in rtl.createSet(1,3)?"TEL":6===this.FEditType?"SEARCH":"TEXT"},this.GetText=function(){var t="";return t=this.FText,null!=this.GetElementInputHandle()&&(t=this.GetElementInputHandle().value),3===this.FCharCase&&(t=pas.SysUtils.UpperCase(t)),0===this.FCharCase&&(t=pas.SysUtils.LowerCase(t)),t},this.GetDisplayText=function(){return this.FText},this.IsReadOnly=function(){return this.FReadOnly},this.Validate=function(t){var e=!1,i=0,s="",o=!1;e=!0;for(var n=1,r=t.length;n<=r;n++){i=n,s=t.charAt(i-1),o=!0;var a=this.FEditType;if(3===a?o=s.charCodeAt()in rtl.createSet(null,48,57):5===a?o=s.charCodeAt()in rtl.createSet(null,48,57,43,45):1===a?o=s.charCodeAt()in rtl.createSet(null,48,57,44,46):4===a?o=s.charCodeAt()in rtl.createSet(null,48,57,44,46,43,45):2===a&&(o=s.charCodeAt()in rtl.createSet(null,48,57,null,65,70)),!o){e=!1;break}}return e},this.ClearMethodPointers=function(){pas["WEBLib.Controls"].TControl.ClearMethodPointers.call(this),this.FHandlePastePtr=null,this.FHandleCutPtr=null,this.FHandleChangePtr=null,this.FHandleInvalidPtr=null},this.GetMethodPointers=function(){pas["WEBLib.Controls"].TControl.GetMethodPointers.call(this),this.FHandlePastePtr=rtl.createCallback(this,"DoHandlePaste"),this.FHandleCutPtr=rtl.createCallback(this,"DoHandleCut"),this.FHandleChangePtr=rtl.createCallback(this,"DoHandleChange"),this.FHandleInvalidPtr=rtl.createCallback(this,"DoHandleInvalid")},this.BindEvents=function(){pas["WEBLib.Controls"].TCustomControl.BindEvents.call(this),null!=this.GetElementInputHandle()&&(this.GetElementInputHandle().addEventListener("input",this.FHandleChangePtr),this.GetElementInputHandle().addEventListener("paste",this.FHandlePastePtr),this.GetElementInputHandle().addEventListener("cut",this.FHandleCutPtr),this.GetElementInputHandle().addEventListener("invalid",this.FHandleInvalidPtr))},this.UnbindEvents=function(){pas["WEBLib.Controls"].TControl.UnbindEvents.call(this),null!=this.GetElementInputHandle()&&(this.GetElementInputHandle().removeEventListener("input",this.FHandleChangePtr),this.GetElementInputHandle().removeEventListener("paste",this.FHandlePastePtr),this.GetElementInputHandle().removeEventListener("cut",this.FHandleCutPtr),this.GetElementInputHandle().removeEventListener("invalid",this.FHandleInvalidPtr))},this.UpdateElementData=function(){var e=null,i=0,s=0,o=!1,n=!1;if(pas["WEBLib.Controls"].TControl.UpdateElementData.call(this),null!=this.GetElementInputHandle()){if(!this.GetIsLinked()){var r=this.FCharCase;3===r?this.GetElementInputHandle().style.setProperty("text-transform","uppercase"):0===r?this.GetElementInputHandle().style.setProperty("text-transform","lowercase"):2===r?this.GetElementInputHandle().style.setProperty("text-transform","capitalize"):1===r&&this.GetElementInputHandle().style.setProperty("text-transform","initial")}if(this.GetElementInputHandle().readOnly=this.IsReadOnly(),""!==this.FTextHint&&(this.GetElementInputHandle().placeholder=this.FTextHint),n=!0,this.GetIsLinked()&&(n=!this.GetElementInputHandle().hasAttribute("autocomplete")),n&&(52===this.FAutoCompletion?(this.GetElementInputHandle().setAttribute("autocomplete","nope"),this.GetElementInputHandle().removeAttribute("name")):51===this.FAutoCompletion?(this.GetElementInputHandle().setAttribute("autocomplete","off"),this.GetElementInputHandle().removeAttribute("name")):0!==this.FAutoCompletion?(this.GetElementInputHandle().setAttribute("autocomplete","on"),this.GetElementInputHandle().setAttribute("name",t.GetAutoCompletionName(this.FAutoCompletion))):(this.GetElementInputHandle().removeAttribute("autocomplete"),this.GetElementInputHandle().removeAttribute("name"))),!this.GetIsLinked()){this.GetElementInputHandle().setAttribute("type",this.GetInputType()),this.GetElementInputHandle().setAttribute("role","textbox");var a=this.FAlignment;0===a?this.GetElementInputHandle().style.removeProperty("text-align"):2===a?this.GetElementInputHandle().style.setProperty("text-align","center"):1===a&&this.GetElementInputHandle().style.setProperty("text-align","right")}this.FAutoFocus?this.GetElementInputHandle().setAttribute("autofocus",""):this.GetElementInputHandle().removeAttribute("autofocus"),this.FRequired?this.GetElementInputHandle().setAttribute("required",""):this.GetElementInputHandle().removeAttribute("required"),""!==this.FPattern?this.GetElementInputHandle().setAttribute("pattern",this.FPattern):this.GetElementInputHandle().removeAttribute("pattern"),this.FMaxLength<=0?this.GetElementInputHandle().removeAttribute("maxLength"):this.GetElementInputHandle().maxLength=this.FMaxLength,this.GetElementInputHandle().value=this.GetDisplayText(),o="NUMBER"===pas.SysUtils.UpperCase(this.GetInputType()),this.FSpellCheck?this.GetElementInputHandle().removeAttribute("spellcheck"):this.GetElementInputHandle().setAttribute("spellcheck","false"),o||this.GetIsLinked()||this.IsCustomEditor()||(i=this.FSelStart,s=this.FSelStart+this.FSelLength,e=this.GetElementInputHandle(),setTimeout((function(){e.setSelectionRange(i,s)}),1))}},this.SetCharCase=function(t){this.FCharCase!==t&&(this.FCharCase=t,this.UpdateElement())},this.SetMaxLength=function(t){this.FMaxLength!==t&&(this.FMaxLength=t,this.UpdateElementData())},this.SetReadOnly=function(t){this.FReadOnly!==t&&(this.FReadOnly=t,this.UpdateElement())},this.SetText=function(t){this.FText=t,null!=this.GetElementInputHandle()&&(this.GetElementInputHandle().value=this.GetDisplayText(),this.GetElementInputHandle().readOnly=this.IsReadOnly())},this.SetTextHint=function(t){this.FTextHint=t,this.UpdateElement()},this.CanPaste=function(t){return!0,!0},this.CanCut=function(){return!0,!0},this.CreateInitialize=function(){t.TCustomInput.CreateInitialize.call(this),this.FAutoCompletion=0,this.FEditType=0,this.FText="",this.FCharCase=1,this.FMaxLength=0,this.FReadOnly=!1,this.FTextHint="",this.FPasswordChar="\0",this.FSpellCheck=!0,this.SetHeight(25)},this.Change=function(){null!=this.GetElementHandle()&&(this.FText=this.GetElementInputHandle().value),null!=this.FOnChange&&this.FOnChange(this)},this.SelectAll=function(){null!=this.GetElementInputHandle()&&this.GetElementInputHandle().select()},rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TEdit",this.TCustomEdit,(function(){rtl.addIntf(this,pas.System.IUnknown);var e=this.$rtti;e.addProperty("Alignment",2,pas.Classes.$rtti.TAlignment,"FAlignment","SetAlignment"),e.addProperty("Align",2,pas["WEBLib.Controls"].$rtti.TAlign,"FAlign","SetAlign",{Default:pas["WEBLib.Controls"].TAlign.alNone}),e.addProperty("AlignWithMargins",2,rtl.boolean,"FAlignWithMargins","SetAlignWithMargins",{Default:!1}),e.addProperty("Anchors",2,pas["WEBLib.Controls"].$rtti.TAnchors,"FAnchors","SetAnchors",{Default:rtl.createSet(0,1)}),e.addProperty("AutoCompletion",2,t.$rtti.TAutoCompletion,"FAutoCompletion","SetAutoCompletion",{Default:t.TAutoCompletion.acOff}),e.addProperty("AutoFocus",2,rtl.boolean,"FAutoFocus","SetAutoFocus",{Default:!1}),e.addProperty("AutoSize",2,rtl.boolean,"FAutoSize","SetAutoSize",{Default:!1}),e.addProperty("AutoSelect",2,rtl.boolean,"FAutoSelect","SetAutoSelect",{Default:!1}),e.addProperty("BiDiMode",2,pas["WEBLib.Controls"].$rtti.TBiDiMode,"FBiDiMode","SetBiDiMode",{Default:pas["WEBLib.Controls"].TBiDiMode.bdLeftToRight}),e.addProperty("BorderStyle",2,pas["WEBLib.Controls"].$rtti.TBorderStyle,"FBorderStyle","SetBorderStyle",{Default:pas["WEBLib.Controls"].TBorderStyle.bsSingle}),e.addProperty("CharCase",2,t.$rtti.TEditCharCase,"FCharCase","SetCharCase",{Default:t.TEditCharCase.wecNormal}),e.addProperty("ChildOrder",2,rtl.longint,"FChildOrder","SetChildOrderEx",{Default:0}),e.addProperty("Color",2,pas["WEBLib.Graphics"].$rtti.TColor,"FColor","SetColor"),e.addProperty("DragMode",2,pas["WEBLib.Controls"].$rtti.TDragMode,"FDragMode","SetDragMode",{Default:pas["WEBLib.Controls"].TDragMode.dmManual}),e.addProperty("EditType",2,t.$rtti.TEditType,"FEditType","SetEditType",{Default:t.TEditType.weString}),e.addProperty("ElementClassName",2,pas["WEBLib.Controls"].$rtti.TElementClassName,"FElementClassName","SetElementClassName"),e.addProperty("ElementID",3,pas["WEBLib.Controls"].$rtti.TElementID,"GetID","SetID"),e.addProperty("ElementFont",2,pas["WEBLib.Controls"].$rtti.TElementFont,"FElementFont","SetElementFont",{Default:pas["WEBLib.Controls"].TElementFont.efProperty}),e.addProperty("ElementPosition",2,pas["WEBLib.Controls"].$rtti.TElementPosition,"FElementPosition","SetElementPosition",{Default:pas["WEBLib.Controls"].TElementPosition.epAbsolute}),e.addProperty("Enabled",2,rtl.boolean,"FEnabled","SetEnabled",{Default:!0}),e.addProperty("Font",2,pas["WEBLib.Graphics"].$rtti.TFont,"FFont","SetFont"),e.addProperty("Height",3,rtl.longint,"GetHeight","SetHeight"),e.addProperty("HeightPercent",2,rtl.double,"FHeightPercent","SetHeightPercent",{Default:100}),e.addProperty("HeightStyle",2,pas["WEBLib.Controls"].$rtti.TSizeStyle,"FHeightStyle","SetHeightStyle",{Default:pas["WEBLib.Controls"].TSizeStyle.ssAbsolute}),e.addProperty("Hint",2,rtl.string,"FHint","SetHint"),e.addProperty("HideSelection",2,rtl.boolean,"FHideSelection","SetHideSelection"),e.addProperty("Left",3,rtl.longint,"GetLeft","SetLeft"),e.addProperty("ParentFont",2,rtl.boolean,"FParentFont","SetParentFont",{Default:!0}),e.addProperty("PasswordChar",2,rtl.char,"FPasswordChar","SetPasswordChar",{Default:"\0"}),e.addProperty("Pattern",2,rtl.string,"FPattern","SetPattern"),e.addProperty("Margins",2,pas["WEBLib.Controls"].$rtti.TMargins,"FMargins","SetMargins"),e.addProperty("MaxLength",2,rtl.longint,"FMaxLength","SetMaxLength",{Default:0}),e.addProperty("PopupMenu",0,pas["WEBLib.Menus"].$rtti.TPopupMenu,"FPopupMenu","FPopupMenu"),e.addProperty("ReadOnly",2,rtl.boolean,"FReadOnly","SetReadOnly",{Default:!1}),e.addProperty("Required",2,rtl.boolean,"FRequired","SetRequired",{Default:!1}),e.addProperty("RequiredText",0,rtl.string,"FRequiredText","FRequiredText"),e.addProperty("ShowFocus",2,rtl.boolean,"FShowFocus","SetShowFocus",{Default:!1}),e.addProperty("ShowHint",2,rtl.boolean,"FShowHint","SetShowHint",{Default:!1}),e.addProperty("SpellCheck",2,rtl.boolean,"FSpellCheck","SetSpellCheck",{Default:!0}),e.addProperty("TabOrder",2,rtl.longint,"FTabOrder","SetTabOrder"),e.addProperty("TabStop",2,rtl.boolean,"FTabStop","SetTabStop",{Default:!0}),e.addProperty("Text",3,rtl.string,"GetText","SetText"),e.addProperty("TextDirection",0,pas["WEBLib.Controls"].$rtti.TTextDirection,"FTextDirection","FTextDirection",{Default:pas["WEBLib.Controls"].TTextDirection.tdDefault}),e.addProperty("TextHint",2,rtl.string,"FTextHint","SetTextHint"),e.addProperty("Top",3,rtl.longint,"GetTop","SetTop"),e.addProperty("Visible",2,rtl.boolean,"FVisible","SetVisible",{Default:!0}),e.addProperty("Width",3,rtl.longint,"GetWidth","SetWidth"),e.addProperty("WidthPercent",2,rtl.double,"FWidthPercent","SetWidthPercent",{Default:100}),e.addProperty("WidthStyle",2,pas["WEBLib.Controls"].$rtti.TSizeStyle,"FWidthStyle","SetWidthStyle",{Default:pas["WEBLib.Controls"].TSizeStyle.ssAbsolute}),e.addProperty("OnChange",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnChange","FOnChange"),e.addProperty("OnClick",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnClick","FOnClick"),e.addProperty("OnDblClick",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnDblClick","FOnDblClick"),e.addProperty("OnKeyDown",0,pas["WEBLib.Controls"].$rtti.TKeyEvent,"FOnKeyDown","FOnKeyDown"),e.addProperty("OnKeyPress",0,pas["WEBLib.Controls"].$rtti.TKeyPressEvent,"FOnKeyPress","FOnKeyPress"),e.addProperty("OnKeyUp",0,pas["WEBLib.Controls"].$rtti.TKeyEvent,"FOnKeyUp","FOnKeyUp"),e.addProperty("OnMouseDown",0,pas["WEBLib.Controls"].$rtti.TMouseEvent,"FOnMouseDown","FOnMouseDown"),e.addProperty("OnMouseUp",0,pas["WEBLib.Controls"].$rtti.TMouseEvent,"FOnMouseUp","FOnMouseUp"),e.addProperty("OnMouseMove",0,pas["WEBLib.Controls"].$rtti.TMouseMoveEvent,"FOnMouseMove","FOnMouseMove"),e.addProperty("OnMouseLeave",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnMouseLeave","FOnMouseLeave"),e.addProperty("OnMouseEnter",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnMouseEnter","FOnMouseEnter"),e.addProperty("OnEnter",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnEnter","FOnEnter"),e.addProperty("OnExit",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnExit","FOnExit"),e.addProperty("OnDragDrop",0,pas["WEBLib.Controls"].$rtti.TDragDropEvent,"FOnDragDrop","FOnDragDrop"),e.addProperty("OnDragOver",0,pas["WEBLib.Controls"].$rtti.TDragOverEvent,"FOnDragOver","FOnDragOver"),e.addProperty("OnEndDrag",0,pas["WEBLib.Controls"].$rtti.TEndDragEvent,"FonEndDrag","FonEndDrag"),e.addProperty("OnStartDrag",0,pas["WEBLib.Controls"].$rtti.TStartDragEvent,"FOnStartDrag","FOnStartDrag")})),rtl.createClass(this,"TSpinEdit",this.TCustomInput,(function(){this.$init=function(){t.TCustomInput.$init.call(this),this.FIncrement=0,this.FMaxValue=0,this.FMinValue=0,this.FValue=0,this.FAutoSize=!1,this.FOnChange=null,this.FReadOnly=!1,this.FHandleChangePtr=null,this.FHandleInvalidPtr=null,this.FRequiredText="",this.FRequired=!1},this.$final=function(){this.FOnChange=void 0,t.TCustomInput.$final.call(this)},this.GetText=function(){return pas.SysUtils.IntToStr(this.GetValue())},this.SetText=function(t){var e=0;e=0,pas.SysUtils.TryStrToInt(t,{get:function(){return e},set:function(t){e=t}})?this.SetValue(e):this.SetValue(0)},this.GetElementInputHandle=function(){return this.GetContainer()},this.SetReadOnly=function(t){this.FReadOnly!==t&&(this.FReadOnly=t,this.UpdateElement())},this.SetRequired=function(t){this.FRequired!==t&&(this.FRequired=t,this.UpdateElement())},this.KeyPress=function(t){t.get().charCodeAt()in rtl.createSet(null,48,57)||(t.set("\0"),this.PreventDefault(),this.StopPropagation()),pas["WEBLib.Controls"].TControl.KeyPress.apply(this,arguments)},this.GetInputType=function(){return"NUMBER","NUMBER"},this.UpdateElementData=function(){pas["WEBLib.Controls"].TControl.UpdateElementData.call(this),null!=this.GetContainer()&&(this.GetContainer().setAttribute("inputmode","numeric"),this.GetContainer().setAttribute("pattern","[0-9]*"),this.GetContainer().value=this.GetDisplayText(),this.GetElementInputHandle().readOnly=this.IsReadOnly(),this.FRequired?this.GetElementInputHandle().setAttribute("required",""):this.GetElementInputHandle().removeAttribute("required"))},this.GetValue=function(){var t,e=0;return e=this.FValue,null==this.GetContainer()||""!==(t=this.GetContainer().value)&&(e=pas.SysUtils.StrToInt(t)),e},this.SetIncrement=function(t){this.FIncrement=t,null!=this.GetContainer()&&this.GetContainer().setAttribute("step",pas.SysUtils.IntToStr(t))},this.SetMaxValue=function(t){this.FMaxValue=t,null!=this.GetContainer()&&this.GetContainer().setAttribute("max",pas.SysUtils.IntToStr(t))},this.SetMinValue=function(t){this.FMinValue=t,null!=this.GetContainer()&&this.GetContainer().setAttribute("min",pas.SysUtils.IntToStr(t))},this.SetValue=function(t){this.FValue=t,this.UpdateElement()},this.DoHandleChange=function(t){return this.Change(),!0,""!==this.FRequiredText&&this.GetElementInputHandle().setCustomValidity(""),!0},this.DoHandleInvalid=function(t){return this.GetElementInputHandle().setCustomValidity(this.FRequiredText),!0,!0},this.IsReadOnly=function(){return this.FReadOnly},this.GetDisplayText=function(){return pas.SysUtils.IntToStr(this.FValue)},this.BindEvents=function(){pas["WEBLib.Controls"].TCustomControl.BindEvents.call(this),null!=this.GetElementInputHandle()&&(this.GetElementInputHandle().addEventListener("input",this.FHandleChangePtr),this.GetElementInputHandle().addEventListener("invalid",this.FHandleInvalidPtr))},this.UnbindEvents=function(){pas["WEBLib.Controls"].TControl.UnbindEvents.call(this),null!=this.GetElementInputHandle()&&(this.GetElementInputHandle().removeEventListener("input",this.FHandleChangePtr),this.GetElementInputHandle().removeEventListener("invalid",this.FHandleInvalidPtr))},this.Change=function(){this.FValue=this.GetValue(),null!=this.FOnChange&&this.FOnChange(this)},this.ClearMethodPointers=function(){pas["WEBLib.Controls"].TControl.ClearMethodPointers.call(this),this.FHandleChangePtr=null,this.FHandleInvalidPtr=null},this.GetMethodPointers=function(){pas["WEBLib.Controls"].TControl.GetMethodPointers.call(this),this.FHandleChangePtr=rtl.createCallback(this,"DoHandleChange"),this.FHandleInvalidPtr=rtl.createCallback(this,"DoHandleInvalid")},this.CreateInitialize=function(){t.TCustomInput.CreateInitialize.call(this),this.FIncrement=1,this.FMaxValue=100,this.FMinValue=0,this.SetShowFocus(!0),this.SetHeight(25),this.AddControlStyle('input[type="number"]::-webkit-inner-spin-button { opacity: 1 !important; }')},rtl.addIntf(this,pas.System.IUnknown);var e=this.$rtti;e.addProperty("Align",2,pas["WEBLib.Controls"].$rtti.TAlign,"FAlign","SetAlign",{Default:pas["WEBLib.Controls"].TAlign.alNone}),e.addProperty("AlignWithMargins",2,rtl.boolean,"FAlignWithMargins","SetAlignWithMargins",{Default:!1}),e.addProperty("Anchors",2,pas["WEBLib.Controls"].$rtti.TAnchors,"FAnchors","SetAnchors",{Default:rtl.createSet(0,1)}),e.addProperty("AutoSize",0,rtl.boolean,"FAutoSize","FAutoSize"),e.addProperty("BiDiMode",2,pas["WEBLib.Controls"].$rtti.TBiDiMode,"FBiDiMode","SetBiDiMode",{Default:pas["WEBLib.Controls"].TBiDiMode.bdLeftToRight}),e.addProperty("BorderStyle",2,pas["WEBLib.Controls"].$rtti.TBorderStyle,"FBorderStyle","SetBorderStyle",{Default:pas["WEBLib.Controls"].TBorderStyle.bsSingle}),e.addProperty("ChildOrder",2,rtl.longint,"FChildOrder","SetChildOrderEx",{Default:0}),e.addProperty("Color",2,pas["WEBLib.Graphics"].$rtti.TColor,"FColor","SetColor"),e.addProperty("DragMode",2,pas["WEBLib.Controls"].$rtti.TDragMode,"FDragMode","SetDragMode",{Default:pas["WEBLib.Controls"].TDragMode.dmManual}),e.addProperty("ElementClassName",2,pas["WEBLib.Controls"].$rtti.TElementClassName,"FElementClassName","SetElementClassName"),e.addProperty("ElementID",3,pas["WEBLib.Controls"].$rtti.TElementID,"GetID","SetID"),e.addProperty("ElementFont",2,pas["WEBLib.Controls"].$rtti.TElementFont,"FElementFont","SetElementFont",{Default:pas["WEBLib.Controls"].TElementFont.efProperty}),e.addProperty("ElementPosition",2,pas["WEBLib.Controls"].$rtti.TElementPosition,"FElementPosition","SetElementPosition",{Default:pas["WEBLib.Controls"].TElementPosition.epAbsolute}),e.addProperty("Enabled",2,rtl.boolean,"FEnabled","SetEnabled",{Default:!0}),e.addProperty("Font",2,pas["WEBLib.Graphics"].$rtti.TFont,"FFont","SetFont"),e.addProperty("Height",3,rtl.longint,"GetHeight","SetHeight"),e.addProperty("HeightPercent",2,rtl.double,"FHeightPercent","SetHeightPercent",{Default:100}),e.addProperty("HeightStyle",2,pas["WEBLib.Controls"].$rtti.TSizeStyle,"FHeightStyle","SetHeightStyle",{Default:pas["WEBLib.Controls"].TSizeStyle.ssAbsolute}),e.addProperty("Hint",2,rtl.string,"FHint","SetHint"),e.addProperty("Increment",2,rtl.longint,"FIncrement","SetIncrement"),e.addProperty("Left",3,rtl.longint,"GetLeft","SetLeft"),e.addProperty("Margins",2,pas["WEBLib.Controls"].$rtti.TMargins,"FMargins","SetMargins"),e.addProperty("MaxValue",2,rtl.longint,"FMaxValue","SetMaxValue",{Default:100}),e.addProperty("MinValue",2,rtl.longint,"FMinValue","SetMinValue",{Default:0}),e.addProperty("ParentFont",2,rtl.boolean,"FParentFont","SetParentFont",{Default:!0}),e.addProperty("ReadOnly",2,rtl.boolean,"FReadOnly","SetReadOnly",{Default:!1}),e.addProperty("Required",2,rtl.boolean,"FRequired","SetRequired",{Default:!1}),e.addProperty("RequiredText",0,rtl.string,"FRequiredText","FRequiredText"),e.addProperty("Role",3,rtl.string,"GetRole","SetRole"),e.addProperty("ShowFocus",2,rtl.boolean,"FShowFocus","SetShowFocus",{Default:!1}),e.addProperty("ShowHint",2,rtl.boolean,"FShowHint","SetShowHint",{Default:!1}),e.addProperty("TabStop",2,rtl.boolean,"FTabStop","SetTabStop",{Default:!0}),e.addProperty("TabOrder",2,rtl.longint,"FTabOrder","SetTabOrder"),e.addProperty("TextDirection",0,pas["WEBLib.Controls"].$rtti.TTextDirection,"FTextDirection","FTextDirection",{Default:pas["WEBLib.Controls"].TTextDirection.tdDefault}),e.addProperty("Value",3,rtl.longint,"GetValue","SetValue"),e.addProperty("Visible",2,rtl.boolean,"FVisible","SetVisible",{Default:!0}),e.addProperty("Width",3,rtl.longint,"GetWidth","SetWidth"),e.addProperty("WidthPercent",2,rtl.double,"FWidthPercent","SetWidthPercent",{Default:100}),e.addProperty("WidthStyle",2,pas["WEBLib.Controls"].$rtti.TSizeStyle,"FWidthStyle","SetWidthStyle",{Default:pas["WEBLib.Controls"].TSizeStyle.ssAbsolute}),e.addProperty("OnChange",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnChange","FOnChange"),e.addProperty("OnClick",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnClick","FOnClick"),e.addProperty("OnDblClick",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnDblClick","FOnDblClick"),e.addProperty("OnKeyDown",0,pas["WEBLib.Controls"].$rtti.TKeyEvent,"FOnKeyDown","FOnKeyDown"),e.addProperty("OnKeyPress",0,pas["WEBLib.Controls"].$rtti.TKeyPressEvent,"FOnKeyPress","FOnKeyPress"),e.addProperty("OnKeyUp",0,pas["WEBLib.Controls"].$rtti.TKeyEvent,"FOnKeyUp","FOnKeyUp"),e.addProperty("OnMouseDown",0,pas["WEBLib.Controls"].$rtti.TMouseEvent,"FOnMouseDown","FOnMouseDown"),e.addProperty("OnMouseUp",0,pas["WEBLib.Controls"].$rtti.TMouseEvent,"FOnMouseUp","FOnMouseUp"),e.addProperty("OnMouseMove",0,pas["WEBLib.Controls"].$rtti.TMouseMoveEvent,"FOnMouseMove","FOnMouseMove"),e.addProperty("OnMouseLeave",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnMouseLeave","FOnMouseLeave"),e.addProperty("OnMouseEnter",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnMouseEnter","FOnMouseEnter"),e.addProperty("OnEnter",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnEnter","FOnEnter"),e.addProperty("OnExit",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnExit","FOnExit"),e.addProperty("OnDragDrop",0,pas["WEBLib.Controls"].$rtti.TDragDropEvent,"FOnDragDrop","FOnDragDrop"),e.addProperty("OnDragOver",0,pas["WEBLib.Controls"].$rtti.TDragOverEvent,"FOnDragOver","FOnDragOver"),e.addProperty("OnEndDrag",0,pas["WEBLib.Controls"].$rtti.TEndDragEvent,"FonEndDrag","FonEndDrag"),e.addProperty("OnStartDrag",0,pas["WEBLib.Controls"].$rtti.TStartDragEvent,"FOnStartDrag","FOnStartDrag")})),rtl.createClass(this,"TDateTimePicker",this.TCustomInput,(function(){this.$init=function(){t.TCustomInput.$init.call(this),this.FDate=0,this.FTime=0,this.FKind=0,this.FOnChange=null,this.FReadOnly=!1,this.FElementCheck=null,this.FElementPicker=null,this.FShowCheckBox=!1,this.FClickPtr$1=null,this.FHandleChangePtr=null,this.FFocusPtr=null,this.FBlurPtr=null,this.FChecked=!1,this.FShowSeconds=!1,this.FAutoDropDown=!1},this.$final=function(){this.FOnChange=void 0,this.FElementCheck=void 0,this.FElementPicker=void 0,t.TCustomInput.$final.call(this)},this.SetDate=function(t){this.FDate!==t&&(this.FDate=pas.System.Int(t),this.FTime=0,this.UpdateElementData())},this.GetDate=function(){var t,e=0,i="",s="",o="",n=0,r=0,a=0,l=0;return e=pas.System.Int(this.FDate)+pas.System.Frac(this.FTime),null==this.GetElementPicker()||(t=this.GetElementPicker().value,0===this.FKind?(i=pas.System.Copy(t,1,4),s=pas.System.Copy(t,6,2),o=pas.System.Copy(t,9,2),pas.System.val$5(i,{get:function(){return n},set:function(t){n=t}},{get:function(){return l},set:function(t){l=t}}),pas.System.val$5(s,{get:function(){return r},set:function(t){r=t}},{get:function(){return l},set:function(t){l=t}}),pas.System.val$5(o,{get:function(){return a},set:function(t){a=t}},{get:function(){return l},set:function(t){l=t}}),e=0!==n&&0!==r&&0!==a?pas.SysUtils.EncodeDate(n,r,a)+pas.System.Frac(this.FTime):pas.System.Frac(this.FTime)):e=this.FTime),e},this.SetTime=function(t){this.FTime!==t&&(this.FDate=0,this.FTime=t,this.UpdateElementData())},this.GetTime=function(){var t,e=0,i=0;return e=this.FDate>0?pas.System.Frac(this.FTime)+pas.System.Int(this.FDate):pas.System.Frac(this.FTime),null==this.GetElementPicker()||(t=this.GetElementPicker().value,pas.SysUtils.TryStrToTime(t,{get:function(){return i},set:function(t){i=t}})&&(e=i+pas.System.Int(this.FDate))),e},this.SetKind=function(t){var e=0;this.FKind=t,null!=this.GetElementPicker()&&(e=pas.System.Int(this.FDate)+pas.System.Frac(this.FTime),0===t?this.GetElementPicker().setAttribute("type","DATE"):this.GetElementPicker().setAttribute("type","TIME"),this.SetDate(e),this.SetTime(e),this.UpdateElement())},this.SetText=function(t){this.GetElementPicker()},this.GetText=function(){var t="";return t="",null==this.GetElementPicker()?t:t=this.GetElementPicker().value},this.SetReadOnly=function(t){this.FReadOnly=t,this.UpdateElement()},this.SetShowCheckBox=function(t){this.FShowCheckBox!==t&&(this.FShowCheckBox=t,this.UpdateElementVisual())},this.SetChecked=function(t){this.FChecked!==t&&(this.FChecked=t,this.UpdateElementVisual())},this.SetShowSeconds=function(t){this.FShowSeconds!==t&&(this.FShowSeconds=t,this.UpdateElement())},this.DoCheckClick=function(t){return this.FChecked=this.FElementCheck.checked,this.FChecked?this.GetElementPicker().removeAttribute("disabled"):this.GetElementPicker().setAttribute("disabled","true"),!0,!0},this.DoPickerFocus=function(t){return this.GetElementHandle().style.setProperty("outline","auto"),!0,this.DoEnter(),!0},this.DoPickerBlur=function(t){return this.GetElementHandle().style.setProperty("outline","none"),!0,this.DoExit(),!0},this.DoHandleChange=function(t){return this.Change(),!0,!0},this.HandleDoEnter=function(t){var e;return e=pas["WEBLib.Controls"].TControl.HandleDoEnter.call(this,t),this.FAutoDropDown&&this.GetElementPicker().showPicker(),e},this.GetElementBindHandle=function(){return this.GetElementPicker()},this.BindEvents=function(){pas["WEBLib.Controls"].TCustomControl.BindEvents.call(this),null!=this.FElementCheck&&this.FElementCheck.addEventListener("click",this.FClickPtr$1),null!=this.GetElementPicker()&&(this.GetElementPicker().addEventListener("input",this.FHandleChangePtr),this.GetElementPicker().addEventListener("focus",this.FFocusPtr),this.GetElementPicker().addEventListener("blur",this.FBlurPtr))},this.UnbindEvents=function(){pas["WEBLib.Controls"].TControl.UnbindEvents.call(this),null!=this.FElementCheck&&this.FElementCheck.removeEventListener("click",this.FClickPtr$1),null!=this.GetElementPicker()&&(this.GetElementPicker().removeEventListener("input",this.FHandleChangePtr),this.GetElementPicker().removeEventListener("focus",this.FFocusPtr),this.GetElementPicker().removeEventListener("blur",this.FBlurPtr))},this.UpdateElementData=function(){var t=null;if(pas["WEBLib.Controls"].TControl.UpdateElementData.call(this),null!=(t=this.GetElementPicker())){t.setAttribute("step","1");var e=this.FKind;1===e?(t.value=pas.SysUtils.FormatDateTime(pas.SysUtils.TFormatSettings.Invariant().LongTimeFormat,this.FTime),this.FShowSeconds||t.setAttribute("step","60")):0===e&&(0===this.FDate?t.value="":t.value=pas.SysUtils.FormatDateTime("yyyy-MM-dd",this.FDate)),this.FTabStop?t.setAttribute("tabindex",pas.SysUtils.IntToStr(this.FTabOrder)):t.setAttribute("tabindex","-1"),t.readOnly=this.IsReadOnly(),this.IsEnabled()?t.removeAttribute("disabled"):t.setAttribute("disabled","")}},this.UpdateElementVisual=function(){t.TCustomInput.UpdateElementVisual.call(this),null!=this.GetElementPicker()&&null!=this.GetElementHandle()&&null!=this.FElementCheck&&(this.FElementCheck.setAttribute("type","CHECKBOX"),0===this.FKind?this.GetElementPicker().setAttribute("type","DATE"):this.GetElementPicker().setAttribute("type","TIME"),this.GetElementPicker().style.setProperty("border","none"),this.GetElementPicker().style.setProperty("border-width","0px"),this.GetElementPicker().style.setProperty("outline","none"),this.GetElementPicker().style.setProperty("font-family","inherit"),this.GetElementPicker().style.setProperty("font-size","inherit"),this.GetElementPicker().style.setProperty("width","100%"),this.GetElementPicker().style.setProperty("height","100%"),this.GetElementHandle().style.setProperty("padding","1px"),this.GetElementHandle().style.setProperty("outline","none"),1===this.FBorderStyle?(this.FEnabled?this.GetElementHandle().style.setProperty("border","1px solid"):this.GetElementHandle().style.setProperty("border","1px silver solid"),this.GetElementHandle().style.setProperty("border-radius","3px")):this.GetElementHandle().style.removeProperty("border"),null!=this.FElementCheck&&(this.FShowCheckBox?this.FElementCheck.style.setProperty("display",""):this.FElementCheck.style.setProperty("display","none")),this.FShowCheckBox&&(this.FChecked?this.GetElementPicker().removeAttribute("disabled"):this.GetElementPicker().setAttribute("disabled","true")))},this.CreateElement=function(){var t=null;return t=document.createElement("DIV"),this.FElementCheck=document.createElement("INPUT"),this.FElementPicker=document.createElement("INPUT"),t.appendChild(this.FElementCheck),t.appendChild(this.FElementPicker),t},this.GetInputType=function(){return 0===this.FKind?"DATE":"TIME"},this.Change=function(){this.FTime=this.GetTime(),this.FDate=this.GetDate(),null!=this.FOnChange&&this.FOnChange(this)},this.IsReadOnly=function(){return this.FReadOnly},this.ClearMethodPointers=function(){pas["WEBLib.Controls"].TControl.ClearMethodPointers.call(this),this.FHandleChangePtr=null,this.FBlurPtr=null,this.FFocusPtr=null,this.FClickPtr$1=null},this.GetMethodPointers=function(){pas["WEBLib.Controls"].TControl.GetMethodPointers.call(this),this.FHandleChangePtr=rtl.createCallback(this,"DoHandleChange"),this.FClickPtr$1=rtl.createCallback(this,"DoCheckClick"),this.FFocusPtr=rtl.createCallback(this,"DoPickerFocus"),this.FBlurPtr=rtl.createCallback(this,"DoPickerBlur")},this.GetElementPicker=function(){return this.GetIsLinked()?this.GetElementHandle():this.FElementPicker},this.SetEnabled=function(t){var e=null;pas["WEBLib.Controls"].TControl.SetEnabled.apply(this,arguments),null!=(e=this.GetElementPicker())&&(t?e.removeAttribute("disabled"):e.setAttribute("disabled",""))},this.CreateInitialize=function(){t.TCustomInput.CreateInitialize.call(this),this.SetDate(pas.SysUtils.Now()),this.SetShowFocus(!0),4 in this.FComponentState&&(this.SetWidth(170),this.SetHeight(25)),this.FDate=pas.System.Int(pas.SysUtils.Now()),this.FTime=0,this.FReadOnly=!1,this.FShowSeconds=!0},this.SetFocus=function(){null!=this.GetElementPicker()&&this.GetElementPicker().focus()},rtl.addIntf(this,pas.System.IUnknown);var e=this.$rtti;e.addProperty("Align",2,pas["WEBLib.Controls"].$rtti.TAlign,"FAlign","SetAlign",{Default:pas["WEBLib.Controls"].TAlign.alNone}),e.addProperty("AlignWithMargins",2,rtl.boolean,"FAlignWithMargins","SetAlignWithMargins",{Default:!1}),e.addProperty("Anchors",2,pas["WEBLib.Controls"].$rtti.TAnchors,"FAnchors","SetAnchors",{Default:rtl.createSet(0,1)}),e.addProperty("AutoDropDown",0,rtl.boolean,"FAutoDropDown","FAutoDropDown",{Default:!1}),e.addProperty("BorderStyle",2,pas["WEBLib.Controls"].$rtti.TBorderStyle,"FBorderStyle","SetBorderStyle",{Default:pas["WEBLib.Controls"].TBorderStyle.bsSingle}),e.addProperty("Checked",2,rtl.boolean,"FChecked","SetChecked",{Default:!1}),e.addProperty("ChildOrder",2,rtl.longint,"FChildOrder","SetChildOrderEx",{Default:0}),e.addProperty("Color",2,pas["WEBLib.Graphics"].$rtti.TColor,"FColor","SetColor"),e.addProperty("Date",3,pas.System.$rtti.TDate,"GetDate","SetDate"),e.addProperty("DragMode",2,pas["WEBLib.Controls"].$rtti.TDragMode,"FDragMode","SetDragMode",{Default:pas["WEBLib.Controls"].TDragMode.dmManual}),e.addProperty("ElementClassName",2,pas["WEBLib.Controls"].$rtti.TElementClassName,"FElementClassName","SetElementClassName"),e.addProperty("ElementID",3,pas["WEBLib.Controls"].$rtti.TElementID,"GetID","SetID"),e.addProperty("ElementFont",2,pas["WEBLib.Controls"].$rtti.TElementFont,"FElementFont","SetElementFont",{Default:pas["WEBLib.Controls"].TElementFont.efProperty}),e.addProperty("ElementPosition",2,pas["WEBLib.Controls"].$rtti.TElementPosition,"FElementPosition","SetElementPosition",{Default:pas["WEBLib.Controls"].TElementPosition.epAbsolute}),e.addProperty("Font",2,pas["WEBLib.Graphics"].$rtti.TFont,"FFont","SetFont"),e.addProperty("Height",3,rtl.longint,"GetHeight","SetHeight"),e.addProperty("HeightPercent",2,rtl.double,"FHeightPercent","SetHeightPercent",{Default:100}),e.addProperty("HeightStyle",2,pas["WEBLib.Controls"].$rtti.TSizeStyle,"FHeightStyle","SetHeightStyle",{Default:pas["WEBLib.Controls"].TSizeStyle.ssAbsolute}),e.addProperty("Hint",2,rtl.string,"FHint","SetHint"),e.addProperty("Kind",2,t.$rtti.TDateTimeKind,"FKind","SetKind"),e.addProperty("Left",3,rtl.longint,"GetLeft","SetLeft"),e.addProperty("Margins",2,pas["WEBLib.Controls"].$rtti.TMargins,"FMargins","SetMargins"),e.addProperty("ParentFont",2,rtl.boolean,"FParentFont","SetParentFont",{Default:!0}),e.addProperty("ReadOnly",2,rtl.boolean,"FReadOnly","SetReadOnly",{Default:!1}),e.addProperty("Role",3,rtl.string,"GetRole","SetRole"),e.addProperty("ShowCheckBox",2,rtl.boolean,"FShowCheckBox","SetShowCheckBox",{Default:!1}),e.addProperty("ShowFocus",2,rtl.boolean,"FShowFocus","SetShowFocus",{Default:!1}),e.addProperty("ShowHint",2,rtl.boolean,"FShowHint","SetShowHint",{Default:!1}),e.addProperty("ShowSeconds",2,rtl.boolean,"FShowSeconds","SetShowSeconds",{Default:!0}),e.addProperty("TabStop",2,rtl.boolean,"FTabStop","SetTabStop",{Default:!0}),e.addProperty("TabOrder",2,rtl.longint,"FTabOrder","SetTabOrder"),e.addProperty("Text",3,rtl.string,"GetText","SetText"),e.addProperty("TextDirection",0,pas["WEBLib.Controls"].$rtti.TTextDirection,"FTextDirection","FTextDirection",{Default:pas["WEBLib.Controls"].TTextDirection.tdDefault}),e.addProperty("Time",3,pas.System.$rtti.TTime,"GetTime","SetTime"),e.addProperty("Top",3,rtl.longint,"GetTop","SetTop"),e.addProperty("Visible",2,rtl.boolean,"FVisible","SetVisible",{Default:!0}),e.addProperty("Width",3,rtl.longint,"GetWidth","SetWidth"),e.addProperty("WidthPercent",2,rtl.double,"FWidthPercent","SetWidthPercent",{Default:100}),e.addProperty("WidthStyle",2,pas["WEBLib.Controls"].$rtti.TSizeStyle,"FWidthStyle","SetWidthStyle",{Default:pas["WEBLib.Controls"].TSizeStyle.ssAbsolute}),e.addProperty("OnClick",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnClick","FOnClick"),e.addProperty("OnChange",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnChange","FOnChange"),e.addProperty("OnDblClick",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnDblClick","FOnDblClick"),e.addProperty("OnKeyDown",0,pas["WEBLib.Controls"].$rtti.TKeyEvent,"FOnKeyDown","FOnKeyDown"),e.addProperty("OnKeyPress",0,pas["WEBLib.Controls"].$rtti.TKeyPressEvent,"FOnKeyPress","FOnKeyPress"),e.addProperty("OnKeyUp",0,pas["WEBLib.Controls"].$rtti.TKeyEvent,"FOnKeyUp","FOnKeyUp"),e.addProperty("OnMouseDown",0,pas["WEBLib.Controls"].$rtti.TMouseEvent,"FOnMouseDown","FOnMouseDown"),e.addProperty("OnMouseUp",0,pas["WEBLib.Controls"].$rtti.TMouseEvent,"FOnMouseUp","FOnMouseUp"),e.addProperty("OnMouseMove",0,pas["WEBLib.Controls"].$rtti.TMouseMoveEvent,"FOnMouseMove","FOnMouseMove"),e.addProperty("OnMouseLeave",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnMouseLeave","FOnMouseLeave"),e.addProperty("OnMouseEnter",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnMouseEnter","FOnMouseEnter"),e.addProperty("OnEnter",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnEnter","FOnEnter"),e.addProperty("OnExit",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnExit","FOnExit"),e.addProperty("OnDragDrop",0,pas["WEBLib.Controls"].$rtti.TDragDropEvent,"FOnDragDrop","FOnDragDrop"),e.addProperty("OnDragOver",0,pas["WEBLib.Controls"].$rtti.TDragOverEvent,"FOnDragOver","FOnDragOver"),e.addProperty("OnEndDrag",0,pas["WEBLib.Controls"].$rtti.TEndDragEvent,"FonEndDrag","FonEndDrag"),e.addProperty("OnStartDrag",0,pas["WEBLib.Controls"].$rtti.TStartDragEvent,"FOnStartDrag","FOnStartDrag")})),rtl.createClass(this,"TWebDateTimePicker",this.TDateTimePicker,(function(){rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TButton",pas["WEBLib.Menus"].TWebCustomControl,(function(){this.$init=function(){pas["WEBLib.Menus"].TWebCustomControl.$init.call(this),this.FModalResult=0,this.FDefault=!1,this.FButtonType=""},this.SetButtonType=function(t){this.FButtonType=t,this.UpdateElementData()},this.SetDefault=function(t){this.FDefault=t,this.FDefault&&this.SetFocus()},this.CreateElement=function(){var t=null;return(t=document.createElement("BUTTON")).setAttribute("type","BUTTON"),t},this.SetCaption=function(t){this.FCaption!==t&&(pas["WEBLib.Controls"].TCustomControl.SetCaption.call(this,t),this.UpdateElementData())},this.UpdateElementData=function(){var t="";pas["WEBLib.Controls"].TControl.UpdateElementData.call(this),this.GetIsLinked()&&""===this.FCaption||null!=this.GetElementHandle()&&((0===this.GetElementHandle().childElementCount||pas.System.Pos("</",this.FCaption)>0||!this.GetIsLinked())&&(this.GetElementHandle().innerHTML=pas["WEBLib.WebTools"].ProcessAccelerator(this.FCaption,{get:function(){return t},set:function(e){t=e}})),""!==t&&this.GetElementHandle().setAttribute("accesskey",t),this.GetElementHandle().setAttribute("role","button"),this.GetElementHandle().setAttribute("aria-label",this.FCaption),""!==this.FButtonType?this.GetElementHandle().setAttribute("type",this.FButtonType):this.GetElementHandle().setAttribute("type","BUTTON"))},this.UpdateElementVisual=function(){var t="";pas["WEBLib.Controls"].TCustomControl.UpdateElementVisual.call(this),null!=this.GetElementHandle()&&(this.GetElementHandle().style.removeProperty("outline"),this.GetElementHandle().style.removeProperty("user-select"),"BTN"===(t=pas.SysUtils.UpperCase(this.FElementClassName))||pas.System.Pos("BTN ",t))},this.CreateInitialize=function(){pas["WEBLib.Controls"].TCustomControl.CreateInitialize.call(this),4 in this.FComponentState&&""===this.FCaption&&this.SetCaption(this.FName),this.SetColor(-1)},rtl.addIntf(this,pas.System.IUnknown);var t=this.$rtti;t.addProperty("Align",2,pas["WEBLib.Controls"].$rtti.TAlign,"FAlign","SetAlign",{Default:pas["WEBLib.Controls"].TAlign.alNone}),t.addProperty("AlignWithMargins",2,rtl.boolean,"FAlignWithMargins","SetAlignWithMargins",{Default:!1}),t.addProperty("Anchors",2,pas["WEBLib.Controls"].$rtti.TAnchors,"FAnchors","SetAnchors",{Default:rtl.createSet(0,1)}),t.addProperty("BiDiMode",2,pas["WEBLib.Controls"].$rtti.TBiDiMode,"FBiDiMode","SetBiDiMode",{Default:pas["WEBLib.Controls"].TBiDiMode.bdLeftToRight}),t.addProperty("BorderStyle",2,pas["WEBLib.Controls"].$rtti.TBorderStyle,"FBorderStyle","SetBorderStyle",{Default:pas["WEBLib.Controls"].TBorderStyle.bsSingle}),t.addProperty("ButtonType",2,rtl.string,"FButtonType","SetButtonType"),t.addProperty("Caption",2,rtl.string,"FCaption","SetCaption"),t.addProperty("ChildOrder",2,rtl.longint,"FChildOrder","SetChildOrderEx",{Default:0}),t.addProperty("Color",2,pas["WEBLib.Graphics"].$rtti.TColor,"FColor","SetColor"),t.addProperty("Default",2,rtl.boolean,"FDefault","SetDefault"),t.addProperty("DragMode",2,pas["WEBLib.Controls"].$rtti.TDragMode,"FDragMode","SetDragMode",{Default:pas["WEBLib.Controls"].TDragMode.dmManual}),t.addProperty("ElementClassName",2,pas["WEBLib.Controls"].$rtti.TElementClassName,"FElementClassName","SetElementClassName"),t.addProperty("ElementID",3,pas["WEBLib.Controls"].$rtti.TElementID,"GetID","SetID"),t.addProperty("ElementFont",2,pas["WEBLib.Controls"].$rtti.TElementFont,"FElementFont","SetElementFont",{Default:pas["WEBLib.Controls"].TElementFont.efProperty}),t.addProperty("ElementPosition",2,pas["WEBLib.Controls"].$rtti.TElementPosition,"FElementPosition","SetElementPosition",{Default:pas["WEBLib.Controls"].TElementPosition.epAbsolute}),t.addProperty("Enabled",2,rtl.boolean,"FEnabled","SetEnabled",{Default:!0}),t.addProperty("Font",2,pas["WEBLib.Graphics"].$rtti.TFont,"FFont","SetFont"),t.addProperty("Height",3,rtl.longint,"GetHeight","SetHeight"),t.addProperty("HeightPercent",2,rtl.double,"FHeightPercent","SetHeightPercent",{Default:100}),t.addProperty("HeightStyle",2,pas["WEBLib.Controls"].$rtti.TSizeStyle,"FHeightStyle","SetHeightStyle",{Default:pas["WEBLib.Controls"].TSizeStyle.ssAbsolute}),t.addProperty("Hint",2,rtl.string,"FHint","SetHint"),t.addProperty("Left",3,rtl.longint,"GetLeft","SetLeft"),t.addProperty("Margins",2,pas["WEBLib.Controls"].$rtti.TMargins,"FMargins","SetMargins"),t.addProperty("PopupMenu",0,pas["WEBLib.Menus"].$rtti.TPopupMenu,"FPopupMenu","FPopupMenu"),t.addProperty("Role",3,rtl.string,"GetRole","SetRole"),t.addProperty("ParentFont",2,rtl.boolean,"FParentFont","SetParentFont",{Default:!0}),t.addProperty("ShowHint",2,rtl.boolean,"FShowHint","SetShowHint",{Default:!1}),t.addProperty("TabOrder",2,rtl.longint,"FTabOrder","SetTabOrder"),t.addProperty("TabStop",2,rtl.boolean,"FTabStop","SetTabStop",{Default:!0}),t.addProperty("TextDirection",0,pas["WEBLib.Controls"].$rtti.TTextDirection,"FTextDirection","FTextDirection",{Default:pas["WEBLib.Controls"].TTextDirection.tdDefault}),t.addProperty("Top",3,rtl.longint,"GetTop","SetTop"),t.addProperty("Visible",2,rtl.boolean,"FVisible","SetVisible",{Default:!0}),t.addProperty("Width",3,rtl.longint,"GetWidth","SetWidth"),t.addProperty("WidthPercent",2,rtl.double,"FWidthPercent","SetWidthPercent",{Default:100}),t.addProperty("WidthStyle",2,pas["WEBLib.Controls"].$rtti.TSizeStyle,"FWidthStyle","SetWidthStyle",{Default:pas["WEBLib.Controls"].TSizeStyle.ssAbsolute}),t.addProperty("OnClick",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnClick","FOnClick"),t.addProperty("OnKeyDown",0,pas["WEBLib.Controls"].$rtti.TKeyEvent,"FOnKeyDown","FOnKeyDown"),t.addProperty("OnKeyPress",0,pas["WEBLib.Controls"].$rtti.TKeyPressEvent,"FOnKeyPress","FOnKeyPress"),t.addProperty("OnKeyUp",0,pas["WEBLib.Controls"].$rtti.TKeyEvent,"FOnKeyUp","FOnKeyUp"),t.addProperty("OnMouseDown",0,pas["WEBLib.Controls"].$rtti.TMouseEvent,"FOnMouseDown","FOnMouseDown"),t.addProperty("OnMouseUp",0,pas["WEBLib.Controls"].$rtti.TMouseEvent,"FOnMouseUp","FOnMouseUp"),t.addProperty("OnMouseMove",0,pas["WEBLib.Controls"].$rtti.TMouseMoveEvent,"FOnMouseMove","FOnMouseMove"),t.addProperty("OnMouseLeave",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnMouseLeave","FOnMouseLeave"),t.addProperty("OnMouseEnter",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnMouseEnter","FOnMouseEnter"),t.addProperty("OnEnter",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnEnter","FOnEnter"),t.addProperty("OnExit",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnExit","FOnExit"),t.addProperty("OnDragDrop",0,pas["WEBLib.Controls"].$rtti.TDragDropEvent,"FOnDragDrop","FOnDragDrop"),t.addProperty("OnDragOver",0,pas["WEBLib.Controls"].$rtti.TDragOverEvent,"FOnDragOver","FOnDragOver"),t.addProperty("OnEndDrag",0,pas["WEBLib.Controls"].$rtti.TEndDragEvent,"FonEndDrag","FonEndDrag"),t.addProperty("OnStartDrag",0,pas["WEBLib.Controls"].$rtti.TStartDragEvent,"FOnStartDrag","FOnStartDrag")})),rtl.createClass(this,"TWebButton",this.TButton,(function(){rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TCheckBox",pas["WEBLib.Menus"].TWebCustomControl,(function(){this.$init=function(){pas["WEBLib.Menus"].TWebCustomControl.$init.call(this),this.FChecked=!1,this.FState=0,this.FElementButtonClassName="",this.FElementLabelClassName="",this.FOnCheckClick=null},this.$final=function(){this.FOnCheckClick=void 0,pas["WEBLib.Menus"].TWebCustomControl.$final.call(this)},this.Loaded=function(){pas["WEBLib.Controls"].TCustomControl.Loaded.call(this),null!=this.GetContainer()&&(this.GetIsLinked()||(this.GetContainer().children.item(1).onclick=rtl.createSafeCallback(this,"HandleLabelClick")))},this.UpdateElementData=function(){var t=null;pas["WEBLib.Controls"].TControl.UpdateElementData.call(this),null!=this.GetContainer()&&((t=this.GetCheckElement()).disabled=!this.IsEnabled(),t.checked=this.FChecked,t.indeterminate=1===this.GetState(),this.GetIsLinked()||(""!==this.FCaption&&(this.GetContainer().lastElementChild.innerHTML=this.FCaption),this.GetElementHandle().setAttribute("tabindex","-1"),this.GetElementHandle().firstChild.setAttribute("tabindex","-1")),this.FTabStop&&this.GetContainer().setAttribute("tabindex",pas.SysUtils.IntToStr(this.FTabOrder)))},this.UpdateElementSize=function(){pas["WEBLib.Controls"].TControl.UpdateElementSize.call(this),null==this.GetContainer()||this.GetIsLinked()||0!==this.FElementPosition||(2!==this.FHeightStyle?this.GetContainer().firstElementChild.style.setProperty("height","100%"):this.GetContainer().firstElementChild.style.removeProperty("height"))},this.UpdateElementVisual=function(){var t=null,e=null,i=null,s=!1;pas["WEBLib.Controls"].TCustomControl.UpdateElementVisual.call(this),null!=this.GetElementHandle()&&(null!=(t=this.GetElementHandle().firstChild)&&(null!=t.style&&t.style.setProperty("margin-right","4px"),""!==this.FElementButtonClassName?t.setAttribute("class",this.FElementButtonClassName):t.removeAttribute("class")),null!=(e=this.GetElementHandle().lastElementChild)&&(""!==this.FElementLabelClassName?e.setAttribute("class",this.FElementLabelClassName):e.removeAttribute("class")),this.FTabStop&&this.FShowFocus&&""===this.FElementClassName||this.GetElementHandle().style.setProperty("outline","none"),this.GetIsLinked()||(this.GetElementHandle().style.setProperty("user-select","none"),0===this.FElementPosition&&(""===this.FElementButtonClassName&&(t.style.setProperty("float","left"),2===this.FHeightStyle?t.style.removeProperty("height"):0===this.FElementPosition&&t.style.setProperty("height","100%"),t.style.setProperty("vertical-align","middle"),t.style.setProperty("margin-top","0px"),t.style.setProperty("margin-bottom","0px")),s=null!=(i=pas["WEBLib.Forms"].GetParentForm(this))&&1===i.FCSSLibrary,(""===this.FElementLabelClassName||s)&&((e=this.GetContainer().lastElementChild).style.setProperty("vertical-align","middle"),e.style.setProperty("min-height","100%"),e.style.setProperty("height","100%"),e.style.setProperty("position","absolute"),e.style.setProperty("overflow","hidden"),e.style.setProperty("display","inline-flex"),e.style.setProperty("align-items","center")))))},this.CreateElement=function(){var t=null,e=null,i=null;return t=document.createElement("SPAN"),e=document.createElement("INPUT"),i=document.createElement("SPAN"),e.setAttribute("TYPE","CHECKBOX"),e.setAttribute("id",this.GetID()),e.setAttribute("role","checkbox"),i.setAttribute("id",this.GetID()+"lbl"),i.setAttribute("value",this.GetID()),t.appendChild(e),t.appendChild(i),rtl.asExt(e,HTMLInputElement).onclick=rtl.createSafeCallback(this,"HandleCheckClick"),t},this.SetChecked=function(t){this.FChecked=t,this.FState=t?0:2,this.UpdateElement()},this.GetChecked=function(){return null!=this.GetContainer()&&(this.FChecked=this.GetCheckElement().checked),this.FChecked},this.SetState=function(t){this.FState=t,this.FChecked=0===this.FState,this.UpdateElement()},this.GetState=function(){return this.FState},this.SetCaption=function(t){this.FCaption!==t&&(pas["WEBLib.Controls"].TCustomControl.SetCaption.call(this,t),null!=this.GetContainer()&&(this.GetIsLinked()?null!=this.GetContainer().lastElementChild&&"SPAN"===this.GetContainer().lastElementChild.tagName&&(this.GetContainer().lastElementChild.innerHTML=t):null!=this.GetContainer().lastElementChild&&(this.GetContainer().lastElementChild.innerHTML=t)))},this.SetEnabled=function(t){pas["WEBLib.Controls"].TControl.SetEnabled.apply(this,arguments),null!=this.GetContainer()&&(this.GetCheckElement().disabled=!t)},this.HandleLabelClick=function(t){var e=null;return null!=this.GetContainer()&&this.FEnabled&&((e=this.GetCheckElement()).checked=!e.checked,this.SetChecked(e.checked)),this.DoCheckClick(),!0,!0},this.HandleCheckClick=function(t){return this.DoCheckClick(),!0,!0},this.Click=function(){pas["WEBLib.Controls"].TControl.Click.call(this),this.FChecked=this.GetChecked(),this.FChecked?this.FState=0:this.FState=2,this.SetFocus()},this.DoCheckClick=function(){null!=this.FOnCheckClick&&this.FOnCheckClick(this)},this.GetCheckElement=function(){return this.GetIsLinked()&&"INPUT"===this.GetElementHandle().tagName?this.GetElementHandle():this.GetContainer().firstElementChild},this.KeyPress=function(t){var e=null;pas["WEBLib.Controls"].TControl.KeyPress.apply(this,arguments)," "===t.get()&&null!=this.GetContainer()&&((e=this.GetCheckElement()).checked=!e.checked)},this.CreateInitialize=function(){pas["WEBLib.Controls"].TCustomControl.CreateInitialize.call(this),this.SetColor(-1),this.FChecked=!1,this.FState=2,4 in this.FComponentState&&""===this.FCaption&&this.SetCaption(this.FName),this.SetShowFocus(!0)},rtl.addIntf(this,pas.System.IUnknown);var e=this.$rtti;e.addProperty("Align",2,pas["WEBLib.Controls"].$rtti.TAlign,"FAlign","SetAlign",{Default:pas["WEBLib.Controls"].TAlign.alNone}),e.addProperty("AlignWithMargins",2,rtl.boolean,"FAlignWithMargins","SetAlignWithMargins",{Default:!1}),e.addProperty("Anchors",2,pas["WEBLib.Controls"].$rtti.TAnchors,"FAnchors","SetAnchors",{Default:rtl.createSet(0,1)}),e.addProperty("Caption",2,rtl.string,"FCaption","SetCaption"),e.addProperty("Checked",3,rtl.boolean,"GetChecked","SetChecked",{Default:!1}),e.addProperty("ChildOrder",2,rtl.longint,"FChildOrder","SetChildOrderEx",{Default:0}),e.addProperty("Color",2,pas["WEBLib.Graphics"].$rtti.TColor,"FColor","SetColor",{Default:-1}),e.addProperty("DragMode",2,pas["WEBLib.Controls"].$rtti.TDragMode,"FDragMode","SetDragMode",{Default:pas["WEBLib.Controls"].TDragMode.dmManual}),e.addProperty("ElementClassName",2,pas["WEBLib.Controls"].$rtti.TElementClassName,"FElementClassName","SetElementClassName"),e.addProperty("ElementButtonClassName",0,pas["WEBLib.Controls"].$rtti.TElementClassName,"FElementButtonClassName","FElementButtonClassName"),e.addProperty("ElementLabelClassName",0,pas["WEBLib.Controls"].$rtti.TElementClassName,"FElementLabelClassName","FElementLabelClassName"),e.addProperty("ElementID",3,pas["WEBLib.Controls"].$rtti.TElementID,"GetID","SetID"),e.addProperty("ElementFont",2,pas["WEBLib.Controls"].$rtti.TElementFont,"FElementFont","SetElementFont",{Default:pas["WEBLib.Controls"].TElementFont.efProperty}),e.addProperty("ElementPosition",2,pas["WEBLib.Controls"].$rtti.TElementPosition,"FElementPosition","SetElementPosition",{Default:pas["WEBLib.Controls"].TElementPosition.epAbsolute}),e.addProperty("Enabled",2,rtl.boolean,"FEnabled","SetEnabled",{Default:!0}),e.addProperty("Font",2,pas["WEBLib.Graphics"].$rtti.TFont,"FFont","SetFont"),e.addProperty("Height",3,rtl.longint,"GetHeight","SetHeight"),e.addProperty("HeightPercent",2,rtl.double,"FHeightPercent","SetHeightPercent",{Default:100}),e.addProperty("HeightStyle",2,pas["WEBLib.Controls"].$rtti.TSizeStyle,"FHeightStyle","SetHeightStyle",{Default:pas["WEBLib.Controls"].TSizeStyle.ssAbsolute}),e.addProperty("Hint",2,rtl.string,"FHint","SetHint"),e.addProperty("Left",3,rtl.longint,"GetLeft","SetLeft"),e.addProperty("Margins",2,pas["WEBLib.Controls"].$rtti.TMargins,"FMargins","SetMargins"),e.addProperty("ParentFont",2,rtl.boolean,"FParentFont","SetParentFont",{Default:!0}),e.addProperty("PopupMenu",0,pas["WEBLib.Menus"].$rtti.TPopupMenu,"FPopupMenu","FPopupMenu"),e.addProperty("Role",3,rtl.string,"GetRole","SetRole"),e.addProperty("ShowFocus",2,rtl.boolean,"FShowFocus","SetShowFocus",{Default:!1}),e.addProperty("ShowHint",2,rtl.boolean,"FShowHint","SetShowHint",{Default:!1}),e.addProperty("State",3,t.$rtti.TCheckBoxState,"GetState","SetState",{Default:t.TCheckBoxState.cbUnchecked}),e.addProperty("TabOrder",2,rtl.longint,"FTabOrder","SetTabOrder"),e.addProperty("TabStop",2,rtl.boolean,"FTabStop","SetTabStop",{Default:!0}),e.addProperty("Top",3,rtl.longint,"GetTop","SetTop"),e.addProperty("Visible",2,rtl.boolean,"FVisible","SetVisible",{Default:!0}),e.addProperty("Width",3,rtl.longint,"GetWidth","SetWidth"),e.addProperty("WidthPercent",2,rtl.double,"FWidthPercent","SetWidthPercent",{Default:100}),e.addProperty("WidthStyle",2,pas["WEBLib.Controls"].$rtti.TSizeStyle,"FWidthStyle","SetWidthStyle",{Default:pas["WEBLib.Controls"].TSizeStyle.ssAbsolute}),e.addProperty("OnClick",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnClick","FOnClick"),e.addProperty("OnKeyDown",0,pas["WEBLib.Controls"].$rtti.TKeyEvent,"FOnKeyDown","FOnKeyDown"),e.addProperty("OnKeyPress",0,pas["WEBLib.Controls"].$rtti.TKeyPressEvent,"FOnKeyPress","FOnKeyPress"),e.addProperty("OnKeyUp",0,pas["WEBLib.Controls"].$rtti.TKeyEvent,"FOnKeyUp","FOnKeyUp"),e.addProperty("OnMouseDown",0,pas["WEBLib.Controls"].$rtti.TMouseEvent,"FOnMouseDown","FOnMouseDown"),e.addProperty("OnMouseUp",0,pas["WEBLib.Controls"].$rtti.TMouseEvent,"FOnMouseUp","FOnMouseUp"),e.addProperty("OnMouseMove",0,pas["WEBLib.Controls"].$rtti.TMouseMoveEvent,"FOnMouseMove","FOnMouseMove"),e.addProperty("OnMouseLeave",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnMouseLeave","FOnMouseLeave"),e.addProperty("OnMouseEnter",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnMouseEnter","FOnMouseEnter"),e.addProperty("OnEnter",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnEnter","FOnEnter"),e.addProperty("OnExit",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnExit","FOnExit"),e.addProperty("OnDragDrop",0,pas["WEBLib.Controls"].$rtti.TDragDropEvent,"FOnDragDrop","FOnDragDrop"),e.addProperty("OnDragOver",0,pas["WEBLib.Controls"].$rtti.TDragOverEvent,"FOnDragOver","FOnDragOver"),e.addProperty("OnEndDrag",0,pas["WEBLib.Controls"].$rtti.TEndDragEvent,"FonEndDrag","FonEndDrag"),e.addProperty("OnStartDrag",0,pas["WEBLib.Controls"].$rtti.TStartDragEvent,"FOnStartDrag","FOnStartDrag")})),rtl.createClass(this,"TWebCheckBox",this.TCheckBox,(function(){rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TRadioButton",pas["WEBLib.Menus"].TWebCustomControl,(function(){this.$init=function(){pas["WEBLib.Menus"].TWebCustomControl.$init.call(this),this.FChecked=!1,this.FGroupName="",this.FElementButtonClassName="",this.FElementLabelClassName=""},this.CreateElement=function(){var t=null,e=null,i=null;return t=document.createElement("SPAN"),e=document.createElement("INPUT"),i=document.createElement("SPAN"),t.addEventListener("click",rtl.createCallback(this,"HandleLabelClick")),e.setAttribute("TYPE","RADIO"),e.setAttribute("id",this.GetID()+"rd"),e.setAttribute("name",this.FGroupName),e.setAttribute("role","radio"),e.setAttribute("tabindex","-1"),e.addEventListener("click",rtl.createCallback(this,"HandleRadioClick")),i.setAttribute("id",this.GetID()+"lbl"),i.setAttribute("value",this.GetID()),t.appendChild(e),t.appendChild(i),t},this.SetChecked=function(t){this.FChecked=t,null!=this.GetContainer()&&(this.GetRadioElement().checked=t)},this.GetChecked=function(){var t=!1;return t=this.FChecked,null!=this.GetContainer()&&(t=this.GetRadioElement().checked),t},this.SetEnabled=function(t){pas["WEBLib.Controls"].TControl.SetEnabled.apply(this,arguments),null!=this.GetContainer()&&(this.GetRadioElement().disabled=!t)},this.SetCaption=function(t){this.FCaption!==t&&(pas["WEBLib.Controls"].TCustomControl.SetCaption.call(this,t),null==this.GetContainer()||this.GetIsLinked()||(this.GetContainer().lastElementChild.innerHTML=t))},this.SetGroupName=function(t){this.FGroupName=t,this.UpdateElementData()},this.HandleLabelClick=function(t){return null!=this.GetContainer()&&this.FEnabled&&(this.GetRadioElement().checked=!0),!0,!0},this.HandleRadioClick=function(t){return this.SetFocus(),!0,!0},this.UpdateElementSize=function(){pas["WEBLib.Controls"].TControl.UpdateElementSize.call(this),null==this.GetContainer()||this.GetIsLinked()||(2!==this.FHeightStyle?this.GetContainer().firstElementChild.style.setProperty("height","100%"):this.GetContainer().firstElementChild.style.removeProperty("height"))},this.UpdateElementData=function(){var t=null;pas["WEBLib.Controls"].TControl.UpdateElementData.call(this),null!=this.GetContainer()&&(this.GetIsLinked()?this.GetElementHandle().setAttribute("name",this.FGroupName):(this.GetContainer().firstElementChild.setAttribute("name",this.FGroupName),(t=this.GetElementHandle().firstChild).disabled=!this.FEnabled),this.GetIsLinked()||(""!==this.FCaption&&(this.GetContainer().lastElementChild.innerHTML=this.FCaption),this.GetElementHandle().setAttribute("tabindex","-1"),this.FTabStop&&null!=t&&t.setAttribute("tabindex","-1")),this.FTabStop&&this.GetContainer().setAttribute("tabindex",pas.SysUtils.IntToStr(this.FTabOrder)))},this.UpdateElementVisual=function(){var e=null,i=null,s=!1,o=null;pas["WEBLib.Controls"].TCustomControl.UpdateElementVisual.call(this),null!=this.GetElementHandle()&&(this.GetIsLinked()||((e=this.GetElementHandle().firstChild).style.setProperty("margin-right","4px"),null!=e&&(""!==this.FElementButtonClassName?e.setAttribute("class",this.FElementButtonClassName):e.removeAttribute("class")),null!=(i=this.GetElementHandle().lastElementChild)&&(""!==this.FElementLabelClassName?i.setAttribute("class",this.FElementLabelClassName):i.removeAttribute("class"))),this.FTabStop&&this.FShowFocus&&""===this.FElementClassName||this.GetElementHandle().style.setProperty("outline","none"),this.GetIsLinked()||(this.GetElementHandle().style.setProperty("user-select","none"),this.GetElementHandle().style.setProperty("white-space","normal"),0===this.FElementPosition&&(""===this.FElementButtonClassName&&(e.style.setProperty("float","left"),2!==this.FHeightStyle?e.style.setProperty("height","100%"):e.style.removeProperty("height"),e.style.setProperty("vertical-align","middle"),e.style.setProperty("margin-top","0px"),e.style.setProperty("margin-bottom","0px")),s=null!=(o=pas["WEBLib.Forms"].GetParentForm(this))&&1===o.FCSSLibrary,(""===this.FElementLabelClassName||s)&&((i=this.GetContainer().lastElementChild).style.setProperty("vertical-align","middle"),i.style.setProperty("min-height","100%"),i.style.setProperty("height","100%"),t.TRadioGroup.isPrototypeOf(this.FParent)||i.style.setProperty("position","absolute"),i.style.setProperty("overflow","hidden"),i.style.setProperty("display","inline-flex"),i.style.setProperty("align-items","center")))))},this.GetRadioElement=function(){return this.GetIsLinked()?this.GetElementHandle():this.GetContainer().firstElementChild},this.KeyPress=function(t){pas["WEBLib.Controls"].TControl.KeyPress.apply(this,arguments)," "===t.get()&&(this.GetRadioElement().checked=!0)},this.CreateInitialize=function(){pas["WEBLib.Controls"].TCustomControl.CreateInitialize.call(this),this.SetColor(-1),4 in this.FComponentState&&""===this.FCaption&&this.SetCaption(this.FName),this.FGroupName="",this.SetShowFocus(!0)},rtl.addIntf(this,pas.System.IUnknown);var e=this.$rtti;e.addProperty("Align",2,pas["WEBLib.Controls"].$rtti.TAlign,"FAlign","SetAlign",{Default:pas["WEBLib.Controls"].TAlign.alNone}),e.addProperty("AlignWithMargins",2,rtl.boolean,"FAlignWithMargins","SetAlignWithMargins",{Default:!1}),e.addProperty("Anchors",2,pas["WEBLib.Controls"].$rtti.TAnchors,"FAnchors","SetAnchors",{Default:rtl.createSet(0,1)}),e.addProperty("Caption",2,rtl.string,"FCaption","SetCaption"),e.addProperty("Checked",3,rtl.boolean,"GetChecked","SetChecked",{Default:!1}),e.addProperty("ChildOrder",2,rtl.longint,"FChildOrder","SetChildOrderEx",{Default:0}),e.addProperty("Color",2,pas["WEBLib.Graphics"].$rtti.TColor,"FColor","SetColor",{Default:-1}),e.addProperty("DragMode",2,pas["WEBLib.Controls"].$rtti.TDragMode,"FDragMode","SetDragMode",{Default:pas["WEBLib.Controls"].TDragMode.dmManual}),e.addProperty("ElementClassName",2,pas["WEBLib.Controls"].$rtti.TElementClassName,"FElementClassName","SetElementClassName"),e.addProperty("ElementButtonClassName",0,pas["WEBLib.Controls"].$rtti.TElementClassName,"FElementButtonClassName","FElementButtonClassName"),e.addProperty("ElementLabelClassName",0,pas["WEBLib.Controls"].$rtti.TElementClassName,"FElementLabelClassName","FElementLabelClassName"),e.addProperty("ElementID",3,pas["WEBLib.Controls"].$rtti.TElementID,"GetID","SetID"),e.addProperty("ElementFont",2,pas["WEBLib.Controls"].$rtti.TElementFont,"FElementFont","SetElementFont",{Default:pas["WEBLib.Controls"].TElementFont.efProperty}),e.addProperty("ElementPosition",2,pas["WEBLib.Controls"].$rtti.TElementPosition,"FElementPosition","SetElementPosition",{Default:pas["WEBLib.Controls"].TElementPosition.epAbsolute}),e.addProperty("Enabled",2,rtl.boolean,"FEnabled","SetEnabled",{Default:!0}),e.addProperty("Font",2,pas["WEBLib.Graphics"].$rtti.TFont,"FFont","SetFont"),e.addProperty("GroupName",2,rtl.string,"FGroupName","SetGroupName"),e.addProperty("Height",3,rtl.longint,"GetHeight","SetHeight"),e.addProperty("HeightPercent",2,rtl.double,"FHeightPercent","SetHeightPercent",{Default:100}),e.addProperty("HeightStyle",2,pas["WEBLib.Controls"].$rtti.TSizeStyle,"FHeightStyle","SetHeightStyle",{Default:pas["WEBLib.Controls"].TSizeStyle.ssAbsolute}),e.addProperty("Hint",2,rtl.string,"FHint","SetHint"),e.addProperty("Left",3,rtl.longint,"GetLeft","SetLeft"),e.addProperty("ParentFont",2,rtl.boolean,"FParentFont","SetParentFont",{Default:!0}),e.addProperty("PopupMenu",0,pas["WEBLib.Menus"].$rtti.TPopupMenu,"FPopupMenu","FPopupMenu"),e.addProperty("Role",3,rtl.string,"GetRole","SetRole"),e.addProperty("ShowFocus",2,rtl.boolean,"FShowFocus","SetShowFocus",{Default:!1}),e.addProperty("ShowHint",2,rtl.boolean,"FShowHint","SetShowHint",{Default:!1}),e.addProperty("TabOrder",2,rtl.longint,"FTabOrder","SetTabOrder"),e.addProperty("TabStop",2,rtl.boolean,"FTabStop","SetTabStop",{Default:!0}),e.addProperty("Visible",2,rtl.boolean,"FVisible","SetVisible",{Default:!0}),e.addProperty("Width",3,rtl.longint,"GetWidth","SetWidth"),e.addProperty("WidthPercent",2,rtl.double,"FWidthPercent","SetWidthPercent",{Default:100}),e.addProperty("WidthStyle",2,pas["WEBLib.Controls"].$rtti.TSizeStyle,"FWidthStyle","SetWidthStyle",{Default:pas["WEBLib.Controls"].TSizeStyle.ssAbsolute}),e.addProperty("OnClick",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnClick","FOnClick"),e.addProperty("OnDblClick",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnDblClick","FOnDblClick"),e.addProperty("OnKeyDown",0,pas["WEBLib.Controls"].$rtti.TKeyEvent,"FOnKeyDown","FOnKeyDown"),e.addProperty("OnKeyPress",0,pas["WEBLib.Controls"].$rtti.TKeyPressEvent,"FOnKeyPress","FOnKeyPress"),e.addProperty("OnKeyUp",0,pas["WEBLib.Controls"].$rtti.TKeyEvent,"FOnKeyUp","FOnKeyUp"),e.addProperty("OnMouseDown",0,pas["WEBLib.Controls"].$rtti.TMouseEvent,"FOnMouseDown","FOnMouseDown"),e.addProperty("OnMouseUp",0,pas["WEBLib.Controls"].$rtti.TMouseEvent,"FOnMouseUp","FOnMouseUp"),e.addProperty("OnMouseMove",0,pas["WEBLib.Controls"].$rtti.TMouseMoveEvent,"FOnMouseMove","FOnMouseMove"),e.addProperty("OnMouseLeave",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnMouseLeave","FOnMouseLeave"),e.addProperty("OnMouseEnter",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnMouseEnter","FOnMouseEnter"),e.addProperty("OnEnter",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnEnter","FOnEnter"),e.addProperty("OnExit",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnExit","FOnExit"),e.addProperty("OnDragDrop",0,pas["WEBLib.Controls"].$rtti.TDragDropEvent,"FOnDragDrop","FOnDragDrop"),e.addProperty("OnDragOver",0,pas["WEBLib.Controls"].$rtti.TDragOverEvent,"FOnDragOver","FOnDragOver"),e.addProperty("OnEndDrag",0,pas["WEBLib.Controls"].$rtti.TEndDragEvent,"FonEndDrag","FonEndDrag"),e.addProperty("OnStartDrag",0,pas["WEBLib.Controls"].$rtti.TStartDragEvent,"FOnStartDrag","FOnStartDrag")})),rtl.createClass(this,"TWebRadioButton",this.TRadioButton,(function(){rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TListBox",pas["WEBLib.Menus"].TWebCustomControl,(function(){this.$init=function(){pas["WEBLib.Menus"].TWebCustomControl.$init.call(this),this.FItems=null,this.FItemIndex=0,this.FMultiSelect=!1,this.FSelected=null,this.FItemHeight=0,this.FSorted=!1,this.FOnChange=null,this.FHandleChangePtr=null,this.FElementItemClassName=""},this.$final=function(){this.FItems=void 0,this.FSelected=void 0,this.FOnChange=void 0,pas["WEBLib.Menus"].TWebCustomControl.$final.call(this)},this.SetItemHeight=function(t){this.FItemHeight=t},this.SetSorted=function(t){this.FSorted=t,this.FItems.Sort()},this.GetCount=function(){return this.FItems.GetCount()},this.GetElementSelectHandle=function(){return this.GetContainer()},this.DoHandleChange=function(t){return this.Change(),!0,!0},this.DoItemsChange=function(t){this.DoUpdateList()},this.DoUpdateList=function(){var t=0,e=null;if(null!=this.GetContainer()&&!this.IsUpdating()&&"SELECT"===this.GetElementHandle().tagName){for(var i=this.GetContainer().options.length-1;i>=0;i--)t=i,this.GetContainer().remove(t);for(var s=0,o=this.FItems.GetCount()-1;s<=o;s++)t=s,(e=new Option(this.FItems.Get(t))).setAttribute("role","listitem"),""!==this.FElementItemClassName&&e.setAttribute("class",this.FElementItemClassName),1===this.FDragMode&&e.setAttribute("draggable","true"),this.GetContainer().add(e),this.SetSelected(t,!1);this.UpdateElementData()}},this.GetItemIndex=function(){var t=0;return t=this.FItemIndex,null!=this.GetContainer()&&(t=this.GetContainer().selectedIndex),t},this.CreateElement=function(){var t=null;return(t=document.createElement("SELECT")).setAttribute("Size","2"),t},this.SetSelected=function(t,e){for(;t>=this.FSelected.GetCount();)this.FSelected.Add(!1);this.FSelected.Put(t,e),null!=this.GetContainer()&&(this.GetContainer().options.item(t).selected=e)},this.SetItems=function(t){this.FItems.Assign(t)},this.SetItemIndex=function(t){this.FItemIndex!==t&&(this.FItemIndex=t,this.UpdateElement())},this.SetMultiSelect=function(t){this.FMultiSelect=t,null!=this.GetContainer()&&(this.GetContainer().multiple=t)},this.Loaded=function(){pas["WEBLib.Controls"].TCustomControl.Loaded.call(this),this.DoUpdateList(),this.UpdateElement()},this.UpdateElementData=function(){pas["WEBLib.Controls"].TControl.UpdateElementData.call(this),null!=this.GetElementSelectHandle()&&(this.GetElementSelectHandle().style.setProperty("overflow","auto"),this.GetElementSelectHandle().selectedIndex=this.FItemIndex)},this.UpdateElementVisual=function(){pas["WEBLib.Controls"].TCustomControl.UpdateElementVisual.call(this),null!=this.GetElementSelectHandle()&&(this.GetElementSelectHandle().style.setProperty("overflow","auto"),this.GetElementSelectHandle().setAttribute("role","listbox"),this.GetElementSelectHandle().setAttribute("aria-busy","true"))},this.UpdateParent=function(){pas["WEBLib.Controls"].TControl.UpdateParent.call(this),this.DoUpdateList()},this.BindEvents=function(){pas["WEBLib.Controls"].TCustomControl.BindEvents.call(this),null!=this.GetElementHandle()&&this.GetElementHandle().addEventListener("change",this.FHandleChangePtr)},this.UnbindEvents=function(){pas["WEBLib.Controls"].TControl.UnbindEvents.call(this),null!=this.GetElementHandle()&&this.GetElementHandle().removeEventListener("change",this.FHandleChangePtr)},this.Change=function(){null!=this.FOnChange&&this.FOnChange(this)},this.EnableDrag=function(){var t=0;if(null!=this.GetContainer())for(var e=0,i=this.GetContainer().options.length-1;e<=i;e++)t=e,this.GetContainer().options.item(t).setAttribute("draggable","true")},this.DisableDrag=function(){var t=0;if(null!=this.GetContainer())for(var e=0,i=this.GetContainer().options.length-1;e<=i;e++)t=e,this.GetContainer().options.item(t).setAttribute("draggable","false")},this.ClearMethodPointers=function(){pas["WEBLib.Controls"].TControl.ClearMethodPointers.call(this),this.FHandleChangePtr=null},this.GetMethodPointers=function(){pas["WEBLib.Controls"].TControl.GetMethodPointers.call(this),this.FHandleChangePtr=rtl.createCallback(this,"DoHandleChange")},this.CreateInitialize=function(){pas["WEBLib.Controls"].TCustomControl.CreateInitialize.call(this),this.FItems=pas.Classes.TStringList.$create("Create$1"),this.FItems.SetSkipLastLineBreak(!0),this.FItems.FOnChange=rtl.createCallback(this,"DoItemsChange"),this.FMultiSelect=!1,this.FSelected=pas.Classes.TList.$create("Create$1"),this.FItemIndex=-1,this.SetShowFocus(!0),4 in this.FComponentState&&(this.SetWidth(160),this.SetHeight(180))},this.Destroy=function(){rtl.free(this,"FItems"),rtl.free(this,"FSelected"),pas["WEBLib.Controls"].TCustomControl.Destroy.call(this)},this.EndUpdate=function(){pas["WEBLib.Controls"].TCustomControl.EndUpdate.call(this),this.DoUpdateList()},rtl.addIntf(this,pas.System.IUnknown);var t=this.$rtti;t.addProperty("Align",2,pas["WEBLib.Controls"].$rtti.TAlign,"FAlign","SetAlign",{Default:pas["WEBLib.Controls"].TAlign.alNone}),t.addProperty("AlignWithMargins",2,rtl.boolean,"FAlignWithMargins","SetAlignWithMargins",{Default:!1}),t.addProperty("Anchors",2,pas["WEBLib.Controls"].$rtti.TAnchors,"FAnchors","SetAnchors",{Default:rtl.createSet(0,1)}),t.addProperty("BiDiMode",2,pas["WEBLib.Controls"].$rtti.TBiDiMode,"FBiDiMode","SetBiDiMode",{Default:pas["WEBLib.Controls"].TBiDiMode.bdLeftToRight}),t.addProperty("BorderStyle",2,pas["WEBLib.Controls"].$rtti.TBorderStyle,"FBorderStyle","SetBorderStyle",{Default:pas["WEBLib.Controls"].TBorderStyle.bsSingle}),t.addProperty("ChildOrder",2,rtl.longint,"FChildOrder","SetChildOrderEx",{Default:0}),t.addProperty("Color",2,pas["WEBLib.Graphics"].$rtti.TColor,"FColor","SetColor"),t.addProperty("DragMode",2,pas["WEBLib.Controls"].$rtti.TDragMode,"FDragMode","SetDragMode",{Default:pas["WEBLib.Controls"].TDragMode.dmManual}),t.addProperty("Font",2,pas["WEBLib.Graphics"].$rtti.TFont,"FFont","SetFont"),t.addProperty("ElementClassName",2,pas["WEBLib.Controls"].$rtti.TElementClassName,"FElementClassName","SetElementClassName"),t.addProperty("ElementItemClassName",0,rtl.string,"FElementItemClassName","FElementItemClassName"),t.addProperty("ElementID",3,pas["WEBLib.Controls"].$rtti.TElementID,"GetID","SetID"),t.addProperty("ElementFont",2,pas["WEBLib.Controls"].$rtti.TElementFont,"FElementFont","SetElementFont",{Default:pas["WEBLib.Controls"].TElementFont.efProperty}),t.addProperty("ElementPosition",2,pas["WEBLib.Controls"].$rtti.TElementPosition,"FElementPosition","SetElementPosition",{Default:pas["WEBLib.Controls"].TElementPosition.epAbsolute}),t.addProperty("Enabled",2,rtl.boolean,"FEnabled","SetEnabled",{Default:!0}),t.addProperty("Height",3,rtl.longint,"GetHeight","SetHeight"),t.addProperty("HeightPercent",2,rtl.double,"FHeightPercent","SetHeightPercent",{Default:100}),t.addProperty("HeightStyle",2,pas["WEBLib.Controls"].$rtti.TSizeStyle,"FHeightStyle","SetHeightStyle",{Default:pas["WEBLib.Controls"].TSizeStyle.ssAbsolute}),t.addProperty("Hint",2,rtl.string,"FHint","SetHint"),t.addProperty("ItemHeight",2,rtl.longint,"FItemHeight","SetItemHeight"),t.addProperty("ItemIndex",3,rtl.longint,"GetItemIndex","SetItemIndex",{Default:-1}),t.addProperty("Items",2,pas.Classes.$rtti.TStrings,"FItems","SetItems"),t.addProperty("Left",3,rtl.longint,"GetLeft","SetLeft"),t.addProperty("MultiSelect",2,rtl.boolean,"FMultiSelect","SetMultiSelect"),t.addProperty("ParentColor",2,rtl.boolean,"FParentColor","SetParentColor",{Default:!1}),t.addProperty("ParentFont",2,rtl.boolean,"FParentFont","SetParentFont",{Default:!0}),t.addProperty("PopupMenu",0,pas["WEBLib.Menus"].$rtti.TPopupMenu,"FPopupMenu","FPopupMenu"),t.addProperty("Role",3,rtl.string,"GetRole","SetRole"),t.addProperty("ShowFocus",2,rtl.boolean,"FShowFocus","SetShowFocus",{Default:!1}),t.addProperty("ShowHint",2,rtl.boolean,"FShowHint","SetShowHint",{Default:!1}),t.addProperty("TabOrder",2,rtl.longint,"FTabOrder","SetTabOrder"),t.addProperty("TabStop",2,rtl.boolean,"FTabStop","SetTabStop",{Default:!0}),t.addProperty("TextDirection",0,pas["WEBLib.Controls"].$rtti.TTextDirection,"FTextDirection","FTextDirection",{Default:pas["WEBLib.Controls"].TTextDirection.tdDefault}),t.addProperty("Top",3,rtl.longint,"GetTop","SetTop"),t.addProperty("Visible",2,rtl.boolean,"FVisible","SetVisible",{Default:!0}),t.addProperty("Width",3,rtl.longint,"GetWidth","SetWidth"),t.addProperty("WidthPercent",2,rtl.double,"FWidthPercent","SetWidthPercent",{Default:100}),t.addProperty("WidthStyle",2,pas["WEBLib.Controls"].$rtti.TSizeStyle,"FWidthStyle","SetWidthStyle",{Default:pas["WEBLib.Controls"].TSizeStyle.ssAbsolute}),t.addProperty("OnChange",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnChange","FOnChange"),t.addProperty("OnClick",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnClick","FOnClick"),t.addProperty("OnDblClick",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnDblClick","FOnDblClick"),t.addProperty("OnKeyDown",0,pas["WEBLib.Controls"].$rtti.TKeyEvent,"FOnKeyDown","FOnKeyDown"),t.addProperty("OnKeyPress",0,pas["WEBLib.Controls"].$rtti.TKeyPressEvent,"FOnKeyPress","FOnKeyPress"),t.addProperty("OnKeyUp",0,pas["WEBLib.Controls"].$rtti.TKeyEvent,"FOnKeyUp","FOnKeyUp"),t.addProperty("OnMouseDown",0,pas["WEBLib.Controls"].$rtti.TMouseEvent,"FOnMouseDown","FOnMouseDown"),t.addProperty("OnMouseUp",0,pas["WEBLib.Controls"].$rtti.TMouseEvent,"FOnMouseUp","FOnMouseUp"),t.addProperty("OnMouseMove",0,pas["WEBLib.Controls"].$rtti.TMouseMoveEvent,"FOnMouseMove","FOnMouseMove"),t.addProperty("OnMouseLeave",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnMouseLeave","FOnMouseLeave"),t.addProperty("OnMouseEnter",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnMouseEnter","FOnMouseEnter"),t.addProperty("OnMouseWheel",0,pas["WEBLib.Controls"].$rtti.TMouseWheelEvent,"FOnMouseWheel","FOnMouseWheel"),t.addProperty("OnEnter",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnEnter","FOnEnter"),t.addProperty("OnExit",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnExit","FOnExit"),t.addProperty("OnDragDrop",0,pas["WEBLib.Controls"].$rtti.TDragDropEvent,"FOnDragDrop","FOnDragDrop"),t.addProperty("OnDragOver",0,pas["WEBLib.Controls"].$rtti.TDragOverEvent,"FOnDragOver","FOnDragOver"),t.addProperty("OnEndDrag",0,pas["WEBLib.Controls"].$rtti.TEndDragEvent,"FonEndDrag","FonEndDrag"),t.addProperty("OnStartDrag",0,pas["WEBLib.Controls"].$rtti.TStartDragEvent,"FOnStartDrag","FOnStartDrag")})),this.TComboBoxStyle={0:"csDropDownList",csDropDownList:0,1:"csDropDown",csDropDown:1},this.$rtti.$Enum("TComboBoxStyle",{minvalue:0,maxvalue:1,ordtype:1,enumtype:this.TComboBoxStyle}),rtl.createClass(this,"TCustomComboBox",pas["WEBLib.Menus"].TWebCustomControl,(function(){this.$init=function(){pas["WEBLib.Menus"].TWebCustomControl.$init.call(this),this.FItems=null,this.FItemIndex=0,this.FStyle=0,this.FDroppedDown=!1,this.FOnChange=null,this.FTextHint="",this.FListName="",this.FText="",this.FHandleChangePtr=null,this.FHandleInputPtr=null,this.FHandleFocusInPtr=null,this.FHandleFocusOutPtr=null,this.FOnFocusOut=null,this.FOnFocusIn=null},this.$final=function(){this.FItems=void 0,this.FOnChange=void 0,this.FOnFocusOut=void 0,this.FOnFocusIn=void 0,pas["WEBLib.Menus"].TWebCustomControl.$final.call(this)},this.GetText=function(){var t="";return t="",1===this.FStyle?null!=this.GetElementHandle()&&(t=this.GetElementHandle().value):this.GetItemIndex()>=0&&(t=this.FItems.Get(this.GetItemIndex())),t},this.SetText=function(t){var e=0;if(1===this.FStyle)this.FText=t,this.UpdateElement();else for(var i=0,s=this.FItems.GetCount()-1;i<=s;i++)e=i,t===this.FItems.Get(e)&&this.SetItemIndex(e)},this.SetStyle=function(t){this.FStyle!==t&&(this.FStyle=t,this.GetIsLinked()||this.RecreateElement())},this.SetDroppedDown=function(t){this.FDroppedDown=t},this.GetElementSelectHandle=function(){return this.GetContainer()},this.SetTextHint=function(t){this.FTextHint!==t&&(this.FTextHint=t,this.DoUpdateList())},this.DoHandleChange=function(t){return this.Change(),!0,!0},this.DoHandleInput=function(t){return 1===this.FStyle&&this.Change(),!0,!0},this.DoHandleFocusIn=function(t){return null!=this.FOnFocusIn&&this.FOnFocusIn(this),!0,!0},this.DoHandleFocusOut=function(t){return null!=this.FOnFocusOut&&this.FOnFocusOut(this),!0,!0},this.DoItemsChange=function(t){this.DoUpdateList()},this.ClearMethodPointers=function(){pas["WEBLib.Controls"].TControl.ClearMethodPointers.call(this),this.FHandleChangePtr=null,this.FHandleInputPtr=null},this.GetMethodPointers=function(){pas["WEBLib.Controls"].TControl.GetMethodPointers.call(this),this.FHandleChangePtr=rtl.createCallback(this,"DoHandleChange"),this.FHandleInputPtr=rtl.createCallback(this,"DoHandleInput"),this.FHandleFocusInPtr=rtl.createCallback(this,"DoHandleFocusIn"),this.FHandleFocusOutPtr=rtl.createCallback(this,"DoHandleFocusOut")},this.AddTextHint=function(){var t=null;""!==this.FTextHint&&0===this.FStyle&&((t=document.createElement("OPTION")).setAttribute("value",""),t.setAttribute("disabled","true"),t.setAttribute("selected","true"),t.setAttribute("hidden","true"),t.innerHTML=this.FTextHint,this.GetContainer().appendChild(t))},this.DoUpdateList=function(){var t=0,e=0,i="",s="",o="",n=null,r=null;if(null!=this.GetContainer()){if("INPUT"===this.GetElementHandle().tagName){this.GetElementHandle().value=this.GetText(),null!=(r=document.getElementById(this.FName+"_LIST"))&&r.parentNode.removeChild(r),""!==this.FTextHint&&(this.GetElementHandle().placeholder=this.FTextHint),(r=document.createElement("DATALIST")).setAttribute("id",this.FListName),document.body.appendChild(r);for(var a=0,l=this.FItems.GetCount()-1;a<=l;a++)t=a,i=this.FItems.Get(t),n=document.createElement("OPTION"),s=i,o=i,(e=pas.System.Pos(this.FItems.GetNameValueSeparator(),i))>0&&(o=pas.System.Copy(i,1,e-1),s=pas.System.Copy(i,e+1,65535)),n.setAttribute("value",o),n.innerHTML=s,r.appendChild(n)}else{if("SELECT"!==this.GetElementHandle().tagName)return;for(var h=this.GetContainer().options.length-1;h>=0;h--)t=h,this.GetContainer().remove(t);this.AddTextHint();for(var F=0,p=this.FItems.GetCount()-1;F<=p;F++)t=F,i=this.FItems.Get(t),n=document.createElement("OPTION"),s=i,o=i,(e=pas.System.Pos(this.FItems.GetNameValueSeparator(),i))>0&&(o=pas.System.Copy(i,1,e-1),s=pas.System.Copy(i,e+1,65535)),n.setAttribute("value",o),n.innerHTML=s,this.GetContainer().appendChild(n)}this.UpdateElement()}},this.GetItemIndex=function(){var t=0;return 1===this.FStyle?t=this.FItems.IndexOf(this.GetText()):(t=this.FItemIndex,null!=this.GetContainer()&&(t=this.GetContainer().selectedIndex,""!==this.FTextHint&&(t-=1))),t},this.CreateElement=function(){var t=null;return 0===this.FStyle?t=document.createElement("SELECT"):(t=document.createElement("INPUT"),this.FListName=this.FName+"_LIST",t.setAttribute("list",this.FListName)),t},this.BindEvents=function(){pas["WEBLib.Controls"].TCustomControl.BindEvents.call(this),null!=this.GetElementHandle()&&(this.GetElementHandle().addEventListener("input",this.FHandleInputPtr),this.GetElementHandle().addEventListener("change",this.FHandleChangePtr),this.GetElementHandle().addEventListener("focusin",this.FHandleFocusInPtr),this.GetElementHandle().addEventListener("focusout",this.FHandleFocusOutPtr))},this.UnbindEvents=function(){pas["WEBLib.Controls"].TControl.UnbindEvents.call(this),null!=this.GetElementHandle()&&(this.GetElementHandle().removeEventListener("input",this.FHandleInputPtr),this.GetElementHandle().removeEventListener("change",this.FHandleChangePtr),this.GetElementHandle().removeEventListener("focusin",this.FHandleFocusInPtr),this.GetElementHandle().removeEventListener("focusout",this.FHandleFocusOutPtr))},this.UpdateElementData=function(){var t=0;pas["WEBLib.Controls"].TControl.UpdateElementData.call(this),1===this.FStyle?null!=this.GetElementHandle()&&(this.GetElementHandle().value=this.FText,this.FListName=this.FName+"_LIST",this.GetElementHandle().setAttribute("list",this.FListName)):null!=this.GetElementSelectHandle()&&(t=0,""!==this.FTextHint&&(t=1),this.GetElementSelectHandle().selectedIndex=this.FItemIndex+t,this.GetElementSelectHandle().setAttribute("role","combobox"))},this.UpdateParent=function(){pas["WEBLib.Controls"].TControl.UpdateParent.call(this),this.DoUpdateList()},this.SetItems=function(t){this.FItems.Assign(t)},this.SetItemIndex=function(t){this.FItemIndex!==t&&(this.FItemIndex=t,t>=0&&this.FStyle in rtl.createSet(1,0)&&t<this.FItems.GetCount()&&(this.FText=this.FItems.Get(t)),this.UpdateElement())},this.Loaded=function(){pas["WEBLib.Controls"].TCustomControl.Loaded.call(this),this.DoUpdateList()},this.Change=function(){this.FItemIndex=this.GetItemIndex(),null!=this.FOnChange&&this.FOnChange(this)},this.CreateInitialize=function(){pas["WEBLib.Controls"].TCustomControl.CreateInitialize.call(this),this.FItems=pas.Classes.TStringList.$create("Create$1"),this.FItems.FOnChange=rtl.createCallback(this,"DoItemsChange"),this.FItemIndex=-1,this.FStyle=0,this.SetShowFocus(!0),this.SetHeight(25)},this.Destroy=function(){rtl.free(this,"FItems"),pas["WEBLib.Controls"].TCustomControl.Destroy.call(this)},rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TComboBox",this.TCustomComboBox,(function(){rtl.addIntf(this,pas.System.IUnknown);var e=this.$rtti;e.addProperty("Align",2,pas["WEBLib.Controls"].$rtti.TAlign,"FAlign","SetAlign",{Default:pas["WEBLib.Controls"].TAlign.alNone}),e.addProperty("AlignWithMargins",2,rtl.boolean,"FAlignWithMargins","SetAlignWithMargins",{Default:!1}),e.addProperty("Anchors",2,pas["WEBLib.Controls"].$rtti.TAnchors,"FAnchors","SetAnchors",{Default:rtl.createSet(0,1)}),e.addProperty("BiDiMode",2,pas["WEBLib.Controls"].$rtti.TBiDiMode,"FBiDiMode","SetBiDiMode",{Default:pas["WEBLib.Controls"].TBiDiMode.bdLeftToRight}),e.addProperty("ChildOrder",2,rtl.longint,"FChildOrder","SetChildOrderEx",{Default:0}),e.addProperty("Color",2,pas["WEBLib.Graphics"].$rtti.TColor,"FColor","SetColor"),e.addProperty("DragMode",2,pas["WEBLib.Controls"].$rtti.TDragMode,"FDragMode","SetDragMode",{Default:pas["WEBLib.Controls"].TDragMode.dmManual}),e.addProperty("ElementClassName",2,pas["WEBLib.Controls"].$rtti.TElementClassName,"FElementClassName","SetElementClassName"),e.addProperty("ElementID",3,pas["WEBLib.Controls"].$rtti.TElementID,"GetID","SetID"),e.addProperty("ElementFont",2,pas["WEBLib.Controls"].$rtti.TElementFont,"FElementFont","SetElementFont",{Default:pas["WEBLib.Controls"].TElementFont.efProperty}),e.addProperty("ElementPosition",2,pas["WEBLib.Controls"].$rtti.TElementPosition,"FElementPosition","SetElementPosition",{Default:pas["WEBLib.Controls"].TElementPosition.epAbsolute}),e.addProperty("Enabled",2,rtl.boolean,"FEnabled","SetEnabled",{Default:!0}),e.addProperty("Font",2,pas["WEBLib.Graphics"].$rtti.TFont,"FFont","SetFont"),e.addProperty("Height",3,rtl.longint,"GetHeight","SetHeight"),e.addProperty("HeightPercent",2,rtl.double,"FHeightPercent","SetHeightPercent",{Default:100}),e.addProperty("HeightStyle",2,pas["WEBLib.Controls"].$rtti.TSizeStyle,"FHeightStyle","SetHeightStyle",{Default:pas["WEBLib.Controls"].TSizeStyle.ssAbsolute}),e.addProperty("Hint",2,rtl.string,"FHint","SetHint"),e.addProperty("ItemIndex",3,rtl.longint,"GetItemIndex","SetItemIndex",{Default:-1}),e.addProperty("Items",2,pas.Classes.$rtti.TStrings,"FItems","SetItems"),e.addProperty("Left",3,rtl.longint,"GetLeft","SetLeft"),e.addProperty("ParentFont",2,rtl.boolean,"FParentFont","SetParentFont",{Default:!0}),e.addProperty("Role",3,rtl.string,"GetRole","SetRole"),e.addProperty("ShowFocus",2,rtl.boolean,"FShowFocus","SetShowFocus",{Default:!1}),e.addProperty("ShowHint",2,rtl.boolean,"FShowHint","SetShowHint",{Default:!1}),e.addProperty("Style",2,t.$rtti.TComboBoxStyle,"FStyle","SetStyle"),e.addProperty("TabOrder",2,rtl.longint,"FTabOrder","SetTabOrder"),e.addProperty("TabStop",2,rtl.boolean,"FTabStop","SetTabStop",{Default:!0}),e.addProperty("Text",3,rtl.string,"GetText","SetText"),e.addProperty("TextDirection",0,pas["WEBLib.Controls"].$rtti.TTextDirection,"FTextDirection","FTextDirection",{Default:pas["WEBLib.Controls"].TTextDirection.tdDefault}),e.addProperty("TextHint",2,rtl.string,"FTextHint","SetTextHint"),e.addProperty("Top",3,rtl.longint,"GetTop","SetTop"),e.addProperty("Visible",2,rtl.boolean,"FVisible","SetVisible",{Default:!0}),e.addProperty("Width",3,rtl.longint,"GetWidth","SetWidth"),e.addProperty("WidthPercent",2,rtl.double,"FWidthPercent","SetWidthPercent",{Default:100}),e.addProperty("WidthStyle",2,pas["WEBLib.Controls"].$rtti.TSizeStyle,"FWidthStyle","SetWidthStyle",{Default:pas["WEBLib.Controls"].TSizeStyle.ssAbsolute}),e.addProperty("OnChange",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnChange","FOnChange"),e.addProperty("OnClick",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnClick","FOnClick"),e.addProperty("OnDblClick",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnDblClick","FOnDblClick"),e.addProperty("OnKeyDown",0,pas["WEBLib.Controls"].$rtti.TKeyEvent,"FOnKeyDown","FOnKeyDown"),e.addProperty("OnKeyPress",0,pas["WEBLib.Controls"].$rtti.TKeyPressEvent,"FOnKeyPress","FOnKeyPress"),e.addProperty("OnKeyUp",0,pas["WEBLib.Controls"].$rtti.TKeyEvent,"FOnKeyUp","FOnKeyUp"),e.addProperty("OnMouseDown",0,pas["WEBLib.Controls"].$rtti.TMouseEvent,"FOnMouseDown","FOnMouseDown"),e.addProperty("OnMouseUp",0,pas["WEBLib.Controls"].$rtti.TMouseEvent,"FOnMouseUp","FOnMouseUp"),e.addProperty("OnMouseMove",0,pas["WEBLib.Controls"].$rtti.TMouseMoveEvent,"FOnMouseMove","FOnMouseMove"),e.addProperty("OnMouseLeave",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnMouseLeave","FOnMouseLeave"),e.addProperty("OnMouseEnter",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnMouseEnter","FOnMouseEnter"),e.addProperty("OnEnter",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnEnter","FOnEnter"),e.addProperty("OnExit",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnExit","FOnExit"),e.addProperty("OnDragDrop",0,pas["WEBLib.Controls"].$rtti.TDragDropEvent,"FOnDragDrop","FOnDragDrop"),e.addProperty("OnDragOver",0,pas["WEBLib.Controls"].$rtti.TDragOverEvent,"FOnDragOver","FOnDragOver"),e.addProperty("OnEndDrag",0,pas["WEBLib.Controls"].$rtti.TEndDragEvent,"FonEndDrag","FonEndDrag"),e.addProperty("OnStartDrag",0,pas["WEBLib.Controls"].$rtti.TStartDragEvent,"FOnStartDrag","FOnStartDrag")})),rtl.createClass(this,"TWebComboBox",this.TComboBox,(function(){rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TCustomMemo",pas["WEBLib.Menus"].TWebCustomControl,(function(){this.$init=function(){pas["WEBLib.Menus"].TWebCustomControl.$init.call(this),this.FWordWrap=!1,this.FBlockChange=!1,this.FLines=null,this.FSelStart=0,this.FSelLength=0,this.FCaretPosition=pas.Types.TPoint.$new(),this.FAutoSize=!1,this.FOnChange=null,this.FReadOnly=!1,this.FTextHint="",this.FHandleChangePtr=null,this.FHandlePastePtr=null,this.FHandleCutPtr=null,this.FHandleInputPtr=null,this.FWantTabs=!1,this.FAutoCompletion=0,this.FSpellCheck=!1,this.FModified=!1},this.$final=function(){this.FLines=void 0,this.FCaretPosition=void 0,this.FOnChange=void 0,pas["WEBLib.Menus"].TWebCustomControl.$final.call(this)},this.GetText=function(){return null!=this.GetElementInputHandle()&&(this.FBlockChange=!0,this.FLines.SetTextStr(this.GetElementInputHandle().value),this.FBlockChange=!1),this.FLines.GetTextStr()},this.SetText=function(t){this.FLines.SetTextStr(t)},this.SetSelLength=function(t){this.FSelLength!==t&&(this.FSelLength=t,this.UpdateElement())},this.SetSelStart=function(t){this.FSelStart!==t&&(this.FSelStart=t,this.UpdateElement())},this.SetAutoSize=function(t){this.FAutoSize!==t&&(this.FAutoSize=t,this.UpdateElement())},this.GetElementInputHandle=function(){return this.GetContainer()},this.SetReadOnly=function(t){this.FReadOnly!==t&&(this.FReadOnly=t,this.UpdateElement())},this.GetSelLength=function(){var t=0;return t=-1,null!=this.GetElementInputHandle()&&(t=this.GetElementInputHandle().selectionEnd-this.GetElementInputHandle().selectionStart),t},this.GetSelStart=function(){var t=0;return t=-1,null!=this.GetElementInputHandle()&&(t=this.GetElementInputHandle().selectionStart),t},this.SetSpellCheck=function(t){this.FSpellCheck!==t&&(this.FSpellCheck=t,this.UpdateElement())},this.IsInputControl=function(){return!0,!0},this.HandleDoKeyDown=function(t){var e=!1,i=null;if(9===this.GetKeyCode(t.key,!0)&&this.FWantTabs){var s=(i=this.GetElementInputHandle()).selectionStart,o=i.selectionEnd;i.value=i.value.substring(0,s)+"\t"+i.value.substring(o),i.selectionStart=i.selectionEnd=s+1,t.stopPropagation(),t.preventDefault()}else pas["WEBLib.Controls"].TControl.HandleDoKeyDown.apply(this,arguments);return e},this.CreateElement=function(){return document.createElement("TEXTAREA")},this.DoHandlePaste=function(t){var e;return e=(t.clipboardData||window.clipboardData).getData("Text"),this.CanPaste(e)||(t.preventDefault(),t.stopPropagation()),!1,!1},this.DoHandleCut=function(t){return this.CanCut()||(t.preventDefault(),t.stopPropagation()),!1,!1},this.DoHandleInput=function(t){return this.GetText(),this.Change(),!0,!0},this.DoHandleChange=function(t){return this.FModified=!0,this.Change(),!0,!0},this.IsReadOnly=function(){return this.FReadOnly},this.GetDisplayText=function(){return this.FLines.GetTextStr()},this.BindEvents=function(){pas["WEBLib.Controls"].TCustomControl.BindEvents.call(this),null!=this.GetElementInputHandle()&&(this.GetElementInputHandle().addEventListener("input",this.FHandleInputPtr),this.GetElementInputHandle().addEventListener("change",this.FHandleChangePtr),this.GetElementInputHandle().addEventListener("paste",this.FHandlePastePtr),this.GetElementInputHandle().addEventListener("cut",this.FHandleCutPtr))},this.UnbindEvents=function(){pas["WEBLib.Controls"].TControl.UnbindEvents.call(this),null!=this.GetElementInputHandle()&&(this.GetElementInputHandle().removeEventListener("input",this.FHandleInputPtr),this.GetElementInputHandle().removeEventListener("change",this.FHandleChangePtr),this.GetElementInputHandle().removeEventListener("paste",this.FHandlePastePtr),this.GetElementInputHandle().removeEventListener("cut",this.FHandleCutPtr))},this.UpdateElementData=function(){var e=0,i=0,s=null;pas["WEBLib.Controls"].TControl.UpdateElementData.call(this),null==this.GetElementInputHandle()||this.FBlockChange||(this.GetElementInputHandle().value=this.GetDisplayText(),"TEXTAREA"===this.GetElementInputHandle().tagName&&this.GetElementInputHandle().setSelectionRange(this.GetSelStart(),this.GetSelStart()+this.GetSelLength()),this.GetIsLinked()||this.GetElementInputHandle().style.setProperty("resize","none"),this.GetElementInputHandle().readOnly=this.IsReadOnly(),""!==this.FTextHint&&(this.GetElementInputHandle().placeholder=this.FTextHint),this.GetIsLinked()||(51===this.FAutoCompletion?(this.GetElementInputHandle().setAttribute("autocomplete","none"),this.GetElementInputHandle().removeAttribute("name")):0!==this.FAutoCompletion?(this.GetElementInputHandle().setAttribute("autocomplete","on"),this.GetElementInputHandle().setAttribute("name",t.GetAutoCompletionName(this.FAutoCompletion))):(this.GetElementInputHandle().removeAttribute("autocomplete"),this.GetElementInputHandle().removeAttribute("name")),e=this.FSelStart,i=this.FSelStart+this.FSelLength,s=this.GetElementInputHandle(),setTimeout((function(){s.setSelectionRange(e,i)}),1)))},this.UpdateElementVisual=function(){pas["WEBLib.Controls"].TCustomControl.UpdateElementVisual.call(this),null==this.GetElementInputHandle()||this.FBlockChange||this.GetIsLinked()||(this.GetElementInputHandle().style.setProperty("overflow","auto"),this.GetElementInputHandle().style.setProperty("margin","0"),-1!==this.FColor&&16711422!==this.FColor?this.GetElementInputHandle().style.setProperty("background-color",pas["WEBLib.Graphics"].ColorToHTML(this.FColor)):this.GetElementInputHandle().style.removeProperty("background-color"),this.FSpellCheck?this.GetElementInputHandle().hasAttribute("spellcheck")&&this.GetElementInputHandle().removeAttribute("spellcheck"):this.GetElementInputHandle().setAttribute("spellcheck","false"),this.FWordWrap?this.GetElementInputHandle().hasAttribute("wrap")&&this.GetElementInputHandle().removeAttribute("wrap"):this.GetElementInputHandle().setAttribute("wrap","off"))},this.SetLines=function(t){this.FLines.Assign(t)},this.ClearMethodPointers=function(){pas["WEBLib.Controls"].TControl.ClearMethodPointers.call(this),this.FHandleChangePtr=null,this.FHandleInputPtr=null,this.FHandlePastePtr=null,this.FHandleCutPtr=null},this.GetMethodPointers=function(){pas["WEBLib.Controls"].TControl.GetMethodPointers.call(this),this.FHandleChangePtr=rtl.createCallback(this,"DoHandleChange"),this.FHandleInputPtr=rtl.createCallback(this,"DoHandleInput"),this.FHandlePastePtr=rtl.createCallback(this,"DoHandlePaste"),this.FHandleCutPtr=rtl.createCallback(this,"DoHandleCut")},this.DoLinesChange=function(t){null==this.GetElementInputHandle()||this.FBlockChange||(this.GetElementInputHandle().value=this.GetDisplayText(),this.GetElementInputHandle().readOnly=this.IsReadOnly())},this.CanPaste=function(t){return!0,!0},this.CanCut=function(){return!0,!0},this.Change=function(){null!=this.FOnChange&&this.FOnChange(this)},this.CreateInitialize=function(){pas["WEBLib.Controls"].TCustomControl.CreateInitialize.call(this),this.FSpellCheck=!0,this.FLines=pas.Classes.TStringList.$create("Create$1"),this.FLines.SetSkipLastLineBreak(!0),this.FLines.FOnChange=rtl.createCallback(this,"DoLinesChange"),4 in this.FComponentState&&(this.SetWidth(400),this.SetHeight(300)),this.SetShowFocus(!0),this.SetClipChildren(!1),this.FWantTabs=!1,this.FAutoCompletion=0,this.FWordWrap=!0,this.FNoUserSelect=!1},this.Destroy=function(){rtl.free(this,"FLines"),pas["WEBLib.Controls"].TCustomControl.Destroy.call(this)},rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TMemo",this.TCustomMemo,(function(){rtl.addIntf(this,pas.System.IUnknown);var t=this.$rtti;t.addProperty("Align",2,pas["WEBLib.Controls"].$rtti.TAlign,"FAlign","SetAlign",{Default:pas["WEBLib.Controls"].TAlign.alNone}),t.addProperty("AlignWithMargins",2,rtl.boolean,"FAlignWithMargins","SetAlignWithMargins",{Default:!1}),t.addProperty("Anchors",2,pas["WEBLib.Controls"].$rtti.TAnchors,"FAnchors","SetAnchors",{Default:rtl.createSet(0,1)}),t.addProperty("AutoSize",2,rtl.boolean,"FAutoSize","SetAutoSize"),t.addProperty("BiDiMode",2,pas["WEBLib.Controls"].$rtti.TBiDiMode,"FBiDiMode","SetBiDiMode",{Default:pas["WEBLib.Controls"].TBiDiMode.bdLeftToRight}),t.addProperty("BorderStyle",2,pas["WEBLib.Controls"].$rtti.TBorderStyle,"FBorderStyle","SetBorderStyle",{Default:pas["WEBLib.Controls"].TBorderStyle.bsSingle}),t.addProperty("ChildOrder",2,rtl.longint,"FChildOrder","SetChildOrderEx",{Default:0}),t.addProperty("Color",2,pas["WEBLib.Graphics"].$rtti.TColor,"FColor","SetColor"),t.addProperty("DragMode",2,pas["WEBLib.Controls"].$rtti.TDragMode,"FDragMode","SetDragMode",{Default:pas["WEBLib.Controls"].TDragMode.dmManual}),t.addProperty("ElementClassName",2,pas["WEBLib.Controls"].$rtti.TElementClassName,"FElementClassName","SetElementClassName"),t.addProperty("ElementID",3,pas["WEBLib.Controls"].$rtti.TElementID,"GetID","SetID"),t.addProperty("ElementFont",2,pas["WEBLib.Controls"].$rtti.TElementFont,"FElementFont","SetElementFont",{Default:pas["WEBLib.Controls"].TElementFont.efProperty}),t.addProperty("ElementPosition",2,pas["WEBLib.Controls"].$rtti.TElementPosition,"FElementPosition","SetElementPosition",{Default:pas["WEBLib.Controls"].TElementPosition.epAbsolute}),t.addProperty("Enabled",2,rtl.boolean,"FEnabled","SetEnabled",{Default:!0}),t.addProperty("Font",2,pas["WEBLib.Graphics"].$rtti.TFont,"FFont","SetFont"),t.addProperty("Height",3,rtl.longint,"GetHeight","SetHeight"),t.addProperty("HeightPercent",2,rtl.double,"FHeightPercent","SetHeightPercent",{Default:100}),t.addProperty("HeightStyle",2,pas["WEBLib.Controls"].$rtti.TSizeStyle,"FHeightStyle","SetHeightStyle",{Default:pas["WEBLib.Controls"].TSizeStyle.ssAbsolute}),t.addProperty("Hint",2,rtl.string,"FHint","SetHint"),t.addProperty("Left",3,rtl.longint,"GetLeft","SetLeft"),t.addProperty("Lines",2,pas.Classes.$rtti.TStrings,"FLines","SetLines"),t.addProperty("Margins",2,pas["WEBLib.Controls"].$rtti.TMargins,"FMargins","SetMargins"),t.addProperty("ParentColor",2,rtl.boolean,"FParentColor","SetParentColor",{Default:!1}),t.addProperty("ParentFont",2,rtl.boolean,"FParentFont","SetParentFont",{Default:!0}),t.addProperty("PopupMenu",0,pas["WEBLib.Menus"].$rtti.TPopupMenu,"FPopupMenu","FPopupMenu"),t.addProperty("ReadOnly",2,rtl.boolean,"FReadOnly","SetReadOnly"),t.addProperty("Role",3,rtl.string,"GetRole","SetRole"),t.addProperty("SelStart",3,rtl.longint,"GetSelStart","SetSelStart"),t.addProperty("SelLength",3,rtl.longint,"GetSelLength","SetSelLength"),t.addProperty("ShowFocus",2,rtl.boolean,"FShowFocus","SetShowFocus",{Default:!1}),t.addProperty("ShowHint",2,rtl.boolean,"FShowHint","SetShowHint",{Default:!1}),t.addProperty("Spellcheck",2,rtl.boolean,"FSpellCheck","SetSpellCheck",{Default:!0}),t.addProperty("TabOrder",2,rtl.longint,"FTabOrder","SetTabOrder"),t.addProperty("TabStop",2,rtl.boolean,"FTabStop","SetTabStop",{Default:!0}),t.addProperty("TextDirection",0,pas["WEBLib.Controls"].$rtti.TTextDirection,"FTextDirection","FTextDirection",{Default:pas["WEBLib.Controls"].TTextDirection.tdDefault}),t.addProperty("Top",3,rtl.longint,"GetTop","SetTop"),t.addProperty("Visible",2,rtl.boolean,"FVisible","SetVisible",{Default:!0}),t.addProperty("Width",3,rtl.longint,"GetWidth","SetWidth"),t.addProperty("WidthPercent",2,rtl.double,"FWidthPercent","SetWidthPercent",{Default:100}),t.addProperty("WidthStyle",2,pas["WEBLib.Controls"].$rtti.TSizeStyle,"FWidthStyle","SetWidthStyle",{Default:pas["WEBLib.Controls"].TSizeStyle.ssAbsolute}),t.addProperty("OnChange",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnChange","FOnChange"),t.addProperty("OnClick",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnClick","FOnClick"),t.addProperty("OnDblClick",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnDblClick","FOnDblClick"),t.addProperty("OnKeyDown",0,pas["WEBLib.Controls"].$rtti.TKeyEvent,"FOnKeyDown","FOnKeyDown"),t.addProperty("OnKeyPress",0,pas["WEBLib.Controls"].$rtti.TKeyPressEvent,"FOnKeyPress","FOnKeyPress"),t.addProperty("OnKeyUp",0,pas["WEBLib.Controls"].$rtti.TKeyEvent,"FOnKeyUp","FOnKeyUp"),t.addProperty("OnMouseDown",0,pas["WEBLib.Controls"].$rtti.TMouseEvent,"FOnMouseDown","FOnMouseDown"),t.addProperty("OnMouseUp",0,pas["WEBLib.Controls"].$rtti.TMouseEvent,"FOnMouseUp","FOnMouseUp"),t.addProperty("OnMouseMove",0,pas["WEBLib.Controls"].$rtti.TMouseMoveEvent,"FOnMouseMove","FOnMouseMove"),t.addProperty("OnMouseLeave",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnMouseLeave","FOnMouseLeave"),t.addProperty("OnMouseEnter",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnMouseEnter","FOnMouseEnter"),t.addProperty("OnMouseWheel",0,pas["WEBLib.Controls"].$rtti.TMouseWheelEvent,"FOnMouseWheel","FOnMouseWheel"),t.addProperty("OnEnter",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnEnter","FOnEnter"),t.addProperty("OnExit",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnExit","FOnExit"),t.addProperty("OnDragDrop",0,pas["WEBLib.Controls"].$rtti.TDragDropEvent,"FOnDragDrop","FOnDragDrop"),t.addProperty("OnDragOver",0,pas["WEBLib.Controls"].$rtti.TDragOverEvent,"FOnDragOver","FOnDragOver"),t.addProperty("OnEndDrag",0,pas["WEBLib.Controls"].$rtti.TEndDragEvent,"FonEndDrag","FonEndDrag"),t.addProperty("OnStartDrag",0,pas["WEBLib.Controls"].$rtti.TStartDragEvent,"FOnStartDrag","FOnStartDrag")})),rtl.createClass(this,"TWebMemo",this.TMemo,(function(){rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TControlGroup",pas["WEBLib.Menus"].TWebCustomControl,(function(){this.$init=function(){pas["WEBLib.Menus"].TWebCustomControl.$init.call(this),this.FControls$1=null,this.FOldCount=0,this.FColumns=0,this.FItems=null,this.FOnChange=null,this.FElementButtonClassName="",this.FElementLabelClassName="",this.FElementGroupClassName="",this.FControlPosition=0,this.FElementLegendClassName=""},this.$final=function(){this.FControls$1=void 0,this.FItems=void 0,this.FOnChange=void 0,pas["WEBLib.Menus"].TWebCustomControl.$final.call(this)},this.SetControlPosition=function(t){this.FControlPosition!==t&&(this.FControlPosition=t,this.DoUpdateList())},this.CreateElement=function(){var t=null,e=null;return t=document.createElement("FIELDSET"),e=document.createElement("LEGEND"),t.appendChild(e),e.innerHTML=this.FCaption,e.setAttribute("class","w-auto "+this.FElementLegendClassName),""===this.FCaption?e.style.setProperty("display","none"):e.style.setProperty("display",""),e.style.setProperty("float","none"),t.style.setProperty("display","inline-block"),t.style.setProperty("-webkit-padding-before","0px"),t.style.setProperty("-webkit-padding-after","0px"),t.style.setProperty("-webkit-padding-end","0px"),t.style.setProperty("-webkit-padding-start","0px"),t.style.setProperty("border","1px"),t},this.DoHandleClick=function(t){this.Change()},this.DoItemsChange=function(t){this.DoUpdateList()},this.DoControlClick=function(t){this.DoHandleClick(rtl.as(t,pas["WEBLib.Controls"].TCustomControl))},this.SetCaption=function(t){var e=null;pas["WEBLib.Controls"].TCustomControl.SetCaption.call(this,t),null!=this.GetContainer()&&null!=(e=this.GetContainer().firstElementChild)&&(e.innerHTML=t,""===t?e.style.setProperty("display","none"):e.style.setProperty("display",""))},this.SetColumns=function(t){this.FColumns>0&&this.FColumns!==t&&(this.FColumns=t,this.DoUpdateList())},this.SetItems=function(t){this.FItems.Assign(t),this.DoUpdateList()},this.DoUpdateList=function(){var e,i,s=0,o="",n=null,r=0,a=0,l=0,h=0,F=null,p=[];if(null!=this.GetContainer()&&0!==this.FItems.GetCount()){i=Math.round(2.5*this.FFont.FSize),e=rtl.trunc(this.GetWidth()/this.FColumns),r=""!==this.FCaption?this.FFont.FSize:4,a=0,l=0,this.FOldCount>0&&(p=rtl.arraySetLength(p,!1,this.FOldCount));for(var c=0,u=this.FOldCount-1;c<=u;c++)s=c,n=rtl.getObject(this.FControls$1.Get(s)),t.TRadioButton.isPrototypeOf(n)&&(p[s]=rtl.as(n,t.TRadioButton).GetChecked()),t.TCheckBox.isPrototypeOf(n)&&(p[s]=rtl.as(n,t.TCheckBox).GetChecked()),n=rtl.freeLoc(n);for(this.FControls$1.Clear();this.GetContainer().childElementCount>0;)this.GetContainer().removeChild(this.GetContainer().firstChild);""!==this.FCaption&&(F=document.createElement("LEGEND"),this.GetElementHandle().appendChild(F),F.innerHTML=this.FCaption,F.setAttribute("class","w-auto "+this.FElementLegendClassName),F.style.setProperty("float","none"),pas["WEBLib.Controls"].SetHTMLElementFont(F,this.FFont,!(0===this.FElementFont&&""===this.FElementClassName))),""!==this.FElementGroupClassName?this.GetElementHandle().setAttribute("class",this.FElementGroupClassName):this.GetElementHandle().setAttribute("class","border p-2"),this.GetContainer().style.setProperty("margin","0px");for(var C=0,T=this.FItems.GetCount()-1;C<=T;C++)s=C,h=r+l*i,o=this.FItems.Get(s),(n=this.CreateGroupControl(4+a*e,h,s,o,this.FControlPosition,this.GetGroupControlState(s),!0)).SetEnabled(this.FEnabled),this.FControls$1.Add(n),s<=this.FOldCount&&(t.TRadioButton.isPrototypeOf(n)&&rtl.as(n,t.TRadioButton).SetChecked(p[s]),t.TCheckBox.isPrototypeOf(n)&&rtl.as(n,t.TCheckBox).SetChecked(p[s])),this.GetIsLinked()||(n.GetContainer().style.setProperty("float","left"),n.GetContainer().style.setProperty("width",pas.SysUtils.IntToStr(pas.System.Trunc(100/this.FColumns)-5)+"%")),s%this.FColumns==0&&n.GetContainer().style.setProperty("clear","left"),this.GetElementHandle().appendChild(n.GetContainer()),a<this.FColumns-1?a+=1:(a=0,l+=1);this.FOldCount=this.FItems.GetCount()}},this.Change=function(){null!=this.FOnChange&&this.FOnChange(this)},this.Loaded=function(){pas["WEBLib.Controls"].TCustomControl.Loaded.call(this),this.DoUpdateList()},this.FontChanged=function(){pas["WEBLib.Controls"].TControl.FontChanged.call(this),this.DoUpdateList()},this.CreateGroupControl=function(t,e,i,s,o,n,r){return null,null},this.GetGroupControlState=function(t){return!1,!1},this.GetGroupControl=function(t){return rtl.getObject(this.FControls$1.Get(t))},this.SetEnabled=function(t){var e=0;pas["WEBLib.Controls"].TControl.SetEnabled.apply(this,arguments);for(var i=0,s=this.FControls$1.GetCount()-1;i<=s;i++)e=i,rtl.getObject(this.FControls$1.Get(e)).SetEnabled(t)},this.CreateInitialize=function(){pas["WEBLib.Controls"].TCustomControl.CreateInitialize.call(this),this.FColumns=1,this.FControls$1=pas.Classes.TList.$create("Create$1"),this.FItems=pas.Classes.TStringList.$create("Create$1"),this.FItems.FOnChange=rtl.createCallback(this,"DoItemsChange"),this.FOldCount=-1,this.FControlPosition=0,4 in this.FComponentState&&(this.SetWidth(200),this.SetHeight(200))},this.Destroy=function(){rtl.free(this,"FControls$1"),rtl.free(this,"FItems"),pas["WEBLib.Controls"].TCustomControl.Destroy.call(this)},this.EndUpdate=function(){pas["WEBLib.Controls"].TCustomControl.EndUpdate.call(this),this.DoUpdateList()},this.SetHeight=function(t){pas["WEBLib.Controls"].TControl.SetHeight.apply(this,arguments),this.DoUpdateList()},this.SetWidth=function(t){pas["WEBLib.Controls"].TControl.SetWidth.apply(this,arguments),this.DoUpdateList()},rtl.addIntf(this,pas.System.IUnknown);var e=this.$rtti;e.addProperty("Align",2,pas["WEBLib.Controls"].$rtti.TAlign,"FAlign","SetAlign",{Default:pas["WEBLib.Controls"].TAlign.alNone}),e.addProperty("AlignWithMargins",2,rtl.boolean,"FAlignWithMargins","SetAlignWithMargins",{Default:!1}),e.addProperty("Anchors",2,pas["WEBLib.Controls"].$rtti.TAnchors,"FAnchors","SetAnchors",{Default:rtl.createSet(0,1)}),e.addProperty("Caption",2,rtl.string,"FCaption","SetCaption"),e.addProperty("ChildOrder",2,rtl.longint,"FChildOrder","SetChildOrderEx",{Default:0}),e.addProperty("Columns",2,rtl.longint,"FColumns","SetColumns"),e.addProperty("ControlPosition",2,pas["WEBLib.Controls"].$rtti.TElementPosition,"FControlPosition","SetControlPosition",{Default:pas["WEBLib.Controls"].TElementPosition.epAbsolute}),e.addProperty("DragMode",2,pas["WEBLib.Controls"].$rtti.TDragMode,"FDragMode","SetDragMode",{Default:pas["WEBLib.Controls"].TDragMode.dmManual}),e.addProperty("ElementClassName",2,pas["WEBLib.Controls"].$rtti.TElementClassName,"FElementClassName","SetElementClassName"),e.addProperty("ElementButtonClassName",0,pas["WEBLib.Controls"].$rtti.TElementClassName,"FElementButtonClassName","FElementButtonClassName"),e.addProperty("ElementGroupClassName",0,pas["WEBLib.Controls"].$rtti.TElementClassName,"FElementGroupClassName","FElementGroupClassName"),e.addProperty("ElementLabelClassName",0,pas["WEBLib.Controls"].$rtti.TElementClassName,"FElementLabelClassName","FElementLabelClassName"),e.addProperty("ElementLegendClassName",0,pas["WEBLib.Controls"].$rtti.TElementClassName,"FElementLegendClassName","FElementLegendClassName"),e.addProperty("ElementID",3,pas["WEBLib.Controls"].$rtti.TElementID,"GetID","SetID"),e.addProperty("ElementFont",2,pas["WEBLib.Controls"].$rtti.TElementFont,"FElementFont","SetElementFont",{Default:pas["WEBLib.Controls"].TElementFont.efProperty}),e.addProperty("ElementPosition",2,pas["WEBLib.Controls"].$rtti.TElementPosition,"FElementPosition","SetElementPosition",{Default:pas["WEBLib.Controls"].TElementPosition.epAbsolute}),e.addProperty("Enabled",2,rtl.boolean,"FEnabled","SetEnabled",{Default:!0}),e.addProperty("Font",2,pas["WEBLib.Graphics"].$rtti.TFont,"FFont","SetFont"),e.addProperty("Height",3,rtl.longint,"GetHeight","SetHeight"),e.addProperty("HeightPercent",2,rtl.double,"FHeightPercent","SetHeightPercent",{Default:100}),e.addProperty("HeightStyle",2,pas["WEBLib.Controls"].$rtti.TSizeStyle,"FHeightStyle","SetHeightStyle",{Default:pas["WEBLib.Controls"].TSizeStyle.ssAbsolute}),e.addProperty("Items",2,pas.Classes.$rtti.TStrings,"FItems","SetItems"),e.addProperty("Margins",2,pas["WEBLib.Controls"].$rtti.TMargins,"FMargins","SetMargins"),e.addProperty("ParentFont",2,rtl.boolean,"FParentFont","SetParentFont",{Default:!0}),e.addProperty("PopupMenu",0,pas["WEBLib.Menus"].$rtti.TPopupMenu,"FPopupMenu","FPopupMenu"),e.addProperty("Role",3,rtl.string,"GetRole","SetRole"),e.addProperty("Visible",2,rtl.boolean,"FVisible","SetVisible",{Default:!0}),e.addProperty("Width",3,rtl.longint,"GetWidth","SetWidth"),e.addProperty("WidthPercent",2,rtl.double,"FWidthPercent","SetWidthPercent",{Default:100}),e.addProperty("WidthStyle",2,pas["WEBLib.Controls"].$rtti.TSizeStyle,"FWidthStyle","SetWidthStyle",{Default:pas["WEBLib.Controls"].TSizeStyle.ssAbsolute}),e.addProperty("OnChange",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnChange","FOnChange"),e.addProperty("OnDragDrop",0,pas["WEBLib.Controls"].$rtti.TDragDropEvent,"FOnDragDrop","FOnDragDrop"),e.addProperty("OnDragOver",0,pas["WEBLib.Controls"].$rtti.TDragOverEvent,"FOnDragOver","FOnDragOver"),e.addProperty("OnEndDrag",0,pas["WEBLib.Controls"].$rtti.TEndDragEvent,"FonEndDrag","FonEndDrag"),e.addProperty("OnStartDrag",0,pas["WEBLib.Controls"].$rtti.TStartDragEvent,"FOnStartDrag","FOnStartDrag")})),rtl.createClass(this,"TRadioGroup",this.TControlGroup,(function(){this.$init=function(){t.TControlGroup.$init.call(this),this.FItemIndex=0,this.FOldItemIndex=0},this.DoHandleClick=function(t){this.GetItemIndex()!==this.FOldItemIndex&&(this.Change(),this.FOldItemIndex=this.GetItemIndex())},this.GetItemIndex=function(){var t=0,e=null,i=0;t=this.FItemIndex;for(var s=0,o=this.FItems.GetCount()-1;s<=o;s++)i=s,null!=(e=document.getElementById(this.GetID()+pas.SysUtils.IntToStr(i)+"rd"))&&e.checked&&(t=i);return t},this.SetItemIndex=function(t){var e=null;-1===t&&this.GetItemIndex()>=0?(null!=(e=document.getElementById(this.GetID()+pas.SysUtils.IntToStr(this.GetItemIndex())+"rd"))&&(e.checked=!1),this.FItemIndex=-1):(this.FItemIndex=t,t>=0&&t<this.FItems.GetCount()&&null!=(e=document.getElementById(this.GetID()+pas.SysUtils.IntToStr(t)+"rd"))&&(e.checked=!0))},this.CreateGroupControl=function(e,i,s,o,n,r,a){var l=null,h="";return""===(h=this.GetID())&&(h=this.FName),(l=t.TRadioButton.$create("Create$2",[h+pas.SysUtils.IntToStr(s)])).SetElementPosition(n),l.SetElementFont(this.FElementFont),l.SetElementClassName(this.FElementClassName),l.FElementButtonClassName=this.FElementButtonClassName,l.FElementLabelClassName=this.FElementLabelClassName,l.SetHeightStyle(2),l.SetParentFont(!1),l.FFont.Assign(this.FFont),l.SetParent(this),l.SetCaption(o),l.SetGroupName(h),l.SetTop(i),l.SetLeft(e),l.SetWidthStyle(2),l.SetWidthPercent(100),l.FOnClick=rtl.createCallback(this,"DoControlClick"),l.SetChecked(r),l.SetEnabled(a),l.FTag$1=s,l.SetTabStop(!0),l},this.GetGroupControlState=function(t){return t===this.FItemIndex},this.CreateInitialize=function(){t.TControlGroup.CreateInitialize.call(this),this.FItemIndex=-1,this.FOldItemIndex=-2},this.SetFocus=function(){var t=0,e=null;0!==this.FItems.GetCount()&&((t=this.GetItemIndex())<0&&(t=0),null!=(e=this.GetGroupControl(t))&&e.SetFocus())},rtl.addIntf(this,pas.System.IUnknown),this.$rtti.addProperty("ItemIndex",3,rtl.longint,"GetItemIndex","SetItemIndex")})),rtl.createClass(this,"TScrollBarContent",pas["WEBLib.Controls"].TCustomControl,(function(){this.CreateElement=function(){return document.createElement("SPAN")},rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TScrollBar",pas["WEBLib.Controls"].TCustomControl,(function(){this.$init=function(){pas["WEBLib.Controls"].TCustomControl.$init.call(this),this.FScrolling=!1,this.FContent=null,this.FKind=0,this.FPosition=0,this.FSmallChange=0,this.FMax=0,this.FMin=0,this.FLargeChange=0,this.FPageSize=0,this.FOnChange=null,this.FScrollPtr=null},this.$final=function(){this.FContent=void 0,this.FOnChange=void 0,pas["WEBLib.Controls"].TCustomControl.$final.call(this)},this.SetKind=function(t){if(this.FKind!==t){this.FKind=t;var e=this.FKind;0===e?this.SetBounds(this.GetLeft(),this.GetTop(),this.GetHeight(),17):1===e&&this.SetBounds(this.GetLeft(),this.GetTop(),17,this.GetWidth()),this.UpdateElement(),this.UpdateContent()}},this.SetPosition=function(t){this.FPosition!==t&&(this.FPosition=t,this.UpdateContent())},this.SetMax=function(t){this.FMax!==t&&(this.FMax=t,this.UpdateContent())},this.SetMin=function(t){this.FMin!==t&&(this.FMin=t,this.UpdateContent())},this.SetPageSize=function(t){this.FPageSize!==t&&(this.FPageSize=t,this.UpdateContent())},this.GetPosition=function(){var t=0;if(t=0,null!=this.GetElement()){var e=this.FKind;0===e?t=Math.round(this.GetValue(this.GetElement().scrollLeft)):1===e&&(t=Math.round(this.GetValue(this.GetElement().scrollTop)))}else t=this.FPosition;return t},this.GetPageSize=function(){var t=0;return 0===(t=this.FPageSize)&&(t=25),t},this.GetValue=function(t){var e=0;if(e=0,null!=this.FContent){var i=this.FKind;0===i?this.FContent.GetWidth()>0&&(e=t/this.FContent.GetWidth()*(this.FMax-this.FMin)):1===i&&this.FContent.GetHeight()>0&&(e=t/this.FContent.GetHeight()*(this.FMax-this.FMin))}return e},this.CreateElement=function(){return document.createElement("SPAN")},this.DoScroll=function(t){return this.FScrolling=!0,null!=this.FOnChange&&this.FOnChange(this),this.FScrolling=!1,!0,!0},this.BindEvents=function(){pas["WEBLib.Controls"].TCustomControl.BindEvents.call(this),null!=this.GetElementHandle()&&this.GetElementHandle().addEventListener("scroll",this.FScrollPtr)},this.UnbindEvents=function(){pas["WEBLib.Controls"].TControl.UnbindEvents.call(this),null!=this.GetElementHandle()&&this.GetElementHandle().removeEventListener("scroll",this.FScrollPtr)},this.UpdateElementVisual=function(){if(pas["WEBLib.Controls"].TCustomControl.UpdateElementVisual.call(this),null!=this.GetElementHandle()){this.GetElementHandle().style.setProperty("overflow","auto");var t=this.FKind;0===t?(this.GetElementHandle().style.setProperty("overflow-y","hidden"),this.GetElementHandle().style.setProperty("overflow-x","")):1===t&&(this.GetElementHandle().style.setProperty("overflow-y",""),this.GetElementHandle().style.setProperty("overflow-x","hidden"))}},this.UpdateContent=function(){var t,e,i=0,s=0,o=0,n=0;if(null!=this.FContent&&null!=this.GetElementHandle()&&!this.FScrolling){t=this.GetPageSize(),e=(this.FMax-this.FMin)/t;var r=this.FKind;0===r?(s=0,n=this.GetHeight(),o=Math.round(e*this.GetWidth()),i=Math.round((this.FPosition-this.FMin)/(this.FMax-this.FMin)*o)):1===r&&(i=0,o=this.GetWidth(),n=Math.round(e*this.GetHeight()),s=Math.round((this.FPosition-this.FMin)/(this.FMax-this.FMin)*n)),this.FContent.SetBounds(0,0,o,n),this.GetElementHandle().scrollLeft=i,this.GetElementHandle().scrollTop=s}},this.Loaded=function(){pas["WEBLib.Controls"].TCustomControl.Loaded.call(this),this.UpdateContent()},this.ClearMethodPointers=function(){pas["WEBLib.Controls"].TControl.ClearMethodPointers.call(this),this.FScrollPtr=null},this.GetMethodPointers=function(){pas["WEBLib.Controls"].TControl.GetMethodPointers.call(this),this.FScrollPtr=rtl.createCallback(this,"DoScroll")},this.CreateInitialize=function(){pas["WEBLib.Controls"].TCustomControl.CreateInitialize.call(this),this.SetTabStop(!0),this.FKind=0,this.FPosition=0,this.FMin=0,this.FMax=100,this.FSmallChange=1,this.FLargeChange=1,this.FContent=t.TScrollBarContent.$create("Create$1",[this]),this.FContent.SetParent(this),this.FContent.SetWidth(121),this.FContent.SetHeight(17),4 in this.FComponentState&&(this.SetWidth(121),this.SetHeight(17)),this.UpdateContent()},this.Destroy=function(){rtl.free(this,"FContent"),pas["WEBLib.Controls"].TCustomControl.Destroy.call(this)},this.SetBounds=function(t,e,i,s){pas["WEBLib.Controls"].TControl.SetBounds.apply(this,arguments),this.UpdateContent()},rtl.addIntf(this,pas.System.IUnknown);var e=this.$rtti;e.addProperty("Align",2,pas["WEBLib.Controls"].$rtti.TAlign,"FAlign","SetAlign",{Default:pas["WEBLib.Controls"].TAlign.alNone}),e.addProperty("AlignWithMargins",2,rtl.boolean,"FAlignWithMargins","SetAlignWithMargins",{Default:!1}),e.addProperty("DragMode",2,pas["WEBLib.Controls"].$rtti.TDragMode,"FDragMode","SetDragMode",{Default:pas["WEBLib.Controls"].TDragMode.dmManual}),e.addProperty("Height",3,rtl.longint,"GetHeight","SetHeight"),e.addProperty("Kind",2,pas["WEBLib.Controls"].$rtti.TScrollBarKind,"FKind","SetKind"),e.addProperty("Position",3,rtl.longint,"GetPosition","SetPosition"),e.addProperty("Left",3,rtl.longint,"GetLeft","SetLeft"),e.addProperty("SmallChange",0,rtl.longint,"FSmallChange","FSmallChange"),e.addProperty("LargeChange",0,rtl.longint,"FLargeChange","FLargeChange"),e.addProperty("Max",2,rtl.longint,"FMax","SetMax"),e.addProperty("Min",2,rtl.longint,"FMin","SetMin"),e.addProperty("PageSize",3,rtl.longint,"GetPageSize","SetPageSize"),e.addProperty("Top",3,rtl.longint,"GetTop","SetTop"),e.addProperty("Visible",2,rtl.boolean,"FVisible","SetVisible",{Default:!0}),e.addProperty("Width",3,rtl.longint,"GetWidth","SetWidth"),e.addProperty("OnChange",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnChange","FOnChange"),e.addProperty("OnDragDrop",0,pas["WEBLib.Controls"].$rtti.TDragDropEvent,"FOnDragDrop","FOnDragDrop"),e.addProperty("OnDragOver",0,pas["WEBLib.Controls"].$rtti.TDragOverEvent,"FOnDragOver","FOnDragOver"),e.addProperty("OnEndDrag",0,pas["WEBLib.Controls"].$rtti.TEndDragEvent,"FonEndDrag","FonEndDrag"),e.addProperty("OnStartDrag",0,pas["WEBLib.Controls"].$rtti.TStartDragEvent,"FOnStartDrag","FOnStartDrag")})),this.GetAutoCompletionName=function(t){var e="";return 0===t?e="":1===t?e="honorific-prefix":2===t?e="given-name":3===t?e="additional-name":4===t?e="family-name":5===t?e="honorific-suffix":6===t?e="nickname":7===t?e="email":8===t?e="username":9===t?e="new-password":10===t?e="current-password":11===t?e="organization-title":12===t?e="organization":13===t?e="street-address":14===t?e="address-line1":15===t?e="address-line2":16===t?e="address-line3":17===t?e="address-level1":18===t?e="address-level2":19===t?e="address-level3":20===t?e="address-level4":21===t?e="country":22===t?e="country-name":23===t?e="postal-code":24===t?e="cc-name":25===t?e="cc-given-name":26===t?e="cc-additional-name":27===t?e="cc-family-name":28===t?e="cc-number":29===t?e="cc-exp":30===t?e="cc-exp-month":31===t?e="cc-exp-year":32===t?e="cc-csc":33===t?e="cc-type":34===t?e="transaction-currency":35===t?e="transaction-amount":36===t?e="language":37===t?e="bday":38===t?e="bday-day":39===t?e="bday-month":40===t?e="bday-year":41===t?e="sex":42===t?e="tel":43===t?e="tel-country-code":44===t?e="tel-national":45===t?e="tel-area-code":46===t?e="tel-local":47===t?e="tel-extension":48===t?e="impp":49===t?e="url":50===t?e="photo":52===t&&(e="nope"),e}})),rtl.module("WEBLib.ExtCtrls",["System","Classes","SysUtils","Types","WEBLib.Controls","WEBLib.StdCtrls","WEBLib.Graphics","Web","JS","WEBLib.WebTools","WEBLib.Menus"],(function(){"use strict";var t=this;this.TTrackBarOrientation={0:"trHorizontal",trHorizontal:0,1:"trVertical",trVertical:1},this.$rtti.$Enum("TTrackBarOrientation",{minvalue:0,maxvalue:1,ordtype:1,enumtype:this.TTrackBarOrientation}),rtl.createClass(this,"TTrackBar",pas["WEBLib.StdCtrls"].TCustomInput,(function(){this.$init=function(){pas["WEBLib.StdCtrls"].TCustomInput.$init.call(this),this.FMax=0,this.FMin=0,this.FPosition=0,this.FOnChange=null,this.FOrientation=0},this.$final=function(){this.FOnChange=void 0,pas["WEBLib.StdCtrls"].TCustomInput.$final.call(this)},this.SetOrientation=function(t){var e=0,i=0;this.FOrientation!==t&&(e=this.GetWidth(),i=this.GetHeight(),this.FOrientation=t,0 in this.FComponentState||(this.SetWidth(i),this.SetHeight(e)),this.UpdateElement())},this.GetInputType=function(){return"range","range"},this.DoHandleChange=function(t){var e;return e=this.GetElementHandle(),this.FPosition=e.value,this.Change(),!0,!0},this.BindEvents=function(){pas["WEBLib.Controls"].TCustomControl.BindEvents.call(this),null!=this.GetElementHandle()&&(this.GetElementHandle().oninput=rtl.createSafeCallback(this,"DoHandleChange"))},this.SetMax=function(t){this.FMax!==t&&(this.FMax=t,this.DoUpdate())},this.SetMin=function(t){this.FMin!==t&&(this.FMin=t,this.DoUpdate())},this.SetPosition=function(t){this.FPosition!==t&&(this.FPosition=t,this.DoUpdate())},this.GetPosition=function(){var t,e=0;return e=this.FPosition,null==this.GetContainer()||""!==(t=this.GetContainer().value)&&(e=pas.SysUtils.StrToInt(t)),e},this.DoUpdate=function(){var t=null;null!=this.GetContainer()&&(this.GetContainer().setAttribute("max",pas.SysUtils.IntToStr(this.FMax)),this.GetContainer().setAttribute("min",pas.SysUtils.IntToStr(this.FMin)),(t=this.GetElementHandle()).value=this.FPosition,t.setAttribute("value",this.FPosition))},this.Change=function(){null!=this.FOnChange&&this.FOnChange(this)},this.CreateControl=function(){pas["WEBLib.Controls"].TCustomControl.CreateControl.call(this),this.DoUpdate()},this.UpdateElementVisual=function(){var t=null;pas["WEBLib.StdCtrls"].TCustomInput.UpdateElementVisual.call(this),t=this.GetElementHandle(),0===this.FOrientation?(t.removeAttribute("orient"),t.style.removeProperty("writing-mode"),t.style.removeProperty("-webkit-appearance"),t.style.removeProperty("height"),1===this.FWidthStyle&&t.style.setProperty("width",pas.SysUtils.IntToStr(this.GetWidth()))):(t.setAttribute("orient","vertical"),t.style.setProperty("writing-mode","bt-lt"),t.style.setProperty("-webkit-appearance","slider-vertical"),t.style.removeProperty("width"),1===this.FHeightStyle&&t.style.setProperty("height",pas.SysUtils.IntToStr(this.GetHeight())),t.style.setProperty("width","22px"))},this.CreateInitialize=function(){pas["WEBLib.StdCtrls"].TCustomInput.CreateInitialize.call(this),this.FMax=100,this.FMin=0,this.FPosition=0},rtl.addIntf(this,pas.System.IUnknown);var e=this.$rtti;e.addProperty("Align",2,pas["WEBLib.Controls"].$rtti.TAlign,"FAlign","SetAlign",{Default:pas["WEBLib.Controls"].TAlign.alNone}),e.addProperty("AlignWithMargins",2,rtl.boolean,"FAlignWithMargins","SetAlignWithMargins",{Default:!1}),e.addProperty("Anchors",2,pas["WEBLib.Controls"].$rtti.TAnchors,"FAnchors","SetAnchors",{Default:rtl.createSet(0,1)}),e.addProperty("DragMode",2,pas["WEBLib.Controls"].$rtti.TDragMode,"FDragMode","SetDragMode",{Default:pas["WEBLib.Controls"].TDragMode.dmManual}),e.addProperty("ElementClassName",2,pas["WEBLib.Controls"].$rtti.TElementClassName,"FElementClassName","SetElementClassName"),e.addProperty("ElementID",3,pas["WEBLib.Controls"].$rtti.TElementID,"GetID","SetID"),e.addProperty("ElementFont",2,pas["WEBLib.Controls"].$rtti.TElementFont,"FElementFont","SetElementFont",{Default:pas["WEBLib.Controls"].TElementFont.efProperty}),e.addProperty("ElementPosition",2,pas["WEBLib.Controls"].$rtti.TElementPosition,"FElementPosition","SetElementPosition",{Default:pas["WEBLib.Controls"].TElementPosition.epAbsolute}),e.addProperty("Enabled",2,rtl.boolean,"FEnabled","SetEnabled",{Default:!0}),e.addProperty("Height",3,rtl.longint,"GetHeight","SetHeight"),e.addProperty("HeightPercent",2,rtl.double,"FHeightPercent","SetHeightPercent",{Default:100}),e.addProperty("HeightStyle",2,pas["WEBLib.Controls"].$rtti.TSizeStyle,"FHeightStyle","SetHeightStyle",{Default:pas["WEBLib.Controls"].TSizeStyle.ssAbsolute}),e.addProperty("Left",3,rtl.longint,"GetLeft","SetLeft"),e.addProperty("Margins",2,pas["WEBLib.Controls"].$rtti.TMargins,"FMargins","SetMargins"),e.addProperty("Max",2,rtl.longint,"FMax","SetMax",{Default:10}),e.addProperty("Min",2,rtl.longint,"FMin","SetMin",{Default:0}),e.addProperty("Orientation",2,t.$rtti.TTrackBarOrientation,"FOrientation","SetOrientation",{Default:t.TTrackBarOrientation.trHorizontal}),e.addProperty("Position",3,rtl.longint,"GetPosition","SetPosition",{Default:0}),e.addProperty("Role",3,rtl.string,"GetRole","SetRole"),e.addProperty("ShowHint",2,rtl.boolean,"FShowHint","SetShowHint",{Default:!1}),e.addProperty("TabOrder",2,rtl.longint,"FTabOrder","SetTabOrder"),e.addProperty("TabStop",2,rtl.boolean,"FTabStop","SetTabStop",{Default:!0}),e.addProperty("Top",3,rtl.longint,"GetTop","SetTop"),e.addProperty("Visible",2,rtl.boolean,"FVisible","SetVisible",{Default:!0}),e.addProperty("Width",3,rtl.longint,"GetWidth","SetWidth"),e.addProperty("WidthPercent",2,rtl.double,"FWidthPercent","SetWidthPercent",{Default:100}),e.addProperty("WidthStyle",2,pas["WEBLib.Controls"].$rtti.TSizeStyle,"FWidthStyle","SetWidthStyle",{Default:pas["WEBLib.Controls"].TSizeStyle.ssAbsolute}),e.addProperty("OnClick",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnClick","FOnClick"),e.addProperty("OnChange",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnChange","FOnChange"),e.addProperty("OnDragDrop",0,pas["WEBLib.Controls"].$rtti.TDragDropEvent,"FOnDragDrop","FOnDragDrop"),e.addProperty("OnDragOver",0,pas["WEBLib.Controls"].$rtti.TDragOverEvent,"FOnDragOver","FOnDragOver"),e.addProperty("OnEndDrag",0,pas["WEBLib.Controls"].$rtti.TEndDragEvent,"FonEndDrag","FonEndDrag"),e.addProperty("OnStartDrag",0,pas["WEBLib.Controls"].$rtti.TStartDragEvent,"FOnStartDrag","FOnStartDrag")})),rtl.createClass(this,"TWebTrackBar",this.TTrackBar,(function(){rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TTimer",pas.Classes.TComponent,(function(){this.$init=function(){pas.Classes.TComponent.$init.call(this),this.FInterval=0,this.FTimerID=0,this.FOnTimer=null,this.FEnabled=!1},this.$final=function(){this.FOnTimer=void 0,pas.Classes.TComponent.$final.call(this)},this.SetEnabled=function(t){this.FEnabled=t,this.DoUpdateTimer()},this.SetInterval=function(t){this.FInterval=t,this.DoUpdateTimer()},this.DoTimer=function(){null!=this.FOnTimer&&this.FOnTimer(this)},this.DoUpdateTimer=function(){this.DoClearTimer(),this.FEnabled&&(this.FTimerID=window.setInterval(rtl.createSafeCallback(this,"DoTimer"),this.FInterval))},this.DoClearTimer=function(){-1!==this.FTimerID&&(window.clearInterval(this.FTimerID),this.FTimerID=-1)},this.Create$1=function(t){return pas.Classes.TComponent.Create$1.apply(this,arguments),this.FInterval=1e3,this.FTimerID=-1,this.SetEnabled(!0),this},this.Destroy=function(){this.DoClearTimer(),pas.Classes.TComponent.Destroy.call(this)},rtl.addIntf(this,pas.System.IUnknown);var t=this.$rtti;t.addProperty("Enabled",2,rtl.boolean,"FEnabled","SetEnabled",{Default:!0}),t.addProperty("Interval",2,rtl.longint,"FInterval","SetInterval",{Default:1e3}),t.addProperty("OnTimer",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnTimer","FOnTimer")})),rtl.createClass(this,"TWebTimer",this.TTimer,(function(){rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TCustomPanel",pas["WEBLib.Menus"].TWebCustomControl,(function(){this.$init=function(){pas["WEBLib.Menus"].TWebCustomControl.$init.call(this),this.FAutoSize=!1,this.FIsSizing=!1,this.FPadding=null,this.FShowCaption=!1,this.FLabel=null,this.FPanelBody=null,this.FElementBodyClassName="",this.FAlignment=0},this.$final=function(){this.FPadding=void 0,this.FLabel=void 0,this.FPanelBody=void 0,pas["WEBLib.Menus"].TWebCustomControl.$final.call(this)},this.SetShowCaption=function(t){this.FShowCaption!==t&&(this.FShowCaption=t,this.UpdateElementVisual())},this.SetPadding=function(t){this.FPadding.Assign(t)},this.SetAlignment=function(t){this.FAlignment!==t&&(this.FAlignment=t,this.UpdateElement())},this.CreateElement=function(){var t=null;return t=document.createElement("SPAN"),this.FPanelBody=document.createElement("DIV"),this.FPanelBody.setAttribute("class","card-body"),t.appendChild(this.FPanelBody),t},this.SetCaption=function(t){pas["WEBLib.Controls"].TCustomControl.SetCaption.call(this,t),null!=this.GetElementHandle()&&this.FShowCaption&&(null==this.FLabel?(this.FLabel=document.createElement("SPAN"),this.FLabel.innerHTML=this.FCaption,null!=this.GetChildContainer()?this.GetChildContainer().appendChild(this.FLabel):this.GetElementHandle().appendChild(this.FLabel),this.UpdateElementVisual()):this.FLabel.innerHTML=this.FCaption)},this.SetBorderStyle=function(t){pas["WEBLib.Controls"].TCustomControl.SetBorderStyle.apply(this,arguments),this.UpdateElement()},this.SetAutoSize=function(t){this.FAutoSize=t,this.FAutoSize&&!this.IsUpdating()&&this.DoAutoSize()},this.UpdateElementVisual=function(){if(pas["WEBLib.Controls"].TCustomControl.UpdateElementVisual.call(this),null!=this.GetElementHandle()){if(this.GetIsLinked()||(this.FAutoSize?(this.GetElementHandle().style.setProperty("overflow",""),this.GetElementHandle().style.setProperty("white-space","normal"),this.FVisible&&this.GetElementHandle().style.setProperty("display","inline")):(this.GetElementHandle().style.setProperty("overflow","hidden"),this.GetElementHandle().style.setProperty("white-space","nowrap"),this.FVisible&&this.GetElementHandle().style.setProperty("display","inline-block")),this.GetElementHandle().style.setProperty("padding-left",pas.SysUtils.IntToStr(this.FPadding.FLeft)+"px"),this.GetElementHandle().style.setProperty("padding-right",pas.SysUtils.IntToStr(this.FPadding.FRight)+"px"),this.GetElementHandle().style.setProperty("padding-top",pas.SysUtils.IntToStr(this.FPadding.FTop)+"px"),this.GetElementHandle().style.setProperty("padding-bottom",pas.SysUtils.IntToStr(this.FPadding.FBottom)+"px"),this.GetElementHandle().style.setProperty("box-sizing","border-box"),""!==this.FElementBodyClassName?this.GetChildContainer().setAttribute("class",this.FElementBodyClassName):this.GetChildContainer().removeAttribute("class")),null!=this.FLabel&&(this.FShowCaption?this.FLabel.innerHTML=this.FCaption:this.FLabel.innerHTML="",this.FVisible)){this.GetElementHandle().style.setProperty("display","flex");var t=this.FAlignment;0===t?this.GetElementHandle().style.setProperty("justify-content","flex-start"):2===t?this.GetElementHandle().style.setProperty("justify-content","center"):1===t&&this.GetElementHandle().style.setProperty("justify-content","flex-end"),this.GetElementHandle().style.setProperty("align-items","center")}this.GetElementHandle().style.setProperty("user-select",""),0===this.FCursor&&this.GetElementHandle().style.setProperty("cursor","")}},this.GetOuterWidth=function(){return pas["WEBLib.Controls"].TControl.GetOuterWidth.call(this)},this.GetOuterHeight=function(){return pas["WEBLib.Controls"].TControl.GetOuterHeight.call(this)},this.GetChildContainer=function(){return null!=this.FPanelBody?this.FPanelBody:pas["WEBLib.Controls"].TControl.GetChildContainer.call(this)},this.RegisterParent=function(t){pas["WEBLib.Controls"].TControl.RegisterParent.apply(this,arguments),this.FAutoSize&&this.DoAutoSize()},this.UnRegisterParent=function(t){pas["WEBLib.Controls"].TControl.UnRegisterParent.apply(this,arguments),this.FAutoSize&&this.DoAutoSize()},this.DoAutoSize=function(){var t=0,e=0,i=0,s=0,o=0,n=null,r=null;if(!this.FIsSizing){if(this.FIsSizing=!0,1===this.FWidthStyle&&1===this.FHeightStyle){s=0,o=0,e=65535,i=65535;for(var a=0,l=this.GetControlsCount()-1;a<=l;a++)t=a,1===this.GetControls(t).FWidthStyle?(this.GetControls(t).GetLeft()+this.GetControls(t).GetWidth()>s&&(s=this.GetControls(t).GetLeft()+this.GetControls(t).GetWidth()),this.GetControls(t).GetLeft()<e&&(e=this.GetControls(t).GetLeft())):null!=(r=this.GetControls(t).GetElementHandle())&&((n=r.getBoundingClientRect()).x-this.GetLeft()+n.width>s&&(s=Math.round(n.x-this.GetLeft()+n.width)),e=0),1===this.GetControls(t).FHeightStyle?(this.GetControls(t).GetTop()+this.GetControls(t).GetHeight()>o&&(o=this.GetControls(t).GetTop()+this.GetControls(t).GetHeight()),this.GetControls(t).GetTop()<i&&(i=this.GetControls(t).GetTop())):null!=(r=this.GetControls(t).GetElementHandle())&&((n=r.getBoundingClientRect()).y-this.GetTop()+n.height>o&&(o=Math.round(n.y-this.GetTop()+n.height)),i=0);if(4 in this.FComponentState&&(0===this.GetControlsCount()||0===s||0===o))return;1===this.FBorderStyle&&(s+=1,o+=1);for(var h=0,F=this.GetControlsCount()-1;h<=F;h++)t=h,this.GetControls(t).SetLeft(this.GetControls(t).GetLeft()-e),this.GetControls(t).SetTop(this.GetControls(t).GetTop()-i);this.SetWidth(s-e),this.SetHeight(o-i)}else this.SetWidth(-1),this.SetHeight(-1);this.UpdateElement(),this.FIsSizing=!1}},this.AlignControl=function(t){pas["WEBLib.Controls"].TControl.AlignControl.apply(this,arguments),this.FAutoSize&&this.DoAutoSize()},this.CreateInitialize=function(){pas["WEBLib.Controls"].TCustomControl.CreateInitialize.call(this),4 in this.FComponentState&&(this.FEnablePropagation=!0),this.FAutoSize=!1,this.FAlignment=2,this.SetColor(15790320),this.SetTabStop(!1),this.FCustomBorder=!0,this.SetShowCaption(!0),this.FControlStyle=rtl.unionSet(this.FControlStyle,rtl.createSet(0)),this.FLabel=null,this.FPadding=pas["WEBLib.Controls"].TPadding.$create("Create$1"),4 in this.FComponentState&&(this.SetWidth(400),this.SetHeight(300))},this.Destroy=function(){rtl.free(this,"FPadding"),pas["WEBLib.Controls"].TCustomControl.Destroy.call(this)},this.EndUpdate=function(){pas["WEBLib.Controls"].TCustomControl.EndUpdate.call(this),this.FAutoSize&&this.SetAutoSize(!0)},this.SetBounds=function(t,e,i,s){pas["WEBLib.Controls"].TControl.SetBounds.apply(this,arguments),this.FAutoSize&&this.DoAutoSize()},rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TPanel",this.TCustomPanel,(function(){rtl.addIntf(this,pas.System.IUnknown);var t=this.$rtti;t.addProperty("Align",2,pas["WEBLib.Controls"].$rtti.TAlign,"FAlign","SetAlign",{Default:pas["WEBLib.Controls"].TAlign.alNone}),t.addProperty("Alignment",2,pas.Classes.$rtti.TAlignment,"FAlignment","SetAlignment",{Default:pas.Classes.TAlignment.taCenter}),t.addProperty("AlignWithMargins",2,rtl.boolean,"FAlignWithMargins","SetAlignWithMargins",{Default:!1}),t.addProperty("Anchors",2,pas["WEBLib.Controls"].$rtti.TAnchors,"FAnchors","SetAnchors",{Default:rtl.createSet(0,1)}),t.addProperty("AutoSize",2,rtl.boolean,"FAutoSize","SetAutoSize",{Default:!1}),t.addProperty("BorderColor",2,pas["WEBLib.Graphics"].$rtti.TColor,"FBorderColor","SetBorderColor",{Default:12632256}),t.addProperty("BorderStyle",2,pas["WEBLib.Controls"].$rtti.TBorderStyle,"FBorderStyle","SetBorderStyle",{Default:pas["WEBLib.Controls"].TBorderStyle.bsSingle}),t.addProperty("Caption",2,rtl.string,"FCaption","SetCaption"),t.addProperty("ChildOrder",2,rtl.longint,"FChildOrder","SetChildOrderEx",{Default:0}),t.addProperty("Color",2,pas["WEBLib.Graphics"].$rtti.TColor,"FColor","SetColor"),t.addProperty("DragMode",2,pas["WEBLib.Controls"].$rtti.TDragMode,"FDragMode","SetDragMode",{Default:pas["WEBLib.Controls"].TDragMode.dmManual}),t.addProperty("ElementBodyClassName",0,pas["WEBLib.Controls"].$rtti.TElementClassName,"FElementBodyClassName","FElementBodyClassName"),t.addProperty("ElementID",3,pas["WEBLib.Controls"].$rtti.TElementID,"GetID","SetID"),t.addProperty("ElementFont",2,pas["WEBLib.Controls"].$rtti.TElementFont,"FElementFont","SetElementFont",{Default:pas["WEBLib.Controls"].TElementFont.efProperty}),t.addProperty("ElementPosition",2,pas["WEBLib.Controls"].$rtti.TElementPosition,"FElementPosition","SetElementPosition",{Default:pas["WEBLib.Controls"].TElementPosition.epAbsolute}),t.addProperty("Font",2,pas["WEBLib.Graphics"].$rtti.TFont,"FFont","SetFont"),t.addProperty("HeightPercent",2,rtl.double,"FHeightPercent","SetHeightPercent",{Default:100}),t.addProperty("HeightStyle",2,pas["WEBLib.Controls"].$rtti.TSizeStyle,"FHeightStyle","SetHeightStyle",{Default:pas["WEBLib.Controls"].TSizeStyle.ssAbsolute}),t.addProperty("Margins",2,pas["WEBLib.Controls"].$rtti.TMargins,"FMargins","SetMargins"),t.addProperty("Padding",2,pas["WEBLib.Controls"].$rtti.TPadding,"FPadding","SetPadding"),t.addProperty("ParentFont",2,rtl.boolean,"FParentFont","SetParentFont",{Default:!0}),t.addProperty("PopupMenu",0,pas["WEBLib.Menus"].$rtti.TPopupMenu,"FPopupMenu","FPopupMenu"),t.addProperty("Role",3,rtl.string,"GetRole","SetRole"),t.addProperty("ShowCaption",2,rtl.boolean,"FShowCaption","SetShowCaption",{Default:!0}),t.addProperty("WidthPercent",2,rtl.double,"FWidthPercent","SetWidthPercent",{Default:100}),t.addProperty("WidthStyle",2,pas["WEBLib.Controls"].$rtti.TSizeStyle,"FWidthStyle","SetWidthStyle",{Default:pas["WEBLib.Controls"].TSizeStyle.ssAbsolute}),t.addProperty("OnClick",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnClick","FOnClick"),t.addProperty("OnDblClick",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnDblClick","FOnDblClick"),t.addProperty("OnDragDrop",0,pas["WEBLib.Controls"].$rtti.TDragDropEvent,"FOnDragDrop","FOnDragDrop"),t.addProperty("OnDragOver",0,pas["WEBLib.Controls"].$rtti.TDragOverEvent,"FOnDragOver","FOnDragOver"),t.addProperty("OnEndDrag",0,pas["WEBLib.Controls"].$rtti.TEndDragEvent,"FonEndDrag","FonEndDrag"),t.addProperty("OnStartDrag",0,pas["WEBLib.Controls"].$rtti.TStartDragEvent,"FOnStartDrag","FOnStartDrag")})),rtl.createClass(this,"TWebPanel",this.TPanel,(function(){rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TScrollBox",this.TCustomPanel,(function(){this.$init=function(){t.TCustomPanel.$init.call(this),this.FAutoScroll=!1,this.FScrollBars=0,this.FScrollPtr=null,this.FOnScroll=null,this.FVertScrollBar=null,this.FHorzScrollBar=null},this.$final=function(){this.FOnScroll=void 0,this.FVertScrollBar=void 0,this.FHorzScrollBar=void 0,t.TCustomPanel.$final.call(this)},this.SetScrollBars=function(t){this.FScrollBars!==t&&(this.FScrollBars=t,this.UpdateElement())},this.UpdateElement=function(){if(pas["WEBLib.Controls"].TControl.UpdateElement.call(this),null!=this.GetElementHandle()&&!this.IsUpdating()){var t=this.FScrollBars;0===t?this.GetElementHandle().style.setProperty("overflow","hidden"):2===t?(this.GetElementHandle().style.removeProperty("overflow"),this.GetElementHandle().style.setProperty("overflow-x","hidden"),this.GetElementHandle().style.setProperty("overflow-y","auto")):1===t?(this.GetElementHandle().style.removeProperty("overflow"),this.GetElementHandle().style.setProperty("overflow-x","auto"),this.GetElementHandle().style.setProperty("overflow-y","hidden")):3===t&&this.GetElementHandle().style.setProperty("overflow","auto"),this.FVisible&&!this.GetIsLinked()&&this.GetElementHandle().style.setProperty("display","inline-block")}},this.SetAutoScroll=function(t){this.FAutoScroll=t},this.GetClientRect=function(){var t=pas.Types.TRect.$new(),e=0,i=0;return e=0,i=0,this.GetElementHandle().scrollHeight>this.GetElementHandle().clientHeight&&this.FScrollBars in rtl.createSet(3,2)&&(e=16),this.GetElementHandle().scrollWidth>this.GetElementHandle().clientWidth&&this.FScrollBars in rtl.createSet(3,1)&&(i=16),t.$assign(pas.Types.Rect(0,0,this.GetElementHandle().clientWidth-e,this.GetElementHandle().clientHeight-i)),t},this.HandleDoScroll=function(t){return this.DoScroll(),!0,!0},this.DoScroll=function(){null!=this.FOnScroll&&this.FOnScroll(this)},this.ClearMethodPointers=function(){pas["WEBLib.Controls"].TControl.ClearMethodPointers.call(this),this.FScrollPtr=null},this.GetMethodPointers=function(){pas["WEBLib.Controls"].TControl.GetMethodPointers.call(this),null===this.FScrollPtr&&(this.FScrollPtr=rtl.createCallback(this,"HandleDoScroll"))},this.BindEvents=function(){pas["WEBLib.Controls"].TCustomControl.BindEvents.call(this),null!=this.GetElementBindHandle()&&this.GetElementBindHandle().addEventListener("scroll",this.FScrollPtr)},this.UnbindEvents=function(){pas["WEBLib.Controls"].TControl.UnbindEvents.call(this),null!=this.GetElementBindHandle()&&this.GetElementBindHandle().removeEventListener("scroll",this.FScrollPtr)},this.CreateInitialize=function(){t.TCustomPanel.CreateInitialize.call(this),this.FAutoScroll=!0,this.FScrollBars=3,this.FHorzScrollBar=pas["WEBLib.Controls"].TControlScrollBar.$create("Create$1",[this,0]),this.FVertScrollBar=pas["WEBLib.Controls"].TControlScrollBar.$create("Create$1",[this,1])},this.Destroy=function(){rtl.free(this,"FHorzScrollBar"),rtl.free(this,"FVertScrollBar"),t.TCustomPanel.Destroy.call(this)},this.EndUpdate=function(){t.TCustomPanel.EndUpdate.call(this),this.AlignControl(this),this.AlignControl(this)},rtl.addIntf(this,pas.System.IUnknown);var e=this.$rtti;e.addProperty("Align",2,pas["WEBLib.Controls"].$rtti.TAlign,"FAlign","SetAlign",{Default:pas["WEBLib.Controls"].TAlign.alNone}),e.addProperty("AlignWithMargins",2,rtl.boolean,"FAlignWithMargins","SetAlignWithMargins",{Default:!1}),e.addProperty("Anchors",2,pas["WEBLib.Controls"].$rtti.TAnchors,"FAnchors","SetAnchors",{Default:rtl.createSet(0,1)}),e.addProperty("AutoScroll",2,rtl.boolean,"FAutoScroll","SetAutoScroll"),e.addProperty("BorderStyle",2,pas["WEBLib.Controls"].$rtti.TBorderStyle,"FBorderStyle","SetBorderStyle",{Default:pas["WEBLib.Controls"].TBorderStyle.bsSingle}),e.addProperty("Color",2,pas["WEBLib.Graphics"].$rtti.TColor,"FColor","SetColor"),e.addProperty("DragMode",2,pas["WEBLib.Controls"].$rtti.TDragMode,"FDragMode","SetDragMode",{Default:pas["WEBLib.Controls"].TDragMode.dmManual}),e.addProperty("ElementFont",2,pas["WEBLib.Controls"].$rtti.TElementFont,"FElementFont","SetElementFont",{Default:pas["WEBLib.Controls"].TElementFont.efProperty}),e.addProperty("ElementID",3,pas["WEBLib.Controls"].$rtti.TElementID,"GetID","SetID"),e.addProperty("ElementPosition",2,pas["WEBLib.Controls"].$rtti.TElementPosition,"FElementPosition","SetElementPosition",{Default:pas["WEBLib.Controls"].TElementPosition.epAbsolute}),e.addProperty("HeightPercent",2,rtl.double,"FHeightPercent","SetHeightPercent",{Default:100}),e.addProperty("HeightStyle",2,pas["WEBLib.Controls"].$rtti.TSizeStyle,"FHeightStyle","SetHeightStyle",{Default:pas["WEBLib.Controls"].TSizeStyle.ssAbsolute}),e.addProperty("Margins",2,pas["WEBLib.Controls"].$rtti.TMargins,"FMargins","SetMargins"),e.addProperty("PopupMenu",0,pas["WEBLib.Menus"].$rtti.TPopupMenu,"FPopupMenu","FPopupMenu"),e.addProperty("Role",3,rtl.string,"GetRole","SetRole"),e.addProperty("ScrollBars",2,pas["WEBLib.Controls"].$rtti.TScrollStyle,"FScrollBars","SetScrollBars"),e.addProperty("WidthPercent",2,rtl.double,"FWidthPercent","SetWidthPercent",{Default:100}),e.addProperty("WidthStyle",2,pas["WEBLib.Controls"].$rtti.TSizeStyle,"FWidthStyle","SetWidthStyle",{Default:pas["WEBLib.Controls"].TSizeStyle.ssAbsolute}),e.addProperty("OnClick",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnClick","FOnClick"),e.addProperty("OnDblClick",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnDblClick","FOnDblClick"),e.addProperty("OnMouseDown",0,pas["WEBLib.Controls"].$rtti.TMouseEvent,"FOnMouseDown","FOnMouseDown"),e.addProperty("OnMouseMove",0,pas["WEBLib.Controls"].$rtti.TMouseMoveEvent,"FOnMouseMove","FOnMouseMove"),e.addProperty("OnMouseUp",0,pas["WEBLib.Controls"].$rtti.TMouseEvent,"FOnMouseUp","FOnMouseUp"),e.addProperty("OnResize",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnResize","FOnResize"),e.addProperty("OnDragDrop",0,pas["WEBLib.Controls"].$rtti.TDragDropEvent,"FOnDragDrop","FOnDragDrop"),e.addProperty("OnDragOver",0,pas["WEBLib.Controls"].$rtti.TDragOverEvent,"FOnDragOver","FOnDragOver"),e.addProperty("OnEndDrag",0,pas["WEBLib.Controls"].$rtti.TEndDragEvent,"FonEndDrag","FonEndDrag"),e.addProperty("OnScroll",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnScroll","FOnScroll"),e.addProperty("OnStartDrag",0,pas["WEBLib.Controls"].$rtti.TStartDragEvent,"FOnStartDrag","FOnStartDrag")})),this.TVerticalAlignment={0:"vaTop",vaTop:0,1:"vaCenter",vaCenter:1,2:"vaBottom",vaBottom:2},this.$rtti.$Enum("TVerticalAlignment",{minvalue:0,maxvalue:2,ordtype:1,enumtype:this.TVerticalAlignment}),this.TGridPanelExpandStyle={0:"esAddRows",esAddRows:0,1:"esAddColumns",esAddColumns:1},this.$rtti.$Enum("TGridPanelExpandStyle",{minvalue:0,maxvalue:1,ordtype:1,enumtype:this.TGridPanelExpandStyle}),rtl.createClass(this,"TGridPanelRow",pas.Classes.TCollectionItem,(function(){this.$init=function(){pas.Classes.TCollectionItem.$init.call(this),this.FSizeStyle=0,this.FValue=0,this.FMarginBottom=0,this.FMarginTop=0,this.FAlignment=0,this.FElementClassName=""},this.SetMarginBottom=function(t){this.FMarginBottom!==t&&(this.FMarginBottom=t,this.FCollection.Update(this))},this.SetMarginTop=function(t){this.FMarginTop!==t&&(this.FMarginTop=t,this.FCollection.Update(this))},this.SetSizeStyle=function(t){this.FSizeStyle!==t&&(this.FSizeStyle=t,this.FCollection.Update(this))},this.SetValue=function(t){this.FValue!==t&&(this.FValue=t,this.FCollection.Update(this))},this.HeightAttribute=function(){var t="";t="";var e=this.FSizeStyle;return 0===e?t=pas.SysUtils.IntToStr(this.FValue)+"%":1===e&&(t=pas.SysUtils.IntToStr(this.FValue)+"px"),t},this.Create$1=function(t){return pas.Classes.TCollectionItem.Create$1.apply(this,arguments),this.FSizeStyle=0,this.FAlignment=0,this.FMarginTop=0,this.FMarginBottom=0,this},this.Assign=function(e){t.TGridPanelRow.isPrototypeOf(e)&&(this.FAlignment=rtl.as(e,t.TGridPanelRow).FAlignment,this.FSizeStyle=rtl.as(e,t.TGridPanelRow).FSizeStyle,this.FElementClassName=rtl.as(e,t.TGridPanelRow).FElementClassName,this.FValue=rtl.as(e,t.TGridPanelRow).FValue,this.FMarginTop=rtl.as(e,t.TGridPanelRow).FMarginTop,this.FMarginBottom=rtl.as(e,t.TGridPanelRow).FMarginBottom)};var e=this.$rtti;e.addProperty("Alignment",0,t.$rtti.TVerticalAlignment,"FAlignment","FAlignment",{Default:t.TVerticalAlignment.vaTop}),e.addProperty("ElementClassName",0,rtl.string,"FElementClassName","FElementClassName"),e.addProperty("MarginTop",2,rtl.longint,"FMarginTop","SetMarginTop"),e.addProperty("MarginBottom",2,rtl.longint,"FMarginBottom","SetMarginBottom"),e.addProperty("SizeStyle",2,pas["WEBLib.Controls"].$rtti.TSizeStyle,"FSizeStyle","SetSizeStyle"),e.addProperty("Value",2,rtl.longint,"FValue","SetValue")})),rtl.createClass(this,"TGridPanelRows",pas.Classes.TOwnedCollection,(function(){this.$init=function(){pas.Classes.TOwnedCollection.$init.call(this),this.FOnChange=null},this.$final=function(){this.FOnChange=void 0,pas.Classes.TOwnedCollection.$final.call(this)},this.GetItem$1=function(t){return this.GetItem(t)},this.Update=function(t){pas.Classes.TCollection.Update.apply(this,arguments),null!=this.FOnChange&&this.FOnChange(this)},this.Create$3=function(e){return pas.Classes.TOwnedCollection.Create$2.call(this,e,t.TGridPanelRow),this},this.Add$1=function(){return pas.Classes.TCollection.Add.call(this)}})),rtl.createClass(this,"TGridPanelColumn",pas.Classes.TCollectionItem,(function(){this.$init=function(){pas.Classes.TCollectionItem.$init.call(this),this.FSizeStyle=0,this.FValue=0,this.FMarginLeft=0,this.FAlignment=0,this.FMarginRight=0,this.FElementClassName=""},this.SetMarginLeft=function(t){this.FMarginLeft!==t&&(this.FMarginLeft=t,this.FCollection.Update(this))},this.SetMarginRight=function(t){this.FMarginRight!==t&&(this.FMarginRight=t,this.FCollection.Update(this))},this.SetSizeStyle=function(t){this.FSizeStyle!==t&&(this.FSizeStyle=t,this.FCollection.Update(this))},this.SetValue=function(t){this.FValue!==t&&(this.FValue=t,this.FCollection.Update(this))},this.WidthAttribute=function(){var t="";t="";var e=this.FSizeStyle;return 0===e?t=pas.SysUtils.IntToStr(this.FValue)+"%":1===e&&(t=pas.SysUtils.IntToStr(this.FValue)+"px"),t},this.Create$1=function(t){return pas.Classes.TCollectionItem.Create$1.apply(this,arguments),this.FSizeStyle=0,this.FValue=0,this.FMarginLeft=0,this.FMarginRight=0,this.FAlignment=0,this},this.Assign=function(e){t.TGridPanelColumn.isPrototypeOf(e)&&(this.FAlignment=rtl.as(e,t.TGridPanelColumn).FAlignment,this.FSizeStyle=rtl.as(e,t.TGridPanelColumn).FSizeStyle,this.FElementClassName=rtl.as(e,t.TGridPanelColumn).FElementClassName,this.FValue=rtl.as(e,t.TGridPanelColumn).FValue,this.FMarginLeft=rtl.as(e,t.TGridPanelColumn).FMarginLeft,this.FMarginRight=rtl.as(e,t.TGridPanelColumn).FMarginRight)};var e=this.$rtti;e.addProperty("Alignment",0,pas.Classes.$rtti.TAlignment,"FAlignment","FAlignment",{Default:pas.Classes.TAlignment.taLeftJustify}),e.addProperty("ElementClassName",0,rtl.string,"FElementClassName","FElementClassName"),e.addProperty("MarginLeft",2,rtl.longint,"FMarginLeft","SetMarginLeft",{Default:0}),e.addProperty("MarginRight",2,rtl.longint,"FMarginRight","SetMarginRight",{Default:0}),e.addProperty("SizeStyle",2,pas["WEBLib.Controls"].$rtti.TSizeStyle,"FSizeStyle","SetSizeStyle",{Default:pas["WEBLib.Controls"].TSizeStyle.ssPercent}),e.addProperty("Value",2,rtl.longint,"FValue","SetValue")})),rtl.createClass(this,"TGridPanelColumns",pas.Classes.TOwnedCollection,(function(){this.$init=function(){pas.Classes.TOwnedCollection.$init.call(this),this.FOnChange=null},this.$final=function(){this.FOnChange=void 0,pas.Classes.TOwnedCollection.$final.call(this)},this.GetItem$1=function(t){return this.GetItem(t)},this.Update=function(t){pas.Classes.TCollection.Update.apply(this,arguments),null!=this.FOnChange&&this.FOnChange(this)},this.Create$3=function(e){return pas.Classes.TOwnedCollection.Create$2.call(this,e,t.TGridPanelColumn),this},this.Add$1=function(){return pas.Classes.TCollection.Add.call(this)}})),rtl.createClass(this,"TControlCollectionItem",pas.Classes.TCollectionItem,(function(){this.$init=function(){pas.Classes.TCollectionItem.$init.call(this),this.FControl=null,this.FRow=0,this.FColumn=0},this.$final=function(){this.FControl=void 0,pas.Classes.TCollectionItem.$final.call(this)},this.Assign=function(e){t.TControlCollectionItem.isPrototypeOf(e)&&(this.FColumn=rtl.as(e,t.TControlCollectionItem).FColumn,this.FRow=rtl.as(e,t.TControlCollectionItem).FRow,this.FControl=rtl.as(e,t.TControlCollectionItem).FControl)};var e=this.$rtti;e.addProperty("Column",0,rtl.longint,"FColumn","FColumn"),e.addProperty("Row",0,rtl.longint,"FRow","FRow"),e.addProperty("Control",0,pas["WEBLib.Controls"].$rtti.TWinControl,"FControl","FControl")})),rtl.createClass(this,"TControlCollection",pas.Classes.TOwnedCollection,(function(){this.GetItem$1=function(t){return this.GetItem(t)},this.Create$3=function(e){return pas.Classes.TOwnedCollection.Create$2.call(this,e,t.TControlCollectionItem),this},this.Add$1=function(){return pas.Classes.TCollection.Add.call(this)}})),rtl.createClass(this,"TGridPanel",pas["WEBLib.Menus"].TWebCustomControl,(function(){this.$init=function(){pas["WEBLib.Menus"].TWebCustomControl.$init.call(this),this.FDesignTime=!1,this.FUpdateTable=!1,this.FColCount=0,this.FRowCollection=null,this.FColumnCollection=null,this.FControlCollection=null,this.FGridLineWidth=0,this.FGridLineColor=0,this.FExpandStyle=0,this.FTbl=null,this.FTblBody=null},this.$final=function(){this.FRowCollection=void 0,this.FColumnCollection=void 0,this.FControlCollection=void 0,this.FTbl=void 0,this.FTblBody=void 0,pas["WEBLib.Menus"].TWebCustomControl.$final.call(this)},this.SetColumnCollection=function(t){this.FColumnCollection.Assign(t)},this.SetRowCollection=function(t){this.FRowCollection.Assign(t)},this.SetControlCollection=function(t){this.FControlCollection.Assign(t)},this.CreateTable=function(){var t=null,e=0,i="";this.FTbl=document.createElement("table"),this.FTbl.setAttribute("width","100%"),this.FTbl.setAttribute("height","100%"),""!==this.FElementClassName?this.FTbl.setAttribute("class",this.FElementClassName):(i=-1!==this.FGridLineColor&&this.FGridLineWidth>0?pas.SysUtils.IntToStr(this.FGridLineWidth)+"px solid "+pas["WEBLib.Graphics"].ColorToHTML(this.FGridLineColor):4 in this.FComponentState?"1px dotted gray":"0px",this.FTbl.style.setProperty("border",i),this.FTbl.style.setProperty("border-collapse","collapse")),pas["WEBLib.Controls"].SetHTMLElementColor(this.FTbl,this.FColor,!(""===this.FElementClassName&&!this.GetIsLinked())),this.FTblBody=document.createElement("tbody");for(var s=0,o=this.FRowCollection.GetCount()-1;s<=o;s++)e=s,t=this.CreateRow(e),this.FTblBody.appendChild(t);return this.FTbl.appendChild(this.FTblBody),this.FTbl},this.CreateRow=function(t){var e=null,i=null,s=0,o="";o=-1!==this.FGridLineColor&&this.FGridLineWidth>0?pas.SysUtils.IntToStr(this.FGridLineWidth)+"px solid "+pas["WEBLib.Graphics"].ColorToHTML(this.FGridLineColor):4 in this.FComponentState?"1px dotted gray":"0px",e=document.createElement("tr"),""===this.FElementClassName&&e.style.setProperty("border",o),0!==this.FRowCollection.GetItem$1(t).FMarginTop&&e.style.setProperty("margin-top",pas.SysUtils.IntToStr(this.FRowCollection.GetItem$1(t).FMarginTop)),0!==this.FRowCollection.GetItem$1(t).FMarginBottom&&e.style.setProperty("margin-bottom",pas.SysUtils.IntToStr(this.FRowCollection.GetItem$1(t).FMarginBottom)),""!==this.FRowCollection.GetItem$1(t).FElementClassName&&e.setAttribute("class",this.FRowCollection.GetItem$1(t).FElementClassName);var n=this.FRowCollection.GetItem$1(t).FAlignment;1===n?e.setAttribute("valign","middle"):2===n&&e.setAttribute("valign","bottom"),""===this.FElementClassName&&e.style.setProperty("border",o),e.setAttribute("height",this.FRowCollection.GetItem$1(t).HeightAttribute());for(var r=0,a=this.FColumnCollection.GetCount()-1;r<=a;r++){s=r,i=document.createElement("td"),""===this.FElementClassName&&i.style.setProperty("border",o),0!==this.FColumnCollection.GetItem$1(s).FMarginLeft&&i.style.setProperty("padding-left",pas.SysUtils.IntToStr(this.FColumnCollection.GetItem$1(s).FMarginLeft)+"px"),0!==this.FColumnCollection.GetItem$1(s).FMarginRight&&i.style.setProperty("padding-right",pas.SysUtils.IntToStr(this.FColumnCollection.GetItem$1(s).FMarginRight)+"px"),""!==this.FColumnCollection.GetItem$1(s).FElementClassName&&i.setAttribute("class",this.FColumnCollection.GetItem$1(s).FElementClassName);var l=this.FColumnCollection.GetItem$1(s).FAlignment;2===l?i.setAttribute("align","center"):1===l&&i.setAttribute("align","right"),i.setAttribute("id",this.FName+"R"+pas.SysUtils.IntToStr(t)+"C"+pas.SysUtils.IntToStr(s)),0===t&&i.style.setProperty("width",this.FColumnCollection.GetItem$1(s).WidthAttribute()),e.appendChild(i)}return e},this.CreateElement=function(){return document.createElement("SPAN")},this.AlignControl=function(t){3 in this.FComponentState||this.UpdateTable(),pas["WEBLib.Controls"].TControl.AlignControl.apply(this,arguments)},this.UpdateTable=function(){var t=0,e=0,i=0,s=0,o=0,n=null,r="",a=null,l=null,h=null,F=!1,p=0;if(null!=this.FTblBody&&!this.IsUpdating()&&!(3 in this.FComponentState)){F=!0,s=0;for(var c=0,u=this.FRowCollection.GetCount()-1;c<=u;c++){if(t=c,0!==this.FRowCollection.GetItem$1(t).FSizeStyle){F=!1;break}s+=this.FRowCollection.GetItem$1(t).FValue}if(F&&s>100){p=s/100;for(var C=0,T=this.FRowCollection.GetCount()-1;C<=T;C++)t=C,this.FRowCollection.GetItem$1(t).FValue=pas.System.Trunc(this.FRowCollection.GetItem$1(t).FValue/p)}F=!0,s=0;for(var S=0,d=this.FColumnCollection.GetCount()-1;S<=d;S++){if(t=S,0!==this.FColumnCollection.GetItem$1(t).FSizeStyle){F=!1;break}s+=this.FColumnCollection.GetItem$1(t).FValue}if(F&&s>100){p=s/100;for(var m=0,f=this.FColumnCollection.GetCount()-1;m<=f;m++)t=m,this.FColumnCollection.GetItem$1(t).FValue=pas.System.Trunc(this.FColumnCollection.GetItem$1(t).FValue/p)}for(o=this.FRowCollection.GetCount(),this.FColCount!==this.FColumnCollection.GetCount()&&(o=0);this.FTblBody.childNodes.length>o;)this.FTblBody.removeChild(this.FTblBody.childNodes.item(this.FTblBody.childNodes.length-1));for(;this.FTblBody.childNodes.length<this.FRowCollection.GetCount();)h=this.CreateRow(this.FTblBody.childNodes.length),this.FTblBody.appendChild(h);for(var g=0,y=this.FRowCollection.GetCount()-1;g<=y;g++)t=g,(h=this.FTblBody.childNodes.item(t)).setAttribute("height",this.FRowCollection.GetItem$1(t).HeightAttribute());t=0,e=0;for(var M=0,b=this.FControlCollection.GetCount()-1;M<=b;M++)i=M,null!=this.FControlCollection.GetItem$1(i).FControl&&(n=document.createDocumentFragment(),a=this.FControlCollection.GetItem$1(i).FControl,this.FControlCollection.GetItem$1(i).FColumn=t,this.FControlCollection.GetItem$1(i).FRow=e,a.SetElementPosition(1),a.SetChildOrderEx(-1),3===a.FAlign&&(a.SetHeightStyle(0),a.SetHeightPercent(100),null!=a.GetElementHandle()&&a.GetElementHandle().style.setProperty("float","left")),4===a.FAlign&&(a.SetHeightStyle(0),a.SetHeightPercent(100),null!=a.GetElementHandle()&&a.GetElementHandle().style.setProperty("float","right")),a.FAlign in rtl.createSet(1,2)&&(a.SetWidthStyle(0),a.SetWidthPercent(100)),5===a.FAlign&&(a.SetWidthStyle(0),a.SetHeightStyle(0),a.SetWidthPercent(100),a.SetHeightPercent(100)),null!=(h=this.FTblBody.childNodes.item(e))&&(h.setAttribute("height",this.FRowCollection.GetItem$1(e).HeightAttribute()),""!==this.FRowCollection.GetItem$1(e).FElementClassName?h.setAttribute("class",this.FRowCollection.GetItem$1(e).FElementClassName):h.removeAttribute("class")),null!=a.GetElementHandle()&&n.appendChild(a.GetElementHandle()),r=this.FName+"R"+pas.SysUtils.IntToStr(e)+"C"+pas.SysUtils.IntToStr(t),null==(l=document.getElementById(r))?(h=this.CreateRow(e),this.FTblBody.appendChild(h),l=document.getElementById(r),h.setAttribute("height",this.FRowCollection.GetItem$1(e).HeightAttribute())):0===e&&(1===this.FColumnCollection.GetItem$1(t).FSizeStyle?(this.FTbl.removeAttribute("width"),this.FTbl.removeAttribute("height")):(this.FTbl.setAttribute("width","100%"),this.FTbl.setAttribute("height","100%")),l.style.setProperty("width",this.FColumnCollection.GetItem$1(t).WidthAttribute())),null!=l&&(l.appendChild(n),1===a.FAlign&&l.style.setProperty("vertical-align","top"),2===a.FAlign&&l.style.setProperty("vertical-align","bottom")),(t+=1)===this.FColumnCollection.GetCount()&&(t=0,e+=1));for(var N=0,B=this.FColumnCollection.GetCount()-1;N<=B;N++)t=N,r=this.FName+"R0C"+pas.SysUtils.IntToStr(t),null!=(l=document.getElementById(r))&&l.style.setProperty("width",this.FColumnCollection.GetItem$1(t).WidthAttribute());this.FColCount=this.FColumnCollection.GetCount()}},this.UpdateElement=function(){pas["WEBLib.Controls"].TControl.UpdateElement.call(this),null==this.GetElementHandle()||this.IsUpdating()||(this.GetElementHandle().style.setProperty("user-select",""),0===this.FCursor&&this.GetElementHandle().style.setProperty("cursor",""),this.FUpdateTable&&null!=this.GetContainer()&&(this.GetContainer().appendChild(this.CreateTable()),this.UpdateTable(),this.FUpdateTable=!1))},this.UpdateElementVisual=function(){pas["WEBLib.Controls"].TCustomControl.UpdateElementVisual.call(this),4 in this.FComponentState&&this.GetElementHandle().style.setProperty("border","1px dotted gray")},this.RegisterParent=function(t){if(pas["WEBLib.Controls"].TControl.RegisterParent.apply(this,arguments),!this.IsUpdating()&&!(0 in this.FComponentState)){if(0 in t.FComponentState)return;this.FControlCollection.Add$1().FControl=t,this.FControlCollection.GetCount()>this.FColumnCollection.GetCount()*this.FRowCollection.GetCount()&&(0===this.FExpandStyle?this.FRowCollection.Add$1():this.FColumnCollection.Add$1()),this.UpdateTable()}},this.TableChanged=function(t){this.UpdateTable()},this.Notification=function(t,e){var i=0,s="",o=null;if(1===e&&!(3 in this.FComponentState)){for(var n=this.FControlCollection.GetCount()-1;n>=0;n--)i=n,this.FControlCollection.GetItem$1(i).FControl===t&&(s=this.FName+"R"+pas.SysUtils.IntToStr(this.FControlCollection.GetItem$1(i).FRow)+"C"+pas.SysUtils.IntToStr(this.FControlCollection.GetItem$1(i).FColumn),(o=document.getElementById(s)).removeChild(o.firstChild),this.FControlCollection.GetItem$1(i).FControl=null,this.FControlCollection.Delete(i));this.UpdateTable()}pas["WEBLib.Menus"].TWebCustomControl.Notification.apply(this,arguments)},this.CreateInitialize=function(){pas["WEBLib.Controls"].TCustomControl.CreateInitialize.call(this),this.FDesignTime=4 in this.FComponentState&&!(1 in this.FOwner.FComponentState||0 in this.FOwner.FComponentState),this.FEnablePropagation=!0,this.FControlStyle=rtl.unionSet(this.FControlStyle,rtl.createSet(0)),this.FUpdateTable=!0,this.FColCount=-1,this.FRowCollection=t.TGridPanelRows.$create("Create$3",[this]),this.FRowCollection.FPropName="RowCollection",this.FDesignTime&&!(0 in this.FComponentState)&&(this.FRowCollection.Add$1(),this.FRowCollection.GetItem$1(0).SetValue(100),this.FRowCollection.GetItem$1(0).SetSizeStyle(0)),this.FColumnCollection=t.TGridPanelColumns.$create("Create$3",[this]),this.FColumnCollection.FPropName="ColumnCollection",this.FDesignTime&&!(0 in this.FComponentState)&&(this.FColumnCollection.Add$1(),this.FColumnCollection.Add$1(),this.FColumnCollection.GetItem$1(0).SetValue(50),this.FColumnCollection.GetItem$1(1).SetValue(50),this.FColumnCollection.GetItem$1(0).SetSizeStyle(0),this.FColumnCollection.GetItem$1(1).SetSizeStyle(0)),this.FRowCollection.FOnChange=rtl.createCallback(this,"TableChanged"),this.FColumnCollection.FOnChange=rtl.createCallback(this,"TableChanged"),this.FControlCollection=t.TControlCollection.$create("Create$3",[this]),4 in this.FComponentState&&(this.SetWidth(400),this.SetHeight(300))},this.Destroy=function(){rtl.free(this,"FRowCollection"),rtl.free(this,"FColumnCollection"),rtl.free(this,"FControlCollection"),pas["WEBLib.Controls"].TCustomControl.Destroy.call(this)},this.EndUpdate=function(){pas["WEBLib.Controls"].TCustomControl.EndUpdate.call(this),this.UpdateTable()},rtl.addIntf(this,pas.System.IUnknown);var e=this.$rtti;e.addProperty("Align",2,pas["WEBLib.Controls"].$rtti.TAlign,"FAlign","SetAlign",{Default:pas["WEBLib.Controls"].TAlign.alNone}),e.addProperty("AlignWithMargins",2,rtl.boolean,"FAlignWithMargins","SetAlignWithMargins",{Default:!1}),e.addProperty("Anchors",2,pas["WEBLib.Controls"].$rtti.TAnchors,"FAnchors","SetAnchors",{Default:rtl.createSet(0,1)}),e.addProperty("Color",2,pas["WEBLib.Graphics"].$rtti.TColor,"FColor","SetColor"),e.addProperty("ControlCollection",2,t.$rtti.TControlCollection,"FControlCollection","SetControlCollection"),e.addProperty("ColumnCollection",2,t.$rtti.TGridPanelColumns,"FColumnCollection","SetColumnCollection"),e.addProperty("DragMode",2,pas["WEBLib.Controls"].$rtti.TDragMode,"FDragMode","SetDragMode",{Default:pas["WEBLib.Controls"].TDragMode.dmManual}),e.addProperty("ElementFont",2,pas["WEBLib.Controls"].$rtti.TElementFont,"FElementFont","SetElementFont",{Default:pas["WEBLib.Controls"].TElementFont.efProperty}),e.addProperty("ElementID",3,pas["WEBLib.Controls"].$rtti.TElementID,"GetID","SetID"),e.addProperty("ElementPosition",2,pas["WEBLib.Controls"].$rtti.TElementPosition,"FElementPosition","SetElementPosition",{Default:pas["WEBLib.Controls"].TElementPosition.epAbsolute}),e.addProperty("ExpandStyle",0,t.$rtti.TGridPanelExpandStyle,"FExpandStyle","FExpandStyle",{Default:t.TGridPanelExpandStyle.esAddRows}),e.addProperty("GridLineWidth",0,rtl.longint,"FGridLineWidth","FGridLineWidth",{Default:0}),e.addProperty("GridLineColor",0,pas["WEBLib.Graphics"].$rtti.TColor,"FGridLineColor","FGridLineColor",{Default:0}),e.addProperty("HeightPercent",2,rtl.double,"FHeightPercent","SetHeightPercent",{Default:100}),e.addProperty("HeightStyle",2,pas["WEBLib.Controls"].$rtti.TSizeStyle,"FHeightStyle","SetHeightStyle",{Default:pas["WEBLib.Controls"].TSizeStyle.ssAbsolute}),e.addProperty("Margins",2,pas["WEBLib.Controls"].$rtti.TMargins,"FMargins","SetMargins"),e.addProperty("PopupMenu",0,pas["WEBLib.Menus"].$rtti.TPopupMenu,"FPopupMenu","FPopupMenu"),e.addProperty("Role",3,rtl.string,"GetRole","SetRole"),e.addProperty("RowCollection",2,t.$rtti.TGridPanelRows,"FRowCollection","SetRowCollection"),e.addProperty("WidthPercent",2,rtl.double,"FWidthPercent","SetWidthPercent",{Default:100}),e.addProperty("WidthStyle",2,pas["WEBLib.Controls"].$rtti.TSizeStyle,"FWidthStyle","SetWidthStyle",{Default:pas["WEBLib.Controls"].TSizeStyle.ssAbsolute}),e.addProperty("OnDragDrop",0,pas["WEBLib.Controls"].$rtti.TDragDropEvent,"FOnDragDrop","FOnDragDrop"),e.addProperty("OnDragOver",0,pas["WEBLib.Controls"].$rtti.TDragOverEvent,"FOnDragOver","FOnDragOver"),e.addProperty("OnEndDrag",0,pas["WEBLib.Controls"].$rtti.TEndDragEvent,"FonEndDrag","FonEndDrag"),e.addProperty("OnStartDrag",0,pas["WEBLib.Controls"].$rtti.TStartDragEvent,"FOnStartDrag","FOnStartDrag")})),rtl.createClass(this,"TAccordionSection",pas.Classes.TCollectionItem,(function(){this.$init=function(){pas.Classes.TCollectionItem.$init.call(this),this.FCaption="",this.FContent="",this.FTag=0,this.FExpanded=!1,this.FControl=null},this.$final=function(){this.FControl=void 0,pas.Classes.TCollectionItem.$final.call(this)},this.SetExpanded=function(e){this.FExpanded!==e&&(this.FExpanded=e,this.FExpanded?rtl.as(rtl.as(this.FCollection,t.TAccordionSections).Owner(),t.TAccordion).Expand(this):rtl.as(rtl.as(this.FCollection,t.TAccordionSections).Owner(),t.TAccordion).Collapse(this))},this.SetCaption=function(e){this.FCaption=e,rtl.as(this.FCollection,t.TAccordionSections).Update(this)},this.SetContent=function(e){this.FContent=e,rtl.as(this.FCollection,t.TAccordionSections).Update(this)},this.Assign=function(e){t.TAccordionSection.isPrototypeOf(e)&&(this.FCaption=rtl.as(e,t.TAccordionSection).FCaption,this.FContent=rtl.as(e,t.TAccordionSection).FContent,this.FTag=rtl.as(e,t.TAccordionSection).FTag)},this.CaptionElement=function(){return document.getElementById(rtl.as(rtl.as(this.FCollection,t.TAccordionSections).Owner(),t.TAccordion).FName+"_"+pas.SysUtils.IntToStr(this.GetIndex()))};var e=this.$rtti;e.addProperty("Caption",2,rtl.string,"FCaption","SetCaption"),e.addProperty("Content",2,rtl.string,"FContent","SetContent"),e.addProperty("Tag",0,rtl.longint,"FTag","FTag")})),rtl.createClass(this,"TAccordionSections",pas.Classes.TOwnedCollection,(function(){this.$init=function(){pas.Classes.TOwnedCollection.$init.call(this),this.FOnChange=null},this.$final=function(){this.FOnChange=void 0,pas.Classes.TOwnedCollection.$final.call(this)},this.GetItem$1=function(t){return this.GetItem(t)},this.Update=function(t){pas.Classes.TCollection.Update.apply(this,arguments),null!=this.FOnChange&&0===this.FUpdateCount&&this.FOnChange(this)},this.Create$3=function(e){return pas.Classes.TOwnedCollection.Create$2.call(this,e,t.TAccordionSection),this},this.Add$1=function(){return pas.Classes.TCollection.Add.call(this)},this.Insert$1=function(t){return pas.Classes.TCollection.Insert.call(this,t)}})),this.$rtti.$MethodVar("TAccordionSectionEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ASection",this.$rtti.TAccordionSection]]),methodkind:0}),this.$rtti.$MethodVar("TAccordionSectionAllowEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ASection",this.$rtti.TAccordionSection],["Allow",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TAccordionSectionRenderEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ASection",this.$rtti.TAccordionSection],["ACaption",pas["WEBLib.Controls"].$rtti.TJSHTMLElementRecord],["APanel",pas["WEBLib.Controls"].$rtti.TJSHTMLElementRecord]]),methodkind:0}),rtl.createClass(this,"TAccordion",pas["WEBLib.Controls"].TCustomControl,(function(){this.$init=function(){pas["WEBLib.Controls"].TCustomControl.$init.call(this),this.FStyleRendered=!1,this.FSections=null,this.FOnCollapsing=null,this.FOnExpanding=null,this.FOnCollapsed=null,this.FOnExpanded=null,this.FOnRenderSection=null,this.FElementSectionClassName="",this.FElementContentClassName=""},this.$final=function(){this.FSections=void 0,this.FOnCollapsing=void 0,this.FOnExpanding=void 0,this.FOnCollapsed=void 0,this.FOnExpanded=void 0,this.FOnRenderSection=void 0,pas["WEBLib.Controls"].TCustomControl.$final.call(this)},this.SetSections=function(t){this.FSections.Assign(t)},this.CreateElement=function(){return document.createElement("DIV")},this.UpdateElement=function(){pas["WEBLib.Controls"].TControl.UpdateElement.call(this)},this.RenderAccordion=function(){var t=0,e=null,i=null,s=null,o=null,n=pas["WEBLib.Controls"].TJSHTMLElementRecord.$new(),r=pas["WEBLib.Controls"].TJSHTMLElementRecord.$new();if(this.GetElementHandle().childNodes.length>0){for(;null!=this.GetElementHandle().firstChild;)this.GetElementHandle().removeChild(this.GetElementHandle().firstChild);""!==this.FElementClassName&&(this.GetElementHandle().style.removeProperty("border"),this.GetElementHandle().style.removeProperty("background-color"))}e=document.createElement("SPAN"),this.GetElementHandle().appendChild(e);for(var a=0,l=this.FSections.GetCount()-1;a<=l;a++)t=a,(i=document.createElement("BUTTON")).innerHTML=this.FSections.GetItem$1(t).FCaption,i.setAttribute("id",this.FName+"_"+pas.SysUtils.IntToStr(t)),i.setAttribute("class","accordion_"+this.FName),""!==this.FElementSectionClassName&&i.classList.add(this.FElementSectionClassName),i.addEventListener("click",rtl.createSafeCallback(this,"DoAccordionClick")),(s=document.createElement("DIV")).setAttribute("class","accordionpanel_"+this.FName),(o=document.createElement("P")).style.setProperty("user-select","text"),""!==this.FElementContentClassName&&o.setAttribute("class",this.FElementContentClassName),o.innerHTML=this.FSections.GetItem$1(t).FContent,e.appendChild(i),e.appendChild(s),s.appendChild(o),null!=this.FOnRenderSection&&(n.element=i,r.element=o,this.FOnRenderSection(this,this.FSections.GetItem$1(t),pas["WEBLib.Controls"].TJSHTMLElementRecord.$clone(n),pas["WEBLib.Controls"].TJSHTMLElementRecord.$clone(r)));!this.GetIsLinked()&&4 in this.FComponentState&&this.RenderDesigning(this.$classname,this.GetContainer(),this,0===this.FSections.GetCount(),"")},this.RenderStyle=function(){var t;this.FStyleRendered||(this.FStyleRendered=!0,t=".accordion_"+this.FName+" {background-color: #eee;color: #444;cursor: pointer;padding: 18px;width: 100%;text-align: left;border: none;outline: none;transition: 0.4s;}\r\n.accordionactive_"+this.FName+", .accordion_"+this.FName+"::hover {background-color: #ccc;}\r\n.accordionactive_"+this.FName+"::before {transform: rotate(90deg);}\r\n.accordion_"+this.FName+'::before {  content: "\\25B6";  font-size: 13px;  display: inline-block;  margin-right: 5px;}\r\n.accordionpanel_'+this.FName+" {padding: 0 18px;max-height: 0;overflow: hidden;transition: max-height 0.2s ease-out;}",this.AddInstanceStyle(t))},this.SectionsChanged=function(t){this.IsUpdating()||(this.RenderStyle(),this.RenderAccordion())},this.DoAccordionClick=function(t){var e=!1,i=null,s=null,o="",n=!1,r=null,a=0,l=0;return i=t.srcElement,n=!0,r=null,i.hasAttribute("id")&&(o=i.getAttribute("id"),o=pas.System.Copy(o,pas.System.Pos(this.FName,o)+this.FName.length+1,o.length),pas.System.val$6(o,{get:function(){return a},set:function(t){a=t}},{get:function(){return l},set:function(t){l=t}}),0===l&&a<this.FSections.GetCount()&&(r=this.FSections.GetItem$1(a))),i.classList.contains("accordionactive_"+this.FName)?null!=this.FOnCollapsing&&this.FOnCollapsing(this,r,{get:function(){return n},set:function(t){n=t}}):null!=this.FOnExpanding&&this.FOnExpanding(this,r,{get:function(){return n},set:function(t){n=t}}),n?(i.classList.toggle("accordionactive_"+this.FName),s=i.nextElementSibling,null!=r.FControl&&(r.FControl.SetElementPosition(1),s.appendChild(r.FControl.GetElementHandle()),r.FControl.SetVisible(!0)),"0px"!==(o=s.style.getPropertyValue("max-height"))&&""!==o?s.style.setProperty("max-height","0"):s.style.setProperty("max-height",pas.SysUtils.IntToStr(s.scrollHeight)+"px"),i.classList.contains("accordionactive_"+this.FName)?(r.FExpanded=!0,null!=this.FOnExpanded&&this.FOnExpanded(this,r)):(r.FExpanded=!1,null!=this.FOnCollapsed&&this.FOnCollapsed(this,r)),e=!0):e},this.UpdateElementVisual=function(){pas["WEBLib.Controls"].TCustomControl.UpdateElementVisual.call(this),this.GetElementHandle().style.setProperty("overflow-y","auto"),this.GetElementHandle().style.setProperty("overflow-x","hidden")},this.Expand=function(t){var e,i=null,s=null;i=t.CaptionElement(),e="accordionactive_"+this.FName,i.classList.contains(e)||i.classList.add(e),(s=i.nextElementSibling).style.setProperty("max-height",pas.SysUtils.IntToStr(s.scrollHeight)+"px")},this.Collapse=function(t){var e,i=null;i=t.CaptionElement(),e="accordionactive_"+this.FName,i.classList.contains(e)&&i.classList.remove(e),i.nextElementSibling.style.setProperty("max-height","0")},this.SetElementClassName=function(t){pas["WEBLib.Controls"].TControl.SetElementClassName.apply(this,arguments),""!==this.FElementClassName&&this.RenderAccordion()},this.Loaded=function(){var t=0;pas["WEBLib.Controls"].TCustomControl.Loaded.call(this);for(var e=0,i=this.FSections.GetCount()-1;e<=i;e++)t=e,null!=this.FSections.GetItem$1(t).FControl&&this.FSections.GetItem$1(t).FControl.SetVisible(!1)},this.CreateInitialize=function(){pas["WEBLib.Controls"].TCustomControl.CreateInitialize.call(this),this.FSections=t.TAccordionSections.$create("Create$3",[this]),this.FSections.FOnChange=rtl.createCallback(this,"SectionsChanged"),this.FSections.FPropName="Sections",this.FStyleRendered=!1,4 in this.FComponentState&&(this.SetWidth(400),this.SetHeight(300))},this.Destroy=function(){rtl.free(this,"FSections"),pas["WEBLib.Controls"].TCustomControl.Destroy.call(this)},this.EndUpdate=function(){pas["WEBLib.Controls"].TCustomControl.EndUpdate.call(this),this.RenderStyle(),this.RenderAccordion()},rtl.addIntf(this,pas.System.IUnknown);var e=this.$rtti;e.addProperty("Align",2,pas["WEBLib.Controls"].$rtti.TAlign,"FAlign","SetAlign",{Default:pas["WEBLib.Controls"].TAlign.alNone}),e.addProperty("AlignWithMargins",2,rtl.boolean,"FAlignWithMargins","SetAlignWithMargins",{Default:!1}),e.addProperty("Anchors",2,pas["WEBLib.Controls"].$rtti.TAnchors,"FAnchors","SetAnchors",{Default:rtl.createSet(0,1)}),e.addProperty("Margins",2,pas["WEBLib.Controls"].$rtti.TMargins,"FMargins","SetMargins"),e.addProperty("HeightPercent",2,rtl.double,"FHeightPercent","SetHeightPercent",{Default:100}),e.addProperty("HeightStyle",2,pas["WEBLib.Controls"].$rtti.TSizeStyle,"FHeightStyle","SetHeightStyle",{Default:pas["WEBLib.Controls"].TSizeStyle.ssAbsolute}),e.addProperty("ElementSectionClassName",0,pas["WEBLib.Controls"].$rtti.TElementClassName,"FElementSectionClassName","FElementSectionClassName"),e.addProperty("ElementContentClassName",0,pas["WEBLib.Controls"].$rtti.TElementClassName,"FElementContentClassName","FElementContentClassName"),e.addProperty("ElementClassName",2,pas["WEBLib.Controls"].$rtti.TElementClassName,"FElementClassName","SetElementClassName"),e.addProperty("ElementID",3,pas["WEBLib.Controls"].$rtti.TElementID,"GetID","SetID"),e.addProperty("ElementFont",2,pas["WEBLib.Controls"].$rtti.TElementFont,"FElementFont","SetElementFont",{Default:pas["WEBLib.Controls"].TElementFont.efProperty}),e.addProperty("ElementPosition",2,pas["WEBLib.Controls"].$rtti.TElementPosition,"FElementPosition","SetElementPosition",{Default:pas["WEBLib.Controls"].TElementPosition.epAbsolute}),e.addProperty("Role",3,rtl.string,"GetRole","SetRole"),e.addProperty("Sections",2,t.$rtti.TAccordionSections,"FSections","SetSections"),e.addProperty("WidthPercent",2,rtl.double,"FWidthPercent","SetWidthPercent",{Default:100}),e.addProperty("WidthStyle",2,pas["WEBLib.Controls"].$rtti.TSizeStyle,"FWidthStyle","SetWidthStyle",{Default:pas["WEBLib.Controls"].TSizeStyle.ssAbsolute}),e.addProperty("OnCollapsed",0,t.$rtti.TAccordionSectionEvent,"FOnCollapsed","FOnCollapsed"),e.addProperty("OnCollapsing",0,t.$rtti.TAccordionSectionAllowEvent,"FOnCollapsing","FOnCollapsing"),e.addProperty("OnExpanded",0,t.$rtti.TAccordionSectionEvent,"FOnExpanded","FOnExpanded"),e.addProperty("OnExpanding",0,t.$rtti.TAccordionSectionAllowEvent,"FOnExpanding","FOnExpanding"),e.addProperty("OnRenderSection",0,t.$rtti.TAccordionSectionRenderEvent,"FOnRenderSection","FOnRenderSection")}))}),["WEBLib.Utils"]),rtl.module("WebLib.SEFNC.Layout",["System","Classes","WEBLib.ExtCtrls","WEBLib.Controls"],(function(){"use strict";var t=this;this.TSEFNCControlAlignment={0:"caNone",caNone:0,1:"caTop",caTop:1,2:"caBottom",caBottom:2,3:"caLeft",caLeft:3,4:"caRight",caRight:4,5:"caClient",caClient:5},rtl.createClass(this,"TSEFNCAlign",pas.System.TObject,(function(){this.GetAlign=function(t){var e=0;e=0;return 1===t?e=1:2===t?e=2:3===t?e=3:4===t?e=4:5===t?e=5:0===t&&(e=0),e},this.CenterControl=function(e){if(null==e.FParent)throw pas.SysUtils.Exception.$create("Create$1",["Control needs a Parent!"]);e.SetAlign(t.TSEFNCAlign.GetAlign(0)),e.SetAnchors({}),e.SetLeft(rtl.trunc((e.FParent.GetClientWidth()-e.GetWidth())/2)),e.SetTop(rtl.trunc((e.FParent.GetClientHeight()-e.GetHeight())/2))}})),rtl.createClass(this,"TSEFNCLayout",pas["WEBLib.ExtCtrls"].TWebPanel,(function(){this.SetAlignment$1=function(e){this.SetAlign(t.TSEFNCAlign.GetAlign(e))},rtl.addIntf(this,pas.System.IUnknown)}))}),["SysUtils"]),rtl.module("Generics.Strings",["System"],(function(){"use strict";this.$resourcestrings={SArgumentOutOfRange:{org:"Argument out of range"}}})),rtl.module("Generics.Defaults",["System"],(function(){"use strict";rtl.createInterface(this,"IComparer$G18","{505778ED-F783-4456-9691-32F419CC5E18}",["Compare"],pas.System.IUnknown,"IComparer<System.Longint>"),rtl.createInterface(this,"IComparer$G19","{505778ED-F783-4456-9691-32F419CC5E18}",["Compare"],pas.System.IUnknown,"IComparer<System.String>"),rtl.createInterface(this,"IComparer$G20","{505778ED-F783-4456-9691-32F419CC5E18}",["Compare"],pas.System.IUnknown,"IComparer<System.TObject>"),rtl.createInterface(this,"IComparer$G29","{505778ED-F783-4456-9691-32F419CC5E18}",["Compare"],pas.System.IUnknown,"IComparer<System.TGuid>"),rtl.createInterface(this,"IComparer$G31","{505778ED-F783-4456-9691-32F419CC5E18}",["Compare"],pas.System.IUnknown,"IComparer<WebLib.SERTTK.Repository.TSERTTKRepoItem>"),rtl.createInterface(this,"IComparer$G33","{505778ED-F783-4456-9691-32F419CC5E18}",["Compare"],pas.System.IUnknown,"IComparer<WebLib.SERTTK.Repository.TSESRepoRoot>"),rtl.createInterface(this,"IComparer$G36","{505778ED-F783-4456-9691-32F419CC5E18}",["Compare"],pas.System.IUnknown,"IComparer<WebLib.SERTTK.Repository.TSESTransformBase>"),rtl.createInterface(this,"IComparer$G37","{505778ED-F783-4456-9691-32F419CC5E18}",["Compare"],pas.System.IUnknown,"IComparer<System.TClass>"),rtl.createInterface(this,"IComparer$G39","{505778ED-F783-4456-9691-32F419CC5E18}",["Compare"],pas.System.IUnknown,"IComparer<WEBLib.TMSFNCPageControl.TTMSFNCPageControlPage>")})),rtl.module("Generics.Collections",["System","Classes","SysUtils","RTLConsts","Types","JS","Generics.Strings","Generics.Defaults"],(function(){"use strict";var t=this;t.$impl;this.TCollectionNotification={0:"cnAdded",cnAdded:0,1:"cnRemoved",cnRemoved:1,2:"cnExtracted",cnExtracted:2},rtl.createClass(this,"EDictionary",pas.SysUtils.Exception,(function(){})),this.TDictionaryOwnership={0:"doOwnsKeys",doOwnsKeys:0,1:"doOwnsValues",doOwnsValues:1},rtl.createClass(this,"TEnumerable$G19",pas.System.TObject,(function(){}),"TEnumerable<System.Longint>"),rtl.recNewT(this,"TPair$G5",(function(){this.$eq=function(t){return!0},this.$assign=function(t){return this}})),rtl.createClass(this,"TEnumerable$G20",pas.System.TObject,(function(){}),"TEnumerable<Generics.Collections.TPair<System.String,System.TObject>>"),rtl.createClass(this,"TEnumerator$G22",pas.System.TObject,(function(){}),"TEnumerator<System.String>"),rtl.createClass(this,"TEnumerable$G21",pas.System.TObject,(function(){}),"TEnumerable<System.TObject>"),rtl.createClass(this,"TEnumerable$G22",pas.System.TObject,(function(){}),"TEnumerable<System.String>"),rtl.createClass(this,"TDictionary$G3",this.TEnumerable$G20,(function(){rtl.createClass(this,"TKeyEnumerator",t.TEnumerator$G22,(function(){this.$init=function(){t.TEnumerator$G22.$init.call(this),this.FIter=null,this.FVal=null},this.$final=function(){this.FIter=void 0,this.FVal=void 0,t.TEnumerator$G22.$final.call(this)},this.GetCurrent=function(){return this.DoGetCurrent()},this.DoGetCurrent=function(){return""+this.FVal.value},this.DoMoveNext=function(){return this.FVal=this.FIter.next(),!this.FVal.done},this.Create$1=function(t){return this.FIter=t,this},this.MoveNext$1=function(){return this.DoMoveNext()}}),"TDictionary<System.String,System.TObject>.TKeyEnumerator"),rtl.createClass(this,"TValueCollection",t.TEnumerable$G21,(function(){}),"TDictionary<System.String,System.TObject>.TValueCollection"),rtl.createClass(this,"TKeyCollection",t.TEnumerable$G22,(function(){this.$init=function(){t.TEnumerable$G22.$init.call(this),this.FMap=null},this.$final=function(){this.FMap=void 0,t.TEnumerable$G22.$final.call(this)},this.Create$1=function(t){return this.FMap=t.FMap,this},this.GetEnumerator$1=function(){return t.TDictionary$G3.TKeyEnumerator.$create("Create$1",[this.FMap.keys()])}}),"TDictionary<System.String,System.TObject>.TKeyCollection"),this.$init=function(){t.TEnumerable$G20.$init.call(this),this.FMap=null,this.FComparer=null,this.FOnKeyNotify=null,this.FOnValueNotify=null,this.FKeyCollection=null,this.FValueCollection=null},this.$final=function(){this.FMap=void 0,rtl.setIntfP(this,"FComparer",null),this.FOnKeyNotify=void 0,this.FOnValueNotify=void 0,this.FKeyCollection=void 0,this.FValueCollection=void 0,t.TEnumerable$G20.$final.call(this)},this.GetEffectiveKey=function(t){var e="",i=null,s=null;if(null==this.FComparer)return t;for(s=(i=this.FMap.keys()).next();!s.done;){if(e=""+s.value,0===this.FComparer.Compare(e,t))return e;s=i.next()}return e=t},this.GetItem=function(e){var i;if(i=this.FMap.get(this.GetEffectiveKey(e)),pas.JS.isUndefined(i))throw t.EDictionary.$create("Create$1",[rtl.getResStr(t,"SErrDictKeyNotFound")]);return rtl.getObject(i)},this.DoAdd=function(t,e){this.FMap.set(this.GetEffectiveKey(t),e),this.KeyNotify(t,0),this.ValueNotify(e,0)},this.CanClearMap=function(){return null===this.FOnKeyNotify&&null===this.FOnValueNotify},this.PairNotify=function(t,e,i){this.KeyNotify(t,i),this.ValueNotify(e,i)},this.KeyNotify=function(t,e){null!=this.FOnKeyNotify&&this.FOnKeyNotify(this,t,e)},this.ValueNotify=function(t,e){null!=this.FOnValueNotify&&this.FOnValueNotify(this,t,e)},this.Create$1=function(t){return this.FMap=new Map,this},this.Destroy=function(){pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FKeyCollection},set:function(t){this.p.FKeyCollection=t}}),pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FValueCollection},set:function(t){this.p.FValueCollection=t}}),this.Clear(),this.FMap=null,pas.System.TObject.Destroy.call(this)},this.Add=function(e,i){if(this.FMap.has(this.GetEffectiveKey(e)))throw t.EDictionary.$create("Create$1",[rtl.getResStr(t,"SErrDictDuplicateKey")]);this.DoAdd(e,i)},this.Clear=function(){var t=null,e=null,i=[],s="",o=null;if(this.CanClearMap())this.FMap.clear();else{t=this.FMap.entries();do{(e=t.next()).done||(s=""+(i=e.value)[0],o=rtl.getObject(i[1]),this.FMap.delete(s),this.PairNotify(s,o,1))}while(!e.done)}},this.GetKeys=function(){return null===this.FKeyCollection&&(this.FKeyCollection=this.TKeyCollection.$create("Create$1",[this])),this.FKeyCollection}}),"TDictionary<System.String,System.TObject>"),rtl.createClass(this,"TCustomList$G10",this.TEnumerable$G21,(function(){this.$init=function(){t.TEnumerable$G21.$init.call(this),this.FOnNotify=null,this.FLength=0,this.FItems=[]},this.$final=function(){this.FOnNotify=void 0,this.FItems=void 0,t.TEnumerable$G21.$final.call(this)},this.GetCapacity=function(){return rtl.length(this.FItems)},this.PrepareAddingItem=function(){var t;return this.FLength===rtl.length(this.FItems)&&this.FItems.push(null),t=this.FLength,this.FLength+=1,t},this.Notify=function(t,e){null!=this.FOnNotify&&this.FOnNotify(this,t,e)}}),"TCustomList<System.TObject>"),rtl.createClass(this,"TList$G3",this.TCustomList$G10,(function(){this.SetCapacity=function(t){t<this.FLength&&this.SetCount(t),this.FItems=rtl.arraySetLength(this.FItems,null,t)},this.SetCount=function(t){if(t<0)throw pas.SysUtils.EArgumentOutOfRangeException.$create("Create$1",[rtl.getResStr(pas["Generics.Strings"],"SArgumentOutOfRange")]);t>this.GetCapacity()?this.SetCapacity(t):t<this.FLength&&this.DeleteRange(t,this.FLength-t),this.FLength=t},this.GetItem=function(t){if(t<0||t>=this.FLength)throw pas.SysUtils.EArgumentOutOfRangeException.$create("Create$1",[rtl.getResStr(pas["Generics.Strings"],"SArgumentOutOfRange")]);return this.FItems[t]},this.Destroy=function(){this.SetCapacity(0)},this.Add=function(t){var e;return e=this.PrepareAddingItem(),this.FItems[e]=t,this.Notify(t,0),e},this.DeleteRange=function(t,e){var i,s=0;if(0!==e){if(e<0||t<0||t+e>this.FLength)throw pas.SysUtils.EArgumentOutOfRangeException.$create("Create$1",[rtl.getResStr(pas["Generics.Strings"],"SArgumentOutOfRange")]);i=this.FItems.splice(t,this.FLength),this.FLength-=e;for(var o=0,n=rtl.length(i)-1;o<=n;o++)s=o,this.Notify(i[s],1)}},this.Clear=function(){this.SetCount(0),this.SetCapacity(0)}}),"TList<System.TObject>"),rtl.createClass(this,"TObjectList$G1",this.TList$G3,(function(){this.$init=function(){t.TList$G3.$init.call(this),this.FObjectsOwner=!1},this.Notify=function(e,i){t.TCustomList$G10.Notify.call(this,e,i),this.FObjectsOwner&&1===i&&(e=rtl.freeLoc(e))}}),"TObjectList<System.TObject>"),rtl.createClass(this,"TCustomList$G11",this.TEnumerable$G22,(function(){this.$init=function(){t.TEnumerable$G22.$init.call(this),this.FOnNotify=null,this.FLength=0,this.FItems=[]},this.$final=function(){this.FOnNotify=void 0,this.FItems=void 0,t.TEnumerable$G22.$final.call(this)},this.GetCapacity=function(){return rtl.length(this.FItems)},this.PrepareAddingItem=function(){var t;return this.FLength===rtl.length(this.FItems)&&this.FItems.push(""),t=this.FLength,this.FLength+=1,t},this.Notify=function(t,e){null!=this.FOnNotify&&this.FOnNotify(this,t,e)}}),"TCustomList<System.String>"),rtl.createClass(this,"TList$G4",this.TCustomList$G11,(function(){this.SetCapacity=function(t){t<this.FLength&&this.SetCount(t),this.FItems=rtl.arraySetLength(this.FItems,"",t)},this.SetCount=function(t){if(t<0)throw pas.SysUtils.EArgumentOutOfRangeException.$create("Create$1",[rtl.getResStr(pas["Generics.Strings"],"SArgumentOutOfRange")]);t>this.GetCapacity()?this.SetCapacity(t):t<this.FLength&&this.DeleteRange(t,this.FLength-t),this.FLength=t},this.GetItem=function(t){if(t<0||t>=this.FLength)throw pas.SysUtils.EArgumentOutOfRangeException.$create("Create$1",[rtl.getResStr(pas["Generics.Strings"],"SArgumentOutOfRange")]);return this.FItems[t]},this.Destroy=function(){this.SetCapacity(0)},this.Add=function(t){var e;return e=this.PrepareAddingItem(),this.FItems[e]=t,this.Notify(t,0),e},this.DeleteRange=function(t,e){var i,s=0;if(0!==e){if(e<0||t<0||t+e>this.FLength)throw pas.SysUtils.EArgumentOutOfRangeException.$create("Create$1",[rtl.getResStr(pas["Generics.Strings"],"SArgumentOutOfRange")]);i=this.FItems.splice(t,this.FLength),this.FLength-=e;for(var o=0,n=rtl.length(i)-1;o<=n;o++)s=o,this.Notify(i[s],1)}},this.Clear=function(){this.SetCount(0),this.SetCapacity(0)}}),"TList<System.String>"),rtl.createClass(this,"TCustomList$G12",this.TEnumerable$G19,(function(){this.$init=function(){t.TEnumerable$G19.$init.call(this),this.FOnNotify=null,this.FLength=0,this.FItems=[]},this.$final=function(){this.FOnNotify=void 0,this.FItems=void 0,t.TEnumerable$G19.$final.call(this)},this.GetCapacity=function(){return rtl.length(this.FItems)},this.PrepareAddingItem=function(){var t;return this.FLength===rtl.length(this.FItems)&&this.FItems.push(-2147483648),t=this.FLength,this.FLength+=1,t},this.Notify=function(t,e){null!=this.FOnNotify&&this.FOnNotify(this,t,e)},this.GetCount=function(){return this.FLength}}),"TCustomList<System.Longint>"),rtl.createClass(this,"TList$G5",this.TCustomList$G12,(function(){this.SetCapacity=function(t){t<this.FLength&&this.SetCount(t),this.FItems=rtl.arraySetLength(this.FItems,0,t)},this.SetCount=function(t){if(t<0)throw pas.SysUtils.EArgumentOutOfRangeException.$create("Create$1",[rtl.getResStr(pas["Generics.Strings"],"SArgumentOutOfRange")]);t>this.GetCapacity()?this.SetCapacity(t):t<this.FLength&&this.DeleteRange(t,this.FLength-t),this.FLength=t},this.GetItem=function(t){if(t<0||t>=this.FLength)throw pas.SysUtils.EArgumentOutOfRangeException.$create("Create$1",[rtl.getResStr(pas["Generics.Strings"],"SArgumentOutOfRange")]);return this.FItems[t]},this.Destroy=function(){this.SetCapacity(0)},this.Add=function(t){var e;return e=this.PrepareAddingItem(),this.FItems[e]=t,this.Notify(t,0),e},this.DeleteRange=function(t,e){var i,s=0;if(0!==e){if(e<0||t<0||t+e>this.FLength)throw pas.SysUtils.EArgumentOutOfRangeException.$create("Create$1",[rtl.getResStr(pas["Generics.Strings"],"SArgumentOutOfRange")]);i=this.FItems.splice(t,this.FLength),this.FLength-=e;for(var o=0,n=rtl.length(i)-1;o<=n;o++)s=o,this.Notify(i[s],1)}},this.Clear=function(){this.SetCount(0),this.SetCapacity(0)}}),"TList<System.Longint>"),rtl.createClass(this,"TEnumerable$G23",pas.System.TObject,(function(){}),"TEnumerable<System.Double>"),rtl.createClass(this,"TCustomList$G13",this.TEnumerable$G23,(function(){this.$init=function(){t.TEnumerable$G23.$init.call(this),this.FOnNotify=null,this.FLength=0,this.FItems=[]},this.$final=function(){this.FOnNotify=void 0,this.FItems=void 0,t.TEnumerable$G23.$final.call(this)},this.GetCapacity=function(){return rtl.length(this.FItems)},this.PrepareAddingItem=function(){var t;return this.FLength===rtl.length(this.FItems)&&this.FItems.push(0),t=this.FLength,this.FLength+=1,t},this.Notify=function(t,e){null!=this.FOnNotify&&this.FOnNotify(this,t,e)}}),"TCustomList<System.Double>"),rtl.createClass(this,"TList$G6",this.TCustomList$G13,(function(){this.SetCapacity=function(t){t<this.FLength&&this.SetCount(t),this.FItems=rtl.arraySetLength(this.FItems,0,t)},this.SetCount=function(t){if(t<0)throw pas.SysUtils.EArgumentOutOfRangeException.$create("Create$1",[rtl.getResStr(pas["Generics.Strings"],"SArgumentOutOfRange")]);t>this.GetCapacity()?this.SetCapacity(t):t<this.FLength&&this.DeleteRange(t,this.FLength-t),this.FLength=t},this.GetItem=function(t){if(t<0||t>=this.FLength)throw pas.SysUtils.EArgumentOutOfRangeException.$create("Create$1",[rtl.getResStr(pas["Generics.Strings"],"SArgumentOutOfRange")]);return this.FItems[t]},this.Destroy=function(){this.SetCapacity(0)},this.Add=function(t){var e;return e=this.PrepareAddingItem(),this.FItems[e]=t,this.Notify(t,0),e},this.DeleteRange=function(t,e){var i,s=0;if(0!==e){if(e<0||t<0||t+e>this.FLength)throw pas.SysUtils.EArgumentOutOfRangeException.$create("Create$1",[rtl.getResStr(pas["Generics.Strings"],"SArgumentOutOfRange")]);i=this.FItems.splice(t,this.FLength),this.FLength-=e;for(var o=0,n=rtl.length(i)-1;o<=n;o++)s=o,this.Notify(i[s],1)}},this.Clear=function(){this.SetCount(0),this.SetCapacity(0)}}),"TList<System.Double>"),rtl.createClass(this,"TEnumerable$G24",pas.System.TObject,(function(){}),"TEnumerable<WEBLib.TMSFNCPersistence.TTMSFNCObjectReference>"),rtl.createClass(this,"TCustomList$G14",this.TEnumerable$G24,(function(){this.$init=function(){t.TEnumerable$G24.$init.call(this),this.FOnNotify=null,this.FLength=0,this.FItems=[]},this.$final=function(){this.FOnNotify=void 0,this.FItems=void 0,t.TEnumerable$G24.$final.call(this)},this.GetCapacity=function(){return rtl.length(this.FItems)},this.PrepareAddingItem=function(){var t;return this.FLength===rtl.length(this.FItems)&&this.FItems.push(null),t=this.FLength,this.FLength+=1,t},this.Notify=function(t,e){null!=this.FOnNotify&&this.FOnNotify(this,t,e)}}),"TCustomList<WEBLib.TMSFNCPersistence.TTMSFNCObjectReference>"),rtl.createClass(this,"TList$G7",this.TCustomList$G14,(function(){this.SetCapacity=function(t){t<this.FLength&&this.SetCount(t),this.FItems=rtl.arraySetLength(this.FItems,null,t)},this.SetCount=function(t){if(t<0)throw pas.SysUtils.EArgumentOutOfRangeException.$create("Create$1",[rtl.getResStr(pas["Generics.Strings"],"SArgumentOutOfRange")]);t>this.GetCapacity()?this.SetCapacity(t):t<this.FLength&&this.DeleteRange(t,this.FLength-t),this.FLength=t},this.InitializeList=function(){},this.Create$1=function(){return this.InitializeList(),this},this.Destroy=function(){this.SetCapacity(0)},this.Add=function(t){var e;return e=this.PrepareAddingItem(),this.FItems[e]=t,this.Notify(t,0),e},this.DeleteRange=function(t,e){var i,s=0;if(0!==e){if(e<0||t<0||t+e>this.FLength)throw pas.SysUtils.EArgumentOutOfRangeException.$create("Create$1",[rtl.getResStr(pas["Generics.Strings"],"SArgumentOutOfRange")]);i=this.FItems.splice(t,this.FLength),this.FLength-=e;for(var o=0,n=rtl.length(i)-1;o<=n;o++)s=o,this.Notify(i[s],1)}}}),"TList<WEBLib.TMSFNCPersistence.TTMSFNCObjectReference>"),rtl.createClass(this,"TObjectList$G2",this.TList$G7,(function(){this.$init=function(){t.TList$G7.$init.call(this),this.FObjectsOwner=!1},this.Notify=function(e,i){t.TCustomList$G14.Notify.call(this,e,i),this.FObjectsOwner&&1===i&&(e=rtl.freeLoc(e))},this.Create$4=function(e){return t.TList$G7.Create$1.call(this),this.FObjectsOwner=e,this}}),"TObjectList<WEBLib.TMSFNCPersistence.TTMSFNCObjectReference>"),rtl.createClass(this,"TObjectDictionary$G1",this.TDictionary$G3,(function(){this.$init=function(){t.TDictionary$G3.$init.call(this),this.FOwnerships={}},this.$final=function(){this.FOwnerships=void 0,t.TDictionary$G3.$final.call(this)},this.CanClearMap=function(){return t.TDictionary$G3.CanClearMap.call(this)&&rtl.eqSet(this.FOwnerships,{})},this.KeyNotify=function(e,i){t.TDictionary$G3.KeyNotify.call(this,e,i),0 in this.FOwnerships&&1===i&&(e=rtl.freeLoc(e))},this.ValueNotify=function(e,i){t.TDictionary$G3.ValueNotify.call(this,e,i),1 in this.FOwnerships&&1===i&&(e=rtl.freeLoc(e))}}),"TObjectDictionary<System.String,System.TObject>"),rtl.createClass(this,"TEnumerable$G28",pas.System.TObject,(function(){}),"TEnumerable<WebLib.SEFNC.Logger.TSEFNCLogMsg>"),rtl.createClass(this,"TCustomList$G17",this.TEnumerable$G28,(function(){this.$init=function(){t.TEnumerable$G28.$init.call(this),this.FOnNotify=null,this.FLength=0,this.FItems=[]},this.$final=function(){this.FOnNotify=void 0,this.FItems=void 0,t.TEnumerable$G28.$final.call(this)},this.GetCapacity=function(){return rtl.length(this.FItems)},this.PrepareAddingItem=function(){var t;return this.FLength===rtl.length(this.FItems)&&this.FItems.push(null),t=this.FLength,this.FLength+=1,t},this.Notify=function(t,e){null!=this.FOnNotify&&this.FOnNotify(this,t,e)}}),"TCustomList<WebLib.SEFNC.Logger.TSEFNCLogMsg>"),rtl.createClass(this,"TList$G10",this.TCustomList$G17,(function(){this.SetCapacity=function(t){t<this.FLength&&this.SetCount(t),this.FItems=rtl.arraySetLength(this.FItems,null,t)},this.SetCount=function(t){if(t<0)throw pas.SysUtils.EArgumentOutOfRangeException.$create("Create$1",[rtl.getResStr(pas["Generics.Strings"],"SArgumentOutOfRange")]);t>this.GetCapacity()?this.SetCapacity(t):t<this.FLength&&this.DeleteRange(t,this.FLength-t),this.FLength=t},this.InitializeList=function(){},this.GetItem=function(t){if(t<0||t>=this.FLength)throw pas.SysUtils.EArgumentOutOfRangeException.$create("Create$1",[rtl.getResStr(pas["Generics.Strings"],"SArgumentOutOfRange")]);return this.FItems[t]},this.Create$1=function(){return this.InitializeList(),this},this.Destroy=function(){this.SetCapacity(0)},this.Add=function(t){var e;return e=this.PrepareAddingItem(),this.FItems[e]=t,this.Notify(t,0),e},this.DeleteRange=function(t,e){var i,s=0;if(0!==e){if(e<0||t<0||t+e>this.FLength)throw pas.SysUtils.EArgumentOutOfRangeException.$create("Create$1",[rtl.getResStr(pas["Generics.Strings"],"SArgumentOutOfRange")]);i=this.FItems.splice(t,this.FLength),this.FLength-=e;for(var o=0,n=rtl.length(i)-1;o<=n;o++)s=o,this.Notify(i[s],1)}},this.Clear=function(){this.SetCount(0),this.SetCapacity(0)}}),"TList<WebLib.SEFNC.Logger.TSEFNCLogMsg>"),rtl.createClass(this,"TObjectList$G5",this.TList$G10,(function(){this.$init=function(){t.TList$G10.$init.call(this),this.FObjectsOwner=!1},this.Notify=function(e,i){t.TCustomList$G17.Notify.call(this,e,i),this.FObjectsOwner&&1===i&&(e=rtl.freeLoc(e))},this.Create$4=function(e){return t.TList$G10.Create$1.call(this),this.FObjectsOwner=e,this}}),"TObjectList<WebLib.SEFNC.Logger.TSEFNCLogMsg>"),rtl.createClass(this,"TEnumerable$G29",pas.System.TObject,(function(){}),"TEnumerable<WebLib.SERTTK.Session.TSESSessionScreenDiff>"),rtl.createClass(this,"TCustomList$G18",this.TEnumerable$G29,(function(){this.$init=function(){t.TEnumerable$G29.$init.call(this),this.FOnNotify=null,this.FLength=0,this.FItems=[]},this.$final=function(){this.FOnNotify=void 0,this.FItems=void 0,t.TEnumerable$G29.$final.call(this)},this.GetCapacity=function(){return rtl.length(this.FItems)},this.PrepareAddingItem=function(){var t;return this.FLength===rtl.length(this.FItems)&&this.FItems.push(null),t=this.FLength,this.FLength+=1,t},this.Notify=function(t,e){null!=this.FOnNotify&&this.FOnNotify(this,t,e)}}),"TCustomList<WebLib.SERTTK.Session.TSESSessionScreenDiff>"),rtl.createClass(this,"TList$G11",this.TCustomList$G18,(function(){this.SetCapacity=function(t){t<this.FLength&&this.SetCount(t),this.FItems=rtl.arraySetLength(this.FItems,null,t)},this.SetCount=function(t){if(t<0)throw pas.SysUtils.EArgumentOutOfRangeException.$create("Create$1",[rtl.getResStr(pas["Generics.Strings"],"SArgumentOutOfRange")]);t>this.GetCapacity()?this.SetCapacity(t):t<this.FLength&&this.DeleteRange(t,this.FLength-t),this.FLength=t},this.InitializeList=function(){},this.GetItem=function(t){if(t<0||t>=this.FLength)throw pas.SysUtils.EArgumentOutOfRangeException.$create("Create$1",[rtl.getResStr(pas["Generics.Strings"],"SArgumentOutOfRange")]);return this.FItems[t]},this.Create$1=function(){return this.InitializeList(),this},this.Destroy=function(){this.SetCapacity(0)},this.Add=function(t){var e;return e=this.PrepareAddingItem(),this.FItems[e]=t,this.Notify(t,0),e},this.DeleteRange=function(t,e){var i,s=0;if(0!==e){if(e<0||t<0||t+e>this.FLength)throw pas.SysUtils.EArgumentOutOfRangeException.$create("Create$1",[rtl.getResStr(pas["Generics.Strings"],"SArgumentOutOfRange")]);i=this.FItems.splice(t,this.FLength),this.FLength-=e;for(var o=0,n=rtl.length(i)-1;o<=n;o++)s=o,this.Notify(i[s],1)}}}),"TList<WebLib.SERTTK.Session.TSESSessionScreenDiff>"),rtl.createClass(this,"TObjectList$G6",this.TList$G11,(function(){this.$init=function(){t.TList$G11.$init.call(this),this.FObjectsOwner=!1},this.Notify=function(e,i){t.TCustomList$G18.Notify.call(this,e,i),this.FObjectsOwner&&1===i&&(e=rtl.freeLoc(e))},this.Create$4=function(e){return t.TList$G11.Create$1.call(this),this.FObjectsOwner=e,this}}),"TObjectList<WebLib.SERTTK.Session.TSESSessionScreenDiff>"),rtl.recNewT(this,"TPair$G7",(function(){this.$eq=function(t){return!0},this.$assign=function(t){return this}})),rtl.createClass(this,"TEnumerable$G30",pas.System.TObject,(function(){}),"TEnumerable<Generics.Collections.TPair<System.String,WebLib.SERTTK.Session.TSERTTKSessionInfoStream>>"),rtl.createClass(this,"TEnumerable$G31",pas.System.TObject,(function(){}),"TEnumerable<WebLib.SERTTK.Session.TSERTTKSessionInfoStream>"),rtl.createClass(this,"TDictionary$G5",this.TEnumerable$G30,(function(){rtl.createClass(this,"TKeyEnumerator",t.TEnumerator$G22,(function(){this.$init=function(){t.TEnumerator$G22.$init.call(this),this.FIter=null,this.FVal=null},this.$final=function(){this.FIter=void 0,this.FVal=void 0,t.TEnumerator$G22.$final.call(this)},this.GetCurrent=function(){return this.DoGetCurrent()},this.DoGetCurrent=function(){return""+this.FVal.value},this.DoMoveNext=function(){return this.FVal=this.FIter.next(),!this.FVal.done},this.Create$1=function(t){return this.FIter=t,this},this.MoveNext$1=function(){return this.DoMoveNext()}}),"TDictionary<System.String,WebLib.SERTTK.Session.TSERTTKSessionInfoStream>.TKeyEnumerator"),rtl.createClass(this,"TValueCollection",t.TEnumerable$G31,(function(){}),"TDictionary<System.String,WebLib.SERTTK.Session.TSERTTKSessionInfoStream>.TValueCollection"),rtl.createClass(this,"TKeyCollection",t.TEnumerable$G22,(function(){this.$init=function(){t.TEnumerable$G22.$init.call(this),this.FMap=null},this.$final=function(){this.FMap=void 0,t.TEnumerable$G22.$final.call(this)},this.Create$1=function(t){return this.FMap=t.FMap,this},this.GetEnumerator$1=function(){return t.TDictionary$G5.TKeyEnumerator.$create("Create$1",[this.FMap.keys()])}}),"TDictionary<System.String,WebLib.SERTTK.Session.TSERTTKSessionInfoStream>.TKeyCollection"),this.$init=function(){t.TEnumerable$G30.$init.call(this),this.FMap=null,this.FComparer=null,this.FOnKeyNotify=null,this.FOnValueNotify=null,this.FKeyCollection=null,this.FValueCollection=null},this.$final=function(){this.FMap=void 0,rtl.setIntfP(this,"FComparer",null),this.FOnKeyNotify=void 0,this.FOnValueNotify=void 0,this.FKeyCollection=void 0,this.FValueCollection=void 0,t.TEnumerable$G30.$final.call(this)},this.GetEffectiveKey=function(t){var e="",i=null,s=null;if(null==this.FComparer)return t;for(s=(i=this.FMap.keys()).next();!s.done;){if(e=""+s.value,0===this.FComparer.Compare(e,t))return e;s=i.next()}return e=t},this.GetItem=function(e){var i;if(i=this.FMap.get(this.GetEffectiveKey(e)),pas.JS.isUndefined(i))throw t.EDictionary.$create("Create$1",[rtl.getResStr(t,"SErrDictKeyNotFound")]);return rtl.getObject(i)},this.DoAdd=function(t,e){this.FMap.set(this.GetEffectiveKey(t),e),this.KeyNotify(t,0),this.ValueNotify(e,0)},this.CanClearMap=function(){return null===this.FOnKeyNotify&&null===this.FOnValueNotify},this.PairNotify=function(t,e,i){this.KeyNotify(t,i),this.ValueNotify(e,i)},this.KeyNotify=function(t,e){null!=this.FOnKeyNotify&&this.FOnKeyNotify(this,t,e)},this.ValueNotify=function(t,e){null!=this.FOnValueNotify&&this.FOnValueNotify(this,t,e)},this.Create$1=function(t){return this.FMap=new Map,this},this.Destroy=function(){pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FKeyCollection},set:function(t){this.p.FKeyCollection=t}}),pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FValueCollection},set:function(t){this.p.FValueCollection=t}}),this.Clear(),this.FMap=null,pas.System.TObject.Destroy.call(this)},this.Add=function(e,i){if(this.FMap.has(this.GetEffectiveKey(e)))throw t.EDictionary.$create("Create$1",[rtl.getResStr(t,"SErrDictDuplicateKey")]);this.DoAdd(e,i)},this.Clear=function(){var t=null,e=null,i=[],s="",o=null;if(this.CanClearMap())this.FMap.clear();else{t=this.FMap.entries();do{(e=t.next()).done||(s=""+(i=e.value)[0],o=rtl.getObject(i[1]),this.FMap.delete(s),this.PairNotify(s,o,1))}while(!e.done)}},this.TryGetValue=function(t,e){var i,s;return s=this.GetEffectiveKey(t),(i=this.FMap.has(s))&&e.set(rtl.getObject(this.FMap.get(s))),i},this.GetKeys=function(){return null===this.FKeyCollection&&(this.FKeyCollection=this.TKeyCollection.$create("Create$1",[this])),this.FKeyCollection}}),"TDictionary<System.String,WebLib.SERTTK.Session.TSERTTKSessionInfoStream>"),rtl.createClass(this,"TObjectDictionary$G2",this.TDictionary$G5,(function(){this.$init=function(){t.TDictionary$G5.$init.call(this),this.FOwnerships={}},this.$final=function(){this.FOwnerships=void 0,t.TDictionary$G5.$final.call(this)},this.CanClearMap=function(){return t.TDictionary$G5.CanClearMap.call(this)&&rtl.eqSet(this.FOwnerships,{})},this.KeyNotify=function(e,i){t.TDictionary$G5.KeyNotify.call(this,e,i),0 in this.FOwnerships&&1===i&&(e=rtl.freeLoc(e))},this.ValueNotify=function(e,i){t.TDictionary$G5.ValueNotify.call(this,e,i),1 in this.FOwnerships&&1===i&&(e=rtl.freeLoc(e))},this.Create$5=function(e){return t.TDictionary$G5.Create$1.call(this,0),this.FOwnerships=rtl.refSet(e),this}}),"TObjectDictionary<System.String,WebLib.SERTTK.Session.TSERTTKSessionInfoStream>"),rtl.createClass(this,"TEnumerator$G33",pas.System.TObject,(function(){this.MoveNext=function(){return this.DoMoveNext()}}),"TEnumerator<WEBLib.TMSFNCTypes.TRectF>"),rtl.createClass(this,"TEnumerable$G32",pas.System.TObject,(function(){}),"TEnumerable<WEBLib.TMSFNCTypes.TRectF>"),rtl.createClass(this,"TCustomList$G19",this.TEnumerable$G32,(function(){this.$init=function(){t.TEnumerable$G32.$init.call(this),this.FOnNotify=null,this.FLength=0,this.FItems=[]},this.$final=function(){this.FOnNotify=void 0,this.FItems=void 0,t.TEnumerable$G32.$final.call(this)},this.GetCapacity=function(){return rtl.length(this.FItems)},this.Notify=function(t,e){null!=this.FOnNotify&&this.FOnNotify(this,t,e)}}),"TCustomList<WEBLib.TMSFNCTypes.TRectF>"),rtl.createClass(this,"TCustomListEnumerator$G17",this.TEnumerator$G33,(function(){this.$init=function(){t.TEnumerator$G33.$init.call(this),this.FList=null,this.FIndex=0},this.$final=function(){this.FList=void 0,t.TEnumerator$G33.$final.call(this)},this.DoMoveNext=function(){return this.FIndex+=1,this.FList.FLength>0&&this.FIndex<this.FList.FLength},this.DoGetCurrent=function(){var t=pas["WEBLib.TMSFNCTypes"].TRectF.$new();return t.$assign(this.GetCurrent()),t},this.GetCurrent=function(){var t=pas["WEBLib.TMSFNCTypes"].TRectF.$new();return t.$assign(this.FList.FItems[this.FIndex]),t},this.Create$1=function(t){return pas.System.TObject.Create.call(this),this.FIndex=-1,this.FList=t,this}}),"TCustomListEnumerator<WEBLib.TMSFNCTypes.TRectF>"),rtl.createClass(this,"TList$G12",this.TCustomList$G19,(function(){rtl.createClass(this,"TEnumerator",t.TCustomListEnumerator$G17,(function(){}),"TList<WEBLib.TMSFNCTypes.TRectF>.TEnumerator"),this.SetCapacity=function(t){t<this.FLength&&this.SetCount(t),this.FItems=rtl.arraySetLength(this.FItems,pas["WEBLib.TMSFNCTypes"].TRectF,t)},this.SetCount=function(t){if(t<0)throw pas.SysUtils.EArgumentOutOfRangeException.$create("Create$1",[rtl.getResStr(pas["Generics.Strings"],"SArgumentOutOfRange")]);t>this.GetCapacity()?this.SetCapacity(t):t<this.FLength&&this.DeleteRange(t,this.FLength-t),this.FLength=t},this.GetEnumerator$1=function(){return this.TEnumerator.$create("Create$1",[this])},this.Destroy=function(){this.SetCapacity(0)},this.DeleteRange=function(t,e){var i,s=0;if(0!==e){if(e<0||t<0||t+e>this.FLength)throw pas.SysUtils.EArgumentOutOfRangeException.$create("Create$1",[rtl.getResStr(pas["Generics.Strings"],"SArgumentOutOfRange")]);i=this.FItems.splice(t,this.FLength),this.FLength-=e;for(var o=0,n=rtl.length(i)-1;o<=n;o++)s=o,this.Notify(i[s],1)}}}),"TList<WEBLib.TMSFNCTypes.TRectF>"),rtl.recNewT(this,"TPair$G8",(function(){this.$eq=function(t){return!0},this.$assign=function(t){return this}})),rtl.createClass(this,"TEnumerable$G33",pas.System.TObject,(function(){}),"TEnumerable<Generics.Collections.TPair<System.String,WebLib.SERTTK.Session.TSESScreenDiffInfo>>"),rtl.createClass(this,"TEnumerable$G34",pas.System.TObject,(function(){}),"TEnumerable<WebLib.SERTTK.Session.TSESScreenDiffInfo>"),rtl.createClass(this,"TDictionary$G6",this.TEnumerable$G33,(function(){rtl.createClass(this,"TValueCollection",t.TEnumerable$G34,(function(){}),"TDictionary<System.String,WebLib.SERTTK.Session.TSESScreenDiffInfo>.TValueCollection"),rtl.createClass(this,"TKeyCollection",t.TEnumerable$G22,(function(){}),"TDictionary<System.String,WebLib.SERTTK.Session.TSESScreenDiffInfo>.TKeyCollection"),this.$init=function(){t.TEnumerable$G33.$init.call(this),this.FMap=null,this.FComparer=null,this.FOnKeyNotify=null,this.FOnValueNotify=null,this.FKeyCollection=null,this.FValueCollection=null},this.$final=function(){this.FMap=void 0,rtl.setIntfP(this,"FComparer",null),this.FOnKeyNotify=void 0,this.FOnValueNotify=void 0,this.FKeyCollection=void 0,this.FValueCollection=void 0,t.TEnumerable$G33.$final.call(this)},this.GetEffectiveKey=function(t){var e="",i=null,s=null;if(null==this.FComparer)return t;for(s=(i=this.FMap.keys()).next();!s.done;){if(e=""+s.value,0===this.FComparer.Compare(e,t))return e;s=i.next()}return e=t},this.CanClearMap=function(){return null===this.FOnKeyNotify&&null===this.FOnValueNotify},this.PairNotify=function(t,e,i){this.KeyNotify(t,i),this.ValueNotify(e,i)},this.KeyNotify=function(t,e){null!=this.FOnKeyNotify&&this.FOnKeyNotify(this,t,e)},this.ValueNotify=function(t,e){null!=this.FOnValueNotify&&this.FOnValueNotify(this,t,e)},this.Destroy=function(){pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FKeyCollection},set:function(t){this.p.FKeyCollection=t}}),pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FValueCollection},set:function(t){this.p.FValueCollection=t}}),this.Clear(),this.FMap=null,pas.System.TObject.Destroy.call(this)},this.Clear=function(){var t=null,e=null,i=[],s="",o=null;if(this.CanClearMap())this.FMap.clear();else{t=this.FMap.entries();do{(e=t.next()).done||(s=""+(i=e.value)[0],o=rtl.getObject(i[1]),this.FMap.delete(s),this.PairNotify(s,o,1))}while(!e.done)}},this.TryGetValue=function(t,e){var i,s;return s=this.GetEffectiveKey(t),(i=this.FMap.has(s))&&e.set(rtl.getObject(this.FMap.get(s))),i}}),"TDictionary<System.String,WebLib.SERTTK.Session.TSESScreenDiffInfo>"),rtl.createClass(this,"TObjectDictionary$G3",this.TDictionary$G6,(function(){this.$init=function(){t.TDictionary$G6.$init.call(this),this.FOwnerships={}},this.$final=function(){this.FOwnerships=void 0,t.TDictionary$G6.$final.call(this)},this.CanClearMap=function(){return t.TDictionary$G6.CanClearMap.call(this)&&rtl.eqSet(this.FOwnerships,{})},this.KeyNotify=function(e,i){t.TDictionary$G6.KeyNotify.call(this,e,i),0 in this.FOwnerships&&1===i&&(e=rtl.freeLoc(e))},this.ValueNotify=function(e,i){t.TDictionary$G6.ValueNotify.call(this,e,i),1 in this.FOwnerships&&1===i&&(e=rtl.freeLoc(e))}}),"TObjectDictionary<System.String,WebLib.SERTTK.Session.TSESScreenDiffInfo>"),rtl.createClass(this,"TEnumerable$G35",pas.System.TObject,(function(){}),"TEnumerable<WebLib.SERTTK.Session.TSESupSessionStepInfo>"),rtl.createClass(this,"TCustomList$G20",this.TEnumerable$G35,(function(){this.$init=function(){t.TEnumerable$G35.$init.call(this),this.FOnNotify=null,this.FLength=0,this.FItems=[]},this.$final=function(){this.FOnNotify=void 0,this.FItems=void 0,t.TEnumerable$G35.$final.call(this)},this.GetCapacity=function(){return rtl.length(this.FItems)},this.PrepareAddingItem=function(){var t;return this.FLength===rtl.length(this.FItems)&&this.FItems.push(null),t=this.FLength,this.FLength+=1,t},this.Notify=function(t,e){null!=this.FOnNotify&&this.FOnNotify(this,t,e)}}),"TCustomList<WebLib.SERTTK.Session.TSESupSessionStepInfo>"),rtl.createClass(this,"TList$G13",this.TCustomList$G20,(function(){this.SetCapacity=function(t){t<this.FLength&&this.SetCount(t),this.FItems=rtl.arraySetLength(this.FItems,null,t)},this.SetCount=function(t){if(t<0)throw pas.SysUtils.EArgumentOutOfRangeException.$create("Create$1",[rtl.getResStr(pas["Generics.Strings"],"SArgumentOutOfRange")]);t>this.GetCapacity()?this.SetCapacity(t):t<this.FLength&&this.DeleteRange(t,this.FLength-t),this.FLength=t},this.InitializeList=function(){},this.GetItem=function(t){if(t<0||t>=this.FLength)throw pas.SysUtils.EArgumentOutOfRangeException.$create("Create$1",[rtl.getResStr(pas["Generics.Strings"],"SArgumentOutOfRange")]);return this.FItems[t]},this.Create$1=function(){return this.InitializeList(),this},this.Destroy=function(){this.SetCapacity(0)},this.Add=function(t){var e;return e=this.PrepareAddingItem(),this.FItems[e]=t,this.Notify(t,0),e},this.DeleteRange=function(t,e){var i,s=0;if(0!==e){if(e<0||t<0||t+e>this.FLength)throw pas.SysUtils.EArgumentOutOfRangeException.$create("Create$1",[rtl.getResStr(pas["Generics.Strings"],"SArgumentOutOfRange")]);i=this.FItems.splice(t,this.FLength),this.FLength-=e;for(var o=0,n=rtl.length(i)-1;o<=n;o++)s=o,this.Notify(i[s],1)}}}),"TList<WebLib.SERTTK.Session.TSESupSessionStepInfo>"),rtl.createClass(this,"TObjectList$G7",this.TList$G13,(function(){this.$init=function(){t.TList$G13.$init.call(this),this.FObjectsOwner=!1},this.Notify=function(e,i){t.TCustomList$G20.Notify.call(this,e,i),this.FObjectsOwner&&1===i&&(e=rtl.freeLoc(e))},this.Create$4=function(e){return t.TList$G13.Create$1.call(this),this.FObjectsOwner=e,this}}),"TObjectList<WebLib.SERTTK.Session.TSESupSessionStepInfo>"),rtl.recNewT(this,"TPair$G9",(function(){this.$eq=function(t){return!0},this.$assign=function(t){return this}})),rtl.createClass(this,"TEnumerable$G36",pas.System.TObject,(function(){}),"TEnumerable<Generics.Collections.TPair<System.String,WebLib.SERTTK.Session.TSERTTKSessionStorageBitmap>>"),rtl.createClass(this,"TEnumerable$G37",pas.System.TObject,(function(){}),"TEnumerable<WebLib.SERTTK.Session.TSERTTKSessionStorageBitmap>"),rtl.createClass(this,"TDictionary$G7",this.TEnumerable$G36,(function(){rtl.createClass(this,"TKeyEnumerator",t.TEnumerator$G22,(function(){this.$init=function(){t.TEnumerator$G22.$init.call(this),this.FIter=null,this.FVal=null},this.$final=function(){this.FIter=void 0,this.FVal=void 0,t.TEnumerator$G22.$final.call(this)},this.GetCurrent=function(){return this.DoGetCurrent()},this.DoGetCurrent=function(){return""+this.FVal.value},this.DoMoveNext=function(){return this.FVal=this.FIter.next(),!this.FVal.done},this.Create$1=function(t){return this.FIter=t,this},this.MoveNext$1=function(){return this.DoMoveNext()}}),"TDictionary<System.String,WebLib.SERTTK.Session.TSERTTKSessionStorageBitmap>.TKeyEnumerator"),rtl.createClass(this,"TValueCollection",t.TEnumerable$G37,(function(){}),"TDictionary<System.String,WebLib.SERTTK.Session.TSERTTKSessionStorageBitmap>.TValueCollection"),rtl.createClass(this,"TKeyCollection",t.TEnumerable$G22,(function(){this.$init=function(){t.TEnumerable$G22.$init.call(this),this.FMap=null},this.$final=function(){this.FMap=void 0,t.TEnumerable$G22.$final.call(this)},this.Create$1=function(t){return this.FMap=t.FMap,this},this.GetEnumerator$1=function(){return t.TDictionary$G7.TKeyEnumerator.$create("Create$1",[this.FMap.keys()])}}),"TDictionary<System.String,WebLib.SERTTK.Session.TSERTTKSessionStorageBitmap>.TKeyCollection"),this.$init=function(){t.TEnumerable$G36.$init.call(this),this.FMap=null,this.FComparer=null,this.FOnKeyNotify=null,this.FOnValueNotify=null,this.FKeyCollection=null,this.FValueCollection=null},this.$final=function(){this.FMap=void 0,rtl.setIntfP(this,"FComparer",null),this.FOnKeyNotify=void 0,this.FOnValueNotify=void 0,this.FKeyCollection=void 0,this.FValueCollection=void 0,t.TEnumerable$G36.$final.call(this)},this.GetEffectiveKey=function(t){var e="",i=null,s=null;if(null==this.FComparer)return t;for(s=(i=this.FMap.keys()).next();!s.done;){if(e=""+s.value,0===this.FComparer.Compare(e,t))return e;s=i.next()}return e=t},this.GetItem=function(e){var i;if(i=this.FMap.get(this.GetEffectiveKey(e)),pas.JS.isUndefined(i))throw t.EDictionary.$create("Create$1",[rtl.getResStr(t,"SErrDictKeyNotFound")]);return rtl.getObject(i)},this.CanClearMap=function(){return null===this.FOnKeyNotify&&null===this.FOnValueNotify},this.PairNotify=function(t,e,i){this.KeyNotify(t,i),this.ValueNotify(e,i)},this.KeyNotify=function(t,e){null!=this.FOnKeyNotify&&this.FOnKeyNotify(this,t,e)},this.ValueNotify=function(t,e){null!=this.FOnValueNotify&&this.FOnValueNotify(this,t,e)},this.Create$1=function(t){return this.FMap=new Map,this},this.Destroy=function(){pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FKeyCollection},set:function(t){this.p.FKeyCollection=t}}),pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FValueCollection},set:function(t){this.p.FValueCollection=t}}),this.Clear(),this.FMap=null,pas.System.TObject.Destroy.call(this)},this.Clear=function(){var t=null,e=null,i=[],s="",o=null;if(this.CanClearMap())this.FMap.clear();else{t=this.FMap.entries();do{(e=t.next()).done||(s=""+(i=e.value)[0],o=rtl.getObject(i[1]),this.FMap.delete(s),this.PairNotify(s,o,1))}while(!e.done)}},this.TryGetValue=function(t,e){var i,s;return s=this.GetEffectiveKey(t),(i=this.FMap.has(s))&&e.set(rtl.getObject(this.FMap.get(s))),i},this.GetKeys=function(){return null===this.FKeyCollection&&(this.FKeyCollection=this.TKeyCollection.$create("Create$1",[this])),this.FKeyCollection}}),"TDictionary<System.String,WebLib.SERTTK.Session.TSERTTKSessionStorageBitmap>"),rtl.createClass(this,"TObjectDictionary$G4",this.TDictionary$G7,(function(){this.$init=function(){t.TDictionary$G7.$init.call(this),this.FOwnerships={}},this.$final=function(){this.FOwnerships=void 0,t.TDictionary$G7.$final.call(this)},this.CanClearMap=function(){return t.TDictionary$G7.CanClearMap.call(this)&&rtl.eqSet(this.FOwnerships,{})},this.KeyNotify=function(e,i){t.TDictionary$G7.KeyNotify.call(this,e,i),0 in this.FOwnerships&&1===i&&(e=rtl.freeLoc(e))},this.ValueNotify=function(e,i){t.TDictionary$G7.ValueNotify.call(this,e,i),1 in this.FOwnerships&&1===i&&(e=rtl.freeLoc(e))},this.Create$5=function(e){return t.TDictionary$G7.Create$1.call(this,0),this.FOwnerships=rtl.refSet(e),this}}),"TObjectDictionary<System.String,WebLib.SERTTK.Session.TSERTTKSessionStorageBitmap>"),rtl.recNewT(this,"TPair$G10",(function(){this.$eq=function(t){return!0},this.$assign=function(t){return this}})),rtl.createClass(this,"TEnumerable$G38",pas.System.TObject,(function(){}),"TEnumerable<Generics.Collections.TPair<System.String,WebLib.SERTTK.Session.TSESSessionStepLog>>"),rtl.createClass(this,"TEnumerable$G39",pas.System.TObject,(function(){}),"TEnumerable<WebLib.SERTTK.Session.TSESSessionStepLog>"),rtl.createClass(this,"TDictionary$G8",this.TEnumerable$G38,(function(){rtl.createClass(this,"TKeyEnumerator",t.TEnumerator$G22,(function(){this.$init=function(){t.TEnumerator$G22.$init.call(this),this.FIter=null,this.FVal=null},this.$final=function(){this.FIter=void 0,this.FVal=void 0,t.TEnumerator$G22.$final.call(this)},this.GetCurrent=function(){return this.DoGetCurrent()},this.DoGetCurrent=function(){return""+this.FVal.value},this.DoMoveNext=function(){return this.FVal=this.FIter.next(),!this.FVal.done},this.Create$1=function(t){return this.FIter=t,this},this.MoveNext$1=function(){return this.DoMoveNext()}}),"TDictionary<System.String,WebLib.SERTTK.Session.TSESSessionStepLog>.TKeyEnumerator"),rtl.createClass(this,"TValueCollection",t.TEnumerable$G39,(function(){}),"TDictionary<System.String,WebLib.SERTTK.Session.TSESSessionStepLog>.TValueCollection"),rtl.createClass(this,"TKeyCollection",t.TEnumerable$G22,(function(){this.$init=function(){t.TEnumerable$G22.$init.call(this),this.FMap=null},this.$final=function(){this.FMap=void 0,t.TEnumerable$G22.$final.call(this)},this.Create$1=function(t){return this.FMap=t.FMap,this},this.GetEnumerator$1=function(){return t.TDictionary$G8.TKeyEnumerator.$create("Create$1",[this.FMap.keys()])}}),"TDictionary<System.String,WebLib.SERTTK.Session.TSESSessionStepLog>.TKeyCollection"),this.$init=function(){t.TEnumerable$G38.$init.call(this),this.FMap=null,this.FComparer=null,this.FOnKeyNotify=null,this.FOnValueNotify=null,this.FKeyCollection=null,this.FValueCollection=null},this.$final=function(){this.FMap=void 0,rtl.setIntfP(this,"FComparer",null),this.FOnKeyNotify=void 0,this.FOnValueNotify=void 0,this.FKeyCollection=void 0,this.FValueCollection=void 0,t.TEnumerable$G38.$final.call(this)},this.GetEffectiveKey=function(t){var e="",i=null,s=null;if(null==this.FComparer)return t;for(s=(i=this.FMap.keys()).next();!s.done;){if(e=""+s.value,0===this.FComparer.Compare(e,t))return e;s=i.next()}return e=t},this.GetItem=function(e){var i;if(i=this.FMap.get(this.GetEffectiveKey(e)),pas.JS.isUndefined(i))throw t.EDictionary.$create("Create$1",[rtl.getResStr(t,"SErrDictKeyNotFound")]);return rtl.getObject(i)},this.DoAdd=function(t,e){this.FMap.set(this.GetEffectiveKey(t),e),this.KeyNotify(t,0),this.ValueNotify(e,0)},this.CanClearMap=function(){return null===this.FOnKeyNotify&&null===this.FOnValueNotify},this.PairNotify=function(t,e,i){this.KeyNotify(t,i),this.ValueNotify(e,i)},this.KeyNotify=function(t,e){null!=this.FOnKeyNotify&&this.FOnKeyNotify(this,t,e)},this.ValueNotify=function(t,e){null!=this.FOnValueNotify&&this.FOnValueNotify(this,t,e)},this.Create$1=function(t){return this.FMap=new Map,this},this.Destroy=function(){pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FKeyCollection},set:function(t){this.p.FKeyCollection=t}}),pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FValueCollection},set:function(t){this.p.FValueCollection=t}}),this.Clear(),this.FMap=null,pas.System.TObject.Destroy.call(this)},this.Add=function(e,i){if(this.FMap.has(this.GetEffectiveKey(e)))throw t.EDictionary.$create("Create$1",[rtl.getResStr(t,"SErrDictDuplicateKey")]);this.DoAdd(e,i)},this.Clear=function(){var t=null,e=null,i=[],s="",o=null;if(this.CanClearMap())this.FMap.clear();else{t=this.FMap.entries();do{(e=t.next()).done||(s=""+(i=e.value)[0],o=rtl.getObject(i[1]),this.FMap.delete(s),this.PairNotify(s,o,1))}while(!e.done)}},this.TryGetValue=function(t,e){var i,s;return s=this.GetEffectiveKey(t),(i=this.FMap.has(s))&&e.set(rtl.getObject(this.FMap.get(s))),i},this.GetKeys=function(){return null===this.FKeyCollection&&(this.FKeyCollection=this.TKeyCollection.$create("Create$1",[this])),this.FKeyCollection}}),"TDictionary<System.String,WebLib.SERTTK.Session.TSESSessionStepLog>"),rtl.createClass(this,"TObjectDictionary$G5",this.TDictionary$G8,(function(){this.$init=function(){t.TDictionary$G8.$init.call(this),this.FOwnerships={}},this.$final=function(){this.FOwnerships=void 0,t.TDictionary$G8.$final.call(this)},this.CanClearMap=function(){return t.TDictionary$G8.CanClearMap.call(this)&&rtl.eqSet(this.FOwnerships,{})},this.KeyNotify=function(e,i){t.TDictionary$G8.KeyNotify.call(this,e,i),0 in this.FOwnerships&&1===i&&(e=rtl.freeLoc(e))},this.ValueNotify=function(e,i){t.TDictionary$G8.ValueNotify.call(this,e,i),1 in this.FOwnerships&&1===i&&(e=rtl.freeLoc(e))},this.Create$5=function(e){return t.TDictionary$G8.Create$1.call(this,0),this.FOwnerships=rtl.refSet(e),this}}),"TObjectDictionary<System.String,WebLib.SERTTK.Session.TSESSessionStepLog>"),rtl.recNewT(this,"TPair$G11",(function(){this.$eq=function(t){return!0},this.$assign=function(t){return this}})),rtl.createClass(this,"TEnumerable$G40",pas.System.TObject,(function(){}),"TEnumerable<Generics.Collections.TPair<System.TGuid,WebLib.SERTTK.Session.TSEStepDiffAnalysis>>"),rtl.createClass(this,"TEnumerable$G41",pas.System.TObject,(function(){}),"TEnumerable<WebLib.SERTTK.Session.TSEStepDiffAnalysis>"),rtl.createClass(this,"TEnumerable$G42",pas.System.TObject,(function(){}),"TEnumerable<System.TGuid>"),rtl.createClass(this,"TDictionary$G9",this.TEnumerable$G40,(function(){rtl.createClass(this,"TValueCollection",t.TEnumerable$G41,(function(){}),"TDictionary<System.TGuid,WebLib.SERTTK.Session.TSEStepDiffAnalysis>.TValueCollection"),rtl.createClass(this,"TKeyCollection",t.TEnumerable$G42,(function(){}),"TDictionary<System.TGuid,WebLib.SERTTK.Session.TSEStepDiffAnalysis>.TKeyCollection"),this.$init=function(){t.TEnumerable$G40.$init.call(this),this.FMap=null,this.FComparer=null,this.FOnKeyNotify=null,this.FOnValueNotify=null,this.FKeyCollection=null,this.FValueCollection=null},this.$final=function(){this.FMap=void 0,rtl.setIntfP(this,"FComparer",null),this.FOnKeyNotify=void 0,this.FOnValueNotify=void 0,this.FKeyCollection=void 0,this.FValueCollection=void 0,t.TEnumerable$G40.$final.call(this)},this.GetEffectiveKey=function(t){var e=pas.System.TGuid.$new(),i=null,s=null;if(null==this.FComparer)return t;for(s=(i=this.FMap.keys()).next();!s.done;){if(e.$assign(rtl.getObject(s.value)),0===this.FComparer.Compare(e,t))return e;s=i.next()}return e.$assign(t),e},this.CanClearMap=function(){return null===this.FOnKeyNotify&&null===this.FOnValueNotify},this.PairNotify=function(t,e,i){this.KeyNotify(t,i),this.ValueNotify(e,i)},this.KeyNotify=function(t,e){null!=this.FOnKeyNotify&&this.FOnKeyNotify(this,t,e)},this.ValueNotify=function(t,e){null!=this.FOnValueNotify&&this.FOnValueNotify(this,t,e)},this.Create$1=function(t){return this.FMap=new Map,this},this.Destroy=function(){pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FKeyCollection},set:function(t){this.p.FKeyCollection=t}}),pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FValueCollection},set:function(t){this.p.FValueCollection=t}}),this.Clear(),this.FMap=null,pas.System.TObject.Destroy.call(this)},this.Clear=function(){var t=null,e=null,i=[],s=pas.System.TGuid.$new(),o=null;if(this.CanClearMap())this.FMap.clear();else{t=this.FMap.entries();do{(e=t.next()).done||(i=e.value,s.$assign(rtl.getObject(i[0])),o=rtl.getObject(i[1]),this.FMap.delete(pas.System.TGuid.$clone(s)),this.PairNotify(s,o,1))}while(!e.done)}},this.TryGetValue=function(t,e){var i,s=pas.System.TGuid.$new();return s.$assign(this.GetEffectiveKey(pas.System.TGuid.$clone(t))),(i=this.FMap.has(pas.System.TGuid.$clone(s)))&&e.set(rtl.getObject(this.FMap.get(pas.System.TGuid.$clone(s)))),i}}),"TDictionary<System.TGuid,WebLib.SERTTK.Session.TSEStepDiffAnalysis>"),rtl.createClass(this,"TObjectDictionary$G6",this.TDictionary$G9,(function(){this.$init=function(){t.TDictionary$G9.$init.call(this),this.FOwnerships={}},this.$final=function(){this.FOwnerships=void 0,t.TDictionary$G9.$final.call(this)},this.CanClearMap=function(){return t.TDictionary$G9.CanClearMap.call(this)&&rtl.eqSet(this.FOwnerships,{})},this.KeyNotify=function(e,i){t.TDictionary$G9.KeyNotify.call(this,e,i),0 in this.FOwnerships&&1===i&&(e=rtl.freeLoc(e))},this.ValueNotify=function(e,i){t.TDictionary$G9.ValueNotify.call(this,e,i),1 in this.FOwnerships&&1===i&&(e=rtl.freeLoc(e))},this.Create$5=function(e){return t.TDictionary$G9.Create$1.call(this,0),this.FOwnerships=rtl.refSet(e),this}}),"TObjectDictionary<System.TGuid,WebLib.SERTTK.Session.TSEStepDiffAnalysis>"),rtl.createClass(this,"TEnumerator$G44",pas.System.TObject,(function(){this.MoveNext=function(){return this.DoMoveNext()}}),"TEnumerator<WebLib.SERTTK.Repository.TSERTTKRepoLabel>"),rtl.createClass(this,"TEnumerable$G43",pas.System.TObject,(function(){}),"TEnumerable<WebLib.SERTTK.Repository.TSERTTKRepoLabel>"),rtl.createClass(this,"TCustomList$G21",this.TEnumerable$G43,(function(){this.$init=function(){t.TEnumerable$G43.$init.call(this),this.FOnNotify=null,this.FLength=0,this.FItems=[]},this.$final=function(){this.FOnNotify=void 0,this.FItems=void 0,t.TEnumerable$G43.$final.call(this)},this.GetCapacity=function(){return rtl.length(this.FItems)},this.PrepareAddingItem=function(){var t;return this.FLength===rtl.length(this.FItems)&&this.FItems.push(null),t=this.FLength,this.FLength+=1,t},this.Notify=function(t,e){null!=this.FOnNotify&&this.FOnNotify(this,t,e)}}),"TCustomList<WebLib.SERTTK.Repository.TSERTTKRepoLabel>"),rtl.createClass(this,"TCustomListEnumerator$G19",this.TEnumerator$G44,(function(){this.$init=function(){t.TEnumerator$G44.$init.call(this),this.FList=null,this.FIndex=0},this.$final=function(){this.FList=void 0,t.TEnumerator$G44.$final.call(this)},this.DoMoveNext=function(){return this.FIndex+=1,this.FList.FLength>0&&this.FIndex<this.FList.FLength},this.DoGetCurrent=function(){return this.GetCurrent()},this.GetCurrent=function(){return this.FList.FItems[this.FIndex]},this.Create$1=function(t){return pas.System.TObject.Create.call(this),this.FIndex=-1,this.FList=t,this}}),"TCustomListEnumerator<WebLib.SERTTK.Repository.TSERTTKRepoLabel>"),rtl.createClass(this,"TList$G14",this.TCustomList$G21,(function(){rtl.createClass(this,"TEnumerator",t.TCustomListEnumerator$G19,(function(){}),"TList<WebLib.SERTTK.Repository.TSERTTKRepoLabel>.TEnumerator"),this.SetCapacity=function(t){t<this.FLength&&this.SetCount(t),this.FItems=rtl.arraySetLength(this.FItems,null,t)},this.SetCount=function(t){if(t<0)throw pas.SysUtils.EArgumentOutOfRangeException.$create("Create$1",[rtl.getResStr(pas["Generics.Strings"],"SArgumentOutOfRange")]);t>this.GetCapacity()?this.SetCapacity(t):t<this.FLength&&this.DeleteRange(t,this.FLength-t),this.FLength=t},this.InitializeList=function(){},this.GetEnumerator$1=function(){return this.TEnumerator.$create("Create$1",[this])},this.Create$1=function(){return this.InitializeList(),this},this.Destroy=function(){this.SetCapacity(0)},this.Add=function(t){var e;return e=this.PrepareAddingItem(),this.FItems[e]=t,this.Notify(t,0),e},this.DeleteRange=function(t,e){var i,s=0;if(0!==e){if(e<0||t<0||t+e>this.FLength)throw pas.SysUtils.EArgumentOutOfRangeException.$create("Create$1",[rtl.getResStr(pas["Generics.Strings"],"SArgumentOutOfRange")]);i=this.FItems.splice(t,this.FLength),this.FLength-=e;for(var o=0,n=rtl.length(i)-1;o<=n;o++)s=o,this.Notify(i[s],1)}}}),"TList<WebLib.SERTTK.Repository.TSERTTKRepoLabel>"),rtl.createClass(this,"TObjectList$G8",this.TList$G14,(function(){this.$init=function(){t.TList$G14.$init.call(this),this.FObjectsOwner=!1},this.Notify=function(e,i){t.TCustomList$G21.Notify.call(this,e,i),this.FObjectsOwner&&1===i&&(e=rtl.freeLoc(e))},this.Create$4=function(e){return t.TList$G14.Create$1.call(this),this.FObjectsOwner=e,this}}),"TObjectList<WebLib.SERTTK.Repository.TSERTTKRepoLabel>"),rtl.createClass(this,"TEnumerator$G45",pas.System.TObject,(function(){this.MoveNext=function(){return this.DoMoveNext()}}),"TEnumerator<WebLib.SERTTK.Repository.TSERTTKRepoItem>"),rtl.createClass(this,"TEnumerable$G44",pas.System.TObject,(function(){}),"TEnumerable<WebLib.SERTTK.Repository.TSERTTKRepoItem>"),rtl.createClass(this,"TCustomList$G22",this.TEnumerable$G44,(function(){this.$init=function(){t.TEnumerable$G44.$init.call(this),this.FOnNotify=null,this.FLength=0,this.FItems=[]},this.$final=function(){this.FOnNotify=void 0,this.FItems=void 0,t.TEnumerable$G44.$final.call(this)},this.GetCapacity=function(){return rtl.length(this.FItems)},this.PrepareAddingItem=function(){var t;return this.FLength===rtl.length(this.FItems)&&this.FItems.push(null),t=this.FLength,this.FLength+=1,t},this.Notify=function(t,e){null!=this.FOnNotify&&this.FOnNotify(this,t,e)},this.DoRemove=function(t,e){var i;if(t<0||t>=this.FLength)throw pas.SysUtils.EArgumentOutOfRangeException.$create("Create$1",[rtl.getResStr(pas["Generics.Strings"],"SArgumentOutOfRange")]);return i=this.FItems[t],this.FLength-=1,this.FItems[t]=null,this.FItems.splice(t,1),this.Notify(i,e),i}}),"TCustomList<WebLib.SERTTK.Repository.TSERTTKRepoItem>"),rtl.createClass(this,"TCustomListEnumerator$G20",this.TEnumerator$G45,(function(){this.$init=function(){t.TEnumerator$G45.$init.call(this),this.FList=null,this.FIndex=0},this.$final=function(){this.FList=void 0,t.TEnumerator$G45.$final.call(this)},this.DoMoveNext=function(){return this.FIndex+=1,this.FList.FLength>0&&this.FIndex<this.FList.FLength},this.DoGetCurrent=function(){return this.GetCurrent()},this.GetCurrent=function(){return this.FList.FItems[this.FIndex]},this.Create$1=function(t){return pas.System.TObject.Create.call(this),this.FIndex=-1,this.FList=t,this}}),"TCustomListEnumerator<WebLib.SERTTK.Repository.TSERTTKRepoItem>"),rtl.createClass(this,"TList$G15",this.TCustomList$G22,(function(){rtl.createClass(this,"TEnumerator",t.TCustomListEnumerator$G20,(function(){}),"TList<WebLib.SERTTK.Repository.TSERTTKRepoItem>.TEnumerator"),this.$init=function(){t.TCustomList$G22.$init.call(this),this.FComparer=null},this.$final=function(){rtl.setIntfP(this,"FComparer",null),t.TCustomList$G22.$final.call(this)},this.SameValue=function(t,e){return null!=this.FComparer?0===this.FComparer.Compare(t,e):t===e},this.SetCapacity=function(t){t<this.FLength&&this.SetCount(t),this.FItems=rtl.arraySetLength(this.FItems,null,t)},this.SetCount=function(t){if(t<0)throw pas.SysUtils.EArgumentOutOfRangeException.$create("Create$1",[rtl.getResStr(pas["Generics.Strings"],"SArgumentOutOfRange")]);t>this.GetCapacity()?this.SetCapacity(t):t<this.FLength&&this.DeleteRange(t,this.FLength-t),this.FLength=t},this.InitializeList=function(){},this.GetItem=function(t){if(t<0||t>=this.FLength)throw pas.SysUtils.EArgumentOutOfRangeException.$create("Create$1",[rtl.getResStr(pas["Generics.Strings"],"SArgumentOutOfRange")]);return this.FItems[t]},this.GetEnumerator$1=function(){return this.TEnumerator.$create("Create$1",[this])},this.Create$1=function(){return this.InitializeList(),this},this.Destroy=function(){this.SetCapacity(0)},this.Add=function(t){var e;return e=this.PrepareAddingItem(),this.FItems[e]=t,this.Notify(t,0),e},this.DeleteRange=function(t,e){var i,s=0;if(0!==e){if(e<0||t<0||t+e>this.FLength)throw pas.SysUtils.EArgumentOutOfRangeException.$create("Create$1",[rtl.getResStr(pas["Generics.Strings"],"SArgumentOutOfRange")]);i=this.FItems.splice(t,this.FLength),this.FLength-=e;for(var o=0,n=rtl.length(i)-1;o<=n;o++)s=o,this.Notify(i[s],1)}},this.Extract=function(t){var e;return(e=this.IndexOf(t))<0?null:this.DoRemove(e,2)},this.Move=function(t,e){var i,s=null,o=0;if(e!==t){if(e<0||e>=this.FLength)throw pas.SysUtils.EArgumentOutOfRangeException.$create("Create$1",[rtl.getResStr(pas["Generics.Strings"],"SArgumentOutOfRange")]);if(i=(s=this.FItems)[t],t<e)for(var n=t,r=e-1;n<=r;n++)s[o=n]=s[o+1];else for(var a=t,l=e+1;a>=l;a--)s[o=a]=s[o-1];s[e]=i}},this.Clear=function(){this.SetCount(0),this.SetCapacity(0)},this.Contains=function(t){return this.IndexOf(t)>=0},this.IndexOf=function(t){for(var e=0,i=0,s=this.FLength-1;i<=s;i++)if(e=i,this.SameValue(t,this.FItems[e]))return e;return-1,-1}}),"TList<WebLib.SERTTK.Repository.TSERTTKRepoItem>"),rtl.createClass(this,"TEnumerable$G45",pas.System.TObject,(function(){}),"TEnumerable<WebLib.SERTTK.Repository.TSESInspectToolBase>"),rtl.createClass(this,"TCustomList$G23",this.TEnumerable$G45,(function(){this.$init=function(){t.TEnumerable$G45.$init.call(this),this.FOnNotify=null,this.FLength=0,this.FItems=[]},this.$final=function(){this.FOnNotify=void 0,this.FItems=void 0,t.TEnumerable$G45.$final.call(this)},this.GetCapacity=function(){return rtl.length(this.FItems)},this.PrepareAddingItem=function(){var t;return this.FLength===rtl.length(this.FItems)&&this.FItems.push(null),t=this.FLength,this.FLength+=1,t},this.Notify=function(t,e){null!=this.FOnNotify&&this.FOnNotify(this,t,e)}}),"TCustomList<WebLib.SERTTK.Repository.TSESInspectToolBase>"),rtl.createClass(this,"TList$G16",this.TCustomList$G23,(function(){this.SetCapacity=function(t){t<this.FLength&&this.SetCount(t),this.FItems=rtl.arraySetLength(this.FItems,null,t)},this.SetCount=function(t){if(t<0)throw pas.SysUtils.EArgumentOutOfRangeException.$create("Create$1",[rtl.getResStr(pas["Generics.Strings"],"SArgumentOutOfRange")]);t>this.GetCapacity()?this.SetCapacity(t):t<this.FLength&&this.DeleteRange(t,this.FLength-t),this.FLength=t},this.InitializeList=function(){},this.GetItem=function(t){if(t<0||t>=this.FLength)throw pas.SysUtils.EArgumentOutOfRangeException.$create("Create$1",[rtl.getResStr(pas["Generics.Strings"],"SArgumentOutOfRange")]);return this.FItems[t]},this.Create$1=function(){return this.InitializeList(),this},this.Destroy=function(){this.SetCapacity(0)},this.Add=function(t){var e;return e=this.PrepareAddingItem(),this.FItems[e]=t,this.Notify(t,0),e},this.DeleteRange=function(t,e){var i,s=0;if(0!==e){if(e<0||t<0||t+e>this.FLength)throw pas.SysUtils.EArgumentOutOfRangeException.$create("Create$1",[rtl.getResStr(pas["Generics.Strings"],"SArgumentOutOfRange")]);i=this.FItems.splice(t,this.FLength),this.FLength-=e;for(var o=0,n=rtl.length(i)-1;o<=n;o++)s=o,this.Notify(i[s],1)}},this.Exchange=function(t,e){var i;i=this.FItems[t],this.FItems[t]=this.FItems[e],this.FItems[e]=i}}),"TList<WebLib.SERTTK.Repository.TSESInspectToolBase>"),rtl.createClass(this,"TObjectList$G9",this.TList$G16,(function(){this.$init=function(){t.TList$G16.$init.call(this),this.FObjectsOwner=!1},this.Notify=function(e,i){t.TCustomList$G23.Notify.call(this,e,i),this.FObjectsOwner&&1===i&&(e=rtl.freeLoc(e))},this.Create$4=function(e){return t.TList$G16.Create$1.call(this),this.FObjectsOwner=e,this}}),"TObjectList<WebLib.SERTTK.Repository.TSESInspectToolBase>"),rtl.createClass(this,"TEnumerator$G47",pas.System.TObject,(function(){this.MoveNext=function(){return this.DoMoveNext()}}),"TEnumerator<WebLib.SERTTK.Repository.TSESRepoRoot>"),rtl.createClass(this,"TEnumerable$G46",pas.System.TObject,(function(){}),"TEnumerable<WebLib.SERTTK.Repository.TSESRepoRoot>"),rtl.createClass(this,"TCustomList$G24",this.TEnumerable$G46,(function(){this.$init=function(){t.TEnumerable$G46.$init.call(this),this.FOnNotify=null,this.FLength=0,this.FItems=[]},this.$final=function(){this.FOnNotify=void 0,this.FItems=void 0,t.TEnumerable$G46.$final.call(this)},this.GetCapacity=function(){return rtl.length(this.FItems)},this.PrepareAddingItem=function(){var t;return this.FLength===rtl.length(this.FItems)&&this.FItems.push(null),t=this.FLength,this.FLength+=1,t},this.Notify=function(t,e){null!=this.FOnNotify&&this.FOnNotify(this,t,e)}}),"TCustomList<WebLib.SERTTK.Repository.TSESRepoRoot>"),rtl.createClass(this,"TCustomListEnumerator$G22",this.TEnumerator$G47,(function(){this.$init=function(){t.TEnumerator$G47.$init.call(this),this.FList=null,this.FIndex=0},this.$final=function(){this.FList=void 0,t.TEnumerator$G47.$final.call(this)},this.DoMoveNext=function(){return this.FIndex+=1,this.FList.FLength>0&&this.FIndex<this.FList.FLength},this.DoGetCurrent=function(){return this.GetCurrent()},this.GetCurrent=function(){return this.FList.FItems[this.FIndex]},this.Create$1=function(t){return pas.System.TObject.Create.call(this),this.FIndex=-1,this.FList=t,this}}),"TCustomListEnumerator<WebLib.SERTTK.Repository.TSESRepoRoot>"),rtl.createClass(this,"TList$G17",this.TCustomList$G24,(function(){rtl.createClass(this,"TEnumerator",t.TCustomListEnumerator$G22,(function(){}),"TList<WebLib.SERTTK.Repository.TSESRepoRoot>.TEnumerator"),this.$init=function(){t.TCustomList$G24.$init.call(this),this.FComparer=null},this.$final=function(){rtl.setIntfP(this,"FComparer",null),t.TCustomList$G24.$final.call(this)},this.SameValue=function(t,e){return null!=this.FComparer?0===this.FComparer.Compare(t,e):t===e},this.SetCapacity=function(t){t<this.FLength&&this.SetCount(t),this.FItems=rtl.arraySetLength(this.FItems,null,t)},this.SetCount=function(t){if(t<0)throw pas.SysUtils.EArgumentOutOfRangeException.$create("Create$1",[rtl.getResStr(pas["Generics.Strings"],"SArgumentOutOfRange")]);t>this.GetCapacity()?this.SetCapacity(t):t<this.FLength&&this.DeleteRange(t,this.FLength-t),this.FLength=t},this.InitializeList=function(){},this.GetEnumerator$1=function(){return this.TEnumerator.$create("Create$1",[this])},this.Create$1=function(){return this.InitializeList(),this},this.Destroy=function(){this.SetCapacity(0)},this.Add=function(t){var e;return e=this.PrepareAddingItem(),this.FItems[e]=t,this.Notify(t,0),e},this.DeleteRange=function(t,e){var i,s=0;if(0!==e){if(e<0||t<0||t+e>this.FLength)throw pas.SysUtils.EArgumentOutOfRangeException.$create("Create$1",[rtl.getResStr(pas["Generics.Strings"],"SArgumentOutOfRange")]);i=this.FItems.splice(t,this.FLength),this.FLength-=e;for(var o=0,n=rtl.length(i)-1;o<=n;o++)s=o,this.Notify(i[s],1)}},this.IndexOf=function(t){for(var e=0,i=0,s=this.FLength-1;i<=s;i++)if(e=i,this.SameValue(t,this.FItems[e]))return e;return-1,-1}}),"TList<WebLib.SERTTK.Repository.TSESRepoRoot>"),rtl.recNewT(this,"TPair$G12",(function(){this.$eq=function(t){return!0},this.$assign=function(t){return this}})),rtl.createClass(this,"TEnumerable$G47",pas.System.TObject,(function(){}),"TEnumerable<Generics.Collections.TPair<System.TObject,WebLib.SERTTK.Repository.TSERTTKRepoItem>>"),rtl.createClass(this,"TDictionary$G10",this.TEnumerable$G47,(function(){rtl.createClass(this,"TValueCollection",t.TEnumerable$G44,(function(){}),"TDictionary<System.TObject,WebLib.SERTTK.Repository.TSERTTKRepoItem>.TValueCollection"),rtl.createClass(this,"TKeyCollection",t.TEnumerable$G21,(function(){}),"TDictionary<System.TObject,WebLib.SERTTK.Repository.TSERTTKRepoItem>.TKeyCollection"),this.$init=function(){t.TEnumerable$G47.$init.call(this),this.FMap=null,this.FComparer=null,this.FOnKeyNotify=null,this.FOnValueNotify=null,this.FKeyCollection=null,this.FValueCollection=null},this.$final=function(){this.FMap=void 0,rtl.setIntfP(this,"FComparer",null),this.FOnKeyNotify=void 0,this.FOnValueNotify=void 0,this.FKeyCollection=void 0,this.FValueCollection=void 0,t.TEnumerable$G47.$final.call(this)},this.GetEffectiveKey=function(t){var e=null,i=null,s=null;if(null==this.FComparer)return t;for(s=(i=this.FMap.keys()).next();!s.done;){if(e=rtl.getObject(s.value),0===this.FComparer.Compare(e,t))return e;s=i.next()}return e=t},this.SetItem=function(t,e){var i;i=this.FMap.get(this.GetEffectiveKey(t)),pas.JS.isUndefined(i)||this.ValueNotify(rtl.getObject(i),1),this.FMap.set(t,e),this.ValueNotify(e,0)},this.DoAdd=function(t,e){this.FMap.set(this.GetEffectiveKey(t),e),this.KeyNotify(t,0),this.ValueNotify(e,0)},this.CanClearMap=function(){return null===this.FOnKeyNotify&&null===this.FOnValueNotify},this.PairNotify=function(t,e,i){this.KeyNotify(t,i),this.ValueNotify(e,i)},this.KeyNotify=function(t,e){null!=this.FOnKeyNotify&&this.FOnKeyNotify(this,t,e)},this.ValueNotify=function(t,e){null!=this.FOnValueNotify&&this.FOnValueNotify(this,t,e)},this.Create$1=function(t){return this.FMap=new Map,this},this.Destroy=function(){pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FKeyCollection},set:function(t){this.p.FKeyCollection=t}}),pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FValueCollection},set:function(t){this.p.FValueCollection=t}}),this.Clear(),this.FMap=null,pas.System.TObject.Destroy.call(this)},this.Clear=function(){var t=null,e=null,i=[],s=null,o=null;if(this.CanClearMap())this.FMap.clear();else{t=this.FMap.entries();do{(e=t.next()).done||(i=e.value,s=rtl.getObject(i[0]),o=rtl.getObject(i[1]),this.FMap.delete(s),this.PairNotify(s,o,1))}while(!e.done)}},this.TryGetValue=function(t,e){var i,s;return s=this.GetEffectiveKey(t),(i=this.FMap.has(s))&&e.set(rtl.getObject(this.FMap.get(s))),i},this.AddOrSetValue=function(t,e){var i;i=this.GetEffectiveKey(t),this.FMap.has(i)?this.SetItem(i,e):this.DoAdd(t,e)}}),"TDictionary<System.TObject,WebLib.SERTTK.Repository.TSERTTKRepoItem>"),rtl.createClass(this,"TObjectDictionary$G7",this.TDictionary$G10,(function(){this.$init=function(){t.TDictionary$G10.$init.call(this),this.FOwnerships={}},this.$final=function(){this.FOwnerships=void 0,t.TDictionary$G10.$final.call(this)},this.CanClearMap=function(){return t.TDictionary$G10.CanClearMap.call(this)&&rtl.eqSet(this.FOwnerships,{})},this.KeyNotify=function(e,i){t.TDictionary$G10.KeyNotify.call(this,e,i),0 in this.FOwnerships&&1===i&&(e=rtl.freeLoc(e))},this.ValueNotify=function(e,i){t.TDictionary$G10.ValueNotify.call(this,e,i),1 in this.FOwnerships&&1===i&&(e=rtl.freeLoc(e))},this.Create$5=function(e){return t.TDictionary$G10.Create$1.call(this,0),this.FOwnerships=rtl.refSet(e),this}}),"TObjectDictionary<System.TObject,WebLib.SERTTK.Repository.TSERTTKRepoItem>"),rtl.recNewT(this,"TPair$G13",(function(){this.$eq=function(t){return!0},this.$assign=function(t){return this}})),rtl.createClass(this,"TEnumerable$G48",pas.System.TObject,(function(){}),"TEnumerable<Generics.Collections.TPair<WebLib.SERTTK.Repository.TSERTTKRepoItem,WebLib.SERTTK.Repository.TSERTTKRepoItem>>"),rtl.createClass(this,"TDictionary$G11",this.TEnumerable$G48,(function(){rtl.createClass(this,"TValueCollection",t.TEnumerable$G44,(function(){}),"TDictionary<WebLib.SERTTK.Repository.TSERTTKRepoItem,WebLib.SERTTK.Repository.TSERTTKRepoItem>.TValueCollection"),rtl.createClass(this,"TKeyCollection",t.TEnumerable$G44,(function(){}),"TDictionary<WebLib.SERTTK.Repository.TSERTTKRepoItem,WebLib.SERTTK.Repository.TSERTTKRepoItem>.TKeyCollection"),this.$init=function(){t.TEnumerable$G48.$init.call(this),this.FMap=null,this.FComparer=null,this.FOnKeyNotify=null,this.FOnValueNotify=null,this.FKeyCollection=null,this.FValueCollection=null},this.$final=function(){this.FMap=void 0,rtl.setIntfP(this,"FComparer",null),this.FOnKeyNotify=void 0,this.FOnValueNotify=void 0,this.FKeyCollection=void 0,this.FValueCollection=void 0,t.TEnumerable$G48.$final.call(this)},this.GetEffectiveKey=function(t){var e=null,i=null,s=null;if(null==this.FComparer)return t;for(s=(i=this.FMap.keys()).next();!s.done;){if(e=rtl.getObject(s.value),0===this.FComparer.Compare(e,t))return e;s=i.next()}return e=t},this.SetItem=function(t,e){var i;i=this.FMap.get(this.GetEffectiveKey(t)),pas.JS.isUndefined(i)||this.ValueNotify(rtl.getObject(i),1),this.FMap.set(t,e),this.ValueNotify(e,0)},this.DoAdd=function(t,e){this.FMap.set(this.GetEffectiveKey(t),e),this.KeyNotify(t,0),this.ValueNotify(e,0)},this.CanClearMap=function(){return null===this.FOnKeyNotify&&null===this.FOnValueNotify},this.PairNotify=function(t,e,i){this.KeyNotify(t,i),this.ValueNotify(e,i)},this.KeyNotify=function(t,e){null!=this.FOnKeyNotify&&this.FOnKeyNotify(this,t,e)},this.ValueNotify=function(t,e){null!=this.FOnValueNotify&&this.FOnValueNotify(this,t,e)},this.Create$1=function(t){return this.FMap=new Map,this},this.Destroy=function(){pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FKeyCollection},set:function(t){this.p.FKeyCollection=t}}),pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FValueCollection},set:function(t){this.p.FValueCollection=t}}),this.Clear(),this.FMap=null,pas.System.TObject.Destroy.call(this)},this.Clear=function(){var t=null,e=null,i=[],s=null,o=null;if(this.CanClearMap())this.FMap.clear();else{t=this.FMap.entries();do{(e=t.next()).done||(i=e.value,s=rtl.getObject(i[0]),o=rtl.getObject(i[1]),this.FMap.delete(s),this.PairNotify(s,o,1))}while(!e.done)}},this.AddOrSetValue=function(t,e){var i;i=this.GetEffectiveKey(t),this.FMap.has(i)?this.SetItem(i,e):this.DoAdd(t,e)}}),"TDictionary<WebLib.SERTTK.Repository.TSERTTKRepoItem,WebLib.SERTTK.Repository.TSERTTKRepoItem>"),rtl.recNewT(this,"TPair$G14",(function(){this.$eq=function(t){return!0},this.$assign=function(t){return this}})),rtl.createClass(this,"TEnumerable$G49",pas.System.TObject,(function(){}),"TEnumerable<Generics.Collections.TPair<System.Longint,WebLib.SERTTK.Repository.TSESDisplayInfo>>"),rtl.createClass(this,"TEnumerable$G50",pas.System.TObject,(function(){}),"TEnumerable<WebLib.SERTTK.Repository.TSESDisplayInfo>"),rtl.createClass(this,"TDictionary$G12",this.TEnumerable$G49,(function(){rtl.createClass(this,"TValueCollection",t.TEnumerable$G50,(function(){}),"TDictionary<System.Longint,WebLib.SERTTK.Repository.TSESDisplayInfo>.TValueCollection"),rtl.createClass(this,"TKeyCollection",t.TEnumerable$G19,(function(){}),"TDictionary<System.Longint,WebLib.SERTTK.Repository.TSESDisplayInfo>.TKeyCollection"),this.$init=function(){t.TEnumerable$G49.$init.call(this),this.FMap=null,this.FComparer=null,this.FOnKeyNotify=null,this.FOnValueNotify=null,this.FKeyCollection=null,this.FValueCollection=null},this.$final=function(){this.FMap=void 0,rtl.setIntfP(this,"FComparer",null),this.FOnKeyNotify=void 0,this.FOnValueNotify=void 0,this.FKeyCollection=void 0,this.FValueCollection=void 0,t.TEnumerable$G49.$final.call(this)},this.GetEffectiveKey=function(t){var e=0,i=null,s=null;if(null==this.FComparer)return t;for(s=(i=this.FMap.keys()).next();!s.done;){if(e=rtl.trunc(s.value),0===this.FComparer.Compare(e,t))return e;s=i.next()}return e=t},this.DoAdd=function(t,e){this.FMap.set(this.GetEffectiveKey(t),e),this.KeyNotify(t,0),this.ValueNotify(e,0)},this.CanClearMap=function(){return null===this.FOnKeyNotify&&null===this.FOnValueNotify},this.PairNotify=function(t,e,i){this.KeyNotify(t,i),this.ValueNotify(e,i)},this.KeyNotify=function(t,e){null!=this.FOnKeyNotify&&this.FOnKeyNotify(this,t,e)},this.ValueNotify=function(t,e){null!=this.FOnValueNotify&&this.FOnValueNotify(this,t,e)},this.Create$1=function(t){return this.FMap=new Map,this},this.Destroy=function(){pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FKeyCollection},set:function(t){this.p.FKeyCollection=t}}),pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FValueCollection},set:function(t){this.p.FValueCollection=t}}),this.Clear(),this.FMap=null,pas.System.TObject.Destroy.call(this)},this.Add=function(e,i){if(this.FMap.has(this.GetEffectiveKey(e)))throw t.EDictionary.$create("Create$1",[rtl.getResStr(t,"SErrDictDuplicateKey")]);this.DoAdd(e,i)},this.Clear=function(){var t=null,e=null,i=[],s=0,o=null;if(this.CanClearMap())this.FMap.clear();else{t=this.FMap.entries();do{(e=t.next()).done||(i=e.value,s=rtl.trunc(i[0]),o=rtl.getObject(i[1]),this.FMap.delete(s),this.PairNotify(s,o,1))}while(!e.done)}}}),"TDictionary<System.Longint,WebLib.SERTTK.Repository.TSESDisplayInfo>"),rtl.createClass(this,"TObjectDictionary$G8",this.TDictionary$G12,(function(){this.$init=function(){t.TDictionary$G12.$init.call(this),this.FOwnerships={}},this.$final=function(){this.FOwnerships=void 0,t.TDictionary$G12.$final.call(this)},this.CanClearMap=function(){return t.TDictionary$G12.CanClearMap.call(this)&&rtl.eqSet(this.FOwnerships,{})},this.KeyNotify=function(e,i){t.TDictionary$G12.KeyNotify.call(this,e,i),0 in this.FOwnerships&&1===i&&(e=rtl.freeLoc(e))},this.ValueNotify=function(e,i){t.TDictionary$G12.ValueNotify.call(this,e,i),1 in this.FOwnerships&&1===i&&(e=rtl.freeLoc(e))},this.Create$5=function(e){return t.TDictionary$G12.Create$1.call(this,0),this.FOwnerships=rtl.refSet(e),this}}),"TObjectDictionary<System.Longint,WebLib.SERTTK.Repository.TSESDisplayInfo>"),rtl.createClass(this,"TEnumerator$G52",pas.System.TObject,(function(){this.MoveNext=function(){return this.DoMoveNext()}}),"TEnumerator<WebLib.SERTTK.Repository.TSESFormInfo>"),rtl.createClass(this,"TEnumerable$G51",pas.System.TObject,(function(){}),"TEnumerable<WebLib.SERTTK.Repository.TSESFormInfo>"),rtl.createClass(this,"TCustomList$G25",this.TEnumerable$G51,(function(){this.$init=function(){t.TEnumerable$G51.$init.call(this),this.FOnNotify=null,this.FLength=0,this.FItems=[]},this.$final=function(){this.FOnNotify=void 0,this.FItems=void 0,t.TEnumerable$G51.$final.call(this)},this.GetCapacity=function(){return rtl.length(this.FItems)},this.PrepareAddingItem=function(){var t;return this.FLength===rtl.length(this.FItems)&&this.FItems.push(null),t=this.FLength,this.FLength+=1,t},this.Notify=function(t,e){null!=this.FOnNotify&&this.FOnNotify(this,t,e)}}),"TCustomList<WebLib.SERTTK.Repository.TSESFormInfo>"),rtl.createClass(this,"TCustomListEnumerator$G23",this.TEnumerator$G52,(function(){this.$init=function(){t.TEnumerator$G52.$init.call(this),this.FList=null,this.FIndex=0},this.$final=function(){this.FList=void 0,t.TEnumerator$G52.$final.call(this)},this.DoMoveNext=function(){return this.FIndex+=1,this.FList.FLength>0&&this.FIndex<this.FList.FLength},this.DoGetCurrent=function(){return this.GetCurrent()},this.GetCurrent=function(){return this.FList.FItems[this.FIndex]},this.Create$1=function(t){return pas.System.TObject.Create.call(this),this.FIndex=-1,this.FList=t,this}}),"TCustomListEnumerator<WebLib.SERTTK.Repository.TSESFormInfo>"),rtl.createClass(this,"TList$G18",this.TCustomList$G25,(function(){rtl.createClass(this,"TEnumerator",t.TCustomListEnumerator$G23,(function(){}),"TList<WebLib.SERTTK.Repository.TSESFormInfo>.TEnumerator"),this.SetCapacity=function(t){t<this.FLength&&this.SetCount(t),this.FItems=rtl.arraySetLength(this.FItems,null,t)},this.SetCount=function(t){if(t<0)throw pas.SysUtils.EArgumentOutOfRangeException.$create("Create$1",[rtl.getResStr(pas["Generics.Strings"],"SArgumentOutOfRange")]);t>this.GetCapacity()?this.SetCapacity(t):t<this.FLength&&this.DeleteRange(t,this.FLength-t),this.FLength=t},this.InitializeList=function(){},this.GetEnumerator$1=function(){return this.TEnumerator.$create("Create$1",[this])},this.Create$1=function(){return this.InitializeList(),this},this.Destroy=function(){this.SetCapacity(0)},this.Add=function(t){var e;return e=this.PrepareAddingItem(),this.FItems[e]=t,this.Notify(t,0),e},this.DeleteRange=function(t,e){var i,s=0;if(0!==e){if(e<0||t<0||t+e>this.FLength)throw pas.SysUtils.EArgumentOutOfRangeException.$create("Create$1",[rtl.getResStr(pas["Generics.Strings"],"SArgumentOutOfRange")]);i=this.FItems.splice(t,this.FLength),this.FLength-=e;for(var o=0,n=rtl.length(i)-1;o<=n;o++)s=o,this.Notify(i[s],1)}}}),"TList<WebLib.SERTTK.Repository.TSESFormInfo>"),rtl.createClass(this,"TObjectList$G10",this.TList$G18,(function(){this.$init=function(){t.TList$G18.$init.call(this),this.FObjectsOwner=!1},this.Notify=function(e,i){t.TCustomList$G25.Notify.call(this,e,i),this.FObjectsOwner&&1===i&&(e=rtl.freeLoc(e))},this.Create$4=function(e){return t.TList$G18.Create$1.call(this),this.FObjectsOwner=e,this}}),"TObjectList<WebLib.SERTTK.Repository.TSESFormInfo>"),rtl.createClass(this,"TEnumerator$G53",pas.System.TObject,(function(){this.MoveNext=function(){return this.DoMoveNext()}}),"TEnumerator<Classes.TComponent>"),rtl.createClass(this,"TEnumerable$G52",pas.System.TObject,(function(){}),"TEnumerable<Classes.TComponent>"),rtl.createClass(this,"TCustomList$G26",this.TEnumerable$G52,(function(){this.$init=function(){t.TEnumerable$G52.$init.call(this),this.FOnNotify=null,this.FLength=0,this.FItems=[]},this.$final=function(){this.FOnNotify=void 0,this.FItems=void 0,t.TEnumerable$G52.$final.call(this)},this.GetCapacity=function(){return rtl.length(this.FItems)},this.PrepareAddingItem=function(){var t;return this.FLength===rtl.length(this.FItems)&&this.FItems.push(null),t=this.FLength,this.FLength+=1,t},this.Notify=function(t,e){null!=this.FOnNotify&&this.FOnNotify(this,t,e)}}),"TCustomList<Classes.TComponent>"),rtl.createClass(this,"TCustomListEnumerator$G24",this.TEnumerator$G53,(function(){this.$init=function(){t.TEnumerator$G53.$init.call(this),this.FList=null,this.FIndex=0},this.$final=function(){this.FList=void 0,t.TEnumerator$G53.$final.call(this)},this.DoMoveNext=function(){return this.FIndex+=1,this.FList.FLength>0&&this.FIndex<this.FList.FLength},this.DoGetCurrent=function(){return this.GetCurrent()},this.GetCurrent=function(){return this.FList.FItems[this.FIndex]},this.Create$1=function(t){return pas.System.TObject.Create.call(this),this.FIndex=-1,this.FList=t,this}}),"TCustomListEnumerator<Classes.TComponent>"),rtl.createClass(this,"TList$G19",this.TCustomList$G26,(function(){rtl.createClass(this,"TEnumerator",t.TCustomListEnumerator$G24,(function(){}),"TList<Classes.TComponent>.TEnumerator"),this.SetCapacity=function(t){t<this.FLength&&this.SetCount(t),this.FItems=rtl.arraySetLength(this.FItems,null,t)},this.SetCount=function(t){if(t<0)throw pas.SysUtils.EArgumentOutOfRangeException.$create("Create$1",[rtl.getResStr(pas["Generics.Strings"],"SArgumentOutOfRange")]);t>this.GetCapacity()?this.SetCapacity(t):t<this.FLength&&this.DeleteRange(t,this.FLength-t),this.FLength=t},this.InitializeList=function(){},this.GetEnumerator$1=function(){return this.TEnumerator.$create("Create$1",[this])},this.Create$1=function(){return this.InitializeList(),this},this.Destroy=function(){this.SetCapacity(0)},this.Add=function(t){var e;return e=this.PrepareAddingItem(),this.FItems[e]=t,this.Notify(t,0),e},this.DeleteRange=function(t,e){var i,s=0;if(0!==e){if(e<0||t<0||t+e>this.FLength)throw pas.SysUtils.EArgumentOutOfRangeException.$create("Create$1",[rtl.getResStr(pas["Generics.Strings"],"SArgumentOutOfRange")]);i=this.FItems.splice(t,this.FLength),this.FLength-=e;for(var o=0,n=rtl.length(i)-1;o<=n;o++)s=o,this.Notify(i[s],1)}}}),"TList<Classes.TComponent>"),rtl.createClass(this,"TEnumerator$G54",pas.System.TObject,(function(){this.MoveNext=function(){return this.DoMoveNext()}}),"TEnumerator<WebLib.SERTTK.Repository.TSESTransformBase>"),rtl.createClass(this,"TEnumerable$G53",pas.System.TObject,(function(){}),"TEnumerable<WebLib.SERTTK.Repository.TSESTransformBase>"),rtl.createClass(this,"TCustomList$G27",this.TEnumerable$G53,(function(){this.$init=function(){t.TEnumerable$G53.$init.call(this),this.FOnNotify=null,this.FLength=0,this.FItems=[]},this.$final=function(){this.FOnNotify=void 0,this.FItems=void 0,t.TEnumerable$G53.$final.call(this)},this.GetCapacity=function(){return rtl.length(this.FItems)},this.PrepareAddingItem=function(){var t;return this.FLength===rtl.length(this.FItems)&&this.FItems.push(null),t=this.FLength,this.FLength+=1,t},this.Notify=function(t,e){null!=this.FOnNotify&&this.FOnNotify(this,t,e)},this.DoRemove=function(t,e){var i;if(t<0||t>=this.FLength)throw pas.SysUtils.EArgumentOutOfRangeException.$create("Create$1",[rtl.getResStr(pas["Generics.Strings"],"SArgumentOutOfRange")]);return i=this.FItems[t],this.FLength-=1,this.FItems[t]=null,this.FItems.splice(t,1),this.Notify(i,e),i}}),"TCustomList<WebLib.SERTTK.Repository.TSESTransformBase>"),rtl.createClass(this,"TCustomListEnumerator$G25",this.TEnumerator$G54,(function(){this.$init=function(){t.TEnumerator$G54.$init.call(this),this.FList=null,this.FIndex=0},this.$final=function(){this.FList=void 0,t.TEnumerator$G54.$final.call(this)},this.DoMoveNext=function(){return this.FIndex+=1,this.FList.FLength>0&&this.FIndex<this.FList.FLength},this.DoGetCurrent=function(){return this.GetCurrent()},this.GetCurrent=function(){return this.FList.FItems[this.FIndex]},this.Create$1=function(t){return pas.System.TObject.Create.call(this),this.FIndex=-1,this.FList=t,this}}),"TCustomListEnumerator<WebLib.SERTTK.Repository.TSESTransformBase>"),rtl.createClass(this,"TList$G20",this.TCustomList$G27,(function(){rtl.createClass(this,"TEnumerator",t.TCustomListEnumerator$G25,(function(){}),"TList<WebLib.SERTTK.Repository.TSESTransformBase>.TEnumerator"),this.$init=function(){t.TCustomList$G27.$init.call(this),this.FComparer=null},this.$final=function(){rtl.setIntfP(this,"FComparer",null),t.TCustomList$G27.$final.call(this)},this.SameValue=function(t,e){return null!=this.FComparer?0===this.FComparer.Compare(t,e):t===e},this.SetCapacity=function(t){t<this.FLength&&this.SetCount(t),this.FItems=rtl.arraySetLength(this.FItems,null,t)},this.SetCount=function(t){if(t<0)throw pas.SysUtils.EArgumentOutOfRangeException.$create("Create$1",[rtl.getResStr(pas["Generics.Strings"],"SArgumentOutOfRange")]);t>this.GetCapacity()?this.SetCapacity(t):t<this.FLength&&this.DeleteRange(t,this.FLength-t),this.FLength=t},this.InitializeList=function(){},this.GetItem=function(t){if(t<0||t>=this.FLength)throw pas.SysUtils.EArgumentOutOfRangeException.$create("Create$1",[rtl.getResStr(pas["Generics.Strings"],"SArgumentOutOfRange")]);return this.FItems[t]},this.GetEnumerator$1=function(){return this.TEnumerator.$create("Create$1",[this])},this.Create$1=function(){return this.InitializeList(),this},this.Destroy=function(){this.SetCapacity(0)},this.Add=function(t){var e;return e=this.PrepareAddingItem(),this.FItems[e]=t,this.Notify(t,0),e},this.DeleteRange=function(t,e){var i,s=0;if(0!==e){if(e<0||t<0||t+e>this.FLength)throw pas.SysUtils.EArgumentOutOfRangeException.$create("Create$1",[rtl.getResStr(pas["Generics.Strings"],"SArgumentOutOfRange")]);i=this.FItems.splice(t,this.FLength),this.FLength-=e;for(var o=0,n=rtl.length(i)-1;o<=n;o++)s=o,this.Notify(i[s],1)}},this.Extract=function(t){var e;return(e=this.IndexOf(t))<0?null:this.DoRemove(e,2)},this.IndexOf=function(t){for(var e=0,i=0,s=this.FLength-1;i<=s;i++)if(e=i,this.SameValue(t,this.FItems[e]))return e;return-1,-1}}),"TList<WebLib.SERTTK.Repository.TSESTransformBase>"),rtl.createClass(this,"TObjectList$G11",this.TList$G20,(function(){this.$init=function(){t.TList$G20.$init.call(this),this.FObjectsOwner=!1},this.Notify=function(e,i){t.TCustomList$G27.Notify.call(this,e,i),this.FObjectsOwner&&1===i&&(e=rtl.freeLoc(e))},this.Create$4=function(e){return t.TList$G20.Create$1.call(this),this.FObjectsOwner=e,this}}),"TObjectList<WebLib.SERTTK.Repository.TSESTransformBase>"),rtl.recNewT(this,"TPair$G15",(function(){this.$eq=function(t){return!0},this.$assign=function(t){return this}})),rtl.createClass(this,"TEnumerable$G54",pas.System.TObject,(function(){}),"TEnumerable<Generics.Collections.TPair<System.TClass,Generics.Collections.TObjectList<WebLib.SERTTK.Repository.TSESTransformBase>>>"),rtl.createClass(this,"TEnumerable$G55",pas.System.TObject,(function(){}),"TEnumerable<Generics.Collections.TObjectList<WebLib.SERTTK.Repository.TSESTransformBase>>"),rtl.createClass(this,"TEnumerable$G56",pas.System.TObject,(function(){}),"TEnumerable<System.TClass>"),rtl.createClass(this,"TDictionary$G13",this.TEnumerable$G54,(function(){rtl.createClass(this,"TValueCollection",t.TEnumerable$G55,(function(){}),"TDictionary<System.TClass,Generics.Collections.TObjectList<WebLib.SERTTK.Repository.TSESTransformBase>>.TValueCollection"),rtl.createClass(this,"TKeyCollection",t.TEnumerable$G56,(function(){}),"TDictionary<System.TClass,Generics.Collections.TObjectList<WebLib.SERTTK.Repository.TSESTransformBase>>.TKeyCollection"),this.$init=function(){t.TEnumerable$G54.$init.call(this),this.FMap=null,this.FComparer=null,this.FOnKeyNotify=null,this.FOnValueNotify=null,this.FKeyCollection=null,this.FValueCollection=null},this.$final=function(){this.FMap=void 0,rtl.setIntfP(this,"FComparer",null),this.FOnKeyNotify=void 0,this.FOnValueNotify=void 0,this.FKeyCollection=void 0,this.FValueCollection=void 0,t.TEnumerable$G54.$final.call(this)},this.GetEffectiveKey=function(t){var e=null,i=null,s=null;if(null==this.FComparer)return t;for(s=(i=this.FMap.keys()).next();!s.done;){if(e=rtl.getObject(s.value),0===this.FComparer.Compare(e,t))return e;s=i.next()}return e=t},this.DoAdd=function(t,e){this.FMap.set(this.GetEffectiveKey(t),e),this.KeyNotify(t,0),this.ValueNotify(e,0)},this.GetCount=function(){return this.FMap.size},this.CanClearMap=function(){return null===this.FOnKeyNotify&&null===this.FOnValueNotify},this.PairNotify=function(t,e,i){this.KeyNotify(t,i),this.ValueNotify(e,i)},this.KeyNotify=function(t,e){null!=this.FOnKeyNotify&&this.FOnKeyNotify(this,t,e)},this.ValueNotify=function(t,e){null!=this.FOnValueNotify&&this.FOnValueNotify(this,t,e)},this.Create$1=function(t){return this.FMap=new Map,this},this.Destroy=function(){pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FKeyCollection},set:function(t){this.p.FKeyCollection=t}}),pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FValueCollection},set:function(t){this.p.FValueCollection=t}}),this.Clear(),this.FMap=null,pas.System.TObject.Destroy.call(this)},this.Add=function(e,i){if(this.FMap.has(this.GetEffectiveKey(e)))throw t.EDictionary.$create("Create$1",[rtl.getResStr(t,"SErrDictDuplicateKey")]);this.DoAdd(e,i)},this.Clear=function(){var t=null,e=null,i=[],s=null,o=null;if(this.CanClearMap())this.FMap.clear();else{t=this.FMap.entries();do{(e=t.next()).done||(i=e.value,s=rtl.getObject(i[0]),o=rtl.getObject(i[1]),this.FMap.delete(s),this.PairNotify(s,o,1))}while(!e.done)}},this.TryGetValue=function(t,e){var i,s;return s=this.GetEffectiveKey(t),(i=this.FMap.has(s))&&e.set(rtl.getObject(this.FMap.get(s))),i}}),"TDictionary<System.TClass,Generics.Collections.TObjectList<WebLib.SERTTK.Repository.TSESTransformBase>>"),rtl.createClass(this,"TObjectDictionary$G9",this.TDictionary$G13,(function(){this.$init=function(){t.TDictionary$G13.$init.call(this),this.FOwnerships={}},this.$final=function(){this.FOwnerships=void 0,t.TDictionary$G13.$final.call(this)},this.CanClearMap=function(){return t.TDictionary$G13.CanClearMap.call(this)&&rtl.eqSet(this.FOwnerships,{})},this.KeyNotify=function(e,i){t.TDictionary$G13.KeyNotify.call(this,e,i),0 in this.FOwnerships&&1===i&&(e=rtl.freeLoc(e))},this.ValueNotify=function(e,i){t.TDictionary$G13.ValueNotify.call(this,e,i),1 in this.FOwnerships&&1===i&&(e=rtl.freeLoc(e))},this.Create$5=function(e){return t.TDictionary$G13.Create$1.call(this,0),this.FOwnerships=rtl.refSet(e),this}}),"TObjectDictionary<System.TClass,Generics.Collections.TObjectList<WebLib.SERTTK.Repository.TSESTransformBase>>"),rtl.recNewT(this,"TPair$G16",(function(){this.$eq=function(t){return!0},this.$assign=function(t){return this}})),rtl.createClass(this,"TEnumerable$G57",pas.System.TObject,(function(){}),"TEnumerable<Generics.Collections.TPair<System.TClass,WebLib.SERTTK.Repository.TSERTTKClassTransforms>>"),rtl.createClass(this,"TEnumerable$G58",pas.System.TObject,(function(){}),"TEnumerable<WebLib.SERTTK.Repository.TSERTTKClassTransforms>"),rtl.createClass(this,"TDictionary$G14",this.TEnumerable$G57,(function(){rtl.createClass(this,"TValueCollection",t.TEnumerable$G58,(function(){}),"TDictionary<System.TClass,WebLib.SERTTK.Repository.TSERTTKClassTransforms>.TValueCollection"),rtl.createClass(this,"TKeyCollection",t.TEnumerable$G56,(function(){}),"TDictionary<System.TClass,WebLib.SERTTK.Repository.TSERTTKClassTransforms>.TKeyCollection"),this.$init=function(){t.TEnumerable$G57.$init.call(this),this.FMap=null,this.FComparer=null,this.FOnKeyNotify=null,this.FOnValueNotify=null,this.FKeyCollection=null,this.FValueCollection=null},this.$final=function(){this.FMap=void 0,rtl.setIntfP(this,"FComparer",null),this.FOnKeyNotify=void 0,this.FOnValueNotify=void 0,this.FKeyCollection=void 0,this.FValueCollection=void 0,t.TEnumerable$G57.$final.call(this)},this.GetEffectiveKey=function(t){var e=null,i=null,s=null;if(null==this.FComparer)return t;for(s=(i=this.FMap.keys()).next();!s.done;){if(e=rtl.getObject(s.value),0===this.FComparer.Compare(e,t))return e;s=i.next()}return e=t},this.DoAdd=function(t,e){this.FMap.set(this.GetEffectiveKey(t),e),this.KeyNotify(t,0),this.ValueNotify(e,0)},this.CanClearMap=function(){return null===this.FOnKeyNotify&&null===this.FOnValueNotify},this.PairNotify=function(t,e,i){this.KeyNotify(t,i),this.ValueNotify(e,i)},this.KeyNotify=function(t,e){null!=this.FOnKeyNotify&&this.FOnKeyNotify(this,t,e)},this.ValueNotify=function(t,e){null!=this.FOnValueNotify&&this.FOnValueNotify(this,t,e)},this.Create$1=function(t){return this.FMap=new Map,this},this.Destroy=function(){pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FKeyCollection},set:function(t){this.p.FKeyCollection=t}}),pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FValueCollection},set:function(t){this.p.FValueCollection=t}}),this.Clear(),this.FMap=null,pas.System.TObject.Destroy.call(this)},this.Add=function(e,i){if(this.FMap.has(this.GetEffectiveKey(e)))throw t.EDictionary.$create("Create$1",[rtl.getResStr(t,"SErrDictDuplicateKey")]);this.DoAdd(e,i)},this.Clear=function(){var t=null,e=null,i=[],s=null,o=null;if(this.CanClearMap())this.FMap.clear();else{t=this.FMap.entries();do{(e=t.next()).done||(i=e.value,s=rtl.getObject(i[0]),o=rtl.getObject(i[1]),this.FMap.delete(s),this.PairNotify(s,o,1))}while(!e.done)}},this.TryGetValue=function(t,e){var i,s;return s=this.GetEffectiveKey(t),(i=this.FMap.has(s))&&e.set(rtl.getObject(this.FMap.get(s))),i}}),"TDictionary<System.TClass,WebLib.SERTTK.Repository.TSERTTKClassTransforms>"),rtl.createClass(this,"TObjectDictionary$G10",this.TDictionary$G14,(function(){this.$init=function(){t.TDictionary$G14.$init.call(this),this.FOwnerships={}},this.$final=function(){this.FOwnerships=void 0,t.TDictionary$G14.$final.call(this)},this.CanClearMap=function(){return t.TDictionary$G14.CanClearMap.call(this)&&rtl.eqSet(this.FOwnerships,{})},this.KeyNotify=function(e,i){t.TDictionary$G14.KeyNotify.call(this,e,i),0 in this.FOwnerships&&1===i&&(e=rtl.freeLoc(e))},this.ValueNotify=function(e,i){t.TDictionary$G14.ValueNotify.call(this,e,i),1 in this.FOwnerships&&1===i&&(e=rtl.freeLoc(e))},this.Create$5=function(e){return t.TDictionary$G14.Create$1.call(this,0),this.FOwnerships=rtl.refSet(e),this}}),"TObjectDictionary<System.TClass,WebLib.SERTTK.Repository.TSERTTKClassTransforms>"),rtl.createClass(this,"TEnumerable$G59",pas.System.TObject,(function(){}),"TEnumerable<WebLib.SEFNC.RunLevelTypes.TSEFNCRunLevel>"),rtl.createClass(this,"TCustomList$G28",this.TEnumerable$G59,(function(){this.$init=function(){t.TEnumerable$G59.$init.call(this),this.FOnNotify=null,this.FLength=0,this.FItems=[]},this.$final=function(){this.FOnNotify=void 0,this.FItems=void 0,t.TEnumerable$G59.$final.call(this)},this.GetCapacity=function(){return rtl.length(this.FItems)},this.PrepareAddingItem=function(){var t;return this.FLength===rtl.length(this.FItems)&&this.FItems.push(null),t=this.FLength,this.FLength+=1,t},this.Notify=function(t,e){null!=this.FOnNotify&&this.FOnNotify(this,t,e)}}),"TCustomList<WebLib.SEFNC.RunLevelTypes.TSEFNCRunLevel>"),rtl.createClass(this,"TList$G21",this.TCustomList$G28,(function(){this.SetCapacity=function(t){t<this.FLength&&this.SetCount(t),this.FItems=rtl.arraySetLength(this.FItems,null,t)},this.SetCount=function(t){if(t<0)throw pas.SysUtils.EArgumentOutOfRangeException.$create("Create$1",[rtl.getResStr(pas["Generics.Strings"],"SArgumentOutOfRange")]);t>this.GetCapacity()?this.SetCapacity(t):t<this.FLength&&this.DeleteRange(t,this.FLength-t),this.FLength=t},this.InitializeList=function(){},this.GetItem=function(t){if(t<0||t>=this.FLength)throw pas.SysUtils.EArgumentOutOfRangeException.$create("Create$1",[rtl.getResStr(pas["Generics.Strings"],"SArgumentOutOfRange")]);return this.FItems[t]},this.Create$1=function(){return this.InitializeList(),this},this.Destroy=function(){this.SetCapacity(0)},this.Add=function(t){var e;return e=this.PrepareAddingItem(),this.FItems[e]=t,this.Notify(t,0),e},this.DeleteRange=function(t,e){var i,s=0;if(0!==e){if(e<0||t<0||t+e>this.FLength)throw pas.SysUtils.EArgumentOutOfRangeException.$create("Create$1",[rtl.getResStr(pas["Generics.Strings"],"SArgumentOutOfRange")]);i=this.FItems.splice(t,this.FLength),this.FLength-=e;for(var o=0,n=rtl.length(i)-1;o<=n;o++)s=o,this.Notify(i[s],1)}}}),"TList<WebLib.SEFNC.RunLevelTypes.TSEFNCRunLevel>"),rtl.createClass(this,"TObjectList$G12",this.TList$G21,(function(){this.$init=function(){t.TList$G21.$init.call(this),this.FObjectsOwner=!1},this.Notify=function(e,i){t.TCustomList$G28.Notify.call(this,e,i),this.FObjectsOwner&&1===i&&(e=rtl.freeLoc(e))},this.Create$4=function(e){return t.TList$G21.Create$1.call(this),this.FObjectsOwner=e,this}}),"TObjectList<WebLib.SEFNC.RunLevelTypes.TSEFNCRunLevel>"),rtl.recNewT(this,"TPair$G17",(function(){this.$eq=function(t){return!0},this.$assign=function(t){return this}})),rtl.createClass(this,"TEnumerable$G60",pas.System.TObject,(function(){}),"TEnumerable<Generics.Collections.TPair<System.String,WEBLib.TMSFNCToolBar.TTMSFNCToolBarButton>>"),rtl.createClass(this,"TEnumerable$G61",pas.System.TObject,(function(){}),"TEnumerable<WEBLib.TMSFNCToolBar.TTMSFNCToolBarButton>"),rtl.createClass(this,"TDictionary$G15",this.TEnumerable$G60,(function(){rtl.createClass(this,"TValueCollection",t.TEnumerable$G61,(function(){}),"TDictionary<System.String,WEBLib.TMSFNCToolBar.TTMSFNCToolBarButton>.TValueCollection"),rtl.createClass(this,"TKeyCollection",t.TEnumerable$G22,(function(){}),"TDictionary<System.String,WEBLib.TMSFNCToolBar.TTMSFNCToolBarButton>.TKeyCollection"),this.$init=function(){t.TEnumerable$G60.$init.call(this),this.FMap=null,this.FComparer=null,this.FOnKeyNotify=null,this.FOnValueNotify=null,this.FKeyCollection=null,this.FValueCollection=null},this.$final=function(){this.FMap=void 0,rtl.setIntfP(this,"FComparer",null),this.FOnKeyNotify=void 0,this.FOnValueNotify=void 0,this.FKeyCollection=void 0,this.FValueCollection=void 0,t.TEnumerable$G60.$final.call(this)},this.GetEffectiveKey=function(t){var e="",i=null,s=null;if(null==this.FComparer)return t;for(s=(i=this.FMap.keys()).next();!s.done;){if(e=""+s.value,0===this.FComparer.Compare(e,t))return e;s=i.next()}return e=t},this.DoAdd=function(t,e){this.FMap.set(this.GetEffectiveKey(t),e),this.KeyNotify(t,0),this.ValueNotify(e,0)},this.CanClearMap=function(){return null===this.FOnKeyNotify&&null===this.FOnValueNotify},this.PairNotify=function(t,e,i){this.KeyNotify(t,i),this.ValueNotify(e,i)},this.KeyNotify=function(t,e){null!=this.FOnKeyNotify&&this.FOnKeyNotify(this,t,e)},this.ValueNotify=function(t,e){null!=this.FOnValueNotify&&this.FOnValueNotify(this,t,e)},this.Create$1=function(t){return this.FMap=new Map,this},this.Destroy=function(){pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FKeyCollection},set:function(t){this.p.FKeyCollection=t}}),pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FValueCollection},set:function(t){this.p.FValueCollection=t}}),this.Clear(),this.FMap=null,pas.System.TObject.Destroy.call(this)},this.Add=function(e,i){if(this.FMap.has(this.GetEffectiveKey(e)))throw t.EDictionary.$create("Create$1",[rtl.getResStr(t,"SErrDictDuplicateKey")]);this.DoAdd(e,i)},this.Clear=function(){var t=null,e=null,i=[],s="",o=null;if(this.CanClearMap())this.FMap.clear();else{t=this.FMap.entries();do{(e=t.next()).done||(s=""+(i=e.value)[0],o=rtl.getObject(i[1]),this.FMap.delete(s),this.PairNotify(s,o,1))}while(!e.done)}},this.TryGetValue=function(t,e){var i,s;return s=this.GetEffectiveKey(t),(i=this.FMap.has(s))&&e.set(rtl.getObject(this.FMap.get(s))),i}}),"TDictionary<System.String,WEBLib.TMSFNCToolBar.TTMSFNCToolBarButton>"),rtl.recNewT(this,"TPair$G18",(function(){this.$eq=function(t){return!0},this.$assign=function(t){return this}})),rtl.createClass(this,"TEnumerable$G62",pas.System.TObject,(function(){}),"TEnumerable<Generics.Collections.TPair<WEBLib.TMSFNCPageControl.TTMSFNCPageControlPage,WebLib.SERTTK.MarshalTypes.TSECVToolInstance>>"),rtl.createClass(this,"TEnumerator$G65",pas.System.TObject,(function(){}),"TEnumerator<WebLib.SERTTK.MarshalTypes.TSECVToolInstance>"),rtl.createClass(this,"TEnumerable$G63",pas.System.TObject,(function(){}),"TEnumerable<WebLib.SERTTK.MarshalTypes.TSECVToolInstance>"),rtl.createClass(this,"TEnumerable$G64",pas.System.TObject,(function(){}),"TEnumerable<WEBLib.TMSFNCPageControl.TTMSFNCPageControlPage>"),rtl.createClass(this,"TDictionary$G16",this.TEnumerable$G62,(function(){rtl.createClass(this,"TValueEnumerator",t.TEnumerator$G65,(function(){this.$init=function(){t.TEnumerator$G65.$init.call(this),this.FIter=null,this.FVal=null},this.$final=function(){this.FIter=void 0,this.FVal=void 0,t.TEnumerator$G65.$final.call(this)},this.GetCurrent=function(){return this.DoGetCurrent()},this.DoGetCurrent=function(){return rtl.getObject(this.FVal.value)},this.DoMoveNext=function(){return this.FVal=this.FIter.next(),!this.FVal.done},this.Create$1=function(t){return this.FIter=t,this},this.MoveNext$1=function(){return this.DoMoveNext()}}),"TDictionary<WEBLib.TMSFNCPageControl.TTMSFNCPageControlPage,WebLib.SERTTK.MarshalTypes.TSECVToolInstance>.TValueEnumerator"),rtl.createClass(this,"TValueCollection",t.TEnumerable$G63,(function(){this.$init=function(){t.TEnumerable$G63.$init.call(this),this.FMap=null},this.$final=function(){this.FMap=void 0,t.TEnumerable$G63.$final.call(this)},this.DoGetEnumerator=function(){return t.TDictionary$G16.TValueEnumerator.$create("Create$1",[this.FMap.values()])},this.Create$1=function(t){return this.FMap=t.FMap,this},this.GetEnumerator$1=function(){return this.DoGetEnumerator()}}),"TDictionary<WEBLib.TMSFNCPageControl.TTMSFNCPageControlPage,WebLib.SERTTK.MarshalTypes.TSECVToolInstance>.TValueCollection"),rtl.createClass(this,"TKeyCollection",t.TEnumerable$G64,(function(){}),"TDictionary<WEBLib.TMSFNCPageControl.TTMSFNCPageControlPage,WebLib.SERTTK.MarshalTypes.TSECVToolInstance>.TKeyCollection"),this.$init=function(){t.TEnumerable$G62.$init.call(this),this.FMap=null,this.FComparer=null,this.FOnKeyNotify=null,this.FOnValueNotify=null,this.FKeyCollection=null,this.FValueCollection=null},this.$final=function(){this.FMap=void 0,rtl.setIntfP(this,"FComparer",null),this.FOnKeyNotify=void 0,this.FOnValueNotify=void 0,this.FKeyCollection=void 0,this.FValueCollection=void 0,t.TEnumerable$G62.$final.call(this)},this.GetEffectiveKey=function(t){var e=null,i=null,s=null;if(null==this.FComparer)return t;for(s=(i=this.FMap.keys()).next();!s.done;){if(e=rtl.getObject(s.value),0===this.FComparer.Compare(e,t))return e;s=i.next()}return e=t},this.DoAdd=function(t,e){this.FMap.set(this.GetEffectiveKey(t),e),this.KeyNotify(t,0),this.ValueNotify(e,0)},this.CanClearMap=function(){return null===this.FOnKeyNotify&&null===this.FOnValueNotify},this.PairNotify=function(t,e,i){this.KeyNotify(t,i),this.ValueNotify(e,i)},this.KeyNotify=function(t,e){null!=this.FOnKeyNotify&&this.FOnKeyNotify(this,t,e)},this.ValueNotify=function(t,e){null!=this.FOnValueNotify&&this.FOnValueNotify(this,t,e)},this.Create$1=function(t){return this.FMap=new Map,this},this.Destroy=function(){pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FKeyCollection},set:function(t){this.p.FKeyCollection=t}}),pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FValueCollection},set:function(t){this.p.FValueCollection=t}}),this.Clear(),this.FMap=null,pas.System.TObject.Destroy.call(this)},this.Add=function(e,i){if(this.FMap.has(this.GetEffectiveKey(e)))throw t.EDictionary.$create("Create$1",[rtl.getResStr(t,"SErrDictDuplicateKey")]);this.DoAdd(e,i)},this.Clear=function(){var t=null,e=null,i=[],s=null,o=null;if(this.CanClearMap())this.FMap.clear();else{t=this.FMap.entries();do{(e=t.next()).done||(i=e.value,s=rtl.getObject(i[0]),o=rtl.getObject(i[1]),this.FMap.delete(s),this.PairNotify(s,o,1))}while(!e.done)}},this.GetValues=function(){return null===this.FValueCollection&&(this.FValueCollection=this.TValueCollection.$create("Create$1",[this])),this.FValueCollection}}),"TDictionary<WEBLib.TMSFNCPageControl.TTMSFNCPageControlPage,WebLib.SERTTK.MarshalTypes.TSECVToolInstance>"),rtl.createClass(this,"TObjectDictionary$G11",this.TDictionary$G16,(function(){this.$init=function(){t.TDictionary$G16.$init.call(this),this.FOwnerships={}},this.$final=function(){this.FOwnerships=void 0,t.TDictionary$G16.$final.call(this)},this.CanClearMap=function(){return t.TDictionary$G16.CanClearMap.call(this)&&rtl.eqSet(this.FOwnerships,{})},this.KeyNotify=function(e,i){t.TDictionary$G16.KeyNotify.call(this,e,i),0 in this.FOwnerships&&1===i&&(e=rtl.freeLoc(e))},this.ValueNotify=function(e,i){t.TDictionary$G16.ValueNotify.call(this,e,i),1 in this.FOwnerships&&1===i&&(e=rtl.freeLoc(e))},this.Create$5=function(e){return t.TDictionary$G16.Create$1.call(this,0),this.FOwnerships=rtl.refSet(e),this}}),"TObjectDictionary<WEBLib.TMSFNCPageControl.TTMSFNCPageControlPage,WebLib.SERTTK.MarshalTypes.TSECVToolInstance>"),rtl.createClass(this,"TEnumerable$G65",pas.System.TObject,(function(){}),"TEnumerable<WebLib.SERTTK.MarshalTypes.TSERTTKInspectorCVInfo>"),rtl.createClass(this,"TCustomList$G29",this.TEnumerable$G65,(function(){this.$init=function(){t.TEnumerable$G65.$init.call(this),this.FOnNotify=null,this.FLength=0,this.FItems=[]},this.$final=function(){this.FOnNotify=void 0,this.FItems=void 0,t.TEnumerable$G65.$final.call(this)},this.GetCapacity=function(){return rtl.length(this.FItems)},this.PrepareAddingItem=function(){var t;return this.FLength===rtl.length(this.FItems)&&this.FItems.push(null),t=this.FLength,this.FLength+=1,t},this.Notify=function(t,e){null!=this.FOnNotify&&this.FOnNotify(this,t,e)}}),"TCustomList<WebLib.SERTTK.MarshalTypes.TSERTTKInspectorCVInfo>"),rtl.createClass(this,"TList$G22",this.TCustomList$G29,(function(){this.SetCapacity=function(t){t<this.FLength&&this.SetCount(t),this.FItems=rtl.arraySetLength(this.FItems,null,t)},this.SetCount=function(t){if(t<0)throw pas.SysUtils.EArgumentOutOfRangeException.$create("Create$1",[rtl.getResStr(pas["Generics.Strings"],"SArgumentOutOfRange")]);t>this.GetCapacity()?this.SetCapacity(t):t<this.FLength&&this.DeleteRange(t,this.FLength-t),this.FLength=t},this.InitializeList=function(){},this.Create$1=function(){return this.InitializeList(),this},this.Destroy=function(){this.SetCapacity(0)},this.Add=function(t){var e;return e=this.PrepareAddingItem(),this.FItems[e]=t,this.Notify(t,0),e},this.DeleteRange=function(t,e){var i,s=0;if(0!==e){if(e<0||t<0||t+e>this.FLength)throw pas.SysUtils.EArgumentOutOfRangeException.$create("Create$1",[rtl.getResStr(pas["Generics.Strings"],"SArgumentOutOfRange")]);i=this.FItems.splice(t,this.FLength),this.FLength-=e;for(var o=0,n=rtl.length(i)-1;o<=n;o++)s=o,this.Notify(i[s],1)}}}),"TList<WebLib.SERTTK.MarshalTypes.TSERTTKInspectorCVInfo>"),rtl.createClass(this,"TObjectList$G13",this.TList$G22,(function(){this.$init=function(){t.TList$G22.$init.call(this),this.FObjectsOwner=!1},this.Notify=function(e,i){t.TCustomList$G29.Notify.call(this,e,i),this.FObjectsOwner&&1===i&&(e=rtl.freeLoc(e))},this.Create$4=function(e){return t.TList$G22.Create$1.call(this),this.FObjectsOwner=e,this}}),"TObjectList<WebLib.SERTTK.MarshalTypes.TSERTTKInspectorCVInfo>"),rtl.createClass(this,"TStack$G2",this.TCustomList$G12,(function(){this.DoRemove=function(t,e){var i;if(0===this.FLength||t!==this.FLength-1)throw pas.SysUtils.EArgumentOutOfRangeException.$create("Create$1",[rtl.getResStr(pas["Generics.Strings"],"SArgumentOutOfRange")]);return i=this.FItems[t],this.FItems[t]=-2147483648,this.FLength-=1,this.Notify(i,e),i},this.SetCapacity=function(t){if(t<this.GetCount())throw pas.SysUtils.EArgumentOutOfRangeException.$create("Create$1",[rtl.getResStr(pas["Generics.Strings"],"SArgumentOutOfRange")]);this.FItems=rtl.arraySetLength(this.FItems,0,t)},this.Destroy=function(){this.Clear(),pas.System.TObject.Destroy.call(this)},this.Clear=function(){for(;this.GetCount()>0;)this.Pop()},this.Push=function(t){this.GetCapacity()<=this.FLength&&this.SetCapacity(this.FLength+10),this.FItems[this.FLength]=t,this.FLength+=1,this.Notify(t,0)},this.Pop=function(){return this.DoRemove(this.FLength-1,1)}}),"TStack<System.Longint>"),rtl.recNewT(this,"TPair$G19",(function(){this.$eq=function(t){return!0},this.$assign=function(t){return this}})),rtl.createClass(this,"TEnumerable$G66",pas.System.TObject,(function(){}),"TEnumerable<Generics.Collections.TPair<System.String,WEBLib.Menus.TMenuItem>>"),rtl.createClass(this,"TEnumerable$G67",pas.System.TObject,(function(){}),"TEnumerable<WEBLib.Menus.TMenuItem>"),rtl.createClass(this,"TDictionary$G17",this.TEnumerable$G66,(function(){rtl.createClass(this,"TValueCollection",t.TEnumerable$G67,(function(){}),"TDictionary<System.String,WEBLib.Menus.TMenuItem>.TValueCollection"),rtl.createClass(this,"TKeyCollection",t.TEnumerable$G22,(function(){}),"TDictionary<System.String,WEBLib.Menus.TMenuItem>.TKeyCollection"),this.$init=function(){t.TEnumerable$G66.$init.call(this),this.FMap=null,this.FComparer=null,this.FOnKeyNotify=null,this.FOnValueNotify=null,this.FKeyCollection=null,this.FValueCollection=null},this.$final=function(){this.FMap=void 0,rtl.setIntfP(this,"FComparer",null),this.FOnKeyNotify=void 0,this.FOnValueNotify=void 0,this.FKeyCollection=void 0,this.FValueCollection=void 0,t.TEnumerable$G66.$final.call(this)},this.GetEffectiveKey=function(t){var e="",i=null,s=null;if(null==this.FComparer)return t;for(s=(i=this.FMap.keys()).next();!s.done;){if(e=""+s.value,0===this.FComparer.Compare(e,t))return e;s=i.next()}return e=t},this.DoAdd=function(t,e){this.FMap.set(this.GetEffectiveKey(t),e),this.KeyNotify(t,0),this.ValueNotify(e,0)},this.CanClearMap=function(){return null===this.FOnKeyNotify&&null===this.FOnValueNotify},this.PairNotify=function(t,e,i){this.KeyNotify(t,i),this.ValueNotify(e,i)},this.KeyNotify=function(t,e){null!=this.FOnKeyNotify&&this.FOnKeyNotify(this,t,e)},this.ValueNotify=function(t,e){null!=this.FOnValueNotify&&this.FOnValueNotify(this,t,e)},this.Create$1=function(t){return this.FMap=new Map,this},this.Destroy=function(){pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FKeyCollection},set:function(t){this.p.FKeyCollection=t}}),pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FValueCollection},set:function(t){this.p.FValueCollection=t}}),this.Clear(),this.FMap=null,pas.System.TObject.Destroy.call(this)},this.Add=function(e,i){if(this.FMap.has(this.GetEffectiveKey(e)))throw t.EDictionary.$create("Create$1",[rtl.getResStr(t,"SErrDictDuplicateKey")]);this.DoAdd(e,i)},this.Clear=function(){var t=null,e=null,i=[],s="",o=null;if(this.CanClearMap())this.FMap.clear();else{t=this.FMap.entries();do{(e=t.next()).done||(s=""+(i=e.value)[0],o=rtl.getObject(i[1]),this.FMap.delete(s),this.PairNotify(s,o,1))}while(!e.done)}},this.TryGetValue=function(t,e){var i,s;return s=this.GetEffectiveKey(t),(i=this.FMap.has(s))&&e.set(rtl.getObject(this.FMap.get(s))),i}}),"TDictionary<System.String,WEBLib.Menus.TMenuItem>"),rtl.createClass(this,"TEnumerator$G69",pas.System.TObject,(function(){this.MoveNext=function(){return this.DoMoveNext()}}),"TEnumerator<WebLib.SERTTK.MarshalTypes.TSERTTKRepoItemBinder>"),rtl.createClass(this,"TEnumerable$G68",pas.System.TObject,(function(){}),"TEnumerable<WebLib.SERTTK.MarshalTypes.TSERTTKRepoItemBinder>"),rtl.createClass(this,"TCustomList$G30",this.TEnumerable$G68,(function(){this.$init=function(){t.TEnumerable$G68.$init.call(this),this.FOnNotify=null,this.FLength=0,this.FItems=[]},this.$final=function(){this.FOnNotify=void 0,this.FItems=void 0,t.TEnumerable$G68.$final.call(this)},this.GetCapacity=function(){return rtl.length(this.FItems)},this.PrepareAddingItem=function(){var t;return this.FLength===rtl.length(this.FItems)&&this.FItems.push(null),t=this.FLength,this.FLength+=1,t},this.Notify=function(t,e){null!=this.FOnNotify&&this.FOnNotify(this,t,e)}}),"TCustomList<WebLib.SERTTK.MarshalTypes.TSERTTKRepoItemBinder>"),rtl.createClass(this,"TCustomListEnumerator$G28",this.TEnumerator$G69,(function(){this.$init=function(){t.TEnumerator$G69.$init.call(this),this.FList=null,this.FIndex=0},this.$final=function(){this.FList=void 0,t.TEnumerator$G69.$final.call(this)},this.DoMoveNext=function(){return this.FIndex+=1,this.FList.FLength>0&&this.FIndex<this.FList.FLength},this.DoGetCurrent=function(){return this.GetCurrent()},this.GetCurrent=function(){return this.FList.FItems[this.FIndex]},this.Create$1=function(t){return pas.System.TObject.Create.call(this),this.FIndex=-1,this.FList=t,this}}),"TCustomListEnumerator<WebLib.SERTTK.MarshalTypes.TSERTTKRepoItemBinder>"),rtl.createClass(this,"TList$G23",this.TCustomList$G30,(function(){rtl.createClass(this,"TEnumerator",t.TCustomListEnumerator$G28,(function(){}),"TList<WebLib.SERTTK.MarshalTypes.TSERTTKRepoItemBinder>.TEnumerator"),this.SetCapacity=function(t){t<this.FLength&&this.SetCount(t),this.FItems=rtl.arraySetLength(this.FItems,null,t)},this.SetCount=function(t){if(t<0)throw pas.SysUtils.EArgumentOutOfRangeException.$create("Create$1",[rtl.getResStr(pas["Generics.Strings"],"SArgumentOutOfRange")]);t>this.GetCapacity()?this.SetCapacity(t):t<this.FLength&&this.DeleteRange(t,this.FLength-t),this.FLength=t},this.InitializeList=function(){},this.GetEnumerator$1=function(){return this.TEnumerator.$create("Create$1",[this])},this.Create$1=function(){return this.InitializeList(),this},this.Destroy=function(){this.SetCapacity(0)},this.Add=function(t){var e;return e=this.PrepareAddingItem(),this.FItems[e]=t,this.Notify(t,0),e},this.DeleteRange=function(t,e){var i,s=0;if(0!==e){if(e<0||t<0||t+e>this.FLength)throw pas.SysUtils.EArgumentOutOfRangeException.$create("Create$1",[rtl.getResStr(pas["Generics.Strings"],"SArgumentOutOfRange")]);i=this.FItems.splice(t,this.FLength),this.FLength-=e;for(var o=0,n=rtl.length(i)-1;o<=n;o++)s=o,this.Notify(i[s],1)}}}),"TList<WebLib.SERTTK.MarshalTypes.TSERTTKRepoItemBinder>"),rtl.recNewT(this,"TPair$G20",(function(){this.$eq=function(t){return!0},this.$assign=function(t){return this}})),rtl.createClass(this,"TEnumerable$G69",pas.System.TObject,(function(){}),"TEnumerable<Generics.Collections.TPair<WebLib.SERTTK.Repository.TSERTTKRepoItem,WebLib.SERTTK.MarshalTypes.TSERTTKRepoItemBinder>>"),rtl.createClass(this,"TDictionary$G18",this.TEnumerable$G69,(function(){rtl.createClass(this,"TKeyEnumerator",t.TEnumerator$G45,(function(){this.$init=function(){t.TEnumerator$G45.$init.call(this),this.FIter=null,this.FVal=null},this.$final=function(){this.FIter=void 0,this.FVal=void 0,t.TEnumerator$G45.$final.call(this)},this.GetCurrent=function(){return this.DoGetCurrent()},this.DoGetCurrent=function(){return rtl.getObject(this.FVal.value)},this.DoMoveNext=function(){return this.FVal=this.FIter.next(),!this.FVal.done},this.Create$1=function(t){return this.FIter=t,this},this.MoveNext$1=function(){return this.DoMoveNext()}}),"TDictionary<WebLib.SERTTK.Repository.TSERTTKRepoItem,WebLib.SERTTK.MarshalTypes.TSERTTKRepoItemBinder>.TKeyEnumerator"),rtl.createClass(this,"TValueCollection",t.TEnumerable$G68,(function(){}),"TDictionary<WebLib.SERTTK.Repository.TSERTTKRepoItem,WebLib.SERTTK.MarshalTypes.TSERTTKRepoItemBinder>.TValueCollection"),rtl.createClass(this,"TKeyCollection",t.TEnumerable$G44,(function(){this.$init=function(){t.TEnumerable$G44.$init.call(this),this.FMap=null},this.$final=function(){this.FMap=void 0,t.TEnumerable$G44.$final.call(this)},this.Create$1=function(t){return this.FMap=t.FMap,this},this.GetEnumerator$1=function(){return t.TDictionary$G18.TKeyEnumerator.$create("Create$1",[this.FMap.keys()])}}),"TDictionary<WebLib.SERTTK.Repository.TSERTTKRepoItem,WebLib.SERTTK.MarshalTypes.TSERTTKRepoItemBinder>.TKeyCollection"),this.$init=function(){t.TEnumerable$G69.$init.call(this),this.FMap=null,this.FComparer=null,this.FOnKeyNotify=null,this.FOnValueNotify=null,this.FKeyCollection=null,this.FValueCollection=null},this.$final=function(){this.FMap=void 0,rtl.setIntfP(this,"FComparer",null),this.FOnKeyNotify=void 0,this.FOnValueNotify=void 0,this.FKeyCollection=void 0,this.FValueCollection=void 0,t.TEnumerable$G69.$final.call(this)},this.GetEffectiveKey=function(t){var e=null,i=null,s=null;if(null==this.FComparer)return t;for(s=(i=this.FMap.keys()).next();!s.done;){if(e=rtl.getObject(s.value),0===this.FComparer.Compare(e,t))return e;s=i.next()}return e=t},this.DoAdd=function(t,e){this.FMap.set(this.GetEffectiveKey(t),e),this.KeyNotify(t,0),this.ValueNotify(e,0)},this.DoRemove=function(t,e){var i,s,o=null;return s=this.GetEffectiveKey(t),i=this.FMap.get(s),pas.JS.isUndefined(i)||(this.FMap.delete(s),o=rtl.getObject(i),this.KeyNotify(t,e),this.ValueNotify(o,e)),o},this.CanClearMap=function(){return null===this.FOnKeyNotify&&null===this.FOnValueNotify},this.PairNotify=function(t,e,i){this.KeyNotify(t,i),this.ValueNotify(e,i)},this.KeyNotify=function(t,e){null!=this.FOnKeyNotify&&this.FOnKeyNotify(this,t,e)},this.ValueNotify=function(t,e){null!=this.FOnValueNotify&&this.FOnValueNotify(this,t,e)},this.Create$1=function(t){return this.FMap=new Map,this},this.Destroy=function(){pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FKeyCollection},set:function(t){this.p.FKeyCollection=t}}),pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FValueCollection},set:function(t){this.p.FValueCollection=t}}),this.Clear(),this.FMap=null,pas.System.TObject.Destroy.call(this)},this.Add=function(e,i){if(this.FMap.has(this.GetEffectiveKey(e)))throw t.EDictionary.$create("Create$1",[rtl.getResStr(t,"SErrDictDuplicateKey")]);this.DoAdd(e,i)},this.Remove=function(t){this.DoRemove(t,1)},this.Clear=function(){var t=null,e=null,i=[],s=null,o=null;if(this.CanClearMap())this.FMap.clear();else{t=this.FMap.entries();do{(e=t.next()).done||(i=e.value,s=rtl.getObject(i[0]),o=rtl.getObject(i[1]),this.FMap.delete(s),this.PairNotify(s,o,1))}while(!e.done)}},this.TryGetValue=function(t,e){var i,s;return s=this.GetEffectiveKey(t),(i=this.FMap.has(s))&&e.set(rtl.getObject(this.FMap.get(s))),i},this.GetKeys=function(){return null===this.FKeyCollection&&(this.FKeyCollection=this.TKeyCollection.$create("Create$1",[this])),this.FKeyCollection}}),"TDictionary<WebLib.SERTTK.Repository.TSERTTKRepoItem,WebLib.SERTTK.MarshalTypes.TSERTTKRepoItemBinder>"),rtl.createClass(this,"TObjectDictionary$G12",this.TDictionary$G18,(function(){this.$init=function(){t.TDictionary$G18.$init.call(this),this.FOwnerships={}},this.$final=function(){this.FOwnerships=void 0,t.TDictionary$G18.$final.call(this)},this.CanClearMap=function(){return t.TDictionary$G18.CanClearMap.call(this)&&rtl.eqSet(this.FOwnerships,{})},this.KeyNotify=function(e,i){t.TDictionary$G18.KeyNotify.call(this,e,i),0 in this.FOwnerships&&1===i&&(e=rtl.freeLoc(e))},this.ValueNotify=function(e,i){t.TDictionary$G18.ValueNotify.call(this,e,i),1 in this.FOwnerships&&1===i&&(e=rtl.freeLoc(e))},this.Create$5=function(e){return t.TDictionary$G18.Create$1.call(this,0),this.FOwnerships=rtl.refSet(e),this}}),"TObjectDictionary<WebLib.SERTTK.Repository.TSERTTKRepoItem,WebLib.SERTTK.MarshalTypes.TSERTTKRepoItemBinder>"),rtl.recNewT(this,"TPair$G21",(function(){this.$eq=function(t){return!0},this.$assign=function(t){return this}})),rtl.createClass(this,"TEnumerable$G70",pas.System.TObject,(function(){}),"TEnumerable<Generics.Collections.TPair<System.TObject,WebLib.SERTTK.MarshalTypes.TSERTTKRepoItemBinder>>"),rtl.createClass(this,"TDictionary$G19",this.TEnumerable$G70,(function(){rtl.createClass(this,"TValueCollection",t.TEnumerable$G68,(function(){}),"TDictionary<System.TObject,WebLib.SERTTK.MarshalTypes.TSERTTKRepoItemBinder>.TValueCollection"),rtl.createClass(this,"TKeyCollection",t.TEnumerable$G21,(function(){}),"TDictionary<System.TObject,WebLib.SERTTK.MarshalTypes.TSERTTKRepoItemBinder>.TKeyCollection"),this.$init=function(){t.TEnumerable$G70.$init.call(this),this.FMap=null,this.FComparer=null,this.FOnKeyNotify=null,this.FOnValueNotify=null,this.FKeyCollection=null,this.FValueCollection=null},this.$final=function(){this.FMap=void 0,rtl.setIntfP(this,"FComparer",null),this.FOnKeyNotify=void 0,this.FOnValueNotify=void 0,this.FKeyCollection=void 0,this.FValueCollection=void 0,t.TEnumerable$G70.$final.call(this)},this.GetEffectiveKey=function(t){var e=null,i=null,s=null;if(null==this.FComparer)return t;for(s=(i=this.FMap.keys()).next();!s.done;){if(e=rtl.getObject(s.value),0===this.FComparer.Compare(e,t))return e;s=i.next()}return e=t},this.DoAdd=function(t,e){this.FMap.set(this.GetEffectiveKey(t),e),this.KeyNotify(t,0),this.ValueNotify(e,0)},this.CanClearMap=function(){return null===this.FOnKeyNotify&&null===this.FOnValueNotify},this.PairNotify=function(t,e,i){this.KeyNotify(t,i),this.ValueNotify(e,i)},this.KeyNotify=function(t,e){null!=this.FOnKeyNotify&&this.FOnKeyNotify(this,t,e)},this.ValueNotify=function(t,e){null!=this.FOnValueNotify&&this.FOnValueNotify(this,t,e)},this.Create$1=function(t){return this.FMap=new Map,this},this.Destroy=function(){pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FKeyCollection},set:function(t){this.p.FKeyCollection=t}}),pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FValueCollection},set:function(t){this.p.FValueCollection=t}}),this.Clear(),this.FMap=null,pas.System.TObject.Destroy.call(this)},this.Add=function(e,i){if(this.FMap.has(this.GetEffectiveKey(e)))throw t.EDictionary.$create("Create$1",[rtl.getResStr(t,"SErrDictDuplicateKey")]);this.DoAdd(e,i)},this.Clear=function(){var t=null,e=null,i=[],s=null,o=null;if(this.CanClearMap())this.FMap.clear();else{t=this.FMap.entries();do{(e=t.next()).done||(i=e.value,s=rtl.getObject(i[0]),o=rtl.getObject(i[1]),this.FMap.delete(s),this.PairNotify(s,o,1))}while(!e.done)}},this.TryGetValue=function(t,e){var i,s;return s=this.GetEffectiveKey(t),(i=this.FMap.has(s))&&e.set(rtl.getObject(this.FMap.get(s))),i}}),"TDictionary<System.TObject,WebLib.SERTTK.MarshalTypes.TSERTTKRepoItemBinder>"),rtl.recNewT(this,"TPair$G22",(function(){this.$eq=function(t){return!0},this.$assign=function(t){return this}})),rtl.createClass(this,"TEnumerable$G71",pas.System.TObject,(function(){}),"TEnumerable<Generics.Collections.TPair<System.TObject,WEBLib.TMSFNCTreeViewData.TTMSFNCTreeViewNode>>"),rtl.createClass(this,"TEnumerable$G72",pas.System.TObject,(function(){}),"TEnumerable<WEBLib.TMSFNCTreeViewData.TTMSFNCTreeViewNode>"),rtl.createClass(this,"TDictionary$G20",this.TEnumerable$G71,(function(){rtl.createClass(this,"TValueCollection",t.TEnumerable$G72,(function(){}),"TDictionary<System.TObject,WEBLib.TMSFNCTreeViewData.TTMSFNCTreeViewNode>.TValueCollection"),rtl.createClass(this,"TKeyCollection",t.TEnumerable$G21,(function(){}),"TDictionary<System.TObject,WEBLib.TMSFNCTreeViewData.TTMSFNCTreeViewNode>.TKeyCollection"),this.$init=function(){t.TEnumerable$G71.$init.call(this),this.FMap=null,this.FComparer=null,this.FOnKeyNotify=null,this.FOnValueNotify=null,this.FKeyCollection=null,this.FValueCollection=null},this.$final=function(){this.FMap=void 0,rtl.setIntfP(this,"FComparer",null),this.FOnKeyNotify=void 0,this.FOnValueNotify=void 0,this.FKeyCollection=void 0,this.FValueCollection=void 0,t.TEnumerable$G71.$final.call(this)},this.GetEffectiveKey=function(t){var e=null,i=null,s=null;if(null==this.FComparer)return t;for(s=(i=this.FMap.keys()).next();!s.done;){if(e=rtl.getObject(s.value),0===this.FComparer.Compare(e,t))return e;s=i.next()}return e=t},this.CanClearMap=function(){return null===this.FOnKeyNotify&&null===this.FOnValueNotify},this.PairNotify=function(t,e,i){this.KeyNotify(t,i),this.ValueNotify(e,i)},this.KeyNotify=function(t,e){null!=this.FOnKeyNotify&&this.FOnKeyNotify(this,t,e)},this.ValueNotify=function(t,e){null!=this.FOnValueNotify&&this.FOnValueNotify(this,t,e)},this.Create$1=function(t){return this.FMap=new Map,this},this.Destroy=function(){pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FKeyCollection},set:function(t){this.p.FKeyCollection=t}}),pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FValueCollection},set:function(t){this.p.FValueCollection=t}}),this.Clear(),this.FMap=null,pas.System.TObject.Destroy.call(this)},this.Clear=function(){var t=null,e=null,i=[],s=null,o=null;if(this.CanClearMap())this.FMap.clear();else{t=this.FMap.entries();do{(e=t.next()).done||(i=e.value,s=rtl.getObject(i[0]),o=rtl.getObject(i[1]),this.FMap.delete(s),this.PairNotify(s,o,1))}while(!e.done)}},this.TryGetValue=function(t,e){var i,s;return s=this.GetEffectiveKey(t),(i=this.FMap.has(s))&&e.set(rtl.getObject(this.FMap.get(s))),i}}),"TDictionary<System.TObject,WEBLib.TMSFNCTreeViewData.TTMSFNCTreeViewNode>"),t.$implcode=function(){t.$resourcestrings={SErrDictKeyNotFound:{org:"Key value not found"},SErrDictDuplicateKey:{org:"Duplicate key value"}}}}),[]),rtl.module("WEBLib.TMSFNCUtils",["System","Classes","SysUtils","Types","WEBLib.Graphics","WEBLib.TMSFNCTypes","WEBLib.Controls","WEBLib.Forms","JS","WEBLib.Dialogs","WEBLib.JSON","Web"],(function(){"use strict";var t=this,e=t.$impl;rtl.createClass(this,"TTMSFNCUtils",pas.System.TObject,(function(){this.OpenURL=function(t){window.open(t,"_blank")},this.SetFontSize=function(t,e,i){t.SetSize(Math.round(e/96*72))},this.ScaleForCurrentDPI=function(t){},this.IsHTML=function(t){return pas.System.Pos("</",t)>0||pas.System.Pos("/>",t)>0||pas.System.Pos("<BR>",pas.SysUtils.UpperCase(t))>0},this.GetTempPath=function(){return"",""},this.GetMousePos=function(){var t=pas["WEBLib.TMSFNCTypes"].TPointF.$new(),e=pas.Types.TPoint.$new();return t.$assign(pas["WEBLib.TMSFNCTypes"].PointF(-1,-1)),e.$assign(pas["WEBLib.Controls"].GetMousePos()),t.$assign(pas["WEBLib.TMSFNCTypes"].PointF(e.x,e.y)),t},this.IsHighDPIScale=function(t,e){return this.GetDPIScale(t,e)>1},this.GetDPIScale=function(t,e){return 1,1},this.Clone=function(t){throw null,pas.SysUtils.Exception.$create("Create$1",["Implement Clone"])},this.HTMLStrip=function(t){var e="",i=0;for(e="";pas.System.Pos("<BR>",pas.SysUtils.UpperCase(t))>0;)t=pas.SysUtils.StringReplace(t,"<BR>",String.fromCharCode(13)+String.fromCharCode(10),rtl.createSet(1));for(;pas.System.Pos("<HR>",pas.SysUtils.UpperCase(t))>0;)t=pas.SysUtils.StringReplace(t,"<HR>",String.fromCharCode(13)+String.fromCharCode(10),rtl.createSet(1));for(i=0;this.VarPos("<",t,{get:function(){return i},set:function(t){rtl.rc(t,-2147483648,2147483647),i=t}})>0&&(e+=pas.System.Copy(t,1,i-1),this.VarPos(">",t,{get:function(){return i},set:function(t){rtl.rc(t,-2147483648,2147483647),i=t}})>0);)pas.System.Delete({get:function(){return t},set:function(e){t=e}},1,i);return e+=t},this.VarPos=function(t,e,i){rtl.rc(i.get(),-2147483648,2147483647);return i.set(pas.System.Pos(t,e)),rtl.rc(i.get(),-2147483648,2147483647)},this.CharInStr=function(t,e){var i="";return i="\0",e>0&&e<=t.length&&(i=t.charAt(e-1)),i},this.HexStrToBytes=function(t){var e=0,i=0,s=[];for([],s=rtl.arraySetLength(s,0,rtl.trunc(t.length/2)),e=1,i=0;e<=t.length;)s[i]=pas.SysUtils.StrToInt("$"+t.charAt(e-1)+t.charAt(e+1-1)),e+=2,i+=1;return rtl.arrayRef(s)},this.SaveBitmapToHexStr=function(t){var e="",i=null,s="",o=null,n=null;i=pas.Classes.TMemoryStream.$create("Create");try{if(s="",!t.Empty()){o=t.Image();var r=document.createElement("canvas");r.width=o.width,r.height=o.height,r.getContext("2d").drawImage(o,0,0),s=r.toDataURL("image/png"),n=pas.Classes.TStringStream.$create("Create$2",[s]);try{s=this.SaveStreamToHexStr(n)}finally{n=rtl.freeLoc(n)}}e=s}finally{i=rtl.freeLoc(i)}return e},this.SaveStreamToHexStr=function(t){var e="",i=[];e="",t.SetPosition(0);for(var s=1,o=t.GetSize();s<=o;s++)s,i=rtl.arraySetLength(i,0,1),t.Read({get:function(){return i},set:function(t){i=t}},1),e+=pas.SysUtils.IntToHex(i[0],2);return e},this.MulDivInt=function(t,e,i){var s,o=0;return 0===i?o=-1:o=(s=t*e/i)>=0?pas.System.Trunc(s+.5):pas.System.Trunc(s-.5),o},this.LoadBitmapFromHexStr=function(t,e){var i=null,s=null,o=null,n=[],r="";i=pas.Classes.TStringStream.$create("Create$2",[t]),o=pas.Classes.TBytesStream.$create("Create");try{for(var a=1,l=rtl.trunc(i.GetSize()/2);a<=l;a++)a,n=this.HexStrToBytes(i.ReadString(2)),o.Write(n,rtl.length(n));o.SetPosition(0),r="",s=pas.Classes.TStringStream.$create("Create$2",[""]);try{s.CopyFrom(o,o.GetSize()),r=s.GetDataString()}finally{s=rtl.freeLoc(s)}pas.System.Pos(";base64,",r)>0?e.LoadFromResource(r):e.LoadFromStream(o)}finally{i=rtl.freeLoc(i),o=rtl.freeLoc(o)}},this.LoadBitmapFromBase64=function(t,e,i){var s="";s=t,pas.System.Pos(";base64,",s)>0||(s="data:image/png;base64,"+s),e.LoadFromResource(s)},this.Split=function(t,e,i,s){rtl.rcc(t,0,65535);var o=0;if(i.Clear(),i.SetDelimiter(t),i.FStrictDelimiter=!0,i.SetDelimitedText(e),s)for(var n=i.GetCount()-1;n>=0;n--)o=n,""===i.Get(o)&&i.Delete(o)},this.Encode64$1=function(t,e){var i="",s="";if(i="",0===rtl.length(t))return i;return s="",s=function(t){for(var e="",i=new Uint8Array(t),s=i.byteLength,o=0;o<s;o++)e+=String.fromCharCode(i[o]);return window.btoa(e)}(rtl.arrayRef(t)),e&&(s=pas.SysUtils.StringReplace(s,"+","-",rtl.createSet(0,1)),s=pas.SysUtils.StringReplace(s,"/","_",rtl.createSet(0,1)),s=pas.SysUtils.StringReplace(s,"=","",rtl.createSet(0,1))),i=s},this.Decode64ToBytes=function(t,e){var i,s=[],o="",n=null;if(s=[],0===t.length)return s;o=t,e&&(o+=pas.System.StringOfChar("=",o.length%4),o=pas.SysUtils.StringReplace(o,"-","+",rtl.createSet(0)),o=pas.SysUtils.StringReplace(o,"_","/",rtl.createSet(0))),i=o,o=window.atob(i),n=pas.Classes.TStringStream.$create("Create$3",["",pas.Classes.TEncoding.GetUTF8(),!0]);try{n.WriteString(o),s=pas["WEBLib.TMSFNCTypes"].TTMSFNCMemoryStream.GetBytes.call(n)}finally{n=rtl.freeLoc(n)}return s},this.MatchStrEx=function(e,i,s){var o="",n="",r=0,a=0,l=!1,h=!1,F=[];if(e=pas.SysUtils.Trim(e),e=this.StripLogicSpaces(e),r=rtl.rc(-1,-2147483648,2147483647),1===t.TTMSFNCUtils.VarPos("=",e,{get:function(){return r},set:function(t){rtl.rc(t,-2147483648,2147483647),r=t}})&&pas.System.Delete({get:function(){return e},set:function(t){e=t}},r,1),n="\0",l=!0,(F=rtl.arraySetLength(F,"",5))[0]="(",F[1]=";",F[2]="^",F[3]="&",F[4]="|",""===e)return""===i;if("*"!==e&&""===i)return!1;do{if("\0"!==(o=rtl.rcc(this.FirstChar(rtl.arrayRef(F),e,{get:function(){return r},set:function(t){rtl.rc(t,-2147483648,2147483647),r=t}}),0,65535))){if(e.length>0&&"("===rtl.rcCharAt(e,0)&&pas.System.Pos("(",e)>0?(a=rtl.rc(this.ClosingParenthesis(e),-2147483648,2147483647),h=this.MatchStrEx(pas.System.Copy(e,2,a-2),i,s),pas.System.Delete({get:function(){return e},set:function(t){e=t}},1,a)):(h=this.MatchStr(pas.System.Copy(e,1,r-1),i,s),pas.System.Delete({get:function(){return e},set:function(t){e=t}},1,r)),"\0"===n)l=h;else{";"===n||"^"===n||"|"===n?l=l||h:"&"===n&&(l=l&&h)}n=rtl.rcc(o,0,65535)}}while("\0"!==o);if(h=this.MatchStr(e,i,s),"\0"===n)l=h;else{";"===n||"^"===n||"|"===n?l=l||h:"&"===n&&(l=l&&h)}return l},this.MatchStr=function(t,e,i){return i?this.Matches(t,e):this.Matches(pas["WEBLib.TMSFNCTypes"].AnsiUpperCase(t),pas["WEBLib.TMSFNCTypes"].AnsiUpperCase(e))},this.StripLogicSpaces=function(t){var e,i="",s=0,o=0;for(o=0,s=1,e=t.length,i="";s<=e;)'"'===t.charAt(s-1)&&(o+=1)," "===t.charAt(s-1)?pas.System.Odd(o)&&(i+=t.charAt(s-1)):i+=t.charAt(s-1),s+=1;return i},this.FirstChar=function(t,e,i){var s="",o=0,n=0;for(0,o=1,n=0,i.set(-1),s="\0";o<=e.length;){if('"'===e.charAt(o-0-1)&&(n+=1),this.CharInSet(e.charAt(o-0-1),rtl.arrayRef(t))&&!pas.System.Odd(n)){i.set(o),s=e.charAt(o-0-1);break}o+=1}return s},this.CharInSet=function(t,e){var i=!1;i=!1;for(var s=0,o=rtl.length(e)-1;s<=o;s++)if(t===e[s]){i=!0;break}return i},this.CreateCharSet=function(t){var e=[],i=0;e=rtl.arraySetLength(e,"",t.length);for(var s=1,o=t.length;s<=o;s++)e[(i=s)-1]=this.CharInStr(t,i);return e},this.IsDate=function(e,i){var s,o,n,r=!1,a="",l="",h=0,F=0,p=0,c=0,u=0,C=0,T=0,S=0;if(r=!1,l="",a=pas.SysUtils.UpperCase(pas.SysUtils.FormatSettings.ShortDateFormat),s=pas.System.Pos("D",a),o=pas.System.Pos("M",a),n=pas.System.Pos("Y",a),h=0,F=0,p=0,c=0,u=0,C=0,S=-1,t.TTMSFNCUtils.VarPos(pas.SysUtils.FormatSettings.DateSeparator,e,{get:function(){return S},set:function(t){S=t}})>0){if(a=pas.System.Copy(e,1,S-1),s<o&&s<n?pas.System.val$5(a,{get:function(){return h},set:function(t){h=t}},{get:function(){return T},set:function(t){T=t}}):o<s&&o<n?pas.System.val$5(a,{get:function(){return F},set:function(t){F=t}},{get:function(){return T},set:function(t){T=t}}):n<o&&n<s&&pas.System.val$5(a,{get:function(){return p},set:function(t){p=t}},{get:function(){return T},set:function(t){T=t}}),0!==T)return r;if(pas.System.Delete({get:function(){return e},set:function(t){e=t}},1,S),t.TTMSFNCUtils.VarPos(pas.SysUtils.FormatSettings.DateSeparator,e,{get:function(){return S},set:function(t){S=t}})>0){if(a=pas.System.Copy(e,1,S-1),s>o&&s<n||s>n&&s<o?pas.System.val$5(a,{get:function(){return h},set:function(t){h=t}},{get:function(){return T},set:function(t){T=t}}):o>s&&o<n||o>n&&o<s?pas.System.val$5(a,{get:function(){return F},set:function(t){F=t}},{get:function(){return T},set:function(t){T=t}}):(n>o&&n<s||n>s&&n<o)&&pas.System.val$5(a,{get:function(){return p},set:function(t){p=t}},{get:function(){return T},set:function(t){T=t}}),0!==T)return r;if(pas.System.Delete({get:function(){return e},set:function(t){e=t}},1,S),e=pas.SysUtils.Trim(e),t.TTMSFNCUtils.VarPos(" ",e,{get:function(){return S},set:function(t){S=t}})>0&&(l=pas.System.Copy(e,S,e.length),e=pas.System.Copy(e,1,S-1)),s>o&&s>n?pas.System.val$5(e,{get:function(){return h},set:function(t){h=t}},{get:function(){return T},set:function(t){T=t}}):o>s&&o>n?pas.System.val$5(e,{get:function(){return F},set:function(t){F=t}},{get:function(){return T},set:function(t){T=t}}):n>o&&n>s&&pas.System.val$5(e,{get:function(){return p},set:function(t){p=t}},{get:function(){return T},set:function(t){T=t}}),0!==T)return r;if(h>31)return r;if(F>12)return r;if(""!==l){if(t.TTMSFNCUtils.VarPos(pas.SysUtils.FormatSettings.TimeSeparator,l,{get:function(){return S},set:function(t){S=t}})>0){if(a=pas.System.Copy(l,1,S-1),pas.System.val$5(a,{get:function(){return c},set:function(t){c=t}},{get:function(){return T},set:function(t){T=t}}),0!==T)return r;if(c>23)return r;if(pas.System.Delete({get:function(){return l},set:function(t){l=t}},1,S),t.TTMSFNCUtils.VarPos(pas.SysUtils.FormatSettings.TimeSeparator,l,{get:function(){return S},set:function(t){S=t}})>0){if(a=pas.System.Copy(l,1,S-1),pas.System.val$5(a,{get:function(){return u},set:function(t){u=t}},{get:function(){return T},set:function(t){T=t}}),0!==T)return r;if(pas.System.Delete({get:function(){return l},set:function(t){l=t}},1,S),pas.System.val$5(l,{get:function(){return C},set:function(t){C=t}},{get:function(){return T},set:function(t){T=t}}),0!==T)return r;if(C>60)return r}else if(pas.System.val$5(a,{get:function(){return u},set:function(t){u=t}},{get:function(){return T},set:function(t){T=t}}),0!==T)return r;if(u>59)return r;r=!0}}else r=!0;try{i.set(pas.SysUtils.EncodeDate(p,F,h)+pas.SysUtils.EncodeTime(c,u,C,0))}catch(t){r=!1}}}return r},this.IPos=function(t,e){return pas.System.Pos(pas.SysUtils.UpperCase(t),pas.SysUtils.UpperCase(e))},this.UnFixMarkup=function(t,i,s){var o=0;if(!s){for(;pas.System.Pos("&lt;",t)>0;)this.TagReplaceString("&lt;","<",{get:function(){return t},set:function(e){t=e}});for(;pas.System.Pos("&gt;",t)>0;)this.TagReplaceString("&gt;",">",{get:function(){return t},set:function(e){t=e}});for(;pas.System.Pos("&amp;",t)>0;)this.TagReplaceString("&amp;","&",{get:function(){return t},set:function(e){t=e}});for(;pas.System.Pos("&quot;",t)>0;)this.TagReplaceString("&quot;",'"',{get:function(){return t},set:function(e){t=e}})}if(i)for(o=4;o<=92;o++)for(;pas.System.Pos(e.HTMLSpecialChar[o-1],t)>0;)this.TagReplaceString(e.HTMLSpecialChar[o-1],e.HTMLEncodedChar[o-1],{get:function(){return t},set:function(e){t=e}});return t},this.TagReplaceString=function(t,e,i){var s,o=!1;return(s=this.IPos(t,i.get()))>0?(o=!0,pas.System.Delete(i,s,t.length),i.set(pas.System.Copy(i.get(),1,s-1)+e+pas.System.Copy(i.get(),s,i.get().length))):o=!1,o};this.Matches=function(e,i){var s=!1,o=!1,n=0,r="",a=0,l=0,h=0,F=0,p=!1,c=!1,u=!1,C="",T=!1,S=!1,d=!1,m=!1,f=0,g=0,y=0,M=0,b=0,N=0,B=0;if(0,p=!0,c=!0,T=!1,S=!1,d=!1,u=!1,m=!1,0!==(h=rtl.rc(pas.System.Pos(">",e),-2147483648,2147483647))){for(h+=1,"="===rtl.rcCharAt(e,h-0-1)&&(m=!0,h+=1);" "===rtl.rcCharAt(e,h-0-1);)h+=1;for(F=rtl.rc(h,-2147483648,2147483647),n=0,r="\0",B=0;h-0<=e.length&&" "!==rtl.rcCharAt(e,h-0-1)&&h<=e.length&&(pas.System.Odd(B)||"&"!==rtl.rcCharAt(e,h-0-1)&&"|"!==rtl.rcCharAt(e,h-0-1));)'"'===rtl.rcCharAt(e,h-0-1)&&(B+=1),0===n&&'"'===rtl.rcCharAt(e,h-0-1)?F+=1:n+=1,r=rtl.rcc(rtl.rcCharAt(e,h-0-1),0,65535),(h+=1)-0<=e.length&&" "===rtl.rcCharAt(e,h-0-1)&&pas.System.Odd(B)&&(r=rtl.rcc(rtl.rcCharAt(e,h-0-1),0,65535),h+=1);n>0&&'"'===r&&(n-=1),C=pas.System.Copy(e,F,n),pas.System.val$8(t.TTMSFNCUtils.StripThousandSep(i),{get:function(){return f},set:function(t){f=t}},{get:function(){return y},set:function(t){rtl.rc(t,-2147483648,2147483647),y=t}}),pas.System.val$8(t.TTMSFNCUtils.StripThousandSep(C),{get:function(){return g},set:function(t){g=t}},{get:function(){return M},set:function(t){rtl.rc(t,-2147483648,2147483647),M=t}}),N=0,t.TTMSFNCUtils.IsDate(C,{get:function(){return N},set:function(t){N=t}})&&(M=1),b=0,t.TTMSFNCUtils.IsDate(i,{get:function(){return b},set:function(t){b=t}})&&(y=1),c=0===y&&0===M?m?f>=g:f>g:t.TTMSFNCUtils.IsDate(C,{get:function(){return N},set:function(t){N=t}})&&t.TTMSFNCUtils.IsDate(i,{get:function(){return b},set:function(t){b=t}})?m?b>=N:b>N:m?pas.SysUtils.CompareStr(C,i)<=0:pas.SysUtils.CompareStr(C,i)<0,T=!0}if(m=!1,0!==(h=rtl.rc(pas.System.Pos("<",e),-2147483648,2147483647))){for(h+=1,"="===rtl.rcCharAt(e,h-0-1)&&(m=!0,h+=1),r="\0";h-0<=e.length&&" "===rtl.rcCharAt(e,h-0-1);)h+=1;for(F=rtl.rc(h,-2147483648,2147483647),n=0,B=0;h-0<=e.length&&" "!==rtl.rcCharAt(e,h-0-1)&&h<=e.length&&(pas.System.Odd(B)||"&"!==rtl.rcCharAt(e,h-0-1)&&"|"!==rtl.rcCharAt(e,h-0-1));)'"'===rtl.rcCharAt(e,h-0-1)&&(B+=1),0===n&&'"'===rtl.rcCharAt(e,h-0-1)?F+=1:n+=1,r=rtl.rcc(rtl.rcCharAt(e,h-0-1),0,65535),h+=1;n>0&&'"'===r&&(n-=1),C=pas.System.Copy(e,F,n),pas.System.val$8(t.TTMSFNCUtils.StripThousandSep(i),{get:function(){return f},set:function(t){f=t}},{get:function(){return y},set:function(t){rtl.rc(t,-2147483648,2147483647),y=t}}),pas.System.val$8(t.TTMSFNCUtils.StripThousandSep(C),{get:function(){return g},set:function(t){g=t}},{get:function(){return M},set:function(t){rtl.rc(t,-2147483648,2147483647),M=t}}),t.TTMSFNCUtils.IsDate(C,{get:function(){return N},set:function(t){N=t}})&&(M=1),t.TTMSFNCUtils.IsDate(i,{get:function(){return b},set:function(t){b=t}})&&(y=1),p=0===y&&0===M?m?f<=g:f<g:t.TTMSFNCUtils.IsDate(C,{get:function(){return N},set:function(t){N=t}})&&t.TTMSFNCUtils.IsDate(i,{get:function(){return b},set:function(t){b=t}})?m?b<=N:b<N:m?pas.SysUtils.CompareStr(C,i)>=0:pas.SysUtils.CompareStr(C,i)>0,S=!0}if(0!==(h=rtl.rc(pas.System.Pos("!",e),-2147483648,2147483647))){for(h+=1;" "===rtl.rcCharAt(e,h-0-1);)h+=1;for(F=rtl.rc(h,-2147483648,2147483647),n=0,r="\0",B=0;" "!==rtl.rcCharAt(e,h-0-1)&&h<=e.length&&(pas.System.Odd(B)||"&"!==rtl.rcCharAt(e,h-0-1)&&"|"!==rtl.rcCharAt(e,h-0-1));)'"'===rtl.rcCharAt(e,h-0-1)&&(B+=1),0===n&&'"'===rtl.rcCharAt(e,h-0-1)?F+=1:n+=1,r=rtl.rcc(rtl.rcCharAt(e,h-0-1),0,65535),h+=1;n>0&&'"'===r&&(n-=1),C=pas.System.Copy(e,F,n),d=!0}if(d&&(0===pas.System.Pos(">",e)&&(T=d),0===pas.System.Pos("<",e)&&(S=d)),0!==pas.System.Pos("^",e)&&(T||S))return p||c;if(0!==pas.System.Pos("&",e)&&T&&S)return p&&c;if(0!==pas.System.Pos(">",e)&&c||0!==pas.System.Pos("<",e)&&p)return!0;for(a=1,l=1,o=""===e||""===i,s=!0;!o&&s;){var E=rtl.rcCharAt(e,a-0-1);if("?"===E)(s=l<=i.length)&&(a+=1,l+=1);else if("!"===E)u=!0,a+=1;else if('"'===E)a+=1;else if("*"===E){do{a+=1}while(!(a-0>e.length||"*"!==rtl.rcCharAt(e,a-0-1)));for(l+=n=rtl.rc(i.length-l,-2147483648,2147483647),s=this.Matches(pas.System.Copy(e,a,e.length),pas.System.Copy(i,l,i.length));n>=0&&!s;)l-=1,n-=1,s=this.Matches(pas.System.Copy(e,a,e.length),pas.System.Copy(i,l,i.length));s&&(a=rtl.rc(e.length+1,-2147483648,2147483647),l=rtl.rc(i.length+1,-2147483648,2147483647))}else(s=a<=e.length&&l<=i.length&&rtl.rcCharAt(e,a-0-1)===rtl.rcCharAt(i,l-0-1))&&(a+=1,l+=1);o=a>e.length&&l>i.length}return u?!s:s},this.StripThousandSep=function(t){for(;pas.System.Pos(pas.SysUtils.FormatSettings.ThousandSeparator,t)>0;)pas.System.Delete({get:function(){return t},set:function(e){t=e}},pas.System.Pos(pas.SysUtils.FormatSettings.ThousandSeparator,t),1);return t},this.ClosingParenthesis=function(t){var e=0,i=0,s=0,o=0;for(o=0,i=0,s=0,e=1;e<=t.length;){if(")"===t.charAt(e-1)&&(s+=1),"("===t.charAt(e-1)&&(i+=1),")"===t.charAt(e-1)&&i===s){o=e;break}e+=1}return o},this.IndexOfTextInArray=function(t,e){var i=0,s=0;i=-1;for(var o=0,n=rtl.length(e)-1;o<=n;o++)if(s=o,pas.SysUtils.SameText(t,e[s])){if(!(pas.System.Pos("cute",t)>0||pas.System.Pos("grave",t)>0||pas.System.Pos("uml",t)>0||pas.System.Pos("circ",t)>0||pas.System.Pos("tilde",t)>0||pas.System.Pos("ring",t)>0||pas.System.Pos("cedil",t)>0)){i=s;break}if(t===e[s]){i=s;break}}return i},this.GetParentForm=function(t){var e,i=null;return i=null,null==(e=t)?i:i=pas["WEBLib.Forms"].TCustomForm.isPrototypeOf(e.FParent)?rtl.as(e.FParent,pas["WEBLib.Forms"].TCustomForm):this.GetParentForm(e.FParent)},this.GetOwnerForm=function(t){var e,i=null;return i=null,null==(e=t)?i:i=pas["WEBLib.Forms"].TCustomForm.isPrototypeOf(e.FOwner)?rtl.as(e.FOwner,pas["WEBLib.Forms"].TCustomForm):this.GetOwnerForm(e.FOwner)},this.SelectFile=function(t,e,i,s){return!0,null!=s&&s(t.get(),!0),!0},this.EscapeString=function(t){var i="",s="",o="",n=0;function r(t,i){var s=!1,o=0;for(s=!1,i.set(""),o=1;o<=7;o++)if(t===e.JSONSpecialChar[o-1]){i.set(e.JSONEncodedSpecialChar[o-1]),s=!0;break}return s}i="";for(var a=1,l=t.length;a<=l;a++)n=a,(o=this.CharInStr(t,n))>""?i=i+"\\u"+pas.SysUtils.IntToHex(o.charCodeAt(),4):(s="",r(o,{get:function(){return s},set:function(t){s=t}})?i+=s:i+=o);return i},this.UnescapeString=function(t){var e=0,i=0,s=0,o="",n=0;for(o=rtl.strSetLength(o,t.length),0,e=1,i=1;e<=t.length;){if("\\"===t.charAt(e-0-1)){if(!(e<t.length))throw pas.SysUtils.Exception.$create("Create$1",["Unexpected end of string"]);if("\\"===t.charAt(e+1-0-1))n=i-0,o=rtl.setCharAt(o,n-1,"\\"),e+=2;else if("/"===t.charAt(e+1-0-1))n=i-0,o=rtl.setCharAt(o,n-1,"/"),e+=2;else if("b"===t.charAt(e+1-0-1))n=i-0,o=rtl.setCharAt(o,n-1,"\b"),e+=2;else if("f"===t.charAt(e+1-0-1))n=i-0,o=rtl.setCharAt(o,n-1,"\f"),e+=2;else if("n"===t.charAt(e+1-0-1))n=i-0,o=rtl.setCharAt(o,n-1,"\n"),e+=2;else if("r"===t.charAt(e+1-0-1))n=i-0,o=rtl.setCharAt(o,n-1,"\r"),e+=2;else if("t"===t.charAt(e+1-0-1))n=i-0,o=rtl.setCharAt(o,n-1,"\t"),e+=2;else if('"'===t.charAt(e+1-0-1))n=i-0,o=rtl.setCharAt(o,n-1,'"'),e+=2;else{if(!("u"===t.charAt(e+1-0-1)&&e+1+4<=t.length&&pas.SysUtils.TryStrToInt("$"+pas.System.Copy(t,e+2,4),{get:function(){return s},set:function(t){s=t}})))throw pas.SysUtils.Exception.$create("CreateFmt",["Invalid code at position %s",pas.System.VarRecs(18,pas.SysUtils.IntToStr(e))]);e+=6,n=i-0,o=rtl.setCharAt(o,n-1,String.fromCharCode(s))}}else n=i-0,o=rtl.setCharAt(o,n-1,t.charAt(e-0-1)),e+=1;i+=1}return o=rtl.strSetLength(o,i-1)}})),this.TTMSFNCClipBoardFormat={0:"cfText",cfText:0,1:"cfRTF",cfRTF:1,2:"cfHTML",cfHTML:2,3:"cfBitmap",cfBitmap:3,4:"cfBitmapWin",cfBitmapWin:4,5:"cfStream",cfStream:5,6:"cfRichTextStream",cfRichTextStream:6},rtl.createClass(this,"TTMSFNCClipBoard",pas.System.TObject,(function(){this.FClipboardData="",this.HasFormat=function(t){rtl.rc(t,0,6);return!0,!0},this.SetText=function(e){t.TTMSFNCClipBoard.FClipboardData=e;const i=document.createElement("textarea");i.value=e,document.body.appendChild(i),i.focus(),i.setSelectionRange(0,i.value.length),document.execCommand("copy"),document.body.removeChild(i)},this.GetText=function(){return this.FClipboardData}})),t.$implcode=function(){e.HTMLNumSpecialChar=92,e.JSONNumSpecialChar=7,e.HTMLEncodedChar=["&","<",">",'"'," ","é","è","ë","ê","ó","ò","ö","ô","í","ì","ï","î","ú","ù","ü","û","á","à","ä","â","É","È","Ë","Ê","Ó","Ò","Ö","Ô","Í","Ì","Ï","Î","Ú","Ù","Ü","Û","Á","À","Ä","Â","ç","Ç","ø","Ø","å","Å","©","®","€","«","»","ã","Ã","õ","Õ","™","§","¶","ß","£","$","§","‰","¶","'","¥","¤","¢","±","¡","°","ý","Ý","¼","½","¾","Æ","æ","Ñ","ñ","Ð","´","µ","¶","·","²","³"],e.HTMLSpecialChar=["amp;","lt;","gt;","quot;","&nbsp;","&eacute;","&egrave;","&euml;","&ecirc;","&oacute;","&ograve;","&ouml;","&ocirc;","&iacute;","&igrave;","&iuml;","&icirc;","&uacute;","&ugrave;","&uuml;","&ucirc;","&aacute;","&agrave;","&auml;","&acirc;","&Eacute;","&Egrave;","&Euml;","&Ecirc;","&Oacute;","&Ograve;","&Ouml;","&Ocirc;","&Iacute;","&Igrave;","&Iuml;","&Icirc;","&Uacute;","&Ugrave;","&Uuml;","&Ucirc;","&Aacute;","&Agrave;","&Auml;","&Acirc;","&ccedil;","&Ccedil;","&oslash;","&Oslash;","&aring;","&Aring;","&copy;","&reg;","&euro;","&laquo;","&raquo;","&atilde;","&Atilde;","&otilde;","&Otilde","&trade;","&sect;","&para;","&szlig;","&pound;","&#36;","&sect;","&permil;","&para;","&#39;","&yen;","&curren;","&cent;","&plusmn;","&iexcl;","&deg;","&#x00FD;","&#221;","&frac14;","&frac12;","&frac34;","&AElig;","&aelig;","&Ntilde;","&ntilde;","&ETH;","&acute;","&micro;","&para;","&middot","&sup2;","&sup3;"],e.JSONSpecialChar=['"',"\\","\b","\f","\n","\r","\t"],e.JSONEncodedSpecialChar=["\\u0022","\\u005C","\\u0008","\\u000C","\\u000A","\\u000D","\\u0009"],e.FMimeTypes=null,e.RegisterMimeTypes=function(){function t(t,i){e.FMimeTypes.Add(t+e.FMimeTypes.GetNameValueSeparator()+i)}t("ez","application/andrew-inset"),t("aw","application/applixware"),t("atom","application/atom+xml"),t("atomcat","application/atomcat+xml"),t("atomsvc","application/atomsvc+xml"),t("bson","application/bson"),t("ccxml","application/ccxml+xml"),t("cdmia","application/cdmi-capability"),t("cdmic","application/cdmi-container"),t("cdmid","application/cdmi-domain"),t("cdmio","application/cdmi-object"),t("cdmiq","application/cdmi-queue"),t("cu","application/cu-seeme"),t("davmount","application/davmount+xml"),t("dbk","application/docbook+xml"),t("dssc","application/dssc+der"),t("xdssc","application/dssc+xml"),t("ecma","application/ecmascript"),t("emma","application/emma+xml"),t("epub","application/epub+zip"),t("exi","application/exi"),t("pfr","application/font-tdpfr"),t("gml","application/gml+xml"),t("gpx","application/gpx+xml"),t("gxf","application/gxf"),t("stk","application/hyperstudio"),t("ink","application/inkml+xml"),t("inkml","application/inkml+xml"),t("ipfix","application/ipfix"),t("jar","application/java-archive"),t("ser","application/java-serialized-object"),t("class","application/java-vm"),t("js","application/javascript"),t("json","application/json"),t("jsonml","application/jsonml+json"),t("lostxml","application/lost+xml"),t("hqx","application/mac-binhex40"),t("cpt","application/mac-compactpro"),t("mads","application/mads+xml"),t("mrc","application/marc"),t("mrcx","application/marcxml+xml"),t("ma","application/mathematica"),t("nb","application/mathematica"),t("mb","application/mathematica"),t("mathml","application/mathml+xml"),t("mbox","application/mbox"),t("mscml","application/mediaservercontrol+xml"),t("metalink","application/metalink+xml"),t("meta4","application/metalink4+xml"),t("mets","application/mets+xml"),t("mods","application/mods+xml"),t("m21","application/mp21"),t("mp21","application/mp21"),t("mp4s","application/mp4"),t("doc","application/msword"),t("dot","application/msword"),t("mxf","application/mxf"),t("bin","application/octet-stream"),t("bpk","application/octet-stream"),t("class","application/octet-stream"),t("deploy","application/octet-stream"),t("dist","application/octet-stream"),t("distz","application/octet-stream"),t("dmg","application/octet-stream"),t("dms","application/octet-stream"),t("dump","application/octet-stream"),t("elc","application/octet-stream"),t("iso","application/octet-stream"),t("lha","application/octet-stream"),t("lrf","application/octet-stream"),t("lzh","application/octet-stream"),t("mar","application/octet-stream"),t("pkg","application/octet-stream"),t("so","application/octet-stream"),t("oda","application/oda"),t("opf","application/oebps-package+xml"),t("ogx","application/ogg"),t("omdoc","application/omdoc+xml"),t("onetoc","application/onenote"),t("onetoc2","application/onenote"),t("onetmp","application/onenote"),t("onepkg","application/onenote"),t("oxps","application/oxps"),t("xer","application/patch-ops-error+xml"),t("pdf","application/pdf"),t("pgp","application/pgp-encrypted"),t("asc","application/pgp-signature"),t("sig","application/pgp-signature"),t("prf","application/pics-rules"),t("p10","application/pkcs10"),t("p7m","application/pkcs7-mime"),t("p7c","application/pkcs7-mime"),t("p7s","application/pkcs7-signature"),t("p8","application/pkcs8"),t("ac","application/pkix-attr-cert"),t("cer","application/pkix-cert"),t("crl","application/pkix-crl"),t("pkipath","application/pkix-pkipath"),t("pki","application/pkixcmp"),t("pls","application/pls+xml"),t("ai","application/postscript"),t("eps","application/postscript"),t("ps","application/postscript"),t("cww","application/prs.cww"),t("pskcxml","application/pskc+xml"),t("rdf","application/rdf+xml"),t("rif","application/reginfo+xml"),t("rnc","application/relax-ng-compact-syntax"),t("rl","application/resource-lists+xml"),t("rld","application/resource-lists-diff+xml"),t("rs","application/rls-services+xml"),t("gbr","application/rpki-ghostbusters"),t("mft","application/rpki-manifest"),t("roa","application/rpki-roa"),t("rsd","application/rsd+xml"),t("rss","application/rss+xml"),t("rtf","application/rtf"),t("sbml","application/sbml+xml"),t("scq","application/scvp-cv-request"),t("scs","application/scvp-cv-response"),t("spq","application/scvp-vp-request"),t("spp","application/scvp-vp-response"),t("sdp","application/sdp"),t("setpay","application/set-payment-initiation"),t("setreg","application/set-registration-initiation"),t("shf","application/shf+xml"),t("smi","application/smil+xml"),t("smil","application/smil+xml"),t("soap","application/soap+xml"),t("rq","application/sparql-query"),t("srx","application/sparql-results+xml"),t("gram","application/srgs"),t("grxml","application/srgs+xml"),t("sru","application/sru+xml"),t("ssdl","application/ssdl+xml"),t("ssml","application/ssml+xml"),t("tei","application/tei+xml"),t("teicorpus","application/tei+xml"),t("tfi","application/thraud+xml"),t("tsd","application/timestamped-data"),t("plb","application/vnd.3gpp.pic-bw-large"),t("psb","application/vnd.3gpp.pic-bw-small"),t("pvb","application/vnd.3gpp.pic-bw-var"),t("tcap","application/vnd.3gpp2.tcap"),t("pwn","application/vnd.3m.post-it-notes"),t("aso","application/vnd.accpac.simply.aso"),t("imp","application/vnd.accpac.simply.imp"),t("acu","application/vnd.acucobol"),t("atc","application/vnd.acucorp"),t("acutc","application/vnd.acucorp"),t("air","application/vnd.adobe.air-application-installer-package+zip"),t("fcdt","application/vnd.adobe.formscentral.fcdt"),t("fxp","application/vnd.adobe.fxp"),t("fxpl","application/vnd.adobe.fxp"),t("xdp","application/vnd.adobe.xdp+xml"),t("xfdf","application/vnd.adobe.xfdf"),t("ahead","application/vnd.ahead.space"),t("azf","application/vnd.airzip.filesecure.azf"),t("azs","application/vnd.airzip.filesecure.azs"),t("azw","application/vnd.amazon.ebook"),t("acc","application/vnd.americandynamics.acc"),t("ami","application/vnd.amiga.ami"),t("apk","application/vnd.android.package-archive"),t("cii","application/vnd.anser-web-certificate-issue-initiation"),t("fti","application/vnd.anser-web-funds-transfer-initiation"),t("atx","application/vnd.antix.game-component"),t("mpkg","application/vnd.apple.installer+xml"),t("m3u8","application/vnd.apple.mpegurl"),t("swi","application/vnd.aristanetworks.swi"),t("iota","application/vnd.astraea-software.iota"),t("aep","application/vnd.audiograph"),t("mpm","application/vnd.blueice.multipass"),t("bmi","application/vnd.bmi"),t("rep","application/vnd.businessobjects"),t("cdxml","application/vnd.chemdraw+xml"),t("mmd","application/vnd.chipnuts.karaoke-mmd"),t("cdy","application/vnd.cinderella"),t("cla","application/vnd.claymore"),t("rp9","application/vnd.cloanto.rp9"),t("c4g","application/vnd.clonk.c4group"),t("c4d","application/vnd.clonk.c4group"),t("c4f","application/vnd.clonk.c4group"),t("c4p","application/vnd.clonk.c4group"),t("c4u","application/vnd.clonk.c4group"),t("c11amc","application/vnd.cluetrust.cartomobile-config"),t("c11amz","application/vnd.cluetrust.cartomobile-config-pkg"),t("csp","application/vnd.commonspace"),t("cdbcmsg","application/vnd.contact.cmsg"),t("cmc","application/vnd.cosmocaller"),t("clkx","application/vnd.crick.clicker"),t("clkk","application/vnd.crick.clicker.keyboard"),t("clkp","application/vnd.crick.clicker.palette"),t("clkt","application/vnd.crick.clicker.template"),t("clkw","application/vnd.crick.clicker.wordbank"),t("wbs","application/vnd.criticaltools.wbs+xml"),t("pml","application/vnd.ctc-posml"),t("ppd","application/vnd.cups-ppd"),t("car","application/vnd.curl.car"),t("pcurl","application/vnd.curl.pcurl"),t("dart","application/vnd.dart"),t("rdz","application/vnd.data-vision.rdz"),t("uvf","application/vnd.dece.data"),t("uvvf","application/vnd.dece.data"),t("uvd","application/vnd.dece.data"),t("uvvd","application/vnd.dece.data"),t("uvt","application/vnd.dece.ttml+xml"),t("uvvt","application/vnd.dece.ttml+xml"),t("uvx","application/vnd.dece.unspecified"),t("uvvx","application/vnd.dece.unspecified"),t("uvz","application/vnd.dece.zip"),t("uvvz","application/vnd.dece.zip"),t("fe_launch","application/vnd.denovo.fcselayout-link"),t("dna","application/vnd.dna"),t("mlp","application/vnd.dolby.mlp"),t("dpg","application/vnd.dpgraph"),t("dfac","application/vnd.dreamfactory"),t("kpxx","application/vnd.ds-keypoint"),t("ait","application/vnd.dvb.ait"),t("svc","application/vnd.dvb.service"),t("geo","application/vnd.dynageo"),t("mag","application/vnd.ecowin.chart"),t("nml","application/vnd.enliven"),t("esf","application/vnd.epson.esf"),t("msf","application/vnd.epson.msf"),t("qam","application/vnd.epson.quickanime"),t("slt","application/vnd.epson.salt"),t("ssf","application/vnd.epson.ssf"),t("es3","application/vnd.eszigno3+xml"),t("et3","application/vnd.eszigno3+xml"),t("ez2","application/vnd.ezpix-album"),t("ez3","application/vnd.ezpix-package"),t("fdf","application/vnd.fdf"),t("mseed","application/vnd.fdsn.mseed"),t("seed","application/vnd.fdsn.seed"),t("dataless","application/vnd.fdsn.seed"),t("json","application/vnd.firedac.json"),t("xml","application/vnd.firedac.xml"),t("bin","application/vnd.firedac.bin"),t("gph","application/vnd.flographit"),t("ftc","application/vnd.fluxtime.clip"),t("fm","application/vnd.framemaker"),t("frame","application/vnd.framemaker"),t("maker","application/vnd.framemaker"),t("book","application/vnd.framemaker"),t("fnc","application/vnd.frogans.fnc"),t("ltf","application/vnd.frogans.ltf"),t("fsc","application/vnd.fsc.weblaunch"),t("oas","application/vnd.fujitsu.oasys"),t("oa2","application/vnd.fujitsu.oasys2"),t("oa3","application/vnd.fujitsu.oasys3"),t("fg5","application/vnd.fujitsu.oasysgp"),t("bh2","application/vnd.fujitsu.oasysprs"),t("ddd","application/vnd.fujixerox.ddd"),t("xdw","application/vnd.fujixerox.docuworks"),t("xbd","application/vnd.fujixerox.docuworks.binder"),t("fzs","application/vnd.fuzzysheet"),t("txd","application/vnd.genomatix.tuxedo"),t("ggb","application/vnd.geogebra.file"),t("ggt","application/vnd.geogebra.tool"),t("gex","application/vnd.geometry-explorer"),t("gre","application/vnd.geometry-explorer"),t("gxt","application/vnd.geonext"),t("g2w","application/vnd.geoplan"),t("g3w","application/vnd.geospace"),t("gmx","application/vnd.gmx"),t("kml","application/vnd.google-earth.kml+xml"),t("kmz","application/vnd.google-earth.kmz"),t("gqf","application/vnd.grafeq"),t("gqs","application/vnd.grafeq"),t("gac","application/vnd.groove-account"),t("ghf","application/vnd.groove-help"),t("gim","application/vnd.groove-identity-message"),t("grv","application/vnd.groove-injector"),t("gtm","application/vnd.groove-tool-message"),t("tpl","application/vnd.groove-tool-template"),t("vcg","application/vnd.groove-vcard"),t("hal","application/vnd.hal+xml"),t("zmm","application/vnd.handheld-entertainment+xml"),t("hbci","application/vnd.hbci"),t("les","application/vnd.hhe.lesson-player"),t("hpgl","application/vnd.hp-hpgl"),t("hpid","application/vnd.hp-hpid"),t("hps","application/vnd.hp-hps"),t("jlt","application/vnd.hp-jlyt"),t("pcl","application/vnd.hp-pcl"),t("pclxl","application/vnd.hp-pclxl"),t("sfd-hdstx","application/vnd.hydrostatix.sof-data"),t("mpy","application/vnd.ibm.minipay"),t("afp","application/vnd.ibm.modcap"),t("listafp","application/vnd.ibm.modcap"),t("list3820","application/vnd.ibm.modcap"),t("irm","application/vnd.ibm.rights-management"),t("sc","application/vnd.ibm.secure-container"),t("icc","application/vnd.iccprofile"),t("icm","application/vnd.iccprofile"),t("igl","application/vnd.igloader"),t("ivp","application/vnd.immervision-ivp"),t("ivu","application/vnd.immervision-ivu"),t("igm","application/vnd.insors.igm"),t("xpw","application/vnd.intercon.formnet"),t("xpx","application/vnd.intercon.formnet"),t("i2g","application/vnd.intergeo"),t("qbo","application/vnd.intu.qbo"),t("qfx","application/vnd.intu.qfx"),t("rcprofile","application/vnd.ipunplugged.rcprofile"),t("irp","application/vnd.irepository.package+xml"),t("xpr","application/vnd.is-xpr"),t("fcs","application/vnd.isac.fcs"),t("jam","application/vnd.jam"),t("rms","application/vnd.jcp.javame.midlet-rms"),t("jisp","application/vnd.jisp"),t("joda","application/vnd.joost.joda-archive"),t("ktz","application/vnd.kahootz"),t("ktr","application/vnd.kahootz"),t("karbon","application/vnd.kde.karbon"),t("chrt","application/vnd.kde.kchart"),t("kfo","application/vnd.kde.kformula"),t("flw","application/vnd.kde.kivio"),t("kon","application/vnd.kde.kontour"),t("kpr","application/vnd.kde.kpresenter"),t("kpt","application/vnd.kde.kpresenter"),t("ksp","application/vnd.kde.kspread"),t("kwd","application/vnd.kde.kword"),t("kwt","application/vnd.kde.kword"),t("htke","application/vnd.kenameaapp"),t("kia","application/vnd.kidspiration"),t("kne","application/vnd.kinar"),t("knp","application/vnd.kinar"),t("skp","application/vnd.koan"),t("skd","application/vnd.koan"),t("skt","application/vnd.koan"),t("skm","application/vnd.koan"),t("sse","application/vnd.kodak-descriptor"),t("lasxml","application/vnd.las.las+xml"),t("lbd","application/vnd.llamagraphics.life-balance.desktop"),t("lbe","application/vnd.llamagraphics.life-balance.exchange+xml"),t("123","application/vnd.lotus-1-2-3"),t("apr","application/vnd.lotus-approach"),t("pre","application/vnd.lotus-freelance"),t("nsf","application/vnd.lotus-notes"),t("org","application/vnd.lotus-organizer"),t("scm","application/vnd.lotus-screencam"),t("lwp","application/vnd.lotus-wordpro"),t("portpkg","application/vnd.macports.portpkg"),t("mcd","application/vnd.mcd"),t("mc1","application/vnd.medcalcdata"),t("cdkey","application/vnd.mediastation.cdkey"),t("mwf","application/vnd.mfer"),t("mfm","application/vnd.mfmp"),t("flo","application/vnd.micrografx.flo"),t("igx","application/vnd.micrografx.igx"),t("mif","application/vnd.mif"),t("daf","application/vnd.mobius.daf"),t("dis","application/vnd.mobius.dis"),t("mbk","application/vnd.mobius.mbk"),t("mqy","application/vnd.mobius.mqy"),t("msl","application/vnd.mobius.msl"),t("plc","application/vnd.mobius.plc"),t("txf","application/vnd.mobius.txf"),t("mpn","application/vnd.mophun.application"),t("mpc","application/vnd.mophun.certificate"),t("xul","application/vnd.mozilla.xul+xml"),t("cil","application/vnd.ms-artgalry"),t("cab","application/vnd.ms-cab-compressed"),t("xls","application/vnd.ms-excel"),t("xlm","application/vnd.ms-excel"),t("xla","application/vnd.ms-excel"),t("xlc","application/vnd.ms-excel"),t("xlt","application/vnd.ms-excel"),t("xlw","application/vnd.ms-excel"),t("xlam","application/vnd.ms-excel.addin.macroenabled.12"),t("xlsb","application/vnd.ms-excel.sheet.binary.macroenabled.12"),t("xlsm","application/vnd.ms-excel.sheet.macroenabled.12"),t("xltm","application/vnd.ms-excel.template.macroenabled.12"),t("eot","application/vnd.ms-fontobject"),t("chm","application/vnd.ms-htmlhelp"),t("ims","application/vnd.ms-ims"),t("lrm","application/vnd.ms-lrm"),t("thmx","application/vnd.ms-officetheme"),t("cat","application/vnd.ms-pki.seccat"),t("stl","application/vnd.ms-pki.stl"),t("ppt","application/vnd.ms-powerpoint"),t("pps","application/vnd.ms-powerpoint"),t("pot","application/vnd.ms-powerpoint"),t("ppam","application/vnd.ms-powerpoint.addin.macroenabled.12"),t("pptm","application/vnd.ms-powerpoint.presentation.macroenabled.12"),t("sldm","application/vnd.ms-powerpoint.slide.macroenabled.12"),t("ppsm","application/vnd.ms-powerpoint.slideshow.macroenabled.12"),t("potm","application/vnd.ms-powerpoint.template.macroenabled.12"),t("mpp","application/vnd.ms-project"),t("mpt","application/vnd.ms-project"),t("docm","application/vnd.ms-word.document.macroenabled.12"),t("dotm","application/vnd.ms-word.template.macroenabled.12"),t("wps","application/vnd.ms-works"),t("wks","application/vnd.ms-works"),t("wcm","application/vnd.ms-works"),t("wdb","application/vnd.ms-works"),t("wpl","application/vnd.ms-wpl"),t("xps","application/vnd.ms-xpsdocument"),t("mseq","application/vnd.mseq"),t("mus","application/vnd.musician"),t("msty","application/vnd.muvee.style"),t("taglet","application/vnd.mynfc"),t("nlu","application/vnd.neurolanguage.nlu"),t("ntf","application/vnd.nitf"),t("nitf","application/vnd.nitf"),t("nnd","application/vnd.noblenet-directory"),t("nns","application/vnd.noblenet-sealer"),t("nnw","application/vnd.noblenet-web"),t("ngdat","application/vnd.nokia.n-gage.data"),t("n-gage","application/vnd.nokia.n-gage.symbian.install"),t("rpst","application/vnd.nokia.radio-preset"),t("rpss","application/vnd.nokia.radio-presets"),t("edm","application/vnd.novadigm.edm"),t("edx","application/vnd.novadigm.edx"),t("FExt","application/vnd.novadigm.FExt"),t("odc","application/vnd.oasis.opendocument.chart"),t("otc","application/vnd.oasis.opendocument.chart-template"),t("odb","application/vnd.oasis.opendocument.database"),t("odf","application/vnd.oasis.opendocument.formula"),t("odft","application/vnd.oasis.opendocument.formula-template"),t("odg","application/vnd.oasis.opendocument.graphics"),t("otg","application/vnd.oasis.opendocument.graphics-template"),t("odi","application/vnd.oasis.opendocument.image"),t("oti","application/vnd.oasis.opendocument.image-template"),t("odp","application/vnd.oasis.opendocument.presentation"),t("otp","application/vnd.oasis.opendocument.presentation-template"),t("ods","application/vnd.oasis.opendocument.spreadsheet"),t("ots","application/vnd.oasis.opendocument.spreadsheet-template"),t("odt","application/vnd.oasis.opendocument.text"),t("odm","application/vnd.oasis.opendocument.text-master"),t("ott","application/vnd.oasis.opendocument.text-template"),t("oth","application/vnd.oasis.opendocument.text-web"),t("xo","application/vnd.olpc-sugar"),t("dd2","application/vnd.oma.dd2+xml"),t("oxt","application/vnd.openofficeorg.extension"),t("pptx","application/vnd.openxmlformats-officedocument.presentationml.presentation"),t("sldx","application/vnd.openxmlformats-officedocument.presentationml.slide"),t("ppsx","application/vnd.openxmlformats-officedocument.presentationml.slideshow"),t("potx","application/vnd.openxmlformats-officedocument.presentationml.template"),t("xlsx","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"),t("xltx","application/vnd.openxmlformats-officedocument.spreadsheetml.template"),t("docx","application/vnd.openxmlformats-officedocument.wordprocessingml.document"),t("dotx","application/vnd.openxmlformats-officedocument.wordprocessingml.template"),t("mgp","application/vnd.osgeo.mapguide.package"),t("dp","application/vnd.osgi.dp"),t("esa","application/vnd.osgi.subsystem"),t("pdb","application/vnd.palm"),t("pqa","application/vnd.palm"),t("oprc","application/vnd.palm"),t("paw","application/vnd.pawaafile"),t("str","application/vnd.pg.format"),t("ei6","application/vnd.pg.osasli"),t("efif","application/vnd.picsel"),t("wg","application/vnd.pmi.widget"),t("plf","application/vnd.pocketlearn"),t("pbd","application/vnd.powerbuilder6"),t("box","application/vnd.previewsystems.box"),t("mgz","application/vnd.proteus.magazine"),t("qps","application/vnd.publishare-delta-tree"),t("ptid","application/vnd.pvi.ptid1"),t("qxd","application/vnd.quark.quarkxpress"),t("qxt","application/vnd.quark.quarkxpress"),t("qwd","application/vnd.quark.quarkxpress"),t("qwt","application/vnd.quark.quarkxpress"),t("qxl","application/vnd.quark.quarkxpress"),t("qxb","application/vnd.quark.quarkxpress"),t("bed","application/vnd.realvnc.bed"),t("mxl","application/vnd.recordare.musicxml"),t("musicxml","application/vnd.recordare.musicxml+xml"),t("cryptonote","application/vnd.rig.cryptonote"),t("cod","application/vnd.rim.cod"),t("rm","application/vnd.rn-realmedia"),t("rmvb","application/vnd.rn-realmedia-vbr"),t("link66","application/vnd.route66.link66+xml"),t("st","application/vnd.sailingtracker.track"),t("see","application/vnd.seemail"),t("sema","application/vnd.sema"),t("semd","application/vnd.semd"),t("semf","application/vnd.semf"),t("ifm","application/vnd.shana.informed.formdata"),t("itp","application/vnd.shana.informed.formtemplate"),t("iif","application/vnd.shana.informed.interchange"),t("ipk","application/vnd.shana.informed.package"),t("twd","application/vnd.simtech-mindmapper"),t("twds","application/vnd.simtech-mindmapper"),t("mmf","application/vnd.smaf"),t("teacher","application/vnd.smart.teacher"),t("sdkm","application/vnd.solent.sdkm+xml"),t("sdkd","application/vnd.solent.sdkm+xml"),t("dxp","application/vnd.spotfire.dxp"),t("sfs","application/vnd.spotfire.sfs"),t("sdc","application/vnd.stardivision.calc"),t("sda","application/vnd.stardivision.draw"),t("sdd","application/vnd.stardivision.impress"),t("smf","application/vnd.stardivision.math"),t("sdw","application/vnd.stardivision.writer"),t("vor","application/vnd.stardivision.writer"),t("sgl","application/vnd.stardivision.writer-global"),t("smzip","application/vnd.stepmania.package"),t("sm","application/vnd.stepmania.stepchart"),t("sxc","application/vnd.sun.xml.calc"),t("stc","application/vnd.sun.xml.calc.template"),t("sxd","application/vnd.sun.xml.draw"),t("std","application/vnd.sun.xml.draw.template"),t("sxi","application/vnd.sun.xml.impress"),t("sti","application/vnd.sun.xml.impress.template"),t("sxm","application/vnd.sun.xml.math"),t("sxw","application/vnd.sun.xml.writer"),t("sxg","application/vnd.sun.xml.writer.global"),t("stw","application/vnd.sun.xml.writer.template"),t("sus","application/vnd.sus-calendar"),t("susp","application/vnd.sus-calendar"),t("svd","application/vnd.svd"),t("sis","application/vnd.symbian.install"),t("sisx","application/vnd.symbian.install"),t("xsm","application/vnd.syncml+xml"),t("bdm","application/vnd.syncml.dm+wbxml"),t("xdm","application/vnd.syncml.dm+xml"),t("tao","application/vnd.tao.intent-module-archive"),t("pcap","application/vnd.tcpdump.pcap"),t("cap","application/vnd.tcpdump.pcap"),t("dmp","application/vnd.tcpdump.pcap"),t("tmo","application/vnd.tmobile-livetv"),t("tpt","application/vnd.trid.tpt"),t("mxs","application/vnd.triscape.mxs"),t("tra","application/vnd.trueapp"),t("ufd","application/vnd.ufdl"),t("ufdl","application/vnd.ufdl"),t("utz","application/vnd.uiq.theme"),t("umj","application/vnd.umajin"),t("unityweb","application/vnd.unity"),t("uoml","application/vnd.uoml+xml"),t("vcx","application/vnd.vcx"),t("vsd","application/vnd.visio"),t("vst","application/vnd.visio"),t("vss","application/vnd.visio"),t("vsw","application/vnd.visio"),t("vis","application/vnd.visionary"),t("vsf","application/vnd.vsf"),t("wbxml","application/vnd.wap.wbxml"),t("wmlc","application/vnd.wap.wmlc"),t("wmlsc","application/vnd.wap.wmlscriptc"),t("wtb","application/vnd.webturbo"),t("nbp","application/vnd.wolfram.player"),t("wpd","application/vnd.wordperfect"),t("wqd","application/vnd.wqd"),t("stf","application/vnd.wt.stf"),t("xar","application/vnd.xara"),t("xfdl","application/vnd.xfdl"),t("hvd","application/vnd.yamaha.hv-dic"),t("hvs","application/vnd.yamaha.hv-script"),t("hvp","application/vnd.yamaha.hv-voice"),t("osf","application/vnd.yamaha.openscoreformat"),t("osfpvg","application/vnd.yamaha.openscoreformat.osfpvg+xml"),t("saf","application/vnd.yamaha.smaf-audio"),t("spf","application/vnd.yamaha.smaf-phrase"),t("cmp","application/vnd.yellowriver-custom-menu"),t("zir","application/vnd.zul"),t("zirz","application/vnd.zul"),t("zaz","application/vnd.zzazz.deck+xml"),t("vxml","application/voicexml+xml"),t("wgt","application/widget"),t("hlp","application/winhlp"),t("wsdl","application/wsdl+xml"),t("wspolicy","application/wspolicy+xml"),t("7z","application/x-7z-compressed"),t("abw","application/x-abiword"),t("ace","application/x-ace-compressed"),t("dmg","application/x-apple-diskimage"),t("aab","application/x-authorware-bin"),t("x32","application/x-authorware-bin"),t("u32","application/x-authorware-bin"),t("vox","application/x-authorware-bin"),t("aam","application/x-authorware-map"),t("aas","application/x-authorware-seg"),t("bcpio","application/x-bcpio"),t("torrent","application/x-bittorrent"),t("blb","application/x-blorb"),t("blorb","application/x-blorb"),t("bz","application/x-bzip"),t("bz2","application/x-bzip2"),t("boz","application/x-bzip2"),t("cbr","application/x-cbr"),t("cba","application/x-cbr"),t("cbt","application/x-cbr"),t("cbz","application/x-cbr"),t("cb7","application/x-cbr"),t("vcd","application/x-cdlink"),t("cfs","application/x-cfs-compressed"),t("chat","application/x-chat"),t("pgn","application/x-chess-pgn"),t("nsc","application/x-conference"),t("cpio","application/x-cpio"),t("csh","application/x-csh"),t("deb","application/x-debian-package"),t("udeb","application/x-debian-package"),t("dgc","application/x-dgc-compressed"),t("dir","application/x-director"),t("dcr","application/x-director"),t("dxr","application/x-director"),t("cst","application/x-director"),t("cct","application/x-director"),t("cxt","application/x-director"),t("w3d","application/x-director"),t("fgd","application/x-director"),t("swa","application/x-director"),t("wad","application/x-doom"),t("ncx","application/x-dtbncx+xml"),t("dtb","application/x-dtbook+xml"),t("res","application/x-dtbresource+xml"),t("dvi","application/x-dvi"),t("evy","application/x-envoy"),t("eva","application/x-eva"),t("bdf","application/x-font-bdf"),t("gsf","application/x-font-ghostscript"),t("psf","application/x-font-linux-psf"),t("otf","application/x-font-otf"),t("pcf","application/x-font-pcf"),t("snf","application/x-font-snf"),t("ttf","application/x-font-ttf"),t("ttc","application/x-font-ttf"),t("pfa","application/x-font-type1"),t("pfb","application/x-font-type1"),t("pfm","application/x-font-type1"),t("afm","application/x-font-type1"),t("woff","application/x-font-woff"),t("arc","application/x-freearc"),t("spl","application/x-futuresplash"),t("gca","application/x-gca-compressed"),t("ulx","application/x-glulx"),t("gnumeric","application/x-gnumeric"),t("gramps","application/x-gramps-xml"),t("gtar","application/x-gtar"),t("hdf","application/x-hdf"),t("install","application/x-install-instructions"),t("iso","application/x-iso9660-image"),t("jnlp","application/x-java-jnlp-file"),t("latex","application/x-latex"),t("lzh","application/x-lzh-compressed"),t("lha","application/x-lzh-compressed"),t("mie","application/x-mie"),t("prc","application/x-mobipocket-ebook"),t("mobi","application/x-mobipocket-ebook"),t("application","application/x-ms-application"),t("lnk","application/x-ms-shortcut"),t("wmd","application/x-ms-wmd"),t("wmz","application/x-ms-wmz"),t("xbap","application/x-ms-xbap"),t("mdb","application/x-msaccess"),t("obd","application/x-msbinder"),t("crd","application/x-mscardfile"),t("clp","application/x-msclip"),t("exe","application/x-msdownload"),t("dll","application/x-msdownload"),t("com","application/x-msdownload"),t("bat","application/x-msdownload"),t("msi","application/x-msdownload"),t("mvb","application/x-msmediaview"),t("m13","application/x-msmediaview"),t("m14","application/x-msmediaview"),t("wmf","application/x-msmetafile"),t("wmz","application/x-msmetafile"),t("emf","application/x-msmetafile"),t("emz","application/x-msmetafile"),t("mny","application/x-msmoney"),t("pub","application/x-mspublisher"),t("scd","application/x-msschedule"),t("trm","application/x-msterminal"),t("wri","application/x-mswrite"),t("nc","application/x-netcdf"),t("cdf","application/x-netcdf"),t("nzb","application/x-nzb"),t("p12","application/x-pkcs12"),t("pfx","application/x-pkcs12"),t("p7b","application/x-pkcs7-certificates"),t("spc","application/x-pkcs7-certificates"),t("p7r","application/x-pkcs7-certreqresp"),t("rar","application/x-rar-compressed"),t("ris","application/x-research-info-systems"),t("sh","application/x-sh"),t("shar","application/x-shar"),t("swf","application/x-shockwave-flash"),t("xap","application/x-silverlight-app"),t("sql","application/x-sql"),t("sit","application/x-stuffit"),t("sitx","application/x-stuffitx"),t("srt","application/x-subrip"),t("sv4cpio","application/x-sv4cpio"),t("sv4crc","application/x-sv4crc"),t("t3","application/x-t3vm-image"),t("gam","application/x-tads"),t("tar","application/x-tar"),t("tcl","application/x-tcl"),t("tex","application/x-tex"),t("tfm","application/x-tex-tfm"),t("texinfo","application/x-texinfo"),t("texi","application/x-texinfo"),t("obj","application/x-tgif"),t("ustar","application/x-ustar"),t("src","application/x-wais-source"),t("der","application/x-x509-ca-cert"),t("crt","application/x-x509-ca-cert"),t("fig","application/x-xfig"),t("xlf","application/x-xliff+xml"),t("xpi","application/x-xpinstall"),t("xz","application/x-xz"),t("z1","application/x-zmachine"),t("z2","application/x-zmachine"),t("z3","application/x-zmachine"),t("z4","application/x-zmachine"),t("z5","application/x-zmachine"),t("z6","application/x-zmachine"),t("z7","application/x-zmachine"),t("z8","application/x-zmachine"),t("xaml","application/xaml+xml"),t("xdf","application/xcap-diff+xml"),t("xenc","application/xenc+xml"),t("xhtml","application/xhtml+xml"),t("xht","application/xhtml+xml"),t("xml","application/xml"),t("xsl","application/xml"),t("dtd","application/xml-dtd"),t("xop","application/xop+xml"),t("xpl","application/xproc+xml"),t("xslt","application/xslt+xml"),t("xspf","application/xspf+xml"),t("mxml","application/xv+xml"),t("xhvml","application/xv+xml"),t("xvml","application/xv+xml"),t("xvm","application/xv+xml"),t("yang","application/yang"),t("yin","application/yin+xml"),t("zip","application/zip"),t("adp","audio/adpcm"),t("au","audio/basic"),t("snd","audio/basic"),t("mid","audio/midi"),t("midi","audio/midi"),t("kar","audio/midi"),t("rmi","audio/midi"),t("mp4a","audio/mp4"),t("mpga","audio/mpeg"),t("mp2","audio/mpeg"),t("mp2a","audio/mpeg"),t("mp3","audio/mpeg"),t("m2a","audio/mpeg"),t("m3a","audio/mpeg"),t("oga","audio/ogg"),t("ogg","audio/ogg"),t("spx","audio/ogg"),t("s3m","audio/s3m"),t("sil","audio/silk"),t("uva","audio/vnd.dece.audio"),t("uvva","audio/vnd.dece.audio"),t("eol","audio/vnd.digital-winds"),t("dra","audio/vnd.dra"),t("dts","audio/vnd.dts"),t("dtshd","audio/vnd.dts.hd"),t("lvp","audio/vnd.lucent.voice"),t("pya","audio/vnd.ms-playready.media.pya"),t("ecelp4800","audio/vnd.nuera.ecelp4800"),t("ecelp7470","audio/vnd.nuera.ecelp7470"),t("ecelp9600","audio/vnd.nuera.ecelp9600"),t("rip","audio/vnd.rip"),t("weba","audio/webm"),t("aac","audio/aac"),t("aif","audio/x-aiff"),t("aiff","audio/x-aiff"),t("aifc","audio/x-aiff"),t("caf","audio/x-caf"),t("flac","audio/x-flac"),t("mka","audio/x-matroska"),t("m3u","audio/x-mpegurl"),t("wax","audio/x-ms-wax"),t("wma","audio/x-ms-wma"),t("ram","audio/x-pn-realaudio"),t("ra","audio/x-pn-realaudio"),t("rmp","audio/x-pn-realaudio-plugin"),t("wav","audio/x-wav"),t("xm","audio/xm"),t("cdx","chemical/x-cdx"),t("cif","chemical/x-cif"),t("cmdf","chemical/x-cmdf"),t("cml","chemical/x-cml"),t("csml","chemical/x-csml"),t("xyz","chemical/x-xyz"),t("bmp","image/bmp"),t("cgm","image/cgm"),t("g3","image/g3fax"),t("gif","image/gif"),t("ief","image/ief"),t("jpeg","image/jpeg"),t("jpg","image/jpeg"),t("jpe","image/jpeg"),t("ktx","image/ktx"),t("png","image/png"),t("btif","image/prs.btif"),t("sgi","image/sgi"),t("svg","image/svg+xml");t("svgz","image/svg+xml"),t("tiff","image/tiff"),t("tif","image/tiff"),t("psd","image/vnd.adobe.photoshop"),t("uvi","image/vnd.dece.graphic"),t("uvvi","image/vnd.dece.graphic"),t("uvg","image/vnd.dece.graphic"),t("uvvg","image/vnd.dece.graphic"),t("sub","image/vnd.dvb.subtitle"),t("djvu","image/vnd.djvu"),t("djv","image/vnd.djvu"),t("dwg","image/vnd.dwg"),t("dxf","image/vnd.dxf"),t("fbs","image/vnd.fastbidsheet"),t("fpx","image/vnd.fpx"),t("fst","image/vnd.fst"),t("mmr","image/vnd.fujixerox.edmics-mmr"),t("rlc","image/vnd.fujixerox.edmics-rlc"),t("mdi","image/vnd.ms-modi"),t("wdp","image/vnd.ms-photo"),t("npx","image/vnd.net-fpx"),t("wbmp","image/vnd.wap.wbmp"),t("xif","image/vnd.xiff"),t("webp","image/webp"),t("3ds","image/x-3ds"),t("ras","image/x-cmu-raster"),t("cmx","image/x-cmx"),t("fh","image/x-freehand"),t("fhc","image/x-freehand"),t("fh4","image/x-freehand"),t("fh5","image/x-freehand"),t("fh7","image/x-freehand"),t("ico","image/x-icon"),t("sid","image/x-mrsid-image"),t("pcx","image/x-pcx"),t("pic","image/x-pict"),t("pct","image/x-pict"),t("pnm","image/x-portable-anymap"),t("pbm","image/x-portable-bitmap"),t("pgm","image/x-portable-graymap"),t("ppm","image/x-portable-pixmap"),t("rgb","image/x-rgb"),t("tga","image/x-tga"),t("xbm","image/x-xbitmap"),t("xpm","image/x-xpixmap"),t("xwd","image/x-xwindowdump"),t("eml","message/rfc822"),t("mime","message/rfc822"),t("igs","model/iges"),t("iges","model/iges"),t("msh","model/mesh"),t("mesh","model/mesh"),t("silo","model/mesh"),t("dae","model/vnd.collada+xml"),t("dwf","model/vnd.dwf"),t("gdl","model/vnd.gdl"),t("gtw","model/vnd.gtw"),t("mts","model/vnd.mts"),t("vtu","model/vnd.vtu"),t("wrl","model/vrml"),t("vrml","model/vrml"),t("x3db","model/x3d+binary"),t("x3dbz","model/x3d+binary"),t("x3dv","model/x3d+vrml"),t("x3dvz","model/x3d+vrml"),t("x3d","model/x3d+xml"),t("x3dz","model/x3d+xml"),t("appcache","text/cache-manifest"),t("ics","text/calendar"),t("ifb","text/calendar"),t("cmd","text/cmd"),t("css","text/css"),t("csv","text/csv"),t("html","text/html"),t("htm","text/html"),t("n3","text/n3"),t("txt","text/plain"),t("text","text/plain"),t("conf","text/plain"),t("def","text/plain"),t("list","text/plain"),t("log","text/plain"),t("in","text/plain"),t("js","text/plain"),t("dsc","text/prs.lines.tag"),t("rtx","text/richtext"),t("sgml","text/sgml"),t("sgm","text/sgml"),t("tsv","text/tab-separated-values"),t("t","text/troff"),t("tr","text/troff"),t("roff","text/troff"),t("man","text/troff"),t("me","text/troff"),t("ms","text/troff"),t("ttl","text/turtle"),t("uri","text/uri-list"),t("uris","text/uri-list"),t("urls","text/uri-list"),t("vcard","text/vcard"),t("curl","text/vnd.curl"),t("dcurl","text/vnd.curl.dcurl"),t("scurl","text/vnd.curl.scurl"),t("mcurl","text/vnd.curl.mcurl"),t("sub","text/vnd.dvb.subtitle"),t("fly","text/vnd.fly"),t("flx","text/vnd.fmi.flexstor"),t("gv","text/vnd.graphviz"),t("3dml","text/vnd.in3d.3dml"),t("spot","text/vnd.in3d.spot"),t("jad","text/vnd.sun.j2me.app-descriptor"),t("wml","text/vnd.wap.wml"),t("wmls","text/vnd.wap.wmlscript"),t("s","text/x-asm"),t("asm","text/x-asm"),t("c","text/x-c"),t("cc","text/x-c"),t("cxx","text/x-c"),t("cpp","text/x-c"),t("h","text/x-c"),t("hh","text/x-c"),t("dic","text/x-c"),t("f","text/x-fortran"),t("for","text/x-fortran"),t("f77","text/x-fortran"),t("f90","text/x-fortran"),t("java","text/x-java-source"),t("opml","text/x-opml"),t("p","text/x-pascal"),t("pas","text/x-pascal"),t("nfo","text/x-nfo"),t("etx","text/x-setext"),t("sfv","text/x-sfv"),t("uu","text/x-uuencode"),t("vcs","text/x-vcalendar"),t("vcf","text/x-vcard"),t("xml","text/xml"),t("xsl","text/xml"),t("dtd","text/xml-dtd"),t("3gp","video/3gpp"),t("3g2","video/3gpp2"),t("h261","video/h261"),t("h263","video/h263"),t("h264","video/h264"),t("jpgv","video/jpeg"),t("jpm","video/jpm"),t("jpgm","video/jpm"),t("mj2","video/mj2"),t("mjp2","video/mj2"),t("mp4","video/mp4"),t("mp4v","video/mp4"),t("mpg4","video/mp4"),t("mpeg","video/mpeg"),t("mpg","video/mpeg"),t("mpe","video/mpeg"),t("m1v","video/mpeg"),t("m2v","video/mpeg"),t("ogv","video/ogg"),t("qt","video/quicktime"),t("mov","video/quicktime"),t("uvh","video/vnd.dece.hd"),t("uvvh","video/vnd.dece.hd"),t("uvm","video/vnd.dece.mobile"),t("uvvm","video/vnd.dece.mobile"),t("uvp","video/vnd.dece.pd"),t("uvvp","video/vnd.dece.pd"),t("uvs","video/vnd.dece.sd"),t("uvvs","video/vnd.dece.sd"),t("uvv","video/vnd.dece.video"),t("uvvv","video/vnd.dece.video"),t("dvb","video/vnd.dvb.file"),t("fvt","video/vnd.fvt"),t("mxu","video/vnd.mpegurl"),t("m4u","video/vnd.mpegurl"),t("pyv","video/vnd.ms-playready.media.pyv"),t("uvu","video/vnd.uvvu.mp4"),t("uvvu","video/vnd.uvvu.mp4"),t("viv","video/vnd.vivo"),t("webm","video/webm"),t("f4v","video/x-f4v"),t("fli","video/x-fli"),t("flv","video/x-flv"),t("m4v","video/x-m4v"),t("mkv","video/x-matroska"),t("mk3d","video/x-matroska"),t("mks","video/x-matroska"),t("mng","video/x-mng"),t("asf","video/x-ms-asf"),t("asx","video/x-ms-asf"),t("vob","video/x-ms-vob"),t("wm","video/x-ms-wm"),t("wmv","video/x-ms-wmv"),t("wmx","video/x-ms-wmx"),t("wvx","video/x-ms-wvx"),t("avi","video/x-msvideo"),t("movie","video/x-sgi-movie"),t("smv","video/x-smv"),t("ice","x-conference/x-cooltalk")}},t.$init=function(){e.FMimeTypes=pas.Classes.TStringList.$create("Create$1"),e.RegisterMimeTypes()}}),["DateUtils"]),rtl.module("WEBLib.TMSFNCJSONReader",["System","Classes","SysUtils","WEBLib.TMSFNCTypes"],(function(){"use strict";var t=this,e=t.$impl;rtl.createClass(this,"TTMSFNCJSONStreamReader",pas.System.TObject,(function(){rtl.createClass(this,"EEndOfInputReached",pas.SysUtils.Exception,(function(){this.Create$2=function(){return pas.SysUtils.Exception.Create$1.call(this,"End of JSON input reached."),this}}),"TTMSFNCJSONStreamReader.EEndOfInputReached"),this.$init=function(){pas.System.TObject.$init.call(this),this.FStream=null,this.FReadStream=null},this.$final=function(){this.FStream=void 0,this.FReadStream=void 0,pas.System.TObject.$final.call(this)},this.Create$1=function(t){return this.FStream=t,this.FReadStream=pas.Classes.TStringStream.$create("Create$3",["",pas.Classes.TEncoding.GetANSI(),!0]),this.FReadStream.CopyFrom(this.FStream,this.FStream.GetSize()),this.FReadStream.SetPosition(0),this},this.Destroy=function(){rtl.free(this,"FReadStream"),pas.System.TObject.Destroy.call(this)},this.NextChar=function(){if(this.Eof())throw this.EEndOfInputReached.$create("Create$2");return this.ReadChar()},this.PeekChar=function(){var t,e;return e=this.FReadStream.GetPosition(),t=this.ReadChar(),this.FReadStream.SetPosition(e),t},this.ReadChar=function(){var t="",e="";return t="\0",1,this.FReadStream.GetPosition()<this.FReadStream.GetSize()&&""!==(e=this.FReadStream.ReadString(1))&&pas.System.Assigned(e)&&(t=e.charAt(0)),t},this.Backup=function(t){this.FReadStream.SetPosition(this.FReadStream.GetPosition()-1)},this.MoveNext=function(t){this.FReadStream.SetPosition(this.FReadStream.GetPosition()+t)},this.Eof=function(){return this.FReadStream.GetPosition()===this.FReadStream.GetSize()}})),this.TTMSFNCJSONToken={0:"jstoBeginObject",jstoBeginObject:0,1:"jstoEndObject",jstoEndObject:1,2:"jstoBeginArray",jstoBeginArray:2,3:"jstoEndArray",jstoEndArray:3,4:"jstoName",jstoName:4,5:"jstoBoolean",jstoBoolean:5,6:"jstoNull",jstoNull:6,7:"jstoText",jstoText:7,8:"jstoNumber",jstoNumber:8,9:"jstoEOF",jstoEOF:9},rtl.createClass(this,"TTMSFNCJSONReader",pas.System.TObject,(function(){this.TTMSFNCJSONState={0:"jstNone",jstNone:0,1:"jstBeginObject",jstBeginObject:1,2:"jstEndObject",jstEndObject:2,3:"jstBeginArray",jstBeginArray:3,4:"jstEndArray",jstEndArray:4,5:"jstTrue",jstTrue:5,6:"jstFalse",jstFalse:6,7:"jstNull",jstNull:7,8:"jstDoubleQuoted",jstDoubleQuoted:8,9:"jstBuffered",jstBuffered:9,10:"jstDoubleQuotedName",jstDoubleQuotedName:10,11:"jstInt64",jstInt64:11,12:"jstNumber",jstNumber:12,13:"jstEOF",jstEOF:13},this.TTMSFNCJSONNumberState={0:"jnstNone",jnstNone:0,1:"jnstSign",jnstSign:1,2:"jnstDigit",jnstDigit:2,3:"jnstDecimal",jnstDecimal:3,4:"jnstFraction",jnstFraction:4,5:"jnstExpE",jnstExpE:5,6:"jnstExpSign",jnstExpSign:6,7:"jnstExpDigit",jnstExpDigit:7},this.TTMSFNCJSONScope={0:"jscEmptyDocument",jscEmptyDocument:0,1:"jscEmptyArray",jscEmptyArray:1,2:"jscEmptyObject",jscEmptyObject:2,3:"jscNonEmptyDocument",jscNonEmptyDocument:3,4:"jscNonEmptyArray",jscNonEmptyArray:4,5:"jscNonEmptyObject",jscNonEmptyObject:5,6:"jscDanglingName",jscDanglingName:6},rtl.createClass(this,"EInvalidStateException",pas.SysUtils.Exception,(function(){this.Create$2=function(t){return pas.SysUtils.Exception.CreateFmt.call(this,"Invalid Json parser state. Expected state: %d",pas.System.VarRecs(0,t)),this}}),"TTMSFNCJSONReader.EInvalidStateException"),rtl.createClass(this,"EUnterminatedArray",pas.SysUtils.Exception,(function(){this.Create$2=function(){return pas.SysUtils.Exception.Create$1.call(this,"Unterminated array"),this}}),"TTMSFNCJSONReader.EUnterminatedArray"),rtl.createClass(this,"EUnterminatedObject",pas.SysUtils.Exception,(function(){this.Create$2=function(){return pas.SysUtils.Exception.Create$1.call(this,"Unterminated object"),this}}),"TTMSFNCJSONReader.EUnterminatedObject"),rtl.createClass(this,"ENameExpected",pas.SysUtils.Exception,(function(){this.Create$2=function(){return pas.SysUtils.Exception.Create$1.call(this,"Name expected"),this}}),"TTMSFNCJSONReader.ENameExpected"),rtl.createClass(this,"EColonExpected",pas.SysUtils.Exception,(function(){this.Create$2=function(){return pas.SysUtils.Exception.Create$1.call(this,"Colon expected"),this}}),"TTMSFNCJSONReader.EColonExpected"),rtl.createClass(this,"EMultipleRootNotAllowed",pas.SysUtils.Exception,(function(){this.Create$2=function(){return pas.SysUtils.Exception.Create$1.call(this,"Multiple root values not allowed"),this}}),"TTMSFNCJSONReader.EMultipleRootNotAllowed"),rtl.createClass(this,"EExpectedValue",pas.SysUtils.Exception,(function(){this.Create$2=function(){return pas.SysUtils.Exception.Create$1.call(this,"Value expected but invalid character found"),this}}),"TTMSFNCJSONReader.EExpectedValue"),rtl.createClass(this,"EObjectOrArrayExpected",pas.SysUtils.Exception,(function(){this.Create$2=function(){return pas.SysUtils.Exception.Create$1.call(this,"Object or array expected as top-level value"),this}}),"TTMSFNCJSONReader.EObjectOrArrayExpected"),rtl.createClass(this,"ETooManyDepthLevels",pas.SysUtils.Exception,(function(){this.Create$2=function(){return pas.SysUtils.Exception.Create$1.call(this,"Maximum level of nested structured reached."),this}}),"TTMSFNCJSONReader.ETooManyDepthLevels"),this.MaxNumberBuffer=255,this.MaxStackSize=255,this.$init=function(){pas.System.TObject.$init.call(this),this.FReader=null,this.FStack=rtl.arraySetLength(null,0,256),this.FStackSize=0,this.FPeeked=0,this.FPeekedInt64=0,this.FPeekedNumber=rtl.arraySetLength(null,"",256),this.FPeekedString=""},this.$final=function(){this.FReader=void 0,this.FStack=void 0,this.FPeekedNumber=void 0,pas.System.TObject.$final.call(this)},this.NextPeek=function(){return 0===this.FPeeked&&(this.FPeeked=this.DoPeek()),this.FPeeked},this.CheckState=function(t){if(this.NextPeek()!==t)throw this.EInvalidStateException.$create("Create$2",[t])},this.SkipChar=function(){for(this.FReader.MoveNext(1);this.FReader.PeekChar().charCodeAt()in e.Wspace;)this.FReader.MoveNext(1)},this.IsLiteral=function(t){return!pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.CharInSet(t,pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.CreateCharSet("/\\;#{}[]:,' \r\n\f\t"))},this.IsDigit=function(t){return t<="ÿ"&&pas["WEBLib.TMSFNCTypes"].CharIsNumber(t)},this.DoPeek=function(){var t,i=0;if(1===(t=this.FStack[this.FStackSize-1]))this.FStack[this.FStackSize-1]=4;else if(4===t){var s=this.NextNonWhitespace();if("]"===s)return this.SkipChar(),this.FPeeked=4,this.FPeeked;if(","!==s)throw this.EUnterminatedArray.$create("Create$2");this.SkipChar()}else{if(t in rtl.createSet(2,5)){if(this.FStack[this.FStackSize-1]=6,5===t){var o=this.NextNonWhitespace();if("}"===o){for(;this.FReader.PeekChar().charCodeAt()in e.Wspace;)this.FReader.MoveNext(1);return this.SkipChar(),this.FPeeked=2,this.FPeeked}if(","!==o)throw this.EUnterminatedObject.$create("Create$2");this.SkipChar()}var n=this.NextNonWhitespace();if('"'===n)return this.SkipChar(),this.FPeeked=10,this.FPeeked;if("}"===n){if(5!==t)return this.SkipChar(),this.FPeeked=2,this.FPeeked;throw this.ENameExpected.$create("Create$2")}throw this.ENameExpected.$create("Create$2")}if(6===t){if(this.FStack[this.FStackSize-1]=5,":"!==this.NextNonWhitespace())throw this.EColonExpected.$create("Create$2");this.SkipChar()}else if(0===t)this.FStack[this.FStackSize-1]=3;else if(3===t){if(this.SkipWhitespaceUntilEnd())return this.FPeeked=13,this.FPeeked;throw this.EMultipleRootNotAllowed.$create("Create$2")}}var r=this.NextNonWhitespace();if("]"===r){if(1===t)return this.SkipChar(),this.FPeeked=4,this.FPeeked;throw this.EExpectedValue.$create("Create$2")}if('"'===r){if(1===this.FStackSize)throw this.EObjectOrArrayExpected.$create("Create$2");return this.SkipChar(),this.FPeeked=8,this.FPeeked}if("["===r)return this.SkipChar(),this.FPeeked=3,this.FPeeked;if("{"===r)return this.SkipChar(),this.FPeeked=1,this.FPeeked;if(1===this.FStackSize)throw this.EObjectOrArrayExpected.$create("Create$2");if(0!==(i=this.PeekKeyword()))return i;if(0!==(i=this.PeekNumber()))return i;throw this.EExpectedValue.$create("Create$2")},this.PushScope=function(t){if(this.FStackSize>255)throw this.ETooManyDepthLevels.$create("Create$2");this.FStack[this.FStackSize]=t,this.FStackSize+=1},this.NextNonWhitespace=function(){var t,i="";t=this.FReader.FReadStream.GetPosition(),i=this.ReadChar();do{if(i>" "||!(i.charCodeAt()in e.Wspace))return this.FReader.FReadStream.SetPosition(t),i;i=this.ReadChar()}while(!this.FReader.Eof());return this.FReader.FReadStream.SetPosition(t),"\0"},this.ReadChar=function(){return this.FReader.ReadChar()},this.PeekKeyword=function(){var t=this.FReader.PeekChar();if("t"===t||"T"===t){this.FReader.MoveNext(1);var e=this.FReader.NextChar();if("r"===e||"R"===e){var i=this.FReader.NextChar();if("u"===i||"U"===i){var s=this.FReader.NextChar();if(("e"===s||"E"===s)&&(this.FReader.Eof()||!this.IsLiteral(this.FReader.PeekChar())))return 5}}}else if("f"===t||"F"===t){this.FReader.MoveNext(1);var o=this.FReader.NextChar();if("a"===o||"A"===o){var n=this.FReader.NextChar();if("l"===n||"L"===n){var r=this.FReader.NextChar();if("s"===r||"S"===r){var a=this.FReader.NextChar();if(("e"===a||"E"===a)&&(this.FReader.Eof()||!this.IsLiteral(this.FReader.PeekChar())))return 6}}}}else{if("n"!==t&&"N"!==t)return 0;this.FReader.MoveNext(1);var l=this.FReader.NextChar();if("u"===l||"U"===l){var h=this.FReader.NextChar();if("l"===h||"L"===h){var F=this.FReader.NextChar();if(("l"===F||"L"===F)&&(this.FReader.Eof()||!this.IsLiteral(this.FReader.PeekChar())))return 7}}}throw this.EExpectedValue.$create("Create$2")};rtl.trunc(-900719925474099.1);this.PeekNumber=function(){var t=0,e=!1,i=!1,s=0,o=0,n="",r=0;if("-"!==(n=this.FReader.PeekChar())&&!this.IsDigit(n))return 0;for(e=!1,i=!0,t=0,r=0,s=-1;;){if(r>=255)throw this.EExpectedValue.$create("Create$2");n=this.FReader.NextChar(),this.FPeekedNumber[r]=n,r+=1;var a=n;if("-"===a){if(0===t){e=!0,t=1;continue}if(5===t){t=6;continue}throw this.EExpectedValue.$create("Create$2")}if("+"===a){if(5===t){t=6;continue}throw this.EExpectedValue.$create("Create$2")}if("e"===a||"E"===a){if(t in rtl.createSet(2,4)){t=5;continue}throw this.EExpectedValue.$create("Create$2")}if("."===a){if(2===t){t=3;continue}throw this.EExpectedValue.$create("Create$2")}if(!this.IsDigit(n)){if(this.IsLiteral(n))throw this.EExpectedValue.$create("Create$2");this.FReader.Backup(n),r-=1;break}if(t in rtl.createSet(1,0))s=-(n.charCodeAt()-48),t=2;else if(2===t){if(0===s)throw this.EExpectedValue.$create("Create$2");o=10*s-(n.charCodeAt()-48),i=i&&(s>-900719925474099||-900719925474099===s&&o<s),s=o}else 3===t?t=4:t in rtl.createSet(5,6)&&(t=7)}if(2===t&&i&&(-9007199254740991!==s||e))return this.FPeekedInt64=e?s:-s,11;if(t in rtl.createSet(2,4,7))return this.FPeekedNumber[r]="\0",12;throw this.EExpectedValue.$create("Create$2")},this.InternalReadQuoted=function(t){var e="",i="",s="",o="";for(e="",o="",i="";!this.FReader.Eof()&&('"'!==(s=this.ReadChar())||"\\"===i);)o+=s,i=s;return t&&(e=o),e},this.ReadQuoted=function(){return this.InternalReadQuoted(!0)},this.SkipQuoted=function(){this.InternalReadQuoted(!1)},this.SkipWhitespaceUntilEnd=function(){var t,i="";t=this.FReader.FReadStream.GetPosition(),i=this.ReadChar();do{if(i>" "||!(i.charCodeAt()in e.Wspace))return this.FReader.FReadStream.SetPosition(t),!1;i=this.ReadChar()}while(!this.FReader.Eof());return this.FReader.FReadStream.SetPosition(t),!0},this.Create$1=function(e){return pas.System.TObject.Create.call(this),this.FReader=t.TTMSFNCJSONStreamReader.$create("Create$1",[e]),this.FPeeked=0,this.FStack[0]=0,this.FStackSize=1,this},this.Destroy=function(){rtl.free(this,"FReader"),pas.System.TObject.Destroy.call(this)},this.ReadBeginArray=function(){this.CheckState(3),this.PushScope(1),this.FPeeked=0},this.ReadEndArray=function(){this.CheckState(4),this.FStackSize-=1,this.FPeeked=0},this.ReadBeginObject=function(){this.CheckState(1),this.PushScope(2),this.FPeeked=0},this.ReadEndObject=function(){this.CheckState(2),this.FStackSize-=1,this.FPeeked=0},this.PeekName=function(){var t,e;return e=this.FReader.FReadStream.GetPosition(),t=this.ReadQuoted(),this.FReader.FReadStream.SetPosition(e),t},this.ReadName=function(){return this.CheckState(10),this.FPeeked=0,this.ReadQuoted()},this.ReadString=function(){var t="",i=this.NextPeek();if(8===i)t=this.ReadQuoted();else if(11===i)t=pas.SysUtils.IntToStr(this.FPeekedInt64);else if(12===i)t=e.ArrayOfCharToString(this.FPeekedNumber.slice(0));else{if(9!==i)throw this.EInvalidStateException.$create("Create$2",[8]);t=this.FPeekedString}return this.FPeeked=0,t=pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.UnescapeString(t)},this.ReadBoolean=function(){var t=!1,e=this.NextPeek();if(5===e)t=!0;else{if(6!==e)throw this.EInvalidStateException.$create("Create$2",[5]);t=!1}return this.FPeeked=0,t},this.ReadDouble=function(){var t=0,i=this.NextPeek();if(11===i)return this.FPeeked=0,this.FPeekedInt64;if(12===i){if(pas.SysUtils.TryStrToFloat$2(e.ArrayOfCharToString(this.FPeekedNumber.slice(0)),{get:function(){return t},set:function(e){t=e}}))return this.FPeeked=0,t;this.FPeekedString=e.ArrayOfCharToString(this.FPeekedNumber.slice(0))}else if(8===i)this.FPeekedString=this.ReadQuoted();else if(9!==i)throw this.EInvalidStateException.$create("Create$2",[12]);return this.FPeeked=9,t=pas.SysUtils.StrToFloat(this.FPeekedString),this.FPeekedString="",this.FPeeked=0,t},this.ReadInteger=function(){var t,i=0,s=this.NextPeek();if(11===s){if((i=4294967295&this.FPeekedInt64)!==this.FPeekedInt64)throw this.EInvalidStateException.$create("Create$2",[11]);return this.FPeeked=0,i}if(12===s){if(pas.SysUtils.TryStrToInt(e.ArrayOfCharToString(this.FPeekedNumber.slice(0)),{get:function(){return i},set:function(t){i=t}}))return this.FPeeked=0,i;this.FPeekedString=e.ArrayOfCharToString(this.FPeekedNumber.slice(0))}else if(8===s){if(this.FPeekedString=this.ReadQuoted(),pas.SysUtils.TryStrToInt(this.FPeekedString,{get:function(){return i},set:function(t){i=t}}))return this.FPeeked=0,i}else if(9!==s)throw this.EInvalidStateException.$create("Create$2",[11]);if(this.FPeeked=9,(t=pas.SysUtils.StrToFloat(this.FPeekedString))!==(i=Math.round(t)))throw this.EInvalidStateException.$create("Create$2",[11]);return this.FPeekedString="",this.FPeeked=0,i},this.SkipValue=function(){var t=0;t=0;do{var e=this.NextPeek();3===e?(this.PushScope(1),t+=1):1===e?(this.PushScope(2),t+=1):4===e||2===e?(this.FStackSize-=1,t-=1):8!==e&&10!==e||this.SkipQuoted(),this.FPeeked=0}while(!(t<=0))},this.ReadNull=function(){this.CheckState(7),this.FPeeked=0},this.HasNext=function(){return!(this.NextPeek()in rtl.createSet(2,4))},this.Peek=function(){var t=this.NextPeek();return 1===t?0:2===t?1:3===t?2:4===t?3:10===t?4:5===t||6===t?5:7===t?6:8===t||9===t?7:11===t||12===t?8:9},this.IsNull=function(){return 6===this.Peek()}})),t.$implcode=function(){e.Wspace=rtl.createSet(32,10,13,9,12),e.ArrayOfCharToString=function(t){var e="",i=0;e="";for(var s=0,o=rtl.length(t)-1;s<=o&&"\0"!==t[i=s];s++)e+=t[i];return e}}}),["WEBLib.TMSFNCUtils"]),rtl.module("WEBLib.TMSFNCJSONWriter",["System","Classes","SysUtils","WEBLib.TMSFNCTypes"],(function(){"use strict";var t=this;rtl.createClass(this,"TTMSFNCJSONStreamWriter",pas.System.TObject,(function(){this.$init=function(){pas.System.TObject.$init.call(this),this.FStream=null,this.FWriteStream=null},this.$final=function(){this.FStream=void 0,this.FWriteStream=void 0,pas.System.TObject.$final.call(this)},this.Create$1=function(t){return this.FStream=t,this.FWriteStream=pas.Classes.TStringStream.$create("Create$3",["",pas.Classes.TEncoding.GetANSI(),!0]),this},this.Destroy=function(){try{this.FWriteStream.SetPosition(0),this.FStream.CopyFrom(this.FWriteStream,this.FWriteStream.GetSize())}finally{rtl.free(this,"FWriteStream")}pas.System.TObject.Destroy.call(this)},this.Write=function(t){this.FWriteStream.WriteString(t)}})),rtl.createClass(this,"TTMSFNCJSONWriter",pas.System.TObject,(function(){rtl.createClass(this,"ECannotWriteName",pas.SysUtils.Exception,(function(){this.Create$2=function(){return pas.SysUtils.Exception.Create$1.call(this,"Cannot write name in current Json scope"),this}}),"TTMSFNCJSONWriter.ECannotWriteName"),rtl.createClass(this,"EMultipleRootNotAllowed",pas.SysUtils.Exception,(function(){this.Create$2=function(){return pas.SysUtils.Exception.Create$1.call(this,"Multiple root values not allowed"),this}}),"TTMSFNCJSONWriter.EMultipleRootNotAllowed"),rtl.createClass(this,"EObjectOrArrayExpected",pas.SysUtils.Exception,(function(){this.Create$2=function(){return pas.SysUtils.Exception.Create$1.call(this,"Object or array expected as top-level value"),this}}),"TTMSFNCJSONWriter.EObjectOrArrayExpected"),rtl.createClass(this,"EInvalidNesting",pas.SysUtils.Exception,(function(){this.Create$2=function(){return pas.SysUtils.Exception.Create$1.call(this,"Invalid nesting. Not all arrays/objects were properly closed."),this}}),"TTMSFNCJSONWriter.EInvalidNesting"),rtl.createClass(this,"EMissingValue",pas.SysUtils.Exception,(function(){this.Create$2=function(){return pas.SysUtils.Exception.Create$1.call(this,"Json value missing"),this}}),"TTMSFNCJSONWriter.EMissingValue"),rtl.createClass(this,"ETooManyDepthLevels",pas.SysUtils.Exception,(function(){this.Create$2=function(){return pas.SysUtils.Exception.Create$1.call(this,"Maximum level of nested structured reached."),this}}),"TTMSFNCJSONWriter.ETooManyDepthLevels"),rtl.createClass(this,"EEmptyJson",pas.SysUtils.Exception,(function(){this.Create$2=function(){return pas.SysUtils.Exception.Create$1.call(this,"Json is still empty. Cannot perform operation."),this}}),"TTMSFNCJSONWriter.EEmptyJson"),rtl.createClass(this,"EEmptyName",pas.SysUtils.Exception,(function(){this.Create$2=function(){return pas.SysUtils.Exception.Create$1.call(this,"Cannot write empty name"),this}}),"TTMSFNCJSONWriter.EEmptyName"),this.TTMSFNCJSONScope={0:"jscEmptyDocument",jscEmptyDocument:0,1:"jscEmptyArray",jscEmptyArray:1,2:"jscEmptyObject",jscEmptyObject:2,3:"jscNonEmptyDocument",jscNonEmptyDocument:3,4:"jscNonEmptyArray",jscNonEmptyArray:4,5:"jscNonEmptyObject",jscNonEmptyObject:5,6:"jscDanglingName",jscDanglingName:6},this.MaxStackSize=255,this.$init=function(){pas.System.TObject.$init.call(this),this.FWriter=null,this.FStack=rtl.arraySetLength(null,0,256),this.FStackSize=0,this.FIndent="",this.FSeparator="",this.FDeferredName=""},this.$final=function(){this.FWriter=void 0,this.FStack=void 0,pas.System.TObject.$final.call(this)},this.OpenItem=function(t,e){return this.BeforeValue(!0),this.PushScope(t),this.FWriter.Write(e),this,this},this.CloseItem=function(t,e,i){var s;if(!((s=this.PeekScope())in rtl.createSet(t,e)))throw this.EInvalidNesting.$create("Create$2");if(""!==this.FDeferredName)throw this.EMissingValue.$create("Create$2");return this.FStackSize-=1,s===e&&this.NewLine(),this.FWriter.Write(i),this,this},this.PushScope=function(t){if(this.FStackSize>255)throw this.ETooManyDepthLevels.$create("Create$2");this.FStack[this.FStackSize]=t,this.FStackSize+=1},this.PeekScope=function(){if(0===this.FStackSize)throw this.EEmptyJson.$create("Create$2");return this.FStack[this.FStackSize-1]},this.ReplaceTop=function(t){if(0===this.FStackSize)throw this.EEmptyJson.$create("Create$2");this.FStack[this.FStackSize-1]=t},this.WriteDeferredName=function(){""!==this.FDeferredName&&(this.BeforeName(),this.InternalWriteString(this.FDeferredName),this.FDeferredName="")},this.InternalWriteString=function(t){this.FWriter.Write('"'),this.FWriter.Write(pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.EscapeString(t)),this.FWriter.Write('"')},this.NewLine=function(){if(""!==this.FIndent){this.FWriter.Write("\r\n");for(var t=1,e=this.FStackSize-1;t<=e;t++)t,this.FWriter.Write(this.FIndent)}},this.BeforeName=function(){var t=this.PeekScope();if(5===t)this.FWriter.Write(",");else if(2!==t)throw this.ECannotWriteName.$create("Create$2");this.NewLine(),this.ReplaceTop(6)},this.BeforeValue=function(t){var e=this.PeekScope();if(3===e)throw this.EMultipleRootNotAllowed.$create("Create$2");if(0===e){if(!t)throw this.EObjectOrArrayExpected.$create("Create$2");this.ReplaceTop(3)}else if(1===e)this.ReplaceTop(4),this.NewLine();else if(4===e)this.FWriter.Write(","),this.NewLine();else{if(6!==e)throw this.EInvalidNesting.$create("Create$2");this.FWriter.Write(this.FSeparator),this.ReplaceTop(5)}},this.Create$1=function(e){return pas.System.TObject.Create.call(this),this.FWriter=t.TTMSFNCJSONStreamWriter.$create("Create$1",[e]),this.FSeparator=":",this.PushScope(0),this},this.Destroy=function(){rtl.free(this,"FWriter"),pas.System.TObject.Destroy.call(this)},this.WriteBeginArray=function(){return this.WriteDeferredName(),this.OpenItem(1,"[")},this.WriteEndArray=function(){return this.CloseItem(1,4,"]")},this.WriteBeginObject=function(){return this.WriteDeferredName(),this.OpenItem(2,"{")},this.WriteEndObject=function(){return this.CloseItem(2,5,"}")},this.WriteName=function(t){if(""===t)throw this.EEmptyName.$create("Create$2");if(""!==this.FDeferredName)throw this.EMissingValue.$create("Create$2");if(0===this.FStackSize)throw this.EEmptyJson.$create("Create$2");return this.FDeferredName=t,this,this},this.WriteString=function(t){return this.WriteDeferredName(),this.BeforeValue(!1),this.InternalWriteString(t),this,this},this.WriteBoolean=function(t){return this.WriteDeferredName(),this.BeforeValue(!1),t?this.FWriter.Write("true"):this.FWriter.Write("false"),this,this},this.WriteNull=function(){return this.WriteDeferredName(),this.BeforeValue(!1),this.FWriter.Write("null"),this,this},this.WriteDouble=function(t){return this.WriteDeferredName(),this.BeforeValue(!1),this.FWriter.Write(pas.SysUtils.FloatToStr(t)),this,this},this.WriteInteger=function(t){return this.WriteDeferredName(),this.BeforeValue(!1),this.FWriter.Write(pas.SysUtils.IntToStr(t)),this,this}}))}),["WEBLib.TMSFNCUtils"]),rtl.module("StrUtils",["System","SysUtils","Types"],(function(){"use strict";var t=this,e=t.$impl;this.AnsiMatchText=function(e,i){return-1!==t.AnsiIndexText(e,i)},this.AnsiIndexText=function(t,e){var i=0;if(-1,rtl.length(e)-1==-1||rtl.length(e)-1>2147483647)return-1;for(var s=0,o=rtl.length(e)-1;s<=o;s++)if(i=s,0===pas.SysUtils.CompareText(e[i],t))return i;return-1},this.MatchText=function(e,i){return t.AnsiMatchText(e,i)},this.AnsiStartsStr=function(t,e){return e.length>=t.length&&""!==t&&t===pas.System.Copy(e,1,t.length)},this.Soundex=function(t,i){var s="",o="",n="",r=0,a=0;if(s="",n="\0",t.length>0)for(s=pas.System.upcase(t.charAt(0)),r=2,a=t.length;r<=a&&s.length<i;)(o=e.SScore.charAt(t.charCodeAt(r-1)-1)).charCodeAt()in rtl.createSet(48,105,n.charCodeAt())||(s+=o),"i"!==o&&(n=o),r+=1;return(a=s.length)<i&&(s+=pas.System.StringOfChar("0",i-a)),s},this.SoundexSimilar=function(e,i,s){return t.Soundex(e,s)===t.Soundex(i,s)},this.SoundexSimilar$1=function(e,i){return t.SoundexSimilar(e,i,4)},this.SoundexProc=function(e,i){return t.SoundexSimilar$1(e,i)},this.AnsiResemblesProc=null,this.ResemblesProc=null,t.$implcode=function(){e.SScore="00000000000000000000000000000000000000000000000000000000000000000123012i02245501262301i2i20000000123012i02245501262301i2i20000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"},t.$init=function(){t.AnsiResemblesProc=t.SoundexProc,t.ResemblesProc=t.SoundexProc}}),["JS"]),rtl.module("WEBLib.TMSFNCPersistence",["System","Generics.Collections","Classes","TypInfo","SysUtils","WEBLib.TMSFNCTypes","WEBLib.TMSFNCJSONReader","WEBLib.TMSFNCJSONWriter","WEBLib.JSON"],(function(){"use strict";var t=this,e=t.$impl;rtl.createInterface(this,"ITMSFNCPersistence","{363F04AF-B8A7-4C47-A2D6-8ED9C44CEFF6}",["SaveSettingsToStream","CanSaveProperty","CanLoadProperty"],pas.System.IUnknown),rtl.createInterface(this,"ITMSFNCBaseListIO","{FAB1D21E-D798-4CE0-B17B-9D75E4456AB4}",["GetItemClass"],pas.System.IUnknown),rtl.createInterface(this,"ITMSFNCBasePersistenceIO","{91DEAFC3-8932-45F4-A3ED-5AAA0C0E9250}",["CreateObject"],pas.System.IUnknown),rtl.createInterface(this,"ITMSFNCBaseCollectionIO","{90FDF257-7362-411D-B7F6-E2BEE2265016}",["AddItem"],pas.System.IUnknown),rtl.createInterface(this,"ITMSFNCPersistenceIO","{11B625F8-447A-4AE5-BB88-5ECDEA979AF7}",["NeedsObjectReference","GetObjectReference","FixOwners"],this.ITMSFNCBasePersistenceIO),rtl.createClass(this,"ETMSFNCReaderException",pas.SysUtils.Exception,(function(){})),rtl.createClass(this,"TTMSFNCObjectDictionary",pas["Generics.Collections"].TDictionary$G3,(function(){})),rtl.createClass(this,"TTMSFNCObjectList",pas["Generics.Collections"].TObjectList$G1,(function(){})),rtl.createClass(this,"TTMSFNCStringList",pas["Generics.Collections"].TList$G4,(function(){})),rtl.createClass(this,"TTMSFNCIntegerList",pas["Generics.Collections"].TList$G5,(function(){})),rtl.createClass(this,"TTMSFNCDoubleList",pas["Generics.Collections"].TList$G6,(function(){})),rtl.createClass(this,"TTMSFNCWriter",pas.System.TObject,(function(){this.$init=function(){pas.System.TObject.$init.call(this),this.FWriter=null,this.FIOReference=null,this.FOnCustomWriteProperty=null,this.FRootObject=null,this.FOnCustomIsAssignableProperty=null},this.$final=function(){this.FWriter=void 0,this.FIOReference=void 0,this.FOnCustomWriteProperty=void 0,this.FRootObject=void 0,this.FOnCustomIsAssignableProperty=void 0,pas.System.TObject.$final.call(this)},this.SetRootObject=function(e){this.FRootObject=e,t.TTMSFNCPersistence.FRootObject=this.FRootObject},this.SetIOReference=function(e){this.FIOReference=e,t.TTMSFNCPersistence.FIOReference=this.FIOReference},this.WritePropInfoValue=function(i,s){var o,n,r,a,l="",h=pas.System.TMethod.$new(),F=0;if(t.TTMSFNCPersistence.IsWriteOnly(s))this.FWriter.WriteNull();else{a=i,r=s,n=t.TTMSFNCPersistence.GetPropInfoType(r),o=t.TTMSFNCPersistence.GetPropInfoName(r);var p=n;1===p?"TAlphaColor"===(l=t.TTMSFNCPersistence.GetPropInfoTypeName(r))||"TColor"===l||"TGraphicsColor"===l?-1===pas.TypInfo.GetOrdProp$1(a,r)?this.FWriter.WriteString("gcNull"):(F=pas.TypInfo.GetOrdProp$1(a,r),this.FWriter.WriteString(e.ColorToHTMLEx(F))):this.FWriter.WriteInteger(pas.TypInfo.GetOrdProp$1(a,r)):2===p||3===p?this.FWriter.WriteString(pas.TypInfo.GetStrProp$1(a,r)):4===p?t.TTMSFNCPersistence.GetPropInfoDataTypeInfo(r)===rtl.boolean?this.FWriter.WriteBoolean(0!=pas.TypInfo.GetOrdProp$1(a,r)):this.FWriter.WriteInteger(pas.TypInfo.GetOrdProp$1(a,r)):7===p?this.FWriter.WriteBoolean(pas.TypInfo.GetBoolProp$1(a,r)):p===pas.System.TTypeKind.tkDouble?this.FWriter.WriteDouble(pas.TypInfo.GetFloatProp$1(a,r)):5===p?this.FWriter.WriteInteger(pas.TypInfo.GetOrdProp$1(a,r)):9===p?(h.$assign(pas.TypInfo.GetMethodProp(a,r)),null===h.Code?this.FWriter.WriteNull():null!=t.TTMSFNCPersistence.FRootObject?this.FWriter.WriteString(t.TTMSFNCPersistence.FRootObject.$class.MethodName(h.Code)):this.FWriter.WriteNull()):(t.TTMSFNCPersistence.GetEnumName(pas.System.$rtti.TTypeKind,n),this.FWriter.WriteNull()),pas["WEBLib.Graphics"].TFont.isPrototypeOf(a)&&"Size"===o&&(this.FWriter.WriteName("IsFMX"),this.FWriter.WriteBoolean(!1))}},this.WriteProperties=function(t){var e=null,i=[],s=0;if(null!=t){e=t.$rtti;try{i=pas.TypInfo.GetPropList(e,pas.System.tkAny,!0);for(var o=0,n=rtl.length(i)-1;o<=n;o++)s=o,this.WriteProperty(t,i[s])}finally{}}},this.WriteProperty=function(e,i){var s="",o=0,n=!1,r=!1,a=!1,l=null,h=null;try{if(null==i)return;s=t.TTMSFNCPersistence.GetPropInfoName(i),o=t.TTMSFNCPersistence.GetPropInfoType(i),n=-1===pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.IndexOfTextInArray(s,t.TTMSFNCPersistence.FExcludeProperties),pas.SysUtils.Supports$3(e,t.ITMSFNCPersistence.$guid,{get:function(){return l},set:function(t){l=t}})&&(n=l.CanSaveProperty(e,s,o)),n&&(r=!0,null!=this.FOnCustomWriteProperty&&this.FOnCustomWriteProperty(e,s,o,this.FWriter,{get:function(){return r},set:function(t){r=t}}),r&&(this.FWriter.WriteName(s),o in rtl.createSet(13)?(h=pas.TypInfo.GetObjectProp(e,s),a=t.TTMSFNCPersistence.IsAssignableProperty(e,i),null!=this.FOnCustomIsAssignableProperty&&this.FOnCustomIsAssignableProperty(e,s,{get:function(){return a},set:function(t){a=t}}),a?pas.Classes.TComponent.isPrototypeOf(h)?this.FWriter.WriteString(rtl.as(h,pas.Classes.TComponent).FName):this.FWriter.WriteString(""):this.WriteObject(h)):this.WritePropInfoValue(e,i)))}finally{rtl._Release(l)}},this.WriteGenericObjectList=function(t){var e=0;this.FWriter.WriteBeginArray();for(var i=0,s=t.FLength-1;i<=s;i++)e=i,this.WriteSingleObject(t.GetItem(e));this.FWriter.WriteEndArray()},this.WriteGenericStringList=function(t){var e=0;this.FWriter.WriteBeginArray();for(var i=0,s=t.FLength-1;i<=s;i++)e=i,this.FWriter.WriteString(t.GetItem(e));this.FWriter.WriteEndArray()},this.WriteGenericIntegerList=function(t){var e=0;this.FWriter.WriteBeginArray();for(var i=0,s=t.FLength-1;i<=s;i++)e=i,this.FWriter.WriteInteger(t.GetItem(e));this.FWriter.WriteEndArray()},this.WriteGenericDoubleList=function(t){var e=0;this.FWriter.WriteBeginArray();for(var i=0,s=t.FLength-1;i<=s;i++)e=i,this.FWriter.WriteDouble(t.GetItem(e));this.FWriter.WriteEndArray()},this.WriteStrings=function(t){var e=0;this.FWriter.WriteBeginArray();for(var i=0,s=t.GetCount()-1;i<=s;i++)e=i,this.FWriter.WriteString(t.Get(e));this.FWriter.WriteEndArray()},this.WriteGenericDictionary=function(t){var e="";this.FWriter.WriteBeginArray();var i=t.GetKeys().GetEnumerator$1();try{for(;i.MoveNext$1();)e=i.GetCurrent(),this.FWriter.WriteBeginObject(),this.FWriter.WriteName(e),this.WriteSingleObject(t.GetItem(e)),this.FWriter.WriteEndObject()}finally{i=rtl.freeLoc(i)}this.FWriter.WriteEndArray()},this.WriteCollection=function(t){var e=0;this.FWriter.WriteBeginArray();for(var i=0,s=t.GetCount()-1;i<=s;i++)e=i,this.WriteSingleObject(t.GetItem(e));this.FWriter.WriteEndArray()},this.WriteList=function(t){var e=0;this.FWriter.WriteBeginArray();for(var i=0,s=t.GetCount()-1;i<=s;i++)e=i,this.WriteSingleObject(rtl.getObject(t.Get(e)));this.FWriter.WriteEndArray()},this.WriteBitmap=function(t){pas["WEBLib.TMSFNCTypes"].IsBitmapEmpty(t)?this.FWriter.WriteString(""):this.FWriter.WriteString(t.GetData())},this.WriteSingleObject=function(e){this.FWriter.WriteBeginObject(),""!==t.TTMSFNCPersistence.ClassTypeVariable&&(this.FWriter.WriteName(t.TTMSFNCPersistence.ClassTypeVariable),this.FWriter.WriteString(e.$classname)),this.WriteProperties(e),this.FWriter.WriteEndObject()},this.WriteObject=function(e){var i=null;try{null===e?this.FWriter.WriteNull():t.TTMSFNCPersistence.IsGenericList(e.$class.ClassType(),"String")?this.WriteGenericStringList(e):t.TTMSFNCPersistence.IsGenericList(e.$class.ClassType(),"Integer")?this.WriteGenericIntegerList(e):t.TTMSFNCPersistence.IsGenericList(e.$class.ClassType(),"Double")?this.WriteGenericDoubleList(e):t.TTMSFNCPersistence.IsGenericList(e.$class.ClassType(),"")?this.WriteGenericObjectList(e):t.TTMSFNCPersistence.IsGenericDictionary(e.$class.ClassType())?this.WriteGenericDictionary(e):t.TTMSFNCPersistence.IsList(e.$class.ClassType())?this.WriteList(e):t.TTMSFNCPersistence.IsCollection(e.$class.ClassType())?this.WriteCollection(e):t.TTMSFNCPersistence.IsBitmap(e.$class.ClassType())?this.WriteBitmap(e):t.TTMSFNCPersistence.IsDescendingClass(e.$class.ClassType(),["TStrings"])?this.WriteStrings(e):null!=this.FIOReference&&pas.SysUtils.Supports$3(this.FIOReference,t.ITMSFNCPersistenceIO.$guid,{get:function(){return i},set:function(t){i=t}})&&i.NeedsObjectReference(e.$class.ClassType())?this.FWriter.WriteString(i.GetObjectReference(e)):this.WriteSingleObject(e)}finally{rtl._Release(i)}},this.Create$1=function(t){return this.FWriter=pas["WEBLib.TMSFNCJSONWriter"].TTMSFNCJSONWriter.$create("Create$1",[t]),this},this.Destroy=function(){rtl.free(this,"FWriter"),pas.System.TObject.Destroy.call(this)},this.Write=function(t){this.WriteObject(t)}})),rtl.createClass(this,"TTMSFNCObjectReference",pas.System.TObject,(function(){this.$init=function(){pas.System.TObject.$init.call(this),this.Instance=null,this.Prop=null,this.Id=""},this.$final=function(){this.Instance=void 0,this.Prop=void 0,pas.System.TObject.$final.call(this)},this.Create$1=function(t,e,i){return this.Instance=t,this.Prop=e,this.Id=i,this}})),rtl.createClass(this,"TTMSFNCReader",pas.System.TObject,(function(){this.$init=function(){pas.System.TObject.$init.call(this),this.FReferences=null,this.FReader=null,this.FIOReference=null,this.FOnCustomReadProperty=null,this.FRootObject=null,this.FOnCustomIsAssignableProperty=null},this.$final=function(){this.FReferences=void 0,this.FReader=void 0,this.FIOReference=void 0,this.FOnCustomReadProperty=void 0,this.FRootObject=void 0,this.FOnCustomIsAssignableProperty=void 0,pas.System.TObject.$final.call(this)},this.ReadSingleObject=function(e){var i=null,s="",o=null,n=null;try{if(this.FReader.ReadBeginObject(),""!==t.TTMSFNCPersistence.ClassTypeVariable){if(!this.FReader.HasNext()||this.FReader.ReadName()!==t.TTMSFNCPersistence.ClassTypeVariable)throw t.ETMSFNCReaderException.$create("Create$1",['"'+t.TTMSFNCPersistence.ClassTypeVariable+'" property not found in Object descriptor.']);s=this.FReader.ReadString()}""===s&&(s=e.$classname),null!=this.FIOReference?(i=null,pas.SysUtils.Supports$3(this.FIOReference,t.ITMSFNCBasePersistenceIO.$guid,{get:function(){return o},set:function(t){o=t}})?i=o.CreateObject(s,e):pas.SysUtils.Supports$3(this.FIOReference,t.ITMSFNCPersistenceIO.$guid,{get:function(){return n},set:function(t){n=t}})&&(i=n.CreateObject(s,e))):i=t.TTMSFNCPersistence.CreateObject(s,e);try{this.ReadProperties(i),this.FReader.ReadEndObject()}catch(t){throw i=rtl.freeLoc(i),t}}finally{rtl._Release(o),rtl._Release(n)}return i},this.SetRootObject=function(e){this.FRootObject=e,t.TTMSFNCPersistence.FRootObject=this.FRootObject},this.SetIOReference=function(e){this.FIOReference=e,t.TTMSFNCPersistence.FIOReference=this.FIOReference},this.ReadSingleObject$1=function(e){if(this.FReader.ReadBeginObject(),""!==t.TTMSFNCPersistence.ClassTypeVariable){if(!this.FReader.HasNext()||this.FReader.ReadName()!==t.TTMSFNCPersistence.ClassTypeVariable)throw t.ETMSFNCReaderException.$create("Create$1",['"'+t.TTMSFNCPersistence.ClassTypeVariable+'" property not found in Object descriptor.']);this.FReader.ReadString()}try{this.ReadProperties(e),this.FReader.ReadEndObject()}catch(t){throw t}},this.ReadProperties=function(t){for(var e=null;this.FReader.HasNext();)this.FReader.IsNull()?this.FReader.SkipValue():(e=null,null!=t&&(e=pas.TypInfo.GetPropInfo$2(t,this.FReader.ReadName())),null!=e?this.ReadProperty(t,e):this.FReader.SkipValue())},this.ReadProperty=function(e,i){var s="",o=null,n=!1,r=null,a=null,l=0,h=!1,F=!1,p=null,c="";try{if(null==i)return;l=t.TTMSFNCPersistence.GetPropInfoType(i),s=t.TTMSFNCPersistence.GetPropInfoName(i),n=-1===pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.IndexOfTextInArray(s,t.TTMSFNCPersistence.FExcludeProperties),pas.SysUtils.Supports$3(e,t.ITMSFNCPersistence.$guid,{get:function(){return r},set:function(t){r=t}})&&(n=r.CanLoadProperty(e,s,l)),n?(h=!0,null!=this.FOnCustomReadProperty&&this.FOnCustomReadProperty(e,s,l,this.FReader,{get:function(){return h},set:function(t){h=t}}),h&&(l in rtl.createSet(13)?(o=t.TTMSFNCPersistence.GetPropInfoDataTypeInfoClassType(i),t.TTMSFNCPersistence.IsGenericList(o,"String")?this.ReadGenericStringList(pas.TypInfo.GetObjectProp(e,s)):t.TTMSFNCPersistence.IsGenericList(o,"")?this.ReadGenericObjectList(pas.TypInfo.GetObjectProp(e,s)):t.TTMSFNCPersistence.IsGenericDictionary(o)?this.ReadGenericDictionary(pas.TypInfo.GetObjectProp(e,s)):t.TTMSFNCPersistence.IsList(o)?this.ReadList(pas.TypInfo.GetObjectProp(e,s)):t.TTMSFNCPersistence.IsCollection(o)?this.ReadCollection(pas.TypInfo.GetObjectProp(e,s)):t.TTMSFNCPersistence.IsBitmap(o)?this.ReadBitmap(pas.TypInfo.GetObjectProp(e,s)):t.TTMSFNCPersistence.IsDescendingClass(o,["TStrings"])?this.ReadStrings(pas.TypInfo.GetObjectProp(e,s)):(h=!1,null!=this.FIOReference&&pas.SysUtils.Supports$3(this.FIOReference,t.ITMSFNCPersistenceIO.$guid,{get:function(){return a},set:function(t){a=t}})&&(h=a.NeedsObjectReference(o)),h?this.FReader.IsNull()?(this.FReader.ReadNull(),pas.TypInfo.SetObjectProp(e,s,null)):this.FReferences.Add(t.TTMSFNCObjectReference.$create("Create$1",[e,i,this.FReader.ReadString()])):(p=pas.TypInfo.GetObjectProp(e,s),F=t.TTMSFNCPersistence.IsAssignableProperty(e,i),null!=this.FOnCustomIsAssignableProperty&&this.FOnCustomIsAssignableProperty(e,s,{get:function(){return F},set:function(t){F=t}}),F?(c=this.FReader.ReadString(),null!=this.FRootObject&&pas.Classes.TComponent.isPrototypeOf(this.FRootObject)&&pas.TypInfo.SetObjectProp(e,s,rtl.as(this.FRootObject,pas.Classes.TComponent).FindComponent(c))):this.ReadExistingObject(p)))):this.ReadPropInfoValue(e,i))):this.FReader.SkipValue()}finally{rtl._Release(r),rtl._Release(a)}},this.ReadPropInfoValue=function(i,s){var o,n,r,a,l="",h="",F=0,p="",c=!1,u=0,C="",T=pas.System.TMethod.$new();if(t.TTMSFNCPersistence.IsWriteOnly(s)||this.FReader.IsNull())this.FReader.ReadNull();else{a=i,r=s,o=t.TTMSFNCPersistence.GetPropInfoName(r);var S=n=rtl.rc(t.TTMSFNCPersistence.GetPropInfoType(r),0,20);1===S?"TAlphaColor"===(l=t.TTMSFNCPersistence.GetPropInfoTypeName(r))||"TColor"===l||"TGraphicsColor"===l?(h=this.FReader.ReadString(),t.TTMSFNCPersistence.IsReadOnly(r)||("gcNull"===h?pas.TypInfo.SetOrdProp(a,o,-1):pas.TypInfo.SetOrdProp(a,o,e.HTMLToColorEx(h)))):(F=rtl.rc(this.FReader.ReadInteger(),-2147483648,2147483647),t.TTMSFNCPersistence.IsReadOnly(r)||pas.TypInfo.SetOrdProp$1(a,r,F)):2===S||3===S?(p=this.FReader.ReadString(),t.TTMSFNCPersistence.IsReadOnly(r)||pas.TypInfo.SetStrProp$1(a,r,p)):4===S?t.TTMSFNCPersistence.GetPropInfoDataTypeInfo(r)===rtl.boolean?(c=this.FReader.ReadBoolean(),t.TTMSFNCPersistence.IsReadOnly(r)||pas.TypInfo.SetOrdProp$1(a,r,c?1:0)):(F=rtl.rc(this.FReader.ReadInteger(),-2147483648,2147483647),t.TTMSFNCPersistence.IsReadOnly(r)||pas.TypInfo.SetOrdProp$1(a,r,F)):7===S?(c=this.FReader.ReadBoolean(),t.TTMSFNCPersistence.IsReadOnly(r)||pas.TypInfo.SetBoolProp$1(a,r,c)):S===pas.System.TTypeKind.tkDouble?(u=this.FReader.ReadDouble(),t.TTMSFNCPersistence.IsReadOnly(r)||pas.TypInfo.SetFloatProp$1(a,r,u)):5===S?(F=rtl.rc(this.FReader.ReadInteger(),-2147483648,2147483647),t.TTMSFNCPersistence.IsReadOnly(r)||pas.TypInfo.SetOrdProp$1(a,r,F)):9===S?(T.Data=null,T.Code=null,this.FReader.IsNull()?this.FReader.ReadNull():null!=t.TTMSFNCPersistence.FRootObject?(C=this.FReader.ReadString(),T.Code=t.TTMSFNCPersistence.FRootObject.$class.MethodAddress(C),null!==T.Code&&(T.Data=t.TTMSFNCPersistence.FRootObject)):this.FReader.ReadNull(),pas.TypInfo.SetMethodProp(a,r,T)):(t.TTMSFNCPersistence.GetEnumName(pas.System.$rtti.TTypeKind,n),this.FReader.ReadNull()),pas["WEBLib.Graphics"].TFont.isPrototypeOf(a)&&"Size"===o&&this.FReader.HasNext()&&"IsFMX"===(p=this.FReader.PeekName())&&(this.FReader.ReadName(),this.FReader.ReadBoolean()&&rtl.as(a,pas["WEBLib.Graphics"].TFont).SetSize(Math.round(rtl.as(a,pas["WEBLib.Graphics"].TFont).FSize/96*72)))}},this.ReadExistingObject=function(e){if(null!=e){if(this.FReader.ReadBeginObject(),""!==t.TTMSFNCPersistence.ClassTypeVariable){if(!this.FReader.HasNext()||this.FReader.ReadName()!==t.TTMSFNCPersistence.ClassTypeVariable)throw t.ETMSFNCReaderException.$create("Create$1",['"'+t.TTMSFNCPersistence.ClassTypeVariable+'" property not found in Object descriptor.']);this.FReader.ReadString()}this.ReadProperties(e),this.FReader.ReadEndObject()}else this.FReader.ReadNull()},this.ReadGenericStringList=function(t){var e="";for(t.Clear(),this.FReader.ReadBeginArray();this.FReader.HasNext();)this.FReader.IsNull()?this.FReader.SkipValue():(e=this.FReader.ReadString(),t.Add(e));this.FReader.ReadEndArray()},this.ReadGenericDoubleList=function(t){var e=0;for(t.Clear(),this.FReader.ReadBeginArray();this.FReader.HasNext();)this.FReader.IsNull()?this.FReader.SkipValue():(e=this.FReader.ReadDouble(),t.Add(e));this.FReader.ReadEndArray()},this.ReadGenericIntegerList=function(t){var e=0;for(t.Clear(),this.FReader.ReadBeginArray();this.FReader.HasNext();)this.FReader.IsNull()?this.FReader.SkipValue():(e=this.FReader.ReadInteger(),t.Add(e));this.FReader.ReadEndArray()},this.ReadStrings=function(t){var e="";for(t.Clear(),this.FReader.ReadBeginArray();this.FReader.HasNext();)this.FReader.IsNull()?this.FReader.SkipValue():(e=this.FReader.ReadString(),t.Add(e));this.FReader.ReadEndArray()},this.ReadGenericObjectList=function(e){var i=null,s=null,o=null,n=null,r=!1;try{if(o=pas.System.TObject,pas.SysUtils.Supports$3(e,t.ITMSFNCBaseListIO.$guid,{get:function(){return n},set:function(t){n=t}})&&(o=n.GetItemClass()),r=!1,this.FReader.ReadBeginArray(),this.FReader.HasNext())for(;this.FReader.HasNext();)this.FReader.IsNull()?this.FReader.SkipValue():null!=(i=this.ReadSingleObject(o))&&(r||(e.Clear(),r=!0),null!=this.FIOReference&&pas.SysUtils.Supports$3(this.FIOReference,t.ITMSFNCPersistenceIO.$guid,{get:function(){return s},set:function(t){s=t}})&&s.FixOwners(i,e),e.Add(i));else e.Clear();this.FReader.ReadEndArray()}finally{rtl._Release(n),rtl._Release(s)}},this.ReadGenericDictionary=function(e){var i=null,s="",o=null,n=null,r=!1;try{if(o=pas.System.TObject,pas.SysUtils.Supports$3(e,t.ITMSFNCBaseListIO.$guid,{get:function(){return n},set:function(t){n=t}})&&(o=n.GetItemClass()),r=!1,e.Clear(),this.FReader.ReadBeginArray(),this.FReader.HasNext())for(;this.FReader.HasNext();)this.FReader.IsNull()?this.FReader.SkipValue():(this.FReader.ReadBeginObject(),s=this.FReader.ReadName(),null!=(i=this.ReadSingleObject(o))&&(r||(e.Clear(),r=!0),e.Add(s,i)),this.FReader.ReadEndObject());else e.Clear();this.FReader.ReadEndArray()}finally{rtl._Release(n)}},this.ReadCollection=function(e){var i=null,s=null,o=null,n=null,r=!1;try{if(s=pas.System.TObject,pas.SysUtils.Supports$3(e,t.ITMSFNCBaseListIO.$guid,{get:function(){return o},set:function(t){o=t}})&&(s=o.GetItemClass()),pas.SysUtils.Supports$3(e,t.ITMSFNCBaseCollectionIO.$guid,{get:function(){return n},set:function(t){n=t}}),r=!1,this.FReader.ReadBeginArray(),this.FReader.HasNext()){for(;this.FReader.HasNext();)if(this.FReader.IsNull())this.FReader.SkipValue();else if(null!=(i=this.ReadSingleObject(s))){r||(e.Clear(),r=!0);try{pas.Classes.TPersistent.isPrototypeOf(i)&&(null!=n?n.AddItem(i).Assign(rtl.as(i,pas.Classes.TPersistent)):e.Add().Assign(rtl.as(i,pas.Classes.TPersistent)))}finally{i=rtl.freeLoc(i)}}}else e.Clear();this.FReader.ReadEndArray()}finally{rtl._Release(o),rtl._Release(n)}},this.ReadList=function(e){var i=null,s=null,o=null,n=null,r=!1;try{if(o=pas.System.TObject,pas.SysUtils.Supports$3(e,t.ITMSFNCBaseListIO.$guid,{get:function(){return n},set:function(t){n=t}})&&(o=n.GetItemClass()),r=!1,this.FReader.ReadBeginArray(),this.FReader.HasNext())for(;this.FReader.HasNext();)this.FReader.IsNull()?this.FReader.SkipValue():null!=(i=this.ReadSingleObject(o))&&(r||(e.Clear(),r=!0),null!=this.FIOReference&&pas.SysUtils.Supports$3(this.FIOReference,t.ITMSFNCPersistenceIO.$guid,{get:function(){return s},set:function(t){s=t}})&&s.FixOwners(i,e),e.Add(i));else e.Clear();this.FReader.ReadEndArray()}finally{rtl._Release(n),rtl._Release(s)}},this.ReadBitmap=function(t){var e;this.FReader.IsNull()||""!==(e=this.FReader.ReadString())&&t.SetData(e)},this.ReadObject=function(e){null===e?this.FReader.ReadNull():t.TTMSFNCPersistence.IsGenericList(e.$class.ClassType(),"String")?this.ReadGenericStringList(e):t.TTMSFNCPersistence.IsGenericList(e.$class.ClassType(),"Double")?this.ReadGenericDoubleList(e):t.TTMSFNCPersistence.IsGenericList(e.$class.ClassType(),"Integer")?this.ReadGenericIntegerList(e):t.TTMSFNCPersistence.IsGenericList(e.$class.ClassType(),"")?this.ReadGenericObjectList(e):t.TTMSFNCPersistence.IsGenericDictionary(e.$class.ClassType())?this.ReadGenericDictionary(e):t.TTMSFNCPersistence.IsList(e.$class.ClassType())?this.ReadList(e):t.TTMSFNCPersistence.IsCollection(e.$class.ClassType())?this.ReadCollection(e):t.TTMSFNCPersistence.IsBitmap(e.$class.ClassType())?this.ReadBitmap(e):t.TTMSFNCPersistence.IsDescendingClass(e.$class.ClassType(),["TStrings"])?this.ReadStrings(e):this.ReadSingleObject$1(e)},this.Create$1=function(t){return this.FReader=pas["WEBLib.TMSFNCJSONReader"].TTMSFNCJSONReader.$create("Create$1",[t]),this.FReferences=pas["Generics.Collections"].TObjectList$G2.$create("Create$4",[!0]),this},this.Destroy=function(){rtl.free(this,"FReader"),rtl.free(this,"FReferences"),pas.System.TObject.Destroy.call(this)},this.Read$1=function(t){this.ReadObject(t)}})),rtl.createClass(this,"TTMSFNCPersistence",pas.System.TObject,(function(){this.ClassTypeVariable="",this.FOnCustomReadProperty=null,this.FOnCustomWriteProperty=null,this.FRootObject=null,this.FExcludeProperties=[],this.FIOReference=null,this.DoCustomReadProperty=function(t,e,i,s,o){rtl.rc(i,0,20),null!=this.FOnCustomReadProperty&&this.FOnCustomReadProperty(t,e,i,s,o)},this.DoCustomWriteProperty=function(t,e,i,s,o){rtl.rc(i,0,20),null!=this.FOnCustomWriteProperty&&this.FOnCustomWriteProperty(t,e,i,s,o)},this.SaveSettingsToFile=function(t,e){var i=null;i=pas.Classes.TMemoryStream.$create("Create");try{this.SaveSettingsToStream(t,i),pas["WEBLib.TMSFNCTypes"].TTMSFNCMemoryStream.SaveToFile.call(i,e)}finally{i=rtl.freeLoc(i)}},this.SaveSettingsToStream=function(e,i){var s,o,n=null;n=t.TTMSFNCWriter.$create("Create$1",[i]),o=pas.SysUtils.FormatSettings.ThousandSeparator,s=pas.SysUtils.FormatSettings.DecimalSeparator;try{n.SetIOReference(t.TTMSFNCPersistence.FIOReference),n.SetRootObject(t.TTMSFNCPersistence.FRootObject),n.FOnCustomWriteProperty=rtl.createCallback(this,"DoCustomWriteProperty"),pas.SysUtils.FormatSettings.DecimalSeparator=".",pas.SysUtils.FormatSettings.ThousandSeparator=",",n.Write(e)}finally{pas.SysUtils.FormatSettings.DecimalSeparator=s,pas.SysUtils.FormatSettings.ThousandSeparator=o,n=rtl.freeLoc(n)}},this.LoadSettingsFromStream=function(e,i){var s,o,n=null;i.SetPosition(0),n=t.TTMSFNCReader.$create("Create$1",[i]),o=pas.SysUtils.FormatSettings.ThousandSeparator,s=pas.SysUtils.FormatSettings.DecimalSeparator;try{n.SetIOReference(t.TTMSFNCPersistence.FIOReference),n.SetRootObject(t.TTMSFNCPersistence.FRootObject),n.FOnCustomReadProperty=rtl.createCallback(this,"DoCustomReadProperty"),pas.SysUtils.FormatSettings.DecimalSeparator=".",pas.SysUtils.FormatSettings.ThousandSeparator=",",n.Read$1(e)}finally{pas.SysUtils.FormatSettings.DecimalSeparator=s,pas.SysUtils.FormatSettings.ThousandSeparator=o,n=rtl.freeLoc(n)}},this.CreateObject=function(e,i){var s=null,o=null;if(null===(o=pas.Classes.GetClass(e)))throw t.ETMSFNCReaderException.$create("CreateFmt",['Type "%s" not found',pas.System.VarRecs(18,e)]);if(!o.InheritsFrom(pas.System.TObject))throw t.ETMSFNCReaderException.$create("Create$1",['Type "%s" is not an class type']);if(null!==i&&!o.InheritsFrom(i))throw t.ETMSFNCReaderException.$create("CreateFmt",['Type "%s" does not inherit from %s',pas.System.VarRecs(18,e,18,i.$classname)]);if(o.InheritsFrom(pas["WEBLib.Controls"].TCustomControl))s=o.$create("Create$1",[null]);else if(o.InheritsFrom(pas.Classes.TComponent))s=o.$create("Create$1",[null]);else if(o.InheritsFrom(pas.Classes.TCollectionItem))s=o.$create("Create$1",[null]);else{if(!o.InheritsFrom(pas.Classes.TPersistent))throw t.ETMSFNCReaderException.$create("CreateFmt",['Type "%s" not supported',pas.System.VarRecs(18,e)]);s=o.$create("Create")}return s},this.GetPropInfoDataTypeInfo=function(t){var e=null;return e=null,null!=t&&(e=t.typeinfo),e},this.GetPropInfoDataTypeInfoClassType=function(t){var e=null;return null,null!=t&&null!=t.typeinfo&&(e=t.typeinfo).class?e.class.ClassType():null},this.GetPropInfoType=function(t){return null!=t.typeinfo?rtl.rc(t.typeinfo.kind,0,20):0},this.GetPropInfoName=function(t){return t.name},this.GetPropInfoTypeName=function(t){var e="";return e="",null!=t.typeinfo&&(e=t.typeinfo.name),e},this.GetEnumName=function(t,e){rtl.rc(e,-2147483648,2147483647);return t.enumtype[e]},this.IsWriteOnly=function(t){return""===t.getter},this.IsReadOnly=function(t){return""===t.setter},this.IsAssignableProperty=function(t,e){var i=!1,s=null,o="";return i=!1,rtl.rc(this.GetPropInfoType(e),0,20)in rtl.createSet(13)&&(o=this.GetPropInfoName(e),i=null!=(s=pas.TypInfo.GetObjectProp(t,o))&&this.IsComponent(s.$class.ClassType())||!(null!=s)),i},this.IsGenericList=function(t,e){var i="";if(null==t)return!1;do{if(i=t.$classname,(pas.StrUtils.AnsiStartsStr("TList<",i)||pas.StrUtils.AnsiStartsStr("TObjectList<",i))&&(""===e||""!==e&&pas.System.Pos(pas.SysUtils.LowerCase(e),pas.SysUtils.LowerCase(i))>0||pas.System.Pos(pas.SysUtils.LowerCase(e),pas.SysUtils.LowerCase(i))>0))return!0;t=t.$ancestor}while(null!=t);return!1,!1},this.IsGenericDictionary=function(t){var e="";if(null==t)return!1;do{if(e=t.$classname,pas.StrUtils.AnsiStartsStr("TDictionary<",e)||pas.StrUtils.AnsiStartsStr("TObjectDictionary<",e))return!0;t=t.$ancestor}while(null!=t);return!1,!1},this.IsCollection=function(t){return this.IsDescendingClass(t,["TCollection"])},this.IsComponent=function(t){return this.IsDescendingClass(t,["TComponent","TTMSFNCCustomComponent"])},this.IsList=function(t){return this.IsDescendingClass(t,["TList"])},this.IsDescendingClass=function(t,e){var i="",s=0;if(null==t)return!1;do{i=t.$classname;for(var o=0,n=rtl.length(e)-1;o<=n;o++)if(s=o,i===rtl.rcArrR(e,s))return!0;t=t.$ancestor}while(null!=t);return!1,!1},this.IsBitmap=function(t){return this.IsDescendingClass(t,["TBitmap","TPicture","TTMSFNCBitmap","TGraphic"])}})),this.ExcludePropertyList=["Align","AllowFocus","Anchors","BevelEdges","BevelInner","BevelKind","BevelOuter","BevelWidth","BiDiMode","BitmapContainer","BorderSpacing","CanParentFocus","ClipChildren","ClipParent","Constraints","Ctl3D","DisableFocusEffect","DoubleBuffered","DragCursor","DragKind","DragMode","Enabled","EnableDragHighLight","Height","Hint","HitTest","Locked","Margins","Name","Opacity","Padding","ParentBiDiMode","ParentColor","ParentCtl3D","ParentDoubleBuffered","ParentFont","ParentShowHint","PopupMenu","Position","RotationAngle","RotationCenter","Scale","ShowHint","Size","StyleElements","StyleName","TabOrder","TabStop","Tag","Touch","TouchTargetExpansion","Visible","Width"],t.$implcode=function(){e.gcNull=-1,e.GetColorRed=function(t){return t=pas["WEBLib.Graphics"].ColorToRGB(t),pas["WEBLib.Graphics"].GetRValue(t)},e.GetColorGreen=function(t){return t=pas["WEBLib.Graphics"].ColorToRGB(t),pas["WEBLib.Graphics"].GetGValue(t)},e.GetColorBlue=function(t){return t=pas["WEBLib.Graphics"].ColorToRGB(t),pas["WEBLib.Graphics"].GetBValue(t)},e.HTMLToColorEx=function(t){function e(t){return t.length<2?0:(1,2,((t.charAt(0)>="A"?t.charCodeAt(0)-65+10:t.charCodeAt(0)-48)<<4)+(t.charAt(1)>="A"?t.charCodeAt(1)-65+10:t.charCodeAt(1)-48))}var i,s;return i=e(pas.System.Copy(t,2,2)),s=e(pas.System.Copy(t,4,2))<<8,(e(pas.System.Copy(t,6,2))<<16)+s+i};var i=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F"];e.ColorToHTMLEx=function(t){var s,o="";return 1,s=pas["WEBLib.Graphics"].ColorToRGB(t),o="#RRGGBB",o=rtl.setCharAt(o,1,i[e.GetColorRed(s)>>>4]),o=rtl.setCharAt(o,2,i[15&e.GetColorRed(s)]),o=rtl.setCharAt(o,3,i[e.GetColorGreen(s)>>>4]),o=rtl.setCharAt(o,4,i[15&e.GetColorGreen(s)]),o=rtl.setCharAt(o,5,i[e.GetColorBlue(s)>>>4]),o=rtl.setCharAt(o,6,i[15&e.GetColorBlue(s)])},e.DummyDict=function(){var e=null,i=null,s=null,o="";e=t.TTMSFNCObjectDictionary.$create("Create$1",[0]),i=pas["Generics.Collections"].TDictionary$G3.$create("Create$1",[0]),s=pas["Generics.Collections"].TObjectDictionary$G1.$create("Create$1",[0]);try{var n=e.GetKeys().GetEnumerator$1();try{for(;n.MoveNext$1();)o=n.GetCurrent(),e.GetItem(o)}finally{n=rtl.freeLoc(n)}var r=i.GetKeys().GetEnumerator$1();try{for(;r.MoveNext$1();)o=r.GetCurrent(),e.GetItem(o)}finally{r=rtl.freeLoc(r)}var a=s.GetKeys().GetEnumerator$1();try{for(;a.MoveNext$1();)o=a.GetCurrent(),e.GetItem(o)}finally{a=rtl.freeLoc(a)}}finally{e=rtl.freeLoc(e),i=rtl.freeLoc(i),s=rtl.freeLoc(s)}}},t.$init=function(){t.TTMSFNCPersistence.ClassTypeVariable="$type",e.DummyDict()}}),["DateUtils","StrUtils","WEBLib.Controls","WEBLib.Graphics","Generics.Defaults","WEBLib.TMSFNCUtils"]),rtl.module("WEBLib.TMSFNCTypes",["System","Types","Classes","WEBLib.Graphics","SysUtils","WEBLib.Controls","Math","WEBLib.JSON"],(function(){"use strict";var t=this;rtl.createInterface(this,"ITMSFNCProductInfo","{C53329EA-7B3A-4507-AD9E-88ACD6A85054}",["GetVersion","GetDocURL","GetTipsURL"],pas.System.IUnknown),this.TTMSFNCBaseDocURL="https://download.tmssoftware.com/doc/",this.TTMSFNCBaseTipsURL="https://www.tmssoftware.com/site/tmsfnccore.asp?s=faq",this.ssCommand=2,this.TMSPlatformsDesktop=0,this.TMSPlatformsWeb=0,this.KEY_CONTROL=17,this.KEY_SHIFT=16,this.KEY_ESCAPE=27,this.KEY_INSERT=45,this.KEY_DELETE=46,this.KEY_TAB=9,this.KEY_SUBTRACT=109,this.KEY_ADD=107,this.KEY_MULTIPLY=106,this.KEY_DIVIDE=111,this.KEY_PRIOR=33,this.KEY_NEXT=34,this.KEY_UP=38,this.KEY_DOWN=40,this.KEY_RIGHT=39,this.KEY_LEFT=37,this.KEY_HOME=36,this.KEY_END=35,this.KEY_RETURN=13,this.KEY_SPACE=32,this.KEY_MENU=18,this.KEY_BACK=8,this.KEY_F2=113,this.KEY_F4=115,rtl.createHelper(this,"TTMSFNCMemoryStream",null,(function(){this.GetBytes=function(){var t,e,i=[];return e=this.GetPosition(),this.SetPosition(0),i=rtl.arraySetLength(i,0,this.GetSize()),this.Read$1(rtl.arrayRef(i),0,rtl.length(i)),t=rtl.arrayRef(i),this.SetPosition(e),t},this.SaveToFile=function(e){var i,s;if(i=e,s=rtl.arrayRef(t.TTMSFNCMemoryStream.GetBytes.call(this)),navigator.userAgent.toLowerCase().indexOf("electron/")>-1){var o=new Uint8Array(s);nfs.writeFileSync(i,o)}else{var n=new Blob([new Uint8Array(s)],{type:"octet/stream"});if(window.navigator&&window.navigator.msSaveOrOpenBlob)return void window.navigator.msSaveOrOpenBlob(n,i);const t=window.URL.createObjectURL(n);var r=document.createElement("a");r.href=t,r.download=i,document.body.appendChild(r),r.click(),setTimeout((function(){document.body.removeChild(r),window.URL.revokeObjectURL(t)}),100)}}})),rtl.recNewT(this,"TSizeF",(function(){this.cx=0,this.cy=0,this.$eq=function(t){return this.cx===t.cx&&this.cy===t.cy},this.$assign=function(t){return this.cx=t.cx,this.cy=t.cy,this}})),rtl.recNewT(this,"TPointF",(function(){this.X=0,this.Y=0,this.$eq=function(t){return this.X===t.X&&this.Y===t.Y},this.$assign=function(t){return this.X=t.X,this.Y=t.Y,this};var e=t.$rtti.$Record("TPointF",{});e.addField("X",rtl.double),e.addField("Y",rtl.double)})),rtl.recNewT(this,"TRectF",(function(){this.Left=0,this.Top=0,this.Right=0,this.Bottom=0,this.$eq=function(t){return this.Left===t.Left&&this.Top===t.Top&&this.Right===t.Right&&this.Bottom===t.Bottom},this.$assign=function(t){return this.Left=t.Left,this.Top=t.Top,this.Right=t.Right,this.Bottom=t.Bottom,this};var e=t.$rtti.$Record("TRectF",{});e.addField("Left",rtl.double),e.addField("Top",rtl.double),e.addField("Right",rtl.double),e.addField("Bottom",rtl.double)})),rtl.createClass(this,"TTMSFNCBitmap",pas["WEBLib.Graphics"].TBitmap,(function(){})),rtl.createHelper(this,"TTMSFNCObjectHelper",null,(function(){this.SaveToJSONFile=function(t){pas["WEBLib.TMSFNCPersistence"].TTMSFNCPersistence.SaveSettingsToFile(this,t)},this.SaveToJSONStream=function(t){pas["WEBLib.TMSFNCPersistence"].TTMSFNCPersistence.SaveSettingsToStream(this,t)},this.LoadFromJSONStream=function(t){pas["WEBLib.TMSFNCPersistence"].TTMSFNCPersistence.LoadSettingsFromStream(this,t)}})),rtl.createClass(this,"TTMSFNCMargins",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FRight=0,this.FBottom=0,this.FTop=0,this.FLeft=0,this.FOnChange=null},this.$final=function(){this.FOnChange=void 0,pas.Classes.TPersistent.$final.call(this)},this.SetBottom=function(t){this.FBottom!==t&&(this.FBottom=t,this.Changed())},this.SetLeft=function(t){this.FLeft!==t&&(this.FLeft=t,this.Changed())},this.SetRight=function(t){this.FRight!==t&&(this.FRight=t,this.Changed())},this.SetTop=function(t){this.FTop!==t&&(this.FTop=t,this.Changed())},this.IsLeftStored=function(){return 0!==this.FLeft},this.IsTopStored=function(){return 0!==this.FTop},this.IsRightStored=function(){return 0!==this.FRight},this.IsBottomStored=function(){return 0!==this.FBottom},this.Changed=function(){null!=this.FOnChange&&this.FOnChange(this)},this.Create$1=function(){return this.FLeft=0,this.FBottom=0,this.FRight=0,this.FTop=0,this},this.Assign=function(e){t.TTMSFNCMargins.isPrototypeOf(e)&&(this.FLeft=rtl.as(e,t.TTMSFNCMargins).FLeft,this.FTop=rtl.as(e,t.TTMSFNCMargins).FTop,this.FRight=rtl.as(e,t.TTMSFNCMargins).FRight,this.FBottom=rtl.as(e,t.TTMSFNCMargins).FBottom)},this.Empty=function(){var e=t.TRectF.$new();return e.$assign(t.RectF(this.FLeft,this.FTop,this.FRight,this.FBottom)),t.RectIsEmpty(e)},this.Rect=function(){var e=t.TRectF.$new();return e.$assign(t.RectF(this.FLeft,this.FTop,this.FRight,this.FBottom)),e};var e=this.$rtti;e.addProperty("Left",14,rtl.double,"FLeft","SetLeft",{stored:"IsLeftStored"}),e.addProperty("Top",14,rtl.double,"FTop","SetTop",{stored:"IsTopStored"}),e.addProperty("Right",14,rtl.double,"FRight","SetRight",{stored:"IsRightStored"}),e.addProperty("Bottom",14,rtl.double,"FBottom","SetBottom",{stored:"IsBottomStored"}),e.addProperty("OnChange",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnChange","FOnChange")})),rtl.createClass(this,"TTMSFNCPoint",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FY=0,this.FX=0,this.FOnChange=null},this.$final=function(){this.FOnChange=void 0,pas.Classes.TPersistent.$final.call(this)},this.SetX=function(t){this.FX!==t&&(this.FX=t,this.Changed())},this.SetY=function(t){this.FY!==t&&(this.FY=t,this.Changed())},this.IsXStored=function(){return 0!==this.FX},this.IsYStored=function(){return 0!==this.FY},this.Changed=function(){null!=this.FOnChange&&this.FOnChange(this)},this.Create$1=function(){return this.FX=0,this.FY=0,this},this.Assign=function(e){t.TTMSFNCPoint.isPrototypeOf(e)&&(this.FX=rtl.as(e,t.TTMSFNCPoint).FX,this.FY=rtl.as(e,t.TTMSFNCPoint).FY)};var e=this.$rtti;e.addProperty("X",14,rtl.double,"FX","SetX",{stored:"IsXStored"}),e.addProperty("Y",14,rtl.double,"FY","SetY",{stored:"IsYStored"}),e.addProperty("OnChange",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnChange","FOnChange")})),rtl.createClass(this,"TTMSFNCScaledBitmap",pas.Classes.TCollectionItem,(function(){this.$init=function(){pas.Classes.TCollectionItem.$init.call(this),this.FBitmap=null,this.FScale=0,this.FBitmapName=""},this.$final=function(){this.FBitmap=void 0,pas.Classes.TCollectionItem.$final.call(this)},this.IsScaleStored=function(){return 1!==this.FScale},this.SetBitmap=function(t){this.FBitmap!==t&&(this.FBitmap.Assign(t),this.Changed(!1))},this.SetScale=function(t){this.FScale!==t&&(this.FScale=t,this.Changed(!1))},this.SetBitmapName=function(t){this.FBitmapName!==t&&(this.FBitmapName=t,this.Changed(!1))},this.BitmapChanged=function(t){this.Changed(!1)},this.Create$1=function(e){return pas.Classes.TCollectionItem.Create$1.apply(this,arguments),this.FBitmap=t.TTMSFNCBitmap.$create("Create$3"),this.FBitmap.FOnChange=rtl.createCallback(this,"BitmapChanged"),this.FScale=1,this},this.Destroy=function(){rtl.free(this,"FBitmap"),pas.Classes.TCollectionItem.Destroy.call(this)},this.Assign=function(e){t.TTMSFNCScaledBitmap.isPrototypeOf(e)&&(this.FBitmap.Assign(rtl.as(e,t.TTMSFNCScaledBitmap).FBitmap),this.FBitmapName=rtl.as(e,t.TTMSFNCScaledBitmap).FBitmapName,this.FScale=rtl.as(e,t.TTMSFNCScaledBitmap).FScale)};var e=this.$rtti;e.addProperty("Bitmap",2,t.$rtti.TTMSFNCBitmap,"FBitmap","SetBitmap"),e.addProperty("BitmapName",2,rtl.string,"FBitmapName","SetBitmapName"),e.addProperty("Scale",14,rtl.double,"FScale","SetScale",{stored:"IsScaleStored"})})),rtl.createClass(this,"TTMSFNCScaledBitmaps",pas.Classes.TOwnedCollection,(function(){this.$init=function(){pas.Classes.TOwnedCollection.$init.call(this),this.FOnChange=null},this.$final=function(){this.FOnChange=void 0,pas.Classes.TOwnedCollection.$final.call(this)},this.GetItems=function(t){return this.GetItem(t)},this.Update=function(t){pas.Classes.TCollection.Update.apply(this,arguments),null!=this.FOnChange&&this.FOnChange(this)},this.Create$3=function(e){return pas.Classes.TOwnedCollection.Create$2.call(this,e,t.TTMSFNCScaledBitmap),this},this.Add$1=function(t){var e=null;return(e=pas.Classes.TCollection.Add.call(this)).SetScale(t),e},this.AddBitmapFromResource=function(t,e){return this.AddBitmapFromResource$1(t,0,e)},this.AddBitmapFromResource$1=function(t,e,i){var s=null;return(s=this.Add$1(i)).FBitmap.LoadFromResource$1(t,e),s},this.AddBitmap=function(t,e){var i=null;return(i=this.Add$1(e)).FBitmap.Assign(t),i},this.AddBitmapName=function(t,e){var i=null;return(i=this.Add$1(e)).SetBitmapName(t),i},this.AddDrawBitmap=function(t,e){var i=null;return(i=this.Add$1(e)).FBitmap.Assign(t),i},this.GetItemByScale=function(t){var e=null,i=0,s=null,o=null,n=0;e=null,s=null,n=0;for(var r=0,a=this.GetCount()-1;r<=a;r++){if(i=r,(o=this.GetItems(i)).FScale===t){e=o;break}o.FScale!==t&&o.FScale>n&&(s=o,n=o.FScale)}return null===e&&(e=s),e}})),rtl.createInterface(this,"ITMSFNCCustomEditor","{CC0C60B7-75F3-47CE-8A7F-8005A19F12E8}",["SetText","SetSelStart","SetSelLength","GetTextLength"],pas.System.IUnknown),rtl.createClass(this,"TTMSFNCOwnedCollection",pas.Classes.TOwnedCollection,(function(){})),rtl.createClass(this,"TTMSFNCPersistent",pas.Classes.TPersistent,(function(){})),this.InflateRectEx=function(t,e,i){t.Left=t.Left-e,t.Right=t.Right+e,t.Top=t.Top-i,t.Bottom=t.Bottom+i},this.ConvertToRectF=function(e){var i=t.TRectF.$new();return i.Left=e.Left,i.Top=e.Top,i.Right=e.Right,i.Bottom=e.Bottom,i},this.ConvertToRect=function(t){var e=pas.Types.TRect.$new();return e.Left=Math.round(t.Left),e.Top=Math.round(t.Top),e.Right=Math.round(t.Right),e.Bottom=Math.round(t.Bottom),e},this.OffsetRectEx$1=function(t,e,i){return t.Left=t.Left+e,t.Right=t.Right+e,t.Top=t.Top+i,t.Bottom=t.Bottom+i,!0,!0},this.PtInRectEx=function(t,e){return e.X>=t.Left&&e.X<t.Right&&e.Y>=t.Top&&e.Y<t.Bottom},this.IntersectRectEx=function(t,e){return t.Left<e.Right&&t.Right>e.Left&&t.Top<e.Bottom&&t.Bottom>e.Top},this.IntersectRectEx$1=function(e,i,s){var o,n=t.TRectF.$new();return n.$assign(i),s.Left>i.Left&&(n.Left=s.Left),s.Top>i.Top&&(n.Top=s.Top),s.Right<i.Right&&(n.Right=s.Right),s.Bottom<i.Bottom&&(n.Bottom=s.Bottom),(o=!t.RectIsEmpty(n))||(n.Top=0,n.Bottom=0,n.Left=0,n.Right=0),e.$assign(n),o},this.EqualRectEx=function(t,e){return t.Left===e.Left&&t.Right===e.Right&&t.Top===e.Top&&t.Bottom===e.Bottom},this.RectWidthEx$1=function(t){return t.Right-t.Left},this.RectHeightEx$1=function(t){return t.Bottom-t.Top},this.RectCenterEx$1=function(e,i){var s=t.TRectF.$new();return t.OffsetRectEx$1(e,-e.Left,-e.Top),t.OffsetRectEx$1(e,Math.round((t.RectWidthEx$1(i)-t.RectWidthEx$1(e))/2),Math.round((t.RectHeightEx$1(i)-t.RectHeightEx$1(e))/2)),t.OffsetRectEx$1(e,i.Left,i.Top),s.$assign(e),s},this.RectCenterAtEx=function(e,i){var s=t.TRectF.$new();return s.$assign(e),t.RectCenterEx$1(s,i),s},this.RectSnapToPixelEx=function(e,i,s){var o=t.TRectF.$new(),n=0,r=0;return n=i<=0?1:i,o.Left=pas.System.Trunc(e.Left*n)/n,o.Top=pas.System.Trunc(e.Top*n)/n,o.Right=o.Left+Math.round((e.Right-e.Left)*n)/n,o.Bottom=o.Top+Math.round((e.Bottom-e.Top)*n)/n,s&&(r=1/(2*n),t.OffsetRectEx$1(o,r,r)),o},this.RectFitIntoEx=function(e,i,s){var o=t.TRectF.$new();return i.Right-i.Left<=0||i.Bottom-i.Top<=0?(s.set(1),e):((e.Right-e.Left)/(i.Right-i.Left)>(e.Bottom-e.Top)/(i.Bottom-i.Top)?s.set((e.Right-e.Left)/(i.Right-i.Left)):s.set((e.Bottom-e.Top)/(i.Bottom-i.Top)),o.$assign(t.RectF(0,0,(e.Right-e.Left)/s.get(),(e.Bottom-e.Top)/s.get())),t.RectCenterEx$1(o,i),o)},this.RectFitIntoEx$1=function(e,i){var s=t.TRectF.$new(),o=0;return s.$assign(t.RectFitIntoEx(e,i,{get:function(){return o},set:function(t){o=t}})),s},this.GetPointLength=function(t){return Math.sqrt(pas.System.Sqr$1(t.X)+pas.System.Sqr$1(t.Y))},this.MakeRectF=function(e,i,s,o){var n=t.TRectF.$new();return n.Left=e,n.Top=i,n.Right=e+s,n.Bottom=i+o,n},this.CenterPointEx=function(e){var i=t.TPointF.$new();return i.X=(e.Right-e.Left)/2+e.Left,i.Y=(e.Bottom-e.Top)/2+e.Top,i},this.CompareValueEx=function(t,e,i){return pas.Math.SameValue(t,e,i)?0:t<e?-1:1},this.RectIsEmpty=function(t){return t.Right<t.Left||pas.Math.SameValue(t.Right,t.Left,0)||t.Bottom<t.Top||pas.Math.SameValue(t.Bottom,t.Top,0)},this.EmptyRect=function(){var e=t.TRectF.$new();return e.$assign(t.RectF(0,0,0,0)),e},this.RectIntersectsWithEx=function(t,e){return t.Left<e.Right&&t.Right>e.Left&&t.Top<e.Bottom&&t.Bottom>e.Top},this.RectF=function(e,i,s,o){var n=t.TRectF.$new();return n.Left=e,n.Top=i,n.Bottom=o,n.Right=s,n},this.PointF=function(e,i){var s=t.TPointF.$new();return s.X=e,s.Y=i,s},this.BitmapToDrawBitmap=function(t){var e=null;return e=null,null!=t&&(e=t),e},this.IsBitmapEmpty=function(e){var i=!1,s=null;return i=!0,null!=e&&null!=(s=t.BitmapToDrawBitmap(e))&&(i=s.Empty()),i},this.CharInArray=function(t,e){var i=!1;i=!1;for(var s=0,o=rtl.length(e)-1;s<=o;s++)if(e[s]===t)return i=!0;return i},this.CharIsNumber=function(t){return t.charCodeAt()in rtl.createSet(null,48,57)},this.CharIsLetter=function(t){return t.charCodeAt()in rtl.createSet(null,97,122)||t.charCodeAt()in rtl.createSet(null,65,90)},this.CharIsHex=function(t){return t.charCodeAt()in rtl.createSet(null,48,57)||t.charCodeAt()in rtl.createSet(null,97,102)||t.charCodeAt()in rtl.createSet(null,65,70)},this.CharIsLetterOrNumber=function(e){return t.CharIsLetter(e)||t.CharIsNumber(e)},this.VarToStr=function(t){return t},this.VarToDateTime=function(t){return pas.SysUtils.StrToDateTime(t)},this.AnsiUpperCase=function(t){return pas.SysUtils.UpperCase(t)},this.AnsiLowerCase=function(t){return pas.SysUtils.LowerCase(t)},this.HInstance=function(){return 0,0}}),["WEBLib.TMSFNCUtils","WEBLib.TMSFNCPersistence","JS"]),rtl.module("WEBLib.TMSFNCGraphicsTypes",["System","Classes","Types","WEBLib.TMSFNCTypes","WEBLib.Graphics"],(function(){"use strict";var t=this,e=t.$impl;this.PathPosition=.001,this.gcAliceblue=16775408,this.gcAntiquewhite=14150650,this.gcAqua=16776960,this.gcAquamarine=13959039,this.gcAzure=16777200,this.gcBeige=14480885,this.gcBisque=12903679,this.gcBlack=0,this.gcBlanchedalmond=13495295,this.gcBlue=16711680,this.gcBlueviolet=14822282,this.gcBrown=2763429,this.gcBurlywood=8894686,this.gcCadetblue=10526303,this.gcChartreuse=65407,this.gcChocolate=1993170,this.gcCoral=5275647,this.gcCornflowerblue=15570276,this.gcCornsilk=14481663,this.gcCrimson=3937500,this.gcCyan=16776960,this.gcDarkblue=9109504,this.gcDarkcyan=9145088,this.gcDarkgoldenrod=755384,this.gcDarkgray=11119017,this.gcDarkgreen=25600,this.gcDarkgrey=11119017,this.gcDarkkhaki=7059389,this.gcDarkmagenta=9109643,this.gcDarkolivegreen=3107669,this.gcDarkorange=36095,this.gcDarkorchid=13382297,this.gcDarkred=139,this.gcDarksalmon=8034025,this.gcDarkseagreen=9419919,this.gcDarkslateblue=9125192,this.gcDarkslategray=5197615,this.gcDarkslategrey=5197615,this.gcDarkturquoise=13749760,this.gcDarkviolet=13828244,this.gcDeeppink=9639167,this.gcDeepskyblue=16760576,this.gcDimgray=6908265,this.gcDimgrey=6908265,this.gcDodgerblue=16748574,this.gcFirebrick=2237106,this.gcFloralwhite=15792895,this.gcForestgreen=2263842,this.gcFuchsia=16711935,this.gcGainsboro=14474460,this.gcGhostwhite=16775416,this.gcGold=55295,this.gcGoldenrod=2139610,this.gcGray=8421504,this.gcGreen=32768,this.gcGreenyellow=3145645,this.gcGrey=8421504,this.gcHoneydew=15794160,this.gcHotpink=11823615,this.gcIndianred=6053069,this.gcIndigo=8519755,this.gcIvory=15794175,this.gcKhaki=9234160,this.gcLavender=16443110,this.gcLavenderblush=16118015,this.gcLawngreen=64636,this.gcLemonchiffon=13499135,this.gcLightblue=15128749,this.gcLightcoral=8421616,this.gcLightcyan=16777184,this.gcLightgoldenrodyellow=13826810,this.gcLightgray=13882323,this.gcLightgreen=9498256,this.gcLightgrey=13882323,this.gcLightpink=12695295,this.gcLightsalmon=8036607,this.gcLightseagreen=11186720,this.gcLightskyblue=16436871,this.gcLightslategray=10061943,this.gcLightslategrey=10061943,this.gcLightsteelblue=14599344,this.gcLightyellow=14745599,this.gcMedGray=10789024,this.gcLime=65280,this.gcLimegreen=3329330,this.gcLinen=15134970,this.gcMagenta=16711935,this.gcMaroon=128,this.gcMediumaquamarine=11193702,this.gcMediumblue=13434880,this.gcMediumorchid=13850042,this.gcMediumpurple=14381203,this.gcMediumseagreen=7451452,this.gcMediumslateblue=15624315,this.gcMediumspringgreen=10156544,this.gcMediumturquoise=13422920,this.gcMediumvioletred=8721863,this.gcMidnightblue=7346457,this.gcMintcream=16449525,this.gcMistyrose=14804223,this.gcMoccasin=11920639,this.gcNavajowhite=11394815,this.gcNavy=8388608,this.gcOldlace=15136253,this.gcOlive=32896,this.gcOlivedrab=2330219,this.gcOrange=42495,this.gcOrangered=17919,this.gcOrchid=14053594,this.gcPalegoldenrod=11200750,this.gcPalegreen=10025880,this.gcPaleturquoise=15658671,this.gcPalevioletred=9662683,this.gcPapayawhip=14020607,this.gcPeachpuff=12180223,this.gcPeru=4163021,this.gcPink=13353215,this.gcPlum=14524637,this.gcPowderblue=15130800,this.gcPurple=8388736,this.gcRed=255,this.gcRosybrown=9408444,this.gcRoyalblue=14772545,this.gcSaddlebrown=1262987,this.gcSalmon=7504122,this.gcSandybrown=6333684,this.gcSeagreen=5737262,this.gcSeashell=15660543,this.gcSienna=2970272,this.gcSilver=12632256,this.gcSkyblue=15453831,this.gcSlateblue=13458026,this.gcSlategray=9470064,this.gcSlategrey=9470064,this.gcSnow=16448255,this.gcSpringgreen=8388352,this.gcSteelblue=11829830,this.gcTan=9221330,this.gcTeal=8421376,this.gcThistle=14204888,this.gcTomato=4678655,this.gcTurquoise=13688896,this.gcViolet=15631086,this.gcWheat=11788021,this.gcWhite=16777215,this.gcWhitesmoke=16119285,this.gcYellow=65535,this.gcYellowgreen=3329434,this.gcNull=-1,this.TTMSFNCGraphicsStrokeKind={0:"gskNone",gskNone:0,1:"gskSolid",gskSolid:1,2:"gskDash",gskDash:2,3:"gskDot",gskDot:3,4:"gskDashDot",gskDashDot:4,5:"gskDashDotDot",gskDashDotDot:5},this.$rtti.$Enum("TTMSFNCGraphicsStrokeKind",{minvalue:0,maxvalue:5,ordtype:1,enumtype:this.TTMSFNCGraphicsStrokeKind}),this.TTMSFNCGraphicsTextureMode={0:"gtmOriginal",gtmOriginal:0,1:"gtmFit",gtmFit:1,2:"gtmStretch",gtmStretch:2,3:"gtmCenter",gtmCenter:3,4:"gtmTile",gtmTile:4},this.$rtti.$Enum("TTMSFNCGraphicsTextureMode",{minvalue:0,maxvalue:4,ordtype:1,enumtype:this.TTMSFNCGraphicsTextureMode}),this.TTMSFNCGraphicsFillKind={0:"gfkNone",gfkNone:0,1:"gfkSolid",gfkSolid:1,2:"gfkGradient",gfkGradient:2,3:"gfkTexture",gfkTexture:3},this.$rtti.$Enum("TTMSFNCGraphicsFillKind",{minvalue:0,maxvalue:3,ordtype:1,enumtype:this.TTMSFNCGraphicsFillKind}),this.TTMSFNCGraphicsFillGradientMode={0:"gfgmDefault",gfgmDefault:0,1:"gfgmCollection",gfgmCollection:1},this.TTMSFNCGraphicsFillGradientType={0:"gfgtLinear",gfgtLinear:0,1:"gfgtRadial",gfgtRadial:1},this.TTMSFNCGraphicsFillOrientation={0:"gfoHorizontal",gfoHorizontal:0,1:"gfoVertical",gfoVertical:1,2:"gfoCustom",gfoCustom:2},this.$rtti.$Enum("TTMSFNCGraphicsFillOrientation",{minvalue:0,maxvalue:2,ordtype:1,enumtype:this.TTMSFNCGraphicsFillOrientation}),this.TTMSFNCGraphicsTextAlign={0:"gtaCenter",gtaCenter:0,1:"gtaLeading",gtaLeading:1,2:"gtaTrailing",gtaTrailing:2},this.$rtti.$Enum("TTMSFNCGraphicsTextAlign",{minvalue:0,maxvalue:2,ordtype:1,enumtype:this.TTMSFNCGraphicsTextAlign}),this.TTMSFNCGraphicsTextTrimming={0:"gttNone",gttNone:0,1:"gttCharacter",gttCharacter:1,2:"gttWord",gttWord:2},this.$rtti.$Enum("TTMSFNCGraphicsTextTrimming",{minvalue:0,maxvalue:2,ordtype:1,enumtype:this.TTMSFNCGraphicsTextTrimming}),this.TTMSFNCGraphicsSide={0:"gsLeft",gsLeft:0,1:"gsTop",gsTop:1,2:"gsRight",gsRight:2,3:"gsBottom",gsBottom:3},this.$rtti.$Enum("TTMSFNCGraphicsSide",{minvalue:0,maxvalue:3,ordtype:1,enumtype:this.TTMSFNCGraphicsSide}),this.$rtti.$Set("TTMSFNCGraphicsSides",{comptype:this.$rtti.TTMSFNCGraphicsSide}),this.TTMSFNCGraphicsTextQuality={0:"gtqDefault",gtqDefault:0,1:"gtqAntiAliasing",gtqAntiAliasing:1,2:"gtqClearType",gtqClearType:2},this.AllSides=rtl.createSet(0,1,2,3),rtl.recNewT(this,"TTMSFNCGraphicsMatrix",(function(){this.m11=0,this.m12=0,this.m13=0,this.m21=0,this.m22=0,this.m23=0,this.m31=0,this.m32=0,this.m33=0,this.$eq=function(t){return this.m11===t.m11&&this.m12===t.m12&&this.m13===t.m13&&this.m21===t.m21&&this.m22===t.m22&&this.m23===t.m23&&this.m31===t.m31&&this.m32===t.m32&&this.m33===t.m33},this.$assign=function(t){return this.m11=t.m11,this.m12=t.m12,this.m13=t.m13,this.m21=t.m21,this.m22=t.m22,this.m23=t.m23,this.m31=t.m31,this.m32=t.m32,this.m33=t.m33,this}})),this.$rtti.$Class("TTMSFNCGraphicsStroke"),this.$rtti.$Class("TTMSFNCGraphicsFill"),this.$rtti.$Class("TTMSFNCGraphicsFont"),rtl.createClass(this,"TTMSFNCGraphicsSaveState",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FSaveDC=0,this.FFont=null,this.FStroke=null,this.FFill=null},this.$final=function(){this.FFont=void 0,this.FStroke=void 0,this.FFill=void 0,pas.Classes.TPersistent.$final.call(this)},this.Create$1=function(){return pas.System.TObject.Create.call(this),this.FFill=t.TTMSFNCGraphicsFill.$create("Create$1",[1,16777215,8421504,-1,-1]),this.FStroke=t.TTMSFNCGraphicsStroke.$create("Create$1",[1,12632256]),this.FFont=t.TTMSFNCGraphicsFont.$create("Create$2"),this},this.Destroy=function(){rtl.free(this,"FFill"),rtl.free(this,"FStroke"),rtl.free(this,"FFont"),pas.System.TObject.Destroy.call(this)}})),rtl.createClass(this,"TTMSFNCGraphicsFillGradientItem",pas.Classes.TCollectionItem,(function(){this.$init=function(){pas.Classes.TCollectionItem.$init.call(this),this.FColor=0,this.FPosition=0,this.FOpacity=0},this.IsPositionStored=function(){return 0!==this.FPosition},this.SetColor=function(t){this.FColor!==t&&(this.FColor=t,this.UpdateGradient())},this.SetPosition=function(t){this.FPosition!==t&&(this.FPosition=t,this.UpdateGradient())},this.IsOpacityStored=function(){return 1!==this.FOpacity},this.SetOpacity=function(t){this.FOpacity!==t&&(this.FOpacity=t,this.UpdateGradient())},this.UpdateGradient=function(){t.TTMSFNCGraphicsFillGradientItems.isPrototypeOf(this.FCollection)&&rtl.as(this.FCollection,t.TTMSFNCGraphicsFillGradientItems).UpdateGradient()},this.Create$1=function(t){return pas.Classes.TCollectionItem.Create$1.apply(this,arguments),this.FColor=16777215,this.FPosition=0,this.FOpacity=1,this},this.Assign=function(e){t.TTMSFNCGraphicsFillGradientItem.isPrototypeOf(e)?(this.FColor=rtl.as(e,t.TTMSFNCGraphicsFillGradientItem).FColor,this.FOpacity=rtl.as(e,t.TTMSFNCGraphicsFillGradientItem).FOpacity,this.FPosition=rtl.as(e,t.TTMSFNCGraphicsFillGradientItem).FPosition):pas.Classes.TPersistent.Assign.apply(this,arguments)};var e=this.$rtti;e.addProperty("Opacity",14,rtl.double,"FOpacity","SetOpacity",{stored:"IsOpacityStored"}),e.addProperty("Color",2,pas["WEBLib.Graphics"].$rtti.TColor,"FColor","SetColor",{Default:16777215}),e.addProperty("Position",14,rtl.double,"FPosition","SetPosition",{stored:"IsPositionStored"})})),rtl.createClass(this,"TTMSFNCGraphicsFillGradientItems",pas["WEBLib.TMSFNCTypes"].TTMSFNCOwnedCollection,(function(){this.$init=function(){pas["WEBLib.TMSFNCTypes"].TTMSFNCOwnedCollection.$init.call(this),this.FOwner$1=null},this.$final=function(){this.FOwner$1=void 0,pas["WEBLib.TMSFNCTypes"].TTMSFNCOwnedCollection.$final.call(this)},this.UpdateGradient=function(){null!=this.FOwner$1&&this.FOwner$1.Changed()},this.GetGradientClass=function(){return t.TTMSFNCGraphicsFillGradientItem},this.Create$3=function(t){return pas.Classes.TOwnedCollection.Create$2.call(this,t,this.GetGradientClass()),this.FOwner$1=t,this}})),rtl.createClass(this,"TTMSFNCCustomGraphicsFill",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FUpdateCount=0,this.FOnChanged=null,this.FOrientation=0,this.FKind=0,this.FDefaultKind=0,this.FColor=0,this.FDefaultColor=0,this.FColorTo=0,this.FColorMirror=0,this.FColorMirrorTo=0,this.FDefaultColorTo=0,this.FDefaultColorMirror=0,this.FDefaultColorMirrorTo=0,this.FOpacity=0,this.FTexture=null,this.FTextureMode=0,this.FGradientMode=0,this.FGradientItems=null,this.FGradientType=0,this.FGradientAngle=0,this.FGradientCenterPoint=pas["WEBLib.TMSFNCTypes"].TPointF.$new(),this.FGradientCenterColor=0,this.FGradientMatrix=t.TTMSFNCGraphicsMatrix.$new()},this.$final=function(){this.FOnChanged=void 0,this.FTexture=void 0,this.FGradientItems=void 0,this.FGradientCenterPoint=void 0,this.FGradientMatrix=void 0,pas.Classes.TPersistent.$final.call(this)},this.SetKind=function(t){this.FKind!==t&&(this.FKind=t,this.Changed())},this.SetOrientation=function(t){this.FOrientation!==t&&(this.FOrientation=t,this.Changed())},this.SetColor=function(t){this.FColor!==t&&(this.FColor=t,-1===this.FColor?this.FColor=-1:536870912===this.FColor&&(this.FColor=15790320),this.Changed())},this.SetColorTo=function(t){this.FColorTo!==t&&(this.FColorTo=t,-1===this.FColorTo?this.FColorTo=-1:536870912===this.FColorTo&&(this.FColorTo=15790320),this.Changed())},this.SetColorMirror=function(t){this.FColorMirror!==t&&(this.FColorMirror=t,-1===this.FColorMirror?this.FColorMirror=-1:536870912===this.FColorMirror&&(this.FColorMirror=15790320),this.Changed())},this.SetColorMirrorTo=function(t){this.FColorMirrorTo!==t&&(this.FColorMirrorTo=t,-1===this.FColorMirrorTo?this.FColorMirrorTo=-1:536870912===this.FColorMirrorTo&&(this.FColorMirrorTo=15790320),this.Changed())},this.SetTexture=function(t){this.FTexture!==t&&(this.FTexture.Assign(t),this.Changed())},this.SetTextureMode=function(t){this.FTextureMode!==t&&(this.FTextureMode=t,this.Changed())},this.IsColorStored=function(){return this.FColor!==this.FDefaultColor},this.IsKindStored=function(){return this.FKind!==this.FDefaultKind},this.IsColorMirrorStored=function(){return this.FColorMirror!==this.FDefaultColorMirror},this.IsColorMirrorToStored=function(){return this.FColorMirrorTo!==this.FDefaultColorMirrorTo},this.IsColorToStored=function(){return this.FColorTo!==this.FDefaultColorTo},this.Changed=function(){null!=this.FOnChanged&&0===this.FUpdateCount&&this.FOnChanged(this)},this.TextureChanged=function(t){this.Changed()},this.Create$1=function(e,i,s,o,n){return this.FGradientItems=t.TTMSFNCGraphicsFillGradientItems.$create("Create$3",[this]),this.FKind=e,this.FDefaultKind=e,this.FGradientMatrix.$assign(t.MatrixIdentity()),this.FGradientCenterColor=-1,this.FGradientMode=0,this.FGradientAngle=0,this.FGradientCenterPoint.$assign(pas["WEBLib.TMSFNCTypes"].PointF(0,0)),this.FGradientType=0,this.FColor=i,this.FDefaultColor=i,this.FOpacity=1,this.FOrientation=1,this.FColorTo=s,this.FColorMirror=o,this.FColorMirrorTo=n,this.FDefaultColorTo=s,this.FDefaultColorMirror=o,this.FDefaultColorMirrorTo=n,this.FTextureMode=2,this.FTexture=pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.$create("Create$3"),this.FTexture.FOnChange=rtl.createCallback(this,"TextureChanged"),this},this.Destroy=function(){rtl.free(this,"FTexture"),rtl.free(this,"FGradientItems"),pas.System.TObject.Destroy.call(this)},this.Assign=function(e){t.TTMSFNCCustomGraphicsFill.isPrototypeOf(e)?(this.FColor=rtl.as(e,t.TTMSFNCCustomGraphicsFill).FColor,this.FColorTo=rtl.as(e,t.TTMSFNCCustomGraphicsFill).FColorTo,this.FColorMirror=rtl.as(e,t.TTMSFNCCustomGraphicsFill).FColorMirror,this.FColorMirrorTo=rtl.as(e,t.TTMSFNCCustomGraphicsFill).FColorMirrorTo,this.FKind=rtl.as(e,t.TTMSFNCCustomGraphicsFill).FKind,this.FOrientation=rtl.as(e,t.TTMSFNCCustomGraphicsFill).FOrientation,this.FOpacity=rtl.as(e,t.TTMSFNCCustomGraphicsFill).FOpacity,this.FTexture.Assign(rtl.as(e,t.TTMSFNCCustomGraphicsFill).FTexture),this.FTextureMode=rtl.as(e,t.TTMSFNCCustomGraphicsFill).FTextureMode,this.FGradientMode=rtl.as(e,t.TTMSFNCCustomGraphicsFill).FGradientMode,this.FGradientAngle=rtl.as(e,t.TTMSFNCCustomGraphicsFill).FGradientAngle,this.FGradientCenterPoint.$assign(rtl.as(e,t.TTMSFNCCustomGraphicsFill).FGradientCenterPoint),this.FGradientItems.Assign(rtl.as(e,t.TTMSFNCCustomGraphicsFill).FGradientItems),this.FGradientType=rtl.as(e,t.TTMSFNCCustomGraphicsFill).FGradientType,this.FGradientCenterColor=rtl.as(e,t.TTMSFNCCustomGraphicsFill).FGradientCenterColor):t.TTMSFNCCustomGraphicsStroke.isPrototypeOf(e)&&(this.FColor=rtl.as(e,t.TTMSFNCCustomGraphicsStroke).FColor,this.FColorTo=-1,this.FColorMirror=-1,this.FColorMirrorTo=-1,this.FKind=1,this.FOrientation=1,this.FOpacity=1),this.Changed()}})),rtl.createClass(this,"TTMSFNCGraphicsFill",this.TTMSFNCCustomGraphicsFill,(function(){var e=this.$rtti;e.addProperty("OnChanged",0,pas.Classes.$rtti.TNotifyEvent,"FOnChanged","FOnChanged"),e.addProperty("Kind",14,t.$rtti.TTMSFNCGraphicsFillKind,"FKind","SetKind",{stored:"IsKindStored"}),e.addProperty("Orientation",2,t.$rtti.TTMSFNCGraphicsFillOrientation,"FOrientation","SetOrientation",{Default:t.TTMSFNCGraphicsFillOrientation.gfoVertical}),e.addProperty("Color",14,pas["WEBLib.Graphics"].$rtti.TColor,"FColor","SetColor",{stored:"IsColorStored"}),e.addProperty("ColorTo",14,pas["WEBLib.Graphics"].$rtti.TColor,"FColorTo","SetColorTo",{stored:"IsColorToStored"}),e.addProperty("ColorMirror",14,pas["WEBLib.Graphics"].$rtti.TColor,"FColorMirror","SetColorMirror",{stored:"IsColorMirrorStored"}),e.addProperty("ColorMirrorTo",14,pas["WEBLib.Graphics"].$rtti.TColor,"FColorMirrorTo","SetColorMirrorTo",{stored:"IsColorMirrorToStored"}),e.addProperty("TextureMode",2,t.$rtti.TTMSFNCGraphicsTextureMode,"FTextureMode","SetTextureMode",{Default:t.TTMSFNCGraphicsTextureMode.gtmStretch}),e.addProperty("Texture",2,pas["WEBLib.TMSFNCTypes"].$rtti.TTMSFNCBitmap,"FTexture","SetTexture")})),rtl.createClass(this,"TTMSFNCGraphicsFont",pas["WEBLib.Graphics"].TFont,(function(){this.$init=function(){pas["WEBLib.Graphics"].TFont.$init.call(this),this.FUpdateCount=0,this.FOnChanged=null},this.$final=function(){this.FOnChanged=void 0,pas["WEBLib.Graphics"].TFont.$final.call(this)},this.DoChanged=function(t){null!=this.FOnChanged&&0===this.FUpdateCount&&this.FOnChanged(this)},this.Create$2=function(){return pas["WEBLib.Graphics"].TFont.Create$1.call(this),this.SetHeight(-11),this.FOnChange=rtl.createCallback(this,"DoChanged"),this},this.Assign=function(t){pas["WEBLib.Graphics"].TFont.Assign.call(this,t),this.DoChanged(this)},this.AssignSource=function(t){this.Assign(t)}})),this.TTMSFNCAppearanceGlobalFontType={0:"aftNone",aftNone:0,1:"aftColor",aftColor:1,2:"aftSize",aftSize:2,3:"aftName",aftName:3,4:"aftScale",aftScale:4,5:"aftStyle",aftStyle:5},rtl.createInterface(this,"ITMSFNCAppearanceGlobalFont","{85CF4F6B-3FF9-4CB7-AD6A-7FC477ED5462}",["SetFonts"],pas.System.IUnknown),rtl.createClass(this,"TTMSFNCAppearanceGlobalFont",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FOwner=null,this.FColor=0,this.FSize=0,this.FName="",this.FScale=0,this.FOldScale=0,this.FStyle={}},this.$final=function(){this.FOwner=void 0,this.FStyle=void 0,pas.Classes.TPersistent.$final.call(this)},this.SetColor=function(t){this.FColor!==t&&(this.FColor=t,this.SetFonts(1))},this.SetSize=function(t){this.FSize!==t&&(this.FSize=t,this.SetFonts(2))},this.SetName=function(t){this.FName!==t&&(this.FName=t,this.SetFonts(3))},this.SetScale=function(t){this.FScale!==t&&(this.FOldScale=this.FScale,this.FScale=t,this.SetFonts(4))},this.SetStyle=function(t){rtl.neSet(this.FStyle,t)&&(this.FStyle=rtl.refSet(t),this.SetFonts(5))},this.SetFonts=function(e){var i=null,s=rtl.createIntfRefs();try{pas.SysUtils.Supports$1(s.ref(1,rtl.queryIntfT(this.FOwner,pas.System.IUnknown)),rtl.getIntfGUIDR(t.ITMSFNCAppearanceGlobalFont),{get:function(){return i},set:function(t){i=t}})&&i.SetFonts(e)}finally{s.free(),rtl._Release(i)}},this.Create$1=function(t){return this.FOwner=t,this.FColor=-1,this.FSize=0,this.FScale=1,this.FName="",this},this.Destroy=function(){pas.System.TObject.Destroy.call(this)},this.Assign=function(e){t.TTMSFNCAppearanceGlobalFont.isPrototypeOf(e)?(this.SetColor(rtl.as(e,t.TTMSFNCAppearanceGlobalFont).FColor),this.SetSize(rtl.as(e,t.TTMSFNCAppearanceGlobalFont).FSize),this.SetName(rtl.as(e,t.TTMSFNCAppearanceGlobalFont).FName),this.SetScale(rtl.as(e,t.TTMSFNCAppearanceGlobalFont).FScale),this.SetStyle(rtl.refSet(rtl.as(e,t.TTMSFNCAppearanceGlobalFont).FStyle))):pas.Classes.TPersistent.Assign.apply(this,arguments)},this.ApplyChange=function(t,e){if(null!=t){var i=e;1===i?t.SetColor(this.FColor):2===i?t.SetSize(Math.round(this.FSize)):3===i?t.SetName(this.FName):4===i?t.SetHeight(Math.round(t.FHeight*this.FScale/this.FOldScale)):5===i&&t.SetStyle(rtl.refSet(this.FStyle))}};var e=this.$rtti;e.addProperty("Color",2,pas["WEBLib.Graphics"].$rtti.TColor,"FColor","SetColor",{Default:-1}),e.addProperty("Size",2,rtl.double,"FSize","SetSize"),e.addProperty("Name",2,rtl.string,"FName","SetName"),e.addProperty("Scale",2,rtl.double,"FScale","SetScale"),e.addProperty("Style",2,pas["WEBLib.Graphics"].$rtti.TFontStyles,"FStyle","SetStyle")})),rtl.createClass(this,"TTMSFNCCustomGraphicsStroke",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FUpdateCount=0,this.FOnChanged=null,this.FKind=0,this.FColor=0,this.FWidth=0,this.FOpacity=0,this.FDefaultKind=0,this.FDefaultColor=0},this.$final=function(){this.FOnChanged=void 0,pas.Classes.TPersistent.$final.call(this)},this.SetKind=function(t){this.FKind!==t&&(this.FKind=t,this.Changed())},this.SetColor=function(t){this.FColor!==t&&(this.FColor=t,-1===this.FColor?this.FColor=-1:536870912===this.FColor&&(this.FColor=15790320),this.Changed())},this.SetWidth=function(t){this.FWidth!==t&&(this.FWidth=t,this.Changed())},this.IsWidthStored=function(){return 1!==this.FWidth},this.IsKindStored=function(){return this.FKind!==this.FDefaultKind},this.IsColorStored=function(){return this.FColor!==this.FDefaultColor},this.Changed=function(){null!=this.FOnChanged&&0===this.FUpdateCount&&this.FOnChanged(this)},this.Create$1=function(t,e){return this.FKind=t,this.FDefaultKind=t,this.FColor=e,this.FDefaultColor=e,this.FOpacity=1,this.FWidth=1,this},this.Assign=function(e){t.TTMSFNCCustomGraphicsStroke.isPrototypeOf(e)?(this.FColor=rtl.as(e,t.TTMSFNCCustomGraphicsStroke).FColor,this.FKind=rtl.as(e,t.TTMSFNCCustomGraphicsStroke).FKind,this.FOpacity=rtl.as(e,t.TTMSFNCCustomGraphicsStroke).FOpacity,this.FWidth=rtl.as(e,t.TTMSFNCCustomGraphicsStroke).FWidth):t.TTMSFNCCustomGraphicsFill.isPrototypeOf(e)&&(this.FColor=rtl.as(e,t.TTMSFNCCustomGraphicsFill).FColor,this.FKind=1,this.FOpacity=1,this.FWidth=1),this.Changed()}})),rtl.createClass(this,"TTMSFNCGraphicsStroke",this.TTMSFNCCustomGraphicsStroke,(function(){var e=this.$rtti;e.addProperty("OnChanged",0,pas.Classes.$rtti.TNotifyEvent,"FOnChanged","FOnChanged"),e.addProperty("Kind",14,t.$rtti.TTMSFNCGraphicsStrokeKind,"FKind","SetKind",{stored:"IsKindStored"}),e.addProperty("Color",14,pas["WEBLib.Graphics"].$rtti.TColor,"FColor","SetColor",{stored:"IsColorStored"}),e.addProperty("Width",14,rtl.double,"FWidth","SetWidth",{stored:"IsWidthStored"})})),this.TTMSFNCGraphicsPathPointKind={0:"gppMoveTo",gppMoveTo:0,1:"gppLineTo",gppLineTo:1,2:"gppCurveTo",gppCurveTo:2,3:"gppClose",gppClose:3},this.TTMSFNCGraphicsPathCubicBezier$clone=function(t){var e=[];e.length=4;for(var i=0;i<4;i++)e[i]=pas["WEBLib.TMSFNCTypes"].TPointF.$clone(t[i]);return e},rtl.recNewT(this,"TTMSFNCGraphicsPathPoint",(function(){this.Kind=0,this.$new=function(){var t=Object.create(this);return t.Point=pas["WEBLib.TMSFNCTypes"].TPointF.$new(),t},this.$eq=function(t){return this.Kind===t.Kind&&this.Point.$eq(t.Point)},this.$assign=function(t){return this.Kind=t.Kind,this.Point.$assign(t.Point),this}})),this.TTMSFNCGraphicsPathDrawMode={0:"pdmPolygon",pdmPolygon:0,1:"pdmPolyline",pdmPolyline:1,2:"pdmPath",pdmPath:2},rtl.createClass(this,"TTMSFNCGraphicsPathPoints",pas.Classes.TList,(function(){this.GetItem=function(e){var i=t.TTMSFNCGraphicsPathPoint.$new();return i.$assign(rtl.getObject(this.Get(e))),i},this.SetItem=function(e,i){var s=t.TTMSFNCGraphicsPathPoint.$new();s.$assign(i),this.Put(e,s)}})),rtl.createClass(this,"TTMSFNCGraphicsPath",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FStartPoint=pas["WEBLib.TMSFNCTypes"].TPointF.$new(),this.FClippable=!1,this.FPoints=null},this.$final=function(){this.FStartPoint=void 0,this.FPoints=void 0,pas.Classes.TPersistent.$final.call(this)},this.CalculateBezierCoefficients=function(t,e,i,s,o,n,r){s.set(3*(t[1].X-t[0].X)),r.set(3*(t[1].Y-t[0].Y)),i.set(3*(t[2].X-t[1].X)-s.get()),n.set(3*(t[2].Y-t[1].Y)-r.get()),e.set(t[3].X-t[0].X-s.get()-i.get()),o.set(t[3].Y-t[0].Y-r.get()-n.get())},this.GetCount=function(){return this.FPoints.GetCount()},this.GetPoint=function(e){var i=t.TTMSFNCGraphicsPathPoint.$new();return i.$assign(this.FPoints.GetItem(e)),i},this.Create$1=function(){return pas.System.TObject.Create.call(this),this.FPoints=t.TTMSFNCGraphicsPathPoints.$create("Create$1"),this},this.Destroy=function(){rtl.free(this,"FPoints"),pas.System.TObject.Destroy.call(this)},this.Assign=function(e){var i=0;if(t.TTMSFNCGraphicsPath.isPrototypeOf(e)){this.FPoints.SetCount(e.GetCount());for(var s=0,o=e.GetCount()-1;s<=o;s++)i=s,this.FPoints.SetItem(i,e.GetPoint(i))}else pas.Classes.TPersistent.Assign.apply(this,arguments)},this.IsPointVisible=function(e){var i=[];return i=rtl.arraySetLength(i,pas["WEBLib.TMSFNCTypes"].TPointF,0),this.FlattenToPolygon({get:function(){return i},set:function(t){i=t}},.25),t.PointInPoly(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(e),rtl.arrayRef(i))},this.PointOnBezier=function(t,e,i,s,o,n,r,a){var l,h,F=pas["WEBLib.TMSFNCTypes"].TPointF.$new();return h=(l=a*a)*a,F.X=e*h+i*l+s*a+t.X,F.Y=o*h+n*l+r*a+t.Y,F},this.CreateBezier=function(t,e){var i,s=[],o=0,n=0,r=0,a=0,l=0,h=0,F=0;if(0===e)return s;i=1/(1*e-1),F=0,s=rtl.arraySetLength(s,pas["WEBLib.TMSFNCTypes"].TPointF,e),this.CalculateBezierCoefficients(t,{get:function(){return o},set:function(t){o=t}},{get:function(){return n},set:function(t){n=t}},{get:function(){return r},set:function(t){r=t}},{get:function(){return a},set:function(t){a=t}},{get:function(){return l},set:function(t){l=t}},{get:function(){return h},set:function(t){h=t}});for(var p=0,c=e-1;p<=c;p++)s[p].$assign(this.PointOnBezier(t[0],o,n,r,a,l,h,F)),F+=i;return s};this.GetBounds=function(){var e=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),i=0,s=t.TTMSFNCGraphicsPathPoint.$new();if(this.FPoints.GetCount()<1)return pas["WEBLib.TMSFNCTypes"].RectF(0,0,0,0);e.$assign(pas["WEBLib.TMSFNCTypes"].RectF(65535,65535,-65535,-65535));for(var o=0,n=this.FPoints.GetCount()-1;o<=n;o++)i=o,s.$assign(this.FPoints.GetItem(i)),3!==s.Kind&&(s.Point.X<e.Left&&(e.Left=s.Point.X),s.Point.X>e.Right&&(e.Right=s.Point.X),s.Point.Y<e.Top&&(e.Top=s.Point.Y),s.Point.Y>e.Bottom&&(e.Bottom=s.Point.Y));return pas.Math.SameValue(e.Right-e.Left,0,.001)&&(e.Right=e.Left+.001),pas.Math.SameValue(e.Bottom-e.Top,0,.001)&&(e.Bottom=e.Top+.001),e},this.MoveTo=function(e){var i=t.TTMSFNCGraphicsPathPoint.$new();i.Kind=0,i.Point.$assign(e),this.FPoints.Add(t.TTMSFNCGraphicsPathPoint.$clone(i)),this.FStartPoint.$assign(this.FPoints.GetItem(this.FPoints.GetCount()-1).Point)},this.LineTo=function(e){var i=t.TTMSFNCGraphicsPathPoint.$new();i.Kind=1,i.Point.$assign(e),this.FPoints.Add(t.TTMSFNCGraphicsPathPoint.$clone(i)),e.X===this.FStartPoint.X&&e.Y===this.FStartPoint.Y&&(this.FClippable=!0)},this.CurveTo=function(e,i,s){var o=t.TTMSFNCGraphicsPathPoint.$new();o.Kind=2,o.Point.$assign(e),this.FPoints.Add(t.TTMSFNCGraphicsPathPoint.$clone(o)),o.Kind=2,o.Point.$assign(i),this.FPoints.Add(t.TTMSFNCGraphicsPathPoint.$clone(o)),o.Kind=2,o.Point.$assign(s),this.FPoints.Add(t.TTMSFNCGraphicsPathPoint.$clone(o))},this.ClosePath=function(){var e=t.TTMSFNCGraphicsPathPoint.$new();e.Kind=3,e.Point.$assign(this.FStartPoint),this.FPoints.Add(t.TTMSFNCGraphicsPathPoint.$clone(e)),this.FClippable=!0},this.AddEllipse=function(t){var e,i,s,o,n;n=.5522847498,e=(t.Left+t.Right)/2,i=(t.Top+t.Bottom)/2,s=n*((t.Right-t.Left)/2),o=n*((t.Bottom-t.Top)/2),this.MoveTo(pas["WEBLib.TMSFNCTypes"].PointF(t.Left,i)),this.CurveTo(pas["WEBLib.TMSFNCTypes"].PointF(t.Left,i-o),pas["WEBLib.TMSFNCTypes"].PointF(e-s,t.Top),pas["WEBLib.TMSFNCTypes"].PointF(e,t.Top)),this.CurveTo(pas["WEBLib.TMSFNCTypes"].PointF(e+s,t.Top),pas["WEBLib.TMSFNCTypes"].PointF(t.Right,i-o),pas["WEBLib.TMSFNCTypes"].PointF(t.Right,i)),this.CurveTo(pas["WEBLib.TMSFNCTypes"].PointF(t.Right,i+o),pas["WEBLib.TMSFNCTypes"].PointF(e+s,t.Bottom),pas["WEBLib.TMSFNCTypes"].PointF(e,t.Bottom)),this.CurveTo(pas["WEBLib.TMSFNCTypes"].PointF(e-s,t.Bottom),pas["WEBLib.TMSFNCTypes"].PointF(t.Left,i+o),pas["WEBLib.TMSFNCTypes"].PointF(t.Left,i)),this.FClippable=!0},this.AddRectangle=function(t,e,i){var s={};0===e&&0===i?(this.MoveTo(pas["WEBLib.TMSFNCTypes"].PointF(t.Left,t.Top)),this.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(t.Right,t.Top)),this.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(t.Right,t.Bottom)),this.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(t.Left,t.Bottom))):(2 in(s=rtl.createSet(0,1,2,3))?(this.MoveTo(pas["WEBLib.TMSFNCTypes"].PointF(t.Left+e,t.Bottom)),this.AddArc(pas["WEBLib.TMSFNCTypes"].PointF(t.Left+e,t.Bottom-i),pas["WEBLib.TMSFNCTypes"].PointF(e,i),-270,90),this.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(t.Left,t.Bottom-i))):this.MoveTo(pas["WEBLib.TMSFNCTypes"].PointF(t.Left,t.Bottom)),0 in s?(this.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(t.Left,t.Top+i)),this.AddArc(pas["WEBLib.TMSFNCTypes"].PointF(t.Left+e,t.Top+i),pas["WEBLib.TMSFNCTypes"].PointF(e,i),-180,90),this.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(t.Left+e,t.Top))):this.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(t.Left,t.Top)),1 in s?(this.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(t.Right-e,t.Top)),this.AddArc(pas["WEBLib.TMSFNCTypes"].PointF(t.Right-e,t.Top+i),pas["WEBLib.TMSFNCTypes"].PointF(e,i),-90,90),this.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(t.Right,t.Top+i))):this.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(t.Right,t.Top)),3 in s?(this.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(t.Right,t.Bottom-i)),this.AddArc(pas["WEBLib.TMSFNCTypes"].PointF(t.Right-e,t.Bottom-i),pas["WEBLib.TMSFNCTypes"].PointF(e,i),0,90),this.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(t.Right-e,t.Bottom))):this.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(t.Right,t.Bottom)),2 in s?this.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(t.Left+e,t.Bottom)):this.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(t.Left,t.Bottom))),this.ClosePath(),this.FClippable=!0};this.AddArc=function(t,i,s,o){var n=!1,r=0,a=0,l=0,h=!1;if(s=pas.Math.DegToRad(s),o=pas.Math.DegToRad(o),s=s-2*pas.System.Trunc(s/(2*Math.PI))*Math.PI,o>=2*Math.PI&&(o=2*Math.PI),o<=-2*Math.PI&&(o=-2*Math.PI),!(Math.abs(o)<1e-10)){r=0,h=!1,n=!0;do{o<0?(l=r,a=-Math.PI/2,(r-=Math.PI/2)<=o+.01&&(a=o-l,h=!0)):(l=r,a=Math.PI/2,(r+=Math.PI/2)>=o-.01&&(a=o-l,h=!0)),e.DrawArcWithBezier(this,t.X,t.Y,i.X,i.Y,s,a,n),n=!1,s+=a}while(!h)}},this.FlattenToPolygon=function(t,e){function i(e){rtl.length(t.get())>0&&pas.Math.SameValue(e.X,t.get()[rtl.length(t.get())-1].X,.001)&&pas.Math.SameValue(e.Y,t.get()[rtl.length(t.get())-1].Y,.001)||(t.set(rtl.arraySetLength(t.get(),pas["WEBLib.TMSFNCTypes"].TPointF,rtl.length(t.get())+1)),t.get()[rtl.length(t.get())-1].$assign(e))}var s=0,o=0,n=[],r=rtl.arraySetLength(null,pas["WEBLib.TMSFNCTypes"].TPointF,4),a=pas["WEBLib.TMSFNCTypes"].TPointF.$new(),l=pas["WEBLib.TMSFNCTypes"].TPointF.$new(),h=pas["WEBLib.TMSFNCTypes"].TPointF.$new(),F=0,p=0,c=0;if(t.set(rtl.arraySetLength(t.get(),pas["WEBLib.TMSFNCTypes"].TPointF,0)),this.FPoints.GetCount()>0)for(F=Math.max(e,.05),s=0;s<this.FPoints.GetCount();){var u=this.FPoints.GetItem(s).Kind;if(0===u)i(this.FPoints.GetItem(s).Point),l.$assign(this.FPoints.GetItem(s).Point),a.$assign(l);else if(1===u)i(this.FPoints.GetItem(s).Point),l.$assign(this.FPoints.GetItem(s).Point);else if(2===u){r[0].$assign(l),r[1].$assign(this.FPoints.GetItem(s).Point),s+=1,r[2].$assign(this.FPoints.GetItem(s).Point),s+=1,r[3].$assign(this.FPoints.GetItem(s).Point),n=this.CreateBezier(r,6),p=0;for(var C=0,T=rtl.length(n)-1-1;C<=T;C++)o=C,h.X=n[o].X-n[o+1].X,h.Y=n[o].Y-n[o+1].Y,p+=pas["WEBLib.TMSFNCTypes"].GetPointLength(h);if((c=Math.round(p/F))<2)i(r[0]),i(r[3]);else{n=this.CreateBezier(r,c);for(var S=0,d=rtl.length(n)-1;S<=d;S++)i(n[o=S])}l.$assign(this.FPoints.GetItem(s).Point)}else 3===u&&i(a);s+=1}}})),rtl.createClass(this,"TTMSFNCGraphicsColorObject",pas.System.TObject,(function(){this.$init=function(){pas.System.TObject.$init.call(this),this.FColor=0},this.Create$1=function(t){return this.FColor=t,this}})),this.TTMSFNCGraphicsModifyRectMode={0:"gcrmNone",gcrmNone:0,1:"gcrmExpandAll",gcrmExpandAll:1,2:"gcrmShrinkAll",gcrmShrinkAll:2,3:"gcrmShiftRightAndExpandHeight",gcrmShiftRightAndExpandHeight:3,4:"gcrmShiftDownAndExpandWidth",gcrmShiftDownAndExpandWidth:4,5:"gcrmShiftRightAndShrinkHeight",gcrmShiftRightAndShrinkHeight:5,6:"gcrmShiftRightDown",gcrmShiftRightDown:6,7:"gcrmShiftRightUp",gcrmShiftRightUp:7,8:"gcrmShiftLeftUp",gcrmShiftLeftUp:8,9:"gcrmShiftLeftDown",gcrmShiftLeftDown:9,10:"gcrmShiftUpAndExpandWidth",gcrmShiftUpAndExpandWidth:10,11:"gcrmShiftLeftAndExpandHeight",gcrmShiftLeftAndExpandHeight:11},this.TTMSFNCGraphicsModifyPointMode={0:"gcpmNone",gcpmNone:0,1:"gcpmLeftUp",gcpmLeftUp:1,2:"gcpmRightDown",gcpmRightDown:2,3:"gcpmLeftDown",gcpmLeftDown:3,4:"gcpmRightUp",gcpmRightUp:4},this.TTMSFNCGraphicsExpanderState={0:"gesCollapsed",gesCollapsed:0,1:"gesExpanded",gesExpanded:1},this.TTMSFNCGraphicsCompactState={0:"gcsCollapsed",gcsCollapsed:0,1:"gcsExpanded",gcsExpanded:1},this.TTMSFNCGraphicsCorner={0:"gcTopLeft",gcTopLeft:0,1:"gcTopRight",gcTopRight:1,2:"gcBottomLeft",gcBottomLeft:2,3:"gcBottomRight",gcBottomRight:3},this.$rtti.$Enum("TTMSFNCGraphicsCorner",{minvalue:0,maxvalue:3,ordtype:1,enumtype:this.TTMSFNCGraphicsCorner}),this.$rtti.$Set("TTMSFNCGraphicsCorners",{comptype:this.$rtti.TTMSFNCGraphicsCorner}),this.ModifyRect=function(t,e){var i=pas["WEBLib.TMSFNCTypes"].TRectF.$new();i.$assign(t);var s=e;return 1===s?i.$assign(pas["WEBLib.TMSFNCTypes"].RectF(pas.System.Int(i.Left)-.5,pas.System.Int(i.Top)-.5,pas.System.Int(i.Right)+.5,pas.System.Int(i.Bottom)+.5)):2===s?i.$assign(pas["WEBLib.TMSFNCTypes"].RectF(pas.System.Int(i.Left)+.5,pas.System.Int(i.Top)+.5,pas.System.Int(i.Right)-.5,pas.System.Int(i.Bottom)-.5)):3===s?i.$assign(pas["WEBLib.TMSFNCTypes"].RectF(pas.System.Int(i.Left)+.5,pas.System.Int(i.Top)-.5,pas.System.Int(i.Right)+.5,pas.System.Int(i.Bottom)+.5)):6===s?i.$assign(pas["WEBLib.TMSFNCTypes"].RectF(pas.System.Int(i.Left)+.5,pas.System.Int(i.Top)+.5,pas.System.Int(i.Right)+.5,pas.System.Int(i.Bottom)+.5)):5===s?i.$assign(pas["WEBLib.TMSFNCTypes"].RectF(pas.System.Int(i.Left)+.5,pas.System.Int(i.Top)+.5,pas.System.Int(i.Right)+.5,pas.System.Int(i.Bottom)-.5)):4===s?i.$assign(pas["WEBLib.TMSFNCTypes"].RectF(pas.System.Int(i.Left)-.5,pas.System.Int(i.Top)+.5,pas.System.Int(i.Right)+.5,pas.System.Int(i.Bottom)+.5)):10===s?i.$assign(pas["WEBLib.TMSFNCTypes"].RectF(pas.System.Int(i.Left)-.5,pas.System.Int(i.Top)-.5,pas.System.Int(i.Right)+.5,pas.System.Int(i.Bottom)-.5)):7===s?i.$assign(pas["WEBLib.TMSFNCTypes"].RectF(pas.System.Int(i.Left)+.5,pas.System.Int(i.Top)-.5,pas.System.Int(i.Right)+.5,pas.System.Int(i.Bottom)-.5)):8===s?i.$assign(pas["WEBLib.TMSFNCTypes"].RectF(pas.System.Int(i.Left)-.5,pas.System.Int(i.Top)-.5,pas.System.Int(i.Right)-.5,pas.System.Int(i.Bottom)-.5)):9===s?i.$assign(pas["WEBLib.TMSFNCTypes"].RectF(pas.System.Int(i.Left)-.5,pas.System.Int(i.Top)+.5,pas.System.Int(i.Right)-.5,pas.System.Int(i.Bottom)+.5)):11===s&&i.$assign(pas["WEBLib.TMSFNCTypes"].RectF(pas.System.Int(i.Left)-.5,pas.System.Int(i.Top)-.5,pas.System.Int(i.Right)-.5,pas.System.Int(i.Bottom)+.5)),i},this.MakeGraphicsColor=function(t,e,i){return pas["WEBLib.Graphics"].RGB(t,e,i)},this.Lighter=function(e,i){var s=0,o=0,n=0;return e=pas["WEBLib.Graphics"].ColorToRGB(e),s=pas["WEBLib.Graphics"].GetRValue(e),o=pas["WEBLib.Graphics"].GetGValue(e),n=pas["WEBLib.Graphics"].GetBValue(e),s+=Math.min(255,pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.MulDivInt(255-s,i,100)),o+=Math.min(255,pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.MulDivInt(255-o,i,100)),n+=Math.min(255,pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.MulDivInt(255-n,i,100)),t.MakeGraphicsColor(s,o,n)},this.Darker=function(e,i){var s=0,o=0,n=0;return e=pas["WEBLib.Graphics"].ColorToRGB(e),s=pas["WEBLib.Graphics"].GetRValue(e),o=pas["WEBLib.Graphics"].GetGValue(e),n=pas["WEBLib.Graphics"].GetBValue(e),s-=Math.max(0,pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.MulDivInt(255-s,i,100)),o-=Math.max(0,pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.MulDivInt(255-o,i,100)),n-=Math.max(0,pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.MulDivInt(255-n,i,100)),t.MakeGraphicsColor(s,o,n)},this.Blend=function(t,e,i){var s,o,n,r,a=0,l=0;return i=Math.round(2.55*i),a=255&(s=pas["WEBLib.Graphics"].ColorToRGB(t)),l=255&(o=pas["WEBLib.Graphics"].ColorToRGB(e)),n=Math.max(0,Math.min(255,(i*(a-l)>>>8)+l)),a=255&Math.floor(s/256),l=255&Math.floor(o/256),r=Math.max(0,Math.min(255,(i*(a-l)>>>8)+l)),a=255&Math.floor(s/65536),l=255&Math.floor(o/65536),(Math.max(0,Math.min(255,(i*(a-l)>>>8)+l))<<16)+(r<<8)+n},this.ColorLookup=function(){return e.FColorLookup},this.PointInPoly=function(t,e){var i=!1,s=0,o=0,n=0,r=0,a=0,l=0,h=pas["WEBLib.TMSFNCTypes"].TPointF.$new(),F=pas["WEBLib.TMSFNCTypes"].TPointF.$new(),p=pas["WEBLib.TMSFNCTypes"].TPointF.$new(),c=!1,u=!1,C=0,T=!1;if(i=!1,0===rtl.length(e))return i;s=e[0].X,o=e[0].X,n=e[0].Y,r=e[0].Y;for(var S=1,d=rtl.length(e)-1;S<=d;S++)a=S,h.$assign(e[a]),s=Math.min(h.X,s),o=Math.max(h.X,o),n=Math.min(h.Y,n),r=Math.max(h.Y,r);if(t.X<s||t.X>o||t.Y<n||t.Y>r)return i=!1;c=!1,l=rtl.length(e)-1;for(var m=0,f=rtl.length(e)-1;m<=f;m++)a=m,F.$assign(e[a]),p.$assign(e[l]),u=F.Y>t.Y!=p.Y>t.Y,p.Y-F.Y!=0&&(C=(p.X-F.X)*(t.Y-F.Y)/(p.Y-F.Y)+F.X,T=t.X<C,u&&T&&(c=!c)),l=a;return i=c},this.DrawGradient=function(t,e,i,s,o,n,r){var a,l,h,F,p,c,u,C,T,S,d=0,m=0,f=0,g=0,y=0,M=0,b=0,N=0,B=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),E=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),D=0,L=0;B.$assign(s),0===(N=r?Math.round(B.Right-B.Left):Math.round(B.Bottom-B.Top))&&(N=1),e=pas["WEBLib.Graphics"].ColorToRGB(e),i=pas["WEBLib.Graphics"].ColorToRGB(i),a=255&e,l=Math.floor((65280&e)/256),h=Math.floor((16711680&e)/65536),F=((d=255&i)-a)/N,p=((m=Math.floor((65280&i)/256))-l)/N,c=((f=Math.floor((16711680&i)/65536))-h)/N,y=r?(B.Right-B.Left)/N:(B.Bottom-B.Top)/N,C=t.FBrush.FColor,S=t.FBrush.FStyle,u=t.FPen.FColor,T=t.FPen.FStyle,t.FPen.FStyle=0,t.FBrush.FStyle=0;for(var G=0,A=N-1;G<=A;G++)M=G,d=a+Math.round(F*M),m=l+Math.round(p*M),f=h+Math.round(c*M),b=Math.round(M*y),t.FPen.SetColor(d+(m<<8)+(f<<16)),t.FBrush.FColor=t.FPen.FColor,r?(g=pas.System.Trunc(y),D=B.Left+b+g,D=Math.min(D,B.Right),E.$assign(B),M<=o&&(0 in n||2 in n)?(L=Math.sqrt(Math.pow(o,2)-Math.pow(o-M,2)),0 in n&&(E.Top=E.Top+Math.round(o-L)),2 in n&&(E.Bottom=E.Bottom-Math.round(o-L))):M>=N-o&&(3 in n||1 in n)&&(L=Math.sqrt(Math.pow(o,2)-Math.pow(o-(N-M),2)),1 in n&&(E.Top=E.Top+Math.round(o-L)),3 in n&&(E.Bottom=E.Bottom-Math.round(o-L))),t.Rectangle(E.Left+b,E.Top,D,E.Bottom)):(g=pas.System.Trunc(y),D=B.Top+b+g,D=Math.min(D,B.Bottom),E.$assign(B),M<=o&&(0 in n||1 in n)?(L=Math.sqrt(Math.pow(o,2)-Math.pow(o-M,2)),0 in n&&(E.Left=E.Left+Math.round(o-L)),1 in n&&(E.Right=E.Right-Math.round(o-L))):M>=N-o&&(2 in n||3 in n)&&(L=Math.sqrt(Math.pow(o,2)-Math.pow(o-(N-M),2)),2 in n&&(E.Left=E.Left+Math.round(o-L)),3 in n&&(E.Right=E.Right-Math.round(o-L))),t.Rectangle(E.Left,E.Top+b,E.Right,D));t.FBrush.FColor=C,t.FBrush.FStyle=S,t.FPen.SetColor(u),t.FPen.FStyle=T},this.MatrixIdentity=function(){var e=t.TTMSFNCGraphicsMatrix.$new();return e.m11=1,e.m12=0,e.m13=0,e.m21=0,e.m22=1,e.m23=0,e.m31=0,e.m32=0,e.m33=1,e},t.$implcode=function(){e.FColorLookup=null,e.DrawArcWithBezier=function(t,e,i,s,o,n,r,a){var l,h,F,p,c,u,C=[],T=[],S=0;if(0===r)return a&&(t.FPoints.GetCount()<1?t.MoveTo(pas["WEBLib.TMSFNCTypes"].PointF(e+s*Math.cos(n),i-o*Math.sin(n))):t.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(e+s*Math.cos(n),i-o*Math.sin(n)))),void t.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(e+s*Math.cos(n),i-o*Math.sin(n)));for(h=(p=Math.sin(r/2))-(l=4*(1-(F=Math.cos(r/2)))/3)*F/p,u=Math.sin(n+r/2),c=Math.cos(n+r/2),(C=rtl.arraySetLength(C,pas["WEBLib.TMSFNCTypes"].TPointF,4))[0].$assign(pas["WEBLib.TMSFNCTypes"].PointF(F,-p)),C[1].$assign(pas["WEBLib.TMSFNCTypes"].PointF(F+l,-h)),C[2].$assign(pas["WEBLib.TMSFNCTypes"].PointF(F+l,h)),C[3].$assign(pas["WEBLib.TMSFNCTypes"].PointF(F,p)),T=rtl.arraySetLength(T,pas["WEBLib.TMSFNCTypes"].TPointF,4),S=0;S<=3;S++)T[S].$assign(pas["WEBLib.TMSFNCTypes"].PointF(e+s*(C[S].X*c-C[S].Y*u),i+o*(C[S].X*u+C[S].Y*c)));a&&(t.FPoints.GetCount()<1?t.MoveTo(T[0]):t.LineTo(T[0])),t.CurveTo(T[1],T[2],T[3])}},t.$init=function(){e.FColorLookup=pas.Classes.TStringList.$create("Create$1"),e.FColorLookup.AddObject("aliceblue",t.TTMSFNCGraphicsColorObject.$create("Create$1",[16775408])),e.FColorLookup.AddObject("antiquewhite",t.TTMSFNCGraphicsColorObject.$create("Create$1",[14150650])),e.FColorLookup.AddObject("aqua",t.TTMSFNCGraphicsColorObject.$create("Create$1",[16776960])),e.FColorLookup.AddObject("aquamarine",t.TTMSFNCGraphicsColorObject.$create("Create$1",[13959039])),e.FColorLookup.AddObject("azure",t.TTMSFNCGraphicsColorObject.$create("Create$1",[16777200])),e.FColorLookup.AddObject("beige",t.TTMSFNCGraphicsColorObject.$create("Create$1",[14480885])),e.FColorLookup.AddObject("bisque",t.TTMSFNCGraphicsColorObject.$create("Create$1",[12903679])),e.FColorLookup.AddObject("black",t.TTMSFNCGraphicsColorObject.$create("Create$1",[0])),e.FColorLookup.AddObject("blanchedalmond",t.TTMSFNCGraphicsColorObject.$create("Create$1",[13495295])),e.FColorLookup.AddObject("blue",t.TTMSFNCGraphicsColorObject.$create("Create$1",[16711680])),e.FColorLookup.AddObject("blueviolet",t.TTMSFNCGraphicsColorObject.$create("Create$1",[14822282])),e.FColorLookup.AddObject("brown",t.TTMSFNCGraphicsColorObject.$create("Create$1",[2763429])),e.FColorLookup.AddObject("burlywood",t.TTMSFNCGraphicsColorObject.$create("Create$1",[8894686])),e.FColorLookup.AddObject("cadetblue",t.TTMSFNCGraphicsColorObject.$create("Create$1",[10526303])),e.FColorLookup.AddObject("chartreuse",t.TTMSFNCGraphicsColorObject.$create("Create$1",[65407])),e.FColorLookup.AddObject("chocolate",t.TTMSFNCGraphicsColorObject.$create("Create$1",[1993170])),e.FColorLookup.AddObject("coral",t.TTMSFNCGraphicsColorObject.$create("Create$1",[5275647])),e.FColorLookup.AddObject("cornflowerblue",t.TTMSFNCGraphicsColorObject.$create("Create$1",[15570276])),e.FColorLookup.AddObject("cornsilk",t.TTMSFNCGraphicsColorObject.$create("Create$1",[14481663])),e.FColorLookup.AddObject("crimson",t.TTMSFNCGraphicsColorObject.$create("Create$1",[3937500])),e.FColorLookup.AddObject("cyan",t.TTMSFNCGraphicsColorObject.$create("Create$1",[16776960])),e.FColorLookup.AddObject("darkblue",t.TTMSFNCGraphicsColorObject.$create("Create$1",[9109504])),e.FColorLookup.AddObject("darkcyan",t.TTMSFNCGraphicsColorObject.$create("Create$1",[9145088])),e.FColorLookup.AddObject("darkgoldenrod",t.TTMSFNCGraphicsColorObject.$create("Create$1",[755384])),e.FColorLookup.AddObject("darkgray",t.TTMSFNCGraphicsColorObject.$create("Create$1",[11119017])),e.FColorLookup.AddObject("darkgreen",t.TTMSFNCGraphicsColorObject.$create("Create$1",[25600])),e.FColorLookup.AddObject("darkgrey",t.TTMSFNCGraphicsColorObject.$create("Create$1",[11119017])),e.FColorLookup.AddObject("darkkhaki",t.TTMSFNCGraphicsColorObject.$create("Create$1",[7059389])),e.FColorLookup.AddObject("darkmagenta",t.TTMSFNCGraphicsColorObject.$create("Create$1",[9109643])),e.FColorLookup.AddObject("darkolivegreen",t.TTMSFNCGraphicsColorObject.$create("Create$1",[3107669])),e.FColorLookup.AddObject("darkorange",t.TTMSFNCGraphicsColorObject.$create("Create$1",[36095])),e.FColorLookup.AddObject("darkorchid",t.TTMSFNCGraphicsColorObject.$create("Create$1",[13382297])),e.FColorLookup.AddObject("darkred",t.TTMSFNCGraphicsColorObject.$create("Create$1",[139])),e.FColorLookup.AddObject("darksalmon",t.TTMSFNCGraphicsColorObject.$create("Create$1",[8034025])),e.FColorLookup.AddObject("darkseagreen",t.TTMSFNCGraphicsColorObject.$create("Create$1",[9419919])),e.FColorLookup.AddObject("darkslateblue",t.TTMSFNCGraphicsColorObject.$create("Create$1",[9125192])),e.FColorLookup.AddObject("darkslategray",t.TTMSFNCGraphicsColorObject.$create("Create$1",[5197615])),e.FColorLookup.AddObject("darkslategrey",t.TTMSFNCGraphicsColorObject.$create("Create$1",[5197615])),e.FColorLookup.AddObject("darkturquoise",t.TTMSFNCGraphicsColorObject.$create("Create$1",[13749760])),e.FColorLookup.AddObject("darkviolet",t.TTMSFNCGraphicsColorObject.$create("Create$1",[13828244])),e.FColorLookup.AddObject("deeppink",t.TTMSFNCGraphicsColorObject.$create("Create$1",[9639167])),e.FColorLookup.AddObject("deepskyblue",t.TTMSFNCGraphicsColorObject.$create("Create$1",[16760576])),e.FColorLookup.AddObject("dimgray",t.TTMSFNCGraphicsColorObject.$create("Create$1",[6908265])),e.FColorLookup.AddObject("dimgrey",t.TTMSFNCGraphicsColorObject.$create("Create$1",[6908265])),e.FColorLookup.AddObject("dodgerblue",t.TTMSFNCGraphicsColorObject.$create("Create$1",[16748574])),e.FColorLookup.AddObject("firebrick",t.TTMSFNCGraphicsColorObject.$create("Create$1",[2237106])),e.FColorLookup.AddObject("floralwhite",t.TTMSFNCGraphicsColorObject.$create("Create$1",[15792895])),e.FColorLookup.AddObject("forestgreen",t.TTMSFNCGraphicsColorObject.$create("Create$1",[2263842])),e.FColorLookup.AddObject("fuchsia",t.TTMSFNCGraphicsColorObject.$create("Create$1",[16711935])),e.FColorLookup.AddObject("gainsboro",t.TTMSFNCGraphicsColorObject.$create("Create$1",[14474460])),e.FColorLookup.AddObject("ghostwhite",t.TTMSFNCGraphicsColorObject.$create("Create$1",[16775416])),e.FColorLookup.AddObject("gold",t.TTMSFNCGraphicsColorObject.$create("Create$1",[55295])),e.FColorLookup.AddObject("goldenrod",t.TTMSFNCGraphicsColorObject.$create("Create$1",[2139610])),e.FColorLookup.AddObject("gray",t.TTMSFNCGraphicsColorObject.$create("Create$1",[8421504])),e.FColorLookup.AddObject("green",t.TTMSFNCGraphicsColorObject.$create("Create$1",[32768])),e.FColorLookup.AddObject("greenyellow",t.TTMSFNCGraphicsColorObject.$create("Create$1",[3145645])),e.FColorLookup.AddObject("grey",t.TTMSFNCGraphicsColorObject.$create("Create$1",[8421504])),e.FColorLookup.AddObject("honeydew",t.TTMSFNCGraphicsColorObject.$create("Create$1",[15794160])),e.FColorLookup.AddObject("hotpink",t.TTMSFNCGraphicsColorObject.$create("Create$1",[11823615])),e.FColorLookup.AddObject("indianred",t.TTMSFNCGraphicsColorObject.$create("Create$1",[6053069])),e.FColorLookup.AddObject("indigo",t.TTMSFNCGraphicsColorObject.$create("Create$1",[8519755])),e.FColorLookup.AddObject("ivory",t.TTMSFNCGraphicsColorObject.$create("Create$1",[15794175])),e.FColorLookup.AddObject("khaki",t.TTMSFNCGraphicsColorObject.$create("Create$1",[9234160])),e.FColorLookup.AddObject("lavender",t.TTMSFNCGraphicsColorObject.$create("Create$1",[16443110])),e.FColorLookup.AddObject("lavenderblush",t.TTMSFNCGraphicsColorObject.$create("Create$1",[16118015])),e.FColorLookup.AddObject("lawngreen",t.TTMSFNCGraphicsColorObject.$create("Create$1",[64636])),e.FColorLookup.AddObject("lemonchiffon",t.TTMSFNCGraphicsColorObject.$create("Create$1",[13499135])),e.FColorLookup.AddObject("lightblue",t.TTMSFNCGraphicsColorObject.$create("Create$1",[15128749])),e.FColorLookup.AddObject("lightcoral",t.TTMSFNCGraphicsColorObject.$create("Create$1",[8421616])),e.FColorLookup.AddObject("lightcyan",t.TTMSFNCGraphicsColorObject.$create("Create$1",[16777184])),e.FColorLookup.AddObject("lightgoldenrodyellow",t.TTMSFNCGraphicsColorObject.$create("Create$1",[13826810])),e.FColorLookup.AddObject("lightgray",t.TTMSFNCGraphicsColorObject.$create("Create$1",[13882323])),e.FColorLookup.AddObject("lightgreen",t.TTMSFNCGraphicsColorObject.$create("Create$1",[9498256])),e.FColorLookup.AddObject("lightgrey",t.TTMSFNCGraphicsColorObject.$create("Create$1",[13882323])),e.FColorLookup.AddObject("lightpink",t.TTMSFNCGraphicsColorObject.$create("Create$1",[12695295])),e.FColorLookup.AddObject("lightsalmon",t.TTMSFNCGraphicsColorObject.$create("Create$1",[8036607])),e.FColorLookup.AddObject("lightseagreen",t.TTMSFNCGraphicsColorObject.$create("Create$1",[11186720])),e.FColorLookup.AddObject("lightskyblue",t.TTMSFNCGraphicsColorObject.$create("Create$1",[16436871])),e.FColorLookup.AddObject("lightslategray",t.TTMSFNCGraphicsColorObject.$create("Create$1",[10061943])),e.FColorLookup.AddObject("lightslategrey",t.TTMSFNCGraphicsColorObject.$create("Create$1",[10061943])),e.FColorLookup.AddObject("lightsteelblue",t.TTMSFNCGraphicsColorObject.$create("Create$1",[14599344])),e.FColorLookup.AddObject("lightyellow",t.TTMSFNCGraphicsColorObject.$create("Create$1",[14745599])),e.FColorLookup.AddObject("lime",t.TTMSFNCGraphicsColorObject.$create("Create$1",[65280])),e.FColorLookup.AddObject("limegreen",t.TTMSFNCGraphicsColorObject.$create("Create$1",[3329330])),e.FColorLookup.AddObject("linen",t.TTMSFNCGraphicsColorObject.$create("Create$1",[15134970])),e.FColorLookup.AddObject("magenta",t.TTMSFNCGraphicsColorObject.$create("Create$1",[16711935])),e.FColorLookup.AddObject("maroon",t.TTMSFNCGraphicsColorObject.$create("Create$1",[128])),e.FColorLookup.AddObject("mediumaquamarine",t.TTMSFNCGraphicsColorObject.$create("Create$1",[11193702])),e.FColorLookup.AddObject("mediumblue",t.TTMSFNCGraphicsColorObject.$create("Create$1",[13434880])),e.FColorLookup.AddObject("mediumorchid",t.TTMSFNCGraphicsColorObject.$create("Create$1",[13850042])),e.FColorLookup.AddObject("mediumpurple",t.TTMSFNCGraphicsColorObject.$create("Create$1",[14381203])),e.FColorLookup.AddObject("mediumseagreen",t.TTMSFNCGraphicsColorObject.$create("Create$1",[7451452])),e.FColorLookup.AddObject("mediumslateblue",t.TTMSFNCGraphicsColorObject.$create("Create$1",[15624315])),e.FColorLookup.AddObject("mediumspringgreen",t.TTMSFNCGraphicsColorObject.$create("Create$1",[10156544])),e.FColorLookup.AddObject("mediumturquoise",t.TTMSFNCGraphicsColorObject.$create("Create$1",[13422920])),e.FColorLookup.AddObject("mediumvioletred",t.TTMSFNCGraphicsColorObject.$create("Create$1",[8721863])),e.FColorLookup.AddObject("midnightblue",t.TTMSFNCGraphicsColorObject.$create("Create$1",[7346457])),e.FColorLookup.AddObject("mintcream",t.TTMSFNCGraphicsColorObject.$create("Create$1",[16449525])),e.FColorLookup.AddObject("mistyrose",t.TTMSFNCGraphicsColorObject.$create("Create$1",[14804223])),e.FColorLookup.AddObject("moccasin",t.TTMSFNCGraphicsColorObject.$create("Create$1",[11920639])),e.FColorLookup.AddObject("navajowhite",t.TTMSFNCGraphicsColorObject.$create("Create$1",[11394815])),e.FColorLookup.AddObject("navy",t.TTMSFNCGraphicsColorObject.$create("Create$1",[8388608])),e.FColorLookup.AddObject("oldlace",t.TTMSFNCGraphicsColorObject.$create("Create$1",[15136253])),e.FColorLookup.AddObject("olive",t.TTMSFNCGraphicsColorObject.$create("Create$1",[32896])),e.FColorLookup.AddObject("olivedrab",t.TTMSFNCGraphicsColorObject.$create("Create$1",[2330219])),e.FColorLookup.AddObject("orange",t.TTMSFNCGraphicsColorObject.$create("Create$1",[42495])),e.FColorLookup.AddObject("orangered",t.TTMSFNCGraphicsColorObject.$create("Create$1",[17919])),e.FColorLookup.AddObject("orchid",t.TTMSFNCGraphicsColorObject.$create("Create$1",[14053594])),e.FColorLookup.AddObject("palegoldenrod",t.TTMSFNCGraphicsColorObject.$create("Create$1",[11200750])),e.FColorLookup.AddObject("palegreen",t.TTMSFNCGraphicsColorObject.$create("Create$1",[10025880])),e.FColorLookup.AddObject("paleturquoise",t.TTMSFNCGraphicsColorObject.$create("Create$1",[15658671])),e.FColorLookup.AddObject("palevioletred",t.TTMSFNCGraphicsColorObject.$create("Create$1",[9662683])),e.FColorLookup.AddObject("papayawhip",t.TTMSFNCGraphicsColorObject.$create("Create$1",[14020607])),e.FColorLookup.AddObject("peachpuff",t.TTMSFNCGraphicsColorObject.$create("Create$1",[12180223])),e.FColorLookup.AddObject("peru",t.TTMSFNCGraphicsColorObject.$create("Create$1",[4163021])),e.FColorLookup.AddObject("pink",t.TTMSFNCGraphicsColorObject.$create("Create$1",[13353215])),e.FColorLookup.AddObject("plum",t.TTMSFNCGraphicsColorObject.$create("Create$1",[14524637])),e.FColorLookup.AddObject("powderblue",t.TTMSFNCGraphicsColorObject.$create("Create$1",[15130800])),e.FColorLookup.AddObject("purple",t.TTMSFNCGraphicsColorObject.$create("Create$1",[8388736])),e.FColorLookup.AddObject("red",t.TTMSFNCGraphicsColorObject.$create("Create$1",[255])),e.FColorLookup.AddObject("rosybrown",t.TTMSFNCGraphicsColorObject.$create("Create$1",[9408444])),e.FColorLookup.AddObject("royalblue",t.TTMSFNCGraphicsColorObject.$create("Create$1",[14772545])),e.FColorLookup.AddObject("saddlebrown",t.TTMSFNCGraphicsColorObject.$create("Create$1",[1262987])),e.FColorLookup.AddObject("salmon",t.TTMSFNCGraphicsColorObject.$create("Create$1",[7504122])),e.FColorLookup.AddObject("sandybrown",t.TTMSFNCGraphicsColorObject.$create("Create$1",[6333684])),e.FColorLookup.AddObject("seagreen",t.TTMSFNCGraphicsColorObject.$create("Create$1",[5737262])),e.FColorLookup.AddObject("seashell",t.TTMSFNCGraphicsColorObject.$create("Create$1",[15660543])),e.FColorLookup.AddObject("sienna",t.TTMSFNCGraphicsColorObject.$create("Create$1",[2970272])),e.FColorLookup.AddObject("skyblue",t.TTMSFNCGraphicsColorObject.$create("Create$1",[15453831])),e.FColorLookup.AddObject("slateblue",t.TTMSFNCGraphicsColorObject.$create("Create$1",[13458026])),e.FColorLookup.AddObject("slategray",t.TTMSFNCGraphicsColorObject.$create("Create$1",[9470064])),e.FColorLookup.AddObject("slategrey",t.TTMSFNCGraphicsColorObject.$create("Create$1",[9470064])),e.FColorLookup.AddObject("snow",t.TTMSFNCGraphicsColorObject.$create("Create$1",[16448255])),e.FColorLookup.AddObject("springgreen",t.TTMSFNCGraphicsColorObject.$create("Create$1",[8388352])),e.FColorLookup.AddObject("steelblue",t.TTMSFNCGraphicsColorObject.$create("Create$1",[11829830])),e.FColorLookup.AddObject("violet",t.TTMSFNCGraphicsColorObject.$create("Create$1",[15631086])),e.FColorLookup.AddObject("thistle",t.TTMSFNCGraphicsColorObject.$create("Create$1",[14204888])),e.FColorLookup.AddObject("tan",t.TTMSFNCGraphicsColorObject.$create("Create$1",[9221330])),e.FColorLookup.AddObject("tomato",t.TTMSFNCGraphicsColorObject.$create("Create$1",[4678655])),e.FColorLookup.AddObject("turquoise",t.TTMSFNCGraphicsColorObject.$create("Create$1",[13688896])),e.FColorLookup.AddObject("wheat",t.TTMSFNCGraphicsColorObject.$create("Create$1",[11788021])),e.FColorLookup.AddObject("whitesmoke",t.TTMSFNCGraphicsColorObject.$create("Create$1",[16119285])),e.FColorLookup.AddObject("yellowgreen",t.TTMSFNCGraphicsColorObject.$create("Create$1",[3329434])),e.FColorLookup.AddObject("red",t.TTMSFNCGraphicsColorObject.$create("Create$1",[255])),e.FColorLookup.AddObject("black",t.TTMSFNCGraphicsColorObject.$create("Create$1",[0])),e.FColorLookup.AddObject("blue",t.TTMSFNCGraphicsColorObject.$create("Create$1",[16711680])),e.FColorLookup.AddObject("green",t.TTMSFNCGraphicsColorObject.$create("Create$1",[32768])),e.FColorLookup.AddObject("aqua",t.TTMSFNCGraphicsColorObject.$create("Create$1",[16776960])),e.FColorLookup.AddObject("yellow",t.TTMSFNCGraphicsColorObject.$create("Create$1",[65535])),e.FColorLookup.AddObject("fuchsia",t.TTMSFNCGraphicsColorObject.$create("Create$1",[16711935])),e.FColorLookup.AddObject("white",t.TTMSFNCGraphicsColorObject.$create("Create$1",[16777215])),e.FColorLookup.AddObject("lime",t.TTMSFNCGraphicsColorObject.$create("Create$1",[65280])),e.FColorLookup.AddObject("silver",t.TTMSFNCGraphicsColorObject.$create("Create$1",[12632256])),e.FColorLookup.AddObject("gray",t.TTMSFNCGraphicsColorObject.$create("Create$1",[8421504])),e.FColorLookup.AddObject("olive",t.TTMSFNCGraphicsColorObject.$create("Create$1",[32896])),e.FColorLookup.AddObject("navy",t.TTMSFNCGraphicsColorObject.$create("Create$1",[8388608])),e.FColorLookup.AddObject("purple",t.TTMSFNCGraphicsColorObject.$create("Create$1",[8388736])),e.FColorLookup.AddObject("teal",t.TTMSFNCGraphicsColorObject.$create("Create$1",[8421376])),e.FColorLookup.AddObject("orange",t.TTMSFNCGraphicsColorObject.$create("Create$1",[42495])),e.FColorLookup.AddObject("maroon",t.TTMSFNCGraphicsColorObject.$create("Create$1",[128])),e.FColorLookup.Sort()}}),["WEBLib.TMSFNCUtils","SysUtils","Math"]),rtl.module("WEBLib.TMSFNCHTMLEngine",["System","Classes","WEBLib.TMSFNCGraphics","Types","WEBLib.Graphics","WEBLib.TMSFNCTypes","WEBLib.TMSFNCBitmapContainer","WEBLib.TMSFNCGraphicsTypes"],(function(){"use strict";var t=this,e=t.$impl;this.TMSFNCHTMLENGINE_ATTR_DELIM='"';this.HTMLDrawEx$1=function(i,s,o,n,r,a,l,h,F,p,c,u,C,T,S,d,m,f,g,y,M,b,N,B,E,D,L,G,A,I,P,w,$,R,v,W,O,x,k,V,H,U){var z,K,j,Y=!1,q="",X=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),J=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),Q=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),Z=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),_=0,tt=0,et=0,it=0,st=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),ot=0,nt=0,rt=null,at=0,lt=null,ht=0,Ft=null,pt=0,ct=0,ut=null,Ct=0,Tt=0,St=0,dt=null,mt=0,ft=!1,gt=!1,yt=!1,Mt=!1,bt=!1,Nt=!1,Bt=0,Et=0,Dt=0,Lt=0,Gt=0,At="",It="",Pt="",wt=pas.Types.TPoint.$new(),$t=!1,Rt=!1,vt=!1,Wt=!1,Ot=0,xt=0,kt=0,Vt=0,Ht=0,Ut=0,zt=!1,Kt=!1,jt=0,Yt={},qt=0,Xt=0,Jt=0,Qt=0,Zt=0,_t=0,te=0,ee=!1,ie=pas.Types.TRect.$new(),se=pas.Types.TPoint.$new(),oe=0,ne=0,re=0;function ae(i,s,n,r,p,c,L,v,W,x,z,K,j,Y,q,X,J,_,tt){var et="",st="",ot="",nt="",lt="",ht="",Ft=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),pt=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),ut={},Ct=!1,dt=!1,mt=!1,ft=0,gt=0,Mt=0,It=0,Ot=0,xt=0,kt=0,Vt=0,Ht=0,Kt=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),Jt=0,te=0,ie=0,oe=0,ne=null,ae=!1,le=0,he=0,Fe=0,pe=0,ce=0,ue="",Ce=!1,Te=pas["WEBLib.TMSFNCTypes"].TPointF.$new(),Se=pas["WEBLib.TMSFNCTypes"].TPointF.$new(),de="",me="",fe="",ge="",ye="",Me="",be="";for("","",ce=0,n.Bottom=n.Bottom-L.get(),p.set(0),kt=0,Ct=!1,dt=!1,mt=!1,Y.set(!1),q.set(!1),Ft.$assign(n),st="",r||(Ft.Left=Ft.Left+X),vt&&!r&&(Et=i.FStroke.FColor,i.FStroke.SetColor(i.FFill.FColor),i.FFill.SetKind(0),i.FStroke.SetKind(1),i.DrawRectangle$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(o.Left,n.Top,o.Right,n.Top+c.get())),2));s.get().length>0&&!Ct&&!dt;){for(Jt=pas.System.Pos("<",s.get()),te=S?pas.System.Pos(" ",s.get()):0,pe=(et=Jt>0&&(te>Jt||0===te)?pas.System.Copy(s.get(),1,Jt-1):te>0?pas.System.Copy(s.get(),1,te):s.get()).length;pas.System.Pos("&nbsp;",et)>0;)pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.TagReplaceString("&nbsp;"," ",{get:function(){return et},set:function(t){et=t}});for(;pas.System.Pos("&lt;",et)>0;)pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.TagReplaceString("&lt;","<",{get:function(){return et},set:function(t){et=t}});for(;pas.System.Pos("&gt;",et)>0;)pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.TagReplaceString("&gt;",">",{get:function(){return et},set:function(t){et=t}});if(pe>0&&(Kt.$assign(i.CalculateText(et,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(0,0,1e4,1e4)),!1,!1)),Vt=Kt.Bottom-Kt.Top,Rt&&L.get()<Vt/4&&L.set(Vt/4),$t&&v.get()<Vt/4&&v.set(Vt/4),Vt>c.get()&&c.set(Vt),B.set(B.get()+et),zt&&pas.System.Delete(s,1,pe),!zt)){if(r)Ft.$assign(n),Kt.$assign(i.CalculateText(et,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(0,0,1e4,1e4)),!1,!1)),Ft.Right=Ft.Left+(Kt.Right-Kt.Left),j>Ft.Top&&j<Ft.Bottom&&K>p.get()&&((jt=0)===pe?pe:jt),ce=Ft.Right-Ft.Left,p.set(p.get()+ce),K-Ft.Left>=p.get()-ce&&K-Ft.Left<=p.get()&&yt&&(Y.set(!0),j>Ft.Top&&(N.set(At),bt=!0));else{if($t&&(Ft.Bottom=Ft.Bottom-v.get()),Rt&&(Ft.Bottom=Ft.Bottom+L.get()),Ft.Bottom=Ft.Bottom-W.get(),Kt.$assign(i.CalculateText(et,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(0,0,1e4,1e4)),!1,!1)),Ht=Kt.Right-Kt.Left,-1!==Tt&&(i.FFill.SetColor(Tt),i.FStroke.SetColor(Tt),i.FFill.SetKind(1),i.FStroke.SetKind(1),Kt.$assign(i.CalculateText$1("gh")),i.DrawRectangle$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(Ft.Left,Ft.Top,Ft.Left+Ht,Ft.Top+(Kt.Bottom-Kt.Top))),2)),Tt=-1,Wt&&(pas["WEBLib.TMSFNCTypes"].OffsetRectEx$1(Ft,h,h),i.FFont.SetColor(b),i.DrawText$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(Ft),et,!1,1,0,0,0,-1,-1,!1,!1,-1,-1),pas["WEBLib.TMSFNCTypes"].OffsetRectEx$1(Ft,-h,-h),i.FFont.SetColor(at)),ht=""!==et&&" "===et.charAt(et.length-1)&&yt?et+"\0":et,i.FFont.SetColor(ct),i.DrawText$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(Ft),ht,!1,1,0,0,0,-1,-1,!1,!1,-1,-1),Ft.Right=Ft.Left+Ht,yt&&G.get()-1===a&&E.set(At),Nt)for(i.FStroke.SetColor(255),i.FStroke.SetKind(1),i.FStroke.SetWidth(1),ie=(oe=Math.round(Ft.Left/2*2))%4==0?2:0;oe<Ft.Right;)Te.$assign(pas["WEBLib.TMSFNCTypes"].PointF(oe,n.Bottom+ie-1)),ie=2===ie?0:2,Se.$assign(pas["WEBLib.TMSFNCTypes"].PointF(oe+2,n.Bottom+ie-1)),i.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(Te),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(Se),2,2),oe+=2;Ft.Left=Ft.Right,Ft.Right=n.Right,Ft.Bottom=n.Bottom,Ft.Top=n.Top}Ce=p.get()<n.Right-n.Left-_t+1||n.Right-n.Left-_t<=ce,et,Ce||!S?(st+=pas.System.Copy(s.get(),1,pe),pas.System.Delete(s,1,pe),et.length>=pe&&" "===pas.System.Copy(et,pe,1)?(Kt.$assign(i.CalculateText$1(" ")),kt=Kt.Right-Kt.Left):kt=0):(Ct=!0,p.set(p.get()-ce))}if(1===(Jt=pas.System.Pos("<",s.get()))&&s.get().length<=2&&s.set(""),!Ct&&1===Jt&&s.get().length>2){if("/"===s.get().charAt(1)&&s.get().length>3){var Ne=pas.System.upcase(s.get().charAt(2));"A"===Ne?(T&&l!==G.get()||r||(i.FFont.SetStyle(rtl.diffSet(i.FFont.FStyle,rtl.createSet(3))),-1!==y&&(Tt=y),-1!==M&&(ct=M)),u||(ct=at),yt=!1,bt&&(Q.Bottom=n.Bottom,Q.Right=n.Left+p.get(),n.Top!==Q.Top&&(Q.Left=n.Left,Q.Top=n.Top),I.$assign(Q),A.set(G.get()),bt=!1),a===G.get()-1&&(Z.Right=Ft.Left,Z.Bottom=Ft.Bottom-W.get(),Kt.$assign(i.CalculateText$1("gh")),Z.Top=Z.Bottom-(Kt.Bottom-Kt.Top),pas["WEBLib.TMSFNCTypes"].InflateRectEx(Z,1,0))):"E"===Ne?r||(Nt=!1):"B"===Ne?">"!==s.get().charAt(3)?ct=at:i.FFont.SetStyle(rtl.diffSet(i.FFont.FStyle,rtl.createSet(0))):"S"===Ne?"U"===(ue=pas.System.upcase(s.get().charAt(3)))?($t=!1,Rt=!1):"H"===ue?Wt=!1:i.FFont.SetStyle(rtl.diffSet(i.FFont.FStyle,rtl.createSet(2))):"F"===Ne?(i.FFont.SetName(rt.FName),i.FFont.SetSize(rt.FSize),r||u||(ct=at,i.FFill.SetColor(St))):"H"===Ne?r||(ct=Lt,Tt=Gt,i.FFont.SetStyle(rtl.refSet(Yt)),i.FFill.SetColor(Gt)):"I"===Ne?i.FFont.SetStyle(rtl.diffSet(i.FFont.FStyle,rtl.createSet(1))):"L"===Ne?Ct=!0:"O"===Ne?J.set(0):"P"===Ne?(Ct=!0,r||(i.FFill.SetColor(Bt),vt=!1)):"U"===Ne?">"!==s.get().charAt(3)&&Ut>0?Ut-=1:i.FFont.SetStyle(rtl.diffSet(i.FFont.FStyle,rtl.createSet(3))):"R"===Ne||"Z"===Ne&&(zt=!1)}else{var Be=pas.System.upcase(s.get().charAt(1));if("A"===Be)a!==G.get()||r||(Z.Left=Ft.Left,Z.Top=Ft.Top),G.set(G.get()+1),T&&l!==G.get()||r||(k&&i.FFont.SetStyle(rtl.unionSet(i.FFont.FStyle,rtl.createSet(3))),-1===y||r||(Tt=y),-1!==M&&(ct=M)),u||-1!==M&&l===G.get()&&T||(at=ct,ct=g),ot=pas.System.Copy(s.get(),3,pas.System.Pos(">",s.get())-1),nt=pas.System.Copy(ot,pas.System.Pos('"',ot)+1,ot.length),nt=pas.System.Copy(nt,1,pas.System.Pos('"',nt)-1),At=nt,yt=!0,Q.Left=p.get(),Q.Top=n.Top;else if("B"===Be){var Ee=ue=pas.System.upcase(s.get().charAt(2));if(">"===Ee)i.FFont.SetStyle(rtl.unionSet(i.FFont.FStyle,rtl.createSet(0)));else if("R"===Ee)Ct=!0,B.set(B.get()+"\r");else if("L"===Ee)C||(ct=Dt);else if("O"===Ee&&(Mt=0,st+=pas.System.Copy(s.get(),1,pas.System.Pos(">",s.get())),!r&&!u)){if(ot=pas.SysUtils.UpperCase(pas.System.Copy(s.get(),6,pas.System.Pos(">",s.get())-1)),pas.System.Pos("BACKGROUND",ot)>0&&(nt=pas.System.Copy(ot,pas.System.Pos("BACKGROUND",ot)+10,ot.length),nt=pas.System.Copy(nt,pas.System.Pos('"',nt)+1,nt.length),nt=pas.System.Copy(nt,1,pas.System.Pos('"',nt)-1),pas.System.Pos("IDX:",pas.SysUtils.UpperCase(nt))>0&&pas.System.Delete({get:function(){return nt},set:function(t){nt=t}},1,4),ne=null,ae=!1,0===pas.System.Pos(":",nt)&&null!=O&&(ne=O.FindBitmap$1(nt)),pas.System.Pos("URL://",pas.SysUtils.UpperCase(nt))>0&&(pas.System.Delete({get:function(){return nt},set:function(t){nt=t}},1,6),ne=pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.CreateFromURL(nt),ae=!0),null!=ne)){if(!pas["WEBLib.TMSFNCTypes"].IsBitmapEmpty(ne)&&ne.GetWidth()>0&&ne.GetHeight()>0)for(;Mt<o.Bottom-o.Top;){for(gt=0;gt<o.Right-o.Left;)i.DrawBitmap$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(Math.round(o.Left+gt),Math.round(o.Top+Mt),Math.round(o.Left+gt)+ne.GetWidth(),Math.round(o.Top+Mt)+ne.GetHeight())),ne,!0,!1,!0,!1),gt+=ne.GetWidth();Mt+=ne.GetHeight()}ae&&(ne=rtl.freeLoc(ne))}pas.System.Pos("BGTOPLEFT",ot)>0&&(nt=pas.System.Copy(ot,pas.System.Pos("BGTOPLEFT",ot)+10,ot.length),nt=pas.System.Copy(nt,pas.System.Pos('"',nt)+1,nt.length),nt=pas.System.Copy(nt,1,pas.System.Pos('"',nt)-1),ne=null,0===pas.System.Pos(":",nt)&&null!=O&&(ne=O.FindBitmap$1(nt)),null!=ne&&!pas["WEBLib.TMSFNCTypes"].IsBitmapEmpty(ne)&&ne.GetWidth()>0&&ne.GetHeight()>0&&i.DrawBitmap$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(Math.round(o.Left),Math.round(o.Top+Mt),Math.round(o.Left)+ne.GetWidth(),Math.round(o.Top)+ne.GetHeight())),ne,!0,!1,!0,!1)),pas.System.Pos("BGTOPRIGHT",ot)>0&&(nt=pas.System.Copy(ot,pas.System.Pos("BGTOPRIGHT",ot)+10,ot.length),nt=pas.System.Copy(nt,pas.System.Pos('"',nt)+1,nt.length),nt=pas.System.Copy(nt,1,pas.System.Pos('"',nt)-1),ne=null,0===pas.System.Pos(":",nt)&&null!=O&&(ne=O.FindBitmap$1(nt)),null!=ne&&!pas["WEBLib.TMSFNCTypes"].IsBitmapEmpty(ne)&&ne.GetWidth()>0&&ne.GetHeight()>0&&i.DrawBitmap$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(Math.round(o.Right)-ne.GetWidth(),Math.round(o.Top+Mt),Math.round(o.Right),Math.round(o.Top)+ne.GetHeight())),ne,!0,!1,!0,!1)),pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.VarPos("BGCOLOR",ot,{get:function(){return Jt},set:function(t){Jt=t}})>0&&(nt=pas.System.Copy(ot,Jt+5,ot.length),nt=pas.System.Copy(nt,pas.System.Pos('"',nt)+1,nt.length),le=-1,(nt=pas.System.Copy(nt,1,pas.System.Pos('"',nt)-1)).length>0&&(le="#"===nt.charAt(0)?pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.HTMLToColor(nt):pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.TextToColor(pas.SysUtils.LowerCase(nt))),pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.VarPos("BGCOLORTO",ot,{get:function(){return Jt},set:function(t){Jt=t}})>0?(nt=pas.System.Copy(ot,Jt+5,ot.length),nt=pas.System.Copy(nt,pas.System.Pos('"',nt)+1,nt.length),nt=pas.System.Copy(nt,1,pas.System.Pos('"',nt)-1),nt="H",pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.VarPos("DIR",ot,{get:function(){return Jt},set:function(t){Jt=t}})>0&&(nt=pas.System.Copy(ot,Jt+3,ot.length),nt=pas.System.Copy(nt,pas.System.Pos('"',nt)+1,nt.length),nt=pas.System.Copy(nt,1,pas.System.Pos('"',nt)-1)),i.FStroke.SetColor(le)):(St=i.FFill.FColor,i.FFill.SetColor(le),Et=i.FStroke.FColor,i.FStroke.SetColor(le),i.FFill.SetKind(1),i.FStroke.SetKind(1),i.DrawRectangle$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(o.Left-2,o.Top,o.Right,o.Bottom)),2),i.FStroke.SetColor(Et)))}}else if("E"===Be)r||(Nt=!0);else if("C"===Be)ot=pas.System.Copy(s.get(),9,pas.System.Pos(">",s.get())-1),de="",ge="",ye="",me="",fe="",Me="",be="",t.ParseControl(ot,{get:function(){return de},set:function(t){de=t}},{get:function(){return ge},set:function(t){ge=t}},{get:function(){return ye},set:function(t){ye=t}},{get:function(){return me},set:function(t){me=t}},{get:function(){return fe},set:function(t){fe=t}},{get:function(){return Me},set:function(t){Me=t}},{get:function(){return be},set:function(t){be=t}}),it=25,""!==fe&&(pas.System.val$8(fe,{get:function(){return it},set:function(t){it=t}},{get:function(){return xt},set:function(t){xt=t}}),0!==xt&&(it=25)),""===me&&"CHECK"!==de&&"RADIO"!==de||(pas.System.val$6(me,{get:function(){return ft},set:function(t){ft=t}},{get:function(){return xt},set:function(t){xt=t}}),0===xt&&(wt.x=ft,wt.y=Math.round(i.CalculateTextHeight$1("gh"))+10),"CHECK"===de||"RADIO"===de?c.set(16):c.set(23),it>25&&c.set(it-2),r||("CHECK"===de&&(wt.x=Math.round(16*f)+2,wt.y=wt.x,ft=wt.x,pt.$assign(pas["WEBLib.TMSFNCTypes"].RectF(Ft.Left+1,Ft.Top+(Ft.Bottom-Ft.Top-(wt.y-2))/2,Ft.Left+wt.x-1,Ft.Top+(Ft.Bottom-Ft.Top-(wt.y-2))/2+(wt.y-2))),pt.$assign(pas["WEBLib.TMSFNCTypes"].RectF(Math.round(pt.Left),Math.round(pt.Top),Math.round(pt.Right),Math.round(pt.Bottom))),i.DrawCheckBox(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pt),"TRUE"===pas.SysUtils.UpperCase(ye),d&&m===ge,!0,1)),"RADIO"===de&&(wt.x=Math.round(16*f)+2,wt.y=wt.x,ft=wt.x,pt.$assign(pas["WEBLib.TMSFNCTypes"].RectF(Ft.Left+1,Ft.Top+(Ft.Bottom-Ft.Top-(wt.y-2))/2,Ft.Left+wt.x-1,Ft.Top+(Ft.Bottom-Ft.Top-(wt.y-2))/2+(wt.y-2))),pt.$assign(pas["WEBLib.TMSFNCTypes"].RectF(Math.round(pt.Left),Math.round(pt.Top),Math.round(pt.Right),Math.round(pt.Bottom))),i.DrawRadioButton(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pt),"TRUE"===pas.SysUtils.UpperCase(ye),d&&m===ge,!0,1)),"BUTTON"===de&&(wt.y=22,pt.$assign(pas["WEBLib.TMSFNCTypes"].RectF(Ft.Left+2,Ft.Top+(Ft.Bottom-Ft.Top-wt.y)/2,Ft.Left+ft-2,Ft.Top+(Ft.Bottom-Ft.Top-wt.y)/2+wt.y)),ee=pas["WEBLib.TMSFNCTypes"].PtInRectEx(pt,pas["WEBLib.TMSFNCTypes"].PointF(K,j)),pt.$assign(pas["WEBLib.TMSFNCTypes"].RectF(Math.round(pt.Left),Math.round(pt.Top),Math.round(pt.Right),Math.round(pt.Bottom))),i.DrawButton(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pt),d&&m===ge,ee,!0,!0,1),pas["WEBLib.TMSFNCTypes"].InflateRectEx(pt,-2,-2),i.DrawText$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pt),ye,!1,0,0,0,0,-1,-1,!0,!1,-1,-1))),"BUTTON"===de&&(wt.y=22),"COMBO"===de&&(wt.y=25),"CHECK"!==de&&"RADIO"!==de||(wt.x=Math.round(16*f)+2,wt.y=wt.x),(K-n.Left>p.get()&&K-n.Left<p.get()+wt.x&&j>Ft.Top&&j<Ft.Top+wt.y||F&&w.get()===ge)&&(q.set(!0),N.set("ctrl"),qt=Xt,pt.Left=n.Left+p.get(),pt.Right=pt.Left+wt.x,pt.Top=Ft.Top,pt.Bottom=Ft.Top+wt.y,P.$assign(pt),$.set(ye),w.set(ge),R.set(de)),p.get()+wt.x>n.Right-n.Left&&wt.x<n.Right-n.Left?dt=!0:(p.set(p.get()+wt.x),Ft.Left=Ft.Left+wt.x,wt.y>c.get()&&c.set(wt.y)));else if("H"===Be){var De=pas.System.upcase(s.get().charAt(2));"R"===De?(Ct=!0,r||(ot=pas.System.Copy(s.get(),4,pas.System.Pos(">",s.get())-1),le=0,pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.VarPos("COLOR",pas.SysUtils.UpperCase(ot),{get:function(){return Jt},set:function(t){Jt=t}})>0&&(nt=pas.System.Copy(ot,Jt+5,ot.length),nt=pas.System.Copy(nt,pas.System.Pos('"',nt)+1,nt.length),(nt=pas.System.Copy(nt,1,pas.System.Pos('"',nt)-1)).length>0&&(le="#"===nt.charAt(0)?pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.HTMLToColor(nt):pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.TextToColor(pas.SysUtils.LowerCase(nt)))),i.FStroke.SetKind(1),Et=i.FStroke.FColor,i.FStroke.SetColor(le),Te.$assign(pas["WEBLib.TMSFNCTypes"].PointF(n.Left,Ft.Bottom+1)),Se.$assign(pas["WEBLib.TMSFNCTypes"].PointF(n.Right,Ft.Bottom+1)),i.FStroke.SetKind(1),i.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(Te),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(Se),2,2),i.FStroke.SetColor(Et))):"I"===De&&(r||(Lt=ct,Gt=Tt,Yt=rtl.refSet(i.FFont.FStyle),Tt=V,ct=H),i.FFont.SetStyle(rtl.refSet(U)))}else if("I"===Be)">"===(ue=pas.System.upcase(s.get().charAt(2)))?i.FFont.SetStyle(rtl.unionSet(i.FFont.FStyle,rtl.createSet(1))):"N"===ue?(ot=pas.System.Copy(s.get(),3,pas.System.Pos(">",s.get())-1),nt=pas.System.Copy(ot,pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.IPos("x",ot)+2,ot.length),nt=pas.System.Copy(nt,pas.System.Pos('"',nt)+1,nt.length),nt=pas.System.Copy(nt,1,pas.System.Pos('"',nt)-1),pas.System.val$6(nt,{get:function(){return ft},set:function(t){ft=t}},{get:function(){return xt},set:function(t){xt=t}}),0===xt&&ft>p.get()&&(p.set(ft),Ft.Left=o.Left+ft)):"M"===ue&&(0,0,re=0,Math.round(i.CalculateTextHeight$1("gh")),Xt+=1,pt.$assign(Ft),ot=pas.System.Copy(s.get(),3,pas.System.Pos(">",s.get())-1),nt=pas.System.Copy(ot,pas.System.Pos("SRC",pas.SysUtils.UpperCase(ot))+4,ot.length),nt=pas.System.Copy(nt,pas.System.Pos('"',nt)+1,nt.length),nt=pas.System.Copy(nt,1,pas.System.Pos('"',nt)-1),ot=pas.SysUtils.UpperCase(ot),pas.System.Pos("ALT",ot)>0&&qt===Xt&&(nt=pas.System.Copy(ot,pas.System.Pos("ALT",ot)+4,ot.length),nt=pas.System.Copy(nt,pas.System.Pos('"',nt)+1,nt.length),nt=pas.System.Copy(nt,1,pas.System.Pos('"',nt)-1)),he=0,Fe=0,pas.System.Pos("WIDTH",ot)>0&&(lt=pas.System.Copy(ot,pas.System.Pos("WIDTH",ot)+6,ot.length),lt=pas.System.Copy(lt,pas.System.Pos('"',lt)+1,lt.length),lt=pas.System.Copy(lt,1,pas.System.Pos('"',lt)-1),pas.System.val$6(lt,{get:function(){return he},set:function(t){he=t}},{get:function(){return xt},set:function(t){xt=t}})),pas.System.Pos("HEIGHT",ot)>0&&(lt=pas.System.Copy(ot,pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.IPos("HEIGHT",ot)+7,ot.length),lt=pas.System.Copy(lt,pas.System.Pos('"',lt)+1,lt.length),lt=pas.System.Copy(lt,1,pas.System.Pos('"',lt)-1),pas.System.val$6(lt,{get:function(){return Fe},set:function(t){Fe=t}},{get:function(){return xt},set:function(t){xt=t}})),pas.System.Pos("ALIGN",ot)>0&&(lt=pas.System.Copy(ot,pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.IPos("ALIGN",ot)+6,ot.length),lt=pas.System.Copy(lt,pas.System.Pos('"',lt)+1,lt.length),"MIDDLE"===(lt=pas.System.Copy(lt,1,pas.System.Pos('"',lt)-1))&&1,"TOP"===lt&&2),pas.System.Pos("FLOAT",ot)>0&&(lt=pas.System.Copy(ot,pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.IPos("FLOAT",ot)+6,ot.length),lt=pas.System.Copy(lt,pas.System.Pos('"',lt)+1,lt.length),"LEFT"===(lt=pas.System.Copy(lt,1,pas.System.Pos('"',lt)-1))&&(re=1,pt.Left=o.Left),"RIGHT"===lt&&(re=2)),wt.x=0,wt.y=0,pas.System.Pos("IDX:",pas.SysUtils.UpperCase(nt))>0&&pas.System.Delete({get:function(){return nt},set:function(t){nt=t}},1,4),ne=null,ae=!1,0===pas.System.Pos(":",nt)&&null!=O&&(ne=O.FindBitmap$1(nt)),pas.System.Pos("URL://",pas.SysUtils.UpperCase(nt))>0&&(pas.System.Delete({get:function(){return nt},set:function(t){nt=t}},1,6),ne=pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.CreateFromURL(nt),ae=!0),pas.System.Pos("DATA:",pas.SysUtils.UpperCase(nt))>0&&pas.System.Pos("BASE64,",pas.SysUtils.UpperCase(nt))>0&&(pas.System.Delete({get:function(){return nt},set:function(t){nt=t}},1,pas.System.Pos("BASE64,",pas.SysUtils.UpperCase(nt))+6),ne=pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.$create("Create$3"),pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.LoadBitmapFromBase64(nt,ne,!1),ae=!0),It=0,Ot=0,null!=ne&&(pas["WEBLib.TMSFNCTypes"].IsBitmapEmpty(ne)||(he>0&&Fe>0&&(It=he,Ot=Fe),he>0&&0===Fe&&(It=he,Ot=Math.round(he/ne.GetWidth()*ne.GetHeight())),0===he&&Fe>0&&(It=Math.round(Fe/ne.GetHeight()*ne.GetWidth()),Ot=Fe),0===he&&0===Fe&&(It=ne.GetWidth(),Ot=ne.GetHeight()),2===re&&(pt.Left=n.Right-It),r||(he>0||Fe>0?i.DrawBitmap$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(Math.round(pt.Left),Math.round(pt.Top),Math.round(pt.Left)+It,Math.round(pt.Top)+Ot)),ne,!0,!1,!0,!1):he>0&&0===Fe?i.DrawBitmap$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(Math.round(pt.Left),Math.round(pt.Top),Math.round(pt.Left)+he,Math.round(pt.Top)+Fe)),ne,!0,!1,!0,!1):i.DrawBitmap$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(Math.round(pt.Left),Math.round(pt.Top),Math.round(pt.Left)+ne.GetWidth(),Math.round(pt.Top)+ne.GetHeight())),ne,!0,!1,!0,!1)),he>0||Fe>0?(wt.x=It,wt.y=Ot):(wt.x=ne.GetWidth(),wt.y=ne.GetHeight())),ae&&(ne=rtl.freeLoc(ne))),K-n.Left>p.get()&&K-n.Left<p.get()+wt.x&&j>Ft.Top&&j<Ft.Top+wt.y&&yt&&(q.set(!0),N.set(At),qt=Xt),p.get()+wt.x>n.Right-n.Left&&wt.x<n.Right-n.Left?dt=!0:(p.set(p.get()+wt.x+2),Ft.Left=Ft.Left+wt.x+2,wt.y>c.get()&&c.set(wt.y)),pas.System.Pos("ALIGN",ot)>0&&(pas.System.Pos('"TOP',ot)>0?(Kt.$assign(i.CalculateText$1("gh")),W.set(c.get()-(Kt.Bottom-Kt.Top))):pas.System.Pos('"MIDDLE',ot)>0&&(Kt.$assign(i.CalculateText$1("gh")),W.set((c.get()-(Kt.Bottom-Kt.Top))/2))),pas.System.Pos("WRAP",ot)>0&&(Kt.$assign(i.CalculateText$1("gh")),c.set(Kt.Bottom-Kt.Top),W.set(0)),1===re&&(Kt.$assign(i.CalculateText$1("gh")),W.set(c.get()-(Kt.Bottom-Kt.Top)),_.Left=It,_.Bottom=Ot,r||(Kt.$assign(i.CalculateText$1("gh")),c.set(Kt.Bottom-Kt.Top))),2===re&&(Kt.$assign(i.CalculateText$1("gh")),W.set(c.get()-(Kt.Bottom-Kt.Top)),_.Right=It,_.Bottom=Ot,r||(Kt.$assign(i.CalculateText$1("gh")),c.set(Kt.Bottom-Kt.Top)),p.set(o.Right)));else if("L"===Be)le=-1,Pt="",pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.VarPos(">",s.get(),{get:function(){return Jt},set:function(t){Jt=t}})>0&&(ot=pas.SysUtils.UpperCase(pas.System.Copy(s.get(),3,Jt-1)),pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.VarPos("TYPE",ot,{get:function(){return Jt},set:function(t){Jt=t}})>0&&(nt=pas.System.Copy(ot,Jt+4,ot.length),nt=pas.System.Copy(nt,pas.System.Pos('"',nt)+1,nt.length),nt=pas.System.Copy(nt,1,pas.System.Pos('"',nt)-1),Pt=nt),pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.VarPos("COLOR",ot,{get:function(){return Jt},set:function(t){Jt=t}})>0&&(nt=pas.System.Copy(ot,Jt+5,ot.length),nt=pas.System.Copy(nt,pas.System.Pos('"',nt)+1,nt.length),(nt=pas.System.Copy(nt,1,pas.System.Pos('"',nt)-1)).length>0&&(le="#"===nt.charAt(0)?pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.HTMLToColor(nt):pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.TextToColor(nt)))),p.set(p.get()+12*Ut),mt?dt=!0:mt=!0,Ft.Left=Ft.Left+12*(Ut-1),r||zt||(""===Pt?(-1!==le&&(Qt=i.FFont.FColor,ct=le),nt=i.FFont.FName,ut=rtl.refSet(i.FFont.FStyle),i.FFont.SetStyle({}),pas.System.Odd(Ut)?i.DrawText$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(Ft),"•",!1,1,0,0,0,-1,-1,!1,!1,-1,-1):i.DrawText$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(Ft),"o",!1,1,0,0,0,-1,-1,!1,!1,-1,-1),i.FFont.SetName(nt),i.FFont.SetStyle(rtl.refSet(ut)),-1!==le&&(ct=Qt)):(Zt=-1,"SQUARE"===Pt&&(Zt=i.FFill.FColor,i.FStroke.SetColor(le),i.FFill.SetColor(le),i.FFill.SetKind(1),i.FStroke.SetKind(1),i.DrawRectangle$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(Ft.Left,Ft.Top+2,Ft.Left+8,Ft.Top+10)),2),i.FFill.SetColor(Zt)),"CIRCLE"===Pt&&(Zt=i.FFill.FColor,i.FStroke.SetColor(le),i.FFill.SetColor(le),i.FFill.SetKind(1),i.FStroke.SetKind(1),i.DrawEllipse$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(Ft.Left,Ft.Top+2,Ft.Left+8,Ft.Top+10)),2),i.FFill.SetColor(Zt)))),Ft.Left=Ft.Left+12;else if("U"===Be)">"!==s.get().charAt(2)?(Ut+=1,Ct=!0):i.FFont.SetStyle(rtl.unionSet(i.FFont.FStyle,rtl.createSet(3)));else if("O"===Be)"F"===(ue=pas.System.upcase(s.get().charAt(2)))&&(ot=pas.System.Copy(s.get(),3,pas.System.Pos(">",s.get())-1),nt=pas.System.Copy(ot,pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.IPos("x",ot)+2,ot.length),nt=pas.System.Copy(nt,pas.System.Pos('"',nt)+1,nt.length),nt=pas.System.Copy(nt,1,pas.System.Pos('"',nt)-1),pas.System.val$6(nt,J,{get:function(){return xt},set:function(t){xt=t}}),Ft.Left=J.get(),p.set(J.get()));else if("P"===Be)pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.VarPos(">",s.get(),{get:function(){return Jt},set:function(t){Jt=t}})>0&&(ot=pas.SysUtils.UpperCase(pas.System.Copy(s.get(),3,Jt-1)),pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.VarPos("ALIGN",ot,{get:function(){return Jt},set:function(t){Jt=t}})>0&&(nt=pas.System.Copy(ot,Jt+5,ot.length),nt=pas.System.Copy(nt,pas.System.Pos('"',nt)+1,nt.length),nt=pas.System.Copy(nt,1,pas.System.Pos('"',nt)-1),pas.System.Pos("RIGHT",nt)>0&&x.set(1),pas.System.Pos("LEFT",nt)>0&&x.set(0),pas.System.Pos("CENTER",nt)>0&&x.set(2)),pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.VarPos("INDENT",ot,{get:function(){return Jt},set:function(t){Jt=t}})>0&&(nt=pas.System.Copy(ot,Jt+6,ot.length),nt=pas.System.Copy(nt,pas.System.Pos('"',nt)+1,nt.length),nt=pas.System.Copy(nt,1,pas.System.Pos('"',nt)-1),z.set(e.IStrToInt(nt))),pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.VarPos("FLOAT",ot,{get:function(){return Jt},set:function(t){Jt=t}})>0&&(nt=pas.System.Copy(ot,Jt+5,ot.length),nt=pas.System.Copy(nt,pas.System.Pos('"',nt)+1,nt.length),"LEFT"===(nt=pas.System.Copy(nt,1,pas.System.Pos('"',nt)-1))&&tt.set(1),"RIGHT"===nt&&tt.set(2),se.$assign(pas.Types.Point(Math.round(n.Left),Math.round(n.Top)))),pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.VarPos("BGCOLOR",ot,{get:function(){return Jt},set:function(t){Jt=t}})>0&&(nt=pas.System.Copy(ot,Jt+5,ot.length),nt=pas.System.Copy(nt,pas.System.Pos('"',nt)+1,nt.length),le=-1,(nt=pas.System.Copy(nt,1,pas.System.Pos('"',nt)-1)).length>0&&(le="#"===nt.charAt(0)?pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.HTMLToColor(nt):pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.TextToColor(nt)),pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.VarPos("BGCOLORTO",ot,{get:function(){return Jt},set:function(t){Jt=t}})>0?(nt=pas.System.Copy(ot,Jt+5,ot.length),nt=pas.System.Copy(nt,pas.System.Pos('"',nt)+1,nt.length),nt=pas.System.Copy(nt,1,pas.System.Pos('"',nt)-1),r||(vt=!0,i.FStroke.SetColor(le))):r||(vt=!0,Bt=i.FFill.FColor,i.FFill.SetColor(le),Et=i.FStroke.FColor,i.FStroke.SetColor(le),i.FFill.SetKind(1),i.FStroke.SetKind(1),i.DrawRectangle$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(o.Left,n.Top,o.Right,n.Bottom)),2))));else if("F"===Be){if(pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.VarPos(">",s.get(),{get:function(){return Jt},set:function(t){Jt=t}})>0)if(ot=pas.SysUtils.UpperCase(pas.System.Copy(s.get(),6,Jt-6)),pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.VarPos("FACE",ot,{get:function(){return Jt},set:function(t){Jt=t}})>0&&(nt=pas.System.Copy(ot,Jt+4,ot.length),nt=pas.System.Copy(nt,pas.System.Pos('"',nt)+1,nt.length),nt=pas.System.Copy(nt,1,pas.System.Pos('"',nt)-1),i.FFont.SetName(nt)),pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.VarPos(" COLOR",ot,{get:function(){return Jt},set:function(t){Jt=t}})>0&&!u&&(nt=pas.System.Copy(ot,Jt+6,ot.length),nt=pas.System.Copy(nt,pas.System.Pos('"',nt)+1,nt.length),nt=pas.System.Copy(nt,1,pas.System.Pos('"',nt)-1),at=-1!==i.FFill.FColor?i.FFont.FColor:0,nt.length>0&&(ct="#"===nt.charAt(0)?pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.HTMLToColor(nt):pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.TextToColor(nt))),pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.VarPos("BGCOLOR",ot,{get:function(){return Jt},set:function(t){Jt=t}})>0&&!r&&!u&&(nt=pas.System.Copy(ot,Jt+7,ot.length),nt=pas.System.Copy(nt,pas.System.Pos('"',nt)+1,nt.length),(nt=pas.System.Copy(nt,1,pas.System.Pos('"',nt)-1)).length>0&&(Tt="#"===nt.charAt(0)?pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.HTMLToColor(nt):pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.TextToColor(nt))),pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.VarPos("STYLE",ot,{get:function(){return Jt},set:function(t){Jt=t}})>0)nt=pas.System.Copy(ot,Jt+5,ot.length),nt=pas.System.Copy(nt,pas.System.Pos("=",nt)+1,nt.length),nt=pas.System.Copy(nt,pas.System.Pos('"',nt)+1,nt.length),pas.System.Pos("FONT-SIZE:",pas.SysUtils.UpperCase(nt))>0&&(pas.System.Delete({get:function(){return nt},set:function(t){nt=t}},1,10),pas.System.Pos("PT",pas.SysUtils.UpperCase(nt))>0&&(nt=pas.SysUtils.Trim(pas.System.Copy(nt,1,pas.System.Pos("PT",pas.SysUtils.UpperCase(nt))-1)),pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.SetFontSize(i.FFont,e.IStrToInt(nt),1)));else if(pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.VarPos("SIZE",ot,{get:function(){return Jt},set:function(t){Jt=t}})>0){nt=pas.System.Copy(ot,Jt+4,ot.length),nt=pas.System.Copy(nt,pas.System.Pos("=",nt)+1,nt.length),nt=pas.System.Copy(nt,pas.System.Pos('"',nt)+1,nt.length),nt=pas.System.Copy(nt,1,pas.System.Pos('"',nt)-1);var Le=e.IStrToInt(nt);1===Le?pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.SetFontSize(i.FFont,8,1):2===Le?pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.SetFontSize(i.FFont,10,1):3===Le?pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.SetFontSize(i.FFont,12,1):4===Le?pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.SetFontSize(i.FFont,14,1):5===Le?pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.SetFontSize(i.FFont,16,1):pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.SetFontSize(i.FFont,e.IStrToInt(nt),1)}}else"S"===Be?">"===(ue=pas.System.upcase(s.get().charAt(2)))?i.FFont.SetStyle(rtl.unionSet(i.FFont.FStyle,rtl.createSet(2))):"H"===ue?Wt=!0:1===pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.IPos("<SUB>",s.get())?Rt=!0:1===pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.IPos("<SUP>",s.get())&&($t=!0):"R"===Be?(ot=pas.System.Copy(s.get(),3,pas.System.Pos(">",s.get())-1),nt=pas.System.Copy(ot,pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.IPos("a",ot)+2,ot.length),nt=pas.System.Copy(nt,pas.System.Pos('"',nt)+1,nt.length),nt=pas.System.Copy(nt,1,pas.System.Pos('"',nt)-1)):"Z"===Be&&(zt=!0)}pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.VarPos(">",s.get(),{get:function(){return Jt},set:function(t){Jt=t}})>0&&!dt?(st+=pas.System.Copy(s.get(),1,Jt),pas.System.Delete(s,1,Jt)):dt||pas.System.Delete(s,1,s.get().length)}}return p.set(p.get()-kt),p.get()>D.get()&&D.set(p.get()+2),a===G.get()-1&&yt&&!r&&(Z.Right=Ft.Left,Z.Bottom=Ft.Bottom,pas["WEBLib.TMSFNCTypes"].InflateRectEx(Z,1,0),Z.Left=n.Left+1,Z.Top=Z.Bottom),st}if(yt=!1,Nt=!1,(rt=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFont.$create("Create$2")).AssignSource(i.FFont),at=i.FFont.FColor,(Ft=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFont.$create("Create$2")).AssignSource(i.FFont),pt=i.FFont.FColor,(lt=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFont.$create("Create$2")).AssignSource(i.FFont),ht=i.FFont.FColor,(dt=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFont.$create("Create$2")).AssignSource(i.FFont),mt=i.FFont.FColor,(ut=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFont.$create("Create$2")).AssignSource(i.FFont),Ct=i.FFont.FColor,Dt=i.FFill.FColor,z=i.FStroke.FColor,j=i.FFill.FKind,K=i.FStroke.FKind,St=-1,Tt=-1,Bt=-1,vt=!1,Wt=!1,zt=!1,P.$assign(pas["WEBLib.TMSFNCTypes"].RectF(0,0,0,0)),$.set(""),R.set(""),F||w.set(""),_t=0,te=0,oe=0,ie.$assign(pas.Types.Rect(0,0,0,0)),Y=!1,X.$assign(o),ot=0,nt=0,D.set(0),L.set(0),G.set(0),Ot=0,Ut=0,xt=0,B.set(""),E.set(""),A.set(-1),bt=!1,Xt=0,qt=-1,pas.System.Pos("&",s)>0){s=pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.UnFixMarkup(s,!0,!0);do{Kt=!1,pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.TagReplaceString("&amp;","&",{get:function(){return s},set:function(t){s=t}})&&(Kt=!0)}while(Kt)}for(s=e.DBTagStrip(s),s=e.UnicodeTagStrip(s),s=e.CRLFStrip(s,!0),0,v.set(0);s.length>0;){rt.AssignSource(ut),at=Ct,i.FFont.AssignSource(lt),ct=ht,Mt=yt,It=At,Ht=0,Vt=0,kt=0,$t=!1,Rt=!1,ft=!1,gt=!1,_=0,st.$assign(i.CalculateText$1("gh")),et=tt=st.Bottom-st.Top,Jt=Xt,s=pas.SysUtils.Trim(s),ne=oe,q=ae(i,{get:function(){return s},set:function(t){s=t}},pas["WEBLib.TMSFNCTypes"].TRectF.$clone(X),!0,{get:function(){return _},set:function(t){_=t}},{get:function(){return tt},set:function(t){tt=t}},{get:function(){return Vt},set:function(t){Vt=t}},{get:function(){return Ht},set:function(t){Ht=t}},{get:function(){return kt},set:function(t){kt=t}},{get:function(){return ot},set:function(t){ot=t}},{get:function(){return nt},set:function(t){nt=t}},n,r,{get:function(){return ft},set:function(t){ft=t}},{get:function(){return gt},set:function(t){gt=t}},_t,{get:function(){return te},set:function(t){te=t}},ie,{get:function(){return oe},set:function(t){oe=t}}),v.set(v.get()+1),yt=Mt,At=It,lt.AssignSource(i.FFont),ht=i.FFont.FColor,ut.AssignSource(rt),Ct=at,tt+=W,J.$assign(X);var le=ot;2===le?X.Right-X.Left-_>0&&(J.Left=X.Left+(X.Right-X.Left-_)/2):1===le&&X.Right-_>X.Left&&(J.Left=X.Right-_),J.Left=J.Left+nt,J.Right=J.Right+nt,J.Bottom=J.Top+tt+Vt+Ht,p||(rt.AssignSource(dt),at=mt,i.FFont.AssignSource(Ft),ct=pt,G.set(Ot),Ut=xt,Xt=Jt,ae(i,{get:function(){return q},set:function(t){q=t}},pas["WEBLib.TMSFNCTypes"].TRectF.$clone(J),F,{get:function(){return _},set:function(t){_=t}},{get:function(){return tt},set:function(t){tt=t}},{get:function(){return Vt},set:function(t){Vt=t}},{get:function(){return Ht},set:function(t){Ht=t}},{get:function(){return kt},set:function(t){kt=t}},{get:function(){return ot},set:function(t){ot=t}},{get:function(){return nt},set:function(t){nt=t}},n,r,{get:function(){return ft},set:function(t){ft=t}},{get:function(){return gt},set:function(t){gt=t}},_t,{get:function(){return te},set:function(t){te=t}},ie,{get:function(){return oe},set:function(t){oe=t}}),Ot=G.get(),xt=Ut,X.Left=o.Left+ie.Left,X.Right=o.Right-ie.Right,J.Top>ie.Bottom&&(ie.Left=0,ie.Right=0,X.Left=o.Left),st.$assign(i.CalculateText$1("gh")),(ft&&r>J.Bottom-kt-(st.Bottom-st.Top)&&r<J.Bottom-kt||gt)&&(Y=!0),_t=te,Ft.AssignSource(i.FFont),pt=ct,dt.AssignSource(rt),mt=at),0!==oe&&oe!==ne?(X.Left=se.x,X.Top=se.y,oe=0):(X.Top=X.Top+tt+Vt+Ht,L.set(L.get()+tt+Vt+Ht)),X.Top+et>X.Bottom+1&&!p&&(s="")}return 0===L.get()&&(st.$assign(i.CalculateText$1("gh")),L.set(st.Bottom-st.Top)),1,i.FStroke.SetKind(K),i.FFill.SetKind(j),i.FStroke.SetColor(z),i.FFill.SetColor(Dt),i.FFont.AssignSource(rt),rt=rtl.freeLoc(rt),Ft=rtl.freeLoc(Ft),lt=rtl.freeLoc(lt),dt=rtl.freeLoc(dt),ut=rtl.freeLoc(ut),Y},this.HiLight=function(t,i,s,o){var n="",r=0,a=0;for(n=pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.HTMLStrip(t),r=0,pas.System.Pos(i,t)>0&&(pas.System.Pos("<",n)>0||pas.System.Pos(">",n)>0)&&(n=pas.SysUtils.StringReplace(n,"<","&lt;",rtl.createSet(0)),n=pas.SysUtils.StringReplace(n,">","&gt;",rtl.createSet(0)),t=n,i=pas.SysUtils.StringReplace(i,"<","&lt;",rtl.createSet(0)),i=pas.SysUtils.StringReplace(i,">","&gt;",rtl.createSet(0))),a=0;e.PosFrom(i,n,r,o,{get:function(){return a},set:function(t){a=t}})>0;)r=a+i.length,pas.System.Insert("<"+s+">",{get:function(){return t},set:function(e){t=e}},e.StripPos2HTMLPos(t,a)),pas.System.Insert("</"+s+">",{get:function(){return t},set:function(e){t=e}},e.StripPos2HTMLPos(t,r));return t},this.ParseControl=function(i,s,o,n,r,a,l,h){var F="",p=0;s.set(""),r.set(""),a.set(""),n.set(""),o.set(""),l.set(""),h.set(""),p=0,e.VarIPos("TYPE=",i,{get:function(){return p},set:function(t){p=t}})>0&&(F=pas.System.Copy(i,p+1,i.length),F=pas.System.Copy(F,pas.System.Pos(t.TMSFNCHTMLENGINE_ATTR_DELIM,F)+1,F.length),F=pas.System.Copy(F,1,pas.System.Pos(t.TMSFNCHTMLENGINE_ATTR_DELIM,F)-1),s.set(pas.SysUtils.UpperCase(F))),e.VarIPos("WIDTH=",i,{get:function(){return p},set:function(t){p=t}})>0&&(F=pas.System.Copy(i,p+1,i.length),F=pas.System.Copy(F,pas.System.Pos(t.TMSFNCHTMLENGINE_ATTR_DELIM,F)+1,F.length),F=pas.System.Copy(F,1,pas.System.Pos(t.TMSFNCHTMLENGINE_ATTR_DELIM,F)-1),r.set(F)),e.VarIPos("HEIGHT=",i,{get:function(){return p},set:function(t){p=t}})>0&&(F=pas.System.Copy(i,p+1,i.length),F=pas.System.Copy(F,pas.System.Pos(t.TMSFNCHTMLENGINE_ATTR_DELIM,F)+1,F.length),F=pas.System.Copy(F,1,pas.System.Pos(t.TMSFNCHTMLENGINE_ATTR_DELIM,F)-1),a.set(F)),e.VarIPos("ID=",i,{get:function(){return p},set:function(t){p=t}})>0&&(F=pas.System.Copy(i,p+1,i.length),F=pas.System.Copy(F,pas.System.Pos(t.TMSFNCHTMLENGINE_ATTR_DELIM,F)+1,F.length),F=pas.System.Copy(F,1,pas.System.Pos(t.TMSFNCHTMLENGINE_ATTR_DELIM,F)-1),o.set(F)),e.VarIPos("VALUE=",i,{get:function(){return p},set:function(t){p=t}})>0&&(F=pas.System.Copy(i,p+1,i.length),F=pas.System.Copy(F,pas.System.Pos(t.TMSFNCHTMLENGINE_ATTR_DELIM,F)+1,F.length),F=pas.System.Copy(F,1,pas.System.Pos(t.TMSFNCHTMLENGINE_ATTR_DELIM,F)-1),n.set(pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.UnFixMarkup(F,!0,!1))),e.VarIPos("PROP=",i,{get:function(){return p},set:function(t){p=t}})>0&&(F=pas.System.Copy(i,p+1,i.length),F=pas.System.Copy(F,pas.System.Pos(t.TMSFNCHTMLENGINE_ATTR_DELIM,F)+1,F.length),F=pas.System.Copy(F,1,pas.System.Pos(t.TMSFNCHTMLENGINE_ATTR_DELIM,F)-1),l.set(pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.UnFixMarkup(F,!0,!1))),e.VarIPos("MAXLEN=",i,{get:function(){return p},set:function(t){p=t}})>0&&(F=pas.System.Copy(i,p+1,i.length),F=pas.System.Copy(F,pas.System.Pos(t.TMSFNCHTMLENGINE_ATTR_DELIM,F)+1,F.length),F=pas.System.Copy(F,1,pas.System.Pos(t.TMSFNCHTMLENGINE_ATTR_DELIM,F)-1),h.set(F))},t.$implcode=function(){e.VarIPos=function(t,e,i){return i.set(pas.System.Pos(t,pas.SysUtils.UpperCase(e))),i.get()},e.StripPos2HTMLPos=function(t,e){var i=0,s=0,o=0,n=!1;i=0,o=1,n=!1;for(var r=1,a=t.length;r<=a;r++){if(s=r,"<"===t.charAt(s-1)&&(n=!0),o===e)return i=s;n||(o+=1),">"===t.charAt(s-1)&&(n=!1)}return o===e&&(i=t.length+1),i},e.PosFrom=function(t,e,i,s,o){var n=0,r=0;return n=0,o.set(0),i>0&&pas.System.Delete({get:function(){return e},set:function(t){e=t}},1,i),(r=s?pas.System.Pos(t,e):pas.System.Pos(pas["WEBLib.TMSFNCTypes"].AnsiUpperCase(t),pas["WEBLib.TMSFNCTypes"].AnsiUpperCase(e)))>0&&(o.set(i+r),n=o.get()),n},e.IStrToInt=function(t){var e=0,i=0;return pas.System.val$6(t,{get:function(){return i},set:function(t){i=t}},{get:function(){return e},set:function(t){e=t}}),i},e.DBTagStrip=function(t){var e,i="",s=0;return(e=pas.System.Pos("<#",t))>0?(i=pas.System.Copy(t,1,e-1),pas.System.Delete({get:function(){return t},set:function(e){t=e}},1,e),(s=pas.System.Pos(">",t))>0&&pas.System.Delete({get:function(){return t},set:function(e){t=e}},s,1),i+=t):i=t,i},e.HexVal=function(t){return t.length<2?0:((t.charAt(0)>="A"?t.charCodeAt(0)-65+10:t.charCodeAt(0)-48)<<4)+(t.charAt(1)>="A"?t.charCodeAt(1)-65+10:t.charCodeAt(1)-48)},e.UnicodeTagStrip=function(t){var i=0,s=0,o=0,n=0,r="",a="",l=0,h=!1;function F(t,e){var i=0,s=0,o=0;i=o=e?4:3;for(var n=o,r=t.length;n<=r;n++){if(s=n,!(t.charAt(s-1)>="0"&&t.charAt(s-1)<="9")){i=s;break}if(e&&!(t.charAt(s-1)>="A"&&t.charAt(s-1)<="F")&&e&&!(t.charAt(s-1)>="a"&&t.charAt(s-1)<="f")){i=s;break}}return i}a="";do{if(i=pas.System.Pos("&#",t),(o=pas.System.Pos("&&#",t))===i-1&&0!==o&&(i=0),i>0)if(a+=pas.System.Copy(t,1,i-1),pas.System.Delete({get:function(){return t},set:function(e){t=e}},1,i-1),h=1===pas.System.Pos("&#x",t),(s=pas.System.Pos(";",t))>7&&(s=F(t,h)),s>0){if(h){r=pas.System.Copy(t,4,s-4);try{l=e.HexVal(r),n=0}catch(t){l=0}}else r=pas.System.Copy(t,3,s-3),pas.System.val$6(r,{get:function(){return l},set:function(t){l=t}},{get:function(){return n},set:function(t){n=t}});r.length>0&&r.length<=6&&0===n&&(a+=String.fromCharCode(l),pas.System.Delete({get:function(){return t},set:function(e){t=e}},1,s))}else a+="&#",pas.System.Delete({get:function(){return t},set:function(e){t=e}},1,2);else a+=t}while(!(i<=0));return a},e.CRLFStrip=function(t,e){var i="",s=0;i="";for(var o=1,n=t.length;o<=n;o++)s=o,"\r"!==t.charAt(s-1)&&"\n"!==t.charAt(s-1)?i+=t.charAt(s-1):"\r"===t.charAt(s-1)&&e&&(i+="<BR>");return i}}}),["SysUtils","WEBLib.TMSFNCUtils"]),rtl.module("WEBLib.TMSFNCGraphics.General",["System","Classes","WEBLib.TMSFNCGraphicsTypes","Types","WEBLib.Graphics","WEBLib.TMSFNCGraphics","WEBLib.TMSFNCTypes"],(function(){"use strict";rtl.createClass(this,"TTMSFNCGraphicsContextGeneral",pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphicsContext,(function(){this.$init=function(){pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphicsContext.$init.call(this),this.FOldPenStyle=0,this.FOldPenWidth=0},this.DrawRotatedText=function(t,e,i,s,o,n){var r,a=0,l=0,h=pas["WEBLib.Graphics"].TCanvasRectF.$new();r=i,e.Left,e.Top,t.TextWidth(r),t.TextHeight(r);1===o?a=0:0===o?a=2:2===o&&(a=1);0===n?l=2:1===n?l=0:2===n&&(l=1),h.$assign(pas["WEBLib.Graphics"].CreateCanvasRectF(e.Left,e.Top,e.Right,e.Bottom)),t.TextRect$1(pas["WEBLib.Graphics"].TCanvasRectF.$clone(h),r,!1,!1,a,l)},this.Destroy=function(){pas.System.TObject.Destroy.call(this)},this.GetFillColor=function(){return this.GetCanvas().FBrush.FColor},this.CalculateText=function(t,e,i){var s=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),o=pas["WEBLib.Graphics"].TCanvasRectF.$new();return o.$assign(pas["WEBLib.Graphics"].CreateCanvasRectF(e.Left,e.Top,e.Right,e.Bottom)),o.$assign(this.GetCanvas().TextRect$1(pas["WEBLib.Graphics"].TCanvasRectF.$clone(o),t,i,!0,0,0)),s.$assign(pas["WEBLib.TMSFNCTypes"].RectF(o.Left,o.Top,o.Right,o.Bottom)),s},this.SetTextAngle=function(t,e){var i=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),s=0,o=pas["WEBLib.TMSFNCTypes"].TPointF.$new(),n=0,r=0,a=0,l=0,h=0,F=0;return i.$assign(t),0!==e&&(s=pas.Math.DegToRad(e),o.X=i.Left+(i.Right-i.Left)/2,o.Y=i.Top+(i.Bottom-i.Top)/2,this.GetCanvas().Transform(Math.cos(s),Math.sin(s),-Math.sin(s),Math.cos(s),o.X,o.Y),a=i.Right-i.Left,h=i.Bottom-i.Top,n=Math.cos(s),r=Math.sin(s),l=Math.abs(a*n)+Math.abs(h*r),F=Math.abs(a*r)+Math.abs(h*n),i.$assign(pas["WEBLib.TMSFNCTypes"].RectF(-l/2,-F/2,l/2,F/2))),i},this.CreatePath=function(){return null,null},this.Render=function(){},this.PathOpen=function(t){},this.PathMoveTo=function(t,e){this.GetCanvas().PathMoveTo$1(e.X,e.Y)},this.PathLineTo=function(t,e){this.GetCanvas().PathLineTo$1(e.X,e.Y)},this.PathClose=function(t){this.GetCanvas().PathClose()},this.SetTextQuality=function(t){},this.SetAntiAliasing=function(t){},this.SetShowAcceleratorChar=function(t){},this.SetSize=function(t,e){},this.ResetTextAngle=function(t){0!==t&&this.GetCanvas().SetTransform(1,0,0,1,0,0)},this.BeginScene=function(){null!=this.GetCanvas()&&(this.GetCanvas().BeginScene(),this.GetCanvas().Clear())},this.EndScene=function(){this.GetCanvas().EndScene()},this.StartSpecialPen=function(){this.FOldPenStyle=this.GetCanvas().FPen.FStyle,this.FOldPenWidth=this.GetCanvas().FPen.FWidth,this.GetCanvas().FPen.FStyle=2,this.GetCanvas().FPen.FWidth=1},this.StopSpecialPen=function(){this.GetCanvas().FPen.FStyle=this.FOldPenStyle,this.GetCanvas().FPen.FWidth=this.FOldPenWidth},this.RestoreState=function(t){null!=t&&(t.FSaveDC=0),this.GetCanvas().Restore(),this.GetCanvas().Refresh()},this.SaveState=function(t){this.GetCanvas().Refresh(),this.GetCanvas().Save()},this.SetFont=function(t){this.GetCanvas().FFont.Assign(t)},this.SetFill=function(t){this.GetCanvas().FBrush.FColor=t.FColor,this.GetCanvas().FBrush.FGradient=0,this.GetCanvas().FBrush.ClearGradient();var e=t.FKind;if(1===e)this.GetCanvas().FBrush.FStyle=0;else if(2===e){this.GetCanvas().FBrush.ClearGradient(),-1!==t.FColorMirror&&-1!==t.FColorMirrorTo?(this.GetCanvas().FBrush.AddGradientColor(t.FColor,0),this.GetCanvas().FBrush.AddGradientColor(t.FColorTo,.5),this.GetCanvas().FBrush.AddGradientColor(t.FColorMirror,.5),this.GetCanvas().FBrush.AddGradientColor(t.FColorMirrorTo,1)):(this.GetCanvas().FBrush.AddGradientColor(t.FColor,0),this.GetCanvas().FBrush.AddGradientColor(t.FColorTo,1));var i=t.FOrientation;0===i?this.GetCanvas().FBrush.FGradient=2:1===i&&(this.GetCanvas().FBrush.FGradient=1)}else 0===e&&(this.GetCanvas().FBrush.FStyle=1)},this.SetFillColor=function(t){this.GetCanvas().FBrush.FColor=t},this.SetStroke=function(t){this.GetCanvas().FPen.SetColor(t.FColor),this.GetCanvas().FPen.FWidth=Math.round(t.FWidth);var e=t.FKind;1===e?this.GetCanvas().FPen.FStyle=0:0===e?this.GetCanvas().FPen.FStyle=5:2===e?this.GetCanvas().FPen.FStyle=1:3===e?this.GetCanvas().FPen.FStyle=2:4===e?this.GetCanvas().FPen.FStyle=3:5===e&&(this.GetCanvas().FPen.FStyle=4)},this.DrawLine=function(t,e,i,s,o){this.GetCanvas().MoveTo$1(e.X,e.Y),this.GetCanvas().LineTo$1(i.X,i.Y)},this.DrawPolygon=function(t,e){var i,s,o=[],n=0;o=rtl.arraySetLength(o,pas["WEBLib.Graphics"].TCanvasPointF,rtl.length(e));for(var r=0,a=rtl.length(e)-1;r<=a;r++)o[n=r].$assign(pas["WEBLib.Graphics"].CreateCanvasPointF(e[n].X,e[n].Y));s=this.GetCanvas().FBrush.FColor,i=this.GetCanvas().FBrush.FStyle,this.GetCanvas().FBrush.FStyle=1,this.GetCanvas().Polygon$1(o),this.GetCanvas().FBrush.FStyle=i,this.GetCanvas().FBrush.FColor=s},this.FillPolygon=function(t,e){var i,s=[],o=0;s=rtl.arraySetLength(s,pas["WEBLib.Graphics"].TCanvasPointF,rtl.length(e));for(var n=0,r=rtl.length(e)-1;n<=r;n++)s[o=n].$assign(pas["WEBLib.Graphics"].CreateCanvasPointF(e[o].X,e[o].Y));i=this.GetCanvas().FPen.FStyle,this.GetCanvas().FPen.FStyle=5,this.GetCanvas().Polygon$1(s),this.GetCanvas().FPen.FStyle=i},this.DrawPolyline=function(t,e){var i,s,o=0,n=[];n=rtl.arraySetLength(n,pas["WEBLib.Graphics"].TCanvasPointF,rtl.length(e));for(var r=0,a=rtl.length(e)-1;r<=a;r++)n[o=r].$assign(pas["WEBLib.Graphics"].CreateCanvasPointF(e[o].X,e[o].Y));s=this.GetCanvas().FBrush.FColor,i=this.GetCanvas().FBrush.FStyle,this.GetCanvas().FBrush.FStyle=1,this.GetCanvas().Polyline$1(n),this.GetCanvas().FBrush.FStyle=i,this.GetCanvas().FBrush.FColor=s},this.FillPolyline=function(t,e){var i,s=[],o=0;s=rtl.arraySetLength(s,pas["WEBLib.Graphics"].TCanvasPointF,rtl.length(e));for(var n=0,r=rtl.length(e)-1;n<=r;n++)s[o=n].$assign(pas["WEBLib.Graphics"].CreateCanvasPointF(e[o].X,e[o].Y));i=this.GetCanvas().FPen.FStyle,this.GetCanvas().FPen.FStyle=5,this.GetCanvas().Polyline$1(s),this.GetCanvas().FPen.FStyle=i},this.FillArc=function(t,e,i,s,o){var n;n=this.GetCanvas().FPen.FStyle,this.GetCanvas().FPen.FStyle=5,this.GetCanvas().AngleArc$1(e.X,e.Y,i.X,pas.Math.DegToRad(s),pas.Math.DegToRad(o)),this.GetCanvas().FPen.FStyle=n},this.DrawArc=function(t,e,i,s,o){var n,r;r=this.GetCanvas().FBrush.FColor,n=this.GetCanvas().FBrush.FStyle,this.GetCanvas().FBrush.FStyle=1,this.GetCanvas().AngleArc$1(e.X,e.Y,i.X,pas.Math.DegToRad(s),pas.Math.DegToRad(o)),this.GetCanvas().FBrush.FStyle=n,this.GetCanvas().FBrush.FColor=r},this.FillRect=function(t,e,i){var s,o=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),n=0,r=0;if(e.$assign(pas["WEBLib.TMSFNCGraphicsTypes"].ModifyRect(e,i)),o.$assign(pas["WEBLib.TMSFNCTypes"].RectF(e.Left,e.Top,e.Right,e.Bottom)),n=-1,r=1,2===t.FKind){if(-1!==t.FColor&&-1!==t.FColorTo)if(-1!==t.FColorMirror&&-1!==t.FColorMirrorTo){var a=t.FOrientation;0===a?(pas["WEBLib.TMSFNCGraphicsTypes"].DrawGradient(this.GetCanvas(),t.FColor,t.FColorTo,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(o.Left,o.Top,o.Left+(o.Right-o.Left)/2,o.Bottom)),0,{},!0),pas["WEBLib.TMSFNCGraphicsTypes"].DrawGradient(this.GetCanvas(),t.FColorMirror,t.FColorMirrorTo,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(o.Left+(o.Right-o.Left)/2,o.Top,o.Right,o.Bottom)),0,{},!0)):1===a&&(pas["WEBLib.TMSFNCGraphicsTypes"].DrawGradient(this.GetCanvas(),t.FColor,t.FColorTo,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(o.Left,o.Top,o.Right,o.Top+(o.Bottom-o.Top)/2)),0,{},!1),pas["WEBLib.TMSFNCGraphicsTypes"].DrawGradient(this.GetCanvas(),t.FColorMirror,t.FColorMirrorTo,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(o.Left,o.Top+(o.Bottom-o.Top)/2,o.Right,o.Bottom)),0,{},!1))}else pas["WEBLib.TMSFNCGraphicsTypes"].DrawGradient(this.GetCanvas(),t.FColor,t.FColorTo,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(o),0,{},0===t.FOrientation);n=this.GetCanvas().FBrush.FColor,r=this.GetCanvas().FBrush.FStyle,this.GetCanvas().FBrush.FStyle=1}s=this.GetCanvas().FPen.FStyle,this.GetCanvas().FPen.FStyle=5,-1!==t.FColor&&1===t.FKind&&this.GetCanvas().Rectangle$3(pas["WEBLib.Graphics"].CreateCanvasRectF(o.Left,o.Top,o.Right,o.Bottom)),this.GetCanvas().FPen.FStyle=s,2===t.FKind&&(this.GetCanvas().FBrush.FColor=n,this.GetCanvas().FBrush.FStyle=r)},this.DrawRect=function(t,e,i,s){var o=pas["WEBLib.TMSFNCTypes"].TRectF.$new();e.$assign(pas["WEBLib.TMSFNCGraphicsTypes"].ModifyRect(e,s)),o.$assign(e),1 in i&&this.DrawLine(t,pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(o.Left,o.Top)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(o.Right,o.Top)),2,2),0 in i&&this.DrawLine(t,pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(o.Left,o.Top)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(o.Left,o.Bottom)),2,2),3 in i&&this.DrawLine(t,pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(o.Left,o.Bottom)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(o.Right,o.Bottom)),2,2),2 in i&&this.DrawLine(t,pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(o.Right,o.Top)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(o.Right,o.Bottom)),2,2)},this.FillRoundRect=function(t,e,i,s,o){var n=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),r=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),a={};if(e.$assign(pas["WEBLib.TMSFNCGraphicsTypes"].ModifyRect(e,o)),n.$assign(pas["WEBLib.TMSFNCTypes"].RectF(e.Left,e.Top,e.Right,e.Bottom)),r.$assign(n),r.Bottom=r.Bottom-1,r.Right=r.Right-1,2===t.FKind){if(-1!==t.FColor&&-1!==t.FColorTo)if(-1!==t.FColorMirror&&-1!==t.FColorMirrorTo){var l=t.FOrientation;0===l?(a={},0 in s&&(a=rtl.unionSet(a,rtl.createSet(0))),2 in s&&(a=rtl.unionSet(a,rtl.createSet(2))),pas["WEBLib.TMSFNCGraphicsTypes"].DrawGradient(this.GetCanvas(),t.FColor,t.FColorTo,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(r.Left,r.Top,r.Left+(r.Right-r.Left)/2,n.Bottom)),i,rtl.refSet(a),!0),a={},1 in s&&(a=rtl.unionSet(a,rtl.createSet(1))),3 in s&&(a=rtl.unionSet(a,rtl.createSet(3))),pas["WEBLib.TMSFNCGraphicsTypes"].DrawGradient(this.GetCanvas(),t.FColorMirror,t.FColorMirrorTo,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(r.Left+(r.Right-n.Left)/2,r.Top,r.Right,r.Bottom)),i,rtl.refSet(a),!0)):1===l&&(a={},0 in s&&(a=rtl.unionSet(a,rtl.createSet(0))),1 in s&&(a=rtl.unionSet(a,rtl.createSet(1))),pas["WEBLib.TMSFNCGraphicsTypes"].DrawGradient(this.GetCanvas(),t.FColor,t.FColorTo,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(r.Left,r.Top,r.Right,r.Top+(r.Bottom-r.Top)/2)),i,rtl.refSet(a),!1),a={},2 in s&&(a=rtl.unionSet(a,rtl.createSet(2))),3 in s&&(a=rtl.unionSet(a,rtl.createSet(3))),pas["WEBLib.TMSFNCGraphicsTypes"].DrawGradient(this.GetCanvas(),t.FColorMirror,t.FColorMirrorTo,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(r.Left,r.Top+(r.Bottom-r.Top)/2,r.Right,r.Bottom)),i,rtl.refSet(a),!1))}else pas["WEBLib.TMSFNCGraphicsTypes"].DrawGradient(this.GetCanvas(),t.FColor,t.FColorTo,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(r),i,rtl.refSet(s),0===t.FOrientation)}else-1!==t.FColor&&1===t.FKind&&pas["WEBLib.TMSFNCGraphicsTypes"].DrawGradient(this.GetCanvas(),t.FColor,t.FColor,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(n),i,rtl.refSet(s),0===t.FOrientation)},this.DrawRoundRect=function(t,e,i,s,o){var n,r,a,l=pas["WEBLib.Graphics"].TCanvasRectF.$new(),h=pas["WEBLib.Graphics"].TCanvasRectF.$new();function F(t,e,i,s,o){t.AngleArc$1(e.X,e.Y,i.X,pas.Math.DegToRad(s),pas.Math.DegToRad(o))}e.$assign(pas["WEBLib.TMSFNCGraphicsTypes"].ModifyRect(e,o)),l.$assign(pas["WEBLib.Graphics"].CreateCanvasRectF(e.Left,e.Top,e.Right,e.Bottom)),h.$assign(l),h.Bottom=h.Bottom-1,h.Right=h.Right-1,r=this.GetCanvas().FBrush.FColor,a=this.GetCanvas().FBrush.FStyle,this.GetCanvas().FBrush.FStyle=1,n=Math.round(i),rtl.eqSet(s,rtl.createSet(0,1,2,3))?this.GetCanvas().RoundRect$3(l,2*n,2*n):rtl.eqSet(s,{})?this.GetCanvas().Rectangle$3(l):(2 in s?(this.GetCanvas().MoveTo$1(l.Left+n,l.Bottom),F(this.GetCanvas(),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(l.Left+n,l.Bottom-n)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(n,n)),-270,90),this.GetCanvas().MoveTo$1(l.Left,l.Bottom-n)):this.GetCanvas().MoveTo$1(l.Left,l.Bottom),0 in s?(this.GetCanvas().LineTo$1(l.Left,l.Top+n),F(this.GetCanvas(),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(l.Left+n,l.Top+n)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(n,n)),-180,90),this.GetCanvas().MoveTo$1(l.Left+n,l.Top)):this.GetCanvas().LineTo$1(l.Left,l.Top),1 in s?(this.GetCanvas().LineTo$1(l.Right-n,l.Top),F(this.GetCanvas(),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(l.Right-n,l.Top+n)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(n,n)),-90,90),this.GetCanvas().MoveTo$1(l.Right,l.Top+n)):this.GetCanvas().LineTo$1(l.Right,l.Top),3 in s?(this.GetCanvas().LineTo$1(l.Right,l.Bottom-n),F(this.GetCanvas(),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(l.Right-n,l.Bottom-n)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(n,n)),0,90),this.GetCanvas().MoveTo$1(l.Right-n,l.Bottom)):this.GetCanvas().LineTo$1(l.Right,l.Bottom),2 in s?this.GetCanvas().LineTo$1(l.Left+n,l.Bottom):this.GetCanvas().LineTo$1(l.Left,l.Bottom)),this.GetCanvas().FBrush.FColor=r,this.GetCanvas().FBrush.FStyle=a},this.FillEllipse=function(t,e,i){var s,o=pas["WEBLib.Graphics"].TCanvasRectF.$new();e.$assign(pas["WEBLib.TMSFNCGraphicsTypes"].ModifyRect(e,i)),o.$assign(pas["WEBLib.Graphics"].CreateCanvasRectF(e.Left,e.Top,e.Right,e.Bottom)),s=this.GetCanvas().FPen.FStyle,this.GetCanvas().FPen.FStyle=5,this.GetCanvas().Ellipse$3(o),this.GetCanvas().FPen.FStyle=s},this.DrawEllipse=function(t,e,i){var s,o,n=pas["WEBLib.Graphics"].TCanvasRectF.$new();e.$assign(pas["WEBLib.TMSFNCGraphicsTypes"].ModifyRect(e,i)),n.$assign(pas["WEBLib.Graphics"].CreateCanvasRectF(e.Left,e.Top,e.Right,e.Bottom)),o=this.GetCanvas().FBrush.FColor,s=this.GetCanvas().FBrush.FStyle,this.GetCanvas().FBrush.FStyle=1,this.GetCanvas().Ellipse$3(n),this.GetCanvas().FBrush.FStyle=s,this.GetCanvas().FBrush.FColor=o},this.DrawBitmap=function(t,e,i,s){this.GetCanvas().StretchDraw$1(pas["WEBLib.Graphics"].TCanvasRectF.$clone(pas["WEBLib.Graphics"].CreateCanvasRectF(i.Left,i.Top,i.Right,i.Bottom)),t)},this.ClipRect=function(t){this.GetCanvas().SetClipRect(pas["WEBLib.Graphics"].CreateCanvasRectF(t.Left,t.Top,t.Right,t.Bottom))},this.DrawFocusRectangle=function(t,e,i,s){var o,n,r=pas["WEBLib.Graphics"].TCanvasRectF.$new();e.$assign(pas["WEBLib.TMSFNCGraphicsTypes"].ModifyRect(e,s)),r.$assign(pas["WEBLib.Graphics"].CreateCanvasRectF(e.Left,e.Top,e.Right,e.Bottom)),o=this.GetCanvas().FBrush.FColor,n=this.GetCanvas().FBrush.FStyle,this.GetCanvas().FBrush.FStyle=1,this.GetCanvas().FPen.SetColor(i),this.StartSpecialPen(),this.GetCanvas().Rectangle$3(r),this.StopSpecialPen(),this.GetCanvas().FBrush.FColor=o,this.GetCanvas().FBrush.FStyle=n},this.DrawText=function(t,e,i,s,o,n,r){var a,l,h=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),F=0,p=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),c=null;if(a=this.GetCanvas().FBrush.FColor,l=this.GetCanvas().FBrush.FStyle,this.GetCanvas().FBrush.FStyle=1,p.$assign(pas["WEBLib.TMSFNCTypes"].RectF(e.Left,e.Top,e.Right,e.Bottom)),i){var u=o;0===u?(h.$assign(this.CalculateText(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i)),F=Math.round(h.Bottom-h.Top),p.Top=p.Top+Math.max(0,(p.Bottom-p.Top-F)/2),p.Bottom=Math.max(0,Math.min(Math.round(e.Bottom),p.Top+F))):2===u&&(h.$assign(this.CalculateText(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i)),F=Math.round(h.Bottom-h.Top),p.Top=p.Bottom-F,p.Bottom=p.Top+F)}if(0!==r)this.DrawRotatedText(this.GetCanvas(),pas["WEBLib.TMSFNCTypes"].TRectF.$clone(p),t,r,s,o);else{c=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsSaveState.$create("Create$1");try{this.SaveState(c),this.ClipRect(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(p));var C=s;if(1===C){var T=o;1===T?this.GetCanvas().TextRect$1(pas["WEBLib.Graphics"].TCanvasRectF.$clone(pas["WEBLib.Graphics"].CreateCanvasRectF(p.Left,p.Top,p.Right,p.Bottom)),t,i,!1,0,0):0===T?this.GetCanvas().TextRect$1(pas["WEBLib.Graphics"].TCanvasRectF.$clone(pas["WEBLib.Graphics"].CreateCanvasRectF(p.Left,p.Top,p.Right,p.Bottom)),t,i,!1,0,2):2===T&&this.GetCanvas().TextRect$1(pas["WEBLib.Graphics"].TCanvasRectF.$clone(pas["WEBLib.Graphics"].CreateCanvasRectF(p.Left,p.Top,p.Right,p.Bottom)),t,i,!1,0,1)}else if(0===C){var S=o;1===S?this.GetCanvas().TextRect$1(pas["WEBLib.Graphics"].TCanvasRectF.$clone(pas["WEBLib.Graphics"].CreateCanvasRectF(p.Left,p.Top,p.Right,p.Bottom)),t,i,!1,2,0):0===S?this.GetCanvas().TextRect$1(pas["WEBLib.Graphics"].TCanvasRectF.$clone(pas["WEBLib.Graphics"].CreateCanvasRectF(p.Left,p.Top,p.Right,p.Bottom)),t,i,!1,2,2):2===S&&this.GetCanvas().TextRect$1(pas["WEBLib.Graphics"].TCanvasRectF.$clone(pas["WEBLib.Graphics"].CreateCanvasRectF(p.Left,p.Top,p.Right,p.Bottom)),t,i,!1,2,1)}else if(2===C){var d=o;1===d?this.GetCanvas().TextRect$1(pas["WEBLib.Graphics"].TCanvasRectF.$clone(pas["WEBLib.Graphics"].CreateCanvasRectF(p.Left,p.Top,p.Right,p.Bottom)),t,i,!1,1,0):0===d?this.GetCanvas().TextRect$1(pas["WEBLib.Graphics"].TCanvasRectF.$clone(pas["WEBLib.Graphics"].CreateCanvasRectF(p.Left,p.Top,p.Right,p.Bottom)),t,i,!1,1,2):2===d&&this.GetCanvas().TextRect$1(pas["WEBLib.Graphics"].TCanvasRectF.$clone(pas["WEBLib.Graphics"].CreateCanvasRectF(p.Left,p.Top,p.Right,p.Bottom)),t,i,!1,1,1)}}finally{this.RestoreState(c)}}this.GetCanvas().FBrush.FColor=a,this.GetCanvas().FBrush.FStyle=l},this.DrawPath=function(t,e,i){var s=[];if(null!=e)if(2===i)this.GetCanvas().PathBegin(),this.ConvertToPath(e,.25),this.GetCanvas().PathStroke();else{s=rtl.arraySetLength(s,pas["WEBLib.TMSFNCTypes"].TPointF,0),e.FlattenToPolygon({get:function(){return s},set:function(t){s=t}},.25);var o=i;0===o?this.DrawPolygon(t,rtl.arrayRef(s)):1===o&&this.DrawPolyline(t,rtl.arrayRef(s))}},this.FillPath=function(t,e,i){var s=[];if(null!=e)if(2===i)this.GetCanvas().PathBegin(),this.ConvertToPath(e,.25),this.GetCanvas().PathFill();else{s=rtl.arraySetLength(s,pas["WEBLib.TMSFNCTypes"].TPointF,0),e.FlattenToPolygon({get:function(){return s},set:function(t){s=t}},.25);var o=i;0===o?this.FillPolygon(t,rtl.arrayRef(s)):1!==o&&2!==o||this.FillPolyline(t,rtl.arrayRef(s))}}}))}),["Math"]),rtl.module("WEBLib.TMSFNCGraphics.WEB",["System","Classes","WEBLib.TMSFNCGraphicsTypes","WEBLib.TMSFNCUtils","Types","WEBLib.TMSFNCTypes","WEBLib.TMSFNCGraphics","WEBLib.Graphics"],(function(){"use strict";var t=this;rtl.createClass(this,"TTMSFNCGraphicsContextWEB",pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphicsContext,(function(){this.$init=function(){pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphicsContext.$init.call(this),this.FActivePath=null,this.FScale=0,this.FNeedsRendering=!1,this.FFont=null,this.FFill=null,this.FStroke=null,this.FContextSize=pas["WEBLib.TMSFNCTypes"].TSizeF.$new(),this.FNCanvas=null,this.FBitmap=null},this.$final=function(){this.FActivePath=void 0,this.FFont=void 0,this.FFill=void 0,this.FStroke=void 0,this.FContextSize=void 0,this.FBitmap=void 0,pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphicsContext.$final.call(this)},this.DestroyResources=function(){null!=this.FNCanvas&&(this.RestoreContext(),this.FNCanvas=null),null!=this.FBitmap&&(rtl.free(this,"FBitmap"),this.FBitmap=null)},this.DrawTextInternal=function(t,e,i,s,o){var n=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),r=0,a="",l="",h=0,F=0,p=!1,c=0,u=0,C=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),T=0;function S(t,e){var i,s="",o=0;if(s="",i=t.length,e.get()>i)return s;for(o=e.get();;){if("\n"===t.charAt(o-1)&&"\r"===t.charAt(o-1-1)||"\r"===t.charAt(o-1)&&"\n"===t.charAt(o-1-1)||" "===t.charAt(o-1)){s=" "===t.charAt(o-1)?pas.System.Copy(t,e.get(),o-(e.get()-1)):pas.System.Copy(t,e.get(),o-e.get());break}if("\n"===t.charAt(o-1)||"\r"===t.charAt(o-1)||" "===t.charAt(o-1)){s=pas.System.Copy(t,e.get(),o-(e.get()-1));break}if(o>=i){s=pas.System.Copy(t,e.get(),o-(e.get()-1));break}o+=1}return e.set(o+1),s}if(i){for(C.$assign(e),F=0,r=1,u=0,T=0,c=0,F+=0,(a=S(t,{get:function(){return r},set:function(t){r=t}})).length>0&&" "===a.charAt(a.length-1)&&(F+=T);r<=t.length&&((h=a.length)>=2&&("\n"===a.charAt(h-1)&&"\r"===a.charAt(h-1-1)||"\r"===a.charAt(h-1)&&"\n"===a.charAt(h-1-1))?(a=pas.System.Copy(a,1,h-2),p=!0):h>=1&&("\n"===a.charAt(h-1)||"\r"===a.charAt(h-1))?(a=pas.System.Copy(a,1,h-1),p=!0):p=!1,l=S(t,{get:function(){return r},set:function(t){r=t}}),!((e.Left+F+0>e.Right||p)&&(""!==a&&(u+=1,F>c&&(c=F),F=0),a="",e.Top=e.Top+0,pas.System.Trunc(e.Top)>pas.System.Trunc(e.Bottom-0)&&!o)));)F+=0,l.length>0&&" "===l.charAt(l.length-1)&&(F+=T),a+=l;""!==a&&(u+=1,F>c&&(c=F)),n.$assign(pas["WEBLib.TMSFNCTypes"].RectF(C.Left,C.Top,C.Left+c,C.Top+0*u))}else;return n},this.DrawLinearGradient=function(t){if(null!=this.FNCanvas){this.FFill.FOrientation;-1!==this.FFill.FColorTo&&-1!==this.FFill.FColorMirror||this.FFill.FColorTo}},this.FontChanged=function(t){},this.FillChanged=function(t){null!=this.FNCanvas&&this.ApplyFill()},this.StrokeChanged=function(t){null!=this.FNCanvas&&this.ApplyStroke()},this.RestoreContext=function(){this.FNCanvas},this.SaveContext=function(){this.FNCanvas},this.ApplyStroke=function(){this.FNCanvas},this.ApplyFill=function(){if(null!=this.FNCanvas)this.FFill.FKind},this.Create$1=function(t){return pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphicsContext.Create$1.apply(this,arguments),this.FScale=pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.GetDPIScale(null,-1),this.FNeedsRendering=!0,this.FContextSize.cx=0,this.FContextSize.cy=0,this.FFont=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFont.$create("Create$2"),this.FFont.FOnChanged=rtl.createCallback(this,"FontChanged"),this.FStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,12632256]),this.FStroke.FOnChanged=rtl.createCallback(this,"StrokeChanged"),this.FFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[1,16777215,8421504,-1,-1]),this.FFill.FOnChanged=rtl.createCallback(this,"FillChanged"),this},this.Destroy=function(){this.Render(),null!=this.FFont&&(rtl.free(this,"FFont"),this.FFont=null),null!=this.FFill&&(rtl.free(this,"FFill"),this.FFill=null),null!=this.FStroke&&(rtl.free(this,"FStroke"),this.FStroke=null),this.DestroyResources(),pas.System.TObject.Destroy.call(this)},this.GetFillColor=function(){return this.GetGraphics().FFill.FColor},this.CalculateText=function(t,e,i){var s=pas["WEBLib.TMSFNCTypes"].TRectF.$new();return s.$assign(pas["WEBLib.TMSFNCTypes"].RectF(0,0,0,0)),null==this.FNCanvas||(this.SaveContext(),s.$assign(this.DrawTextInternal(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i,1,!0)),this.RestoreContext()),s},this.SetTextAngle=function(t,e){var i=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),s=0,o=pas["WEBLib.TMSFNCTypes"].TPointF.$new(),n=0,r=0,a=0,l=0,h=0,F=0;return i.$assign(t),null==this.FNCanvas||0!==e&&(s=pas.Math.DegToRad(e),o.X=i.Left+(i.Right-i.Left)/2,o.Y=i.Top+(i.Bottom-i.Top)/2,this.SaveContext(),n=i.Right-i.Left,r=i.Bottom-i.Top,a=Math.cos(s),l=Math.sin(s),h=Math.abs(n*a)+Math.abs(r*l),F=Math.abs(n*l)+Math.abs(r*a),i.$assign(pas["WEBLib.TMSFNCTypes"].RectF(-h/2,-F/2,h/2,F/2))),i},this.CreatePath=function(){return null,null},this.Render=function(){this.FNeedsRendering&&(this.FNeedsRendering=!1,this.DestroyResources())},this.PathOpen=function(t){},this.PathMoveTo=function(t,e){},this.PathLineTo=function(t,e){},this.PathClose=function(t){},this.ScaleTransform=function(t,e){this.FNCanvas},this.SetTextQuality=function(t){},this.SetAntiAliasing=function(t){this.FNCanvas},this.SetShowAcceleratorChar=function(t){},this.SetSize=function(t,e){this.FContextSize.cx=t,this.FContextSize.cy=e,this.DestroyResources(),this.FBitmap=pas["WEBLib.Graphics"].TBitmap.$create("Create$3"),this.ScaleTransform(this.FScale,this.FScale),this.SaveContext()},this.ResetTextAngle=function(t){null!=this.FNCanvas&&0!==t&&this.RestoreContext()},this.BeginScene=function(){this.FNCanvas},this.EndScene=function(){null!=this.FNCanvas&&this.Render()},this.StartSpecialPen=function(){this.FNCanvas},this.StopSpecialPen=function(){this.FNCanvas},this.RestoreState=function(t){null!=this.FNCanvas&&this.RestoreContext()},this.SaveState=function(t){null!=this.FNCanvas&&this.SaveContext()},this.SetFont=function(t){null!=this.FNCanvas&&this.FFont.AssignSource(t)},this.SetFill=function(t){null!=this.FNCanvas&&this.FFill.Assign(t)},this.SetFillColor=function(t){null!=this.FNCanvas&&this.FFill.SetColor(t)},this.SetStroke=function(t){null!=this.FNCanvas&&this.FStroke.Assign(t)},this.DrawLine=function(t,e,i,s,o){null!=this.FNCanvas&&(this.SaveContext(),this.RestoreContext())},this.DrawPolygon=function(t,e){null!=this.FNCanvas&&0!==rtl.length(e)&&(this.SaveContext(),this.ApplyStroke(),this.RestoreContext())},this.FillPolygon=function(t,e){if(null!=this.FNCanvas&&0!==rtl.length(e)){this.SaveContext();var i=t.FKind;1===i?this.ApplyFill():2===i&&null!=this.FActivePath&&this.DrawLinearGradient(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(this.FActivePath.GetBounds())),this.RestoreContext()}},this.DrawPolyline=function(t,e){null!=this.FNCanvas&&0!==rtl.length(e)&&(this.SaveContext(),this.ApplyStroke(),this.RestoreContext())},this.FillPolyline=function(t,e){if(null!=this.FNCanvas&&0!==rtl.length(e)){this.SaveContext();var i=t.FKind;1===i?this.ApplyFill():2===i&&null!=this.FActivePath&&this.DrawLinearGradient(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(this.FActivePath.GetBounds())),this.RestoreContext()}},this.FillArc=function(t,e,i,s,o){if(null!=this.FNCanvas){this.SaveContext();var n=t.FKind;1===n?this.ApplyFill():2===n&&this.DrawLinearGradient(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(e.X-i.X,e.Y-i.Y,e.X+i.X,e.Y+i.Y))),this.RestoreContext()}},this.DrawArc=function(t,e,i,s,o){null!=this.FNCanvas&&(this.SaveContext(),this.ApplyStroke(),this.RestoreContext())},this.FillRect=function(t,e,i){var s=pas["WEBLib.TMSFNCTypes"].TRectF.$new();if(null!=this.FNCanvas){s.$assign(e),this.SaveContext();var o=t.FKind;1===o?this.ApplyFill():2===o&&this.DrawLinearGradient(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(s)),this.RestoreContext()}},this.DrawRect=function(t,e,i,s){var o=pas["WEBLib.TMSFNCTypes"].TRectF.$new();null!=this.FNCanvas&&(o.$assign(e),1 in i&&this.DrawLine(t,pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(o.Left,o.Top)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(o.Right,o.Top)),2,2),0 in i&&this.DrawLine(t,pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(o.Left,o.Top)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(o.Left,o.Bottom)),2,2),3 in i&&this.DrawLine(t,pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(o.Left,o.Bottom)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(o.Right,o.Bottom)),2,2),2 in i&&this.DrawLine(t,pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(o.Right,o.Top)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(o.Right,o.Bottom)),2,2))},this.FillRoundRect=function(t,e,i,s,o){var n,r=null,a=pas["WEBLib.TMSFNCTypes"].TRectF.$new();a.$assign(e),n=i,r=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsPath.$create("Create$1");try{2 in s?(r.MoveTo(pas["WEBLib.TMSFNCTypes"].PointF(a.Left+n,a.Bottom)),r.AddArc(pas["WEBLib.TMSFNCTypes"].PointF(a.Left+n,a.Bottom-n),pas["WEBLib.TMSFNCTypes"].PointF(n,n),-270,90),r.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(a.Left,a.Bottom-n))):r.MoveTo(pas["WEBLib.TMSFNCTypes"].PointF(a.Left,a.Bottom)),0 in s?(r.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(a.Left,a.Top+n)),r.AddArc(pas["WEBLib.TMSFNCTypes"].PointF(a.Left+n,a.Top+n),pas["WEBLib.TMSFNCTypes"].PointF(n,n),-180,90),r.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(a.Left+n,a.Top))):r.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(a.Left,a.Top)),1 in s?(r.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(a.Right-n,a.Top)),r.AddArc(pas["WEBLib.TMSFNCTypes"].PointF(a.Right-n,a.Top+n),pas["WEBLib.TMSFNCTypes"].PointF(n,n),-90,90),r.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(a.Right,a.Top+n))):r.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(a.Right,a.Top)),3 in s?(r.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(a.Right,a.Bottom-n)),r.AddArc(pas["WEBLib.TMSFNCTypes"].PointF(a.Right-n,a.Bottom-n),pas["WEBLib.TMSFNCTypes"].PointF(n,n),0,90),r.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(a.Right-n,a.Bottom))):r.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(a.Right,a.Bottom)),2 in s?r.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(a.Left+n,a.Bottom)):r.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(a.Left,a.Bottom)),r.ClosePath(),this.FillPath(this.FFill,r,0)}finally{r=rtl.freeLoc(r)}},this.DrawRoundRect=function(t,e,i,s,o){var n,r=null,a=pas["WEBLib.TMSFNCTypes"].TRectF.$new();a.$assign(e),n=i,r=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsPath.$create("Create$1");try{2 in s?(r.MoveTo(pas["WEBLib.TMSFNCTypes"].PointF(a.Left+n,a.Bottom)),r.AddArc(pas["WEBLib.TMSFNCTypes"].PointF(a.Left+n,a.Bottom-n),pas["WEBLib.TMSFNCTypes"].PointF(n,n),-270,90),r.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(a.Left,a.Bottom-n))):r.MoveTo(pas["WEBLib.TMSFNCTypes"].PointF(a.Left,a.Bottom)),0 in s?(r.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(a.Left,a.Top+n)),r.AddArc(pas["WEBLib.TMSFNCTypes"].PointF(a.Left+n,a.Top+n),pas["WEBLib.TMSFNCTypes"].PointF(n,n),-180,90),r.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(a.Left+n,a.Top))):r.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(a.Left,a.Top)),1 in s?(r.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(a.Right-n,a.Top)),r.AddArc(pas["WEBLib.TMSFNCTypes"].PointF(a.Right-n,a.Top+n),pas["WEBLib.TMSFNCTypes"].PointF(n,n),-90,90),r.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(a.Right,a.Top+n))):r.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(a.Right,a.Top)),3 in s?(r.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(a.Right,a.Bottom-n)),r.AddArc(pas["WEBLib.TMSFNCTypes"].PointF(a.Right-n,a.Bottom-n),pas["WEBLib.TMSFNCTypes"].PointF(n,n),0,90),r.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(a.Right-n,a.Bottom))):r.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(a.Right,a.Bottom)),2 in s?r.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(a.Left+n,a.Bottom)):r.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(a.Left,a.Bottom)),r.ClosePath(),this.DrawPath(this.FStroke,r,0)}finally{r=rtl.freeLoc(r)}},this.FillEllipse=function(t,e,i){var s=pas["WEBLib.TMSFNCTypes"].TRectF.$new();if(null!=this.FNCanvas){s.$assign(e),this.SaveContext();var o=t.FKind;1===o?this.ApplyFill():2===o&&this.DrawLinearGradient(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(s)),this.RestoreContext()}},this.DrawEllipse=function(t,e,i){null!=this.FNCanvas&&(this.SaveContext(),this.ApplyStroke(),this.RestoreContext())},this.DrawBitmap=function(t,e,i,s){null!=t&&null!=this.FNCanvas&&(this.SaveContext(),this.RestoreContext())},this.ClipRect=function(t){null!=this.FNCanvas&&this.SaveContext()},this.DrawFocusRectangle=function(t,e,i,s){this.FNCanvas},this.DrawText=function(t,e,i,s,o,n,r){var a=pas["WEBLib.TMSFNCTypes"].TRectF.$new();if(null!=this.FNCanvas){this.SaveContext(),a.$assign(this.DrawTextInternal(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i,s,!0));var l=o;0===l?this.DrawTextInternal(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(e.Left,e.Top+(e.Bottom-e.Top-(a.Bottom-a.Top))/2,e.Right,e.Top+(e.Bottom-e.Top-(a.Bottom-a.Top))/2+(a.Bottom-a.Top))),i,s,!1):1===l?this.DrawTextInternal(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(e.Left,e.Top,e.Right,e.Top+(a.Bottom-a.Top))),i,s,!1):2===l&&this.DrawTextInternal(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(e.Left,e.Bottom-(a.Bottom-a.Top),e.Right,e.Bottom)),i,s,!1),this.RestoreContext()}},this.DrawPath=function(t,e,i){var s=[];if(null!=e){this.FActivePath=e,s=rtl.arraySetLength(s,pas["WEBLib.TMSFNCTypes"].TPointF,0),e.FlattenToPolygon({get:function(){return s},set:function(t){s=t}},.25);var o=i;0===o?this.DrawPolygon(t,rtl.arrayRef(s)):1===o&&this.DrawPolyline(t,rtl.arrayRef(s)),this.FActivePath=null}},this.FillPath=function(t,e,i){var s=[];if(null!=e){this.FActivePath=e,s=rtl.arraySetLength(s,pas["WEBLib.TMSFNCTypes"].TPointF,0),e.FlattenToPolygon({get:function(){return s},set:function(t){s=t}},.25);var o=i;0===o?this.FillPolygon(t,rtl.arrayRef(s)):1===o&&this.FillPolyline(t,rtl.arrayRef(s)),this.FActivePath=null}}})),this.GetNativeContextClass=function(){return t.TTMSFNCGraphicsContextWEB}}),["SysUtils","Math"]),rtl.module("WEBLib.TMSFNCGraphics",["System","Classes","WEBLib.TMSFNCGraphicsTypes","WEBLib.Graphics","JS","WEBLib.TMSFNCBitmapContainer","Types","WEBLib.TMSFNCTypes"],(function(){"use strict";var t=this;this.$rtti.$Class("TTMSFNCGraphics"),rtl.createClass(this,"TTMSFNCGraphicsContext",pas.System.TObject,(function(){this.$init=function(){pas.System.TObject.$init.call(this),this.FGraphics=null},this.$final=function(){this.FGraphics=void 0,pas.System.TObject.$final.call(this)},this.GetCanvas=function(){var t=null;return t=null,null!=this.GetGraphics()&&(t=this.GetGraphics().GetCanvas()),t},this.GetGraphics=function(){return this.FGraphics},this.Create$1=function(t){return this.FGraphics=t,this},this.ConvertToPath=function(t,e){var i,s=0,o=0,n=[],r=rtl.arraySetLength(null,pas["WEBLib.TMSFNCTypes"].TPointF,4),a=0,l=0,h=0,F=pas["WEBLib.TMSFNCTypes"].TPointF.$new(),p=pas["WEBLib.TMSFNCTypes"].TPointF.$new();if(i=this.CreatePath(),t.GetCount()>0)for(a=Math.max(e,.05),s=0;s<t.GetCount();){var c=t.GetPoint(s).Kind;if(0===c)this.PathOpen(i),this.PathMoveTo(i,pas["WEBLib.TMSFNCTypes"].TPointF.$clone(t.GetPoint(s).Point)),F.$assign(t.GetPoint(s).Point);else if(1===c)this.PathLineTo(i,pas["WEBLib.TMSFNCTypes"].TPointF.$clone(t.GetPoint(s).Point)),F.$assign(t.GetPoint(s).Point);else if(2===c){r[0].$assign(F),r[1].$assign(t.GetPoint(s).Point),s+=1,r[2].$assign(t.GetPoint(s).Point),s+=1,r[3].$assign(t.GetPoint(s).Point),n=t.CreateBezier(r,6),l=0;for(var u=0,C=rtl.length(n)-1-1;u<=C;u++)o=u,p.X=n[o].X-n[o+1].X,p.Y=n[o].Y-n[o+1].Y,l+=pas["WEBLib.TMSFNCTypes"].GetPointLength(p);if((h=Math.round(l/a))<2)this.PathLineTo(i,pas["WEBLib.TMSFNCTypes"].TPointF.$clone(r[3]));else{n=t.CreateBezier(r,h);for(var T=0,S=rtl.length(n)-1;T<=S;T++)o=T,this.PathLineTo(i,pas["WEBLib.TMSFNCTypes"].TPointF.$clone(n[o]));F.$assign(t.GetPoint(s).Point)}}else 3===c&&this.PathClose(i);s+=1}return i}})),rtl.createClass(this,"TTMSFNCGraphics",pas.System.TObject,(function(){this.DefaultSelectionFillColor=0,this.DefaultTextFontColor=0,this.DefaultPopupFillColor=0,this.DefaultPopupStrokeColor=0,this.DefaultButtonStrokeColorFocused=0,this.DefaultButtonFillColorFocused=0,this.DefaultButtonStrokeColorDisabled=0,this.DefaultButtonFillColorDisabled=0,this.DefaultButtonStrokeColor=0,this.DefaultButtonFillColor=0,this.$init=function(){pas.System.TObject.$init.call(this),this.FActiveCanvas=null,this.FBlockUpdate=0,this.FNative=!1,this.FContextNative=null,this.FContextGeneral=null,this.FBitmap=null,this.FFill=null,this.FStroke=null,this.FFont=null,this.FHighlightColor=0,this.FOptimizedHTMLDrawing=!1,this.FHighlightTextColor=0,this.FHighlightFontStyles={},this.FURLUnderline=!1,this.FURLColor=0,this.FBitmapContainer=null},this.$final=function(){this.FActiveCanvas=void 0,this.FContextNative=void 0,this.FContextGeneral=void 0,this.FBitmap=void 0,this.FFill=void 0,this.FStroke=void 0,this.FFont=void 0,this.FHighlightFontStyles=void 0,this.FBitmapContainer=void 0,pas.System.TObject.$final.call(this)},this.GetCanvas=function(){return this.FActiveCanvas},this.GetContext=function(){return this.FNative?this.FContextNative:this.FContextGeneral},this.FontChanged=function(t){this.SetFont(rtl.as(t,pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFont))},this.FillChanged=function(t){this.SetFill(rtl.as(t,pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill))},this.StrokeChanged=function(t){this.SetStroke(rtl.as(t,pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke))},this.InitializeDefaultAppearance=function(){this.FURLColor=16711680,this.FURLUnderline=!0,this.SetFill(this.FFill),this.SetStroke(this.FStroke),this.SetFont(this.FFont)},this.InternalCalculateText=function(t,e,i,s){var o=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),n="",r="",a="",l=0,h=0,F=0,p=0,c=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),u=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),C=0,T="",S="",d="";return o.$assign(e),Math.round(o.Right-o.Left)<=0?(o.Bottom=o.Top,o):(""!==t?s&&(pas.System.Pos("</",t)>0||pas.System.Pos("/>",t)>0||pas.System.Pos("<BR>",pas.SysUtils.UpperCase(t))>0)?(c.$assign(pas["WEBLib.TMSFNCTypes"].RectF(0,0,0,0)),l=0,h=0,F=-1,p=-1,a="",r="",n="",C=0,u.$assign(pas["WEBLib.TMSFNCTypes"].RectF(0,0,0,0)),T="",d="",S="",pas["WEBLib.TMSFNCHTMLEngine"].HTMLDrawEx$1(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),0,0,-1,-1,0,!1,!0,!1,!1,!1,!1,i,!1,"",1,this.FURLColor,-1,-1,-1,{get:function(){return n},set:function(t){n=t}},{get:function(){return r},set:function(t){r=t}},{get:function(){return a},set:function(t){a=t}},{get:function(){return l},set:function(t){l=t}},{get:function(){return h},set:function(t){h=t}},{get:function(){return F},set:function(t){F=t}},{get:function(){return p},set:function(t){p=t}},c,u,{get:function(){return T},set:function(t){T=t}},{get:function(){return d},set:function(t){d=t}},{get:function(){return S},set:function(t){S=t}},{get:function(){return C},set:function(t){C=t}},0,this.FBitmapContainer,1,this.FURLUnderline,this.FHighlightColor,this.FHighlightTextColor,rtl.refSet(this.FHighlightFontStyles)),h+=1,o.Right=o.Left+l,o.Bottom=o.Top+h):(o.$assign(this.GetContext().CalculateText(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i)),o.Bottom=o.Bottom+1):(o.Right=o.Left,o.Bottom=o.Top),o)},this.InternalDrawText=function(t,e,i,s,o,n,r,a,l,h,F,p,c,u,C,T){var S,d="",m="",f="",g="",y=0,M=0,b=0,N=0,B=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),E=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),D=0,L=0,G=0,A=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),I=!1,P=null;if(S=this.GetContext().GetFillColor(),this.GetContext().SetFillColor(this.FFont.FColor),p>-1&&t.Bottom-t.Top<p&&(t.Bottom=t.Top+p),F>-1&&t.Right-t.Left<F&&(t.Right=t.Left+F),t.$assign(this.GetContext().SetTextAngle(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(t),h)),d="",(pas.System.Pos("</",e)>0||pas.System.Pos("/>",e)>0||pas.System.Pos("<BR>",pas.SysUtils.UpperCase(e))>0)&&c){if(B.$assign(pas["WEBLib.TMSFNCTypes"].RectF(0,0,0,0)),y=0,M=0,b=-1,N=-1,g="",f="",m="",G=0,E.$assign(pas["WEBLib.TMSFNCTypes"].RectF(0,0,0,0)),i.set(""),s.set(""),o.set(""),pas["WEBLib.TMSFNCHTMLEngine"].HTMLDrawEx$1(this,e,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(t),0,0,-1,-1,0,!1,!0,!1,!1,!1,!1,n,!1,"",1,this.FURLColor,-1,-1,-1,{get:function(){return m},set:function(t){m=t}},{get:function(){return f},set:function(t){f=t}},{get:function(){return g},set:function(t){g=t}},{get:function(){return y},set:function(t){y=t}},{get:function(){return M},set:function(t){M=t}},{get:function(){return b},set:function(t){b=t}},{get:function(){return N},set:function(t){N=t}},B,E,i,s,o,{get:function(){return G},set:function(t){G=t}},0,this.FBitmapContainer,1,this.FURLUnderline,this.FHighlightColor,this.FHighlightTextColor,rtl.refSet(this.FHighlightFontStyles)),M+=1,y+=1,n&&G<=1||!n){D=t.Left,L=t.Top;var w=r;0===w?D+=(t.Right-t.Left-y)/2:2===w&&(D=t.Left+(t.Right-t.Left)-y);var $=a;0===$?L+=(t.Bottom-t.Top-M)/2:2===$&&(L=L+(t.Bottom-t.Top)-M),A.$assign(pas["WEBLib.TMSFNCTypes"].RectF(D,L,D+y,L+M))}else A.$assign(t);P=this.SaveState(!0),this.ClipRect(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(t)),I=pas["WEBLib.TMSFNCHTMLEngine"].HTMLDrawEx$1(this,e,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(A),Math.round(C),Math.round(T),-1,-1,0,u,!1,!1,!1,!1,!1,n,!1,"",1,this.FURLColor,-1,-1,-1,{get:function(){return m},set:function(t){m=t}},{get:function(){return f},set:function(t){f=t}},{get:function(){return g},set:function(t){g=t}},{get:function(){return y},set:function(t){y=t}},{get:function(){return M},set:function(t){M=t}},{get:function(){return b},set:function(t){b=t}},{get:function(){return N},set:function(t){N=t}},B,E,i,s,o,{get:function(){return G},set:function(t){G=t}},0,this.FBitmapContainer,1,this.FURLUnderline,this.FHighlightColor,this.FHighlightTextColor,rtl.refSet(this.FHighlightFontStyles)),this.RestoreState(P,!0),I&&(d=m)}else u||this.GetContext().DrawText(e,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(t),n,r,a,l,h);return this.GetContext().ResetTextAngle(h),this.GetContext().SetFillColor(S),d},this.DrawTexture=function(t,e,i){var s=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),o=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),n=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),r=0,a=0;if(!pas["WEBLib.TMSFNCTypes"].IsBitmapEmpty(e)){s.$assign(t);var l=i;if(0===l)o.$assign(pas["WEBLib.TMSFNCTypes"].RectF(t.Left,t.Top,t.Left+e.GetWidth(),t.Top+e.GetHeight())),pas["WEBLib.TMSFNCTypes"].IntersectRectEx$1(n,s,o),this.DrawBitmapPart$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(0,0,n.Right-n.Left,n.Bottom-n.Top)),pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(o.Left,o.Top,o.Left+(n.Right-n.Left),o.Top+(n.Bottom-n.Top))),e,!1,!1,!1,!1);else if(1===l)o.$assign(pas["WEBLib.TMSFNCTypes"].RectF(0,0,e.GetWidth(),e.GetHeight())),o.$assign(pas["WEBLib.TMSFNCTypes"].RectSnapToPixelEx(pas["WEBLib.TMSFNCTypes"].RectFitIntoEx$1(o,t),1,!1)),this.DrawBitmapPart$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(0,0,e.GetWidth(),e.GetHeight())),pas["WEBLib.TMSFNCTypes"].TRectF.$clone(o),e,!1,!0,!1,!1);else if(2===l)this.DrawBitmapPart$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(0,0,e.GetWidth(),e.GetHeight())),pas["WEBLib.TMSFNCTypes"].TRectF.$clone(t),e,!1,!0,!1,!1);else if(4===l)for(var h=0,F=pas.System.Trunc((s.Right-s.Left)/e.GetWidth())+1;h<=F;h++){r=h;for(var p=0,c=pas.System.Trunc((s.Bottom-s.Top)/e.GetHeight())+1;p<=c;p++)a=p,o.$assign(pas["WEBLib.TMSFNCTypes"].RectF(s.Left,s.Top,s.Left+e.GetWidth(),s.Top+e.GetHeight())),pas["WEBLib.TMSFNCTypes"].OffsetRectEx$1(o,r*e.GetWidth(),a*e.GetHeight()),pas["WEBLib.TMSFNCTypes"].IntersectRectEx$1(n,s,o),pas["WEBLib.TMSFNCTypes"].IntersectRectEx(n,o)&&this.DrawBitmap$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(o.Left,o.Top,o.Left+(n.Right-n.Left),o.Top+(n.Bottom-n.Top))),e,!1,!1,!1,!1)}else 3===l&&(o.$assign(pas["WEBLib.TMSFNCTypes"].RectF(0,0,e.GetWidth(),e.GetHeight())),o.$assign(pas["WEBLib.TMSFNCTypes"].RectSnapToPixelEx(pas["WEBLib.TMSFNCTypes"].RectCenterAtEx(o,t),1,!1)),this.DrawBitmapPart$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(0,0,e.GetWidth(),e.GetHeight())),pas["WEBLib.TMSFNCTypes"].TRectF.$clone(o),e,!0,!1,!0,!1))}},this.DrawSVG=function(t,e){return!1,!1},this.Create$1=function(t,e){return this.FNative=e,this.FActiveCanvas=t,e?(this.FContextNative=pas["WEBLib.TMSFNCGraphics.WEB"].GetNativeContextClass().$create("Create$1",[this]),this.FContextNative.SetSize(1,1)):(this.FContextGeneral=pas["WEBLib.TMSFNCGraphics.General"].TTMSFNCGraphicsContextGeneral.$create("Create$1",[this]),this.FContextGeneral.SetSize(1,1)),this.FFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[1,16777215,8421504,-1,-1]),this.FFill.FOnChanged=rtl.createCallback(this,"FillChanged"),this.FStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,12632256]),this.FStroke.FOnChanged=rtl.createCallback(this,"StrokeChanged"),this.FFont=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFont.$create("Create$2"),this.FFont.FOnChanged=rtl.createCallback(this,"FontChanged"),this.FHighlightColor=16711680,this.FHighlightTextColor=16777215,this.FHighlightFontStyles={},this.InitializeDefaultAppearance(),this},this.CreateBitmapCanvas=function(t,e,i,s){return this.FNative=i,this.FBitmap=pas["WEBLib.Graphics"].TBitmap.$create("Create$3"),this.FBitmap.SetWidth(t),this.FBitmap.SetHeight(e),this.FActiveCanvas=this.FBitmap.GetCanvas(),i?(this.FContextNative=pas["WEBLib.TMSFNCGraphics.WEB"].GetNativeContextClass().$create("Create$1",[this]),this.FContextNative.SetSize(t,e)):(this.FContextGeneral=pas["WEBLib.TMSFNCGraphics.General"].TTMSFNCGraphicsContextGeneral.$create("Create$1",[this]),this.FContextGeneral.SetSize(t,e)),this.FFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[1,16777215,8421504,-1,-1]),this.FFill.FOnChanged=rtl.createCallback(this,"FillChanged"),this.FStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,12632256]),this.FStroke.FOnChanged=rtl.createCallback(this,"StrokeChanged"),this.FFont=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFont.$create("Create$2"),this.FFont.FOnChanged=rtl.createCallback(this,"FontChanged"),this.InitializeDefaultAppearance(),this},this.Destroy=function(){null!=this.FContextNative&&(rtl.free(this,"FContextNative"),this.FContextNative=null),null!=this.FContextGeneral&&(rtl.free(this,"FContextGeneral"),this.FContextGeneral=null),null!=this.FFont&&(rtl.free(this,"FFont"),this.FFont=null),null!=this.FFill&&(this.FFill.FOnChanged=null,rtl.free(this,"FFill"),this.FFill=null),null!=this.FStroke&&(this.FStroke.FOnChanged=null,rtl.free(this,"FStroke"),this.FStroke=null),this.FBitmapContainer=null,null!=this.FBitmap&&(rtl.free(this,"FBitmap"),this.FBitmap=null),pas.System.TObject.Destroy.call(this)},this.StartSpecialPen=function(){this.GetContext().StartSpecialPen()},this.StopSpecialPen=function(){this.GetContext().StopSpecialPen()},this.BeginScene=function(){this.GetContext().BeginScene()},this.EndScene=function(){this.GetContext().EndScene()},this.SetFill=function(t){this.FBlockUpdate>0||(this.FBlockUpdate+=1,this.GetContext().SetFill(t),this.FFill.Assign(t),this.FBlockUpdate-=1)},this.SetStroke=function(t){this.FBlockUpdate>0||(this.FBlockUpdate+=1,this.GetContext().SetStroke(t),this.FStroke.Assign(t),this.FBlockUpdate-=1)},this.RestoreState=function(t,e){e||(this.SetFill(t.FFill),this.SetStroke(t.FStroke),this.SetFont(t.FFont)),this.GetContext().RestoreState(t),t=rtl.freeLoc(t)},this.SetFont=function(t){this.FBlockUpdate>0||(this.FBlockUpdate+=1,this.GetContext().SetFont(t),this.FFont.AssignSource(t),this.FBlockUpdate-=1)},this.DrawLine$1=function(t,e,i,s){-1!==this.FStroke.FColor&&0!==this.FStroke.FKind&&this.GetContext().DrawLine(this.FStroke,pas["WEBLib.TMSFNCTypes"].TPointF.$clone(t),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(e),i,s)},this.DrawFocusRectangle$2=function(t,e,i,s,o,n){var r=pas["WEBLib.TMSFNCTypes"].TRectF.$new();r.$assign(pas["WEBLib.TMSFNCTypes"].RectF(t,e,i,s)),this.GetContext().DrawFocusRectangle(this.FStroke,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(r),o,n)},this.DrawFocusRectangle$3=function(t,e,i){this.DrawFocusRectangle$2(t.Left,t.Top,t.Right,t.Bottom,e,i)},this.DrawPath=function(t,e){(-1!==this.FFill.FColor&&0!==this.FFill.FKind||3===this.FFill.FKind)&&(3===this.FFill.FKind?this.DrawTexture(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(t.GetBounds()),this.FFill.FTexture,this.FFill.FTextureMode):this.GetContext().FillPath(this.FFill,t,e));-1!==this.FStroke.FColor&&0!==this.FStroke.FKind&&this.GetContext().DrawPath(this.FStroke,t,e)},this.DrawArc=function(t,e,i,s){var o=null;if(-1!==this.FFill.FColor&&0!==this.FFill.FKind)if(3===this.FFill.FKind){o=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsPath.$create("Create$1");try{o.AddArc(t,e,i,s),this.DrawTexture(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(o.GetBounds()),this.FFill.FTexture,this.FFill.FTextureMode)}finally{o=rtl.freeLoc(o)}}else this.GetContext().FillArc(this.FFill,pas["WEBLib.TMSFNCTypes"].TPointF.$clone(t),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(e),i,s);-1!==this.FStroke.FColor&&0!==this.FStroke.FKind&&this.GetContext().DrawArc(this.FStroke,pas["WEBLib.TMSFNCTypes"].TPointF.$clone(t),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(e),i,s)},this.DrawRectangle=function(t,e,i,s,o){this.DrawRectangle$1(t,e,i,s,pas["WEBLib.TMSFNCGraphicsTypes"].AllSides,o)},this.DrawRectangle$1=function(t,e,i,s,o,n){var r=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),a=null;if(r.$assign(pas["WEBLib.TMSFNCTypes"].RectF(t,e,i,s)),-1!==this.FFill.FColor&&0!==this.FFill.FKind||3===this.FFill.FKind)if(3===this.FFill.FKind){a=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsPath.$create("Create$1");try{a.AddRectangle(r,0,0),this.DrawTexture(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(r),this.FFill.FTexture,this.FFill.FTextureMode)}finally{a=rtl.freeLoc(a)}}else this.GetContext().FillRect(this.FFill,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(r),n);-1!==this.FStroke.FColor&&0!==this.FStroke.FKind&&this.GetContext().DrawRect(this.FStroke,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(r),rtl.refSet(o),n)},this.DrawEllipse=function(t,e,i,s,o){var n=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),r=null;if(n.$assign(pas["WEBLib.TMSFNCTypes"].RectF(t,e,i,s)),-1!==this.FFill.FColor&&0!==this.FFill.FKind||3===this.FFill.FKind)if(3===this.FFill.FKind){r=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsPath.$create("Create$1");try{r.AddEllipse(n),this.DrawTexture(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(n),this.FFill.FTexture,this.FFill.FTextureMode)}finally{r=rtl.freeLoc(r)}}else this.GetContext().FillEllipse(this.FFill,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(n),o);-1!==this.FStroke.FColor&&0!==this.FStroke.FKind&&this.GetContext().DrawEllipse(this.FStroke,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(n),o)},this.DrawRectangle$2=function(t,e){this.DrawRectangle(t.Left,t.Top,t.Right,t.Bottom,e)},this.DrawRectangle$3=function(t,e,i){this.DrawRectangle$1(t.Left,t.Top,t.Right,t.Bottom,rtl.refSet(e),i)},this.DrawRoundRectangle=function(t,e,i,s,o,n,r){var a=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),l=0,h=null;if(a.$assign(pas["WEBLib.TMSFNCTypes"].RectF(t,e,i,s)),-1!==this.FFill.FColor&&0!==this.FFill.FKind||3===this.FFill.FKind)if(3===this.FFill.FKind){h=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsPath.$create("Create$1");try{l=o,2 in n?(h.MoveTo(pas["WEBLib.TMSFNCTypes"].PointF(a.Left+l,a.Bottom)),h.AddArc(pas["WEBLib.TMSFNCTypes"].PointF(a.Left+l,a.Bottom-l),pas["WEBLib.TMSFNCTypes"].PointF(l,l),-270,90),h.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(a.Left,a.Bottom-l))):h.MoveTo(pas["WEBLib.TMSFNCTypes"].PointF(a.Left,a.Bottom)),0 in n?(h.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(a.Left,a.Top+l)),h.AddArc(pas["WEBLib.TMSFNCTypes"].PointF(a.Left+l,a.Top+l),pas["WEBLib.TMSFNCTypes"].PointF(l,l),-180,90),h.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(a.Left+l,a.Top))):h.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(a.Left,a.Top)),1 in n?(h.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(a.Right-l,a.Top)),h.AddArc(pas["WEBLib.TMSFNCTypes"].PointF(a.Right-l,a.Top+l),pas["WEBLib.TMSFNCTypes"].PointF(l,l),-90,90),h.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(a.Right,a.Top+l))):h.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(a.Right,a.Top)),3 in n?(h.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(a.Right,a.Bottom-l)),h.AddArc(pas["WEBLib.TMSFNCTypes"].PointF(a.Right-l,a.Bottom-l),pas["WEBLib.TMSFNCTypes"].PointF(l,l),0,90),h.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(a.Right-l,a.Bottom))):h.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(a.Right,a.Bottom)),2 in n?h.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(a.Left+l,a.Bottom)):h.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(a.Left,a.Bottom)),h.ClosePath(),this.DrawTexture(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(a),this.FFill.FTexture,this.FFill.FTextureMode)}finally{h=rtl.freeLoc(h)}}else this.GetContext().FillRoundRect(this.FFill,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(a),o,rtl.refSet(n),r);-1!==this.FStroke.FColor&&0!==this.FStroke.FKind&&this.GetContext().DrawRoundRect(this.FStroke,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(a),o,rtl.refSet(n),r)},this.DrawRoundRectangle$1=function(t,e,i,s){this.DrawRoundRectangle(t.Left,t.Top,t.Right,t.Bottom,e,rtl.refSet(i),s)},this.DrawEllipse$2=function(t,e){this.DrawEllipse(t.Left,t.Top,t.Right,t.Bottom,e)},this.DrawBitmapPart=function(e,i,s,o,n,r,a,l,h,F,p,c,u){var C=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),T=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),S=null,d=null;if(C.$assign(pas["WEBLib.TMSFNCTypes"].RectF(n,r,a,l)),T.$assign(pas["WEBLib.TMSFNCTypes"].RectF(e,i,s,o)),!pas["WEBLib.TMSFNCTypes"].RectIsEmpty(C)&&!pas["WEBLib.TMSFNCTypes"].RectIsEmpty(T)&&!this.DrawSVG(h,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(C))){S=t.TTMSFNCGraphics.$create("CreateBitmapCanvas",[Math.round(s-e),Math.round(o-i),this.FNative,!0]);try{S.BeginScene(),S.DrawBitmap(-e,-i,-e+S.FBitmap.GetWidth(),-i+S.FBitmap.GetHeight(),h,!1,!1,!1,!1),S.EndScene(),d=pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.$create("Create$3");try{d.Assign(S.FBitmap),this.DrawBitmap$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(C),d,F,p,c,u)}finally{d=rtl.freeLoc(d)}}finally{S=rtl.freeLoc(S)}}},this.DrawBitmapPart$1=function(t,e,i,s,o,n,r){this.DrawBitmapPart(t.Left,t.Top,t.Right,t.Bottom,e.Left,e.Top,e.Right,e.Bottom,i,s,o,n,r)},this.DrawBitmap=function(t,e,i,s,o,n,r,a,l){var h=pas["WEBLib.TMSFNCTypes"].TRectF.$new();null!=o&&(h.$assign(pas["WEBLib.TMSFNCTypes"].RectF(t,e,i,s)),h.$assign(this.GetBitmapDrawRectangle$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(h),o,n,r,a,l)),this.DrawSVG(o,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(h))||this.GetContext().DrawBitmap(pas["WEBLib.TMSFNCTypes"].BitmapToDrawBitmap(o),pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(0,0,o.GetWidth(),o.GetHeight())),pas["WEBLib.TMSFNCTypes"].TRectF.$clone(h),1))},this.DrawBitmap$1=function(t,e,i,s,o,n){this.DrawBitmap(t.Left,t.Top,t.Right,t.Bottom,e,i,s,o,n)},this.DrawBitmap$5=function(t,e,i){this.DrawBitmap$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(t,e,t+i.GetWidth(),e+i.GetHeight())),i,!0,!1,!0,!1)},this.DrawCheckBox=function(t,e,i,s,o){var n=0,r=pas["WEBLib.TMSFNCTypes"].TRectF.$new();r.$assign(t),pas["WEBLib.TMSFNCTypes"].InflateRectEx(r,-1,-1),n=s?i?11829830:0:11119017,this.FFill.SetKind(1),s?this.FFill.SetColor(pas["WEBLib.TMSFNCGraphicsTypes"].Lighter(13882323,85)):this.FFill.SetColor(13882323),this.FStroke.SetWidth(1),this.FStroke.SetKind(1),this.FStroke.SetColor(n),this.DrawRectangle$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(r),2),pas["WEBLib.TMSFNCTypes"].InflateRectEx(r,-(r.Right-r.Left)/5,-(r.Bottom-r.Top)/5),this.FStroke.SetWidth(2),this.FStroke.SetColor(n),e&&(this.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(r.Left,r.Top)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(r.Right-1,r.Bottom-1)),2,2),this.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(r.Right-1,r.Top)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(r.Left,r.Bottom-1)),2,2))},this.DrawButton=function(e,i,s,o,n,r){var a=pas["WEBLib.TMSFNCTypes"].TRectF.$new();a.$assign(e),this.FStroke.SetKind(1),this.FStroke.SetWidth(1),this.FFill.SetKind(1),n?o?s?(this.FStroke.SetColor(t.TTMSFNCGraphics.DefaultButtonStrokeColorFocused),this.FFill.SetColor(t.TTMSFNCGraphics.DefaultButtonFillColorFocused)):(this.FStroke.SetColor(t.TTMSFNCGraphics.DefaultButtonStrokeColor),this.FFill.SetColor(t.TTMSFNCGraphics.DefaultButtonFillColor)):(this.FStroke.SetColor(t.TTMSFNCGraphics.DefaultButtonStrokeColorDisabled),this.FFill.SetColor(t.TTMSFNCGraphics.DefaultButtonFillColorDisabled)):o?s?(this.FStroke.SetColor(pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(60,127,177)),this.FFill.SetColor(pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(229,241,251))):(this.FStroke.SetColor(11119017),this.FFill.SetColor(pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(225,225,225))):(this.FStroke.SetColor(11119017),this.FFill.SetColor(13882323)),this.DrawRectangle$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(a),2),pas["WEBLib.TMSFNCTypes"].InflateRectEx(a,-1,-1),this.FFill.SetKind(0),i?this.FStroke.SetColor(pas["WEBLib.TMSFNCGraphicsTypes"].Lighter(this.FStroke.FColor,40)):this.FStroke.SetColor(this.FFill.FColor),this.DrawRectangle$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(a),2)},this.DrawCloseButton=function(e,i,s,o,n,r){var a=null,l=null,h=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),F=null;if(this.DrawButton(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i,s,o,n,r),n){(l=pas["WEBLib.Graphics"].TBitmap.$create("Create$3")).SetSize(Math.round(16*r),Math.round(16*r)),F=t.TTMSFNCGraphics.$create("Create$1",[l.GetCanvas(),!1]);try{F.BeginScene(),F.FStroke.SetKind(1),F.FStroke.SetColor(t.TTMSFNCGraphics.DefaultSelectionFillColor),F.FStroke.SetWidth(2),F.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(3*r,3*r)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(12*r,12*r)),2,2),F.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(3*r,12*r)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(12*r,3*r)),2,2)}finally{F.EndScene(),F=rtl.freeLoc(F)}try{h.$assign(e),a=pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.$create("Create$3");try{a.Assign(l),this.DrawBitmap$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(h),a,!0,!1,!0,!1)}finally{a=rtl.freeLoc(a)}}finally{l=rtl.freeLoc(l)}}else{a=pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.CreateFromResource(t.TMSFNCGRAPHICSCLOSESVG);try{h.$assign(e),pas["WEBLib.TMSFNCTypes"].InflateRectEx(h,-6*r,-6*r),this.DrawBitmap$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(h),a,!0,!1,!0,!1)}finally{a=rtl.freeLoc(a)}}},this.DrawExpanderButton=function(e,i,s,o,n,r,a){var l=null,h=null,F=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),p=null;if(this.DrawButton(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),s,o,n,r,a),r){(l=pas["WEBLib.Graphics"].TBitmap.$create("Create$3")).SetSize(Math.round(16*a),Math.round(16*a)),p=t.TTMSFNCGraphics.$create("Create$1",[l.GetCanvas(),!1]);try{p.BeginScene(),p.FStroke.SetKind(1),p.FStroke.SetWidth(2),p.FStroke.SetColor(t.TTMSFNCGraphics.DefaultSelectionFillColor);var c=i;0===c?(p.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(5*a,6*a)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(8*a,9*a)),2,2),p.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(8*a,9*a)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(11*a,6*a)),2,2)):1===c&&(p.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(5*a,9*a)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(8*a,6*a)),2,2),p.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(8*a,6*a)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(11*a,9*a)),2,2))}finally{p.EndScene(),p=rtl.freeLoc(p)}if(null!=l)try{F.$assign(e),h=pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.$create("Create$3");try{h.Assign(l),this.DrawBitmap$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(F),h,!0,!1,!0,!1)}finally{h=rtl.freeLoc(h)}}finally{l=rtl.freeLoc(l)}}else{var u=i;if(null!=(h=0===u?pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.CreateFromResource(t.TMSFNCGRAPHICSDOWNSVG):1===u?pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.CreateFromResource(t.TMSFNCGRAPHICSUPSVG):null))try{F.$assign(e),pas["WEBLib.TMSFNCTypes"].InflateRectEx(F,-4*a,-4*a),this.DrawBitmap$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(F),h,!0,!1,!0,!1)}finally{h=rtl.freeLoc(h)}}},this.DrawCompactButton=function(e,i,s,o,n,r,a){var l=null,h=null,F=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),p=null;if(this.DrawButton(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),s,o,n,r,a),r){(l=pas["WEBLib.Graphics"].TBitmap.$create("Create$3")).SetSize(Math.round(16*a),Math.round(16*a)),p=t.TTMSFNCGraphics.$create("Create$1",[l.GetCanvas(),!1]);try{p.BeginScene(),p.FStroke.SetKind(1),p.FStroke.SetWidth(2),p.FStroke.SetColor(t.TTMSFNCGraphics.DefaultSelectionFillColor);var c=i;0===c?(p.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(6*a,5*a)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(9*a,8*a)),2,2),p.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(9*a,8*a)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(6*a,11*a)),2,2)):1===c&&(p.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(9*a,5*a)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(6*a,8*a)),2,2),p.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(6*a,8*a)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(9*a,11*a)),2,2))}finally{p.EndScene(),p=rtl.freeLoc(p)}if(null!=l)try{F.$assign(e),h=pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.$create("Create$3");try{h.Assign(l),this.DrawBitmap$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(F),h,!0,!1,!0,!1)}finally{h=rtl.freeLoc(h)}}finally{l=rtl.freeLoc(l)}}else{var u=i;if(null!=(h=0===u?pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.CreateFromResource(t.TMSFNCGRAPHICSRIGHTSVG):1===u?pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.CreateFromResource(t.TMSFNCGRAPHICSLEFTSVG):null))try{F.$assign(e),pas["WEBLib.TMSFNCTypes"].InflateRectEx(F,-4*a,-4*a),this.DrawBitmap$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(F),h,!0,!1,!0,!1)}finally{h=rtl.freeLoc(h)}}},this.DrawDropDownButton=function(e,i,s,o,n,r,a){var l=null,h=null,F=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),p=null;if(this.DrawButton(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i,s,o,r,1),r){(h=pas["WEBLib.Graphics"].TBitmap.$create("Create$3")).SetSize(Math.round(7*a),Math.round(7*a)),p=t.TTMSFNCGraphics.$create("Create$1",[h.GetCanvas(),!1]);try{p.BeginScene(),p.FStroke.SetKind(1),p.FStroke.SetColor(t.TTMSFNCGraphics.DefaultSelectionFillColor),p.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(0,1*a)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(6*a,1*a)),2,2),p.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(0,2*a)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(6*a,2*a)),2,2),p.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(1*a,3*a)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(5*a,3*a)),2,2),p.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(2*a,4*a)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(4*a,4*a)),2,2),p.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(3*a,5*a)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(3*a,5*a)),2,2)}finally{p.EndScene(),p=rtl.freeLoc(p)}try{e.Right-h.GetWidth()-10*a>e.Left&&!n?F.$assign(pas["WEBLib.TMSFNCTypes"].RectF(e.Right-h.GetWidth()-10*a,e.Top,e.Right,e.Bottom)):F.$assign(e),l=pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.$create("Create$3");try{l.Assign(h),this.DrawBitmap$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(F),l,!0,!1,!0,!1)}finally{l=rtl.freeLoc(l)}}finally{h=rtl.freeLoc(h)}}else{(l=pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.$create("Create$3")).LoadFromResource(t.TMSFNCGRAPHICSEXPANDSVG);try{n?(F.$assign(e),pas["WEBLib.TMSFNCTypes"].InflateRectEx(F,-4*a,-4*a)):(F.$assign(pas["WEBLib.TMSFNCTypes"].RectF(e.Right-16*a,e.Top,e.Right-2*a,e.Bottom)),pas["WEBLib.TMSFNCTypes"].InflateRectEx(F,-2*a,-2*a)),this.DrawBitmap$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(F),l,!0,!1,!0,!1)}finally{l=rtl.freeLoc(l)}}},this.DrawRadioButton=function(t,e,i,s,o){var n=0,r=pas["WEBLib.TMSFNCTypes"].TRectF.$new();r.$assign(t),pas["WEBLib.TMSFNCTypes"].InflateRectEx(r,-1,-1),n=s?i?11829830:0:11119017,this.FFill.SetKind(1),s?this.FFill.SetColor(pas["WEBLib.TMSFNCGraphicsTypes"].Lighter(13882323,85)):this.FFill.SetColor(13882323),this.FStroke.SetKind(1),this.FStroke.SetWidth(1),this.FStroke.SetColor(n),this.DrawEllipse$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(r),2),pas["WEBLib.TMSFNCTypes"].InflateRectEx(r,-(r.Right-r.Left)/5,-(r.Bottom-r.Top)/5),this.FFill.SetKind(1),this.FFill.SetColor(n),e&&this.DrawEllipse$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(r),2)},this.DrawProgressBar=function(t,e,i,s,o,n,r,a,l){var h,F,p=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),c=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),u=0;p.$assign(t),c.$assign(p),F=this.FFill.FColor,a?this.FFill.SetColor(pas["WEBLib.TMSFNCGraphicsTypes"].Lighter(13882323,75)):this.FFill.SetColor(13882323),this.FFill.SetKind(1),this.FStroke.SetKind(1),this.FStroke.SetColor(11119017),this.DrawRectangle$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(p),2),(h=Math.max(0,Math.min(e,s)))>=0&&h<=s&&s>0&&(pas["WEBLib.TMSFNCTypes"].InflateRectEx(c,-1,-1),c.Right=c.Left+(c.Right-p.Left)*h/s,this.FFill.SetColor(o),this.FStroke.SetColor(this.FFill.FColor),this.DrawRectangle$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(c),2),r&&(u=this.FFont.FColor,this.FFont.SetColor(n),this.DrawText$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(p),pas.SysUtils.Format(i,pas.System.VarRecs(3,h/s*100)),!1,0,0,0,0,-1,-1,!0,!1,-1,-1),this.FFont.SetColor(u))),this.FFill.SetColor(F)},this.DrawBitmapWithName$1=function(t,e,i,s,o,n,r,a){var l;null!=(l=this.$class.GetBitmapFromBitmapContainer(this.FBitmapContainer,e,i,s))&&this.DrawBitmap$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(t),l,o,n,r,a)},this.DrawScaledBitmap=function(t,e,i,s,o,n,r){var a=null,l=null;null!=e&&null!=(a=i>0?e.GetItemByScale(i):e.GetItemByScale(pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.GetDPIScale(null,-1)))&&(null==a.FBitmap||pas["WEBLib.TMSFNCTypes"].IsBitmapEmpty(a.FBitmap)?null==(l=this.$class.GetBitmapFromBitmapContainer(this.FBitmapContainer,a.FBitmapName,!0,i))||pas["WEBLib.TMSFNCTypes"].IsBitmapEmpty(l)?this.DrawBitmapWithName$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(t),a.FBitmapName,!1,a.FScale,s,o,n,r):this.DrawBitmap$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(t),l,s,o,n,r):this.DrawBitmap$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(t),a.FBitmap,s,o,n,r))},this.GetBitmapDrawRectangle=function(t,e,i,s,o,n,r,a,l){var h=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),F=null,p=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),c=0,u=0,C=0,T=0;return h.$assign(pas["WEBLib.TMSFNCTypes"].RectF(0,0,0,0)),null!=(F=o)&&(C=0,T=0,c=0,u=0,this.$class.GetAspectSize({get:function(){return c},set:function(t){c=t}},{get:function(){return u},set:function(t){u=t}},F.GetWidth(),F.GetHeight(),i-t,s-e,n,r,l),(a||l)&&(C=Math.round((i-t-c)/2),T=Math.round((s-e-u)/2)),p.$assign(pas["WEBLib.TMSFNCTypes"].RectF(t+C,e+T,t+C+c,e+T+u)),h.$assign(p)),h},this.GetBitmapDrawRectangle$1=function(t,e,i,s,o,n){var r=pas["WEBLib.TMSFNCTypes"].TRectF.$new();return r.$assign(this.GetBitmapDrawRectangle(t.Left,t.Top,t.Right,t.Bottom,e,i,s,o,n)),r},this.ClipRect=function(t){this.GetContext().ClipRect(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(t))},this.CalculateTextSize=function(t,e,i,s){var o=pas["WEBLib.TMSFNCTypes"].TSizeF.$new(),n=pas["WEBLib.TMSFNCTypes"].TRectF.$new();return n.$assign(this.CalculateText(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i,s)),o.cx=n.Right-n.Left,o.cy=n.Bottom-n.Top,o},this.CalculateTextWidth=function(t,e,i,s){var o=pas["WEBLib.TMSFNCTypes"].TRectF.$new();return o.$assign(this.CalculateText(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i,s)),o.Right-o.Left},this.CalculateTextHeight=function(t,e,i,s){var o=pas["WEBLib.TMSFNCTypes"].TRectF.$new();return o.$assign(this.CalculateText(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i,s)),o.Bottom-o.Top};var e=["<BR>","<BR/>"];this.CalculateText=function(t,i,s,o){var n=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),r=null,a=0,l=0,h=0,F=!1,p=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),c=0;if(n.$assign(i),F=this.FOptimizedHTMLDrawing&&pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.IsHTML(t)){for(a=0;a<=1;a++)h=pas.System.Pos(e[a],pas.SysUtils.UpperCase(t)),l=e[a].length;if(h>0&&l>0){r=pas.Classes.TStringList.$create("Create$1");try{r.SetLineBreak(pas.System.Copy(t,h,l)),r.SetTextStr(t),c=0;for(var u=0,C=r.GetCount()-1;u<=C;u++)a=u,p.$assign(this.InternalCalculateText(r.Get(a),pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),s,o)),c+=p.Bottom-p.Top;n.Bottom=n.Top+c}finally{r=rtl.freeLoc(r)}}else F=!1}return F||n.$assign(this.InternalCalculateText(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),s,o)),n},this.CalculateTextSize$1=function(t){var e=pas["WEBLib.TMSFNCTypes"].TSizeF.$new();return e.$assign(this.CalculateTextSize(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(0,0,1e4,1e4)),!1,!0)),e},this.CalculateTextWidth$1=function(t){return this.CalculateTextWidth(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(0,0,1e4,1e4)),!1,!0)},this.CalculateTextHeight$1=function(t){return this.CalculateTextHeight(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(0,0,1e4,1e4)),!1,!0)},this.CalculateText$1=function(t){var e=pas["WEBLib.TMSFNCTypes"].TRectF.$new();return e.$assign(this.CalculateText(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(0,0,1e4,1e4)),!1,!0)),e},this.DrawText=function(t,e,i,s,o,n,r){var a="",l="",h="";return a="",l="",h="",this.DrawText$5(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(t.X,t.Y,t.X+1e4,t.Y+1e4)),e,{get:function(){return a},set:function(t){a=t}},{get:function(){return l},set:function(t){l=t}},{get:function(){return h},set:function(t){h=t}},!1,1,1,0,i,-1,-1,s,o,n,r)},this.DrawText$1=function(t,e,i,s,o,n,r,a,l,h,F,p,c){var u="",C="",T="";return u="",C="",T="",this.DrawText$5(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(t),e,{get:function(){return u},set:function(t){u=t}},{get:function(){return C},set:function(t){C=t}},{get:function(){return T},set:function(t){T=t}},i,s,o,n,r,a,l,h,F,p,c)};var i=["<BR>","<BR/>"];this.DrawText$5=function(t,e,s,o,n,r,a,l,h,F,p,c,u,C,T,S){var d="",m=null,f=0,g=0,y=0,M=!1,b=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),N=pas["WEBLib.TMSFNCTypes"].TRectF.$new();if(N.$assign(t),M=(M=!C&&this.FOptimizedHTMLDrawing)&&pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.IsHTML(e)){for(f=0;f<=1;f++)y=pas.System.Pos(i[f],pas.SysUtils.UpperCase(e)),g=i[f].length;if(y>0&&g>0){m=pas.Classes.TStringList.$create("Create$1");try{m.SetLineBreak(pas.System.Copy(e,y,g)),m.SetTextStr(e);for(var B=0,E=m.GetCount()-1;B<=E;B++)f=B,b.$assign(this.CalculateText(m.Get(f),pas["WEBLib.TMSFNCTypes"].TRectF.$clone(N),r,u)),this.InternalDrawText(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(b.Left,b.Top,b.Right+1,b.Bottom)),m.Get(f),s,o,n,r,a,l,h,F,p,c,u,C,T,S),N.Top=N.Top+(b.Bottom-b.Top),N.Bottom=N.Bottom+(b.Bottom-b.Top)}finally{m=rtl.freeLoc(m)}}else M=!1}return M||(d=this.InternalDrawText(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(t),e,s,o,n,r,a,l,h,F,p,c,u,C,T,S)),d},this.SaveState=function(t){var e=null;return e=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsSaveState.$create("Create$1"),t||(e.FFill.Assign(this.FFill),e.FStroke.Assign(this.FStroke),e.FFont.AssignSource(this.FFont)),this.GetContext().SaveState(e),e},this.ApplyHilight=function(t,e,i,s){return pas["WEBLib.TMSFNCHTMLEngine"].HiLight(t,e,i,s)},this.GetBitmapFromBitmapContainer=function(t,e,i,s){var o=null;return o=null,null!=t&&""!==e&&(i&&(o=s>0?t.FindBitmap$1(e+"_"+pas.SysUtils.FloatToStr(s)):t.FindBitmap$1(e+"_"+pas.SysUtils.FloatToStr(pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.GetDPIScale(null,-1)))),null==o&&(o=t.FindBitmap$1(e))),o},this.GetScaledBitmap=function(t,e,i){var s=null,o=null,n=null;return s=null,null!=t&&null!=(o=e>0?t.GetItemByScale(e):t.GetItemByScale(pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.GetDPIScale(null,-1)))&&(null==o.FBitmap||pas["WEBLib.TMSFNCTypes"].IsBitmapEmpty(o.FBitmap)?(null==(n=this.GetBitmapFromBitmapContainer(i,o.FBitmapName,!0,e))||pas["WEBLib.TMSFNCTypes"].IsBitmapEmpty(n))&&(null==(n=this.GetBitmapFromBitmapContainer(i,o.FBitmapName,!1,0))||pas["WEBLib.TMSFNCTypes"].IsBitmapEmpty(n))||(s=n):s=o.FBitmap),s},this.GetAspectSize=function(t,e,i,s,o,n,r,a,l){var h=0,F=0;r?i>0&&s>0&&o>0&&n>0?i<o&&s<n&&!a?(t.set(i),e.set(s)):i/s<o/n?(e.set(n),t.set(n*i/s)):(t.set(o),e.set(o*s/i)):(t.set(0),e.set(0)):a?(t.set(o),e.set(n)):(t.set(i),e.set(s),l&&(t.get()>=e.get()&&t.get()>0?(e.set(i/t.get()*e.get()),t.set(i)):e.get()>=t.get()&&e.get()>0&&(t.set(s/e.get()*t.get()),e.set(s)),h=0===s?1:i/s,(F=0===e.get()?1:t.get()/e.get())<1||h>F?(e.set(i/F),t.set(i)):(t.set(F*s),e.set(s))))},this.SetDefaultGraphicColors=function(){t.TTMSFNCGraphics.DefaultPopupFillColor=16777215,t.TTMSFNCGraphics.DefaultPopupStrokeColor=12632256,t.TTMSFNCGraphics.DefaultButtonFillColor=pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(225,225,225),t.TTMSFNCGraphics.DefaultButtonStrokeColor=11119017,t.TTMSFNCGraphics.DefaultTextFontColor=0,t.TTMSFNCGraphics.DefaultSelectionFillColor=0,t.TTMSFNCGraphics.DefaultButtonFillColorFocused=pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(229,241,251),t.TTMSFNCGraphics.DefaultButtonStrokeColorFocused=pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(60,127,177),t.TTMSFNCGraphics.DefaultButtonStrokeColorDisabled=11119017,t.TTMSFNCGraphics.DefaultButtonFillColorDisabled=13882323},this.PointInPath=function(t,e){return e.IsPointVisible(t)},this.PointInRect=function(t,e){return pas["WEBLib.TMSFNCTypes"].PtInRectEx(e,t)},this.GetColorRed=function(t){return t=pas["WEBLib.Graphics"].ColorToRGB(t),pas["WEBLib.Graphics"].GetRValue(t)},this.GetColorGreen=function(t){return t=pas["WEBLib.Graphics"].ColorToRGB(t),pas["WEBLib.Graphics"].GetGValue(t)},this.GetColorBlue=function(t){return t=pas["WEBLib.Graphics"].ColorToRGB(t),pas["WEBLib.Graphics"].GetBValue(t)},this.HTMLToColor=function(t){var e=0,i=0,s=0,o=0;return e=-1,""===t?e:(4===t.length?(i=pas.SysUtils.StrToInt("$"+pas.System.Copy(t,2,1)+pas.System.Copy(t,2,1)),s=pas.SysUtils.StrToInt("$"+pas.System.Copy(t,3,1)+pas.System.Copy(t,3,1)),o=pas.SysUtils.StrToInt("$"+pas.System.Copy(t,4,1)+pas.System.Copy(t,4,1))):(i=pas.SysUtils.StrToInt("$"+pas.System.Copy(t,2,2)),s=pas.SysUtils.StrToInt("$"+pas.System.Copy(t,4,2)),o=pas.SysUtils.StrToInt("$"+pas.System.Copy(t,6,2))),e=pas["WEBLib.Graphics"].RGB(i,s,o))},this.TextToColor=function(t){var e=0,i=0,s="",o=null;return s=t,s=pas.SysUtils.LowerCase(s),1===pas.System.Pos("cl",s)&&pas.System.Delete({get:function(){return s},set:function(t){s=t}},1,2),1===pas.System.Pos("cla",s)&&pas.System.Delete({get:function(){return s},set:function(t){s=t}},1,3),1===pas.System.Pos("gc",s)&&pas.System.Delete({get:function(){return s},set:function(t){s=t}},1,2),e=0,null!=(o=pas["WEBLib.TMSFNCGraphicsTypes"].ColorLookup())&&(i=o.IndexOf(pas.SysUtils.LowerCase(s)))>=0&&i<=o.GetCount()-1&&(e=o.GetObject(i).FColor),e}})),this.TMSFNCGRAPHICSCLOSE="data:image/PNG;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAACxIAAAsSAdLdfvwAAAAYdEVYdFNvZnR3YXJlAHBhaW50Lm5ldCA0LjAuOWwzfk4AAABVSURBVDhPYxh+QBSI/0OYWAFIThjCxA5ACmAYHeCTQwHYFGITwwuQNSBjkgBFmkGAIgNAGv5BaZINQdYMA0Qbgk0zDBBlCCiR4FMAkhOCMIcJYGAAAHvVMBv6PIFYAAAAAElFTkSuQmCC",this.TMSFNCGRAPHICSDOWN="data:image/PNG;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEwAACxMBAJqcGAAAAGdJREFUOI3tzjsOwjAURNGDUqSgTxU5K2AVrJtswjUsgHSR0qdxAZZFPrS+3ZvRzBsqf9MUtBtazJk+oMe0VTriiZCFX8nbpENMgfARjsn74vKj5IFruhfc8d6zIF9S/Hyk5HS4spMVeFcOjszaOwMAAAAASUVORK5CYII=",this.TMSFNCGRAPHICSDOWN2="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAACxIAAAsSAdLdfvwAAAAZdEVYdFNvZnR3YXJlAHBhaW50Lm5ldCA0LjAuMTZEaa/1AAAAdElEQVQ4T6XMsQ2AMBBD0UxBBwyA2L9jCWpY5bCLSJfgSFgUr+AHX4mIX2R0yOiQ0SGjQ8Ud5q7RClvX5IEDLlhS4/gGvuV/5YEJTuCAR+qYjW/N/81Hko8Mx/QKST0yHJOMCYfDMcnokNEho0NGh4zfRXkAxSYKjdpwcIUAAAAASUVORK5CYII=",this.TMSFNCGRAPHICSUP="data:image/PNG;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEwAACxMBAJqcGAAAAEZJREFUOI3tjLEJACAMwLLo5EM+rTjpXV7g0oI4tYKbgYwJfJ6Txet4iu6Jxk10TTSuQACidzKAIrGik24ZpCPeJ8ky+DhZ1JENPrPndiwAAAAASUVORK5CYII=",this.TMSFNCGRAPHICSUP2="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAACxIAAAsSAdLdfvwAAAAZdEVYdFNvZnR3YXJlAHBhaW50Lm5ldCA0LjAuMTZEaa/1AAAAcklEQVQ4T6XMMQ6AMAiF4S46eSEvremk5/IC+GggKfE1ER2+gZ9AEZFfaMygMYPGDBozaOyshu0aGo0eXmb4hEbw42qGTx4B/HiHCWYYPgmDOWEDPfbmT46uNWEwC/THTp/oLvQwfEFjBo0ZNGbQ+J6UG5Y9CmuVGrAsAAAAAElFTkSuQmCC",this.TMSFNCGRAPHICSPIN="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAOCAYAAAAfSC3RAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsIAAA7CARUoSoAAAAAZdEVYdFNvZnR3YXJlAHBhaW50Lm5ldCA0LjAuMTZEaa/1AAABKklEQVQ4T2PAB0JDQ5mjoqIEgUxGiAiRIDo6WiY8PHwdEGvW19czQYUJA6AGhbCwsO9Aek1ISIiZvb09C1QKPwBqaAbi/1DNJ4HYiqDNIE1ADZ9AGqGa/wLp6xERESZAaVQ/AyUUgDgIiOdCbQFrQsL/gPgxUM4OFACSQMYdIP4FFPwNxH+gpqNoAortAYayHNSfjAwgNwMFvaCaMTQA8W+g+M7IyEgNiLuQAMgUoNsDgYruoWkCOe1gcHCwHlQpJgA6wwCo6DySJhD+BDQwCaoEEwA1SQAVzQLiq0BcBMRXgBhk25PAwEBJqDJUkJaWxgr0QzoQbwYqdABGNCeQrQPSDKTv44w3oFPEgYqmAmk9UNqECjMCxWSBeAeUjx1ANWAkZCSD0AADAwDRpKHlJfOjAwAAAABJRU5ErkJggg==",this.TMSFNCGRAPHICSPIN2="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAOCAYAAAAfSC3RAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsIAAA7CARUoSoAAAAAZdEVYdFNvZnR3YXJlAHBhaW50Lm5ldCA0LjAuMTZEaa/1AAAA/UlEQVQ4T33Su2oCQRTGcddLYWmlQhTLCBIsQgoLSW2nj2Bj7yv4DGkCeYOQxiaBNJapbCI2ooU+gY3gbf1/w47MjosHfsvM7DlzY1JhGN6TQQGBM2bEOgke8IU60tGY4SYlqWGHT7wgC/PPT/SNoFDxH1owKyclWyrawsYJczwj8JO1tR4+oFX8OGONtpLLWGCPA47Q7H78ogqd06yoPXeg4qQCTfaDR1x3ZxuapYsl3NDWJnjCtUjcThNTuKHL6cPNM2yjhHfMMMQ/tNoGuoNYkeiTwwBjvCKPBlS8QuzFWPoU8QadQ29TY3qbFXxH/Ru2oYKbhww7kSdMXQD8wIToOQZE/AAAAABJRU5ErkJggg==",this.TMSFNCGRAPHICSRIGHT="data:image/PNG;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEwAACxMBAJqcGAAAAFNJREFUOI3tzzsSQFAQRNFDqSezHUuwYBJLsBuhEomE4/ll3HBq+nY1PxENRrS5xzK4L1jPSiISesxPJcORJJqwU9xthjrX/ko4mpBQocN0tf1rbDeZDIfcSud0AAAAAElFTkSuQmCC",this.TMSFNCGRAPHICSLEFT="data:image/PNG;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEwAACxMBAJqcGAAAAEpJREFUOI3lzKENgEAQAMEJBkkIDdDTSxp6gqMyCkB8IQgMFdwZAutn+U19Bi84MUbxhZrBawSXB+8RDDMaDkyvmQyZyYYuOvh6N24uDUKEV//MAAAAAElFTkSuQmCC",this.TMSFNCGRAPHICSEXPAND="data:image/PNG;base64,iVBORw0KGgoAAAANSUhEUgAAAAcAAAAHCAYAAADEUlfTAAAABGdBTUEAALGPC/xhBQAAAAlwSFlzAAAOvwAADr8BOAVTJAAAABh0RVh0U29mdHdhcmUAcGFpbnQubmV0IDQuMC4zjOaXUAAAACVJREFUGFdj+P//P07MEBYW9h8Xxi8JAjglYACnBAzglMAEDAwARZ1DA4NRF38AAAAASUVORK5CYII=",this.TMSFNCGRAPHICSEXPANDSVG="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSI+CjxnIGlkPSJzdXJmYWNlMSI+CjxwYXRoIHN0eWxlPSIgc3Ryb2tlOm5vbmU7ZmlsbC1ydWxlOm5vbnplcm87ZmlsbDpyZ2IoMCUsMCUsMCUpO2ZpbGwtb3BhY2l0eToxOyIgZD0iTSAxMS44Mzk4NDQgMi44ODY3MTkgQyAxMS42Mjg5MDYgMi42NzU3ODEgMTEuMjgxMjUgMi42NzU3ODEgMTEuMDcwMzEyIDIuODg2NzE5IEwgNiA3Ljk1NzAzMSBMIDAuOTI5Njg4IDIuODg2NzE5IEMgMC43MTg3NSAyLjY3NTc4MSAwLjM3MTA5NCAyLjY3NTc4MSAwLjE2MDE1NiAyLjg4NjcxOSBDIC0wLjA1NDY4NzUgMy4xMDE1NjIgLTAuMDU0Njg3NSAzLjQ0NTMxMiAwLjE2MDE1NiAzLjY2MDE1NiBMIDUuNjEzMjgxIDkuMTEzMjgxIEMgNS43MTQ4NDQgOS4yMTQ4NDQgNS44NTU0NjkgOS4yNzM0MzggNiA5LjI3MzQzOCBDIDYuMTQ0NTMxIDkuMjczNDM4IDYuMjg1MTU2IDkuMjE0ODQ0IDYuMzg2NzE5IDkuMTEzMjgxIEwgMTEuODM5ODQ0IDMuNjYwMTU2IEMgMTIuMDU0Njg4IDMuNDQ1MzEyIDEyLjA1NDY4OCAzLjEwMTU2MiAxMS44Mzk4NDQgMi44ODY3MTkgWiBNIDExLjgzOTg0NCAyLjg4NjcxOSAiLz4KPC9nPgo8L3N2Zz4K",this.TMSFNCGRAPHICSDOWNSVG="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSI+CjxnIGlkPSJzdXJmYWNlMSI+CjxwYXRoIHN0eWxlPSIgc3Ryb2tlOm5vbmU7ZmlsbC1ydWxlOm5vbnplcm87ZmlsbDpyZ2IoMCUsMCUsMCUpO2ZpbGwtb3BhY2l0eToxOyIgZD0iTSAxMS44Mzk4NDQgMi44ODY3MTkgQyAxMS42Mjg5MDYgMi42NzU3ODEgMTEuMjgxMjUgMi42NzU3ODEgMTEuMDcwMzEyIDIuODg2NzE5IEwgNiA3Ljk1NzAzMSBMIDAuOTI5Njg4IDIuODg2NzE5IEMgMC43MTg3NSAyLjY3NTc4MSAwLjM3MTA5NCAyLjY3NTc4MSAwLjE2MDE1NiAyLjg4NjcxOSBDIC0wLjA1NDY4NzUgMy4xMDE1NjIgLTAuMDU0Njg3NSAzLjQ0NTMxMiAwLjE2MDE1NiAzLjY2MDE1NiBMIDUuNjEzMjgxIDkuMTEzMjgxIEMgNS43MTQ4NDQgOS4yMTQ4NDQgNS44NTU0NjkgOS4yNzM0MzggNiA5LjI3MzQzOCBDIDYuMTQ0NTMxIDkuMjczNDM4IDYuMjg1MTU2IDkuMjE0ODQ0IDYuMzg2NzE5IDkuMTEzMjgxIEwgMTEuODM5ODQ0IDMuNjYwMTU2IEMgMTIuMDU0Njg4IDMuNDQ1MzEyIDEyLjA1NDY4OCAzLjEwMTU2MiAxMS44Mzk4NDQgMi44ODY3MTkgWiBNIDExLjgzOTg0NCAyLjg4NjcxOSAiLz4KPC9nPgo8L3N2Zz4K",this.TMSFNCGRAPHICSUPSVG="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSI+CjxnIGlkPSJzdXJmYWNlMSI+CjxwYXRoIHN0eWxlPSIgc3Ryb2tlOm5vbmU7ZmlsbC1ydWxlOm5vbnplcm87ZmlsbDpyZ2IoMCUsMCUsMCUpO2ZpbGwtb3BhY2l0eToxOyIgZD0iTSAxMS44Mzk4NDQgOC4zMzk4NDQgTCA2LjM4NjcxOSAyLjg4NjcxOSBDIDYuMjg1MTU2IDIuNzg1MTU2IDYuMTQ0NTMxIDIuNzI2NTYyIDYgMi43MjY1NjIgQyA1Ljg1NTQ2OSAyLjcyNjU2MiA1LjcxNDg0NCAyLjc4NTE1NiA1LjYxMzI4MSAyLjg4NjcxOSBMIDAuMTYwMTU2IDguMzM5ODQ0IEMgLTAuMDU0Njg3NSA4LjU1NDY4OCAtMC4wNTQ2ODc1IDguODk4NDM4IDAuMTYwMTU2IDkuMTEzMjgxIEMgMC4zNzEwOTQgOS4zMjQyMTkgMC43MTg3NSA5LjMyNDIxOSAwLjkyOTY4OCA5LjExMzI4MSBMIDYgNC4wNDI5NjkgTCAxMS4wNzAzMTIgOS4xMTMyODEgQyAxMS4xNzU3ODEgOS4yMTg3NSAxMS4zMTY0MDYgOS4yNzM0MzggMTEuNDUzMTI1IDkuMjczNDM4IEMgMTEuNTkzNzUgOS4yNzM0MzggMTEuNzM0Mzc1IDkuMjE4NzUgMTEuODM5ODQ0IDkuMTEzMjgxIEMgMTIuMDU0Njg4IDguODk4NDM4IDEyLjA1NDY4OCA4LjU1NDY4OCAxMS44Mzk4NDQgOC4zMzk4NDQgWiBNIDExLjgzOTg0NCA4LjMzOTg0NCAiLz4KPC9nPgo8L3N2Zz4K",this.TMSFNCGRAPHICSRIGHTSVG="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSI+CjxnIGlkPSJzdXJmYWNlMSI+CjxwYXRoIHN0eWxlPSIgc3Ryb2tlOm5vbmU7ZmlsbC1ydWxlOm5vbnplcm87ZmlsbDpyZ2IoMCUsMCUsMCUpO2ZpbGwtb3BhY2l0eToxOyIgZD0iTSA5LjExMzI4MSA1LjYxMzI4MSBMIDMuNjYwMTU2IDAuMTYwMTU2IEMgMy40NDUzMTIgLTAuMDU0Njg3NSAzLjEwMTU2MiAtMC4wNTQ2ODc1IDIuODg2NzE5IDAuMTYwMTU2IEMgMi42NzU3ODEgMC4zNzEwOTQgMi42NzU3ODEgMC43MTg3NSAyLjg4NjcxOSAwLjkyOTY4OCBMIDcuOTU3MDMxIDYgTCAyLjg4NjcxOSAxMS4wNzAzMTIgQyAyLjY3NTc4MSAxMS4yODEyNSAyLjY3NTc4MSAxMS42Mjg5MDYgMi44ODY3MTkgMTEuODM5ODQ0IEMgMi45OTIxODggMTEuOTQ1MzEyIDMuMTMyODEyIDEyIDMuMjczNDM4IDEyIEMgMy40MTQwNjIgMTIgMy41NTA3ODEgMTEuOTQ1MzEyIDMuNjYwMTU2IDExLjgzOTg0NCBMIDkuMTEzMjgxIDYuMzg2NzE5IEMgOS4yMTQ4NDQgNi4yODUxNTYgOS4yNzM0MzggNi4xNDQ1MzEgOS4yNzM0MzggNiBDIDkuMjczNDM4IDUuODU1NDY5IDkuMjE0ODQ0IDUuNzE0ODQ0IDkuMTEzMjgxIDUuNjEzMjgxIFogTSA5LjExMzI4MSA1LjYxMzI4MSAiLz4KPC9nPgo8L3N2Zz4K",this.TMSFNCGRAPHICSLEFTSVG="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSI+CjxnIGlkPSJzdXJmYWNlMSI+CjxwYXRoIHN0eWxlPSIgc3Ryb2tlOm5vbmU7ZmlsbC1ydWxlOm5vbnplcm87ZmlsbDpyZ2IoMCUsMCUsMCUpO2ZpbGwtb3BhY2l0eToxOyIgZD0iTSA0LjA0Mjk2OSA2IEwgOS4xMTMyODEgMC45Mjk2ODggQyA5LjMyNDIxOSAwLjcxODc1IDkuMzI0MjE5IDAuMzcxMDk0IDkuMTEzMjgxIDAuMTYwMTU2IEMgOC44OTg0MzggLTAuMDU0Njg3NSA4LjU1NDY4OCAtMC4wNTQ2ODc1IDguMzM5ODQ0IDAuMTYwMTU2IEwgMi44ODY3MTkgNS42MTMyODEgQyAyLjc4NTE1NiA1LjcxNDg0NCAyLjcyNjU2MiA1Ljg1NTQ2OSAyLjcyNjU2MiA2IEMgMi43MjY1NjIgNi4xNDQ1MzEgMi43ODUxNTYgNi4yODUxNTYgMi44ODY3MTkgNi4zODY3MTkgTCA4LjMzOTg0NCAxMS44Mzk4NDQgQyA4LjQ0OTIxOSAxMS45NDUzMTIgOC41ODU5MzggMTIgOC43MjY1NjIgMTIgQyA4Ljg2NzE4OCAxMiA5LjAwNzgxMiAxMS45NDUzMTIgOS4xMTMyODEgMTEuODM5ODQ0IEMgOS4zMjQyMTkgMTEuNjI4OTA2IDkuMzI0MjE5IDExLjI4MTI1IDkuMTEzMjgxIDExLjA3MDMxMiBaIE0gNC4wNDI5NjkgNiAiLz4KPC9nPgo8L3N2Zz4K",this.TMSFNCGRAPHICSCLOSESVG="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSI+CjxnIGlkPSJzdXJmYWNlMSI+CjxwYXRoIHN0eWxlPSIgc3Ryb2tlOm5vbmU7ZmlsbC1ydWxlOm5vbnplcm87ZmlsbDpyZ2IoMCUsMCUsMCUpO2ZpbGwtb3BhY2l0eToxOyIgZD0iTSA3LjA2MjUgNiBMIDExLjc4MTI1IDEuMjgxMjUgQyAxMi4wNzQyMTkgMC45ODgyODEgMTIuMDc0MjE5IDAuNTExNzE5IDExLjc4MTI1IDAuMjE4NzUgQyAxMS40ODgyODEgLTAuMDc0MjE4OCAxMS4wMTE3MTkgLTAuMDc0MjE4OCAxMC43MTg3NSAwLjIxODc1IEwgNiA0LjkzNzUgTCAxLjI4MTI1IDAuMjE4NzUgQyAwLjk4ODI4MSAtMC4wNzQyMTg4IDAuNTExNzE5IC0wLjA3NDIxODggMC4yMTg3NSAwLjIxODc1IEMgLTAuMDc0MjE4OCAwLjUxMTcxOSAtMC4wNzQyMTg4IDAuOTg4MjgxIDAuMjE4NzUgMS4yODEyNSBMIDQuOTM3NSA2IEwgMC4yMTg3NSAxMC43MTg3NSBDIC0wLjA3NDIxODggMTEuMDExNzE5IC0wLjA3NDIxODggMTEuNDg4MjgxIDAuMjE4NzUgMTEuNzgxMjUgQyAwLjM2NzE4OCAxMS45MjU3ODEgMC41NTg1OTQgMTIgMC43NSAxMiBDIDAuOTQxNDA2IDEyIDEuMTMyODEyIDExLjkyNTc4MSAxLjI4MTI1IDExLjc4MTI1IEwgNiA3LjA2MjUgTCAxMC43MTg3NSAxMS43ODEyNSBDIDEwLjg2NzE4OCAxMS45MjU3ODEgMTEuMDU4NTk0IDEyIDExLjI1IDEyIEMgMTEuNDQxNDA2IDEyIDExLjYzMjgxMiAxMS45MjU3ODEgMTEuNzgxMjUgMTEuNzgxMjUgQyAxMi4wNzQyMTkgMTEuNDg4MjgxIDEyLjA3NDIxOSAxMS4wMTE3MTkgMTEuNzgxMjUgMTAuNzE4NzUgWiBNIDcuMDYyNSA2ICIvPgo8L2c+Cjwvc3ZnPgo=",t.$init=function(){pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.CreateFromResource(t.TMSFNCGRAPHICSCLOSE),pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.CreateFromResource(t.TMSFNCGRAPHICSDOWN),pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.CreateFromResource(t.TMSFNCGRAPHICSRIGHT),pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.CreateFromResource(t.TMSFNCGRAPHICSLEFT),pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.CreateFromResource(t.TMSFNCGRAPHICSEXPAND),pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.CreateFromResource(t.TMSFNCGRAPHICSPIN),pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.CreateFromResource(t.TMSFNCGRAPHICSPIN2),pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.CreateFromResource(t.TMSFNCGRAPHICSDOWN),pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.CreateFromResource(t.TMSFNCGRAPHICSDOWN2),pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.CreateFromResource(t.TMSFNCGRAPHICSUP),pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.CreateFromResource(t.TMSFNCGRAPHICSUP2),pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.CreateFromResource(t.TMSFNCGRAPHICSEXPANDSVG),pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.CreateFromResource(t.TMSFNCGRAPHICSUPSVG),pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.CreateFromResource(t.TMSFNCGRAPHICSRIGHTSVG),pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.CreateFromResource(t.TMSFNCGRAPHICSLEFTSVG),pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.CreateFromResource(t.TMSFNCGRAPHICSDOWNSVG),pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.CreateFromResource(t.TMSFNCGRAPHICSCLOSESVG)}}),["SysUtils","Math","WEBLib.TMSFNCUtils","WEBLib.TMSFNCHTMLEngine","WEBLib.TMSFNCGraphics.General","WEBLib.TMSFNCGraphics.WEB"]),rtl.module("WEBLib.DesignIntf",["System","Classes","Web","JS","TypInfo","WEBLib.Forms","WEBLib.Menus"],(function(){"use strict";var t=this.$impl;rtl.createClass(this,"TRegisteredComponent",pas.System.TObject,(function(){this.$init=function(){pas.System.TObject.$init.call(this),this.FIcon=""}})),this.GetRegisteredComponent=function(e){var i=null,s=null;if(i=null,""===e)return i;s=null;var o=Object.keys(t.RegisteredComponentList).map((function(e){return[t.RegisteredComponentList[e]]}));for(let t of o)if(t[0].FClass.$classname.toLowerCase()==e.toLowerCase()){s=t[0];break}return i=s},this.$implcode=function(){t.RegisteredComponentList=null,t.RegisteredSelectionEditorList=null,t.RegisteredPropertyEditorList=null,t.RegisteredIgnoredPropertyList=null,t.RegisteredLibraryRequirementsEditorList=null,t.RegisteredComponentEditorList=null,t.RegisteredIdentToIntList=null},this.$init=function(){t.RegisteredComponentList=Object.create(null),t.RegisteredSelectionEditorList=Object.create(null),t.RegisteredPropertyEditorList=Object.create(null),t.RegisteredIgnoredPropertyList=Object.create(null),t.RegisteredLibraryRequirementsEditorList=Object.create(null),t.RegisteredComponentEditorList=Object.create(null),t.RegisteredIdentToIntList=Object.create(null)}}),["SysUtils","Generics.Collections"]),rtl.module("WEBLib.TMSFNCCustomComponent",["System","Classes","WEBLib.Controls","WEBLib.TMSFNCTypes","WEBLib.TMSFNCPersistence","TypInfo"],(function(){"use strict";var t=this;this.$rtti.$MethodVar("TTMSFNCCustomComponentCanSavePropertyEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AObject",pas.System.$rtti.TObject],["APropertyName",rtl.string],["APropertyType",pas.System.$rtti.TTypeKind],["ACanSave",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCCustomComponentCanLoadPropertyEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AObject",pas.System.$rtti.TObject],["APropertyName",rtl.string],["APropertyType",pas.System.$rtti.TTypeKind],["ACanLoad",rtl.boolean,1]]),methodkind:0}),rtl.createClass(this,"TTMSFNCCustomComponent",pas["WEBLib.Controls"].TCustomControl,(function(){this.FBlockPersistenceInterface=!1,this.$init=function(){pas["WEBLib.Controls"].TCustomControl.$init.call(this),this.FStored=!1,this.FDesigntimeFormPixelsPerInch=0,this.FAppearancePersisting=!1,this.FAdaptToStyle=!1,this.FOnCanSaveProperty=null,this.FOnCanLoadProperty=null},this.$final=function(){this.FOnCanSaveProperty=void 0,this.FOnCanLoadProperty=void 0,pas["WEBLib.Controls"].TCustomControl.$final.call(this)},this.GetVersionNumber=function(t,e,i,s){return"",""},this.DoCanSaveProperty=function(t,e,i,s){null!=this.FOnCanSaveProperty&&this.FOnCanSaveProperty(this,t,e,i,s)},this.DoCanLoadProperty=function(t,e,i,s){null!=this.FOnCanLoadProperty&&this.FOnCanLoadProperty(this,t,e,i,s)},this.IsAppearanceProperty=function(t,e,i){return!1,!1},this.CanSaveProperty=function(t,e,i){var s=!1;return s=!(t===this&&!this.FBlockPersistenceInterface)||-1===pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.IndexOfTextInArray(e,pas["WEBLib.TMSFNCPersistence"].ExcludePropertyList),this.FAppearancePersisting&&(s=s&&this.IsAppearanceProperty(t,e,i)),this.DoCanSaveProperty(t,e,i,{get:function(){return s},set:function(t){s=t}}),s},this.CanLoadProperty=function(t,e,i){var s=!1;return s=!(t===this&&!this.FBlockPersistenceInterface)||-1===pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.IndexOfTextInArray(e,pas["WEBLib.TMSFNCPersistence"].ExcludePropertyList),this.DoCanLoadProperty(t,e,i,{get:function(){return s},set:function(t){s=t}}),s},this.GetVersion=function(){return"",""},this.GetDocURL=function(){return pas["WEBLib.TMSFNCTypes"].TTMSFNCBaseDocURL},this.GetTipsURL=function(){return pas["WEBLib.TMSFNCTypes"].TTMSFNCBaseTipsURL},this.SetAdaptToStyle=function(t){this.FAdaptToStyle=t},this.Paint=function(){var t=null,e=null,i=null,s=null;pas["WEBLib.Controls"].TCustomControl.Paint.call(this),i=null,t=pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.$create("Create$3"),e=pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.$create("Create$1",[this.GetCanvas(),!1]);try{e.FStroke.SetKind(1),e.FStroke.SetColor(0),e.DrawRectangle$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(0,0,this.GetWidth(),this.GetHeight())),2),null!=(s=pas["WEBLib.DesignIntf"].GetRegisteredComponent(this.$classname))&&t.LoadFromResource(s.FIcon),e.DrawBitmap$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(2,2,this.GetWidth()-2,this.GetHeight()-2)),t,!0,!0,!0,!1)}finally{null!=i&&(i=rtl.freeLoc(i)),t=rtl.freeLoc(t),e=rtl.freeLoc(e)}},this.Loaded=function(){pas["WEBLib.Controls"].TCustomControl.Loaded.call(this),4 in this.FComponentState||this.SetVisible(!1)},this.RegisterRuntimeClasses=function(){},this.Create$1=function(t){var e=0;return pas["WEBLib.Controls"].TControl.Create$1.apply(this,arguments),e=96,this.FDesigntimeFormPixelsPerInch=e,this.SetWidth(26),this.SetHeight(26),this.IsDesigning()||this.RegisterRuntimeClasses(),this},this.SetBounds=function(t,e,i,s){var o;o=pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.GetDPIScale(this,-1),pas["WEBLib.Controls"].TControl.SetBounds.call(this,t,e,Math.round(26*o),Math.round(26*o))},this.BeginUpdate=function(){pas["WEBLib.Controls"].TControl.BeginUpdate.call(this)},this.EndUpdate=function(){pas["WEBLib.Controls"].TCustomControl.EndUpdate.call(this)},this.IsDesignTime=function(){var t=!1;return t=!1,null!=this.FOwner&&(t=this.IsDesigning()&&!(1 in this.FOwner.FComponentState||0 in this.FOwner.FComponentState)),t},this.IsDesigning=function(){return 4 in this.FComponentState||null!=pas["WEBLib.Forms"].VSIDE},this.SaveSettingsToStream=function(t,e){this.FAppearancePersisting=e,pas["WEBLib.TMSFNCPersistence"].TTMSFNCPersistence.SaveSettingsToStream(this,t),this.FAppearancePersisting=!1},rtl.addIntf(this,pas["WEBLib.TMSFNCTypes"].ITMSFNCProductInfo),rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas.System.IUnknown);var e=this.$rtti;e.addProperty("Visible",2,rtl.boolean,"FVisible","SetVisible",{Default:!0}),e.addProperty("Width",3,rtl.longint,"GetWidth","SetWidth"),e.addProperty("Height",3,rtl.longint,"GetHeight","SetHeight"),e.addProperty("OnCanSaveProperty",0,t.$rtti.TTMSFNCCustomComponentCanSavePropertyEvent,"FOnCanSaveProperty","FOnCanSaveProperty"),e.addProperty("OnCanLoadProperty",0,t.$rtti.TTMSFNCCustomComponentCanLoadPropertyEvent,"FOnCanLoadProperty","FOnCanLoadProperty")}))}),["WEBLib.TMSFNCUtils","WEBLib.Forms","SysUtils","WEBLib.TMSFNCGraphics","WEBLib.Graphics","WEBLib.TMSFNCGraphicsTypes","Types","WEBLib.DesignIntf"]),rtl.module("WEBLib.TMSFNCBitmapContainer",["System","Classes","WEBLib.TMSFNCTypes","WEBLib.TMSFNCCustomComponent","WEBLib.Controls"],(function(){"use strict";var t=this;this.MAJ_VER=1,this.MIN_VER=0,this.REL_VER=0,this.BLD_VER=0,this.$rtti.$Class("TTMSFNCBitmapContainer"),rtl.createInterface(this,"ITMSFNCBitmapContainer","{ED26710D-395F-4971-8AC9-A31083BF2A3C}",["GetBitmapContainer"],pas.System.IUnknown),rtl.createClass(this,"TTMSFNCBitmapItem",pas.Classes.TCollectionItem,(function(){this.$init=function(){pas.Classes.TCollectionItem.$init.call(this),this.FBitmap=null,this.FTag=0,this.FName=""},this.$final=function(){this.FBitmap=void 0,pas.Classes.TCollectionItem.$final.call(this)},this.SetBitmap=function(t){this.FBitmap.Assign(t)},this.Create$1=function(t){return pas.Classes.TCollectionItem.Create$1.apply(this,arguments),this.FBitmap=pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.$create("Create$3"),this.FBitmap.FOnChange=rtl.createCallback(this,"DoBitmapChanged"),this.FName="Item"+pas.SysUtils.IntToStr(this.FCollection.GetCount()),this},this.Destroy=function(){rtl.free(this,"FBitmap"),pas.Classes.TCollectionItem.Destroy.call(this)},this.DoBitmapChanged=function(e){t.TTMSFNCBitmapCollection.isPrototypeOf(this.FCollection)&&null!=rtl.as(this.FCollection,t.TTMSFNCBitmapCollection).FOwner$1&&rtl.as(this.FCollection,t.TTMSFNCBitmapCollection).FOwner$1.DoBitmapChanged(this)},this.Assign=function(e){this.FName=rtl.as(e,t.TTMSFNCBitmapItem).FName,this.FTag=rtl.as(e,t.TTMSFNCBitmapItem).FTag,this.FBitmap.Assign(rtl.as(e,t.TTMSFNCBitmapItem).FBitmap)};var e=this.$rtti;e.addProperty("Bitmap",2,pas["WEBLib.TMSFNCTypes"].$rtti.TTMSFNCBitmap,"FBitmap","SetBitmap"),e.addProperty("Name",0,rtl.string,"FName","FName"),e.addProperty("Tag",0,rtl.nativeint,"FTag","FTag")})),rtl.createClass(this,"TTMSFNCBitmapCollection",pas.Classes.TOwnedCollection,(function(){this.$init=function(){pas.Classes.TOwnedCollection.$init.call(this),this.FOwner$1=null},this.$final=function(){this.FOwner$1=void 0,pas.Classes.TOwnedCollection.$final.call(this)},this.GetItemEx=function(t){return this.GetItem(t)},this.GetBitmapItemClass=function(){return t.TTMSFNCBitmapItem},this.Create$3=function(t){return pas.Classes.TOwnedCollection.Create$2.call(this,t,this.GetBitmapItemClass()),this.FOwner$1=t,this}})),rtl.createClass(this,"TControlList",pas.Classes.TList,(function(){})),rtl.createClass(this,"TTMSFNCBitmapContainer",pas["WEBLib.TMSFNCCustomComponent"].TTMSFNCCustomComponent,(function(){this.$init=function(){pas["WEBLib.TMSFNCCustomComponent"].TTMSFNCCustomComponent.$init.call(this),this.FControls$1=null,this.FItems=null,this.FOnBitmapChanged=null},this.$final=function(){this.FControls$1=void 0,this.FItems=void 0,this.FOnBitmapChanged=void 0,pas["WEBLib.TMSFNCCustomComponent"].TTMSFNCCustomComponent.$final.call(this)},this.SetItems=function(t){this.FItems.Assign(t)},this.GetBitmapName=function(t){var e="";return e="",t>=0&&t<=this.GetItems().GetCount()-1&&(e=this.GetItems().GetItemEx(t).FName),e},this.GetBitmap=function(t){var e=null;return e=null,t>=0&&t<=this.GetItems().GetCount()-1&&(e=this.GetItems().GetItemEx(t).FBitmap),e},this.GetItems=function(){return this.FItems},this.GetVersion=function(){return this.$class.GetVersionNumber(1,0,0,0)},this.CreateItems=function(){return t.TTMSFNCBitmapCollection.$create("Create$3",[this])},this.RegisterRuntimeClasses=function(){pas.Classes.RegisterClass(t.TTMSFNCBitmapContainer)},this.Notification=function(t,e){var i=0;if(pas.Classes.TComponent.Notification.apply(this,arguments),1===e&&null!=this.FControls$1)for(var s=this.FControls$1.GetCount()-1;s>=0;s--)i=s,this.FControls$1.Get(i)==t&&this.FControls$1.Delete(i)},this.DoBitmapChanged=function(t){var e=null,i=0;if(null!=(e=pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.GetParentForm(this)))for(var s=0,o=e.GetControlsCount()-1;s<=o;s++)i=s,pas["WEBLib.Controls"].TWinControl.isPrototypeOf(e.GetControls(i))&&this.InvalidateMembers(rtl.as(e.GetControls(i),pas["WEBLib.Controls"].TWinControl));null!=this.FOnBitmapChanged&&this.FOnBitmapChanged(this)},this.InvalidateMembers=function(t){var e=0;if(null!=t){null!=pas.TypInfo.GetPropInfo$2(t,"BitmapContainer")&&t.Invalidate();for(var i=0,s=t.GetControlsCount()-1;i<=s;i++)e=i,pas["WEBLib.Controls"].TWinControl.isPrototypeOf(t.GetControls(e))&&this.InvalidateMembers(rtl.as(t.GetControls(e),pas["WEBLib.Controls"].TWinControl))}},this.Create$1=function(e){return pas["WEBLib.TMSFNCCustomComponent"].TTMSFNCCustomComponent.Create$1.apply(this,arguments),this.FItems=this.CreateItems(),this.FControls$1=t.TControlList.$create("Create$1"),this},this.Destroy=function(){pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FControls$1},set:function(t){this.p.FControls$1=t}}),rtl.free(this,"FItems"),pas["WEBLib.Controls"].TCustomControl.Destroy.call(this)},this.Assign=function(e){t.TTMSFNCBitmapContainer.isPrototypeOf(e)?this.FItems.Assign(rtl.as(e,t.TTMSFNCBitmapContainer).GetItems()):pas["WEBLib.Controls"].TControl.Assign.apply(this,arguments)},this.FindBitmap$1=function(t){var e=null,i=0;for(e=null,t=pas.SysUtils.UpperCase(t),i=1;i<=this.GetItems().GetCount();){if(pas.SysUtils.UpperCase(this.GetItems().GetItemEx(i-1).FName)===t){e=this.GetItems().GetItemEx(i-1).FBitmap;break}i+=1}return e},this.ItemCount=function(){return this.GetItems().GetCount()},rtl.addIntf(this,pas["WEBLib.TMSFNCTypes"].ITMSFNCProductInfo),rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas.System.IUnknown);var e=this.$rtti;e.addProperty("Items",3,t.$rtti.TTMSFNCBitmapCollection,"GetItems","SetItems"),e.addProperty("Version",1,rtl.string,"GetVersion",""),e.addProperty("OnBitmapChanged",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnBitmapChanged","FOnBitmapChanged"),e.attr=[pas.Classes.ComponentPlatformsAttribute,"Create$1",[0]]}))}),["TypInfo","WEBLib.Forms","SysUtils","WEBLib.TMSFNCUtils"]),rtl.module("WEBLib.TMSFNCStyles",["System","Classes","WEBLib.Graphics","WEBLib.Controls","WEBLib.Forms","WEBLib.TMSFNCTypes","WEBLib.TMSFNCCustomComponent","WEBLib.TMSFNCGraphicsTypes","JS","WEBLib.JSON"],(function(){"use strict";var t=this;rtl.createInterface(this,"ITMSFNCAdaptToStyle","{3EFF288D-3927-4E86-8E9D-EF684B501C9E}",["SetAdaptToStyle"],pas.System.IUnknown),rtl.createClass(this,"TTMSFNCStyles",pas.System.TObject,(function(){this.ExtractColor=function(t){var e=0,i="",s="",o=null,n=0,r=0;function a(t){return pas.SysUtils.StrToInt(pas.SysUtils.Trim(pas.SysUtils.StringReplace(t,"rgb(","",rtl.createSet(0))))}if(e=-1,""!==t)if(i=pas.SysUtils.LowerCase(pas.SysUtils.StringReplace(t," ","",rtl.createSet(0))),1===pas.System.Pos("linear-gradient",i))0===(n=pas.System.Pos("rgb",i))&&(n=pas.System.Pos("#",i)),r=pas.System.Pos$1(")",i,n),s=pas.System.Copy(i,n,r-n+1),0===(n=pas.System.Pos$1("rgb",i,r))&&(n=pas.System.Pos("#",i)),r=pas.System.Pos$1(")",i,n),e=this.ExtractColor(s);else if(1===pas.System.Pos("rgb",i)){o=pas.Classes.TStringList.$create("Create$1");try{o.SetDelimiter(","),o.SetDelimitedText(i),e=pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(a(o.Get(0)),a(o.Get(1)),a(o.Get(2)))}finally{o=rtl.freeLoc(o)}}else 1===pas.System.Pos("#",i)&&(e=pas["WEBLib.Graphics"].HexToColor(i));return e},this.ExtractColorTo=function(t){var e=0,i="",s="",o=null,n=0,r=0;function a(t){return pas.SysUtils.StrToInt(pas.SysUtils.Trim(pas.SysUtils.StringReplace(t,"rgb(","",rtl.createSet(0))))}if(e=-1,""!==t)if(i=pas.SysUtils.LowerCase(pas.SysUtils.StringReplace(t," ","",rtl.createSet(0))),1===pas.System.Pos("linear-gradient",i))0===(n=pas.System.Pos("rgb",i))&&(n=pas.System.Pos("#",i)),r=pas.System.Pos$1(")",i,n),0===(n=pas.System.Pos$1("rgb",i,r))&&(n=pas.System.Pos("#",i)),r=pas.System.Pos$1(")",i,n),s=pas.System.Copy(i,n,r-n+1),e=this.ExtractColor(s);else if(1===pas.System.Pos("rgb",i)){o=pas.Classes.TStringList.$create("Create$1");try{o.SetDelimiter(","),o.SetDelimitedText(i),e=pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(a(o.Get(0)),a(o.Get(1)),a(o.Get(2)))}finally{o=rtl.freeLoc(o)}}else 1===pas.System.Pos("#",i)&&(e=pas["WEBLib.Graphics"].HexToColor(i));return e},this.GetStyleBackgroundFill=function(){return this.FindCSSStyleProperty(".TMSFNCGridStyle","background")},this.GetStyleBackgroundStroke=function(){return this.FindCSSStyleProperty(".TMSFNCGridStyle","border-color")},this.GetStyleDefaultButtonFill=function(){return this.FindCSSStyleProperty(".TMSFNCButtonStyle","background")},this.GetStyleDefaultButtonStroke=function(){return this.FindCSSStyleProperty(".TMSFNCButtonStyle","border-color")},this.GetStyleEditTextColor=function(){return this.FindCSSStyleProperty(".TMSFNCEditStyle","--foreground")},this.GetStyleHeaderFill=function(){return this.FindCSSStyleProperty(".TMSFNCHeaderItemStyle","background")},this.GetStyleSelectionFill=function(){return this.FindCSSStyleProperty(".TMSFNCGridStyle","--selection")},this.GetStyleAlternativeBackgroundFill=function(){return this.FindCSSStyleProperty(".TMSFNCMemoStyle","background")},this.GetStyleLineFill=function(){return this.FindCSSStyleProperty(".TMSFNCGridStyle","--linefill")},this.GetStyleTextColor=function(){return this.FindCSSStyleProperty(".TMSFNCHeaderItemStyle","color")},this.FindCSSStyleRule=function(e){var i,s;i=e,s=t.CSSStyleFileName;for(var o=0;o<document.styleSheets.length;o++){var n=document.styleSheets[o].href;if(null!=n&&s==n.substring(n.lastIndexOf("/")+1))for(var r=document.styleSheets[o].rules||document.styleSheets[o].cssRules,a=0;a<r.length;a++)if(r[a].selectorText.startsWith(i))return r[a]}return null},this.FindCSSStyleProperty=function(t,e){var i="",s=null,o="";return i="",null!=(s=this.FindCSSStyleRule(t))&&(o=e,i=s.style.getPropertyValue(o)),i},this.StyleServicesEnabled=function(){return!0,!0},this.GetStyleLineFillColor=function(t){var e=!1,i="",s=0;return e=!1,this.StyleServicesEnabled()&&""!==(i=this.GetStyleLineFill())&&(s=this.ExtractColor(i),t.set(s),e=-1!==s),e},this.GetStyleBackgroundFillColor=function(t){var e=!1,i="",s=0;return e=!1,this.StyleServicesEnabled()&&""!==(i=this.GetStyleBackgroundFill())&&(s=this.ExtractColor(i),t.set(s),e=-1!==s),e},this.GetStyleAlternativeBackgroundFillColor=function(t){var e=!1,i="",s=0;return e=!1,this.StyleServicesEnabled()&&""!==(i=this.GetStyleAlternativeBackgroundFill())&&(s=this.ExtractColor(i),t.set(s),e=-1!==s),e},this.GetStyleBackgroundStrokeColor=function(t){var e=!1,i="",s=0;return e=!1,this.StyleServicesEnabled()&&""!==(i=this.GetStyleBackgroundStroke())&&(s=this.ExtractColor(i),t.set(s),e=-1!==s),e},this.GetStyleHeaderFillColor=function(t){var e=!1,i="",s=0;return e=!1,this.StyleServicesEnabled()&&""!==(i=this.GetStyleHeaderFill())&&(s=this.ExtractColor(i),t.set(s),e=-1!==s),e},this.GetStyleHeaderFillColorTo=function(t){var e=!1,i="",s=0;return e=!1,this.StyleServicesEnabled()&&""!==(i=this.GetStyleHeaderFill())&&(s=this.ExtractColorTo(i),t.set(s),e=-1!==s),e},this.GetStyleSelectionFillColor=function(t){var e=!1,i="",s=0;return e=!1,this.StyleServicesEnabled()&&""!==(i=this.GetStyleSelectionFill())&&(s=this.ExtractColor(i),t.set(s),e=-1!==s),e},this.GetStyleSelectionFillColorTo=function(t){var e=!1,i="",s=0;return e=!1,this.StyleServicesEnabled()&&""!==(i=this.GetStyleSelectionFill())&&(s=this.ExtractColorTo(i),t.set(s),e=-1!==s),e},this.GetStyleTextFontColor=function(t){var e=!1,i="",s=0;return e=!1,this.StyleServicesEnabled()&&""!==(i=this.GetStyleTextColor())&&(s=this.ExtractColor(i),t.set(s),e=-1!==s),e},this.GetStyleAlternativeTextFontColor=function(t){var e=!1,i="",s=0;return e=!1,this.StyleServicesEnabled()&&""!==(i=this.GetStyleEditTextColor())&&(s=this.ExtractColor(i),t.set(s),e=-1!==s),e},this.GetStyleDefaultButtonFillColor=function(t){var e=!1,i="",s=0;return e=!1,this.StyleServicesEnabled()&&""!==(i=this.GetStyleDefaultButtonFill())&&(s=this.ExtractColor(i),t.set(s),e=-1!==s),e},this.GetStyleDefaultButtonStrokeColor=function(t){var e=!1,i="",s=0;return e=!1,this.StyleServicesEnabled()&&""!==(i=this.GetStyleDefaultButtonStroke())&&(s=this.ExtractColor(i),t.set(s),e=-1!==s),e}})),this.CSSStyleFileName=""}),["WEBLib.TMSFNCUtils","SysUtils","WEBLib.TMSFNCPersistence","WEBLib.TMSFNCGraphics"]),rtl.module("WEBLib.TMSFNCUndo",["System","Classes","WEBLib.TMSFNCTypes"],(function(){"use strict";var t=this;rtl.createClass(this,"TTMSFNCUndoStackItem",pas.Classes.TCollectionItem,(function(){this.$init=function(){pas.Classes.TCollectionItem.$init.call(this),this.FActionName="",this.FState=null},this.$final=function(){this.FState=void 0,pas.Classes.TCollectionItem.$final.call(this)},this.Create$1=function(t){return pas.Classes.TCollectionItem.Create$1.call(this,t),this.FState=pas.Classes.TMemoryStream.$create("Create"),this},this.Destroy=function(){rtl.free(this,"FState"),pas.Classes.TCollectionItem.Destroy.call(this)}})),rtl.createClass(this,"TTMSFNCUndoManager",pas.Classes.TCollection,(function(){this.$init=function(){pas.Classes.TCollection.$init.call(this),this.FCurrent=0,this.FObject=null,this.FMaxStackCount=0},this.$final=function(){this.FObject=void 0,pas.Classes.TCollection.$final.call(this)},this.GetStackItem=function(t){var e=null;return e=null,t>-1&&t<this.GetCount()&&(e=this.GetItem(t)),e},this.NextUndoAction=function(){var t="";return t="",this.FCurrent>-1&&this.FCurrent<this.GetCount()&&(t=this.GetItem(this.FCurrent).FActionName),t},this.NextRedoAction=function(){var t="";return t="",this.FCurrent>=-1&&this.FCurrent<this.GetCount()-1&&(t=this.GetItem(this.FCurrent+1).FActionName),t},this.CanUndo=function(){return this.FCurrent>0&&this.GetCount()>0},this.CanRedo=function(){return this.FCurrent<this.GetCount()-1&&this.GetCount()>0},this.Create$2=function(e){return pas.Classes.TCollection.Create$1.call(this,t.TTMSFNCUndoStackItem),this.FObject=e,this.FMaxStackCount=20,this.FCurrent=-1,this}}))}),["SysUtils","WEBLib.TMSFNCPersistence"]),rtl.module("WEBLib.TMSFNCCustomControl",["System","Classes","WEBLib.Controls","WEBLib.TMSFNCGraphics","WEBLib.Graphics","WEBLib.TMSFNCStyles","WEBLib.TMSFNCPersistence","WEBLib.TMSFNCUndo","Types","WEBLib.TMSFNCGraphicsTypes","WEBLib.TMSFNCTypes","TypInfo","WEBLib.Forms","WEBLib.Menus"],(function(){"use strict";var t=this;rtl.createClass(this,"TTMSFNCCustomDesignerForm",pas["WEBLib.Forms"].TForm,(function(){rtl.addIntf(this,pas.System.IUnknown)})),this.TTMSFNCControlAlignment={0:"caNone",caNone:0,1:"caTop",caTop:1,2:"caBottom",caBottom:2,3:"caLeft",caLeft:3,4:"caRight",caRight:4,5:"caClient",caClient:5},this.$rtti.$Enum("TTMSFNCControlAlignment",{minvalue:0,maxvalue:5,ordtype:1,enumtype:this.TTMSFNCControlAlignment}),rtl.createClass(this,"TTMSFNCCustomControlBaseCommon",pas["WEBLib.Menus"].TWebCustomControl,(function(){this.$init=function(){pas["WEBLib.Menus"].TWebCustomControl.$init.call(this),this.FResourceScaleFactor=0,this.FPaintScaleFactor=0,this.FDesigntimeFormPixelsPerInch=0,this.FAllowFocus=!1,this.FAdaptToStyle=!1,this.FAdaptedToStyle=!1,this.FTransparent=!1,this.FBufferedPainting=!1,this.FNativeCanvas=!1,this.FAntiAliasing=!1,this.FOptimizedHTMLDrawing=!1,this.FShowAcceleratorChar=!1,this.FTextQuality=0,this.FOnInternalDblClick=null,this.FOnInternalMouseDown=null,this.FOnInternalMouseMove=null,this.FOnInternalMouseUp=null},this.$final=function(){this.FOnInternalDblClick=void 0,this.FOnInternalMouseDown=void 0,this.FOnInternalMouseMove=void 0,this.FOnInternalMouseUp=void 0,pas["WEBLib.Menus"].TWebCustomControl.$final.call(this)},this.GetAllowFocus=function(){return this.FAllowFocus},this.GetControlAlignment=function(){var t=0;t=0;var e=this.FAlign;return 0===e?t=0:1===e?t=1:2===e?t=2:3===e?t=3:4===e?t=4:5===e&&(t=5),t},this.SetAllowFocus=function(t){this.FAllowFocus=t},this.SetControlAlignment=function(t){var e=t;0===e?this.SetAlign(0):1===e?this.SetAlign(1):2===e?this.SetAlign(2):3===e?this.SetAlign(3):4===e?this.SetAlign(4):5===e&&this.SetAlign(5)},this.SetOptimizedHTMLDrawing=function(t){this.FOptimizedHTMLDrawing!==t&&(this.FOptimizedHTMLDrawing=t,this.Invalidate())},this.SetShowAcceleratorChar=function(t){this.FShowAcceleratorChar!==t&&(this.FShowAcceleratorChar=t,this.Invalidate())},this.GetVersion=function(){return"",""},this.GetDocURL=function(){return pas["WEBLib.TMSFNCTypes"].TTMSFNCBaseDocURL},this.GetTipsURL=function(){return pas["WEBLib.TMSFNCTypes"].TTMSFNCBaseTipsURL},this.ConvertScreenToClient=function(t){var e=pas["WEBLib.TMSFNCTypes"].TPointF.$new(),i=pas.Types.TPoint.$new();return i.$assign(this.ScreenToClient(pas.Types.Point(Math.round(t.X),Math.round(t.Y)))),e.$assign(pas["WEBLib.TMSFNCTypes"].PointF(i.x,i.y)),e},this.ConvertClientToScreen=function(t){var e=pas["WEBLib.TMSFNCTypes"].TPointF.$new(),i=pas.Types.TPoint.$new();return i.$assign(this.ClientToScreen(pas.Types.Point(Math.round(t.X),Math.round(t.Y)))),e.$assign(pas["WEBLib.TMSFNCTypes"].PointF(i.x,i.y)),e},this.GetAdaptToStyle=function(){return this.FAdaptToStyle},this.SetEnabled=function(t){pas["WEBLib.Controls"].TControl.SetEnabled.apply(this,arguments),this.Invalidate()},this.SetDefaultGraphicColors=function(){var t=0;t=-1,pas["WEBLib.TMSFNCStyles"].TTMSFNCStyles.GetStyleBackgroundFillColor({get:function(){return t},set:function(e){t=e}})?pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.DefaultPopupFillColor=t:pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.DefaultPopupFillColor=16777215,t=-1,pas["WEBLib.TMSFNCStyles"].TTMSFNCStyles.GetStyleBackgroundStrokeColor({get:function(){return t},set:function(e){t=e}})?pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.DefaultPopupStrokeColor=t:pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.DefaultPopupStrokeColor=12632256,t=-1,pas["WEBLib.TMSFNCStyles"].TTMSFNCStyles.GetStyleDefaultButtonFillColor({get:function(){return t},set:function(e){t=e}})?pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.DefaultButtonFillColor=t:pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.DefaultButtonFillColor=pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(225,225,225),t=-1,pas["WEBLib.TMSFNCStyles"].TTMSFNCStyles.GetStyleLineFillColor({get:function(){return t},set:function(e){t=e}})?pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.DefaultButtonStrokeColor=t:pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.DefaultButtonStrokeColor=11119017,t=-1,pas["WEBLib.TMSFNCStyles"].TTMSFNCStyles.GetStyleTextFontColor({get:function(){return t},set:function(e){t=e}})?pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.DefaultTextFontColor=t:pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.DefaultTextFontColor=0,t=-1,pas["WEBLib.TMSFNCStyles"].TTMSFNCStyles.GetStyleSelectionFillColor({get:function(){return t},set:function(e){t=e}})?(pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.DefaultSelectionFillColor=t,pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.DefaultButtonFillColorFocused=pas["WEBLib.TMSFNCGraphicsTypes"].Blend(t,pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.DefaultButtonFillColor,25),pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.DefaultButtonStrokeColorFocused=pas["WEBLib.TMSFNCGraphicsTypes"].Blend(t,pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.DefaultButtonStrokeColor,30)):(pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.DefaultSelectionFillColor=0,pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.DefaultButtonFillColorFocused=pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(229,241,251),pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.DefaultButtonStrokeColorFocused=pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(60,127,177)),pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.DefaultButtonStrokeColorDisabled=11119017,pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.DefaultButtonFillColorDisabled=13882323},this.SetAdaptToStyle=function(t){this.FAdaptToStyle=t,this.InitializeStyle()},this.CancelHint=function(){},this.BeginDrag$1=function(){},this.InitializeStyle=function(){this.SetDefaultGraphicColors(),this.DestroyGraphicElements(),this.GetAdaptToStyle()?(this.FAdaptedToStyle=!0,this.ApplyStyle()):this.FAdaptedToStyle&&(this.ResetToDefaultStyle(),this.FAdaptedToStyle=!1),this.Invalidate()},this.ApplyStyle=function(){},this.ResetToDefaultStyle=function(){},this.HandleMouseLeave=function(){},this.HandleMouseEnter=function(){},this.HandleMouseDown=function(t,e,i,s){},this.HandleMouseMove=function(t,e,i){},this.HandleDblClick=function(t,e){},this.HandleMouseUp=function(t,e,i,s){},this.HandleKeyPress=function(t){},this.HandleKeyDown=function(t,e){},this.HandleDialogKey=function(t,e){},this.HandleKeyUp=function(t,e){},this.HandleMouseWheel=function(t,e,i){},this.HandleDragOver=function(t,e,i){},this.HandleDragDrop=function(t,e){},this.Create$1=function(t){var e=0;return pas["WEBLib.Controls"].TControl.Create$1.apply(this,arguments),e=96,this.FDesigntimeFormPixelsPerInch=e,this.FPaintScaleFactor=1,this.FResourceScaleFactor=1,this.SetDefaultGraphicColors(),this.FAdaptToStyle=!1,this.FAdaptedToStyle=!1,this.FTransparent=!1,this.FNativeCanvas=!1,this.FBufferedPainting=!1,this.FAntiAliasing=!0,this.FOptimizedHTMLDrawing=!0,this.FShowAcceleratorChar=!0,this.FTextQuality=1,this.FAllowFocus=!0,this},this.Destroy=function(){pas["WEBLib.Controls"].TCustomControl.Destroy.call(this)},this.SetControlMargins=function(t,e,i,s){this.SetAlignWithMargins(!0),this.FMargins.SetLeft(Math.round(t)),this.FMargins.SetTop(Math.round(e)),this.FMargins.SetRight(Math.round(i)),this.FMargins.SetBottom(Math.round(s))},this.GetControlMargins=function(t,e,i,s){this.FAlignWithMargins&&(t.set(this.FMargins.FLeft),e.set(this.FMargins.FTop),i.set(this.FMargins.FRight),s.set(this.FMargins.FBottom))},this.ScalePaintValue=function(t){return pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.MulDivInt(t,Math.round(100*this.FPaintScaleFactor),100)},this.ScalePaintValue$1=function(t){return t*this.FPaintScaleFactor},rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas["WEBLib.TMSFNCTypes"].ITMSFNCProductInfo),rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TTMSFNCCustomControlBase",this.TTMSFNCCustomControlBaseCommon,(function(){this.$init=function(){t.TTMSFNCCustomControlBaseCommon.$init.call(this),this.FStored=!1,this.FHitTest=!1},this.MouseWheel=function(t,e,i){pas["WEBLib.Controls"].TControl.MouseWheel.apply(this,arguments),this.HandleMouseWheel(rtl.refSet(t),e,i)},this.DoMouseLeave=function(){pas["WEBLib.Controls"].TControl.DoMouseLeave.call(this),this.HandleMouseLeave()},this.DoMouseEnter=function(){pas["WEBLib.Controls"].TControl.DoMouseEnter.call(this),this.HandleMouseEnter()},this.GetLocalRect=function(){var t=pas["WEBLib.TMSFNCTypes"].TRectF.$new();return t.$assign(pas["WEBLib.TMSFNCTypes"].RectF(0,0,this.GetWidth(),this.GetHeight())),t},this.MouseDown=function(t,e,i,s){pas["WEBLib.Controls"].TControl.MouseDown.apply(this,arguments),this.HandleMouseDown(t,rtl.refSet(e),i,s),null!=this.FOnInternalMouseDown&&this.FOnInternalMouseDown(this)},this.MouseMove=function(t,e,i){pas["WEBLib.Controls"].TControl.MouseMove.apply(this,arguments),this.HandleMouseMove(rtl.refSet(t),e,i),null!=this.FOnInternalMouseMove&&this.FOnInternalMouseMove(this)},this.MouseUp=function(t,e,i,s){pas["WEBLib.Controls"].TControl.MouseUp.apply(this,arguments),this.HandleMouseUp(t,rtl.refSet(e),i,s),null!=this.FOnInternalMouseUp&&this.FOnInternalMouseUp(this)},this.DragOver=function(t,e,i,s,o){pas["WEBLib.Controls"].TControl.DragOver.apply(this,arguments),this.HandleDragOver(t,pas["WEBLib.TMSFNCTypes"].PointF(e,i),o)},this.KeyDown=function(t,e){pas["WEBLib.Controls"].TControl.KeyDown.apply(this,arguments),this.HandleDialogKey(t,rtl.refSet(e)),this.HandleKeyDown(t,rtl.refSet(e)),t.get()},this.KeyPress=function(t){pas["WEBLib.Controls"].TControl.KeyPress.apply(this,arguments),this.HandleKeyPress(t)},this.KeyUp=function(t,e){pas["WEBLib.Controls"].TControl.KeyUp.apply(this,arguments),this.HandleKeyUp(t,rtl.refSet(e))},this.DblClick=function(){var t=pas["WEBLib.TMSFNCTypes"].TPointF.$new();pas["WEBLib.Controls"].TControl.DblClick.call(this),t.$assign(this.ConvertScreenToClient(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.GetMousePos()))),this.HandleDblClick(t.X,t.Y),null!=this.FOnInternalDblClick&&this.FOnInternalDblClick(this)},this.Create$1=function(e){return t.TTMSFNCCustomControlBaseCommon.Create$1.apply(this,arguments),this.FHitTest=!0,this.FStored=!0,this.FControlStyle=rtl.unionSet(this.FControlStyle,rtl.createSet(0)),this},this.BeginUpdate=function(){pas["WEBLib.Controls"].TControl.BeginUpdate.call(this)},this.EndUpdate=function(){pas["WEBLib.Controls"].TCustomControl.EndUpdate.call(this)},this.DragDrop=function(t,e,i){pas["WEBLib.Controls"].TControl.DragDrop.apply(this,arguments),this.HandleDragDrop(t,pas["WEBLib.TMSFNCTypes"].PointF(e,i))},this.CanFocus=function(){return pas["WEBLib.Controls"].TControl.CanFocus.call(this)&&this.GetAllowFocus()},rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas["WEBLib.TMSFNCTypes"].ITMSFNCProductInfo),rtl.addIntf(this,pas.System.IUnknown)})),this.$rtti.$MethodVar("TTMSFNCCustomControlBeforeDrawEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["ADefaultDraw",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCCustomControlAfterDrawEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCCustomControlCanSavePropertyEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AObject",pas.System.$rtti.TObject],["APropertyName",rtl.string],["APropertyType",pas.System.$rtti.TTypeKind],["ACanSave",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCCustomControlCanLoadPropertyEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AObject",pas.System.$rtti.TObject],["APropertyName",rtl.string],["APropertyType",pas.System.$rtti.TTypeKind],["ACanLoad",rtl.boolean,1]]),methodkind:0}),rtl.createClass(this,"TTMSFNCCustomControl",this.TTMSFNCCustomControlBase,(function(){this.FBlockPersistenceInterface=!1,this.$init=function(){t.TTMSFNCCustomControlBase.$init.call(this),this.FBlockInvalidate=!1,this.FAppearancePersisting=!1,this.FExporting=!1,this.FExportRect=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),this.FOnBeforeDraw=null,this.FOnAfterDraw=null,this.FOnCanSaveProperty=null,this.FOnCanLoadProperty=null,this.FCheckedChk=null,this.FUnCheckedChk=null,this.FCheckedFocusChk=null,this.FUnCheckedFocusChk=null,this.FCheckedDisabledChk=null,this.FUnCheckedDisabledChk=null,this.FCheckedRd=null,this.FUnCheckedRd=null,this.FCheckedFocusRd=null,this.FUnCheckedFocusRd=null,this.FCheckedDisabledRd=null,this.FUnCheckedDisabledRd=null,this.FDownBtn=null,this.FNormalBtn=null,this.FDownFocusBtn=null,this.FNormalFocusBtn=null,this.FNormalDisabledBtn=null,this.FFill=null,this.FStroke=null,this.FDataPointer=null,this.FDataBoolean=!1,this.FDataString="",this.FDataObject=null,this.FDataInteger=0,this.FUndoManager=null},this.$final=function(){this.FExportRect=void 0,this.FOnBeforeDraw=void 0,this.FOnAfterDraw=void 0,this.FOnCanSaveProperty=void 0,this.FOnCanLoadProperty=void 0,this.FCheckedChk=void 0,this.FUnCheckedChk=void 0,this.FCheckedFocusChk=void 0,this.FUnCheckedFocusChk=void 0,this.FCheckedDisabledChk=void 0,this.FUnCheckedDisabledChk=void 0,this.FCheckedRd=void 0,this.FUnCheckedRd=void 0,this.FCheckedFocusRd=void 0,this.FUnCheckedFocusRd=void 0,this.FCheckedDisabledRd=void 0,this.FUnCheckedDisabledRd=void 0,this.FDownBtn=void 0,this.FNormalBtn=void 0,this.FDownFocusBtn=void 0,this.FNormalFocusBtn=void 0,this.FNormalDisabledBtn=void 0,this.FFill=void 0,this.FStroke=void 0,this.FDataObject=void 0,this.FUndoManager=void 0,t.TTMSFNCCustomControlBase.$final.call(this)},this.GetUndoManager=function(){return null==this.FUndoManager&&(this.FUndoManager=pas["WEBLib.TMSFNCUndo"].TTMSFNCUndoManager.$create("Create$2",[this])),this.FUndoManager},this.SetFill=function(t){this.FFill.Assign(t)},this.SetStroke=function(t){this.FStroke.Assign(t)},this.GetVersionNumber=function(t,e,i,s){return"",""},this.IsAppearanceProperty=function(t,e,i){var s,o=!1,n="",r="";return o=!1,null!=(s=pas.TypInfo.GetPropInfo$2(t,e))&&(n=pas["WEBLib.TMSFNCPersistence"].TTMSFNCPersistence.GetPropInfoName(s),o=(o="TAlphaColor"===(r=pas["WEBLib.TMSFNCPersistence"].TTMSFNCPersistence.GetPropInfoTypeName(s))||"TColor"===r||"TGraphicsColor"===r||"TTMSFNCGraphicsFill"===r||"TTMSFNCGraphicsStroke"===r||pas.System.Pos("Appearance",n)>0)||"Fill"===e||"Stroke"===e||"Font"===e),o},this.CanSaveProperty=function(t,e,i){var s=!1;return s=!(t===this&&!this.FBlockPersistenceInterface)||-1===pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.IndexOfTextInArray(e,pas["WEBLib.TMSFNCPersistence"].ExcludePropertyList),this.FAppearancePersisting&&(s=s&&this.IsAppearanceProperty(t,e,i)),this.DoCanSaveProperty(t,e,i,{get:function(){return s},set:function(t){s=t}}),s},this.CanLoadProperty=function(t,e,i){var s=!1;return s=!(t===this&&!this.FBlockPersistenceInterface)||-1===pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.IndexOfTextInArray(e,pas["WEBLib.TMSFNCPersistence"].ExcludePropertyList),this.DoCanLoadProperty(t,e,i,{get:function(){return s},set:function(t){s=t}}),s},this.GetVersion=function(){return"",""},this.LocalToScreenEx=function(t){var e=pas["WEBLib.TMSFNCTypes"].TPointF.$new(),i=pas.Types.TPoint.$new();return i.$assign(this.ClientToScreen(pas.Types.Point(Math.round(t.X),Math.round(t.Y)))),e.$assign(pas["WEBLib.TMSFNCTypes"].PointF(i.x,i.y)),e},this.ScreenToLocalEx=function(t){var e=pas["WEBLib.TMSFNCTypes"].TPointF.$new(),i=pas.Types.TPoint.$new();return i.$assign(this.ScreenToClient(pas.Types.Point(Math.round(t.X),Math.round(t.Y)))),e.$assign(pas["WEBLib.TMSFNCTypes"].PointF(i.x,i.y)),e},this.GetContentRect=function(){var t=pas["WEBLib.TMSFNCTypes"].TRectF.$new();return t.$assign(this.GetControlRect()),t},this.GetControlRect=function(){var t=pas["WEBLib.TMSFNCTypes"].TRectF.$new();return this.IsExporting()?t.$assign(this.FExportRect):t.$assign(pas["WEBLib.TMSFNCTypes"].RectF(0,0,this.GetWidth(),this.GetHeight())),t},this.GetLocalRect=function(){var e=pas["WEBLib.TMSFNCTypes"].TRectF.$new();return this.IsExporting()?e.$assign(this.FExportRect):e.$assign(t.TTMSFNCCustomControlBase.GetLocalRect.call(this)),e},this.IsExporting=function(){return this.FExporting},this.SetColor=function(t){pas["WEBLib.Controls"].TControl.SetColor.apply(this,arguments),null!=this.FFill&&this.FFill.SetColor(t),this.Invalidate()},this.RegisterRuntimeClasses=function(){},this.ApplyStyle=function(){var e=0;t.TTMSFNCCustomControlBaseCommon.ApplyStyle.call(this),e=-1,pas["WEBLib.TMSFNCStyles"].TTMSFNCStyles.GetStyleBackgroundFillColor({get:function(){return e},set:function(t){e=t}})&&this.FFill.SetColor(e),e=-1,pas["WEBLib.TMSFNCStyles"].TTMSFNCStyles.GetStyleLineFillColor({get:function(){return e},set:function(t){e=t}})&&this.FStroke.SetColor(e)},this.ResetToDefaultStyle=function(){t.TTMSFNCCustomControlBaseCommon.ResetToDefaultStyle.call(this),this.FFill.SetColor(16777215),this.FStroke.SetColor(12632256)},this.DestroyGraphicElements=function(){null!=this.FDownBtn&&(rtl.free(this,"FDownBtn"),this.FDownBtn=null),null!=this.FNormalBtn&&(rtl.free(this,"FNormalBtn"),this.FNormalBtn=null),null!=this.FDownFocusBtn&&(rtl.free(this,"FDownFocusBtn"),this.FDownFocusBtn=null),null!=this.FNormalFocusBtn&&(rtl.free(this,"FNormalFocusBtn"),this.FNormalFocusBtn=null),null!=this.FNormalDisabledBtn&&(rtl.free(this,"FNormalDisabledBtn"),this.FNormalDisabledBtn=null),null!=this.FCheckedChk&&(rtl.free(this,"FCheckedChk"),this.FCheckedChk=null),null!=this.FCheckedFocusChk&&(rtl.free(this,"FCheckedFocusChk"),this.FCheckedFocusChk=null),null!=this.FUnCheckedDisabledChk&&(rtl.free(this,"FUnCheckedDisabledChk"),this.FUnCheckedDisabledChk=null),null!=this.FCheckedDisabledChk&&(rtl.free(this,"FCheckedDisabledChk"),this.FCheckedDisabledChk=null),null!=this.FUnCheckedChk&&(rtl.free(this,"FUnCheckedChk"),this.FUnCheckedChk=null),null!=this.FUnCheckedFocusChk&&(rtl.free(this,"FUnCheckedFocusChk"),this.FUnCheckedFocusChk=null),null!=this.FCheckedRd&&(rtl.free(this,"FCheckedRd"),this.FCheckedRd=null),null!=this.FCheckedFocusRd&&(rtl.free(this,"FCheckedFocusRd"),this.FCheckedFocusRd=null),null!=this.FUnCheckedRd&&(rtl.free(this,"FUnCheckedRd"),this.FUnCheckedRd=null),null!=this.FUnCheckedFocusRd&&(rtl.free(this,"FUnCheckedFocusRd"),this.FUnCheckedFocusRd=null),null!=this.FUnCheckedDisabledRd&&(rtl.free(this,"FUnCheckedDisabledRd"),this.FUnCheckedDisabledRd=null),null!=this.FCheckedDisabledRd&&(rtl.free(this,"FCheckedDisabledRd"),this.FCheckedDisabledRd=null)},this.UpdateControlAfterResize=function(){},this.CreateCheckBoxBitmaps=function(){var t,e=null,i=null;t=this.FResourceScaleFactor,null!=this.FCheckedFocusChk&&(rtl.free(this,"FCheckedFocusChk"),this.FCheckedFocusChk=null),null!=this.FUnCheckedChk&&(rtl.free(this,"FUnCheckedChk"),this.FUnCheckedChk=null),null!=this.FCheckedChk&&(rtl.free(this,"FCheckedChk"),this.FCheckedChk=null),null!=this.FUnCheckedFocusChk&&(rtl.free(this,"FUnCheckedFocusChk"),this.FUnCheckedFocusChk=null),null!=this.FUnCheckedDisabledChk&&(rtl.free(this,"FUnCheckedDisabledChk"),this.FUnCheckedDisabledChk=null),null!=this.FCheckedDisabledChk&&(rtl.free(this,"FCheckedDisabledChk"),this.FCheckedDisabledChk=null),i=pas["WEBLib.Graphics"].TBitmap.$create("Create$3"),e=pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.$create("Create$1",[i.GetCanvas(),!1]);try{i.SetSize(Math.round(16*t),Math.round(16*t)),this.FUnCheckedChk=pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.$create("Create$3"),this.FUnCheckedChk.FOnChange=rtl.createCallback(this,"DoBitmapChanged"),e.FFill.SetKind(1),e.FFill.SetColor(16777215),e.FStroke.SetKind(1),e.FStroke.SetColor(16777215),e.DrawRectangle$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(0,0,i.GetWidth(),i.GetHeight())),2),e.DrawCheckBox(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(0,0,i.GetWidth(),i.GetHeight())),!1,!1,!0,1),this.FUnCheckedChk.Assign(i),this.FCheckedChk=pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.$create("Create$3"),this.FCheckedChk.FOnChange=rtl.createCallback(this,"DoBitmapChanged"),e.FFill.SetKind(1),e.FFill.SetColor(16777215),e.FStroke.SetKind(1),e.FStroke.SetColor(16777215),e.DrawRectangle$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(0,0,i.GetWidth(),i.GetHeight())),2),e.DrawCheckBox(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(0,0,i.GetWidth(),i.GetHeight())),!0,!1,!0,1),this.FCheckedChk.Assign(i),this.FUnCheckedFocusChk=pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.$create("Create$3"),this.FUnCheckedFocusChk.FOnChange=rtl.createCallback(this,"DoBitmapChanged"),e.FFill.SetKind(1),e.FFill.SetColor(16777215),e.FStroke.SetKind(1),e.FStroke.SetColor(16777215),e.DrawRectangle$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(0,0,i.GetWidth(),i.GetHeight())),2),e.DrawCheckBox(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(0,0,i.GetWidth(),i.GetHeight())),!1,!0,!0,1),this.FUnCheckedFocusChk.Assign(i),this.FCheckedFocusChk=pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.$create("Create$3"),this.FCheckedFocusChk.FOnChange=rtl.createCallback(this,"DoBitmapChanged"),e.FFill.SetKind(1),e.FFill.SetColor(16777215),e.FStroke.SetKind(1),e.FStroke.SetColor(16777215),e.DrawRectangle$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(0,0,i.GetWidth(),i.GetHeight())),2),e.DrawCheckBox(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(0,0,i.GetWidth(),i.GetHeight())),!0,!0,!0,1),this.FCheckedFocusChk.Assign(i),this.FUnCheckedDisabledChk=pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.$create("Create$3"),this.FUnCheckedDisabledChk.FOnChange=rtl.createCallback(this,"DoBitmapChanged"),e.FFill.SetKind(1),e.FFill.SetColor(16777215),e.FStroke.SetKind(1),e.FStroke.SetColor(16777215),e.DrawRectangle$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(0,0,i.GetWidth(),i.GetHeight())),2),e.DrawCheckBox(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(0,0,i.GetWidth(),i.GetHeight())),!1,!1,!1,1),this.FUnCheckedDisabledChk.Assign(i),this.FCheckedDisabledChk=pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.$create("Create$3"),this.FCheckedDisabledChk.FOnChange=rtl.createCallback(this,"DoBitmapChanged"),e.FFill.SetKind(1),e.FFill.SetColor(16777215),e.FStroke.SetKind(1),e.FStroke.SetColor(16777215),e.DrawRectangle$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(0,0,i.GetWidth(),i.GetHeight())),2),e.DrawCheckBox(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(0,0,i.GetWidth(),i.GetHeight())),!0,!1,!1,1),this.FCheckedDisabledChk.Assign(i)}finally{e=rtl.freeLoc(e),i=rtl.freeLoc(i)}},this.CreateRadioButtonBitmaps=function(){var t,e=null,i=null;t=this.FResourceScaleFactor,null!=this.FCheckedFocusRd&&(rtl.free(this,"FCheckedFocusRd"),this.FCheckedFocusRd=null),null!=this.FUnCheckedRd&&(rtl.free(this,"FUnCheckedRd"),this.FUnCheckedRd=null),null!=this.FCheckedRd&&(rtl.free(this,"FCheckedRd"),this.FCheckedRd=null),null!=this.FUnCheckedFocusRd&&(rtl.free(this,"FUnCheckedFocusRd"),this.FUnCheckedFocusRd=null),null!=this.FUnCheckedDisabledRd&&(rtl.free(this,"FUnCheckedDisabledRd"),this.FUnCheckedDisabledRd=null),null!=this.FCheckedDisabledRd&&(rtl.free(this,"FCheckedDisabledRd"),this.FCheckedDisabledRd=null),i=pas["WEBLib.Graphics"].TBitmap.$create("Create$3"),e=pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.$create("Create$1",[i.GetCanvas(),!1]);try{i.SetSize(Math.round(16*t),Math.round(16*t)),this.FUnCheckedRd=pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.$create("Create$3"),this.FUnCheckedRd.FOnChange=rtl.createCallback(this,"DoBitmapChanged"),e.FFill.SetKind(1),e.FFill.SetColor(16777215),e.FStroke.SetKind(1),e.FStroke.SetColor(16777215),e.DrawRectangle$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(0,0,i.GetWidth(),i.GetHeight())),2),e.DrawRadioButton(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(0,0,i.GetWidth(),i.GetHeight())),!1,!1,!0,1),this.FUnCheckedRd.Assign(i),this.FCheckedRd=pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.$create("Create$3"),this.FCheckedRd.FOnChange=rtl.createCallback(this,"DoBitmapChanged"),e.FFill.SetKind(1),e.FFill.SetColor(16777215),e.FStroke.SetKind(1),e.FStroke.SetColor(16777215),e.DrawRectangle$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(0,0,i.GetWidth(),i.GetHeight())),2),e.DrawRadioButton(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(0,0,i.GetWidth(),i.GetHeight())),!0,!1,!0,1),this.FCheckedRd.Assign(i),this.FUnCheckedFocusRd=pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.$create("Create$3"),this.FUnCheckedFocusRd.FOnChange=rtl.createCallback(this,"DoBitmapChanged"),e.FFill.SetKind(1),e.FFill.SetColor(16777215),e.FStroke.SetKind(1),e.FStroke.SetColor(16777215),e.DrawRectangle$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(0,0,i.GetWidth(),i.GetHeight())),2),e.DrawRadioButton(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(0,0,i.GetWidth(),i.GetHeight())),!1,!0,!0,1),this.FUnCheckedFocusRd.Assign(i),this.FCheckedFocusRd=pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.$create("Create$3"),this.FCheckedFocusRd.FOnChange=rtl.createCallback(this,"DoBitmapChanged"),e.FFill.SetKind(1),e.FFill.SetColor(16777215),e.FStroke.SetKind(1),e.FStroke.SetColor(16777215),e.DrawRectangle$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(0,0,i.GetWidth(),i.GetHeight())),2),e.DrawRadioButton(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(0,0,i.GetWidth(),i.GetHeight())),!0,!0,!0,1),this.FCheckedFocusRd.Assign(i),this.FUnCheckedDisabledRd=pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.$create("Create$3"),this.FUnCheckedDisabledRd.FOnChange=rtl.createCallback(this,"DoBitmapChanged"),e.FFill.SetKind(1),e.FFill.SetColor(16777215),e.FStroke.SetKind(1),e.FStroke.SetColor(16777215),e.DrawRectangle$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(0,0,i.GetWidth(),i.GetHeight())),2),e.DrawRadioButton(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(0,0,i.GetWidth(),i.GetHeight())),!1,!1,!1,1),this.FUnCheckedDisabledRd.Assign(i),this.FCheckedDisabledRd=pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.$create("Create$3"),this.FCheckedDisabledRd.FOnChange=rtl.createCallback(this,"DoBitmapChanged"),e.FFill.SetKind(1),e.FFill.SetColor(16777215),e.FStroke.SetKind(1),e.FStroke.SetColor(16777215),e.DrawRectangle$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(0,0,i.GetWidth(),i.GetHeight())),2),e.DrawRadioButton(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(0,0,i.GetWidth(),i.GetHeight())),!0,!1,!1,1),this.FCheckedDisabledRd.Assign(i)}finally{e=rtl.freeLoc(e),i=rtl.freeLoc(i)}},this.DoBeforeDraw=function(t,e,i){null!=this.FOnBeforeDraw&&this.FOnBeforeDraw(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i)},this.DoAfterDraw=function(t,e){null!=this.FOnAfterDraw&&this.FOnAfterDraw(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e))},this.DoCanSaveProperty=function(t,e,i,s){null!=this.FOnCanSaveProperty&&this.FOnCanSaveProperty(this,t,e,i,s)},this.DoCanLoadProperty=function(t,e,i,s){null!=this.FOnCanLoadProperty&&this.FOnCanLoadProperty(this,t,e,i,s)},this.DrawBackground=function(t,e){t.FFill.Assign(this.FFill),t.FFill.SetColor(this.FColor),t.FStroke.Assign(this.FStroke),t.DrawRectangle$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),2)},this.StrokeChanged=function(t){this.Invalidate()},this.FillChanged=function(t){0!==this.FFill.FKind&&3!==this.FFill.FKind&&-1!==this.FFill.FColor?this.SetColor(this.FFill.FColor):this.SetColor(-1),this.Invalidate()},this.Draw=function(t,e){},this.DrawControl=function(){var t=null,e=null,i=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),s=!1,o=null;this.FBufferedPainting?(t=pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.$create("CreateBitmapCanvas",[this.GetWidth(),this.GetHeight(),this.FNativeCanvas,!0])).BeginScene():t=pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.$create("Create$1",[this.GetCanvas(),this.FNativeCanvas]),t.FOptimizedHTMLDrawing=this.FOptimizedHTMLDrawing,t.GetContext().SetSize(this.GetWidth(),this.GetHeight()),t.GetContext().SetAntiAliasing(this.FAntiAliasing),t.GetContext().SetShowAcceleratorChar(this.FShowAcceleratorChar),t.GetContext().SetTextQuality(this.FTextQuality);try{if(i.$assign(pas["WEBLib.TMSFNCTypes"].RectF(0,0,this.GetWidth(),this.GetHeight())),s=!0,this.DoBeforeDraw(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),{get:function(){return s},set:function(t){s=t}}),s&&(this.DrawBackground(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i)),this.Draw(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i)),this.DoAfterDraw(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i))),this.FBufferedPainting&&t.EndScene(),t.GetContext().Render(),this.FBufferedPainting){o=pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.$create("Create$3");try{o.Assign(t.FBitmap),e=pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.$create("Create$1",[this.GetCanvas(),!1]);try{e.GetContext().SetSize(this.GetWidth(),this.GetHeight()),e.GetContext().SetAntiAliasing(this.FAntiAliasing),e.GetContext().SetShowAcceleratorChar(this.FShowAcceleratorChar),e.GetContext().SetTextQuality(this.FTextQuality),e.DrawBitmap$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),o,!0,!1,!0,!1)}finally{e=rtl.freeLoc(e)}}finally{o=rtl.freeLoc(o)}}}finally{t=rtl.freeLoc(t)}},this.DoBitmapChanged=function(t){this.FBlockInvalidate||(this.FBlockInvalidate=!0,this.Invalidate(),this.FBlockInvalidate=!1)},this.CaptureEx=function(){this.Capture()},this.ReleaseCaptureEx=function(){this.ReleaseCapture()},this.Assign=function(e){t.TTMSFNCCustomControl.isPrototypeOf(e)?(this.FFill.Assign(rtl.as(e,t.TTMSFNCCustomControl).FFill),this.FStroke.Assign(rtl.as(e,t.TTMSFNCCustomControl).FStroke)):pas["WEBLib.Controls"].TControl.Assign.apply(this,arguments)},this.Create$1=function(e){return t.TTMSFNCCustomControlBase.Create$1.apply(this,arguments),this.SetColor(16777215),this.FLinkTouchEvents=!0,this.FAllowTouch=!1,this.SetTabStop(!0),this.FFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[1,16777215,8421504,-1,-1]),this.FStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,12632256]),this.FFill.FOnChanged=rtl.createCallback(this,"FillChanged"),this.FStroke.FOnChanged=rtl.createCallback(this,"StrokeChanged"),this.IsDesignerForm()||this.RegisterRuntimeClasses(),this},this.Destroy=function(){null!=this.FUndoManager&&(rtl.free(this,"FUndoManager"),this.FUndoManager=null),null!=this.FDownBtn&&(rtl.free(this,"FDownBtn"),this.FDownBtn=null),null!=this.FNormalBtn&&(rtl.free(this,"FNormalBtn"),this.FNormalBtn=null),null!=this.FDownFocusBtn&&(rtl.free(this,"FDownFocusBtn"),this.FDownFocusBtn=null),null!=this.FNormalFocusBtn&&(rtl.free(this,"FNormalFocusBtn"),this.FNormalFocusBtn=null),null!=this.FNormalDisabledBtn&&(rtl.free(this,"FNormalDisabledBtn"),this.FNormalDisabledBtn=null),null!=this.FCheckedChk&&(rtl.free(this,"FCheckedChk"),this.FCheckedChk=null),null!=this.FCheckedFocusChk&&(rtl.free(this,"FCheckedFocusChk"),this.FCheckedFocusChk=null),null!=this.FUnCheckedDisabledChk&&(rtl.free(this,"FUnCheckedDisabledChk"),this.FUnCheckedDisabledChk=null),null!=this.FCheckedDisabledChk&&(rtl.free(this,"FCheckedDisabledChk"),this.FCheckedDisabledChk=null),null!=this.FUnCheckedChk&&(rtl.free(this,"FUnCheckedChk"),this.FUnCheckedChk=null),null!=this.FUnCheckedFocusChk&&(rtl.free(this,"FUnCheckedFocusChk"),this.FUnCheckedFocusChk=null),null!=this.FCheckedRd&&(rtl.free(this,"FCheckedRd"),this.FCheckedRd=null),null!=this.FCheckedFocusRd&&(rtl.free(this,"FCheckedFocusRd"),this.FCheckedFocusRd=null),null!=this.FUnCheckedRd&&(rtl.free(this,"FUnCheckedRd"),this.FUnCheckedRd=null),null!=this.FUnCheckedFocusRd&&(rtl.free(this,"FUnCheckedFocusRd"),this.FUnCheckedFocusRd=null),null!=this.FUnCheckedDisabledRd&&(rtl.free(this,"FUnCheckedDisabledRd"),this.FUnCheckedDisabledRd=null),null!=this.FCheckedDisabledRd&&(rtl.free(this,"FCheckedDisabledRd"),this.FCheckedDisabledRd=null),rtl.free(this,"FFill"),rtl.free(this,"FStroke"),t.TTMSFNCCustomControlBaseCommon.Destroy.call(this)},this.GetCheckBoxBitmap=function(t,e,i){return null!=this.FCheckedChk&&null!=this.FCheckedFocusChk&&null!=this.FUnCheckedChk&&null!=this.FUnCheckedFocusChk&&null!=this.FCheckedDisabledChk&&null!=this.FUnCheckedDisabledChk||this.CreateCheckBoxBitmaps(),t?i?e?this.FCheckedFocusChk:this.FCheckedChk:this.FCheckedDisabledChk:i?e?this.FUnCheckedFocusChk:this.FUnCheckedChk:this.FUnCheckedDisabledChk},this.GetRadioButtonBitmap=function(t,e,i){return null!=this.FCheckedRd&&null!=this.FCheckedFocusRd&&null!=this.FUnCheckedRd&&null!=this.FUnCheckedFocusRd&&null!=this.FCheckedDisabledRd&&null!=this.FUnCheckedDisabledRd||this.CreateRadioButtonBitmaps(),t?i?e?this.FCheckedFocusRd:this.FCheckedRd:this.FCheckedDisabledRd:i?e?this.FUnCheckedFocusRd:this.FUnCheckedRd:this.FUnCheckedDisabledRd},this.IsDesignTime=function(){var t=!1;return t=!1,null!=this.FOwner&&(t=this.IsDesigning()&&!(1 in this.FOwner.FComponentState||0 in this.FOwner.FComponentState)),t},this.IsLoading=function(){var t=!1;return t=!1,null!=this.FOwner&&(t=0 in this.FOwner.FComponentState),t},this.IsReading=function(){var t=!1;return t=!1,null!=this.FOwner&&(t=1 in this.FOwner.FComponentState),t},this.IsDesigning=function(){return 4 in this.FComponentState||null!=pas["WEBLib.Forms"].VSIDE},this.IsDesignerForm=function(){var e,i=!1;return e=pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.GetOwnerForm(this),i=this.IsDesigning(),null!=e&&(i=i||t.TTMSFNCCustomDesignerForm.isPrototypeOf(e)),i},this.IsDestroying=function(){return 3 in this.FComponentState},this.SaveSettingsToStream=function(t,e){this.FAppearancePersisting=e,pas["WEBLib.TMSFNCPersistence"].TTMSFNCPersistence.SaveSettingsToStream(this,t),this.FAppearancePersisting=!1},this.DisableBackground=function(){this.FFill.SetKind(0),this.FStroke.SetKind(0),this.SetColor(-1)},this.DisableFill=function(){this.FFill.SetKind(0)},this.Resize=function(){pas["WEBLib.Controls"].TCustomControl.Resize.call(this),this.UpdateControlAfterResize()},this.Paint=function(){pas["WEBLib.Controls"].TCustomControl.Paint.call(this),this.DrawControl()},rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas["WEBLib.TMSFNCTypes"].ITMSFNCProductInfo),rtl.addIntf(this,pas.System.IUnknown);var e=this.$rtti;e.addProperty("AdaptToStyle",3,rtl.boolean,"GetAdaptToStyle","SetAdaptToStyle",{Default:!1}),e.addProperty("AllowFocus",3,rtl.boolean,"GetAllowFocus","SetAllowFocus",{Default:!0}),e.addProperty("Align",2,pas["WEBLib.Controls"].$rtti.TAlign,"FAlign","SetAlign",{Default:pas["WEBLib.Controls"].TAlign.alNone}),e.addProperty("AlignWithMargins",2,rtl.boolean,"FAlignWithMargins","SetAlignWithMargins",{Default:!1}),e.addProperty("DoubleBuffered",0,rtl.boolean,"FDoubleBuffered","FDoubleBuffered",{Default:!1}),e.addProperty("Color",2,pas["WEBLib.Graphics"].$rtti.TColor,"FColor","SetColor"),e.addProperty("Margins",2,pas["WEBLib.Controls"].$rtti.TMargins,"FMargins","SetMargins"),e.addProperty("Enabled",2,rtl.boolean,"FEnabled","SetEnabled",{Default:!0}),e.addProperty("Font",2,pas["WEBLib.Graphics"].$rtti.TFont,"FFont","SetFont"),e.addProperty("ParentDoubleBuffered",0,rtl.boolean,"FParentDoubleBuffered","FParentDoubleBuffered",{Default:!0}),e.addProperty("TabStop",2,rtl.boolean,"FTabStop","SetTabStop",{Default:!0}),e.addProperty("ShowHint",2,rtl.boolean,"FShowHint","SetShowHint",{Default:!1}),e.addProperty("Hint",2,rtl.string,"FHint","SetHint"),e.addProperty("TabOrder",2,rtl.longint,"FTabOrder","SetTabOrder"),e.addProperty("Visible",2,rtl.boolean,"FVisible","SetVisible",{Default:!0}),e.addProperty("OnClick",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnClick","FOnClick"),e.addProperty("OnDblClick",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnDblClick","FOnDblClick"),e.addProperty("OnEnter",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnEnter","FOnEnter"),e.addProperty("OnExit",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnExit","FOnExit"),e.addProperty("OnKeyDown",0,pas["WEBLib.Controls"].$rtti.TKeyEvent,"FOnKeyDown","FOnKeyDown"),e.addProperty("OnKeyPress",0,pas["WEBLib.Controls"].$rtti.TKeyPressEvent,"FOnKeyPress","FOnKeyPress"),e.addProperty("OnKeyUp",0,pas["WEBLib.Controls"].$rtti.TKeyEvent,"FOnKeyUp","FOnKeyUp"),e.addProperty("OnMouseDown",0,pas["WEBLib.Controls"].$rtti.TMouseEvent,"FOnMouseDown","FOnMouseDown"),e.addProperty("OnMouseEnter",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnMouseEnter","FOnMouseEnter"),e.addProperty("OnMouseLeave",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnMouseLeave","FOnMouseLeave"),e.addProperty("OnMouseMove",0,pas["WEBLib.Controls"].$rtti.TMouseMoveEvent,"FOnMouseMove","FOnMouseMove"),e.addProperty("OnMouseUp",0,pas["WEBLib.Controls"].$rtti.TMouseEvent,"FOnMouseUp","FOnMouseUp"),e.addProperty("OnMouseWheel",0,pas["WEBLib.Controls"].$rtti.TMouseWheelEvent,"FOnMouseWheel","FOnMouseWheel"),e.addProperty("OnMouseWheelUp",0,pas["WEBLib.Controls"].$rtti.TMouseWheelUpDownEvent,"FOnMouseWheelUp","FOnMouseWheelUp"),e.addProperty("OnMouseWheelDown",0,pas["WEBLib.Controls"].$rtti.TMouseWheelUpDownEvent,"FOnMouseWheelDown","FOnMouseWheelDown"),e.addProperty("OnDragOver",0,pas["WEBLib.Controls"].$rtti.TDragOverEvent,"FOnDragOver","FOnDragOver"),e.addProperty("OnDragDrop",0,pas["WEBLib.Controls"].$rtti.TDragDropEvent,"FOnDragDrop","FOnDragDrop"),e.addProperty("PopupMenu",0,pas["WEBLib.Menus"].$rtti.TPopupMenu,"FPopupMenu","FPopupMenu"),e.addProperty("ShowAcceleratorChar",2,rtl.boolean,"FShowAcceleratorChar","SetShowAcceleratorChar",{Default:!0}),e.addProperty("OnBeforeDraw",0,t.$rtti.TTMSFNCCustomControlBeforeDrawEvent,"FOnBeforeDraw","FOnBeforeDraw"),e.addProperty("OnAfterDraw",0,t.$rtti.TTMSFNCCustomControlAfterDrawEvent,"FOnAfterDraw","FOnAfterDraw"),e.addProperty("OnCanSaveProperty",0,t.$rtti.TTMSFNCCustomControlCanSavePropertyEvent,"FOnCanSaveProperty","FOnCanSaveProperty"),e.addProperty("OnCanLoadProperty",0,t.$rtti.TTMSFNCCustomControlCanLoadPropertyEvent,"FOnCanLoadProperty","FOnCanLoadProperty")}))}),["WEBLib.TMSFNCUtils","SysUtils","WEBLib.StdCtrls"]),rtl.module("WEBLib.TMSFNCScrollBar",["System","Classes","WEBLib.TMSFNCCustomControl","WEBLib.ExtCtrls","WEBLib.TMSFNCTypes","WEBLib.TMSFNCGraphics","WEBLib.Controls","WEBLib.TMSFNCGraphicsTypes"],(function(){"use strict";var t=this;rtl.createClass(this,"TTMSFNCScrollBarAppearance",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FOwner=null,this.FScrollButtonSize=0,this.FThumbButtonSize=0,this.FOnChange=null,this.FFixedThumb=!1,this.FArrowColor=0,this.FThumbStroke=null,this.FThumbButtonRightDownStroke=null,this.FThumbFill=null,this.FThumbButtonLeftFill=null,this.FScrollButtonLeftHoverFill=null,this.FScrollButtonLeftStroke=null,this.FScrollButtonRightFill=null,this.FThumbButtonLeftHoverFill=null,this.FThumbButtonLeftStroke=null,this.FScrollButtonLeftHoverStroke=null,this.FThumbButtonRightFill=null,this.FScrollButtonRightHoverFill=null,this.FScrollButtonRightStroke=null,this.FThumbButtonLeftHoverStroke=null,this.FScrollButtonLeftDownFill=null,this.FThumbButtonRightHoverFill=null,this.FThumbButtonRightStroke=null,this.FScrollButtonRightHoverStroke=null,this.FThumbButtonLeftDownFill=null,this.FScrollButtonLeftDownStroke=null,this.FThumbButtonRightHoverStroke=null,this.FScrollButtonRightDownFill=null,this.FThumbButtonLeftDownStroke=null,this.FThumbButtonRightDownFill=null,this.FScrollButtonRightDownStroke=null,this.FScrollButtonLeftFill=null},this.$final=function(){this.FOwner=void 0,this.FOnChange=void 0,this.FThumbStroke=void 0,this.FThumbButtonRightDownStroke=void 0,this.FThumbFill=void 0,this.FThumbButtonLeftFill=void 0,this.FScrollButtonLeftHoverFill=void 0,this.FScrollButtonLeftStroke=void 0,this.FScrollButtonRightFill=void 0,this.FThumbButtonLeftHoverFill=void 0,this.FThumbButtonLeftStroke=void 0,this.FScrollButtonLeftHoverStroke=void 0,this.FThumbButtonRightFill=void 0,this.FScrollButtonRightHoverFill=void 0,this.FScrollButtonRightStroke=void 0,this.FThumbButtonLeftHoverStroke=void 0,this.FScrollButtonLeftDownFill=void 0,this.FThumbButtonRightHoverFill=void 0,this.FThumbButtonRightStroke=void 0,this.FScrollButtonRightHoverStroke=void 0,this.FThumbButtonLeftDownFill=void 0,this.FScrollButtonLeftDownStroke=void 0,this.FThumbButtonRightHoverStroke=void 0,this.FScrollButtonRightDownFill=void 0,this.FThumbButtonLeftDownStroke=void 0,this.FThumbButtonRightDownFill=void 0,this.FScrollButtonRightDownStroke=void 0,this.FScrollButtonLeftFill=void 0,pas.Classes.TPersistent.$final.call(this)},this.SetThumbButtonSize=function(t){this.FThumbButtonSize!==t&&(this.FThumbButtonSize=t,this.Changed())},this.SetFixedThumb=function(t){this.FFixedThumb!==t&&(this.FFixedThumb=t,this.Changed())},this.SetArrowColor=function(t){this.FArrowColor!==t&&(this.FArrowColor=t,this.Changed())},this.SetScrollButtonLeftDownFill=function(t){this.FScrollButtonLeftDownFill.Assign(t)},this.SetScrollButtonLeftDownStroke=function(t){this.FScrollButtonLeftDownStroke.Assign(t)},this.SetScrollButtonLeftFill=function(t){this.FScrollButtonLeftFill.Assign(t)},this.SetScrollButtonLeftHoverFill=function(t){this.FScrollButtonLeftHoverFill.Assign(t)},this.SetScrollButtonLeftHoverStroke=function(t){this.FScrollButtonLeftHoverStroke.Assign(t)},this.SetScrollButtonLeftStroke=function(t){this.FScrollButtonLeftStroke.Assign(t)},this.SetScrollButtonRightDownFill=function(t){this.FScrollButtonRightDownFill.Assign(t)},this.SetScrollButtonRightDownStroke=function(t){this.FScrollButtonRightDownStroke.Assign(t)},this.SetScrollButtonRightFill=function(t){this.FScrollButtonRightFill.Assign(t)},this.SetScrollButtonRightHoverFill=function(t){this.FScrollButtonRightHoverFill.Assign(t)},this.SetScrollButtonRightHoverStroke=function(t){this.FScrollButtonRightHoverStroke.Assign(t)},this.SetScrollButtonRightStroke=function(t){this.FScrollButtonRightStroke.Assign(t)},this.SetScrollButtonSize=function(t){this.FScrollButtonSize!==t&&(this.FScrollButtonSize=t,this.Changed())},this.SetThumbButtonLeftDownFill=function(t){this.FThumbButtonLeftDownFill.Assign(t)},this.SetThumbButtonLeftDownStroke=function(t){this.FThumbButtonLeftDownStroke.Assign(t)},this.SetThumbButtonLeftFill=function(t){this.FThumbButtonLeftFill.Assign(t)},this.SetThumbButtonLeftHoverFill=function(t){this.FThumbButtonLeftHoverFill.Assign(t)},this.SetThumbButtonLeftHoverStroke=function(t){this.FThumbButtonLeftHoverStroke.Assign(t)},this.SetThumbButtonLeftStroke=function(t){this.FThumbButtonLeftStroke.Assign(t)},this.SetThumbButtonRightDownFill=function(t){this.FThumbButtonRightDownFill.Assign(t)},this.SetThumbButtonRightDownStroke=function(t){this.FThumbButtonRightDownStroke.Assign(t)},this.SetThumbButtonRightFill=function(t){this.FThumbButtonRightFill.Assign(t)},this.SetThumbButtonRightHoverFill=function(t){this.FThumbButtonRightHoverFill.Assign(t)},this.SetThumbButtonRightHoverStroke=function(t){this.FThumbButtonRightHoverStroke.Assign(t)},this.SetThumbButtonRightStroke=function(t){this.FThumbButtonRightStroke.Assign(t)},this.SetThumbFill=function(t){this.FThumbFill.Assign(t)},this.SetThumbStroke=function(t){this.FThumbStroke.Assign(t)},this.IsScrollButtonSizeStored=function(){return 18!==this.FScrollButtonSize},this.IsThumbButtonSizeStored=function(){return 18!==this.FThumbButtonSize},this.Changed=function(){this.FOwner.Changed()},this.FillChanged=function(t){this.Changed()},this.StrokeChanged=function(t){this.Changed()},this.Create$1=function(t){return this.FOwner=t,this.FThumbFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[1,pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(225,225,225),8421504,-1,-1]),this.FThumbFill.FOnChanged=rtl.createCallback(this,"FillChanged"),this.FThumbButtonLeftFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[1,pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(225,225,225),8421504,-1,-1]),this.FThumbButtonLeftFill.FOnChanged=rtl.createCallback(this,"FillChanged"),this.FThumbButtonRightFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[1,pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(225,225,225),8421504,-1,-1]),this.FThumbButtonRightFill.FOnChanged=rtl.createCallback(this,"FillChanged"),this.FThumbButtonLeftHoverFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[1,pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(229,241,251),8421504,-1,-1]),this.FThumbButtonLeftHoverFill.FOnChanged=rtl.createCallback(this,"FillChanged"),this.FThumbButtonRightHoverFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[1,pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(229,241,251),8421504,-1,-1]),this.FThumbButtonRightHoverFill.FOnChanged=rtl.createCallback(this,"FillChanged"),this.FThumbButtonLeftDownFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[1,pas["WEBLib.TMSFNCGraphicsTypes"].Darker(pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(229,241,251),40),8421504,-1,-1]),this.FThumbButtonLeftDownFill.FOnChanged=rtl.createCallback(this,"FillChanged"),this.FThumbButtonRightDownFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[1,pas["WEBLib.TMSFNCGraphicsTypes"].Darker(pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(229,241,251),40),8421504,-1,-1]),this.FThumbButtonRightDownFill.FOnChanged=rtl.createCallback(this,"FillChanged"),this.FScrollButtonLeftFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[1,pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(225,225,225),8421504,-1,-1]),this.FScrollButtonLeftFill.FOnChanged=rtl.createCallback(this,"FillChanged"),this.FScrollButtonRightFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[1,pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(225,225,225),8421504,-1,-1]),this.FScrollButtonRightFill.FOnChanged=rtl.createCallback(this,"FillChanged"),this.FScrollButtonLeftHoverFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[1,pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(229,241,251),8421504,-1,-1]),this.FScrollButtonLeftHoverFill.FOnChanged=rtl.createCallback(this,"FillChanged"),this.FScrollButtonRightHoverFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[1,pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(229,241,251),8421504,-1,-1]),this.FScrollButtonRightHoverFill.FOnChanged=rtl.createCallback(this,"FillChanged"),this.FScrollButtonLeftDownFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[1,pas["WEBLib.TMSFNCGraphicsTypes"].Darker(pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(229,241,251),40),8421504,-1,-1]),this.FScrollButtonLeftDownFill.FOnChanged=rtl.createCallback(this,"FillChanged"),this.FScrollButtonRightDownFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[1,pas["WEBLib.TMSFNCGraphicsTypes"].Darker(pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(229,241,251),40),8421504,-1,-1]),this.FScrollButtonRightDownFill.FOnChanged=rtl.createCallback(this,"FillChanged"),this.FThumbStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,pas["WEBLib.TMSFNCGraphicsTypes"].Darker(11119017,40)]),this.FThumbStroke.FOnChanged=rtl.createCallback(this,"StrokeChanged"),this.FThumbButtonLeftStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,pas["WEBLib.TMSFNCGraphicsTypes"].Darker(11119017,40)]),this.FThumbButtonLeftStroke.FOnChanged=rtl.createCallback(this,"StrokeChanged"),this.FThumbButtonRightStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,pas["WEBLib.TMSFNCGraphicsTypes"].Darker(11119017,40)]),this.FThumbButtonRightStroke.FOnChanged=rtl.createCallback(this,"StrokeChanged"),this.FThumbButtonLeftHoverStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(60,127,177)]),this.FThumbButtonLeftHoverStroke.FOnChanged=rtl.createCallback(this,"StrokeChanged"),this.FThumbButtonRightHoverStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(60,127,177)]),this.FThumbButtonRightHoverStroke.FOnChanged=rtl.createCallback(this,"StrokeChanged"),this.FThumbButtonLeftDownStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(60,127,177)]),this.FThumbButtonLeftDownStroke.FOnChanged=rtl.createCallback(this,"StrokeChanged"),this.FThumbButtonRightDownStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(60,127,177)]),this.FThumbButtonRightDownStroke.FOnChanged=rtl.createCallback(this,"StrokeChanged"),this.FScrollButtonLeftStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,pas["WEBLib.TMSFNCGraphicsTypes"].Darker(11119017,40)]),this.FScrollButtonLeftStroke.FOnChanged=rtl.createCallback(this,"StrokeChanged"),this.FScrollButtonRightStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,pas["WEBLib.TMSFNCGraphicsTypes"].Darker(11119017,40)]),this.FScrollButtonRightStroke.FOnChanged=rtl.createCallback(this,"StrokeChanged"),this.FScrollButtonLeftHoverStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(60,127,177)]),this.FScrollButtonLeftHoverStroke.FOnChanged=rtl.createCallback(this,"StrokeChanged"),this.FScrollButtonRightHoverStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(60,127,177)]),this.FScrollButtonRightHoverStroke.FOnChanged=rtl.createCallback(this,"StrokeChanged"),this.FScrollButtonLeftDownStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(60,127,177)]),this.FScrollButtonLeftDownStroke.FOnChanged=rtl.createCallback(this,"StrokeChanged"),this.FScrollButtonRightDownStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(60,127,177)]),this.FScrollButtonRightDownStroke.FOnChanged=rtl.createCallback(this,"StrokeChanged"),this.FArrowColor=0,this.FFixedThumb=!1,this.FThumbButtonSize=18,this.FScrollButtonSize=18,this},this.Destroy=function(){rtl.free(this,"FThumbFill"),rtl.free(this,"FScrollButtonLeftFill"),rtl.free(this,"FScrollButtonRightFill"),rtl.free(this,"FScrollButtonLeftHoverFill"),rtl.free(this,"FScrollButtonRightHoverFill"),rtl.free(this,"FScrollButtonLeftDownFill"),rtl.free(this,"FScrollButtonRightDownFill"),rtl.free(this,"FThumbButtonLeftFill"),rtl.free(this,"FThumbButtonRightFill"),rtl.free(this,"FThumbButtonLeftHoverFill"),rtl.free(this,"FThumbButtonRightHoverFill"),rtl.free(this,"FThumbButtonLeftDownFill"),rtl.free(this,"FThumbButtonRightDownFill"),rtl.free(this,"FThumbStroke"),rtl.free(this,"FScrollButtonLeftStroke"),rtl.free(this,"FScrollButtonRightStroke"),rtl.free(this,"FScrollButtonLeftHoverStroke"),rtl.free(this,"FScrollButtonRightHoverStroke"),rtl.free(this,"FScrollButtonLeftDownStroke"),rtl.free(this,"FScrollButtonRightDownStroke"),rtl.free(this,"FThumbButtonLeftStroke"),rtl.free(this,"FThumbButtonRightStroke"),rtl.free(this,"FThumbButtonLeftHoverStroke"),rtl.free(this,"FThumbButtonRightHoverStroke"),rtl.free(this,"FThumbButtonLeftDownStroke"),rtl.free(this,"FThumbButtonRightDownStroke"),pas.System.TObject.Destroy.call(this)},this.Assign=function(e){t.TTMSFNCScrollBarAppearance.isPrototypeOf(e)&&(this.FThumbFill.Assign(rtl.as(e,t.TTMSFNCScrollBarAppearance).FThumbFill),this.FScrollButtonSize=rtl.as(e,t.TTMSFNCScrollBarAppearance).FScrollButtonSize,this.FThumbButtonSize=rtl.as(e,t.TTMSFNCScrollBarAppearance).FThumbButtonSize,this.FThumbButtonLeftFill.Assign(rtl.as(e,t.TTMSFNCScrollBarAppearance).FThumbButtonLeftFill),this.FThumbButtonLeftHoverFill.Assign(rtl.as(e,t.TTMSFNCScrollBarAppearance).FThumbButtonLeftHoverFill),this.FThumbButtonLeftDownFill.Assign(rtl.as(e,t.TTMSFNCScrollBarAppearance).FThumbButtonLeftDownFill),this.FThumbButtonRightFill.Assign(rtl.as(e,t.TTMSFNCScrollBarAppearance).FThumbButtonRightFill),this.FThumbButtonRightDownFill.Assign(rtl.as(e,t.TTMSFNCScrollBarAppearance).FThumbButtonRightDownFill),this.FThumbButtonRightHoverFill.Assign(rtl.as(e,t.TTMSFNCScrollBarAppearance).FThumbButtonRightHoverFill),this.FScrollButtonLeftFill.Assign(rtl.as(e,t.TTMSFNCScrollBarAppearance).FScrollButtonLeftFill),this.FScrollButtonLeftHoverFill.Assign(rtl.as(e,t.TTMSFNCScrollBarAppearance).FScrollButtonLeftHoverFill),this.FScrollButtonLeftDownFill.Assign(rtl.as(e,t.TTMSFNCScrollBarAppearance).FScrollButtonLeftDownFill),this.FScrollButtonRightFill.Assign(rtl.as(e,t.TTMSFNCScrollBarAppearance).FScrollButtonRightFill),this.FScrollButtonRightDownFill.Assign(rtl.as(e,t.TTMSFNCScrollBarAppearance).FScrollButtonRightDownFill),this.FScrollButtonRightHoverFill.Assign(rtl.as(e,t.TTMSFNCScrollBarAppearance).FScrollButtonRightHoverFill),this.FThumbButtonLeftStroke.Assign(rtl.as(e,t.TTMSFNCScrollBarAppearance).FThumbButtonLeftStroke),this.FThumbButtonLeftHoverStroke.Assign(rtl.as(e,t.TTMSFNCScrollBarAppearance).FThumbButtonLeftHoverStroke),this.FThumbButtonLeftDownStroke.Assign(rtl.as(e,t.TTMSFNCScrollBarAppearance).FThumbButtonLeftDownStroke),this.FThumbButtonRightStroke.Assign(rtl.as(e,t.TTMSFNCScrollBarAppearance).FThumbButtonRightStroke),this.FThumbButtonRightDownStroke.Assign(rtl.as(e,t.TTMSFNCScrollBarAppearance).FThumbButtonRightDownStroke),this.FThumbButtonRightHoverStroke.Assign(rtl.as(e,t.TTMSFNCScrollBarAppearance).FThumbButtonRightHoverStroke),this.FScrollButtonLeftStroke.Assign(rtl.as(e,t.TTMSFNCScrollBarAppearance).FScrollButtonLeftStroke),this.FScrollButtonLeftHoverStroke.Assign(rtl.as(e,t.TTMSFNCScrollBarAppearance).FScrollButtonLeftHoverStroke),this.FScrollButtonLeftDownStroke.Assign(rtl.as(e,t.TTMSFNCScrollBarAppearance).FScrollButtonLeftDownStroke),this.FScrollButtonRightStroke.Assign(rtl.as(e,t.TTMSFNCScrollBarAppearance).FScrollButtonRightStroke),this.FScrollButtonRightDownStroke.Assign(rtl.as(e,t.TTMSFNCScrollBarAppearance).FScrollButtonRightDownStroke),this.FScrollButtonRightHoverStroke.Assign(rtl.as(e,t.TTMSFNCScrollBarAppearance).FScrollButtonRightHoverStroke),this.Changed())},this.GetThumbButtonSize=function(){return this.FFixedThumb?0:this.FThumbButtonSize};var e=this.$rtti;e.addProperty("ThumbFill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FThumbFill","SetThumbFill"),e.addProperty("ScrollButtonLeftFill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FScrollButtonLeftFill","SetScrollButtonLeftFill"),e.addProperty("ScrollButtonRightFill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FScrollButtonRightFill","SetScrollButtonRightFill"),e.addProperty("ScrollButtonLeftHoverFill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FScrollButtonLeftHoverFill","SetScrollButtonLeftHoverFill"),e.addProperty("ScrollButtonRightHoverFill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FScrollButtonRightHoverFill","SetScrollButtonRightHoverFill"),e.addProperty("ScrollButtonLeftDownFill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FScrollButtonLeftDownFill","SetScrollButtonLeftDownFill"),e.addProperty("ScrollButtonRightDownFill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FScrollButtonRightDownFill","SetScrollButtonRightDownFill"),e.addProperty("ThumbButtonLeftFill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FThumbButtonLeftFill","SetThumbButtonLeftFill"),e.addProperty("ThumbButtonRightFill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FThumbButtonRightFill","SetThumbButtonRightFill"),e.addProperty("ThumbButtonLeftHoverFill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FThumbButtonLeftHoverFill","SetThumbButtonLeftHoverFill"),e.addProperty("ThumbButtonRightHoverFill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FThumbButtonRightHoverFill","SetThumbButtonRightHoverFill"),e.addProperty("ThumbButtonLeftDownFill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FThumbButtonLeftDownFill","SetThumbButtonLeftDownFill"),e.addProperty("ThumbButtonRightDownFill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FThumbButtonRightDownFill","SetThumbButtonRightDownFill"),e.addProperty("ThumbStroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FThumbStroke","SetThumbStroke"),e.addProperty("ScrollButtonLeftStroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FScrollButtonLeftStroke","SetScrollButtonLeftStroke"),e.addProperty("ScrollButtonRightStroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FScrollButtonRightStroke","SetScrollButtonRightStroke"),e.addProperty("ScrollButtonLeftHoverStroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FScrollButtonLeftHoverStroke","SetScrollButtonLeftHoverStroke"),e.addProperty("ScrollButtonRightHoverStroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FScrollButtonRightHoverStroke","SetScrollButtonRightHoverStroke"),e.addProperty("ScrollButtonLeftDownStroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FScrollButtonLeftDownStroke","SetScrollButtonLeftDownStroke"),e.addProperty("ScrollButtonRightDownStroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FScrollButtonRightDownStroke","SetScrollButtonRightDownStroke"),e.addProperty("ThumbButtonLeftStroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FThumbButtonLeftStroke","SetThumbButtonLeftStroke"),e.addProperty("ThumbButtonRightStroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FThumbButtonRightStroke","SetThumbButtonRightStroke"),e.addProperty("ThumbButtonLeftHoverStroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FThumbButtonLeftHoverStroke","SetThumbButtonLeftHoverStroke"),e.addProperty("ThumbButtonRightHoverStroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FThumbButtonRightHoverStroke","SetThumbButtonRightHoverStroke"),e.addProperty("ThumbButtonLeftDownStroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FThumbButtonLeftDownStroke","SetThumbButtonLeftDownStroke"),e.addProperty("ThumbButtonRightDownStroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FThumbButtonRightDownStroke","SetThumbButtonRightDownStroke"),e.addProperty("ThumbButtonSize",14,rtl.double,"FThumbButtonSize","SetThumbButtonSize",{stored:"IsThumbButtonSizeStored"}),e.addProperty("ScrollButtonSize",14,rtl.double,"FScrollButtonSize","SetScrollButtonSize",{stored:"IsScrollButtonSizeStored"}),e.addProperty("FixedThumb",2,rtl.boolean,"FFixedThumb","SetFixedThumb",{Default:!1}),e.addProperty("ArrowColor",2,pas["WEBLib.Graphics"].$rtti.TColor,"FArrowColor","SetArrowColor",{Default:0}),e.addProperty("OnChange",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnChange","FOnChange")})),this.TTMSFNCScrollBarMode={0:"sbmNone",sbmNone:0,1:"sbmScroll",sbmScroll:1,2:"sbmChangePageSize",sbmChangePageSize:2},this.TTMSFNCScrollBarHoveredButton={0:"shbNone",shbNone:0,1:"shbScrollMin",shbScrollMin:1,2:"shbScrollMax",shbScrollMax:2,3:"shbThumbMin",shbThumbMin:3,4:"shbThumbMax",shbThumbMax:4},this.TTMSFNCScrollBarDownButton={0:"sdbNone",sdbNone:0,1:"sdbScrollMin",sdbScrollMin:1,2:"sdbScrollMax",sdbScrollMax:2,3:"sdbThumbMin",sdbThumbMin:3,4:"sdbThumbMax",sdbThumbMax:4},this.TTMSFNCScrollButtonChange={0:"sbcNone",sbcNone:0,1:"sbcSmallSubstract",sbcSmallSubstract:1,2:"sbcSmallAdd",sbcSmallAdd:2,3:"sbcLargeSubstract",sbcLargeSubstract:3,4:"sbcLargeAdd",sbcLargeAdd:4},this.$rtti.$MethodVar("TTMSFNCScrollBarValueChanged",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["Value",rtl.double]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCScrollBarPageSizeChanged",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["PageSize",rtl.double]]),methodkind:0}),this.TTMSFNCScrollBarKind={0:"sbkHorizontal",sbkHorizontal:0,1:"sbkVertical",sbkVertical:1},this.$rtti.$Enum("TTMSFNCScrollBarKind",{minvalue:0,maxvalue:1,ordtype:1,enumtype:this.TTMSFNCScrollBarKind}),rtl.createClass(this,"TTMSFNCCustomScrollBar",pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl,(function(){this.$init=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.$init.call(this),this.FNeedsChange=!1,this.FSavedPageSize=0,this.FDesignTime=!1,this.FMinThumb=!1,this.FMaxThumb=!1,this.FMx=0,this.FMy=0,this.FCx=0,this.FCy=0,this.FTimer=null,this.FTime=0,this.FScrollBarMode=0,this.FScrollButtonChange=0,this.FHoveredButton=0,this.FDownButton=0,this.FKind=0,this.FValue=0,this.FTempValue=0,this.FMin=0,this.FMax=0,this.FPageSize=0,this.FSmallChange=0,this.FLargeChange=0,this.FAppearance=null,this.FOnValueChange=null,this.FOnPageSizeChanged=null,this.FTracking=!1},this.$final=function(){this.FTimer=void 0,this.FAppearance=void 0,this.FOnValueChange=void 0,this.FOnPageSizeChanged=void 0,pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.$final.call(this)},this.SetAppearance=function(t){this.FAppearance!==t&&(this.FAppearance.Assign(t),this.Changed())},this.SetKind=function(t){this.FKind!==t&&(this.FKind=t,0 in this.FComponentState?this.FNeedsChange=!0:this.SetBounds(this.GetLeft(),this.GetTop(),this.GetHeight(),this.GetWidth()),this.Changed())},this.SetMax=function(t){this.FMax!==t&&(this.FMax=t,this.Changed())},this.SetMin=function(t){this.FMin!==t&&(this.FMin=t,this.Changed())},this.SetValue=function(t){this.FValue!==t&&(this.FValue=Math.max(this.FMin,Math.min(this.FMax,t)),this.FTempValue=this.FValue,null!=this.FOnValueChange&&this.FOnValueChange(this,t),this.Changed())},this.SetPageSize=function(t){this.FPageSize!==t&&(this.FPageSize=Math.min(this.GetRange(),Math.max(0,t)),null!=this.FOnPageSizeChanged&&this.FOnPageSizeChanged(this,this.FPageSize),this.Changed())},this.IsLargeChangeStored=function(){return 20!==this.FLargeChange},this.IsMaxStored=function(){return 100!==this.FMax},this.IsMinStored=function(){return 0!==this.FMin},this.IsPageSizeStored=function(){return 20!==this.FPageSize},this.IsSmallChangeStored=function(){return 1!==this.FSmallChange},this.IsValueStored=function(){return 0!==this.FValue},this.SetTracking=function(t){this.FTracking!==t&&(this.FTracking=t,this.Changed())},this.ApplyStyle=function(){var t=0;pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.ApplyStyle.call(this),t=-1,pas["WEBLib.TMSFNCStyles"].TTMSFNCStyles.GetStyleBackgroundFillColor({get:function(){return t},set:function(e){t=e}})&&(this.FAppearance.FThumbFill.SetColor(t),this.FAppearance.FThumbButtonLeftFill.SetColor(t),this.FAppearance.FThumbButtonRightFill.SetColor(t),this.FAppearance.FScrollButtonLeftFill.SetColor(t),this.FAppearance.FScrollButtonRightFill.SetColor(t)),t=-1,pas["WEBLib.TMSFNCStyles"].TTMSFNCStyles.GetStyleLineFillColor({get:function(){return t},set:function(e){t=e}})&&(this.FAppearance.FThumbStroke.SetColor(t),this.FAppearance.FThumbButtonLeftStroke.SetColor(t),this.FAppearance.FThumbButtonRightStroke.SetColor(t),this.FAppearance.FScrollButtonLeftStroke.SetColor(t),this.FAppearance.FScrollButtonRightStroke.SetColor(t),this.FAppearance.FThumbButtonLeftHoverStroke.SetColor(t),this.FAppearance.FThumbButtonRightHoverStroke.SetColor(t),this.FAppearance.FScrollButtonLeftHoverStroke.SetColor(t),this.FAppearance.FScrollButtonRightHoverStroke.SetColor(t),this.FAppearance.FThumbButtonLeftDownStroke.SetColor(t),this.FAppearance.FThumbButtonRightDownStroke.SetColor(t),this.FAppearance.FScrollButtonLeftDownStroke.SetColor(t),this.FAppearance.FScrollButtonRightDownStroke.SetColor(t)),t=-1,pas["WEBLib.TMSFNCStyles"].TTMSFNCStyles.GetStyleSelectionFillColor({get:function(){return t},set:function(e){t=e}})&&(this.FAppearance.FThumbButtonLeftHoverFill.SetColor(pas["WEBLib.TMSFNCGraphicsTypes"].Blend(this.FFill.FColor,t,70)),this.FAppearance.FThumbButtonRightHoverFill.SetColor(pas["WEBLib.TMSFNCGraphicsTypes"].Blend(this.FFill.FColor,t,70)),this.FAppearance.FScrollButtonLeftHoverFill.SetColor(pas["WEBLib.TMSFNCGraphicsTypes"].Blend(this.FFill.FColor,t,70)),this.FAppearance.FScrollButtonRightHoverFill.SetColor(pas["WEBLib.TMSFNCGraphicsTypes"].Blend(this.FFill.FColor,t,70)),this.FAppearance.FThumbButtonLeftDownFill.SetColor(pas["WEBLib.TMSFNCGraphicsTypes"].Blend(this.FFill.FColor,t,50)),this.FAppearance.FThumbButtonRightDownFill.SetColor(pas["WEBLib.TMSFNCGraphicsTypes"].Blend(this.FFill.FColor,t,50)),this.FAppearance.FScrollButtonLeftDownFill.SetColor(pas["WEBLib.TMSFNCGraphicsTypes"].Blend(this.FFill.FColor,t,50)),this.FAppearance.FScrollButtonRightDownFill.SetColor(pas["WEBLib.TMSFNCGraphicsTypes"].Blend(this.FFill.FColor,t,50)),this.FAppearance.SetArrowColor(t))},this.ResetToDefaultStyle=function(){var e=null;pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.ResetToDefaultStyle.call(this),e=t.TTMSFNCScrollBarAppearance.$create("Create$1",[null]);try{this.FAppearance.Assign(e)}finally{e=rtl.freeLoc(e)}},this.HandleKeyDown=function(t,e){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleKeyDown.apply(this,arguments);var i=t.get();38===i||37===i?this.SetValue(this.FValue-this.FSmallChange):40===i||39===i?this.SetValue(this.FValue+this.FSmallChange):36===i?this.SetValue(this.FMin):35===i?this.SetValue(this.FMax):33===i?this.SetValue(this.FValue-this.FLargeChange):34===i&&this.SetValue(this.FValue+this.FLargeChange)},this.HandleMouseDown=function(t,e,i,s){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleMouseDown.apply(this,arguments),this.CaptureEx(),this.FCx=Math.abs(i-this.GetThumbRectangle().Left+this.GetScrollRectangle().Left),this.FCy=Math.abs(s-this.GetThumbRectangle().Top+this.GetScrollRectangle().Top),this.FMx=i,this.FMy=s,this.FSavedPageSize=this.FPageSize,this.FTime=0,this.FTimer.SetEnabled(!0),this.MouseOnThumbButtons(i,s)?(this.FScrollBarMode=2,this.FMinThumb=pas["WEBLib.TMSFNCTypes"].PtInRectEx(this.GetMinThumbButton(),pas["WEBLib.TMSFNCTypes"].PointF(i,s)),this.FMaxThumb=pas["WEBLib.TMSFNCTypes"].PtInRectEx(this.GetMaxThumbButton(),pas["WEBLib.TMSFNCTypes"].PointF(i,s))):this.MouseOnThumb(i,s)?this.FScrollBarMode=1:pas["WEBLib.TMSFNCTypes"].PtInRectEx(this.GetMinScrollButton(),pas["WEBLib.TMSFNCTypes"].PointF(i,s))?this.FScrollButtonChange=1:pas["WEBLib.TMSFNCTypes"].PtInRectEx(this.GetMaxScrollButton(),pas["WEBLib.TMSFNCTypes"].PointF(i,s))?this.FScrollButtonChange=2:pas["WEBLib.TMSFNCTypes"].PtInRectEx(this.GetScrollAreaMin(),pas["WEBLib.TMSFNCTypes"].PointF(i,s))?this.FScrollButtonChange=3:pas["WEBLib.TMSFNCTypes"].PtInRectEx(this.GetScrollAreaMax(),pas["WEBLib.TMSFNCTypes"].PointF(i,s))&&(this.FScrollButtonChange=4),pas["WEBLib.TMSFNCTypes"].PtInRectEx(this.GetMinThumbButton(),pas["WEBLib.TMSFNCTypes"].PointF(i,s))&&3!==this.FDownButton?(this.FDownButton=3,this.Changed()):pas["WEBLib.TMSFNCTypes"].PtInRectEx(this.GetMaxThumbButton(),pas["WEBLib.TMSFNCTypes"].PointF(i,s))&&4!==this.FDownButton?(this.FDownButton=4,this.Changed()):pas["WEBLib.TMSFNCTypes"].PtInRectEx(this.GetMinScrollButton(),pas["WEBLib.TMSFNCTypes"].PointF(i,s))&&1!==this.FDownButton?(this.FDownButton=1,this.Changed()):pas["WEBLib.TMSFNCTypes"].PtInRectEx(this.GetMaxScrollButton(),pas["WEBLib.TMSFNCTypes"].PointF(i,s))&&2!==this.FDownButton&&(this.FDownButton=2,this.Changed())},this.HandleMouseMove=function(t,e,i){var s=0,o=0;if(pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleMouseMove.apply(this,arguments),2===this.FScrollBarMode){var n=this.FKind;0===n?this.SetControlCursor(9):1===n&&this.SetControlCursor(7);var r=this.FKind;s=0===r?this.GetRange()/(this.GetScrollRectangle().Right-this.GetScrollRectangle().Left)*(e-this.FMx):1===r?this.GetRange()/(this.GetScrollRectangle().Bottom-this.GetScrollRectangle().Top)*(i-this.FMy):0,this.FMinThumb?this.FValue-this.FMin>0?this.SetPageSize(this.FSavedPageSize-s*(this.GetRange()/(this.FValue-this.FMin))):this.SetPageSize(this.FSavedPageSize-s):this.FMaxThumb&&(this.FValue-this.FMin<this.GetRange()?this.SetPageSize(this.FSavedPageSize+s*(this.GetRange()/(this.FMax-this.FValue))):this.SetPageSize(this.FSavedPageSize+s))}else if(1===this.FScrollBarMode){var a=this.FKind;s=0===a?e-this.FCx:1===a?i-this.FCy:0,o=this.GetValue$1(s),this.FTracking?this.SetValue(o):(this.FTempValue=o,this.Changed())}else if(this.MouseOnThumbButtons(e,i)){var l=this.FKind;0===l?this.SetControlCursor(9):1===l&&this.SetControlCursor(7)}else this.SetControlCursor(0);pas["WEBLib.TMSFNCTypes"].PtInRectEx(this.GetMinThumbButton(),pas["WEBLib.TMSFNCTypes"].PointF(e,i))&&3!==this.FHoveredButton?(this.FHoveredButton=3,this.Changed()):pas["WEBLib.TMSFNCTypes"].PtInRectEx(this.GetMaxThumbButton(),pas["WEBLib.TMSFNCTypes"].PointF(e,i))&&4!==this.FHoveredButton?(this.FHoveredButton=4,this.Changed()):pas["WEBLib.TMSFNCTypes"].PtInRectEx(this.GetMinScrollButton(),pas["WEBLib.TMSFNCTypes"].PointF(e,i))&&1!==this.FHoveredButton?(this.FHoveredButton=1,this.Changed()):pas["WEBLib.TMSFNCTypes"].PtInRectEx(this.GetMaxScrollButton(),pas["WEBLib.TMSFNCTypes"].PointF(e,i))&&2!==this.FHoveredButton?(this.FHoveredButton=2,this.Changed()):pas["WEBLib.TMSFNCTypes"].PtInRectEx(this.GetMaxThumbButton(),pas["WEBLib.TMSFNCTypes"].PointF(e,i))||pas["WEBLib.TMSFNCTypes"].PtInRectEx(this.GetMinThumbButton(),pas["WEBLib.TMSFNCTypes"].PointF(e,i))||pas["WEBLib.TMSFNCTypes"].PtInRectEx(this.GetMaxScrollButton(),pas["WEBLib.TMSFNCTypes"].PointF(e,i))||pas["WEBLib.TMSFNCTypes"].PtInRectEx(this.GetMinScrollButton(),pas["WEBLib.TMSFNCTypes"].PointF(e,i))||0===this.FHoveredButton||(this.FHoveredButton=0,this.Changed())},this.HandleMouseUp=function(t,e,i,s){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleMouseUp.apply(this,arguments),this.ReleaseCaptureEx(),1!==this.FScrollBarMode||this.FTracking||this.SetValue(this.FTempValue),0===this.FScrollBarMode&&(pas["WEBLib.TMSFNCTypes"].PtInRectEx(this.GetMinScrollButton(),pas["WEBLib.TMSFNCTypes"].PointF(i,s))?this.SetValue(this.FValue-this.FSmallChange):pas["WEBLib.TMSFNCTypes"].PtInRectEx(this.GetMaxScrollButton(),pas["WEBLib.TMSFNCTypes"].PointF(i,s))?this.SetValue(this.FValue+this.FSmallChange):pas["WEBLib.TMSFNCTypes"].PtInRectEx(this.GetScrollAreaMin(),pas["WEBLib.TMSFNCTypes"].PointF(i,s))?this.SetValue(this.FValue-this.FLargeChange):pas["WEBLib.TMSFNCTypes"].PtInRectEx(this.GetScrollAreaMax(),pas["WEBLib.TMSFNCTypes"].PointF(i,s))&&this.SetValue(this.FValue+this.FLargeChange)),this.FDownButton=0,this.FMinThumb=!1,this.FMaxThumb=!1,this.FTimer.SetEnabled(!1),this.FTime=0,this.FScrollBarMode=0,this.SetControlCursor(0),this.FScrollButtonChange=0,this.Changed()},this.HandleMouseLeave=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleMouseLeave.call(this),this.FTimer.SetEnabled(!1),this.FTime=0,this.FScrollBarMode=0,this.FScrollButtonChange=0,this.FMinThumb=!1,this.FMaxThumb=!1,this.FDownButton=0,this.FHoveredButton=0,this.Changed()},this.HandleMouseEnter=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleMouseEnter.call(this)},this.HandleMouseWheel=function(t,e,i){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleMouseWheel.apply(this,arguments),e<0?this.SetValue(this.FValue+this.FLargeChange):this.SetValue(this.FValue-this.FLargeChange)},this.Changed=function(){this.Invalidate()},this.AppearanceChanged=function(t){this.Changed()},this.TimerChanged=function(t){this.FTime+=1,this.FTime>=4&&(1===this.FScrollButtonChange?(this.SetValue(this.FValue-this.FSmallChange),this.Changed()):2===this.FScrollButtonChange?(this.SetValue(this.FValue+this.FSmallChange),this.Changed()):3===this.FScrollButtonChange?(this.SetValue(this.FValue-this.FLargeChange),this.Changed()):4===this.FScrollButtonChange&&(this.SetValue(this.FValue+this.FLargeChange),this.Changed()))},this.GetDocURL=function(){return pas["WEBLib.TMSFNCTypes"].TTMSFNCBaseDocURL+"tmsfncuipack"},this.GetMinScrollButton=function(){var t=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),e=pas["WEBLib.TMSFNCTypes"].TRectF.$new();e.$assign(this.GetLocalRect());var i=this.FKind;return 0===i?t.$assign(pas["WEBLib.TMSFNCTypes"].MakeRectF(e.Left,e.Top,this.FAppearance.FScrollButtonSize,e.Bottom-e.Top)):1===i&&t.$assign(pas["WEBLib.TMSFNCTypes"].MakeRectF(e.Left,e.Top,e.Right-e.Left,this.FAppearance.FScrollButtonSize)),t},this.GetMaxScrollButton=function(){var t=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),e=pas["WEBLib.TMSFNCTypes"].TRectF.$new();e.$assign(this.GetLocalRect());var i=this.FKind;return 0===i?t.$assign(pas["WEBLib.TMSFNCTypes"].MakeRectF(e.Right-this.FAppearance.FScrollButtonSize,e.Top,this.FAppearance.FScrollButtonSize,e.Bottom-e.Top)):1===i&&t.$assign(pas["WEBLib.TMSFNCTypes"].MakeRectF(e.Left,e.Bottom-this.FAppearance.FScrollButtonSize,e.Right-e.Left,this.FAppearance.FScrollButtonSize)),t},this.GetMinThumbButton=function(){var t=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),e=pas["WEBLib.TMSFNCTypes"].TRectF.$new();e.$assign(this.GetThumbRectangle());var i=this.FKind;return 0===i?t.$assign(pas["WEBLib.TMSFNCTypes"].MakeRectF(e.Left,e.Top,this.FAppearance.GetThumbButtonSize(),e.Bottom-e.Top)):1===i&&t.$assign(pas["WEBLib.TMSFNCTypes"].MakeRectF(e.Left,e.Top,e.Right-e.Left,this.FAppearance.GetThumbButtonSize())),t},this.GetMaxThumbButton=function(){var t=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),e=pas["WEBLib.TMSFNCTypes"].TRectF.$new();e.$assign(this.GetThumbRectangle());var i=this.FKind;return 0===i?t.$assign(pas["WEBLib.TMSFNCTypes"].MakeRectF(e.Left+(e.Right-e.Left)-this.FAppearance.GetThumbButtonSize(),e.Top,this.FAppearance.GetThumbButtonSize(),e.Bottom-e.Top)):1===i&&t.$assign(pas["WEBLib.TMSFNCTypes"].MakeRectF(e.Left,e.Top+(e.Bottom-e.Top)-this.FAppearance.GetThumbButtonSize(),e.Right-e.Left,this.FAppearance.GetThumbButtonSize())),t},this.GetScrollRectangle=function(){var t=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),e=this.FKind;return 0===e?(t.Left=this.GetMinScrollButton().Left+(this.GetMinScrollButton().Right-this.GetMinScrollButton().Left),t.Top=this.GetMinScrollButton().Top,t.Bottom=t.Top+(this.GetMinScrollButton().Bottom-this.GetMinScrollButton().Top),t.Right=t.Left+this.GetMaxScrollButton().Left-(this.GetMinScrollButton().Right-this.GetMinScrollButton().Left)):1===e&&(t.Left=this.GetMinScrollButton().Left,t.Top=this.GetMinScrollButton().Top+(this.GetMinScrollButton().Bottom-this.GetMinScrollButton().Top),t.Bottom=t.Top+this.GetMaxScrollButton().Top-(this.GetMinScrollButton().Bottom-this.GetMinScrollButton().Top),t.Right=t.Left+(this.GetMinScrollButton().Right-this.GetMinScrollButton().Left)),t},this.GetScrollAreaMin=function(){var t=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),e=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),i=pas["WEBLib.TMSFNCTypes"].TRectF.$new();e.$assign(this.GetScrollRectangle()),i.$assign(this.GetThumbRectangle());var s=this.FKind;return 0===s?(t.Left=e.Left,t.Top=e.Top,t.Right=t.Left+(i.Left-e.Left),t.Bottom=t.Top+(e.Bottom-e.Top)):1===s&&(t.Left=e.Left,t.Top=e.Top,t.Right=t.Left+(e.Right-e.Left),t.Bottom=t.Top+(i.Top-e.Top)),t},this.GetScrollAreaMax=function(){var t=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),e=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),i=pas["WEBLib.TMSFNCTypes"].TRectF.$new();e.$assign(this.GetScrollRectangle()),i.$assign(this.GetThumbRectangle());var s=this.FKind;return 0===s?(t.Left=i.Left+(i.Right-i.Left),t.Top=e.Top,t.Right=t.Left+(e.Right-e.Left)-(i.Right-i.Left)-i.Left+e.Left,t.Bottom=t.Top+(e.Bottom-e.Top)):1===s&&(t.Left=e.Left,t.Top=i.Top+(i.Bottom-i.Top),t.Right=t.Left+(e.Right-e.Left),t.Bottom=t.Top+(e.Bottom-e.Top)-(i.Bottom-i.Top)-i.Top+e.Top),t},this.GetThumbRectangle=function(){var t=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),e=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),i=0;e.$assign(this.GetScrollRectangle());var s=this.FKind;return 0===s?(i=(e.Right-e.Left)/this.GetRange()*this.FPageSize,t.Left=e.Left+this.GetValue(),t.Top=e.Top,t.Right=t.Left+Math.max(2*this.FAppearance.GetThumbButtonSize()+this.ScalePaintValue(10),i),t.Bottom=t.Top+(e.Bottom-e.Top)):1===s&&(i=(e.Bottom-e.Top)/this.GetRange()*this.FPageSize,t.Left=e.Left,t.Top=e.Top+this.GetValue(),t.Right=t.Left+(e.Right-e.Left),t.Bottom=t.Top+Math.max(2*this.FAppearance.GetThumbButtonSize()+this.ScalePaintValue(10),i)),t},this.GetValue=function(){var t=0,e=0,i=pas["WEBLib.TMSFNCTypes"].TRectF.$new();t=0,i.$assign(this.GetScrollRectangle());var s=this.FKind;return(e=0===s?i.Right-i.Left-Math.max(2*this.FAppearance.GetThumbButtonSize()+10,(i.Right-i.Left)/this.GetRange()*this.FPageSize):1===s?i.Bottom-i.Top-Math.max(2*this.FAppearance.GetThumbButtonSize()+10,(i.Bottom-i.Top)/this.GetRange()*this.FPageSize):0)<=0?t:t=this.FMax-this.FMin>0?this.FTracking?Math.min((this.FValue-this.FMin)/(this.FMax-this.FMin)*e,e):Math.min((this.FTempValue-this.FMin)/(this.FMax-this.FMin)*e,e):this.FMin},this.GetValue$1=function(t){var e=0,i=0,s=0,o=pas["WEBLib.TMSFNCTypes"].TRectF.$new();o.$assign(this.GetScrollRectangle());var n=this.FKind;return s=0===n?o.Right-o.Left-Math.max(2*this.FAppearance.GetThumbButtonSize()+10,(o.Right-o.Left)/this.GetRange()*this.FPageSize):1===n?o.Bottom-o.Top-Math.max(2*this.FAppearance.GetThumbButtonSize()+10,(o.Bottom-o.Top)/this.GetRange()*this.FPageSize):0,this.FMax-this.FMin>0&&s>0?(i=t/s*(this.FMax-this.FMin)+this.FMin,e=Math.max(Math.min(i,this.FMax),this.FMin)):e=0,e},this.GetRange=function(){return Math.max(2,this.FMax-this.FMin)},this.MouseOnThumbButtons=function(t,e){return(pas["WEBLib.TMSFNCTypes"].PtInRectEx(this.GetMinThumbButton(),pas["WEBLib.TMSFNCTypes"].PointF(t,e))||pas["WEBLib.TMSFNCTypes"].PtInRectEx(this.GetMaxThumbButton(),pas["WEBLib.TMSFNCTypes"].PointF(t,e)))&&!this.FAppearance.FFixedThumb},this.MouseOnThumb=function(t,e){return pas["WEBLib.TMSFNCTypes"].PtInRectEx(this.GetThumbRectangle(),pas["WEBLib.TMSFNCTypes"].PointF(t,e))},this.DrawScrollButtons=function(t){var e=null,i=null,s=null,o=null;this.FAppearance.FScrollButtonSize<=0||(e=this.FAppearance.FScrollButtonLeftFill,i=this.FAppearance.FScrollButtonRightFill,s=this.FAppearance.FScrollButtonLeftStroke,o=this.FAppearance.FScrollButtonRightStroke,1===this.FDownButton?(e=this.FAppearance.FScrollButtonLeftDownFill,s=this.FAppearance.FScrollButtonLeftDownStroke):1===this.FHoveredButton&&(e=this.FAppearance.FScrollButtonLeftHoverFill,s=this.FAppearance.FScrollButtonLeftHoverStroke),t.FFill.Assign(e),t.FStroke.Assign(s),t.DrawRectangle$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(this.GetMinScrollButton()),2),2===this.FDownButton?(i=this.FAppearance.FScrollButtonRightDownFill,o=this.FAppearance.FScrollButtonRightDownStroke):2===this.FHoveredButton&&(i=this.FAppearance.FScrollButtonRightHoverFill,o=this.FAppearance.FScrollButtonRightHoverStroke),t.FFill.Assign(i),t.FStroke.Assign(o),t.DrawRectangle$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(this.GetMaxScrollButton()),2),this.DrawArrow(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(this.GetMinScrollButton()),!0),this.DrawArrow(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(this.GetMaxScrollButton()),!1))},this.DrawThumb=function(t){t.FFill.Assign(this.FAppearance.FThumbFill),t.FStroke.Assign(this.FAppearance.FThumbStroke),t.DrawRectangle$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(this.GetThumbRectangle()),2),this.FAppearance.FFixedThumb||this.DrawThumbButtons(t)},this.DrawThumbButtons=function(t){var e=null,i=null,s=null,o=null;this.FAppearance.FThumbButtonSize<=0||(e=this.FAppearance.FThumbButtonLeftFill,i=this.FAppearance.FThumbButtonRightFill,s=this.FAppearance.FThumbButtonLeftStroke,o=this.FAppearance.FThumbButtonRightStroke,3===this.FDownButton?(e=this.FAppearance.FThumbButtonLeftDownFill,s=this.FAppearance.FThumbButtonLeftDownStroke):3===this.FHoveredButton&&(e=this.FAppearance.FThumbButtonLeftHoverFill,s=this.FAppearance.FThumbButtonLeftHoverStroke),t.FFill.Assign(e),t.FStroke.Assign(s),t.DrawRectangle$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(this.GetMinThumbButton()),2),4===this.FDownButton?(i=this.FAppearance.FThumbButtonRightDownFill,o=this.FAppearance.FThumbButtonRightDownStroke):4===this.FHoveredButton&&(i=this.FAppearance.FThumbButtonRightHoverFill,o=this.FAppearance.FThumbButtonRightHoverStroke),t.FFill.Assign(i),t.FStroke.Assign(o),t.DrawRectangle$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(this.GetMaxThumbButton()),2),this.DrawArrow(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(this.GetMinThumbButton()),!0),this.DrawArrow(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(this.GetMaxThumbButton()),!1))},this.DrawArrow=function(t,e,i){t.FStroke.SetColor(this.FAppearance.FArrowColor),1===this.FKind?(pas["WEBLib.TMSFNCTypes"].InflateRectEx(e,0,-4),i?(t.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(e.Left+(e.Right-e.Left)/2,e.Top+(e.Bottom-e.Top)/3)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(e.Left+(e.Right-e.Left)/3,e.Top+(e.Bottom-e.Top)/3*2)),2,2),t.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(e.Left+(e.Right-e.Left)/2,e.Top+(e.Bottom-e.Top)/3)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(e.Left+(e.Right-e.Left)/3*2,e.Top+(e.Bottom-e.Top)/3*2)),2,2)):(t.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(e.Left+(e.Right-e.Left)/2,e.Top+(e.Bottom-e.Top)/3*2)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(e.Left+(e.Right-e.Left)/3,e.Top+(e.Bottom-e.Top)/3)),2,2),t.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(e.Left+(e.Right-e.Left)/2,e.Top+(e.Bottom-e.Top)/3*2)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(e.Left+(e.Right-e.Left)/3*2,e.Top+(e.Bottom-e.Top)/3)),2,2))):(pas["WEBLib.TMSFNCTypes"].InflateRectEx(e,-4,0),i?(t.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(e.Left+(e.Right-e.Left)/3*2,e.Top+(e.Bottom-e.Top)/3)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(e.Left+(e.Right-e.Left)/3,e.Top+(e.Bottom-e.Top)/2)),2,2),t.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(e.Left+(e.Right-e.Left)/3*2,e.Top+(e.Bottom-e.Top)/3*2)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(e.Left+(e.Right-e.Left)/3,e.Top+(e.Bottom-e.Top)/2)),2,2)):(t.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(e.Left+(e.Right-e.Left)/3,e.Top+(e.Bottom-e.Top)/3)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(e.Left+(e.Right-e.Left)/3*2,e.Top+(e.Bottom-e.Top)/2)),2,2),t.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(e.Left+(e.Right-e.Left)/3,e.Top+(e.Bottom-e.Top)/3*2)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(e.Left+(e.Right-e.Left)/3*2,e.Top+(e.Bottom-e.Top)/2)),2,2)))},this.Draw=function(t,e){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Draw.apply(this,arguments),this.DrawThumb(t),this.DrawScrollButtons(t)},this.Create$1=function(e){return pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Create$1.apply(this,arguments),this.FTracking=!0,this.FDesignTime=this.IsDesignTime(),this.FDesignTime&&(this.FFill.SetColor(pas["WEBLib.TMSFNCGraphicsTypes"].Lighter(pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(225,225,225),40)),this.FStroke.SetColor(pas["WEBLib.TMSFNCGraphicsTypes"].Darker(11119017,40))),this.SetHeight(121),this.SetWidth(18),this.FKind=1,this.FValue=0,this.FMin=0,this.FMax=100,this.FSmallChange=1,this.FLargeChange=20,this.FAppearance=t.TTMSFNCScrollBarAppearance.$create("Create$1",[this]),this.FAppearance.FOnChange=rtl.createCallback(this,"AppearanceChanged"),this.FPageSize=20,this.FTimer=pas["WEBLib.ExtCtrls"].TTimer.$create("Create$1",[null]),this.FTimer.FOnTimer=rtl.createCallback(this,"TimerChanged"),this.FTimer.SetInterval(100),this},this.Destroy=function(){rtl.free(this,"FAppearance"),rtl.free(this,"FTimer"),pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Destroy.call(this)},this.Assign=function(e){t.TTMSFNCScrollBar.isPrototypeOf(e)&&(this.FKind=rtl.as(e,t.TTMSFNCScrollBar).FKind,this.FValue=rtl.as(e,t.TTMSFNCScrollBar).FValue,this.FMin=rtl.as(e,t.TTMSFNCScrollBar).FMin,this.FMax=rtl.as(e,t.TTMSFNCScrollBar).FMax,this.FPageSize=rtl.as(e,t.TTMSFNCScrollBar).FPageSize,this.FSmallChange=rtl.as(e,t.TTMSFNCScrollBar).FSmallChange,this.FLargeChange=rtl.as(e,t.TTMSFNCScrollBar).FLargeChange,this.FAppearance.Assign(rtl.as(e,t.TTMSFNCScrollBar).FAppearance),this.FTracking=rtl.as(e,t.TTMSFNCScrollBar).FTracking,this.Changed())},rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas["WEBLib.TMSFNCTypes"].ITMSFNCProductInfo),rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TTMSFNCScrollBar",this.TTMSFNCCustomScrollBar,(function(){this.RegisterRuntimeClasses=function(){pas.Classes.RegisterClass(t.TTMSFNCScrollBar)},rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas["WEBLib.TMSFNCTypes"].ITMSFNCProductInfo),rtl.addIntf(this,pas.System.IUnknown);var e=this.$rtti;e.addProperty("Fill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FFill","SetFill"),e.addProperty("Stroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FStroke","SetStroke"),e.addProperty("Appearance",2,t.$rtti.TTMSFNCScrollBarAppearance,"FAppearance","SetAppearance"),e.addProperty("Kind",2,t.$rtti.TTMSFNCScrollBarKind,"FKind","SetKind",{Default:t.TTMSFNCScrollBarKind.sbkVertical}),e.addProperty("LargeChange",12,rtl.double,"FLargeChange","FLargeChange",{stored:"IsLargeChangeStored"}),e.addProperty("Max",14,rtl.double,"FMax","SetMax",{stored:"IsMaxStored"}),e.addProperty("Tracking",2,rtl.boolean,"FTracking","SetTracking",{Default:!0}),e.addProperty("Min",14,rtl.double,"FMin","SetMin",{stored:"IsMinStored"}),e.addProperty("PageSize",14,rtl.double,"FPageSize","SetPageSize",{stored:"IsPageSizeStored"}),e.addProperty("Value",14,rtl.double,"FValue","SetValue",{stored:"IsValueStored"}),e.addProperty("SmallChange",12,rtl.double,"FSmallChange","FSmallChange",{stored:"IsSmallChangeStored"}),e.addProperty("OnValueChanged",0,t.$rtti.TTMSFNCScrollBarValueChanged,"FOnValueChange","FOnValueChange"),e.addProperty("OnPageSizeChanged",0,t.$rtti.TTMSFNCScrollBarPageSizeChanged,"FOnPageSizeChanged","FOnPageSizeChanged"),e.attr=[pas.Classes.ComponentPlatformsAttribute,"Create$1",[0]]}))}),["Math","WEBLib.TMSFNCStyles","WEBLib.TMSFNCUtils"]),rtl.module("WEBLib.TMSFNCTreeViewBase",["System","Classes","WEBLib.TMSFNCCustomControl","WEBLib.TMSFNCScrollBar","WEBLib.StdCtrls","WEBLib.Controls","WEBLib.TMSFNCTypes"],(function(){"use strict";var t=this;this.SWIPECOUNT=300,this.DOWNCOUNT=100,rtl.createClass(this,"TTMSFNCTreeViewDoubleListItem",pas.Classes.TCollectionItem,(function(){this.$init=function(){pas.Classes.TCollectionItem.$init.call(this),this.FOwner=null,this.FValue=0,this.FCellVal=0},this.$final=function(){this.FOwner=void 0,pas.Classes.TCollectionItem.$final.call(this)},this.SetCellData=function(t){this.FValue=t},this.Create$1=function(e){return pas.Classes.TCollectionItem.Create$1.apply(this,arguments),null!=this.FCollection&&(this.FOwner=rtl.as(this.FCollection,t.TTMSFNCTreeViewDoubleList).FOwner$1),this};var e=this.$rtti;e.addProperty("Value",2,rtl.double,"FValue","SetCellData"),e.addProperty("CellVal",0,rtl.longint,"FCellVal","FCellVal")})),rtl.createClass(this,"TTMSFNCTreeViewDoubleList",pas["WEBLib.TMSFNCTypes"].TTMSFNCOwnedCollection,(function(){this.$init=function(){pas["WEBLib.TMSFNCTypes"].TTMSFNCOwnedCollection.$init.call(this),this.FOwner$1=null},this.$final=function(){this.FOwner$1=void 0,pas["WEBLib.TMSFNCTypes"].TTMSFNCOwnedCollection.$final.call(this)},this.GetItem$1=function(t){return this.GetItem(t)},this.IndexOf=function(t){var e=0,i=0;e=-1;for(var s=0,o=this.GetCount()-1;s<=o;s++)if(i=s,this.GetItem$1(i).FCellVal===t)return e=i;return e},this.Create$3=function(e){return pas.Classes.TOwnedCollection.Create$2.call(this,e,t.TTMSFNCTreeViewDoubleListItem),this.FOwner$1=e,this},this.Add$1=function(){return pas.Classes.TCollection.Add.call(this)}})),this.TTMSFNCTreeViewScrollMode={0:"smPixelScrolling",smPixelScrolling:0,1:"smNodeScrolling",smNodeScrolling:1},this.TTMSFNCTreeViewScrollUpdate={0:"suContinuous",suContinuous:0,1:"suOnce",suOnce:1},rtl.createClass(this,"TTMSFNCTreeViewBase",pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl,(function(){this.$init=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.$init.call(this),this.FSaveHScrollPos=0,this.FSaveVScrollPos=0,this.FTotalRowHeight=0,this.FNodeListBuild=!1,this.FTotalColumnWidth=0,this.FStartOffset=0,this.FStartCol=0,this.FStopCol=0,this.FStartRow=0,this.FStopRow=0,this.FStartX=0,this.FStopX=0,this.FStartY=0,this.FStopY=0,this.FBlockScrollingUpdate=!1,this.FUpdateCount$1=0,this.FVerticalScrollBar=null,this.FHorizontalScrollBar=null,this.FCustomVerticalScrollBar=null,this.FCustomHorizontalScrollBar=null,this.FRowCount=0,this.FColumnCount=0,this.FColumnW=null,this.FColumnP=null,this.FDefaultRowHeight=0,this.FDefaultColumnWidth=0,this.FVerticalScrollBarVisible=!1,this.FHorizontalScrollBarVisible=!1,this.FScrollMode=0,this.FIsMouseDown=!1,this.FDelayedLoading=!1,this.FStretchScrollBars=!1,this.FBlockUpdateNodeList=!1,this.FBlockUpdateNode=!1,this.FBlockRemoveNode=0,this.FBlockUserInput=!1,this.FBlockMouseClick=!1,this.FCustomScrollBars=!1,this.FScrollUpdate=0},this.$final=function(){this.FVerticalScrollBar=void 0,this.FHorizontalScrollBar=void 0,this.FCustomVerticalScrollBar=void 0,this.FCustomHorizontalScrollBar=void 0,this.FColumnW=void 0,this.FColumnP=void 0,pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.$final.call(this)},this.SetColumnCount=function(t){this.FColumnCount!==t&&(this.FColumnCount=t)},this.SetRowCount=function(t){this.FRowCount!==t&&(this.FRowCount=t)},this.SetDefaultRowHeight=function(t){this.FDefaultRowHeight!==t&&(this.FDefaultRowHeight=t)},this.SetHorizontalScrollBarVisible=function(t){this.FHorizontalScrollBarVisible!==t&&(this.FHorizontalScrollBarVisible=t,this.UpdateTreeViewCache())},this.SetVerticalScrollBarVisible=function(t){this.FVerticalScrollBarVisible!==t&&(this.FVerticalScrollBarVisible=t,this.UpdateTreeViewCache())},this.SetColWidths=function(t,e){var i,s=null;(i=this.FColumnW.IndexOf(t))>=0&&i<=this.FColumnW.GetCount()-1?e===this.FDefaultColumnWidth?this.FColumnW.Delete(i):(this.FColumnW.GetItem$1(i).SetCellData(Math.max(0,e)),this.FColumnW.GetItem$1(i).FCellVal=t):e!==this.FDefaultColumnWidth&&((s=this.FColumnW.Add$1()).SetCellData(Math.max(0,e)),s.FCellVal=t)},this.GetColWidths=function(t){var e;return-1!==(e=this.FColumnW.IndexOf(t))?this.FColumnW.GetItem$1(e).FValue:this.FDefaultColumnWidth},this.GetColPos=function(t){var e;return-1!==(e=this.FColumnP.IndexOf(t))?this.FColumnP.GetItem$1(e).FValue:-1},this.SetColPos=function(t,e){var i,s=null;(i=this.FColumnP.IndexOf(t))>=0&&i<=this.FColumnP.GetCount()-1?-1===e?this.FColumnP.Delete(i):(this.FColumnP.GetItem$1(i).SetCellData(Math.max(0,e)),this.FColumnP.GetItem$1(i).FCellVal=t):-1!==e&&((s=this.FColumnP.Add$1()).SetCellData(Math.max(0,e)),s.FCellVal=t)},this.SetStretchScrollBars=function(t){this.FStretchScrollBars!==t&&(this.FStretchScrollBars=t,this.UpdateTreeViewDisplay())},this.UpdateTreeView=function(){this.SaveScrollPosition(),this.UpdateNodesCache(!0,!0),this.RestoreScrollPosition(),this.UpdateGroupsCache(),this.UpdateColumnsCache()},this.UpdateVisualRange=function(){var t,e,i,s,o,n=0,r=0,a=0,l=0,h=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),F=0;s=this.GetHorizontalScrollPosition(),i=this.GetVerticalScrollPosition(),h.$assign(this.GetContentRect()),a=-s,l=-i,t=h.Right-h.Left,e=h.Bottom-h.Top,(o=this.GetVScrollValue()>this.VerticalScrollBar().FMax/2)&&(l+=this.GetTotalRowHeight()),this.FStartCol=-1,this.FStartRow=-1,this.FStopCol=-1,this.FStopRow=-1,this.FStartX=h.Left,this.FStopX=h.Left,this.FStartY=h.Top,this.FStopY=h.Top,this.FStartOffset=0;for(var p=0,c=this.FColumnCount-1;p<=c&&(n=p,(a+=this.GetColWidths(n))>0&&-1===this.FStartCol&&(this.FStartCol=n,this.FStartX=this.FStartX+pas.System.Int(a-this.GetColWidths(n))),a>=t&&-1===this.FStopCol&&(this.FStopCol=n,this.FStopX=this.FStopX+pas.System.Int(a)),!(this.FStartCol>-1&&this.FStopCol>-1));p++);if(o)for(var u=this.FRowCount-1;u>=0&&(r=u,(l-=F=this.GetRowHeight(r))<=0&&-1===this.FStartRow&&(this.FStartRow=r,this.FStartOffset=l,this.FStartY=this.FStartY+pas.System.Int(this.FStartOffset-F)),l<e&&-1===this.FStopRow&&(this.FStopRow=r,this.FStopY=this.FStopY+pas.System.Int(l)),!(this.FStartRow>-1&&this.FStopRow>-1));u--);else for(var C=0,T=this.FRowCount-1;C<=T&&(r=C,(l+=F=this.GetRowHeight(r))>0&&-1===this.FStartRow&&(this.FStartRow=r,this.FStartOffset=l-F,this.FStartY=this.FStartY+pas.System.Int(this.FStartOffset)),l>=e&&-1===this.FStopRow&&(this.FStopRow=r,this.FStopY=this.FStopY+pas.System.Int(l)),!(this.FStartRow>-1&&this.FStopRow>-1));C++);this.FStartRow>-1&&-1===this.FStopRow&&(this.FStopRow=this.FRowCount-1),this.FStartCol>-1&&-1===this.FStopCol&&(this.FStopCol=this.FColumnCount-1)},this.StretchColumn=function(t,e,i){var s,o=0,n=0,r=0,a=0,l=pas["WEBLib.TMSFNCTypes"].TRectF.$new();if(s=this.HorizontalScrollBar(),null!=this.VerticalScrollBar()&&null!=s){-1===i?(l.$assign(this.GetContentRect()),r=l.Right-l.Left):r=i,a=0;for(var h=0,F=this.FColumnCount-1;h<=F;h++)o=h,this.IsColumnVisible(o)&&(a+=1);if(-1===e&&(e=this.FColumnCount-1),0!==a&&(!(e>=this.FColumnCount)||t||this.IsLoading()))if(1!==this.FColumnCount)if(n=0,t){if(a>0){n=r/a;for(var p=0,c=this.FColumnCount-1;p<=c;p++)o=p,this.IsColumnVisible(o)&&this.SetColWidths(o,n)}}else{for(var u=0,C=this.FColumnCount-1;u<=C;u++)(o=u)!==e&&this.IsColumnVisible(o)&&(n+=this.GetColWidths(o));this.SetColWidths(e,r-n)}else this.SetColWidths(0,r)}},this.Scroll=function(t,e){this.FBlockScrollingUpdate=!0,this.SetHScrollValue(t),this.SetVScrollValue(e),this.FBlockScrollingUpdate=!1,this.UpdateDisplay()},this.UpdateDisplay=function(){},this.VScrollChanged=function(t){this.FBlockScrollingUpdate||(this.FIsMouseDown||this.StopAnimationTimer(),this.VerticalScrollPositionChanged())},this.HScrollChanged=function(t){this.FBlockScrollingUpdate||(this.FIsMouseDown||this.StopAnimationTimer(),this.HorizontalScrollPositionChanged())},this.HCustomScrollChanged=function(t,e){!this.FBlockScrollingUpdate&&this.FCustomScrollBars&&(this.FIsMouseDown||this.StopAnimationTimer(),this.HorizontalScrollPositionChanged(),this.SetHScrollValue(this.GetHScrollValue()))},this.VCustomScrollChanged=function(t,e){!this.FBlockScrollingUpdate&&this.FCustomScrollBars&&(this.FIsMouseDown||this.StopAnimationTimer(),this.VerticalScrollPositionChanged(),this.SetVScrollValue(this.GetVScrollValue()))},this.UpdateScrollBars=function(t,e){var i=null,s=null,o=null,n=null,r=0,a=0,l=0,h=0,F=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),p=null,c=null;this.FUpdateCount$1>0||3 in this.FComponentState||(this.FBlockScrollingUpdate=!0,e&&(this.UpdateAutoSizing(),this.UpdateColumnRowCalculations(!0)),i=this.VerticalScrollBar(),s=this.HorizontalScrollBar(),o=this.CustomVerticalScrollBar(),n=this.CustomHorizontalScrollBar(),null!=i&&null!=s&&null!=o&&null!=n&&(t?F.$assign(this.GetCalculationRect()):F.$assign(this.GetContentRect()),l=F.Right-F.Left,h=F.Bottom-F.Top,r=this.GetTotalColumnWidth(),a=this.GetTotalRowHeight(),s.SetVisible(r>0&&1===pas["WEBLib.TMSFNCTypes"].CompareValueEx(r,l,0)&&this.FHorizontalScrollBarVisible&&!this.ColumnStretchingActive()&&!this.FCustomScrollBars),i.SetVisible(a>0&&1===pas["WEBLib.TMSFNCTypes"].CompareValueEx(a,h,0)&&this.FVerticalScrollBarVisible&&!this.FCustomScrollBars),n.SetVisible(r>0&&1===pas["WEBLib.TMSFNCTypes"].CompareValueEx(r,l,0)&&this.FHorizontalScrollBarVisible&&!this.ColumnStretchingActive()&&this.FCustomScrollBars),o.SetVisible(a>0&&1===pas["WEBLib.TMSFNCTypes"].CompareValueEx(a,h,0)&&this.FVerticalScrollBarVisible&&this.FCustomScrollBars),o.FVisible&&this.FCustomScrollBars?o.SetParent(this):o.SetParent(null),n.FVisible&&this.FCustomScrollBars?n.SetParent(this):n.SetParent(null),i.FVisible&&!this.FCustomScrollBars?i.SetParent(this):i.SetParent(null),s.FVisible&&!this.FCustomScrollBars?s.SetParent(this):s.SetParent(null),p=pas["WEBLib.TMSFNCTypes"].TTMSFNCMargins.$create("Create$1"),c=pas["WEBLib.TMSFNCTypes"].TTMSFNCMargins.$create("Create$1"),this.FCustomScrollBars?o.FVisible&&this.FStretchScrollBars?c.SetRight(o.GetWidth()+1):c.SetRight(1):i.FVisible&&this.FStretchScrollBars?c.SetRight(i.GetWidth()+1):c.SetRight(1),p.SetTop(1),p.SetRight(1),c.SetBottom(1),c.SetLeft(1),this.FCustomScrollBars?n.FVisible?p.SetBottom(n.GetHeight()+1):p.SetBottom(1):s.FVisible?p.SetBottom(s.GetHeight()+1):p.SetBottom(1),this.FStretchScrollBars||(F.$assign(this.GetCalculationRect()),c.SetLeft(c.FLeft+F.Left),c.SetRight(c.FRight+(this.GetWidth()-F.Right)),p.SetTop(p.FTop+F.Top),p.SetBottom(p.FBottom+(this.GetHeight()-F.Bottom))),s.SetLeft(Math.round(c.FLeft)),s.SetTop(Math.round(this.GetHeight()-c.FBottom-s.GetHeight())),i.SetLeft(Math.round(this.GetWidth()-p.FRight-i.GetWidth())),i.SetTop(Math.round(p.FTop)),s.SetWidth(Math.round(Math.max(0,this.GetWidth()-c.FRight-c.FLeft))),i.SetHeight(Math.round(Math.max(0,this.GetHeight()-p.FBottom-p.FTop))),i.SetHeight(Math.round(Math.max(0,this.GetHeight()-p.FBottom-p.FTop))),n.SetLeft(Math.round(c.FLeft)),n.SetTop(Math.round(this.GetHeight()-c.FBottom-n.GetHeight())),o.SetLeft(Math.round(this.GetWidth()-p.FRight-o.GetWidth())),o.SetTop(Math.round(p.FTop)),n.SetWidth(Math.round(Math.max(0,this.GetWidth()-c.FRight-c.FLeft))),o.SetHeight(Math.round(Math.max(0,this.GetHeight()-p.FBottom-p.FTop))),c=rtl.freeLoc(c),p=rtl.freeLoc(p),F.$assign(this.GetContentRect()),l=F.Right-F.Left,h=F.Bottom-F.Top,1===this.FScrollMode?(i.SetPageSize(Math.round(Math.max(0,this.GetRowViewPortSize()))),i.SetMax(Math.max(i.GetPageSize(),this.FRowCount))):(i.SetPageSize(Math.round(Math.max(0,Math.min(a,h)))),i.SetMax(Math.round(Math.max(i.GetPageSize(),a))),i.FSmallChange=Math.round(this.FDefaultRowHeight),i.FLargeChange=Math.max(1,i.GetPageSize()),i.SetPosition(Math.min(i.GetPosition(),i.FMax))),1===this.FScrollMode?(s.SetPageSize(Math.round(Math.max(0,this.GetColumnViewPortSize()))),s.SetMax(Math.max(s.GetPageSize(),this.FColumnCount))):(s.SetPageSize(Math.round(Math.max(0,Math.min(r,l)))),s.SetMax(Math.round(Math.max(s.GetPageSize(),r))),s.SetPosition(Math.min(s.GetPosition(),s.FMax))),1===this.FScrollMode?(o.SetPageSize(this.GetRowViewPortSize()),o.SetMax(this.FRowCount-o.FPageSize)):(o.SetPageSize(Math.min(a,h)),o.SetMax(a-o.FPageSize),o.FSmallChange=Math.round(this.FDefaultRowHeight),o.SetValue(Math.min(o.FValue,o.FMax))),1===this.FScrollMode?(n.SetPageSize(this.GetColumnViewPortSize()),n.SetMax(this.FColumnCount-n.FPageSize)):(n.SetPageSize(Math.min(r,l)),n.SetMax(r-n.FPageSize),n.SetValue(Math.min(n.FValue,n.FMax)))),this.FBlockScrollingUpdate=!1,t&&this.UpdateScrollBars(!1,!1))},this.UpdateTreeViewCache=function(){this.FUpdateCount$1>0||this.FBlockUpdateNode||3 in this.FComponentState||0 in this.FComponentState||(this.ResetNodes(!0),this.UpdateCalculations(),this.UpdateColumns(),this.UpdateScrollBars(!0,!0),this.UpdateNodesCache(!0,!0),this.UpdateGroupsCache(),this.UpdateColumnsCache())},this.UpdateTreeViewDisplay=function(){this.UpdateScrollBars(!0,!0),this.UpdateDisplay()},this.Loaded=function(){pas["WEBLib.Controls"].TCustomControl.Loaded.call(this),this.UpdateTreeViewCache()},this.SetHScrollValue=function(t){this.FCustomScrollBars?this.CustomHorizontalScrollBar().SetValue(t):this.HorizontalScrollBar().SetPosition(Math.round(Math.min(this.HorizontalScrollBar().FMax-this.HorizontalScrollBar().GetPageSize(),Math.max(0,t))))},this.SetVScrollValue=function(t){this.FCustomScrollBars?this.CustomVerticalScrollBar().SetValue(t):this.VerticalScrollBar().SetPosition(Math.round(Math.min(this.VerticalScrollBar().FMax-this.VerticalScrollBar().GetPageSize(),Math.max(0,t))))},this.UpdateControlAfterResize=function(){this.FUpdateCount$1>0||3 in this.FComponentState||0 in this.FComponentState||(this.ResetNodes(!0),this.SaveScrollPosition(),this.UpdateNodesCache(!0,!0),this.UpdateGroupsCache(),this.UpdateColumnsCache(),this.RestoreScrollPosition())},this.CanScrollDown=function(){return this.GetVerticalScrollPosition()<this.GetTotalRowHeight()-this.GetVViewPortSize()},this.CanScrollUp=function(){return this.GetVerticalScrollPosition()>0},this.ScrollLimitation=function(){return!1,!1},this.IsColumnVisible=function(t){return!0,!0},this.GetRowHeight=function(t){return 0,0},this.GetCalculationRect=function(){var t=pas["WEBLib.TMSFNCTypes"].TRectF.$new();return t.$assign(this.GetLocalRect()),t},this.GetContentRect=function(){var t=pas["WEBLib.TMSFNCTypes"].TRectF.$new();return t.$assign(pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.GetContentRect.call(this)),this.FCustomScrollBars?(this.CustomHorizontalScrollBar().FVisible&&(t.Bottom=t.Bottom-this.CustomHorizontalScrollBar().GetHeight()-1),this.CustomVerticalScrollBar().FVisible&&(t.Right=t.Right-this.CustomVerticalScrollBar().GetWidth()-1)):(this.HorizontalScrollBar().FVisible&&(t.Bottom=t.Bottom-this.HorizontalScrollBar().GetHeight()-1),this.VerticalScrollBar().FVisible&&(t.Right=t.Right-this.VerticalScrollBar().GetWidth()-1)),t},this.GetContentClipRect=function(){var t=pas["WEBLib.TMSFNCTypes"].TRectF.$new();return t.$assign(this.GetContentRect()),t},this.GetHScrollValue=function(){return this.FCustomScrollBars?this.CustomHorizontalScrollBar().FValue:Math.round(Math.min(this.HorizontalScrollBar().FMax-this.HorizontalScrollBar().GetPageSize(),Math.max(0,this.HorizontalScrollBar().GetPosition())))},this.GetVScrollValue=function(){return this.FCustomScrollBars?this.CustomVerticalScrollBar().FValue:Math.round(Math.min(this.VerticalScrollBar().FMax-this.VerticalScrollBar().GetPageSize(),Math.max(0,this.VerticalScrollBar().GetPosition())))},this.GetVViewPortSize=function(){return this.FCustomScrollBars?this.CustomVerticalScrollBar().FPageSize:this.VerticalScrollBar().GetPageSize()},this.GetHViewPortSize=function(){return this.FCustomScrollBars?this.CustomHorizontalScrollBar().FPageSize:this.HorizontalScrollBar().GetPageSize()},this.GetColumnViewPortSize=function(){var t,e=0,i=0,s=0,o=0,n=pas["WEBLib.TMSFNCTypes"].TRectF.$new();n.$assign(this.GetContentRect()),t=n.Right-n.Left,e=0,o=0,s=0;for(var r=this.FColumnCount-1;r>=0;r--){if(i=r,(o+=this.GetColWidths(i))>t){e=Math.max(1,s);break}s+=1}return e},this.GetRowViewPortSize=function(){var t,e=0,i=0,s=0,o=0,n=pas["WEBLib.TMSFNCTypes"].TRectF.$new();n.$assign(this.GetContentRect()),t=n.Bottom-n.Top,e=0,o=0,s=0;for(var r=this.FRowCount-1;r>=0;r--){if(i=r,(o+=this.GetRowHeight(i))>t){e=Math.max(1,s);break}s+=1}return e},this.Create$1=function(e){return pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Create$1.apply(this,arguments),this.FDelayedLoading=!1,this.FStretchScrollBars=!0,this.FScrollUpdate=0,this.FCustomVerticalScrollBar=pas["WEBLib.TMSFNCScrollBar"].TTMSFNCScrollBar.$create("Create$1",[this]),this.FCustomVerticalScrollBar.SetParent(this),this.FCustomHorizontalScrollBar=pas["WEBLib.TMSFNCScrollBar"].TTMSFNCScrollBar.$create("Create$1",[this]),this.FCustomHorizontalScrollBar.SetParent(this),this.FVerticalScrollBar=pas["WEBLib.StdCtrls"].TScrollBar.$create("Create$1",[this]),this.FVerticalScrollBar.SetParent(this),this.FHorizontalScrollBar=pas["WEBLib.StdCtrls"].TScrollBar.$create("Create$1",[this]),this.FHorizontalScrollBar.SetParent(this),this.FCustomVerticalScrollBar.FAppearance.SetThumbButtonSize(0),this.FCustomHorizontalScrollBar.FAppearance.SetThumbButtonSize(0),this.FCustomHorizontalScrollBar.SetKind(0),this.FVerticalScrollBar.FDoubleBuffered=!1,this.FHorizontalScrollBar.FDoubleBuffered=!1,this.FVerticalScrollBar.SetKind(1),this.FVerticalScrollBar.SetVisible(!0),this.FHorizontalScrollBar.SetVisible(!0),this.FCustomVerticalScrollBar.SetVisible(!1),this.FCustomHorizontalScrollBar.SetVisible(!1),this.FVerticalScrollBar.FOnChange=rtl.createCallback(this,"VScrollChanged"),this.FHorizontalScrollBar.FOnChange=rtl.createCallback(this,"HScrollChanged"),this.FCustomHorizontalScrollBar.FOnValueChange=rtl.createCallback(this,"HCustomScrollChanged"),this.FCustomVerticalScrollBar.FOnValueChange=rtl.createCallback(this,"VCustomScrollChanged"),this.FVerticalScrollBarVisible=!0,this.FHorizontalScrollBarVisible=!0,this.FScrollMode=0,this.FColumnW=t.TTMSFNCTreeViewDoubleList.$create("Create$3",[this]),this.FColumnP=t.TTMSFNCTreeViewDoubleList.$create("Create$3",[this]),this.FDefaultRowHeight=25,this.FDefaultColumnWidth=75,this.FColumnCount=0,this.FRowCount=0,this.FVerticalScrollBarVisible=!0,this.FHorizontalScrollBarVisible=!0,this},this.Destroy=function(){rtl.free(this,"FColumnP"),rtl.free(this,"FColumnW"),rtl.free(this,"FCustomVerticalScrollBar"),rtl.free(this,"FCustomHorizontalScrollBar"),rtl.free(this,"FVerticalScrollBar"),rtl.free(this,"FHorizontalScrollBar"),pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Destroy.call(this)},this.Assign=function(e){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Assign.apply(this,arguments),t.TTMSFNCTreeViewBase.isPrototypeOf(e)&&(this.FScrollMode=rtl.as(e,t.TTMSFNCTreeViewBase).FScrollMode,this.FStretchScrollBars=rtl.as(e,t.TTMSFNCTreeViewBase).FStretchScrollBars)},this.Resize=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Resize.call(this),this.UpdateControlAfterResize()},this.BeginUpdate=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBase.BeginUpdate.call(this),this.FUpdateCount$1+=1},this.EndUpdate=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBase.EndUpdate.call(this),this.FUpdateCount$1-=1,0===this.FUpdateCount$1&&this.UpdateTreeViewCache()},this.SaveScrollPosition=function(){this.FSaveHScrollPos=this.GetHScrollValue(),this.FSaveVScrollPos=this.GetVScrollValue()},this.RestoreScrollPosition=function(){this.Scroll(this.FSaveHScrollPos,this.FSaveVScrollPos)},this.AutoSizeColumn=function(t){this.AutoSizeColumnInternal(t,!0,!0)},this.GetVerticalScrollPosition=function(){var t;return t=this.GetVScrollValue(),this.FScrollMode,t},this.GetHorizontalScrollPosition=function(){var t=0;return t=this.GetHScrollValue(),1===this.FScrollMode&&(t=this.GetColPos(Math.round(t))),t},this.HorizontalScrollBar=function(){return this.FHorizontalScrollBar},this.VerticalScrollBar=function(){return this.FVerticalScrollBar},this.CustomHorizontalScrollBar=function(){return this.FCustomHorizontalScrollBar},this.CustomVerticalScrollBar=function(){return this.FCustomVerticalScrollBar},this.StartRow=function(){return this.FStartRow},this.StartOffset=function(){return this.FStartOffset},this.StopRow=function(){return this.FStopRow},this.GetColumnWidth=function(t){return this.GetColWidths(t)},this.GetColumnPosition=function(t){return this.GetColPos(t)},this.GetTotalColumnNodeWidth=function(){return this.FTotalColumnWidth},this.GetTotalColumnWidth=function(){return this.FTotalColumnWidth},this.GetTotalRowHeight=function(){return this.FTotalRowHeight},rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas["WEBLib.TMSFNCTypes"].ITMSFNCProductInfo),rtl.addIntf(this,pas.System.IUnknown)}))}),["Math","WEBLib.TMSFNCUtils","SysUtils","WEBLib.Forms"]),rtl.module("WEBLib.TMSFNCTreeViewData",["System","Classes","WEBLib.TMSFNCTypes","WEBLib.TMSFNCGraphicsTypes","WEBLib.TMSFNCBitmapContainer","WEBLib.TMSFNCTreeViewBase","contnrs"],(function(){"use strict";var t=this;this.MAXLEVELDEPTH=100,this.MAXNODECOUNT=2e6,this.$rtti.$Class("TTMSFNCTreeViewColumn"),this.$rtti.$Class("TTMSFNCTreeViewNode"),this.TTMSFNCTreeViewNodeScrollPosition={0:"tvnspTop",tvnspTop:0,1:"tvnspBottom",tvnspBottom:1,2:"tvnspMiddle",tvnspMiddle:2},rtl.recNewT(this,"TTMSFNCTreeViewVirtualNodeRemoveData",(function(){this.RowIndex=0,this.Count=0,this.ParentNode=0,this.$eq=function(t){return this.RowIndex===t.RowIndex&&this.Count===t.Count&&this.ParentNode===t.ParentNode},this.$assign=function(t){return this.RowIndex=t.RowIndex,this.Count=t.Count,this.ParentNode=t.ParentNode,this}})),rtl.createClass(this,"TTMSFNCTreeViewVirtualNode",pas.System.TObject,(function(){this.$init=function(){pas.System.TObject.$init.call(this),this.FTreeView=null,this.FLevel=0,this.FAddedToVisibleList=!1,this.FChildren=0,this.FParentNode=0,this.FExpanded=!1,this.FTotalChildren=0,this.FIndex=0,this.FRow=0,this.FHeight=0,this.FCalculated=!1,this.FCache=null,this.FTextRects=[],this.FBitmapRects=[],this.FExpandRects=[],this.FCheckRects=[],this.FCheckStates=[],this.FNode=null,this.FExtended=!1,this.FExtraRects=[],this.FTitleRects=[],this.FTitleHeight=0,this.FTitleExtraRects=[]},this.$final=function(){this.FTreeView=void 0,this.FCache=void 0,this.FTextRects=void 0,this.FBitmapRects=void 0,this.FExpandRects=void 0,this.FCheckRects=void 0,this.FCheckStates=void 0,this.FNode=void 0,this.FExtraRects=void 0,this.FTitleRects=void 0,this.FTitleExtraRects=void 0,pas.System.TObject.$final.call(this)},this.GetText=function(t){var e="";return e="",null!=this.FTreeView&&(e=this.FTreeView.GetVirtualNodeText(this,t)),e},this.GetTitle=function(t){var e="";return e="",null!=this.FTreeView&&(e=this.FTreeView.GetVirtualNodeTitle(this,t)),e},this.GetTitleExpanded=function(t){var e=!1;return e=!0,null!=this.FTreeView&&(e=this.FTreeView.GetVirtualNodeTitleExpanded(this,t)),e},this.GetParent=function(){var t=null;return t=null,null!=this.FTreeView&&(t=this.FTreeView.GetParentVirtualNode(this)),t},this.GetNext=function(){var t=null;return t=null,null!=this.FTreeView&&(t=this.FTreeView.GetNextVirtualNode(this)),t},this.GetNextSibling=function(){var t=null;return t=null,null!=this.FTreeView&&(t=this.FTreeView.GetNextSiblingVirtualNode(this)),t},this.Expand=function(t){null!=this.FTreeView&&this.FTreeView.ExpandVirtualNode(this,t)},this.CopyFrom=function(e){null!=e&&(this.FChildren=rtl.as(e,t.TTMSFNCTreeViewVirtualNode).FChildren,this.FTotalChildren=rtl.as(e,t.TTMSFNCTreeViewVirtualNode).FTotalChildren,this.FExpanded=rtl.as(e,t.TTMSFNCTreeViewVirtualNode).FExpanded,this.FExtended=rtl.as(e,t.TTMSFNCTreeViewVirtualNode).FExtended,this.FLevel=rtl.as(e,t.TTMSFNCTreeViewVirtualNode).FLevel,this.FRow=rtl.as(e,t.TTMSFNCTreeViewVirtualNode).FRow,this.FCalculated=rtl.as(e,t.TTMSFNCTreeViewVirtualNode).FCalculated,this.FHeight=rtl.as(e,t.TTMSFNCTreeViewVirtualNode).FHeight,this.FParentNode=rtl.as(e,t.TTMSFNCTreeViewVirtualNode).FParentNode,this.FIndex=rtl.as(e,t.TTMSFNCTreeViewVirtualNode).FIndex,this.FTextRects=rtl.as(e,t.TTMSFNCTreeViewVirtualNode).FTextRects,this.FExtraRects=rtl.as(e,t.TTMSFNCTreeViewVirtualNode).FExtraRects,this.FBitmapRects=rtl.as(e,t.TTMSFNCTreeViewVirtualNode).FBitmapRects,this.FCheckRects=rtl.as(e,t.TTMSFNCTreeViewVirtualNode).FCheckRects,this.FExpandRects=rtl.as(e,t.TTMSFNCTreeViewVirtualNode).FExpandRects,this.FCheckStates=rtl.as(e,t.TTMSFNCTreeViewVirtualNode).FCheckStates,this.FNode=rtl.as(e,t.TTMSFNCTreeViewVirtualNode).FNode)},this.Create$1=function(t){return this.FTreeView=t,this},this.Destroy=function(){this.FCache=null,this.FNode=null,pas.System.TObject.Destroy.call(this)}})),this.TTMSFNCTreeViewCacheItemKind={0:"ikNode",ikNode:0,1:"ikColumnTop",ikColumnTop:1,2:"ikColumnBottom",ikColumnBottom:2,3:"ikGroupTop",ikGroupTop:3,4:"ikGroupBottom",ikGroupBottom:4},this.$rtti.$Enum("TTMSFNCTreeViewCacheItemKind",{minvalue:0,maxvalue:4,ordtype:1,enumtype:this.TTMSFNCTreeViewCacheItemKind}),rtl.createClass(this,"TTMSFNCTreeViewCacheItem",pas.System.TObject,(function(){this.$init=function(){pas.System.TObject.$init.call(this),this.FRect=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),this.FDrawRect=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),this.FKind=0,this.FGroup=0,this.FColumn=0,this.FNode=null,this.FStartColumn=0,this.FEndColumn=0},this.$final=function(){this.FRect=void 0,this.FDrawRect=void 0,this.FNode=void 0,pas.System.TObject.$final.call(this)},this.CreateNode=function(e,i){var s=null;return(s=t.TTMSFNCTreeViewCacheItem.$create("Create")).FKind=0,s.FRect.$assign(e),s.FNode=i,s},this.CreateColumnTop=function(e,i){var s=null;return(s=t.TTMSFNCTreeViewCacheItem.$create("Create")).FKind=1,s.FColumn=i,s.FRect.$assign(e),s},this.CreateGroupTop=function(e,i,s,o){var n=null;return(n=t.TTMSFNCTreeViewCacheItem.$create("Create")).FKind=3,n.FGroup=i,n.FStartColumn=s,n.FEndColumn=o,n.FRect.$assign(e),n},this.CreateColumnBottom=function(e,i){var s=null;return(s=t.TTMSFNCTreeViewCacheItem.$create("Create")).FKind=2,s.FColumn=i,s.FRect.$assign(e),s},this.CreateGroupBottom=function(e,i,s,o){var n=null;return(n=t.TTMSFNCTreeViewCacheItem.$create("Create")).FKind=4,n.FGroup=i,n.FStartColumn=s,n.FEndColumn=o,n.FRect.$assign(e),n},this.Destroy=function(){this.FNode=null,pas.System.TObject.Destroy.call(this)}})),rtl.createClass(this,"TTMSFNCTreeViewIntegerList",pas.Classes.TList,(function(){})),this.TTMSFNCTreeViewColumnEditorType={0:"tcetEdit",tcetEdit:0,1:"tcetComboBox",tcetComboBox:1,2:"tcetMemo",tcetMemo:2,3:"tcetNone",tcetNone:3},this.$rtti.$Enum("TTMSFNCTreeViewColumnEditorType",{minvalue:0,maxvalue:3,ordtype:1,enumtype:this.TTMSFNCTreeViewColumnEditorType}),this.TTMSFNCTreeViewNodesSortMode={0:"nsmAscending",nsmAscending:0,1:"nsmDescending",nsmDescending:1},this.$rtti.$Enum("TTMSFNCTreeViewNodesSortMode",{minvalue:0,maxvalue:1,ordtype:1,enumtype:this.TTMSFNCTreeViewNodesSortMode}),this.TTMSFNCTreeViewNodesSortKind={0:"nskNone",nskNone:0,1:"nskAscending",nskAscending:1,2:"nskDescending",nskDescending:2},this.$rtti.$Enum("TTMSFNCTreeViewNodesSortKind",{minvalue:0,maxvalue:2,ordtype:1,enumtype:this.TTMSFNCTreeViewNodesSortKind}),this.TTMSFNCTreeViewColumnSorting={0:"tcsNone",tcsNone:0,1:"tcsNormal",tcsNormal:1,2:"tcsRecursive",tcsRecursive:2,3:"tcsNormalCaseSensitive",tcsNormalCaseSensitive:3,4:"tcsRecursiveCaseSensitive",tcsRecursiveCaseSensitive:4},this.$rtti.$Enum("TTMSFNCTreeViewColumnSorting",{minvalue:0,maxvalue:4,ordtype:1,enumtype:this.TTMSFNCTreeViewColumnSorting}),rtl.createClass(this,"TTMSFNCTreeViewColumnFiltering",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FColumn=null,this.FEnabled=!1,this.FMultiColumn=!1,this.FDropDownHeight=0,this.FDropDownWidth=0,this.FButtonSize=0},this.$final=function(){this.FColumn=void 0,pas.Classes.TPersistent.$final.call(this)},this.SetEnabled=function(t){this.FEnabled!==t&&(this.FEnabled=t,null!=this.FColumn&&this.FColumn.UpdateColumn())},this.IsButtonSizeStored=function(){return 15!==this.FButtonSize},this.SetButtonSize=function(t){this.FButtonSize!==t&&(this.FButtonSize=t,null!=this.FColumn&&this.FColumn.UpdateColumn())},this.Create$1=function(t){return this.FColumn=t,this.FEnabled=!1,this.FDropDownWidth=100,this.FDropDownHeight=120,this.FMultiColumn=!1,this.FButtonSize=15,this},this.Destroy=function(){pas.System.TObject.Destroy.call(this)},this.Assign=function(e){t.TTMSFNCTreeViewColumnFiltering.isPrototypeOf(e)&&(this.FEnabled=rtl.as(e,t.TTMSFNCTreeViewColumnFiltering).FEnabled,this.FDropDownWidth=rtl.as(e,t.TTMSFNCTreeViewColumnFiltering).FDropDownWidth,this.FDropDownHeight=rtl.as(e,t.TTMSFNCTreeViewColumnFiltering).FDropDownHeight,this.FMultiColumn=rtl.as(e,t.TTMSFNCTreeViewColumnFiltering).FMultiColumn,this.FButtonSize=rtl.as(e,t.TTMSFNCTreeViewColumnFiltering).FButtonSize)};var e=this.$rtti;e.addProperty("Enabled",2,rtl.boolean,"FEnabled","SetEnabled",{Default:!1}),e.addProperty("DropDownWidth",0,rtl.longint,"FDropDownWidth","FDropDownWidth",{Default:100}),e.addProperty("DropDownHeight",0,rtl.longint,"FDropDownHeight","FDropDownHeight",{Default:120}),e.addProperty("MultiColumn",0,rtl.boolean,"FMultiColumn","FMultiColumn",{Default:!1}),e.addProperty("ButtonSize",14,rtl.double,"FButtonSize","SetButtonSize",{stored:"IsButtonSizeStored"})})),this.TTMSFNCTreeViewFilterOperation={0:"tfoSHORT",tfoSHORT:0,1:"tfoNONE",tfoNONE:1,2:"tfoAND",tfoAND:2,3:"tfoXOR",tfoXOR:3,4:"tfoOR",tfoOR:4},this.$rtti.$Enum("TTMSFNCTreeViewFilterOperation",{minvalue:0,maxvalue:4,ordtype:1,enumtype:this.TTMSFNCTreeViewFilterOperation}),rtl.createClass(this,"TTMSFNCTreeViewFilterData",pas.Classes.TCollectionItem,(function(){this.$init=function(){pas.Classes.TCollectionItem.$init.call(this),this.FColumn=0,this.FCondition="",this.FCaseSensitive=!1,this.FSuffix="",this.FPrefix="",this.FOperation=0},this.Create$1=function(t){return pas.Classes.TCollectionItem.Create$1.apply(this,arguments),this.FCaseSensitive=!0,this},this.Assign=function(e){var i;null!=(i=rtl.as(e,t.TTMSFNCTreeViewFilterData))&&(this.FColumn=i.FColumn,this.FCondition=i.FCondition,this.FCaseSensitive=i.FCaseSensitive,this.FPrefix=i.FPrefix,this.FSuffix=i.FSuffix,this.FOperation=i.FOperation)};var e=this.$rtti;e.addProperty("Column",0,rtl.smallint,"FColumn","FColumn"),e.addProperty("Condition",0,rtl.string,"FCondition","FCondition"),e.addProperty("CaseSensitive",0,rtl.boolean,"FCaseSensitive","FCaseSensitive",{Default:!0}),e.addProperty("Prefix",0,rtl.string,"FPrefix","FPrefix"),e.addProperty("Suffix",0,rtl.string,"FSuffix","FSuffix"),e.addProperty("Operation",0,t.$rtti.TTMSFNCTreeViewFilterOperation,"FOperation","FOperation")})),rtl.createClass(this,"TTMSFNCTreeViewFilter",pas["WEBLib.TMSFNCTypes"].TTMSFNCOwnedCollection,(function(){this.$init=function(){pas["WEBLib.TMSFNCTypes"].TTMSFNCOwnedCollection.$init.call(this),this.FOwner$1=null},this.$final=function(){this.FOwner$1=void 0,pas["WEBLib.TMSFNCTypes"].TTMSFNCOwnedCollection.$final.call(this)},this.GetItem$1=function(t){return pas.Classes.TCollection.GetItem.call(this,t)},this.Create$3=function(e){return pas.Classes.TOwnedCollection.Create$2.call(this,e,t.TTMSFNCTreeViewFilterData),this.FOwner$1=e,this},this.Add$1=function(){var t=null;return t=pas.Classes.TCollection.Add.call(this),1===this.GetCount()?t.FOperation=1:t.FOperation=2,t}})),rtl.createClass(this,"TTMSFNCTreeViewColumn",pas.Classes.TCollectionItem,(function(){this.$init=function(){pas.Classes.TCollectionItem.$init.call(this),this.FSortKind=0,this.FTag=0,this.FTreeView=null,this.FText="",this.FName="",this.FWordWrapping=!1,this.FVerticalTextAlign=0,this.FTrimming=0,this.FHorizontalTextAlign=0,this.FWidth=0,this.FVisible=!1,this.FUseDefaultAppearance=!1,this.FBottomFill=null,this.FBottomStroke=null,this.FTopFill=null,this.FTopStroke=null,this.FTopFont=null,this.FBottomFont=null,this.FFont=null,this.FFill=null,this.FStroke=null,this.FEditorType=0,this.FDisabledFontColor=0,this.FSelectedFontColor=0,this.FEditorItems=null,this.FCustomEditor=!1,this.FSorting=0,this.FSortIndex=0,this.FFiltering=null,this.FTitleTrimming=0,this.FTitleHorizontalTextAlign=0,this.FTitleWordWrapping=!1,this.FTitleVerticalTextAlign=0,this.FDisabledTitleFontColor=0,this.FSelectedTitleFontColor=0,this.FTitleFont=null,this.FExpanded=!1,this.FExpandable=!1,this.FExpandingButtonSize=0,this.FHTMLTemplate=""},this.$final=function(){this.FTreeView=void 0,this.FBottomFill=void 0,this.FBottomStroke=void 0,this.FTopFill=void 0,this.FTopStroke=void 0,this.FTopFont=void 0,this.FBottomFont=void 0,this.FFont=void 0,this.FFill=void 0,this.FStroke=void 0,this.FEditorItems=void 0,this.FFiltering=void 0,this.FTitleFont=void 0,pas.Classes.TCollectionItem.$final.call(this)},this.SetText=function(t){this.FText!==t&&(this.FText=t,this.UpdateColumn())},this.SetName=function(t){this.FName!==t&&(this.FName=t)},this.SetHorizontalTextAlign=function(t){this.FHorizontalTextAlign!==t&&(this.FHorizontalTextAlign=t,this.UpdateColumn())},this.SetTrimming=function(t){this.FTrimming!==t&&(this.FTrimming=t,this.UpdateColumn())},this.SetVerticalTextAlign=function(t){this.FVerticalTextAlign!==t&&(this.FVerticalTextAlign=t,this.UpdateColumn())},this.SetWordWrapping=function(t){this.FWordWrapping!==t&&(this.FWordWrapping=t,this.UpdateColumn())},this.SetWidth=function(t){this.FWidth!==t&&(this.FWidth=t,this.UpdateColumn())},this.SetVisible=function(t){this.FVisible!==t&&(this.FVisible=t,this.UpdateColumn())},this.SetUseDefaultAppearance=function(t){this.FUseDefaultAppearance!==t&&(this.FUseDefaultAppearance=t,this.UpdateColumn())},this.SetBottomFill=function(t){this.FBottomFill!==t&&this.FBottomFill.Assign(t)},this.SetBottomStroke=function(t){this.FBottomStroke!==t&&this.FBottomStroke.Assign(t)},this.SetTopFill=function(t){this.FTopFill!==t&&this.FTopFill.Assign(t)},this.SetTopStroke=function(t){this.FTopStroke!==t&&this.FTopStroke.Assign(t)},this.SetBottomFont=function(t){this.FBottomFont!==t&&this.FBottomFont.Assign(t)},this.SetTopFont=function(t){this.FTopFont!==t&&this.FTopFont.Assign(t)},this.SetFill=function(t){this.FFill!==t&&this.FFill.Assign(t)},this.SetFont=function(t){this.FFont!==t&&this.FFont.Assign(t)},this.SetStroke=function(t){this.FStroke!==t&&this.FStroke.Assign(t)},this.SetEditorType=function(t){this.FEditorType!==t&&(this.FEditorType=t)},this.SetDisabledFontColor=function(t){this.FDisabledFontColor!==t&&(this.FDisabledFontColor=t,this.Changed$1(this))},this.SetSelectedFontColor=function(t){this.FSelectedFontColor!==t&&(this.FSelectedFontColor=t,this.Changed$1(this))},this.SetEditorItems=function(t){this.FEditorItems.Assign(t)},this.SetSorting=function(t){this.FSorting!==t&&(this.FSorting=t,this.Changed$1(this))},this.SetSortKind=function(t){this.FSortKind!==t&&(this.FSortKind=t,this.Changed$1(this))},this.SetFiltering=function(t){this.FFiltering!==t&&this.FFiltering.Assign(t)},this.SetHTMLTemplate=function(t){this.FHTMLTemplate!==t&&(this.FHTMLTemplate=t,null!=this.FTreeView&&this.FTreeView.UpdateTreeView())},this.UpdateColumn=function(){var t=null;null!=(t=this.TreeView())&&(t.UpdateColumns(),t.UpdateTreeViewCache())},this.Changed$1=function(t){this.UpdateColumn()},this.TreeView=function(){return this.FTreeView},this.Create$1=function(e){return pas.Classes.TCollectionItem.Create$1.apply(this,arguments),null!=this.FCollection&&(this.FTreeView=rtl.as(this.FCollection,t.TTMSFNCTreeViewColumns).TreeView()),this.FSorting=0,this.FExpandingButtonSize=15,this.FExpanded=!0,this.FSortIndex=-1,this.FSortKind=0,this.FFiltering=t.TTMSFNCTreeViewColumnFiltering.$create("Create$1",[this]),this.FEditorType=3,this.FWordWrapping=!1,this.FTrimming=0,this.FCustomEditor=!1,this.FHorizontalTextAlign=1,this.FVerticalTextAlign=0,this.FTitleWordWrapping=!1,this.FTitleTrimming=0,this.FTitleHorizontalTextAlign=1,this.FTitleVerticalTextAlign=0,this.FEditorItems=pas.Classes.TStringList.$create("Create$1"),null!=this.FCollection&&(this.FText=t.TranslateTextEx(rtl.getResStr(t,"sTMSFNCTreeViewColumn"))+" "+pas.SysUtils.IntToStr(this.FCollection.GetCount()-1)),this.FName=pas.SysUtils.StringReplace(this.FText," ","",rtl.createSet(0)),this.FWidth=100,this.FVisible=!0,this.FUseDefaultAppearance=!0,this.FBottomFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[0,16777215,8421504,-1,-1]),this.FBottomStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,11119017]),this.FTopFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[0,16777215,8421504,-1,-1]),this.FTopStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,11119017]),this.FFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[1,-1,8421504,-1,-1]),this.FStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,11119017]),this.FSelectedFontColor=16777215,this.FDisabledFontColor=12632256,this.FSelectedTitleFontColor=16777215,this.FDisabledTitleFontColor=12632256,this.FFont=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFont.$create("Create$2"),this.FTitleFont=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFont.$create("Create$2"),this.FTopFont=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFont.$create("Create$2"),this.FBottomFont=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFont.$create("Create$2"),this.FBottomFill.FOnChanged=rtl.createCallback(this,"Changed$1"),this.FTopFill.FOnChanged=rtl.createCallback(this,"Changed$1"),this.FBottomStroke.FOnChanged=rtl.createCallback(this,"Changed$1"),this.FTopStroke.FOnChanged=rtl.createCallback(this,"Changed$1"),this.FStroke.FOnChanged=rtl.createCallback(this,"Changed$1"),this.FFill.FOnChanged=rtl.createCallback(this,"Changed$1"),this.FFont.FOnChanged=rtl.createCallback(this,"Changed$1"),this.FTitleFont.FOnChanged=rtl.createCallback(this,"Changed$1"),this.FTopFont.FOnChanged=rtl.createCallback(this,"Changed$1"),this.FBottomFont.FOnChanged=rtl.createCallback(this,"Changed$1"),this.UpdateColumn(),this},this.Destroy=function(){rtl.free(this,"FFiltering"),rtl.free(this,"FEditorItems"),rtl.free(this,"FTopFill"),rtl.free(this,"FTopStroke"),rtl.free(this,"FTopFont"),rtl.free(this,"FBottomFill"),rtl.free(this,"FBottomStroke"),rtl.free(this,"FBottomFont"),rtl.free(this,"FFill"),rtl.free(this,"FStroke"),rtl.free(this,"FFont"),rtl.free(this,"FTitleFont"),pas.Classes.TCollectionItem.Destroy.call(this),this.UpdateColumn()},this.Assign=function(e){t.TTMSFNCTreeViewColumn.isPrototypeOf(e)&&(this.FTag=rtl.as(e,t.TTMSFNCTreeViewColumn).FTag,this.FText=rtl.as(e,t.TTMSFNCTreeViewColumn).FText,this.FName=rtl.as(e,t.TTMSFNCTreeViewColumn).FName,this.FTrimming=rtl.as(e,t.TTMSFNCTreeViewColumn).FTrimming,this.FWordWrapping=rtl.as(e,t.TTMSFNCTreeViewColumn).FWordWrapping,this.FHorizontalTextAlign=rtl.as(e,t.TTMSFNCTreeViewColumn).FHorizontalTextAlign,this.FVerticalTextAlign=rtl.as(e,t.TTMSFNCTreeViewColumn).FVerticalTextAlign,this.FTitleTrimming=rtl.as(e,t.TTMSFNCTreeViewColumn).FTitleTrimming,this.FTitleWordWrapping=rtl.as(e,t.TTMSFNCTreeViewColumn).FTitleWordWrapping,this.FTitleHorizontalTextAlign=rtl.as(e,t.TTMSFNCTreeViewColumn).FTitleHorizontalTextAlign,this.FTitleVerticalTextAlign=rtl.as(e,t.TTMSFNCTreeViewColumn).FTitleVerticalTextAlign,this.FWidth=rtl.as(e,t.TTMSFNCTreeViewColumn).FWidth,this.FVisible=rtl.as(e,t.TTMSFNCTreeViewColumn).FVisible,this.FUseDefaultAppearance=rtl.as(e,t.TTMSFNCTreeViewColumn).FUseDefaultAppearance,this.FFill.Assign(rtl.as(e,t.TTMSFNCTreeViewColumn).FFill),this.FDisabledFontColor=rtl.as(e,t.TTMSFNCTreeViewColumn).FDisabledFontColor,this.FSelectedFontColor=rtl.as(e,t.TTMSFNCTreeViewColumn).FSelectedFontColor,this.FDisabledTitleFontColor=rtl.as(e,t.TTMSFNCTreeViewColumn).FDisabledTitleFontColor,this.FSelectedTitleFontColor=rtl.as(e,t.TTMSFNCTreeViewColumn).FSelectedTitleFontColor,this.FTitleFont.Assign(rtl.as(e,t.TTMSFNCTreeViewColumn).FTitleFont),this.FFont.Assign(rtl.as(e,t.TTMSFNCTreeViewColumn).FFont),this.FStroke.Assign(rtl.as(e,t.TTMSFNCTreeViewColumn).FStroke),this.FBottomFill.Assign(rtl.as(e,t.TTMSFNCTreeViewColumn).FBottomFill),this.FBottomFont.Assign(rtl.as(e,t.TTMSFNCTreeViewColumn).FBottomFont),this.FBottomStroke.Assign(rtl.as(e,t.TTMSFNCTreeViewColumn).FBottomStroke),this.FTopFill.Assign(rtl.as(e,t.TTMSFNCTreeViewColumn).FTopFill),this.FTopStroke.Assign(rtl.as(e,t.TTMSFNCTreeViewColumn).FTopStroke),this.FTopFont.Assign(rtl.as(e,t.TTMSFNCTreeViewColumn).FTopFont),this.FEditorType=rtl.as(e,t.TTMSFNCTreeViewColumn).FEditorType,this.FEditorItems.Assign(rtl.as(e,t.TTMSFNCTreeViewColumn).FEditorItems),this.FCustomEditor=rtl.as(e,t.TTMSFNCTreeViewColumn).FCustomEditor,this.FSorting=rtl.as(e,t.TTMSFNCTreeViewColumn).FSorting,this.FFiltering.Assign(rtl.as(e,t.TTMSFNCTreeViewColumn).FFiltering),this.FExpandingButtonSize=rtl.as(e,t.TTMSFNCTreeViewColumn).FExpandingButtonSize,this.FHTMLTemplate=rtl.as(e,t.TTMSFNCTreeViewColumn).FHTMLTemplate)},this.UpdateWidth=function(t){this.FWidth=t},this.Sort=function(t,e,i){var s=null;null!=(s=this.TreeView())&&s.FNodes.Sort$1(this.GetIndex(),t,e,i,!0)};var e=this.$rtti;e.addProperty("EditorType",2,t.$rtti.TTMSFNCTreeViewColumnEditorType,"FEditorType","SetEditorType",{Default:t.TTMSFNCTreeViewColumnEditorType.tcetNone}),e.addProperty("EditorItems",2,pas.Classes.$rtti.TStringList,"FEditorItems","SetEditorItems"),e.addProperty("CustomEditor",0,rtl.boolean,"FCustomEditor","FCustomEditor",{Default:!1}),e.addProperty("Name",2,rtl.string,"FName","SetName"),e.addProperty("Text",2,rtl.string,"FText","SetText"),e.addProperty("Tag",0,rtl.nativeint,"FTag","FTag",{Default:0}),e.addProperty("HorizontalTextAlign",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsTextAlign,"FHorizontalTextAlign","SetHorizontalTextAlign",{Default:pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsTextAlign.gtaLeading}),e.addProperty("VerticalTextAlign",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsTextAlign,"FVerticalTextAlign","SetVerticalTextAlign",{Default:pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsTextAlign.gtaCenter}),e.addProperty("WordWrapping",2,rtl.boolean,"FWordWrapping","SetWordWrapping",{Default:!1}),e.addProperty("Trimming",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsTextTrimming,"FTrimming","SetTrimming",{Default:pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsTextTrimming.gttNone}),e.addProperty("Width",2,rtl.double,"FWidth","SetWidth"),e.addProperty("Visible",2,rtl.boolean,"FVisible","SetVisible",{Default:!0}),e.addProperty("UseDefaultAppearance",2,rtl.boolean,"FUseDefaultAppearance","SetUseDefaultAppearance",{Default:!0}),e.addProperty("Fill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FFill","SetFill"),e.addProperty("Stroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FStroke","SetStroke"),e.addProperty("Font",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFont,"FFont","SetFont"),e.addProperty("SelectedFontColor",2,pas["WEBLib.Graphics"].$rtti.TColor,"FSelectedFontColor","SetSelectedFontColor",{Default:16777215}),e.addProperty("DisabledFontColor",2,pas["WEBLib.Graphics"].$rtti.TColor,"FDisabledFontColor","SetDisabledFontColor",{Default:12632256}),e.addProperty("TopFill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FTopFill","SetTopFill"),e.addProperty("TopStroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FTopStroke","SetTopStroke"),e.addProperty("TopFont",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFont,"FTopFont","SetTopFont"),e.addProperty("BottomFill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FBottomFill","SetBottomFill"),e.addProperty("BottomStroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FBottomStroke","SetBottomStroke"),e.addProperty("BottomFont",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFont,"FBottomFont","SetBottomFont"),e.addProperty("Sorting",2,t.$rtti.TTMSFNCTreeViewColumnSorting,"FSorting","SetSorting",{Default:t.TTMSFNCTreeViewColumnSorting.tcsNone}),e.addProperty("Filtering",2,t.$rtti.TTMSFNCTreeViewColumnFiltering,"FFiltering","SetFiltering"),e.addProperty("HTMLTemplate",2,rtl.string,"FHTMLTemplate","SetHTMLTemplate")})),rtl.createClass(this,"TTMSFNCTreeViewColumns",pas["WEBLib.TMSFNCTypes"].TTMSFNCOwnedCollection,(function(){this.$init=function(){pas["WEBLib.TMSFNCTypes"].TTMSFNCOwnedCollection.$init.call(this),this.FTreeView=null},this.$final=function(){this.FTreeView=void 0,pas["WEBLib.TMSFNCTypes"].TTMSFNCOwnedCollection.$final.call(this)},this.GetItem$1=function(t){return this.GetItem(t)},this.GetItemClass=function(){return t.TTMSFNCTreeViewColumn},this.TreeView=function(){return this.FTreeView},this.Create$3=function(t){return pas.Classes.TOwnedCollection.Create$2.call(this,t,this.GetItemClass()),this.FTreeView=t,this},this.Add$1=function(){return pas.Classes.TCollection.Add.call(this)}})),this.$rtti.$Class("TTMSFNCTreeViewNodes"),this.TTMSFNCTreeViewNodeCheckType={0:"tvntNone",tvntNone:0,1:"tvntCheckBox",tvntCheckBox:1,2:"tvntRadioButton",tvntRadioButton:2},this.$rtti.$Enum("TTMSFNCTreeViewNodeCheckType",{minvalue:0,maxvalue:2,ordtype:1,enumtype:this.TTMSFNCTreeViewNodeCheckType}),rtl.createClass(this,"TTMSFNCTreeViewNodeValue",pas.Classes.TCollectionItem,(function(){this.$init=function(){pas.Classes.TCollectionItem.$init.call(this),this.FTag=0,this.FDataString="",this.FDataObject=null,this.FDataInteger=0,this.FTreeView=null,this.FNode=null,this.FText="",this.FDBKey="",this.FDataBoolean=!1,this.FCheckType=0,this.FChecked=!1,this.FCollapsedIcon=null,this.FCollapsedIconLarge=null,this.FExpandedIcon=null,this.FExpandedIconLarge=null,this.FCollapsedIconName="",this.FCollapsedIconLargeName="",this.FExpandedIconName="",this.FExpandedIconLargeName="",this.FDataPointer=null,this.FTitle="",this.FTitleExpanded=!1,this.FHTMLTemplateItems=null},this.$final=function(){this.FDataObject=void 0,this.FTreeView=void 0,this.FNode=void 0,this.FCollapsedIcon=void 0,this.FCollapsedIconLarge=void 0,this.FExpandedIcon=void 0,this.FExpandedIconLarge=void 0,this.FHTMLTemplateItems=void 0,pas.Classes.TCollectionItem.$final.call(this)},this.SetText=function(t){this.FText!==t&&(this.FText=t,this.UpdateNodeValue())},this.UpdateNodeValue=function(){var t,e=null;e=this.TreeView(),t=this.Node(),null!=e&&null!=t&&e.UpdateNode(t.FVirtualNode)},this.SetChecked=function(t){var e=[],i=0,s=!1,o=null,n=null;if(this.FChecked!==t){if(this.FChecked=t,o=this.TreeView(),n=this.Node(),null!=o&&null!=n&&null!=n.FVirtualNode){e=rtl.arraySetLength(e,!1,0);for(var r=0,a=o.FColumnCount-1;r<=a;r++)i=r,s=!1,this.TreeView().DoIsNodeChecked(this.Node().FVirtualNode,i,{get:function(){return s},set:function(t){s=t}}),(e=rtl.arraySetLength(e,!1,rtl.length(e)+1))[rtl.length(e)-1]=s;this.TreeView().UpdateNodeCheckStates(this.Node().FVirtualNode,rtl.arrayRef(e))}this.UpdateNodeValue()}},this.SetCheckType=function(t){this.FCheckType!==t&&(this.FCheckType=t,this.UpdateNodeValue())},this.SetCollapsedIconLarge=function(t){this.FCollapsedIconLarge!==t&&(this.FCollapsedIconLarge.Assign(t),this.UpdateNodeValue())},this.SetCollapsedIcon=function(t){this.FCollapsedIcon!==t&&(this.FCollapsedIcon.Assign(t),this.UpdateNodeValue())},this.SetExpandedIconLarge=function(t){this.FExpandedIconLarge!==t&&(this.FExpandedIconLarge.Assign(t),this.UpdateNodeValue())},this.SetExpandedIcon=function(t){this.FExpandedIcon!==t&&(this.FExpandedIcon.Assign(t),this.UpdateNodeValue())},this.SetCollapsedIconLargeName=function(t){this.FCollapsedIconLargeName!==t&&(this.FCollapsedIconLargeName=t,this.UpdateNodeValue())},this.SetCollapsedIconName=function(t){this.FCollapsedIconName!==t&&(this.FCollapsedIconName=t,this.UpdateNodeValue())},this.SetExpandedIconLargeName=function(t){this.FExpandedIconLargeName!==t&&(this.FExpandedIconLargeName=t,this.UpdateNodeValue())},this.SetExpandedIconName=function(t){this.FExpandedIconName!==t&&(this.FExpandedIconName=t,this.UpdateNodeValue())},this.SetHTMLTemplateItems=function(t){this.FHTMLTemplateItems!==t&&(this.FHTMLTemplateItems.Assign(t),this.UpdateNodeValue())},this.BitmapChanged=function(t){this.UpdateNodeValue()},this.TemplateItemsChanged=function(t){this.UpdateNodeValue()},this.TreeView=function(){return this.FTreeView},this.Node=function(){return this.FNode},this.GetText=function(){var t="",e="";return e=this.FText,null!=this.FTreeView&&(t=this.FTreeView.GetHTMLTemplate(this.GetIndex()),this.FTreeView.DoGetHTMLTemplate(this,this.GetIndex(),{get:function(){return t},set:function(e){t=e}}),""!==t&&(e=this.FTreeView.HTMLReplace(t,this))),e},this.Create$1=function(e){return pas.Classes.TCollectionItem.Create$1.apply(this,arguments),null!=this.FCollection&&(this.FTreeView=rtl.as(this.FCollection,t.TTMSFNCTreeViewNodeValues).TreeView(),this.FNode=rtl.as(this.FCollection,t.TTMSFNCTreeViewNodeValues).Node()),this.FChecked=!1,this.FTitleExpanded=!0,this.FCheckType=0,this.FCollapsedIcon=pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.$create("Create$3"),this.FCollapsedIcon.FOnChange=rtl.createCallback(this,"BitmapChanged"),this.FExpandedIcon=pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.$create("Create$3"),this.FExpandedIcon.FOnChange=rtl.createCallback(this,"BitmapChanged"),this.FCollapsedIconLarge=pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.$create("Create$3"),this.FCollapsedIconLarge.FOnChange=rtl.createCallback(this,"BitmapChanged"),this.FExpandedIconLarge=pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.$create("Create$3"),this.FExpandedIconLarge.FOnChange=rtl.createCallback(this,"BitmapChanged"),this.FHTMLTemplateItems=pas.Classes.TStringList.$create("Create$1"),this.FHTMLTemplateItems.FOnChange=rtl.createCallback(this,"TemplateItemsChanged"),this.UpdateNodeValue(),this},this.Destroy=function(){rtl.free(this,"FHTMLTemplateItems"),rtl.free(this,"FCollapsedIcon"),rtl.free(this,"FCollapsedIconLarge"),rtl.free(this,"FExpandedIcon"),rtl.free(this,"FExpandedIconLarge"),pas.Classes.TCollectionItem.Destroy.call(this),this.UpdateNodeValue()},this.Assign=function(e){t.TTMSFNCTreeViewNodeValue.isPrototypeOf(e)&&(this.FTag=rtl.as(e,t.TTMSFNCTreeViewNodeValue).FTag,this.FText=rtl.as(e,t.TTMSFNCTreeViewNodeValue).FText,this.FTitleExpanded=rtl.as(e,t.TTMSFNCTreeViewNodeValue).FTitleExpanded,this.FTitle=rtl.as(e,t.TTMSFNCTreeViewNodeValue).FTitle,this.FCheckType=rtl.as(e,t.TTMSFNCTreeViewNodeValue).FCheckType,this.FChecked=rtl.as(e,t.TTMSFNCTreeViewNodeValue).FChecked,this.FCollapsedIcon.Assign(rtl.as(e,t.TTMSFNCTreeViewNodeValue).FCollapsedIcon),this.FCollapsedIconLarge.Assign(rtl.as(e,t.TTMSFNCTreeViewNodeValue).FCollapsedIconLarge),this.FExpandedIcon.Assign(rtl.as(e,t.TTMSFNCTreeViewNodeValue).FExpandedIcon),this.FExpandedIconLarge.Assign(rtl.as(e,t.TTMSFNCTreeViewNodeValue).FExpandedIconLarge),this.FCollapsedIconName=rtl.as(e,t.TTMSFNCTreeViewNodeValue).FCollapsedIconName,this.FCollapsedIconLargeName=rtl.as(e,t.TTMSFNCTreeViewNodeValue).FCollapsedIconLargeName,this.FExpandedIconName=rtl.as(e,t.TTMSFNCTreeViewNodeValue).FExpandedIconName,this.FExpandedIconLargeName=rtl.as(e,t.TTMSFNCTreeViewNodeValue).FExpandedIconLargeName,this.FHTMLTemplateItems.Assign(rtl.as(e,t.TTMSFNCTreeViewNodeValue).FHTMLTemplateItems),this.AssignData(e))},this.AssignData=function(e){t.TTMSFNCTreeViewNodeValue.isPrototypeOf(e)&&(this.FDataString=rtl.as(e,t.TTMSFNCTreeViewNodeValue).FDataString,this.FDataPointer=rtl.as(e,t.TTMSFNCTreeViewNodeValue).FDataPointer,this.FDataBoolean=rtl.as(e,t.TTMSFNCTreeViewNodeValue).FDataBoolean,this.FDataObject=rtl.as(e,t.TTMSFNCTreeViewNodeValue).FDataObject,this.FDataInteger=rtl.as(e,t.TTMSFNCTreeViewNodeValue).FDataInteger,this.FDBKey=rtl.as(e,t.TTMSFNCTreeViewNodeValue).FDBKey)};var e=this.$rtti;e.addProperty("Tag",0,rtl.nativeint,"FTag","FTag",{Default:0}),e.addProperty("Text",2,rtl.string,"FText","SetText"),e.addProperty("CollapsedIconName",2,rtl.string,"FCollapsedIconName","SetCollapsedIconName"),e.addProperty("CollapsedIconLargeName",2,rtl.string,"FCollapsedIconLargeName","SetCollapsedIconLargeName"),e.addProperty("ExpandedIconName",2,rtl.string,"FExpandedIconName","SetExpandedIconName"),e.addProperty("ExpandedIconLargeName",2,rtl.string,"FExpandedIconLargeName","SetExpandedIconLargeName"),e.addProperty("CollapsedIcon",2,pas["WEBLib.TMSFNCTypes"].$rtti.TTMSFNCBitmap,"FCollapsedIcon","SetCollapsedIcon"),e.addProperty("CollapsedIconLarge",2,pas["WEBLib.TMSFNCTypes"].$rtti.TTMSFNCBitmap,"FCollapsedIconLarge","SetCollapsedIconLarge"),e.addProperty("ExpandedIcon",2,pas["WEBLib.TMSFNCTypes"].$rtti.TTMSFNCBitmap,"FExpandedIcon","SetExpandedIcon"),e.addProperty("ExpandedIconLarge",2,pas["WEBLib.TMSFNCTypes"].$rtti.TTMSFNCBitmap,"FExpandedIconLarge","SetExpandedIconLarge"),e.addProperty("Checked",2,rtl.boolean,"FChecked","SetChecked",{Default:!1}),e.addProperty("CheckType",2,t.$rtti.TTMSFNCTreeViewNodeCheckType,"FCheckType","SetCheckType",{Default:t.TTMSFNCTreeViewNodeCheckType.tvntNone}),e.addProperty("HTMLTemplateItems",2,pas.Classes.$rtti.TStringList,"FHTMLTemplateItems","SetHTMLTemplateItems")})),rtl.createClass(this,"TTMSFNCTreeViewNodeValues",pas["WEBLib.TMSFNCTypes"].TTMSFNCOwnedCollection,(function(){this.$init=function(){pas["WEBLib.TMSFNCTypes"].TTMSFNCOwnedCollection.$init.call(this),this.FTreeView=null,this.FNode=null},this.$final=function(){this.FTreeView=void 0,this.FNode=void 0,pas["WEBLib.TMSFNCTypes"].TTMSFNCOwnedCollection.$final.call(this)},this.GetItem$1=function(t){return this.GetItem(t)},this.GetItemClass=function(){return t.TTMSFNCTreeViewNodeValue},this.TreeView=function(){return this.FTreeView},this.Node=function(){return this.FNode},this.UpdateChecked=function(t,e){null!=this.FTreeView&&(this.FTreeView.FUpdateCount$1=this.FTreeView.FUpdateCount$1+1),this.GetItem$1(t).SetChecked(e),null!=this.FTreeView&&(this.FTreeView.FUpdateCount$1=this.FTreeView.FUpdateCount$1-1)},this.Create$3=function(t,e){return pas.Classes.TOwnedCollection.Create$2.call(this,t,this.GetItemClass()),this.FTreeView=t,this.FNode=e,this},this.Add$1=function(){return pas.Classes.TCollection.Add.call(this)}})),rtl.createClass(this,"TTMSFNCTreeViewNode",pas.Classes.TCollectionItem,(function(){this.$init=function(){pas.Classes.TCollectionItem.$init.call(this),this.FTag=0,this.FDataString="",this.FDataObject=null,this.FDataInteger=0,this.FTreeView=null,this.FValues=null,this.FDBKey="",this.FDataBoolean=!1,this.FNodes=null,this.FVirtualNode=null,this.FExpanded=!1,this.FEnabled=!1,this.FExtended=!1,this.FDataPointer=null},this.$final=function(){this.FDataObject=void 0,this.FTreeView=void 0,this.FValues=void 0,this.FNodes=void 0,this.FVirtualNode=void 0,pas.Classes.TCollectionItem.$final.call(this)},this.SetValues=function(t){this.FValues!==t&&(this.FValues.Assign(t),this.UpdateNode())},this.SetNodes=function(t){this.FNodes!==t&&(this.FNodes.Assign(t),this.UpdateNode())},this.SetExpanded=function(t){this.FExpanded!==t&&(this.FExpanded=t,null!=this.FTreeView&&this.FTreeView.ToggleNode(this))},this.SetEnabled=function(t){this.FEnabled!==t&&(this.FEnabled=t,this.UpdateNode())},this.SetExtended=function(t){this.FExtended!==t&&(this.FExtended=t,this.UpdateNode())},this.GetChecked=function(t){var e,i=!1;return i=!1,null!=(e=this.GetValueForColumn(t))&&(i=e.FChecked),i},this.SetChecked=function(t,e){var i=null;null!=(i=this.GetValueForColumn(t))&&i.SetChecked(e)},this.GetCheckType=function(t){var e,i=0;return i=0,null!=(e=this.GetValueForColumn(t))&&(i=e.FCheckType),i},this.GetCollapsedIcon=function(t,e){var i,s=null;return s=null,null!=(i=this.GetValueForColumn(t))&&(s=e?i.FCollapsedIconLarge:i.FCollapsedIcon),s},this.GetCollapsedIconName=function(t,e){var i,s="";return s="",null!=(i=this.GetValueForColumn(t))&&(s=e?i.FCollapsedIconLargeName:i.FCollapsedIconName),s},this.GetExpandedIcon=function(t,e){var i,s=null;return s=null,null!=(i=this.GetValueForColumn(t))&&(s=e?i.FExpandedIconLarge:i.FExpandedIcon),s},this.GetExpandedIconName=function(t,e){var i,s="";return s="",null!=(i=this.GetValueForColumn(t))&&(s=e?i.FExpandedIconLargeName:i.FExpandedIconName),s},this.GetText=function(t){var e,i="";return i="",null!=(e=this.GetValueForColumn(t))&&(i=e.FText),i},this.SetCheckType=function(t,e){var i=null;null!=(i=this.GetValueForColumn(t))&&i.SetCheckType(e)},this.SetCollapsedIconName=function(t,e,i){var s=null;null!=(s=this.GetValueForColumn(t))&&(e?s.SetCollapsedIconLargeName(i):s.SetCollapsedIconName(i))},this.SetExpandedIconName=function(t,e,i){var s=null;null!=(s=this.GetValueForColumn(t))&&(e?s.SetExpandedIconLargeName(i):s.SetExpandedIconName(i))},this.SetText=function(t,e){var i=null;null!=(i=this.GetValueForColumn(t))&&i.SetText(e)},this.GetStrippedHTMLText=function(t){return pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.HTMLStrip(this.GetText(t))},this.UpdateNode=function(){var t=null;null!=(t=this.TreeView())&&(this.FTreeView.FNodeListBuild?t.UpdateNode(this.FVirtualNode):t.UpdateTreeViewCache())},this.GetValueForColumn=function(t){var e=null;if(e=null,t>=0&&t<=this.FValues.GetCount()-1)return e=this.FValues.GetItem$1(t);this.FTreeView.FBlockUpdateNode=!0;for(var i=0,s=t;i<=s;i++)i>this.FValues.GetCount()-1&&(e=this.FValues.Add$1());return this.FTreeView.FBlockUpdateNode=!1,e},this.CreateNodes=function(){return t.TTMSFNCTreeViewNodes.$create("Create$3",[this.FTreeView,this])},this.CreateNodeValues=function(){return t.TTMSFNCTreeViewNodeValues.$create("Create$3",[this.FTreeView,this])},this.SetIndex=function(t){var e=this;function i(t){for(var s=0,o=0,n=t.GetCount()-1;o<=n;o++)s=o,e.FTreeView.InsertItemInternal(t.GetItem$1(s)),i(t.GetItem$1(s).FNodes)}pas.Classes.TCollectionItem.SetIndex.apply(this,arguments),null!=this.FTreeView&&(this.FTreeView.FNodeListBuild?(this.FTreeView.RemoveItemInternal(e,!0),this.FTreeView.InsertItemInternal(e),i(this.FNodes)):this.FTreeView.UpdateTreeViewCache())},this.TreeView=function(){return this.FTreeView},this.GetParent=function(){var t=null;return t=null,null!=this.FTreeView&&(t=this.FTreeView.GetParentNode(this)),t},this.GetChildCount=function(){var t=0;return t=0,null!=this.FTreeView&&(t=this.FTreeView.GetNodeChildCount(this)),t};this.SaveToString=function(t){var e="",i=0;if(null==this.FTreeView)return e;e="";for(var s=0,o=this.FVirtualNode.FLevel-1;s<=o;s++)i=s,e+="\t";for(var n=0,r=this.FTreeView.FColumnCount-1;n<=r;n++)i=n,t?i===this.FTreeView.FColumnCount-1?e+=this.GetStrippedHTMLText(i):e=e+this.GetStrippedHTMLText(i)+"{1}":i===this.FTreeView.FColumnCount-1?e+=this.GetText(i):e=e+this.GetText(i)+"{1}";t||(e+="{0}");for(var a=0,l=this.FTreeView.FColumnCount-1;a<=l;a++)i=a,t||(e=(e=(e=(e=(e=(e=(e=(e=(e=e+pas.SysUtils.IntToStr(this.GetCheckType(i))+";")+pas.SysUtils.BoolToStr(this.GetChecked(i),!1)+";")+this.GetExpandedIconName(i,!1)+";")+this.GetExpandedIconName(i,!0)+";")+this.GetCollapsedIconName(i,!1)+";")+this.GetCollapsedIconName(i,!0)+";")+pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.SaveBitmapToHexStr(this.GetExpandedIcon(i,!1))+";")+pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.SaveBitmapToHexStr(this.GetExpandedIcon(i,!0))+";")+pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.SaveBitmapToHexStr(this.GetCollapsedIcon(i,!1))+";",i===this.FValues.GetCount()-1?e+=pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.SaveBitmapToHexStr(this.GetCollapsedIcon(i,!0)):e=e+pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.SaveBitmapToHexStr(this.GetCollapsedIcon(i,!0))+"|");return t||(e=(e+="{0}")+pas.SysUtils.BoolToStr(this.FExtended,!1)+"{0}",e+=pas.SysUtils.BoolToStr(this.FEnabled,!1)),e},this.LoadFromString=function(t){var e=0,i=0,s=null,o=null,n=null,r=0,a="",l=0,h="";s=pas.Classes.TStringList.$create("Create$1");try{for(a=t;""!==a;){if(0===(l=pas.System.Pos("{0}",a))){s.Add(a);break}h=pas.System.Copy(a,1,l-1),s.Add(h),pas.System.Delete({get:function(){return a},set:function(t){a=t}},1,l-1+"{0}".length)}for(var F=0,p=s.GetCount()-1;F<=p;F++)if(e=F,""!==s.Get(e))if(0===e){o=pas.Classes.TStringList.$create("Create$1");try{for(a=s.Get(e);""!==a;){if(0===(l=pas.System.Pos("{1}",a))){o.Add(a);break}h=pas.System.Copy(a,1,l-1),o.Add(h),pas.System.Delete({get:function(){return a},set:function(t){a=t}},1,l-1+"{0}".length)}for(var c=0,u=o.GetCount()-1;c<=u;c++)i=c,""!==o.Get(i)&&this.SetText(i,o.Get(i))}finally{o=rtl.freeLoc(o)}}else if(1===e){o=pas.Classes.TStringList.$create("Create$1");try{pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.Split("|",s.Get(e),o,!1);for(var C=0,T=o.GetCount()-1;C<=T;C++){i=C,n=pas.Classes.TStringList.$create("Create$1");try{pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.Split(";",o.Get(i),n,!1);for(var S=0,d=n.GetCount()-1;S<=d;S++)r=S,""!==n.Get(r)&&(0===r?this.SetCheckType(i,pas.SysUtils.StrToInt(n.Get(r))):1===r?this.SetChecked(i,pas.SysUtils.StrToBool(n.Get(r))):2===r?this.SetExpandedIconName(i,!1,n.Get(r)):3===r?this.SetExpandedIconName(i,!0,n.Get(r)):4===r?this.SetCollapsedIconName(i,!1,n.Get(r)):5===r?this.SetCollapsedIconName(i,!0,n.Get(r)):6!==r&&7!==r&&8!==r&&9!==r||(6===r?pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.LoadBitmapFromHexStr(n.Get(r),this.GetExpandedIcon(i,!1)):7===r?pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.LoadBitmapFromHexStr(n.Get(r),this.GetExpandedIcon(i,!0)):8===r?pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.LoadBitmapFromHexStr(n.Get(r),this.GetCollapsedIcon(i,!1)):pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.LoadBitmapFromHexStr(n.Get(r),this.GetCollapsedIcon(i,!0))))}finally{n=rtl.freeLoc(n)}}}finally{o=rtl.freeLoc(o)}}else 2===e?this.SetExtended(pas.SysUtils.StrToBool(s.Get(e))):3===e&&this.SetEnabled(pas.SysUtils.StrToBool(s.Get(e)))}finally{s=rtl.freeLoc(s)}},this.RemoveChildren=function(){this.FNodes.Clear()},this.Expand=function(t){null!=this.FTreeView&&this.FTreeView.ExpandNode(this,t)},this.MoveTo=function(t,e){null!=this.FTreeView&&this.FTreeView.MoveNode(this,t,e)},this.CopyTo=function(t,e){null!=this.FTreeView&&this.FTreeView.CopyNode(this,t,e)},this.Create$1=function(e){return pas.Classes.TCollectionItem.Create$1.apply(this,arguments),null!=this.FCollection&&(this.FTreeView=rtl.as(this.FCollection,t.TTMSFNCTreeViewNodes).TreeView()),this.FValues=this.CreateNodeValues(),this.FExpanded=!1,this.FExtended=!1,this.FEnabled=!0,this.FNodes=this.CreateNodes(),null!=this.FTreeView&&(this.FTreeView.FNodeListBuild?this.FTreeView.InsertItemInternal(this):this.FTreeView.UpdateTreeViewCache()),this},this.Destroy=function(){var e=t.TTMSFNCTreeViewVirtualNodeRemoveData.$new();e.RowIndex=-1,e.Count=0,e.ParentNode=-1,null!=this.FTreeView&&(!this.FTreeView.FNodeListBuild||this.FTreeView.FBlockRemoveNode>0||e.$assign(this.FTreeView.RemoveItemInternal(this,!1))),this.FVirtualNode=null,null!=this.FTreeView&&(this.FTreeView.FBlockRemoveNode=this.FTreeView.FBlockRemoveNode+1),rtl.free(this,"FNodes"),null!=this.FTreeView&&(this.FTreeView.FBlockRemoveNode=this.FTreeView.FBlockRemoveNode-1),rtl.free(this,"FValues"),pas.Classes.TCollectionItem.Destroy.call(this),-1!==e.RowIndex&&this.FTreeView.UpdateNodesInternal(t.TTMSFNCTreeViewVirtualNodeRemoveData.$clone(e)),null!=this.FTreeView&&this.FTreeView.UpdateTreeViewCache()},this.Assign=function(e){t.TTMSFNCTreeViewNode.isPrototypeOf(e)&&(this.FTag=rtl.as(e,t.TTMSFNCTreeViewNode).FTag,this.FValues.Assign(rtl.as(e,t.TTMSFNCTreeViewNode).FValues),this.FExpanded=rtl.as(e,t.TTMSFNCTreeViewNode).FExpanded,this.FExtended=rtl.as(e,t.TTMSFNCTreeViewNode).FExtended,this.FEnabled=rtl.as(e,t.TTMSFNCTreeViewNode).FEnabled,this.FNodes.Assign(rtl.as(e,t.TTMSFNCTreeViewNode).FNodes),this.AssignData(e),null!=this.FTreeView&&(this.FExpanded?this.FTreeView.ExpandNode(this,!1):this.FTreeView.CollapseNode(this,!1)))},this.AssignData=function(e){t.TTMSFNCTreeViewNode.isPrototypeOf(e)&&(this.FDataString=rtl.as(e,t.TTMSFNCTreeViewNode).FDataString,this.FDataBoolean=rtl.as(e,t.TTMSFNCTreeViewNode).FDataBoolean,this.FDataObject=rtl.as(e,t.TTMSFNCTreeViewNode).FDataObject,this.FDataInteger=rtl.as(e,t.TTMSFNCTreeViewNode).FDataInteger,this.FDataPointer=rtl.as(e,t.TTMSFNCTreeViewNode).FDataPointer,this.FDBKey=rtl.as(e,t.TTMSFNCTreeViewNode).FDBKey)};var e=this.$rtti;e.addProperty("Values",2,t.$rtti.TTMSFNCTreeViewNodeValues,"FValues","SetValues"),e.addProperty("Expanded",2,rtl.boolean,"FExpanded","SetExpanded",{Default:!1}),e.addProperty("Enabled",2,rtl.boolean,"FEnabled","SetEnabled",{Default:!0}),e.addProperty("Extended",2,rtl.boolean,"FExtended","SetExtended",{Default:!1}),e.addProperty("Tag",0,rtl.nativeint,"FTag","FTag"),e.addProperty("Nodes",2,t.$rtti.TTMSFNCTreeViewNodes,"FNodes","SetNodes")})),rtl.createClass(this,"TTMSFNCTreeViewNodes",pas["WEBLib.TMSFNCTypes"].TTMSFNCOwnedCollection,(function(){this.$init=function(){pas["WEBLib.TMSFNCTypes"].TTMSFNCOwnedCollection.$init.call(this),this.FTreeView=null,this.FNode=null},this.$final=function(){this.FTreeView=void 0,this.FNode=void 0,pas["WEBLib.TMSFNCTypes"].TTMSFNCOwnedCollection.$final.call(this)},this.GetItem$1=function(t){return this.GetItem(t)},this.GetItemClass=function(){return t.TTMSFNCTreeViewNode},this.Compare=function(t,e,i,s,o){var n=0,r=null;return n=0,null==(r=this.TreeView())||(n=s?pas.SysUtils.AnsiCompareStr(t.GetStrippedHTMLText(i),e.GetStrippedHTMLText(i)):pas.SysUtils.AnsiCompareStr(pas.SysUtils.UpperCase(t.GetStrippedHTMLText(i)),pas.SysUtils.UpperCase(e.GetStrippedHTMLText(i))),1===o&&(n*=-1),r.DoNodeCompare(t,e,i,{get:function(){return n},set:function(t){n=t}})),n},this.QuickSort=function(t,e,i,s,o){var n,r,a,l=0,h=0,F=0,p=null;p=this.FItems;do{l=t,h=e,F=t+e>>>1;do{for(;this.Compare(this.GetItem$1(l),this.GetItem$1(F),i,s,o)<0;)l+=1;for(;this.Compare(this.GetItem$1(h),this.GetItem$1(F),i,s,o)>0;)h-=1;l<=h&&(n=l,r=h,a=void 0,a=p.Get(n),p.Put(n,p.Get(r)),p.Put(r,a),F===l?F=h:F===h&&(F=l),l+=1,h-=1)}while(!(l>h));t<h&&this.QuickSort(t,h,i,s,o),t=l}while(!(l>=e))},this.TreeView=function(){return this.FTreeView},this.Node=function(){return this.FNode},this.Create$3=function(t,e){return pas.Classes.TOwnedCollection.Create$2.call(this,t,this.GetItemClass()),this.FTreeView=t,this.FNode=e,this},this.Destroy=function(){this.FNode=null,pas.Classes.TCollection.Destroy.call(this)},this.Add$1=function(){return pas.Classes.TCollection.Add.call(this)},this.Sort$1=function(t,e,i,s,o){var n=null,r=0;if(null!=(n=this.TreeView())){if(n.FSortMode=s,n.BeginUpdate(),o&&n.ClearNodeList(),this.BeginUpdate(),this.GetCount()>0&&(this.QuickSort(0,this.GetCount()-1,t,i,s),e))for(var a=0,l=this.GetCount()-1;a<=l;a++)r=a,this.GetItem$1(r).FNodes.Sort$1(t,e,i,s,o);this.EndUpdate(),n.EndUpdate()}}})),rtl.createClass(this,"TTMSFNCTreeViewGroup",pas.Classes.TCollectionItem,(function(){this.$init=function(){pas.Classes.TCollectionItem.$init.call(this),this.FTag=0,this.FTreeView=null,this.FText="",this.FStartColumn=0,this.FEndColumn=0,this.FName="",this.FBottomFill=null,this.FBottomStroke=null,this.FTopFill=null,this.FTopStroke=null,this.FTopFont=null,this.FBottomFont=null,this.FUseDefaultAppearance=!1},this.$final=function(){this.FTreeView=void 0,this.FBottomFill=void 0,this.FBottomStroke=void 0,this.FTopFill=void 0,this.FTopStroke=void 0,this.FTopFont=void 0,this.FBottomFont=void 0,pas.Classes.TCollectionItem.$final.call(this)},this.SetText=function(t){this.FText!==t&&(this.FText=t,this.UpdateGroup())},this.SetStartColumn=function(t){this.FStartColumn!==t&&(this.FStartColumn=t,this.UpdateGroup())},this.SetEndColumn=function(t){this.FEndColumn!==t&&(this.FEndColumn=t,this.UpdateGroup())},this.SetName=function(t){this.FName!==t&&(this.FName=t)},this.SetBottomFill=function(t){this.FBottomFill!==t&&this.FBottomFill.Assign(t)},this.SetBottomStroke=function(t){this.FBottomStroke!==t&&this.FBottomStroke.Assign(t)},this.SetTopFill=function(t){this.FTopFill!==t&&this.FTopFill.Assign(t)},this.SetTopStroke=function(t){this.FTopStroke!==t&&this.FTopStroke.Assign(t)},this.SetBottomFont=function(t){this.FBottomFont!==t&&this.FBottomFont.Assign(t)},this.SetTopFont=function(t){this.FTopFont!==t&&this.FTopFont.Assign(t)},this.SetUseDefaultAppearance=function(t){this.FUseDefaultAppearance!==t&&(this.FUseDefaultAppearance=t,this.Changed$1(this))},this.UpdateGroup=function(){var t=null;null!=(t=this.TreeView())&&(t.UpdateColumns(),t.UpdateTreeViewCache())},this.Changed$1=function(t){this.UpdateGroup()},this.TreeView=function(){return this.FTreeView},this.Create$1=function(e){var i=null;return pas.Classes.TCollectionItem.Create$1.apply(this,arguments),null!=this.FCollection&&(this.FTreeView=rtl.as(this.FCollection,t.TTMSFNCTreeViewGroups).TreeView(),this.FText=t.TranslateTextEx(rtl.getResStr(t,"sTMSFNCTreeViewGroup"))+" "+pas.SysUtils.IntToStr(this.FTreeView.FGroups.GetCount()-1),this.FTreeView.FGroups.GetCount()<2?(this.FStartColumn=0,this.FEndColumn=0):(i=this.FTreeView.FGroups.GetItem$1(this.FTreeView.FGroups.GetCount()-2),this.FStartColumn=i.FStartColumn+1,this.FEndColumn=this.FStartColumn)),this.FUseDefaultAppearance=!0,this.FBottomFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[0,16777215,8421504,-1,-1]),this.FBottomStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,11119017]),this.FTopFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[0,16777215,8421504,-1,-1]),this.FTopStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,8421504]),this.FTopFont=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFont.$create("Create$2"),this.FBottomFont=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFont.$create("Create$2"),this.FBottomFill.FOnChanged=rtl.createCallback(this,"Changed$1"),this.FTopFill.FOnChanged=rtl.createCallback(this,"Changed$1"),this.FBottomStroke.FOnChanged=rtl.createCallback(this,"Changed$1"),this.FTopStroke.FOnChanged=rtl.createCallback(this,"Changed$1"),this.FTopFont.FOnChange=rtl.createCallback(this,"Changed$1"),this.FBottomFont.FOnChange=rtl.createCallback(this,"Changed$1"),this.UpdateGroup(),this},this.Destroy=function(){rtl.free(this,"FTopFill"),rtl.free(this,"FTopStroke"),rtl.free(this,"FTopFont"),rtl.free(this,"FBottomFill"),rtl.free(this,"FBottomStroke"),rtl.free(this,"FBottomFont"),pas.Classes.TCollectionItem.Destroy.call(this),this.UpdateGroup()},this.Assign=function(e){t.TTMSFNCTreeViewGroup.isPrototypeOf(e)&&(this.FTag=rtl.as(e,t.TTMSFNCTreeViewGroup).FTag,this.FText=rtl.as(e,t.TTMSFNCTreeViewGroup).FText,this.FStartColumn=rtl.as(e,t.TTMSFNCTreeViewGroup).FStartColumn,this.FEndColumn=rtl.as(e,t.TTMSFNCTreeViewGroup).FEndColumn,this.FUseDefaultAppearance=rtl.as(e,t.TTMSFNCTreeViewGroup).FUseDefaultAppearance,this.FBottomFill.Assign(rtl.as(e,t.TTMSFNCTreeViewGroup).FBottomFill),this.FBottomFont.Assign(rtl.as(e,t.TTMSFNCTreeViewGroup).FBottomFont),this.FBottomStroke.Assign(rtl.as(e,t.TTMSFNCTreeViewGroup).FBottomStroke),this.FTopFill.Assign(rtl.as(e,t.TTMSFNCTreeViewGroup).FTopFill),this.FTopStroke.Assign(rtl.as(e,t.TTMSFNCTreeViewGroup).FTopStroke),this.FTopFont.Assign(rtl.as(e,t.TTMSFNCTreeViewGroup).FTopFont))},this.GetText=function(){var e="";return""===(e=this.FText)&&""===(e=this.FName)&&(e=t.TranslateTextEx(rtl.getResStr(t,"sTMSFNCTreeViewGroup"))+" "+pas.SysUtils.IntToStr(this.GetIndex())),e};var e=this.$rtti;e.addProperty("Name",2,rtl.string,"FName","SetName"),e.addProperty("Text",2,rtl.string,"FText","SetText"),e.addProperty("StartColumn",2,rtl.longint,"FStartColumn","SetStartColumn",{Default:0}),e.addProperty("EndColumn",2,rtl.longint,"FEndColumn","SetEndColumn",{Default:0}),e.addProperty("Tag",0,rtl.nativeint,"FTag","FTag",{Default:0}),e.addProperty("UseDefaultAppearance",2,rtl.boolean,"FUseDefaultAppearance","SetUseDefaultAppearance",{Default:!0}),e.addProperty("TopFill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FTopFill","SetTopFill"),e.addProperty("TopStroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FTopStroke","SetTopStroke"),e.addProperty("TopFont",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFont,"FTopFont","SetTopFont"),e.addProperty("BottomFill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FBottomFill","SetBottomFill"),e.addProperty("BottomStroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FBottomStroke","SetBottomStroke"),e.addProperty("BottomFont",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFont,"FBottomFont","SetBottomFont")})),rtl.createClass(this,"TTMSFNCTreeViewGroups",pas["WEBLib.TMSFNCTypes"].TTMSFNCOwnedCollection,(function(){this.$init=function(){pas["WEBLib.TMSFNCTypes"].TTMSFNCOwnedCollection.$init.call(this),this.FTreeView=null},this.$final=function(){this.FTreeView=void 0,pas["WEBLib.TMSFNCTypes"].TTMSFNCOwnedCollection.$final.call(this)},this.GetItem$1=function(t){return this.GetItem(t)},this.GetItemClass=function(){return t.TTMSFNCTreeViewGroup},this.TreeView=function(){return this.FTreeView},this.Create$3=function(t){return pas.Classes.TOwnedCollection.Create$2.call(this,t,this.GetItemClass()),this.FTreeView=t,this}})),this.TTMSFNCTreeViewNodeTextMode={0:"tntmDrawing",tntmDrawing:0,1:"tntmEditing",tntmEditing:1},this.$rtti.$Enum("TTMSFNCTreeViewNodeTextMode",{minvalue:0,maxvalue:1,ordtype:1,enumtype:this.TTMSFNCTreeViewNodeTextMode}),rtl.createClass(this,"TTMSFNCTreeViewNodeStructure",pas.contnrs.TObjectList,(function(){this.GetItem$1=function(t){return this.GetItem(t)}})),rtl.createClass(this,"TTMSFNCTreeViewVisibleNodes",pas.Classes.TList,(function(){this.GetItem=function(t){return rtl.getObject(this.Get(t))}})),rtl.recNewT(this,"TTMSFNCTreeViewDisplayGroup",(function(){this.StartColumn=0,this.EndColumn=0,this.$eq=function(t){return this.StartColumn===t.StartColumn&&this.EndColumn===t.EndColumn},this.$assign=function(t){return this.StartColumn=t.StartColumn,this.EndColumn=t.EndColumn,this}})),rtl.createClass(this,"TTMSFNCTreeViewDisplayGroups",pas.Classes.TList,(function(){this.GetItem=function(e){var i=t.TTMSFNCTreeViewDisplayGroup.$new();return i.$assign(rtl.getObject(this.Get(e))),i}})),rtl.createClass(this,"TTMSFNCTreeViewData",pas["WEBLib.TMSFNCTreeViewBase"].TTMSFNCTreeViewBase,(function(){this.$init=function(){pas["WEBLib.TMSFNCTreeViewBase"].TTMSFNCTreeViewBase.$init.call(this),this.FFilterApplied=!1,this.FBlockUpdate=!1,this.FNodeStructure=null,this.FVisibleNodes=null,this.FColumns=null,this.FGroups=null,this.FNodes=null,this.FBitmapContainer=null,this.FDisplayGroups=null,this.FFilter=null,this.FSortMode=0},this.$final=function(){this.FNodeStructure=void 0,this.FVisibleNodes=void 0,this.FColumns=void 0,this.FGroups=void 0,this.FNodes=void 0,this.FBitmapContainer=void 0,this.FDisplayGroups=void 0,this.FFilter=void 0,pas["WEBLib.TMSFNCTreeViewBase"].TTMSFNCTreeViewBase.$final.call(this)},this.SetColumns=function(t){this.FColumns.Assign(t)},this.SetGroups=function(t){this.FGroups.Assign(t)},this.SetNodes=function(t){this.FNodes.Assign(t)},this.GetBitmapContainer=function(){return this.FBitmapContainer},this.SetBitmapContainer=function(t){this.FBitmapContainer=t,this.Invalidate()},this.Notification=function(t,e){pas["WEBLib.Menus"].TWebCustomControl.Notification.apply(this,arguments),t===this.FBitmapContainer&&1===e&&(this.FBitmapContainer=null)},this.CreateColumns=function(){return t.TTMSFNCTreeViewColumns.$create("Create$3",[this])},this.CreateGroups=function(){return t.TTMSFNCTreeViewGroups.$create("Create$3",[this])},this.CreateNodes=function(){return t.TTMSFNCTreeViewNodes.$create("Create$3",[this,null])},this.GetInsertPosition=function(t,e,i){var s=0,o=null,n=0,r=0,a=null;if(s=-1,null==t)return s;if(0===t.FRow)return s=0;if(o=i?this.GetNodeFromNodeStructure(t.FRow-1):this.GetNodeFromNodeStructure(t.FRow),e)for(;null!=o&&o.FParentNode>=0&&o.FParentNode<=this.FNodeStructure.GetCount()-1&&(a=this.GetNodeFromNodeStructure(o.FParentNode))!==o;)o=a;if(null!=o)for(var l=0,h=this.FVisibleNodes.GetCount()-1;l<=h;l++)if(n=l,r=i?t.FRow+1:t.FRow,this.FVisibleNodes.GetItem(n).FRow===r){s=n;break}return s},this.GetNodeFromNodeStructure=function(t){var e=null;return e=null,t>=0&&t<=this.FNodeStructure.GetCount()-1&&(e=this.FNodeStructure.GetItem$1(t)),e},this.MatchFilter=function(t){var e=!1,i=0,s="",o=!1;e=!0;for(var n=1,r=this.FFilter.GetCount();n<=r;n++){i=n;var a=this.FFilter.GetItem$1(i-1);s="",this.DoGetNodeText(t,a.FColumn,0,{get:function(){return s},set:function(t){s=t}}),s=pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.HTMLStrip(s),s=pas.SysUtils.Trim(s),""!==a.FPrefix&&1===pas.System.Pos(a.FPrefix,s)&&pas.System.Delete({get:function(){return s},set:function(t){s=t}},1,this.FFilter.GetItem$1(i-1).FPrefix.length),""!==a.FSuffix&&pas.System.Pos(a.FSuffix,s)===1+s.length-a.FSuffix.length&&pas.System.Delete({get:function(){return s},set:function(t){s=t}},1+s.length-a.FSuffix.length,s.length);try{o=pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.MatchStrEx(a.FCondition,s,a.FCaseSensitive)}catch(t){o=!1}var l=this.FFilter.GetItem$1(i-1).FOperation;if(0===l){if(!(e=o))break}else 1===l?e=o:2===l?e=e&&o:4===l?e=e||o:3===l&&(e^=o)}return e},this.BuildNodeList=function(){var e,i=0;this.FNodeListBuild||(this.FNodeStructure.Clear(),this.FVisibleNodes.Clear(),e=t.TTMSFNCTreeViewVirtualNode.$create("Create$1",[this]),this.FTotalRowHeight=1,this.SetRowCount(0),i=0,this.BuildInternalNodeList(e,"ROOT",-1,-1,-1,!0,{get:function(){return i},set:function(t){i=t}}),this.SetRowCount(this.FVisibleNodes.GetCount()),this.FNodeListBuild=this.FNodeStructure.GetCount()>0)},this.UpdateColumns=function(){var e=0,i=null,s=null,o=t.TTMSFNCTreeViewDisplayGroup.$new();if(!(this.FUpdateCount$1>0||3 in this.FComponentState)){this.FDisplayGroups.Clear();for(var n=0,r=this.FGroups.GetCount()-1;n<=r;n++)e=n,s=this.FGroups.GetItem$1(e),o.StartColumn=Math.max(0,Math.min(s.FStartColumn,this.FColumns.GetCount()-1)),o.EndColumn=Math.max(0,Math.min(s.FEndColumn,this.FColumns.GetCount()-1)),this.FDisplayGroups.Add(t.TTMSFNCTreeViewDisplayGroup.$clone(o));for(var a=0,l=this.FColumns.GetCount()-1;a<=l;a++)e=a,(i=this.FColumns.GetItem$1(e)).FVisible?this.SetColWidths(e,i.FWidth):this.SetColWidths(e,0)}},this.BuildInternalNodeList=function(e,i,s,o,n,r,a){var l=0,h=0,F=!1,p=null,c=!1,u=0,C=!1,T=!1,S=[],d=null,m=[];if(e.FRow=this.FNodeStructure.GetCount(),e.FParentNode=s,e.FIndex=o,e.FLevel=n,"ROOT"!==i&&this.GetNodeForNodeData(e),h=0,n<100&&this.DoGetNumberOfNodes(e,{get:function(){return h},set:function(t){h=t}}),e.FChildren=h,e.FCalculated=!1,e.FHeight=this.FDefaultRowHeight,c=!1,"ROOT"!==i&&this.DoIsNodeExpanded(e,{get:function(){return c},set:function(t){c=t}}),e.FExpanded=c,T=!1,this.DoIsNodeExtended(e,{get:function(){return T},set:function(t){T=t}}),this.UpdateNodeExtended(e,T),S=rtl.arraySetLength(S,!1,0),"ROOT"!==i){for(var f=0,g=this.FColumnCount-1;f<=g;f++)l=f,C=!1,this.DoIsNodeChecked(e,l,{get:function(){return C},set:function(t){C=t}}),(S=rtl.arraySetLength(S,!1,rtl.length(S)+1))[rtl.length(S)-1]=C;e.FCheckStates=rtl.arrayRef(S)}if(F=!this.FFilterApplied||this.MatchFilter(e),"ROOT"!==i&&this.DoIsNodeVisible(e,{get:function(){return F},set:function(t){F=t}}),u=h,"ROOT"!==i&&(this.FNodeStructure.Add$1(e),(r||0===e.FLevel)&&F)){if(this.FFilterApplied){for(d=e.GetParent(),m=[];null!=d;)d.FAddedToVisibleList||((m=rtl.arraySetLength(m,null,rtl.length(m)+1))[rtl.length(m)-1]=d),d=d.GetParent();for(var y=rtl.length(m)-1;y>=0;y--)l=y,this.FVisibleNodes.Add(m[l]),m[l].FAddedToVisibleList=!0}this.FVisibleNodes.Add(e),e.FAddedToVisibleList=!0}for(var M=0,b=h-1;M<=b&&(l=M,2e6!==this.FNodeStructure.GetCount());M++)p=t.TTMSFNCTreeViewVirtualNode.$create("Create$1",[this]),"ROOT"===i?this.BuildInternalNodeList(p,"",s,l,0,c,{get:function(){return u},set:function(t){u=t}}):this.BuildInternalNodeList(p,"",e.FRow,l,e.FLevel+1,c,{get:function(){return u},set:function(t){u=t}});a.set(a.get()+u),"ROOT"!==i?e.FTotalChildren=u:e=rtl.freeLoc(e)},this.GetNodeForNodeData=function(t){var e=null,i=null,s=null;null!=t&&null!=(e=null!=(i=this.GetNodeFromNodeStructure(t.FParentNode))&&null!=i.FNode?i.FNode.FNodes:this.FNodes)&&t.FIndex>=0&&t.FIndex<=e.GetCount()-1&&(s=e.GetItem$1(t.FIndex),t.FNode=s,s.FVirtualNode=t)},this.DoGetNumberOfNodes=function(t,e){null!=t.FNode?e.set(t.FNode.FNodes.GetCount()):e.set(this.FNodes.GetCount())},this.DoGetColumnTrimming=function(t,e,i){},this.DoGetColumnWordWrapping=function(t,e,i){},this.DoGetNodeSides=function(t,e){},this.DoGetNodeText=function(t,e,i,s){var o=null;null!=(o=t.FNode)&&e>=0&&e<=o.FValues.GetCount()-1&&s.set(o.FValues.GetItem$1(e).GetText())},this.DoGetNodeData=function(t){},this.DoGetNodeTitle=function(t,e,i,s){var o=null;null!=(o=t.FNode)&&e>=0&&e<=o.FValues.GetCount()-1&&s.set(o.FValues.GetItem$1(e).FTitle)},this.DoGetNodeTitleExpanded=function(t,e,i){var s=null;null!=(s=t.FNode)&&e>=0&&e<=s.FValues.GetCount()-1&&i.set(s.FValues.GetItem$1(e).FTitleExpanded)},this.DoGetNodeTrimming=function(t,e,i){},this.DoGetNodeHorizontalTextAlign=function(t,e,i){},this.DoGetNodeWordWrapping=function(t,e,i){},this.DoGetNodeTitleTrimming=function(t,e,i){},this.DoGetNodeTitleHorizontalTextAlign=function(t,e,i){},this.DoGetNodeTitleVerticalTextAlign=function(t,e,i){},this.DoGetNodeTitleWordWrapping=function(t,e,i){},this.DoGetNodeExtraSize=function(t,e,i){},this.DoGetNodeTitleExtraSize=function(t,e,i){},this.DoGetNodeCheckType=function(t,e,i){var s=null;null!=(s=t.FNode)&&e>=0&&e<=s.FValues.GetCount()-1&&i.set(s.FValues.GetItem$1(e).FCheckType)},this.DoGetNodeIcon=function(t,e,i,s){var o=null,n=null;null!=(o=t.FNode)&&e>=0&&e<=o.FValues.GetCount()-1&&(n=o.FValues.GetItem$1(e),t.FExpanded?i?(null!=this.GetBitmapContainer()&&""!==n.FExpandedIconLargeName&&s.set(this.GetBitmapContainer().FindBitmap$1(n.FExpandedIconLargeName)),null==s.get()&&s.set(n.FExpandedIconLarge)):(null!=this.GetBitmapContainer()&&""!==n.FExpandedIconName&&s.set(this.GetBitmapContainer().FindBitmap$1(n.FExpandedIconName)),null==s.get()&&s.set(n.FExpandedIcon)):i?(null!=this.GetBitmapContainer()&&""!==n.FCollapsedIconLargeName&&s.set(this.GetBitmapContainer().FindBitmap$1(n.FCollapsedIconLargeName)),null==s.get()&&s.set(n.FCollapsedIconLarge)):(null!=this.GetBitmapContainer()&&""!==n.FCollapsedIconName&&s.set(this.GetBitmapContainer().FindBitmap$1(n.FCollapsedIconName)),null==s.get()&&s.set(n.FCollapsedIcon)))},this.DoGetNodeIconSize=function(t,e,i,s,o,n){},this.DoGetNodeSelectedColor=function(t,e){},this.DoGetNodeDisabledColor=function(t,e){},this.DoGetNodeColor=function(t,e){},this.DoGetNodeSelectedTextColor=function(t,e,i){},this.DoGetNodeDisabledTextColor=function(t,e,i){},this.DoGetNodeSelectedTitleColor=function(t,e,i){},this.DoGetNodeDisabledTitleColor=function(t,e,i){},this.DoGetNodeTextColor=function(t,e,i){},this.DoGetNodeTitleColor=function(t,e,i){},this.DoIsNodeExpanded=function(t,e){var i;null!=(i=t.FNode)&&e.set(i.FExpanded)},this.DoIsNodeExtended=function(t,e){var i;null!=(i=t.FNode)&&e.set(i.FExtended)},this.DoIsNodeChecked=function(t,e,i){var s=null;null!=(s=t.FNode)&&e>=0&&e<=s.FValues.GetCount()-1&&i.set(s.FValues.GetItem$1(e).FChecked)},this.DoIsNodeVisible=function(t,e){},this.DoIsNodeEnabled=function(t,e){var i;null!=(i=t.FNode)&&e.set(i.FEnabled)},this.DoNodeCompare=function(t,e,i,s){},this.DoGetHTMLTemplateValue=function(t,e,i){},this.DoGetHTMLTemplate=function(t,e,i){},this.ToggleCheckNodeInternal=function(t,e,i){!(3 in this.FComponentState)&&null!=t&&this.FNodeListBuild&&e>=0&&e<=rtl.length(t.FCheckStates)-1&&(t.FCheckStates[e]?this.UnCheckNodeInternal(t,e,i):this.CheckNodeInternal(t,e,i))},this.CheckNodeInternal=function(t,e,i){var s=0,o=null,n=null,r=0,a=0,l=0,h=null;if(null!=t){if(e>=0&&e<=rtl.length(t.FCheckStates)-1&&(t.FCheckStates[e]=!0,this.UpdateCheckState(t,e,t.FCheckStates[e])),null!=t.FNode&&e>=0&&e<=t.FNode.FValues.GetCount()-1&&t.FNode.FValues.UpdateChecked(e,!0),s=0,this.DoGetNodeCheckType(t,e,{get:function(){return s},set:function(t){s=t}}),2===s)for(null!=(o=this.GetNodeFromNodeStructure(t.FParentNode))?a=(r=o.FRow+1)+o.FTotalChildren:(r=0,a=this.FNodeStructure.GetCount());r<a&&null!=(n=this.GetNodeFromNodeStructure(r));)n!==t&&(s=0,this.DoGetNodeCheckType(n,e,{get:function(){return s},set:function(t){s=t}}),2===s&&(e>=0&&e<=rtl.length(n.FCheckStates)-1&&(n.FCheckStates[e]=!1,this.UpdateCheckState(n,e,n.FCheckStates[e])),null!=n.FNode&&e>=0&&e<=n.FNode.FValues.GetCount()-1&&n.FNode.FValues.UpdateChecked(e,!1))),r=r+n.FTotalChildren+1;if(i)for(var F=t.FRow+1,p=t.FRow+t.FTotalChildren;F<=p;F++)l=F,null!=(h=this.GetNodeFromNodeStructure(l))&&this.CheckNodeInternal(h,e,i);this.Invalidate()}},this.UpdateCheckState=function(t,e,i){},this.UnCheckNodeInternal=function(t,e,i){var s=0,o=0,n=null;if(!(3 in this.FComponentState)&&null!=t&&this.FNodeListBuild){if(s=0,this.DoGetNodeCheckType(t,e,{get:function(){return s},set:function(t){s=t}}),1===s&&(e>=0&&e<=rtl.length(t.FCheckStates)-1&&(t.FCheckStates[e]=!1,this.UpdateCheckState(t,e,t.FCheckStates[e])),null!=t.FNode&&e>=0&&e<=t.FNode.FValues.GetCount()-1&&t.FNode.FValues.UpdateChecked(e,!1)),i)for(var r=t.FRow+1,a=t.FRow+t.FTotalChildren;r<=a;r++)o=r,null!=(n=this.GetNodeFromNodeStructure(o))&&this.UnCheckNodeInternal(n,e,i);this.Invalidate()}},this.ExpandNodeInternal=function(t,e){var i=0,s=null;if(!(3 in this.FComponentState)&&null!=t&&!t.FExpanded){if(null!=t&&(t.FExpanded=!0),this.UpdateNodeExpanded(t,!0),e)for(var o=t.FRow+1,n=t.FRow+t.FTotalChildren;o<=n;o++)i=o,null!=(s=this.GetNodeFromNodeStructure(i))&&this.UpdateNodeExpanded(s,!0);this.UpdateVisibleNodes(t),this.FBlockUpdate||(this.ResetNodes(!1),this.UpdateTreeView(),this.Invalidate())}},this.CollapseNodeInternal=function(t,e){var i=0,s=null;if(null!=t&&t.FExpanded&&this.FNodeListBuild&&!(3 in this.FComponentState)){if(this.UpdateNodeExpanded(t,!1),e)for(var o=t.FRow+1,n=t.FRow+t.FTotalChildren;o<=n;o++)i=o,null!=(s=this.GetNodeFromNodeStructure(i))&&this.UpdateNodeExpanded(s,!1);this.ResetNodes(!1),this.UpdateVisibleNodes(t),this.UpdateTreeView(),this.Invalidate()}},this.RemoveNodeInternal=function(e,i){var s=t.TTMSFNCTreeViewVirtualNodeRemoveData.$new(),o=0,n=0,r=0,a=null,l=null,h=null,F=0,p=!1,c=!1,u=[],C=0,T=!1;if(3 in this.FComponentState||!this.FNodeListBuild||null==e)return s;for(F=this.FNodeStructure.GetCount(),l=this.GetNodeFromNodeStructure(e.FParentNode);null!=l;)this.UpdateNodeTotalChildren(l,l.FTotalChildren-1-e.FTotalChildren),l.FRow===e.FParentNode&&this.UpdateNodeChildren(l,l.FChildren-1),r=l.FParentNode,l=this.GetNodeFromNodeStructure(r);for(var S=e.FTotalChildren-1;S>=0;S--)n=(o=S)+e.FRow+1,null!=(a=this.GetNodeFromNodeStructure(n))&&(this.FVisibleNodes.IndexOf(a)>-1&&(this.FVisibleNodes.Remove(a),this.FTotalRowHeight=this.FTotalRowHeight-a.FHeight,this.SetRowCount(this.FRowCount-1)),this.FNodeStructure.Remove$1(a),this.RemoveNodeFromSelection(a));if(n=e.FRow,r=e.FParentNode,this.FVisibleNodes.IndexOf(e)>-1&&(this.FVisibleNodes.Remove(e),this.FTotalRowHeight=this.FTotalRowHeight-e.FHeight,this.SetRowCount(this.FRowCount-1)),this.UpdateNodeChildren(e,e.FChildren-1),this.UpdateNodeTotalChildren(e,e.FTotalChildren-1),this.ClearFocusedNode(e),this.FNodeStructure.Remove$1(e),this.RemoveNodeFromSelection(e),F-=this.FNodeStructure.GetCount(),s.Count=F,s.RowIndex=n,s.ParentNode=r,i){for(var d=n,m=this.FNodeStructure.GetCount()-1;d<=m;d++)if(o=d,null!=(h=this.GetNodeFromNodeStructure(o))){this.UpdateNodeRow(h,h.FRow-F),h.FParentNode>r&&this.UpdateNodeParentNode(h,h.FParentNode-F),h.FParentNode===r&&this.UpdateNodeIndex(h,h.FIndex-1),this.GetNodeForNodeData(h),p=!1,this.DoIsNodeExpanded(h,{get:function(){return p},set:function(t){p=t}}),this.UpdateNodeExpanded(h,p),c=!1,this.DoIsNodeExtended(h,{get:function(){return c},set:function(t){c=t}}),this.UpdateNodeExtended(h,c),u=rtl.arraySetLength(u,!1,0);for(var f=0,g=this.FColumnCount-1;f<=g;f++)C=f,T=!1,this.DoIsNodeChecked(h,C,{get:function(){return T},set:function(t){T=t}}),(u=rtl.arraySetLength(u,!1,rtl.length(u)+1))[rtl.length(u)-1]=T;this.UpdateNodeCheckStates(h,rtl.arrayRef(u))}this.FBlockUpdate||(this.ResetNodes(!1),this.UpdateTreeView(),this.Invalidate())}return s},this.UpdateNodesInternal=function(t){var e,i,s=0,o=null,n=!1,r=!1,a=[],l=0,h=!1;e=t.Count,i=t.ParentNode;for(var F=t.RowIndex,p=this.FNodeStructure.GetCount()-1;F<=p;F++)if(s=F,null!=(o=this.GetNodeFromNodeStructure(s))){this.UpdateNodeRow(o,o.FRow-e),o.FParentNode>i&&this.UpdateNodeParentNode(o,o.FParentNode-e),o.FParentNode===i&&this.UpdateNodeIndex(o,o.FIndex-1),this.GetNodeForNodeData(o),r=!1,this.DoIsNodeExpanded(o,{get:function(){return r},set:function(t){r=t}}),this.UpdateNodeExpanded(o,r),n=!1,this.DoIsNodeExtended(o,{get:function(){return n},set:function(t){n=t}}),this.UpdateNodeExtended(o,n),a=rtl.arraySetLength(a,!1,0);for(var c=0,u=this.FColumnCount-1;c<=u;c++)l=c,h=!1,this.DoIsNodeChecked(o,l,{get:function(){return h},set:function(t){h=t}}),(a=rtl.arraySetLength(a,!1,rtl.length(a)+1))[rtl.length(a)-1]=h;this.UpdateNodeCheckStates(o,rtl.arrayRef(a))}this.FBlockUpdate||(this.ResetNodes(!1),this.UpdateTreeView(),this.Invalidate())},this.InsertNodeInternal=function(t,e,i,s){var o=0,n=0,r=null,a=null,l=0,h=!1,F=!1,p=[],c=0,u=!1,C=!1,T=0;if(this.FNodeListBuild&&!(3 in this.FComponentState))if(null!=s){if(l=this.FNodeStructure.GetCount(),null!=t&&(n=t.FRow)>=0&&n<=this.FNodeStructure.GetCount()-1)for(r=this.GetNodeFromNodeStructure(n);null!=r;)this.UpdateNodeTotalChildren(r,r.FTotalChildren+1),r.FRow===t.FRow&&this.UpdateNodeChildren(r,r.FChildren+1),n=r.FParentNode,r=this.GetNodeFromNodeStructure(n);this.UpdateNodeIndex(s,e),this.UpdateNodeRow(s,i),null!=t?(this.UpdateNodeParentNode(s,t.FRow),this.UpdateNodeLevel(s,t.FLevel+1)):(this.UpdateNodeParentNode(s,-1),this.UpdateNodeLevel(s,0)),this.UpdateNodeHeight(s,this.FDefaultRowHeight),this.GetNodeForNodeData(s),u=!1,this.DoIsNodeExpanded(s,{get:function(){return u},set:function(t){u=t}}),this.UpdateNodeExpanded(s,u),C=!1,this.DoIsNodeExtended(s,{get:function(){return C},set:function(t){C=t}}),this.UpdateNodeExtended(s,C),p=rtl.arraySetLength(p,!1,0);for(var S=0,d=this.FColumnCount-1;S<=d;S++)o=S,F=!1,this.DoIsNodeChecked(s,o,{get:function(){return F},set:function(t){F=t}}),(p=rtl.arraySetLength(p,!1,rtl.length(p)+1))[rtl.length(p)-1]=F;this.UpdateNodeCheckStates(s,rtl.arrayRef(p)),s.FRow>=0&&s.FRow<this.FNodeStructure.GetCount()?this.FNodeStructure.Insert$1(s.FRow,s):this.FNodeStructure.Add$1(s),h=!0,null!=t&&this.DoIsNodeVisible(t,{get:function(){return h},set:function(t){h=t}}),l-=this.FNodeStructure.GetCount();for(var m=s.FRow+1,f=this.FNodeStructure.GetCount()-1;m<=f;m++)if(o=m,null!=(a=this.GetNodeFromNodeStructure(o))){this.UpdateNodeRow(a,a.FRow-l),a.FParentNode>s.FParentNode&&this.UpdateNodeParentNode(a,a.FParentNode-l),a.FParentNode===s.FParentNode&&this.UpdateNodeIndex(a,a.FIndex+1),this.GetNodeForNodeData(a),u=!1,this.DoIsNodeExpanded(a,{get:function(){return u},set:function(t){u=t}}),this.UpdateNodeExpanded(a,u),C=!1,this.DoIsNodeExtended(a,{get:function(){return C},set:function(t){C=t}}),this.UpdateNodeExtended(a,C),p=rtl.arraySetLength(p,!1,0);for(var g=0,y=this.FColumnCount-1;g<=y;g++)T=g,F=!1,this.DoIsNodeChecked(a,T,{get:function(){return F},set:function(t){F=t}}),(p=rtl.arraySetLength(p,!1,rtl.length(p)+1))[rtl.length(p)-1]=F;this.UpdateNodeCheckStates(a,rtl.arrayRef(p))}(null==t||null!=t&&t.FExpanded&&h)&&(null==t?(this.SetRowCount(this.FRowCount+1),this.FTotalRowHeight=this.FTotalRowHeight+this.FDefaultRowHeight,(c=this.GetInsertPosition(s,!0,!0))>=0&&c<this.FVisibleNodes.GetCount()?this.FVisibleNodes.Insert(c,s):this.FVisibleNodes.Add(s)):(this.UpdateNodeExpanded(t,!1),this.UpdateVisibleNodes(t),this.UpdateNodeExpanded(t,!0),this.UpdateVisibleNodes(t))),this.ResetNodes(!1),this.UpdateTreeView(),this.Invalidate()}else s=rtl.freeLoc(s)},this.UpdateVisibleNodes=function(t){var e=0,i=0,s=0,o=0,n=null,r=!1,a=!1,l=!1;if(t.FExpanded){if(o=this.GetInsertPosition(t,-1===t.FParentNode,!1),r=!0,this.DoIsNodeEnabled(t,{get:function(){return r},set:function(t){r=t}}),a=!0,this.DoIsNodeVisible(t,{get:function(){return a},set:function(t){a=t}}),-1!==o&&a&&r)for(i=0,s=o+1;i<t.FTotalChildren;)e=i+t.FRow+1,null!=(n=this.GetNodeFromNodeStructure(e))&&((this.MatchFilter(n)||n.FAddedToVisibleList)&&this.FFilterApplied||!this.FFilterApplied)&&(l=!0,this.DoIsNodeVisible(n,{get:function(){return l},set:function(t){l=t}}),l&&(s>=0&&s<this.FVisibleNodes.GetCount()?this.FVisibleNodes.Insert(s,n):this.FVisibleNodes.Add(n),0===n.FChildren&&(n.FExpanded=!0),this.FTotalRowHeight=this.FTotalRowHeight+n.FHeight,this.SetRowCount(this.FRowCount+1),s+=1),n.FExpanded&&l||(i+=n.FTotalChildren)),i+=1}else for(var h=0,F=t.FTotalChildren-1;h<=F;h++)e=(i=h)+t.FRow+1,null!=(n=this.GetNodeFromNodeStructure(e))&&(this.UpdateNodeCalculated(n,!1),this.FVisibleNodes.IndexOf(n)>-1&&(this.FVisibleNodes.Remove(n),0===n.FChildren&&(n.FExpanded=!1),this.FTotalRowHeight=this.FTotalRowHeight-n.FHeight,this.SetRowCount(this.FRowCount-1)))},this.ToggleNodeInternal=function(t,e){!(3 in this.FComponentState)&&null!=t&&this.FNodeListBuild&&(t.FExpanded?this.CollapseNodeInternal(t,e):this.ExpandNodeInternal(t,e))},this.InsertItemInternal=function(t){var e;!(3 in this.FComponentState)&&null!=t&&this.FNodeListBuild&&(null!=(e=t.FCollection.Node())?this.InsertVirtualNode(t.GetIndex(),e.FVirtualNode):this.InsertVirtualNode(t.GetIndex(),null))},this.RemoveItemInternal=function(e,i){var s=t.TTMSFNCTreeViewVirtualNodeRemoveData.$new();return s.RowIndex=-1,s.Count=0,s.ParentNode=-1,3 in this.FComponentState||null==e||!this.FNodeListBuild||s.$assign(this.RemoveNodeInternal(e.FVirtualNode,i)),s},this.GetVisibleNodeForIndex=function(t){var e=null;return e=null,t>=0&&t<=this.FVisibleNodes.GetCount()-1&&(e=this.FVisibleNodes.GetItem(t)),e},this.ToggleNode=function(t){null!=t&&this.ToggleVirtualNode(t.FVirtualNode,!1)},this.UpdateNodeCalculated=function(t,e){t.FCalculated=e},this.UpdateNodeHeight=function(t,e){t.FHeight=e},this.UpdateNodeTitleHeight=function(t,e){t.FTitleHeight=e},this.UpdateNodeCheckStates=function(t,e){t.FCheckStates=rtl.arrayRef(e)},this.UpdateNodeBitmapRects=function(t,e){t.FBitmapRects=rtl.arrayRef(e)},this.UpdateNodeCheckRects=function(t,e){t.FCheckRects=rtl.arrayRef(e)},this.UpdateNodeExpandRects=function(t,e){t.FExpandRects=rtl.arrayRef(e)},this.UpdateNodeTextRects=function(t,e){t.FTextRects=rtl.arrayRef(e)},this.UpdateNodeTitleRects=function(t,e){t.FTitleRects=rtl.arrayRef(e)},this.UpdateNodeExtraRects=function(t,e){t.FExtraRects=rtl.arrayRef(e)},this.UpdateNodeTitleExtraRects=function(t,e){t.FTitleExtraRects=rtl.arrayRef(e)},this.UpdateNodeCacheReference=function(t,e){t.FCache=e},this.UpdateNodeExpanded=function(t,e){t.FExpanded=e,null!=t.FNode&&(t.FNode.FExpanded=e)},this.UpdateNodeExtended=function(t,e){t.FExtended=e},this.UpdateNodeTotalChildren=function(t,e){t.FTotalChildren=e},this.UpdateNodeChildren=function(t,e){t.FChildren=e},this.UpdateNodeIndex=function(t,e){t.FIndex=e},this.UpdateNodeRow=function(t,e){t.FRow=e},this.UpdateNodeLevel=function(t,e){t.FLevel=e},this.UpdateNodeParentNode=function(t,e){t.FParentNode=e},this.UpdateNode=function(t){null!=t&&!(3 in this.FComponentState)&&this.FNodeListBuild&&(this.FBlockUpdateNode||(t.FCalculated=!1,this.FUpdateCount$1>0||(this.UpdateNodesCache(!0,!1),this.Invalidate())))},this.CustomizeScrollPosition=function(t,e,i){},this.HTMLReplace=function(t,e){var i="",s="",o="",n="",r="",a=0,l=0;if(i="",null==e)return i;for(s="";pas.System.Pos("<#",t)>0&&pas.System.Pos(">",t)>0;)a=pas.System.Pos("<#",t),s+=pas.System.Copy(t,1,a-1),o=pas.System.Copy(t,a,t.length),l=pas.System.Pos(">",o),n=pas.System.Copy(o,1,l-1),pas.System.Delete({get:function(){return n},set:function(t){n=t}},1,2),pas.System.Delete({get:function(){return t},set:function(e){t=e}},1,a+l-1),r=e.FHTMLTemplateItems.GetValue(n),this.DoGetHTMLTemplateValue(e,n,{get:function(){return r},set:function(t){r=t}}),s+=r;return i=s+t},this.GetHTMLTemplate=function(t){return"",""},this.Assign=function(e){pas["WEBLib.TMSFNCTreeViewBase"].TTMSFNCTreeViewBase.Assign.apply(this,arguments),t.TTMSFNCTreeViewData.isPrototypeOf(e)&&(this.FColumns.Assign(rtl.as(e,t.TTMSFNCTreeViewData).FColumns),this.FGroups.Assign(rtl.as(e,t.TTMSFNCTreeViewData).FGroups),this.FNodes.Assign(rtl.as(e,t.TTMSFNCTreeViewData).FNodes))},this.Create$1=function(e){return pas["WEBLib.TMSFNCTreeViewBase"].TTMSFNCTreeViewBase.Create$1.apply(this,arguments),this.FFilter=t.TTMSFNCTreeViewFilter.$create("Create$3",[this]),this.FNodeStructure=t.TTMSFNCTreeViewNodeStructure.$create("Create$2"),this.FVisibleNodes=t.TTMSFNCTreeViewVisibleNodes.$create("Create$1"),this.FDisplayGroups=t.TTMSFNCTreeViewDisplayGroups.$create("Create$1"),this.FNodes=this.CreateNodes(),this.FColumns=this.CreateColumns(),this.FGroups=this.CreateGroups(),this},this.Destroy=function(){rtl.free(this,"FFilter"),rtl.free(this,"FDisplayGroups"),rtl.free(this,"FNodeStructure"),rtl.free(this,"FVisibleNodes"),rtl.free(this,"FNodes"),rtl.free(this,"FGroups"),rtl.free(this,"FColumns"),pas["WEBLib.TMSFNCTreeViewBase"].TTMSFNCTreeViewBase.Destroy.call(this)},this.IsColumnVisible=function(t){var e=!1;return e=pas["WEBLib.TMSFNCTreeViewBase"].TTMSFNCTreeViewBase.IsColumnVisible.call(this,t),t>=0&&t<=this.FColumns.GetCount()-1&&(e=this.FColumns.GetItem$1(t).FVisible),e},this.ClearColumns=function(){this.BeginUpdate(),this.FColumns.Clear(),this.EndUpdate()},this.ClearNodes=function(){this.BeginUpdate(),this.FNodeListBuild=!1,this.FNodes.Clear(),this.ClearFocusedNode(null),this.EndUpdate()},this.ClearNodeList=function(){this.BeginUpdate(),this.FNodeListBuild=!1,this.ClearFocusedNode(null),this.EndUpdate()},this.RemoveVirtualNode=function(t){this.RemoveNodeInternal(t,!0)},this.RemoveNode=function(t){null!=t&&(t=rtl.freeLoc(t))},this.ExpandNode=function(t,e){null!=t&&this.ExpandVirtualNode(t.FVirtualNode,e)},this.MoveNode=function(e,i,s){var o=null,n=null;if(null!=i&&null!=e&&i!==e){for(n=i.GetParent();null!=n;){if(n===e)return;n=n.GetParent()}this.BeginUpdate(),o=t.TTMSFNCTreeViewNode.$create("Create$1",[null]),null!=i?e.SetCollection(i.FNodes):e.SetCollection(this.FNodes),null!=i?s>=0&&s<=i.FNodes.GetCount()-1?e.SetIndex(s):e.SetIndex(i.FNodes.GetCount()-1):s>=0&&s<=this.FNodes.GetCount()-1?e.SetIndex(s):e.SetIndex(this.FNodes.GetCount()-1),o=rtl.freeLoc(o),this.EndUpdate()}},this.CopyNode=function(e,i,s){var o=null,n=null;i!==e&&(this.BeginUpdate(),(o=t.TTMSFNCTreeViewNode.$create("Create$1",[null])).Assign(e),(n=null!=i?i.FNodes.Add$1():this.FNodes.Add$1()).Assign(o),o=rtl.freeLoc(o),null!=i?s>=0&&s<=i.FNodes.GetCount()-1&&n.SetIndex(s):s>=0&&s<=this.FNodes.GetCount()-1&&n.SetIndex(s),this.EndUpdate())},this.ExpandAll=function(){!function t(e){for(var i=0,s=0,o=e.GetCount()-1;s<=o;s++)i=s,e.GetItem$1(i).FExpanded=!0,t(e.GetItem$1(i).FNodes)}(this.FNodes),this.ExpandAllVirtual()},this.ExpandAllVirtual=function(){var t=0,e=null;this.FVisibleNodes.Clear(),this.FTotalRowHeight=1,this.SetRowCount(0);for(var i=0,s=this.FNodeStructure.GetCount()-1;i<=s;i++)t=i,null!=(e=this.GetNodeFromNodeStructure(t))&&((this.MatchFilter(e)||e.FAddedToVisibleList)&&this.FFilterApplied||!this.FFilterApplied)&&(this.UpdateNodeExpanded(e,!0),this.FVisibleNodes.Add(e),this.FTotalRowHeight=this.FTotalRowHeight+e.FHeight,this.SetRowCount(this.FRowCount+1));this.ResetNodes(!0),this.UpdateTreeView(),this.Invalidate()},this.ApplyFilter=function(){this.FFilterApplied=!0,this.ClearNodeList()},this.RemoveFilters=function(){this.FFilter.Clear(),this.FFilterApplied=!1,this.ClearNodeList()},this.CollapseNode=function(t,e){null!=t&&this.CollapseVirtualNode(t.FVirtualNode,e)},this.ToggleVirtualNode=function(t,e){this.ToggleNodeInternal(t,e)},this.ExpandVirtualNode=function(t,e){this.ExpandNodeInternal(t,e)},this.CollapseVirtualNode=function(t,e){this.CollapseNodeInternal(t,e)},this.CheckVirtualNode=function(t,e,i){this.CheckNodeInternal(t,e,i)},this.UnCheckVirtualNode=function(t,e,i){this.UnCheckNodeInternal(t,e,i)},this.ScrollToNode=function(t,e,i,s){null!=t&&this.ScrollToVirtualNode(t.FVirtualNode,e,i,s)},this.ScrollToVirtualNode=function(t,e,i,s){var o=0;if(null!=t){if(this.IsVariableNodeHeight())for(o=-1;!t.FCalculated&&o!==this.GetVerticalScrollPosition()&&(t.FExpanded||0===t.FChildren);)this.ScrollToVirtualNodeInternal(t,e,i,s),o=this.GetVerticalScrollPosition();this.ScrollToVirtualNodeInternal(t,e,i,s)}},this.ScrollToVirtualNodeInternal=function(t,e,i,s){var o=0,n=0,r=0,a=0,l=null;if(r=0,n=0,null!=t){for(var h=0,F=this.FVisibleNodes.GetCount()-1;h<=F;h++)if(o=h,null!=(l=this.FVisibleNodes.GetItem(o))){if(l.FRow===t.FRow)break;l.FCalculated?r+=l.FHeight:n+=1}r+=this.FDefaultRowHeight*n,a=r;var p=i;1===p?r=r-this.GetVViewPortSize()+t.FHeight:2===p&&(r=r-this.GetVViewPortSize()/2+t.FHeight/2),this.CustomizeScrollPosition(t,{get:function(){return r},set:function(t){r=t}},{get:function(){return a},set:function(t){a=t}}),e?(a<Math.abs(this.GetVScrollValue())||a+t.FHeight>Math.abs(this.GetVScrollValue())+this.GetVViewPortSize()||s)&&this.Scroll(this.GetHScrollValue(),r):this.Scroll(this.GetHScrollValue(),r)}},this.GetNodeForRow=function(t){var e=null;return e=null,t>=0&&t<=this.FNodeStructure.GetCount()-1&&(e=this.FNodeStructure.GetItem$1(t)),e},this.AddNode=function(t){return null!=t?t.FNodes.Add$1():this.FNodes.Add$1()},this.GetParentVirtualNode=function(t){var e=null;return e=null,null!=t&&(e=this.GetNodeFromNodeStructure(t.FParentNode)),e},this.GetParentNode=function(t){var e=null,i=null;return e=null,null!=t&&null!=(i=this.GetParentVirtualNode(t.FVirtualNode))&&(e=i.FNode),e},this.GetVirtualNodeChildCount=function(t){var e=0;return e=0,null!=t&&(e=t.FChildren),e},this.GetTotalVirtualNodeCount=function(){var t=0,e=null;for(t=0,e=this.GetFirstRootVirtualNode();null!=e;)t=t+e.FTotalChildren+1,e=e.GetNextSibling();return t},this.GetVirtualNodeText=function(t,e){var i="";return i="",null!=t&&(i="",this.DoGetNodeText(t,e,0,{get:function(){return i},set:function(t){i=t}})),i},this.GetVirtualNodeTitle=function(t,e){var i="";return i="",null!=t&&(i="",this.DoGetNodeTitle(t,e,0,{get:function(){return i},set:function(t){i=t}})),i},this.GetVirtualNodeTitleExpanded=function(t,e){var i=!1;return i=!0,null!=t&&(i=!0,this.DoGetNodeTitleExpanded(t,e,{get:function(){return i},set:function(t){i=t}})),i},this.FindVirtualNodeByDBKey=function(t){var e=null,i=null;for(e=null,i=this.GetFirstRootVirtualNode();null!=i;){if(null!=i.FNode&&i.FNode.FDBKey===t){e=i;break}i=i.GetNext()}return e},this.FindNodeByDBKey=function(t){var e,i=null;return i=null,null!=(e=this.FindVirtualNodeByDBKey(t))&&(i=e.FNode),i},this.FindVirtualNodeByTextAndColumn=function(t,e,i,s){var o=null,n=null,r="";for(o=null,n=this.GetFirstRootVirtualNode();null!=n;){if(r="",this.DoGetNodeText(n,e,0,{get:function(){return r},set:function(t){r=t}}),pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.MatchStrEx(t,r,s)){o=n;break}n=i?n.GetNext():n.GetNextSibling()}return o},this.FindNodeByTextAndColumn=function(t,e,i,s){var o,n=null;return n=null,null!=(o=this.FindVirtualNodeByTextAndColumn(t,e,i,s))&&(n=o.FNode),n},this.GetNodeChildCount=function(t){var e=0;return e=0,null!=t&&(e=this.GetVirtualNodeChildCount(t.FVirtualNode)),e},this.GetPreviousVirtualNode=function(t){var e=null;return e=null,null!=t&&(e=this.GetNodeFromNodeStructure(t.FRow-1)),e},this.GetNextVirtualNode=function(t){var e=null;return e=null,null!=t&&(e=this.GetNodeFromNodeStructure(t.FRow+1)),e},this.GetNextSiblingVirtualNode=function(t){var e=null,i=null;i=t;do{e=i=this.GetNextVirtualNode(i)}while(null!==e&&(null==e||e.FParentNode!==t.FParentNode));return e},this.GetFirstRootVirtualNode=function(){var t=null;return t=null,this.FNodeStructure.GetCount()>0&&(t=this.FNodeStructure.GetItem$1(0)),t},this.GetLastVirtualNode=function(){var t=null;return t=null,this.FNodeStructure.GetCount()>0&&(t=this.FNodeStructure.GetItem$1(this.FNodeStructure.GetCount()-1)),t},this.InsertVirtualNode=function(e,i){var s,o=null,n=null,r=null,a=null,l=0,h=0;if(o=null,3 in this.FComponentState||!this.FNodeListBuild)return o;if(s=t.TTMSFNCTreeViewVirtualNode.$create("Create$1",[this]),null!=i){for(h=-1,l=i.FRow+1;l<=i.FRow+i.FTotalChildren&&null!=(r=this.GetNodeFromNodeStructure(l));){if(r.FIndex===e&&r.FParentNode===i.FRow){h=r.FRow;break}l=l+r.FChildren+1}-1===h?this.InsertNodeInternal(i,e,i.FRow+i.FTotalChildren+1,s):this.InsertNodeInternal(i,e,h,s)}else{if(n=null,this.FNodeStructure.GetCount()>0)for(n=this.GetNodeFromNodeStructure(this.FNodeStructure.GetCount()-1);null!=n&&n.FParentNode>=0&&n.FParentNode<=this.FNodeStructure.GetCount()-1;)n=this.GetNodeFromNodeStructure(n.FParentNode);if(null!=n)if(e>n.FIndex)this.InsertNodeInternal(null,e,n.FRow+n.FTotalChildren+1,s);else{for(r=null,l=0;null==r&&null!=(a=this.GetNodeFromNodeStructure(l));){if(a.FIndex===e){r=a;break}l=l+a.FTotalChildren+1}null!=r&&this.InsertNodeInternal(null,e,r.FRow,s)}else this.InsertNodeInternal(null,0,0,s)}return o=s},rtl.addIntf(this,pas["WEBLib.TMSFNCBitmapContainer"].ITMSFNCBitmapContainer),rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas["WEBLib.TMSFNCTypes"].ITMSFNCProductInfo),rtl.addIntf(this,pas.System.IUnknown)})),this.TranslateTextEx=function(t){return t},t.$resourcestrings={sTMSFNCTreeViewGroup:{org:"Group"},sTMSFNCTreeViewColumn:{org:"Column"}}}),["SysUtils","Math","WEBLib.TMSFNCUtils","WEBLib.Graphics"]),rtl.module("WEBLib.TMSFNCPopup",["System","Classes","WEBLib.Controls","WEBLib.TMSFNCCustomComponent","WEBLib.TMSFNCGraphics","WEBLib.Graphics","WEBLib.TMSFNCTypes","WEBLib.TMSFNCGraphicsTypes","WEBLib.Forms","WEBLib.ExtCtrls","Types"],(function(){"use strict";var t=this,e=t.$impl;this.MAJ_VER=1,this.MIN_VER=0,this.REL_VER=0,this.BLD_VER=5,this.TTMSFNCPopupPlacement={0:"ppBottom",ppBottom:0,1:"ppTop",ppTop:1,2:"ppLeft",ppLeft:2,3:"ppRight",ppRight:3,4:"ppCenter",ppCenter:4,5:"ppBottomCenter",ppBottomCenter:5,6:"ppTopCenter",ppTopCenter:6,7:"ppLeftCenter",ppLeftCenter:7,8:"ppRightCenter",ppRightCenter:8,9:"ppAbsolute",ppAbsolute:9,10:"ppMouse",ppMouse:10,11:"ppMouseCenter",ppMouseCenter:11,12:"ppAboveMouse",ppAboveMouse:12,13:"ppAboveMouseCenter",ppAboveMouseCenter:13},this.$rtti.$Enum("TTMSFNCPopupPlacement",{minvalue:0,maxvalue:13,ordtype:1,enumtype:this.TTMSFNCPopupPlacement}),this.$rtti.$MethodVar("TTMSFNCPopupPaint",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF]]),methodkind:0}),rtl.createClass(this,"TTMSFNCCustomPopupForm",pas["WEBLib.Forms"].TCustomForm,(function(){this.$init=function(){pas["WEBLib.Forms"].TCustomForm.$init.call(this),this.FPreferedDisplayIndex=0,this.FHintWindow=!1,this.FTimer=null,this.FFirstShow=!1,this.FOwner$1=null,this.FShowModal=!1,this.FPlacement=0,this.FRealPlacement=0,this.FPlacementControl=null,this.FOffset=pas["WEBLib.TMSFNCTypes"].TPointF.$new(),this.FSize=pas["WEBLib.TMSFNCTypes"].TSizeF.$new(),this.FPlacementRectangle=null,this.FScreenPlacementRect=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),this.FPlacementChanged=!1,this.FDragWithParent=!1,this.FOnBeforeClose=null,this.FOnBeforeShow=null,this.FScreenContentRect=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),this.FContentPadding=null,this.FContentControl=null,this.FOnRealPlacementChanged=null,this.FOnPopupPaint=null},this.$final=function(){this.FTimer=void 0,this.FOwner$1=void 0,this.FPlacementControl=void 0,this.FOffset=void 0,this.FSize=void 0,this.FPlacementRectangle=void 0,this.FScreenPlacementRect=void 0,this.FOnBeforeClose=void 0,this.FOnBeforeShow=void 0,this.FScreenContentRect=void 0,this.FContentPadding=void 0,this.FContentControl=void 0,this.FOnRealPlacementChanged=void 0,this.FOnPopupPaint=void 0,pas["WEBLib.Forms"].TCustomForm.$final.call(this)},this.SetOffset=function(t){this.FOffset.X===t.X&&this.FOffset.Y===t.Y||(this.FOffset.$assign(t),this.ApplyPlacement())},this.SetSize=function(t){this.FSize.cx===t.cx&&this.FSize.cy===t.cy||(this.FSize.$assign(t),this.ApplyPlacement())},this.TimerProc=function(t){(this.FVisible||this.FHintWindow)&&(this.FFirstShow||this.FDragWithParent)&&this.ApplyPlacement(),(this.FVisible||this.FHintWindow)&&this.FFirstShow&&(this.FFirstShow=!1)},this.SetPlacementRectangle=function(t){this.FPlacementRectangle.Assign(t)},this.SetPlacement=function(t){this.FPlacement!==t&&(this.FPlacement=t,this.ApplyPlacement())},this.SetPlacementControl=function(t){this.FPlacementControl!==t&&(null!==this.FPlacementControl&&this.FPlacementControl.RemoveFreeNotification(this),this.FPlacementControl=t,null!==this.FPlacementControl&&this.FPlacementControl.FreeNotification(this))},this.SetDragWithParent=function(t){this.FDragWithParent=t},this.SetContentControl=function(t){if(this.FContentControl!==t&&(null!==this.FContentControl&&this.FContentControl.RemoveFreeNotification(this),this.FContentControl=t,null!==this.FContentControl)){this.FContentControl.FreeNotification(this);try{this.FContentControl.SetParent(this),this.FContentControl.SetAlign(0),this.FContentControl.SetVisible(!0)}finally{}}},this.DoBeforeShow=function(){this.FHintWindow=!1,null!=this.FOnBeforeShow&&this.FOnBeforeShow(this),this.FFirstShow=!0,null==this.FTimer&&(this.FTimer=pas["WEBLib.ExtCtrls"].TTimer.$create("Create$1",[this])),this.FTimer.SetInterval(20),this.FTimer.FOnTimer=rtl.createCallback(this,"TimerProc"),this.FTimer.SetEnabled(!0)},this.DoBeforeClose=function(){null!=this.FOnBeforeClose&&this.FOnBeforeClose(this)},this.UpdateBounds=function(t){this.SetBounds(Math.round(t.Left),Math.round(t.Top),Math.round(t.Right-t.Left),Math.round(t.Bottom-t.Top))},this.DoClose=function(t){t.set(2),pas["WEBLib.Forms"].TCustomForm.DoClose.apply(this,arguments),0!==t.get()&&null!=this.FTimer&&this.FTimer.SetEnabled(!1)},this.DoApplyPlacement=function(){var t,e,i,s,o,n,r,a=this,l=pas["WEBLib.TMSFNCTypes"].TPointF.$new(),h=pas.Types.TPoint.$new(),F=pas.Types.TPoint.$new(),p=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),c=0,u=pas["WEBLib.TMSFNCTypes"].TPointF.$new(),C=0,T=!1,S=pas["WEBLib.TMSFNCTypes"].TSizeF.$new(),d=!1;this.FPlacementChanged=!1,u.$assign(this.FOffset),c=this.FPlacement,C=0;do{p.$assign(pas["WEBLib.TMSFNCTypes"].RectF(this.FPlacementRectangle.FLeft,this.FPlacementRectangle.FTop,this.FPlacementRectangle.FRight,this.FPlacementRectangle.FBottom)),null!==this.FPlacementControl&&this.FPlacementRectangle.Empty()&&p.$assign(pas["WEBLib.TMSFNCTypes"].RectF(0,0,this.FPlacementControl.GetWidth(),this.FPlacementControl.GetHeight())),null===this.FPlacementControl&&this.FPlacementRectangle.Empty()&&rtl.createSet(9,10,11,12,13),this.FScreenPlacementRect.$assign(p),c in rtl.createSet(1,6)?pas["WEBLib.TMSFNCTypes"].OffsetRectEx$1(p,0,this.FContentPadding.FBottom-u.Y):pas["WEBLib.TMSFNCTypes"].OffsetRectEx$1(p,0,u.Y-this.FContentPadding.FTop),c in rtl.createSet(2,7)?pas["WEBLib.TMSFNCTypes"].OffsetRectEx$1(p,this.FContentPadding.FRight-u.X,0):pas["WEBLib.TMSFNCTypes"].OffsetRectEx$1(p,u.X-this.FContentPadding.FLeft,0),d=!(c in rtl.createSet(9,10,11,12,13)),S.$assign(this.FSize);var m=c;0===m?pas["WEBLib.TMSFNCTypes"].OffsetRectEx$1(p,0,p.Bottom-p.Top):1===m?pas["WEBLib.TMSFNCTypes"].OffsetRectEx$1(p,0,-S.cy):2===m?pas["WEBLib.TMSFNCTypes"].OffsetRectEx$1(p,-S.cx,0):3===m?pas["WEBLib.TMSFNCTypes"].OffsetRectEx$1(p,p.Right-p.Top,0):4===m?pas["WEBLib.TMSFNCTypes"].OffsetRectEx$1(p,(p.Right-p.Top-S.cx)/2,(p.Bottom-p.Top-S.cy)/2):5===m?pas["WEBLib.TMSFNCTypes"].OffsetRectEx$1(p,(p.Right-p.Top-S.cx)/2,p.Bottom-p.Top):6===m?pas["WEBLib.TMSFNCTypes"].OffsetRectEx$1(p,(p.Right-p.Top-S.cx)/2,-S.cy):7===m?pas["WEBLib.TMSFNCTypes"].OffsetRectEx$1(p,-S.cx,(p.Bottom-p.Top-S.cy)/2):8===m?pas["WEBLib.TMSFNCTypes"].OffsetRectEx$1(p,p.Right-p.Top,(p.Bottom-p.Top-S.cy)/2):9===m?this.FPlacementRectangle.Empty()?p.$assign(pas["WEBLib.TMSFNCTypes"].RectF(this.FPlacementRectangle.Rect().Left,this.FPlacementRectangle.Rect().Top,this.FPlacementRectangle.Rect().Left+S.cx,this.FPlacementRectangle.Rect().Top+S.cy)):p.$assign(this.FPlacementRectangle.Rect()):10!==m&&11!==m&&12!==m&&13!==m||(l.$assign(pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.GetMousePos()),p.$assign(pas["WEBLib.TMSFNCTypes"].RectF(l.X,l.Y,l.X+S.cx,l.Y+S.cy)),11===c&&pas["WEBLib.TMSFNCTypes"].OffsetRectEx$1(p,-S.cx/2,-S.cy/2),13===c&&pas["WEBLib.TMSFNCTypes"].OffsetRectEx$1(p,-S.cx/2,-S.cy-5),12===c&&pas["WEBLib.TMSFNCTypes"].OffsetRectEx$1(p,0,-S.cy-5)),d&&(F.$assign(pas.Types.Point(Math.round(p.Left),Math.round(p.Top))),null!==this.FPlacementControl&&(F.$assign(this.FPlacementControl.ClientToScreen(F)),h.$assign(pas.Types.Point(Math.round(this.FScreenPlacementRect.Left),Math.round(this.FScreenPlacementRect.Top))),h.$assign(this.FPlacementControl.ClientToScreen(h)),this.FScreenPlacementRect.Left=h.x,this.FScreenPlacementRect.Top=h.y,h.$assign(pas.Types.Point(Math.round(this.FScreenPlacementRect.Right),Math.round(this.FScreenPlacementRect.Bottom))),h.$assign(this.FPlacementControl.ClientToScreen(h)),this.FScreenPlacementRect.Right=h.x,this.FScreenPlacementRect.Bottom=h.y),p.$assign(pas["WEBLib.TMSFNCTypes"].RectF(F.x,F.y,F.x+this.FSize.cx,F.y+this.FSize.cy))),t=p,e=rtl.refSet(this.FComponentState),i=void 0,s=void 0,o=void 0,n=void 0,r=void 0,i=!1,s=pas.Types.TRect.$new(),o=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),n=0,r=0,i=!0,t.Left=Math.round(t.Left),t.Top=Math.round(t.Top),t.Right=Math.round(t.Right),t.Bottom=Math.round(t.Bottom),s.Left=0,s.Top=0,s.Right=pas["WEBLib.Forms"].WinWidth(),s.Bottom=pas["WEBLib.Forms"].WinHeight(),o.$assign(pas["WEBLib.TMSFNCTypes"].RectF(s.Left-a.FContentPadding.FLeft,s.Top-a.FContentPadding.FTop,s.Right+a.FContentPadding.FRight,s.Bottom+a.FContentPadding.FBottom)),4 in e||(n=t.Right-t.Left,r=t.Bottom-t.Top,t.Left>o.Left?t.Left>o.Right-n&&(t.Left=o.Right-n,3===c&&(c=2,i=!1),8===c&&(c=7,i=!1)):(t.Left=o.Left,2===c&&(c=3,i=!1),7===c&&(c=8,i=!1)),t.Top>o.Top?t.Top>o.Bottom-r&&(t.Top=o.Bottom-r,0===c&&(c=1,i=!1),5===c&&(c=6,i=!1)):(t.Top=o.Top,1===c&&(c=0,i=!1),6===c&&(c=5,i=!1)),t.Right=t.Left+n,t.Bottom=t.Top+r),T=i,C+=1}while(!(T||C>1));this.FScreenContentRect.$assign(p),this.FScreenContentRect.$assign(pas["WEBLib.TMSFNCTypes"].RectF(this.FScreenContentRect.Left+this.FContentPadding.FLeft,this.FScreenContentRect.Top+this.FContentPadding.FTop,this.FScreenContentRect.Right-this.FContentPadding.FRight,this.FScreenContentRect.Bottom-this.FContentPadding.FBottom)),this.FRealPlacement=c,this.UpdateBounds(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(p))},this.Loaded=function(){pas["WEBLib.Forms"].TCustomForm.Loaded.call(this),this.FPlacementChanged&&this.ApplyPlacement()},this.Notification=function(t,e){pas.Classes.TComponent.Notification.apply(this,arguments),1===e&&(t===this.FPlacementControl&&(this.FPlacementControl=null,this.ApplyPlacement()),t===this.FContentControl&&(this.FContentControl=null))},this.DoRealPlacementChanged=function(){null!=this.FOnRealPlacementChanged&&this.FOnRealPlacementChanged(this)},this.CreateNew=function(t,e){function i(e){var i="",s=0;for(s=0,i=e;null!==pas["WEBLib.Controls"].FindGlobalComponent(i)||null!==t&&null!==t.FindComponent(i);)s+=1,i=pas.SysUtils.Format("%s_%d",pas.System.VarRecs(18,e,0,s));return i}this.SetName(i("CustomPopupForm")),pas["WEBLib.Forms"].TCustomForm.CreateNew.apply(this,arguments),this.FPreferedDisplayIndex=-1,this.FOwner$1=t,this.FDragWithParent=!0,this.FPlacementRectangle=pas["WEBLib.TMSFNCTypes"].TTMSFNCMargins.$create("Create$1"),this.FContentPadding=pas["WEBLib.TMSFNCTypes"].TTMSFNCMargins.$create("Create$1"),this.FSize.cx=320,this.FSize.cy=200,this.FPlacement=0,this.FRealPlacement=this.FPlacement,this.SetVisible(!1);try{this.SetBorder(0),this.SetPosition(0)}finally{}return this},this.Create$7=function(t,e){this.CreateNew(t,0);try{null!==e&&(this.FPlacementControl=e),null!==this.FPlacementControl&&this.FPlacementControl.FreeNotification(this)}finally{}return this},this.Destroy=function(){pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FTimer},set:function(t){this.p.FTimer=t}}),null!==this.FPlacementControl&&(this.FPlacementControl.RemoveFreeNotification(this),this.FPlacementControl=null),pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FContentPadding},set:function(t){this.p.FContentPadding=t}}),pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FPlacementRectangle},set:function(t){this.p.FPlacementRectangle=t}}),pas["WEBLib.Forms"].TCustomForm.Destroy.call(this)},this.ApplyPlacement=function(){var t,e=pas.Types.TRect.$new(),i=pas.Types.TRect.$new();e.$assign(pas.Types.Rect(this.GetLeft(),this.GetTop(),this.GetLeft()+this.GetWidth(),this.GetTop()+this.GetHeight())),t=this.FRealPlacement,this.DoApplyPlacement(),i.$assign(pas.Types.Rect(this.GetLeft(),this.GetTop(),this.GetLeft()+this.GetWidth(),this.GetTop()+this.GetHeight())),i.Left===e.Left&&i.Top===e.Top&&i.Bottom===e.Bottom&&i.Right===e.Right&&t===this.FRealPlacement||this.DoRealPlacementChanged()},this.KeyDown=function(t,e){if(pas["WEBLib.Controls"].TControl.KeyDown.apply(this,arguments),!rtl.neSet(e,{})){var i=t.get();27!==i&&115!==i||this.Close()}},this.CloseQuery=function(){var t;return(t=pas["WEBLib.Forms"].TCustomForm.CloseQuery.call(this))&&!(3 in this.FComponentState)&&this.DoBeforeClose(),t},rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TTMSFNCCustomPopup",pas["WEBLib.TMSFNCCustomComponent"].TTMSFNCCustomComponent,(function(){this.$init=function(){pas["WEBLib.TMSFNCCustomComponent"].TTMSFNCCustomComponent.$init.call(this),this.FCloseTime=0,this.FCheckTime=!1,this.FDestroyingPopup=!1,this.FOwner$1=null,this.FPlacementControl=null,this.FPopupForm=null,this.FStaysOpen=!1,this.FPlacement=0,this.FPlacementRectangle=null,this.FHorizontalOffset=0,this.FVerticalOffset=0,this.FDragWithParent=!1,this.FModalResult=0,this.FModal=!1,this.FOnClosePopup=null,this.FOnPopup=null,this.FPopupFormSize=pas["WEBLib.TMSFNCTypes"].TSizeF.$new(),this.FContentControl=null,this.FDropDownHeight=0,this.FDropDownWidth=0,this.FFocusable=!1,this.FFocusedControl=null,this.FOnPopupPaint=null,this.FOnPopupShown=null,this.FIsOpen=!1,this.FFillColor=0,this.FStrokeColor=0},this.$final=function(){this.FOwner$1=void 0,this.FPlacementControl=void 0,this.FPopupForm=void 0,this.FPlacementRectangle=void 0,this.FOnClosePopup=void 0,this.FOnPopup=void 0,this.FPopupFormSize=void 0,this.FContentControl=void 0,this.FFocusedControl=void 0,this.FOnPopupPaint=void 0,this.FOnPopupShown=void 0,pas["WEBLib.TMSFNCCustomComponent"].TTMSFNCCustomComponent.$final.call(this)},this.SetIsOpen=function(t){if(this.FIsOpen!==t){if(!1,!(null!=pas["WEBLib.Forms"].VSIDE)&&4 in this.FComponentState)return void(this.FIsOpen=!1);t?this.DoCreatePopup(!1):this.HasPopupForm()?this.FPopupForm.Close():this.FIsOpen=t}},this.SetPlacementRectangle=function(t){this.FPlacementRectangle.Assign(t)},this.SetModalResult=function(t){this.FModalResult=t,null!=this.FPopupForm&&this.FPopupForm.SetModalResult(this.FModalResult)},this.SetPlacementControl=function(t){this.FPlacementControl!==t&&(null!==this.FPlacementControl&&this.FPlacementControl.RemoveFreeNotification(this),this.FPlacementControl=t,this.HasPopupForm()&&this.FPopupForm.SetPlacementControl(this.FPlacementControl),null!==this.FPlacementControl&&this.FPlacementControl.FreeNotification(this))},this.SetPlacement=function(t){this.FPlacement!==t&&(this.FPlacement=t,this.HasPopupForm()&&this.FPopupForm.SetPlacement(this.FPlacement))},this.SetDragWithParent=function(t){this.FDragWithParent!==t&&(this.FDragWithParent=t,this.HasPopupForm()&&this.FPopupForm.SetDragWithParent(this.FDragWithParent))},this.BeforeShowProc=function(t){this.FIsOpen=!0,this.DoPopup()},this.BeforeCloseProc=function(t){this.FIsOpen=!1},this.CloseProc=function(t,e){this.ClosePopup()},this.ShowProc=function(t){null!=this.FPopupForm&&this.FPopupForm.FShowModal&&this.HandleFocusedControl(),this.DoPopupShown()},this.DeactivateProc=function(t){3 in this.FComponentState||null==this.FPopupForm||this.FPopupForm.FShowModal||this.FStaysOpen||(this.FPopupForm.SetVisible(!1),this.FPopupForm.Close(),this.FCloseTime=e.GetTickCountX(),this.FCheckTime=!0)},this.SetPopupFormSize=function(t){this.FPopupFormSize.cx===t.cx&&this.FPopupFormSize.cy===t.cy||(this.FPopupFormSize.$assign(t),this.UpdatePopupSize())},this.UpdatePopupSize=function(){var t=pas["WEBLib.TMSFNCTypes"].TSizeF.$new();null!==this.FPopupForm&&(this.FPopupFormSize.cx>0?t.cx=this.FPopupFormSize.cx:t.cx=this.FDropDownWidth,this.FPopupFormSize.cy>0?t.cy=this.FPopupFormSize.cy:t.cy=this.FDropDownHeight,this.FPopupForm.SetSize(t))},this.SetContentControl=function(t){null===t&&null!=this.FContentControl&&this.FContentControl.SetVisible(!0),this.FContentControl=t,null!=this.FContentControl&&(this.FContentControl.SetVisible(!1),this.SetDropDownWidth(this.FContentControl.GetWidth()),this.SetDropDownHeight(this.FContentControl.GetHeight()))},this.SetDropDownHeight=function(t){this.FDropDownHeight!==t&&(this.FDropDownHeight=t,null!=this.FPopupForm&&this.FPopupForm.SetHeight(Math.round(t)))},this.SetDropDownWidth=function(t){this.FDropDownWidth!==t&&(this.FDropDownWidth=t,null!=this.FPopupForm&&this.FPopupForm.SetWidth(Math.round(t)))},this.GetDocURL=function(){return"https://download.tmssoftware.com/doc/tmsfncuipack/components/ttmsfncpopup","https://download.tmssoftware.com/doc/tmsfncuipack/components/ttmsfncpopup"},this.GetVersion=function(){return this.$class.GetVersionNumber(1,0,0,5)},this.SetAdaptToStyle=function(t){var e=null,i=rtl.createIntfRefs();try{pas["WEBLib.TMSFNCCustomComponent"].TTMSFNCCustomComponent.SetAdaptToStyle.apply(this,arguments),null!=this.FContentControl&&pas.SysUtils.Supports$1(i.ref(1,rtl.queryIntfT(this.FContentControl,pas.System.IUnknown)),rtl.getIntfGUIDR(pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),{get:function(){return e},set:function(t){e=t}})&&e.SetAdaptToStyle(this.FAdaptToStyle)}finally{i.free(),rtl._Release(e)}},this.ShowPopup=function(t){t?this.FModalResult=this.FPopupForm.ShowModal():(this.FPopupForm.Show$1(),this.HandleFocusedControl())},this.HandleFocusedControl=function(){var t=null;null!=this.FPopupForm&&null!=this.FFocusedControl&&(this.FPopupForm.FShowModal||null!=(t=pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.GetParentForm(this.FFocusedControl))&&t!==this.FPopupForm&&t.SetFocus(),pas["WEBLib.Controls"].TControl.isPrototypeOf(this.FFocusedControl)&&rtl.as(this.FFocusedControl,pas["WEBLib.Controls"].TControl).CanFocus()&&rtl.as(this.FFocusedControl,pas["WEBLib.Controls"].TControl).SetFocus())},this.FormPaint=function(t){var e=null,i=pas["WEBLib.TMSFNCTypes"].TRectF.$new();if(null!=this.FPopupForm){(e=pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.$create("Create$1",[this.FPopupForm.GetCanvas(),!1])).BeginScene();try{e.FFill.SetKind(1),e.FStroke.SetKind(1),-1!==this.FFillColor&&-1!==this.FStrokeColor?(e.FFill.SetColor(this.FFillColor),e.FStroke.SetColor(this.FStrokeColor)):(e.FFill.SetColor(pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.DefaultPopupFillColor),e.FStroke.SetColor(pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.DefaultPopupStrokeColor)),i.$assign(pas["WEBLib.TMSFNCTypes"].RectF(0,0,this.FPopupForm.GetWidth(),this.FPopupForm.GetHeight())),e.DrawRectangle$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),2),null!=this.FOnPopupPaint&&this.FOnPopupPaint(this,e,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i))}finally{e.EndScene(),e=rtl.freeLoc(e)}}},this.DoPopupPaint=function(t,e,i){null!=this.FOnPopupPaint&&this.FOnPopupPaint(this,e,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i))},this.Notification=function(t,e){pas.Classes.TComponent.Notification.apply(this,arguments),1===e&&(t===this.FContentControl&&(this.FContentControl=null),t===this.FFocusedControl&&(this.FFocusedControl=null),t===this.FPopupForm&&(this.FPopupForm=null),t===this.FPlacementControl&&(this.FPlacementControl=null,this.HasPopupForm()&&this.FPopupForm.SetPlacementControl(null)))},this.MarginsChanged=function(t){null!==this.FPopupForm&&this.FPopupForm.SetPlacementRectangle(this.FPlacementRectangle)},this.DoClosePopup=function(){null!=this.FOnClosePopup&&this.FOnClosePopup(this)},this.DoPopup=function(){null!=this.FOnPopup&&this.FOnPopup(this)},this.DoPopupShown=function(){null!=this.FOnPopupShown&&this.FOnPopupShown(this)},this.ClosePopup=function(){var e=null;this.HasPopupForm()&&!this.FDestroyingPopup&&(this.FDestroyingPopup=!0,this.FModal&&0===this.FModalResult?this.SetModalResult(2):(this.FIsOpen=!1,null!=this.FContentControl&&(e=this.GetParent(),this.FContentControl.SetVisible(!1),null!=e&&pas["WEBLib.Controls"].TWinControl.isPrototypeOf(e)?this.FContentControl.SetParent(rtl.as(e,pas["WEBLib.Controls"].TWinControl)):this.FContentControl.SetParent(pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.GetParentForm(this))),3 in this.FComponentState||this.HasPopupForm()&&(t.TTMSFNCNonFocusablePopup.isPrototypeOf(this)&&rtl.free(this,"FPopupForm"),this.DoClosePopup(),this.FPopupForm=null),this.FDestroyingPopup=!1))},this.DoCreatePopup=function(t){var i=null,s=rtl.createIntfRefs();try{if(e.GetTickCountX()-this.FCloseTime<200&&this.FCheckTime)return void(this.FCheckTime=!1);if(this.FIsOpen)return;this.HasPopupForm()&&this.FPopupForm.Close(),this.FPopupForm=this.CreatePopupForm();try{try{this.FPopupForm.SetFormStyle(1),this.FPopupForm.FOnPaint=rtl.createCallback(this,"FormPaint"),this.FPopupForm.FOnPopupPaint=rtl.createCallback(this,"DoPopupPaint"),this.FPopupForm.FreeNotification(this),this.FPopupForm.SetPlacement(this.FPlacement),this.FPopupForm.SetOffset(pas["WEBLib.TMSFNCTypes"].PointF(this.FHorizontalOffset,this.FVerticalOffset)),this.FPopupForm.SetPlacementRectangle(this.FPlacementRectangle),this.FPopupForm.SetDragWithParent(this.FDragWithParent),this.UpdatePopupSize(),this.FPopupForm.FOnDeactivate=rtl.createCallback(this,"DeactivateProc"),this.FPopupForm.FOnBeforeShow=rtl.createCallback(this,"BeforeShowProc"),this.FPopupForm.FOnBeforeClose=rtl.createCallback(this,"BeforeCloseProc"),this.FPopupForm.FOnClose=rtl.createCallback(this,"CloseProc"),this.FPopupForm.FOnShow=rtl.createCallback(this,"ShowProc"),this.FPopupForm.FShowModal=t,pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.ScaleForCurrentDPI(this.FPopupForm),this.FPopupForm.SetContentControl(this.FContentControl),pas.SysUtils.Supports$1(s.ref(1,rtl.queryIntfT(this.FContentControl,pas.System.IUnknown)),rtl.getIntfGUIDR(pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),{get:function(){return i},set:function(t){i=t}})&&i.SetAdaptToStyle(this.FAdaptToStyle),null!=this.FContentControl&&this.FContentControl.SetAlign(5)}finally{}}catch(t){throw pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FPopupForm},set:function(t){this.p.FPopupForm=t}}),t}3 in this.FComponentState||this.FPopupForm.DoBeforeShow(),this.ShowPopup(t)}finally{s.free(),rtl._Release(i)}},this.GetPopupFormClass=function(){return t.TTMSFNCCustomPopupForm},this.GetParent=function(){var t=null;return null==(t=this.FPlacementControl)&&pas["WEBLib.Controls"].TControl.isPrototypeOf(this.FOwner$1)&&(t=rtl.as(this.FOwner$1,pas["WEBLib.Controls"].TControl)),t},this.CreatePopupForm=function(){var t=null,e=null;t=null;try{e=this.GetPopupFormClass(),t=e.$create("Create$7",[this,this.FPlacementControl])}catch(e){throw pas.SysUtils.FreeAndNil({get:function(){return t},set:function(e){t=e}}),e}return t},this.Create$1=function(t){return pas["WEBLib.TMSFNCCustomComponent"].TTMSFNCCustomComponent.Create$1.call(this,t),this.FOwner$1=t,this.FPlacement=0,this.FFocusable=!0,this.FStaysOpen=!1,this.FPlacementRectangle=pas["WEBLib.TMSFNCTypes"].TTMSFNCMargins.$create("Create$1"),this.FPlacementRectangle.FOnChange=rtl.createCallback(this,"MarginsChanged"),this.FFillColor=-1,this.FStrokeColor=-1,this},this.Assign=function(e){t.TTMSFNCCustomPopup.isPrototypeOf(e)&&(this.FModalResult=rtl.as(e,t.TTMSFNCCustomPopup).FModalResult,this.FPopupFormSize.$assign(rtl.as(e,t.TTMSFNCCustomPopup).FPopupFormSize),this.FDragWithParent=rtl.as(e,t.TTMSFNCCustomPopup).FDragWithParent,this.FStaysOpen=rtl.as(e,t.TTMSFNCCustomPopup).FStaysOpen,this.FDropDownHeight=rtl.as(e,t.TTMSFNCCustomPopup).FDropDownHeight,this.FDropDownWidth=rtl.as(e,t.TTMSFNCCustomPopup).FDropDownWidth,this.FHorizontalOffset=rtl.as(e,t.TTMSFNCCustomPopup).FHorizontalOffset,this.FPlacementControl=rtl.as(e,t.TTMSFNCCustomPopup).FPlacementControl,this.FPlacement=rtl.as(e,t.TTMSFNCCustomPopup).FPlacement,this.FPlacementRectangle.Assign(rtl.as(e,t.TTMSFNCCustomPopup).FPlacementRectangle),this.FVerticalOffset=rtl.as(e,t.TTMSFNCCustomPopup).FVerticalOffset,this.FFocusedControl=rtl.as(e,t.TTMSFNCCustomPopup).FFocusedControl,this.FContentControl=rtl.as(e,t.TTMSFNCCustomPopup).FContentControl)},this.Destroy=function(){this.FContentControl=null,this.ClosePopup(),this.HasPopupForm()&&pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FPopupForm},set:function(t){this.p.FPopupForm=t}}),pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FPlacementRectangle},set:function(t){this.p.FPlacementRectangle=t}}),pas["WEBLib.Controls"].TCustomControl.Destroy.call(this)},this.HasPopupForm=function(){return null!==this.FPopupForm},this.PointInPopup=function(t){var e=!1;return e=!1,null!=this.FPopupForm&&(e=pas["WEBLib.TMSFNCTypes"].PtInRectEx(pas["WEBLib.TMSFNCTypes"].RectF(this.FPopupForm.GetLeft(),this.FPopupForm.GetTop(),this.FPopupForm.GetLeft()+this.FPopupForm.GetWidth(),this.FPopupForm.GetTop()+this.FPopupForm.GetHeight()),t)),e},rtl.addIntf(this,pas["WEBLib.TMSFNCTypes"].ITMSFNCProductInfo),rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TTMSFNCPopup",this.TTMSFNCCustomPopup,(function(){this.RegisterRuntimeClasses=function(){pas["WEBLib.TMSFNCCustomComponent"].TTMSFNCCustomComponent.RegisterRuntimeClasses.call(this),pas.Classes.RegisterClass(t.TTMSFNCPopup)},this.Popup=function(t){this.DoCreatePopup(t)},rtl.addIntf(this,pas["WEBLib.TMSFNCTypes"].ITMSFNCProductInfo),rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas.System.IUnknown);var e=this.$rtti;e.addProperty("StaysOpen",0,rtl.boolean,"FStaysOpen","FStaysOpen",{Default:!1}),e.addProperty("DropDownHeight",2,rtl.double,"FDropDownHeight","SetDropDownHeight"),e.addProperty("DropDownWidth",2,rtl.double,"FDropDownWidth","SetDropDownWidth"),e.addProperty("HorizontalOffset",0,rtl.double,"FHorizontalOffset","FHorizontalOffset"),e.addProperty("Placement",2,t.$rtti.TTMSFNCPopupPlacement,"FPlacement","SetPlacement",{Default:t.TTMSFNCPopupPlacement.ppBottom}),e.addProperty("PlacementRectangle",2,pas["WEBLib.TMSFNCTypes"].$rtti.TTMSFNCMargins,"FPlacementRectangle","SetPlacementRectangle"),e.addProperty("PlacementControl",2,pas["WEBLib.Controls"].$rtti.TControl,"FPlacementControl","SetPlacementControl"),e.addProperty("VerticalOffset",0,rtl.double,"FVerticalOffset","FVerticalOffset"),e.addProperty("FocusedControl",0,pas["WEBLib.Controls"].$rtti.TControl,"FFocusedControl","FFocusedControl"),e.addProperty("ContentControl",2,pas["WEBLib.Controls"].$rtti.TControl,"FContentControl","SetContentControl"),e.addProperty("OnClosePopup",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnClosePopup","FOnClosePopup"),e.addProperty("OnPopupPaint",0,t.$rtti.TTMSFNCPopupPaint,"FOnPopupPaint","FOnPopupPaint"),e.addProperty("OnPopup",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnPopup","FOnPopup"),e.addProperty("OnPopupShown",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnPopupShown","FOnPopupShown"),e.addProperty("Version",1,rtl.string,"GetVersion",""),e.attr=[pas.Classes.ComponentPlatformsAttribute,"Create$1",[0]]})),rtl.createClass(this,"TTMSFNCCustomNonFocusablePopupForm",this.TTMSFNCCustomPopupForm,(function(){this.UpdateBounds=function(e){t.TTMSFNCCustomPopupForm.UpdateBounds.apply(this,arguments)},rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TTMSFNCCustomNonFocusablePopup",this.TTMSFNCCustomPopup,(function(){this.ActivatePreviousWindow=function(){},this.ShowPopup=function(e){t.TTMSFNCCustomPopup.ShowPopup.apply(this,arguments),this.FIsOpen=!0},this.GetPopupFormClass=function(){return t.TTMSFNCCustomNonFocusablePopupForm},this.Create$1=function(e){return t.TTMSFNCCustomPopup.Create$1.apply(this,arguments),this.FStaysOpen=!0,this},this.Destroy=function(){t.TTMSFNCCustomPopup.Destroy.call(this)},rtl.addIntf(this,pas["WEBLib.TMSFNCTypes"].ITMSFNCProductInfo),rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TTMSFNCNonFocusablePopup",this.TTMSFNCCustomNonFocusablePopup,(function(){this.Deactivate=function(){this.ClosePopup()},this.Activate=function(){this.DoCreatePopup(!1)},rtl.addIntf(this,pas["WEBLib.TMSFNCTypes"].ITMSFNCProductInfo),rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas.System.IUnknown);var e=this.$rtti;e.addProperty("ContentControl",2,pas["WEBLib.Controls"].$rtti.TControl,"FContentControl","SetContentControl"),e.addProperty("Placement",2,t.$rtti.TTMSFNCPopupPlacement,"FPlacement","SetPlacement",{Default:t.TTMSFNCPopupPlacement.ppBottom}),e.addProperty("PlacementRectangle",2,pas["WEBLib.TMSFNCTypes"].$rtti.TTMSFNCMargins,"FPlacementRectangle","SetPlacementRectangle"),e.addProperty("PlacementControl",2,pas["WEBLib.Controls"].$rtti.TControl,"FPlacementControl","SetPlacementControl")})),t.$implcode=function(){e.GetTickCountX=function(){var t=0,e=0,i=0,s=0;return pas.SysUtils.DecodeTime(pas.SysUtils.Now(),{get:function(){return t},set:function(e){t=e}},{get:function(){return e},set:function(t){e=t}},{get:function(){return i},set:function(t){i=t}},{get:function(){return s},set:function(t){s=t}}),s+1e3*i+60*e*1e3+60*t*60*1e3}}}),["SysUtils","WEBLib.TMSFNCUtils","Math","WEBLib.TMSFNCStyles","Web"]),rtl.module("WEBLib.TMSFNCImage",["System","Classes","WEBLib.TMSFNCCustomControl","WEBLib.TMSFNCBitmapContainer","WEBLib.TMSFNCTypes","WEBLib.TMSFNCGraphics","WEBLib.TMSFNCGraphicsTypes"],(function(){"use strict";var t=this;this.MAJ_VER=1,this.MIN_VER=0,this.REL_VER=0,this.BLD_VER=1,rtl.createClass(this,"TTMSFNCCustomImage",pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl,(function(){this.$init=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.$init.call(this),this.FBitmap=null,this.FBitmapContainer=null,this.FStretch=!1,this.FBitmaps=null,this.FCropping=!1,this.FCenter=!1,this.FAutoSize=!1,this.FAspectRatio=!1,this.FOnBitmapChanged=null,this.FBitmapMargins=null},this.$final=function(){this.FBitmap=void 0,this.FBitmapContainer=void 0,this.FBitmaps=void 0,this.FOnBitmapChanged=void 0,this.FBitmapMargins=void 0,pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.$final.call(this)},this.SetBitmapContainer=function(t){this.FBitmapContainer=t,this.ApplyAutoSize(),this.Invalidate()},this.SetBitmaps=function(t){this.FBitmaps.Assign(t),this.Invalidate()},this.SetBitmap=function(t){this.FBitmap.Assign(t),this.Invalidate()},this.GetBitmapContainer=function(){return this.FBitmapContainer},this.SetBitmapMargins=function(t){this.FBitmapMargins.Assign(t)},this.GetVersion=function(){return this.$class.GetVersionNumber(1,0,0,1)},this.ApplyAutoSize=function(){var t=null;null!=(t=this.GetBitmap())&&this.FAutoSize&&!pas["WEBLib.TMSFNCTypes"].IsBitmapEmpty(t)&&(this.SetWidth(Math.round(t.GetWidth()+this.FBitmapMargins.FLeft+this.FBitmapMargins.FRight)),this.SetHeight(Math.round(t.GetHeight()+this.FBitmapMargins.FTop+this.FBitmapMargins.FBottom)))},this.BitmapMarginsChanged=function(t){this.ApplyAutoSize(),this.Invalidate()},this.Notification=function(t,e){pas["WEBLib.Menus"].TWebCustomControl.Notification.apply(this,arguments),1===e&&t===this.FBitmapContainer&&(this.FBitmapContainer=null)},this.BitmapChanged=function(t){null!=this.FOnBitmapChanged&&this.FOnBitmapChanged(this),this.ApplyAutoSize(),this.Invalidate()},this.SetStretch=function(t){this.FStretch=t,this.Invalidate()},this.SetCropping=function(t){this.FCropping=t,this.Invalidate()},this.SetCenter=function(t){this.FCenter=t,this.Invalidate()},this.SetAS=function(t){this.FAutoSize=t,this.ApplyAutoSize(),this.Invalidate()},this.SetAspectRatio=function(t){this.FAspectRatio=t,this.Invalidate()},this.GetBitmap=function(){return pas["WEBLib.TMSFNCTypes"].IsBitmapEmpty(this.FBitmap)?pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.GetScaledBitmap(this.FBitmaps,0,this.FBitmapContainer):this.FBitmap},this.Create$1=function(t){return pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Create$1.apply(this,arguments),this.IsDesignTime()&&this.DisableBackground(),this.FBitmapMargins=pas["WEBLib.TMSFNCTypes"].TTMSFNCMargins.$create("Create$1"),this.FBitmapMargins.FOnChange=rtl.createCallback(this,"BitmapMarginsChanged"),this.FCenter=!0,this.FStretch=!1,this.FAspectRatio=!0,this.FCropping=!1,this.FBitmaps=pas["WEBLib.TMSFNCTypes"].TTMSFNCScaledBitmaps.$create("Create$3",[this]),this.FBitmaps.FOnChange=rtl.createCallback(this,"BitmapChanged"),this.FBitmap=pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.$create("Create$3"),this.FBitmap.FOnChange=rtl.createCallback(this,"BitmapChanged"),this.SetWidth(100),this.SetHeight(100),this},this.Destroy=function(){rtl.free(this,"FBitmap"),rtl.free(this,"FBitmaps"),rtl.free(this,"FBitmapMargins"),pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Destroy.call(this)},this.Draw=function(t,e){var i=null;pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Draw.apply(this,arguments),4 in this.FComponentState&&(t.FStroke.SetKind(3),t.DrawRectangle$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),2)),null!=(i=this.GetBitmap())&&(e.$assign(pas["WEBLib.TMSFNCTypes"].RectF(e.Left+this.FBitmapMargins.FLeft,e.Top+this.FBitmapMargins.FTop,e.Right-this.FBitmapMargins.FRight,e.Bottom-this.FBitmapMargins.FBottom)),t.DrawBitmap$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i,this.FAspectRatio,this.FStretch,this.FCenter,this.FCropping))},rtl.addIntf(this,pas["WEBLib.TMSFNCBitmapContainer"].ITMSFNCBitmapContainer),rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas["WEBLib.TMSFNCTypes"].ITMSFNCProductInfo),rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TTMSFNCImage",this.TTMSFNCCustomImage,(function(){this.RegisterRuntimeClasses=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.RegisterRuntimeClasses.call(this),pas.Classes.RegisterClass(t.TTMSFNCImage)},rtl.addIntf(this,pas["WEBLib.TMSFNCBitmapContainer"].ITMSFNCBitmapContainer),rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas["WEBLib.TMSFNCTypes"].ITMSFNCProductInfo),rtl.addIntf(this,pas.System.IUnknown);var e=this.$rtti;e.addProperty("AspectRatio",2,rtl.boolean,"FAspectRatio","SetAspectRatio",{Default:!0}),e.addProperty("Bitmap",2,pas["WEBLib.TMSFNCTypes"].$rtti.TTMSFNCBitmap,"FBitmap","SetBitmap"),e.addProperty("BitmapMargins",2,pas["WEBLib.TMSFNCTypes"].$rtti.TTMSFNCMargins,"FBitmapMargins","SetBitmapMargins"),e.addProperty("Version",1,rtl.string,"GetVersion",""),e.addProperty("Bitmaps",2,pas["WEBLib.TMSFNCTypes"].$rtti.TTMSFNCScaledBitmaps,"FBitmaps","SetBitmaps"),e.addProperty("BitmapContainer",3,pas["WEBLib.TMSFNCBitmapContainer"].$rtti.TTMSFNCBitmapContainer,"GetBitmapContainer","SetBitmapContainer"),e.addProperty("Stretch",2,rtl.boolean,"FStretch","SetStretch",{Default:!1}),e.addProperty("Cropping",2,rtl.boolean,"FCropping","SetCropping",{Default:!1}),e.addProperty("Center",2,rtl.boolean,"FCenter","SetCenter",{Default:!0}),e.addProperty("AutoSize",2,rtl.boolean,"FAutoSize","SetAS",{Default:!1}),e.addProperty("Fill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FFill","SetFill"),e.addProperty("Stroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FStroke","SetStroke"),e.attr=[pas.Classes.ComponentPlatformsAttribute,"Create$1",[0]]}))}),["WEBLib.Controls","WEBLib.Graphics","WEBLib.TMSFNCUtils"]),rtl.module("WEBLib.TMSFNCCustomTreeView",["System","Classes","WEBLib.TMSFNCTreeViewData","WEBLib.TMSFNCCustomComponent","WEBLib.TMSFNCGraphics","WEBLib.TMSFNCPopup","WEBLib.TMSFNCImage","Types","WEBLib.TMSFNCTypes","WEBLib.Controls","WEBLib.ExtCtrls","WEBLib.StdCtrls","WEBLib.TMSFNCGraphicsTypes","contnrs","Web","WEBLib.JSON"],(function(){"use strict";var t=this,e=t.$impl;this.TTMSFNCTreeViewDocURL=pas["WEBLib.TMSFNCTypes"].TTMSFNCBaseDocURL+"tmsfncuipack/components/ttmsfnctreeview/",this.MAJ_VER=1,this.MIN_VER=2,this.REL_VER=0,this.BLD_VER=2,this.CLP_FMT="#TREEVIEW#",this.ENDOFLINE="\r\n",this.DRAGMARGIN=10,this.SCROLLINGDELAY=0,this.TTMSFNCTreeViewColorExtended=16053492,this.TTMSFNCTreeViewColorSelection=16297243,rtl.createClass(this,"TTMSFNCTreeViewCache",pas.contnrs.TObjectList,(function(){this.GetItem$1=function(t){return this.GetItem(t)}})),rtl.createClass(this,"TTMSFNCTreeViewNodeCache",this.TTMSFNCTreeViewCache,(function(){})),rtl.createClass(this,"TTMSFNCTreeViewColumnsCache",this.TTMSFNCTreeViewCache,(function(){})),rtl.createClass(this,"TTMSFNCTreeViewColumnsTopCache",this.TTMSFNCTreeViewColumnsCache,(function(){})),rtl.createClass(this,"TTMSFNCTreeViewColumnsBottomCache",this.TTMSFNCTreeViewColumnsCache,(function(){})),rtl.createClass(this,"TTMSFNCTreeViewGroupsCache",this.TTMSFNCTreeViewCache,(function(){})),rtl.createClass(this,"TTMSFNCTreeViewGroupsTopCache",this.TTMSFNCTreeViewGroupsCache,(function(){})),rtl.createClass(this,"TTMSFNCTreeViewGroupsBottomCache",this.TTMSFNCTreeViewGroupsCache,(function(){})),rtl.createClass(this,"TTMSFNCTreeViewDisplayList",pas.Classes.TList,(function(){this.GetItem=function(t){return rtl.getObject(this.Get(t))}})),rtl.createClass(this,"TTMSFNCTreeViewNodeDisplayList",this.TTMSFNCTreeViewDisplayList,(function(){})),rtl.createClass(this,"TTMSFNCTreeViewColumnsDisplayList",this.TTMSFNCTreeViewDisplayList,(function(){})),rtl.createClass(this,"TTMSFNCTreeViewColumnsTopDisplayList",this.TTMSFNCTreeViewColumnsDisplayList,(function(){})),rtl.createClass(this,"TTMSFNCTreeViewColumnsBottomDisplayList",this.TTMSFNCTreeViewColumnsDisplayList,(function(){})),rtl.createClass(this,"TTMSFNCTreeViewGroupsDisplayList",this.TTMSFNCTreeViewDisplayList,(function(){})),rtl.createClass(this,"TTMSFNCTreeViewGroupsTopDisplayList",this.TTMSFNCTreeViewGroupsDisplayList,(function(){})),rtl.createClass(this,"TTMSFNCTreeViewGroupsBottomDisplayList",this.TTMSFNCTreeViewGroupsDisplayList,(function(){})),this.TTMSFNCTreeViewColumnsLayout={0:"tclTop",tclTop:0,1:"tclBottom",tclBottom:1},this.$rtti.$Enum("TTMSFNCTreeViewColumnsLayout",{minvalue:0,maxvalue:1,ordtype:1,enumtype:this.TTMSFNCTreeViewColumnsLayout}),this.$rtti.$Set("TTMSFNCTreeViewColumnsLayouts",{comptype:this.$rtti.TTMSFNCTreeViewColumnsLayout}),this.TTMSFNCTreeViewGroupLayout={0:"tglTop",tglTop:0,1:"tglBottom",tglBottom:1},this.$rtti.$Enum("TTMSFNCTreeViewGroupLayout",{minvalue:0,maxvalue:1,ordtype:1,enumtype:this.TTMSFNCTreeViewGroupLayout}),this.$rtti.$Set("TTMSFNCTreeViewGroupsLayouts",{comptype:this.$rtti.TTMSFNCTreeViewGroupLayout}),this.TTMSFNCTreeViewNodeHeightMode={0:"tnhmFixed",tnhmFixed:0,1:"tnhmVariable",tnhmVariable:1},this.$rtti.$Enum("TTMSFNCTreeViewNodeHeightMode",{minvalue:0,maxvalue:1,ordtype:1,enumtype:this.TTMSFNCTreeViewNodeHeightMode}),this.TTMSFNCTreeViewSelectionArea={0:"tsaDefault",tsaDefault:0,1:"tsaFull",tsaFull:1,2:"tsaFromLevel",tsaFromLevel:2,3:"tsaFromText",tsaFromText:3},this.$rtti.$Enum("TTMSFNCTreeViewSelectionArea",{minvalue:0,maxvalue:3,ordtype:1,enumtype:this.TTMSFNCTreeViewSelectionArea}),rtl.createClass(this,"TTMSFNCTreeViewNodesAppearance",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FTreeView=null,this.FFill=null,this.FStroke=null,this.FFont=null,this.FDisabledFill=null,this.FSelectedFill=null,this.FDisabledStroke=null,this.FSelectedStroke=null,this.FSelectionArea=0,this.FExpandColumn=0,this.FExpandWidth=0,this.FExpandHeight=0,this.FLevelIndent=0,this.FHeightMode=0,this.FFixedHeight=0,this.FVariableMinimumHeight=0,this.FSelectedFontColor=0,this.FDisabledFontColor=0,this.FExtendedFontColor=0,this.FExtendedSelectedFontColor=0,this.FExtendedDisabledFontColor=0,this.FExtendedDisabledFill=null,this.FExtendedFont=null,this.FExtendedSelectedFill=null,this.FExtendedDisabledStroke=null,this.FExtendedSelectedStroke=null,this.FExtendedFill=null,this.FExtendedStroke=null,this.FShowLines=!1,this.FExpandNodeIcon=null,this.FCollapseNodeIcon=null,this.FExpandNodeIconLarge=null,this.FCollapseNodeIconLarge=null,this.FColumnStroke=null,this.FLineStroke=null,this.FShowFocus=!1,this.FSpacing=0,this.FDisabledTitleFontColor=0,this.FSelectedTitleFontColor=0,this.FTitleFont=null},this.$final=function(){this.FTreeView=void 0,this.FFill=void 0,this.FStroke=void 0,this.FFont=void 0,this.FDisabledFill=void 0,this.FSelectedFill=void 0,this.FDisabledStroke=void 0,this.FSelectedStroke=void 0,this.FExtendedDisabledFill=void 0,this.FExtendedFont=void 0,this.FExtendedSelectedFill=void 0,this.FExtendedDisabledStroke=void 0,this.FExtendedSelectedStroke=void 0,this.FExtendedFill=void 0,this.FExtendedStroke=void 0,this.FExpandNodeIcon=void 0,this.FCollapseNodeIcon=void 0,this.FExpandNodeIconLarge=void 0,this.FCollapseNodeIconLarge=void 0,this.FColumnStroke=void 0,this.FLineStroke=void 0,this.FTitleFont=void 0,pas.Classes.TPersistent.$final.call(this)},this.SetFill=function(t){this.FFill!==t&&this.FFill.Assign(t)},this.SetStroke=function(t){this.FStroke!==t&&this.FStroke.Assign(t)},this.SetFont=function(t){this.FFont!==t&&this.FFont.Assign(t)},this.SetDisabledFill=function(t){this.FDisabledFill!==t&&this.FDisabledFill.Assign(t)},this.SetDisabledStroke=function(t){this.FDisabledStroke!==t&&this.FDisabledStroke.Assign(t)},this.SetSelectedFill=function(t){this.FSelectedFill!==t&&this.FSelectedFill.Assign(t)},this.SetSelectedStroke=function(t){this.FSelectedStroke!==t&&this.FSelectedStroke.Assign(t)},this.SetSelectionArea=function(t){this.FSelectionArea!==t&&(this.FSelectionArea=t,this.FTreeView.Invalidate())},this.SetExtendedFill=function(t){this.FExtendedFill!==t&&this.FExtendedFill.Assign(t)},this.SetExtendedStroke=function(t){this.FExtendedStroke!==t&&this.FExtendedStroke.Assign(t)},this.SetExtendedFont=function(t){this.FExtendedFont!==t&&this.FExtendedFont.Assign(t)},this.SetExtendedDisabledFill=function(t){this.FExtendedDisabledFill!==t&&this.FExtendedDisabledFill.Assign(t)},this.SetExtendedDisabledStroke=function(t){this.FExtendedDisabledStroke!==t&&this.FExtendedDisabledStroke.Assign(t)},this.SetExtendedSelectedFill=function(t){this.FExtendedSelectedFill!==t&&this.FExtendedSelectedFill.Assign(t)},this.SetExtendedSelectedStroke=function(t){this.FExtendedSelectedStroke!==t&&this.FExtendedSelectedStroke.Assign(t)},this.SetExpandColumn=function(t){this.FExpandColumn!==t&&(this.FExpandColumn=t,this.Changed(this))},this.SetExpandWidth=function(t){this.FExpandWidth!==t&&(this.FExpandWidth=t,this.Changed(this))},this.SetExpandHeight=function(t){this.FExpandHeight!==t&&(this.FExpandHeight=t,this.Changed(this))},this.SetLevelIndent=function(t){this.FLevelIndent!==t&&(this.FLevelIndent=t,this.Changed(this))},this.SetFixedHeight=function(t){this.FFixedHeight!==t&&(this.FFixedHeight=t,this.Changed(this))},this.SetVariableMinimumHeight=function(t){this.FVariableMinimumHeight!==t&&(this.FVariableMinimumHeight=t,this.Changed(this))},this.SetSelectedFontColor=function(t){this.FSelectedFontColor!==t&&(this.FSelectedFontColor=t,this.Changed(this))},this.SetDisabledFontColor=function(t){this.FDisabledFontColor!==t&&(this.FDisabledFontColor=t,this.Changed(this))},this.SetExtendedFontColor=function(t){this.FExtendedFontColor!==t&&(this.FExtendedFontColor=t,this.Changed(this))},this.SetExtendedSelectedFontColor=function(t){this.FExtendedSelectedFontColor!==t&&(this.FExtendedSelectedFontColor=t,this.Changed(this))},this.SetExtendedDisabledFontColor=function(t){this.FExtendedDisabledFontColor!==t&&(this.FExtendedDisabledFontColor=t,this.Changed(this))},this.SetHeightMode=function(t){this.FHeightMode!==t&&(this.FHeightMode=t,this.Changed(this))},this.SetShowLines=function(t){this.FShowLines!==t&&(this.FShowLines=t,this.Changed(this))},this.SetCollapseNodeIcon=function(t){this.FCollapseNodeIcon!==t&&(this.FCollapseNodeIcon.Assign(t),this.Changed(this))},this.SetExpandNodeIcon=function(t){this.FExpandNodeIcon!==t&&(this.FExpandNodeIcon.Assign(t),this.Changed(this))},this.SetCollapseNodeIconLarge=function(t){this.FCollapseNodeIconLarge!==t&&(this.FCollapseNodeIconLarge.Assign(t),this.Changed(this))},this.SetExpandNodeIconLarge=function(t){this.FExpandNodeIconLarge!==t&&(this.FExpandNodeIconLarge.Assign(t),this.Changed(this))},this.SetColumnStroke=function(t){this.FColumnStroke!==t&&this.FColumnStroke.Assign(t)},this.SetLineStroke=function(t){this.FLineStroke!==t&&this.FLineStroke.Assign(t)},this.SetShowFocus=function(t){this.FShowFocus!==t&&(this.FShowFocus=t,this.FTreeView.Invalidate())},this.IsSpacingStored=function(){return 0!==this.FSpacing},this.SetSpacing=function(t){this.FSpacing!==t&&(this.FSpacing=t,this.Changed(this))},this.SetDisabledTitleFontColor=function(t){this.FDisabledTitleFontColor!==t&&(this.FDisabledTitleFontColor=t,this.FTreeView.Invalidate())},this.SetSelectedTitleFontColor=function(t){this.FSelectedTitleFontColor!==t&&(this.FSelectedTitleFontColor=t,this.FTreeView.Invalidate())},this.SetTitleFont=function(t){this.FTitleFont!==t&&this.FTitleFont.Assign(t)},this.Changed=function(t){this.FTreeView.UpdateTreeViewCache()},this.BitmapChanged=function(t){this.FTreeView.UpdateTreeViewCache()},this.Create$1=function(e){return this.FTreeView=e,this.FShowFocus=!0,this.FSelectionArea=3,this.FExpandColumn=0,this.FExpandWidth=15,this.FExpandHeight=15,this.FFixedHeight=25,this.FVariableMinimumHeight=25,this.FShowLines=!0,this.FHeightMode=0,this.FLevelIndent=20,this.FSpacing=0,this.FSelectedFontColor=16777215,this.FDisabledFontColor=12632256,this.FSelectedTitleFontColor=16777215,this.FDisabledTitleFontColor=12632256,this.FExtendedFontColor=0,this.FExtendedSelectedFontColor=16777215,this.FExtendedDisabledFontColor=12632256,this.FColumnStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,-1]),this.FLineStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[3,11119017]),this.FFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[1,-1,8421504,-1,-1]),this.FStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[0,11119017]),this.FSelectedFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[1,16297243,8421504,-1,-1]),this.FSelectedStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,16297243]),this.FDisabledFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[1,11119017,8421504,-1,-1]),this.FDisabledStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[0,11119017]),this.FExtendedFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[1,16053492,8421504,-1,-1]),this.FExtendedStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,11119017]),this.FExtendedSelectedFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[1,16297243,8421504,-1,-1]),this.FExtendedSelectedStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[0,11119017]),this.FExtendedDisabledFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[1,11119017,8421504,-1,-1]),this.FExtendedDisabledStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[0,11119017]),this.FExpandNodeIcon=pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.CreateFromResource$1(t.TTMSFNCTREEVIEWEXPAND,pas["WEBLib.TMSFNCTypes"].HInstance()),this.FExpandNodeIcon.FOnChange=rtl.createCallback(this,"BitmapChanged"),this.FCollapseNodeIcon=pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.CreateFromResource$1(t.TTMSFNCTREEVIEWCOLLAPSE,pas["WEBLib.TMSFNCTypes"].HInstance()),this.FExpandNodeIcon.FOnChange=rtl.createCallback(this,"BitmapChanged"),this.FExpandNodeIconLarge=pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.CreateFromResource$1(t.TTMSFNCTREEVIEWEXPANDLARGE,pas["WEBLib.TMSFNCTypes"].HInstance()),this.FExpandNodeIconLarge.FOnChange=rtl.createCallback(this,"BitmapChanged"),this.FCollapseNodeIconLarge=pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.CreateFromResource$1(t.TTMSFNCTREEVIEWCOLLAPSELARGE,pas["WEBLib.TMSFNCTypes"].HInstance()),this.FCollapseNodeIconLarge.FOnChange=rtl.createCallback(this,"BitmapChanged"),this.FFont=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFont.$create("Create$2"),null!=this.FTreeView&&this.FTreeView.IsDesignTime()&&this.FFont.SetColor(0),this.FTitleFont=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFont.$create("Create$2"),null!=this.FTreeView&&this.FTreeView.IsDesignTime()&&this.FTitleFont.SetColor(0),this.FFill.FOnChanged=rtl.createCallback(this,"Changed"),this.FStroke.FOnChanged=rtl.createCallback(this,"Changed"),this.FSelectedFill.FOnChanged=rtl.createCallback(this,"Changed"),this.FSelectedStroke.FOnChanged=rtl.createCallback(this,"Changed"),this.FDisabledFill.FOnChanged=rtl.createCallback(this,"Changed"),this.FDisabledStroke.FOnChanged=rtl.createCallback(this,"Changed"),this.FExtendedFont=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFont.$create("Create$2"),this.FExtendedFill.FOnChanged=rtl.createCallback(this,"Changed"),this.FExtendedStroke.FOnChanged=rtl.createCallback(this,"Changed"),this.FExtendedSelectedFill.FOnChanged=rtl.createCallback(this,"Changed"),this.FExtendedSelectedStroke.FOnChanged=rtl.createCallback(this,"Changed"),this.FExtendedDisabledFill.FOnChanged=rtl.createCallback(this,"Changed"),this.FExtendedDisabledStroke.FOnChanged=rtl.createCallback(this,"Changed"),this.FFont.FOnChanged=rtl.createCallback(this,"Changed"),this.FExtendedFont.FOnChanged=rtl.createCallback(this,"Changed"),this},this.Assign=function(e){t.TTMSFNCTreeViewNodesAppearance.isPrototypeOf(e)&&(this.FFill.Assign(rtl.as(e,t.TTMSFNCTreeViewNodesAppearance).FFill),this.FStroke.Assign(rtl.as(e,t.TTMSFNCTreeViewNodesAppearance).FStroke),this.FFont.Assign(rtl.as(e,t.TTMSFNCTreeViewNodesAppearance).FFont),this.FTitleFont.Assign(rtl.as(e,t.TTMSFNCTreeViewNodesAppearance).FTitleFont),this.FSelectedFill.Assign(rtl.as(e,t.TTMSFNCTreeViewNodesAppearance).FSelectedFill),this.FSelectedStroke.Assign(rtl.as(e,t.TTMSFNCTreeViewNodesAppearance).FSelectedStroke),this.FDisabledFill.Assign(rtl.as(e,t.TTMSFNCTreeViewNodesAppearance).FDisabledFill),this.FDisabledStroke.Assign(rtl.as(e,t.TTMSFNCTreeViewNodesAppearance).FDisabledStroke),this.FExtendedFill.Assign(rtl.as(e,t.TTMSFNCTreeViewNodesAppearance).FExtendedFill),this.FExtendedStroke.Assign(rtl.as(e,t.TTMSFNCTreeViewNodesAppearance).FExtendedStroke),this.FExtendedFont.Assign(rtl.as(e,t.TTMSFNCTreeViewNodesAppearance).FExtendedFont),this.FExtendedSelectedFill.Assign(rtl.as(e,t.TTMSFNCTreeViewNodesAppearance).FExtendedSelectedFill),this.FExtendedSelectedStroke.Assign(rtl.as(e,t.TTMSFNCTreeViewNodesAppearance).FExtendedSelectedStroke),this.FExtendedDisabledFill.Assign(rtl.as(e,t.TTMSFNCTreeViewNodesAppearance).FExtendedDisabledFill),this.FExtendedDisabledStroke.Assign(rtl.as(e,t.TTMSFNCTreeViewNodesAppearance).FExtendedDisabledStroke),this.FExpandColumn=rtl.as(e,t.TTMSFNCTreeViewNodesAppearance).FExpandColumn,this.FExpandWidth=rtl.as(e,t.TTMSFNCTreeViewNodesAppearance).FExpandWidth,this.FExpandHeight=rtl.as(e,t.TTMSFNCTreeViewNodesAppearance).FExpandHeight,this.FFixedHeight=rtl.as(e,t.TTMSFNCTreeViewNodesAppearance).FFixedHeight,this.FVariableMinimumHeight=rtl.as(e,t.TTMSFNCTreeViewNodesAppearance).FVariableMinimumHeight,this.FSelectedFontColor=rtl.as(e,t.TTMSFNCTreeViewNodesAppearance).FSelectedFontColor,this.FDisabledFontColor=rtl.as(e,t.TTMSFNCTreeViewNodesAppearance).FDisabledFontColor,this.FSelectedTitleFontColor=rtl.as(e,t.TTMSFNCTreeViewNodesAppearance).FSelectedTitleFontColor,this.FDisabledTitleFontColor=rtl.as(e,t.TTMSFNCTreeViewNodesAppearance).FDisabledTitleFontColor,this.FExtendedFontColor=rtl.as(e,t.TTMSFNCTreeViewNodesAppearance).FExtendedFontColor,this.FExtendedSelectedFontColor=rtl.as(e,t.TTMSFNCTreeViewNodesAppearance).FExtendedSelectedFontColor,this.FExtendedDisabledFontColor=rtl.as(e,t.TTMSFNCTreeViewNodesAppearance).FExtendedDisabledFontColor,this.FLevelIndent=rtl.as(e,t.TTMSFNCTreeViewNodesAppearance).FLevelIndent,this.FSpacing=rtl.as(e,t.TTMSFNCTreeViewNodesAppearance).FSpacing,this.FHeightMode=rtl.as(e,t.TTMSFNCTreeViewNodesAppearance).FHeightMode,this.FShowLines=rtl.as(e,t.TTMSFNCTreeViewNodesAppearance).FShowLines,this.FShowFocus=rtl.as(e,t.TTMSFNCTreeViewNodesAppearance).FShowFocus,this.FColumnStroke.Assign(rtl.as(e,t.TTMSFNCTreeViewNodesAppearance).FColumnStroke),this.FLineStroke.Assign(rtl.as(e,t.TTMSFNCTreeViewNodesAppearance).FLineStroke))},this.Destroy=function(){rtl.free(this,"FLineStroke"),rtl.free(this,"FColumnStroke"),rtl.free(this,"FExpandNodeIconLarge"),rtl.free(this,"FCollapseNodeIconLarge"),rtl.free(this,"FExpandNodeIcon"),rtl.free(this,"FCollapseNodeIcon"),rtl.free(this,"FFill"),rtl.free(this,"FStroke"),rtl.free(this,"FFont"),rtl.free(this,"FTitleFont"),rtl.free(this,"FSelectedFill"),rtl.free(this,"FSelectedStroke"),rtl.free(this,"FDisabledFill"),rtl.free(this,"FDisabledStroke"),rtl.free(this,"FExtendedFill"),rtl.free(this,"FExtendedStroke"),rtl.free(this,"FExtendedFont"),rtl.free(this,"FExtendedSelectedFill"),rtl.free(this,"FExtendedSelectedStroke"),rtl.free(this,"FExtendedDisabledFill"),rtl.free(this,"FExtendedDisabledStroke"),pas.System.TObject.Destroy.call(this)};var e=this.$rtti;e.addProperty("ShowFocus",2,rtl.boolean,"FShowFocus","SetShowFocus",{Default:!0}),e.addProperty("ExpandColumn",2,rtl.longint,"FExpandColumn","SetExpandColumn",{Default:0}),e.addProperty("ExpandWidth",2,rtl.double,"FExpandWidth","SetExpandWidth"),e.addProperty("ExpandHeight",2,rtl.double,"FExpandHeight","SetExpandHeight"),e.addProperty("LevelIndent",2,rtl.double,"FLevelIndent","SetLevelIndent"),e.addProperty("Spacing",14,rtl.double,"FSpacing","SetSpacing",{stored:"IsSpacingStored"}),e.addProperty("FixedHeight",2,rtl.double,"FFixedHeight","SetFixedHeight"),e.addProperty("VariableMinimumHeight",2,rtl.double,"FVariableMinimumHeight","SetVariableMinimumHeight"),e.addProperty("HeightMode",2,t.$rtti.TTMSFNCTreeViewNodeHeightMode,"FHeightMode","SetHeightMode",{Default:t.TTMSFNCTreeViewNodeHeightMode.tnhmFixed}),e.addProperty("ShowLines",2,rtl.boolean,"FShowLines","SetShowLines",{Default:!0}),e.addProperty("Fill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FFill","SetFill"),e.addProperty("Stroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FStroke","SetStroke"),e.addProperty("ColumnStroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FColumnStroke","SetColumnStroke"),e.addProperty("LineStroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FLineStroke","SetLineStroke"),e.addProperty("Font",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFont,"FFont","SetFont"),e.addProperty("TitleFont",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFont,"FTitleFont","SetTitleFont"),e.addProperty("SelectedFontColor",2,pas["WEBLib.Graphics"].$rtti.TColor,"FSelectedFontColor","SetSelectedFontColor",{Default:16777215}),e.addProperty("DisabledFontColor",2,pas["WEBLib.Graphics"].$rtti.TColor,"FDisabledFontColor","SetDisabledFontColor",{Default:12632256}),e.addProperty("SelectedTitleFontColor",2,pas["WEBLib.Graphics"].$rtti.TColor,"FSelectedTitleFontColor","SetSelectedTitleFontColor",{Default:16777215}),e.addProperty("DisabledTitleFontColor",2,pas["WEBLib.Graphics"].$rtti.TColor,"FDisabledTitleFontColor","SetDisabledTitleFontColor",{Default:12632256}),e.addProperty("ExtendedFontColor",2,pas["WEBLib.Graphics"].$rtti.TColor,"FExtendedFontColor","SetExtendedFontColor",{Default:0}),e.addProperty("ExtendedSelectedFontColor",2,pas["WEBLib.Graphics"].$rtti.TColor,"FExtendedSelectedFontColor","SetExtendedSelectedFontColor",{Default:16777215}),e.addProperty("ExtendedDisabledFontColor",2,pas["WEBLib.Graphics"].$rtti.TColor,"FExtendedDisabledFontColor","SetExtendedDisabledFontColor",{Default:12632256}),e.addProperty("SelectedFill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FSelectedFill","SetSelectedFill"),e.addProperty("SelectedStroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FSelectedStroke","SetSelectedStroke"),e.addProperty("SelectionArea",2,t.$rtti.TTMSFNCTreeViewSelectionArea,"FSelectionArea","SetSelectionArea",{Default:t.TTMSFNCTreeViewSelectionArea.tsaFromText}),e.addProperty("DisabledFill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FDisabledFill","SetDisabledFill"),e.addProperty("DisabledStroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FDisabledStroke","SetDisabledStroke"),e.addProperty("ExtendedFill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FExtendedFill","SetExtendedFill"),e.addProperty("ExtendedStroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FExtendedStroke","SetExtendedStroke"),e.addProperty("ExtendedFont",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFont,"FExtendedFont","SetExtendedFont"),e.addProperty("ExtendedSelectedFill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FExtendedSelectedFill","SetExtendedSelectedFill"),e.addProperty("ExtendedSelectedStroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FExtendedSelectedStroke","SetExtendedSelectedStroke"),e.addProperty("ExtendedDisabledFill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FExtendedDisabledFill","SetExtendedDisabledFill"),e.addProperty("ExtendedDisabledStroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FExtendedDisabledStroke","SetExtendedDisabledStroke"),e.addProperty("ExpandNodeIcon",2,pas["WEBLib.TMSFNCTypes"].$rtti.TTMSFNCBitmap,"FExpandNodeIcon","SetExpandNodeIcon"),e.addProperty("CollapseNodeIcon",2,pas["WEBLib.TMSFNCTypes"].$rtti.TTMSFNCBitmap,"FCollapseNodeIcon","SetCollapseNodeIcon"),e.addProperty("ExpandNodeIconLarge",2,pas["WEBLib.TMSFNCTypes"].$rtti.TTMSFNCBitmap,"FExpandNodeIconLarge","SetExpandNodeIconLarge"),e.addProperty("CollapseNodeIconLarge",2,pas["WEBLib.TMSFNCTypes"].$rtti.TTMSFNCBitmap,"FCollapseNodeIconLarge","SetCollapseNodeIconLarge")})),rtl.createClass(this,"TTMSFNCTreeViewColumnsAppearance",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FTreeView=null,this.FLayouts={},this.FStretch=!1,this.FStretchColumn=0,this.FStretchAll=!1,this.FBottomSize=0,this.FTopSize=0,this.FBottomFill=null,this.FBottomStroke=null,this.FTopFill=null,this.FTopStroke=null,this.FTopFont=null,this.FBottomFont=null,this.FTopVerticalTextAlign=0,this.FTopHorizontalTextAlign=0,this.FBottomHorizontalTextAlign=0,this.FBottomVerticalTextAlign=0,this.FTopVerticalText=!1,this.FBottomVerticalText=!1,this.FFillEmptySpaces=!1,this.FSortIndicatorColor=0,this.FOptimizedColumnDisplay=!1},this.$final=function(){this.FTreeView=void 0,this.FLayouts=void 0,this.FBottomFill=void 0,this.FBottomStroke=void 0,this.FTopFill=void 0,this.FTopStroke=void 0,this.FTopFont=void 0,this.FBottomFont=void 0,pas.Classes.TPersistent.$final.call(this)},this.SetLayouts=function(t){rtl.neSet(this.FLayouts,t)&&(this.FLayouts=rtl.refSet(t),this.FTreeView.UpdateTreeViewCache())},this.SetStretch=function(t){this.FStretch!==t&&(this.FStretch=t,this.FTreeView.UpdateColumns(),this.FTreeView.UpdateTreeViewCache())},this.SetStretchAll=function(t){this.FStretchAll!==t&&(this.FStretchAll=t,this.FTreeView.UpdateColumns(),this.FTreeView.UpdateTreeViewCache())},this.SetStretchColumn=function(t){this.FStretchColumn!==t&&(this.FStretchColumn=t,this.FTreeView.UpdateColumns(),this.FTreeView.UpdateTreeViewCache())},this.SetBottomSize=function(t){this.FBottomSize!==t&&(this.FBottomSize=t,this.FTreeView.UpdateTreeViewCache())},this.SetTopSize=function(t){this.FTopSize!==t&&(this.FTopSize=t,this.Changed(this))},this.SetBottomFill=function(t){this.FBottomFill!==t&&this.FBottomFill.Assign(t)},this.SetBottomStroke=function(t){this.FBottomStroke!==t&&this.FBottomStroke.Assign(t)},this.SetTopFill=function(t){this.FTopFill!==t&&this.FTopFill.Assign(t)},this.SetTopStroke=function(t){this.FTopStroke!==t&&this.FTopStroke.Assign(t)},this.SetBottomFont=function(t){this.FBottomFont!==t&&this.FBottomFont.Assign(t)},this.SetTopFont=function(t){this.FTopFont!==t&&this.FTopFont.Assign(t)},this.SetTopVerticalText=function(t){this.FTopVerticalText!==t&&(this.FTopVerticalText=t,this.Changed(this))},this.SetBottomVerticalText=function(t){this.FBottomVerticalText!==t&&(this.FBottomVerticalText=t,this.Changed(this))},this.SetFillEmptySpaces=function(t){this.FFillEmptySpaces!==t&&(this.FFillEmptySpaces=t,this.FTreeView.Invalidate())},this.SetSortIndicatorColor=function(t){this.FSortIndicatorColor!==t&&(this.FSortIndicatorColor=t,this.FTreeView.Invalidate())},this.SetOptimizedColumnDisplay=function(t){this.FOptimizedColumnDisplay!==t&&(this.FOptimizedColumnDisplay=t,this.FTreeView.UpdateColumns(),this.FTreeView.UpdateTreeViewCache())},this.Changed=function(t){this.FTreeView.UpdateTreeViewCache()},this.Create$1=function(t){return this.FTreeView=t,this.FSortIndicatorColor=11829830,this.FLayouts=rtl.createSet(0),this.FFillEmptySpaces=!0,this.FOptimizedColumnDisplay=!0,this.FStretch=!0,this.FStretchAll=!0,this.FStretchColumn=-1,this.FBottomSize=25,this.FTopVerticalText=!1,this.FStretchAll=!0,this.FBottomVerticalText=!1,this.FTopSize=25,this.FTopHorizontalTextAlign=0,this.FTopVerticalTextAlign=0,this.FBottomHorizontalTextAlign=0,this.FBottomVerticalTextAlign=0,this.FBottomFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[1,16777215,8421504,-1,-1]),this.FBottomStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,11119017]),this.FTopFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[1,16777215,8421504,-1,-1]),this.FTopStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,11119017]),this.FTopFont=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFont.$create("Create$2"),this.FTopFont.SetColor(0),this.FBottomFont=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFont.$create("Create$2"),this.FBottomFont.SetColor(0),this.FBottomFill.FOnChanged=rtl.createCallback(this,"Changed"),this.FTopFill.FOnChanged=rtl.createCallback(this,"Changed"),this.FBottomStroke.FOnChanged=rtl.createCallback(this,"Changed"),this.FTopStroke.FOnChanged=rtl.createCallback(this,"Changed"),this.FTopFont.FOnChanged=rtl.createCallback(this,"Changed"),this.FBottomFont.FOnChanged=rtl.createCallback(this,"Changed"),this},this.Destroy=function(){rtl.free(this,"FTopFont"),rtl.free(this,"FBottomFont"),rtl.free(this,"FBottomFill"),rtl.free(this,"FTopFill"),rtl.free(this,"FBottomStroke"),rtl.free(this,"FTopStroke"),pas.System.TObject.Destroy.call(this)},this.Assign=function(e){t.TTMSFNCTreeViewColumnsAppearance.isPrototypeOf(e)&&(this.FSortIndicatorColor=rtl.as(e,t.TTMSFNCTreeViewColumnsAppearance).FSortIndicatorColor,this.FLayouts=rtl.refSet(rtl.as(e,t.TTMSFNCTreeViewColumnsAppearance).FLayouts),this.FTopSize=rtl.as(e,t.TTMSFNCTreeViewColumnsAppearance).FTopSize,this.FBottomSize=rtl.as(e,t.TTMSFNCTreeViewColumnsAppearance).FBottomSize,this.FBottomFill.Assign(rtl.as(e,t.TTMSFNCTreeViewColumnsAppearance).FBottomFill),this.FBottomFont.Assign(rtl.as(e,t.TTMSFNCTreeViewColumnsAppearance).FBottomFont),this.FBottomStroke.Assign(rtl.as(e,t.TTMSFNCTreeViewColumnsAppearance).FBottomStroke),this.FTopFill.Assign(rtl.as(e,t.TTMSFNCTreeViewColumnsAppearance).FTopFill),this.FTopStroke.Assign(rtl.as(e,t.TTMSFNCTreeViewColumnsAppearance).FTopStroke),this.FTopFont.Assign(rtl.as(e,t.TTMSFNCTreeViewColumnsAppearance).FTopFont),this.FStretch=rtl.as(e,t.TTMSFNCTreeViewColumnsAppearance).FStretch,this.FOptimizedColumnDisplay=rtl.as(e,t.TTMSFNCTreeViewColumnsAppearance).FOptimizedColumnDisplay,this.FStretchColumn=rtl.as(e,t.TTMSFNCTreeViewColumnsAppearance).FStretchColumn,this.FStretchAll=rtl.as(e,t.TTMSFNCTreeViewColumnsAppearance).FStretchAll,this.FTopVerticalText=rtl.as(e,t.TTMSFNCTreeViewColumnsAppearance).FTopVerticalText,this.FBottomVerticalText=rtl.as(e,t.TTMSFNCTreeViewColumnsAppearance).FBottomVerticalText,this.FFillEmptySpaces=rtl.as(e,t.TTMSFNCTreeViewColumnsAppearance).FFillEmptySpaces)};var e=this.$rtti;e.addProperty("Layouts",2,t.$rtti.TTMSFNCTreeViewColumnsLayouts,"FLayouts","SetLayouts",{Default:rtl.createSet(0)}),e.addProperty("Stretch",2,rtl.boolean,"FStretch","SetStretch",{Default:!0}),e.addProperty("StretchColumn",2,rtl.longint,"FStretchColumn","SetStretchColumn",{Default:-1}),e.addProperty("StretchAll",2,rtl.boolean,"FStretchAll","SetStretchAll",{Default:!0}),e.addProperty("TopSize",2,rtl.double,"FTopSize","SetTopSize"),e.addProperty("BottomSize",2,rtl.double,"FBottomSize","SetBottomSize"),e.addProperty("TopFont",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFont,"FTopFont","SetTopFont"),e.addProperty("BottomFont",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFont,"FBottomFont","SetBottomFont"),e.addProperty("TopFill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FTopFill","SetTopFill"),e.addProperty("BottomFill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FBottomFill","SetBottomFill"),e.addProperty("TopStroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FTopStroke","SetTopStroke"),e.addProperty("BottomStroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FBottomStroke","SetBottomStroke"),e.addProperty("TopVerticalText",2,rtl.boolean,"FTopVerticalText","SetTopVerticalText",{Default:!1}),e.addProperty("BottomVerticalText",2,rtl.boolean,"FBottomVerticalText","SetBottomVerticalText",{Default:!1}),e.addProperty("FillEmptySpaces",2,rtl.boolean,"FFillEmptySpaces","SetFillEmptySpaces",{Default:!0}),e.addProperty("SortIndicatorColor",2,pas["WEBLib.Graphics"].$rtti.TColor,"FSortIndicatorColor","SetSortIndicatorColor",{Default:11829830}),e.addProperty("OptimizedColumnDisplay",2,rtl.boolean,"FOptimizedColumnDisplay","SetOptimizedColumnDisplay",{Default:!0})})),this.TTMSFNCTreeViewColumnEmptySpace={0:"tcesTopLeft",tcesTopLeft:0,1:"tcesTopRight",tcesTopRight:1,2:"tcesBottomLeft",tcesBottomLeft:2,3:"tcesBottomRight",tcesBottomRight:3},this.$rtti.$Enum("TTMSFNCTreeViewColumnEmptySpace",{minvalue:0,maxvalue:3,ordtype:1,enumtype:this.TTMSFNCTreeViewColumnEmptySpace}),this.TTMSFNCTreeViewGroupEmptySpace={0:"tgesTopLeft",tgesTopLeft:0,1:"tgesTopRight",tgesTopRight:1,2:"tgesBottomLeft",tgesBottomLeft:2,3:"tgesBottomRight",tgesBottomRight:3},this.$rtti.$Enum("TTMSFNCTreeViewGroupEmptySpace",{minvalue:0,maxvalue:3,ordtype:1,enumtype:this.TTMSFNCTreeViewGroupEmptySpace}),rtl.createClass(this,"TTMSFNCTreeViewGroupsAppearance",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FTreeView=null,this.FLayouts={},this.FBottomSize=0,this.FTopSize=0,this.FBottomFill=null,this.FBottomStroke=null,this.FTopFill=null,this.FTopStroke=null,this.FTopFont=null,this.FBottomFont=null,this.FBottomHorizontalTextAlign=0,this.FTopVerticalTextAlign=0,this.FTopHorizontalTextAlign=0,this.FBottomVerticalTextAlign=0,this.FTopVerticalText=!1,this.FBottomVerticalText=!1,this.FFillEmptySpaces=!1},this.$final=function(){this.FTreeView=void 0,this.FLayouts=void 0,this.FBottomFill=void 0,this.FBottomStroke=void 0,this.FTopFill=void 0,this.FTopStroke=void 0,this.FTopFont=void 0,this.FBottomFont=void 0,pas.Classes.TPersistent.$final.call(this)},this.SetLayouts=function(t){rtl.neSet(this.FLayouts,t)&&(this.FLayouts=rtl.refSet(t),this.FTreeView.UpdateTreeViewCache())},this.SetBottomSize=function(t){this.FBottomSize!==t&&(this.FBottomSize=t,this.FTreeView.UpdateTreeViewCache())},this.SetTopSize=function(t){this.FTopSize!==t&&(this.FTopSize=t,this.FTreeView.UpdateTreeViewCache())},this.SetBottomFill=function(t){this.FBottomFill!==t&&this.FBottomFill.Assign(t)},this.SetBottomStroke=function(t){this.FBottomStroke!==t&&this.FBottomStroke.Assign(t)},this.SetTopFill=function(t){this.FTopFill!==t&&this.FTopFill.Assign(t)},this.SetTopStroke=function(t){this.FTopStroke!==t&&this.FTopStroke.Assign(t)},this.SetBottomFont=function(t){this.FBottomFont!==t&&this.FBottomFont.Assign(t)},this.SetTopFont=function(t){this.FTopFont!==t&&this.FTopFont.Assign(t)},this.SetBottomHorizontalTextAlign=function(t){this.FBottomHorizontalTextAlign!==t&&(this.FBottomHorizontalTextAlign=t,this.Changed(this))},this.SetBottomVerticalTextAlign=function(t){this.FBottomVerticalTextAlign!==t&&(this.FBottomVerticalTextAlign=t,this.Changed(this))},this.SetTopHorizontalTextAlign=function(t){this.FTopHorizontalTextAlign!==t&&(this.FTopHorizontalTextAlign=t,this.Changed(this))},this.SetTopVerticalTextAlign=function(t){this.FTopVerticalTextAlign!==t&&(this.FTopVerticalTextAlign=t,this.Changed(this))},this.SetTopVerticalText=function(t){this.FTopVerticalText!==t&&(this.FTopVerticalText=t,this.Changed(this))},this.SetBottomVerticalText=function(t){this.FBottomVerticalText!==t&&(this.FBottomVerticalText=t,this.Changed(this))},this.SetFillEmptySpaces=function(t){this.FFillEmptySpaces!==t&&(this.FFillEmptySpaces=t,this.FTreeView.Invalidate())},this.Changed=function(t){this.FTreeView.UpdateTreeViewCache()},this.Create$1=function(t){return this.FTreeView=t,this.FLayouts=rtl.createSet(0),this.FFillEmptySpaces=!0,this.FTopSize=50,this.FBottomSize=50,this.FTopVerticalText=!1,this.FBottomVerticalText=!1,this.FTopHorizontalTextAlign=0,this.FTopVerticalTextAlign=0,this.FBottomHorizontalTextAlign=0,this.FBottomVerticalTextAlign=0,this.FBottomFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[1,16777215,8421504,-1,-1]),this.FBottomStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,11119017]),this.FTopFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[1,16777215,8421504,-1,-1]),this.FTopStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,11119017]),this.FTopFont=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFont.$create("Create$2"),this.FTopFont.SetColor(0),this.FBottomFont=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFont.$create("Create$2"),this.FBottomFont.SetColor(0),this.FBottomFill.FOnChanged=rtl.createCallback(this,"Changed"),this.FTopFill.FOnChanged=rtl.createCallback(this,"Changed"),this.FBottomStroke.FOnChanged=rtl.createCallback(this,"Changed"),this.FTopStroke.FOnChanged=rtl.createCallback(this,"Changed"),this.FTopFont.FOnChanged=rtl.createCallback(this,"Changed"),this.FBottomFont.FOnChanged=rtl.createCallback(this,"Changed"),this},this.Destroy=function(){rtl.free(this,"FBottomFont"),rtl.free(this,"FTopFont"),rtl.free(this,"FBottomFill"),rtl.free(this,"FBottomStroke"),rtl.free(this,"FTopFill"),rtl.free(this,"FTopStroke"),pas.System.TObject.Destroy.call(this)},this.Assign=function(e){t.TTMSFNCTreeViewGroupsAppearance.isPrototypeOf(e)&&(this.FLayouts=rtl.refSet(rtl.as(e,t.TTMSFNCTreeViewGroupsAppearance).FLayouts),this.FTopSize=rtl.as(e,t.TTMSFNCTreeViewGroupsAppearance).FTopSize,this.FBottomSize=rtl.as(e,t.TTMSFNCTreeViewGroupsAppearance).FBottomSize,this.FBottomFill.Assign(rtl.as(e,t.TTMSFNCTreeViewGroupsAppearance).FBottomFill),this.FBottomFont.Assign(rtl.as(e,t.TTMSFNCTreeViewGroupsAppearance).FBottomFont),this.FBottomStroke.Assign(rtl.as(e,t.TTMSFNCTreeViewGroupsAppearance).FBottomStroke),this.FTopFill.Assign(rtl.as(e,t.TTMSFNCTreeViewGroupsAppearance).FTopFill),this.FTopStroke.Assign(rtl.as(e,t.TTMSFNCTreeViewGroupsAppearance).FTopStroke),this.FTopFont.Assign(rtl.as(e,t.TTMSFNCTreeViewGroupsAppearance).FTopFont),this.FTopHorizontalTextAlign=rtl.as(e,t.TTMSFNCTreeViewGroupsAppearance).FTopHorizontalTextAlign,this.FTopVerticalTextAlign=rtl.as(e,t.TTMSFNCTreeViewGroupsAppearance).FTopVerticalTextAlign,this.FBottomHorizontalTextAlign=rtl.as(e,t.TTMSFNCTreeViewGroupsAppearance).FBottomHorizontalTextAlign,this.FBottomVerticalTextAlign=rtl.as(e,t.TTMSFNCTreeViewGroupsAppearance).FBottomVerticalTextAlign,this.FTopVerticalText=rtl.as(e,t.TTMSFNCTreeViewGroupsAppearance).FTopVerticalText,this.FBottomVerticalText=rtl.as(e,t.TTMSFNCTreeViewGroupsAppearance).FBottomVerticalText,this.FFillEmptySpaces=rtl.as(e,t.TTMSFNCTreeViewGroupsAppearance).FFillEmptySpaces)};var e=this.$rtti;e.addProperty("Layouts",2,t.$rtti.TTMSFNCTreeViewGroupsLayouts,"FLayouts","SetLayouts",{Default:rtl.createSet(0)}),e.addProperty("TopSize",2,rtl.double,"FTopSize","SetTopSize"),e.addProperty("BottomSize",2,rtl.double,"FBottomSize","SetBottomSize"),e.addProperty("TopFill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FTopFill","SetTopFill"),e.addProperty("BottomFill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FBottomFill","SetBottomFill"),e.addProperty("TopFont",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFont,"FTopFont","SetTopFont"),e.addProperty("BottomFont",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFont,"FBottomFont","SetBottomFont"),e.addProperty("TopStroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FTopStroke","SetTopStroke"),e.addProperty("BottomStroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FBottomStroke","SetBottomStroke"),e.addProperty("TopHorizontalTextAlign",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsTextAlign,"FTopHorizontalTextAlign","SetTopHorizontalTextAlign",{Default:pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsTextAlign.gtaCenter}),e.addProperty("TopVerticalTextAlign",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsTextAlign,"FTopVerticalTextAlign","SetTopVerticalTextAlign",{Default:pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsTextAlign.gtaCenter}),e.addProperty("BottomHorizontalTextAlign",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsTextAlign,"FBottomHorizontalTextAlign","SetBottomHorizontalTextAlign",{Default:pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsTextAlign.gtaCenter}),e.addProperty("BottomVerticalTextAlign",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsTextAlign,"FBottomVerticalTextAlign","SetBottomVerticalTextAlign",{Default:pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsTextAlign.gtaCenter}),e.addProperty("TopVerticalText",2,rtl.boolean,"FTopVerticalText","SetTopVerticalText",{Default:!1}),e.addProperty("BottomVerticalText",2,rtl.boolean,"FBottomVerticalText","SetBottomVerticalText",{Default:!1}),e.addProperty("FillEmptySpaces",2,rtl.boolean,"FFillEmptySpaces","SetFillEmptySpaces",{Default:!0})})),this.$rtti.$MethodVar("TTMSFNCTreeViewBeforeDrawSortIndicatorEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["AColumn",rtl.longint],["ASortIndex",rtl.longint],["ASortKind",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewNodesSortKind],["ADefaultDraw",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewAfterDrawSortIndicatorEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["AColumn",rtl.longint],["ASortIndex",rtl.longint],["ASortKind",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewNodesSortKind]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewNodeCompareEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["Node1",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewNode],["Node2",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewNode],["AColumn",rtl.longint],["ACompareResult",rtl.longint,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewBeforeSizeColumnEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AColumn",rtl.longint],["AColumnSize",rtl.double],["ANewColumnSize",rtl.double,1],["AAllow",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewAfterSizeColumnEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AColumn",rtl.longint],["AColumnSize",rtl.double]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewBeforeDrawColumnEmptySpaceEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["ASpace",this.$rtti.TTMSFNCTreeViewColumnEmptySpace],["AAllow",rtl.boolean,1],["ADefaultDraw",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewAfterDrawColumnEmptySpaceEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["ASpace",this.$rtti.TTMSFNCTreeViewColumnEmptySpace]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewBeforeDrawGroupEmptySpaceEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["ASpace",this.$rtti.TTMSFNCTreeViewGroupEmptySpace],["AAllow",rtl.boolean,1],["ADefaultDraw",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewAfterDrawGroupEmptySpaceEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["ASpace",this.$rtti.TTMSFNCTreeViewGroupEmptySpace]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewNeedFilterDropDownDataEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AColumn",rtl.longint],["AValues",pas.Classes.$rtti.TStrings]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewBeforeDrawColumnEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["AColumn",rtl.longint],["AAllow",rtl.boolean,1],["ADefaultDraw",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewAfterDrawColumnEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["AColumn",rtl.longint]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewBeforeDrawColumnHeaderEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["AColumn",rtl.longint],["AKind",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewCacheItemKind],["AAllow",rtl.boolean,1],["ADefaultDraw",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewAfterDrawColumnHeaderEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["AColumn",rtl.longint],["AKind",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewCacheItemKind]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewBeforeDrawGroupEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["AGroup",rtl.longint],["AStartColumn",rtl.longint],["AEndColumn",rtl.longint],["AKind",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewCacheItemKind],["AAllow",rtl.boolean,1],["ADefaultDraw",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewAfterDrawGroupEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["AGroup",rtl.longint],["AStartColumn",rtl.longint],["AEndColumn",rtl.longint],["AKind",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewCacheItemKind]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewBeforeDrawNodeEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["ANode",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewVirtualNode],["AAllow",rtl.boolean,1],["ADefaultDraw",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewAfterDrawNodeEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["ANode",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewVirtualNode]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewGetNumberOfNodesEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ANode",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewVirtualNode],["ANumberOfNodes",rtl.longint,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewGetColumnTextEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AColumn",rtl.longint],["AKind",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewCacheItemKind],["AText",rtl.string,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewBeforeDrawColumnTextEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["AColumn",rtl.longint],["AKind",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewCacheItemKind],["AText",rtl.string],["AAllow",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewAfterDrawColumnTextEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["AColumn",rtl.longint],["AKind",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewCacheItemKind],["AText",rtl.string]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewGetGroupTextEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGroup",rtl.longint],["AKind",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewCacheItemKind],["AText",rtl.string,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewBeforeDrawGroupTextEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["AGroup",rtl.longint],["AStartColumn",rtl.longint],["AEndColumn",rtl.longint],["AKind",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewCacheItemKind],["AText",rtl.string],["AAllow",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewAfterDrawGroupTextEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["AGroup",rtl.longint],["AStartColumn",rtl.longint],["AEndColumn",rtl.longint],["AKind",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewCacheItemKind],["AText",rtl.string]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewNodeAnchorClickEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ANode",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewVirtualNode],["AColumn",rtl.longint],["AAnchor",rtl.string]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewNodeChangedEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ANode",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewVirtualNode]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewGetNodeTextEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ANode",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewVirtualNode],["AColumn",rtl.longint],["AMode",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewNodeTextMode],["AText",rtl.string,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewGetNodeDataEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ANode",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewVirtualNode]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewGetNodeSidesEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ANode",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewVirtualNode],["ASides",pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsSides,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewGetNodeTrimmingEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ANode",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewVirtualNode],["AColumn",rtl.longint],["ATrimming",pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsTextTrimming,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewGetNodeHorizontalTextAlignEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ANode",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewVirtualNode],["AColumn",rtl.longint],["AHorizontalTextAlign",pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsTextAlign,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewGetNodeVerticalTextAlignEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ANode",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewVirtualNode],["AColumn",rtl.longint],["AVerticalTextAlign",pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsTextAlign,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewGetNodeWordWrappingEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ANode",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewVirtualNode],["AColumn",rtl.longint],["AWordWrapping",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewGetColumnTrimmingEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AColumn",rtl.longint],["AKind",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewCacheItemKind],["ATrimming",pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsTextTrimming,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewGetColumnHorizontalTextAlignEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AColumn",rtl.longint],["AKind",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewCacheItemKind],["AHorizontalTextAlign",pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsTextAlign,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewGetColumnVerticalTextAlignEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AColumn",rtl.longint],["AKind",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewCacheItemKind],["AVerticalTextAlign",pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsTextAlign,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewGetColumnWordWrappingEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AColumn",rtl.longint],["AKind",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewCacheItemKind],["AWordWrapping",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewGetNodeIconEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ANode",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewVirtualNode],["AColumn",rtl.longint],["ALarge",rtl.boolean],["AIcon",pas["WEBLib.TMSFNCTypes"].$rtti.TTMSFNCBitmap,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewGetNodeIconSizeEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ANode",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewVirtualNode],["AColumn",rtl.longint],["ALarge",rtl.boolean],["AIcon",pas["WEBLib.TMSFNCTypes"].$rtti.TTMSFNCBitmap],["AIconWidth",rtl.double,1],["AIconHeight",rtl.double,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewFocusedNodeChangedEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ANode",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewVirtualNode]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewGetNodeHeightEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ANode",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewVirtualNode],["AColumn",rtl.longint],["AHeight",rtl.double,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewBeforeDrawNodeTextEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["AColumn",rtl.longint],["ANode",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewVirtualNode],["AText",rtl.string],["AAllow",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewAfterDrawNodeTextEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["AColumn",rtl.longint],["ANode",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewVirtualNode],["AText",rtl.string]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewBeforeDrawNodeExpandEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["AColumn",rtl.longint],["ANode",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewVirtualNode],["AExpand",pas["WEBLib.TMSFNCTypes"].$rtti.TTMSFNCBitmap],["AAllow",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewAfterDrawNodeExpandEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["AColumn",rtl.longint],["ANode",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewVirtualNode],["AExpand",pas["WEBLib.TMSFNCTypes"].$rtti.TTMSFNCBitmap]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewBeforeDrawNodeIconEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["AColumn",rtl.longint],["ANode",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewVirtualNode],["AIcon",pas["WEBLib.TMSFNCTypes"].$rtti.TTMSFNCBitmap],["AAllow",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewAfterDrawNodeIconEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["AColumn",rtl.longint],["ANode",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewVirtualNode],["AIcon",pas["WEBLib.TMSFNCTypes"].$rtti.TTMSFNCBitmap]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewBeforeDrawNodeCheckEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["AColumn",rtl.longint],["ANode",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewVirtualNode],["ACheck",pas["WEBLib.TMSFNCTypes"].$rtti.TTMSFNCBitmap],["AAllow",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewAfterDrawNodeCheckEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["AColumn",rtl.longint],["ANode",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewVirtualNode],["ACheck",pas["WEBLib.TMSFNCTypes"].$rtti.TTMSFNCBitmap]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewGetNodeColorEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ANode",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewVirtualNode],["AColor",pas["WEBLib.Graphics"].$rtti.TColor,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewGetNodeCheckTypeEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ANode",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewVirtualNode],["AColumn",rtl.longint],["ACheckType",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewNodeCheckType,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewGetNodeTextColorEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ANode",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewVirtualNode],["AColumn",rtl.longint],["ATextColor",pas["WEBLib.Graphics"].$rtti.TColor,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewIsNodeExtendedEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ANode",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewVirtualNode],["AExtended",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewColumnAnchorClickEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AColumn",rtl.longint],["AAnchor",rtl.string]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewIsNodeCheckedEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ANode",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewVirtualNode],["AColumn",rtl.longint],["AChecked",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewIsNodeExpandedEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ANode",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewVirtualNode],["AExpanded",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewIsNodeEnabledEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ANode",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewVirtualNode],["AEnabled",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewBeforeUpdateNodeEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ANode",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewVirtualNode],["AColumn",rtl.longint],["AText",rtl.string,1],["ACanUpdate",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewAfterUpdateNodeEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ANode",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewVirtualNode],["AColumn",rtl.longint]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewBeforeCollapseNodeEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ANode",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewVirtualNode],["ACanCollapse",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewAfterCollapseNodeEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ANode",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewVirtualNode]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewBeforeExpandNodeEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ANode",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewVirtualNode],["ACanExpand",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewAfterExpandNodeEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ANode",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewVirtualNode]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewBeforeCheckNodeEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ANode",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewVirtualNode],["AColumn",rtl.longint],["ACanCheck",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewAfterCheckNodeEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ANode",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewVirtualNode],["AColumn",rtl.longint]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewBeforeUnCheckNodeEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ANode",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewVirtualNode],["AColumn",rtl.longint],["ACanUnCheck",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewAfterUnCheckNodeEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ANode",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewVirtualNode],["AColumn",rtl.longint]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewBeforeSelectAllNodesEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ACanSelect",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewAfterSelectAllNodesEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewBeforeSelectNodeEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ANode",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewVirtualNode],["ACanSelect",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewAfterSelectNodeEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ANode",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewVirtualNode]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewBeforeUnSelectNodeEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ANode",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewVirtualNode],["ACanUnSelect",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewAfterUnSelectNodeEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ANode",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewVirtualNode]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewNodeClickEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ANode",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewVirtualNode]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewNodeMouseEnterEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ANode",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewVirtualNode]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewNodeMouseLeaveEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ANode",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewVirtualNode]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewScrollEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["APosition",rtl.double]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewBeforeAddJSONNodeEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AJSONValue",pas["WEBLib.JSON"].$rtti.TJSONValue],["AAddNode",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewAfterAddJSONNodeEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ANode",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewNode],["AJSONValue",pas["WEBLib.JSON"].$rtti.TJSONValue]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewGetHTMLTemplateValueEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ANodeValue",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewNodeValue],["AName",rtl.string],["AValue",rtl.string,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewGetHTMLTemplateEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ANodeValue",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewNodeValue],["AColumnIndex",rtl.longint],["AHTMLTemplate",rtl.string,1]]),methodkind:0}),this.$rtti.$ClassRef("TTMSFNCTreeViewInplaceEditorClass",{instancetype:pas["WEBLib.Controls"].$rtti.TWinControl}),this.$rtti.$MethodVar("TTMSFNCTreeViewCustomizeInplaceEditorEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ANode",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewVirtualNode],["AColumn",rtl.longint],["AInplaceEditor",pas["WEBLib.Controls"].$rtti.TWinControl]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewGetInplaceEditorRectEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ANode",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewVirtualNode],["AColumn",rtl.longint],["AInplaceEditor",pas["WEBLib.Controls"].$rtti.TWinControl],["AInplaceEditorRect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewGetInplaceEditorEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ANode",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewVirtualNode],["AColumn",rtl.longint],["AInplaceEditorClass",this.$rtti.TTMSFNCTreeViewInplaceEditorClass,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewBeforeOpenInplaceEditorEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ANode",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewVirtualNode],["AColumn",rtl.longint],["ACanOpen",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewAfterOpenInplaceEditorEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ANode",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewVirtualNode],["AColumn",rtl.longint],["AInplaceEditor",pas["WEBLib.Controls"].$rtti.TWinControl],["AInplaceEditorRect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewCloseInplaceEditorEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ANode",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewVirtualNode],["AColumn",rtl.longint],["AInplaceEditor",pas["WEBLib.Controls"].$rtti.TWinControl],["ACancelled",rtl.boolean],["ACanClose",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewBeforeReorderNodeEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AFromNode",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewVirtualNode],["AToNode",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewVirtualNode],["ACanReorder",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewAfterReorderNodeEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AFromNode",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewVirtualNode],["AToNode",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewVirtualNode]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewBeforeSortNodesEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ASortColumn",rtl.longint],["ASortMode",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewNodesSortMode],["ACanSort",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewAfterSortNodesEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ASortColumn",rtl.longint],["ASortMode",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewNodesSortMode]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewBeforeDropNodeEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AFromNode",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewVirtualNode],["AToNode",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewVirtualNode],["ACanDrop",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewAfterDropNodeEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AFromNode",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewVirtualNode],["AToNode",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewVirtualNode]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewBeforeCopyToClipboardEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ACanCopy",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewBeforeCutToClipboardEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ACanCut",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewBeforePasteFromClipboardEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ACanPaste",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewAfterCopyToClipboardEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewAfterCutToClipboardEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewAfterPasteFromClipboardEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewFilterSelectEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AColumn",rtl.longint],["ACondition",rtl.string,1]]),methodkind:0}),this.TTMSFNCTreeViewMouseEditMode={0:"tmemDoubleClick",tmemDoubleClick:0,1:"tmemSingleClick",tmemSingleClick:1,2:"tmemSingleClickOnSelectedNode",tmemSingleClickOnSelectedNode:2},this.$rtti.$Enum("TTMSFNCTreeViewMouseEditMode",{minvalue:0,maxvalue:2,ordtype:1,enumtype:this.TTMSFNCTreeViewMouseEditMode}),this.TTMSFNCTreeViewClipboardMode={0:"tcmNone",tcmNone:0,1:"tcmTextOnly",tcmTextOnly:1,2:"tcmFull",tcmFull:2},this.$rtti.$Enum("TTMSFNCTreeViewClipboardMode",{minvalue:0,maxvalue:2,ordtype:1,enumtype:this.TTMSFNCTreeViewClipboardMode}),this.TTMSFNCTreeViewDragDropMode={0:"tdmNone",tdmNone:0,1:"tdmMove",tdmMove:1,2:"tdmCopy",tdmCopy:2},this.$rtti.$Enum("TTMSFNCTreeViewDragDropMode",{minvalue:0,maxvalue:2,ordtype:1,enumtype:this.TTMSFNCTreeViewDragDropMode}),this.TMultiSelectStyles={0:"msControlSelect",msControlSelect:0,1:"msShiftSelect",msShiftSelect:1,2:"msVisibleOnly",msVisibleOnly:2,3:"msSiblingOnly",msSiblingOnly:3},this.$rtti.$Enum("TMultiSelectStyles",{minvalue:0,maxvalue:3,ordtype:1,enumtype:this.TMultiSelectStyles}),this.$rtti.$Set("TMultiSelectStyle",{comptype:this.$rtti.TMultiSelectStyles}),this.$rtti.$Class("TTMSFNCTreeViewInteraction"),rtl.createClass(this,"TTMSFNCTreeViewLookup",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FOwner=null,this.FEnabled=!1,this.FCaseSensitive=!1,this.FIncremental=!1,this.FColumn=0,this.FAutoSelect=!1,this.FRootNodesOnly=!1,this.FAutoExpand=!1,this.FVisibleNodesOnly=!1},this.$final=function(){this.FOwner=void 0,pas.Classes.TPersistent.$final.call(this)},this.Create$1=function(t){return this.FOwner=t,this.FEnabled=!0,this.FCaseSensitive=!1,this.FIncremental=!0,this.FColumn=-1,this.FAutoSelect=!0,this.FAutoExpand=!1,this.FRootNodesOnly=!1,this.FVisibleNodesOnly=!1,this},this.Destroy=function(){pas.System.TObject.Destroy.call(this)},this.Assign=function(e){t.TTMSFNCTreeViewLookup.isPrototypeOf(e)&&(this.FEnabled=rtl.as(e,t.TTMSFNCTreeViewLookup).FEnabled,this.FCaseSensitive=rtl.as(e,t.TTMSFNCTreeViewLookup).FCaseSensitive,this.FIncremental=rtl.as(e,t.TTMSFNCTreeViewLookup).FIncremental,this.FColumn=rtl.as(e,t.TTMSFNCTreeViewLookup).FColumn,this.FAutoSelect=rtl.as(e,t.TTMSFNCTreeViewLookup).FAutoSelect,this.FAutoExpand=rtl.as(e,t.TTMSFNCTreeViewLookup).FAutoExpand,this.FRootNodesOnly=rtl.as(e,t.TTMSFNCTreeViewLookup).FRootNodesOnly,this.FVisibleNodesOnly=rtl.as(e,t.TTMSFNCTreeViewLookup).FVisibleNodesOnly)};var e=this.$rtti;e.addProperty("CaseSensitive",0,rtl.boolean,"FCaseSensitive","FCaseSensitive",{Default:!1}),e.addProperty("Enabled",0,rtl.boolean,"FEnabled","FEnabled",{Default:!0}),e.addProperty("Incremental",0,rtl.boolean,"FIncremental","FIncremental",{Default:!0}),e.addProperty("Column",0,rtl.longint,"FColumn","FColumn",{Default:-1}),e.addProperty("RootNodesOnly",0,rtl.boolean,"FRootNodesOnly","FRootNodesOnly",{Default:!1}),e.addProperty("VisibleNodesOnly",0,rtl.boolean,"FVisibleNodesOnly","FVisibleNodesOnly",{Default:!1}),e.addProperty("AutoExpand",0,rtl.boolean,"FAutoExpand","FAutoExpand",{Default:!1}),e.addProperty("AutoSelect",0,rtl.boolean,"FAutoSelect","FAutoSelect",{Default:!0})})),rtl.createClass(this,"TTMSFNCTreeViewInteraction",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FTreeView=null,this.FMultiSelect=!1,this.FTouchScrolling=!1,this.FReadOnly=!1,this.FColumnSizing=!1,this.FColumnAutoSizeOnDblClick=!1,this.FExtendedSelectable=!1,this.FSelectionFollowsFocus=!1,this.FKeyboardEdit=!1,this.FMouseEditMode=0,this.FExtendedEditable=!1,this.FClipboardMode=0,this.FReorder=!1,this.FDragDropMode=0,this.FLookup=null,this.FExpandCollapseOnDblClick=!1,this.FAutoOpenURL=!1,this.FURLDetectionOnMouseMove=!1,this.FMouseWheelDelta=0,this.FAnimationFactor=0,this.FMultiSelectStyle={}},this.$final=function(){this.FTreeView=void 0,this.FLookup=void 0,this.FMultiSelectStyle=void 0,pas.Classes.TPersistent.$final.call(this)},this.SetMultiSelect=function(t){this.FMultiSelect!==t&&(this.FMultiSelect=t)},this.SetTouchScrolling=function(t){this.FTouchScrolling!==t&&(this.FTouchScrolling=t)},this.SetReadOnly=function(t){this.FReadOnly!==t&&(this.FReadOnly=t)},this.SetColumnSizing=function(t){this.FColumnSizing!==t&&(this.FColumnSizing=t,null!=this.FTreeView&&this.FColumnSizing&&this.FTreeView.FColumnsAppearance.SetStretchAll(!1))},this.SetColumnAutoSizeOnDblClick=function(t){this.FColumnAutoSizeOnDblClick!==t&&(this.FColumnAutoSizeOnDblClick=t)},this.SetExtendedSelectable=function(t){this.FExtendedSelectable!==t&&(this.FExtendedSelectable=t)},this.SetMouseEditMode=function(t){this.FMouseEditMode!==t&&(this.FMouseEditMode=t)},this.SetExtendedEditable=function(t){this.FExtendedEditable!==t&&(this.FExtendedEditable=t)},this.SetDragDropMode=function(t){this.FDragDropMode!==t&&(this.FDragDropMode=t)},this.SetReorder=function(t){this.FReorder!==t&&(this.FReorder=t)},this.SetLookup=function(t){this.FLookup!==t&&this.FLookup.Assign(t)},this.SetExpandCollapseOnDblClick=function(t){this.FExpandCollapseOnDblClick!==t&&(this.FExpandCollapseOnDblClick=t)},this.SetURLDetectionOnMouseMove=function(t){this.FURLDetectionOnMouseMove!==t&&(this.FURLDetectionOnMouseMove=t)},this.IsMouseWheelDeltaStored=function(){return 1!==this.FMouseWheelDelta},this.SetMouseWheelDelta=function(t){this.FMouseWheelDelta=t},this.IsAnimationFactorStored=function(){return 2.5!==this.FAnimationFactor},this.SetMultiSelectStyle=function(t){rtl.neSet(t,this.FMultiSelectStyle)&&(this.FMultiSelectStyle=rtl.refSet(t))},this.Create$1=function(e){return this.FTreeView=e,this.FAutoOpenURL=!0,this.FAnimationFactor=2.5,this.FMouseWheelDelta=1,this.FClipboardMode=0,this.FExpandCollapseOnDblClick=!0,this.FReorder=!1,this.FDragDropMode=0,this.FReadOnly=!1,this.FURLDetectionOnMouseMove=!0,this.FSelectionFollowsFocus=!0,this.FTouchScrolling=!0,this.FKeyboardEdit=!0,this.FExtendedSelectable=!1,this.FMultiSelect=!1,this.FColumnSizing=!1,this.FExtendedEditable=!1,this.FColumnAutoSizeOnDblClick=!1,this.FMouseEditMode=2,this.FLookup=t.TTMSFNCTreeViewLookup.$create("Create$1",[this]),this.FMultiSelectStyle=rtl.createSet(0,1),this},this.Destroy=function(){rtl.free(this,"FLookup"),pas.System.TObject.Destroy.call(this)},this.Assign=function(e){t.TTMSFNCTreeViewInteraction.isPrototypeOf(e)&&(this.FMultiSelect=rtl.as(e,t.TTMSFNCTreeViewInteraction).FMultiSelect,this.FTouchScrolling=rtl.as(e,t.TTMSFNCTreeViewInteraction).FTouchScrolling,this.FReadOnly=rtl.as(e,t.TTMSFNCTreeViewInteraction).FReadOnly,this.FColumnSizing=rtl.as(e,t.TTMSFNCTreeViewInteraction).FColumnSizing,this.FColumnAutoSizeOnDblClick=rtl.as(e,t.TTMSFNCTreeViewInteraction).FColumnAutoSizeOnDblClick,this.FExtendedSelectable=rtl.as(e,t.TTMSFNCTreeViewInteraction).FExtendedSelectable,this.FSelectionFollowsFocus=rtl.as(e,t.TTMSFNCTreeViewInteraction).FSelectionFollowsFocus,this.FKeyboardEdit=rtl.as(e,t.TTMSFNCTreeViewInteraction).FKeyboardEdit,this.FMouseEditMode=rtl.as(e,t.TTMSFNCTreeViewInteraction).FMouseEditMode,this.FExtendedEditable=rtl.as(e,t.TTMSFNCTreeViewInteraction).FExtendedEditable,this.FClipboardMode=rtl.as(e,t.TTMSFNCTreeViewInteraction).FClipboardMode,this.FReorder=rtl.as(e,t.TTMSFNCTreeViewInteraction).FReorder,this.FDragDropMode=rtl.as(e,t.TTMSFNCTreeViewInteraction).FDragDropMode,this.FLookup.Assign(rtl.as(e,t.TTMSFNCTreeViewInteraction).FLookup),this.FExpandCollapseOnDblClick=rtl.as(e,t.TTMSFNCTreeViewInteraction).FExpandCollapseOnDblClick,this.FAutoOpenURL=rtl.as(e,t.TTMSFNCTreeViewInteraction).FAutoOpenURL,this.FURLDetectionOnMouseMove=rtl.as(e,t.TTMSFNCTreeViewInteraction).FURLDetectionOnMouseMove,this.FMouseWheelDelta=rtl.as(e,t.TTMSFNCTreeViewInteraction).FMouseWheelDelta,this.FAnimationFactor=rtl.as(e,t.TTMSFNCTreeViewInteraction).FAnimationFactor)};var e=this.$rtti;e.addProperty("AnimationFactor",12,rtl.double,"FAnimationFactor","FAnimationFactor",{stored:"IsAnimationFactorStored"}),e.addProperty("AutoOpenURL",0,rtl.boolean,"FAutoOpenURL","FAutoOpenURL",{Default:!0}),e.addProperty("MultiSelect",2,rtl.boolean,"FMultiSelect","SetMultiSelect",{Default:!1}),e.addProperty("MultiSelectStyle",2,t.$rtti.TMultiSelectStyle,"FMultiSelectStyle","SetMultiSelectStyle",{Default:rtl.createSet(0,1)}),e.addProperty("ExtendedSelectable",2,rtl.boolean,"FExtendedSelectable","SetExtendedSelectable",{Default:!1}),e.addProperty("ExtendedEditable",2,rtl.boolean,"FExtendedEditable","SetExtendedEditable",{Default:!1}),e.addProperty("MouseEditMode",2,t.$rtti.TTMSFNCTreeViewMouseEditMode,"FMouseEditMode","SetMouseEditMode",{Default:t.TTMSFNCTreeViewMouseEditMode.tmemSingleClickOnSelectedNode}),e.addProperty("MouseWheelDelta",14,rtl.double,"FMouseWheelDelta","SetMouseWheelDelta",{stored:"IsMouseWheelDeltaStored"}),e.addProperty("TouchScrolling",2,rtl.boolean,"FTouchScrolling","SetTouchScrolling",{Default:!0}),e.addProperty("KeyboardEdit",0,rtl.boolean,"FKeyboardEdit","FKeyboardEdit",{Default:!0}),e.addProperty("ReadOnly",2,rtl.boolean,"FReadOnly","SetReadOnly",{Default:!1}),e.addProperty("ExpandCollapseOnDblClick",2,rtl.boolean,"FExpandCollapseOnDblClick","SetExpandCollapseOnDblClick",{Default:!0}),e.addProperty("ColumnSizing",2,rtl.boolean,"FColumnSizing","SetColumnSizing",{Default:!1}),e.addProperty("ColumnAutoSizeOnDblClick",2,rtl.boolean,"FColumnAutoSizeOnDblClick","SetColumnAutoSizeOnDblClick",{Default:!1}),e.addProperty("ClipboardMode",0,t.$rtti.TTMSFNCTreeViewClipboardMode,"FClipboardMode","FClipboardMode",{Default:t.TTMSFNCTreeViewClipboardMode.tcmNone}),e.addProperty("Reorder",2,rtl.boolean,"FReorder","SetReorder",{Default:!1}),e.addProperty("DragDropMode",2,t.$rtti.TTMSFNCTreeViewDragDropMode,"FDragDropMode","SetDragDropMode",{Default:t.TTMSFNCTreeViewDragDropMode.tdmNone}),e.addProperty("Lookup",2,t.$rtti.TTMSFNCTreeViewLookup,"FLookup","SetLookup"),e.addProperty("URLDetectionOnMouseMove",2,rtl.boolean,"FURLDetectionOnMouseMove","SetURLDetectionOnMouseMove",{Default:!0})})),rtl.createClass(this,"TTMSFNCTreeViewSelectedNodes",pas.Classes.TList,(function(){this.GetItem=function(t){return rtl.getObject(this.Get(t))}})),rtl.recNewT(this,"TTMSFNCTreeViewNodeCheck",(function(){this.AColumn=0,this.ANode=null,this.$eq=function(t){return this.AColumn===t.AColumn&&this.ANode===t.ANode},this.$assign=function(t){return this.AColumn=t.AColumn,this.ANode=t.ANode,this}})),rtl.recNewT(this,"TTMSFNCTreeViewNodeAnchor",(function(){this.AAnchor="",this.AColumn=0,this.$eq=function(t){return this.AAnchor===t.AAnchor&&this.AColumn===t.AColumn},this.$assign=function(t){return this.AAnchor=t.AAnchor,this.AColumn=t.AColumn,this}})),rtl.createClass(this,"TTMSFNCTreeViewComboBox",pas["WEBLib.StdCtrls"].TComboBox,(function(){rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TTMSFNCTreeViewMemo",pas["WEBLib.StdCtrls"].TMemo,(function(){this.$init=function(){pas["WEBLib.StdCtrls"].TMemo.$init.call(this),this.FTreeView=null},this.$final=function(){this.FTreeView=void 0,pas["WEBLib.StdCtrls"].TMemo.$final.call(this)},this.KeyDown=function(t,e){if(pas["WEBLib.Controls"].TControl.KeyDown.apply(this,arguments),null!=this.FTreeView&&this.FTreeView.FInplaceEditorActive){var i=t.get();27===i?(this.FTreeView.CloseInplaceEditor(!0,!0),t.set(0)):113===i&&(this.FTreeView.CloseInplaceEditor(!1,!0),t.set(0))}},this.DoExit=function(){pas["WEBLib.Controls"].TControl.DoExit.call(this),null!=this.FTreeView&&this.FTreeView.FInplaceEditorActive&&this.FTreeView.CloseInplaceEditor(!1,!1)},this.Create$1=function(e){return pas["WEBLib.Controls"].TControl.Create$1.apply(this,arguments),t.TTMSFNCCustomTreeView.isPrototypeOf(e)&&(this.FTreeView=rtl.as(e,t.TTMSFNCCustomTreeView)),this},rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TTMSFNCTreeViewEdit",pas["WEBLib.StdCtrls"].TEdit,(function(){this.$init=function(){pas["WEBLib.StdCtrls"].TEdit.$init.call(this),this.FTreeView=null},this.$final=function(){this.FTreeView=void 0,pas["WEBLib.StdCtrls"].TEdit.$final.call(this)},this.KeyDown=function(t,e){if(pas["WEBLib.Controls"].TControl.KeyDown.apply(this,arguments),null!=this.FTreeView&&this.FTreeView.FInplaceEditorActive){var i=t.get();27===i?(this.FTreeView.CloseInplaceEditor(!0,!0),t.set(0)):113!==i&&13!==i||(this.FTreeView.CloseInplaceEditor(!1,!0),t.set(0))}},this.DoExit=function(){pas["WEBLib.Controls"].TControl.DoExit.call(this),null!=this.FTreeView&&this.FTreeView.FInplaceEditorActive&&this.FTreeView.CloseInplaceEditor(!1,!1)},this.Create$1=function(e){return pas["WEBLib.Controls"].TControl.Create$1.apply(this,arguments),t.TTMSFNCCustomTreeView.isPrototypeOf(e)&&(this.FTreeView=rtl.as(e,t.TTMSFNCCustomTreeView)),this},rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TTMSFNCTreeViewCopyNodes",pas["WEBLib.TMSFNCTreeViewData"].TTMSFNCTreeViewNodes,(function(){})),rtl.createClass(this,"TTMSFNCTreeViewAdapter",pas["WEBLib.TMSFNCCustomComponent"].TTMSFNCCustomComponent,(function(){this.$init=function(){pas["WEBLib.TMSFNCCustomComponent"].TTMSFNCCustomComponent.$init.call(this),this.FBlockAdd=!1,this.FTreeView=null,this.FActive=!1},this.$final=function(){this.FTreeView=void 0,pas["WEBLib.TMSFNCCustomComponent"].TTMSFNCCustomComponent.$final.call(this)},this.SetActive=function(t){this.FActive=t,null!=this.FTreeView&&this.Initialize()},this.SetTreeView=function(t){if(this.FTreeView!==t){if(this.FTreeView=t,this.FBlockAdd)return;this.FBlockAdd=!0,null!=this.FTreeView&&(this.FTreeView.SetAdapter(this),this.Initialize()),this.FBlockAdd=!1}},this.GetNumberOfNodes=function(t,e){},this.Notification=function(t,e){pas.Classes.TComponent.Notification.apply(this,arguments),1===e&&t===this.FTreeView&&(this.FTreeView=null)},this.UpdateBounds=function(){},this.Initialize=function(){},this.ScrollTreeView=function(t){},this.SelectNode=function(t){},this.GetNodeText=function(t,e,i){},this.GetColumnDisplayName=function(t){return"",""},this.Create$1=function(e){var i=0;if(pas["WEBLib.TMSFNCCustomComponent"].TTMSFNCCustomComponent.Create$1.apply(this,arguments),this.FActive=!1,this.IsDesignTime()&&null!=e&&pas["WEBLib.Forms"].TCustomForm.isPrototypeOf(e))for(var s=0,o=e.GetComponentCount()-1;s<=o;s++)if(i=s,t.TTMSFNCCustomTreeView.isPrototypeOf(e.GetComponent(i))){this.SetTreeView(rtl.as(e.GetComponent(i),t.TTMSFNCCustomTreeView));break}return this},rtl.addIntf(this,pas["WEBLib.TMSFNCTypes"].ITMSFNCProductInfo),rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas.System.IUnknown);var e=this.$rtti;e.addProperty("Active",2,rtl.boolean,"FActive","SetActive",{Default:!1}),e.addProperty("TreeView",2,t.$rtti.TTMSFNCCustomTreeView,"FTreeView","SetTreeView")})),rtl.createClass(this,"TTMSFNCTreeViewViewJSONOptions",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FValueHTMLTemplate="",this.FExpandNodes=!1,this.FNameHTMLTemplate="",this.FStretchColumn=0,this.FArrayItemPrefix="",this.FArrayItemSuffix=""},this.Create$1=function(){return this.FExpandNodes=!0,this.FStretchColumn=1,this.FNameHTMLTemplate="<#NAME>",this.FValueHTMLTemplate="<#VALUE>",this.FArrayItemPrefix="",this.FArrayItemSuffix="",this},this.Destroy=function(){pas.System.TObject.Destroy.call(this)},this.Assign=function(e){t.TTMSFNCTreeViewViewJSONOptions.isPrototypeOf(e)?(this.FExpandNodes=rtl.as(e,t.TTMSFNCTreeViewViewJSONOptions).FExpandNodes,this.FStretchColumn=rtl.as(e,t.TTMSFNCTreeViewViewJSONOptions).FStretchColumn,this.FNameHTMLTemplate=rtl.as(e,t.TTMSFNCTreeViewViewJSONOptions).FNameHTMLTemplate,this.FValueHTMLTemplate=rtl.as(e,t.TTMSFNCTreeViewViewJSONOptions).FValueHTMLTemplate,this.FArrayItemPrefix=rtl.as(e,t.TTMSFNCTreeViewViewJSONOptions).FArrayItemPrefix,this.FArrayItemSuffix=rtl.as(e,t.TTMSFNCTreeViewViewJSONOptions).FArrayItemSuffix):pas.Classes.TPersistent.Assign.apply(this,arguments)};var e=this.$rtti;e.addProperty("ExpandNodes",0,rtl.boolean,"FExpandNodes","FExpandNodes",{Default:!0}),e.addProperty("StretchColumn",0,rtl.longint,"FStretchColumn","FStretchColumn",{Default:1}),e.addProperty("NameHTMLTemplate",0,rtl.string,"FNameHTMLTemplate","FNameHTMLTemplate"),e.addProperty("ValueHTMLTemplate",0,rtl.string,"FValueHTMLTemplate","FValueHTMLTemplate"),e.addProperty("ArrayItemPrefix",0,rtl.string,"FArrayItemPrefix","FArrayItemPrefix"),e.addProperty("ArrayItemSuffix",0,rtl.string,"FArrayItemSuffix","FArrayItemSuffix")})),rtl.createClass(this,"TTMSFNCCustomTreeView",pas["WEBLib.TMSFNCTreeViewData"].TTMSFNCTreeViewData,(function(){this.$init=function(){pas["WEBLib.TMSFNCTreeViewData"].TTMSFNCTreeViewData.$init.call(this),this.FPrevDSP=null,this.FOldTopRow=0,this.FCompactMode=!1,this.FVerticalOffset=0,this.FVerticalOffsetTo=0,this.FAccepted=!1,this.FLookupString="",this.FY=0,this.FDragY=0,this.FSaveDragY=0,this.FX=0,this.FDragBitmap=null,this.FReorderMode=!1,this.FDragMode$1=!1,this.FDragModeStarted=!1,this.FSortColumn=0,this.FClosing=!1,this.FInplaceEditorClosed=!1,this.FColumnSize=0,this.FCloseWithDialogKey=!1,this.FFilterPopup=null,this.FFilterListBox=null,this.FFilterTimer=null,this.FInplaceEditorClass=null,this.FInplaceEditor=null,this.FOldInplaceEditor=null,this.FInplaceEditorActive=!1,this.FSizeColumn=0,this.FDownColumn=0,this.FDownColumnFilter=0,this.FDownColumnExpand=0,this.FUpdateNodeColumn=0,this.FUpdateNode=null,this.FCopyNodes=null,this.FDoubleSelection=!1,this.FDragTimer=null,this.FDragRow=0,this.FDownNode=null,this.FFocusedNode=null,this.FDragNode=null,this.FDblClicked=!1,this.FDoNodeAnchor=t.TTMSFNCTreeViewNodeAnchor.$new(),this.FDoNodeTitleAnchor=t.TTMSFNCTreeViewNodeAnchor.$new(),this.FDoNodeCheck=t.TTMSFNCTreeViewNodeCheck.$new(),this.FDoNodeExpand=!1,this.FDoNodeExtra=!1,this.FDoNodeTitleExtra=!1,this.FScrolling=!1,this.FMouseUp=!1,this.FAnimateVerticalPos=!1,this.FAnimateHorizontalPos=!1,this.FAnimateVerticalOffset=!1,this.FAnimating=!1,this.FSpX=0,this.FSpY=0,this.FScrollX=0,this.FScrollY=0,this.FDownX=0,this.FDownY=0,this.FMouseX=0,this.FMouseY=0,this.FSizeX=0,this.FScrollVTo=0,this.FScrollHTo=0,this.FTimeStart=0,this.FTimeStop=0,this.FAnimateTimer=null,this.FNodeCache=null,this.FColumnsTopCache=null,this.FColumnsBottomCache=null,this.FGroupsTopCache=null,this.FGroupsBottomCache=null,this.FNodeDisplay=null,this.FColumnsTopDisplay=null,this.FColumnsBottomDisplay=null,this.FGroupsTopDisplay=null,this.FGroupsBottomDisplay=null,this.FNodesAppearance=null,this.FColumnsCaching=!1,this.FGroupsCaching=!1,this.FGroupsAppearance=null,this.FColumnsAppearance=null,this.FOnAfterDrawGroup=null,this.FOnNodeCompare=null,this.FOnBeforeSizeColumn=null,this.FOnAfterSizeColumn=null,this.FOnBeforeDrawColumn=null,this.FOnBeforeDrawColumnHeader=null,this.FOnAfterDrawColumnHeader=null,this.FOnBeforeDrawNode=null,this.FOnAfterDrawColumn=null,this.FOnBeforeDrawGroup=null,this.FOnAfterDrawNode=null,this.FOnBeforeDrawNodeText=null,this.FOnBeforeDrawNodeTitle=null,this.FOnGetNodeHeight=null,this.FOnAfterDrawColumnText=null,this.FOnBeforeDrawGroupText=null,this.FOnAfterDrawNodeText=null,this.FOnAfterDrawNodeTitle=null,this.FOnAfterDrawGroupText=null,this.FOnBeforeDrawColumnText=null,this.FInteraction=null,this.FOnAfterUpdateNode=null,this.FOnBeforeUpdateNode=null,this.FOnAfterUnCheckNode=null,this.FOnBeforeUnCheckNode=null,this.FOnAfterCheckNode=null,this.FOnBeforeCheckNode=null,this.FOnAfterExpandNode=null,this.FOnBeforeExpandNode=null,this.FOnAfterCollapseNode=null,this.FOnBeforeCollapseNode=null,this.FOnBeforeSelectNode=null,this.FOnAfterSelectNode=null,this.FOnBeforeSelectAllNodes=null,this.FOnAfterSelectAllNodes=null,this.FOnNodeClick=null,this.FOnNodeDblClick=null,this.FOnGetNodeText=null,this.FOnGetNodeTitle=null,this.FOnGetColumnText=null,this.FOnGetGroupText=null,this.FOnNodeAnchorClick=null,this.FOnVScroll=null,this.FOnHScroll=null,this.FOnBeforeDrawColumnEmptySpace=null,this.FOnAfterDrawColumnEmptySpace=null,this.FOnBeforeDrawGroupEmptySpace=null,this.FOnAfterDrawGroupEmptySpace=null,this.FOnGetNumberOfNodes=null,this.FOnIsNodeExpanded=null,this.FOnIsNodeEnabled=null,this.FOnIsNodeVisible=null,this.FSelectedNodes=null,this.FOnGetNodeDisabledColor=null,this.FOnGetNodeTextColor=null,this.FOnGetNodeTitleColor=null,this.FOnGetNodeSelectedColor=null,this.FOnGetNodeColor=null,this.FOnGetNodeDisabledTextColor=null,this.FOnGetNodeSelectedTextColor=null,this.FOnGetNodeDisabledTitleColor=null,this.FOnGetNodeSelectedTitleColor=null,this.FOnIsNodeExtended=null,this.FOnGetNodeIcon=null,this.FOnGetColumnWordWrapping=null,this.FOnGetColumnVerticalTextAlign=null,this.FOnGetColumnTrimming=null,this.FOnGetColumnHorizontalTextAlign=null,this.FOnGetNodeWordWrapping=null,this.FOnGetNodeVerticalTextAlign=null,this.FOnGetNodeTrimming=null,this.FOnGetNodeHorizontalTextAlign=null,this.FOnIsNodeChecked=null,this.FOnBeforeDrawNodeIcon=null,this.FOnBeforeDrawNodeExpand=null,this.FOnAfterDrawNodeIcon=null,this.FOnAfterDrawNodeExpand=null,this.FOnGetNodeCheckType=null,this.FOnAfterDrawNodeCheck=null,this.FOnBeforeDrawNodeCheck=null,this.FColumnStroke=null,this.FOnAfterDrawNodeColumn=null,this.FOnBeforeDrawNodeColumn=null,this.FOnBeforeUnSelectNode=null,this.FOnAfterUnSelectNode=null,this.FOnAfterOpenInplaceEditor=null,this.FOnGetInplaceEditor=null,this.FOnCloseInplaceEditor=null,this.FOnBeforeOpenInplaceEditor=null,this.FOnNodeChanged=null,this.FOnCustomizeInplaceEditor=null,this.FOnGetInplaceEditorRect=null,this.FOnBeforeReorderNode=null,this.FOnAfterReorderNode=null,this.FOnAfterDropNode=null,this.FOnBeforeDropNode=null,this.FOnAfterCutToClipboard=null,this.FOnBeforePasteFromClipboard=null,this.FOnBeforeCopyToClipboard=null,this.FOnAfterPasteFromClipboard=null,this.FOnBeforeCutToClipboard=null,this.FOnAfterCopyToClipboard=null,this.FOnNeedFilterDropDownData=null,this.FOnFilterSelect=null,this.FOnCustomReorder=null,this.FOnCustomDragDrop=null,this.FOnCustomDragOver=null,this.FOnCustomCopyToClipboard=null,this.FOnCustomCutToClipboard=null,this.FOnCustomPasteFromClipboard=null,this.FOnCustomColumnSort=null,this.FOnCustomLookup=null,this.FOnBeforeDrawSortIndicator=null,this.FOnAfterDrawSortIndicator=null,this.FAdapter=null,this.FOnGetNodeSides=null,this.FOnGetNodeExtraSize=null,this.FOnGetNodeTitleExtraSize=null,this.FOnAfterDrawNodeExtra=null,this.FOnBeforeDrawNodeExtra=null,this.FOnDrawNodeExtra=null,this.FOnGetNodeTitleTrimming=null,this.FOnGetNodeTitleHorizontalTextAlign=null,this.FOnGetNodeTitleWordWrapping=null,this.FOnGetNodeTitleVerticalTextAlign=null,this.FOnNodeTitleAnchorClick=null,this.FOnGetNodeExpanded=null,this.FOnBeforeDrawNodeTitleExtra=null,this.FOnAfterDrawNodeTitleExtra=null,this.FOnDrawNodeTitleExtra=null,this.FOnNodeMouseEnter=null,this.FOnNodeMouseLeave=null,this.FOnGetNodeIconSize=null,this.FOnColumnAnchorClick=null,this.FOnFocusedNodeChanged=null,this.FOnGetNodeData=null,this.FOnAfterSortNodes=null,this.FOnBeforeSortNodes=null,this.FGlobalFont=null,this.FOnGetNodeRounding=null,this.FOnGetNodeDisabledStrokeColor=null,this.FOnGetNodeSelectedStrokeColor=null,this.FOnGetNodeStrokeColor=null,this.FOnGetHTMLTemplateValue=null,this.FOnGetHTMLTemplate=null,this.FDefaultViewJSONOptions=null,this.FOnAfterAddJSONNode=null,this.FOnBeforeAddJSONNode=null,this.FCheckStartSize=0},this.$final=function(){this.FPrevDSP=void 0,this.FDragBitmap=void 0,this.FFilterPopup=void 0,this.FFilterListBox=void 0,this.FFilterTimer=void 0,this.FInplaceEditorClass=void 0,this.FInplaceEditor=void 0,this.FOldInplaceEditor=void 0,this.FUpdateNode=void 0,this.FCopyNodes=void 0,this.FDragTimer=void 0,this.FDownNode=void 0,this.FFocusedNode=void 0,this.FDragNode=void 0,this.FDoNodeAnchor=void 0,this.FDoNodeTitleAnchor=void 0,this.FDoNodeCheck=void 0,this.FAnimateTimer=void 0,this.FNodeCache=void 0,this.FColumnsTopCache=void 0,this.FColumnsBottomCache=void 0,this.FGroupsTopCache=void 0,this.FGroupsBottomCache=void 0,this.FNodeDisplay=void 0,this.FColumnsTopDisplay=void 0,this.FColumnsBottomDisplay=void 0,this.FGroupsTopDisplay=void 0,this.FGroupsBottomDisplay=void 0,this.FNodesAppearance=void 0,this.FGroupsAppearance=void 0,this.FColumnsAppearance=void 0,this.FOnAfterDrawGroup=void 0,this.FOnNodeCompare=void 0,this.FOnBeforeSizeColumn=void 0,this.FOnAfterSizeColumn=void 0,this.FOnBeforeDrawColumn=void 0,this.FOnBeforeDrawColumnHeader=void 0,this.FOnAfterDrawColumnHeader=void 0,this.FOnBeforeDrawNode=void 0,this.FOnAfterDrawColumn=void 0,this.FOnBeforeDrawGroup=void 0,this.FOnAfterDrawNode=void 0,this.FOnBeforeDrawNodeText=void 0,this.FOnBeforeDrawNodeTitle=void 0,this.FOnGetNodeHeight=void 0,this.FOnAfterDrawColumnText=void 0,this.FOnBeforeDrawGroupText=void 0,this.FOnAfterDrawNodeText=void 0,this.FOnAfterDrawNodeTitle=void 0,this.FOnAfterDrawGroupText=void 0,this.FOnBeforeDrawColumnText=void 0,this.FInteraction=void 0,this.FOnAfterUpdateNode=void 0,this.FOnBeforeUpdateNode=void 0,this.FOnAfterUnCheckNode=void 0,this.FOnBeforeUnCheckNode=void 0,this.FOnAfterCheckNode=void 0,this.FOnBeforeCheckNode=void 0,this.FOnAfterExpandNode=void 0,this.FOnBeforeExpandNode=void 0,this.FOnAfterCollapseNode=void 0,this.FOnBeforeCollapseNode=void 0,this.FOnBeforeSelectNode=void 0,this.FOnAfterSelectNode=void 0,this.FOnBeforeSelectAllNodes=void 0,this.FOnAfterSelectAllNodes=void 0,this.FOnNodeClick=void 0,this.FOnNodeDblClick=void 0,this.FOnGetNodeText=void 0,this.FOnGetNodeTitle=void 0,this.FOnGetColumnText=void 0,this.FOnGetGroupText=void 0,this.FOnNodeAnchorClick=void 0,this.FOnVScroll=void 0,this.FOnHScroll=void 0,this.FOnBeforeDrawColumnEmptySpace=void 0,this.FOnAfterDrawColumnEmptySpace=void 0,this.FOnBeforeDrawGroupEmptySpace=void 0,this.FOnAfterDrawGroupEmptySpace=void 0,this.FOnGetNumberOfNodes=void 0,this.FOnIsNodeExpanded=void 0,this.FOnIsNodeEnabled=void 0,this.FOnIsNodeVisible=void 0,this.FSelectedNodes=void 0,this.FOnGetNodeDisabledColor=void 0,this.FOnGetNodeTextColor=void 0,this.FOnGetNodeTitleColor=void 0,this.FOnGetNodeSelectedColor=void 0,this.FOnGetNodeColor=void 0,this.FOnGetNodeDisabledTextColor=void 0,this.FOnGetNodeSelectedTextColor=void 0,this.FOnGetNodeDisabledTitleColor=void 0,this.FOnGetNodeSelectedTitleColor=void 0,this.FOnIsNodeExtended=void 0,this.FOnGetNodeIcon=void 0,this.FOnGetColumnWordWrapping=void 0,this.FOnGetColumnVerticalTextAlign=void 0,this.FOnGetColumnTrimming=void 0,this.FOnGetColumnHorizontalTextAlign=void 0,this.FOnGetNodeWordWrapping=void 0,this.FOnGetNodeVerticalTextAlign=void 0,this.FOnGetNodeTrimming=void 0,this.FOnGetNodeHorizontalTextAlign=void 0,this.FOnIsNodeChecked=void 0,this.FOnBeforeDrawNodeIcon=void 0,this.FOnBeforeDrawNodeExpand=void 0,this.FOnAfterDrawNodeIcon=void 0,this.FOnAfterDrawNodeExpand=void 0,this.FOnGetNodeCheckType=void 0,this.FOnAfterDrawNodeCheck=void 0,this.FOnBeforeDrawNodeCheck=void 0,this.FColumnStroke=void 0,this.FOnAfterDrawNodeColumn=void 0,this.FOnBeforeDrawNodeColumn=void 0,this.FOnBeforeUnSelectNode=void 0,this.FOnAfterUnSelectNode=void 0,this.FOnAfterOpenInplaceEditor=void 0,this.FOnGetInplaceEditor=void 0,this.FOnCloseInplaceEditor=void 0,this.FOnBeforeOpenInplaceEditor=void 0,this.FOnNodeChanged=void 0,this.FOnCustomizeInplaceEditor=void 0,this.FOnGetInplaceEditorRect=void 0,this.FOnBeforeReorderNode=void 0,this.FOnAfterReorderNode=void 0,this.FOnAfterDropNode=void 0,this.FOnBeforeDropNode=void 0,this.FOnAfterCutToClipboard=void 0,this.FOnBeforePasteFromClipboard=void 0,this.FOnBeforeCopyToClipboard=void 0,this.FOnAfterPasteFromClipboard=void 0,this.FOnBeforeCutToClipboard=void 0,this.FOnAfterCopyToClipboard=void 0,this.FOnNeedFilterDropDownData=void 0,this.FOnFilterSelect=void 0,this.FOnCustomReorder=void 0,this.FOnCustomDragDrop=void 0,this.FOnCustomDragOver=void 0,this.FOnCustomCopyToClipboard=void 0,this.FOnCustomCutToClipboard=void 0,this.FOnCustomPasteFromClipboard=void 0,this.FOnCustomColumnSort=void 0,this.FOnCustomLookup=void 0,this.FOnBeforeDrawSortIndicator=void 0,this.FOnAfterDrawSortIndicator=void 0,this.FAdapter=void 0,this.FOnGetNodeSides=void 0,this.FOnGetNodeExtraSize=void 0,this.FOnGetNodeTitleExtraSize=void 0,this.FOnAfterDrawNodeExtra=void 0,this.FOnBeforeDrawNodeExtra=void 0,this.FOnDrawNodeExtra=void 0,this.FOnGetNodeTitleTrimming=void 0,this.FOnGetNodeTitleHorizontalTextAlign=void 0,this.FOnGetNodeTitleWordWrapping=void 0,this.FOnGetNodeTitleVerticalTextAlign=void 0,this.FOnNodeTitleAnchorClick=void 0,this.FOnGetNodeExpanded=void 0,this.FOnBeforeDrawNodeTitleExtra=void 0,this.FOnAfterDrawNodeTitleExtra=void 0,this.FOnDrawNodeTitleExtra=void 0,this.FOnNodeMouseEnter=void 0,this.FOnNodeMouseLeave=void 0,this.FOnGetNodeIconSize=void 0,this.FOnColumnAnchorClick=void 0,this.FOnFocusedNodeChanged=void 0,this.FOnGetNodeData=void 0,this.FOnAfterSortNodes=void 0,this.FOnBeforeSortNodes=void 0,this.FGlobalFont=void 0,this.FOnGetNodeRounding=void 0,this.FOnGetNodeDisabledStrokeColor=void 0,this.FOnGetNodeSelectedStrokeColor=void 0,this.FOnGetNodeStrokeColor=void 0,this.FOnGetHTMLTemplateValue=void 0,this.FOnGetHTMLTemplate=void 0,this.FDefaultViewJSONOptions=void 0,this.FOnAfterAddJSONNode=void 0,this.FOnBeforeAddJSONNode=void 0,pas["WEBLib.TMSFNCTreeViewData"].TTMSFNCTreeViewData.$final.call(this)},this.SetNodesAppearance=function(t){this.FNodesAppearance!==t&&this.FNodesAppearance.Assign(t)},this.SetGroupsAppearance=function(t){this.FGroupsAppearance!==t&&this.FGroupsAppearance.Assign(t)},this.SetColumnsAppearance=function(t){this.FColumnsAppearance!==t&&this.FColumnsAppearance.Assign(t)},this.SetInteraction=function(t){this.FInteraction!==t&&this.FInteraction.Assign(t)},this.GetFocusedNode=function(){var t,e=null;return e=null,null!=(t=this.FFocusedNode)&&(e=t.FNode),e},this.GetFocusedVirtualNode=function(){return this.FFocusedNode},this.GetSelNode=function(t){var e,i=null;return i=null,null!=(e=this.GetSelVirtualNode(t))&&(i=e.FNode),i},this.GetSelVirtualNode=function(t){var e=null;return e=null,t>=0&&t<=this.SelectedVirtualNodeCount()-1&&(e=this.FSelectedNodes.GetItem(t)),e},this.SetColumnStroke=function(t){this.FColumnStroke!==t&&this.FColumnStroke.Assign(t)},this.HandleFilterTimer=function(e){var i=null,s="",o=0,n=0;if(null!=this.FFilterListBox&&(n=this.FFilterListBox.FTag$1)>=0&&n<=this.FColumns.GetCount()-1){if(this.FColumns.GetItem$1(n).FFiltering.FMultiColumn)for(var r=this.FFilter.GetCount()-1;r>=0;r--)o=r,this.FFilter.GetItem$1(o).FColumn===n&&this.FFilter.Delete(o);else this.FFilter.Clear();(i=this.FFilter.Add$1()).FColumn=n,s="",this.FFilterListBox.GetItemIndex()>=0&&this.FFilterListBox.GetItemIndex()<=this.FFilterListBox.FItems.GetCount()-1&&(s=this.FFilterListBox.FItems.Get(this.FFilterListBox.GetItemIndex())),pas.System.Pos(" ",s)>0&&(s='"'+s+'"'),this.FFilterPopup.SetIsOpen(!1),s===rtl.getResStr(t,"sTMSFNCTreeViewFilterAll")?this.RemoveFilters():(this.DoFilterSelect(i.FColumn,{get:function(){return s},set:function(t){s=t}}),i.FCondition=s,this.ApplyFilter())}this.FFilterTimer.SetEnabled(!1)},this.SetAdapter=function(t){null!=t&&t.SetTreeView(this),this.FAdapter=t},this.GetSelectedVirtualNodeRow=function(){var t,e=0;return e=-1,null!=(t=this.GetFocusedVirtualNode())&&(e=t.FRow),e},this.SetGlobalFont=function(t){this.FGlobalFont.Assign(t)},this.SetDefaultViewJSONOptions=function(t){this.FDefaultViewJSONOptions=t},this.RegisterRuntimeClasses=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.RegisterRuntimeClasses.call(this),pas.Classes.RegisterClass(t.TTMSFNCCustomTreeView)},this.ApplyStyle=function(){var t=0;pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.ApplyStyle.call(this),t=-1,pas["WEBLib.TMSFNCStyles"].TTMSFNCStyles.GetStyleBackgroundFillColor({get:function(){return t},set:function(e){t=e}})&&this.FFill.SetColor(t),pas["WEBLib.TMSFNCStyles"].TTMSFNCStyles.GetStyleLineFillColor({get:function(){return t},set:function(e){t=e}})&&(this.FStroke.SetColor(t),this.FColumnsAppearance.FTopStroke.SetColor(t),this.FColumnsAppearance.FBottomStroke.SetColor(t),this.FGroupsAppearance.FTopStroke.SetColor(t),this.FGroupsAppearance.FBottomStroke.SetColor(t),this.FNodesAppearance.FExtendedFill.SetColor(t),this.FNodesAppearance.FExtendedStroke.SetColor(t)),t=-1,pas["WEBLib.TMSFNCStyles"].TTMSFNCStyles.GetStyleHeaderFillColor({get:function(){return t},set:function(e){t=e}})&&(this.FColumnsAppearance.FTopFill.SetColor(t),this.FColumnsAppearance.FTopFill.SetKind(1),this.FColumnsAppearance.FBottomFill.SetColor(t),this.FColumnsAppearance.FBottomFill.SetKind(1),this.FGroupsAppearance.FTopFill.SetColor(t),this.FGroupsAppearance.FTopFill.SetKind(1),this.FGroupsAppearance.FBottomFill.SetColor(t),this.FGroupsAppearance.FBottomFill.SetKind(1)),t=-1,pas["WEBLib.TMSFNCStyles"].TTMSFNCStyles.GetStyleHeaderFillColorTo({get:function(){return t},set:function(e){t=e}})&&(this.FColumnsAppearance.FTopFill.SetColorTo(t),this.FColumnsAppearance.FTopFill.SetKind(2),this.FColumnsAppearance.FBottomFill.SetColorTo(t),this.FColumnsAppearance.FBottomFill.SetKind(2),this.FGroupsAppearance.FTopFill.SetColorTo(t),this.FGroupsAppearance.FTopFill.SetKind(2),this.FGroupsAppearance.FBottomFill.SetColorTo(t),this.FGroupsAppearance.FBottomFill.SetKind(2)),t=-1,pas["WEBLib.TMSFNCStyles"].TTMSFNCStyles.GetStyleSelectionFillColor({get:function(){return t},set:function(e){t=e}})&&(this.FNodesAppearance.FSelectedFill.SetColor(t),this.FNodesAppearance.FSelectedStroke.SetColor(t)),t=-1,pas["WEBLib.TMSFNCStyles"].TTMSFNCStyles.GetStyleTextFontColor({get:function(){return t},set:function(e){t=e}})&&(this.FNodesAppearance.FFont.SetColor(t),this.FNodesAppearance.SetExtendedFontColor(t),this.FColumnsAppearance.FTopFont.SetColor(t),this.FColumnsAppearance.FBottomFont.SetColor(t),this.FGroupsAppearance.FTopFont.SetColor(t),this.FGroupsAppearance.FBottomFont.SetColor(t)),t=-1,pas["WEBLib.TMSFNCStyles"].TTMSFNCStyles.GetStyleAlternativeTextFontColor({get:function(){return t},set:function(e){t=e}})&&(this.FNodesAppearance.SetSelectedFontColor(t),this.FNodesAppearance.SetSelectedTitleFontColor(t)),t=-1,pas["WEBLib.TMSFNCStyles"].TTMSFNCStyles.GetStyleBackgroundFillColor({get:function(){return t},set:function(e){t=e}})&&this.FFill.SetColor(t)},this.DoEnter=function(){pas["WEBLib.Controls"].TControl.DoEnter.call(this),this.Invalidate()},this.DoExit=function(){pas["WEBLib.Controls"].TControl.DoExit.call(this),this.Invalidate()},this.UpdateControlAfterResize=function(){pas["WEBLib.TMSFNCTreeViewBase"].TTMSFNCTreeViewBase.UpdateControlAfterResize.call(this),null!=this.FAdapter&&this.FAdapter.UpdateBounds()},this.ResetToDefaultStyle=function(){this.BeginUpdate(),pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.SetFontSize(this.FColumnsAppearance.FTopFont,14,1),this.FColumnsAppearance.FTopFont.SetStyle(rtl.createSet(0)),this.FColumnsAppearance.FTopFill.SetColor(16380654),this.FColumnsAppearance.FTopFont.SetColor(4539717),this.FNodesAppearance.FSelectedFill.SetColor(16578806),this.FNodesAppearance.FSelectedStroke.SetColor(15702829),this.FNodesAppearance.FFont.SetColor(8026746),this.FNodesAppearance.SetSelectedFontColor(4539717),this.FNodesAppearance.FSelectedStroke.SetColor(15702829),this.FNodesAppearance.SetShowFocus(!1),this.FNodesAppearance.SetExpandWidth(this.ScalePaintValue(18)),this.FNodesAppearance.SetExpandHeight(this.ScalePaintValue(18)),this.FNodesAppearance.SetShowFocus(!1),this.FNodesAppearance.FSelectedStroke.SetWidth(pas.System.Trunc(this.ScalePaintValue$1(2))),this.FColumnsAppearance.SetTopSize(this.ScalePaintValue(36)),this.FColumnsAppearance.FTopStroke.SetKind(0),this.FFill.SetKind(1),this.FStroke.SetKind(1),this.FFill.SetColor(16777215),this.FStroke.SetColor(11119017),this.FNodesAppearance.FExtendedFill.SetColor(16053492),this.FColumnsAppearance.FBottomFill.SetColor(this.FColumnsAppearance.FTopFill.FColor),this.FColumnsAppearance.FTopStroke.SetColor(11119017),this.FColumnsAppearance.FBottomStroke.SetColor(11119017),this.FColumnsAppearance.FBottomFont.SetColor(this.FColumnsAppearance.FTopFont.FColor),this.FGroupsAppearance.FTopFill.SetColor(16777215),this.FGroupsAppearance.FBottomFill.SetColor(16777215),this.FGroupsAppearance.FTopStroke.SetColor(11119017),this.FGroupsAppearance.FBottomStroke.SetColor(11119017),this.FGroupsAppearance.FTopFont.SetColor(0),this.FGroupsAppearance.FBottomFont.SetColor(0),this.FColumnsAppearance.FTopFill.SetKind(1),this.FColumnsAppearance.FBottomFill.SetKind(0),this.FColumnsAppearance.FBottomStroke.SetKind(1),this.FGroupsAppearance.FTopFill.SetKind(0),this.FGroupsAppearance.FBottomFill.SetKind(0),this.FGroupsAppearance.FTopStroke.SetKind(1),this.FGroupsAppearance.FBottomStroke.SetKind(1),this.FNodesAppearance.SetExtendedFontColor(this.FColumnsAppearance.FTopFont.FColor),this.FColumnsAppearance.FBottomFont.SetColor(this.FColumnsAppearance.FTopFont.FColor),this.FGroupsAppearance.FTopFont.SetColor(this.FColumnsAppearance.FTopFont.FColor),this.FGroupsAppearance.FBottomFont.SetColor(this.FColumnsAppearance.FTopFont.FColor),this.EndUpdate()},this.Notification=function(t,e){pas["WEBLib.TMSFNCTreeViewData"].TTMSFNCTreeViewData.Notification.apply(this,arguments),t===this.FAdapter&&1===e&&(this.FAdapter=null)},this.InitializeColumnSorting=function(t,e){var i=0;this.FUpdateCount$1=this.FUpdateCount$1+1,this.FSortColumn=t;for(var s=0,o=this.FColumns.GetCount()-1;s<=o;s++){i=s;var n=e;0===n?this.FColumns.GetItem$1(i).SetSortKind(1):1===n&&this.FColumns.GetItem$1(i).SetSortKind(2)}this.FUpdateCount$1=this.FUpdateCount$1-1},this.AutoSizeColumnInternal=function(t,e,i){var s=0,o=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),n=null,r=null,a="",l="",h=!1,F=!1,p=0,c=!1,u=0,C=!1,T=null,S=0;if(!(3 in this.FComponentState)&&t>=0&&t<=this.FColumnCount-1&&!this.FColumnsAppearance.FStretch&&this.FNodeListBuild){S=this.GetHorizontalScrollPosition(),p=0,u=this.GetColPos(t),(r=pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.$create("CreateBitmapCanvas",[1,1,!1,!0])).BeginScene(),r.FBitmapContainer=this.GetBitmapContainer(),r.FOptimizedHTMLDrawing=this.FOptimizedHTMLDrawing;try{C=!0,T=null,t>=0&&t<=this.FColumns.GetCount()-1&&((T=this.FColumns.GetItem$1(t)).FUseDefaultAppearance||(C=!1)),0 in this.FColumnsAppearance.FLayouts&&(a=this.GetColumnText(t),this.DoGetColumnText(t,1,{get:function(){return a},set:function(t){a=t}}),C?r.FFont.Assign(this.FColumnsAppearance.FTopFont):r.FFont.Assign(T.FTopFont),o.$assign(pas["WEBLib.TMSFNCTypes"].RectF(0,0,1e4,1e4)),o.$assign(r.CalculateText(a,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(o),!1,!0)),o.Right=o.Right+this.ScalePaintValue(4),o.Right-o.Left>p&&(p=o.Right-o.Left)),1 in this.FColumnsAppearance.FLayouts&&(a=this.GetColumnText(t),this.DoGetColumnText(t,2,{get:function(){return a},set:function(t){a=t}}),C?r.FFont.Assign(this.FColumnsAppearance.FBottomFont):r.FFont.Assign(T.FBottomFont),o.$assign(pas["WEBLib.TMSFNCTypes"].RectF(0,0,1e4,1e4)),o.$assign(r.CalculateText(a,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(o),!1,!0)),o.Right=o.Right+this.ScalePaintValue(4),o.Right-o.Left>p&&(p=o.Right-o.Left));for(var d=this.StartRow(),m=this.StopRow();d<=m;d++)s=d,null!=(n=this.GetVisibleNodeForIndex(s))&&(a="",this.DoGetNodeText(n,t,0,{get:function(){return a},set:function(t){a=t}}),h=!1,t>=0&&t<=this.FColumns.GetCount()-1&&(h=this.FColumns.GetItem$1(t).FWordWrapping),this.DoGetNodeWordWrapping(n,t,{get:function(){return h},set:function(t){h=t}}),o.$assign(pas["WEBLib.TMSFNCTypes"].RectF(0,0,1e4,1e4)),o.$assign(r.CalculateText(a,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(o),!1,!0)),o.Right=o.Right+this.ScalePaintValue(4),t<=rtl.length(n.FBitmapRects)-1&&(o.Right=o.Right+n.FBitmapRects[t].Right+S-u+this.ScalePaintValue(3)),o.Right-o.Left>p&&(p=o.Right-o.Left),l="",this.DoGetNodeTitle(n,t,0,{get:function(){return l},set:function(t){l=t}}),F=!1,t>=0&&t<=this.FColumns.GetCount()-1&&(F=this.FColumns.GetItem$1(t).FTitleWordWrapping),this.DoGetNodeTitleWordWrapping(n,t,{get:function(){return F},set:function(t){F=t}}),o.$assign(pas["WEBLib.TMSFNCTypes"].RectF(0,0,1e4,1e4)),o.$assign(r.CalculateText(l,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(o),!1,!0)),o.Right=o.Right+this.ScalePaintValue(4),t<=rtl.length(n.FBitmapRects)-1&&(o.Right=o.Right+n.FBitmapRects[t].Right+S-u+this.ScalePaintValue(3)),o.Right-o.Left>p&&(p=o.Right-o.Left))}finally{r.EndScene(),r=rtl.freeLoc(r)}p=pas.System.Int(p),c=!0,i&&this.DoBeforeSizeColumn(t,this.GetColWidths(t),{get:function(){return p},set:function(t){p=t}},{get:function(){return c},set:function(t){c=t}}),c&&(this.SetColWidths(t,p),i&&this.DoAfterSizeColumn(t,p),e&&(this.UpdateTreeView(),this.Invalidate()))}},this.DoNodeCompare=function(t,e,i,s){null!=this.FOnNodeCompare&&this.FOnNodeCompare(this,t,e,i,s)},this.SetFonts=function(t){this.BeginUpdate(),this.FGlobalFont.ApplyChange(this.FNodesAppearance.FFont,t),this.FGlobalFont.ApplyChange(this.FNodesAppearance.FExtendedFont,t),this.FGlobalFont.ApplyChange(this.FNodesAppearance.FTitleFont,t),this.FGlobalFont.ApplyChange(this.FColumnsAppearance.FTopFont,t),this.FGlobalFont.ApplyChange(this.FColumnsAppearance.FBottomFont,t),this.FGlobalFont.ApplyChange(this.FGroupsAppearance.FTopFont,t),this.FGlobalFont.ApplyChange(this.FGroupsAppearance.FBottomFont,t),1===t&&(this.FNodesAppearance.SetSelectedFontColor(this.FGlobalFont.FColor),this.FNodesAppearance.SetExtendedFontColor(this.FGlobalFont.FColor),this.FNodesAppearance.SetSelectedTitleFontColor(this.FGlobalFont.FColor)),this.EndUpdate()},this.DoBeforeSortNodes=function(t,e,i){null!=this.FOnBeforeSortNodes&&this.FOnBeforeSortNodes(this,t,e,i)},this.DoAfterSortNodes=function(t,e){null!=this.FOnAfterSortNodes&&this.FOnAfterSortNodes(this,t,e)},this.DoBeforeDrawSortIndicator=function(t,e,i,s,o,n){null!=this.FOnBeforeDrawSortIndicator&&this.FOnBeforeDrawSortIndicator(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i,s,o,n)},this.DoAfterDrawSortIndicator=function(t,e,i,s,o){null!=this.FOnAfterDrawSortIndicator&&this.FOnAfterDrawSortIndicator(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i,s,o)},this.DoBeforeCutToClipboard=function(t){null!=this.FOnBeforeCutToClipboard&&this.FOnBeforeCutToClipboard(this,t)},this.DoBeforeCopyToClipboard=function(t){null!=this.FOnBeforeCopyToClipboard&&this.FOnBeforeCopyToClipboard(this,t)},this.DoBeforePasteFromClipboard=function(t){null!=this.FOnBeforePasteFromClipboard&&this.FOnBeforePasteFromClipboard(this,t)},this.DoAfterCutToClipboard=function(){null!=this.FOnAfterCutToClipboard&&this.FOnAfterCutToClipboard(this)},this.DoAfterCopyToClipboard=function(){null!=this.FOnAfterCopyToClipboard&&this.FOnAfterCopyToClipboard(this)},this.DoAfterPasteFromClipboard=function(){null!=this.FOnAfterPasteFromClipboard&&this.FOnAfterPasteFromClipboard(this)},this.DoBeforeReorderNode=function(t,e,i){null!=this.FOnBeforeReorderNode&&this.FOnBeforeReorderNode(this,t,e,i)},this.DoAfterReorderNode=function(t,e){null!=this.FOnAfterReorderNode&&this.FOnAfterReorderNode(this,t,e)},this.DoBeforeDropNode=function(t,e,i){null!=this.FOnBeforeDropNode&&this.FOnBeforeDropNode(this,t,e,i)},this.DoAfterDropNode=function(t,e){null!=this.FOnAfterDropNode&&this.FOnAfterDropNode(this,t,e)},this.DoBeforeDrawColumnEmptySpace=function(t,e,i,s,o){null!=this.FOnBeforeDrawColumnEmptySpace&&this.FOnBeforeDrawColumnEmptySpace(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i,s,o)},this.DoAfterDrawColumnEmptySpace=function(t,e,i){null!=this.FOnAfterDrawColumnEmptySpace&&this.FOnAfterDrawColumnEmptySpace(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i)},this.DoBeforeDrawGroupEmptySpace=function(t,e,i,s,o){null!=this.FOnBeforeDrawGroupEmptySpace&&this.FOnBeforeDrawGroupEmptySpace(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i,s,o)},this.DoAfterDrawGroupEmptySpace=function(t,e,i){null!=this.FOnAfterDrawGroupEmptySpace&&this.FOnAfterDrawGroupEmptySpace(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i)},this.DoBeforeDrawColumnHeader=function(t,e,i,s,o,n){null!=this.FOnBeforeDrawColumnHeader&&this.FOnBeforeDrawColumnHeader(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i,s,o,n)},this.DoAfterDrawColumnHeader=function(t,e,i,s){null!=this.FOnAfterDrawColumnHeader&&this.FOnAfterDrawColumnHeader(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i,s)},this.DoBeforeDrawColumn=function(t,e,i,s,o){null!=this.FOnBeforeDrawColumn&&this.FOnBeforeDrawColumn(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i,s,o)},this.DoAfterDrawColumn=function(t,e,i){null!=this.FOnAfterDrawColumn&&this.FOnAfterDrawColumn(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i)},this.DoBeforeDrawNodeColumn=function(t,e,i,s,o){null!=this.FOnBeforeDrawNodeColumn&&this.FOnBeforeDrawNodeColumn(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i,s,o)},this.DoAfterDrawNodeColumn=function(t,e,i){null!=this.FOnAfterDrawNodeColumn&&this.FOnAfterDrawNodeColumn(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i)},this.DoBeforeDrawGroup=function(t,e,i,s,o,n,r,a){null!=this.FOnBeforeDrawGroup&&this.FOnBeforeDrawGroup(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i,s,o,n,r,a)},this.DoAfterDrawGroup=function(t,e,i,s,o,n){null!=this.FOnAfterDrawGroup&&this.FOnAfterDrawGroup(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i,s,o,n)},this.DoBeforeDrawNode=function(t,e,i,s,o){null!=this.FOnBeforeDrawNode&&this.FOnBeforeDrawNode(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i,s,o)},this.DoAfterDrawNode=function(t,e,i){null!=this.FOnAfterDrawNode&&this.FOnAfterDrawNode(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i)},this.DoGetColumnText=function(t,e,i){null!=this.FOnGetColumnText&&this.FOnGetColumnText(this,t,e,i)},this.DoBeforeDrawColumnText=function(t,e,i,s,o,n){null!=this.FOnBeforeDrawColumnText&&this.FOnBeforeDrawColumnText(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i,s,o,n)},this.DoAfterDrawColumnText=function(t,e,i,s,o){null!=this.FOnAfterDrawColumnText&&this.FOnAfterDrawColumnText(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i,s,o)},this.DoGetGroupText=function(t,e,i){null!=this.FOnGetGroupText&&this.FOnGetGroupText(this,t,e,i)},this.DoBeforeDrawGroupText=function(t,e,i,s,o,n,r,a){null!=this.FOnBeforeDrawGroupText&&this.FOnBeforeDrawGroupText(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i,s,o,n,r,a)},this.DoAfterDrawGroupText=function(t,e,i,s,o,n,r){null!=this.FOnAfterDrawGroupText&&this.FOnAfterDrawGroupText(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i,s,o,n,r)},this.DoNodeClick=function(t){null!=this.FOnNodeClick&&this.FOnNodeClick(this,t)},this.DoNodeMouseLeave=function(t){null!=this.FOnNodeMouseLeave&&this.FOnNodeMouseLeave(this,t)},this.DoNodeMouseEnter=function(t){null!=this.FOnNodeMouseEnter&&this.FOnNodeMouseEnter(this,t)},this.DoNodeDblClick=function(t){null!=this.FOnNodeDblClick&&this.FOnNodeDblClick(this,t)},this.DoGetNumberOfNodes=function(t,e){pas["WEBLib.TMSFNCTreeViewData"].TTMSFNCTreeViewData.DoGetNumberOfNodes.apply(this,arguments),null!=this.FAdapter&&this.FAdapter.GetNumberOfNodes(t,e),null!=this.FOnGetNumberOfNodes&&(this.FUpdateCount$1=this.FUpdateCount$1+1,this.FNodeListBuild=!1,this.FNodes.Clear(),this.FUpdateCount$1=this.FUpdateCount$1-1,this.FOnGetNumberOfNodes(this,t,e))},this.DoGetNodeText=function(t,e,i,s){pas["WEBLib.TMSFNCTreeViewData"].TTMSFNCTreeViewData.DoGetNodeText.apply(this,arguments),null!=this.FAdapter&&this.FAdapter.GetNodeText(e,t,s),null!=this.FOnGetNodeText&&this.FOnGetNodeText(this,t,e,i,s)},this.DoGetNodeData=function(t){pas["WEBLib.TMSFNCTreeViewData"].TTMSFNCTreeViewData.DoGetNodeData.apply(this,arguments),null!=this.FOnGetNodeData&&this.FOnGetNodeData(this,t)},this.DoGetNodeTitle=function(t,e,i,s){pas["WEBLib.TMSFNCTreeViewData"].TTMSFNCTreeViewData.DoGetNodeTitle.apply(this,arguments),null!=this.FOnGetNodeTitle&&this.FOnGetNodeTitle(this,t,e,i,s)},this.DoGetNodeTitleExpanded=function(t,e,i){pas["WEBLib.TMSFNCTreeViewData"].TTMSFNCTreeViewData.DoGetNodeTitleExpanded.apply(this,arguments),null!=this.FOnGetNodeExpanded&&this.FOnGetNodeExpanded(this,t,e,i)},this.DoGetNodeTrimming=function(t,e,i){pas["WEBLib.TMSFNCTreeViewData"].TTMSFNCTreeViewData.DoGetNodeTrimming.apply(this,arguments),null!=this.FOnGetNodeTrimming&&this.FOnGetNodeTrimming(this,t,e,i)},this.DoGetNodeHorizontalTextAlign=function(t,e,i){pas["WEBLib.TMSFNCTreeViewData"].TTMSFNCTreeViewData.DoGetNodeHorizontalTextAlign.apply(this,arguments),null!=this.FOnGetNodeHorizontalTextAlign&&this.FOnGetNodeHorizontalTextAlign(this,t,e,i)},this.DoGetNodeVerticalTextAlign=function(t,e,i){null!=this.FOnGetNodeVerticalTextAlign&&this.FOnGetNodeVerticalTextAlign(this,t,e,i)},this.DoGetNodeWordWrapping=function(t,e,i){pas["WEBLib.TMSFNCTreeViewData"].TTMSFNCTreeViewData.DoGetNodeWordWrapping.apply(this,arguments),null!=this.FOnGetNodeWordWrapping&&this.FOnGetNodeWordWrapping(this,t,e,i)},this.DoGetNodeTitleTrimming=function(t,e,i){pas["WEBLib.TMSFNCTreeViewData"].TTMSFNCTreeViewData.DoGetNodeTitleTrimming.apply(this,arguments),null!=this.FOnGetNodeTitleTrimming&&this.FOnGetNodeTitleTrimming(this,t,e,i)},this.DoGetNodeTitleHorizontalTextAlign=function(t,e,i){pas["WEBLib.TMSFNCTreeViewData"].TTMSFNCTreeViewData.DoGetNodeTitleHorizontalTextAlign.apply(this,arguments),null!=this.FOnGetNodeTitleHorizontalTextAlign&&this.FOnGetNodeTitleHorizontalTextAlign(this,t,e,i)},this.DoGetNodeTitleVerticalTextAlign=function(t,e,i){pas["WEBLib.TMSFNCTreeViewData"].TTMSFNCTreeViewData.DoGetNodeTitleVerticalTextAlign.apply(this,arguments),null!=this.FOnGetNodeTitleVerticalTextAlign&&this.FOnGetNodeTitleVerticalTextAlign(this,t,e,i)},this.DoGetNodeTitleWordWrapping=function(t,e,i){pas["WEBLib.TMSFNCTreeViewData"].TTMSFNCTreeViewData.DoGetNodeTitleWordWrapping.apply(this,arguments),null!=this.FOnGetNodeTitleWordWrapping&&this.FOnGetNodeTitleWordWrapping(this,t,e,i)},this.DoGetNodeExtraSize=function(t,e,i){pas["WEBLib.TMSFNCTreeViewData"].TTMSFNCTreeViewData.DoGetNodeExtraSize.apply(this,arguments),null!=this.FOnGetNodeExtraSize&&this.FOnGetNodeExtraSize(this,t,e,i)},this.DoGetNodeTitleExtraSize=function(t,e,i){pas["WEBLib.TMSFNCTreeViewData"].TTMSFNCTreeViewData.DoGetNodeTitleExtraSize.apply(this,arguments),null!=this.FOnGetNodeTitleExtraSize&&this.FOnGetNodeTitleExtraSize(this,t,e,i)},this.DoGetColumnTrimming=function(t,e,i){pas["WEBLib.TMSFNCTreeViewData"].TTMSFNCTreeViewData.DoGetColumnTrimming.apply(this,arguments),null!=this.FOnGetColumnTrimming&&this.FOnGetColumnTrimming(this,t,e,i)},this.DoGetColumnHorizontalTextAlign=function(t,e,i){null!=this.FOnGetColumnHorizontalTextAlign&&this.FOnGetColumnHorizontalTextAlign(this,t,e,i)},this.DoGetColumnVerticalTextAlign=function(t,e,i){null!=this.FOnGetColumnVerticalTextAlign&&this.FOnGetColumnVerticalTextAlign(this,t,e,i)},this.DoGetColumnWordWrapping=function(t,e,i){pas["WEBLib.TMSFNCTreeViewData"].TTMSFNCTreeViewData.DoGetColumnWordWrapping.apply(this,arguments),null!=this.FOnGetColumnWordWrapping&&this.FOnGetColumnWordWrapping(this,t,e,i)},this.DoGetNodeCheckType=function(t,e,i){pas["WEBLib.TMSFNCTreeViewData"].TTMSFNCTreeViewData.DoGetNodeCheckType.apply(this,arguments),null!=this.FOnGetNodeCheckType&&this.FOnGetNodeCheckType(this,t,e,i)},this.DoGetNodeHeight=function(t,e,i){null!=this.FOnGetNodeHeight&&this.FOnGetNodeHeight(this,t,e,i)},this.DoGetNodeIcon=function(t,e,i,s){pas["WEBLib.TMSFNCTreeViewData"].TTMSFNCTreeViewData.DoGetNodeIcon.apply(this,arguments),null!=this.FOnGetNodeIcon&&this.FOnGetNodeIcon(this,t,e,i,s)},this.DoGetNodeIconSize=function(t,e,i,s,o,n){pas["WEBLib.TMSFNCTreeViewData"].TTMSFNCTreeViewData.DoGetNodeIconSize.apply(this,arguments),null!=this.FOnGetNodeIconSize&&this.FOnGetNodeIconSize(this,t,e,i,s,o,n)},this.DoGetNodeSelectedColor=function(t,e){pas["WEBLib.TMSFNCTreeViewData"].TTMSFNCTreeViewData.DoGetNodeSelectedColor.apply(this,arguments),null!=this.FOnGetNodeSelectedStrokeColor&&this.FOnGetNodeSelectedStrokeColor(this,t,e)},this.DoGetNodeSelectedStrokeColor=function(t,e){null!=this.FOnGetNodeSelectedColor&&this.FOnGetNodeSelectedStrokeColor(this,t,e)},this.DoGetNodeSides=function(t,e){pas["WEBLib.TMSFNCTreeViewData"].TTMSFNCTreeViewData.DoGetNodeSides.apply(this,arguments),null!=this.FOnGetNodeSides&&this.FOnGetNodeSides(this,t,e)},this.DoGetNodeRounding=function(t,e,i){null!=this.FOnGetNodeRounding&&this.FOnGetNodeRounding(this,t,e,i)},this.DoGetNodeDisabledColor=function(t,e){pas["WEBLib.TMSFNCTreeViewData"].TTMSFNCTreeViewData.DoGetNodeDisabledColor.apply(this,arguments),null!=this.FOnGetNodeDisabledColor&&this.FOnGetNodeDisabledColor(this,t,e)},this.DoGetNodeDisabledStrokeColor=function(t,e){null!=this.FOnGetNodeDisabledStrokeColor&&this.FOnGetNodeDisabledStrokeColor(this,t,e)},this.DoGetNodeColor=function(t,e){pas["WEBLib.TMSFNCTreeViewData"].TTMSFNCTreeViewData.DoGetNodeColor.apply(this,arguments),null!=this.FOnGetNodeColor&&this.FOnGetNodeColor(this,t,e)},this.DoGetNodeStrokeColor=function(t,e){null!=this.FOnGetNodeStrokeColor&&this.FOnGetNodeStrokeColor(this,t,e)},this.DoGetNodeSelectedTextColor=function(t,e,i){pas["WEBLib.TMSFNCTreeViewData"].TTMSFNCTreeViewData.DoGetNodeSelectedTextColor.apply(this,arguments),null!=this.FOnGetNodeSelectedTextColor&&this.FOnGetNodeSelectedTextColor(this,t,e,i)},this.DoGetNodeDisabledTextColor=function(t,e,i){pas["WEBLib.TMSFNCTreeViewData"].TTMSFNCTreeViewData.DoGetNodeDisabledTextColor.apply(this,arguments),null!=this.FOnGetNodeDisabledTextColor&&this.FOnGetNodeDisabledTextColor(this,t,e,i)},this.DoGetNodeTextColor=function(t,e,i){pas["WEBLib.TMSFNCTreeViewData"].TTMSFNCTreeViewData.DoGetNodeTextColor.apply(this,arguments),null!=this.FOnGetNodeTextColor&&this.FOnGetNodeTextColor(this,t,e,i)},this.DoGetNodeSelectedTitleColor=function(t,e,i){pas["WEBLib.TMSFNCTreeViewData"].TTMSFNCTreeViewData.DoGetNodeSelectedTitleColor.apply(this,arguments),null!=this.FOnGetNodeSelectedTitleColor&&this.FOnGetNodeSelectedTitleColor(this,t,e,i)},this.DoGetNodeDisabledTitleColor=function(t,e,i){pas["WEBLib.TMSFNCTreeViewData"].TTMSFNCTreeViewData.DoGetNodeDisabledTitleColor.apply(this,arguments),null!=this.FOnGetNodeDisabledTitleColor&&this.FOnGetNodeDisabledTitleColor(this,t,e,i)},this.DoGetNodeTitleColor=function(t,e,i){pas["WEBLib.TMSFNCTreeViewData"].TTMSFNCTreeViewData.DoGetNodeTitleColor.apply(this,arguments),null!=this.FOnGetNodeTitleColor&&this.FOnGetNodeTitleColor(this,t,e,i)},this.DoIsNodeExpanded=function(t,e){pas["WEBLib.TMSFNCTreeViewData"].TTMSFNCTreeViewData.DoIsNodeExpanded.apply(this,arguments),null!=this.FOnIsNodeExpanded&&this.FOnIsNodeExpanded(this,t,e)},this.DoIsNodeExtended=function(t,e){pas["WEBLib.TMSFNCTreeViewData"].TTMSFNCTreeViewData.DoIsNodeExtended.apply(this,arguments),null!=this.FOnIsNodeExtended&&this.FOnIsNodeExtended(this,t,e)},this.DoIsNodeChecked=function(t,e,i){pas["WEBLib.TMSFNCTreeViewData"].TTMSFNCTreeViewData.DoIsNodeChecked.apply(this,arguments),null!=this.FOnIsNodeChecked&&this.FOnIsNodeChecked(this,t,e,i)},this.DoIsNodeVisible=function(t,e){pas["WEBLib.TMSFNCTreeViewData"].TTMSFNCTreeViewData.DoIsNodeVisible.apply(this,arguments),null!=this.FOnIsNodeVisible&&this.FOnIsNodeVisible(t,t,e)},this.DoIsNodeEnabled=function(t,e){pas["WEBLib.TMSFNCTreeViewData"].TTMSFNCTreeViewData.DoIsNodeEnabled.apply(this,arguments),null!=this.FOnIsNodeEnabled&&this.FOnIsNodeEnabled(this,t,e)},this.DoBeforeDrawNodeText=function(t,e,i,s,o,n){null!=this.FOnBeforeDrawNodeText&&this.FOnBeforeDrawNodeText(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i,s,o,n)},this.DoAfterDrawNodeText=function(t,e,i,s,o){null!=this.FOnAfterDrawNodeText&&this.FOnAfterDrawNodeText(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i,s,o)},this.DoBeforeDrawNodeTitle=function(t,e,i,s,o,n){null!=this.FOnBeforeDrawNodeTitle&&this.FOnBeforeDrawNodeTitle(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i,s,o,n)},this.DoAfterDrawNodeTitle=function(t,e,i,s,o){null!=this.FOnAfterDrawNodeTitle&&this.FOnAfterDrawNodeTitle(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i,s,o)},this.DoBeforeDrawNodeIcon=function(t,e,i,s,o,n){null!=this.FOnBeforeDrawNodeIcon&&this.FOnBeforeDrawNodeIcon(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i,s,o,n)},this.DoAfterDrawNodeIcon=function(t,e,i,s,o){null!=this.FOnAfterDrawNodeIcon&&this.FOnAfterDrawNodeIcon(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i,s,o)},this.DoBeforeDrawNodeExtra=function(t,e,i,s,o){null!=this.FOnBeforeDrawNodeExtra&&this.FOnBeforeDrawNodeExtra(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i,s,o)},this.DoDrawNodeExtra=function(t,e,i,s){null!=this.FOnDrawNodeExtra&&this.FOnDrawNodeExtra(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i,s)},this.DoAfterDrawNodeExtra=function(t,e,i,s){null!=this.FOnAfterDrawNodeExtra&&this.FOnAfterDrawNodeExtra(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i,s)},this.DoBeforeDrawNodeTitleExtra=function(t,e,i,s,o){null!=this.FOnBeforeDrawNodeTitleExtra&&this.FOnBeforeDrawNodeTitleExtra(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i,s,o)},this.DoDrawNodeTitleExtra=function(t,e,i,s){null!=this.FOnDrawNodeTitleExtra&&this.FOnDrawNodeTitleExtra(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i,s)},this.DoAfterDrawNodeTitleExtra=function(t,e,i,s){null!=this.FOnAfterDrawNodeTitleExtra&&this.FOnAfterDrawNodeTitleExtra(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i,s)},this.DoBeforeDrawNodeCheck=function(t,e,i,s,o,n){null!=this.FOnBeforeDrawNodeCheck&&this.FOnBeforeDrawNodeCheck(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i,s,o,n)},this.DoAfterDrawNodeCheck=function(t,e,i,s,o){null!=this.FOnAfterDrawNodeCheck&&this.FOnAfterDrawNodeCheck(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i,s,o)},this.DoBeforeDrawNodeExpand=function(t,e,i,s,o,n){null!=this.FOnBeforeDrawNodeExpand&&this.FOnBeforeDrawNodeExpand(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i,s,o,n)},this.DoAfterDrawNodeExpand=function(t,e,i,s,o){null!=this.FOnAfterDrawNodeExpand&&this.FOnAfterDrawNodeExpand(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i,s,o)},this.DoBeforeSelectNode=function(t,e){null!=this.FOnBeforeSelectNode&&this.FOnBeforeSelectNode(this,t,e)},this.DoBeforeSelectAllNodes=function(t){null!=this.FOnBeforeSelectAllNodes&&this.FOnBeforeSelectAllNodes(this,t)},this.DoBeforeUnSelectNode=function(t,e){null!=this.FOnBeforeUnSelectNode&&this.FOnBeforeUnSelectNode(this,t,e)},this.DoCustomizeInplaceEditor=function(t,e,i){null!=this.FOnCustomizeInplaceEditor&&this.FOnCustomizeInplaceEditor(this,t,e,i)},this.DoBeforeSizeColumn=function(t,e,i,s){null!=this.FOnBeforeSizeColumn&&this.FOnBeforeSizeColumn(this,t,e,i,s)},this.DoAfterSizeColumn=function(t,e){null!=this.FOnAfterSizeColumn&&this.FOnAfterSizeColumn(this,t,e)},this.DoBeforeUpdateNode=function(t,e,i,s){null!=this.FOnBeforeUpdateNode&&this.FOnBeforeUpdateNode(this,t,e,i,s)},this.DoNodeChanged=function(t){null!=this.FOnNodeChanged&&this.FOnNodeChanged(this,t)},this.DoAfterUpdateNode=function(t,e){null!=this.FOnAfterUpdateNode&&this.FOnAfterUpdateNode(this,t,e)},this.DoUpdateNodeText=function(t,e,i){},this.DoBeforeExpandNode=function(t,e){null!=this.FOnBeforeExpandNode&&this.FOnBeforeExpandNode(this,t,e)},this.DoAfterExpandNode=function(t){null!=this.FOnAfterExpandNode&&this.FOnAfterExpandNode(this,t)},this.DoBeforeCollapseNode=function(t,e){null!=this.FOnBeforeCollapseNode&&this.FOnBeforeCollapseNode(this,t,e)},this.DoAfterCollapseNode=function(t){null!=this.FOnAfterCollapseNode&&this.FOnAfterCollapseNode(this,t)},this.DoBeforeCheckNode=function(t,e,i){null!=this.FOnBeforeCheckNode&&this.FOnBeforeCheckNode(this,t,e,i)},this.DoAfterCheckNode=function(t,e){null!=this.FOnAfterCheckNode&&this.FOnAfterCheckNode(this,t,e)},this.DoBeforeUnCheckNode=function(t,e,i){null!=this.FOnBeforeUnCheckNode&&this.FOnBeforeUnCheckNode(this,t,e,i)},this.DoAfterUnCheckNode=function(t,e){null!=this.FOnAfterUnCheckNode&&this.FOnAfterUnCheckNode(this,t,e)},this.DoNodeAnchorClick=function(t,e,i){null!=this.FOnNodeAnchorClick?this.FOnNodeAnchorClick(this,t,e,i):this.FInteraction.FAutoOpenURL&&pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.OpenURL(i)},this.DoNodeTitleAnchorClick=function(t,e,i){null!=this.FOnNodeTitleAnchorClick?this.FOnNodeTitleAnchorClick(this,t,e,i):this.FInteraction.FAutoOpenURL&&pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.OpenURL(i)},this.DoColumnAnchorClick=function(t,e){null!=this.FOnColumnAnchorClick?this.FOnColumnAnchorClick(this,t,e):this.FInteraction.FAutoOpenURL&&pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.OpenURL(e)},this.DoGetHTMLTemplateValue=function(t,e,i){null!=this.FOnGetHTMLTemplateValue&&this.FOnGetHTMLTemplateValue(this,t,e,i)},this.DoGetHTMLTemplate=function(t,e,i){null!=this.FOnGetHTMLTemplate&&this.FOnGetHTMLTemplate(this,t,e,i)},this.DoBeforeOpenInplaceEditor=function(t,e,i){null!=this.FOnBeforeOpenInplaceEditor&&this.FOnBeforeOpenInplaceEditor(this,t,e,i)},this.DoAfterOpenInplaceEditor=function(t,e,i,s){null!=this.FOnAfterOpenInplaceEditor&&this.FOnAfterOpenInplaceEditor(this,t,e,i,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(s))},this.DoCloseInplaceEditor=function(t,e,i,s,o){null!=this.FOnCloseInplaceEditor&&this.FOnCloseInplaceEditor(this,t,e,i,s,o)},this.UpdateInplaceEditorPosition=function(){var t=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),e=pas.Types.TRect.$new();this.FUpdateCount$1>0||3 in this.FComponentState||null!=this.FUpdateNode&&-1!==this.FUpdateNodeColumn&&null!=this.FInplaceEditor&&this.FInplaceEditorActive&&(this.FUpdateNode.FRow>=this.StartRow()&&this.FUpdateNode.FRow<=this.StopRow()?(t.$assign(this.GetInplaceEditorRect(this.FUpdateNode,this.FUpdateNodeColumn)),this.FInplaceEditor.SetParent(this),this.FInplaceEditor.SetVisible(!1),null!=this.FInplaceEditor&&(e.$assign(pas.Types.Rect(Math.round(t.Left),Math.round(t.Top),Math.round(t.Right),Math.round(t.Bottom))),this.FInplaceEditor.SetBoundsRect(e),this.FInplaceEditor.SetBoundsRect(pas.Types.Rect(e.Left,e.Top+rtl.trunc((e.Bottom-e.Top-this.FInplaceEditor.GetHeight())/2),e.Right,e.Top+rtl.trunc((e.Bottom-e.Top-this.FInplaceEditor.GetHeight())/2)+this.FInplaceEditor.GetHeight())),this.FInplaceEditor.SetVisible(!0))):this.FInplaceEditor.SetParent(null))},this.DoGetInplaceEditor=function(t,e,i){null!=this.FOnGetInplaceEditor&&this.FOnGetInplaceEditor(this,t,e,i)},this.CloseInplaceEditor=function(t,e){var i="",s=!1,o=!1,n="";if(this.FClosing)e&&(this.FInplaceEditorClosed=!0);else{if(this.FClosing=!0,null!=this.FUpdateNode&&-1!==this.FUpdateNodeColumn&&null!=this.FInplaceEditor){if(!t)try{n="",pas["WEBLib.StdCtrls"].TEdit.isPrototypeOf(this.FInplaceEditor)?i=rtl.as(this.FInplaceEditor,pas["WEBLib.StdCtrls"].TEdit).GetText():pas["WEBLib.StdCtrls"].TComboBox.isPrototypeOf(this.FInplaceEditor)?i=rtl.as(this.FInplaceEditor,pas["WEBLib.StdCtrls"].TComboBox).GetText():pas["WEBLib.StdCtrls"].TMemo.isPrototypeOf(this.FInplaceEditor)&&(i=rtl.as(this.FInplaceEditor,pas["WEBLib.StdCtrls"].TMemo).GetText()),n=i}finally{}o=!0,this.DoCloseInplaceEditor(this.FUpdateNode,this.FUpdateNodeColumn,this.FInplaceEditor,t,{get:function(){return o},set:function(t){o=t}}),o&&(s=!0,this.DoBeforeUpdateNode(this.FUpdateNode,this.FUpdateNodeColumn,{get:function(){return n},set:function(t){n=t}},{get:function(){return s},set:function(t){s=t}}),s&&!t&&(this.FUpdateCount$1=this.FUpdateCount$1+1,null!=this.FUpdateNode.FNode&&this.FUpdateNode.FNode.SetText(this.FUpdateNodeColumn,n),this.DoUpdateNodeText(this.FUpdateNode,this.FUpdateNodeColumn,n),this.FUpdateCount$1=this.FUpdateCount$1-1,this.DoAfterUpdateNode(this.FUpdateNode,this.FUpdateNodeColumn),this.DoNodeChanged(this.FUpdateNode)),this.FInplaceEditor.SetParent(null),null!=this.FOldInplaceEditor&&rtl.free(this,"FOldInplaceEditor"),this.FOldInplaceEditor=this.FInplaceEditor,this.FInplaceEditor=null,this.FInplaceEditorActive=!1),this.ResetNodes(!1),this.UpdateTreeView(),this.Invalidate(),this.CanFocus()&&this.SetFocus()}this.FClosing=!1,e&&(this.FInplaceEditorClosed=!0)}},this.DoFocusedNodeChanged=function(t){null!=this.FOnFocusedNodeChanged&&this.FOnFocusedNodeChanged(this,t)},this.DoAfterSelectNode=function(t){null!=this.FAdapter&&this.FAdapter.SelectNode(t),null!=this.FOnAfterSelectNode&&this.FOnAfterSelectNode(this,t)},this.DoAfterSelectAllNodes=function(){null!=this.FOnAfterSelectAllNodes&&this.FOnAfterSelectAllNodes(this)},this.DoAfterUnSelectNode=function(t){null!=this.FOnAfterUnSelectNode&&this.FOnAfterUnSelectNode(this,t)},this.DoHScroll=function(t){null!=this.FOnHScroll&&this.FOnHScroll(this,t)},this.DoVScroll=function(t){null!=this.FAdapter&&this.FAdapter.ScrollTreeView(this.GetFirstVisibleVirtualNodeRow()-this.FOldTopRow),null!=this.FOnVScroll&&this.FOnVScroll(this,t)},this.ResetNodes=function(t){var e=0,i=null,s=0,o=0;if(null!=this.FVisibleNodes){t?(s=0,o=this.FRowCount-1):(s=this.StartRow(),o=this.StopRow());for(var n=s,r=o;n<=r;n++)e=n,null!=(i=this.GetVisibleNodeForIndex(e))&&(this.FTotalRowHeight=this.FTotalRowHeight-i.FHeight+this.FDefaultRowHeight,this.UpdateNodeHeight(i,this.FDefaultRowHeight),this.UpdateNodeCalculated(i,!1))}},this.CreateDragBitmap=function(){var t=null,e=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),i="";if(null!=this.FDragNode){this.DestroyDragBitmap(),e.$assign(this.FDragNode.FCache.FDrawRect),this.FDragBitmap=pas["WEBLib.TMSFNCImage"].TTMSFNCImage.$create("Create$1",[this]),this.FDragBitmap.SetWidth(Math.round((e.Right-e.Left)/this.FResourceScaleFactor)),this.FDragBitmap.SetHeight(Math.round((e.Bottom-e.Top)/this.FResourceScaleFactor)),this.FDragBitmap.SetLeft(Math.round(e.Left/this.FResourceScaleFactor)),this.FDragBitmap.SetTop(Math.round(e.Top/this.FResourceScaleFactor)),(t=pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.$create("CreateBitmapCanvas",[Math.round(this.FDragBitmap.GetWidth()*this.FResourceScaleFactor),Math.round(this.FDragBitmap.GetHeight()*this.FResourceScaleFactor),!1,!0])).FBitmapContainer=this.GetBitmapContainer(),t.FOptimizedHTMLDrawing=this.FOptimizedHTMLDrawing;try{t.BeginScene(),this.DrawNode(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(0,0,e.Right-e.Left,e.Bottom-e.Top)),this.FDragNode,!1,-e.Left,-e.Top),t.EndScene(),i=t.FBitmap.GetBase64Image(),this.FDragBitmap.FBitmaps.AddBitmapFromResource(i,1)}finally{t=rtl.freeLoc(t)}this.FDragBitmap.SetParent(this)}},this.DestroyDragBitmap=function(){null!=this.FDragBitmap&&(this.FDragBitmap.SetParent(null),rtl.free(this,"FDragBitmap"),this.FDragBitmap=null)},this.HandleSelectNode=function(t,e,i,s){var o=0,n=null,r=!1;if(!s)for(var a=this.FSelectedNodes.GetCount()-1;a>=0;a--)o=a,(n=this.FSelectedNodes.GetItem(o))!==t&&(r=!0,e&&this.DoBeforeUnSelectNode(n,{get:function(){return r},set:function(t){r=t}}),r&&(this.FSelectedNodes.IndexOf(n)>-1&&this.FSelectedNodes.Remove(n),e&&this.DoAfterUnSelectNode(n)));null!=t&&(this.FSelectedNodes.IndexOf(t)>-1||null!=this.FDownNode&&this.FDownNode.FParentNode!==t.FParentNode&&3 in this.FInteraction.FMultiSelectStyle&&s?(r=!0,e&&this.DoBeforeUnSelectNode(t,{get:function(){return r},set:function(t){r=t}}),r&&(this.FSelectedNodes.IndexOf(t)>-1&&this.FSelectedNodes.Remove(t),e&&this.DoAfterUnSelectNode(t))):(null==this.FDownNode||this.FDownNode.FParentNode!==t.FParentNode&&s)&&3 in this.FInteraction.FMultiSelectStyle||(this.FVisibleNodes.IndexOf(t)>-1||!(2 in this.FInteraction.FMultiSelectStyle))&&(r=!0,e&&this.DoBeforeSelectNode(t,{get:function(){return r},set:function(t){r=t}}),r&&(this.FSelectedNodes.Add(t),e&&this.DoAfterSelectNode(t))),!i&&e&&this.DoNodeClick(t))},this.Animate=function(t){var i=0,s=0,o=0,n=0,r=0,a=0,l=!1,h=!1,F=!1;n=this.GetVScrollValue(),o=this.GetHScrollValue(),a=this.FVerticalOffset,h=!1,l=!1,F=!1,this.FInteraction.FAnimationFactor>0&&(i=Math.abs(this.FScrollHTo-o)/Math.max(1,Math.abs(this.FSpX)*this.FInteraction.FAnimationFactor),s=Math.abs(this.FScrollVTo-n)/Math.max(1,Math.abs(this.FSpY)*this.FInteraction.FAnimationFactor),r=Math.abs(this.FVerticalOffsetTo-a)/this.FInteraction.FAnimationFactor,this.FAnimateVerticalPos&&(h=e.AnimateDouble({get:function(){return n},set:function(t){n=t}},{p:this,get:function(){return this.p.FScrollVTo},set:function(t){this.p.FScrollVTo=t}},s,.01)),this.FAnimateHorizontalPos&&(l=e.AnimateDouble({get:function(){return o},set:function(t){o=t}},{p:this,get:function(){return this.p.FScrollHTo},set:function(t){this.p.FScrollHTo=t}},i,.01)),this.FAnimateVerticalOffset&&(F=e.AnimateDouble({get:function(){return a},set:function(t){a=t}},{p:this,get:function(){return this.p.FVerticalOffsetTo},set:function(t){this.p.FVerticalOffsetTo=t}},r,.01))),this.FAnimating=h||l,this.FAnimating?this.Scroll(o,n):F?(this.FVerticalOffset=a,this.UpdateDisplay()):(this.FVerticalOffset=this.FVerticalOffsetTo,this.UpdateDisplay(),this.FAnimateVerticalPos=!1,this.FAnimateTimer.SetEnabled(!1),this.FAnimateHorizontalPos=!1)},this.ColumnStrokeChanged=function(t){this.Invalidate()},this.DragTime=function(t){var e=pas["WEBLib.TMSFNCTypes"].TRectF.$new();(this.FReorderMode||this.FDragMode$1&&this.FDragModeStarted&&this.AlternativeDragDrop())&&(e.$assign(this.GetNodesRect()),this.FY>=e.Bottom?(this.FDragRow=this.FDragRow+1,this.ScrollToVirtualNode(this.GetNodeForRow(this.FDragRow),!1,0,!1)):this.FY<=e.Top&&(this.FDragRow=this.FDragRow-1,this.ScrollToVirtualNode(this.GetNodeForRow(this.FDragRow),!1,0,!1)))},this.StopAnimationTimer=function(){this.FAnimateTimer.SetEnabled(!1),this.FAnimating=!1},this.HandleNodeToggle=function(t){var e=!1;null!=t&&t.FChildren>0&&(t.FExpanded?(e=!0,this.FBlockUpdateNode=!0,this.DoBeforeCollapseNode(t,{get:function(){return e},set:function(t){e=t}}),this.FBlockUpdateNode=!1,e&&(this.ToggleNodeInternal(t,!1),this.DoAfterCollapseNode(t))):(e=!0,this.FBlockUpdateNode=!0,this.DoBeforeExpandNode(t,{get:function(){return e},set:function(t){e=t}}),this.FBlockUpdateNode=!1,e&&(this.ToggleNodeInternal(t,!1),this.DoAfterExpandNode(t))))},this.HandleNodeExtra=function(t){},this.HandleNodeTitleExtra=function(t){},this.HandleNodeToggleCheck=function(t,e){var i=!1,s=0;null!=t&&e>=0&&e<=rtl.length(t.FCheckStates)-1&&(t.FCheckStates[e]?(s=0,this.DoGetNodeCheckType(t,e,{get:function(){return s},set:function(t){s=t}}),1===s&&(i=!0,this.DoBeforeUnCheckNode(t,e,{get:function(){return i},set:function(t){i=t}}),i&&(this.ToggleCheckNodeInternal(t,e,!1),this.DoAfterUnCheckNode(t,e)))):(i=!0,this.DoBeforeCheckNode(t,e,{get:function(){return i},set:function(t){i=t}}),i&&(this.ToggleCheckNodeInternal(t,e,!1),this.DoAfterCheckNode(t,e))))},this.HandleNodeExpand=function(t,e){var i=!1;null!=t&&!t.FExpanded&&t.FChildren>0&&(i=!0,this.FBlockUpdateNode=!0,this.DoBeforeExpandNode(t,{get:function(){return i},set:function(t){i=t}}),this.FBlockUpdateNode=!1,i&&(this.ToggleNodeInternal(t,e),this.DoAfterExpandNode(t)))},this.HandleNodeCollapse=function(t,e){var i=!1;null!=t&&t.FExpanded&&t.FChildren>0&&(i=!0,this.FBlockUpdateNode=!0,this.DoBeforeCollapseNode(t,{get:function(){return i},set:function(t){i=t}}),this.FBlockUpdateNode=!1,i&&(this.ToggleNodeInternal(t,e),this.DoAfterCollapseNode(t)))},this.HandleCustomKeys=function(t){},this.OffsetNodeRects=function(t,e,i,s){var o=0,n=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),r=pas["WEBLib.TMSFNCTypes"].TRectF.$new();r.$assign(this.GetNodesRect()),pas["WEBLib.TMSFNCTypes"].OffsetRectEx$1(s,e+r.Left,i+r.Top);for(var a=0,l=this.FColumnCount-1;a<=l;a++)(o=a)>=0&&o<=rtl.length(t.FTitleRects)-1&&(n.$assign(t.FTitleRects[o]),pas["WEBLib.TMSFNCTypes"].OffsetRectEx$1(n,e+r.Left,i+r.Top),t.FTitleRects[o].$assign(n)),o>=0&&o<=rtl.length(t.FTextRects)-1&&(n.$assign(t.FTextRects[o]),pas["WEBLib.TMSFNCTypes"].OffsetRectEx$1(n,e+r.Left,i+r.Top),t.FTextRects[o].$assign(n)),o>=0&&o<=rtl.length(t.FExtraRects)-1&&(n.$assign(t.FExtraRects[o]),pas["WEBLib.TMSFNCTypes"].OffsetRectEx$1(n,e+r.Left,i+r.Top),t.FExtraRects[o].$assign(n)),o>=0&&o<=rtl.length(t.FTitleExtraRects)-1&&(n.$assign(t.FTitleExtraRects[o]),pas["WEBLib.TMSFNCTypes"].OffsetRectEx$1(n,e+r.Left,i+r.Top),t.FTitleExtraRects[o].$assign(n)),o>=0&&o<=rtl.length(t.FBitmapRects)-1&&(n.$assign(t.FBitmapRects[o]),pas["WEBLib.TMSFNCTypes"].OffsetRectEx$1(n,e+r.Left,i+r.Top),t.FBitmapRects[o].$assign(n)),o>=0&&o<=rtl.length(t.FExpandRects)-1&&(n.$assign(t.FExpandRects[o]),pas["WEBLib.TMSFNCTypes"].OffsetRectEx$1(n,e+r.Left,i+r.Top),t.FExpandRects[o].$assign(n)),o>=0&&o<=rtl.length(t.FCheckRects)-1&&(n.$assign(t.FCheckRects[o]),pas["WEBLib.TMSFNCTypes"].OffsetRectEx$1(n,e+r.Left,i+r.Top),t.FCheckRects[o].$assign(n))},this.BuildDisplay=function(t,e){var i,s=0,o=0,n=null,r=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),a=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),l=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),h=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),F=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),p=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),c=null;if(!(this.FUpdateCount$1>0||3 in this.FComponentState||null==t||null==e)){e.Clear(),i=-this.GetHorizontalScrollPosition(),s=-this.GetVerticalScrollPosition(),this.CanApplyVerticalOffset()&&(s+=this.FVerticalOffset),r.$assign(this.GetNodesRect()),F.$assign(this.GetGroupsTopRect()),p.$assign(this.GetGroupsBottomRect()),a.$assign(this.GetColumnsTopRect()),l.$assign(this.GetColumnsBottomRect());for(var u=0,C=t.GetCount()-1;u<=C;u++){o=u,n=t.GetItem$1(o),h.$assign(n.FRect);var T=n.FKind;0===T?null!=(c=n.FNode)&&this.OffsetNodeRects(c,pas.System.Int(i),pas.System.Int(s),h):3===T?pas["WEBLib.TMSFNCTypes"].OffsetRectEx$1(h,pas.System.Int(i)+F.Left,F.Top):4===T?pas["WEBLib.TMSFNCTypes"].OffsetRectEx$1(h,pas.System.Int(i)+p.Left,p.Top-1):1===T?pas["WEBLib.TMSFNCTypes"].OffsetRectEx$1(h,pas.System.Int(i)+a.Left,a.Top):2===T&&pas["WEBLib.TMSFNCTypes"].OffsetRectEx$1(h,pas.System.Int(i)+l.Left,l.Top-1),n.FDrawRect.$assign(h);var S=n.FKind;0===S?pas["WEBLib.TMSFNCTypes"].RectIntersectsWithEx(h,r)&&e.Add(n):1===S?pas["WEBLib.TMSFNCTypes"].RectIntersectsWithEx(h,a)&&e.Add(n):2===S?pas["WEBLib.TMSFNCTypes"].RectIntersectsWithEx(h,l)&&e.Add(n):3===S?pas["WEBLib.TMSFNCTypes"].RectIntersectsWithEx(h,F)&&e.Add(n):4===S&&pas["WEBLib.TMSFNCTypes"].RectIntersectsWithEx(h,p)&&e.Add(n)}}},this.UpdateCalculations=function(){this.FUpdateCount$1>0||3 in this.FComponentState||0 in this.FComponentState||(this.FOldTopRow=this.GetFirstVisibleVirtualNodeRow(),this.SetColumnCount(this.FColumns.GetCount()),0===this.FNodesAppearance.FHeightMode?this.SetDefaultRowHeight(this.FNodesAppearance.FFixedHeight):this.SetDefaultRowHeight(this.FNodesAppearance.FVariableMinimumHeight),0!==this.FUpdateCount$1||this.FBlockUpdateNodeList||3 in this.FComponentState||1 in this.FComponentState||0 in this.FComponentState||this.BuildNodeList())},this.UpdateAutoSizing=function(){this.FColumnsAppearance.FStretch&&this.StretchColumn(this.FColumnsAppearance.FStretchAll,this.FColumnsAppearance.FStretchColumn,-1)},this.UpdateColumnRowCalculations=function(t){var e=0,i=0,s=0,o=0,n=0,r=0,a=0;this.FColumnP.Clear(),s=0,this.SetColPos(0,s);for(var l=0,h=this.FColumnCount-1;l<=h;l++)e=l,s+=this.GetColWidths(e),this.SetColPos(e+1,s);this.FTotalColumnWidth=s,t&&(o=0,n=0,r=0,a=0,this.GetNodeMargins({get:function(){return o},set:function(t){o=t}},{get:function(){return n},set:function(t){n=t}},{get:function(){return r},set:function(t){r=t}},{get:function(){return a},set:function(t){a=t}}),i=this.FRowCount*this.FDefaultRowHeight,this.FTotalRowHeight=i+1+n+a)},this.UpdateColumnsCache=function(){this.UpdateColumnCache(this.FColumnsTopCache),this.UpdateColumnCache(this.FColumnsBottomCache),this.UpdateColumnsDisplay()},this.UpdateColumnCache=function(e){var i,s,o,n=0,r=0,a=0,l=0,h=0,F=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),p=0,c=0,u=0,C=0,T=pas["WEBLib.TMSFNCTypes"].TRectF.$new();if(!(this.FUpdateCount$1>0||3 in this.FComponentState||null==e||(e.Clear(),t.TTMSFNCTreeViewColumnsTopCache.isPrototypeOf(e)&&(!(0 in this.FColumnsAppearance.FLayouts)||this.FColumnsAppearance.FTopSize<=0)||t.TTMSFNCTreeViewColumnsBottomCache.isPrototypeOf(e)&&(!(1 in this.FColumnsAppearance.FLayouts)||this.FColumnsAppearance.FBottomSize<=0))))for(i=this.GetTotalColumnWidth(),n=t.TTMSFNCTreeViewColumnsTopCache.isPrototypeOf(e)?this.GetColumnsTopSize()+1:this.GetColumnsBottomSize()+1,s=this.GetColumnsExtraSize(),u=0,r=0,a=0,C=0,p=0,c=0,o=this.FColumnCount-1;r<i;){for(l=i;a<n;){h=n,F.$assign(pas["WEBLib.TMSFNCTypes"].RectF(0,0,l,h)),c=F.Left+u;for(var S=C,d=o;S<=d&&(p=S,T.Top=pas.System.Int(F.Top)+.5,T.Bottom=pas.System.Int(F.Bottom)-.5,T.Left=pas.System.Int(c)+.5,c=c+this.GetColWidths(p)+s,T.Right=p===o?pas.System.Int(c)-.5:pas.System.Int(c)+.5,pas["WEBLib.TMSFNCTypes"].OffsetRectEx$1(T,r,a),t.TTMSFNCTreeViewColumnsTopCache.isPrototypeOf(e)?e.Add$1(pas["WEBLib.TMSFNCTreeViewData"].TTMSFNCTreeViewCacheItem.CreateColumnTop(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(T),p)):e.Add$1(pas["WEBLib.TMSFNCTreeViewData"].TTMSFNCTreeViewCacheItem.CreateColumnBottom(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(T),p)),!(c>F.Right-F.Left));S++);a+=h}r+=l,a=0,C=p,u=-this.GetColWidths(p)-(l-c)}},this.UpdateGroupsCache=function(){this.UpdateGroupCache(this.FGroupsTopCache),this.UpdateGroupCache(this.FGroupsBottomCache),this.UpdateGroupsDisplay()},this.UpdateGroupCache=function(e){var i=0,s=0,o=pas["WEBLib.TMSFNCTreeViewData"].TTMSFNCTreeViewDisplayGroup.$new(),n=0,r=0,a=0,l=0,h=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),F=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),p=null;if(!(this.FUpdateCount$1>0||3 in this.FComponentState||0===this.FColumnCount||0===this.FDisplayGroups.GetCount()||null==e||(e.Clear(),t.TTMSFNCTreeViewGroupsTopCache.isPrototypeOf(e)&&(!(0 in this.FGroupsAppearance.FLayouts)||this.FGroupsAppearance.FTopSize<=0)||t.TTMSFNCTreeViewGroupsBottomCache.isPrototypeOf(e)&&(!(1 in this.FGroupsAppearance.FLayouts)||this.FGroupsAppearance.FBottomSize<=0)))){i=t.TTMSFNCTreeViewGroupsTopCache.isPrototypeOf(e)?this.GetGroupsTopSize()+1:this.GetGroupsBottomSize()+1;for(var c=0,u=this.FDisplayGroups.GetCount()-1;c<=u;c++)s=c,o.$assign(this.FDisplayGroups.GetItem(s)),r=0,n=pas.System.Int(this.GetColPos(o.StartColumn)),l=i,(a=pas.System.Int(this.GetColPos(o.EndColumn+1)-n))<=0||l<=0||(h.$assign(pas["WEBLib.TMSFNCTypes"].RectF(0,0,a,l)),F.Top=pas.System.Int(h.Top)+.5,F.Bottom=pas.System.Int(h.Bottom)-.5,F.Left=pas.System.Int(h.Left)+.5,F.Right=pas.System.Int(h.Right)+.5,pas["WEBLib.TMSFNCTypes"].OffsetRectEx$1(F,n,r),p=t.TTMSFNCTreeViewGroupsTopCache.isPrototypeOf(e)?pas["WEBLib.TMSFNCTreeViewData"].TTMSFNCTreeViewCacheItem.CreateGroupTop(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(F),s,o.StartColumn,o.EndColumn):pas["WEBLib.TMSFNCTreeViewData"].TTMSFNCTreeViewCacheItem.CreateGroupBottom(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(F),s,o.StartColumn,o.EndColumn),e.Add$1(p))}},this.UpdateNodesCache=function(t,e){this.FBlockUpdateNode||(this.UpdateScrollBars(!0,!1),this.UpdateVisualRange(),this.UpdateNodeCache(),this.UpdateScrollBars(!0,!1),t?(e&&this.ResetNodes(!1),this.UpdateAutoSizing(),this.UpdateColumnRowCalculations(!1),this.UpdateNodesCache(!1,!1),this.UpdateVisualRange()):(this.UpdateNodeDisplay(),this.UpdateInplaceEditorPosition()))},this.UpdateNodeCache=function(){var t=null,e=0,i=0,s=0,o=null;if(!(this.FUpdateCount$1>0||3 in this.FComponentState||null==this.FNodeCache)&&(this.FNodeCache.Clear(),this.FColumnCount>0)){(t=pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.$create("CreateBitmapCanvas",[1,1,!1,!0])).BeginScene(),t.FBitmapContainer=this.GetBitmapContainer(),t.FOptimizedHTMLDrawing=this.FOptimizedHTMLDrawing;try{e=this.GetVerticalScrollPosition(),i=e+this.StartOffset();for(var n=this.StartRow(),r=this.StopRow();n<=r&&(s=n,null==(o=this.GetVisibleNodeForIndex(s))||!this.ConfigureNode(t,s,o,{get:function(){return i},set:function(t){i=t}}));n++);this.CustomizeNodeCache(t,i)}finally{t.EndScene(),t=rtl.freeLoc(t)}}},this.CustomizeNodeCache=function(t,e){},this.UpdateDisplay=function(){pas["WEBLib.TMSFNCTreeViewBase"].TTMSFNCTreeViewBase.UpdateDisplay.call(this),this.UpdateNodesCache(!1,!1),this.UpdateGroupsDisplay(),this.UpdateColumnsDisplay(),this.Invalidate()},this.UpdateTreeViewCache=function(){this.FUpdateCount$1>0||this.IsDestroying()||(pas["WEBLib.TMSFNCTreeViewBase"].TTMSFNCTreeViewBase.UpdateTreeViewCache.call(this),this.Invalidate())},this.UpdateColumnsDisplay=function(){this.BuildDisplay(this.FColumnsTopCache,this.FColumnsTopDisplay),this.BuildDisplay(this.FColumnsBottomCache,this.FColumnsBottomDisplay)},this.UpdateGroupsDisplay=function(){this.BuildDisplay(this.FGroupsTopCache,this.FGroupsTopDisplay),this.BuildDisplay(this.FGroupsBottomCache,this.FGroupsBottomDisplay)},this.UpdateNodeDisplay=function(){this.BuildDisplay(this.FNodeCache,this.FNodeDisplay)},this.VerticalScrollPositionChanged=function(){this.FBlockScrollingUpdate=!0,this.UpdateDisplay(),this.FBlockScrollingUpdate=!1,this.DoVScroll(this.GetVScrollValue())},this.Scroll=function(t,e){var i=0,s=0;i=this.GetHorizontalScrollPosition(),s=this.GetVerticalScrollPosition(),pas["WEBLib.TMSFNCTreeViewBase"].TTMSFNCTreeViewBase.Scroll.apply(this,arguments),i!==t&&this.DoHScroll(t),s!==e&&this.DoVScroll(e)},this.HorizontalScrollPositionChanged=function(){this.FBlockScrollingUpdate=!0,this.UpdateDisplay(),this.FBlockScrollingUpdate=!1,this.DoHScroll(this.GetHScrollValue())},this.DrawNode=function(t,e,i,s,o,n){},this.DrawGroup=function(t,e,i,s,o,n){},this.DrawColumn=function(t,e,i,s){},this.DrawNodes=function(t){this.DrawDisplay(t,this.FNodeDisplay)},this.DrawColumns=function(t){this.DrawDisplay(t,this.FColumnsTopDisplay),this.DrawDisplay(t,this.FColumnsBottomDisplay)},this.DrawNodeColumns=function(t){},this.DrawGroups=function(t){this.DrawDisplay(t,this.FGroupsTopDisplay),this.DrawDisplay(t,this.FGroupsBottomDisplay)},this.DrawBorders=function(t){},this.DrawEmptySpaces=function(t){},this.DrawDisplay=function(e,i){var s,o=0,n=null,r=pas["WEBLib.TMSFNCTypes"].TRectF.$new();if(0!==i.GetCount()){s=e.SaveState(!1),t.TTMSFNCTreeViewNodeDisplayList.isPrototypeOf(i)?(r.$assign(this.GetContentClipRect()),r.Right=r.Right+1):t.TTMSFNCTreeViewGroupsTopDisplayList.isPrototypeOf(i)?(r.$assign(this.GetGroupsTopRect()),r.Bottom=r.Bottom+1):t.TTMSFNCTreeViewGroupsBottomDisplayList.isPrototypeOf(i)?(r.$assign(this.GetGroupsBottomRect()),r.Top=r.Top-1):t.TTMSFNCTreeViewColumnsTopDisplayList.isPrototypeOf(i)?(r.$assign(this.GetColumnsTopRect()),r.Bottom=r.Bottom+1):t.TTMSFNCTreeViewColumnsBottomDisplayList.isPrototypeOf(i)&&(r.$assign(this.GetColumnsBottomRect()),r.Top=r.Top-1),e.ClipRect(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(r));for(var a=0,l=i.GetCount()-1;a<=l;a++)o=a,n=i.GetItem(o),t.TTMSFNCTreeViewNodeDisplayList.isPrototypeOf(i)?null!=n.FNode&&this.DrawNode(e,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(n.FDrawRect),n.FNode,!1,0,0):t.TTMSFNCTreeViewColumnsDisplayList.isPrototypeOf(i)?this.DrawColumn(e,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(n.FDrawRect),n.FColumn,n.FKind):t.TTMSFNCTreeViewGroupsDisplayList.isPrototypeOf(i)&&this.DrawGroup(e,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(n.FDrawRect),n.FGroup,n.FStartColumn,n.FEndColumn,n.FKind);e.RestoreState(s,!1)}},this.HandleDragStart=function(t,e){},this.HandleDragOver=function(e,i,s){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleDragOver.apply(this,arguments),this.FBlockUserInput||null!=this.FOnDragOver||(this.AlternativeDragDrop()||(this.FDragMode$1=!1,this.FDragModeStarted=!1,this.FIsMouseDown=!1),null!=this.FOnCustomDragOver?this.FOnCustomDragOver(this,e,pas["WEBLib.TMSFNCTypes"].TPointF.$clone(i),s):(s.set(0!==this.FInteraction.FDragDropMode&&t.TTMSFNCCustomTreeView.isPrototypeOf(e)&&null!=rtl.as(e,t.TTMSFNCCustomTreeView).FDragNode),s.set(s.get()&&pas["WEBLib.TMSFNCTypes"].PtInRectEx(this.GetNodesRect(),i))),this.FAccepted=s.get())},this.HandleDragDrop=function(e,i){var s=null,o=null,n=!1;if(pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleDragDrop.apply(this,arguments),!this.FBlockUserInput&&null==this.FOnDragDrop)if(null!=this.FOnCustomDragDrop)this.FOnCustomDragDrop(this,e,pas["WEBLib.TMSFNCTypes"].TPointF.$clone(i));else if(this.FAccepted&&null!=e&&t.TTMSFNCCustomTreeView.isPrototypeOf(e)&&0!==rtl.as(e,t.TTMSFNCCustomTreeView).FInteraction.FDragDropMode&&null!=(o=rtl.as(e,t.TTMSFNCCustomTreeView).FDragNode)&&(s=this.XYToNode(i.X,i.Y,0))!==o&&null!=o.FNode&&pas["WEBLib.TMSFNCTypes"].PtInRectEx(this.GetNodesRect(),i)&&(n=!0,this.DoBeforeDropNode(o,s,{get:function(){return n},set:function(t){n=t}}),n)){if(this.BeginUpdate(),rtl.as(e,t.TTMSFNCCustomTreeView).BeginUpdate(),null!=s&&null!=s.FNode){var r=rtl.as(e,t.TTMSFNCCustomTreeView).FInteraction.FDragDropMode;1===r?o.FNode.MoveTo(s.FNode,s.FNode.GetIndex()):2===r&&o.FNode.CopyTo(s.FNode,s.FNode.GetIndex())}else{this.FNodes.Add$1().Assign(o.FNode);var a=rtl.as(e,t.TTMSFNCCustomTreeView).FInteraction.FDragDropMode;1===a&&o.FNode.TreeView().RemoveNode(o.FNode)}rtl.as(e,t.TTMSFNCCustomTreeView).FDragNode=null,rtl.as(e,t.TTMSFNCCustomTreeView).EndUpdate(),this.EndUpdate(),this.DoAfterDropNode(o,s)}},this.HandleMouseDown=function(t,i,s,o){var n=null;pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleMouseDown.apply(this,arguments),1===t||this.FBlockUserInput||this.FBlockMouseClick||(this.FDblClicked||this.CaptureEx(),this.FDragMode$1=!1,this.FDragModeStarted=!1,this.FReorderMode=!1,this.FDragNode=null,this.FDblClicked||(this.CanFocus()&&this.SetFocus(),this.FInplaceEditorActive&&this.CloseInplaceEditor(!1,!1)),n=this.XYToCacheItem(s,o,0),this.FDownNode=null,null!=n&&(this.FDownNode=n.FNode,this.FSelectedNodes.IndexOf(this.FDownNode)>-1&&(this.FDragNode=this.FDownNode,this.FDragMode$1=!(null==this.FDownNode||0===this.FInteraction.FDragDropMode||this.FDblClicked||this.XYToNodeExpand(this.FDownNode,s,o)||this.XYToNodeExtra(this.FDownNode,s,o)||this.XYToNodeTitleExtra(this.FDownNode,s,o)||null!=this.XYToNodeCheck(this.FDownNode,s,o).ANode),this.FReorderMode=null!=this.FDownNode&&this.FInteraction.FReorder&&!this.FDragMode$1&&!this.FDblClicked&&!this.XYToNodeExpand(this.FDownNode,s,o)&&!this.XYToNodeExtra(this.FDownNode,s,o)&&!this.XYToNodeTitleExtra(this.FDownNode,s,o)&&!(null!=this.XYToNodeCheck(this.FDownNode,s,o).ANode),this.FReorderMode&&(this.CreateDragBitmap(),this.FSaveDragY=this.FDragBitmap.GetTop()))),this.FDragMode$1?(this.CanStartDragFromMouseDown()&&(this.FDragModeStarted=!0,this.HandleDragStart(s,o),this.BeginDrag$1()),this.FIsMouseDown=!this.FDblClicked):(null!=this.FDownNode&&(this.FDoNodeExpand=this.XYToNodeExpand(this.FDownNode,s,o),this.FDoNodeCheck.$assign(this.XYToNodeCheck(this.FDownNode,s,o)),this.FDoNodeAnchor.$assign(this.XYToNodeAnchor(this.FDownNode,s,o)),this.FDoNodeTitleAnchor.$assign(this.XYToNodeTitleAnchor(this.FDownNode,s,o)),this.FDoNodeExtra=this.XYToNodeExtra(this.FDownNode,s,o),this.FDoNodeTitleExtra=this.XYToNodeTitleExtra(this.FDownNode,s,o)),this.FSizeColumn=-1,this.FInteraction.FColumnSizing&&(this.FSizeColumn=this.XYToColumnSize(s,o),this.FSizeColumn>=0&&this.FSizeColumn<=this.FColumnCount-1&&(this.FColumnSize=this.GetColWidths(this.FSizeColumn))),this.FDownColumn=this.XYToColumn(s,o,!1),this.FDownColumnFilter=this.XYToColumnFilter(s,o),this.FDownColumnExpand=this.XYToColumnExpand(s,o),this.FIsMouseDown=!this.FDblClicked,this.FTimeStart=e.GetTickCountX(),this.FTimeStop=this.FTimeStart,this.FScrollVTo=this.GetVScrollValue(),this.FScrollHTo=this.GetHScrollValue(),this.FScrollX=s,this.FScrollY=o,this.FDownX=s,this.FDownY=o,this.FMouseX=s,this.FMouseY=o,this.FSizeX=s,this.FDragY=o,this.FVerticalOffset=0,this.FVerticalOffsetTo=0,this.FMouseUp=!1,this.FDoubleSelection=!this.FAnimateTimer.FEnabled,this.FScrolling=!1),this.FDblClicked=!1)},this.HandleMouseMove=function(t,e,i){var s=0,o=null,n=null,r=0,a=!1,l=0,h=0,F=0,p=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),c=null,u=!1,C=!1,T=0,S=0;if(pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleMouseMove.apply(this,arguments),!(this.FBlockUserInput||this.FAnimating&&!this.FIsMouseDown)){if(this.FY=i,this.FX=e,this.FIsMouseDown&&this.FDragMode$1&&this.CanStartDragFromMouseMove()&&(Math.abs(this.FY-this.FDownY)>10||Math.abs(this.FX-this.FDownX)>10))return this.FDragModeStarted||this.HandleDragStart(e,i),this.FDragModeStarted=!0,void(this.AlternativeDragDrop()?this.HandleAlternativeDragOver(e,i):this.BeginDrag$1());if(this.FReorderMode&&null!=this.FDragBitmap&&this.FInteraction.FReorder)return p.$assign(this.GetContentClipRect()),(F=this.FSaveDragY+(this.FY-this.FDragY))<=p.Top+(p.Bottom-p.Top)-this.FDragBitmap.GetHeight()&&F>=p.Top?(this.FDragBitmap.SetTop(Math.round(Math.max(p.Top,Math.min(p.Top+(p.Bottom-p.Top)-this.FDragBitmap.GetHeight(),F)))),this.FSaveDragY=this.FDragBitmap.GetTop(),this.FDragTimer.SetEnabled(!1),F>p.Top&&F<p.Top+(p.Right-p.Left)&&null!=(c=this.XYToNode((p.Right-p.Left)/2,F,0))&&(this.FDragRow=c.FRow)):F>p.Top+(p.Bottom-p.Top)-this.FDragBitmap.GetHeight()?(this.FDragBitmap.SetTop(Math.round(p.Top+(p.Bottom-p.Top)-this.FDragBitmap.GetHeight())),this.FSaveDragY=F,this.FDragTimer.SetEnabled(!0)):F<p.Top&&(this.FDragBitmap.SetTop(Math.round(p.Top)),this.FSaveDragY=F,this.FDragTimer.SetEnabled(!0)),void(this.FDragY=this.FY);if(this.FSizeColumn>=0&&this.FSizeColumn<=this.FColumnCount-1)return a=!0,l=this.FColumnSize,this.FColumnSize=l+(e-this.FSizeX),h=Math.max(0,this.FColumnSize),this.FSizeX=e,this.DoBeforeSizeColumn(this.FSizeColumn,l,{get:function(){return h},set:function(t){h=t}},{get:function(){return a},set:function(t){a=t}}),void(a&&(this.SetColWidths(this.FSizeColumn,h),this.FSizeColumn>=0&&this.FSizeColumn<=this.FColumns.GetCount()-1&&this.FColumns.GetItem$1(this.FSizeColumn).UpdateWidth(h),this.DoAfterSizeColumn(this.FSizeColumn,h),this.ResetNodes(!0),this.UpdateTreeView(),this.Invalidate()));if(this.FIsMouseDown&&""===this.FDoNodeAnchor.AAnchor&&""===this.FDoNodeTitleAnchor.AAnchor){if(!(this.FDoNodeExpand||null!=this.FDoNodeCheck.ANode)){s=1;var d=this.FScrollMode;1===d&&(s=.1),a=!0,this.ScrollLimitation()&&Math.abs(i-this.FMouseY)<15&&(a=Math.abs(e-this.FMouseX)<5),(this.FScrolling||Math.abs(this.FMouseX-e)>3||Math.abs(this.FMouseY-i)>3)&&this.FInteraction.FTouchScrolling&&a&&(this.FDragTimer.SetEnabled(!1),(Math.abs(e-this.FDownX)>0||Math.abs(i-this.FDownY)>0)&&(this.FScrolling=!0,this.FDoubleSelection=!1,this.FIsMouseDown&&!this.FMouseUp&&(u=this.CanScrollUp(),C=this.CanScrollDown(),u&&i-this.FDownY>0||C&&i-this.FDownY<0&&0===this.FVerticalOffset?(this.FVerticalOffset=0,this.Scroll(this.GetHScrollValue()-(e-this.FDownX)*s,this.GetVScrollValue()-(i-this.FDownY)*s)):this.CanApplyVerticalOffset()?(this.FVerticalOffset=Math.min(75,Math.max(-75,this.FVerticalOffset+(i-this.FDownY))),this.UpdateDisplay()):this.Scroll(this.GetHScrollValue()-(e-this.FDownX)*s,this.GetVScrollValue()),this.FDownY=i,this.FDownX=e)))}}else o=null,null!=(n=this.XYToCacheItem(e,i,0))&&(o=n.FNode),T=0,null!=o&&null!=n?!this.FInteraction.FURLDetectionOnMouseMove||""===this.XYToNodeAnchor(o,e,i).AAnchor&&""===this.XYToNodeTitleAnchor(o,e,i).AAnchor||(T=21):this.FInteraction.FColumnSizing&&(r=this.XYToColumnSize(e,i))>=0&&r<=this.FColumnCount-1&&(T=9),S=-1,""!==this.XYToColumnAnchor(e,i,{get:function(){return S},set:function(t){S=t}})&&(T=21),T!==this.FCursor&&this.SetControlCursor(T),this.FPrevDSP!==n&&(null!=this.FPrevDSP&&null!=this.FPrevDSP.FNode&&this.DoNodeMouseLeave(this.FPrevDSP.FNode),null!=n&&null!=n.FNode&&this.DoNodeMouseEnter(n.FNode)),this.FPrevDSP=n}},this.HandleDblClick=function(t,e){var i=pas["WEBLib.TMSFNCTypes"].TPointF.$new(),s=null,o=0,n=!1,r=!1,a=0;pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleDblClick.apply(this,arguments),this.FBlockUserInput||(this.FDblClicked=!0,i.$assign(pas["WEBLib.TMSFNCTypes"].PointF(t,e)),this.FDownNode=null,null!=(s=this.XYToNode(i.X,i.Y,0))?this.XYToNodeExpand(s,i.X,i.Y)||null!=this.XYToNodeCheck(s,i.X,i.Y).ANode||(this.FDownNode=s,null!=this.FDownNode&&(n=!0,this.DoIsNodeEnabled(this.FDownNode,{get:function(){return n},set:function(t){n=t}}),n&&(r=!1,this.DoIsNodeExtended(this.FDownNode,{get:function(){return r},set:function(t){r=t}}),this.FCompactMode||!(r&&this.FInteraction.FExtendedSelectable&&this.FInteraction.FExtendedEditable)&&r||0!==this.FInteraction.FMouseEditMode||this.FInteraction.FReadOnly?this.FInteraction.FExpandCollapseOnDblClick&&this.HandleNodeToggle(this.FDownNode):-1!==(a=this.XYToNodeTextColumn(this.FDownNode,i.X,i.Y))&&this.HandleNodeEditing(this.FDownNode,a)),this.DoNodeDblClick(this.FDownNode))):(o=this.XYToColumnSize(i.X,i.Y),this.FInteraction.FColumnAutoSizeOnDblClick&&this.AutoSizeColumn(o)),this.FIsMouseDown=!1,this.FMouseUp=!0,this.FScrolling=!1,this.FDoNodeExpand=!1,this.FDoNodeExtra=!1,this.FDoNodeTitleExtra=!1,this.FDoNodeAnchor.AAnchor="",this.FDoNodeAnchor.AColumn=-1,this.FDoNodeTitleAnchor.AAnchor="",this.FDoNodeTitleAnchor.AColumn=-1,this.FDownColumn=-1,this.FDownColumnFilter=-1,this.FDownColumnExpand=-1,this.FReorderMode=!1,this.FDragMode$1=!1,this.FDragModeStarted=!1)},this.DoNeedFilterDropDownData=function(t,e){null!=this.FOnNeedFilterDropDownData&&this.FOnNeedFilterDropDownData(this,t,e)},this.DoFilterSelect=function(t,e){null!=this.FOnFilterSelect&&this.FOnFilterSelect(this,t,e)},this.HandleFilter=function(e){var i=null,s=pas["WEBLib.TMSFNCTypes"].TPointF.$new(),o=null,n="",r=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),a=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),l=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),h=0,F=0,p=0;if(e>=0&&e<=this.FColumns.GetCount()-1&&this.FColumns.GetItem$1(e).FFiltering.FEnabled&&(F=this.GetColWidths(e))>=0){p=this.GetColPos(e),i=pas.Classes.TStringList.$create("Create$1");try{for(i.FDuplicates=0,i.SetSorted(!0),i.Add(rtl.getResStr(t,"sTMSFNCTreeViewFilterAll")),o=this.GetFirstRootVirtualNode();null!=o;)n="",this.DoGetNodeText(o,e,0,{get:function(){return n},set:function(t){n=t}}),""!==(n=pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.HTMLStrip(n))&&i.Add(n),o=o.GetNext();this.DoNeedFilterDropDownData(e,i),this.FFilterListBox.SetParent(this),this.FFilterListBox.FItems.Assign(i),this.FFilterListBox.SetItemIndex(-1),pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.SetFontSize(this.FFilterListBox.FFont,16,1),this.FFilterListBox.SetParent(null),this.FFilterListBox.FTag$1=e}finally{i=rtl.freeLoc(i)}this.FFilterPopup.SetPlacementControl(this),r.$assign(this.GetColumnsTopRect()),r.Left=r.Left-this.GetHorizontalScrollPosition(),a.$assign(pas["WEBLib.TMSFNCTypes"].RectF(r.Left+p,r.Top,r.Left+p+F,r.Bottom)),h=this.FColumns.GetItem$1(e).FFiltering.FButtonSize,l.$assign(pas["WEBLib.TMSFNCTypes"].RectF(Math.round(a.Right-h-this.ScalePaintValue(4)),Math.round(a.Top+(a.Bottom-a.Top-h)/2),Math.round(a.Right-this.ScalePaintValue(4)),Math.round(a.Top+(a.Bottom-a.Top-h)/2+h))),s.$assign(this.LocalToScreenEx(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(l.Left+(l.Right-l.Left)-h-this.ScalePaintValue(2),l.Top+(l.Bottom-l.Top+h)/2)))),this.FFilterPopup.FPlacementRectangle.SetLeft(s.X),this.FFilterPopup.FPlacementRectangle.SetTop(s.Y),this.FFilterListBox.SetWidth(this.FColumns.GetItem$1(e).FFiltering.FDropDownWidth),this.FFilterListBox.SetHeight(this.FColumns.GetItem$1(e).FFiltering.FDropDownHeight),this.FFilterPopup.SetDropDownHeight(this.FColumns.GetItem$1(e).FFiltering.FDropDownHeight),this.FFilterPopup.SetDropDownWidth(this.FColumns.GetItem$1(e).FFiltering.FDropDownWidth),this.FFilterPopup.FPlacementRectangle.SetRight(s.X+this.FFilterPopup.FDropDownWidth),this.FFilterPopup.FPlacementRectangle.SetBottom(s.Y+this.FFilterPopup.FDropDownHeight),this.FFilterPopup.SetContentControl(this.FFilterListBox),this.FFilterPopup.FFocusedControl=this.FFilterListBox,this.FFilterPopup.Popup(!1)}},this.HandleExpand=function(t){},this.HandleMouseUp=function(i,s,o,n){var r=0,a=t.TTMSFNCTreeViewNodeAnchor.$new(),l=0,h="",F=!1,p=!1,c=!1,u=!1,C=0,T=0,S=null,d=null,m=!1,f=0,g=!1,y=0;if(pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleMouseUp.apply(this,arguments),1!==i&&!this.FBlockUserInput&&(this.ReleaseCaptureEx(),this.FDragMode$1&&this.FDragModeStarted&&this.AlternativeDragDrop()&&(this.HandleAlternativeDragDrop(o,n),this.DestroyDragBitmap(),this.SetControlCursor(0)),f=this.FSizeColumn,this.FSizeColumn=-1,this.FDragTimer.SetEnabled(!1),this.FIsMouseDown)){this.FReorderMode&&this.FInteraction.FReorder&&(S=this.XYToNode(o,n,0),null!=this.FOnCustomReorder?this.FOnCustomReorder(this,this.FDragNode,S):null!=S&&S!==this.FDragNode&&null!=S.FNode&&null!=this.FDragNode.FNode&&(m=!0,this.DoBeforeReorderNode(this.FDragNode,S,{get:function(){return m},set:function(t){m=t}}),m&&(this.FDragNode.FLevel===S.FLevel&&(null===S.FNode.GetParent()?this.FDragNode.FNode.SetIndex(S.FNode.GetIndex()):this.FDragNode.FNode.MoveTo(S.FNode.GetParent(),S.FNode.GetIndex())),this.DoAfterReorderNode(this.FDragNode,S))),this.DestroyDragBitmap(),this.FDragNode=null),r=1;var M=this.FScrollMode;if(1===M&&(r=.1),this.FIsMouseDown=!1,this.FMouseUp=!0,this.FScrolling=!1,-1!==this.FDownColumnFilter)this.HandleFilter(this.FDownColumnFilter);else if(-1!==this.FDownColumnExpand)this.HandleExpand(this.FDownColumnExpand);else if(-1!==this.FDownColumn&&-1===f){if(this.FDownColumn>=0&&this.FDownColumn<=this.FColumnCount-1){if(0!==this.FColumns.GetItem$1(this.FDownColumn).FSorting){var b=this.FColumns.GetItem$1(this.FDownColumn).FSortKind;0===b||1===b?(this.InitializeColumnSorting(this.FDownColumn,1),null!=this.FOnCustomColumnSort?this.FOnCustomColumnSort(this,this.FDownColumn,1):(this.DoBeforeSortNodes(this.FDownColumn,1,{get:function(){return g},set:function(t){g=t}}),g&&(this.FNodes.Sort$1(this.FDownColumn,this.FColumns.GetItem$1(this.FDownColumn).FSorting in rtl.createSet(2,4),this.FColumns.GetItem$1(this.FDownColumn).FSorting in rtl.createSet(3,4),1,!0),this.DoAfterSortNodes(this.FDownColumn,1)))):2===b&&(this.InitializeColumnSorting(this.FDownColumn,0),null!=this.FOnCustomColumnSort?this.FOnCustomColumnSort(this,this.FDownColumn,0):(this.DoBeforeSortNodes(this.FDownColumn,0,{get:function(){return g},set:function(t){g=t}}),g&&(this.FNodes.Sort$1(this.FDownColumn,this.FColumns.GetItem$1(this.FDownColumn).FSorting in rtl.createSet(2,4),this.FColumns.GetItem$1(this.FDownColumn).FSorting in rtl.createSet(3,4),0,!0),this.DoAfterSortNodes(this.FDownColumn,0))))}l=-1,""!==(h=this.XYToColumnAnchor(o,n,{get:function(){return l},set:function(t){l=t}}))&&this.DoColumnAnchorClick(this.FDownColumn,h)}}else if(!this.FReorderMode&&!this.FDragModeStarted)if(this.FDoNodeExpand||this.FDoNodeExtra||this.FDoNodeTitleExtra||null!=this.FDoNodeCheck.ANode||""!==this.FDoNodeAnchor.AAnchor||""!==this.FDoNodeTitleAnchor.AAnchor)this.FCompactMode||(this.FDoNodeExpand?this.HandleNodeToggle(this.FDownNode):this.FDoNodeExtra?this.HandleNodeExtra(this.FDownNode):this.FDoNodeTitleExtra?this.HandleNodeTitleExtra(this.FDownNode):null==this.FDoNodeCheck.ANode||this.FInteraction.FReadOnly?(a.$assign(this.XYToNodeAnchor(this.FDownNode,o,n)),""!==a.AAnchor&&this.DoNodeAnchorClick(this.FDownNode,a.AColumn,a.AAnchor),a.$assign(this.XYToNodeTitleAnchor(this.FDownNode,o,n)),""!==a.AAnchor&&this.DoNodeTitleAnchorClick(this.FDownNode,a.AColumn,a.AAnchor)):this.HandleNodeToggleCheck(this.FDownNode,this.FDoNodeCheck.AColumn));else if(!this.FDoubleSelection&&this.FInteraction.FTouchScrolling)this.FTimeStop=e.GetTickCountX(),0===this.FVerticalOffset&&this.FTimeStop-this.FTimeStart<300&&this.FTimeStop-this.FTimeStart>0?(this.FSpY=Math.abs(n-this.FScrollY)/(this.FTimeStop-this.FTimeStart),this.FSpY>0&&(n-this.FScrollY>0?this.FScrollVTo=Math.max(0,Math.min(this.VerticalScrollBar().FMax-this.GetVViewPortSize(),this.FScrollVTo-Math.round(Math.abs(n-this.FScrollY)*this.FSpY*r*3))):this.FScrollVTo=Math.max(0,Math.min(this.VerticalScrollBar().FMax-this.GetVViewPortSize(),this.FScrollVTo+Math.round(Math.abs(n-this.FScrollY)*this.FSpY*r*3))),this.FAnimateVerticalPos=!0,this.FAnimateTimer.SetEnabled(!0)),this.FSpX=Math.abs(o-this.FScrollX)/(this.FTimeStop-this.FTimeStart),this.FSpX>0&&(o-this.FScrollX>0?this.FScrollHTo=Math.max(0,Math.min(this.HorizontalScrollBar().FMax-this.GetHViewPortSize(),this.FScrollHTo-Math.round(Math.abs(o-this.FScrollX)*this.FSpX*r*3))):this.FScrollHTo=Math.max(0,Math.min(this.HorizontalScrollBar().FMax-this.GetHViewPortSize(),this.FScrollHTo+Math.round(Math.abs(o-this.FScrollX)*this.FSpX*r*3))),this.FAnimateHorizontalPos=!0,this.FAnimateTimer.SetEnabled(!0))):this.CanApplyVerticalOffset()&&(this.NeedsReload(this.FVerticalOffset)&&this.StartReload(),this.StartVerticalOffsetAnimation());else if(null!=this.FDownNode&&!this.FBlockMouseClick){if(F=this.IsVirtualNodeSelectable(this.FDownNode),d=this.FFocusedNode,c=F,F)if(0 in s&&1 in this.FInteraction.FMultiSelectStyle){if(null!=this.FFocusedNode)if(y=3 in this.FInteraction.FMultiSelectStyle&&this.FFocusedNode.FParentNode!==this.FDownNode.FParentNode?0:1,this.FFocusedNode.FRow<=this.FDownNode.FRow)for(var N=this.FFocusedNode.FRow+y,B=this.FDownNode.FRow;N<=B;N++)C=N,this.HandleSelectNode(this.GetNodeFromNodeStructure(C),!0,!1,0 in s&&this.FInteraction.FMultiSelect);else for(var E=this.FFocusedNode.FRow-y,D=this.FDownNode.FRow;E>=D;E--)C=E,this.HandleSelectNode(this.GetNodeFromNodeStructure(C),!0,!1,0 in s&&this.FInteraction.FMultiSelect)}else 3 in this.FInteraction.FMultiSelectStyle&&null!=this.FFocusedNode&&this.FDownNode.FParentNode!==this.FFocusedNode.FParentNode&&this.FSelectedNodes.GetCount()>0?this.FSelectedNodes.Clear():(!(2 in s)&&!(pas.Classes.TShiftState$a.ssCtrl in s)||!(0 in this.FInteraction.FMultiSelectStyle))&&this.FSelectedNodes.GetCount()>0&&this.UnSelectVirtualNode(this.FDownNode),this.HandleSelectNode(this.FDownNode,!0,!1,(2 in s||pas.Classes.TShiftState$a.ssCtrl in s)&&0 in this.FInteraction.FMultiSelectStyle&&this.FInteraction.FMultiSelect);c&&this.FFocusedNode!==this.FDownNode&&(this.FFocusedNode=this.FDownNode,this.DoFocusedNodeChanged(this.FFocusedNode)),this.FCompactMode||1!==this.FInteraction.FMouseEditMode&&(2!==this.FInteraction.FMouseEditMode||this.FDownNode!==d)||this.FInteraction.FReadOnly||null!=this.FDownNode&&(u=!1,this.DoIsNodeExtended(this.FDownNode,{get:function(){return u},set:function(t){u=t}}),p=!0,this.DoIsNodeEnabled(this.FDownNode,{get:function(){return p},set:function(t){p=t}}),a.$assign(this.XYToNodeTitleAnchor(this.FDownNode,o,n)),""!==a.AAnchor&&this.DoNodeTitleAnchorClick(this.FDownNode,a.AColumn,a.AAnchor),a.$assign(this.XYToNodeAnchor(this.FDownNode,o,n)),p&&""!==a.AAnchor?this.DoNodeAnchorClick(this.FDownNode,a.AColumn,a.AAnchor):(u&&this.FInteraction.FExtendedSelectable&&this.FInteraction.FExtendedEditable||!u)&&p&&-1!==(T=this.XYToNodeTextColumn(this.FDownNode,o,n))&&this.FDownNode.GetTitleExpanded(T)&&this.HandleNodeEditing(this.FDownNode,T)),this.Invalidate()}this.FDoNodeExpand=!1,this.FDoNodeExtra=!1,this.FDoNodeTitleExtra=!1,this.FDoNodeAnchor.AAnchor="",this.FDoNodeAnchor.AColumn=-1,this.FDoNodeTitleAnchor.AAnchor="",this.FDoNodeTitleAnchor.AColumn=-1,this.FDownColumn=-1,this.FDownColumnFilter=-1,this.FDownColumnExpand=-1,this.FReorderMode=!1,this.FDragMode$1=!1,this.FDragModeStarted=!1}},this.StartVerticalOffsetAnimation=function(){this.FAnimateVerticalOffset=!0,this.FAnimateTimer.SetEnabled(!0)},this.ClearFocusedNode=function(t){t!==this.FFocusedNode&&null!==t||(this.FFocusedNode=null)},this.HandleKeyPress=function(t){var e=0;pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleKeyPress.apply(this,arguments),this.FBlockUserInput||(e=t.get().charCodeAt(),this.FInteraction.FLookup.FEnabled&&(e in rtl.createSet(27,45,46,38,40,37,39,36,35,33,34,9,0)?this.FLookupString="":(this.FInteraction.FLookup.FIncremental?this.FLookupString=this.FLookupString+t.get():this.FLookupString=t.get(),null!=this.FOnCustomLookup?this.FOnCustomLookup(this,this.FLookupString):this.LookupNode(this.FLookupString,this.FInteraction.FLookup.FRootNodesOnly,this.FInteraction.FLookup.FColumn,this.FInteraction.FLookup.FCaseSensitive,this.FInteraction.FLookup.FAutoSelect,this.FInteraction.FLookup.FAutoExpand))))},this.HandleKeyDown=function(t,e){var i=null,s=null,o=null,n=!1,r=!1,a=!1,l=!1,h=0,F=0,p=!1,c=!1,u=null;if(pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleKeyDown.apply(this,arguments),!this.FInplaceEditorClosed&&!this.FBlockUserInput){if(t.get()in rtl.createSet(27,45,46,38,40,37,39,36,35,33,34,9,106,109,107,111)&&(this.FLookupString=""),2 in e||pas.Classes.TShiftState$a.ssCtrl in e){var C=t.get();if(65===C)return void(this.FInteraction.FMultiSelect&&(this.DoBeforeSelectAllNodes({get:function(){return n},set:function(t){n=t}}),n&&(this.SelectAllNodes(),this.DoAfterSelectAllNodes())));if(88===C)return void(0!==this.FInteraction.FClipboardMode&&(p=!0,this.DoBeforeCutToClipboard({get:function(){return p},set:function(t){p=t}}),p&&(this.CutToClipboard(1===this.FInteraction.FClipboardMode),this.DoAfterCutToClipboard())));if(67===C)return void(0!==this.FInteraction.FClipboardMode&&(p=!0,this.DoBeforeCopyToClipboard({get:function(){return p},set:function(t){p=t}}),p&&(this.CopyToClipboard(1===this.FInteraction.FClipboardMode),this.DoAfterCopyToClipboard())));if(86===C)return void(0!==this.FInteraction.FClipboardMode&&(p=!0,this.DoBeforePasteFromClipboard({get:function(){return p},set:function(t){p=t}}),p&&(this.PasteFromClipboard(),this.DoAfterPasteFromClipboard())))}i=this.GetFocusedVirtualNode(),a=!1,l=!1;var T=t.get();18===T||17===T||16===T?i=null:33===T?(l=!0,null!=i&&(h=i.FRow-(this.StopRow()-this.StartRow()),null!=(i=this.GetNodeFromNodeStructure(h))&&(this.IsVirtualNodeSelectable(i)||(i=this.GetPreviousFocusableNode(i))),null==i&&(i=this.GetNextFocusableNode(null)))):34===T?(a=!0,null!=i&&(h=i.FRow+(this.StopRow()-this.StartRow()),null!=(i=this.GetNodeFromNodeStructure(h))&&(this.IsVirtualNodeSelectable(i)||(i=this.GetNextFocusableNode(i))),null==i&&(i=this.GetPreviousFocusableNode(null)))):36===T?(i=this.GetNextFocusableNode(null),l=!0):35===T?(i=this.GetPreviousFocusableNode(null),l=!0):40===T?this.FInteraction.FMultiSelect&&(!this.FInteraction.FMultiSelect||3 in this.FInteraction.FMultiSelectStyle&&2 in e)||(i=this.GetNextFocusableNode(i),a=!0):38===T?3 in this.FInteraction.FMultiSelectStyle&&this.FInteraction.FMultiSelect&&2 in e||(i=this.GetPreviousFocusableNode(i),l=!0):37===T||109===T||111===T?this.HandleNodeCollapse(i,111===t.get()):39===T||107===T||106===T?this.HandleNodeExpand(i,106===t.get()):32===T&&this.DoNodeClick(i);var S=t.get();if(37!==S&&39!==S||this.HandleCustomKeys(t.get()),r=!1,32===t.get()&&(r=!0),null!=i){if(this.FInteraction.FSelectionFollowsFocus&&(a||l)||r&&(2 in e||pas.Classes.TShiftState$a.ssCtrl in e)){if(0 in e){if(this.FSelectedNodes.GetCount()>1&&(s=this.FSelectedNodes.GetItem(this.FSelectedNodes.GetCount()-1),o=this.FSelectedNodes.GetItem(0),l&&i.FRow<s.FRow&&i.FRow>=o.FRow||a&&i.FRow>s.FRow&&i.FRow<=o.FRow))if(s.FRow<=i.FRow)for(var d=s.FRow,m=i.FRow;d<=m;d++)F=d,null!=(u=this.GetNodeFromNodeStructure(F))&&(u!==i?(c=!0,this.DoBeforeUnSelectNode(u,{get:function(){return c},set:function(t){c=t}}),c&&(this.UnSelectVirtualNode(u),this.DoAfterUnSelectNode(u))):this.UnSelectVirtualNode(u));else for(var f=s.FRow,g=i.FRow;f>=g;f--)F=f,null!=(u=this.GetNodeFromNodeStructure(F))&&(u!==i?(c=!0,this.DoBeforeUnSelectNode(u,{get:function(){return c},set:function(t){c=t}}),c&&(this.UnSelectVirtualNode(u),this.DoAfterUnSelectNode(u))):this.UnSelectVirtualNode(u))}else!(2 in e)&&!(pas.Classes.TShiftState$a.ssCtrl in e)&&(a||l)&&this.FSelectedNodes.GetCount()>0&&(c=!0,this.DoBeforeUnSelectNode(i,{get:function(){return c},set:function(t){c=t}}),c&&(this.UnSelectVirtualNode(i),this.DoAfterUnSelectNode(i)));if(0 in e){if(null!=this.FFocusedNode)if(this.FFocusedNode.FRow<=i.FRow)for(var y=this.FFocusedNode.FRow+1,M=i.FRow;y<=M;y++)F=y,this.HandleSelectNode(this.GetNodeFromNodeStructure(F),!0,!0,0 in e&&this.FInteraction.FMultiSelect);else for(var b=this.FFocusedNode.FRow-1,N=i.FRow;b>=N;b--)F=b,this.HandleSelectNode(this.GetNodeFromNodeStructure(F),!0,!0,0 in e&&this.FInteraction.FMultiSelect)}else this.HandleSelectNode(i,!0,!0,(2 in e||pas.Classes.TShiftState$a.ssCtrl in e)&&this.FInteraction.FMultiSelect)}else r&&this.HandleNodeToggleCheck(i,0);this.FFocusedNode!==i&&(this.FFocusedNode=i,this.DoFocusedNodeChanged(this.FFocusedNode)),a?this.ScrollToVirtualNode(this.FFocusedNode,!0,1,!1):this.ScrollToVirtualNode(this.FFocusedNode,!0,0,!1),this.Invalidate()}}},this.HandleDialogKey=function(t,e){var i=null,s=0,o=!1;this.FInplaceEditorClosed||this.FBlockUserInput||(null!=this.FInplaceEditor&&this.FInplaceEditorActive&&(27===t.get()||9===t.get()||113===t.get()||pas["WEBLib.StdCtrls"].TEdit.isPrototypeOf(this.FInplaceEditor)&&13===t.get())||pas["WEBLib.StdCtrls"].TMemo.isPrototypeOf(this.FInplaceEditor)&&13===t.get()&&!(2 in e))&&(this.FCloseWithDialogKey=!0,this.CloseInplaceEditor(27===t.get(),!1),9===t.get()&&null!=this.FFocusedNode&&(0 in e?(o=!1,this.DoIsNodeExtended(this.FFocusedNode,{get:function(){return o},set:function(t){o=t}}),this.FUpdateNodeColumn>this.GetFirstEditableColumn()&&!o?(this.HandleNodeEditing(this.FFocusedNode,this.GetPreviousEditableColumn(this.FUpdateNodeColumn)),this.Invalidate(),t.set(0)):null!=(i=this.GetPreviousFocusableNode(this.FFocusedNode))&&(o=!1,this.DoIsNodeExtended(i,{get:function(){return o},set:function(t){o=t}}),(o&&this.FInteraction.FExtendedEditable||!o)&&(s=o?0:this.GetLastEditableColumn(),this.FFocusedNode!==i&&(this.FFocusedNode=i,this.DoFocusedNodeChanged(this.FFocusedNode)),this.SelectVirtualNode(i),this.ScrollToVirtualNode(i,!0,0,!1),this.HandleNodeEditing(i,s),this.Invalidate(),t.set(0)))):(o=!1,this.DoIsNodeExtended(this.FFocusedNode,{get:function(){return o},set:function(t){o=t}}),this.FUpdateNodeColumn<this.GetLastEditableColumn()&&!o?(this.EditVirtualNode(this.FFocusedNode,this.GetNextEditableColumn(this.FUpdateNodeColumn)),t.set(0)):null!=(i=this.GetNextFocusableNode(this.FFocusedNode))&&(o=!1,this.DoIsNodeExtended(i,{get:function(){return o},set:function(t){o=t}}),(o&&this.FInteraction.FExtendedEditable||!o)&&(s=this.GetFirstEditableColumn(),this.FFocusedNode!==i&&(this.FFocusedNode=i,this.DoFocusedNodeChanged(this.FFocusedNode)),this.SelectVirtualNode(i),this.ScrollToVirtualNode(i,!0,1,!1),this.HandleNodeEditing(i,s),this.Invalidate(),t.set(0)))))),pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleDialogKey.apply(this,arguments)},this.HandleFilterListClick=function(t){this.FFilterTimer.SetEnabled(!0)},this.HandleKeyUp=function(t,e){var i=!1,s=!1,o=0;if(pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleKeyUp.apply(this,arguments),!this.FBlockUserInput)if(this.FInplaceEditorClosed)this.FInplaceEditorClosed=!1;else if(this.FCloseWithDialogKey)this.FCloseWithDialogKey=!1;else if(null!=this.FFocusedNode&&!this.FCompactMode&&this.FInteraction.FKeyboardEdit&&!this.FInteraction.FReadOnly&&rtl.eqSet(e,{})){var n=t.get();113!==n&&13!==n||(i=!0,this.DoIsNodeEnabled(this.FFocusedNode,{get:function(){return i},set:function(t){i=t}}),i&&(s=!1,this.DoIsNodeExtended(this.FFocusedNode,{get:function(){return s},set:function(t){s=t}}),(s&&this.FInteraction.FExtendedSelectable&&this.FInteraction.FExtendedEditable||!s)&&-1!==(o=this.GetFirstEditableColumn())&&this.FFocusedNode.GetTitleExpanded(o)&&this.HandleNodeEditing(this.FFocusedNode,o)))}},this.HandleMouseWheel=function(t,e,i){var s=0,o=0,n=0,r=0,a=null;pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleMouseWheel.apply(this,arguments),this.FBlockUserInput||(s=this.GetVScrollValue(),o=this.GetHScrollValue(),r=e>0?this.StartRow()-1:this.StartRow(),null!=(a=this.GetVisibleNodeForIndex(r))?e>0?(n=a.FHeight*this.FInteraction.FMouseWheelDelta,this.Scroll(o,s-n)):(n=a.FHeight*this.FInteraction.FMouseWheelDelta,this.Scroll(o,s+n)):this.Scroll(o,0),i.set(!0))},this.HandleNodeEditing=function(e,i){var s=null,o=!1,n="",r=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),a=pas.Types.TRect.$new();function l(t,e){var i=pas.Types.TPoint.$new();return i.x=t,i.y=e,i}if(null!=e&&i>=0&&i<=this.FColumns.GetCount()-1){if(s=this.FColumns.GetItem$1(i),this.FInplaceEditorClass=null,!s.FCustomEditor){var h=s.FEditorType;if(0===h)this.FInplaceEditorClass=t.TTMSFNCTreeViewEdit;else if(1===h)this.FInplaceEditorClass=t.TTMSFNCTreeViewComboBox;else if(2===h)this.FInplaceEditorClass=t.TTMSFNCTreeViewMemo;else if(3===h)return}if(o=!0,this.DoBeforeOpenInplaceEditor(e,i,{get:function(){return o},set:function(t){o=t}}),o){if(this.DoGetInplaceEditor(e,i,{p:this,get:function(){return this.p.FInplaceEditorClass},set:function(t){this.p.FInplaceEditorClass=t}}),null!=this.FInplaceEditor&&(null!=this.FOldInplaceEditor&&rtl.free(this,"FOldInplaceEditor"),this.FOldInplaceEditor=this.FInplaceEditor,this.FInplaceEditor=null),null!=this.FInplaceEditorClass?this.FInplaceEditor=this.FInplaceEditorClass.$create("Create$1",[this]):this.FInplaceEditor=pas["WEBLib.StdCtrls"].TEdit.$create("Create$1",[this]),r.$assign(this.GetInplaceEditorRect(e,i)),null!=this.FInplaceEditor){this.FUpdateNode=e,this.FUpdateNodeColumn=i,this.FInplaceEditor.SetShowFocus(!1),this.FInplaceEditor.SetParent(this),this.FInplaceEditor.SetVisible(!1),a.$assign(pas.Types.Rect(Math.round(r.Left),Math.round(r.Top),Math.round(r.Right),Math.round(r.Bottom))),this.FInplaceEditor.SetBoundsRect(a),this.FInplaceEditor.SetBoundsRect(pas.Types.Rect(a.Left,a.Top+rtl.trunc((a.Bottom-a.Top-this.FInplaceEditor.GetHeight())/2),a.Right,a.Top+rtl.trunc((a.Bottom-a.Top-this.FInplaceEditor.GetHeight())/2)+this.FInplaceEditor.GetHeight())),this.FInplaceEditor.SetVisible(!0),1===s.FEditorType&&!s.FCustomEditor&&pas["WEBLib.StdCtrls"].TComboBox.isPrototypeOf(this.FInplaceEditor)&&(rtl.as(this.FInplaceEditor,pas["WEBLib.StdCtrls"].TComboBox).FItems.Assign(s.FEditorItems),rtl.as(this.FInplaceEditor,pas["WEBLib.StdCtrls"].TComboBox).SetStyle(0)),this.CustomizeInplaceEditor(this.FInplaceEditor,e,s);try{n="",this.DoGetNodeText(e,i,1,{get:function(){return n},set:function(t){n=t}}),pas["WEBLib.StdCtrls"].TComboBox.isPrototypeOf(this.FInplaceEditor)&&rtl.as(this.FInplaceEditor,pas["WEBLib.StdCtrls"].TComboBox).SetItemIndex(rtl.as(this.FInplaceEditor,pas["WEBLib.StdCtrls"].TComboBox).FItems.IndexOf(n)),pas["WEBLib.StdCtrls"].TEdit.isPrototypeOf(this.FInplaceEditor)&&rtl.as(this.FInplaceEditor,pas["WEBLib.StdCtrls"].TEdit).SetText(n),pas["WEBLib.StdCtrls"].TMemo.isPrototypeOf(this.FInplaceEditor)&&rtl.as(this.FInplaceEditor,pas["WEBLib.StdCtrls"].TMemo).SetText(n)}finally{}this.FInplaceEditor.CanFocus()&&this.FInplaceEditor.SetFocus(),pas["WEBLib.StdCtrls"].TEdit.isPrototypeOf(this.FInplaceEditor)&&rtl.as(this.FInplaceEditor,pas["WEBLib.StdCtrls"].TEdit).SetSelStart(rtl.as(this.FInplaceEditor,pas["WEBLib.StdCtrls"].TEdit).GetText().length),pas["WEBLib.StdCtrls"].TMemo.isPrototypeOf(this.FInplaceEditor)&&(rtl.as(this.FInplaceEditor,pas["WEBLib.StdCtrls"].TMemo).SetSelLength(0),rtl.as(this.FInplaceEditor,pas["WEBLib.StdCtrls"].TMemo).FLines.GetCount()>0?rtl.as(this.FInplaceEditor,pas["WEBLib.StdCtrls"].TMemo).FCaretPosition.$assign(l(rtl.as(this.FInplaceEditor,pas["WEBLib.StdCtrls"].TMemo).FLines.GetCount()-1,rtl.as(this.FInplaceEditor,pas["WEBLib.StdCtrls"].TMemo).FLines.Get(rtl.as(this.FInplaceEditor,pas["WEBLib.StdCtrls"].TMemo).FLines.GetCount()-1).length)):rtl.as(this.FInplaceEditor,pas["WEBLib.StdCtrls"].TMemo).FCaretPosition.$assign(l(0,0))),this.FInplaceEditorActive=!0,this.Invalidate()}this.DoAfterOpenInplaceEditor(e,i,this.FInplaceEditor,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(r))}}},this.CustomizeInplaceEditor=function(t,e,i){null!=e&&null!=i&&null!=t&&this.DoCustomizeInplaceEditor(e,i.GetIndex(),this.FInplaceEditor)},this.StartReload=function(){this.FVerticalOffsetTo=this.GetReloadOffset(),this.StartVerticalOffsetAnimation()},this.ConfigureNodeRect=function(t,e,i){},this.GetNodeOffset=function(t,e,i,s,o){},this.GetNodeMargins=function(t,e,i,s){},this.HandleAlternativeDragOver=function(t,e){},this.HandleAlternativeDragDrop=function(t,e){},this.InternalSelectVirtualNode=function(t){},this.CanStartDragFromMouseDown=function(){return!0,!0},this.CanStartDragFromMouseMove=function(){return!1,!1},this.AlternativeDragDrop=function(){return!1,!1},this.GetNodesSpacing=function(){return this.FNodesAppearance.FSpacing},this.IsAnimating=function(){return!0===this.FAnimateTimer.FEnabled&&this.FAnimating},this.GetNodesRect=function(){var t=pas["WEBLib.TMSFNCTypes"].TRectF.$new();return t.$assign(this.GetContentRect()),t},this.CanApplyVerticalOffset=function(){return!1,!1},this.GetReloadOffset=function(){return 0,0},this.NeedsReload=function(t){return!1,!1},this.IsVariableNodeHeight=function(){return 1===this.FNodesAppearance.FHeightMode},this.ColumnStretchingActive=function(){return this.FColumnsAppearance.FStretch&&this.FColumnsAppearance.FStretchAll},this.GetBufStart=function(t,e){var i=0;for(i=1,e.set(0);pas["WEBLib.TMSFNCTypes"].CharInArray(t.charAt(i-1),[" ","\t"]);)i+=1,e.set(e.get()+1);return pas.System.Copy(t,i,t.length-i+1)},this.GetFirstEditableColumn=function(){var t=0,e=0;t=-1;for(var i=0,s=this.FColumns.GetCount()-1;i<=s;i++)if(e=i,3!==this.FColumns.GetItem$1(e).FEditorType||this.FColumns.GetItem$1(e).FCustomEditor){t=e;break}return t},this.GetLastEditableColumn=function(){var t=0,e=0;t=-1;for(var i=this.FColumns.GetCount()-1;i>=0;i--)if(e=i,3!==this.FColumns.GetItem$1(e).FEditorType||this.FColumns.GetItem$1(e).FCustomEditor){t=e;break}return t},this.GetPreviousEditableColumn=function(t){var e=0,i=0;if(e=-1,t>0&&t<=this.FColumns.GetCount()-1)for(var s=t-1;s>=0;s--)if(i=s,3!==this.FColumns.GetItem$1(i).FEditorType||this.FColumns.GetItem$1(i).FCustomEditor){e=i;break}return e},this.GetNextEditableColumn=function(t){var e=0,i=0;if(e=-1,t>=0&&t<this.FColumns.GetCount()-1)for(var s=t+1,o=this.FColumns.GetCount()-1;s<=o;s++)if(i=s,3!==this.FColumns.GetItem$1(i).FEditorType||this.FColumns.GetItem$1(i).FCustomEditor){e=i;break}return e},this.GetInplaceEditorRect=function(t,e){var i=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),s=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),o=pas["WEBLib.TMSFNCTypes"].TRectF.$new();return i.$assign(pas["WEBLib.TMSFNCTypes"].RectF(0,0,0,0)),null==t||e>=0&&e<=rtl.length(t.FTextRects)-1&&(o.$assign(t.FTextRects[e]),s.$assign(this.GetContentClipRect()),o.Top=Math.max(o.Top,s.Top),o.Bottom=Math.min(o.Bottom,s.Bottom),o.Left=Math.max(o.Left,s.Left),o.Right=Math.min(o.Right,s.Right),i.$assign(pas["WEBLib.TMSFNCTypes"].RectF(pas.Math.Floor(o.Left),pas.Math.Floor(o.Top),Math.round(o.Right),Math.round(o.Bottom))),null!=this.FOnGetInplaceEditorRect&&this.FOnGetInplaceEditorRect(this,t,e,this.FInplaceEditor,i)),i},this.GetNextFocusableNode=function(t){var e=null,i=!1;for(e=null!=t?this.GetNextVirtualNode(t):this.GetFirstRootVirtualNode(),i=this.IsVirtualNodeSelectable(e);null!=e&&!i;)e=this.GetNextVirtualNode(e),i=this.IsVirtualNodeSelectable(e);return e},this.GetPreviousFocusableNode=function(t){var e=null,i=!1;for(e=null!=t?this.GetPreviousVirtualNode(t):this.GetLastVirtualNode(),i=this.IsVirtualNodeSelectable(e);null!=e&&!i;)e=this.GetPreviousVirtualNode(e),i=this.IsVirtualNodeSelectable(e);return e},this.GetVersion=function(){return this.$class.GetVersionNumber(1,2,0,2)},this.GetFirstVisibleColumn=function(){var t=0,e=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),i=0;if(t=0,!this.FColumnsAppearance.FOptimizedColumnDisplay)return t;e.$assign(this.GetNodesRect());for(var s=0,o=this.FColumns.GetCount()-1;s<=o;s++)if(i=s,this.GetColPos(i)+this.GetColWidths(i)>=e.Left+this.GetHorizontalScrollPosition()){t=i;break}return t},this.GetLastVisibleColumn=function(){var t=0,e=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),i=0;if(t=this.FColumns.GetCount()-1,!this.FColumnsAppearance.FOptimizedColumnDisplay)return t;e.$assign(this.GetNodesRect());for(var s=t;s>=0;s--)if(i=s,this.GetColPos(i)<=e.Right+this.GetHorizontalScrollPosition()){t=i;break}return t},this.ConfigureNode=function(t,e,i,s){var o,n,r,a=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),l=0,h=0,F=0,p=0,c=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),u=0,C=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),T=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),S=null,d=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),m=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),f=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),g="",y="",M=!1,b=0,N=0,B=0,E=0,D=0,L=null,G=0,A=0,I=0,P=0,w=!1,$=!1,R=0,v=0,W=!1,O=0,x=null,k=[],V=[],H=[],U=[],z=[],K=[],j=[],Y=0,q=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),X=0,J=0,Q=0,Z=0,_=0,tt=0,et=0,it=0,st=0,ot=0,nt=0;if(this.DoGetNodeData(i),Z=0,_=0,tt=0,et=0,this.GetNodeOffset(i,{get:function(){return Z},set:function(t){Z=t}},{get:function(){return _},set:function(t){_=t}},{get:function(){return tt},set:function(t){tt=t}},{get:function(){return et},set:function(t){et=t}}),it=0,st=0,ot=0,nt=0,this.GetNodeMargins({get:function(){return it},set:function(t){it=t}},{get:function(){return st},set:function(t){st=t}},{get:function(){return ot},set:function(t){ot=t}},{get:function(){return nt},set:function(t){nt=t}}),n=this.GetVerticalScrollPosition(),C.$assign(this.GetNodesRect()),S=i,l=this.GetTotalColumnNodeWidth()-ot-it,r=this.FNodesAppearance.FLevelIndent*S.FLevel,this.FNodesAppearance.FExpandColumn===this.GetFirstVisibleColumn()?(F=r,l-=r):F=0,B=0,p=s.get(),h=0,F+=it,p+=st,a.$assign(pas["WEBLib.TMSFNCTypes"].RectF(pas.System.Int(F),pas.System.Int(p),pas.System.Int(F+l),pas.System.Int(p+h))),this.HorizontalScrollBar().FVisible||this.FColumnsAppearance.FStretch?0===e?c.$assign(pas["WEBLib.TMSFNCTypes"].RectF(a.Left+1.5,a.Top+1.5,a.Right-1.5,a.Bottom+.5)):(this.FRowCount,c.$assign(pas["WEBLib.TMSFNCTypes"].RectF(a.Left+1.5,a.Top+.5,a.Right-1.5,a.Bottom+.5))):0===e?c.$assign(pas["WEBLib.TMSFNCTypes"].RectF(a.Left+1.5,a.Top+1.5,a.Right-.5,a.Bottom+.5)):(this.FRowCount,c.$assign(pas["WEBLib.TMSFNCTypes"].RectF(a.Left+1.5,a.Top+.5,a.Right-.5,a.Bottom+.5))),this.ConfigureNodeRect(e,i,c),S.FCalculated)h=S.FHeight;else if(this.UpdateNodeCalculated(S,!0),1===this.FNodesAppearance.FHeightMode){E=this.GetFirstVisibleColumn(),D=this.GetLastVisibleColumn(),W=!1,this.DoIsNodeExtended(S,{get:function(){return W},set:function(t){W=t}}),W&&(D=Math.min(E,D));for(var rt=E,at=D;rt<=at;rt++)u=rt,((R=this.GetColWidths(u))>0||W)&&(g="",this.DoGetNodeText(S,u,0,{get:function(){return g},set:function(t){g=t}}),y="",this.DoGetNodeTitle(S,u,0,{get:function(){return y},set:function(t){y=t}}),M=!0,this.DoGetNodeTitleExpanded(S,u,{get:function(){return M},set:function(t){M=t}}),this.FCompactMode&&(y="",g="",M=!1),b=this.GetColPos(u),u===E&&(b+=c.Left),N=W?b+l:b+this.GetColWidths(u),u===E&&(N-=c.Left),this.FNodesAppearance.FExpandColumn===u&&u>E&&(b+=r),N=N-Z-tt-ot-it,u===this.FNodesAppearance.FExpandColumn&&(b+=I=this.FNodesAppearance.FExpandWidth+this.ScalePaintValue(4),(P=this.FNodesAppearance.FExpandHeight+this.ScalePaintValue(4))>B&&(B=P)),v=0,this.DoGetNodeCheckType(S,u,{get:function(){return v},set:function(t){v=t}}),0!==v&&(O=this.ScalePaintValue(this.FCheckStartSize),b+=Math.max(0,O+4),O>B&&(B=O)),L=null,this.DoGetNodeIcon(S,u,!1,{get:function(){return L},set:function(t){L=t}}),null==L&&pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.IsHighDPIScale(null,-1)&&this.DoGetNodeIcon(S,u,!0,{get:function(){return L},set:function(t){L=t}}),null!=L&&L.GetWidth()>0&&L.GetHeight()>0&&(G=L.GetWidth()+this.ScalePaintValue(4),A=L.GetHeight()+this.ScalePaintValue(4),this.DoGetNodeIconSize(S,u,pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.IsHighDPIScale(null,-1),L,{get:function(){return G},set:function(t){G=t}},{get:function(){return A},set:function(t){A=t}}),b+=G,A>B&&(B=A)),w=!1,$=!1,u>=0&&u<=this.FColumns.GetCount()-1&&(w=this.FColumns.GetItem$1(u).FWordWrapping,$=this.FColumns.GetItem$1(u).FTitleWordWrapping),this.DoGetNodeWordWrapping(S,u,{get:function(){return w},set:function(t){w=t}}),this.DoGetNodeTitleWordWrapping(S,u,{get:function(){return $},set:function(t){$=t}}),X=0,this.DoGetNodeExtraSize(S,u,{get:function(){return X},set:function(t){X=t}}),J=0,this.DoGetNodeTitleExtraSize(S,u,{get:function(){return J},set:function(t){J=t}}),d.$assign(pas["WEBLib.TMSFNCTypes"].RectF(b,0,N-X,1e4)),pas["WEBLib.TMSFNCTypes"].InflateRectEx(d,this.ScalePaintValue(-2),0),m.$assign(pas["WEBLib.TMSFNCTypes"].RectF(b,0,N-J,1e4)),pas["WEBLib.TMSFNCTypes"].InflateRectEx(m,this.ScalePaintValue(-2),0),x=null,u>=0&&u<=this.FColumnCount-1&&(x=this.FColumns.GetItem$1(u)),null==x||x.FUseDefaultAppearance||W?W?t.FFont.Assign(this.FNodesAppearance.FExtendedFont):t.FFont.Assign(this.FNodesAppearance.FFont):t.FFont.Assign(x.FFont),M?(d.$assign(t.CalculateText(g,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(d),w,!0)),d.Bottom=d.Bottom+this.ScalePaintValue(4),Y=d.Bottom-d.Top):Y=0,""!==y?(null==x||x.FUseDefaultAppearance?t.FFont.Assign(this.FNodesAppearance.FTitleFont):t.FFont.Assign(x.FTitleFont),f.$assign(t.CalculateText(y,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(m),$,!0)),f.Bottom=f.Bottom+this.ScalePaintValue(4),Q=f.Bottom-f.Top):Q=0,this.UpdateNodeTitleHeight(S,Math.max(J,Q)),Y+=S.FTitleHeight,this.DoGetNodeHeight(S,u,{get:function(){return Y},set:function(t){Y=t}}),Y>B&&(B=Y));h=(h=Math.max(this.FDefaultRowHeight,B))+this.GetNodesSpacing()+_+et,this.UpdateNodeHeight(S,pas.System.Int(h)),this.FTotalRowHeight=this.FTotalRowHeight-this.FDefaultRowHeight+S.FHeight}else h=(h=this.FDefaultRowHeight)+this.GetNodesSpacing()+_+et,this.UpdateNodeHeight(S,h);s.set(s.get()+pas.System.Int(h)),c.Bottom=c.Bottom+pas.System.Int(h),c.Bottom=c.Bottom-this.GetNodesSpacing(),T.$assign(c),T.Left=T.Left+Z,T.Top=T.Top+_,T.Right=T.Right+tt,T.Bottom=T.Bottom+et,K=rtl.arraySetLength(K,pas["WEBLib.TMSFNCTypes"].TRectF,0),j=rtl.arraySetLength(j,pas["WEBLib.TMSFNCTypes"].TRectF,0),H=rtl.arraySetLength(H,pas["WEBLib.TMSFNCTypes"].TRectF,0),U=rtl.arraySetLength(U,pas["WEBLib.TMSFNCTypes"].TRectF,0),V=rtl.arraySetLength(V,pas["WEBLib.TMSFNCTypes"].TRectF,0),k=rtl.arraySetLength(k,pas["WEBLib.TMSFNCTypes"].TRectF,0),z=rtl.arraySetLength(z,pas["WEBLib.TMSFNCTypes"].TRectF,0),E=this.GetFirstVisibleColumn(),D=this.GetLastVisibleColumn(),W=!1,this.DoIsNodeExtended(S,{get:function(){return W},set:function(t){W=t}}),W&&(D=Math.min(E,D));for(var lt=E,ht=D;lt<=ht;lt++)u=lt,R=this.GetColumnWidth(u),b=this.GetColumnPosition(u),u===E&&(b+=T.Left),N=W?b+l:b+R,u===E&&(N-=T.Left),this.FNodesAppearance.FExpandColumn===u&&u>E&&(b+=r),W&&(N+=r),N=N-ot-tt,I=0,P=0,u===this.FNodesAppearance.FExpandColumn&&(I=this.FNodesAppearance.FExpandWidth+this.ScalePaintValue(4),P=this.FNodesAppearance.FExpandHeight+this.ScalePaintValue(4)),(k=rtl.arraySetLength(k,pas["WEBLib.TMSFNCTypes"].TRectF,rtl.length(k)+1))[rtl.length(k)-1].$assign(pas["WEBLib.TMSFNCTypes"].RectF(pas.System.Int(b+this.ScalePaintValue(2)),pas.System.Int(T.Top+(T.Bottom-T.Top-P)/2+this.ScalePaintValue(2)),pas.System.Int(b+I-this.ScalePaintValue(2)),pas.System.Int(T.Top+(T.Bottom-T.Top-P)/2+P-this.ScalePaintValue(2)))),b+=I,v=0,O=0,this.DoGetNodeCheckType(S,u,{get:function(){return v},set:function(t){v=t}}),0!==v&&(O=this.ScalePaintValue(this.FCheckStartSize)),(z=rtl.arraySetLength(z,pas["WEBLib.TMSFNCTypes"].TRectF,rtl.length(z)+1))[rtl.length(z)-1].$assign(pas["WEBLib.TMSFNCTypes"].RectF(pas.System.Int(b+this.ScalePaintValue(4)),pas.System.Int(T.Top+(T.Bottom-T.Top-O)/2+this.ScalePaintValue(2)),pas.System.Int(b+O),pas.System.Int(T.Top+(T.Bottom-T.Top-O)/2+O-this.ScalePaintValue(2)))),b+=Math.max(0,O+4),L=null,this.DoGetNodeIcon(S,u,!1,{get:function(){return L},set:function(t){L=t}}),null==L&&pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.IsHighDPIScale(null,-1)&&this.DoGetNodeIcon(S,u,!0,{get:function(){return L},set:function(t){L=t}}),G=0,A=0,null!=L&&L.GetWidth()>0&&L.GetHeight()>0&&(G=L.GetWidth()+this.ScalePaintValue(4),A=L.GetHeight()+this.ScalePaintValue(4),this.DoGetNodeIconSize(S,u,pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.IsHighDPIScale(null,-1),L,{get:function(){return G},set:function(t){G=t}},{get:function(){return A},set:function(t){A=t}})),(V=rtl.arraySetLength(V,pas["WEBLib.TMSFNCTypes"].TRectF,rtl.length(V)+1))[rtl.length(V)-1].$assign(pas["WEBLib.TMSFNCTypes"].RectF(pas.System.Int(b+this.ScalePaintValue(2)),pas.System.Int(T.Top+(T.Bottom-T.Top-A)/2+this.ScalePaintValue(2)),pas.System.Int(b+G-this.ScalePaintValue(2)),pas.System.Int(T.Top+(T.Bottom-T.Top-A)/2+A-this.ScalePaintValue(2)))),b+=G,X=0,this.DoGetNodeExtraSize(S,u,{get:function(){return X},set:function(t){X=t}}),J=0,this.DoGetNodeTitleExtraSize(S,u,{get:function(){return J},set:function(t){J=t}}),(""!==S.GetTitle(u)||S.FTitleHeight>0)&&""!==S.GetText(u)&&S.GetTitleExpanded(u)?(q.$assign(pas["WEBLib.TMSFNCTypes"].RectF(b,T.Top,N-J,T.Top+S.FTitleHeight)),(U=rtl.arraySetLength(U,pas["WEBLib.TMSFNCTypes"].TRectF,rtl.length(U)+1))[rtl.length(U)-1].$assign(q),(j=rtl.arraySetLength(j,pas["WEBLib.TMSFNCTypes"].TRectF,rtl.length(j)+1))[rtl.length(j)-1].$assign(pas["WEBLib.TMSFNCTypes"].RectF(q.Right,T.Top,q.Right+J,T.Top+J)),q.$assign(pas["WEBLib.TMSFNCTypes"].RectF(b,q.Bottom,N-X,T.Bottom)),(H=rtl.arraySetLength(H,pas["WEBLib.TMSFNCTypes"].TRectF,rtl.length(H)+1))[rtl.length(H)-1].$assign(q)):(q.$assign(pas["WEBLib.TMSFNCTypes"].RectF(b,T.Top+(T.Bottom-T.Top-(c.Bottom-c.Top))/2,N-J,T.Top+(T.Bottom-T.Top-(c.Bottom-c.Top))/2+(c.Bottom-c.Top))),(U=rtl.arraySetLength(U,pas["WEBLib.TMSFNCTypes"].TRectF,rtl.length(U)+1))[rtl.length(U)-1].$assign(q),(j=rtl.arraySetLength(j,pas["WEBLib.TMSFNCTypes"].TRectF,rtl.length(j)+1))[rtl.length(j)-1].$assign(pas["WEBLib.TMSFNCTypes"].RectF(q.Right,T.Top,q.Right+J,T.Top+J)),q.$assign(pas["WEBLib.TMSFNCTypes"].RectF(b,T.Top+(T.Bottom-T.Top-(c.Bottom-c.Top))/2,N-X,T.Top+(T.Bottom-T.Top-(c.Bottom-c.Top))/2+(c.Bottom-c.Top))),(H=rtl.arraySetLength(H,pas["WEBLib.TMSFNCTypes"].TRectF,rtl.length(H)+1))[rtl.length(H)-1].$assign(q)),(K=rtl.arraySetLength(K,pas["WEBLib.TMSFNCTypes"].TRectF,rtl.length(K)+1))[rtl.length(K)-1].$assign(pas["WEBLib.TMSFNCTypes"].RectF(q.Right,q.Top,q.Right+X,q.Bottom));return this.UpdateNodeExtraRects(S,rtl.arrayRef(K)),this.UpdateNodeTitleExtraRects(S,rtl.arrayRef(j)),this.UpdateNodeTextRects(S,rtl.arrayRef(H)),this.UpdateNodeTitleRects(S,rtl.arrayRef(U)),this.UpdateNodeBitmapRects(S,rtl.arrayRef(V)),this.UpdateNodeExpandRects(S,rtl.arrayRef(k)),this.UpdateNodeCheckRects(S,rtl.arrayRef(z)),o=pas["WEBLib.TMSFNCTreeViewData"].TTMSFNCTreeViewCacheItem.CreateNode(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(c),S),this.FNodeCache.Add$1(o),this.UpdateNodeCacheReference(S,o),p-n>C.Bottom-C.Top},this.XYToColumnAnchorCache=function(t,e,i,s){var o="",n=0,r=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),a="",l=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),h="",F=null,p=null,c=null,u=!1,C=0,T=0,S=0,d=!1,m=0;o="",s.set(-1),(F=pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.$create("CreateBitmapCanvas",[1,1,!1,!0])).BeginScene();try{F.FBitmapContainer=this.GetBitmapContainer();for(var f=0,g=i.GetCount()-1;f<=g;f++){if(n=f,p=i.GetItem$1(n),c=null,u=!1,p.FColumn>=0&&p.FColumn<=this.FColumns.GetCount()-1&&(c=this.FColumns.GetItem$1(p.FColumn)),l.$assign(p.FDrawRect),m=0,null!=c&&(c.FFiltering.FEnabled&&(m=m+c.FFiltering.FButtonSize+this.ScalePaintValue(4)),c.FExpandable&&(m=m+c.FExpandingButtonSize+this.ScalePaintValue(6)),0!==c.FSortKind&&this.FSortColumn===p.FColumn&&(m=m+this.ScalePaintValue(8)+this.ScalePaintValue(6))),u){var y=p.FKind;1===y?F.FFont.Assign(this.FColumnsAppearance.FTopFont):2===y&&F.FFont.Assign(this.FColumnsAppearance.FBottomFont)}else if(null!=c){var M=p.FKind;1===M?F.FFont.Assign(c.FTopFont):2===M&&F.FFont.Assign(c.FBottomFont)}if(h=this.GetColumnText(p.FColumn),this.DoGetColumnText(p.FColumn,p.FKind,{get:function(){return h},set:function(t){h=t}}),T=1,S=0,d=!1,C=0,null!=c&&(T=c.FHorizontalTextAlign,S=c.FVerticalTextAlign,d=c.FWordWrapping,C=c.FTrimming),this.DoGetColumnTrimming(p.FColumn,p.FKind,{get:function(){return C},set:function(t){C=t}}),this.DoGetColumnWordWrapping(p.FColumn,p.FKind,{get:function(){return d},set:function(t){d=t}}),this.DoGetColumnHorizontalTextAlign(p.FColumn,p.FKind,{get:function(){return T},set:function(t){T=t}}),this.DoGetColumnVerticalTextAlign(p.FColumn,p.FKind,{get:function(){return S},set:function(t){S=t}}),r.$assign(l),pas["WEBLib.TMSFNCTypes"].InflateRectEx(r,this.ScalePaintValue(-2),this.ScalePaintValue(-2)),r.Right=Math.max(r.Left,r.Right-m),pas["WEBLib.TMSFNCTypes"].PtInRectEx(r,pas["WEBLib.TMSFNCTypes"].PointF(t,e))){var b=p.FKind;if(1===b?(null!=c?F.FFont.Assign(c.FTopFont):F.FFont.Assign(this.FColumnsAppearance.FTopFont),a=this.FColumnsAppearance.FTopVerticalText?F.DrawText$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(r),h,d,T,S,C,-90,-1,-1,!0,!0,t,e):F.DrawText$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(r),h,d,T,S,C,0,-1,-1,!0,!0,t,e)):2===b&&(null!=c?F.FFont.Assign(c.FBottomFont):F.FFont.Assign(this.FColumnsAppearance.FBottomFont),a=this.FColumnsAppearance.FBottomVerticalText?F.DrawText$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(r),h,d,T,S,C,90,-1,-1,!0,!0,t,e):F.DrawText$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(r),h,d,T,S,C,0,-1,-1,!0,!0,t,e)),""!==a){o=a,s.set(p.FColumn);break}}}}finally{F.EndScene(),F=rtl.freeLoc(F)}return o},this.GetDocURL=function(){return t.TTMSFNCTreeViewDocURL},this.GetRowHeight=function(t){var e,i=0;return i=this.FDefaultRowHeight,null!=(e=this.GetVisibleNodeForIndex(t))&&e.FCalculated&&(i=e.FHeight),i},this.GetColumnText=function(t){var e="";return e=pas["WEBLib.TMSFNCTreeViewData"].TranslateTextEx(rtl.getResStr(pas["WEBLib.TMSFNCTreeViewData"],"sTMSFNCTreeViewColumn"))+" "+pas.SysUtils.IntToStr(t),t>=0&&t<=this.FColumnCount-1&&(t>=0&&t<=this.FColumns.GetCount()-1&&""===(e=this.FColumns.GetItem$1(t).FText)&&(e=this.FColumns.GetItem$1(t).FName),""===e&&(e=pas["WEBLib.TMSFNCTreeViewData"].TranslateTextEx(rtl.getResStr(pas["WEBLib.TMSFNCTreeViewData"],"sTMSFNCTreeViewColumn"))+" "+pas.SysUtils.IntToStr(t))),null!=this.FAdapter&&(e=this.FAdapter.GetColumnDisplayName(t)),e},this.GetGroupText=function(t){var e="";return e=pas["WEBLib.TMSFNCTreeViewData"].TranslateTextEx(rtl.getResStr(pas["WEBLib.TMSFNCTreeViewData"],"sTMSFNCTreeViewGroup"))+" "+pas.SysUtils.IntToStr(t),t>=0&&t<=this.FGroups.GetCount()-1&&(e=this.FGroups.GetItem$1(t).GetText()),e},this.GetColumnsTopSize=function(){var t=0;return t=0,0 in this.FColumnsAppearance.FLayouts&&this.FColumnCount>0&&(t=this.FColumnsAppearance.FTopSize),t},this.GetColumnsExtraSize=function(){return 0,0},this.GetColumnsBottomSize=function(){var t=0;return t=0,1 in this.FColumnsAppearance.FLayouts&&this.FColumnCount>0&&(t=this.FColumnsAppearance.FBottomSize),t},this.GetGroupsTopSize=function(){var t=0;return t=0,0 in this.FGroupsAppearance.FLayouts&&this.FDisplayGroups.GetCount()>0&&this.FColumnCount>0&&(t=this.FGroupsAppearance.FTopSize),t},this.GetGroupsBottomSize=function(){var t=0;return t=0,1 in this.FGroupsAppearance.FLayouts&&this.FDisplayGroups.GetCount()>0&&this.FColumnCount>0&&(t=this.FGroupsAppearance.FBottomSize),t},this.GetContentClipRect=function(){var t=pas["WEBLib.TMSFNCTypes"].TRectF.$new();return t.$assign(pas["WEBLib.TMSFNCTreeViewBase"].TTMSFNCTreeViewBase.GetContentClipRect.call(this)),t.Bottom=t.Top+Math.min(this.GetTotalRowHeight(),t.Bottom-t.Top),t.Right=t.Left+Math.min(this.GetTotalColumnWidth(),t.Right-t.Left),t.Left=t.Left+1,t.Right=t.Right-1,t},this.GetContentRect=function(){var t=pas["WEBLib.TMSFNCTypes"].TRectF.$new();return t.$assign(pas["WEBLib.TMSFNCTreeViewBase"].TTMSFNCTreeViewBase.GetContentRect.call(this)),t.Top=t.Top+this.GetColumnsTopSize()+this.GetGroupsTopSize(),t.Bottom=t.Bottom-this.GetColumnsBottomSize()-this.GetGroupsBottomSize(),t},this.GetCalculationRect=function(){var t=pas["WEBLib.TMSFNCTypes"].TRectF.$new();return t.$assign(pas["WEBLib.TMSFNCTreeViewBase"].TTMSFNCTreeViewBase.GetCalculationRect.call(this)),t.Top=t.Top+this.GetColumnsTopSize()+this.GetGroupsTopSize(),t.Bottom=t.Bottom-this.GetColumnsBottomSize()-this.GetGroupsBottomSize(),t.Right=t.Left+Math.max(0,t.Right-t.Left),t.Bottom=t.Top+Math.max(0,t.Bottom-t.Top),t},this.GetGroupsTopRect=function(){var t=pas["WEBLib.TMSFNCTypes"].TRectF.$new();return t.$assign(this.GetColumnsTopRect()),t.Bottom=t.Top,t.Top=t.Top-this.GetGroupsTopSize(),t},this.GetGroupsBottomRect=function(){var t=pas["WEBLib.TMSFNCTypes"].TRectF.$new();return t.$assign(this.GetColumnsBottomRect()),t.Top=t.Bottom,t.Bottom=t.Top+this.GetGroupsBottomSize(),t},this.GetColumnsTopRect=function(){var t=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),e=pas["WEBLib.TMSFNCTypes"].TRectF.$new();return e.$assign(pas["WEBLib.TMSFNCTreeViewBase"].TTMSFNCTreeViewBase.GetContentRect.call(this)),t.Left=e.Left,t.Top=e.Top+this.GetGroupsTopSize(),t.Right=e.Right+this.GetColumnsExtraSize(),t.Bottom=e.Top+this.GetGroupsTopSize()+this.GetColumnsTopSize(),t},this.GetColumnBottomRightEmptyRect=function(){var t=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),e=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),i=pas["WEBLib.TMSFNCTypes"].TRectF.$new();return e.$assign(this.GetColumnsBottomRect()),i.$assign(this.GetLocalRect()),t.Top=e.Top,t.Left=e.Right,t.Right=i.Right-1,t.Bottom=e.Bottom,t},this.GetColumnTopRightEmptyRect=function(){var t=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),e=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),i=pas["WEBLib.TMSFNCTypes"].TRectF.$new();return e.$assign(this.GetColumnsTopRect()),i.$assign(this.GetLocalRect()),t.Top=e.Top,t.Left=e.Right,t.Right=i.Right-1,t.Bottom=e.Bottom,t},this.GetGroupBottomRightEmptyRect=function(){var t=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),e=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),i=pas["WEBLib.TMSFNCTypes"].TRectF.$new();return e.$assign(this.GetGroupsBottomRect()),i.$assign(this.GetLocalRect()),t.Top=e.Top,t.Left=e.Right,t.Right=i.Right,t.Bottom=e.Bottom,t},this.GetGroupTopRightEmptyRect=function(){var t=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),e=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),i=pas["WEBLib.TMSFNCTypes"].TRectF.$new();return e.$assign(this.GetGroupsTopRect()),i.$assign(this.GetLocalRect()),t.Top=e.Top,t.Left=e.Right,t.Right=i.Right,t.Bottom=e.Bottom,t},this.GetColumnsBottomRect=function(){var t=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),e=pas["WEBLib.TMSFNCTypes"].TRectF.$new();return e.$assign(pas["WEBLib.TMSFNCTreeViewBase"].TTMSFNCTreeViewBase.GetContentRect.call(this)),t.Left=e.Left,t.Top=e.Bottom-this.GetGroupsBottomSize()-this.GetColumnsBottomSize(),t.Right=e.Right+this.GetColumnsExtraSize(),t.Bottom=e.Bottom-this.GetGroupsBottomSize(),t},this.XYToCacheItem=function(t,e,i){var s=null,o=0,n=null,r=pas["WEBLib.TMSFNCTypes"].TRectF.$new();if(s=null,null==this.FNodeDisplay)return s;if(!pas["WEBLib.TMSFNCTypes"].PtInRectEx(this.GetContentClipRect(),pas["WEBLib.TMSFNCTypes"].PointF(t,e)))return s;for(var a=0,l=this.FNodeDisplay.GetCount()-1;a<=l;a++)if(o=a,n=this.FNodeDisplay.GetItem(o),r.$assign(n.FDrawRect),r.Left=r.Left+i,r.Right=r.Right+i,pas["WEBLib.TMSFNCTypes"].PtInRectEx(r,pas["WEBLib.TMSFNCTypes"].PointF(t,e))){s=n;break}return s},this.GetHTMLTemplate=function(t){return t>=0&&t<this.FColumns.GetCount()?this.FColumns.GetItem$1(t).FHTMLTemplate:""},this.Create$1=function(e){var i=0;return pas["WEBLib.TMSFNCTreeViewData"].TTMSFNCTreeViewData.Create$1.apply(this,arguments),this.FColumnStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,-1]),this.FColumnStroke.FOnChanged=rtl.createCallback(this,"ColumnStrokeChanged"),this.FSizeColumn=-1,this.FGroupsCaching=!1,this.FColumnsCaching=!1,this.FSelectedNodes=t.TTMSFNCTreeViewSelectedNodes.$create("Create$1"),this.FNodeCache=t.TTMSFNCTreeViewNodeCache.$create("Create$2"),this.FColumnsTopCache=t.TTMSFNCTreeViewColumnsTopCache.$create("Create$2"),this.FGroupsTopCache=t.TTMSFNCTreeViewGroupsTopCache.$create("Create$2"),this.FColumnsBottomCache=t.TTMSFNCTreeViewColumnsBottomCache.$create("Create$2"),this.FGroupsBottomCache=t.TTMSFNCTreeViewGroupsBottomCache.$create("Create$2"),this.FNodeDisplay=t.TTMSFNCTreeViewNodeDisplayList.$create("Create$1"),this.FColumnsTopDisplay=t.TTMSFNCTreeViewColumnsTopDisplayList.$create("Create$1"),this.FGroupsTopDisplay=t.TTMSFNCTreeViewGroupsTopDisplayList.$create("Create$1"),this.FColumnsBottomDisplay=t.TTMSFNCTreeViewColumnsBottomDisplayList.$create("Create$1"),this.FGroupsBottomDisplay=t.TTMSFNCTreeViewGroupsBottomDisplayList.$create("Create$1"),this.FNodesAppearance=t.TTMSFNCTreeViewNodesAppearance.$create("Create$1",[this]),this.FColumnsAppearance=t.TTMSFNCTreeViewColumnsAppearance.$create("Create$1",[this]),this.FGroupsAppearance=t.TTMSFNCTreeViewGroupsAppearance.$create("Create$1",[this]),this.FInteraction=t.TTMSFNCTreeViewInteraction.$create("Create$1",[this]),this.FDragTimer=pas["WEBLib.ExtCtrls"].TTimer.$create("Create$1",[this]),this.FDragTimer.SetInterval(10),this.FDragTimer.SetEnabled(!1),this.FDragTimer.FOnTimer=rtl.createCallback(this,"DragTime"),this.FAnimateTimer=pas["WEBLib.ExtCtrls"].TTimer.$create("Create$1",[this]),this.FAnimateTimer.SetInterval(1),this.FAnimateTimer.SetEnabled(!1),this.FAnimateTimer.FOnTimer=rtl.createCallback(this,"Animate"),this.FCopyNodes=t.TTMSFNCTreeViewCopyNodes.$create("Create$3",[null,null]),this.FFilterListBox=pas["WEBLib.StdCtrls"].TListBox.$create("Create$1",[this]),this.FFilterListBox.FTag$1=-1,this.FFilterListBox.FOnClick=rtl.createCallback(this,"HandleFilterListClick"),this.FGlobalFont=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCAppearanceGlobalFont.$create("Create$1",[this]),this.FFilterTimer=pas["WEBLib.ExtCtrls"].TTimer.$create("Create$1",[this]),this.FFilterTimer.FOnTimer=rtl.createCallback(this,"HandleFilterTimer"),this.FFilterTimer.SetInterval(100),this.FFilterTimer.SetEnabled(!1),this.FFilterPopup=pas["WEBLib.TMSFNCPopup"].TTMSFNCPopup.$create("Create$1",[this]),this.FFilterPopup.SetPlacement(9),this.SetWidth(300),this.SetHeight(280),this.FDefaultViewJSONOptions=t.TTMSFNCTreeViewViewJSONOptions.$create("Create$1"),i=pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.GetDPIScale(this,96),this.FCheckStartSize=1===i?19:1.25===i||1.75===i?16:17,this.IsDesignTime()&&this.InitSample(),this},this.Destroy=function(){null!=this.FOldInplaceEditor&&rtl.free(this,"FOldInplaceEditor"),rtl.free(this,"FDefaultViewJSONOptions"),rtl.free(this,"FGlobalFont"),rtl.free(this,"FCopyNodes"),rtl.free(this,"FFilterTimer"),rtl.free(this,"FFilterListBox"),rtl.free(this,"FFilterPopup"),null!=this.FDragBitmap&&(rtl.free(this,"FDragBitmap"),this.FDragBitmap=null),rtl.free(this,"FColumnStroke"),rtl.free(this,"FAnimateTimer"),rtl.free(this,"FNodesAppearance"),rtl.free(this,"FGroupsAppearance"),rtl.free(this,"FInteraction"),rtl.free(this,"FColumnsAppearance"),rtl.free(this,"FGroupsTopDisplay"),rtl.free(this,"FColumnsTopDisplay"),rtl.free(this,"FGroupsBottomDisplay"),rtl.free(this,"FColumnsBottomDisplay"),rtl.free(this,"FSelectedNodes"),rtl.free(this,"FNodeDisplay"),rtl.free(this,"FNodeCache"),rtl.free(this,"FGroupsTopCache"),rtl.free(this,"FColumnsTopCache"),rtl.free(this,"FGroupsBottomCache"),rtl.free(this,"FColumnsBottomCache"),pas["WEBLib.TMSFNCTreeViewData"].TTMSFNCTreeViewData.Destroy.call(this)},this.Assign=function(e){this.BeginUpdate(),pas["WEBLib.TMSFNCTreeViewData"].TTMSFNCTreeViewData.Assign.apply(this,arguments),t.TTMSFNCCustomTreeView.isPrototypeOf(e)&&(this.FNodesAppearance.Assign(rtl.as(e,t.TTMSFNCCustomTreeView).FNodesAppearance),this.FColumnsAppearance.Assign(rtl.as(e,t.TTMSFNCCustomTreeView).FColumnsAppearance),this.FGroupsAppearance.Assign(rtl.as(e,t.TTMSFNCCustomTreeView).FGroupsAppearance),this.FInteraction.Assign(rtl.as(e,t.TTMSFNCCustomTreeView).FInteraction)),this.EndUpdate()},this.Draw=function(t,e){var i=null;pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Draw.apply(this,arguments),this.FUpdateCount$1>0||(t.FBitmapContainer=this.GetBitmapContainer(),this.DrawEmptySpaces(t),i=t.SaveState(!1),t.ClipRect(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(this.GetContentClipRect())),this.DrawNodeColumns(t),t.RestoreState(i,!1),this.DrawNodes(t),this.DrawColumns(t),this.DrawGroups(t),this.DrawBorders(t))},this.InitSample=function(){var t=null,e=null,i=null,s=null,o=null,n=0,r="";for(this.BeginUpdate(),this.SetWidth(this.ScalePaintValue(350)),this.ClearNodeList(),this.FColumns.Clear(),this.FNodes.Clear(),this.ResetToDefaultStyle(),this.FNodesAppearance.SetExpandWidth(this.ScalePaintValue(18)),this.FNodesAppearance.SetExpandHeight(this.ScalePaintValue(18)),this.FColumnsAppearance.SetTopSize(this.ScalePaintValue(36)),this.FColumnsAppearance.FTopStroke.SetKind(0),this.FNodesAppearance.FSelectedStroke.SetWidth(pas.System.Trunc(this.ScalePaintValue$1(2))),(o=this.FColumns.Add$1()).SetText("Name"),o.SetHorizontalTextAlign(1),(o=this.FColumns.Add$1()).SetText("Unit"),o.SetHorizontalTextAlign(2),o.SetWidth(this.ScalePaintValue(90)),(o=this.FColumns.Add$1()).SetText("Status"),o.SetHorizontalTextAlign(0),o.SetWidth(this.ScalePaintValue(80)),(t=this.AddNode(null)).SetText(0,"Managers"),(e=this.AddNode(null)).SetText(0,"Specialists"),(i=this.AddNode(null)).SetText(0,"Assistants"),n=0;n<=7;n++){s=n<3?this.AddNode(t):n<5?this.AddNode(e):this.AddNode(i);var a=pas.System.Random(125)%7;r=0===a?"Liam":1===a?"Fatma":2===a?"Yusuf":3===a?"Marie":4===a?"Isabella":5===a?"Omar":"Arthur";var l=pas.System.Random(125)%7;r+=0===l?" Andersson":1===l?" Wang":2===l?" Smith":3===l?" Peeters":4===l?" Gonzales":5===l?" Moyo":" Ali",s.SetText(0,r);var h=pas.System.Random(120)%7;1===h?s.SetText(1,"Research"):2===h?s.SetText(1,"Finance"):3===h?s.SetText(1,"Manufactering"):4===h?s.SetText(1,"Sales"):5===h?s.SetText(1,"HR"):6===h?s.SetText(1,"Marketing"):s.SetText(1,"Customers");var F=pas.System.Random(120)%5;0===F?s.SetText(2,"Flight"):1===F?s.SetText(2,"On Leave"):2===F?s.SetText(2,"Abroad"):s.SetText(2,"Office")}t.SetExpanded(!0),e.SetExpanded(!0),this.FGlobalFont.SetName("Segoe UI"),this.FColumnsAppearance.SetStretchAll(!1),this.FColumnsAppearance.SetStretch(!0),this.FColumnsAppearance.SetStretchColumn(0),this.EndUpdate()},this.CutToClipboard=function(t){var e=0,i=null,s=null;if(null!=this.FOnCustomCutToClipboard)this.FOnCustomCutToClipboard(this);else{this.BeginUpdate(),this.CopyToClipboard(t);for(var o=this.SelectedNodeCount()-1;o>=0;o--)e=o,null!=(i=this.GetSelNode(e))?this.RemoveNode(i):(s=this.GetSelVirtualNode(e),this.RemoveVirtualNode(s));this.EndUpdate()}},this.CopyToClipboard=function(e){var i="",s=0,o=0,n=null,r=null,a=null;if(null!=this.FOnCustomCopyToClipboard)this.FOnCustomCopyToClipboard(this);else{a=pas["WEBLib.TMSFNCTreeViewData"].TTMSFNCTreeViewIntegerList.$create("Create$1");try{i="";for(var l=0,h=this.SelectedVirtualNodeCount()-1;l<=h;l++)if(s=l,null!=(n=this.GetSelVirtualNode(s))&&-1===a.IndexOf(n.FRow)&&(null!=n.FNode&&(i=i+n.FNode.SaveToString(e)+t.ENDOFLINE),a.Add(n.FRow)),null!=n)for(var F=n.FRow+1,p=n.FRow+n.FTotalChildren;F<=p;F++)o=F,null!=(r=this.GetNodeFromNodeStructure(o))&&null!=r.FNode&&-1===a.IndexOf(r.FRow)&&(i=i+r.FNode.SaveToString(e)+t.ENDOFLINE,a.Add(r.FRow));""!==i&&pas["WEBLib.TMSFNCUtils"].TTMSFNCClipBoard.SetText(t.CLP_FMT+i)}finally{a=rtl.freeLoc(a)}}},this.PasteFromClipboard=function(){var e="",i=null,s=null,o=null,n=0,r=0,a=0,l="";if(null!=this.FOnCustomPasteFromClipboard)this.FOnCustomPasteFromClipboard(this);else if(pas["WEBLib.TMSFNCUtils"].TTMSFNCClipBoard.HasFormat(0)&&(e=pas["WEBLib.TMSFNCUtils"].TTMSFNCClipBoard.GetText(),pas.System.Pos(t.CLP_FMT,e)>0)){i=pas.Classes.TStringList.$create("Create$1");try{e=pas.SysUtils.StringReplace(e,t.CLP_FMT,"",rtl.createSet(0)),i.SetTextStr(e);try{s=null,a=0;for(var h=0,F=i.GetCount()-1;h<=F;h++){if(r=h,n=-1,l=this.GetBufStart(i.Get(r),{get:function(){return n},set:function(t){n=t}}),null===s)s=this.AddNode(this.GetFocusedNode()),a=n,null!=this.GetFocusedNode()&&(a-=this.GetFocusedNode().FVirtualNode.FLevel);else if(null!=s.FVirtualNode&&s.FVirtualNode.FLevel===n-a)s=this.AddNode(s.GetParent());else if(null!=s.FVirtualNode&&s.FVirtualNode.FLevel===n-1-a)s=this.AddNode(s);else if(null!=s.FVirtualNode&&s.FVirtualNode.FLevel>n-a){for(o=s.GetParent();null!=o&&null!=o.FVirtualNode&&o.FVirtualNode.FLevel>n-a;)o=o.GetParent();s=this.AddNode(o.GetParent())}null!=s&&s.LoadFromString(l)}}finally{}}finally{i=rtl.freeLoc(i)}}},this.UnSelectAllNodes=function(){this.UnSelectAllVirtualNodes()},this.SelectAllNodes=function(){this.SelectAllVirtualNodes()},this.UnSelectAllVirtualNodes=function(){this.FSelectedNodes.Clear(),this.Invalidate()},this.SelectAllVirtualNodes=function(){var t=0,e=null;this.FSelectedNodes.Clear();for(var i=0,s=this.FVisibleNodes.GetCount()-1;i<=s;i++)t=i,null!=(e=this.FVisibleNodes.GetItem(t))&&this.IsVirtualNodeSelectable(e)&&this.FSelectedNodes.Add(e);this.Invalidate()},this.SelectNode=function(t){null!=t?this.SelectVirtualNode(t.FVirtualNode):this.SelectVirtualNode(null)},this.SelectVirtualNode=function(t){this.FSelectedNodes.Clear(),null!=t&&this.IsVirtualNodeSelectable(t)&&(this.FSelectedNodes.Add(t),this.FFocusedNode=t,this.InternalSelectVirtualNode(t)),this.Invalidate()},this.SelectVirtualNodes=function(t){var e=null;this.FSelectedNodes.Clear();for(var i=0,s=rtl.length(t)-1;i<=s;i++)null!=(e=t[i])&&this.IsVirtualNodeSelectable(e)&&this.FSelectedNodes.Add(e);this.Invalidate()},this.UnSelectVirtualNode=function(t){this.FSelectedNodes.Remove(t),this.Invalidate()},this.RemoveNodeFromSelection=function(t){this.FSelectedNodes.Remove(t)},this.EditVirtualNode=function(t,e){this.HandleNodeEditing(t,e),this.Invalidate()},this.StopEditing=function(){this.FInplaceEditorActive&&this.CloseInplaceEditor(!1,!1)},this.GetVisibleNodeCount=function(){var t,e,i=0;return i=0,t=this.GetFirstVisibleVirtualNode(),e=this.GetLastVisibleVirtualNode(),null!=t&&null!=e&&(i=e.FRow-t.FRow),i},this.GetFirstVisibleVirtualNode=function(){var t=null;return t=null,this.FNodeDisplay.GetCount()>0&&(t=this.FNodeDisplay.GetItem(0).FNode),t},this.GetLastVisibleVirtualNode=function(){var t=null;return t=null,this.FNodeDisplay.GetCount()>0&&(t=this.FNodeDisplay.GetItem(this.FNodeDisplay.GetCount()-1).FNode),t},this.GetFirstVisibleVirtualNodeRow=function(){var t,e=0;return e=0,null!=(t=this.GetFirstVisibleVirtualNode())&&(e=t.FRow),e},this.GetLastVisibleVirtualNodeRow=function(){var t,e=0;return e=0,null!=(t=this.GetLastVisibleVirtualNode())&&(e=t.FRow),e},this.LookupNode=function(t,e,i,s,o,n){var r=null,a="",l=null,h=null,F=null,p="",c=0,u=0,C=!1;if(r=null,a=t,s||(a=pas.SysUtils.UpperCase(a)),e)for(l=this.GetFirstRootVirtualNode();null!=l;){if(h=this.GetFirstVisibleVirtualNode(),F=this.GetLastVisibleVirtualNode(),!this.FInteraction.FLookup.FVisibleNodesOnly||this.FInteraction.FLookup.FVisibleNodesOnly&&null!=h&&null!=F&&l.FRow<=F.FRow&&l.FRow>=h.FRow)if(i>=0&&i<=this.FColumns.GetCount()-1){if(p="",this.DoGetNodeText(l,i,0,{get:function(){return p},set:function(t){p=t}}),p=pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.HTMLStrip(p),s||(p=pas.SysUtils.UpperCase(p)),1===pas.System.Pos(a,p)){r=l;break}}else{C=!1;for(var T=0,S=this.FColumns.GetCount()-1;T<=S;T++)if(u=T,p="",this.DoGetNodeText(l,u,0,{get:function(){return p},set:function(t){p=t}}),p=pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.HTMLStrip(p),s||(p=pas.SysUtils.UpperCase(p)),1===pas.System.Pos(a,p)){r=l,C=!0;break}if(C)break}l=l.GetNextSibling()}else for(var d=0,m=this.FNodeStructure.GetCount()-1;d<=m;d++)if(c=d,null!=(l=this.GetNodeFromNodeStructure(c))&&(h=this.GetFirstVisibleVirtualNode(),F=this.GetLastVisibleVirtualNode(),!this.FInteraction.FLookup.FVisibleNodesOnly||this.FInteraction.FLookup.FVisibleNodesOnly&&null!=h&&null!=F&&l.FRow<=F.FRow&&l.FRow>=h.FRow))if(i>=0&&i<=this.FColumns.GetCount()-1){if(p="",this.DoGetNodeText(l,i,0,{get:function(){return p},set:function(t){p=t}}),p=pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.HTMLStrip(p),s||(p=pas.SysUtils.UpperCase(p)),1===pas.System.Pos(a,p)){r=l;break}}else{C=!1;for(var f=0,g=this.FColumns.GetCount()-1;f<=g;f++)if(u=f,p="",this.DoGetNodeText(l,u,0,{get:function(){return p},set:function(t){p=t}}),p=pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.HTMLStrip(p),s||(p=pas.SysUtils.UpperCase(p)),1===pas.System.Pos(a,p)){r=l,C=!0;break}if(C)break}if(null!=r){if(n){for(l=r.GetParent();null!=l&&l.FLevel>0;)l.FExpanded||l.Expand(!1),l=l.GetParent();null!=l&&l.Expand(!1)}o&&(this.IsVirtualNodeSelectable(r)&&this.SelectVirtualNode(r),this.ScrollToVirtualNode(r,!0,0,!1))}return r},this.GetInplaceEditor=function(){return this.FInplaceEditor},this.IsVirtualNodeSelectable=function(t){var e=!1,i=!1;return e=!0,null!=t&&(this.DoIsNodeEnabled(t,{get:function(){return e},set:function(t){e=t}}),i=!1,this.DoIsNodeExtended(t,{get:function(){return i},set:function(t){i=t}}),(!i||this.FInteraction.FExtendedSelectable)&&this.FVisibleNodes.IndexOf(t)>-1||(e=!1)),e},this.XYToColumnAnchor=function(t,e,i){var s="";return""===(s=this.XYToColumnAnchorCache(t,e,this.FColumnsTopCache,i))&&-1===i.get()&&(s=this.XYToColumnAnchorCache(t,e,this.FColumnsBottomCache,i)),s},this.XYToNode=function(t,e,i){var s,o=null;return o=null,null!=(s=this.XYToCacheItem(t,e,i))&&(o=s.FNode),o},this.XYToNodeAnchor=function(e,i,s){var o=t.TTMSFNCTreeViewNodeAnchor.$new(),n=0,r=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),a="",l="",h=null,F=null,p=0,c=0,u=!1,C=0,T=!1,S=0;if(o.AAnchor="",o.AColumn=-1,null!=e)for(var d=S=this.GetFirstVisibleColumn(),m=this.GetLastVisibleColumn();d<=m;d++)if((n=d)-S>=0&&n-S<=rtl.length(e.FTextRects)-1&&(r.$assign(e.FTextRects[n-S]),pas["WEBLib.TMSFNCTypes"].InflateRectEx(r,this.ScalePaintValue(-2),this.ScalePaintValue(-2)),pas["WEBLib.TMSFNCTypes"].PtInRectEx(r,pas["WEBLib.TMSFNCTypes"].PointF(i,s)))){F=null,n<=this.FColumns.GetCount()-1&&(F=this.FColumns.GetItem$1(n)),T=!1,p=1,c=0,u=!1,C=0,null!=F&&(p=F.FHorizontalTextAlign,c=F.FVerticalTextAlign,u=F.FWordWrapping,C=F.FTrimming),this.DoIsNodeExtended(e,{get:function(){return T},set:function(t){T=t}}),this.DoGetNodeTrimming(e,n,{get:function(){return C},set:function(t){C=t}}),this.DoGetNodeWordWrapping(e,n,{get:function(){return u},set:function(t){u=t}}),this.DoGetNodeHorizontalTextAlign(e,n,{get:function(){return p},set:function(t){p=t}}),this.DoGetNodeVerticalTextAlign(e,n,{get:function(){return c},set:function(t){c=t}}),l="",this.DoGetNodeText(e,n,0,{get:function(){return l},set:function(t){l=t}}),(h=pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.$create("CreateBitmapCanvas",[1,1,!1,!0])).BeginScene(),null==F||F.FUseDefaultAppearance||T?T?h.FFont.Assign(this.FNodesAppearance.FExtendedFont):h.FFont.Assign(this.FNodesAppearance.FFont):h.FFont.Assign(F.FFont),h.FBitmapContainer=this.GetBitmapContainer(),h.FOptimizedHTMLDrawing=this.FOptimizedHTMLDrawing;try{a=h.DrawText$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(r),l,u,p,c,C,0,-1,-1,!0,!0,i,s)}finally{h.EndScene(),h=rtl.freeLoc(h)}if(""!==a){o.AAnchor=a,o.AColumn=n;break}}return o},this.XYToNodeTitleAnchor=function(e,i,s){var o=t.TTMSFNCTreeViewNodeAnchor.$new(),n=0,r=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),a="",l="",h=null,F=null,p=0,c=0,u=!1,C=0,T=0;if(o.AAnchor="",o.AColumn=-1,null!=e)for(var S=T=this.GetFirstVisibleColumn(),d=this.GetLastVisibleColumn();S<=d;S++)if((n=S)-T>=0&&n-T<=rtl.length(e.FTitleRects)-1&&(r.$assign(e.FTitleRects[n-T]),pas["WEBLib.TMSFNCTypes"].InflateRectEx(r,this.ScalePaintValue(-2),this.ScalePaintValue(-2)),pas["WEBLib.TMSFNCTypes"].PtInRectEx(r,pas["WEBLib.TMSFNCTypes"].PointF(i,s)))){F=null,n<=this.FColumns.GetCount()-1&&(F=this.FColumns.GetItem$1(n)),p=1,c=0,u=!1,C=0,null!=F&&(p=F.FTitleHorizontalTextAlign,c=F.FTitleVerticalTextAlign,u=F.FTitleWordWrapping,C=F.FTitleTrimming),this.DoGetNodeTitleTrimming(e,n,{get:function(){return C},set:function(t){C=t}}),this.DoGetNodeTitleWordWrapping(e,n,{get:function(){return u},set:function(t){u=t}}),this.DoGetNodeTitleHorizontalTextAlign(e,n,{get:function(){return p},set:function(t){p=t}}),this.DoGetNodeTitleVerticalTextAlign(e,n,{get:function(){return c},set:function(t){c=t}}),l="",this.DoGetNodeTitle(e,n,0,{get:function(){return l},set:function(t){l=t}}),(h=pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.$create("CreateBitmapCanvas",[1,1,!1,!0])).BeginScene(),null==F||F.FUseDefaultAppearance?h.FFont.Assign(this.FNodesAppearance.FTitleFont):h.FFont.Assign(F.FTitleFont),h.FBitmapContainer=this.GetBitmapContainer(),h.FOptimizedHTMLDrawing=this.FOptimizedHTMLDrawing;try{a=h.DrawText$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(r),l,u,p,c,C,0,-1,-1,!0,!0,i,s)}finally{h.EndScene(),h=rtl.freeLoc(h)}if(""!==a){o.AAnchor=a,o.AColumn=n;break}}return o},this.XYToNodeExpand=function(t,e,i){var s=!1,o=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),n=!1,r=0;return s=!1,null!=t&&t.FChildren>0&&(n=!0,this.DoIsNodeEnabled(t,{get:function(){return n},set:function(t){n=t}}),n&&(r=this.GetFirstVisibleColumn(),this.FNodesAppearance.FExpandColumn-r>=0&&this.FNodesAppearance.FExpandColumn-r<=rtl.length(t.FExpandRects)-1&&(o.$assign(t.FExpandRects[this.FNodesAppearance.FExpandColumn-r]),s=pas["WEBLib.TMSFNCTypes"].PtInRectEx(o,pas["WEBLib.TMSFNCTypes"].PointF(e,i))))),s},this.XYToNodeExtra=function(t,e,i){var s=!1,o=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),n=!1,r=0,a=0;if(s=!1,n=!0,this.DoIsNodeEnabled(t,{get:function(){return n},set:function(t){n=t}}),null!=t&&n)for(var l=a=this.GetFirstVisibleColumn(),h=this.GetLastVisibleColumn();l<=h;l++)if((r=l)-a>=0&&r-a<=rtl.length(t.FExtraRects)-1&&(o.$assign(t.FExtraRects[r-a]),pas["WEBLib.TMSFNCTypes"].PtInRectEx(o,pas["WEBLib.TMSFNCTypes"].PointF(e,i)))){s=!0;break}return s},this.XYToNodeTitleExtra=function(t,e,i){var s=!1,o=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),n=!1,r=0,a=0;if(s=!1,n=!0,this.DoIsNodeEnabled(t,{get:function(){return n},set:function(t){n=t}}),null!=t&&n)for(var l=a=this.GetFirstVisibleColumn(),h=this.GetLastVisibleColumn();l<=h;l++)if((r=l)-a>=0&&r-a<=rtl.length(t.FTitleExtraRects)-1&&(o.$assign(t.FTitleExtraRects[r-a]),pas["WEBLib.TMSFNCTypes"].PtInRectEx(o,pas["WEBLib.TMSFNCTypes"].PointF(e,i)))){s=!0;break}return s},this.XYToNodeCheck=function(e,i,s){var o=t.TTMSFNCTreeViewNodeCheck.$new(),n=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),r=!1,a=0,l=0;if(o.AColumn=-1,o.ANode=null,r=!0,this.DoIsNodeEnabled(e,{get:function(){return r},set:function(t){r=t}}),null!=e&&r)for(var h=l=this.GetFirstVisibleColumn(),F=this.GetLastVisibleColumn();h<=F;h++)if((a=h)-l>=0&&a-l<=rtl.length(e.FCheckRects)-1&&(n.$assign(e.FCheckRects[a-l]),pas["WEBLib.TMSFNCTypes"].PtInRectEx(n,pas["WEBLib.TMSFNCTypes"].PointF(i,s)))){o.ANode=e,o.AColumn=a;break}return o},this.XYToNodeTextColumn=function(t,e,i){var s=0,o=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),n=0,r=0;if(s=-1,null!=t)for(var a=r=this.GetFirstVisibleColumn(),l=this.GetLastVisibleColumn();a<=l;a++)if((n=a)-r>=0&&n-r<=rtl.length(t.FTextRects)-1&&(o.$assign(t.FTextRects[n-r]),pas["WEBLib.TMSFNCTypes"].PtInRectEx(o,pas["WEBLib.TMSFNCTypes"].PointF(e,i)))){s=n;break}return s},this.XYToColumnSize=function(t,e){var i=0,s=0,o=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),n=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),r=0,a=0;i=-1,o.$assign(this.GetColumnsTopRect()),o.Left=o.Left-this.GetHorizontalScrollPosition();for(var l=this.FColumnCount-1;l>=0;l--)if((s=l)>=0&&s<=this.FColumns.GetCount()-1&&this.FColumns.GetItem$1(s).FVisible&&(r=this.GetColWidths(s))>=0&&s>=0&&s<=this.FColumns.GetCount()-1&&this.FColumns.GetItem$1(s).FVisible&&(a=this.GetColPos(s),n.$assign(pas["WEBLib.TMSFNCTypes"].RectF(o.Left+a+r-this.ScalePaintValue(4),o.Top,o.Left+a+r+this.ScalePaintValue(4),o.Bottom)),pas["WEBLib.TMSFNCTypes"].PtInRectEx(n,pas["WEBLib.TMSFNCTypes"].PointF(t,e)))){i=s;break}return i},this.XYToColumn=function(t,e,i){var s=0,o=0,n=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),r=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),a=0,l=0;s=-1,i?n.$assign(pas["WEBLib.TMSFNCTreeViewBase"].TTMSFNCTreeViewBase.GetContentRect.call(this)):n.$assign(this.GetColumnsTopRect()),n.Left=n.Left-this.GetHorizontalScrollPosition();for(var h=this.FColumnCount-1;h>=0;h--)if((o=h)>=0&&o<=this.FColumns.GetCount()-1&&this.FColumns.GetItem$1(o).FVisible&&(a=this.GetColWidths(o)+this.GetColumnsExtraSize())>=0&&(l=this.GetColPos(o),r.$assign(pas["WEBLib.TMSFNCTypes"].RectF(n.Left+l,n.Top,n.Left+l+a,n.Bottom)),pas["WEBLib.TMSFNCTypes"].PtInRectEx(r,pas["WEBLib.TMSFNCTypes"].PointF(t,e)))){s=o;break}return s},this.XYToColumnFilter=function(t,e){var i=0,s=0,o=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),n=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),r=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),a=0,l=0,h=0;i=-1,o.$assign(this.GetColumnsTopRect()),o.Left=o.Left-this.GetHorizontalScrollPosition();for(var F=this.FColumnCount-1;F>=0;F--)if((s=F)>=0&&s<=this.FColumns.GetCount()-1&&this.FColumns.GetItem$1(s).FFiltering.FEnabled&&this.FColumns.GetItem$1(s).FVisible&&(l=this.GetColWidths(s)+this.GetColumnsExtraSize())>=0&&(h=this.GetColPos(s),n.$assign(pas["WEBLib.TMSFNCTypes"].RectF(o.Left+h,o.Top,o.Left+h+l,o.Bottom)),a=this.FColumns.GetItem$1(s).FFiltering.FButtonSize,r.$assign(pas["WEBLib.TMSFNCTypes"].RectF(Math.round(n.Right-a-this.ScalePaintValue(4)),Math.round(n.Top+(n.Bottom-n.Top-a)/2),Math.round(n.Right-this.ScalePaintValue(4)),Math.round(n.Top+(n.Bottom-n.Top-a)/2+a))),pas["WEBLib.TMSFNCTypes"].PtInRectEx(r,pas["WEBLib.TMSFNCTypes"].PointF(t,e)))){i=s;break}return i},this.XYToColumnExpand=function(t,e){var i=0,s=0,o=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),n=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),r=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),a=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),l=0,h=0,F=0,p=0;i=-1,o.$assign(this.GetColumnsTopRect()),o.Left=o.Left-this.GetHorizontalScrollPosition();for(var c=this.FColumnCount-1;c>=0;c--)if((s=c)>=0&&s<=this.FColumns.GetCount()-1&&this.FColumns.GetItem$1(s).FExpandable&&this.FColumns.GetItem$1(s).FVisible&&(h=this.GetColWidths(s)+this.GetColumnsExtraSize())>=0&&(F=this.GetColPos(s),n.$assign(pas["WEBLib.TMSFNCTypes"].RectF(o.Left+F,o.Top,o.Left+F+h,o.Bottom)),l=this.FColumns.GetItem$1(s).FExpandingButtonSize,this.FColumns.GetItem$1(s).FFiltering.FEnabled?(p=this.FColumns.GetItem$1(s).FFiltering.FButtonSize,r.$assign(pas["WEBLib.TMSFNCTypes"].RectF(Math.round(n.Right-p-this.ScalePaintValue(4)),Math.round(n.Top+(n.Bottom-n.Top-p)/2),Math.round(n.Right-this.ScalePaintValue(4)),Math.round(n.Top+(n.Bottom-n.Top-p)/2+p))),a.$assign(n),a.Right=r.Left):a.$assign(n),r.$assign(pas["WEBLib.TMSFNCTypes"].RectF(Math.round(a.Right-l-this.ScalePaintValue(6)),Math.round(a.Top+(a.Bottom-a.Top-l)/2),Math.round(a.Right-this.ScalePaintValue(6)),Math.round(a.Top+(a.Bottom-a.Top-l)/2+l))),pas["WEBLib.TMSFNCTypes"].PtInRectEx(r,pas["WEBLib.TMSFNCTypes"].PointF(t,e)))){i=s;break}return i},this.SelectedNodeCount=function(){return this.SelectedVirtualNodeCount()},this.SelectedVirtualNodeCount=function(){return this.FSelectedNodes.GetCount()},this.IsVirtualNodeSelected=function(t){return this.FSelectedNodes.IndexOf(t)>-1},rtl.addIntf(this,pas["WEBLib.TMSFNCGraphicsTypes"].ITMSFNCAppearanceGlobalFont),rtl.addIntf(this,pas["WEBLib.TMSFNCBitmapContainer"].ITMSFNCBitmapContainer),rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas["WEBLib.TMSFNCTypes"].ITMSFNCProductInfo),rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TTMSFNCTreeViewPublished",this.TTMSFNCCustomTreeView,(function(){rtl.addIntf(this,pas["WEBLib.TMSFNCGraphicsTypes"].ITMSFNCAppearanceGlobalFont),rtl.addIntf(this,pas["WEBLib.TMSFNCBitmapContainer"].ITMSFNCBitmapContainer),rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas["WEBLib.TMSFNCTypes"].ITMSFNCProductInfo),rtl.addIntf(this,pas.System.IUnknown);var e=this.$rtti;e.addProperty("Fill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FFill","SetFill"),e.addProperty("Stroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FStroke","SetStroke"),e.addProperty("BitmapContainer",3,pas["WEBLib.TMSFNCBitmapContainer"].$rtti.TTMSFNCBitmapContainer,"GetBitmapContainer","SetBitmapContainer"),e.addProperty("HorizontalScrollBarVisible",2,rtl.boolean,"FHorizontalScrollBarVisible","SetHorizontalScrollBarVisible",{Default:!0}),e.addProperty("VerticalScrollBarVisible",2,rtl.boolean,"FVerticalScrollBarVisible","SetVerticalScrollBarVisible",{Default:!0}),e.addProperty("Groups",2,pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewGroups,"FGroups","SetGroups"),e.addProperty("GroupsAppearance",2,t.$rtti.TTMSFNCTreeViewGroupsAppearance,"FGroupsAppearance","SetGroupsAppearance"),e.addProperty("ColumnStroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FColumnStroke","SetColumnStroke"),e.addProperty("Columns",2,pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewColumns,"FColumns","SetColumns"),e.addProperty("Nodes",2,pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewNodes,"FNodes","SetNodes"),e.addProperty("ColumnsAppearance",2,t.$rtti.TTMSFNCTreeViewColumnsAppearance,"FColumnsAppearance","SetColumnsAppearance"),e.addProperty("NodesAppearance",2,t.$rtti.TTMSFNCTreeViewNodesAppearance,"FNodesAppearance","SetNodesAppearance"),e.addProperty("Interaction",2,t.$rtti.TTMSFNCTreeViewInteraction,"FInteraction","SetInteraction"),e.addProperty("StretchScrollBars",2,rtl.boolean,"FStretchScrollBars","SetStretchScrollBars",{Default:!0}),e.addProperty("Version",1,rtl.string,"GetVersion",""),e.addProperty("PopupMenu",0,pas["WEBLib.Menus"].$rtti.TPopupMenu,"FPopupMenu","FPopupMenu"),e.addProperty("GlobalFont",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCAppearanceGlobalFont,"FGlobalFont","SetGlobalFont"),e.addProperty("OnNeedFilterDropDownData",0,t.$rtti.TTMSFNCTreeViewNeedFilterDropDownDataEvent,"FOnNeedFilterDropDownData","FOnNeedFilterDropDownData"),e.addProperty("OnFilterSelect",0,t.$rtti.TTMSFNCTreeViewFilterSelectEvent,"FOnFilterSelect","FOnFilterSelect"),e.addProperty("OnBeforeDrawColumn",0,t.$rtti.TTMSFNCTreeViewBeforeDrawColumnEvent,"FOnBeforeDrawColumn","FOnBeforeDrawColumn"),e.addProperty("OnAfterDrawColumn",0,t.$rtti.TTMSFNCTreeViewAfterDrawColumnEvent,"FOnAfterDrawColumn","FOnAfterDrawColumn"),e.addProperty("OnBeforeDrawColumnHeader",0,t.$rtti.TTMSFNCTreeViewBeforeDrawColumnHeaderEvent,"FOnBeforeDrawColumnHeader","FOnBeforeDrawColumnHeader"),e.addProperty("OnAfterDrawColumnHeader",0,t.$rtti.TTMSFNCTreeViewAfterDrawColumnHeaderEvent,"FOnAfterDrawColumnHeader","FOnAfterDrawColumnHeader"),e.addProperty("OnBeforeDrawNodeColumn",0,t.$rtti.TTMSFNCTreeViewBeforeDrawColumnEvent,"FOnBeforeDrawNodeColumn","FOnBeforeDrawNodeColumn"),e.addProperty("OnAfterDrawNodeColumn",0,t.$rtti.TTMSFNCTreeViewAfterDrawColumnEvent,"FOnAfterDrawNodeColumn","FOnAfterDrawNodeColumn"),e.addProperty("OnBeforeSortNodes",0,t.$rtti.TTMSFNCTreeViewBeforeSortNodesEvent,"FOnBeforeSortNodes","FOnBeforeSortNodes"),e.addProperty("OnAfterSortNodes",0,t.$rtti.TTMSFNCTreeViewAfterSortNodesEvent,"FOnAfterSortNodes","FOnAfterSortNodes"),e.addProperty("OnBeforeDrawGroup",0,t.$rtti.TTMSFNCTreeViewBeforeDrawGroupEvent,"FOnBeforeDrawGroup","FOnBeforeDrawGroup"),e.addProperty("OnAfterDrawGroup",0,t.$rtti.TTMSFNCTreeViewAfterDrawGroupEvent,"FOnAfterDrawGroup","FOnAfterDrawGroup"),e.addProperty("OnBeforeDrawNode",0,t.$rtti.TTMSFNCTreeViewBeforeDrawNodeEvent,"FOnBeforeDrawNode","FOnBeforeDrawNode"),e.addProperty("OnAfterDrawNode",0,t.$rtti.TTMSFNCTreeViewAfterDrawNodeEvent,"FOnAfterDrawNode","FOnAfterDrawNode"),e.addProperty("OnBeforeDrawColumnText",0,t.$rtti.TTMSFNCTreeViewBeforeDrawColumnTextEvent,"FOnBeforeDrawColumnText","FOnBeforeDrawColumnText"),e.addProperty("OnGetColumnText",0,t.$rtti.TTMSFNCTreeViewGetColumnTextEvent,"FOnGetColumnText","FOnGetColumnText"),e.addProperty("OnNodeCompare",0,t.$rtti.TTMSFNCTreeViewNodeCompareEvent,"FOnNodeCompare","FOnNodeCompare"),e.addProperty("OnAfterDrawColumnText",0,t.$rtti.TTMSFNCTreeViewAfterDrawColumnTextEvent,"FOnAfterDrawColumnText","FOnAfterDrawColumnText"),e.addProperty("OnBeforeDrawGroupText",0,t.$rtti.TTMSFNCTreeViewBeforeDrawGroupTextEvent,"FOnBeforeDrawGroupText","FOnBeforeDrawGroupText"),e.addProperty("OnGetGroupText",0,t.$rtti.TTMSFNCTreeViewGetGroupTextEvent,"FOnGetGroupText","FOnGetGroupText"),e.addProperty("OnAfterDrawGroupText",0,t.$rtti.TTMSFNCTreeViewAfterDrawGroupTextEvent,"FOnAfterDrawGroupText","FOnAfterDrawGroupText"),e.addProperty("OnBeforeDrawNodeText",0,t.$rtti.TTMSFNCTreeViewBeforeDrawNodeTextEvent,"FOnBeforeDrawNodeText","FOnBeforeDrawNodeText"),e.addProperty("OnAfterDrawNodeIcon",0,t.$rtti.TTMSFNCTreeViewAfterDrawNodeIconEvent,"FOnAfterDrawNodeIcon","FOnAfterDrawNodeIcon"),e.addProperty("OnAfterDrawNodeExpand",0,t.$rtti.TTMSFNCTreeViewAfterDrawNodeExpandEvent,"FOnAfterDrawNodeExpand","FOnAfterDrawNodeExpand"),e.addProperty("OnBeforeDrawNodeIcon",0,t.$rtti.TTMSFNCTreeViewBeforeDrawNodeIconEvent,"FOnBeforeDrawNodeIcon","FOnBeforeDrawNodeIcon"),e.addProperty("OnBeforeDrawNodeExpand",0,t.$rtti.TTMSFNCTreeViewBeforeDrawNodeExpandEvent,"FOnBeforeDrawNodeExpand","FOnBeforeDrawNodeExpand"),e.addProperty("OnAfterDrawNodeCheck",0,t.$rtti.TTMSFNCTreeViewAfterDrawNodeCheckEvent,"FOnAfterDrawNodeCheck","FOnAfterDrawNodeCheck"),e.addProperty("OnBeforeDrawNodeCheck",0,t.$rtti.TTMSFNCTreeViewBeforeDrawNodeCheckEvent,"FOnBeforeDrawNodeCheck","FOnBeforeDrawNodeCheck"),e.addProperty("OnGetNodeCheckType",0,t.$rtti.TTMSFNCTreeViewGetNodeCheckTypeEvent,"FOnGetNodeCheckType","FOnGetNodeCheckType"),e.addProperty("OnGetNodeText",0,t.$rtti.TTMSFNCTreeViewGetNodeTextEvent,"FOnGetNodeText","FOnGetNodeText"),e.addProperty("OnGetNodeData",0,t.$rtti.TTMSFNCTreeViewGetNodeDataEvent,"FOnGetNodeData","FOnGetNodeData"),e.addProperty("OnBeforeSizeColumn",0,t.$rtti.TTMSFNCTreeViewBeforeSizeColumnEvent,"FOnBeforeSizeColumn","FOnBeforeSizeColumn"),e.addProperty("OnAfterSizeColumn",0,t.$rtti.TTMSFNCTreeViewAfterSizeColumnEvent,"FOnAfterSizeColumn","FOnAfterSizeColumn"),e.addProperty("OnGetNodeTrimming",0,t.$rtti.TTMSFNCTreeViewGetNodeTrimmingEvent,"FOnGetNodeTrimming","FOnGetNodeTrimming"),e.addProperty("OnGetNodeWordWrapping",0,t.$rtti.TTMSFNCTreeViewGetNodeWordWrappingEvent,"FOnGetNodeWordWrapping","FOnGetNodeWordWrapping"),e.addProperty("OnGetNodeHorizontalTextAlign",0,t.$rtti.TTMSFNCTreeViewGetNodeHorizontalTextAlignEvent,"FOnGetNodeHorizontalTextAlign","FOnGetNodeHorizontalTextAlign"),e.addProperty("OnGetNodeVerticalTextAlign",0,t.$rtti.TTMSFNCTreeViewGetNodeVerticalTextAlignEvent,"FOnGetNodeVerticalTextAlign","FOnGetNodeVerticalTextAlign"),e.addProperty("OnGetColumnTrimming",0,t.$rtti.TTMSFNCTreeViewGetColumnTrimmingEvent,"FOnGetColumnTrimming","FOnGetColumnTrimming"),e.addProperty("OnFocusedNodeChanged",0,t.$rtti.TTMSFNCTreeViewFocusedNodeChangedEvent,"FOnFocusedNodeChanged","FOnFocusedNodeChanged"),e.addProperty("OnGetColumnWordWrapping",0,t.$rtti.TTMSFNCTreeViewGetColumnWordWrappingEvent,"FOnGetColumnWordWrapping","FOnGetColumnWordWrapping"),e.addProperty("OnGetColumnHorizontalTextAlign",0,t.$rtti.TTMSFNCTreeViewGetColumnHorizontalTextAlignEvent,"FOnGetColumnHorizontalTextAlign","FOnGetColumnHorizontalTextAlign"),e.addProperty("OnGetColumnVerticalTextAlign",0,t.$rtti.TTMSFNCTreeViewGetColumnVerticalTextAlignEvent,"FOnGetColumnVerticalTextAlign","FOnGetColumnVerticalTextAlign"),e.addProperty("OnBeforeUnCheckNode",0,t.$rtti.TTMSFNCTreeViewBeforeUnCheckNodeEvent,"FOnBeforeUnCheckNode","FOnBeforeUnCheckNode"),e.addProperty("OnAfterUnCheckNode",0,t.$rtti.TTMSFNCTreeViewAfterUnCheckNodeEvent,"FOnAfterUnCheckNode","FOnAfterUnCheckNode"),e.addProperty("OnBeforeCheckNode",0,t.$rtti.TTMSFNCTreeViewBeforeCheckNodeEvent,"FOnBeforeCheckNode","FOnBeforeCheckNode"),e.addProperty("OnAfterCheckNode",0,t.$rtti.TTMSFNCTreeViewAfterCheckNodeEvent,"FOnAfterCheckNode","FOnAfterCheckNode"),e.addProperty("OnBeforeCollapseNode",0,t.$rtti.TTMSFNCTreeViewBeforeCollapseNodeEvent,"FOnBeforeCollapseNode","FOnBeforeCollapseNode"),e.addProperty("OnAfterCollapseNode",0,t.$rtti.TTMSFNCTreeViewAfterCollapseNodeEvent,"FOnAfterCollapseNode","FOnAfterCollapseNode"),e.addProperty("OnBeforeExpandNode",0,t.$rtti.TTMSFNCTreeViewBeforeExpandNodeEvent,"FOnBeforeExpandNode","FOnBeforeExpandNode"),e.addProperty("OnAfterExpandNode",0,t.$rtti.TTMSFNCTreeViewAfterExpandNodeEvent,"FOnAfterExpandNode","FOnAfterExpandNode"),e.addProperty("OnGetNodeIcon",0,t.$rtti.TTMSFNCTreeViewGetNodeIconEvent,"FOnGetNodeIcon","FOnGetNodeIcon"),e.addProperty("OnGetNodeIconSize",0,t.$rtti.TTMSFNCTreeViewGetNodeIconSizeEvent,"FOnGetNodeIconSize","FOnGetNodeIconSize"),e.addProperty("OnGetNumberOfNodes",0,t.$rtti.TTMSFNCTreeViewGetNumberOfNodesEvent,"FOnGetNumberOfNodes","FOnGetNumberOfNodes"),e.addProperty("OnIsNodeExtended",0,t.$rtti.TTMSFNCTreeViewIsNodeExtendedEvent,"FOnIsNodeExtended","FOnIsNodeExtended"),e.addProperty("OnIsNodeExpanded",0,t.$rtti.TTMSFNCTreeViewIsNodeExpandedEvent,"FOnIsNodeExpanded","FOnIsNodeExpanded"),e.addProperty("OnAfterDrawNodeText",0,t.$rtti.TTMSFNCTreeViewAfterDrawNodeTextEvent,"FOnAfterDrawNodeText","FOnAfterDrawNodeText"),e.addProperty("OnIsNodeChecked",0,t.$rtti.TTMSFNCTreeViewIsNodeCheckedEvent,"FOnIsNodeChecked","FOnIsNodeChecked"),e.addProperty("OnNodeAnchorClick",0,t.$rtti.TTMSFNCTreeViewNodeAnchorClickEvent,"FOnNodeAnchorClick","FOnNodeAnchorClick"),e.addProperty("OnBeforeUpdateNode",0,t.$rtti.TTMSFNCTreeViewBeforeUpdateNodeEvent,"FOnBeforeUpdateNode","FOnBeforeUpdateNode"),e.addProperty("OnAfterUpdateNode",0,t.$rtti.TTMSFNCTreeViewAfterUpdateNodeEvent,"FOnAfterUpdateNode","FOnAfterUpdateNode"),e.addProperty("OnBeforeSelectNode",0,t.$rtti.TTMSFNCTreeViewBeforeSelectNodeEvent,"FOnBeforeSelectNode","FOnBeforeSelectNode"),e.addProperty("OnAfterSelectNode",0,t.$rtti.TTMSFNCTreeViewAfterSelectNodeEvent,"FOnAfterSelectNode","FOnAfterSelectNode"),e.addProperty("OnBeforeSelectAllNodes",0,t.$rtti.TTMSFNCTreeViewBeforeSelectAllNodesEvent,"FOnBeforeSelectAllNodes","FOnBeforeSelectAllNodes"),e.addProperty("OnAfterSelectAllNodes",0,t.$rtti.TTMSFNCTreeViewAfterSelectAllNodesEvent,"FOnAfterSelectAllNodes","FOnAfterSelectAllNodes"),e.addProperty("OnNodeClick",0,t.$rtti.TTMSFNCTreeViewNodeClickEvent,"FOnNodeClick","FOnNodeClick"),e.addProperty("OnNodeMouseLeave",0,t.$rtti.TTMSFNCTreeViewNodeMouseLeaveEvent,"FOnNodeMouseLeave","FOnNodeMouseLeave"),e.addProperty("OnNodeMouseEnter",0,t.$rtti.TTMSFNCTreeViewNodeMouseEnterEvent,"FOnNodeMouseEnter","FOnNodeMouseEnter"),e.addProperty("OnNodeDblClick",0,t.$rtti.TTMSFNCTreeViewNodeClickEvent,"FOnNodeDblClick","FOnNodeDblClick"),e.addProperty("OnBeforeUnSelectNode",0,t.$rtti.TTMSFNCTreeViewBeforeUnSelectNodeEvent,"FOnBeforeUnSelectNode","FOnBeforeUnSelectNode"),e.addProperty("OnAfterUnSelectNode",0,t.$rtti.TTMSFNCTreeViewAfterUnSelectNodeEvent,"FOnAfterUnSelectNode","FOnAfterUnSelectNode"),e.addProperty("OnGetNodeSides",0,t.$rtti.TTMSFNCTreeViewGetNodeSidesEvent,"FOnGetNodeSides","FOnGetNodeSides"),e.addProperty("OnBeforeOpenInplaceEditor",0,t.$rtti.TTMSFNCTreeViewBeforeOpenInplaceEditorEvent,"FOnBeforeOpenInplaceEditor","FOnBeforeOpenInplaceEditor"),e.addProperty("OnCloseInplaceEditor",0,t.$rtti.TTMSFNCTreeViewCloseInplaceEditorEvent,"FOnCloseInplaceEditor","FOnCloseInplaceEditor"),e.addProperty("OnAfterOpenInplaceEditor",0,t.$rtti.TTMSFNCTreeViewAfterOpenInplaceEditorEvent,"FOnAfterOpenInplaceEditor","FOnAfterOpenInplaceEditor"),e.addProperty("OnGetInplaceEditor",0,t.$rtti.TTMSFNCTreeViewGetInplaceEditorEvent,"FOnGetInplaceEditor","FOnGetInplaceEditor"),e.addProperty("OnCustomizeInplaceEditor",0,t.$rtti.TTMSFNCTreeViewCustomizeInplaceEditorEvent,"FOnCustomizeInplaceEditor","FOnCustomizeInplaceEditor"),e.addProperty("OnGetInplaceEditorRect",0,t.$rtti.TTMSFNCTreeViewGetInplaceEditorRectEvent,"FOnGetInplaceEditorRect","FOnGetInplaceEditorRect"),e.addProperty("OnNodeChanged",0,t.$rtti.TTMSFNCTreeViewNodeChangedEvent,"FOnNodeChanged","FOnNodeChanged"),e.addProperty("OnHScroll",0,t.$rtti.TTMSFNCTreeViewScrollEvent,"FOnHScroll","FOnHScroll"),e.addProperty("OnVScroll",0,t.$rtti.TTMSFNCTreeViewScrollEvent,"FOnVScroll","FOnVScroll"),e.addProperty("OnBeforeDrawColumnEmptySpace",0,t.$rtti.TTMSFNCTreeViewBeforeDrawColumnEmptySpaceEvent,"FOnBeforeDrawColumnEmptySpace","FOnBeforeDrawColumnEmptySpace"),e.addProperty("OnAfterDrawColumnEmptySpace",0,t.$rtti.TTMSFNCTreeViewAfterDrawColumnEmptySpaceEvent,"FOnAfterDrawColumnEmptySpace","FOnAfterDrawColumnEmptySpace"),e.addProperty("OnBeforeDrawGroupEmptySpace",0,t.$rtti.TTMSFNCTreeViewBeforeDrawGroupEmptySpaceEvent,"FOnBeforeDrawGroupEmptySpace","FOnBeforeDrawGroupEmptySpace"),e.addProperty("OnAfterDrawGroupEmptySpace",0,t.$rtti.TTMSFNCTreeViewAfterDrawGroupEmptySpaceEvent,"FOnAfterDrawGroupEmptySpace","FOnAfterDrawGroupEmptySpace"),e.addProperty("OnIsNodeEnabled",0,t.$rtti.TTMSFNCTreeViewIsNodeEnabledEvent,"FOnIsNodeEnabled","FOnIsNodeEnabled"),e.addProperty("OnGetNodeColor",0,t.$rtti.TTMSFNCTreeViewGetNodeColorEvent,"FOnGetNodeColor","FOnGetNodeColor"),e.addProperty("OnGetNodeSelectedColor",0,t.$rtti.TTMSFNCTreeViewGetNodeColorEvent,"FOnGetNodeSelectedStrokeColor","FOnGetNodeSelectedStrokeColor"),e.addProperty("OnGetNodeDisabledColor",0,t.$rtti.TTMSFNCTreeViewGetNodeColorEvent,"FOnGetNodeDisabledColor","FOnGetNodeDisabledColor"),e.addProperty("OnGetNodeTextColor",0,t.$rtti.TTMSFNCTreeViewGetNodeTextColorEvent,"FOnGetNodeTextColor","FOnGetNodeTextColor"),e.addProperty("OnGetNodeSelectedTextColor",0,t.$rtti.TTMSFNCTreeViewGetNodeTextColorEvent,"FOnGetNodeSelectedTextColor","FOnGetNodeSelectedTextColor"),e.addProperty("OnGetNodeDisabledTextColor",0,t.$rtti.TTMSFNCTreeViewGetNodeTextColorEvent,"FOnGetNodeDisabledTextColor","FOnGetNodeDisabledTextColor"),e.addProperty("OnGetNodeHeight",0,t.$rtti.TTMSFNCTreeViewGetNodeHeightEvent,"FOnGetNodeHeight","FOnGetNodeHeight"),e.addProperty("OnBeforeReorderNode",0,t.$rtti.TTMSFNCTreeViewBeforeReorderNodeEvent,"FOnBeforeReorderNode","FOnBeforeReorderNode"),e.addProperty("OnAfterReorderNode",0,t.$rtti.TTMSFNCTreeViewAfterReorderNodeEvent,"FOnAfterReorderNode","FOnAfterReorderNode"),e.addProperty("OnBeforeDropNode",0,t.$rtti.TTMSFNCTreeViewBeforeDropNodeEvent,"FOnBeforeDropNode","FOnBeforeDropNode"),e.addProperty("OnAfterDropNode",0,t.$rtti.TTMSFNCTreeViewAfterDropNodeEvent,"FOnAfterDropNode","FOnAfterDropNode"),e.addProperty("OnBeforeCutToClipboard",0,t.$rtti.TTMSFNCTreeViewBeforeCutToClipboardEvent,"FOnBeforeCutToClipboard","FOnBeforeCutToClipboard"),e.addProperty("OnBeforeCopyToClipboard",0,t.$rtti.TTMSFNCTreeViewBeforeCopyToClipboardEvent,"FOnBeforeCopyToClipboard","FOnBeforeCopyToClipboard"),e.addProperty("OnBeforePasteFromClipboard",0,t.$rtti.TTMSFNCTreeViewBeforePasteFromClipboardEvent,"FOnBeforePasteFromClipboard","FOnBeforePasteFromClipboard"),e.addProperty("OnAfterCutToClipboard",0,t.$rtti.TTMSFNCTreeViewAfterCutToClipboardEvent,"FOnAfterCutToClipboard","FOnAfterCutToClipboard"),e.addProperty("OnAfterCopyToClipboard",0,t.$rtti.TTMSFNCTreeViewAfterCopyToClipboardEvent,"FOnAfterCopyToClipboard","FOnAfterCopyToClipboard"),e.addProperty("OnAfterPasteFromClipboard",0,t.$rtti.TTMSFNCTreeViewAfterPasteFromClipboardEvent,"FOnAfterPasteFromClipboard","FOnAfterPasteFromClipboard"),e.addProperty("OnBeforeDrawSortIndicator",0,t.$rtti.TTMSFNCTreeViewBeforeDrawSortIndicatorEvent,"FOnBeforeDrawSortIndicator","FOnBeforeDrawSortIndicator"),e.addProperty("OnAfterDrawSortIndicator",0,t.$rtti.TTMSFNCTreeViewAfterDrawSortIndicatorEvent,"FOnAfterDrawSortIndicator","FOnAfterDrawSortIndicator"),e.addProperty("OnColumnAnchorClick",0,t.$rtti.TTMSFNCTreeViewColumnAnchorClickEvent,"FOnColumnAnchorClick","FOnColumnAnchorClick"),e.addProperty("OnBeforeAddJSONNode",0,t.$rtti.TTMSFNCTreeViewBeforeAddJSONNodeEvent,"FOnBeforeAddJSONNode","FOnBeforeAddJSONNode"),e.addProperty("OnAfterAddJSONNode",0,t.$rtti.TTMSFNCTreeViewAfterAddJSONNodeEvent,"FOnAfterAddJSONNode","FOnAfterAddJSONNode"),e.addProperty("DefaultViewJSONOptions",2,t.$rtti.TTMSFNCTreeViewViewJSONOptions,"FDefaultViewJSONOptions","SetDefaultViewJSONOptions"),e.addProperty("OnGetHTMLTemplateValue",0,t.$rtti.TTMSFNCTreeViewGetHTMLTemplateValueEvent,"FOnGetHTMLTemplateValue","FOnGetHTMLTemplateValue"),e.addProperty("OnGetHTMLTemplate",0,t.$rtti.TTMSFNCTreeViewGetHTMLTemplateEvent,"FOnGetHTMLTemplate","FOnGetHTMLTemplate")})),this.TTMSFNCTREEVIEWEXPAND="data:image/PNG;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAALCAIAAAAmzuBxAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAAYdEVYdFNvZnR3YXJlAHBhaW50Lm5ldCA0LjAuNvyMY98AAAAySURBVChTY6iurcaPQCr+4wZYVHj5ekFZYEBdFUAJTISiAg4gEnBAIxVoAKoCH6qtBgAs4hCpNRg4EQAAAABJRU5ErkJggg==",this.TTMSFNCTREEVIEWCOLLAPSE="data:image/PNG;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAALCAIAAAAmzuBxAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAAYdEVYdFNvZnR3YXJlAHBhaW50Lm5ldCA0LjAuNvyMY98AAAAmSURBVChTY6iurcaPQCr+4wYDoMLL1wsZQQRJNAMroKIKfKi2GgCBNiGJV4wrvQAAAABJRU5ErkJggg==",this.TTMSFNCTREEVIEWEXPANDLARGE="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABYAAAAWCAIAAABL1vtsAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAAYdEVYdFNvZnR3YXJlAHBhaW50Lm5ldCA0LjAuNvyMY98AAABDSURBVDhPY6iuraYQUc+I/2QBehnh5esFRFAOBhg1AgFoYwREAzEIop42RmACZA2YYNQIBKCXEfgBtY2gBFFsRG01AN+TQqHfgmnlAAAAAElFTkSuQmCC",this.TTMSFNCTREEVIEWCOLLAPSELARGE="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABYAAAAWCAIAAABL1vtsAAAABGdBTUEAALGPC/xhBQAAAAlwSFlzAAAOwgAADsIBFShKgAAAABh0RVh0U29mdHdhcmUAcGFpbnQubmV0IDQuMC42/Ixj3wAAADRJREFUOE9jqK6tphBRz4j/ZIFRIxBg+Bvh5euFB0EVgQEtjSAejBqBAMPTCEoQxUbUVgMAPoCGIXvOpikAAAAASUVORK5CYII=",t.$resourcestrings={sTMSFNCTreeViewFilterAll:{org:"(All)"}},t.$implcode=function(){rtl.createClass(e,"TTMSFNCTreeViewGroupOpen",pas["WEBLib.TMSFNCTreeViewData"].TTMSFNCTreeViewGroup,(function(){})),rtl.createClass(e,"TTMSFNCTreeViewNodeOpen",pas["WEBLib.TMSFNCTreeViewData"].TTMSFNCTreeViewNode,(function(){})),rtl.createClass(e,"TTMSFNCTreeViewColumnOpen",pas["WEBLib.TMSFNCTreeViewData"].TTMSFNCTreeViewColumn,(function(){})),rtl.createClass(e,"TTMSFNCTreeViewVirtualNodeOpen",pas["WEBLib.TMSFNCTreeViewData"].TTMSFNCTreeViewVirtualNode,(function(){})),e.GetTickCountX=function(){var t=0,e=0,i=0,s=0;return pas.SysUtils.DecodeTime(pas.SysUtils.Now(),{get:function(){return t},set:function(e){t=e}},{get:function(){return e},set:function(t){e=t}},{get:function(){return i},set:function(t){i=t}},{get:function(){return s},set:function(t){s=t}}),s+1e3*i+60*e*1e3+60*t*60*1e3},e.AnimateDouble=function(t,e,i,s){var o=!1;return o=!0,t.get()>e.get()-s&&t.get()<e.get()+s?(t.set(e.get()),o=!1):(i=Math.max(s,i),t.get()<e.get()?t.set(t.get()+i):t.set(t.get()-i)),o}},t.$init=function(){pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.CreateFromResource(t.TTMSFNCTREEVIEWEXPAND),pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.CreateFromResource(t.TTMSFNCTREEVIEWEXPANDLARGE),pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.CreateFromResource(t.TTMSFNCTREEVIEWCOLLAPSE),pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.CreateFromResource(t.TTMSFNCTREEVIEWCOLLAPSELARGE)}}),["SysUtils","Math","WEBLib.TMSFNCTreeViewBase","WEBLib.TMSFNCUtils","WEBLib.TMSFNCStyles","WEBLib.Forms","WEBLib.Graphics"]),rtl.module("WEBLib.TMSFNCCustomSelector",["System","Classes","WEBLib.TMSFNCTypes","WEBLib.TMSFNCGraphics","WEBLib.TMSFNCGraphicsTypes","WEBLib.TMSFNCCustomControl","WEBLib.Controls"],(function(){"use strict";var t=this;this.MAJ_VER=1,this.MIN_VER=0,this.REL_VER=1,this.BLD_VER=0,rtl.createClass(this,"TTMSFNCCustomSelectorItem",pas.Classes.TCollectionItem,(function(){this.$init=function(){pas.Classes.TCollectionItem.$init.call(this),this.FOwner=null,this.FRowSpan=0,this.FColumnSpan=0,this.FVisible=!1,this.FText="",this.FEnabled=!1,this.FSeparator=!1,this.FSeparatorHeight=0,this.FMargins=null,this.FCanDeselect=!1,this.FCanSelect=!1,this.FVerticalTextAlign=0,this.FHorizontalTextAlign=0,this.FHint="",this.FDataBoolean=!1},this.$final=function(){this.FOwner=void 0,this.FMargins=void 0,pas.Classes.TCollectionItem.$final.call(this)},this.SetColumnSpan=function(t){this.FColumnSpan!==t&&(this.FColumnSpan=t,this.FOwner.CalculateItems())},this.SetRowSpan=function(t){this.FRowSpan!==t&&(this.FRowSpan=t,this.FOwner.CalculateItems())},this.SetVisible=function(t){this.FVisible!==t&&(this.FVisible=t,this.FOwner.CalculateItems())},this.SetText=function(t){this.FText!==t&&(this.FText=t,this.FOwner.InvalidateItems())},this.SetEnabled=function(t){this.FEnabled!==t&&(this.FEnabled=t,this.FOwner.InvalidateItems())},this.SetSeparator=function(t){this.FSeparator!==t&&(this.FSeparator=t,this.FOwner.CalculateItems())},this.SetSeparatorHeight=function(t){this.FSeparatorHeight!==t&&(this.FSeparatorHeight=t,this.FOwner.InvalidateItems())},this.SetMargins=function(t){this.FMargins.Assign(t)},this.SetCanDeselect=function(t){this.FCanDeselect=t},this.SetCanSelect=function(t){this.FCanSelect=t},this.SetHorizontalTextAlign=function(t){this.FHorizontalTextAlign!==t&&(this.FHorizontalTextAlign=t,this.FOwner.InvalidateItems())},this.SetVerticalTextAlign=function(t){this.FVerticalTextAlign!==t&&(this.FVerticalTextAlign=t,this.FOwner.InvalidateItems())},this.IsSeparatorHeightStored=function(){return 5!==this.FSeparatorHeight},this.MarginsChanged=function(t){this.FOwner.CalculateItems()},this.Create$1=function(e){return pas.Classes.TCollectionItem.Create$1.apply(this,arguments),null!=this.FCollection&&(this.FOwner=rtl.as(this.FCollection,t.TTMSFNCCustomSelectorItems).FOwner$1),this.FSeparator=!1,this.FColumnSpan=1,this.FCanDeselect=!0,this.FCanSelect=!0,this.FRowSpan=1,this.FMargins=pas["WEBLib.TMSFNCTypes"].TTMSFNCMargins.$create("Create$1"),this.FMargins.FOnChange=rtl.createCallback(this,"MarginsChanged"),this.FEnabled=!0,this.FSeparatorHeight=5,this.FVisible=!0,null!=this.FOwner&&this.FOwner.CalculateItems(),this},this.Assign=function(e){t.TTMSFNCCustomSelectorItem.isPrototypeOf(e)&&(this.FRowSpan=rtl.as(e,t.TTMSFNCCustomSelectorItem).FRowSpan,this.FColumnSpan=rtl.as(e,t.TTMSFNCCustomSelectorItem).FColumnSpan,this.FVisible=rtl.as(e,t.TTMSFNCCustomSelectorItem).FVisible,this.FText=rtl.as(e,t.TTMSFNCCustomSelectorItem).FText,this.FEnabled=rtl.as(e,t.TTMSFNCCustomSelectorItem).FEnabled,this.FSeparator=rtl.as(e,t.TTMSFNCCustomSelectorItem).FSeparator,this.FSeparatorHeight=rtl.as(e,t.TTMSFNCCustomSelectorItem).FSeparatorHeight,this.FMargins.Assign(rtl.as(e,t.TTMSFNCCustomSelectorItem).FMargins),this.FCanDeselect=rtl.as(e,t.TTMSFNCCustomSelectorItem).FCanDeselect,this.FCanSelect=rtl.as(e,t.TTMSFNCCustomSelectorItem).FCanSelect,this.FHint=rtl.as(e,t.TTMSFNCCustomSelectorItem).FHint)},this.Destroy=function(){rtl.free(this,"FMargins"),pas.Classes.TCollectionItem.Destroy.call(this),null!=this.FOwner&&this.FOwner.CalculateItems()};var e=this.$rtti;e.addProperty("CanSelect",2,rtl.boolean,"FCanSelect","SetCanSelect",{Default:!0}),e.addProperty("CanDeselect",2,rtl.boolean,"FCanDeselect","SetCanDeselect",{Default:!0}),e.addProperty("ColumnSpan",2,rtl.longint,"FColumnSpan","SetColumnSpan",{Default:1}),e.addProperty("RowSpan",2,rtl.longint,"FRowSpan","SetRowSpan",{Default:1}),e.addProperty("Visible",2,rtl.boolean,"FVisible","SetVisible",{Default:!0}),e.addProperty("Enabled",2,rtl.boolean,"FEnabled","SetEnabled",{Default:!0}),e.addProperty("Separator",2,rtl.boolean,"FSeparator","SetSeparator",{Default:!1}),e.addProperty("SeparatorHeight",14,rtl.double,"FSeparatorHeight","SetSeparatorHeight",{stored:"IsSeparatorHeightStored"}),e.addProperty("Margins",2,pas["WEBLib.TMSFNCTypes"].$rtti.TTMSFNCMargins,"FMargins","SetMargins"),e.addProperty("Text",2,rtl.string,"FText","SetText"),e.addProperty("HorizontalTextAlign",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsTextAlign,"FHorizontalTextAlign","SetHorizontalTextAlign",{Default:pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsTextAlign.gtaCenter}),e.addProperty("VerticalTextAlign",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsTextAlign,"FVerticalTextAlign","SetVerticalTextAlign",{Default:pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsTextAlign.gtaCenter}),e.addProperty("Hint",0,rtl.string,"FHint","FHint")})),rtl.createClass(this,"TTMSFNCCustomSelectorItems",pas["WEBLib.TMSFNCTypes"].TTMSFNCOwnedCollection,(function(){this.$init=function(){pas["WEBLib.TMSFNCTypes"].TTMSFNCOwnedCollection.$init.call(this),this.FOwner$1=null},this.$final=function(){this.FOwner$1=void 0,pas["WEBLib.TMSFNCTypes"].TTMSFNCOwnedCollection.$final.call(this)},this.GetItem$1=function(t){return this.GetItem(t)},this.CreateItemClass=function(){return t.TTMSFNCCustomSelectorItem},this.GetOwner=function(){return this.FOwner$1},this.Create$3=function(t){return pas.Classes.TOwnedCollection.Create$2.call(this,t,this.CreateItemClass()),this.FOwner$1=t,this},this.Add$1=function(){return pas.Classes.TCollection.Add.call(this)},this.Insert$1=function(t){return pas.Classes.TCollection.Insert.call(this,t)}})),rtl.createClass(this,"TTMSFNCCustomSelectorAppearance",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FOwner=null,this.FStrokeHover=null,this.FFillDown=null,this.FVerticalSpacing=0,this.FStrokeDown=null,this.FFillSelected=null,this.FHorizontalSpacing=0,this.FStrokeSelected=null,this.FFill=null,this.FFillHover=null,this.FStroke=null,this.FFillDisabled=null,this.FStrokeDisabled=null,this.FSeparatorStroke=null,this.FFont=null},this.$final=function(){this.FOwner=void 0,this.FStrokeHover=void 0,this.FFillDown=void 0,this.FStrokeDown=void 0,this.FFillSelected=void 0,this.FStrokeSelected=void 0,this.FFill=void 0,this.FFillHover=void 0,this.FStroke=void 0,this.FFillDisabled=void 0,this.FStrokeDisabled=void 0,this.FSeparatorStroke=void 0,this.FFont=void 0,pas.Classes.TPersistent.$final.call(this)},this.SetFill=function(t){this.FFill.Assign(t)},this.SetFillDown=function(t){this.FFillDown.Assign(t)},this.SetFillHover=function(t){this.FFillHover.Assign(t)},this.SetFillSelected=function(t){this.FFillSelected.Assign(t)},this.SetHorizontalSpacing=function(t){this.FHorizontalSpacing!==t&&(this.FHorizontalSpacing=t,this.Changed())},this.SetStroke=function(t){this.FStroke.Assign(t)},this.SetStrokeDown=function(t){this.FStrokeDown.Assign(t)},this.SetStrokeHover=function(t){this.FStrokeHover.Assign(t)},this.SetStrokeSelected=function(t){this.FStrokeSelected.Assign(t)},this.SetVerticalSpacing=function(t){this.FVerticalSpacing!==t&&(this.FVerticalSpacing=t,this.Changed())},this.SetFillDisabled=function(t){this.FFillDisabled.Assign(t)},this.SetStrokeDisabled=function(t){this.FStrokeDisabled.Assign(t)},this.SetSeparatorStroke=function(t){this.FSeparatorStroke.Assign(t)},this.SetFont=function(t){this.FFont.AssignSource(t)},this.IsHorizontalSpacingStored=function(){return 4!==this.FHorizontalSpacing},this.IsVerticalSpacingStored=function(){return 4!==this.FVerticalSpacing},this.Changed=function(){this.FOwner.CalculateItems()},this.FontChanged=function(t){this.FOwner.InvalidateItems()},this.FillChanged=function(t){this.FOwner.InvalidateItems()},this.StrokeChanged=function(t){this.FOwner.InvalidateItems()},this.Create$1=function(t){return this.FOwner=t,this.FFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[1,16777215,8421504,-1,-1]),this.FFill.SetColor(pas["WEBLib.TMSFNCGraphicsTypes"].Lighter(13882323,50)),this.FFillHover=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[1,16777215,8421504,-1,-1]),this.FFillHover.SetColor(pas["WEBLib.TMSFNCGraphicsTypes"].Lighter(10061943,50)),this.FFillDown=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[1,16777215,8421504,-1,-1]),this.FFillDown.SetColor(pas["WEBLib.TMSFNCGraphicsTypes"].Lighter(9470064,50)),this.FFillSelected=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[1,16777215,8421504,-1,-1]),this.FFillSelected.SetColor(pas["WEBLib.TMSFNCGraphicsTypes"].Lighter(9470064,50)),this.FFillDisabled=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[1,16777215,8421504,-1,-1]),this.FFillDisabled.SetColor(pas["WEBLib.TMSFNCGraphicsTypes"].Lighter(8421504,50)),this.FStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,12632256]),this.FStroke.SetColor(11119017),this.FStrokeHover=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,12632256]),this.FStrokeHover.SetColor(10061943),this.FStrokeDown=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,12632256]),this.FStrokeDown.SetColor(9470064),this.FStrokeSelected=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,12632256]),this.FStrokeSelected.SetColor(5197615),this.FStrokeDisabled=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,12632256]),this.FStrokeDisabled.SetColor(11119017),this.FSeparatorStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,12632256]),this.FSeparatorStroke.SetColor(11119017),this.FFont=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFont.$create("Create$2"),this.FFont.FOnChanged=rtl.createCallback(this,"FontChanged"),this.FSeparatorStroke.FOnChanged=rtl.createCallback(this,"StrokeChanged"),this.FFont.FOnChanged=rtl.createCallback(this,"FontChanged"),this.FFill.FOnChanged=rtl.createCallback(this,"FillChanged"),this.FFillDown.FOnChanged=rtl.createCallback(this,"FillChanged"),this.FFillHover.FOnChanged=rtl.createCallback(this,"FillChanged"),this.FFillSelected.FOnChanged=rtl.createCallback(this,"FillChanged"),this.FFillDisabled.FOnChanged=rtl.createCallback(this,"FillChanged"),this.FStroke.FOnChanged=rtl.createCallback(this,"StrokeChanged"),this.FStrokeHover.FOnChanged=rtl.createCallback(this,"StrokeChanged"),this.FStrokeDown.FOnChanged=rtl.createCallback(this,"StrokeChanged"),this.FStrokeDisabled.FOnChanged=rtl.createCallback(this,"StrokeChanged"),this.FStrokeSelected.FOnChanged=rtl.createCallback(this,"StrokeChanged"),this.FHorizontalSpacing=4,this.FVerticalSpacing=4,this},this.Assign=function(e){t.TTMSFNCCustomSelectorAppearance.isPrototypeOf(e)&&(this.FFill.Assign(rtl.as(e,t.TTMSFNCCustomSelectorAppearance).FFill),this.FFillHover.Assign(rtl.as(e,t.TTMSFNCCustomSelectorAppearance).FFillHover),this.FFillSelected.Assign(rtl.as(e,t.TTMSFNCCustomSelectorAppearance).FFillSelected),this.FFillDisabled.Assign(rtl.as(e,t.TTMSFNCCustomSelectorAppearance).FFillDisabled),this.FFillDown.Assign(rtl.as(e,t.TTMSFNCCustomSelectorAppearance).FFillDown),this.FStroke.Assign(rtl.as(e,t.TTMSFNCCustomSelectorAppearance).FStroke),this.FStrokeHover.Assign(rtl.as(e,t.TTMSFNCCustomSelectorAppearance).FStrokeHover),this.FStrokeSelected.Assign(rtl.as(e,t.TTMSFNCCustomSelectorAppearance).FStrokeSelected),this.FStrokeDown.Assign(rtl.as(e,t.TTMSFNCCustomSelectorAppearance).FStrokeDown),this.FStrokeDisabled.Assign(rtl.as(e,t.TTMSFNCCustomSelectorAppearance).FStrokeDisabled),this.FVerticalSpacing=rtl.as(e,t.TTMSFNCCustomSelectorAppearance).FVerticalSpacing,this.FHorizontalSpacing=rtl.as(e,t.TTMSFNCCustomSelectorAppearance).FHorizontalSpacing,this.FSeparatorStroke.Assign(rtl.as(e,t.TTMSFNCCustomSelectorAppearance).FSeparatorStroke),this.FFont.AssignSource(rtl.as(e,t.TTMSFNCCustomSelectorAppearance).FFont))},this.Destroy=function(){rtl.free(this,"FFont"),rtl.free(this,"FFill"),rtl.free(this,"FFillDown"),rtl.free(this,"FFillSelected"),rtl.free(this,"FFillHover"),rtl.free(this,"FFillDisabled"),rtl.free(this,"FSeparatorStroke"),rtl.free(this,"FStroke"),rtl.free(this,"FStrokeDown"),rtl.free(this,"FStrokeSelected"),rtl.free(this,"FStrokeHover"),rtl.free(this,"FStrokeDisabled"),pas.System.TObject.Destroy.call(this)};var e=this.$rtti;e.addProperty("Stroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FStroke","SetStroke"),e.addProperty("Fill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FFill","SetFill"),e.addProperty("StrokeHover",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FStrokeHover","SetStrokeHover"),e.addProperty("FillHover",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FFillHover","SetFillHover"),e.addProperty("StrokeDown",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FStrokeDown","SetStrokeDown"),e.addProperty("FillDown",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FFillDown","SetFillDown"),e.addProperty("StrokeSelected",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FStrokeSelected","SetStrokeSelected"),e.addProperty("FillSelected",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FFillSelected","SetFillSelected"),e.addProperty("StrokeDisabled",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FStrokeDisabled","SetStrokeDisabled"),e.addProperty("FillDisabled",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FFillDisabled","SetFillDisabled"),e.addProperty("VerticalSpacing",14,rtl.double,"FVerticalSpacing","SetVerticalSpacing",{stored:"IsVerticalSpacingStored"}),e.addProperty("HorizontalSpacing",14,rtl.double,"FHorizontalSpacing","SetHorizontalSpacing",{stored:"IsHorizontalSpacingStored"}),e.addProperty("SeparatorStroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FSeparatorStroke","SetSeparatorStroke"),e.addProperty("Font",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFont,"FFont","SetFont")})),rtl.recNewT(this,"TTMSFNCCustomSelectorPositionItem",(function(){this.TileSet=!1,this.$eq=function(t){return this.TileSet===t.TileSet},this.$assign=function(t){return this.TileSet=t.TileSet,this}})),rtl.recNewT(this,"TTMSFNCCustomSelectorDisplayItem",(function(){this.Item=null,this.PageIndex=0,this.Column=0,this.Row=0,this.ColumnSpan=0,this.RowSpan=0,this.$new=function(){var t=Object.create(this);return t.Rect=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),t},this.$eq=function(t){return this.Rect.$eq(t.Rect)&&this.Item===t.Item&&this.PageIndex===t.PageIndex&&this.Column===t.Column&&this.Row===t.Row&&this.ColumnSpan===t.ColumnSpan&&this.RowSpan===t.RowSpan},this.$assign=function(t){return this.Rect.$assign(t.Rect),this.Item=t.Item,this.PageIndex=t.PageIndex,this.Column=t.Column,this.Row=t.Row,this.ColumnSpan=t.ColumnSpan,this.RowSpan=t.RowSpan,this}})),this.$rtti.$MethodVar("TTMSFNCCustomSelectorItemSelected",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AItemIndex",rtl.longint]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCCustomSelectorItemDeselected",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AItemIndex",rtl.longint]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCCustomSelectorItemClick",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AItemIndex",rtl.longint]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCCustomSelectorItemBeforeDrawBackground",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["AItemIndex",rtl.longint],["ADefaultDraw",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCCustomSelectorItemAfterDrawBackground",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["AItemIndex",rtl.longint]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCCustomSelectorItemBeforeDrawContent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["AItemIndex",rtl.longint],["ADefaultDraw",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCCustomSelectorItemAfterDrawContent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["AItemIndex",rtl.longint]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCCustomSelectorItemBeforeDrawText",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["AItemIndex",rtl.longint],["AText",rtl.string,1],["ADefaultDraw",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCCustomSelectorItemAfterDrawText",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["AItemIndex",rtl.longint],["AText",rtl.string]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCCustomSelectorBeforeDraw",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["ADefaultDraw",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCCustomSelectorAfterDraw",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF]]),methodkind:0}),rtl.createClass(this,"TTMSFNCCustomSelectorDisplayList",pas.Classes.TList,(function(){this.GetItem=function(e){var i=t.TTMSFNCCustomSelectorDisplayItem.$new();return i.$assign(rtl.getObject(this.Get(e))),i}})),rtl.createClass(this,"TTMSFNCCustomSelector",pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl,(function(){this.$init=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.$init.call(this),this.FDisplayList=null,this.FUpdateCount$1=0,this.FItems=null,this.FRows=0,this.FColumns=0,this.FPageCount=0,this.FAppearance=null,this.FSelectedItemIndex=0,this.FFocusedItemIndex=0,this.FHoveredItemIndex=0,this.FDownItemIndex=0,this.FOnItemBeforeDrawText=null,this.FOnAfterDraw$1=null,this.FOnItemAfterDrawBackground=null,this.FOnItemSelected=null,this.FOnItemAfterDrawText=null,this.FOnBeforeDraw$1=null,this.FOnItemBeforeDrawBackground=null,this.FOnItemDeselected=null,this.FOnItemClick=null,this.FOnItemBeforeDrawContent=null,this.FOnItemAfterDrawContent=null,this.FBlockChange=!1,this.FClosedRemotely=!1},this.$final=function(){this.FDisplayList=void 0,this.FItems=void 0,this.FAppearance=void 0,this.FOnItemBeforeDrawText=void 0,this.FOnAfterDraw$1=void 0,this.FOnItemAfterDrawBackground=void 0,this.FOnItemSelected=void 0,this.FOnItemAfterDrawText=void 0,this.FOnBeforeDraw$1=void 0,this.FOnItemBeforeDrawBackground=void 0,this.FOnItemDeselected=void 0,this.FOnItemClick=void 0,this.FOnItemBeforeDrawContent=void 0,this.FOnItemAfterDrawContent=void 0,pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.$final.call(this)},this.SetColumns=function(t){this.FColumns!==t&&(this.FColumns=t,this.UpdateCalculations(),this.CalculateItems())},this.SetRows=function(t){this.FRows!==t&&(this.FRows=t,this.UpdateCalculations(),this.CalculateItems())},this.SetAppearance=function(t){this.FAppearance.Assign(t)},this.SetSelectedItemIndex=function(t){this.FSelectedItemIndex!==t&&(this.FSelectedItemIndex=t,this.FFocusedItemIndex=t,this.InvalidateItems())},this.RegisterRuntimeClasses=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.RegisterRuntimeClasses.call(this),pas.Classes.RegisterClass(t.TTMSFNCCustomSelector)},this.GetDocURL=function(){return pas["WEBLib.TMSFNCTypes"].TTMSFNCBaseDocURL+"tmsfncuipack/components/"+pas.SysUtils.LowerCase(this.$classname)},this.GetVersion=function(){return this.$class.GetVersionNumber(1,0,1,0)},this.GetDisplayItem=function(e){var i=t.TTMSFNCCustomSelectorDisplayItem.$new(),s=0,o=null;i.Rect.$assign(pas["WEBLib.TMSFNCTypes"].RectF(0,0,0,0)),i.Item=null,i.PageIndex=-1,i.Row=-1,i.Column=-1,i.ColumnSpan=-1,i.RowSpan=-1;for(var n=0,r=this.FDisplayList.GetCount()-1;n<=r;n++)if(s=n,null!=(o=this.FDisplayList.GetItem(s).Item)&&o.GetIndex()===e){i.$assign(this.FDisplayList.GetItem(s));break}return i},this.GetNextSelectableItem=function(){var t=0,e=0,i=null;t=this.FFocusedItemIndex;for(var s=0,o=this.FDisplayList.GetCount()-1;s<=o;s++)if(e=s,null!=(i=this.FDisplayList.GetItem(e).Item)&&i.FEnabled&&!i.FSeparator&&i.GetIndex()>this.FFocusedItemIndex){t=i.GetIndex();break}return t},this.GetPreviousSelectableItem=function(){var t=0,e=0,i=null;t=this.FFocusedItemIndex;for(var s=this.FDisplayList.GetCount()-1;s>=0;s--)if(e=s,null!=(i=this.FDisplayList.GetItem(e).Item)&&i.FEnabled&&!i.FSeparator&&i.GetIndex()<this.FFocusedItemIndex){t=i.GetIndex();break}return t},this.GetNextSelectableRowItem=function(){var e=0,i=0,s=null,o=t.TTMSFNCCustomSelectorDisplayItem.$new();if(-1===(e=this.FFocusedItemIndex))return e=this.GetNextSelectableItem();o.$assign(this.GetDisplayItem(this.FFocusedItemIndex));for(var n=0,r=this.FDisplayList.GetCount()-1;n<=r;n++)if(i=n,null!=(s=this.FDisplayList.GetItem(i).Item)&&s.FEnabled&&!s.FSeparator&&s.GetIndex()>this.FFocusedItemIndex&&o.Column>=this.FDisplayList.GetItem(i).Column&&o.Column<=this.FDisplayList.GetItem(i).Column+(this.FDisplayList.GetItem(i).ColumnSpan-1)&&this.FDisplayList.GetItem(i).Row>o.Row){e=s.GetIndex();break}return e},this.GetPreviousSelectableRowItem=function(){var e=0,i=0,s=null,o=t.TTMSFNCCustomSelectorDisplayItem.$new();if(-1===(e=this.FFocusedItemIndex))return e=this.GetPreviousSelectableItem();o.$assign(this.GetDisplayItem(this.FFocusedItemIndex));for(var n=this.FDisplayList.GetCount()-1;n>=0;n--)if(i=n,null!=(s=this.FDisplayList.GetItem(i).Item)&&s.FEnabled&&!s.FSeparator&&s.GetIndex()<this.FFocusedItemIndex&&o.Column>=this.FDisplayList.GetItem(i).Column&&o.Column<=this.FDisplayList.GetItem(i).Column+(this.FDisplayList.GetItem(i).ColumnSpan-1)&&this.FDisplayList.GetItem(i).Row<o.Row){e=s.GetIndex();break}return e},this.GetFirstSelectableItem=function(){var t=0,e=0,i=null;t=this.FFocusedItemIndex;for(var s=0,o=this.FDisplayList.GetCount()-1;s<=o;s++)if(e=s,null!=(i=this.FDisplayList.GetItem(e).Item)&&i.FEnabled&&!i.FSeparator){t=i.GetIndex();break}return t},this.GetLastSelectableItem=function(){var t=0,e=0,i=null;t=this.FFocusedItemIndex;for(var s=this.FDisplayList.GetCount()-1;s>=0;s--)if(e=s,null!=(i=this.FDisplayList.GetItem(e).Item)&&i.FEnabled&&!i.FSeparator){t=i.GetIndex();break}return t},this.CreateItemsCollection=function(){return t.TTMSFNCCustomSelectorItems.$create("Create$3",[this])},this.CalculateItems=function(){var e,i,s,o,n,r,a,l=this,h=[],F=0,p=0,c=0,u=0,C=0,T=null,S=0,d=0,m=0,f=0,g=0,y=!1,M=0,b=0,N=0,B=0,E=0,D=0,L=0,G=0,A=t.TTMSFNCCustomSelectorDisplayItem.$new();function I(t,e,i,s,o,n,r,a,h){var F=0,p=0,c=0,u=0,C=0,T=0;s.set(!1);for(var S=e.get(),d=o-1;S<=d;S++){F=S;for(var m=i.get(),f=r-1;m<=f;m++){p=m,c=t.FColumnSpan,c=Math.min(c,l.FColumns-i.get()),u=t.FRowSpan,u=Math.min(u,l.FRows-e.get()),s.set(!0);for(var g=0,y=u-1;g<=y;g++){C=g;for(var M=0,b=c-1;M<=b;M++)T=M,h[F+C][p+T].TileSet&&s.set(!1)}if(s.get())break;i.set(i.get()+1)}if(s.get())break;i.set(0),e.set(e.get()+1)}}if(!(3 in this.FComponentState||this.FUpdateCount$1>0)&&(this.FDisplayList.Clear(),0!==this.FItems.GetCount())){for(r=this.GetCalculationWidth(),a=this.GetCalculationHeight(),i=this.FAppearance.FHorizontalSpacing,b=o=r-(s=this.FAppearance.FVerticalSpacing),this.FColumns>0&&(b=(o-this.FColumns*i)/this.FColumns),n=a-s-this.GetTotalSeparatorHeight(),e=this.GetTotalSeparatorCount(),N=n,this.FRows-e>0&&(N=(n-(this.FRows-e)*s)/(this.FRows-e)),C=0,M=0,G=0;C<=this.FItems.GetCount()-1;){for(c=0,F=0,h=rtl.arraySetLength(h,t.TTMSFNCCustomSelectorPositionItem,0,0),h=rtl.arraySetLength(h,t.TTMSFNCCustomSelectorPositionItem,this.FRows,this.FColumns);F<this.FRows;){for(;c<this.FColumns;){if(C>=0&&C<=this.FItems.GetCount()-1&&0===M){if(!(T=this.FItems.GetItem$1(C)).FVisible){C+=1;continue}T.FSeparator?(S=this.FColumns,d=1):(S=T.FColumnSpan,d=T.FRowSpan),S=Math.min(S,this.FColumns-c),d=Math.min(d,this.FRows-F),B=b*S+i*(S-1),E=T.FSeparator?T.FSeparatorHeight:N*d+s*(d-1),D=r*M+i+b*c+i*c,L=G+s+N*F+s*F+this.GetTopOffset(),A.Rect.$assign(pas["WEBLib.TMSFNCTypes"].RectF(D+T.FMargins.FLeft,L+T.FMargins.FTop,D+B-T.FMargins.FRight,L+E-T.FMargins.FBottom)),A.Item=T,A.PageIndex=M,A.Column=c,A.Row=F,A.ColumnSpan=S,A.RowSpan=d,this.FDisplayList.Add(t.TTMSFNCCustomSelectorDisplayItem.$clone(A)),m=(m=c)+S-1;for(var P=F,w=F+d-1;P<=w;P++){f=P;for(var $=c,R=m;$<=R;$++)g=$,h[f][g].TileSet=!0}T.FSeparator&&(G=G+T.FSeparatorHeight-N*d+s*(d-1))}if(u=c+=1,p=F,y=!1,(C+=1)>=0&&C<=this.FItems.GetCount()-1&&I(this.FItems.GetItem$1(C),{get:function(){return p},set:function(t){p=t}},{get:function(){return u},set:function(t){u=t}},{get:function(){return y},set:function(t){y=t}},this.FRows,0,this.FColumns,0,rtl.arrayRef(h)),F=p,(c=u)>=this.FColumns||F>=this.FRows)break}if(u=c=0,p=F+=1,y=!1,C>=0&&C<=this.FItems.GetCount()-1&&I(this.FItems.GetItem$1(C),{get:function(){return p},set:function(t){p=t}},{get:function(){return u},set:function(t){u=t}},{get:function(){return y},set:function(t){y=t}},this.FRows,0,this.FColumns,0,rtl.arrayRef(h)),c=u,(F=p)>=this.FRows)break}M+=1}this.FPageCount=M,this.InvalidateItems()}},this.UpdateCalculations=function(){},this.ApplyStyle=function(){var t=0;pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.ApplyStyle.call(this),t=-1,pas["WEBLib.TMSFNCStyles"].TTMSFNCStyles.GetStyleBackgroundFillColor({get:function(){return t},set:function(e){t=e}})&&this.FFill.SetColor(t),t=-1,pas["WEBLib.TMSFNCStyles"].TTMSFNCStyles.GetStyleBackgroundStrokeColor({get:function(){return t},set:function(e){t=e}})&&this.FStroke.SetColor(t),t=-1,pas["WEBLib.TMSFNCStyles"].TTMSFNCStyles.GetStyleDefaultButtonFillColor({get:function(){return t},set:function(e){t=e}})&&this.FAppearance.FFill.SetColor(t),t=-1,pas["WEBLib.TMSFNCStyles"].TTMSFNCStyles.GetStyleSelectionFillColor({get:function(){return t},set:function(e){t=e}})&&(this.FAppearance.FFillSelected.SetColor(t),this.FAppearance.FFillDown.SetColor(t),this.FAppearance.FFillHover.SetColor(pas["WEBLib.TMSFNCGraphicsTypes"].Blend(t,this.FAppearance.FFill.FColor,25))),t=-1,pas["WEBLib.TMSFNCStyles"].TTMSFNCStyles.GetStyleDefaultButtonStrokeColor({get:function(){return t},set:function(e){t=e}})&&(this.FAppearance.FStroke.SetColor(t),this.FAppearance.FStrokeSelected.SetColor(t),this.FAppearance.FStrokeDown.SetColor(t),this.FAppearance.FStrokeHover.SetColor(t)),t=-1,pas["WEBLib.TMSFNCStyles"].TTMSFNCStyles.GetStyleTextFontColor({get:function(){return t},set:function(e){t=e}})&&this.FAppearance.FFont.SetColor(t)},this.ResetToDefaultStyle=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.ResetToDefaultStyle.call(this),this.FFill.SetKind(1),this.FStroke.SetKind(1),this.FFill.SetColor(16777215),this.FStroke.SetColor(12632256),this.FAppearance.FFill.SetColor(pas["WEBLib.TMSFNCGraphicsTypes"].Lighter(13882323,50)),this.FAppearance.FFillHover.SetColor(pas["WEBLib.TMSFNCGraphicsTypes"].Lighter(10061943,50)),this.FAppearance.FFillDown.SetColor(pas["WEBLib.TMSFNCGraphicsTypes"].Lighter(9470064,50)),this.FAppearance.FFillSelected.SetColor(pas["WEBLib.TMSFNCGraphicsTypes"].Lighter(9470064,50)),this.FAppearance.FFillDisabled.SetColor(pas["WEBLib.TMSFNCGraphicsTypes"].Lighter(8421504,50)),this.FAppearance.FStroke.SetColor(11119017),this.FAppearance.FStrokeHover.SetColor(10061943),this.FAppearance.FStrokeDown.SetColor(9470064),this.FAppearance.FStrokeSelected.SetColor(5197615),this.FAppearance.FStrokeDisabled.SetColor(11119017),this.FAppearance.FFont.SetColor(0),this.FAppearance.FFill.SetKind(1),this.FAppearance.FFillHover.SetKind(1),this.FAppearance.FFillDown.SetKind(1),this.FAppearance.FFillSelected.SetKind(1),this.FAppearance.FFillDisabled.SetKind(1),this.FAppearance.FStroke.SetKind(1),this.FAppearance.FStrokeHover.SetKind(1),this.FAppearance.FStrokeDown.SetKind(1),this.FAppearance.FStrokeSelected.SetKind(1),this.FAppearance.FStrokeDisabled.SetKind(1),this.FAppearance.FSeparatorStroke.SetKind(1)},this.GetTopOffset=function(){return 0,0},this.GetCalculationWidth=function(){return this.GetWidth()},this.GetCalculationHeight=function(){return this.GetHeight()-this.GetTopOffset()},this.GetTotalSeparatorHeight=function(){var t=0,e=0;t=0;for(var i=0,s=this.FItems.GetCount()-1;i<=s;i++)e=i,this.FItems.GetItem$1(e).FSeparator&&(t=t+this.FItems.GetItem$1(e).FSeparatorHeight+this.FAppearance.FVerticalSpacing);return t},this.GetTotalSeparatorCount=function(){var t=0,e=0;t=0;for(var i=0,s=this.FItems.GetCount()-1;i<=s;i++)e=i,this.FItems.GetItem$1(e).FSeparator&&(t+=1);return t},this.DoItemSelected=function(t){null!=this.FOnItemSelected&&this.FOnItemSelected(this,t)},this.DoItemClick=function(t){null!=this.FOnItemClick&&this.FOnItemClick(this,t)},this.DoItemDeselected=function(t){null!=this.FOnItemDeselected&&this.FOnItemDeselected(this,t)},this.DoItemBeforeDrawBackground=function(t,e,i,s){null!=this.FOnItemBeforeDrawBackground&&this.FOnItemBeforeDrawBackground(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i,s)},this.DoItemAfterDrawBackground=function(t,e,i){null!=this.FOnItemAfterDrawBackground&&this.FOnItemAfterDrawBackground(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i)},this.DoItemBeforeDrawContent=function(t,e,i,s){null!=this.FOnItemBeforeDrawContent&&this.FOnItemBeforeDrawContent(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i,s)},this.DoItemAfterDrawContent=function(t,e,i){null!=this.FOnItemAfterDrawContent&&this.FOnItemAfterDrawContent(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i)},this.DoItemBeforeDrawText=function(t,e,i,s,o){null!=this.FOnItemBeforeDrawText&&this.FOnItemBeforeDrawText(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i,s,o)},this.DoItemAfterDrawText=function(t,e,i,s){null!=this.FOnItemAfterDrawText&&this.FOnItemAfterDrawText(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i,s)},this.DoBeforeDraw$1=function(t,e,i){null!=this.FOnBeforeDraw$1&&this.FOnBeforeDraw$1(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i)},this.DoAfterDraw$1=function(t,e){null!=this.FOnAfterDraw$1&&this.FOnAfterDraw$1(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e))},this.DrawItems=function(e){for(var i=0,s=0,o=this.FDisplayList.GetCount()-1;s<=o;s++)i=s,this.DrawItem(e,t.TTMSFNCCustomSelectorDisplayItem.$clone(this.FDisplayList.GetItem(i)))},this.Draw=function(t,e){var i=!1;pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Draw.apply(this,arguments),i=!0,this.DoBeforeDraw$1(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),{get:function(){return i},set:function(t){i=t}}),i&&(this.DrawItems(t),this.DoAfterDraw$1(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e)))},this.DrawItem=function(e,i){this.DrawItemBackGround(e,t.TTMSFNCCustomSelectorDisplayItem.$clone(i)),this.DrawItemContent(e,t.TTMSFNCCustomSelectorDisplayItem.$clone(i)),this.DrawItemText(e,t.TTMSFNCCustomSelectorDisplayItem.$clone(i))},this.DrawItemBackGround=function(t,e){var i=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),s=null,o=!1,n=pas["WEBLib.TMSFNCTypes"].TRectF.$new();null!=(s=e.Item)&&(s.FSeparator?t.FStroke.Assign(this.FAppearance.FSeparatorStroke):(t.FFill.Assign(this.FAppearance.FFill),t.FStroke.Assign(this.FAppearance.FStroke),s.FEnabled?s.GetIndex()===this.FDownItemIndex?(t.FFill.Assign(this.FAppearance.FFillDown),t.FStroke.Assign(this.FAppearance.FStrokeDown)):s.GetIndex()===this.FHoveredItemIndex?(t.FFill.Assign(this.FAppearance.FFillHover),t.FStroke.Assign(this.FAppearance.FStrokeHover)):s.GetIndex()===this.FSelectedItemIndex&&(t.FFill.Assign(this.FAppearance.FFillSelected),t.FStroke.Assign(this.FAppearance.FStrokeSelected)):(t.FFill.Assign(this.FAppearance.FFillDisabled),t.FStroke.Assign(this.FAppearance.FStrokeDisabled))),i.$assign(e.Rect),o=!0,this.DoItemBeforeDrawBackground(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e.Rect),s.GetIndex(),{get:function(){return o},set:function(t){o=t}}),o&&(s.FSeparator?t.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(i.Left,pas["WEBLib.TMSFNCTypes"].CenterPointEx(i).Y)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(i.Right,pas["WEBLib.TMSFNCTypes"].CenterPointEx(i).Y)),2,2):(t.DrawRectangle$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),2),this.IsFocused()&&this.FFocusedItemIndex===s.GetIndex()&&(n.$assign(i),pas["WEBLib.TMSFNCTypes"].InflateRectEx(n,this.ScalePaintValue(-2),this.ScalePaintValue(-2)),t.DrawFocusRectangle$3(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(n),0,2))),this.DoItemAfterDrawBackground(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e.Rect),s.GetIndex())))},this.DrawItemContent=function(t,e){var i=null,s=!1;null!=(i=e.Item)&&(s=!0,this.DoItemBeforeDrawContent(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e.Rect),i.GetIndex(),{get:function(){return s},set:function(t){s=t}}),s&&this.DoItemAfterDrawContent(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e.Rect),i.GetIndex()))},this.DrawItemText=function(t,e){var i=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),s=null,o="",n=!1;null!=(s=e.Item)&&""!==s.FText&&(i.$assign(e.Rect),o=s.FText,n=!0,pas["WEBLib.TMSFNCTypes"].InflateRectEx(i,-2,-2),t.FFont.AssignSource(this.FAppearance.FFont),this.DoItemBeforeDrawText(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e.Rect),s.GetIndex(),{get:function(){return o},set:function(t){o=t}},{get:function(){return n},set:function(t){n=t}}),n&&(t.DrawText$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),o,!1,s.FHorizontalTextAlign,s.FVerticalTextAlign,0,0,-1,-1,!0,!1,-1,-1),this.DoItemAfterDrawText(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e.Rect),s.GetIndex(),o)))},this.HandleMouseDown=function(t,e,i,s){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleMouseDown.apply(this,arguments),this.CaptureEx(),this.FDownItemIndex=this.XYToItem(i,s),this.InvalidateItems()},this.HandleMouseUp=function(t,e,i,s){var o=0;pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleMouseUp.apply(this,arguments),this.ReleaseCaptureEx(),(o=this.XYToItem(i,s))===this.FDownItemIndex&&-1!==this.FDownItemIndex&&(this.ProcessSelection(o),-1!==o&&this.DoItemClick(o)),this.FDownItemIndex=-1,this.FHoveredItemIndex=-1,this.InvalidateItems()},this.HandleMouseMove=function(t,e,i){var s=0;pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleMouseMove.apply(this,arguments),this.FDownItemIndex>-1||(s=this.XYToItem(e,i))!==this.FHoveredItemIndex&&(this.FHoveredItemIndex=s,this.CancelHint(),this.InvalidateItems())},this.HandleKeyDown=function(t,e){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleKeyDown.apply(this,arguments);var i=t.get();38===i?(this.FFocusedItemIndex=this.GetPreviousSelectableRowItem(),this.InvalidateItems()):37===i?(this.FFocusedItemIndex=this.GetPreviousSelectableItem(),this.InvalidateItems()):40===i?(this.FFocusedItemIndex=this.GetNextSelectableRowItem(),this.InvalidateItems()):39===i?(this.FFocusedItemIndex=this.GetNextSelectableItem(),this.InvalidateItems()):36===i?(this.FFocusedItemIndex=this.GetFirstSelectableItem(),this.InvalidateItems()):35===i&&(this.FFocusedItemIndex=this.GetLastSelectableItem(),this.InvalidateItems()),13===t.get()&&(this.FDownItemIndex=this.FFocusedItemIndex,this.InvalidateItems())},this.HandleKeyUp=function(t,e){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleKeyUp.apply(this,arguments),13===t.get()&&(this.FDownItemIndex=-1,this.ProcessSelection(this.FFocusedItemIndex),this.InvalidateItems())},this.HandleMouseLeave=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleMouseLeave.call(this),this.FHoveredItemIndex=-1,this.InvalidateItems()},this.ProcessSelection=function(t){var e=null,i=0;t>=0&&t<=this.FItems.GetCount()-1&&(e=this.FItems.GetItem$1(t)).FCanSelect&&(i=this.FSelectedItemIndex,e.FCanDeselect&&e.GetIndex()===this.FSelectedItemIndex?this.FSelectedItemIndex=-1:this.FSelectedItemIndex=e.GetIndex(),-1!==this.FSelectedItemIndex&&(this.FFocusedItemIndex=this.FSelectedItemIndex),e.FCanDeselect&&-1!==i&&this.DoItemDeselected(i),-1!==this.FSelectedItemIndex&&this.DoItemSelected(this.FSelectedItemIndex))},this.Create$1=function(e){return pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Create$1.apply(this,arguments),this.FColumns=4,this.FRows=4,this.FItems=this.CreateItemsCollection(),this.FDisplayList=t.TTMSFNCCustomSelectorDisplayList.$create("Create$1"),this.FAppearance=t.TTMSFNCCustomSelectorAppearance.$create("Create$1",[this]),this.FSelectedItemIndex=-1,this.FFocusedItemIndex=-1,this.FHoveredItemIndex=-1,this.FDownItemIndex=-1,this.IsDesignTime()&&this.InitializeDefault(),this},this.Destroy=function(){rtl.free(this,"FAppearance"),rtl.free(this,"FDisplayList"),rtl.free(this,"FItems"),pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Destroy.call(this)},this.Assign=function(e){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Assign.apply(this,arguments),t.TTMSFNCCustomSelector.isPrototypeOf(e)&&(this.FItems.Assign(rtl.as(e,t.TTMSFNCCustomSelector).FItems),this.FAppearance.Assign(rtl.as(e,t.TTMSFNCCustomSelector).FAppearance),this.FRows=rtl.as(e,t.TTMSFNCCustomSelector).FRows,this.FColumns=rtl.as(e,t.TTMSFNCCustomSelector).FColumns)},this.BeginUpdate=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBase.BeginUpdate.call(this),this.FUpdateCount$1+=1},this.EndUpdate=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBase.EndUpdate.call(this),this.FUpdateCount$1-=1,0===this.FUpdateCount$1&&this.CalculateItems()},this.InvalidateItems=function(){this.Invalidate()},this.UpdateControlAfterResize=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.UpdateControlAfterResize.call(this),this.CalculateItems()},this.InitializeDefault=function(){},this.XYToItem=function(t,e){var i=0,s=0,o=null;i=-1;for(var n=0,r=this.FDisplayList.GetCount()-1;n<=r;n++)if(s=n,pas["WEBLib.TMSFNCTypes"].PtInRectEx(this.FDisplayList.GetItem(s).Rect,pas["WEBLib.TMSFNCTypes"].PointF(t,e))&&null!=(o=this.FDisplayList.GetItem(s).Item)&&o.FEnabled&&!o.FSeparator){i=o.GetIndex();break}return i},rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas["WEBLib.TMSFNCTypes"].ITMSFNCProductInfo),rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TTMSFNCDefaultSelector",this.TTMSFNCCustomSelector,(function(){rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas["WEBLib.TMSFNCTypes"].ITMSFNCProductInfo),rtl.addIntf(this,pas.System.IUnknown);var t=this.$rtti;t.addProperty("Fill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FFill","SetFill"),t.addProperty("Stroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FStroke","SetStroke"),t.addProperty("Version",1,rtl.string,"GetVersion","")})),t.$init=function(){pas.Classes.RegisterClass(t.TTMSFNCCustomSelector)}}),["Math","SysUtils","WEBLib.TMSFNCUtils","WEBLib.TMSFNCStyles"]),rtl.module("WEBLib.TMSFNCCustomPicker",["System","Classes","WEBLib.TMSFNCCustomSelector","WEBLib.TMSFNCPersistence","WEBLib.TMSFNCGraphics","WEBLib.TMSFNCGraphicsTypes","WEBLib.TMSFNCCustomControl","WEBLib.TMSFNCPopup","WEBLib.TMSFNCTypes","WEBLib.Controls","WEBLib.StdCtrls","WEBLib.ExtCtrls"],(function(){"use strict";var t=this.$impl;this.$rtti.$MethodVar("TTMSFNCCustomPickerBeforeDraw",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["ADefaultDraw",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCCustomPickerAfterDraw",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF]]),methodkind:0}),rtl.createClass(this,"TTMSFNCCustomPicker",pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl,(function(){this.$init=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.$init.call(this),this.FExitTimerClose=!1,this.FDefaultStyle=!1,this.FKeyDown=0,this.FContent="",this.FEdit=null,this.FTimer=null,this.FExitTimer=null,this.FDown=!1,this.FPopup=null,this.FSelector=null,this.FOnItemBeforeDrawText=null,this.FOnAfterDraw$1=null,this.FOnItemAfterDrawBackground=null,this.FOnItemSelected=null,this.FOnItemAfterDrawText=null,this.FOnBeforeDraw$1=null,this.FOnItemBeforeDrawBackground=null,this.FDropDownHeight=0,this.FDropDownWidth=0,this.FOnItemDeselected=null,this.FOnItemClick=null,this.FOnItemBeforeDrawContent=null,this.FOnItemAfterDrawContent=null,this.FOnPickerBeforeDraw=null,this.FOnPickerAfterDraw=null,this.FShowFocus$1=!1,this.FOnClosePopup=null,this.FOnPopup=null,this.FOnEditChange=null,this.FEditable=!1,this.FUpdateCount$1=0,this.FFont$1=null,this.FPreventDropDown=!1},this.$final=function(){this.FEdit=void 0,this.FTimer=void 0,this.FExitTimer=void 0,this.FPopup=void 0,this.FSelector=void 0,this.FOnItemBeforeDrawText=void 0,this.FOnAfterDraw$1=void 0,this.FOnItemAfterDrawBackground=void 0,this.FOnItemSelected=void 0,this.FOnItemAfterDrawText=void 0,this.FOnBeforeDraw$1=void 0,this.FOnItemBeforeDrawBackground=void 0,this.FOnItemDeselected=void 0,this.FOnItemClick=void 0,this.FOnItemBeforeDrawContent=void 0,this.FOnItemAfterDrawContent=void 0,this.FOnPickerBeforeDraw=void 0,this.FOnPickerAfterDraw=void 0,this.FOnClosePopup=void 0,this.FOnPopup=void 0,this.FOnEditChange=void 0,this.FFont$1=void 0,pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.$final.call(this)},this.CalcSize=function(){},this.GetAppearance=function(){return this.FSelector.FAppearance},this.GetColumns=function(){return this.FSelector.FColumns},this.GetRows=function(){return this.FSelector.FRows},this.GetSelectedItemIndex=function(){return this.FSelector.FSelectedItemIndex},this.SetAppearance=function(t){this.FSelector.FAppearance.Assign(t)},this.SetColumns=function(t){this.FSelector.SetColumns(t)},this.SetRows=function(t){this.FSelector.SetRows(t)},this.SetSelectedItemIndex=function(t){this.FSelector.SetSelectedItemIndex(t)},this.GetFill=function(){return this.FSelector.FFill},this.GetStroke=function(){return this.FSelector.FStroke},this.SetFill$1=function(t){this.FSelector.FFill.Assign(t)},this.SetStroke$1=function(t){this.FSelector.FStroke.Assign(t)},this.SetDropDownHeight=function(t){this.FDropDownHeight=t,null!=this.FPopup&&this.FPopup.SetDropDownHeight(this.FDropDownHeight)},this.SetDropDownWidth=function(t){this.FDropDownWidth=t,null!=this.FPopup&&this.FPopup.SetDropDownWidth(this.FDropDownWidth)},this.IsDropDownHeightStored=function(){return 135!==this.FDropDownHeight},this.IsDropDownWidthStored=function(){return 135!==this.FDropDownWidth},this.GetPopup=function(){return this.FPopup},this.GetSelector=function(){return this.FSelector},this.SetShowFocus$1=function(t){this.FShowFocus$1!==t&&(this.FShowFocus$1=t,this.Invalidate())},this.SetContent=function(t){this.FContent=t,this.UpdateEditText(t)},this.SetDefaultStyle=function(t){this.FDefaultStyle!==t&&(this.FDefaultStyle=t,this.Invalidate())},this.SetFnt=function(t){this.FFont$1.Assign(t)},this.GetVersion=function(){return this.$class.GetVersionNumber(1,0,0,5)},this.GetContent=function(){return null!=this.FEdit&&null!=this.FEdit.FParent&&this.FEditable?this.FEdit.GetText():this.FContent},this.GetDocURL=function(){return pas["WEBLib.TMSFNCTypes"].TTMSFNCBaseDocURL+"tmsfncuipack/components/"+pas.SysUtils.LowerCase(this.$classname)},this.SetEditable=function(t){this.FEditable!==t&&(this.FEditable=t,null!=this.FEdit&&(this.FEditable?this.FEdit.SetParent(this):this.FEdit.SetParent(null),this.FEdit.SetVisible(this.FEditable),this.UpdateEditText(this.GetContent()),this.FPopup.FStaysOpen=this.FEditable),this.Invalidate())},this.ApplyStyle=function(){var t=0;pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.ApplyStyle.call(this),t=-1,pas["WEBLib.TMSFNCStyles"].TTMSFNCStyles.GetStyleBackgroundFillColor({get:function(){return t},set:function(e){t=e}})&&this.GetFill().SetColor(t),t=-1,pas["WEBLib.TMSFNCStyles"].TTMSFNCStyles.GetStyleLineFillColor({get:function(){return t},set:function(e){t=e}})&&this.GetStroke().SetColor(t),this.Invalidate()},this.SetAdaptToStyle=function(t){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.SetAdaptToStyle.apply(this,arguments),null!=this.FPopup&&this.FPopup.SetAdaptToStyle(this.GetAdaptToStyle())},this.DoExit=function(){pas["WEBLib.Controls"].TControl.DoExit.call(this),this.Invalidate()},this.DoEnter=function(){pas["WEBLib.Controls"].TControl.DoEnter.call(this),this.FTimer.SetEnabled(!0),this.Invalidate()},this.DoEditExit=function(t){this.FExitTimer.SetEnabled(!0)},this.UpdateEditText=function(t){null!=this.FEdit&&null!=this.FEdit.FParent&&this.FEditable&&this.FEdit.SetText(t)},this.DoItemSelected=function(t,e){this.UpdateEditText(""),null!=this.FOnItemSelected&&this.FOnItemSelected(this,e)},this.DoItemDeselected=function(t,e){null!=this.FOnItemDeselected&&this.FOnItemDeselected(this,e)},this.DoItemClick=function(t,e){null!=this.FOnItemClick&&this.FOnItemClick(this,e)},this.DoItemBeforeDrawBackground=function(t,e,i,s,o){null!=this.FOnItemBeforeDrawBackground&&this.FOnItemBeforeDrawBackground(this,e,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),s,o)},this.DoItemAfterDrawBackground=function(t,e,i,s){null!=this.FOnItemAfterDrawBackground&&this.FOnItemAfterDrawBackground(this,e,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),s)},this.DoItemBeforeDrawContent=function(t,e,i,s,o){null!=this.FOnItemBeforeDrawContent&&this.FOnItemBeforeDrawContent(this,e,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),s,o)},this.DoItemAfterDrawContent=function(t,e,i,s){null!=this.FOnItemAfterDrawContent&&this.FOnItemAfterDrawContent(this,e,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),s)},this.DoItemBeforeDrawText=function(t,e,i,s,o,n){null!=this.FOnItemBeforeDrawText&&this.FOnItemBeforeDrawText(this,e,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),s,o,n)},this.DoItemAfterDrawText=function(t,e,i,s,o){null!=this.FOnItemAfterDrawText&&this.FOnItemAfterDrawText(this,e,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),s,o)},this.DoBeforeDraw$1=function(t,e,i,s){null!=this.FOnBeforeDraw$1&&this.FOnBeforeDraw$1(this,e,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),s)},this.DoAfterDraw$1=function(t,e,i){null!=this.FOnAfterDraw$1&&this.FOnAfterDraw$1(this,e,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i))},this.DoPickerBeforeDraw=function(t,e,i){null!=this.FOnPickerBeforeDraw&&this.FOnPickerBeforeDraw(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i)},this.DoPickerAfterDraw=function(t,e){null!=this.FOnPickerAfterDraw&&this.FOnPickerAfterDraw(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e))},this.Draw=function(t,e){var i=!1,s=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),o=pas["WEBLib.TMSFNCTypes"].TRectF.$new();pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Draw.apply(this,arguments),i=!0,this.DoPickerBeforeDraw(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),{get:function(){return i},set:function(t){i=t}}),i&&(this.DrawBackground(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e)),s.$assign(e),s.Right=s.Right-this.ScalePaintValue(15),this.DrawContent(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(s)),this.FShowFocus$1&&this.IsFocused()&&(o.$assign(e),pas["WEBLib.TMSFNCTypes"].InflateRectEx(o,-1,-1),t.DrawFocusRectangle$3(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(o),0,2)),this.DoPickerAfterDraw(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e)))},this.SelectFirstValue=function(){},this.SelectLastValue=function(){},this.SelectNextValue=function(){},this.SelectPreviousValue=function(){},this.EditUp=function(){},this.EditDown=function(){},this.DoPopup=function(t){this.InitializePopup(),null!=this.FSelector&&this.FSelector.CalculateItems(),null!=this.FOnPopup&&this.FOnPopup(this)},this.DoClosePopup=function(t){null!=this.FOnClosePopup&&this.FOnClosePopup(this)},this.EnterTimerChanged=function(t){this.FEditable&&!this.FExitTimerClose&&this.FEdit.SetFocus(),this.FExitTimerClose=!1,this.FTimer.SetEnabled(!1)},this.ExitTimerChanged=function(t){var e=!1;this.FExitTimer.SetEnabled(!1),this.FExitTimerClose=!0,e=!0,null!=this.FPopup.FFocusedControl?pas["WEBLib.Controls"].TCustomControl.isPrototypeOf(this.FPopup.FFocusedControl)&&(e=!rtl.as(this.FPopup.FFocusedControl,pas["WEBLib.Controls"].TCustomControl).Focused()):null!=this.FPopup.FContentControl&&pas["WEBLib.Controls"].TCustomControl.isPrototypeOf(this.FPopup.FContentControl)&&(e=!rtl.as(this.FPopup.FContentControl,pas["WEBLib.Controls"].TCustomControl).Focused()),this.FPopup.FIsOpen&&!this.FDown&&e&&!this.FPreventDropDown&&this.DropDown(),this.FPreventDropDown=!1},this.EditChange=function(t){this.SetContent(this.FEdit.GetText()),this.DoEditChange(),null!=this.FOnEditChange&&this.FOnEditChange(this)},this.DoEditChange=function(){},this.HandleDialogKey=function(t,e){rtl.neSet(e,{})||this.FEditable&&this.FEdit.IsFocused()&&115===t.get()&&(1 in e||this.DropDown())},this.InitializePopup=function(){null!=this.FPopup&&(this.FPopup.SetAdaptToStyle(this.GetAdaptToStyle()),this.FDefaultStyle?(this.FPopup.FFillColor=-1,this.FPopup.FStrokeColor=-1):(this.FPopup.FFillColor=this.GetFill().FColor,this.FPopup.FStrokeColor=this.GetStroke().FColor)),null!=this.FSelector&&this.FSelector.SetAdaptToStyle(this.GetAdaptToStyle())},this.FntChanged=function(t){this.Invalidate()},this.CreateSelector=function(){return pas["WEBLib.TMSFNCCustomSelector"].TTMSFNCCustomSelector.$create("Create$1",[this])},this.GetFocusedControl=function(){return null,null},this.AssignEvents=function(){null!=this.FSelector&&(this.FSelector.FOnItemSelected=rtl.createCallback(this,"DoItemSelected"),this.FSelector.FOnItemDeselected=rtl.createCallback(this,"DoItemDeselected"),this.FSelector.FOnItemClick=rtl.createCallback(this,"DoItemClick"),this.FSelector.FOnItemBeforeDrawBackground=rtl.createCallback(this,"DoItemBeforeDrawBackground"),this.FSelector.FOnItemAfterDrawBackground=rtl.createCallback(this,"DoItemAfterDrawBackground"),this.FSelector.FOnItemBeforeDrawContent=rtl.createCallback(this,"DoItemBeforeDrawContent"),this.FSelector.FOnItemAfterDrawContent=rtl.createCallback(this,"DoItemAfterDrawContent"),this.FSelector.FOnItemBeforeDrawText=rtl.createCallback(this,"DoItemBeforeDrawText"),this.FSelector.FOnItemAfterDrawText=rtl.createCallback(this,"DoItemAfterDrawText"),this.FSelector.FOnBeforeDraw$1=rtl.createCallback(this,"DoBeforeDraw$1"),this.FSelector.FOnAfterDraw$1=rtl.createCallback(this,"DoAfterDraw$1"))},this.SetGraphicColors=function(){pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.DefaultPopupFillColor=this.GetFill().FColor,pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.DefaultPopupStrokeColor=this.GetStroke().FColor,pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.DefaultButtonFillColor=this.GetFill().FColor,pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.DefaultButtonStrokeColor=this.GetStroke().FColor,pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.DefaultTextFontColor=this.FFont$1.FColor,pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.DefaultSelectionFillColor=11119017,pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.DefaultButtonFillColorFocused=pas["WEBLib.TMSFNCGraphicsTypes"].Lighter(this.GetFill().FColor,20),pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.DefaultButtonStrokeColorFocused=pas["WEBLib.TMSFNCGraphicsTypes"].Lighter(this.GetStroke().FColor,20),pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.DefaultButtonStrokeColorDisabled=11119017,pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.DefaultButtonFillColorDisabled=13882323},this.DrawContent=function(t,e){t.FFont.Assign(this.FFont$1),this.FEnabled||t.FFont.SetColor(12632256)},this.DrawBackground=function(t,e){this.FDefaultStyle||this.SetGraphicColors(),t.DrawDropDownButton(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),this.FDown,this.IsFocused(),!0,!1,this.GetAdaptToStyle()||!this.FDefaultStyle,this.FPaintScaleFactor),this.FDefaultStyle||t.$class.SetDefaultGraphicColors()},this.HandleMouseDown=function(t,e,i,s){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleMouseDown.apply(this,arguments),this.CanFocus()&&this.SetFocus(),0===t&&(this.FDown=!0,this.Invalidate(),this.DropDown(),this.FEditable&&this.FEdit.SetFocus())},this.HandleMouseUp=function(t,e,i,s){this.FDown=!1,this.Invalidate()},this.HandleKeyUp=function(t,e){if(pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleKeyUp.apply(this,arguments),!rtl.neSet(e,{})){var i=t.get();32!==i&&13!==i&&115!==i||this.DropDown()}},this.HandleKeyDown=function(t,e){if(pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleKeyDown.apply(this,arguments),1 in e){var i=t.get();if(38===i||40===i)return void this.DropDown()}var s=t.get();36===s?this.SelectFirstValue():35===s?this.SelectLastValue():38===s||37===s?this.SelectPreviousValue():40!==s&&39!==s||this.SelectNextValue()},this.EditKeyDown=function(t,e,i){this.FKeyDown=e.get()},this.EditKeyPress=function(t,e){this.FKeyDown in rtl.createSet(38,40)&&(38===this.FKeyDown&&this.EditUp(),40===this.FKeyDown&&this.EditDown(),e.set("\0"))},this.Create$1=function(e){return pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Create$1.apply(this,arguments),this.FExitTimerClose=!1,this.FPreventDropDown=!1,this.FFont$1=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFont.$create("Create$2"),this.FFont$1.FOnChanged=rtl.createCallback(this,"FntChanged"),this.FDefaultStyle=!0,this.FTimer=pas["WEBLib.ExtCtrls"].TTimer.$create("Create$1",[this]),this.FTimer.SetInterval(1),this.FTimer.FOnTimer=rtl.createCallback(this,"EnterTimerChanged"),this.FTimer.SetEnabled(!1),this.FExitTimer=pas["WEBLib.ExtCtrls"].TTimer.$create("Create$1",[this]),this.FExitTimer.SetInterval(1),this.FExitTimer.FOnTimer=rtl.createCallback(this,"ExitTimerChanged"),this.FExitTimer.SetEnabled(!1),this.FEdit=t.TTMSFNCCustomPickerEdit.$create("Create$1",[this]),this.FEdit.SetTabOrder(0),this.FEdit.SetTabStop(!0),this.FEdit.FOnKeyDown=rtl.createCallback(this,"EditKeyDown"),this.FEdit.FOnExit=rtl.createCallback(this,"DoEditExit"),this.FEdit.SetAlignWithMargins(!0),this.FEdit.FMargins.SetLeft(0),this.FEdit.FMargins.SetTop(0),this.FEdit.FMargins.SetRight(17),this.FEdit.FMargins.SetBottom(0),this.FEdit.SetAlign(5),this.FEdit.FOnChange=rtl.createCallback(this,"EditChange"),this.FEdit.FOnKeyPress=rtl.createCallback(this,"EditKeyPress"),this.FDropDownWidth=135,this.FDropDownHeight=135,this.FShowFocus$1=!0,this.FSelector=this.CreateSelector(),this.AssignEvents(),this.FPopup=pas["WEBLib.TMSFNCPopup"].TTMSFNCPopup.$create("Create$1",[this]),this.FPopup.SetDragWithParent(!0),this.FPopup.FFocusedControl=this.GetFocusedControl(),this.FPopup.SetContentControl(this.FSelector),this.FPopup.SetDropDownWidth(this.FDropDownWidth),this.FPopup.SetDropDownHeight(this.FDropDownHeight),this.FPopup.FOnPopup=rtl.createCallback(this,"DoPopup"),this.FPopup.FOnClosePopup=rtl.createCallback(this,"DoClosePopup"),this.SetWidth(60),this.SetHeight(22),this},this.Destroy=function(){null!=this.FFont$1&&pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FFont$1},set:function(t){this.p.FFont$1=t}}),null!=this.FSelector&&pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FSelector},set:function(t){this.p.FSelector=t}}),null!=this.FPopup&&pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FPopup},set:function(t){this.p.FPopup=t}}),pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Destroy.call(this)},this.DropDown=function(){this.FPopup.SetPlacementControl(this),this.FPopup.FIsOpen?this.FPopup.SetIsOpen(!1):(this.CalcSize(),this.FPopup.SetIsOpen(!0))},this.BeginUpdate=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBase.BeginUpdate.call(this),this.FUpdateCount$1+=1,null!=this.FSelector&&this.FSelector.BeginUpdate()},this.EndUpdate=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBase.EndUpdate.call(this),this.FUpdateCount$1-=1,null!=this.FSelector&&this.FSelector.EndUpdate()},rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas["WEBLib.TMSFNCTypes"].ITMSFNCProductInfo),rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TTMSFNCDefaultPicker",this.TTMSFNCCustomPicker,(function(){rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas["WEBLib.TMSFNCTypes"].ITMSFNCProductInfo),rtl.addIntf(this,pas.System.IUnknown);var t=this.$rtti;t.addProperty("DefaultStyle",2,rtl.boolean,"FDefaultStyle","SetDefaultStyle",{Default:!0}),t.addProperty("Fill",3,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"GetFill","SetFill$1"),t.addProperty("Stroke",3,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"GetStroke","SetStroke$1"),t.addProperty("Font",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFont,"FFont$1","SetFnt"),t.addProperty("Version",1,rtl.string,"GetVersion",""),t.addProperty("OnPopup",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnPopup","FOnPopup"),t.addProperty("OnClosePopup",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnClosePopup","FOnClosePopup")})),this.$implcode=function(){rtl.createClass(t,"TTMSFNCOpenCustomSelector",pas["WEBLib.TMSFNCCustomSelector"].TTMSFNCCustomSelector,(function(){rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas["WEBLib.TMSFNCTypes"].ITMSFNCProductInfo),rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(t,"TTMSFNCCustomPickerEdit",pas["WEBLib.StdCtrls"].TEdit,(function(){rtl.addIntf(this,pas.System.IUnknown)}))}}),["SysUtils","WEBLib.TMSFNCUtils","WEBLib.TMSFNCStyles"]),rtl.module("WEBLib.TMSFNCControlPicker",["System","Classes","Types","WEBLib.Controls","WEBLib.TMSFNCCustomPicker","WEBLib.TMSFNCCustomSelector","WEBLib.TMSFNCGraphics","WEBLib.TMSFNCGraphicsTypes","WEBLib.TMSFNCTypes"],(function(){"use strict";var t=this,e=t.$impl;rtl.createInterface(this,"ITMSFNCControlPickerBase","{FF82E121-0510-4FF1-8BB8-A40AA5219095}",["PickerGetContent"],pas.System.IUnknown),rtl.createInterface(this,"ITMSFNCControlPickerItems","{D0FBAC5E-B2AA-46AE-AD21-91DF23AD4FCB}",["PickerSelectItem","PickerGetSelectedItem","PickerGetVisibleItemCount","PickerGetItemCount","PickerGetItemHeight","PickerSetItemHeight","PickerGetItemWidth","PickerSetItemWidth","PickerGetNextSelectableItem","PickerGetPreviousSelectableItem","PickerGetFirstSelectableItem","PickerGetLastSelectableItem"],this.ITMSFNCControlPickerBase),rtl.recNewT(this,"TTMSFNCControlPickerFilterItem",(function(){this.ItemIndex=0,this.ItemText="",this.$eq=function(t){return this.ItemIndex===t.ItemIndex&&this.ItemText===t.ItemText},this.$assign=function(t){return this.ItemIndex=t.ItemIndex,this.ItemText=t.ItemText,this}})),rtl.createInterface(this,"ITMSFNCControlPickerFull","{3AF9E5D7-2049-4809-920F-BA318E3D8E8D}",["PickerResetFilter","PickerApplyFilter","PickerLookupItem"],this.ITMSFNCControlPickerItems),this.TTMSFNCControlPickerStyle={0:"csDropDown",csDropDown:0,1:"csDropDownList",csDropDownList:1},this.$rtti.$Enum("TTMSFNCControlPickerStyle",{minvalue:0,maxvalue:1,ordtype:1,enumtype:this.TTMSFNCControlPickerStyle}),this.TTMSFNCControlPickderDropDownHeightMode={0:"chmDropDownHeight",chmDropDownHeight:0,1:"chmControl",chmControl:1,2:"chmItems",chmItems:2,3:"chmPickerHeight",chmPickerHeight:3},this.$rtti.$Enum("TTMSFNCControlPickderDropDownHeightMode",{minvalue:0,maxvalue:3,ordtype:1,enumtype:this.TTMSFNCControlPickderDropDownHeightMode}),this.TTMSFNCControlPickderDropDownWidthMode={0:"cwmDropDownWidth",cwmDropDownWidth:0,1:"cwmControl",cwmControl:1,2:"cwmItems",cwmItems:2,3:"cwmPickerWidth",cwmPickerWidth:3},this.$rtti.$Enum("TTMSFNCControlPickderDropDownWidthMode",{minvalue:0,maxvalue:3,ordtype:1,enumtype:this.TTMSFNCControlPickderDropDownWidthMode}),this.$rtti.$MethodVar("TTMSFNCCustomControlPickerItemSelectedEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AText",rtl.string],["AItemIndex",rtl.longint]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCCustomControlPickerOnAdjustDropDownSizeEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ASize",rtl.double,1],["AAllow",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCCustomControlPickerOnSetContentEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AText",rtl.string,1],["AAllow",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCCustomControlPickerBeforeDrawContentEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGrahpics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["AContent",rtl.string],["AAllow",rtl.boolean,1],["ADefaultDraw",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCCustomControlPickerAfterDrawContentEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGrahpics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["AContent",rtl.string]]),methodkind:0}),rtl.createClass(this,"TTMSFNCCustomControlPicker",pas["WEBLib.TMSFNCCustomPicker"].TTMSFNCDefaultPicker,(function(){this.$init=function(){pas["WEBLib.TMSFNCCustomPicker"].TTMSFNCDefaultPicker.$init.call(this),this.FAutoCloseUp=!1,this.FAutoComplete=!1,this.FAutoCompleteDelay=0,this.FAutoCompleteNumChar=0,this.FAutoDropDown=!1,this.FCaseSensitive=!1,this.FControl=null,this.FControlParent=null,this.FControlVisible=!1,this.FControlAlign=0,this.FControlLeft=0,this.FControlTop=0,this.FControlWidth=0,this.FControlHeight=0,this.FDropDownHeightMode=0,this.FKeyDown$1=0,this.FFont$2=null,this.FPrevString="",this.FStyle=0,this.FTick=0,this.FWrapper=null,this.FOnAdjustDropDownHeight=null,this.FOnAfterDrawPickerContent=null,this.FOnBeforeDrawPickerContent=null,this.FOnItemSelected$1=null,this.FOnSetContent=null,this.FDropDownWidthMode=0,this.FOnAdjustDropDownWidth=null,this.FDropDownControlWidth=0,this.FDropDownControlHeight=0},this.$final=function(){this.FControl=void 0,this.FControlParent=void 0,this.FFont$2=void 0,this.FWrapper=void 0,this.FOnAdjustDropDownHeight=void 0,this.FOnAfterDrawPickerContent=void 0,this.FOnBeforeDrawPickerContent=void 0,this.FOnItemSelected$1=void 0,this.FOnSetContent=void 0,this.FOnAdjustDropDownWidth=void 0,pas["WEBLib.TMSFNCCustomPicker"].TTMSFNCDefaultPicker.$final.call(this)},this.SetAutoCloseUp=function(t){this.FAutoCloseUp=t},this.SetAutoComplete=function(t){this.FAutoComplete=t},this.SetAutoCompleteDelay=function(t){this.FAutoCompleteDelay=t},this.SetAutoCompleteNumChar=function(t){this.FAutoCompleteNumChar=t>0?t:1},this.SetAutoDropDown=function(t){this.FAutoDropDown=t},this.SetControl=function(t){t!==this&&(4 in this.FComponentState?this.FControl=t:(0 in this.FComponentState||null==this.FControl||(this.FControl.SetParent(this.FControlParent),this.FControl.SetVisible(this.FControlVisible),this.FControl.SetAlign(this.FControlAlign),this.FControl.SetLeft(Math.round(this.FControlLeft)),this.FControl.SetTop(Math.round(this.FControlTop)),this.FControl.SetWidth(Math.round(this.FControlWidth)),this.FControl.SetHeight(Math.round(this.FControlHeight))),this.FControl=t,null!=this.FControl?(this.FControlParent=this.FControl.FParent,this.FControlVisible=this.FControl.FVisible,this.FControlAlign=this.FControl.FAlign,this.FControl.SetAlign(0),this.FControlLeft=this.FControl.GetLeft(),this.FControlTop=this.FControl.GetTop(),this.FControlWidth=this.FControl.GetWidth(),this.FControlHeight=this.FControl.GetHeight(),this.FControl.SetParent(this.FWrapper),this.FControl.SetVisible(!0),this.FControl.SetLeft(0),this.FControl.SetTop(0)):(this.FControlParent=null,this.FControlVisible=!1,this.FControlAlign=0,this.FControlLeft=0,this.FControlTop=0,this.FControlWidth=0,this.FControlHeight=0),this.UpdatePickerContent(),this.AdjustDropDownHeight(),this.AdjustDropDownWidth()),this.Invalidate())},this.SetDropDownHeightMode=function(t){t!==this.FDropDownHeightMode&&(this.FDropDownHeightMode=t,this.AdjustDropDownHeight())},this.SetFnt$1=function(t){this.FFont$2.AssignSource(t)},this.SetItemHeight=function(e){var i=null,s=null,o=rtl.createIntfRefs();try{null!=this.FControl&&(pas.SysUtils.Supports$1(o.ref(1,rtl.queryIntfT(this.FControl,pas.System.IUnknown)),rtl.getIntfGUIDR(t.ITMSFNCControlPickerItems),{get:function(){return i},set:function(t){i=t}})?i.PickerSetItemHeight(e):pas.SysUtils.Supports$1(o.ref(2,rtl.queryIntfT(this.FControl,pas.System.IUnknown)),rtl.getIntfGUIDR(t.ITMSFNCControlPickerFull),{get:function(){return s},set:function(t){s=t}})&&s.PickerSetItemHeight(e)),this.AdjustDropDownHeight()}finally{o.free(),rtl._Release(i),rtl._Release(s)}},this.SetItemIndex=function(e){var i=null,s=null,o=rtl.createIntfRefs();try{null!=this.FControl&&e>=0&&e<this.GetCount()&&(pas.SysUtils.Supports$1(o.ref(1,rtl.queryIntfT(this.FControl,pas.System.IUnknown)),rtl.getIntfGUIDR(t.ITMSFNCControlPickerItems),{get:function(){return i},set:function(t){i=t}})?i.PickerSelectItem(e):pas.SysUtils.Supports$1(o.ref(2,rtl.queryIntfT(this.FControl,pas.System.IUnknown)),rtl.getIntfGUIDR(t.ITMSFNCControlPickerFull),{get:function(){return s},set:function(t){s=t}})&&s.PickerSelectItem(e),this.UpdatePickerContent(),this.DoPickerItemSelected(this.GetContent(),e),this.Invalidate())}finally{o.free(),rtl._Release(i),rtl._Release(s)}},this.SetStyle=function(t){if(this.FStyle!==t){this.FStyle=t;var e=this.FStyle;0===e?(this.SetEditable(!0),this.GetPopup().FFocusedControl=this.FEdit,this.GetPopup().FStaysOpen=!0):1===e&&(this.SetEditable(!1),null!=this.FControl&&(this.GetPopup().FFocusedControl=this.FControl),this.GetPopup().FStaysOpen=!1)}},this.SetText=function(t){this.SetContent(t)},this.SetCaseSensitive=function(t){this.FCaseSensitive=t},this.GetItemIndex=function(){var e=0,i=null,s=null,o=rtl.createIntfRefs();try{e=-1,null!=this.FControl&&pas.SysUtils.Supports$1(o.ref(1,rtl.queryIntfT(this.FControl,pas.System.IUnknown)),rtl.getIntfGUIDR(t.ITMSFNCControlPickerItems),{get:function(){return i},set:function(t){i=t}})?e=i.PickerGetSelectedItem():null!=this.FControl&&pas.SysUtils.Supports$1(o.ref(2,rtl.queryIntfT(this.FControl,pas.System.IUnknown)),rtl.getIntfGUIDR(t.ITMSFNCControlPickerFull),{get:function(){return s},set:function(t){s=t}})&&(e=s.PickerGetSelectedItem())}finally{o.free(),rtl._Release(i),rtl._Release(s)}return e},this.GetItemHeight=function(){var e=0,i=null,s=null,o=rtl.createIntfRefs();try{e=0,null!=this.FControl&&(e=pas.SysUtils.Supports$1(o.ref(1,rtl.queryIntfT(this.FControl,pas.System.IUnknown)),rtl.getIntfGUIDR(t.ITMSFNCControlPickerItems),{get:function(){return i},set:function(t){i=t}})?i.PickerGetItemHeight():pas.SysUtils.Supports$1(o.ref(2,rtl.queryIntfT(this.FControl,pas.System.IUnknown)),rtl.getIntfGUIDR(t.ITMSFNCControlPickerFull),{get:function(){return s},set:function(t){s=t}})?s.PickerGetItemHeight():this.FControlHeight)}finally{o.free(),rtl._Release(i),rtl._Release(s)}return e},this.GetText=function(){return this.GetContent()},this.GetCount=function(){var e=0,i=null,s=null,o=rtl.createIntfRefs();try{e=0,null!=this.FControl&&(e=pas.SysUtils.Supports$1(o.ref(1,rtl.queryIntfT(this.FControl,pas.System.IUnknown)),rtl.getIntfGUIDR(t.ITMSFNCControlPickerItems),{get:function(){return i},set:function(t){i=t}})?i.PickerGetItemCount():pas.SysUtils.Supports$1(o.ref(2,rtl.queryIntfT(this.FControl,pas.System.IUnknown)),rtl.getIntfGUIDR(t.ITMSFNCControlPickerFull),{get:function(){return s},set:function(t){s=t}})?s.PickerGetItemCount():1)}finally{o.free(),rtl._Release(i),rtl._Release(s)}return e},this.ApplyFilter=function(e){var i=null,s=rtl.createIntfRefs();try{null!=this.FControl&&pas.SysUtils.Supports$1(s.ref(1,rtl.queryIntfT(this.FControl,pas.System.IUnknown)),rtl.getIntfGUIDR(t.ITMSFNCControlPickerFull),{get:function(){return i},set:function(t){i=t}})&&i.PickerApplyFilter(e,this.FCaseSensitive)}finally{s.free(),rtl._Release(i)}},this.ClearFilter=function(){var e=null,i=rtl.createIntfRefs();try{null!=this.FControl&&pas.SysUtils.Supports$1(i.ref(1,rtl.queryIntfT(this.FControl,pas.System.IUnknown)),rtl.getIntfGUIDR(t.ITMSFNCControlPickerFull),{get:function(){return e},set:function(t){e=t}})&&e.PickerResetFilter()}finally{i.free(),rtl._Release(e)}},this.LookupItem=function(e){var i=t.TTMSFNCControlPickerFilterItem.$new(),s=null,o=rtl.createIntfRefs();try{i.ItemIndex=-1,i.ItemText="",null!=this.FControl&&pas.SysUtils.Supports$1(o.ref(1,rtl.queryIntfT(this.FControl,pas.System.IUnknown)),rtl.getIntfGUIDR(t.ITMSFNCControlPickerFull),{get:function(){return s},set:function(t){s=t}})&&i.$assign(s.PickerLookupItem(e,this.FCaseSensitive))}finally{o.free(),rtl._Release(s)}return i},this.SetDropDownWidthMode=function(t){t!==this.FDropDownWidthMode&&(this.FDropDownWidthMode=t,this.AdjustDropDownWidth())},this.GetItemWidth=function(){var e=0,i=null,s=null,o=rtl.createIntfRefs();try{e=0,null!=this.FControl&&(e=pas.SysUtils.Supports$1(o.ref(1,rtl.queryIntfT(this.FControl,pas.System.IUnknown)),rtl.getIntfGUIDR(t.ITMSFNCControlPickerItems),{get:function(){return i},set:function(t){i=t}})?i.PickerGetItemWidth():pas.SysUtils.Supports$1(o.ref(2,rtl.queryIntfT(this.FControl,pas.System.IUnknown)),rtl.getIntfGUIDR(t.ITMSFNCControlPickerFull),{get:function(){return s},set:function(t){s=t}})?s.PickerGetItemWidth():this.FControlWidth)}finally{o.free(),rtl._Release(i),rtl._Release(s)}return e},this.SetItemWidth=function(e){var i=null,s=null,o=rtl.createIntfRefs();try{null!=this.FControl&&(pas.SysUtils.Supports$1(o.ref(1,rtl.queryIntfT(this.FControl,pas.System.IUnknown)),rtl.getIntfGUIDR(t.ITMSFNCControlPickerItems),{get:function(){return i},set:function(t){i=t}})?i.PickerSetItemWidth(e):pas.SysUtils.Supports$1(o.ref(2,rtl.queryIntfT(this.FControl,pas.System.IUnknown)),rtl.getIntfGUIDR(t.ITMSFNCControlPickerFull),{get:function(){return s},set:function(t){s=t}})&&s.PickerSetItemWidth(e)),this.AdjustDropDownWidth()}finally{o.free(),rtl._Release(i),rtl._Release(s)}},this.SetDropDownControlHeight=function(t){this.FDropDownControlHeight!==t&&(this.FDropDownControlHeight=t,this.AdjustDropDownHeight())},this.SetDropDownControlWidth=function(t){this.FDropDownControlWidth!==t&&(this.FDropDownControlWidth=t,this.AdjustDropDownWidth())},this.Notification=function(t,e){pas["WEBLib.Menus"].TWebCustomControl.Notification.apply(this,arguments),1===e&&t===this.FControl&&(this.FControl=null)},this.FontChange=function(t){this.Invalidate()},this.Loaded=function(){pas["WEBLib.Controls"].TCustomControl.Loaded.call(this),this.AdjustDropDownHeight(),this.SetControl(this.FControl)},this.DoPickerItemSelected=function(t,e){null!=this.FOnItemSelected$1&&this.FOnItemSelected$1(this,t,e)},this.DoAdjustDropDownHeight=function(t,e){null!=this.FOnAdjustDropDownHeight&&this.FOnAdjustDropDownHeight(this,t,e)},this.DoAdjustDropDownWidth=function(t,e){null!=this.FOnAdjustDropDownWidth&&this.FOnAdjustDropDownWidth(this,t,e)},this.DoAfterDrawPickerContent=function(t,e,i){null!=this.FOnAfterDrawPickerContent&&this.FOnAfterDrawPickerContent(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i)},this.DoBeforeDrawPickerContent=function(t,e,i,s,o){null!=this.FOnBeforeDrawPickerContent&&this.FOnBeforeDrawPickerContent(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i,s,o)},this.DoSetContent=function(t,e){null!=this.FOnSetContent&&this.FOnSetContent(this,t,e)},this.DrawContent=function(t,e){var i=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),s=!1,o=!1;pas["WEBLib.TMSFNCCustomPicker"].TTMSFNCCustomPicker.DrawContent.apply(this,arguments),this.FEnabled?t.FFont.AssignSource(this.FFont$2):t.FFont.SetColor(12632256),i.$assign(e),pas["WEBLib.TMSFNCTypes"].InflateRectEx(i,-3,-3),s=!0,o=!0,this.DoBeforeDrawPickerContent(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),this.GetContent(),{get:function(){return s},set:function(t){s=t}},{get:function(){return o},set:function(t){o=t}}),s&&(o&&t.DrawText$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),this.GetContent(),!1,1,0,0,0,-1,-1,!0,!1,-1,-1),this.DoAfterDrawPickerContent(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),this.GetContent()))},this.InitializePopup=function(){pas["WEBLib.TMSFNCCustomPicker"].TTMSFNCCustomPicker.InitializePopup.call(this),null!=this.FControl&&(this.FControl.SetWidth(Math.round(this.FDropDownWidth)),this.FControl.SetHeight(Math.round(this.FDropDownHeight)))},this.SelectFirstValue=function(){var e=0,i=null,s=null,o=rtl.createIntfRefs();try{pas["WEBLib.TMSFNCCustomPicker"].TTMSFNCCustomPicker.SelectFirstValue.call(this),null!=this.FControl&&(e=-1,pas.SysUtils.Supports$1(o.ref(1,rtl.queryIntfT(this.FControl,pas.System.IUnknown)),rtl.getIntfGUIDR(t.ITMSFNCControlPickerItems),{get:function(){return i},set:function(t){i=t}})?e=i.PickerGetFirstSelectableItem():pas.SysUtils.Supports$1(o.ref(2,rtl.queryIntfT(this.FControl,pas.System.IUnknown)),rtl.getIntfGUIDR(t.ITMSFNCControlPickerFull),{get:function(){return s},set:function(t){s=t}})&&(e=s.PickerGetFirstSelectableItem()),this.SetItemIndex(e))}finally{o.free(),rtl._Release(i),rtl._Release(s)}},this.SelectLastValue=function(){var e=0,i=null,s=null,o=rtl.createIntfRefs();try{pas["WEBLib.TMSFNCCustomPicker"].TTMSFNCCustomPicker.SelectLastValue.call(this),null!=this.FControl&&(e=-1,pas.SysUtils.Supports$1(o.ref(1,rtl.queryIntfT(this.FControl,pas.System.IUnknown)),rtl.getIntfGUIDR(t.ITMSFNCControlPickerItems),{get:function(){return i},set:function(t){i=t}})?e=i.PickerGetLastSelectableItem():pas.SysUtils.Supports$1(o.ref(2,rtl.queryIntfT(this.FControl,pas.System.IUnknown)),rtl.getIntfGUIDR(t.ITMSFNCControlPickerFull),{get:function(){return s},set:function(t){s=t}})&&(e=s.PickerGetLastSelectableItem()),this.SetItemIndex(e))}finally{o.free(),rtl._Release(i),rtl._Release(s)}},this.SelectNextValue=function(){var e=0,i=null,s=null,o=rtl.createIntfRefs();try{pas["WEBLib.TMSFNCCustomPicker"].TTMSFNCCustomPicker.SelectNextValue.call(this),null!=this.FControl&&(e=-1,pas.SysUtils.Supports$1(o.ref(1,rtl.queryIntfT(this.FControl,pas.System.IUnknown)),rtl.getIntfGUIDR(t.ITMSFNCControlPickerItems),{get:function(){return i},set:function(t){i=t}})?e=i.PickerGetNextSelectableItem(this.GetItemIndex()):pas.SysUtils.Supports$1(o.ref(2,rtl.queryIntfT(this.FControl,pas.System.IUnknown)),rtl.getIntfGUIDR(t.ITMSFNCControlPickerFull),{get:function(){return s},set:function(t){s=t}})&&(e=s.PickerGetNextSelectableItem(this.GetItemIndex())),this.SetItemIndex(e))}finally{o.free(),rtl._Release(i),rtl._Release(s)}},this.SelectPreviousValue=function(){var e=0,i=null,s=null,o=rtl.createIntfRefs();try{pas["WEBLib.TMSFNCCustomPicker"].TTMSFNCCustomPicker.SelectPreviousValue.call(this),null!=this.FControl&&(e=-1,pas.SysUtils.Supports$1(o.ref(1,rtl.queryIntfT(this.FControl,pas.System.IUnknown)),rtl.getIntfGUIDR(t.ITMSFNCControlPickerItems),{get:function(){return i},set:function(t){i=t}})?e=i.PickerGetPreviousSelectableItem(this.GetItemIndex()):pas.SysUtils.Supports$1(o.ref(2,rtl.queryIntfT(this.FControl,pas.System.IUnknown)),rtl.getIntfGUIDR(t.ITMSFNCControlPickerFull),{get:function(){return s},set:function(t){s=t}})&&(e=s.PickerGetPreviousSelectableItem(this.GetItemIndex())),this.SetItemIndex(e))}finally{o.free(),rtl._Release(i),rtl._Release(s)}},this.SetAdaptToStyle=function(t){var e=null,i=rtl.createIntfRefs();try{pas["WEBLib.TMSFNCCustomPicker"].TTMSFNCCustomPicker.SetAdaptToStyle.apply(this,arguments),null!=this.FWrapper&&this.FWrapper.SetAdaptToStyle(this.GetAdaptToStyle()),null!=this.FControl&&pas.SysUtils.Supports$1(i.ref(1,rtl.queryIntfT(this.FControl,pas.System.IUnknown)),rtl.getIntfGUIDR(pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),{get:function(){return e},set:function(t){e=t}})&&e.SetAdaptToStyle(this.GetAdaptToStyle())}finally{i.free(),rtl._Release(e)}},this.AdjustDropDownHeight=function(){var t=0,e=!1;t=null!=this.FControl&&2===this.FDropDownHeightMode?this.GetItemHeight()*this.GetVisibleItemCount():null!=this.FControl&&1===this.FDropDownHeightMode?this.FControlHeight:3===this.FDropDownHeightMode?this.GetHeight():this.FDropDownControlHeight,e=!0,this.DoAdjustDropDownHeight({get:function(){return t},set:function(e){t=e}},{get:function(){return e},set:function(t){e=t}}),e&&this.SetDropDownHeight(t)},this.AdjustDropDownWidth=function(){var t=0,e=!1;t=null!=this.FControl&&2===this.FDropDownWidthMode?this.GetItemWidth()*this.GetVisibleItemCount():null!=this.FControl&&1===this.FDropDownWidthMode?this.FControlWidth:3===this.FDropDownWidthMode?this.GetWidth():this.FDropDownControlWidth,e=!0,this.DoAdjustDropDownWidth({get:function(){return t},set:function(e){t=e}},{get:function(){return e},set:function(t){e=t}}),e&&this.SetDropDownWidth(t)},this.UpdateListBoxLookup=function(t){this.ClearFilter(),this.ApplyFilter(t),this.FAutoDropDown&&t.length>=this.FAutoCompleteNumChar&&!this.GetPopup().FIsOpen&&this.GetVisibleItemCount()>0&&this.DropDown()},this.DeleteFromEdit=function(){this.FPrevString=this.FEdit.GetText(),0===this.FEdit.GetSelLength()?pas.System.Delete({p:this,get:function(){return this.p.FPrevString},set:function(t){this.p.FPrevString=t}},this.FEdit.GetSelStart(),1):pas.System.Delete({p:this,get:function(){return this.p.FPrevString},set:function(t){this.p.FPrevString=t}},Math.max(1,this.FEdit.GetSelStart()+1),this.FEdit.GetSelLength()),this.UpdateListBoxLookup(this.FPrevString),this.FPrevString.length<this.FAutoCompleteNumChar&&this.GetPopup().FIsOpen&&(this.DropDown(),this.ClearFilter())},this.EditKeyDown$1=function(t,e,i){this.FKeyDown$1=e.get(),this.FKeyDown$1 in rtl.createSet(38,40)&&(38===this.FKeyDown$1&&this.SelectPreviousValue(),40===this.FKeyDown$1&&this.SelectNextValue(),e.set(0)),8===this.FKeyDown$1&&this.DeleteFromEdit()},this.EditKeyPress$1=function(e,i){var s,o=t.TTMSFNCControlPickerFilterItem.$new(),n=0,r=0;if(null!=this.FControl){if(s=i.get(),27===this.FKeyDown$1)return this.FAutoCloseUp&&this.GetPopup().FIsOpen,void this.DropDown();if(13===this.FKeyDown$1)return this.GetPopup().FIsOpen&&(this.FEdit.SetSelStart(this.FEdit.GetText().length),this.FEdit.SetSelLength(0),this.ClearFilter()),this.UpdatePickerContent(),void this.DropDown();if(this.FAutoComplete){if("\0"===s)return;if(this.FEdit.GetSelLength()===this.FEdit.GetText().length&&(this.FPrevString=""),this.FPrevString=this.FPrevString+s,this.FPrevString.length<this.FAutoCompleteNumChar)return;this.UpdateListBoxLookup(this.FPrevString),o.$assign(this.LookupItem(this.FPrevString)),o.ItemIndex>=0&&(this.SetItemIndex(o.ItemIndex),n=this.FPrevString.length,this.SetContent(o.ItemText),this.FEdit.SetSelStart(n),r=this.FEdit.GetText().length-n,this.FEdit.SetSelLength(r),i.set("\0"),this.FAutoCloseUp&&0===r&&this.GetPopup().FIsOpen&&this.DropDown())}}},this.KeyPress=function(i){var s=t.TTMSFNCControlPickerFilterItem.$new(),o="",n=0;if(pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBase.KeyPress.apply(this,arguments),null!=this.FControl){if(o=i.get(),27===this.FKeyDown$1)return this.GetPopup().FIsOpen,void this.DropDown();if(this.FAutoComplete){if(8===this.FKeyDown$1)return pas.System.Delete({p:this,get:function(){return this.p.FPrevString},set:function(t){this.p.FPrevString=t}},this.FPrevString.length,1),void(1===this.FPrevString.length&&this.GetPopup().FIsOpen&&(this.DropDown(),this.ClearFilter()));if("\0"===o)return;this.FAutoDropDown&&!this.GetPopup().FIsOpen&&this.DropDown(),n=this.FAutoCompleteDelay,e.GetTickCountX()-this.FTick<n?this.FPrevString=this.FPrevString+o:(this.FTick=e.GetTickCountX(),this.FPrevString=o)}else{if("\0"===o)return;this.FPrevString=o}s.$assign(this.LookupItem(this.FPrevString)),s.ItemIndex>=0&&(this.SetItemIndex(s.ItemIndex),this.SetContent(s.ItemText),this.Invalidate(),this.FAutoComplete&&this.GetContent()===this.FPrevString&&this.FAutoCloseUp&&this.GetPopup().FIsOpen&&this.DropDown())}},this.KeyDown=function(t,e){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBase.KeyDown.apply(this,arguments),this.FKeyDown$1=t.get()},this.CreateSelector=function(){return this.FWrapper=pas["WEBLib.TMSFNCCustomSelector"].TTMSFNCCustomSelector.$create("Create$1",[this]),null!=this.FControl&&(this.FControl.SetParent(this.FWrapper),this.UpdatePickerContent()),this.FWrapper},this.GetVisibleItemCount=function(){var e=0,i=null,s=null,o=rtl.createIntfRefs();try{e=0,null!=this.FControl&&(e=pas.SysUtils.Supports$1(o.ref(1,rtl.queryIntfT(this.FControl,pas.System.IUnknown)),rtl.getIntfGUIDR(t.ITMSFNCControlPickerItems),{get:function(){return i},set:function(t){i=t}})?i.PickerGetVisibleItemCount():pas.SysUtils.Supports$1(o.ref(2,rtl.queryIntfT(this.FControl,pas.System.IUnknown)),rtl.getIntfGUIDR(t.ITMSFNCControlPickerFull),{get:function(){return s},set:function(t){s=t}})?s.PickerGetVisibleItemCount():1)}finally{o.free(),rtl._Release(i),rtl._Release(s)}return e},this.Create$1=function(t){return pas["WEBLib.TMSFNCCustomPicker"].TTMSFNCCustomPicker.Create$1.apply(this,arguments),this.SetWidth(150),this.FDropDownControlWidth=this.GetWidth(),this.FDropDownControlHeight=150,this.SetEditable(!0),this.FPrevString="",this.FAutoComplete=!0,this.FAutoCloseUp=!1,this.FAutoDropDown=!1,this.FCaseSensitive=!1,this.FAutoCompleteNumChar=2,this.FAutoCompleteDelay=500,this.FFont$2=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFont.$create("Create$2"),this.FFont$2.FOnChanged=rtl.createCallback(this,"FontChange"),this.FEdit.FOnKeyDown=rtl.createCallback(this,"EditKeyDown$1"),this.FEdit.FOnKeyPress=rtl.createCallback(this,"EditKeyPress$1"),this.FEdit.FFont.Assign(this.FFont$2),this.GetPopup().FFocusedControl=this.FEdit,this.GetPopup().FStaysOpen=!0,this.FDropDownHeightMode=0,this.FDropDownWidthMode=0,this.IsDesignTime()&&this.SetText("TTMSFNCControlPicker"),this},this.Destroy=function(){rtl.free(this,"FFont$2"),pas["WEBLib.TMSFNCCustomPicker"].TTMSFNCCustomPicker.Destroy.call(this)},this.CallItemClicked=function(t){this.UpdatePickerContent(),this.ClearFilter(),this.SetItemIndex(t),this.DropDown(),this.Invalidate()},this.UpdatePickerContent=function(){var e=null,i=null,s=null,o="",n=!1,r=rtl.createIntfRefs();try{o=this.GetContent(),pas.SysUtils.Supports$1(r.ref(1,rtl.queryIntfT(this.FControl,pas.System.IUnknown)),rtl.getIntfGUIDR(t.ITMSFNCControlPickerBase),{get:function(){return e},set:function(t){e=t}})?o=e.PickerGetContent():pas.SysUtils.Supports$1(r.ref(2,rtl.queryIntfT(this.FControl,pas.System.IUnknown)),rtl.getIntfGUIDR(t.ITMSFNCControlPickerItems),{get:function(){return i},set:function(t){i=t}})?o=i.PickerGetContent():pas.SysUtils.Supports$1(r.ref(3,rtl.queryIntfT(this.FControl,pas.System.IUnknown)),rtl.getIntfGUIDR(t.ITMSFNCControlPickerFull),{get:function(){return s},set:function(t){s=t}})&&(o=s.PickerGetContent()),n=!0,this.DoSetContent({get:function(){return o},set:function(t){o=t}},{get:function(){return n},set:function(t){n=t}}),n&&this.SetContent(o)}finally{r.free(),rtl._Release(e),rtl._Release(i),rtl._Release(s)}},this.UpdateDropDown=function(){this.UpdatePickerContent(),this.DropDown(),this.Invalidate()},this.DropDown=function(){this.AdjustDropDownHeight(),this.AdjustDropDownWidth(),this.GetPopup().SetWidth(Math.round(this.FDropDownWidth)),this.GetPopup().SetHeight(Math.round(this.FDropDownHeight)),pas["WEBLib.TMSFNCCustomPicker"].TTMSFNCCustomPicker.DropDown.call(this)},rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas["WEBLib.TMSFNCTypes"].ITMSFNCProductInfo),rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TTMSFNCControlPicker",this.TTMSFNCCustomControlPicker,(function(){this.RegisterRuntimeClasses=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.RegisterRuntimeClasses.call(this),pas.Classes.RegisterClass(t.TTMSFNCControlPicker)},rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas["WEBLib.TMSFNCTypes"].ITMSFNCProductInfo),rtl.addIntf(this,pas.System.IUnknown);var e=this.$rtti;e.addProperty("AutoCloseUp",2,rtl.boolean,"FAutoCloseUp","SetAutoCloseUp",{Default:!1}),e.addProperty("AutoDropDown",2,rtl.boolean,"FAutoDropDown","SetAutoDropDown",{Default:!1}),e.addProperty("AutoComplete",2,rtl.boolean,"FAutoComplete","SetAutoComplete",{Default:!0}),e.addProperty("AutoCompleteDelay",2,rtl.longint,"FAutoCompleteDelay","SetAutoCompleteDelay",{Default:500}),e.addProperty("AutoCompleteNumChar",2,rtl.longint,"FAutoCompleteNumChar","SetAutoCompleteNumChar",{Default:2}),e.addProperty("Control",2,pas["WEBLib.Controls"].$rtti.TControl,"FControl","SetControl"),e.addProperty("CaseSensitive",2,rtl.boolean,"FCaseSensitive","SetCaseSensitive",{Default:!1}),e.addProperty("DropDownControlHeight",2,rtl.double,"FDropDownControlHeight","SetDropDownControlHeight"),e.addProperty("DropDownControlWidth",2,rtl.double,"FDropDownControlWidth","SetDropDownControlWidth"),e.addProperty("DropDownHeightMode",2,t.$rtti.TTMSFNCControlPickderDropDownHeightMode,"FDropDownHeightMode","SetDropDownHeightMode",{Default:t.TTMSFNCControlPickderDropDownHeightMode.chmDropDownHeight}),e.addProperty("DropDownWidthMode",2,t.$rtti.TTMSFNCControlPickderDropDownWidthMode,"FDropDownWidthMode","SetDropDownWidthMode",{Default:t.TTMSFNCControlPickderDropDownWidthMode.cwmDropDownWidth}),e.addProperty("Font",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFont,"FFont$2","SetFnt$1"),e.addProperty("ItemIndex",3,rtl.longint,"GetItemIndex","SetItemIndex",{Default:-1}),e.addProperty("ItemHeight",3,rtl.double,"GetItemHeight","SetItemHeight"),e.addProperty("ItemWidth",3,rtl.double,"GetItemWidth","SetItemWidth"),e.addProperty("ShowFocus",2,rtl.boolean,"FShowFocus$1","SetShowFocus$1",{Default:!0}),e.addProperty("Style",2,t.$rtti.TTMSFNCControlPickerStyle,"FStyle","SetStyle",{Default:t.TTMSFNCControlPickerStyle.csDropDown}),e.addProperty("Text",3,rtl.string,"GetText","SetText"),e.addProperty("OnAdjustDropDownHeight",0,t.$rtti.TTMSFNCCustomControlPickerOnAdjustDropDownSizeEvent,"FOnAdjustDropDownHeight","FOnAdjustDropDownHeight"),e.addProperty("OnAdjustDropDownWidth",0,t.$rtti.TTMSFNCCustomControlPickerOnAdjustDropDownSizeEvent,"FOnAdjustDropDownWidth","FOnAdjustDropDownWidth"),e.addProperty("OnAfterDrawPickerContent",0,t.$rtti.TTMSFNCCustomControlPickerAfterDrawContentEvent,"FOnAfterDrawPickerContent","FOnAfterDrawPickerContent"),e.addProperty("OnBeforeDrawPickerContent",0,t.$rtti.TTMSFNCCustomControlPickerBeforeDrawContentEvent,"FOnBeforeDrawPickerContent","FOnBeforeDrawPickerContent"),e.addProperty("OnItemSelected",0,t.$rtti.TTMSFNCCustomControlPickerItemSelectedEvent,"FOnItemSelected$1","FOnItemSelected$1"),e.addProperty("OnSetContent",0,t.$rtti.TTMSFNCCustomControlPickerOnSetContentEvent,"FOnSetContent","FOnSetContent"),e.attr=[pas.Classes.ComponentPlatformsAttribute,"Create$1",[0]]})),t.$implcode=function(){e.GetTickCountX=function(){var t=0,e=0,i=0,s=0;return pas.SysUtils.DecodeTime(pas.SysUtils.Now(),{get:function(){return t},set:function(e){t=e}},{get:function(){return e},set:function(t){e=t}},{get:function(){return i},set:function(t){i=t}},{get:function(){return s},set:function(t){s=t}}),s+1e3*i+60*e*1e3+60*t*60*1e3}}}),["Math","SysUtils","WEBLib.Graphics","WEBLib.TMSFNCStyles","WEBLib.TMSFNCUtils","WEBLib.StdCtrls"]),rtl.module("WEBLib.TMSFNCTreeView",["System","Classes","WEBLib.TMSFNCCustomTreeView","WEBLib.TMSFNCGraphics","WEBLib.TMSFNCTreeViewData","WEBLib.TMSFNCTypes","WEBLib.TMSFNCGraphicsTypes","WEBLib.TMSFNCControlPicker"],(function(){"use strict";var t=this,e=t.$impl;rtl.createClass(this,"TTMSFNCTreeView",pas["WEBLib.TMSFNCCustomTreeView"].TTMSFNCTreeViewPublished,(function(){this.RegisterRuntimeClasses=function(){pas["WEBLib.TMSFNCCustomTreeView"].TTMSFNCCustomTreeView.RegisterRuntimeClasses.call(this),pas.Classes.RegisterClasses([t.TTMSFNCTreeView,pas["WEBLib.TMSFNCTreeViewData"].TTMSFNCTreeViewColumn,pas["WEBLib.TMSFNCTreeViewData"].TTMSFNCTreeViewNode,pas["WEBLib.TMSFNCTreeViewData"].TTMSFNCTreeViewNodeValue])},this.DoAfterSelectNode=function(t){pas["WEBLib.TMSFNCCustomTreeView"].TTMSFNCCustomTreeView.DoAfterSelectNode.apply(this,arguments),null!=this.FParent&&pas["WEBLib.TMSFNCCustomSelector"].TTMSFNCCustomSelector.isPrototypeOf(this.FParent)&&null!=this.FParent.FOwner&&pas["WEBLib.TMSFNCControlPicker"].TTMSFNCControlPicker.isPrototypeOf(this.FParent.FOwner)&&rtl.as(this.FParent.FOwner,pas["WEBLib.TMSFNCControlPicker"].TTMSFNCControlPicker).UpdateDropDown()},this.DrawBorders=function(t){var e=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),i=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),s=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),o=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),n=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),r=pas["WEBLib.TMSFNCTypes"].TRectF.$new();pas["WEBLib.TMSFNCCustomTreeView"].TTMSFNCCustomTreeView.DrawBorders.apply(this,arguments),o.$assign(this.GetGroupsTopRect()),n.$assign(this.GetGroupsBottomRect()),e.$assign(this.GetColumnsTopRect()),i.$assign(this.GetColumnsBottomRect()),r.$assign(this.GetContentClipRect()),s.$assign(pas["WEBLib.TMSFNCTypes"].RectF(r.Right+1,e.Bottom,r.Right+1,i.Top)),t.FStroke.Assign(this.FColumnsAppearance.FTopStroke),s.Right-s.Left>0&&s.Bottom-s.Top>0&&(this.HorizontalScrollBar().FVisible||this.FColumnsAppearance.FStretch?t.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(s.Right,s.Top)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(s.Right,s.Bottom)),3,1):t.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(s.Right,s.Top)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(s.Right,s.Bottom)),2,4)),(this.HorizontalScrollBar().FVisible||this.FColumnsAppearance.FStretch)&&(t.FStroke.Assign(this.FColumnsAppearance.FTopStroke),0 in this.FColumnsAppearance.FLayouts&&this.FColumnsAppearance.FTopSize>0?(t.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(e.Left,e.Top)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(e.Left,e.Bottom)),2,4),t.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(e.Right,e.Top)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(e.Right,e.Bottom)),3,1)):0 in this.FGroupsAppearance.FLayouts||this.FGroupsAppearance.FTopSize<=0||0===this.FDisplayGroups.GetCount()||0===this.FStroke.FKind||t.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(e.Left,e.Bottom)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(e.Right,e.Bottom)),2,3),t.FStroke.Assign(this.FColumnsAppearance.FBottomStroke),1 in this.FColumnsAppearance.FLayouts&&this.FColumnsAppearance.FBottomSize>0?(t.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(i.Left,i.Top)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(i.Left,i.Bottom)),2,4),t.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(i.Right,i.Top)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(i.Right,i.Bottom)),3,1)):(!(1 in this.FGroupsAppearance.FLayouts)||this.FGroupsAppearance.FBottomSize<=0||0===this.FDisplayGroups.GetCount())&&0!==this.FStroke.FKind&&t.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(i.Left,i.Top)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(i.Right,i.Top)),4,1),t.FStroke.Assign(this.FGroupsAppearance.FTopStroke),0 in this.FGroupsAppearance.FLayouts&&this.FDisplayGroups.GetCount()>0&&this.FGroupsAppearance.FTopSize>0&&(t.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(o.Left,o.Top)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(o.Left,o.Bottom)),2,4),t.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(o.Right,o.Top)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(o.Right,o.Bottom)),3,1)),(!(0 in this.FColumnsAppearance.FLayouts)||this.FColumnsAppearance.FTopSize<=0)&&0!==this.FStroke.FKind&&t.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(o.Left,o.Bottom)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(o.Right,o.Bottom)),2,3),t.FStroke.Assign(this.FGroupsAppearance.FBottomStroke),1 in this.FGroupsAppearance.FLayouts&&this.FDisplayGroups.GetCount()>0&&this.FGroupsAppearance.FBottomSize>0&&(t.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(n.Left,n.Top)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(n.Left,n.Bottom)),2,4),t.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(n.Right,n.Top)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(n.Right,n.Bottom)),3,1)),(!(1 in this.FColumnsAppearance.FLayouts)||this.FColumnsAppearance.FBottomSize<=0)&&0!==this.FStroke.FKind&&t.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(n.Left,n.Top)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(n.Right,n.Top)),4,1))},this.DrawEmptySpaces=function(t){var e=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),i=!1,s=!1;pas["WEBLib.TMSFNCCustomTreeView"].TTMSFNCCustomTreeView.DrawEmptySpaces.apply(this,arguments),this.FColumnsAppearance.FFillEmptySpaces&&!this.FStretchScrollBars&&(0 in this.FColumnsAppearance.FLayouts&&this.FColumnsAppearance.FTopSize>0&&(e.$assign(this.GetColumnTopRightEmptyRect()),i=!0,s=!0,t.FFill.Assign(this.FColumnsAppearance.FTopFill),t.FStroke.Assign(this.FColumnsAppearance.FTopStroke),this.DoBeforeDrawColumnEmptySpace(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),1,{get:function(){return i},set:function(t){i=t}},{get:function(){return s},set:function(t){s=t}}),i&&(s&&t.DrawRectangle$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),4),this.DoAfterDrawColumnEmptySpace(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),1))),1 in this.FColumnsAppearance.FLayouts&&this.FColumnsAppearance.FBottomSize>0&&(e.$assign(this.GetColumnBottomRightEmptyRect()),i=!0,s=!0,t.FFill.Assign(this.FColumnsAppearance.FBottomFill),t.FStroke.Assign(this.FColumnsAppearance.FBottomStroke),this.DoBeforeDrawColumnEmptySpace(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),3,{get:function(){return i},set:function(t){i=t}},{get:function(){return s},set:function(t){s=t}}),i&&(s&&t.DrawRectangle$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),10),this.DoAfterDrawColumnEmptySpace(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),3)))),this.FGroupsAppearance.FFillEmptySpaces&&!this.FStretchScrollBars&&(0 in this.FGroupsAppearance.FLayouts&&this.FGroupsAppearance.FTopSize>0&&(e.$assign(this.GetGroupTopRightEmptyRect()),i=!0,s=!0,t.FFill.Assign(this.FGroupsAppearance.FTopFill),t.FStroke.Assign(this.FGroupsAppearance.FTopStroke),this.DoBeforeDrawGroupEmptySpace(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),1,{get:function(){return i},set:function(t){i=t}},{get:function(){return s},set:function(t){s=t}}),i&&(s&&t.DrawRectangle$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),9),this.DoAfterDrawGroupEmptySpace(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),1))),1 in this.FGroupsAppearance.FLayouts&&this.FGroupsAppearance.FBottomSize>0&&(e.$assign(this.GetGroupBottomRightEmptyRect()),i=!0,s=!0,t.FFill.Assign(this.FGroupsAppearance.FBottomFill),t.FStroke.Assign(this.FGroupsAppearance.FBottomStroke),this.DoBeforeDrawGroupEmptySpace(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),3,{get:function(){return i},set:function(t){i=t}},{get:function(){return s},set:function(t){s=t}}),i&&(s&&t.DrawRectangle$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),8),this.DoAfterDrawGroupEmptySpace(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),3))))},this.DrawNodeColumns=function(t){var e=!1,i=!1,s=0,o=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),n=0,r=0,a=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),l=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),h=0,F=null;pas["WEBLib.TMSFNCCustomTreeView"].TTMSFNCCustomTreeView.DrawNodeColumns.apply(this,arguments),a.$assign(this.GetContentRect()),l.$assign(this.GetContentClipRect()),h=this.GetHorizontalScrollPosition();for(var p=1,c=this.FColumnCount-1;p<=c;p++)(s=p)>=0&&s<this.FColumns.GetCount()-1&&(n=pas.System.Int(this.GetColPos(s))-pas.System.Int(h),r=pas.System.Int(this.GetColWidths(s)),-1!==this.FColumnStroke.FColor&&0!==this.FColumnStroke.FKind&&(t.FStroke.Assign(this.FColumnStroke),e=!0,i=!0,o.$assign(pas["WEBLib.TMSFNCTypes"].RectF(n,a.Top,n+r,a.Bottom)),this.DoBeforeDrawColumn(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(o),s,{get:function(){return e},set:function(t){e=t}},{get:function(){return i},set:function(t){i=t}}),e&&(i&&t.DrawRectangle$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(o),5),this.DoAfterDrawColumn(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(o),s))));if(this.FNodeStructure.GetCount()>0)for(var u=0,C=this.FColumnCount-1;u<=C;u++)(s=u)>=0&&s<=this.FColumns.GetCount()-1&&(F=this.FColumns.GetItem$1(s),n=pas.System.Int(this.GetColPos(s))-pas.System.Int(h),r=pas.System.Int(this.GetColWidths(s)),e=!0,i=!0,t.FFill.SetKind(0),t.FStroke.Assign(this.FNodesAppearance.FColumnStroke),F.FUseDefaultAppearance||(t.FStroke.Assign(F.FStroke),t.FFill.Assign(F.FFill)),o.$assign(pas["WEBLib.TMSFNCTypes"].RectF(n,l.Top,n+r,l.Bottom)),this.DoBeforeDrawNodeColumn(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(o),s,{get:function(){return e},set:function(t){e=t}},{get:function(){return i},set:function(t){i=t}}),e&&(i&&t.DrawRectangle$3(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(o),rtl.createSet(1,2,3),5),this.DoAfterDrawNodeColumn(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(o),s)))},this.DrawNode=function(t,e,i,s,o,n){var r="",a=!1,l=!1,h=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),F=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),p=0,c=null,u=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),C=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),T=0,S=0,d=0,m=0,f=null,g=0,y=0,M=null,b=!1,N=0,B=!1,E=0,D=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),L=null,G=!1,A=!1,I=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),P=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),w=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),$=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),R=!1,v=null,W=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),O=null,x=null,k=null,V=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),H=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),U=0,z=!1,K=null,j=null,Y=null,q={},X=0,J={};if(pas["WEBLib.TMSFNCCustomTreeView"].TTMSFNCCustomTreeView.DrawNode.apply(this,arguments),!(null==i||this.FDragNode===i&&this.FDragModeStarted)&&(z=this.FResourceScaleFactor>1,B=!0,this.DoIsNodeEnabled(i,{get:function(){return B},set:function(t){B=t}}),A=!1,this.DoIsNodeExtended(i,{get:function(){return A},set:function(t){A=t}}),R=this.IsVirtualNodeSelected(i),B?R?(A?(t.FFill.Assign(this.FNodesAppearance.FExtendedSelectedFill),t.FStroke.Assign(this.FNodesAppearance.FExtendedSelectedStroke)):(t.FFill.Assign(this.FNodesAppearance.FSelectedFill),t.FStroke.Assign(this.FNodesAppearance.FSelectedStroke)),T=t.FFill.FColor,S=t.FStroke.FColor,this.DoGetNodeSelectedColor(i,{get:function(){return T},set:function(t){T=t}}),this.DoGetNodeSelectedStrokeColor(i,{get:function(){return S},set:function(t){S=t}}),t.FFill.SetColor(T),t.FStroke.SetColor(S)):(A?(t.FFill.Assign(this.FNodesAppearance.FExtendedFill),t.FStroke.Assign(this.FNodesAppearance.FExtendedStroke)):(t.FFill.Assign(this.FNodesAppearance.FFill),t.FStroke.Assign(this.FNodesAppearance.FStroke)),T=t.FFill.FColor,S=t.FStroke.FColor,this.DoGetNodeColor(i,{get:function(){return T},set:function(t){T=t}}),this.DoGetNodeStrokeColor(i,{get:function(){return S},set:function(t){S=t}}),t.FFill.SetColor(T),t.FStroke.SetColor(S)):(A?(t.FFill.Assign(this.FNodesAppearance.FExtendedDisabledFill),t.FStroke.Assign(this.FNodesAppearance.FExtendedDisabledStroke)):(t.FFill.Assign(this.FNodesAppearance.FDisabledFill),t.FStroke.Assign(this.FNodesAppearance.FDisabledStroke)),T=t.FFill.FColor,S=t.FStroke.FColor,this.DoGetNodeDisabledColor(i,{get:function(){return T},set:function(t){T=t}}),this.DoGetNodeDisabledStrokeColor(i,{get:function(){return S},set:function(t){S=t}}),t.FFill.SetColor(T),t.FStroke.SetColor(S)),l=!0,a=!0,this.DoBeforeDrawNode(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i,{get:function(){return a},set:function(t){a=t}},{get:function(){return l},set:function(t){l=t}}),a)){if(l){if(V.$assign(e),R&&!A){var Q=this.FNodesAppearance.FSelectionArea;1===Q?0!==this.FStroke.FKind&&-1!==this.FStroke.FColor?V.Left=1:V.Left=0:3===Q&&rtl.length(i.FTextRects)>0&&(V.Left=i.FTextRects[0].Left)}q=rtl.refSet(pas["WEBLib.TMSFNCGraphicsTypes"].AllSides),X=0,J=rtl.createSet(0,1,2,3),this.DoGetNodeSides(i,{get:function(){return q},set:function(t){q=t}}),this.DoGetNodeRounding(i,{get:function(){return X},set:function(t){X=t}},{get:function(){return J},set:function(t){J=t}}),X>0?(X=Math.min(pas.System.Trunc(Math.min(V.Right-V.Left,V.Bottom-V.Top)/2),X),t.DrawRoundRectangle$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(V),X,rtl.refSet(J),0)):t.DrawRectangle$3(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(V),rtl.refSet(q),0),i===this.GetFocusedVirtualNode()&&this.IsFocused()&&this.FNodesAppearance.FShowFocus&&(W.$assign(V),pas["WEBLib.TMSFNCTypes"].InflateRectEx(W,this.ScalePaintValue(-2),this.ScalePaintValue(-2)),t.DrawFocusRectangle$3(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(W),0,2))}if(!this.FCompactMode){d=this.GetFirstVisibleColumn(),m=this.GetLastVisibleColumn(),A&&(m=Math.min(d,m));for(var Z=d,_=m;Z<=_;Z++){if(v=null,(p=Z)>=0&&p<=this.FColumns.GetCount()-1&&(v=this.FColumns.GetItem$1(p)),p-d>=0&&p-d<=rtl.length(i.FExpandRects)-1&&this.FNodesAppearance.FShowLines&&p===this.FNodesAppearance.FExpandColumn&&this.FNodesAppearance.FExpandWidth>0){if(H.$assign(i.FExpandRects[p-d]),pas["WEBLib.TMSFNCTypes"].OffsetRectEx$1(H,o,n),t.FStroke.Assign(this.FNodesAppearance.FLineStroke),this.FNodesAppearance.FLineStroke.FKind in rtl.createSet(2,3,4,5)&&t.StartSpecialPen(),U=this.FNodesAppearance.FLevelIndent,I.$assign(pas["WEBLib.TMSFNCTypes"].RectF(H.Left+this.FNodesAppearance.FExpandWidth/2,e.Top,H.Left+this.FNodesAppearance.FExpandWidth/2+U/2,e.Bottom)),t.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(I.Left,I.Top+(I.Bottom-I.Top)/2)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(I.Right,I.Top+(I.Bottom-I.Top)/2)),2,2),this.FVisibleNodes.GetCount()>1){for(O=(k=i).GetParent(),P.$assign(I);null!=O;)(k===i&&k.FIndex<=O.FChildren-1||k!==i&&k.FIndex<O.FChildren-1)&&(k.FIndex<O.FChildren-1?t.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(P.Left,P.Top)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(P.Left,P.Bottom)),2,4):t.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(P.Left,P.Top)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(P.Left,P.Top+(P.Bottom-P.Top)/2)),2,4)),O=(k=O).GetParent(),pas["WEBLib.TMSFNCTypes"].OffsetRectEx$1(P,-U,0);if(this.FNodeStructure.GetCount()-i.FTotalChildren-1>0)if(null==(O=i.GetParent()))i.FRow===this.FNodeStructure.GetCount()-i.FTotalChildren-1?t.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(P.Left,P.Top)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(P.Left,P.Top+(P.Bottom-P.Top)/2)),2,4):0===i.FRow?t.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(P.Left,P.Top+(P.Bottom-P.Top)/2)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(P.Left,pas.System.Int(P.Bottom)-.5)),2,4):t.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(P.Left,P.Top)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(P.Left,P.Bottom)),2,4);else if(null!=O){for(x=O,O=O.GetParent(),P.$assign(I),pas["WEBLib.TMSFNCTypes"].OffsetRectEx$1(P,-U,0);null!=O;)x=O,O=O.GetParent(),pas["WEBLib.TMSFNCTypes"].OffsetRectEx$1(P,-U,0);null!=x&&x.FRow<this.FNodeStructure.GetCount()-x.FTotalChildren-1&&t.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(P.Left,P.Top)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(P.Left,P.Bottom)),2,4)}}this.FNodesAppearance.FLineStroke.FKind in rtl.createSet(2,3,4,5)&&t.StopSpecialPen()}if(null==v||v.FUseDefaultAppearance||A?A?t.FFont.Assign(this.FNodesAppearance.FExtendedFont):t.FFont.Assign(this.FNodesAppearance.FFont):t.FFont.Assign(v.FFont),this.GetColWidths(p)>0||A){if(B?R?(T=A?this.FNodesAppearance.FExtendedSelectedFontColor:this.FNodesAppearance.FSelectedFontColor,this.DoGetNodeSelectedTextColor(i,p,{get:function(){return T},set:function(t){T=t}}),t.FFont.SetColor(T)):(T=null==v||v.FUseDefaultAppearance||A?A?this.FNodesAppearance.FExtendedFontColor:this.FNodesAppearance.FFont.FColor:v.FFont.FColor,this.DoGetNodeTextColor(i,p,{get:function(){return T},set:function(t){T=t}}),t.FFont.SetColor(T)):(T=A?this.FNodesAppearance.FExtendedDisabledFontColor:this.FNodesAppearance.FDisabledFontColor,this.DoGetNodeDisabledTextColor(i,p,{get:function(){return T},set:function(t){T=t}}),t.FFont.SetColor(T)),p-d>=0&&p-d<=rtl.length(i.FCheckRects)-1&&p-d<=rtl.length(i.FCheckStates)-1&&(E=0,this.DoGetNodeCheckType(i,p,{get:function(){return E},set:function(t){E=t}}),0!==E)){L=null,G=i.FCheckStates[p-d],this.DoIsNodeChecked(i,p,{get:function(){return G},set:function(t){G=t}});var tt=E;1===tt?L=this.GetCheckBoxBitmap(G,!1,!0):2===tt&&(L=this.GetRadioButtonBitmap(G,!1,!0)),null!=L&&(D.$assign(i.FCheckRects[p-d]),pas["WEBLib.TMSFNCTypes"].OffsetRectEx$1(D,o,n),a=!0,this.DoBeforeDrawNodeCheck(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(D),p,i,L,{get:function(){return a},set:function(t){a=t}}),a&&(t.DrawBitmap$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(D),L,!0,!1,!0,!1),this.DoAfterDrawNodeCheck(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(D),p,i,L)))}if(p-d>=0&&p-d<=rtl.length(i.FBitmapRects)-1&&(f=null,this.DoGetNodeIcon(i,p,!1,{get:function(){return f},set:function(t){f=t}}),null==f&&z&&this.DoGetNodeIcon(i,p,!0,{get:function(){return f},set:function(t){f=t}}),null==f||pas["WEBLib.TMSFNCTypes"].IsBitmapEmpty(f)||(u.$assign(i.FBitmapRects[p-d]),pas["WEBLib.TMSFNCTypes"].OffsetRectEx$1(u,o,n),a=!0,this.DoBeforeDrawNodeIcon(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(u),p,i,f,{get:function(){return a},set:function(t){a=t}}),a&&(t.DrawBitmap$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(u),f,!0,!1,!0,!1),this.DoAfterDrawNodeIcon(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(u),p,i,f)))),p-d>=0&&p-d<=rtl.length(i.FExpandRects)-1&&i.FChildren>0&&p===this.FNodesAppearance.FExpandColumn&&this.FNodesAppearance.FExpandWidth>0){if(c=z?i.FExpanded?this.FNodesAppearance.FCollapseNodeIconLarge:this.FNodesAppearance.FExpandNodeIconLarge:i.FExpanded?this.FNodesAppearance.FCollapseNodeIcon:this.FNodesAppearance.FExpandNodeIcon,j=null,this.GetAdaptToStyle()){(j=pas["WEBLib.Graphics"].TBitmap.$create("Create$3")).SetSize(c.GetWidth(),c.GetHeight()),K=pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.$create("Create$1",[j.GetCanvas(),!1]);try{K.BeginScene(),K.FFill.SetColor(pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.DefaultSelectionFillColor),K.FFill.SetKind(1),K.FStroke.SetKind(1),K.FStroke.SetColor(pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.DefaultTextFontColor),K.DrawRectangle$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(0,0,c.GetWidth(),c.GetHeight())),2),K.FStroke.SetWidth(this.ScalePaintValue(2)),i.FExpanded||K.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(rtl.trunc(c.GetWidth()/2),0)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(rtl.trunc(c.GetWidth()/2),c.GetHeight())),2,2),K.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(0,rtl.trunc(c.GetHeight()/2))),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(c.GetWidth(),rtl.trunc(c.GetHeight()/2))),2,2)}finally{K.EndScene(),K=rtl.freeLoc(K)}}if(w.$assign(i.FExpandRects[p-d]),pas["WEBLib.TMSFNCTypes"].OffsetRectEx$1(w,o,n),a=!0,this.DoBeforeDrawNodeExpand(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(w),p,i,c,{get:function(){return a},set:function(t){a=t}}),a){if(z?($.$assign(w),pas["WEBLib.TMSFNCTypes"].InflateRectEx($,this.ScalePaintValue(-2),this.ScalePaintValue(-2))):$.$assign(pas["WEBLib.TMSFNCTypes"].RectF(pas.System.Int(w.Left+(w.Right-w.Left-c.GetWidth())/2),pas.System.Int(w.Top+(w.Bottom-w.Top-c.GetHeight())/2),pas.System.Int(w.Left+(w.Right-w.Left-c.GetWidth())/2)+c.GetWidth(),pas.System.Int(w.Top+(w.Bottom-w.Top-c.GetHeight())/2)+c.GetHeight())),this.GetAdaptToStyle()&&null!=j){Y=pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.$create("Create$3");try{Y.Assign(j),t.DrawBitmap$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone($),Y,!0,!1,!0,!1)}finally{Y=rtl.freeLoc(Y)}j=rtl.freeLoc(j),j=null}else t.DrawBitmap$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone($),c,!0,!1,!0,!1);this.DoAfterDrawNodeExpand(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(w),p,i,c)}null!=j&&(j=rtl.freeLoc(j))}p-d>=0&&p-d<=rtl.length(i.FTextRects)-1&&i.GetTitleExpanded(p-d)&&(h.$assign(i.FTextRects[p-d]),pas["WEBLib.TMSFNCTypes"].OffsetRectEx$1(h,o,n),pas["WEBLib.TMSFNCTypes"].InflateRectEx(h,this.ScalePaintValue(-2),0),M=null,p>=0&&p<=this.FColumns.GetCount()-1&&(M=this.FColumns.GetItem$1(p)),g=1,y=0,b=!1,N=0,null!=M&&(g=M.FHorizontalTextAlign,y=M.FVerticalTextAlign,b=M.FWordWrapping,N=M.FTrimming),this.DoGetNodeTrimming(i,p,{get:function(){return N},set:function(t){N=t}}),this.DoGetNodeWordWrapping(i,p,{get:function(){return b},set:function(t){b=t}}),this.DoGetNodeHorizontalTextAlign(i,p,{get:function(){return g},set:function(t){g=t}}),this.DoGetNodeVerticalTextAlign(i,p,{get:function(){return y},set:function(t){y=t}}),r="",this.DoGetNodeText(i,p,0,{get:function(){return r},set:function(t){r=t}}),a=!0,this.DoBeforeDrawNodeText(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(h),p,i,r,{get:function(){return a},set:function(t){a=t}}),a&&((!this.FInplaceEditorActive||this.FUpdateNodeColumn===p&&this.GetFocusedVirtualNode()===i)&&this.FInplaceEditorActive||t.DrawText$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(h),r,b,g,y,N,0,-1,-1,!0,!1,-1,-1),this.DoAfterDrawNodeText(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(h),p,i,r))),null==v||v.FUseDefaultAppearance?t.FFont.Assign(this.FNodesAppearance.FTitleFont):t.FFont.Assign(v.FTitleFont),B?R?(T=this.FNodesAppearance.FSelectedTitleFontColor,this.DoGetNodeSelectedTitleColor(i,p,{get:function(){return T},set:function(t){T=t}}),t.FFont.SetColor(T)):(T=null==v||v.FUseDefaultAppearance?this.FNodesAppearance.FTitleFont.FColor:v.FTitleFont.FColor,this.DoGetNodeTitleColor(i,p,{get:function(){return T},set:function(t){T=t}}),t.FFont.SetColor(T)):(T=this.FNodesAppearance.FDisabledTitleFontColor,this.DoGetNodeDisabledTitleColor(i,p,{get:function(){return T},set:function(t){T=t}}),t.FFont.SetColor(T)),p-d>=0&&p-d<=rtl.length(i.FTitleRects)-1&&(F.$assign(i.FTitleRects[p-d]),pas["WEBLib.TMSFNCTypes"].OffsetRectEx$1(F,o,n),pas["WEBLib.TMSFNCTypes"].InflateRectEx(F,this.ScalePaintValue(-2),0),M=null,p>=0&&p<=this.FColumns.GetCount()-1&&(M=this.FColumns.GetItem$1(p)),g=1,y=0,b=!1,N=0,null!=M&&(g=M.FTitleHorizontalTextAlign,y=M.FTitleVerticalTextAlign,b=M.FTitleWordWrapping,N=M.FTitleTrimming),this.DoGetNodeTitleTrimming(i,p,{get:function(){return N},set:function(t){N=t}}),this.DoGetNodeTitleWordWrapping(i,p,{get:function(){return b},set:function(t){b=t}}),this.DoGetNodeTitleHorizontalTextAlign(i,p,{get:function(){return g},set:function(t){g=t}}),this.DoGetNodeTitleVerticalTextAlign(i,p,{get:function(){return y},set:function(t){y=t}}),r="",this.DoGetNodeTitle(i,p,0,{get:function(){return r},set:function(t){r=t}}),a=!0,this.DoBeforeDrawNodeTitle(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(F),p,i,r,{get:function(){return a},set:function(t){a=t}}),a&&(t.DrawText$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(F),r,b,g,y,N,0,-1,-1,!0,!1,-1,-1),this.DoAfterDrawNodeTitle(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(F),p,i,r))),p-d>=0&&p-d<=rtl.length(i.FExtraRects)-1&&(C.$assign(i.FExtraRects[p-d]),pas["WEBLib.TMSFNCTypes"].OffsetRectEx$1(C,o,n),a=!0,this.DoBeforeDrawNodeExtra(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(C),p,i,{get:function(){return a},set:function(t){a=t}}),a&&(this.DoDrawNodeExtra(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(C),p,i),this.DoAfterDrawNodeExtra(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(C),p,i))),p-d>=0&&p-d<=rtl.length(i.FTitleExtraRects)-1&&(C.$assign(i.FTitleExtraRects[p-d]),pas["WEBLib.TMSFNCTypes"].OffsetRectEx$1(C,o,n),a=!0,this.DoBeforeDrawNodeTitleExtra(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(C),p,i,{get:function(){return a},set:function(t){a=t}}),a&&(this.DoDrawNodeTitleExtra(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(C),p,i),this.DoAfterDrawNodeTitleExtra(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(C),p,i)))}}}this.DoAfterDrawNode(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i)}},this.DrawGroup=function(t,e,i,s,o,n){var r=!1,a=!1,l="",h=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),F=null,p=!1;if(F=null,p=!0,i>=0&&i<=this.FGroups.GetCount()-1&&!(F=this.FGroups.GetItem$1(i)).FUseDefaultAppearance){p=!1;var c=n;3===c?(t.FStroke.Assign(F.FTopStroke),t.FFill.Assign(F.FTopFill)):4===c&&(t.FStroke.Assign(F.FBottomStroke),t.FFill.Assign(F.FBottomFill))}if(p){var u=n;3===u?(t.FStroke.Assign(this.FGroupsAppearance.FTopStroke),t.FFill.Assign(this.FGroupsAppearance.FTopFill)):4===u&&(t.FStroke.Assign(this.FGroupsAppearance.FBottomStroke),t.FFill.Assign(this.FGroupsAppearance.FBottomFill))}if(r=!0,a=!0,this.DoBeforeDrawGroup(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i,s,o,n,{get:function(){return r},set:function(t){r=t}},{get:function(){return a},set:function(t){a=t}}),r){if(a&&t.DrawRectangle$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),0),p){var C=n;3===C?t.FFont.Assign(this.FGroupsAppearance.FTopFont):4===C&&t.FFont.Assign(this.FGroupsAppearance.FBottomFont)}else if(null!=F){var T=n;3===T?t.FFont.Assign(F.FTopFont):4===T&&t.FFont.Assign(F.FBottomFont)}if(h.$assign(e),pas["WEBLib.TMSFNCTypes"].InflateRectEx(h,this.ScalePaintValue(-2),this.ScalePaintValue(-2)),l=this.GetGroupText(i),this.DoGetGroupText(i,n,{get:function(){return l},set:function(t){l=t}}),r=!0,this.DoBeforeDrawGroupText(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(h),i,s,o,n,l,{get:function(){return r},set:function(t){r=t}}),r){var S=n;3===S?this.FGroupsAppearance.FTopVerticalText?t.DrawText$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(h),l,!1,this.FGroupsAppearance.FTopHorizontalTextAlign,this.FGroupsAppearance.FTopVerticalTextAlign,0,-90,-1,-1,!0,!1,-1,-1):t.DrawText$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(h),l,!1,this.FGroupsAppearance.FTopHorizontalTextAlign,this.FGroupsAppearance.FTopVerticalTextAlign,0,0,-1,-1,!0,!1,-1,-1):4===S&&(this.FGroupsAppearance.FBottomVerticalText?t.DrawText$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(h),l,!1,this.FGroupsAppearance.FBottomHorizontalTextAlign,this.FGroupsAppearance.FBottomVerticalTextAlign,0,90,-1,-1,!0,!1,-1,-1):t.DrawText$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(h),l,!1,this.FGroupsAppearance.FBottomHorizontalTextAlign,this.FGroupsAppearance.FBottomVerticalTextAlign,0,0,-1,-1,!0,!1,-1,-1)),this.DoAfterDrawGroupText(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(h),i,s,o,n,l)}this.DoAfterDrawGroup(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i,s,o,n)}},this.DrawColumn=function(t,e,i,s){var o=!1,n="",r=!1,a=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),l=!1,h=null,F=0,p=0,c=0,u=!1,C=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),T=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),S=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),d=0,m=0,f=0;if(pas["WEBLib.TMSFNCCustomTreeView"].TTMSFNCCustomTreeView.DrawColumn.apply(this,arguments),C.$assign(e),l=!0,h=null,i>=0&&i<=this.FColumns.GetCount()-1&&!(h=this.FColumns.GetItem$1(i)).FUseDefaultAppearance){l=!1;var g=s;1===g?(t.FStroke.Assign(h.FTopStroke),t.FFill.Assign(h.FTopFill)):2===g&&(t.FStroke.Assign(h.FBottomStroke),t.FFill.Assign(h.FBottomFill))}if(l){var y=s;1===y?(t.FStroke.Assign(this.FColumnsAppearance.FTopStroke),t.FFill.Assign(this.FColumnsAppearance.FTopFill)):2===y&&(t.FStroke.Assign(this.FColumnsAppearance.FBottomStroke),t.FFill.Assign(this.FColumnsAppearance.FBottomFill))}if(o=!0,r=!0,this.DoBeforeDrawColumnHeader(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(C),i,s,{get:function(){return o},set:function(t){o=t}},{get:function(){return r},set:function(t){r=t}}),o){if(r&&t.DrawRectangle$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(C),0),T.$assign(C),f=0,null!=h&&(h.FFiltering.FEnabled&&(d=h.FFiltering.FButtonSize,S.$assign(pas["WEBLib.TMSFNCTypes"].RectF(Math.round(C.Right-d-this.ScalePaintValue(4)),Math.round(C.Top+(C.Bottom-C.Top-d)/2),Math.round(C.Right-this.ScalePaintValue(4)),Math.round(C.Top+(C.Bottom-C.Top-d)/2+d))),t.DrawDropDownButton(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(S),!1,!1,!0,!0,this.GetAdaptToStyle(),this.FPaintScaleFactor),T.Right=S.Left,f=f+d+this.ScalePaintValue(4)),h.FExpandable&&(m=h.FExpandingButtonSize,T.$assign(pas["WEBLib.TMSFNCTypes"].RectF(Math.round(T.Right-m-this.ScalePaintValue(6)),Math.round(T.Top+(T.Bottom-T.Top-m)/2),Math.round(T.Right-this.ScalePaintValue(6)),Math.round(T.Top+(T.Bottom-T.Top-m)/2+m))),h.FExpanded?t.DrawCompactButton(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(T),1,!1,!1,!0,!1,this.FPaintScaleFactor):t.DrawCompactButton(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(T),0,!1,!1,!0,!1,this.FPaintScaleFactor),T.Right=T.Left,f=f+m+this.ScalePaintValue(6)),0!==h.FSortKind&&this.FSortColumn===i&&(m=this.ScalePaintValue(8),T.$assign(pas["WEBLib.TMSFNCTypes"].RectF(Math.round(T.Right-m-this.ScalePaintValue(6)),Math.round(T.Top+(T.Bottom-T.Top-m)/2),Math.round(T.Right-this.ScalePaintValue(6)),Math.round(T.Top+(T.Bottom-T.Top-m)/2+m))),this.DrawSortIndicator(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(T),this.FColumnsAppearance.FSortIndicatorColor,i,h.FSortIndex,h.FSortKind),f=f+m+this.ScalePaintValue(6))),l){var M=s;1===M?t.FFont.Assign(this.FColumnsAppearance.FTopFont):2===M&&t.FFont.Assign(this.FColumnsAppearance.FBottomFont)}else if(null!=h){var b=s;1===b?t.FFont.Assign(h.FTopFont):2===b&&t.FFont.Assign(h.FBottomFont)}if(n=this.GetColumnText(i),this.DoGetColumnText(i,s,{get:function(){return n},set:function(t){n=t}}),p=1,c=0,u=!1,F=0,null!=h&&(p=h.FHorizontalTextAlign,c=h.FVerticalTextAlign,u=h.FWordWrapping,F=h.FTrimming),this.DoGetColumnTrimming(i,s,{get:function(){return F},set:function(t){F=t}}),this.DoGetColumnWordWrapping(i,s,{get:function(){return u},set:function(t){u=t}}),this.DoGetColumnHorizontalTextAlign(i,s,{get:function(){return p},set:function(t){p=t}}),this.DoGetColumnVerticalTextAlign(i,s,{get:function(){return c},set:function(t){c=t}}),o=!0,a.$assign(C),pas["WEBLib.TMSFNCTypes"].InflateRectEx(a,this.ScalePaintValue(-3),this.ScalePaintValue(-3)),a.Right=Math.max(a.Left,a.Right-f),this.DoBeforeDrawColumnText(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(a),i,s,n,{get:function(){return o},set:function(t){o=t}}),o){var N=s;1===N?this.FColumnsAppearance.FTopVerticalText?t.DrawText$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(a),n,u,p,c,F,-90,-1,-1,!0,!1,-1,-1):t.DrawText$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(a),n,u,p,c,F,0,-1,-1,!0,!1,-1,-1):2===N&&(this.FColumnsAppearance.FBottomVerticalText?t.DrawText$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(a),n,u,p,c,F,90,-1,-1,!0,!1,-1,-1):t.DrawText$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(a),n,u,p,c,F,0,-1,-1,!0,!1,-1,-1)),this.DoAfterDrawColumnText(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(a),i,s,n)}this.DoAfterDrawColumnHeader(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i,s)}},this.DrawSortIndicator=function(t,e,i,s,o,n){var r,a=null,l=0,h=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),F=!1;if(r=i,t.FFill.SetKind(1),t.FFill.SetColor(r),t.FStroke.SetKind(1),t.FStroke.SetColor(r),F=!0,this.DoBeforeDrawSortIndicator(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),s,o,n,{get:function(){return F},set:function(t){F=t}}),F){l=0,h.$assign(e),a=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsPath.$create("Create$1");try{var p=n;1===p?(l=2,a.MoveTo(pas["WEBLib.TMSFNCTypes"].PointF(e.Left+(e.Right-e.Left)/2,e.Top)),a.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(e.Right,e.Bottom)),a.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(e.Left,e.Bottom)),h.$assign(pas["WEBLib.TMSFNCTypes"].RectF(e.Left,e.Top+this.ScalePaintValue(2),e.Right,e.Bottom+this.ScalePaintValue(2)))):2===p&&(l=1,a.MoveTo(pas["WEBLib.TMSFNCTypes"].PointF(e.Left,e.Top)),a.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(e.Right,e.Top)),a.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(e.Left+(e.Right-e.Left)/2,e.Bottom)),h.$assign(pas["WEBLib.TMSFNCTypes"].RectF(e.Left,e.Top-this.ScalePaintValue(2),e.Right,e.Bottom-this.ScalePaintValue(2)))),a.ClosePath(),t.DrawPath(a,0),-1!==o&&(t.FFont.SetColor(16777215),pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.SetFontSize(t.FFont,9,1),t.DrawText$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(h),pas.SysUtils.IntToStr(o),!1,0,l,0,0,-1,-1,!0,!1,-1,-1))}finally{a=rtl.freeLoc(a)}this.DoAfterDrawSortIndicator(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),s,o,n)}},this.PickerGetContent=function(){var t="";return t="",this.SelectedVirtualNodeCount()>0&&(t=this.GetSelVirtualNode(0).GetText(0)),t},this.PickerSelectItem=function(t){var e;null!=(e=this.GetNodeFromNodeStructure(t))&&(this.SelectVirtualNode(e),this.ScrollToVirtualNode(e,!0,0,!1))},this.PickerGetSelectedItem=function(){return this.GetSelectedVirtualNodeRow()},this.PickerGetVisibleItemCount=function(){return this.GetVisibleNodeCount()},this.PickerGetItemCount=function(){return this.GetTotalVirtualNodeCount()},this.PickerGetItemHeight=function(){return this.FNodesAppearance.FFixedHeight},this.PickerSetItemHeight=function(t){this.FNodesAppearance.SetFixedHeight(t)},this.PickerGetItemWidth=function(){return this.FColumns.GetCount()>0?this.GetWidth()/this.FColumns.GetCount():0},this.PickerSetItemWidth=function(t){},this.PickerGetNextSelectableItem=function(t){var e,i=0,s=null;return i=-1,null!=(e=this.GetNodeFromNodeStructure(t))&&null!=(s=this.GetNextFocusableNode(e))&&(i=s.FRow),i},this.PickerGetPreviousSelectableItem=function(t){var e,i=0,s=null;return i=-1,null!=(e=this.GetNodeFromNodeStructure(t))&&null!=(s=this.GetPreviousFocusableNode(e))&&(i=s.FRow),i},this.PickerGetFirstSelectableItem=function(){return this.GetFirstVisibleVirtualNodeRow()},this.PickerGetLastSelectableItem=function(){return this.GetLastVisibleVirtualNodeRow()},this.PickerResetFilter=function(){this.FFilter.GetCount()>0&&this.RemoveFilters()},this.PickerApplyFilter=function(t,e){var i=null;(i=this.FFilter.Add$1()).FCondition=t,i.FCaseSensitive=e,this.ApplyFilter()},this.PickerLookupItem=function(t,e){var i=pas["WEBLib.TMSFNCControlPicker"].TTMSFNCControlPickerFilterItem.$new(),s=null;return i.ItemIndex=-1,i.ItemText="",null!=(s=this.LookupNode(t+"*",!1,-1,e,!0,!0))&&(i.ItemIndex=s.FRow,i.ItemText=s.GetText(0)),i},rtl.addIntf(this,pas["WEBLib.TMSFNCControlPicker"].ITMSFNCControlPickerFull),rtl.addIntf(this,pas["WEBLib.TMSFNCGraphicsTypes"].ITMSFNCAppearanceGlobalFont),rtl.addIntf(this,pas["WEBLib.TMSFNCBitmapContainer"].ITMSFNCBitmapContainer),rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas["WEBLib.TMSFNCTypes"].ITMSFNCProductInfo),rtl.addIntf(this,pas.System.IUnknown),this.$rtti.attr=[pas.Classes.ComponentPlatformsAttribute,"Create$1",[0]]})),t.$implcode=function(){rtl.createClass(e,"TTMSFNCTreeViewColumnOpen",pas["WEBLib.TMSFNCTreeViewData"].TTMSFNCTreeViewColumn,(function(){}))}}),["Math","SysUtils","WEBLib.TMSFNCUtils","WEBLib.Graphics","WEBLib.TMSFNCCustomSelector"]),rtl.module("WEBLib.TMSFNCToolBarRes",["System"],(function(){"use strict";var t=this;this.TMSFNCTOOLBAREXPAND="data:image/PNG;base64,iVBORw0KGgoAAAANSUhEUgAAAAcAAAAHCAYAAADEUlfTAAAABGdBTUEAALGPC/xhBQAAAAlwSFlzAAAOvwAADr8BOAVTJAAAABh0RVh0U29mdHdhcmUAcGFpbnQubmV0IDQuMC4zjOaXUAAAACVJREFUGFdj+P//P07MEBYW9h8Xxi8JAjglYACnBAzglMAEDAwARZ1DA4NRF38AAAAASUVORK5CYII=",this.TMSFNCTOOLBAREXPANDLARGE=this.TMSFNCTOOLBAREXPAND,this.TMSFNCTOOLBAREXPAND2="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAcAAAAHCAYAAADEUlfTAAAABGdBTUEAALGPC/xhBQAAAAlwSFlzAAAOvgAADr4B6kKxwAAAABl0RVh0U29mdHdhcmUAcGFpbnQubmV0IDQuMC4xNkRpr/UAAAA3SURBVBhXY3j69KktLgyS/I8LE5RsQxeE4jaQpCKIgSQIlgBiRQYQADGgAqgSMABVkI2QYGAAANnukE/t/B6ZAAAAAElFTkSuQmCC",this.TMSFNCTOOLBAROPTIONSMENU="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAcAAAAJCAYAAAD+WDajAAAABGdBTUEAALGPC/xhBQAAAAlwSFlzAAAOvwAADr8BOAVTJAAAABh0RVh0U29mdHdhcmUAcGFpbnQubmV0IDQuMC4zjOaXUAAAACpJREFUKFNjwAvCwsL+48IM///jxvh1YhOEYZz2giVgAKcEDOCUwAQMDAAqj1EKDJG5XAAAAABJRU5ErkJggg==",this.TMSFNCTOOLBAROPTIONSMENULARGE=this.TMSFNCTOOLBAROPTIONSMENU,this.TMSFNCTOOLBARQUICKMENU="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAcAAAAHCAYAAADEUlfTAAAABGdBTUEAALGPC/xhBQAAAAlwSFlzAAAOwgAADsIBFShKgAAAABl0RVh0U29mdHdhcmUAcGFpbnQubmV0IDQuMC4xNkRpr/UAAAAlSURBVBhXYwCC/9gwEAApKAMbJl4SnY0igCQIw3gkcUowMPwHALBNZJw15C+yAAAAAElFTkSuQmCC",this.TMSFNCTOOLBARQUICKMENU2="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAcAAAAHCAYAAADEUlfTAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAAZdEVYdFNvZnR3YXJlAHBhaW50Lm5ldCA0LjAuMTZEaa/1AAAAL0lEQVQYV2P4jxswwCRBNAYGESCAIQHCIAIEYAIgAGejC8D4YEBQEqvE/////wMA7H6pV7j5gXMAAAAASUVORK5CYII=",t.$init=function(){pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.CreateFromResource(t.TMSFNCTOOLBAREXPAND),pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.CreateFromResource(t.TMSFNCTOOLBAREXPAND2),pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.CreateFromResource(t.TMSFNCTOOLBAROPTIONSMENU),pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.CreateFromResource(t.TMSFNCTOOLBARQUICKMENU),pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.CreateFromResource(t.TMSFNCTOOLBARQUICKMENU2)}}),["WEBLib.TMSFNCTypes"]),rtl.module("WEBLib.TMSFNCEdit",["System","Classes","WEBLib.TMSFNCToolBar","WEBLib.TMSFNCToolBarRes","WEBLib.TMSFNCCustomControl","WEBLib.TMSFNCTypes","WEBLib.TMSFNCPopup","WEBLib.ExtCtrls","WEBLib.StdCtrls","WEBLib.Graphics","WEBLib.Controls","WEBLib.TMSFNCGraphicsTypes","WEBLib.TMSFNCBitmapContainer"],(function(){"use strict";var t=this,e=t.$impl;this.MAJ_VER=1,this.MIN_VER=0,this.REL_VER=3,this.BLD_VER=1,this.LOOKUPITEMHEIGHT=18,this.TTMSFNCEditType={0:"etString",etString:0,1:"etNumeric",etNumeric:1,2:"etSignedNumeric",etSignedNumeric:2,3:"etFloat",etFloat:3,4:"etSignedFloat",etSignedFloat:4,5:"etUppercase",etUppercase:5,6:"etMixedCase",etMixedCase:6,7:"etLowerCase",etLowerCase:7,8:"etMoney",etMoney:8,9:"etHex",etHex:9,10:"etAlphaNumeric",etAlphaNumeric:10,11:"etValidChars",etValidChars:11},this.$rtti.$Enum("TTMSFNCEditType",{minvalue:0,maxvalue:11,ordtype:1,enumtype:this.TTMSFNCEditType}),this.TTMSFNCEditPrecisionDisplay={0:"pdNormal",pdNormal:0,1:"pdShortest",pdShortest:1},this.$rtti.$Enum("TTMSFNCEditPrecisionDisplay",{minvalue:0,maxvalue:1,ordtype:1,enumtype:this.TTMSFNCEditPrecisionDisplay}),rtl.createClass(this,"TTMSFNCEditLookupSettings",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FDisplayList=null,this.FValueList=null,this.FDisplayCount=0,this.FColor=0,this.FEnabled=!1,this.FNumChars=0,this.FCaseSensitive=!1,this.FHistory=!1,this.FMulti=!1,this.FSeparator="",this.FAcceptOnTab=!1,this.FWidth=0,this.FHeight=0,this.FUseValueList=!1,this.FMinimumWidth=0,this.FMinimumHeight=0},this.$final=function(){this.FDisplayList=void 0,this.FValueList=void 0,pas.Classes.TPersistent.$final.call(this)},this.SetDisplayList=function(t){this.FDisplayList.Assign(t)},this.SetValueList=function(t){this.FValueList.Assign(t)},this.SetNumChars=function(t){t>0&&(this.FNumChars=t)},this.SetHeight=function(t){this.FHeight=t},this.SetWidth=function(t){this.FWidth=t},this.SetMinimumHeight=function(t){this.FMinimumHeight=t},this.SetMinimumWidth=function(t){this.FMinimumWidth=t},this.Create$1=function(){return pas.System.TObject.Create.call(this),this.FUseValueList=!0,this.FWidth=0,this.FMinimumWidth=0,this.FHeight=0,this.FMinimumHeight=0,this.FDisplayList=pas.Classes.TStringList.$create("Create$1"),this.FDisplayList.SetSorted(!0),this.FDisplayList.FDuplicates=0,this.FValueList=pas.Classes.TStringList.$create("Create$1"),this.FColor=16777215,this.FDisplayCount=4,this.FNumChars=2,this.FEnabled=!1,this.FSeparator=";",this},this.Destroy=function(){rtl.free(this,"FValueList"),rtl.free(this,"FDisplayList"),pas.System.TObject.Destroy.call(this)},this.Assign=function(e){t.TTMSFNCEditLookupSettings.isPrototypeOf(e)&&(this.FAcceptOnTab=rtl.as(e,t.TTMSFNCEditLookupSettings).FAcceptOnTab,this.FCaseSensitive=rtl.as(e,t.TTMSFNCEditLookupSettings).FCaseSensitive,this.FColor=rtl.as(e,t.TTMSFNCEditLookupSettings).FColor,this.FDisplayCount=rtl.as(e,t.TTMSFNCEditLookupSettings).FDisplayCount,this.FDisplayList.Assign(rtl.as(e,t.TTMSFNCEditLookupSettings).FDisplayList),this.FEnabled=rtl.as(e,t.TTMSFNCEditLookupSettings).FEnabled,this.FHistory=rtl.as(e,t.TTMSFNCEditLookupSettings).FHistory,this.FNumChars=rtl.as(e,t.TTMSFNCEditLookupSettings).FNumChars,this.FValueList.Assign(rtl.as(e,t.TTMSFNCEditLookupSettings).FValueList),this.FMulti=rtl.as(e,t.TTMSFNCEditLookupSettings).FMulti,this.FSeparator=rtl.as(e,t.TTMSFNCEditLookupSettings).FSeparator,this.FWidth=rtl.as(e,t.TTMSFNCEditLookupSettings).FWidth,this.FHeight=rtl.as(e,t.TTMSFNCEditLookupSettings).FHeight,this.FMinimumWidth=rtl.as(e,t.TTMSFNCEditLookupSettings).FMinimumWidth,this.FMinimumHeight=rtl.as(e,t.TTMSFNCEditLookupSettings).FMinimumHeight,this.FUseValueList=rtl.as(e,t.TTMSFNCEditLookupSettings).FUseValueList)};var e=this.$rtti;e.addProperty("CaseSensitive",0,rtl.boolean,"FCaseSensitive","FCaseSensitive",{Default:!1}),e.addProperty("DisplayCount",0,rtl.longint,"FDisplayCount","FDisplayCount",{Default:4}),e.addProperty("DisplayList",2,pas.Classes.$rtti.TStringList,"FDisplayList","SetDisplayList"),e.addProperty("Enabled",0,rtl.boolean,"FEnabled","FEnabled",{Default:!1}),e.addProperty("History",0,rtl.boolean,"FHistory","FHistory",{Default:!1}),e.addProperty("NumChars",2,rtl.longint,"FNumChars","SetNumChars",{Default:2}),e.addProperty("ValueList",2,pas.Classes.$rtti.TStringList,"FValueList","SetValueList"),e.addProperty("Multi",0,rtl.boolean,"FMulti","FMulti",{Default:!1}),e.addProperty("Separator",0,rtl.char,"FSeparator","FSeparator"),e.addProperty("Width",2,rtl.longint,"FWidth","SetWidth",{Default:0}),e.addProperty("Height",2,rtl.longint,"FHeight","SetHeight",{Default:0}),e.addProperty("MinimumWidth",2,rtl.longint,"FMinimumWidth","SetMinimumWidth",{Default:0}),e.addProperty("MinimumHeight",2,rtl.longint,"FMinimumHeight","SetMinimumHeight",{Default:0}),e.addProperty("UseValueList",0,rtl.boolean,"FUseValueList","FUseValueList",{Default:!0})})),this.$rtti.$MethodVar("TTMSFNCEditLookupSelectEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["Value",rtl.string,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCEditLookupIndexSelectEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["Index",rtl.longint],["Value",rtl.string,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCEditLookupNeedDataEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["Value",rtl.string],["List",pas.Classes.$rtti.TStrings],["ItemIndex",rtl.longint,1]]),methodkind:0}),rtl.createClass(this,"TTMSFNCLookupListBoxItem",pas.System.TObject,(function(){this.$init=function(){pas.System.TObject.$init.call(this),this.FIdx=0},this.Create$1=function(t){return this.FIdx=t,this}})),rtl.createClass(this,"TTMSFNCLookupList",pas.Classes.TList,(function(){})),rtl.createClass(this,"TTMSFNCEdit",pas["WEBLib.StdCtrls"].TCustomEdit,(function(){this.$init=function(){pas["WEBLib.StdCtrls"].TCustomEdit.$init.call(this),this.FLookupListBoxItems=null,this.FAllowFocus=!1,this.FLookupFormTimer=null,this.FKeyDown=0,this.FShiftState={},this.FEditType$1=0,this.FValidChars="",this.FLookupList=null,this.FLookupListBox=null,this.FLookup=null,this.FOnLookupSelect=null,this.FOnLookupIndexSelect=null,this.FSigned=!1,this.FPrefix="",this.FSuffix="",this.FIsModified=!1,this.FLengthLimit=0,this.FFullTextSearch=!1,this.FAutoThousandSeparator=!1,this.FPrecision=0,this.FPrecisionDisplay=0,this.FBlockChange=!1,this.FAllowNumericNullValue=!1,this.FAutoComplete=!1,this.FOnLookupNeedData=null,this.FAutoClose=!1,this.FOnLookupClose=null,this.FOnLookupOpen=null},this.$final=function(){this.FLookupListBoxItems=void 0,this.FLookupFormTimer=void 0,this.FShiftState=void 0,this.FLookupList=void 0,this.FLookupListBox=void 0,this.FLookup=void 0,this.FOnLookupSelect=void 0,this.FOnLookupIndexSelect=void 0,this.FOnLookupNeedData=void 0,this.FOnLookupClose=void 0,this.FOnLookupOpen=void 0,pas["WEBLib.StdCtrls"].TCustomEdit.$final.call(this)},this.CloseLookup=function(){this.CanFocus()&&this.SetFocus(),null!=this.FLookupList&&(this.FLookupList.FIsOpen&&this.DoLookupClose(),this.FLookupList.SetIsOpen(!1))},this.DoneLookup=function(){var t=0,e=0,i="",s="",o="",n=null;if(null!=this.FLookupListBox&&-1!==this.FLookupListBox.GetItemIndex()){if(t=-1,null!=(n=this.FLookupListBox.FItems.GetObject(this.FLookupListBox.GetItemIndex()))&&(t=n.FIdx),i=t>=0&&t<this.FLookup.FValueList.GetCount()&&this.FLookup.FUseValueList?this.FLookup.FValueList.Get(t):this.FLookupListBox.FItems.Get(this.FLookupListBox.GetItemIndex()),null!=this.FOnLookupSelect&&this.FOnLookupSelect(this,{get:function(){return i},set:function(t){i=t}}),null!=this.FOnLookupIndexSelect&&this.FOnLookupIndexSelect(this,t,{get:function(){return i},set:function(t){i=t}}),this.FLookup.FMulti){for(i+=this.FLookup.FSeparator,s=this.GetT(),o="",e=-1;pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.VarPos(this.FLookup.FSeparator,s,{get:function(){return e},set:function(t){e=t}})>0;)o+=pas.System.Copy(s,1,e),pas.System.Delete({get:function(){return s},set:function(t){s=t}},1,e);this.SetT(o+i)}else this.SetT(i);this.FLookup.FMulti?this.SetSelStart(this.GetT().length):this.SelectAll(),this.CloseLookup()}},this.UpdateLookup=function(){var i=0,s=0,o=0,n=0,r=0,a=0,l="",h=0,F=null;if(this.FLookup.FEnabled&&null!=this.FLookupListBox){if(this.FLookup.FMulti)for(l=this.GetT(),a=-1;pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.VarPos(this.FLookup.FSeparator,l,{get:function(){return a},set:function(t){a=t}})>0;)pas.System.Delete({get:function(){return l},set:function(t){l=t}},1,a);else l=this.GetT();if(l.length>=this.FLookup.FNumChars){n=18*this.FLookup.FDisplayCount+4,this.FLookupListBox.SetParent(this),this.CleanupLookupList(),this.FLookupListBox.FItems.Clear();for(var p=1,c=this.FLookup.FDisplayList.GetCount();p<=c;p++)i=p,this.FLookup.FCaseSensitive?1===pas.System.Pos(l,this.FLookup.FDisplayList.Get(i-1))&&(F=t.TTMSFNCLookupListBoxItem.$create("Create$1",[i-1]),this.FLookupListBox.FItems.AddObject(e.CleanString(this.FLookup.FDisplayList.Get(i-1)),F),this.FLookupListBoxItems.Add(F)):(a=pas.System.Pos(pas["WEBLib.TMSFNCTypes"].AnsiUpperCase(l),pas["WEBLib.TMSFNCTypes"].AnsiUpperCase(this.FLookup.FDisplayList.Get(i-1))),(this.FFullTextSearch?a>0:1===a)&&(F=t.TTMSFNCLookupListBoxItem.$create("Create$1",[i-1]),this.FLookupListBox.FItems.AddObject(e.CleanString(this.FLookup.FDisplayList.Get(i-1)),F),this.FLookupListBoxItems.Add(F)));if(h=0,this.DoLookupNeedData(l,this.FLookupListBox.FItems,{get:function(){return h},set:function(t){h=t}}),s=this.FLookupListBox.FItems.GetCount(),this.FLookup.FDisplayList.GetCount()>0&&this.FLookupListBox.FItems.GetCount()>0&&this.FLookupListBox.SetItemIndex(h),s<this.FLookup.FDisplayCount&&(n=18*s+4),this.FLookupListBox.SetSorted(!0),o=50,this.FLookupList.SetDropDownWidth(0),s>0){for(var u=1,C=s;u<=C;u++)i=u,r=0,null!=this.FLookupListBox.GetCanvas()&&(r=Math.round(this.FLookupListBox.GetCanvas().TextWidth(this.FLookupListBox.FItems.Get(i-1)))),r>o&&(o=r);o+=26}this.FLookup.FWidth>0&&(o=this.FLookup.FWidth),this.FLookup.FHeight>0&&(n=this.FLookup.FHeight),this.FLookupList.SetPlacementControl(this),s>0?(this.FLookupList.SetDropDownWidth(Math.max(this.FLookup.FMinimumWidth,o)),this.FLookupList.SetDropDownHeight(Math.max(this.FLookup.FMinimumHeight,n)),this.FLookupList.HasPopupForm()&&(this.FLookupListBox.SetParent(this.FLookupList.FPopupForm),this.FLookupList.FPopupForm.SetWidth(Math.round(this.FLookupList.FDropDownWidth)),this.FLookupList.FPopupForm.SetHeight(Math.round(this.FLookupList.FDropDownHeight))),this.FLookupList.FIsOpen||this.DoLookupOpen(),this.FLookupList.SetIsOpen(!0),this.FLookupFormTimer.SetEnabled(this.FAutoClose)):(this.FLookupList.FIsOpen&&this.DoLookupClose(),this.FLookupList.SetIsOpen(!1))}else this.FLookupList.FIsOpen&&this.DoLookupClose(),this.FLookupList.SetIsOpen(!1)}},this.UpdateAutoComplete=function(){var t,i="",s=0;if(this.FAutoComplete&&(i="",(t=this.GetT()).length>=1)){for(var o=1,n=this.FLookup.FDisplayList.GetCount();o<=n;o++)if(s=o,this.FLookup.FCaseSensitive){if(1===pas.System.Pos(t,this.FLookup.FDisplayList.Get(s-1))){i=this.FLookup.FDisplayList.Get(s-1);break}}else if(1===pas.System.Pos(pas["WEBLib.TMSFNCTypes"].AnsiUpperCase(t),pas["WEBLib.TMSFNCTypes"].AnsiUpperCase(this.FLookup.FDisplayList.Get(s-1)))){i=this.FLookup.FDisplayList.Get(s-1);break}""!==i&&(this.SetT(e.CleanString(i)),this.SetSelStart(t.length),this.SetSelLength(this.GetT().length-this.GetSelStart()))}},this.SetLookup=function(t){this.FLookup.Assign(t)},this.AllowMin=function(t){return this.FSigned&&this.FEditType$1 in rtl.createSet(3,4,1,2,8)&&"-"===t},this.FixedLength=function(t){var e,i=0;return t=pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.StripThousandSep(t),i=(e=pas.System.Pos(pas.SysUtils.FormatSettings.DecimalSeparator,t))>0?e:t.length+1,this.FSigned&&this.FEditType$1 in rtl.createSet(3,4,1,2,8)&&pas.System.Pos("-",t)>0&&(i-=1),i},this.SetModified=function(t){0 in this.FComponentState||this.FReadOnly||(this.FIsModified=t)},this.DecimalPos=function(){var t;return 0===(t=pas.System.Pos(pas.SysUtils.FormatSettings.DecimalSeparator,this.GetT()))?this.FPrefix.length+this.GetT().length+this.FSuffix.length+1:this.FPrefix.length+t},this.AutoSeparators=function(){var t,e,i,s="",o="",n="",r=0;r=(s=this.GetT()).length,e=this.GetSelStart(),""!==s&&(1===pas.System.Pos("-",s)?(pas.System.Delete({get:function(){return s},set:function(t){s=t}},1,1),n="-"):n="",s=pas.System.Pos(pas.SysUtils.FormatSettings.DecimalSeparator,s)>0?pas.System.Copy(s,pas.System.Pos(pas.SysUtils.FormatSettings.DecimalSeparator,s),255):"",t=pas.System.Trunc(Math.abs(this.GetFloat())),o=this.FAutoThousandSeparator?pas.SysUtils.Format("%n",pas.System.VarRecs(3,t)):pas.SysUtils.Format("%f",pas.System.VarRecs(3,t)),o=pas.System.Copy(o,1,pas.System.Pos(pas.SysUtils.FormatSettings.DecimalSeparator,o)-1),i=this.FPrecision,this.FPrecision=0,this.FBlockChange=this.GetT()!==this.FPrefix+n+o+s+this.FSuffix,this.FBlockChange&&pas["WEBLib.StdCtrls"].TCustomEdit.SetText.call(this,this.FPrefix+n+o+s+this.FSuffix),this.FBlockChange=!1,this.FPrecision=i,r=this.GetT().length-r,this.SetSelStart(e+r),this.SetSelLength(0))},this.GetFloat=function(){var t=0,i="",s=0,o=0;t=0;var n=this.FEditType$1;return 9===n?""!==this.GetT()&&(t=e.HexToInt(this.GetT())):0===n?(i=this.GetT(),","===pas.SysUtils.FormatSettings.DecimalSeparator&&(i=pas.SysUtils.StringReplace(i,",",".",rtl.createSet(0))),pas.System.val$8(i,{get:function(){return s},set:function(t){s=t}},{get:function(){return o},set:function(t){o=t}}),t=s):1===n||2===n||3===n||4===n?""!==this.GetT()&&(t="-"===(i=this.GetT())?0:this.EStrToFloat(i)):8===n&&""!==this.GetT()&&(i=pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.StripThousandSep(this.GetT()),pas.System.Pos(pas.SysUtils.FormatSettings.DecimalSeparator,i)===i.length&&pas.System.Delete({get:function(){return i},set:function(t){i=t}},pas.System.Pos(pas.SysUtils.FormatSettings.DecimalSeparator,i),1),t=""===i||"-"===i?0:this.EStrToFloat(i)),t},this.SetFloat=function(t){var e="",i=this.FEditType$1;9===i?this.SetT(pas.SysUtils.IntToHex(pas.System.Trunc(t),0)):1===i||2===i?this.FPrecision>=0?this.SetT(pas.SysUtils.Format("%."+pas.SysUtils.IntToStr(this.FPrecision)+"n",pas.System.VarRecs(3,t))):this.SetT(pas.SysUtils.Format("%g",pas.System.VarRecs(3,t))):3===i||4===i||0===i?this.FPrecision>=0?(e=pas.SysUtils.Format("%."+pas.SysUtils.IntToStr(this.FPrecision)+"f",pas.System.VarRecs(3,t)),this.SetT(e)):this.SetT(pas.SysUtils.Format("%g",pas.System.VarRecs(3,t))):8===i&&(this.FPrecision>=0?this.SetT(pas.SysUtils.Format("%."+pas.SysUtils.IntToStr(this.FPrecision)+"f",pas.System.VarRecs(3,t))):this.SetT(pas.SysUtils.Format("%g",pas.System.VarRecs(3,t))),this.AutoSeparators()),this.SetModified(!0)},this.SetAutoThousandSeparator=function(t){this.FAutoThousandSeparator=t,this.FEditType$1 in rtl.createSet(1,2,8,3,4)&&this.AutoSeparators()},this.SetPrecision=function(t){this.FPrecision!==t&&this.FEditType$1 in rtl.createSet(3,4,8,0)&&(this.FPrecision=t,""===this.GetT()&&this.FAllowNumericNullValue||(e.IsType(this.GetT())in rtl.createSet(1,0)?this.SetFloat(this.GetFloat()):this.SetFloat(0)))},this.SetPrecisionDisplay=function(t){this.FPrecisionDisplay!==t&&(this.FPrecisionDisplay=t,this.SetFloat(this.GetFloat()))},this.EStrToFloat=function(t){var e=0;e=0,pas.System.Pos(pas.SysUtils.FormatSettings.ThousandSeparator,t)>0&&(t=pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.StripThousandSep(t)),this.FPrecision>0&&t.length>this.FPrecision&&t.charAt(t.length-this.FPrecision-1)===pas.SysUtils.FormatSettings.ThousandSeparator.charAt(-1)&&(t=rtl.setCharAt(t,t.length-this.FPrecision-1,pas.SysUtils.FormatSettings.DecimalSeparator.charAt(-1)));try{pas.SysUtils.TryStrToFloat(t,{get:function(){return e},set:function(t){e=t}})}catch(t){e=0}return e},this.GetInt=function(){var t=0;t=0;var i=this.FEditType$1;return 9===i?""!==this.GetT()&&(t=e.HexToInt(this.GetT())):2===i||1===i||4===i||3===i?t=e.ValStr(this.GetT()):8===i&&(t=e.ValStr(pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.StripThousandSep(this.GetT()))),t},this.SetInt=function(t){var e=this.FEditType$1;9===e?this.SetT(pas.SysUtils.IntToHex(t,0)):2===e||1===e||4===e||3===e?this.SetT(pas.SysUtils.IntToStr(t)):8===e&&(this.SetT(pas.SysUtils.IntToStr(t)),this.AutoSeparators()),this.SetModified(!0)},this.SetEditType$1=function(t){var i=0;if(this.FEditType$1!==t){if(this.FEditType$1=t,0 in this.FComponentState)return;if(""!==this.GetT()||!this.FAllowNumericNullValue){i=e.IsType(this.GetT());var s=this.FEditType$1;9===s?i in rtl.createSet(0,5)||this.SetInt(0):1===s||2===s?0!==i&&this.SetInt(0):3!==s&&4!==s&&8!==s||i in rtl.createSet(1,0)||this.SetFloat(0)}!(4 in this.FComponentState)||0 in this.FComponentState||3!==this.FEditType$1&&4!==this.FEditType$1||0!==this.FPrecision||this.SetPrecision(2)}this.SetCharCase(1);var o=this.FEditType$1;5===o?this.SetCharCase(3):6===o?this.SetCharCase(2):7===o&&this.SetCharCase(0)},this.IsLookupListVisible=function(){return null!=this.FLookupList&&this.FLookupList.FIsOpen},this.GetAllowFocus=function(){return this.FAllowFocus},this.SetAllowFocus=function(t){this.FAllowFocus=t},this.GetVersionNumber=function(t,e,i,s){return"",""},this.Validate=function(t){var e=!1,i=0,s="",o=!1;pas["WEBLib.StdCtrls"].TCustomEdit.Validate.apply(this,arguments),e=!0;for(var n=1,r=t.length;n<=r;n++){i=n,s=t.charAt(i-1),o=!0;var a=this.FEditType$1;if(1===a?pas["WEBLib.TMSFNCTypes"].CharIsNumber(s)||(o=!1):3===a?pas["WEBLib.TMSFNCTypes"].CharIsNumber(s)||s===pas.SysUtils.FormatSettings.DecimalSeparator||(o=!1):4===a||2===a?pas["WEBLib.TMSFNCTypes"].CharInArray(s,["-"])||pas["WEBLib.TMSFNCTypes"].CharIsNumber(s)||s===pas.SysUtils.FormatSettings.DecimalSeparator||(o=!1):8===a?pas["WEBLib.TMSFNCTypes"].CharIsNumber(s)||s===pas.SysUtils.FormatSettings.DecimalSeparator||s===pas.SysUtils.FormatSettings.ThousandSeparator||(o=!1):9===a?pas["WEBLib.TMSFNCTypes"].CharIsHex(s)||(o=!1):10===a&&(pas["WEBLib.TMSFNCTypes"].CharIsLetterOrNumber(s)||(o=!1)),!o){e=!1;break}}return e},this.GetVersion=function(){return this.$class.GetVersionNumber(1,0,3,1)},this.DoLookupFormTimer=function(t){null!=this.FLookupList&&null!=this.FLookupListBox?(null!=this.FLookupList.FPopupForm&&this.FLookupList.FPopupForm.ApplyPlacement(),this.FLookupList.FIsOpen&&(this.IsFocused()||this.FLookupList.IsFocused()||this.FLookupListBox.Focused())||(this.LookupList().FIsOpen&&this.DoLookupClose(),this.FLookupList.SetIsOpen(!1),this.FLookupFormTimer.SetEnabled(!1))):this.FLookupFormTimer.SetEnabled(!1)},this.GetT=function(){var t="";return t=pas["WEBLib.StdCtrls"].TCustomEdit.GetText.call(this),""!==this.FPrefix&&1===pas.System.Pos(pas["WEBLib.TMSFNCTypes"].AnsiUpperCase(this.FPrefix),pas["WEBLib.TMSFNCTypes"].AnsiUpperCase(t))&&pas.System.Delete({get:function(){return t},set:function(e){t=e}},1,this.FPrefix.length),""!==this.FSuffix&&pas.System.Delete({get:function(){return t},set:function(e){t=e}},t.length-this.FSuffix.length+1,this.FSuffix.length),t},this.GetCaretPosition=function(){return this.GetSelStart()},this.CleanupLookupList=function(){var t=0,e=null;if(null!=this.FLookupListBoxItems){for(var i=0,s=this.FLookupListBoxItems.GetCount()-1;i<=s;i++)t=i,null!=(e=rtl.getObject(this.FLookupListBoxItems.Get(t)))&&(e=rtl.freeLoc(e));this.FLookupListBoxItems.Clear()}},this.SetCaretPosition=function(t){this.SetSelStart(t),this.SetSelLength(0)},this.SetT=function(t){var i="",s=0,o="";if(""!==(o=t)||!this.FAllowNumericNullValue){var n=this.FEditType$1;3===n||8===n?e.IsType(o)in rtl.createSet(1,0)||(o="0"):9===n?e.IsType(o)in rtl.createSet(5,0)||(o="0"):1===n&&(e.IsType(o)in rtl.createSet(0)||(o="0")),0===this.FPrecisionDisplay?(this.FPrecision>=0||8===this.FEditType$1)&&""!==o&&(this.FEditType$1 in rtl.createSet(8)&&this.FPrecision>=0&&(i="%."+pas.SysUtils.IntToStr(this.FPrecision)+"n",o=pas.SysUtils.Format(i,pas.System.VarRecs(3,this.EStrToFloat(o)))),this.FEditType$1 in rtl.createSet(3,4)&&(i="%."+pas.SysUtils.IntToStr(this.FPrecision)+"f",s=this.EStrToFloat(o),o=pas.SysUtils.Format(i,pas.System.VarRecs(3,s)))):this.FEditType$1 in rtl.createSet(3,8,4)&&(s=this.EStrToFloat(o),o=pas.SysUtils.Format("%g",pas.System.VarRecs(3,s)))}this.FEditType$1 in rtl.createSet(9,5)?o=pas["WEBLib.TMSFNCTypes"].AnsiUpperCase(o):this.FEditType$1 in rtl.createSet(7)&&(o=pas["WEBLib.TMSFNCTypes"].AnsiLowerCase(o)),pas["WEBLib.StdCtrls"].TCustomEdit.SetText.call(this,this.FPrefix+o+this.FSuffix),this.SetModified(!1)},this.InsertText=function(t){var e="";this.FReadOnly||(e=this.GetT(),pas.System.Delete({get:function(){return e},set:function(t){e=t}},this.GetSelStart()+1,this.GetSelLength()),pas.System.Insert(t,{get:function(){return e},set:function(t){e=t}},this.GetSelStart()+1),(this.FMaxLength<=0||e.length<=this.FMaxLength)&&(this.SetT(e),this.SetCaretPosition(this.GetSelStart()+t.length)),this.SetSelLength(0))},this.ListKeyUp=function(t,e,i){13===e.get()&&this.DoneLookup(),9===e.get()&&this.FLookup.FAcceptOnTab&&this.DoneLookup()},this.ListMouseUp=function(t,e,i,s,o){this.DoneLookup()},this.KeyPress=function(t){var i=this,s="",o="",n="",r="",a=!1,l=0,h=!1,F=0,p="";function c(){i.FKeyDown in rtl.createSet(38,40)||t.set("\0")}if(null!=this.FLookupListBox){if(s=t.get(),p=t.get(),18!==this.FKeyDown&&27!==this.FKeyDown||this.CloseLookup(),!(8===this.FKeyDown&&""!==this.FPrefix&&this.GetSelStart()<=this.FPrefix.length&&0===this.GetSelLength()))if(this.FLengthLimit>0&&this.FixedLength(i.GetT())>this.FLengthLimit&&0===this.GetSelLength()&&this.GetSelStart()<this.DecimalPos()&&8!==this.FKeyDown&&this.FKeyDown!==pas.SysUtils.FormatSettings.DecimalSeparator.charCodeAt(-1)&&!this.AllowMin(p))c();else{if(this.FKeyDown in rtl.createSet(36,35,9,37,39,33,34,46,8))return 8===this.FKeyDown?(s=i.GetT(),0===this.GetSelLength()?pas.System.Delete({get:function(){return s},set:function(t){s=t}},this.GetSelStart()-this.FPrefix.length,1):pas.System.Delete({get:function(){return s},set:function(t){s=t}},Math.max(1,this.GetSelStart()-this.FPrefix.length),this.GetSelLength()),h=s!==this.GetT()||this.FIsModified,this.SetModified(h),pas["WEBLib.StdCtrls"].TCustomEdit.KeyPress.apply(this,arguments),8===this.FEditType$1&&this.AutoSeparators(),""!==this.GetT()||""===s&&!h||this.Change(),this.SetModified(h),void this.UpdateLookup()):(this.FKeyDown in rtl.createSet(36,35,9,37,39,33,34)&&this.FAutoComplete&&this.GetSelLength()>0&&this.IsLookupListVisible()&&this.CloseLookup(),n=i.GetT(),pas["WEBLib.StdCtrls"].TCustomEdit.KeyPress.apply(this,arguments),void(i.GetT()!==n&&this.SetModified(!0)));if(13===this.FKeyDown&&this.IsLookupListVisible())this.DoneLookup();else if(this.FKeyDown in rtl.createSet(9,13,27))pas["WEBLib.StdCtrls"].TCustomEdit.KeyPress.apply(this,arguments);else if(36===this.FKeyDown&&this.IsLookupListVisible())this.FLookupListBox.FItems.GetCount()>0?this.FLookupListBox.SetItemIndex(0):this.FLookupListBox.SetItemIndex(-1);else if(35===this.FKeyDown&&this.IsLookupListVisible())this.FLookupListBox.FItems.GetCount()>0?this.FLookupListBox.SetItemIndex(this.FLookupListBox.FItems.GetCount()-1):this.FLookupListBox.SetItemIndex(-1);else if(34===this.FKeyDown&&this.IsLookupListVisible())this.FLookupListBox.FItems.GetCount()>0?this.FLookupListBox.GetItemIndex()+this.FLookup.FDisplayCount<this.FLookupListBox.FItems.GetCount()?this.FLookupListBox.SetItemIndex(this.FLookupListBox.GetItemIndex()+this.FLookup.FDisplayCount):this.FLookupListBox.SetItemIndex(this.FLookupListBox.FItems.GetCount()-1):this.FLookupListBox.SetItemIndex(-1);else if(33===this.FKeyDown&&this.IsLookupListVisible())this.FLookupListBox.FItems.GetCount()>0?this.FLookupListBox.GetItemIndex()>this.FLookup.FDisplayCount?this.FLookupListBox.SetItemIndex(this.FLookupListBox.GetItemIndex()-this.FLookup.FDisplayCount):this.FLookupListBox.SetItemIndex(0):this.FLookupListBox.SetItemIndex(-1);else if(38===this.FKeyDown&&this.IsLookupListVisible())this.FLookupListBox.FItems.GetCount()>0?this.FLookupListBox.GetItemIndex()>0&&this.FLookupListBox.SetItemIndex(this.FLookupListBox.GetItemIndex()-1):this.FLookupListBox.SetItemIndex(-1);else if(40===this.FKeyDown&&this.IsLookupListVisible())this.FLookupListBox.FItems.GetCount()>0?this.FLookupListBox.GetItemIndex()+1<this.FLookupListBox.FItems.GetCount()&&this.FLookupListBox.SetItemIndex(this.FLookupListBox.GetItemIndex()+1):this.FLookupListBox.SetItemIndex(-1);else if(27===this.FKeyDown&&this.IsLookupListVisible())this.CloseLookup();else{if(46===this.FKeyDown&&this.GetSelStart()>=this.FPrefix.length){if(s=i.GetT(),0===this.GetSelLength()?pas.System.Delete({get:function(){return s},set:function(t){s=t}},this.GetSelStart()-this.FPrefix.length+1,1):pas.System.Delete({get:function(){return s},set:function(t){s=t}},this.GetSelStart()-this.FPrefix.length+1,this.GetSelLength()),this.FLengthLimit>0&&this.FixedLength(s)-1>this.FLengthLimit)return void c();this.SetModified(!0)}if(!(this.FMaxLength>0&&0===this.GetSelLength()&&this.GetT().length>=this.FMaxLength)){if(""!==this.FPrefix&&this.GetSelStart()<this.FPrefix.length&&this.SetSelStart(this.FPrefix.length),rtl.eqSet(this.FShiftState,rtl.createSet(2))&&""===p){o=pas["WEBLib.TMSFNCUtils"].TTMSFNCClipBoard.GetText(),l=e.IsType(o),a=!0;var u=this.FEditType$1;return 1===u||2===u?a=0===l:3===u||4===u?a=1===l:5===u?o=pas["WEBLib.TMSFNCTypes"].AnsiUpperCase(o):6===u?o=e.ShiftCase(o):7===u?o=pas["WEBLib.TMSFNCTypes"].AnsiLowerCase(o):8===u?a=1===l:9===u&&(a=l in rtl.createSet(5,0)),a&&this.InsertText(o),void c()}var C=this.FEditType$1;0===C||(1===C?pas["WEBLib.TMSFNCTypes"].CharIsNumber(p)||c():3===C?(pas["WEBLib.TMSFNCTypes"].CharIsNumber(p)||p===pas.SysUtils.FormatSettings.DecimalSeparator||c(),pas.System.Pos(pas.SysUtils.FormatSettings.DecimalSeparator,this.GetT())>0&&t.get()===pas.SysUtils.FormatSettings.DecimalSeparator&&c()):4===C||2===C?(4===this.FEditType$1?pas["WEBLib.TMSFNCTypes"].CharInArray(p,["-"])||pas["WEBLib.TMSFNCTypes"].CharIsNumber(p)||p===pas.SysUtils.FormatSettings.DecimalSeparator||c():pas["WEBLib.TMSFNCTypes"].CharInArray(p,["-"])||pas["WEBLib.TMSFNCTypes"].CharIsNumber(p)||c(),pas.System.Pos(pas.SysUtils.FormatSettings.DecimalSeparator,this.GetT())>0&&t.get()===pas.SysUtils.FormatSettings.DecimalSeparator&&c(),pas.System.Pos("-",this.GetT())>0&&"-"===t.get()&&this.GetSelLength()!==this.GetT().length&&c()):5===C?(p=(s=pas["WEBLib.TMSFNCTypes"].AnsiUpperCase(s)).charAt(0),t.set(p)):7===C?(p=(s=pas["WEBLib.TMSFNCTypes"].AnsiLowerCase(s)).charAt(0),t.set(p)):8===C?pas["WEBLib.TMSFNCTypes"].CharIsNumber(p)||p===pas.SysUtils.FormatSettings.DecimalSeparator||p===pas.SysUtils.FormatSettings.ThousandSeparator||c():9===C?pas["WEBLib.TMSFNCTypes"].CharIsHex(p)||c():10===C?pas["WEBLib.TMSFNCTypes"].CharIsLetterOrNumber(p)||c():11===C&&""!==this.FValidChars&&0===pas.System.Pos(pas["WEBLib.TMSFNCTypes"].AnsiUpperCase(s),pas["WEBLib.TMSFNCTypes"].AnsiUpperCase(this.FValidChars))&&c()),s=i.GetT(),pas["WEBLib.StdCtrls"].TCustomEdit.KeyPress.apply(this,arguments),i.GetT()!==s&&this.SetModified(!0),this.FEditType$1 in rtl.createSet(8,4,2)&&(r=this.GetT(),pas.System.Pos("-",r)>1&&(pas.System.Delete({get:function(){return r},set:function(t){r=t}},pas.System.Pos("-",r),1),this.SetT("-"+r))),8===this.FEditType$1&&this.AutoSeparators(),this.FEditType$1 in rtl.createSet(3,4,8)&&(F=this.GetT().length-s.length)>1&&this.SetCaretPosition(this.GetCaretPosition()+F),rtl.eqSet(this.FShiftState,{})&&this.UpdateLookup()}}}}else pas["WEBLib.StdCtrls"].TCustomEdit.KeyPress.apply(this,arguments)},this.KeyDown=function(t,e){pas["WEBLib.Controls"].TControl.KeyDown.apply(this,arguments),this.FKeyDown=t.get(),this.FShiftState=rtl.refSet(e)},this.KeyUp=function(t,i){var s=0,o="";pas["WEBLib.Controls"].TControl.KeyUp.apply(this,arguments),o=String.fromCharCode(t.get()),9===t.get()&&this.IsLookupListVisible()&&this.FLookup.FAcceptOnTab&&this.DoneLookup(),6===this.FEditType$1&&(s=this.GetSelStart(),this.SetT(e.ShiftCase(this.GetT())),this.SetSelStart(s)),""!==o&&"\b"!==o&&this.UpdateAutoComplete()},this.DoLookupNeedData=function(t,e,i){null!=this.FOnLookupNeedData&&this.FOnLookupNeedData(this,t,e,i)},this.DoLookupOpen=function(){null!=this.FOnLookupOpen&&this.FOnLookupOpen(this)},this.DoLookupClose=function(){null!=this.FOnLookupClose&&this.FOnLookupClose(this)},this.DoExit=function(){var t,e=!1;pas["WEBLib.Controls"].TControl.DoExit.call(this),0 in this.FComponentState||(this.FPrecision>=0&&this.FEditType$1 in rtl.createSet(3,4,8)&&(""===this.GetT()&&this.FAllowNumericNullValue||(e=this.FIsModified,this.SetFloat(this.GetFloat()),this.SetModified(e))),this.FEditType$1 in rtl.createSet(1,2)&&""===this.GetT()&&!this.FAllowNumericNullValue&&this.SetT("0"),this.FEditType$1 in rtl.createSet(3,4,8)&&""===this.GetT()&&!this.FAllowNumericNullValue&&this.SetFloat(0),t=pas.SysUtils.Trim(this.GetT()),this.FLookup.FEnabled&&this.FLookup.FHistory&&""!==t&&-1===this.FLookup.FDisplayList.IndexOf(t)&&this.FLookup.FDisplayList.Add(t))},this.LookupList=function(){return this.FLookupList},this.CanFocus=function(){return pas["WEBLib.Controls"].TControl.CanFocus.call(this)&&this.GetAllowFocus()},this.Create$1=function(e){return pas["WEBLib.Controls"].TControl.Create$1.apply(this,arguments),this.FAutoClose=!0,this.FAllowFocus=!0,this.SetAutoCompletion(51),this.FLookupFormTimer=pas["WEBLib.ExtCtrls"].TTimer.$create("Create$1",[this]),this.FLookupFormTimer.FOnTimer=rtl.createCallback(this,"DoLookupFormTimer"),this.FLookupFormTimer.SetEnabled(!1),this.FLookupFormTimer.SetInterval(1),this.FAutoThousandSeparator=!0,this.FLengthLimit=0,this.FAutoComplete=!1,this.FLookup=t.TTMSFNCEditLookupSettings.$create("Create$1"),this.FLookupListBoxItems=t.TTMSFNCLookupList.$create("Create$1"),this.FLookupList=pas["WEBLib.TMSFNCPopup"].TTMSFNCPopup.$create("Create$1",[this]),this.FLookupList.FStaysOpen=!0,this.FLookupListBox=pas["WEBLib.StdCtrls"].TListBox.$create("Create$1",[this]),this.FLookupListBox.SetItemHeight(18),this.FLookupListBox.FOnKeyUp=rtl.createCallback(this,"ListKeyUp"),this.FLookupListBox.FOnMouseUp=rtl.createCallback(this,"ListMouseUp"),this.FLookupListBox.SetVisible(!1),this.FLookupListBox.SetAlign(5),this.SetAutoSize(!1),this.FLookupList.SetContentControl(this.FLookupListBox),this.FLookupList.FFocusedControl=this,this},this.Destroy=function(){rtl.free(this,"FLookupFormTimer"),rtl.free(this,"FLookup"),this.CleanupLookupList(),null!=this.FLookupListBox&&(rtl.free(this,"FLookupListBox"),this.FLookupListBox=null),rtl.free(this,"FLookupListBoxItems"),null!=this.FLookupList&&(rtl.free(this,"FLookupList"),this.FLookupList=null),pas["WEBLib.Controls"].TCustomControl.Destroy.call(this)},rtl.addIntf(this,pas.System.IUnknown);var i=this.$rtti;i.addProperty("AllowFocus",3,rtl.boolean,"GetAllowFocus","SetAllowFocus",{Default:!0}),i.addProperty("Align",2,pas["WEBLib.Controls"].$rtti.TAlign,"FAlign","SetAlign",{Default:pas["WEBLib.Controls"].TAlign.alNone}),i.addProperty("Alignment",2,pas.Classes.$rtti.TAlignment,"FAlignment","SetAlignment"),i.addProperty("Anchors",2,pas["WEBLib.Controls"].$rtti.TAnchors,"FAnchors","SetAnchors",{Default:rtl.createSet(0,1)}),i.addProperty("AutoSelect",2,rtl.boolean,"FAutoSelect","SetAutoSelect",{Default:!1}),i.addProperty("AutoSize",2,rtl.boolean,"FAutoSize","SetAutoSize",{Default:!1}),i.addProperty("Hint",2,rtl.string,"FHint","SetHint"),i.addProperty("TextHint",2,rtl.string,"FTextHint","SetTextHint"),i.addProperty("BorderStyle",2,pas["WEBLib.Controls"].$rtti.TBorderStyle,"FBorderStyle","SetBorderStyle",{Default:pas["WEBLib.Controls"].TBorderStyle.bsSingle}),i.addProperty("Color",2,pas["WEBLib.Graphics"].$rtti.TColor,"FColor","SetColor"),i.addProperty("DoubleBuffered",0,rtl.boolean,"FDoubleBuffered","FDoubleBuffered",{Default:!1}),i.addProperty("Enabled",2,rtl.boolean,"FEnabled","SetEnabled",{Default:!0}),i.addProperty("Font",2,pas["WEBLib.Graphics"].$rtti.TFont,"FFont","SetFont"),i.addProperty("HideSelection",2,rtl.boolean,"FHideSelection","SetHideSelection"),i.addProperty("MaxLength",2,rtl.longint,"FMaxLength","SetMaxLength",{Default:0}),i.addProperty("PasswordChar",2,rtl.char,"FPasswordChar","SetPasswordChar",{Default:"\0"}),i.addProperty("ReadOnly",2,rtl.boolean,"FReadOnly","SetReadOnly",{Default:!1}),i.addProperty("ShowHint",2,rtl.boolean,"FShowHint","SetShowHint",{Default:!1}),i.addProperty("TabOrder",2,rtl.longint,"FTabOrder","SetTabOrder"),i.addProperty("TabStop",2,rtl.boolean,"FTabStop","SetTabStop",{Default:!0}),i.addProperty("Visible",2,rtl.boolean,"FVisible","SetVisible",{Default:!0}),i.addProperty("OnChange",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnChange","FOnChange"),i.addProperty("OnClick",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnClick","FOnClick"),i.addProperty("OnDblClick",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnDblClick","FOnDblClick"),i.addProperty("OnEnter",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnEnter","FOnEnter"),i.addProperty("OnExit",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnExit","FOnExit"),i.addProperty("OnKeyDown",0,pas["WEBLib.Controls"].$rtti.TKeyEvent,"FOnKeyDown","FOnKeyDown"),i.addProperty("OnKeyPress",0,pas["WEBLib.Controls"].$rtti.TKeyPressEvent,"FOnKeyPress","FOnKeyPress"),i.addProperty("OnKeyUp",0,pas["WEBLib.Controls"].$rtti.TKeyEvent,"FOnKeyUp","FOnKeyUp"),i.addProperty("OnMouseDown",0,pas["WEBLib.Controls"].$rtti.TMouseEvent,"FOnMouseDown","FOnMouseDown"),i.addProperty("OnMouseEnter",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnMouseEnter","FOnMouseEnter"),i.addProperty("OnMouseLeave",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnMouseLeave","FOnMouseLeave"),i.addProperty("OnMouseMove",0,pas["WEBLib.Controls"].$rtti.TMouseMoveEvent,"FOnMouseMove","FOnMouseMove"),i.addProperty("OnMouseUp",0,pas["WEBLib.Controls"].$rtti.TMouseEvent,"FOnMouseUp","FOnMouseUp"),i.addProperty("Text",3,rtl.string,"GetT","SetT"),i.addProperty("Version",1,rtl.string,"GetVersion",""),i.addProperty("AutoComplete",0,rtl.boolean,"FAutoComplete","FAutoComplete",{Default:!1}),i.addProperty("EditType",2,t.$rtti.TTMSFNCEditType,"FEditType$1","SetEditType$1",{Default:t.TTMSFNCEditType.etString}),i.addProperty("Lookup",2,t.$rtti.TTMSFNCEditLookupSettings,"FLookup","SetLookup"),i.addProperty("ValidChars",0,rtl.string,"FValidChars","FValidChars"),i.addProperty("AllowNumericNullValue",0,rtl.boolean,"FAllowNumericNullValue","FAllowNumericNullValue",{Default:!1}),i.addProperty("AutoThousandSeparator",2,rtl.boolean,"FAutoThousandSeparator","SetAutoThousandSeparator",{Default:!0}),i.addProperty("FullTextSearch",0,rtl.boolean,"FFullTextSearch","FFullTextSearch",{Default:!1}),i.addProperty("LengthLimit",0,rtl.smallint,"FLengthLimit","FLengthLimit",{Default:0}),i.addProperty("Precision",2,rtl.smallint,"FPrecision","SetPrecision",{Default:0}),i.addProperty("PrecisionDisplay",2,t.$rtti.TTMSFNCEditPrecisionDisplay,"FPrecisionDisplay","SetPrecisionDisplay",{Default:t.TTMSFNCEditPrecisionDisplay.pdNormal}),i.addProperty("OnLookupSelect",0,t.$rtti.TTMSFNCEditLookupSelectEvent,"FOnLookupSelect","FOnLookupSelect"),i.addProperty("OnLookupIndexSelect",0,t.$rtti.TTMSFNCEditLookupIndexSelectEvent,"FOnLookupIndexSelect","FOnLookupIndexSelect"),i.addProperty("OnLookupNeedData",0,t.$rtti.TTMSFNCEditLookupNeedDataEvent,"FOnLookupNeedData","FOnLookupNeedData"),i.addProperty("OnLookupOpen",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnLookupOpen","FOnLookupOpen"),i.addProperty("OnLookupClose",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnLookupClose","FOnLookupClose"),i.attr=[pas.Classes.ComponentPlatformsAttribute,"Create$1",[0]]})),rtl.createClass(this,"TTMSFNCEditButton",pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl,(function(){this.$init=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.$init.call(this),this.FBlockDropDown=!1,this.FPopup=null,this.FEdit=null,this.FButton=null,this.FPopupControl=null,this.FOnButtonClick=null,this.FModalPopup=!1,this.FBitmap=null,this.FBitmapName="",this.FButtonSize=0,this.FBitmapContainer=null},this.$final=function(){this.FPopup=void 0,this.FEdit=void 0,this.FButton=void 0,this.FPopupControl=void 0,this.FOnButtonClick=void 0,this.FBitmap=void 0,this.FBitmapContainer=void 0,pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.$final.call(this)},this.SetPopupControl=function(t){this.FPopupControl=t,this.FPopup.SetContentControl(this.FPopupControl)},this.GetText=function(){return this.FEdit.GetT()},this.SetText=function(t){this.FEdit.SetT(t)},this.GetBitmapContainer=function(){return this.FBitmapContainer},this.SetBitmap=function(t){this.FBitmap=t,null!=this.FButton&&(this.FButton.FBitmaps.Clear(),this.FButton.FBitmaps.AddBitmap(t,1))},this.SetBitmapContainer=function(t){this.FBitmapContainer=t,null!=this.FButton&&this.FButton.SetBitmapContainer(t)},this.SetBitmapName=function(t){this.FBitmapName=t,null!=this.FButton&&(this.FButton.FBitmaps.Clear(),this.FButton.FBitmaps.AddBitmapName(t,1))},this.SetButtonSize=function(t){this.FButtonSize=t,null!=this.FButton&&this.FButton.SetWidth(t)},this.SetAdaptToStyle=function(t){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.SetAdaptToStyle.apply(this,arguments),null!=this.FButton&&this.FButton.SetAdaptToStyle(this.GetAdaptToStyle())},this.BeforeDropDown=function(){},this.Loaded=function(){pas["WEBLib.Controls"].TCustomControl.Loaded.call(this),null!=this.FButton&&null!=this.FBitmapContainer&&""!==this.FBitmapName&&(this.FButton.FBitmaps.Clear(),this.FButton.FBitmaps.AddBitmapName(this.FBitmapName,1))},this.KeyDown=function(t,e){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBase.KeyDown.apply(this,arguments),115!==t.get()||this.DropDown()},this.Notification=function(t,e){1===e&&t===this.FPopupControl&&(this.FPopupControl=null),1===e&&t===this.FBitmapContainer&&(this.FBitmapContainer=null),pas["WEBLib.Menus"].TWebCustomControl.Notification.apply(this,arguments)},this.ButtonClick=function(t){this.FBlockDropDown||this.DropDown(),this.FBlockDropDown=!1,null!=this.FOnButtonClick&&this.FOnButtonClick(this)},this.ButtonDblClick=function(t){this.FBlockDropDown=!0},this.BitmapChanged=function(t){null!=this.FButton&&(this.FButton.FBitmaps.Clear(),this.FButton.FBitmaps.AddBitmap(this.FBitmap,1))},this.Create$1=function(e){return pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Create$1.apply(this,arguments),this.FModalPopup=!1,this.FButton=pas["WEBLib.TMSFNCToolBar"].TTMSFNCToolBarDropDownButton.$create("Create$1",[this]),this.FButton.SetTabStop(!1),this.FButton.SetAllowFocus(!1),this.FButton.FStored=!1,this.FButton.SetWidth(18),this.FButton.FAppearance.SetRounding(0),this.FButton.SetAlign(4),this.FButton.SetParent(this),this.FButton.FOnClick=rtl.createCallback(this,"ButtonClick"),this.FButton.FOnDblClick=rtl.createCallback(this,"ButtonDblClick"),this.FButton.FBitmaps.AddBitmapFromResource$1(pas["WEBLib.TMSFNCToolBarRes"].TMSFNCTOOLBAREXPAND,pas["WEBLib.TMSFNCTypes"].HInstance(),1),this.FButton.FBitmaps.AddBitmapFromResource$1(pas["WEBLib.TMSFNCToolBarRes"].TMSFNCTOOLBAREXPANDLARGE,pas["WEBLib.TMSFNCTypes"].HInstance(),1.5),this.FButton.FDisabledBitmaps.AddBitmapFromResource$1(pas["WEBLib.TMSFNCToolBarRes"].TMSFNCTOOLBAREXPAND,pas["WEBLib.TMSFNCTypes"].HInstance(),1),this.FButton.FDisabledBitmaps.AddBitmapFromResource$1(pas["WEBLib.TMSFNCToolBarRes"].TMSFNCTOOLBAREXPANDLARGE,pas["WEBLib.TMSFNCTypes"].HInstance(),1.5),this.FEdit=t.TTMSFNCEdit.$create("Create$1",[this]),this.FEdit.SetParent(this),this.FEdit.SetAlign(5),this.FPopup=pas["WEBLib.TMSFNCPopup"].TTMSFNCPopup.$create("Create$1",[this]),this.FPopup.SetPlacement(0),this.FPopup.FStored=!1,this.FPopup.SetDragWithParent(!0),this.FPopup.SetWidth(240),this.FPopup.SetHeight(160),this.FButtonSize=18,this.FBitmap=pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.$create("Create$3"),this.FBitmap.FOnChange=rtl.createCallback(this,"BitmapChanged"),this.SetWidth(118),this.SetHeight(22),this},this.Destroy=function(){rtl.free(this,"FButton"),rtl.free(this,"FPopup"),rtl.free(this,"FBitmap"),pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Destroy.call(this)},this.DropDown=function(){null!=this.FPopupControl&&(this.FPopup.SetPlacementControl(this),this.FPopup.FIsOpen?this.FPopup.SetIsOpen(!1):(this.BeforeDropDown(),this.FPopup.Popup(this.FModalPopup)))},rtl.addIntf(this,pas["WEBLib.TMSFNCBitmapContainer"].ITMSFNCBitmapContainer),rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas["WEBLib.TMSFNCTypes"].ITMSFNCProductInfo),rtl.addIntf(this,pas.System.IUnknown);var e=this.$rtti;e.addProperty("BitmapContainer",3,pas["WEBLib.TMSFNCBitmapContainer"].$rtti.TTMSFNCBitmapContainer,"GetBitmapContainer","SetBitmapContainer"),e.addProperty("Bitmap",2,pas["WEBLib.TMSFNCTypes"].$rtti.TTMSFNCBitmap,"FBitmap","SetBitmap"),e.addProperty("BitmapName",2,rtl.string,"FBitmapName","SetBitmapName"),e.addProperty("ButtonSize",2,rtl.longint,"FButtonSize","SetButtonSize",{Default:18}),e.addProperty("PopupControl",2,pas["WEBLib.Controls"].$rtti.TControl,"FPopupControl","SetPopupControl"),e.addProperty("OnButtonClick",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnButtonClick","FOnButtonClick"),e.addProperty("Text",3,rtl.string,"GetText","SetText"),e.attr=[pas.Classes.ComponentPlatformsAttribute,"Create$1",[0]]})),t.$implcode=function(){e.TTMSFNCEditAutoType={0:"atNumeric",atNumeric:0,1:"atFloat",atFloat:1,2:"atString",atString:2,3:"atDate",atDate:3,4:"atTime",atTime:4,5:"atHex",atHex:5},rtl.createClass(e,"TTMSFNCPopupOpen",pas["WEBLib.TMSFNCPopup"].TTMSFNCPopup,(function(){rtl.addIntf(this,pas["WEBLib.TMSFNCTypes"].ITMSFNCProductInfo),rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas.System.IUnknown)})),e.CheckTerminator=function(t){return pas["WEBLib.TMSFNCTypes"].CharInArray(t,[" ",",",".","/","\\",":","*","$","-","(",")","[","]",'"',"'","&"])},e.ShiftCase=function(t){var i,s=0,o="",n=!1;n=!0,o=t;for(var r=1,a=i=t.length;r<=a;r++)s=r,e.CheckTerminator(o.charAt(s-1))?n=!0:n?(o=rtl.setCharAt(o,s-1,pas["WEBLib.TMSFNCTypes"].AnsiUpperCase(t).charAt(s-1)),n=!1):o=rtl.setCharAt(o,s-1,pas["WEBLib.TMSFNCTypes"].AnsiLowerCase(t).charAt(s-1)),("Mc"===pas.System.Copy(o,1,s)||"Mac"===pas.System.Copy(o,1,s)||pas.System.Pos(" Mc",o)===s-2&&s>2||s>i-3&&(" I"===pas.System.Copy(o,s-1,2)||" II"===pas.System.Copy(o,s-2,3)))&&(n=!0);return o},e.IsType=function(t){var e=0,i=0,s=!1,o=!1,n=!1,r=0,a=0,l=0;e=2,s=!0,o=!0,n=!0,""===t&&(s=!1,o=!1,n=!1),r=-1,a=0,l=0;for(var h=1,F=t.length;h<=F;h++)i=h,pas["WEBLib.TMSFNCTypes"].CharIsNumber(t.charAt(i-1))||(s=!1),pas["WEBLib.TMSFNCTypes"].CharIsNumber(t.charAt(i-1))||pas["WEBLib.TMSFNCTypes"].CharInArray(t.charAt(i-1),[".",","])||(o=!1),pas["WEBLib.TMSFNCTypes"].CharIsNumber(t.charAt(i-1))||pas["WEBLib.TMSFNCTypes"].CharIsLetter(t.charAt(i-1))||(n=!1),t.charAt(i-1)===pas.SysUtils.FormatSettings.ThousandSeparator&&i-r<3&&(o=!1),t.charAt(i-1)===pas.SysUtils.FormatSettings.ThousandSeparator&&(r=i),t.charAt(i-1)===pas.SysUtils.FormatSettings.DecimalSeparator&&(a+=1),"-"===t.charAt(i-1)&&(l+=1);return n&&!s&&(e=5),s?e=0:o&&(e=1),(l>1||a>1)&&(e=2),e},e.HexToInt=function(t){var e=0,i=0,s=0;function o(t){var e=0;return e=0,t>="0"&&t<="9"&&(e=t.charCodeAt()-48),t>="A"&&t<="F"&&(e=t.charCodeAt()-65+10),t>="a"&&t<="f"&&(e=t.charCodeAt()-97+10),e}i=0,s=1;for(var n=t.length;n>=1;n--)e=n,i+=s*o(t.charAt(e-1)),s<<=4;return i},e.ValStr=function(t){var e=0,i=0;return pas.System.val$6(t,{get:function(){return e},set:function(t){e=t}},{get:function(){return i},set:function(t){i=t}}),e},e.CleanString=function(t){var e=0;return(e=pas.System.Pos("\r",t))>0&&pas.System.Delete({get:function(){return t},set:function(e){t=e}},e,1),(e=pas.System.Pos("\n",t))>0&&pas.System.Delete({get:function(){return t},set:function(e){t=e}},e,1),(e=pas.System.Pos("\v",t))>0&&pas.System.Delete({get:function(){return t},set:function(e){t=e}},e,1),t}},t.$init=function(){pas.Classes.RegisterClass(t.TTMSFNCEditButton)}}),["SysUtils","Types","WEBLib.TMSFNCUtils","Math"]),rtl.module("WEBLib.TMSFNCColorWheelResources",["System"],(function(){"use strict";this.GetColorWheelResource=function(){return"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAJYAAACWCAYAAAA8AXHiAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAAZdEVYdFNvZnR3YXJlAHBhaW50Lm5ldCA0LjAuMjHxIGmVAACqeElEQVR4Xuz9BbhVZdjufQM2onR3SSPdId0h3d0p3VLSISkp3S3S3SIhKSmpgISUNDLn9xvP5j3e3N+u59nv3vt9psdfFnOOcd/3uK9znec1FmvNFeH/i49aEUJxa0YIpawdIZS6foTQ+EYRQ+OboVXE0LG2EcPhjpHC4c7ohl7oi/4YhCEYgdH4FhMw2TlTnTvTGLMw15iLjR+wNEIo9ttp//3xv9qjVIRw8TIRQiUqRAxt+zJi6HC1SKG/ahFEvXfC4YZo+m443AKt0f69cPgrdEUP9H4/HP4aA/ENhmEUxnptPCZhCqY793vMwXxjLsJSc6yIFLq72pxrI4ZWrreGTRFCRd4u698f/zM+CkYItSwcMTy8eMTww1IKXE6hKyl6FdQghDqoTyCNPwiHm6EV2n7IrdAZ3T7iVuiL/hiMoRiB0RiHifjOsdMwE7ONMQ8LscTYy82xCj+Ycx02WsPmSKHQNmvaGSHUa3eEULO3y/33x/+oj88jhBJmixCqkytiaGk+QiqkiEUVs4TClkEFha6s4NUIoBbqEkVDNI3MrdD6Y26Fr6JwK/RAb3yNgZ9wKwzDKIz13HhMwhTMwCznzsECYy3GMmOvxBpz/YgN5t5sDVutZQd2W9s+a/zJWn+OGPr+sLWfjhCO9/Zy/v3x/+YjVYRQorQRQlUyRAzt+TxS6J8cCpVHwQooXGFFLKaYpRS1nAJXUuwqqKH4tQmhPhoTSTO0+pRboWNUboVu6BWNW6E/BmMoRmA0xmEivsM0x87EbMwzxkIsMeYKrDLHD1hnzo3m3oLt1rLLmvZa2wFr/Nlaj1jzMWs/ESn07JRrORMhVPKCa3t7mf/++O/1SBYhVBijU0cKPUmnIJkUJqsC5VSovApWUOGKKGAJhSyjqOUVt7JCV1P0mqhLBA2JoglaROdWaB+DW6EresTkVvgaA/ENhmMUxmI8JmEqZmCWc+ZiARYbaxlWGnsNfjTXBnNuxjZr2Gkte6xpv7UdtMZD1nrUmo9b+ynXcMa1nHdNF13blQjhAVcjhPK/vex/f/zbPMLvxrbJCSKGtifRp6S0+WkUIoOCfK4w2RUot0LlV7TCilcUJRWzLCoqbhVFrq7gtRW/PhoRRLNY4XBLtI0dDndAZ3SLw63QFwPicisMxQiMwThMxHden4aZmIP5zl2EpVhhzNVYa4715tqIrebeYQ27rGWvNR3Az9Z4BMes+aS1/+oazrmWC67pkmu76hqvu9abrvlmhHD2cIRwpLeb8e+Pf41H1AjhL2JGDB2Ipx9J5DM6mU1PpQBpFSKjgmTx2Z9DcfJwhAIK9oXiFVfE0opZXlEro6pC10RdhW9ACE3QgkBao308boWu8bkVeuPrBNwKQzAcozAW4zEZUzEDsxw7Fwuw2BjLsNKYa7DOHBuw2ZzbzL2T0PZYy34ctLbD1viLtZ6w5lPWfsY1nHctv7mmK67tumv8w7Xecs13XPtfEUM77kUI5Xq7Lf/++K99fBAhVOzjiKGz0Xzmxra58W1yYpud3MZ/pgDpFSKzz/hsCpNLgfIpVCEFK6pwJRWxrGJWUNQvFbe6QtdW9HpoRATNiKIl2ibkVuiciFuhV2Juhf4YjKEYkYRbYRwm4jvPTcf3mIP5zluEpVhhrNVYa+z12GSurebcgd3WsM9afrKmQ9Z21BqPWetJa/7V2s+5houu5bJruurafneNNwnstmu+59of2INH74TePIkYOvgsQrjA223698d/3iP8boQIoXzvRQzv+kgMfGIzY9jUODY3AUEltdkpbXoan+EZFOFzxcihMLkVqIBCFVawYgpXSgHLKWQlBa2quDUVuY6CN1D8JmhOEK2JpB2+Ssqt0CMZt8LXGJicW2E4RmEsJmAypmIGZmGuYxdiCZYbYxV+MOY6bDTHFnNtxy5z77WG/dZy0JoOW9sv1njCWk9b81lrv+AaLrmWK67pumu74Rr/dK13XPNfBPbQHvxtL57Zkxf25rU9CnGwf4/I/9Tjo1DCiO+GFkXiUO/bvMg2MarNjElQ8WxuIp/JyWx2Khufzmd4JkXIqiA5FSavAhVUqCKKVkLxyihiBcX8UlGro5Yi11PsRgrflAhaoi1hdEDnFNwqJbdCXwxIxa0wFCMxBuNScytM8fF0fI85mI9FzlmKFcZZjbXGXI/N5tiKHebcbe591vCTtRzCUes7bp2n8CuRnbP2i67hsmu55pr+cG23XONt13rPNT9w7Y/twVMCe25PXtmbN/YpHCkUDkV8OZHAEr7dxX9//J8eUUKVIn0UfviOjXvPxn2AKD6OZjNj2dT4NjexTU5usz/zmZ3e5mdWiGwKklth8hNUYUUqRkylFK6sIlZUzCqKWkNx6yh0AzRW+OZE0Jog2uErYumCHp9xK3ydhlthCIan5Vb4FhMwGVMxE7MxzzELsQTLnbsKPxhrHTYaewu2m2uXOfea+4B1/Iwj1nTM2k5Y42lrPWvNF6z9kmu46lp+d003XNufrvGua73vmh+59if24Jm9eGlP/rE3IXsUfu9NOPzOq3Ao0rP7oQhPSr3dzX9/EFTsiFFDV9+xce+y//dt3oc2L7II+AQx/D2O1xLY3KQ2OaXNTmPTM9r8LAqRQ0Hy+OwvoDhfKFRxBSutcOUVsLJiVlPUWopbV5EbKnhTtCSANsTQAZ0IpFs6boW+6bkVBmMoRmbgVhiHSZiC6fgeczDfMYuwDCudvwY/YoMxNxt7G3aaa4859+OgNRyylqPWdNzaTlnjGWs9b82/Wftl13DNtfzhmm65tjuu8S/X+sA1P3btT+3BC3vxyp6E7E04cshmvbZpL2zeU+J6HApFfHgqHOFG5Le7+//RR+xQ/UixQ+feYf/v2bwPbN5HIuBjGxjFBkZFTB/H9VwiryezyalsdjqbnsnmZ1WInD7j8ypKQQUqqlAlFayswlVUwCoKWV1BaytufUVurODNFb4VIbTDV8TRJSO3Qm98nYlbYUhmboVR+BYTMBnTMBOzMQ8LsQTLnbMKPxhjPTYadwt2mGOX+fbigLl/toYj1nLMmk5a26/WeM5aL1jzJWu/6hp+dy03XdNt13bPNd53rY9c8xPX/twevLQX/9iTsE/CcJR/bNZLm/bM5j2xiY+4133ReO9sKMKfdd7u8v+HHmlCn0RMGN71ToJQ6F2foe/bwA9tYGQxEMUmfmoToxFbdBsZC/H8PbHnkzvmM8emt+mZbX52n+m5FSO/whRWoGIKVUrByilcJQWsqpA1FbWuAjdEU8VuofBtiKADQXRCt8/D4Z7om8WdIAZn5VYYiTEYl41bYQqmYxbmYoHXFmMZVmKNc3/EBmNtxjZj7zTPHuw350FzH7aGX3DCmk5Z2xlrPG+tv1nzFWu/7hpuENgt13THtf3lGh+61r9d8zPX/sIevLYXIXsSji4Co72yWdwqylOb99gmPrCZ97jXHe5181Uowu9rNfbvvd31/8UfyUM5IyYL/fSODXzPBn5gAz/yWfqxTfzEJkYltOg2MoaNjEVocWxmAh8n8VxKr6dxXEbnZHFuDoLKoxgFFaaIApVQqDIKVkHhvlTA6opZW1HrK24jhW6m4K3QjgA6EkMXAumB3tm5FQbm4FYYjlE5uRUmYDKmYSZmYx4WYSlWOHY11mK9MTZhqzF3YLc59pnrJ3P+jKPWcMxaTlrTr9Z2zhovcrLL1nzN2n93DTcJ7LZruufaHrjGx671iWt+7tpf2YM39iIcRwTGEoExuFV0bvXp3zbvoU28bzPv2tQ/be4N7nWde13ZHYpwKefb3f9f9JE2VCJS6tCbd23g+8TwoU2MbBOj4FNCi4oYNjOmzYxNbHFtaHwbmpDYkvk4lefTeT2TTc/qnJzGyGesQgpTVIFKElRZBauocFUUsIZC1lHQBorbRJFbKHZrhW+PToTQjTB65uJW6J+bW2EoRubhVhiHSZiSl1thFuZigecWYxlWYo1zfsQGbDHWduw09l5z7DfXQRw29y/WcMJaTlvTWWu7YI2/WesVArtu7Tdcw5+u5a5r+su1PXKNf7vWZ675pWv/xx6E7EU4PreKy61iP7dZIjA6t4rKrT7lVlFu29SbNvcPm3yNuC5zr4tPQhEu5Hlbhf+FHoXD70bIEJofKV3o5Xs28QOb+KFN/Bif2MioPluj2cyYNjMWscWxofGQgNAS2dQkNjW5Pz+zyek9n9lx2Z2T27n5jVHYmMUJqrRClVewygpXTQFrKWQ9BW2ksM0UuaVit1X0jgTQhSC6ozeh9MvHrfANhufnVvgWEwpwK0zDTMzGPCzCUqxwzGqsxXrnbsJW4+3AbmPvM89POGTOo+Y+bg2nrOWMNZ2ztovWeNlar1nzH9Z+yzXcdi33XNMD1/bYnjx1rS9c8yvX/sYehBNzq4TcKoEIjMet4nCrWNwq5l828Q5xcatPuFXk6zb5is3+TTSeJ66zf4cinJ4hGiO+rcr/Ao8soRWRbOB7+MAmfmQTP8YnPluj2szoNjMmYhNcXJsa36YmJJzENjapjU1GbClsbhofZ/B8Fq/ncGwe5xR0fhFjlTBuGYWqoGBfKlwNBaytkPUVtLHiNkdrxW6v6J0IoCsx9CSOvuhfkFthaCFuhTGFuRUmYQqmYxbmYgEWYzlW4Qesc85GbDHGduwy5l4cMMfP5jpizl/MfdIaTuOsNV2wtkvWeNVaf7fmm9b+p2u461ruu6ZHru2JvXjmWl/ah3/sQdgehJNp2JNwq8TcKiG3iq9hjysCY4vAmNwqOreK+rvNvWqTL9nsizb9HHH9Gg5HOhkORTi28G1V/id+pAp9EDFHeNk7NvE9m/gBPrKRH9vITxHNZsYgtlg2NA7i2dQExJbIxiaxscmIJ7nNTWlzUxNUWn9m8vesXsvluHyOL+S8osYpabxyxq9krqoKV1MB6ypmQ0VtqrgtFbmNYndAZ8XvTgi9iaLfF9wK3xThVhhVlFthAiZjWjFuhdmYj0VYihVeW4212IBNzt2KncbaY9x9+Mkch8111JzHccoazljLeWv6zdqucLJr1vqHNd+y9juu4S/X8tA1PXZtT13jC9f62jWHXHs4tQhMya2Sc6ukGvYkIjARt0rAreJxqzi3bKYIjCECo3GrT7nVx+dt+hmbf0oRjovGX/Rdh6ZwrnfeVul/skf68PsR84ZWvmMT37eJHyKyYkdBVBsazYbGsKGxEdemxie4hDY2MZLa3OQEl9IGp7LBn9ngtMSW3iZn9mc2z+X2Wn7HfeG84s4vbZzyxq1s/OrmqqWA9RWysYI2U9zWitxOsb9S+K4E0BN9CKI/kQzG0OLh8IgS3ArjMKkkt8IMzMJcLMASLMcq/IB1jt2ILdhujF3G2osDxv7ZHEdwzJwnzf2rNZyzlovWdMnarlrj79Z605pvW/s913DftTyyB09c23PX+Mq1vnHN4XQiMC23+kzDnkoEpuRWyblVUm6VmFslFIHxRWBcbhWbW8XgVtEuENdZm37a5p9UhGPEdYS4fiauA9//TxmLEQuFlr9jI9+3kR8iss38xGZGRXQbGhOxiS6ujY1vYxMhic1NSnApbHAqG5yaaNLY5HQ2OQOhZbLRnyOHv+fxWkHHFHF8CeeVMU5F41Uxbg1z1TFnA/M3UdAWCttGgTsodmdF70YAvQihHwYSxzeluBVGleZWmFAmHP4O0zATs8tyKyzCUqzw3Gr8iA3Y7Jxt2GmMPdhvzIPGPoxfzHXCnKfMfdYazlvLb9Z0xdquW+MNa71lzXes/S/X8NC1/O2anrm2F679tWsNueZwRm6VQQSm41ZpuFVqbpVSw55cw56UWyURgYm4VXxuFfeyzRWBMblVdG4VlVtF4VaRjyrGIeL6ibj2EdfuRW/L9T/BozqnKkZUNvJ9fGgzI9vMKIhqQ6Mjpk2Ng3g2NoGNTURsSZDMBqe0wals8GdIa5PTI6ONzkxsWWx2VoLK6c98nivktaKOK+Wccs6vZKyqxqxljnrma2TuZtbQSmHbKXBHhe6i6D0Uvw8hfE0UgzCUWEaU41YYV55bYQpmVOBWmIsFWILlWIUfsM4xG7EVO5y7C/uM9ZMxf8YRcxw310lz/mruc9Zw0VouW9M1a/vdGm9a621rvmftD1zDY9fyxDU9d22vXPMb1xrOyq2yiMBM3Cojt0qvYU8rAj/jVqm4VQpulYxbJdGwJxKBCbhVPG4Vh1vF5FbRT9j8XxThsGL8rCgHiGsvce0iru0a+mX/g8diaT1VafFnM9+3mR8isg2Ngqg2NTpi2tg4iGdzE9jcxEhqg5Pb4JTElhppbHQ6G53BRmcits9tdlabnY2r5bDhuZHfx4U9X9wxpR1b3nlfGqO68Wobu745GpuvublbW097Re6k2N0UvhcB9MMAgviGQIZV5FYYW4lbYTKmVeZWmIP5WPQlt8JKH6/Bj9iAzY7dhp3YY4z9OGjMw8b+xRwncNqcZ819wRouWcsVa7pubTes8U9rvWvNf1n7Q9fwt2t55ppeurZ/XGPItYZzcKts3Cqrhv1zEZhJBGbgVum4VRoNe2pulVIEJheBSblVYm6VQMMeT8MeRwTG5FbRuVVUbhWFW0Xepzi7iWsHcW0lrk3E1f9/3O+QiFheo24j38eHNjMyPkFUmxrDpsZCXBsbHwmJLjGS2uTkNjkVPrPRaW10ehudkdgyI4sNz2bDsxNbTpue26bnJbYCKOLvJbxW1jEVnVPFuTWMU9eYDY3d1Hwtzd3WGjpaUxfF7q7ovRX/a0IYhCHEMYJgxmBcFW6FKVXdCWJWNW6FhViC5ViFtVjv9U3Yih3O2Y19xvgJh4x51NjHccpcZ8x5ztwXreGytVyzpj+s7ZY13rHWe9b8wNofu4anruWFa3rl2t64xnBebpWbW+UUgdlFYDZu9Tm3yqxhzygC02vY03Krz7hVKm6VXMOeVAQmFoEJRWB8bhWXW8XiVjEOKsZ+4tqjODsVaRtxbSGujcS1/n/AWAy+TlU5tOIdG/q+zfwQkW1oFES1qTEQy8bGRXybmxBJbHAypLDJqWzyZ0hLcBlsdiabnRlZbXh2Ysth03PZ9DyEls/GF7DxhVDUx6U8X87rlRxbzTm1jFHPWI2M28w8rczZzvxfWUtX6+ppjX0VfwAhDCaKYRhFKGOrcytMrsGtMLMmt8J8LMIyrMQa/IgN2Ixtjt2Fvc49gJ+NdcSYx3DSHKfNddacF8x9yRquWsvv1nTTtf9pjXet9b41P7L2J67huWt56Tr/cW1hn0zh/Br2fNwqD7fKxa1ycKtsIjCLCMzMrTJxq/TcKi23+kwEphKBKbhVMm6VhFsl1LDH17DHFYGxRGAMbhWVW0XhVpG3KtYm4lpPXGvDoQirZv+PFYvVQvMj2dD38KENjYwoiGpjYyCWzY2L+DY4IZLY5GRIYaNT2+g0SGezMxBCJnxu07Pa9Ow2PSdy2/i8BJff5he0+YWJ7QsFKI7S/l7e8186prpjazu3vjGaGLOF8duYp4M5O5u/uzX1xtfWOZAIhhDECOIYjXG1uFVtboUZdbgV5mJhXW6F5ViNtVjv+U3Yih3Y7Zx9+MkYh4x1FMeNfcocZ8x13py/4Yo1XLOWP6zplrXdcc1/WetDa35s7U9dwwvX8to1hVxb+AsRWJhbFeRW+blVXg17bm6Vk1tl51ZZudXnGvZMGvYM3Codt0rDrVJzqxTcKpkITCICE4rA+CIwLreKxa1icKuo3CrKZsXaoGg/Kt4P4XCklcS1dOTbqv6//KgVKhGpVujlezb1A0S2qZ8gqo2NjliIa4PjI6FNTmKDkyEFUhNdGpudDhlteGYbngXZbHoOwsiFPDY/n80vYPMLEdsXClBUAYoRWglFKOPjip6r4vUajqvrnIbOb2q8lsZta46O5upi/p7W0sfa+lvnYEIYhpGEMZZYJtTjVpiGmfW5FeY34FZYhpVYg3XYiC3Y7phd2OucA/jZOEdwzJgnjf0rzpnvIi6Z+6rr/91ablrTbWu7Z40PrPWRNT+x9ueu4ZVreeOawiVEYDFuVUTD/oWGvZAILMCt8nGrPNwql4Y9hwjMJgKzcKvM3CoDt0qnYU+jYU8tAlNwq2QiMAm3Ssit4mvY4+5SlO2KIwKjbiSudYq2VvFWh8PvrgiHIi1+FoqwKPfb6v6/9GgUyhmpXujNezb1A3yEKDY2KqLb3JiIi/g2OCGSKGgypLDRqZHGZqdDRkXPbNOzILuNz4ncNj+Pzc9v8wsSW2EUUYSiilCc2EoqRGmFKEdslXxc1fO1vF7P8Y2c19wYrY3X3tidzNXNvL2soZ/1DLS+IdY6nChGYxyRTGzIrTC9EbfC3MbcCkuwHKubcCus9/EmbMNO7Hbsfhx07mH8YqwTxjyFM+Y4b67fzHnF3Net4Ya13LKmu9b2lzU+tNa/rfmZtb90Da9dS8g1hUtzq5IisLgILMqtinCrQhr2ghr2/CIwjwjMxa1ycqtsGvYsGvbMIjCDCEwnAtNwq1TcKgW3SsatkojAhCIwvgiMIwJjisDo3Coqt4qyRvFWKuIy4lqs31rwJhRhbo63Vf7v/GgS+iRi49BP79rcD2zsR/gYUW1udMREHJscHwltchIks9EpkNpmp0E6ZLTpmW16FmSz8TltfG7kJbgCClAQhRWhqCIUI7YSClFKIcoQWjnFqKAYlf1Z3XO1vdbAcU0c38L5bYzTwbhdzNHDXH3M/bV1DLKmodY30nrHWv94TCaaaU25FWY341ZYhGVY2ZxbYR02YovntmMX9uKAc37GEWMcM9ZJ/Grsc+a4aK7L5rxm7j+s4aa13Had96ztgTU+ttan1vzc2l+5hjeuJVyeW5UTgWVEYCluVYJbFROBRUVgYW5VkFsV4FZ5uVVuEZhTBGbjVlm4VWZulYFbpdOwp+FWqTTsKbhVMhGYhFsl5FbxuFUcbhWTW0UXgZ+uUrzlirhEk7xQvzWPuOZsE4sfva32f79HxGbhXe/Y1PfxIT7GpzY3GmIijk2Oh4RIYqOTIYXNTo00NjwdMtr0z5HVxmdHTpufG3kVoIACFMIXhFFUIYorREmFKI2yxFZeQSoqSCViq6IoNXxc13MNvd7Usa2c1875Xxmvq7F7mqevOQeY/xtrGW5do63zW+ueSCxTML0Ft2rJrbAQS1pxK6zGWqzHZmzDTuxxzH4cxGHn/mKMEzhtzLPGvmCOS+a6as7r5r5hDX9ay11rum9tj6zxb2t9Zs0vrf0f1xByLeFK3KoityrPrcpq2EuLwJLcqji3KsqtvuBWhTTsBURgXhGYm1vl5FbZuVVWbvW5CMyoYU/HrdJwq9TcKgW3SsatknCrhNwqnoY9jgiMKQKjrVC8pYq4SDHnK+oc4vpevzV98dty/3d6tAnVf6dVKPSezf0QH+MTRLPBMRAb8Wx0AiRGMpudAqlteBqkQ0Yb/zmy2vwcyKUAeZBPEQoqQiF8oRDFFKIESilGGYIrpyAVFKQSsX2pKFUUpRqh1fJnPX9v7LXmjmvt+PbO62Sc7sbsbeyvzTPQ3EOsZYR1jbHO8Zhs7VNbcyvMacOtsKgtt8JKrME6bMQWbMdu7MNPjj2Eo849jlPGOmPMc7hojsvmu4Y/zH3LGu5Yyz1remhtj63xqet5Yc2vrf2NawhX41ZVuFVlblVJBFbgVuW4VRluVUrDXkLDXoxbfSECC3GrAtwqn4Y9j4Y9l4Y9uwjMKgI/51YZuVU6DXsabpVKw55Cw55Mw55YBCYQgfFEYGxuFUMERlusiNwq8jxFnaWZn6nfmvomFOG78m+r/m/8aB+KHald6Ny77UQgIuMTRLXJMRAbcW10AiRGUpudAqmRxqanQ0ab/jmy2vjsyIU8ip1PAQqiMMEVQXHFKKEYpVBWQcorSEViq6woVVBVYaoTUU3Fqa049f3ZxHMtHNPGsR2d18UYPYzVx/j9zTPYvMOsYZT1fGt9E6z3O0x3Dd+351ZY2IFbYQVWd+RWWI/N2Iad2OO1/TiIw875BSeMcdpYZ3HB2JfMcdVcv5vzprlvu7a71nLfmh65nifW+Nx1vLTmf6w97BrCNTXs1TXsVblVFW5ViVtV1LCXF4FlRGApblWCWxXjVkW4VWERWFAE5uNWebhVLm6VnVtl1bBnFoEZNOzpRGAaEZhKBKbgVklFYGJulYBbxeVWsblVDG4VlVt9wq0if6+40/VbU0TipF9DEcbEeFv9f7tHxK9CV9/5ilviI0RBVBsdHbEQF/FtdiIkRXIbngppkM7GZ0RmZLX5OZBLAfIgnyIURGGFKILiilFSMUqjLFGUV5SK+FJhqipMNaKpoTi1FKcOIdVToIZo6u8tvdbOMV85vqtzexqrnzEHGn+IuUaYd4w1jLOmSdY41Zpnuo7ZmN+JW2EZVnYOh3/AOmzEFuzAbuzDT445hKM47txTOGOs88b8zdhXzHHNXDfMecvcd6zhL9fz0Jr+tran1vjCWl9bc8jaw/VEYB1uVYtb1eBW1TTsVUVgZRFYkVuV51ZlNeyluVVJDXtxEViEWxXmVgW5VT5ulYdb5RKB2UVgVhGYmVtlEIHpuFUabpWKWyXnVkm5VSINe3xuFZdbxVqgiHNFIreKMkNxpyryZJE4gbi+Pf62/P9Gj66hSu905ZL4EB/jU0TrIqoRB/GRyKYnQXKksumfIR0y2vjMyILsCpALeRQhHwqisGIUUYziKKkgpVFOUSooSiV8qTBViaS64tRUnNqoq0D1ia2hIjVSpOb+bO259l7r7NjuzultjK+NNci4Q80x0lxjzT3BOr6zrunW+b11z8UC17Okm94Kq7EW67tzK2zDTuzx3AH8jCOOP4aTzj2Nc8a6aMxLxr5qjt/NddOct819zxoeWMsja3pibc+t8ZW1vrHmcCMR2JBb1edWdTXstUVgTW5VnVtV5VZfcqtKIrCChr0styotAktyq+LcqoiGvbCGvaCGPR+3ysOtcnGr7NwqC7fKzK0ycKt0GvbPuFVKDXtyEZhEw55Iwx5fBMYRgTFnK+ZMRZ2muN8p8kTFHicSR4fCEUb/G/3kde9Qwkg9ww/f7cklERmf9OBWiInYiIeENj4JkiGljf8MaZHB5mdGFmRDTkXIg3wKURCFFaMIiitISZRWlHKooDCVFKYKqilODcWphToKVI/YGihSI0VqTGxNFaoF2vi4o+e7OKaHY/s4d4BxvjHecGOPNt84c0/CFGubgdnWO8/6F2GZa1uJH3pxK2zEVuzAbuzDTzjkmKM47pxTOGOM88b6zfVdMfZ13DDXn+a8a+6/rOGha/jbmp5Z+0trfG2tIWsON+VWjTXsjURgA25Vj1vV4Va1uFUNDXs1EfilCKzErSpwq7LcqrSGvaQILC4Ci3CrwtyqILfKx63ycKucGvZs3CqLhj2zCEyvYU8rAj8TgSlFYDIRmFgEJhSB8URgbBEYQwRGnaK4kxR5vGKPFYmjuNbwP8IR+kd5q4Z/pUf/8LsR+4YWvdOXO+IjROljfsRALMRFgt7WiaRIidQ2Py0yIBOyKEJ25FSE3MiHgopRGEVQXFFKoozClENFhamsMFVQjehqoLYi1VWk+orUgGAao4liNVOsFoTUSsHa+fMrf+/mtV6O6+ecgc4dYpwRxh1jjvHmm2z+adbzvbXNwQJrXuI6lmO1a1yLDdiMbdiFvTiAn3EExxx7Er8695wxLuKyMa8Z+w9z3DTXHddxz9wPrOGxtTy1pufW9soa31hvuBW3aiECm4nAJtyqMbdqoGGvr2Gvy61qicAa3Koat6qiYa/MrSqKwHIisAy3KsmtinOrIhr2whr2ghr2fCIwt4Y9pwjMJgKziMBMIjC9CEwrAlOLwBQiMKkITCwCE3CruCIwlgiMIQI/naDI3yr2aEUfIRKHEtfgaWHd0FtV/Cs8+ofyRRrAFfEhPu5vXkRHTMRB/K+5KpIiBVIhTT/XgUz4HNkUIidyI69iFERhFFGU4iipKGVQXmEqorLiVEV1BaqJ2opUlzDqK1RDNFGsporVXLFaEltrBWurYO3R2cfdPd/b6187drDzhhljlPG+NfZE80wx5wzzz7Keeda3CEuteyXWuKZ12Oh6t2IHdmMffsJhr/2CE449jbPOvYBLxrpqzOvGvmGOP81115z3rf2RNfxtLc+s6aW1/WONYZ8U4bbcqjW3asmtmmvYm4rAJiKwIbeqz63qcqva3KqmCKyuYa/CrSpzq4rcqjy3KqNhLykCi4vAIiKwsAgswK3yisDcIjAnt8rGrT4XgZm4VTpulUYEpuJWyblVEm6VSATG51ZxuFVMERh9HNcao9gjFX2Y4n8TDkcaGA5F6J/trSr+2x8RB4d3vTuYKyIyoiAaYiD2IC6KhEiC5EiFzwZaPzIis0JkRQ7kRl4FKYBCKKIoxVESpRWmHCoqTmVUVaDqqKlIdVBPoRooVCM0UaxmhNJCwVopWBu0U7QOitYRXdDD3/t6foDjvnH8cOePMc44Y042/lRzzTTvHOtYYF2LrXU5Vlv/WmxwfZuxDbuwFwfwM47gmGNO4oxzzuGiMS4b65ox/zD2LXPcMddf5nxo7sfW8NRaXljTa2t7Y43hjtyqA7dqx63aiMBWIrAFt2rGrZpo2BtxqwYa9noisDa3qsmtqnOrKtyqsoa9oggsJwJLi8CS3Kq4CCzCrQpxqwLcKi+3ysWtcnCrrNwqM7fKyK3ScavPuFVKbpVMw56EWyXkVvFEYGxuFYNbRR2l2MMVfQjXcqHv9OdafTe+lcV/42NIqFikYaHQe0QbCPdjfIroiDWUeyIBEiMZUiK1daRFBmRGVmLPjlzIgwKKUghfoLj1lkRplFOciqisQFVRXZFqoo5C1UMDxWqEpgrWXMFaorWitVW09sTWUeE6KVxnYuumeL183M9zA70+1HEjnTfW+ROM9Z1xp5tjlnnnWcdCLLW2lda7Butcx0ZsxQ7Xuhv7cRCHPfcLTuC0Y8/ignMvGeMqfjfmTWPfNsddc9035yNzP7GG59byypr+sbawNYY7a9g7adg7isD23Kott2rNrVqKwOYa9qbcqhG3asCt6nGr2hr2mhr26iKwigisLAIriMBy3Ko0tyrJrYpp2L/gVoW4VQENex4Ney5ulV3DnkXDnplbZdCwp9WwpxaBKbhVMg17Yg17Am4Vl1vFEoHRReCnLvJjFxVE1Xv9NPK9X4Ui9Pxv/7fEiKNCZ/Vu4Q8QGZ8gGneMiTiIj0RIiuRIZS1pkB6ZkAXZiT4n8iA/CirOFyiGEtZdGuVQQYEqoyqqK1RN1HFN9dBAsRqhKeE1d40t0Ubh2ilce4X7Cp0JrQu6KWAPBeyNr/19sKIO8/oox3/rvEnGmWrMmcafY6755l5sLcuxyvrWWvMGbHY927ALe3EAh3AUx3HKMWdw3jm/OfcKrhvrhjFvGfuOOf4y10Nz/m3uZ9bwwlpeW1/I2sI9RGA3EdiFW3XiVl9xq/Ya9nYisA23asmtmnOrptyqkYa9gQisJwJrc6ua3Ko6t6rCrSpzqwoa9nLcqrQILKFhL6Zh/0IEFhSB+TXseURgThGYTcP+uQjMJALTi8A0GvZUIjC5CEzCrRJq2ONr2OModEwXFs2FfGLTI9voD2ymu7dQxG7b38rjv/LxbfiLd8zxXtDD+TMKoiI6YiMeEiCJKE6GlPgM6ZARnxN9NuRAbuSz1oIojKIooTilUBYVFKgSqqC666mJOqinWA0UqxGaormitXStbdBO4TooXCd0du1dFbC7Ava0B70Vsa8iDvDnN54b7rUxjhvvnMnGmGas74091xwLzbnUGlZY0xqss9aN1r8VO7Ab+13nQRz28S84gdM469iLzrmEq8b43Vg3jXnb2PfM8cA6H5nzibmfW8Mra3ljTeE+IrA3t+rJrbpzq64a9s4i8CsR2IFbteNWbTTsLTXszblVUxHYiFs14Fb1uFVtblWTW1XnVlVEYCUNewURWFYElhKBJURgURFYWAQWFIH5RGBuEZhDBGYTgZlFYEYRmE4EfiYCU2rYk4nAxIqdwEXFdSGxbFR0C49q0R/bzA99NrzXnWt1CYUidP7srUr+Cx873QlOCB1411wfIDI+QTTERBzEJ+5ESIoUSI20yIDM3DQrsiMX8qKANRdGURRHKYUqi/KopEhVUA01XVcd1EMDBWuEporWAq1cbxu0V7yOitcJXRSwmz3ooYi90Ech+9mP/sQ2UDGH+Hik58Y6ZoJjpzh3hjFmG2++sReZZ5l5V1nHWutaj83Wuw27XMteHMAhHMVxnPLaGZx37G+44tzrxrhhrD+NedfY983x0Fx/m/OZuV9awz/WErKm8Nfcqh+36qNh7yUCe3CrbtyqC7fqpGHvIALbicA23KoVt2rBrZpyq0Ya9gYa9noa9toa9poisJoI/JJbVRKB5blVWW5VilsVF4FFuFUhEVhABOblVrlEYHYRmFUEZhKBGURgWhGYWgSmcEFJXUQQQfFtbBwLjmmx0XwmfMJmI8vwD+T3u524VodN/3V3iFNC+SOZ7z18hCiIiuBONDbiISGSIDlSIQ0nTYdMyIJsyIk8yG/dhVAExVCSMMugPCriS8Wqhhqo7frqoYGCNUJTtFC4VmjrutujowJ2RldF7G4feipib/RVyK/tyQDFHKiY3xDaMH+O8tw4r01y7FTnzHTuHOMsMOYSc63AGnOvs5aN1rcFO6x7N/bjIA7jGE7iV5xzzEVcds415/5hjFu4Y8x7xn5gjsfmemrOF+Z+ZU1vrCU8mFsN1LAPEIH9uFVfbtWbW/XgVt1EYFcR2JlbdeRW7TXsbblVKw17CxHYVAQ2EoENuFU9EVhbBNbgVtW41ZfcqiK3Ks+tynCrktyqGLcqwq0Kcqv83CqPCMzJrbJxqywiMKMIDIqWxgWksvDkFpzEYhNaaFyfBbHZf/A1pU81sR9rXj90K/6eW/BI7dwhtvz8rVr+8x8Rp4W2v0vMHyAyPkE0xEQcxEciJEUKThq4aVpkQGZkRQ7ktu58KIgvUBQlCLQ0yqEiviTKqqiB2qjrOhugkaI1RXO0Ury2aO/6O6KzAnZFd6LrZT96o69i9lfMgRikmN9gKLENt09jfDzenk12zHTHznLePOMsMuYy468y3w/mXo/N1rTNOndhLw64jkM4iuM45bmzOI/fHHvVOddxwxh/GuuuMe8b+5E5npjrmTlfmvsfawlZS3got/pGBA7iVgO51dca9r4a9t7cqie36s6tunKrTiKwo4a9vQhsKwJbicDm3Kopt2rErRpwq7rcqpaGvQa3qqphr6xhr6BhL8etSmvYS3CrotzqCw17QW6Vj1vl5lY5RGBWxcts4RksOK3FprZxKSwyqc+ARNwqvgiMIwJjisBo7jY+cSsb+SuiaM+1WnOtFpveyuU/8/F9qHCk790J6us+wsccMypiIDbiISGSIDlSIQ3SI5P1ZkF25EJeFEBhFPUJUhylUBYVUNm1VUV11EJdhauPRmiK5orXEm0UsD06orO96IruCtlLIfugn73pr5gDMZjghtinYYo6QlFH2a+x/pzo71O8NsMxs50z3/mLjbPcmKvN8aP5NlrDFuywtt3Yb90HcRjHcBK/4pzXLuKyY6/hD+feMsYdY/1lzIfG/tuanprrhTlfmztkHeFR3GoEtxrGrYZo2AeLwIHcqj+36set+nCrnhr27iKwqwjsLAI7cqv2IrANt2rJrZpr2Jtyq0bcqr4IrKthryUCq4vAKiKwkoa9gggsq2EvpWEvLgKLaNgLcav8Gva8iprL4rNbcBYbkckC09ugND77UrH25Gw+iT4ioQiMJwKDf1aJIQI/7UQMHbhWG67VUq/V1B1i4/+CO8Q5odHvmP8DREbwD97REBNxEB+JkDS4U8VnSIeMyIxsyIngEyMfxy2EL1AMJVEG5V1bJVRBNdREHcKsj4ZoguYK2BJt0N4+dERnReyK7uilmH3sTT8MUNBB+EZRhyrqcPs1EqMVdizG2btJ/pzque+9PtexC5231BgrjfWDsdebZ5N5t1nLTuy1zgM4hKM4jtM4iwu45Jir+N05N5172xj3jHXfmI+M/cQcz831ypz/mDv8LVGN1bCP5lYjReBwETiUW33DrQZp2Ptr2PuJwD4isCe36s6tunKrztyqI7dqp2FvIwJbatiba9ibiMCGIrC+CKwjAmuKwGoisIoIrCQCy4vAMiKwpAgspmH/QgQWtPB8FpvbInNYXFYLy0z1GVlqWnYafK0ohQhMyq0SicD4IjCOCIwpAqOJwE/aEkWrcPj95uHwO03EYYO+b1Xzn3jMDyWKtCD05D3r+BAf41NCj47YiIfgn5aSIPiibSqkQXoEd7BZEPSGuZAXBVAYRVECpVHO9VXEl6iKGqhNqPXQAE3QDC0Jsw3aoaP96Iyu6K6YvdBHQfthgH0ahG8UdqjCjrBnozBGcb9V3PHENsEeTsY0f5/l+XmOW+T4Zc5bbYy1xt2ALebaYe7d2G9dB3HEmo/hJH7FOc/9hiuOuYY/nHPLuXfwl7EeGvNvYz8zxwtzvTZnyNzhCSJwvIb9W241mluN4lYjNOxDReA3InAQt+rPrfpxqz7cqie36q5h78qtOonADiKwnQhsw61aiMBmIrAxt2ogAuuJwNoisIYIrCoCK4vACiKwrAgsLQKDzS9qoYUtsICF5bUpuSg+O2vPwkqDrw2lF4FpRGAqDXtybpVEBCYQgXFFYCwRGL0dMbQmihbE0ZRrNeJa9W6EIzSM9lY9/38ei0NV3iHw9/ERoiAqYiIO4iMRkiL4p6bUHDYtMiAzsiEn8iA/CiFw4eKurRTKoAIqoQqqoxbx1kUDNEZTtCDQ1miHDvakE7qiO3opah/0U9QBGGy/hmCYwo4guFEYY//GKfAETLSPkzGF2Gb4c7aiL/D6EsetcM4aY6wz3iZjbzPfTuy1hgM4ZH1HcQKncRYXcMlrV/G7Y2867zbuGeOBsR4b84mxn5vjlbnemDM8hVtNFoETudV4bjWOW40RgaNE4AhuNYxbDeFWg7nVAA17Pw17HxHYU8PenVt1EYFficAO3Kott2rNrVpwq6YisDG3asCt6nKrWiKwOreqIgIricDyNr+MRZaysGIW9YUFFaL24G4qN7fKIQKzisDMIjCDCEwrAlNr2FOIwKQiMJEIjC8C44jAGCIwakuiaEYcjYmkAdeqw7Vq/KffeyvistCedwn9A0TGp4jOTWMhLhIgMZIjFdIgPTIhC7IjF/KigOsqjKIogdIoh4r4EtV8MtVEHdRHIzRBc4JthbZoj072pgu6o5ei9kE/DFDYwRhi34ZhpOKOxlgFHmcfJ2ASwX2n0FPt6XSFnom5Pl7o+aVeX+X4tc7dYJwtxtxujt3m3I+D1nIEx3ASZ3Aev+EKrjvmBv50zl3n3jfGQ2P9bcxnxn5pjn/MFTJneDq3msqtvtOwT9KwTxCB47jVWG41mluN1LAP07APEYGDRWB/EdiPW/XhVj25VTdu1YVbfaVhb8+t2nKrVhr25tyqCbdqxK3qc6s63Komt6qmAF9aXEWLCiKitE0o4bOsqM+uwtyqAFHlFYG5RGDwFewsIjCTCExPVGk07ClFYDIRmFgEJhCBcUVgLBEYTQR+0oQ4iOqDupr4Wpr46ivfyuc/8lgaShhpVeif96zrQ3yMqIiB4DtY4yEhkiIFUiMtMojy4J+gsiIH8iA/CiG40y2OUiiLCqjsk6kqaqA26qEhGqMZIbdEG7THV/anM7qhJ3oTZD8MwCDFHYJhGGkPRyvwWIxX5ImYbE+nKPQ0hZ6B7xV7NuZhsb8v99pqx/3onI3O32qcncbdY54D5j6Eo9Z0AqdxFhdwCde89gduOva2c+4594ExHhvrqTFfGPuVOd6YKzyLW33PrWaIwGkicAq3msytJnKr8Rr2sSJwtAgcKQKHcash3GoQt+rPrfpp2Htzqx7cqpsI7Kxh76hhby8C23Crlhr2Zhr2xhr2htyqroY92NQaFhVEQmWLqEDhZam7FOssLpe/4FaFRGB+EZhbBOYQgVlFYPCPuhmIKviWlNQiMLkITEJUCUVgPBEYWwTGEIHBT8x8XI9IaovDGuKwyutQhNIfvFXR/8NjbajOO9b2Pj7CJ8QfDTERB/GRGMkQfK/YZ0iHTMiC7Aj+SSovCqAwinLlEiiNcqiIL1ENNVEH9e1FIzRFC7RGO3Qk2s7oih7oTZR90R+D7N03GIaRCjwaYxV5PCba08mYqtjTFXsmZin4HPs8l9gWKPoSH6/w3BrHrHfsZudtN9Zu7DP+QfMdtoZjOIkzOI/fcAXXccMxfzr2rnPum/+RMZ4Y65kxXxr7H3OEzRWeq2GfIwK/51YzudV0bjVFwz5ZBE4UgeO51VhuNZpbjeRWw7jVNxr2QSKwv4a9r4a9twjsIQK7isBOIrCDhr2dCGwtAluIwKYa9kbBZlpQHQup6aKrmfxLyq7INsuJwNIisIRmr6g7mcIisIAIzCsCg3/EzSYCg29BySgC04nAz0RgSn1VMhEYfI95fBEYRwTGFIHR6ovDOkRSk1iqisPK4XCE8pXfquj//oi4PrT0XcL/AB/jU0RHLAQ/1JEQSZAcqZAGGZCZA2dFDuRGPhREEQRf/C2FsqiAyqiKGvahNuqhIZqgOVqhLToQdid0QXf0Ql9C7Y+B+MYeDsUIjFbksRiPiYo9GVPt73QFn4nZij7XXs/DAoVfZM+XKv4qH6/12gbHbHHODufvMd4B4x/CUXOewGnrOYuLuIxrnvsDtxxzx/F/4aFz/zbnU2O9MOZrY4fMEV7ErRaIwHncai63mq1hnykCp4vAqdxqMreayK3Gc6uxGvbRGvYRInCoCPxGBA4UgV+LwL4isJcI7C4Cu4jAr0RgBxHYVgS2sqHNLaaJi2ho8nomru0zKLgrqioCK4vACiKwrAgsJQKLicAvRGBBEZhPBOYWgTlEYFZ3gZlFYHoRmEYEpiKq5CIwiQhMIALjElUsERhdBH5aSxxWI5YvxWFFcVj2P/4TPZE46nsIfpw/CqIiBmIjPhIhKYLvx0+NdMiIz5ENwbf95EEBFEZRlEDp4Ot1qIgvUQ01URcN0BjN0AJtfPK1R0d0Rjf0RB8C/hoDMRhD7eUIjMJYjFfwiZis4FMx3T7PxGxFn4v5Cr/Ivi9W/KWKv9z+r/bnj57b5LVtjt3lvH3G+Ml4h81xDCfNfQbn8Ruu4Hfc9Npt3HPsfec8cu4TYzw31itjvjF2eDlRLeVWi7nVQg37fBE4l1vN4lYzudV0bjVVwz5Zwz5RBI7nVmNF4CgROIJbDRWBg0XgQG7Vj1v1EYE9RWA3EdhZBHa0ue0sorXJA6tvZtJGFF2fVdYRgTVFYDUR+KUIDL4SXW6CYnCrEiKwqAgsLALzi8A8/RVPBGYTgZ+LwIxElVYEphaBwU/CJCWq4Of44onA2CIwhgiMWp37VCGWSkRTThyWevFWRv+Xx7ZQy3c46/v4CFEQDTERBwmQGMmQEp8hPTK5vuA7X7MjN/KhIL5A8A/sJVEGFVAZVVEDtVEPDX3SBb1nc7QKPgERfCJ2Qlf04PS90Q8DMAhD7OdwjMIYjCPIiZis4FMxHd/b7zmYp/ALFH4Rltj/ZYq/AqvU4Qes9/Fmr2133G7H73fuz8Y6atwT5jqNs7hoLZdxzcd/4BbuOOYvxz50zt/OfWaMl+Z4bcyQscOrNOwruNUyEbiEWy3kVgu41TxuNVvDPlMETheBU0TgZG41kVuNE4FjuNUobjWcWw3hVoO4VX9u1VcE9uZWPWx8VwvoZOIOFt/WZ04rnzHNWXITdtyQWwVfu6ktAmuIwKoisJIILE9UZURgSREYfGvJFyKwoL4qrwjMJQKzi8As+qpMIjB9e0UWgSlFYDJ9VeJG3EUExhGBMWsQhwiMIgI/Kk80ZcRhSXeHxRu/VdP//oi4Mzz8XbH9AYJ3uPkU0RELcZEQSZAcwY+opUEGZEZW5EAe5EfwPWZFUBylUc4nWEV8iWqoiTqoj8ZohpYIetH2+ApdOH139EJf9MdAfGNPh2EkxmAcJhDoZEzFdMWfiTn2fR4WYDEBLCWA5VihFquJ4AciWKsmG/y51XM7vbbXcT85/rDzfzHWSWOfwXnzXsJV/I6bnruNe4554NjHznni3OfGeGWsN8YMr+VWP2jYV3OrFdxqObdaqmFfpGFfIALnicDZ3Gomt5rOraZq2CdzqwncapyGfTS3GsmthmnYv9GwD+RWX3OrPhbQ06TdTdbFRF9RcTsW2ZoFtxSBTblVI25VXwTWEYE1RWA1ERj8Y2xFEVhWBJYSgcWJqoi+qpAIzCcC84jAHPqqrJ0UVQRmEIFpiCqVviq5CEwiAhMQVVx9VSwRGJ2oPqlALGWJppQ4LEZYRfq9ldP//oi4J/wweJO3D/ExPkUMxPZJEg+JkBQpkBrpkBGfIxtyIi8KoDCKogTKoDwqoQqqozbqIfiicRM0t1+t0BYd0Ald0QN90A8DfKIOxlCMwGh8iwmEOwlTMB0ziXI25mGBGizGUiJYTgSrsEZNfiCEH7GeGDapzzZ/7vL8PscddPwR5x7HaeOdNcdFXMY13MCfuOu1+455iL+d88zYL43xj7FCxgyv51Y/cqsfuNUaDftKEbhcBC4VgYu41QJuNY9bzeJWM0XgdA37FG41SQSO17B/q2EfLQJHiMChGvbBNmqASftZZGDhPXx2dGWPnVhjBxHYVgS2csfQnKiaiMDgny/qisBaRFXdXWAVd4GVRGB5EVhGBJbQVxUVgYVFYAERmFdflVMEZhOBnxNVBn1VWhGYWgSmEIFJ9FUJ9VXxRGBsfVWMikRSjliI6sPihFVEn1XwzFs5vX0cCBePxGnfw0eIgqiIgTiIj0RIhpT4DOmRCVmQHbmRDwXxBYqhFMrakwqojKqoiTqoj0ZoipZog/b4Cl3QHb18kvZFfwzCEAzHKIwl+vGYiO8wDTPt/WzMxQJiXIylRLAcK7FGXdYSwjpsIIZNarSFILb7c4+/H/D8Icf94ryTxjhjzPP4zXxX8Ttu4rbn7nn9AR479qlzXjj3tTHeGC+8hVtt4lYbNOzrROBabrWGW63kVsu51VJutUjDvkDDPlcEzhKBMzTs00TgdyJwoggcLwLHisBRNnG4CYeYZJAJ+lNvX7bYi912F4FdRGBHEdhOBLYWgS1EYFMR2EgE1heBdYiqpgisKgIri8AKIrCsvqqkCCwmAr8gquAnWvKJwFwiMLu+Kou+KlML7iECPyOqlPqqZPqqREQVX18VR18VQwRGLU0sJYimKPEUDocj5eda+TO8VZXHT6ES77iG9xG8ReUniIZYCN6vKwESIzlSIQ3SIzOCH7jNgdzIj0IoguD7+ksj+I7ZivgS1VELdRH8w3xjNEcrn5TBF5M7oBO6Iriz7o2gZx2AwRiGkRgjGb7FBEzGVMzALDWYi/lYRJhLsRwriWEN1qrPOmwkiM0EsRXb1Wsnwe3150+eP+L144495byzxrlo3Mu4jhv4E3dx32uPHPPEsc+d89K5/xgjbKzwdg37VhG4WQRu5FbruNVabrWGW63UsC8XgUtF4EIROF8EzhGBs7jVDBE4VQROFoETRGBwkaNNMMJCh1LuYKodwA77icDeIjD4GkxXEdhJBHYQgW3dBbYSgc1EYGMRGHyLSF0RWEsEVhOBXxJVRREYfA94KRFYXAQW0VcVEoH5RWBufVUOfVVWEZiZqNLrq9Loq1KJwGT6qsT6qgQiMA5RxdRXRStJLET1EVG9X0CflZewcv7vwop4JLTtXdfyAYI31v0UwVtWxkI8JETw/l3JkRppkcEn1OfIhpzIgwIojKIogTIoj0qoihoIvjetHhqiCVqgNYJ/AuuIzuiOXuiL/hgkEYZgOEZhLMZjEqZguhp8jzmYh0VYQrDLsQpriHEt1qnTRmwmiq3YQRi71G03YezDz/5+1PMnHPOr48879zdjXcXv5rmJOz7+Cw+99rdjnjr2hXNeOzdkjPBuEbhLBO7gVlu51WYN+0YN+zoN+1oRuEYEruRWy7nVEhG4UATO41ZzROD3InC6CAwuapLBxxt0LMWOotbhbHWICBwkAvuLwL4isJcI7CYCO4vAjiIw+EfV1iKwBVE1cRfY0F1gPRFYWwRWF4FVhiiGCCwvAssQVQl9VVERGPxQZwF9VR4RmFMEZtNXZdZXZdBXpSWq4D2nkuurkojAhPqquPqqWCIwejHC+oJoiOqDvOIwlzjMvuCtrAjreOjwuz5RPsTH+BQxEBvxkAhJkQKpkQ4Z8TmC96DIhbwogC9QDCVRFhVQGVVRE3VQH8H3qjXj+C3RBu3xFbqiB3qjHwZgMIZiJMZgHIK0+E4NpmEmZmMuFmAx4S/DCqzBWuJch43qtQXbCGMHdhHHHvXbRxwHcMjHxzx3yjFnHX/BuZdx3Zg38Cfu4r7nHnn9CZ479pVz3jg3fEAE7uNWe7jVLm61QwRuE4FbuNVGbrWOW63lVqu51QputYxbLeZWCzTsc7nVLJsyw6BTDTiZWidQ6jg2OEYEjhCBQ0XgYBE4QAT2E4G9RWAPouoy3+aJwPYisI0IbElUwTeyNRKB9UVgHaKqqa+qKgIrE1UFfVVZEVhSBBbTV32hryogAvOKwFz6qmz6qs9FYEZ9VTp9VWoRmIKokuqrgvf5jEdUsfVV0YsQS0GiyUc8uQkrO2Fl+fE/qOpkKG6kk6G/3nNdHyIKgrcFj4E4iI9ESIaU+AzpkQlZkB25kQ/B2wcUQXGUQjlUxJeohlqoiwZojOZohbbogM7ohp7og68xCEOCO28Ed+BjMR6TMAXT8T3mYD4W+aRfihVYjR+wTr02YjO2EeRO7CaQvdhPJD+p5c8EcgTHfXza8+cc85vjrzr/d9zCHfyFh/jba88c89Kxr50Tcm74Z271E7far2HfKwJ3i8Cd3Gobt9rMrTZyq3Ua9h807Ku51QputVQELuJW8w06x2CB9U6n8imsdJIIHC8Cx4rAUSJwuAj8RgQOFIFfi8A+IrCnvqqrCAy+9aMDUbXVV7USgc1EYGOiaqCvqisCaxJVNX3Vl/qqir0Ji6hK6auCHz3/QgQGb5yRT1+VWwRmJ6os+qpM+qp0RPWZviqlviopUSXSV8XXV8UmqhiFiCU/YRHVhzn0WVkJK9ONUIRUH0SIcCqUMpJPmPcQ/GaMKIiGmIiDBAjegDcZUiEN0iMzsiIHgnfQyY9CKIISKI3gB3UrIfgRuOoIfrikHhqiCYLvtG2NduiILuiOXuiL4J/KBmMoRuhrR+NbTAx6XAS97kzMxjwsxBIsxyq1+gE/YgM2E+hW7MBuAtyLA2p5EIeI5AiR/KKuJ/x5xnMXvH7ZsdecewN/4i4e4DGeeu25Y1459o1zwr9wqyMa9kMi8KAIPMCt9nKr3Rr2HRr2rRr2zSJwgwj8UcO+RsO+SgQGi11ioIUGmUehs1nfTBE4TQROFoETROC3InC0CBwhAoeKwMEisD9R9dVX9RKB3UVgF31VRxHYzl1gaxHYXF/VRF/VcLhNF4G19FXV9VVVRGBFfVXwo+alRWAJoiqiryqkr8pPVLn1VTn0VVmJKpO+Kr2+Kg1RpdRXJdNXJSaq+PqqOPqqmEQVNQ/R5CSerESUWQOfXp+V+eMIEX4LpX6HG7+Pj/AJoiEW4iIBkiA5UiF479QMyIxsyIk8KIDCKIoSKIPyqISqqIHaqI9GaIqWaIP2+Apd0AO90Q8D8A2GYSTGYDwmYQqm43sEve98NVqEpViB1ViL9diErYxhB3ZhLw4Q60EcUtejOEYsx4nllBqf9fFFz13x+u+OveX8O/gLD/G355557aVj/nFsyDnh4yLwGLc6wq0OcauD3Gq/CNwrAneJwB0icKsI3CQC14vAtRa92iArTLqUshexzvncao4I/F4ETheBU0TgJKIaLwLHiMCRIjD4x9Fv9FUDRGA/EdhbBPbQV3WZZhNFYHuiaqOvaqGvaioCGxFVfX1VbRFYg6iq6qsq6avKE1UZfVUJfVVRoiqsr8qvr8pDVDn1VVn1VZmJKoNmPXj34VRElVyznlhflYCo4uqrYuqrgt9d80k24vmciDJo4NMSVqpPI0S4GBr/Dlf+AJHxCaIjFuIiIZIgOVIjLTLic2RDLgRvKlcAX6AYSqIMKqAyqqIm6qA+GqMZWqItOqATuqEn+uBrDLL/wT/0D8cojMUETEbw9cQZmIV5WIglWI5V+AHrsJExbMF27MIe7MdBKXQIR9X3GE4QzCmC+VWtz/nzkr9f8/oN/On4e3iAx3jquRd47Zg3jg3/yq1OcasT3OoYtzqiYT/ErQ6KwP0icA+32iUCt4vALS5so5PXOTGw1FUsbzmrXCJLF4rAuSJwlgicIQKn6qsmbyIsEThWBI4SgcP1VUMWi0MR+LUI7KOv6iECu4rATvqqDvqqNiKwJVE101c1FoH1RWAdfVVNfVVVERi8IUYFfVUZfVVJzXoxfVVhfVUBzXrwdorB+3Vm06x/rq/KQFRpNeup9VXJiSqJZj2BviouUcXKRSzZiYaoImckrLSElZqwUo6PEPFKaPy7rvcDRManiI7g9/zEQ0IkRQqkRjpkxOfIjlzIh4L4AsH7gZVC8E47FfElqiF424G6CH6gtzGCH5VrhbboiM7ohl7oi/4YjKEYgeAf/sdhIr7DNMzEHMzHIkawFEFPvBo/YgMCg9iGndiNfVLoJxzCURxT5xM4TYRncI5wLqr7ZR9f9/xNx9zBX859hCc+fo6XXvvHMWHHhs9xqzMa9lMa9hPc6hi3OsKtDnGrn7jVPhG4m1vtMMBWEwQWup7drWV1q0XgChG4VAQGXyOZLwJni8CZInAaUX0nAieKwG+JKvgWjhEicKgIHERU/fVVfUVgT6Lqpq/qrK/qSFRt9VWt9FXNiaoxUQU/Ql5XXxW8AUY1fdWXRFWBqMrqq0oRVTGi+kJfVZCo8mrWc+mrshPV55r1jPqq4A34U2vWU+irkhBVQs16PKKKRVTRsxANUUVOR0SfEVYKfVZSwrpOWD6ZPsDH+BQxEBvxkAhJEfxGjc+QDhmRBdmRG/lQEEVQHKVQDhURvPNOddRCPTREEzRHawQ/OvcVuqA7eqEfBmAwgu99G4kxGIdJmILgn9hmYS4WYDGWYRV+QNAjb8QWbMcudd2LA/gZR3AMJ7Q8p3EW5wn0otpfIpyr/vzD3//0/D3HPcBjPMULz732Wsgx4Usa9osi8LwIPMOtTnGrExr2Y9zqCLf6WcN+wAL2OmEXJW5nj1vY4kYRGNxV/CACV7oLXCYCF4vABSJwDlF9LwKDf/ScQlST9FXjROAYEThSBA7VVwXfNjtABPbTV/XSV3UXgV30VR31Ve30Va2/scn6qiZE1ZCo6uqrahFVdc36l/qqikRVVrNeSl9VnKiKaNYL6qvyEVUuzXp2fVUWosqoWU9HVKmJKoVmPam+KqFmPZ5mPTZRRc9ENOmJh6g+SOnOMClhJSKsbceOvcupP8THiIoYiI34SIRkSInPEPyGjUzIghzIjXwohCII3iKzNMqhEqqgOmqjHhqiKVqgNdrjK3RBD/RGPwzENxiGUQi+F248gu8ymYoZ6jUr+FcRLMQSrMBqrMV6bMI27MAe7MdBHMYvWp7jOIUzOM9ULuIyDVzBNQK64c87nvvL64+c8wTPffzKc2+8Fr4mAq9wq8vc6iK3Oq9hPyMCT2nYj2vYj1roIQcfpMT91LqbvQWN3lYRuEkErheBa/VVq0TgchG4RAQu1FfNE4Gz3AXO0FdN1VdNWuniRWDwXYwj9VXD9FXfENVAfVU/fVVvouqhr+pCVF8RVTt9VWuiaqFZb6qvaqivqqdZr6Wvqk5UVTTrFfVV5YiqtGa9uL6qCFEV0qznI6rcRJVds56FqIJfE5JOs/4ZUaUkqqSa9UREFU+zHpuoYhDVp2mIh6g+TEZYicPHIsY6FiGi638PHyIKoiIG4iA+EiMZUiIN0iMTsiIHciM/CqEoSqA0yqMSqqAGaqMeGqEpWiJ4e4L26ISu6IE++BoDMQTDMQrfYgImYxpmYjbmYxGWYgXW4EdswGZsxy7sZR4HAgNBYCTHcBK/4hwuSqzLuIrr9HCDiG7hro8feP1vPMNL/OO5kNfCf3Cr69zqKre6LAIvisBzIvBXEXjSQMeoMLDGn1nbARG4VwTuEoHbROBmotqgr/pRBK4RgStE4FJ91aKthCUCZ+urgu/7mSoCJxPVBH3VWH3VKKIarq8aQlQDieprfVVvouqhWe+qr+pEVO0168EbW7QgqqZE1UizXo+oamvWaxBVFaKqpFkvp1kvTVQlNOtFiKqQZj14Y/3cRJVDs56VqDIRVXrN+mdElZKokmnWExFVfHeAsYkqBlFFTUVYRPVhYmJKEA5HjBOOEMkn13v4EFEQFcGvF46D+EiMZEiFNEiP4PcDZUUO5EF+FEbwNuQlELzBb3lUQlXUQB0E7yPWCME79LREG3RAJ3RDT/TB1xiEIRiB0fgWwXfyfodp+B5zMB+LsQzBP8X9gHXYiC3YgeCOfx9+wmH8ghM4jbO4ILUu4Qqu4wZu0cZtgvzLn4/8/Qme4xXeeC58m1vd0rDf0LBfF4FXROAlERgMdpb6TlPeCbZ2lKgOach+EoH7ROBuEbhDBG7RV20UgetE4BqiWqmvWiYCFxHVfH3VHBE4k6im6au+01dNIKpv9VWj9VXDNetD9FWDiOprzXoffVXwo+BdNeud9FUdiKqNZr2lZr0pUTXSrAfvVFfbHWANzXpVoqpEVOU166WJqoRmvahmvRBR5des5yGqHO4As2rWMxFVeneAaYgqJVElcweYmKjiuwOMQ1QxiCpqcuJJQkRE9V7ccDhSTMLySfYePkIURENMxEECJEbwizxTIQ3SIzOyIifyID8KoyhKogzKozKqIngrzTqoj8ZohpYI3rGnAzqhG3qiL/pjEIIfuRuBMRiHiZiC4Dt7v8ccLMBiLMcqKfQD1mMTtmIH9mA/DuIIjuEkfsU5/IYruIYbuEUft3GP+dzHYx8/8/xL/OPjsOfCd0XgbW51i1v9IQKvWcAVL1ykxnMs7VcReFIEBncHh0XgQRG4XwTuIaod+qqtInATUQX/ePmDvmoVUS3TVy0mqgVENUdf9b2+ajpRfadZn0hU44hqtGZ9BFEN0awP0qz3J6q+mvWemvVuRNVJs95BXxW8t1NLzXozomqkWa+vWa9DVDU061WJqhJRldeslyGqkkRVVLNemKjyuwPMQ1Q5iSqrO8DMRJXeHWAaokpFVMncASYmqvjuAOMEvyGeqKISVRSi+oio3otFWNEIi4O/h48QBdEQ/Mb9uEiAxEiOVEiLDMiMrMiJPCiAwiiKkiiDCqiMaqiJOmiAxmiGVmiLDuiMbgjeG6Mv+mMwhmIkxmAcgh9umYLpmIW5WIAlWI7VWIv12Ixt2Ingi+AH8DOO4jhO4Qwu4BKu4nf6uInbuIf7eMiInuCFj18j5OPwQ251n1vd41a3udVNT/5OcVdZ2SUReD5o3IjqlL7quAg8IgJ/JqrgK7J7ROBOotqmr9qkr1pPVGv1Vav0Vcs160v0VQv0VXOJapZmfTpRTdGsT9SsBz/PNkazPkKzPpSoBmnW+xNVX6LqqVnvRlSdiaqDZr0tUbXSrDcjqsZEVZ+o6hBVTXeAVYmqMlGVdwdYhqhKElXwu2QKE1UBd4B5iConUWV1B5iZqDK4A0xDVKmIKpk7wMRElYCo4hBVTKKKmpB4iOojonovOmF9Qlg+4d7HR4iCaIiJuEiA4JelJ0cqpEUGZEY25ETw284KoDCKoSTKoAIqoxpqoi4aoDGaoRXaoiM6oxt6oS8GYDCGYiTGYDwmYQpmYBbmYiGWYAVWYy02YDO2YRf24iccwlGcwGmcxQVcxjX8gcCA7uI+HuJvPflTvPTxPwg/Jaq/udVDDft9L9yhtlus7A8ReE0EXhaBF/RVZ0Vg8DWM40QVfAX2kL7qAFHt1Vft0ldtI6rgWyw26KvWEtVqzfpyolpCVAs163OJKvgJkOlENYWoJmnWxxHVGKIaQVRDiWqwZn2AZr0vUfXSrHcjqs5E1ZGo2hJVK3eAzYiqsTvA+u4A6xBVTXeAVYmqMlGVdwdYhqhKVlQ8d4CFiaqAO8Dg9/flJKpsRJWZqDJkJyyiSkVUyYgqMVElSEFYRBWTqKLGIx6i+oio3v+EsCITFjd/Hx/hE0RDTMRFAgS/iT85UiEtgl9LnBnBL/zMibwogMIohuD3CpVFBVRGNdREXTRA8MbAzdEKbdERndEdvdAXAzAYwzASYxD8APEkBD+aNwOzMA8LsQTBdwCvRvC9dRuwGdsRfKPBPgT/hHcIv+AETuMcgq8UXEbQg99AkG738ACP8RQv8BohhF9o2IMnH1PZAzZ3l6j+1KjdEIFB1x/cVl68anCiOh185VVfdZSoDh2zCH3VXqLapVnfRlSbiWqDZv1HolqtWQ++Z3oJUS3UrM8jqlnuAGcQ1RSimqRZH0dUY9wBjtSsDyWqwUQ1gKj6ElUvd4DdiapzD5tKVG2JqpU7wGZEFbyldAOiqkNUNesRFlFVJqoK7gDLElXwG6+KEVVhoipQRFGJKmc+RSaqzESVIQthEVWqdMRAVImJKkFSwiKqmEQVLTbxENVHnxJTZML6gLB8Ar6Pj/AJoiEm4iIBkiA5UiMtMiAzsiEngl8AWgCFUQwlURYV8CWC3+BRE3XRAE3QHMEbBbdF8BacndEdvdAXAxC8088wjMRYjMckTMUMBD+qNw8LsQQrsBo/YgOC77Xbjl3Yh59wGME/6Z3AaZzDRVzBddxE0JPfQ5B2f+M5XuENPYXf+OClCHwmAv8mqof6qqARC7r8G0R1XV91JfhimL7qHFGdJqoTmvVfiOoQUf1EVHuJapdmfTtRBd9luEGz/iNRrSaqFUS1hKgWEtU8oprlDnAGUU0hqklENZ6oxhDVSKIaSlSD3QEOIKq+RNWLqLoTVeeuNpWognf5Dd5CujlRNW5q84mqDlHVrE1YRFWZqCoQVVmiKlla8YiqMFEVIKrgV9jmzK3IRJWZqDIQVRqiSvUZMRBVYqJKQFRxiComUUUjqk+I6qOPiekDwnqXsMJvwu/jI3yCaIiJuEiAJEiO1EiLDMiMbMiJvCiAwiiGkiiLCvgS1VATddEATdAcrdAWHdEZ3dELfTEAgzEMIzEW4zEJUzEDszAPC7EEK7AaP2IDtmA7dmEffsJh/IITOI1zuIgruI6buI17eIi/8RyvEPwXDonA1yLwRZCPIvARt7ovAu+IwFv6qj9EYPCV1Uv6qgsi8Iy+6pS+6rgIPKKv+llftV+zvkdftUNftVUEbtJXrROBwU92rNJXLdOsL9ZXzReBczTr3+urpmnWv9OsTxCB32rWR+urhrsDHKJZD95Z7mt3gH006z1EYFfNeid9VXt3gG30VcEb3zfVrDfUV9VzB1hbs169ajhcxR1gJX1VOX1Vac16cX1VEXeABTXr+URgbs16Dn1VFneAmTTr6dwBfuYOMKW+KmnicDiRZj1enHA4dsxwOHq0cPhTEfjxR+HwB++Hw+9GCoT1irBeEdYrwnpFWK8I6xVhvSKsV4T1irBehVMhLTIgM7IhJ/KiAAqjGEqiLCqgMqqhJuqiARqjOVqhLTqiM7qjF/piAAZjGEZiDMZjEqZiBmZhHhZiCVZgNX7EBmzGduzCPvyEQ/gFJ3Aa53ARl3EdN3Ab9/AAj/EUL8Ivw68RQvgNt3qlYX8edPUa9kca9r807HcI6xZh/R582Z6wgn9sPE9YwbdKnHQXeIywjhDWQcLaT1i73QXucBcY/CTHRsJaR1g/ENZKwlpGWMGPas8nrDmENZOwphHW5HHERVjfEtYowhpOWEMIayBhfU1YvQmrB2F1Iazgje7bE1abZsRFWE0JqyFhBb/JqhZhBb+HrwphVSSscoRVirCKE1bwi7YLElY+wspFWNkJKwthZSSsdIT1GWGlIKykhJWQsOIRVuyoxBWFuAgrMmF98C/Cek5YzwnreTgKoiEm4iIBEiM5UiEtMiAzsiEn8qAACqMYSqIMKqAyqqEm6qABGqMZWqEtOqIzuqEX+mIABmMoRmIMxmMSpmAGZmEuFmIJVmA11mIDNmMbdmEvfsIhHMUJnMZZXMBlXAs/C/+BW7iL+3iIv/HUfy/9+Q9YlS6eWwVfe3gmBv8Wgw/F4D0xeNudYPCPi79fEIlnw+HfCOv88XD4V8I6+TNxHZDHhHWQsIKf3NhNWDvWi8S1xEVY65aH/+VHs1cS1tK54fAiwpo/PRyeTVgzCWsaYQXvHDdhhP6AsEYR1vD+4fA3hBW8NXS/bsRFWD0IqwthfUVY7QmrNWG1qK8PIayGhFWPsGoRVvXy+pUyxEVY5QirFGEVJ6wv8hAXYeUjrFyElZ2wshBWRsJKl0xfRFgpCCspYSUkrHiEFYuwohPWp4QV+V+E9Xf4PXyEKIiGmIiDBEiM5EiFtMiAzMiKnMiDAiiMoiiJMqiAyqiKmqiDBmiMZmiFtuiAzuiGXuiL/hiMoRiJMRiHSZiC6ZiFuViAJViO1ViL9diMbdiJPTiAn3EEx3EKZ3ABl3AVv+MmbuMu7vOsh3iC5/7+Gm98HA4R1WuiesGtnorBx+4EH2ja7wb/uKi/uqG/uq6/Cr6h6yJhndNf/UpYJwjrF/3V4Z36LcLap7/aRVjbCSv4UewNhPXjYuJaoN8irKWEFbzX0jzCCt4pbgZhTSWsyYQ1nrDGDiIuwhpGWN/01G8RVj/C6t1Bv0VYXQgr+E1V7QirNWE1J6wmNYiLsOoSVi3CqkZYXxJWxaL6LcIqRVjFCesLwiqYlbgIKxdhZSeszwkrI2GlJazUhJWCsJIQVkLCikdYsQgr+nv6rX8R1iPCekRYjwjrEWE9IqxHhPWIsB4R1iPCekRYj8JpkB6ZkRU5kQf5URhFURJlUB6VURU1UQf10RjN0BJt0QGd0A090Rf9MQhDMQJjMA4TMQXT8T3mYAEWYzlWkcEPWI9N2Iod2IP9OIgjOIaT+BXn8Buu4Br+EIK3cBv3SCv477GPA/96iX98rLHiWkT1iqiec6u/udUjbnWfW90Rg8E3cP3xazh8zd3gJY37hcPh8FmN+2mN+3HCOqpxP6Rx/4mw9mrcd2nctxNW8AYSGwhrLWGt1riv+F4zT1gLvyMuwppFWDNGa+YJa5LGfTxhjSGs4A3shxHWYMIa0Im4CKsXYXVvqZknrI6NiIuwWhFWc8JqQlgNKhEXYdUkrODX/39JWBUIq2x+4iKsYoT1BWEVIKy86YmLsLIR1ueElYGw0sYnLsJKHoO4CCshYcUlrFiEFe1fhPUXYf0V/hBREBUxEQfxkRjJkAppkB6ZkRU5kAf5URhFUQJlUB6VUBU1UAf10QjN0BJt0AGd0BU90QdfYxCGYARG41tMxHeYhu8xB/OxGMuwEmuwDhuxBTuwG/vwEw7jF5zAaZwlnwu4hCu4zqtu4Fb4DnHd8cwdcrrLte5xraD7usu1xF+IqF4T1QuiCr7l4bGm/QG3uicGb4vBm2Lwd251VQxe0l+d11+d2aeZ301chHVE4x78yPUBwgreMGKnO8JthLXJHeF6d4RrCSt4R7jl7giXENYCd4Rz3RHOIqzp7ginEFbwhvXj3BGO6RMOjyCsoe4IBxNW8Bup+rYhLsLq5o6wM2F1JKy27ghbEVYzwmpMWA0Iq447wpqEVY2wKhciLsIqS1glcxAXYRXORFyElZewcqYkLsLKTFgZCCstYaUirOSElYSwEnxIXIQVi7Ai2qT38CGiICpiIA7iIxGSISXSID0yIStyIDfyoxCKogRKozwqoQpqoDbqoRGaoiXaoD06oSt6oA++xkAMwXCMwreYgMmYhpmYjXlYhKVYgTX4ERuwGduxC3vJ5AB+xhEcw0n8inO4GP5Tr/WnSLxFXLc4103/v/kvEnvg+ceOeYaXPv7HcyGvhd8Q1Suiei4CnxDVI251n1vd5VZ/cqsb3Oq6GLwiBi+KweCHFH8Vg8GPWB/TXx3RuB/UuO/XX+3RuO9YqpknrOAd4NbN1swT1qqpmvnJmnnCCt7iee4od4qENZ2wpgwMhycS1rje7hR7EBdhDf0qHB7UPhzuT1h9WoTDPQmrG2F1qhf+l1+Q3bZ6ONyyCnERVuNy4XB9wqpDWDWLhMNVCasyYZXPHQ6XIayShFWUsAoTVoHPwuE8hJWTsLImIi7CyhA7HE5DWKkIK/nH4XBiwkpAWHEiElbo5rF3bdSH+BhREQOxER+JkAwp8RnSIROyIAdyIx8KoQhKoDTKoRKqoDpqox4aoilaoDXa4yt0QQ/0Rj8MxDcYhlEYi/GYjKmYobCzMA8LsQTLsRprsR6bsBU7sAf7cRCH8QtfOo5TOIPzpHQRl3VaV3CNvG7487bn/vLRIzzBc7zy3BuvhUPi7x9OFXzX3zOi+ltv9VBv9Zfe6g63usWt/uBW18TgZTF4gVud5VanxeAJMfiL/uqQ/uonMbhPf7Vb475d476FsDbqr9a5I1xDWCs17svG67cIa747wjnDNPPfaOYJ67t+mnnC+pawRnfRzBPWkHbE1dqdImH1IayeDcPhroTVqRZxEVYbwmpZ0Z0iYTUirPrFw+HahFWDsKrkC4crEVb57MSVJRwuQVhF04XDhQgrP2HlSRoO5yCsrPGIi7DSE1aaT8PhlISVjLASvxsOxY94jLCuj3/XJn2Aj/EpYiA24iERkiIFPkM6ZEQWZEdu5ENBFEFxlEI5VMSXqI5aqIuGaILmaI12+Apd0B290A8DMBjDMBJjMA6TMAXTMQtzsQCLsQwr8QPWYSO2YDt2EcpeHMDPOIJjOEFCp3CGV53HRbK6RF5X/fmH///ptbuOe4DHeIoXnnvttZDjwm+I6jVRvSCqp0T1mKgenBCJ3Oq23uomt/qdW13lVpfcDQZvBHFGDJ4Sg8fF4FExeEgMHhCDe/VXu/RX28TgZv3VBv3VWo37Gv1V8Eb0SzXuiwhrnsZ9tjvCmQM08/qrye4IJ3TXzBPWKHeEwwnrG437wObE1UQzT1jBr/HvSlhfEVb7L4mLsFqUJa5SmnnCqvcFcRV0p0hYVXIRF2GVI6zSGYmLsIqkJq4UxEVYuRMSF2FlIaxM0YmLsD4jrJQfEBdhJYo4nrCuENZVwroajoxPER2xEQ8JkRQpkBrpkBGfIztyIS8K4gsUQymURUV8iWqoibpogMZojlZoi47ojG7ohb7oj8EYihEYjXGYiO8wDTMxB/OxiBCWYgVWYy02YBO2Yid2Yx8x/IRDOIJjZHQCp7TwZ8jqHC7477I/r3v+po/u4C/nPsITHwdfoHjptX8cw4a4lvh7SVTPiOoJUT0iqvsi8C63Cn50+obe6jq3usKtfuNW57jVr9zqJLcK3tntiBj8WQzuF4N79Fc7xeA2MbhJf7Vef7VWDK7SXy3XXy3RuC8Ug/P0V7M07jMIa6r+apLGfbw7wrH6q5Ea9+AXX39DWAPcEfZrQFyE1b2mO8VqxOWOsF0Fd4qE1YKwmhQjLsKqR1i18hIXYX1JWBU/Jy7CKpXWnSJhFSGsgkncKRJWbsLKHou4CCsTYaWLTFyElfKdcCgpYUUIXRz/jk36AJHxCaIjFuIiIZIgOVIjLTLgc2RDLuRFARRGMZREGVRAZVRFTdRBfTRGM7REW3RAJ3RFT/TB1xik2EMwHKMwFhMwGVMxA7MwDwuxBMuxCj9gncJvxBZsxy7swX5iOIhDOMKnjpHTCZzSyv9KXuf8ecn/r3nthmP+dM49PMBjPPXcC6+9dswbx4ZDeqrXRPWCqJ4S1WOiekhU90TgbRF4y53g79zqmt4qeC+kC9zqLLc67W7whBj8RQwe5lY/cat9c0WiGNwhBreKwU36q3Vi8AcxuEp/tUx/tZiwFojBufqr7zXu08XgFP3VRI37OMIao78aqXEf6o5wMGEN0Lj3dUfYi7C6a9w7E1ZHwmrnjrBVSXeKhNXEHWGDAu4UCauWO8Jq2YjLHWHFDJp5wipFWMWSu1MkrIIJNPNx3SkSVnbC+vyTcDgjYaV7350iYaWMEAjrAo2dD7+Pj/AJoiEW4iIBkiA5UiENMiAzsiEn8qAACqMoSqAMyqMSqqIGaqM+GqEpWqIN2uMrdEEP9EY/DMA3GIaRGIPxmIQpmI7vMQfzFXkRlmIFVmMt1mOT4m/FDuzCXuI5gIM4REpH3B8ew3HSOqWlP+vji56/4vXf/e2WMe7gLwRfoPjbc8+89tIx/zg25JzwGz3VK6J6TlRPiOoRUd0nqrsiMHh7mhsi8Dq3usKtfuNW57lV8P6Tp7jVcW51lFsd4lYHxOBeMbhLDG4Xg5vF4EYx+KMYXCMGV+qvlumvFonB+fqrOfqrmYQ1TQx+p7+aqHEPfj3/aP3VCP3VEI37IP1Vf417H3eEPQmrm8a9szvCDoTVVuPeyh1hM8JqrHFv4I6wDmHV1LhXI6zKhFXBHWGZVJp5wirmjvALwipAWHljauajuVMkrM8/0swTVlrCyhzhY8I6lTKSTXoPHyEKoiEm4iABEiMZUiEN0iMTsiIHciM/CqEISqA0yqESqqA6aqMeGqIJWqA12qEjuqA7eqEv+mMwhmKEIo7Gt5iA7zANMzEb87AQS7BcsVfhB/yIDdhMMluxA7sJYS/286mDOERSR0jrF/+d8OcZ/7/g9cuOvebcG/gTd/EAj/DUa88d88q5b5wTDmnUX+upXhLVM6L6m6geEtVfIvCOCLxFVME7tl1zJxi83+RFvdU5bvUrtzrJrY5p2oM3lP9ZDB4Qg3u41U5utU0MbhaD68Vg8PvuVnOrFWJwiRhcKAbn6a+CX2g9UwwGv45/sv5qgsZ9rBgcpb8arr8aIgYH6q++1l/10bj30F911bh30rh3IKw2GveWGvdmhNVI417fHWEdwqqhca/qjrASYZXXuJdxR1iSsIq6IywcR79FWHncEeaMQlyEldkdYYZI/5uwLsSOFDp59z0b9SGiICpiIA7iIxGSISU+QzpkQhZkR27kQ0EUQXGUQjlUxJeohpqoiwZojGYK0wpt0QGd0Q090QdfYxC+wXCMwliMxyRMwXQi+B5zMB+LsBQrsFrRf8A6bFT8zdiGnQS0G3vDR4nriJ7riIb+sP8f/heJnfb8Ocf95m9X8buxbuEOgq+APfRc8PX7Z4556djXzgmRZ/iNRv2Vnuo5UT0lqkdE9YCo7onA20R1k6h+F4FXReAlorpAVGe51WludYJb/cKtDnGrg9xqP7cKfkPUDjG4VQxuEoPruNUP3GqVGFwuBoNfYL1AfzVXDM4SgzPE4BT91ST91XgxOEYMjtRfDSOsb8TgQP1VP417b8Lqob/qor/6SuPeXn/VWn/VQuPeVH/VUH9VT+Nem7BqaNyruCOsRFjlNe6l3RGWIKwiGvdC7gjzE1ZujXsOd4RZ3wuHMkW8HkoV4T+8g3LE0PHD79qoD23Ux/gUMRAb8ZAISZECqZEOGfE5siMX8qIAvkAxlERZVEBlVEVN1EF9NEIztEQbtMdX6IIe6I1+GIDBGEoIIzEG4zAR32EaZmIW5iryAizGMqzAGkVfi3XYSDhbsI0IdmAXOe3hWftI6wAO+fiY50766Kzjgg7ssjGu44bx/8RdH9/HI689cUzwL5CvnPPGuaxGI69RD97T6Jn4+5uoHhLVfaK6S1R/EtUNERi85fIVEfibO8Hz3OqM3uqU3ir4nSpH9VY/c6sD3Govt9rFrbZzqy3caoO7wXXuBteIwZVicJkYXCwG54vBOWLwezE4XQx+p7+aKAbHicEx+qsR+quhYnCwGBygv+qrv+pFWN31V130Vx0Jq53+qrX+qjlhNdFfNdS419W419JfVddffalxr0hY5TTupTTuxQmriP6qkMY9H2Hl1rhnd0eYJeLbNwXxiBg6svJdG/UBIuNTREcsxENCJEFypEZaZMDnyIacyIMCKIyiKIEyKI9KqIoaqI16aIgmaIHWCtQOHdEZ3dALfdEfgzAEwzEKYzFeQSdhCqbje8zBPEVeiCVYjpUKvgZrCWcdNmIzAWzlVTuwi6x28659+Nnfj3rthGN+dc55z/xmzKv4HTdxG395/iEeO+apY18457VzQ8YIh7jUa6J6oad6Kv6C95F8QFTBu+DeIapbIvCPlSKRqC4vEYki8JwI/JVbnRSBx7jVEW4V/B67/dxqD7faya22ado3i8ENYnAtt1rNrVZwq6XuBheJwflicLYYnCkGp4nB78TgBDH4rf5qtP5qhBgcIgYH6a/666/6iMGeYrCb/qqz/qqjGGyrv2qlv2pOWI31Vw30V3UJq6b+qpr+6kuNewXCKqu/KqVxL0ZYX+ivCmrc8xJWLv1V9giT38rKI/RTiXds1PuIjE8QDTERFwmQGMmQCmmQHpmRFTmQG/lRCEVQHKVtfDlUxJeohlqoiwZojGZohbbogE7oih7ojX4KNwCDMRQjMBrfYgImK+pUzMD3mIv5irwQS7GcZFZijaKvxToetRGbyWkrWW0XjMF/e338k+eO+OiY408596yxLiL4AsU13MCfuOu5+3jkmCeODb5/4qVz/zGG7OJaXOoVUT0jqidE9Yio7hPVXU51m6huiMDrIvAqUf0mAs8T1VkReIpbBb+37hdudYhb/cSt9nGr3dxqB7fayq02cat13OoHbrWKWy0Xg0vE4EIxOFcMzuJWM8TgVDE4SQxOEINj9VejxOBwMThEDA7UX30tBvuIwR76q676q05isL3+qo3+qqX+qhlhNdJf1ddf1SGsmvqrqvqryhr3CvqrMvqrkhr3YoRVWH9VQOOel7ByRvg/vKNfaF+RSKH9ofds1EeIgqiIgTiIj0RIhpT4DOmRCVmQHbmRDwXxBYqhFMqiAiqjKmqiDuqjEZqiBdooUDt8hS7ojl7oi/4YhCEYroijMBbjMRHfYRqxzMRszMUChV6EpYq9HCuJZw3WKvw6ctqATUJxC3ltxx7/P/A2IIMO7KRnfsV5Y/+Gq/gdN3Eb97z2AI8d+9S4L5wbfAfYG2OFQ1u4lru/F0T1lKj+JqqHnOovorpDVLeI6g991TUReFkEXhSB54jq12lc6zuu5U7wiDvBn90JHuBWe7nVLm61nVtt0bRv1LT/qGlfo2lfKQaXcavF3GoBt5rjbvB7MThdDE4Rg5O41Tj91RgxOFIMDhODg8XgADHYTwz2FoPd9VddCOsrMdhef9Vaf9VCf9VUf9VQf1VPf1VbDNbQX1XRX1UirPL6qzL6qxIa96L6q8L6q/yR3oRyR0j3VlX/4RExvOfhezbqQ3yMTxEDsREPiZAUKZAa6ZARnyMbciIvCqAwiqIEyqC8za+EKqiOWqiHhmiC5miFtuiATuiKHorcG/0wAIMxFCMwWjG/xXhMwhSFnY6ZmKXA87AAi4hnKZYr+EoyWo0f+NWPZLWedwX/bfPxLs/vc8xBfztijOM4bdzgCxTBV8Au4xr+wJ+447Xgn7iD758IvkHnmXNfGuMfY4WMGX6znmu5+3uuUX/CqR4R1QOiukdUt4nqJlH9TlRXieqSCLwgAs8S1WkReEIE/iICD3Org9xqP7faw612cqtt3Gozt9rArdZyq9XcagW3WsqtFmna54nBOWJwJreaxq2+41YTxeC3YnC0GBzBrYaKwcFisL8Y7CsGe+mvuonBzmKwoxhsp79qLQabi8Em+quG+qu6YrCWGKyuv6qiv6ooBsvpr0rrr4oTVhH9VcGI/5c3tw0eoZ293rVZHyAyPkV0xEJcJEASJEcqpEEGm5oZWZEDeZAfhVAExVEaZVERX6IaaqIO6qMRmhFAS7RGe3yFLuiOXuiDrxVvIL7BMIzEaIxT0AmYjCkKOx0zMZt45mGBQi/CUsVezqdWYDVJreFba8lrgz+3+PtOr+91XNCBBS3+L8Y7afwzOI/frOEqfvfxTdzGPcc8cOxj5zxx7nNjvDLWG2OGQ1zqNZd66e7vmUb9bz3VQ6L6i6juENWf+qobs0UiUV0hqt/0VedF4BkReEoEHieq4NflH3In+JM7wX3uBHfrrXborbbqrTZyq/V6qx+41SputZxbLRGDC7nVPG41i1vN0LRP5VaTxeB4MfitGBzFrYaLwSFicJAY/FoM9uFWPcVgVzHYSQx2EINtCaulGGwmBhvrrxoQVl0xWFN/VU1/9SVhVRSDZfVXpfRXxcVg0QhfvVXT/+ER2tbsHZv1Pj5CFERDTMRBfCRGMqTEZzY1PTIhC7IjF/KhIL5AMZREGZRHZVRFDdRGPUVpiCZojlZoiw7ohK4K1gO90Q8DMEgBh2A4RmGMYo7DREwmk6mYjpkKPBvzFHkBAS3EElJaxq9WkNUq8lrzLxIL/GstyazjkeuF8gbd4UZN/CZN/CautZlrbeZaW7jWFq61mWttDt/y2h0E36Dz0DnBtxc+M8ZLY702ZsjY4TdE9YpLvSCqpxr1x3qqB0QV/P6520R1k6j+IKqrRHWZqIJfMH1OBP4qAk+KwGMi8IgI/FkEHhCBe0XgLm61jVtt5lYbuNWP3GoNt1rJrZZxq8XcaoGmfY6m/XsxON3d4BQxOIlbjdO0jykjEsXgMDH4jRgcIAb7uRvsLQZ7iMGuYvArMdheDLYRgy3FYFP9VSP9VX0xWEcM1tBfVdVfVRaD5fVXZfRXJQmrWIQGb9X0f35EslHv4UNEQVTEQGzERyIkRQqkRlpkxOfIhpzIgwIojKIogdI2vxwq4ktUQ03UQX00RjO0UKDWaIeO6Ixu6KlofdAPAzFYAYdiBEYRzFiMx0RFnYypCjsdM0lnFuYq8nxSWojFAnEpaS3332p//ui5TT7a5vhdzt3nmeD+8TCOmeuk+c/gPH5D8C+Qv3v+Bv50zF3cd84j5z4xV/AN0q+MGfx4RzhEVP9wqZeLuRZR/a1Rf0RU98XfXaL6k6huEFXwC6WvENUlojovAs8Q1WkReEIE/iICD3OrgyJwP7faza12uBPcyq02cav13Gott1qtt1rBrZZyq4Xcaj63ms2tZnKradzqO241UQyOE4OjxeAIMTiUWw12NzhADPYVg73EYHcx2JlbfSUG24nB1mKwhf6qqRhsKAbricHa+qsaYrCKGKwkBsvrr8pEevFWRv/3R8TQuu/ftWEf4GN8iuiIhbhIiCRIjlRIg/TIbHOzIgdyIx8KogiKoxTKogIqoypqKEZt1ENDNEFztEJbReqATuiC7uil8H3xNQbiG0UcihEYrZhjMV5BJ2Iy8UzBdMWdiVlENIdXzSOpBXxrEXkt9ecq/1/7NiC3OH6HZ/YY7wAOmeOoV48j+Pr9WVzEZVzz3B+45ZjgO8D+MvcD5z42xlNjvTDma2OHzBMOib7XXOqF6Hvq7i/4LZkPiOovorpDVLeI6g+iukZUl4nqogg8R1S/EtVJEXicqI6KwJ+51QEN+z4RuEvDvv0rjXx7kdjGXSK3+oFbreJWy7nVEm61kFvN5VazuNUMTftUTftkMTiBW33LrUZxq+HcaogYHCQG+4vBPmKwJ7fq5m6wsxjsIAbbisFWYrC5GGwsBhuIwbpisBZhVReDX4rBivqrchFnvpXR/8MjtLbOOzbsfXyET2xcNMREHMRHYiRDSnyGdMiELMiOXMiLAiiMoja+BEqjHCriS1RDTdRBfYVphKZogdZoh46K1Qld0QO9Fa4v+mOQAn6DYRipkKMxlnjGY6KiTsZU4pmuuDMwi5zm8Ky5pLWAfy3x8QrPrfHResdudt52Y+z2bPAFioPmO4xj1nESZ3AevyH4/onrXruBPx171zn3nfvIGE+M9cx8L439jzlYB9fiUi+J6vn3Gnl3f4+I6j5R3SWq20R1k6h+J6qrRHVJX3VBX3WWqE6LwBMi8BeiOiwCD4rA/SJwjwjcKQK3cavN3GoDt/qRW63hViu51TJutZhbzedWc7jV99xqOreawq0mcavx3GqMpn2kpn2YGPyGWw3kVv24Ve+MIlEMdhWDncRgBzHYRgy2FIPNxGBjMVhfDNYRgzXFYDUxWPkdrhXhP/5r5SKEl8WLFFr17D0b9iE+RlTEQGzEQ0IkRQqkRlpksLmZkRU5kAf5UQhFUBylUBYVFKEyqqIGaqMeGqKx4jRDS7RBe3ylWJ3RDT3QW+H6oT8GEcUQDFPIkRitmGMxXkEnYjIJTVHYabxqBkl9T1qzMQ+L/H+511Y77kd/2+j8rcbaadw95jmAQ444iuAfiE7jLC7gkueuIvgOsJu47Zx7zn1gjMfGemreF8YOfkDtjbnCIS71mku9IKqn00Siu7+HRPUXUd0hqltE9QdRXSeqK0T1m77qPFGdIapTIvA4UR0lqkMi8CcRuE8E7uZWO7jVVg37pmYisbFIdCe42p3gCm61lFstdCc4j1vN5lYzudU0bvUdt5rIrcZxq9FicAS3GsqtBnOrAZr2vmKwlxjsLga7cKuO3Kq9GGwtBluIwaZisFFUkSgGa4vBGmKwSqS/w9UjvP9WRf/Pj4ihZXvetWkfIDI+tXHREQtxkQCJkQwpkQbpkQlZkB25kNdmF0BhFEUJlEY5VMSXClENNVEH9dEITRSnOVqhLdor1Ffogm7oSQh90E/x+mMwhijiMIxUyNEENBbjFHQCGU3Cd/xqKllNF4zBf4HEFnp+qWNW+tsPzl1vnM2eDb5AEXwFbL+5D1rPYRzDSQT/xH0ewTfoXPH6ddxw7J+449z7xnhorODnh54Z+6U5XpsrRNbhN1zq1VSuRVRPJnEtd38PiOoeUd0mqptE9TtRXSWqy0R1kajOEdWv+qqT+qpjRHVEBP4sAg8Q1V4N+y4RuF0EbhGBG0XgOhH4A7daxa2WcavF3GoBt5rLrWZxqxncaiq3msytJnCrb7nVKE37cE37EE37IDHYn1v15VY9uVU3btWZW3UUg23FYCsx2JxbNXE32FAM1hODtcRg9Yj/iV/dGzxCi/X3i8XhYnG4WBO/mGstFoeLxeFicbhYE7+Yay3mWou51iKutYhrLeJai7jWIk38Iq61iGst4lqL3CEu5FoLudZCd4gL3SEuDFdCFVRXjFqoiwZojKaK0wKt0Q4dCKYTuqK7ovVEH4XrhwGKNxhDiGcYRijkKIwhoHEKOp6cJvKsyaQ1BTMw23MLvL7EcUEHtsYz64y1yfjbsNOcex1xAIes8SiO4zTO4gIuee0qfnds8A3St3HPGA+M9diYT4z93ByvzBX8/HY4JPr+4VIvudSz8VzrW67l7u++Rv2unupPorpBVNeJ6soArkVU54nqDFGd1ledIKpfiOqwCDxIVPuJao8I3CkCt4nAzSJwA7daW0skVheJ3GqpO8FF7gTnuxOcU0okcqvp3GqKpn2S3mo8txrDrUZyq2Hc6htuNZBbfc2t+mjae2jauyYSiWKwA7dqw61acqtmYrCxGGwgBjVPoVr/x6+2/8ceofmJIoUWPHnPpn2Ij/GpzYuO2IiHhEiC5EiFNEiPTMiC7DY5F/KiAAqjKEqgNFGUQ0VURlXUQG1FqYcGaIJmCtQSbdBOoTqgM7oqWHf0RB+F64f+5DJIAb/BUCIaoZCjMJqUvuVX48lqAu+ajEBiszw/z0eLHL/MuauMsdZ4G7wSfAVsh/l3Y791HcRhRx/DSQTfoHPOcxdxxTHX8Idzbjn3jjH+MtZDYwY//fjMGl6Y67U5Q+YOv+FSr7jUCy71lEs9JqoHRHVPo35HT3WLqP7gVNeI6jJRXSSqc0T1q77qpL7qGFEd0Vcd0lcdIKq9InC3CNwuArdyq00icL0I/EHDvkoELheBS0TgQm41j1vN5lYzudU0bvUdt5rIrb7lVqO51QhuNVTTPljTPkDT3k8M9uJW3blVF271Fbdqp2lvo2lvIQabisFGYrBexBvhhhGi/Qfx/Kce4bkD3rFhHyAyPkE0xEQcxEciJLWhKZAaaZERmZEVOZAb+Wx4QXyBYiiJMiivCJVQBdVQE3UUpT4aooniNEdLtFGkduiITgTRFd0VrSf6KFw/9CegQQr4DYYq4nA+NZKcRpPVWN4V/DfJx1M9N9NHcx230HlBi7/SeMEXKNaZa5NXt2Gn9ey1zgM4hKM4jlM4iwu45JjgG6R/xw3n3jbGXWPdN2bwE5BPzBH8/PYrc/5jblXkWlzqJVE9E31PhotEorpPVHeJ6k+iukFUvxPVVaK6RFQXiOosUZ3WV50gql+I6rC+6qAI3E9Ue0TgTqLaJgI3i8ANIvBHbrVGBK7kVsu41WK91QJuNZdbzdJbzeBWU7nVZG41nluN5VajuNVwbjWEWw3iVv25VV9u1ZNbddO0d9a0dxSD7cRgK27VnFs14VYNInR6q5r/jEdodv5IoZmh92zchzbtY0RFDMRGPCREEiRHKqSxsemRCVmQHbmQF/lR2KYXQXGUQllUUIRKqIrqqKUgdVEfjRSmKZqjJdG0QXuF6ojO6Kpg3dGTgPooXD/0V7yBBDRYAYdgGEmNEIqjyGssJvj/lLcBOdvf5jt/sbGWG3u1V34070ZssZbgH4h2Yz8OOuMwjuEkfvXcOVzEZcdec84fuGWMO8b6y5gPrOuxOZ6a64W1vDZ3yBrCIS71mku9EH1PRd/jwSJxoEaeqO4Q1S2i+oOorhHVZaK6SFTnieqMvuqUZv04UR0lqkP6qp9E4D4RuFsE7iCqrSJwE1GtF4FrudVqbrVCBC4tLhKLiEQROEfD/j23mu5OcIo7wYncahy3GqO3GsmthnGrb7jVQE17P27VW9PeQwx25VaduFUHbtWWW7XkVk0jvQo1iZDjrWr+8x4RQ9O2v2vTPkBkfIJoiIk4NjE+EiEpUiA10iIDMiOrTc6B3MiHgvgCRW18CZRGOVRUhMqoihqopdh10QCNFKcpmqOVIrVFe4XqiM4E0hXdFa2novVGXyL6WvEGktIgfvUNhvKu4L8xJDbe85N9NN2xs5w3zzPBPWTwBYpV5vsB6x2xybq2YZf17sUBBN+gcxTHcQpncd4xv+GKc64794Zx/rTGu8a8b22PzPHEXM+s6aW5/7GGkLWE33Cpl1zqOZd6QlSPvuZafUWiu7/bRHWTqH4nqqtEdYmoLhDVWaI6ra86SVTHiOoIUf0sAg8Q1V591S4RuF0EbhGBG4lqnYb9BxG4SgQuF4FLROBCbjWPW83mVjO41TRu9R23msCtvuVWo7nVCG41lFsN5lYDuFVfbtWLW3XnVl241Vea9vaa9taa9hYRN72Vy3/BI/xd9kg27D18iCiIihiIjXhIiCRIblNTIg3SISOyIJuNzok8yI9CKIJiNr8kyqA8KirEl6iGGgpSG/XQQGEaoanitEAromiL9grVEZ0Uqwu6EVAPReutaH3Rj1f1J6mBfGsweQ3z5yh/H+e1SW87sJnOn2OsBcZdYo4VXg2+xPqj9WzEFuvcgd3O2I+DOIxfEHz/6q9eO4eLjr2Ma879wxg3jXXbmPeM/cAcj8311JwvzP3KGt5YSzjEpV4T1Asu9YxL/U1UD4nqrx5cy93fnxr1G0R1naiuENVvRHWeqM4Q1SmiOk5UvxDVYRF4UF+1n6j2iMCd7gK3icDNInADUf0oAteIwJUicBlRLeZWC/KIRG41i1tN/5xrZdTIc6vx7gTHuhMcxa2Gc6sh3GqQ3qo/t+rDrXpyq27cqjO36vieSIwUDrWN8NlbtfwXPML9I0UMTdjxrk37AJHxic2LhpiIg/hIhKRIgdQ2Ni0yIBOyIjty2ey8KIBCKGrji6MUyqC8IlTCl6imGDVRG/UUpQEaEU5TtFCgVmijSO3QgWS+Uqwu6KZgPYioFyn14Vd9yepr94wDMeRf/GuwmYa4iqG8ZrhAGyEOgy9QjOJao7nWGK41VhM/lmt9G95s3cE/ce/CXhxwfYdw1MfHcQpncN6xvznnCq4b44ax/jTmHWPfN8dDawze3uSZuV9aw2trCVlT+A2XekVQz0Xfk14ikageENU9orrt7u+mRv13PdU1orpMVBeJ6pw7wF+J6iRRHSOqo0T1swg8QFT7iGq3CNxBVFv1VZtE4DoRuFYErhaBKzTsS0XgIg37PA37HBH4vQicxq2+41YTudU4bjWGW43kVsO41WBuNZBbfc2tenOrHtyqK7fqxK06RFz9Vin/FY/QmFzvhMa+ec+mfYgoiIroiI14NjIBEiMZUuIzpLO5GfE5siEHctvsfCiIwihq40ugFMqigiJUQhVUV/iaqK0o9dBAYRqhqeI0R0sCaoN2CtVBob4in87oqmDdeVVPkurNt/r6b4A/v/HccB+Ncex45wQt/jTjfW/suV5ZaM6l1hB8DX+Ntf1ovRux1Rk7sBv7cRCHEXyD9AmcdsxZXHDOJedexe/GumnM28a+Z60PzPXInE/MHbxB0ytreWNN4RBB/cOlXoq+Z6Lvb9H3qLNIJKq7RPUnUd3QqF/XU10lqkuc6gJRnSWq00R1gqh+IarD+qqDRLWfqPaIwJ36qm1EtUUEbhCBP4rAH7jVSqJaJgIXi8AFInCuCJzFrWZwq6ncajK3mpBMJLoTHM2tRnCroe4EB3Or/tyqL7fqxa266606R3odah8h0VuV/Nc9IoZGHnzXhn2AyPgE0RATcRAfCW1mEiRHKqRBepubCZ8jG3Iij83Oj4L4QmGLoQRKo6wiVEBlhaiC6qipILVRT1EaoBHxNFWc5mipQG0IqC3aK1RHIurEq7qQVDe+1YO8er+VWOBfwxwzyjnfOneScaYad4Y5gq+AzTf/Yix31CrrXIv1rmEztmGXa9yLA/gZRz13HKdwxrHn8ZtzrxjjmvH+QPAGAXfM/Je5Hprzbyt5ag0vrOW1NYWsLfyGS73mUi+41FPR91j0PRB999qKRKK6RVR/ENU1orpMVBeJ6hxRnSGqU0R1nKiOatYP6at+Iqp9RLVbBO4gqq1EtUkErieqtfqq1SJwhQhcKgIXicD53GpOeq6lYZ+uYZ8iAieJwPEJRSK3GsWthnOrIdxqILf6mlv14VY9uVXX/xa3+t8e4eEFIoWGukMcxrWGuUMcFv7UBkZHLMRFAiRGUhuaEqmRFhmQ2QZnQXbkQh4FLYBC+MLGF0NJlFaAsqiIygpRBdUJoSZqK0o9NFCYRgrTFM2JqIUCtSaitmivUB3I6Sue1Zm0uvqvl4/7eW6gj4Y6dqTzxnpmgrG+M+50c8zy6jzzL7Sepda30prXYB02OmsrdmA39uMgDuMXnHDMaZzFBedeMsZVY/1uzBvGvm2Ou+a6b85H1vvEGoK3l3tlTf9Ym1zhWlzqJZd6zqWeENUjorov+u624FpEdZOofieqq0R1iaguENVZojpNVCeJ6heiOkJUPxPVAaLaq6/apa/aTlRbROBGfdU6ovpBBK4SgctF4BJutVAEzhOBs0XgTBE4TQR+x60mcqtx3GoMtxrBrYZxq8HcagC36setekd6EeoRIetbdfy3PSKGB+96x6Z9gMiIgmiIYRNjIx4SIgmS29SU+AzpkBGZbXJW5EAum50XBVAIRWx8cZS0+aVRTvErojKqKEZ1xaiJ2gpSDw0IqJHCNEEzxWlBRK0UqA2vakdSHfhWR/Lq4s8e/t/3bUB+42/DnT/aWOOMO8krU80309xzrGOBoxZb63Ksdh1rsR6bXec2BN+/uhcH8DOOeO0Ygh9QO+Occ7hojMvGumbMP4x9yxzB++fcM+cD635sDU+t5YU1vbbWN9YYDnGp1wT1QvQ91U89JqqHRPVXM67VmGsR1Q2iuk5UV4jqN6I6T1RniOoUUR3XrB91B3iIqA4S1T6i2qOv2klU24hqswjcQFQ/isA1InAlUS0TgYtF4AIROFcEzhKBM7jVVG41OZ5I1LB/G4NrReVaUbgWtxr0vkh8JxzqG3HjW1n8KzxC/XNFsmnv4UMb9zE+RXTERBwbGR+JkBTJbWoqpEF6ZLLBnyMbctro3MiLAja8MIqguKKXRBkFKIeKilAZVRSiOmoSUG0FqYv6BNNQYRorTFM0J6SW5NSarNryruC/Tj7u7vnePvra8YOdN8wYo4wZfIFiormmeHWGdcyyrnnWuQhLHb0Sa1zXOmx0zVuxA7uxDz95Pvj5oV9wwrGncda5F4xzCVeNed3YN8zxp7numvO+uR9aw9/W8syaXlrvP9YY8ukQfkNQr0Tfc9H3hEs90qTfJ6p7DTXy9blWXa5FVFeJ6hJRXSSqc0T1K1GdJKpjmvUjRPUzUR0gqr36qt2a9R1EtVVftUkErieqtSJwNVGtIKqlInCRCJwvAucQ1fca9ukicIoInCgCx4nAMSJwJLcaxq2+cSc40J1g/wiZ36riX+HxL3eIfSa+Y9Pex0eIYvM+RXTEQlwksJmJkRQpkNrGpkV6ZLLBWZANOW10buRDQeUvjCI2vjhK2vwyKKcAFVCZgKqgmmLUIJRaqKso9RWlAQE1Vpgm5NSMZ7UgrVZoh688181HvRwXdGADnT/EOCOMOcb448052fzTEPwD0RxHLrDmJVjuWla7xrVYj83Yhp3YiwP4GUdwzLEnnfMrzhnjorEuG/Ma/jDHTXPdNuc9cz+whsfW8tSanltb8Pa+b6w1HOJS/3CpF1zqmej7m0s95FJ/cam7RPVnLa5Vg2u5+7uiUf+NqM6Lv7NEdZqoThDVL0R1mKgOEtV+otqjr9pJVNuIaou+aoMIXKev+kFftYqolovAJSJwoQicJwJni8AZInCqCPxOBE4Qgd9yq9EfiURuNZRbDYo4+K0i/hUfod4JI4V63H/Xxn2AyPjE5kVFTMRGPBuZEEmQDCmV9jOkRQYbnBlZkM1G50Qem50PBVHYphdBcZIoidIKUA4VFKESAX2JaopRQzFqEVEd1FOUBqTUiF81JqumvKsFAol19HwXr/dwfB/nDTDON54dbuzR5hvn1YmYYj0zrG+29c5z9CIsc20r8QPWEctGbMEO7Ebw80M/ee0QjuK4c04heIOA88b6zZhXjH3dPDdcU/AOYHfNHbx/4UNrCd599Zm1vbTG19YasubwGy71iks951JPudRjonpQh2txqdtEdZOo/iCqa+7+LhPVRT3VOfF3hqhOEtVxojpKVIeI6iei2qev2k1UO4hqK1FtEoHriWqtvmq1CFxBVEtF4GKimk9Uc0TgLBE4XQROEYGTuNV4EThWwz5Kwz484vVw/whR3qrhX/kR6l4qUqirRr6rSOwqErtyrS76rS7E1UUkdhGJnUViZ+LqLBI7i8ROxNVJv9WJuL4irq+Iq6NmvqN+qyNxdSCuDsTVnrjaE1c74mpHXG2Jqw1xtSGu1sTVirhahasSUXXFqKkYtflUXXKqj4Z8qxF5NfNna/9v7/VOju3unKDFD+4fBxl3qFdGmm+suSdYy3eOmmad31v7XCxwTUuwnEBWYy3WG2UztmEn9nhuPw7iiGOP4aRzT+OcsS4a85Kxgzdo+t1cN81529z3rOGBtTyypifW9twaX1l78O734RCX+odLvSSoZ1zqb9H3iKjui767VbkWUd0gqutEdZWoLhHVBaI6S1SnieoEUR1zB3iEqH4mqgP6qr2a9V1EtZ2otmjWN4rAdUT1g75qlQhcLgKX6KsWisB5InC2CJwpAqdxq+9E4EQROE7DPibS69CYCLnequDf5hEx1OnUOzbtfXyEKPjUBkZHLMS1kfGRCEmR3KamQhqks7kZkNkGZ0V25CKcPDY7HwqisE0vYtOLoyQBlUZZBShPLBUVobIiVEE1IqpBSrVIqg7fqkteDd9KrKXng4D8yt+6OrenMfoZd6Dxh5hvhHnHOGKcNU2yxqnWPQOznTGfKBZhGVYSyRqsw0ZswXbsxj785JhDOOq84zhljDPGO4/fjH3FHNfM9Yc5g/cvDN4g8y9reWhNf1vbU2t8Ya2vrTlk7eE3BPWaS70QfU+51GMu9VA/9Zfou6OfulWeaxHVNaK6TFS/EdV5ojpDVKc41XGiOkpUh4jqJ6Lap6/aQ1Q7iWobUW0WgRuI6keiWiMCV+qrlhHVYhG4QATOFYGziGqGCJwqAieLwAki8NsI+9+W/9/wEW4ROWKo/dl3bdoHiIxPbF5UxEBsxLWRCZAYSW1oCqRW2DRIhww2+HNktcnZkctG50E+4imIwja9iE0vhhIEVMrml0V5BahARJUUoYogrEpO1VGTdwX/1SexJp5v4aM2ju3onC6e6WG8Psbt75XB5h1mDaOs6VtHTcB31hx8/8T3mEsQCwljCZYj+AbptViPzdiGndjjtf0Ifn77sHN+ce4JnDbWWWNewCVzBG8v97s5b7q+P63hrrXct6ZH1vbEGp9b60tr/sfaw64h/A+XesmlnnOpJ0T1iEvd51J3ieq2fupmKY18Ca5FVJeI6gJRnSWqX4nqJFEdI6ojRPUzUR0gqr1EtYuothPVVs36JhG4jqjWEtVqEbiCqJYS1SIROF8EzhGB34vA6SJwigicGPF0eNl/4rtD/9UeoVZ1IoVavXrPpn2IyPjE5kVDDMRWwHhIgMQ2NBlSILWNTYN0NjcjPrfBWZEduQgoj83OhwI2vBC+IKJiNr6EjS9FQGVQTgEqKEAlXlWZpKrwrWrkVdOf9fy/kdeaO6a1v7V3bifjdPNsb+N/bZ7gS6xDrGGEo8ZY33jrnWz9U50xE8F3gM3HIgJZhpVYg3XYiOAH1LZjF/bhJ8cewlHnHjPOKZwx5jljXzTHZXNdM+cf5r5lDcHb+95zXQ+s7bE1PrXWF9Yc/P6ON64hHOJSrwnqBZd6yqX+JqqHmvS/uNQdorpFVDeKisQvNPKFuBZRnSeqM0R1iqhOENUvRHXYHeBBd4D7iWoPUe0kqm1EtVlftYGofiSqNfqqVfqq5US1WAQuJKp5RDVbBM4UgVMjPQ9NjlDubdX/Oz1Czde+Y9Pex4f42OZ9imiIiTg2Mh4S2swkSIYUNjUV0ih2OmS0wZmR1SZnR04bnZt48qKADS9kw79AUSIqbuNL2vjSRFSWlMrzqwpkVUnnVQU1/L+u5xv6qKljWzqvnTGCe8jgCxQ9zdPXqwPM/421DLe2UY781tqD75/4DtOJYRbmOnshlhDJcqzGWqzHJmzFTuxxzH4cdM5h/GKMEzhtzLPGvmCO38x1xZzXzX3DGv60lrvWdN/aHlpj8OsVnlnzS2v/xzWEXEv4DZd6RVDPudQT0feYqB6IvnvFuRZR3SSq34nqWn6RmFcj7+7vnEb9V6I6SVTHOdURojpEVD8R1T6i2k1UO4hqq2Z9E1GtJ6q1RLVaX7WCqJaKwEX6qvlENVcEfi8Cp0eY9rba/x0f4RbvRQw12v2OTfsAH9m4j/EpotvAmIiD+DYyIZIQTTKkQCobm8bGpkMGZLbBWYgnG3La6Nw2Oi8KEFFBG16YiIqgmI0vYeNL8aoyJFVW11WevCr7s7r/1/ZaA8cFHVgL57cxVgdjdjZHd3P2NvfX1hL8A9FQ6xxp3WMVfjwmO2sqMczEbMwnjkVYhpVYQzDBD6gFPwG5BduxC3sdewA/I3j/nGPGOolfjX3OHBfNddmc18wdvL3vTau8bU33rO2BNT621qfW/Nzag98+9Ma1hEME9Q9BvRB9z7jU31zqoej7S/TdFX1/atJvENV1orpCVL8R1QV3f2c16qeJ6oT4+4WoDhPVQaI6QFR7iWoXUW3XrG8hqo1EtY6oftBXrSKq5US1RF+1kKjmEdXsiOvdBb77ttr/nR+hRjkjheo/edemfYCPbFwUREV0xYyJuIhvMxMiiQ1NhhQ2NTXS2Nh0yEAWmW1wFmSzyTkJKBfy2Oz8NrsgERWy4UWIqCiKk1NJsipNXuX+RWLlnFXByBWtorKSfkkCVYVTNXFYXRwGX16tFe5lDf2sZ6D1DXHkcAUfjeAbdCYSwRRMd/YszMVCAlmC5ViNtViPTdiKnY7ZjeDtTX5y7iEcNdZxY54y/hnznMdv5rxi7uvWcMNagjcov2ttwa9XeGitwS+HeWbtL1zDa9cSck3hN1zqFZd6zqWecqnHXOoBl7pHVHdE303R94fou0ZUl4nqIlGdI6pfieoUUR0nqqNEdYiofiKqfUS1m6h2aNa3uQPcRFQbiOpHfdUazfpKolqmr1qsr1oQ8Ulo7n/hN/D9qz9CdfNECtX6+12b9oFNi4woiEow0RHLJsZFfBuZEElsZjKkIJxUSGNj0yGDzc1MIlmQzSbnsMm5CCgP8tnsAoRU0IZ/QU5FeFYx0irhvzI+rui5Kl6v4bi6zmvomabGaWnctl7paL4u5u5hHX2sLfgXyMHWO1SxRyr6WGeNx2RimIbgG6TnYD4WYRmxrMQa/Ijg57e3YDt2Ya9zDuBnYxxB8PZyJ439qznOmuuClV0yd/D+0b9by01rum1t96zxvrU+suYn1v7cNbxyLf+4pnCIS/3DpV5yqWdc6m+CeqSfus+l7hLVn0R1I4dIFH1XieoSUV0gqrNE9StRnSCqY0R1hKh+JqoDRLWXqHYR1XbN+hai2khU64lqrb5qNVGtIKolke6HlkTI+La6/y8/QtVnRLJp79m0DxHZxkVBVMSwgbEQl3DiI6HNTIJkNjSFDU2FNMSTDultbiab+zmykkx2m5zTJucmorxElB8FSaoQ3/oCxVHa38t7vrLjqvtbbefWN04Tz7YwRxtzdfBqZ2vobj29re9rax3o6CEKPkLhg+8AG0cEkzDFCNMxizjmYiGCH1BbjlX4AeuxCVuxw7G7sc+5P+GQsY7iuLFPmeOMuYK39/3N3Fes4Zq1/GFNt6wt+P0df1nrQ2t+bO1PXecL1/LaNb1xbeE3XOo1l3pBVE9F32Oieij6/uJSd/RTt4jqD036tUwiMb1IJKrzRHWGqE4R1XGiOkpUh4nqIFHtJ6o9RLVTs75N/G0mqg1E9aO+6of3uFakcGh5hH+Dr67/1z7CESJGCFVe+I5Ne8+mfYjINi4KohJODMSyiXER30YmRBKbmQwpCCiVTf0MaYkjvc3NZHMzIwvpZLPJOWxyLj6Vh5zy6bjyk1bwX1Efl/RcOR9Vcmw159QyRj1jNTJuM+O3Mmc7839lLV0d1dMa+ypw8P0TgxV8GEY5cywRTEDwDdLTMBNzCGQ+FmEZViL4+e0fscHrm7ENu5y3Fwfws7EOG/MXnDDHaXOdNecFc1+yhqvWEvx6hZvW9qc13rXW+67ikbU/ca3PXctL1/SPawv7NAr/Q1CvRN9zLvWESz3iUvdF310udZtL3dSk/05UV9Nyrc+4VkqRSFS/EtVJojpGVEeI6meiOkBU+4hqN6faQVRbiWoTUa0nKrdioTURvntb0f+xHhFD5aa8Y9Pes2kfIrKNi4KoiGEDYyl6HMSzkQmR2GYmJYjkSGlTP7OpaZGOiDLa3Mw293MCyobswjAnSeVGXvIqgCL+X8JrZR1X0fFVnFvDOHU828D4Tc3V0txtHRH8A1FnIuuusL0d/TUGKXbwHWAjFD/4/tVxRpiEKUQxHbMQ/IDaQizBcqzCD1iPTQjeP2eHc4J3/9pnjJ+MdwhHjX3cHCdxxpznzH3RGi5byzV78Ye13bLG29Z6z5ofWPtj1/DUtbxwTcGvF33jGsMhLvWaS73gUs+41N9c6iGX+ouo7hDVn1zqBpe6TlRXiOq35FwrKddKpJF393dCo/4LUR0mqoNEtZ+o9hDVLqLaTlRbiGojUa0P3vT/f9RHuPo7EUOl3KiWIq6SxFWSuEoQVwniKq7nKq6hL0ZcRYmraDgBaSS2mUmR3IamtKGpfZamQTobm4GIMtnczKSUlV9lI6scvCv4L5BYYc8X91Fpx5Z3bmXPVDdW8AWK+uZp7NXm5m5tHe2tqRORdVPYXuiryAOc9Y2iD8MoAhiLCQQxGcHPD8004hzMxyIsRfAGAWvwIzY4ZjO2Yadz9yB4/8KDOGzsX8xxwlyncdYqL1jDb9ZyxZquW9sNa/zTWu9ac/D70x667uC3Pz5zzS9d2z+uMeTTKfyGS73iUs+51FOCeiz6Huin7hHVbaK6mVokcqlrRHWZqC4S1Tmi+pWoTrr7O65RP6qn+v+1d5/RUpTZGse7G5CcBSQKShIRkSAYBgczRlRUFFFEFBFFJIgwhIsgQxDJIjmIBEFykAySJMeD5HDIOWeovr/y8mHWXWu+3GuAkWL94Zzuqvfdez9P77fo06dqieVvEVPNZ6q5TDWbqaYz1Y/RdvFw1bmmNwFGg4eHJlGwZEjBPKkULg3SK15GZGaCrIp4C3IoZC7myIO8CnqbguZnooKKWpiBiqAoO92F4vrWPexV2r/3+76c5x623xOOedrxzxvrJWO+ao4q5qtm7hr2eJ+AtQn5MUHrE7aRI/5B6OaM9jnCz6+2Q0ejdEZ3puiJ3gh/A3IQowzBcIzEaI+Nw0RMwXTHzMIcY8zHImMuxjJzrDTXGnMmmHuDGDaLZZuYdoptlxj3yuKAmA+L/ZgcTsrltJzOye2iHMO7b8cDXeqyLnWBoc7qUqcsfcctfUd1qUPOp/Yz1R5LX2IeXYuptjLVJqb6hanWMdVqplqhUy1lqsVMtZCp5iWLB3OSBMHMaPdr31T/skWDcn2SKFgypFC0VEijcOlZIiMyK2AWBsqG7AqZSyFzs8ytyKegtzNPAUUtxEp3sNSdFsWietfdCC1W1uMP2qe87x5zbAVjPGfMF439inleN++bRKvOZO8R8AN71iFoPcKGH9Bp7Khm+C+ityZ+W3RghE7oih5G7IW+GMAs32IoRmCUx8ZgAibbdypmYLYxfsICY/5s7KVYYa7V5lxr7vD2ChvFskVM28WWKMY9Yg3vn3ZQ7EfkcFwup+R0Vm7n5XhJroGc41cY6pIudV6XOqNLndSljln6DutSB3Wpfc6ndjuf2ul8als2XYupNjLVeqZay1SrmGo5Uy1hqkU61QKdak60+1W5rqPt12XxPua6j7nKMldZ5irDXPfG0yEDA2VSwCzIpojZmSinQuZWyDzskxe36VP5UZClCutd4Z9iLFbCY2V89YB9H3LMo45/0jjPGLeiZyqZq7J5qxIs/AFR+BPI9wn5ob3rErYBGhH5H8RuQfTwA9JtjNIOHZmhM7ozR0/0Rvj724MwBMMwEqMxzn4TMQXTHDsTc4w1DwuNHV4/epm5wqvfrzF3ghg2iGWTmLaKLby91S6x7hXzAfU4JIejcgnvX3tabuHdty/I9bKc415e8cu61AVd6qwudVqXOqFLHdWlDjHVAV1qD1PtYqodzqe2Op/alEHXsvwlMNUaplrJVMuYajFTLbgelr9/t8UjsWhQyrJYirlKxpMjJVukVrh0yKB4mRjoZgXMilsUMQcT5VLIPEyUVzHzsdTt+lYB9irs37v8fY/nStvvft+Vc9zDxnnco08b+3lzhW+xvspkVYj2FvHesWdNNvyAoHUQfgLsU0c2JnYztCR8ayZoiw4If0GtK3qgF5P0xQB8i6EYgVGeG4PxmOyYHxFeIHM2wsv7zscicywx13JzrjJ/eP+O9QjvPrSFmbaJcadYd4t5n9jD24sekctxOZ2U2xl1OK8Gl+QcyD8e6FKXdKnzutQZXeokUx239B1hqoOWvn1O0ncz1U6m2s5UW5hqY2pdK6WuldySyFQrmGpptMv1a6p/3YLiA2IMlFTBkiOloqVmjLQKlx4ZGSWzAmZRwGzMkx05WSk38uhZefWu8E8hX9/pseK+KmXfso77m0fKGy98g6KCOZ4lzgtEepmJX7NX+BPItwn4LiFrOeIjRvuEuA0I/RnCD0i3MMrnaMMI7dERnRmjO3qiN/pjEIZgGL7HDxhn34mYgmnGmIk5xpxn7IVYbK5l5lxh7tViWCeWX8S0SWxbxbhDrLvEvEfs++VwSC5H5RTefTu8vftZuV6Q82Uvr7gaxC/rUhcZ6pwuddrSd0KXOqpLHbb0HbD07bX07bL07UirazHVZqbawFQJSXWtWDxYeY2+pfB/2iyLkaBo+1hQ5GxSBroJKRQtlaKlRTqvxgyKl4lxblbArAp4i16Vg6VyOuvKzV75/FvQ30U8V8x+4RlYGcc+YJyHPPooMZ5k1mc8W5FI4Q+IKhPsDcJVs/c7hKxJ0PATYB87sj4+JXYTojdDSwZojbZG7IBO6MogPdALfTEA4fVzhiK8+tco+4zBeExy7I+YbqxZmGvs+eZYZL4lWG7uVWII7z6UIKYNYtssxm1i3clMu8W+Tw4H1OawnI7J7aQcz8j1nJwvyv2KGsQDhrrEUOd1qbO61Cld6rgudUSXOqhL7del9jBVoqVvu6Vvy02WxKTxYH3saLDuWnrz87fcggJlokGBK0kU6yakYKJUipZG0dIxUXpkYqLMyMJO2SyK2dkr568Wy+WIPMp+KxnykeU2UuUnZQG9opAFqbDl8A6n1kWcxBd1En+Xk/hiTuLvdhJf3El8+OmvErpWCV2rpK5VStcqrWuVjjclfAu0YoQ2aM8UHdEZ3dGTUXqjHwZhiMeG4XuE1y8c65gJmGyMaZhpzNn4yRzh7RV+NudSrBDDarGsE9MvYtskxi3MtF3MiWLfI4f9Xj6H5BTe3v24HE/J9aycL8j9shoEahG/oktd1KXO6VJndKmTutQxXeowUx1wPrWXqXYz1U6m2mbp2xw9Hay/Vn5M83ttwW2lokHeGUkUKxmSK1hKJkqtaGlZKJ3CZWSnTHrWzayV1Z8c/s3jsds9X+jqGVhxx5ZS9LKK/zfP/J0YjxGlgj2eJdALxHrZnq/hDQJWI2QNvE/UDx39MZHr41OCNyF+M7REa6O2RQfG6ISu6IFe6IsBGIzvMAKj7DsG4x07CT9iujHDq9/PxXxzLTJneIOY5VgpljViSsAGZtos1m1i3iH2XXLYK5cDcjost2NyPCnX03I+pwoX1eCKWsQDXeqyLnVBlzqrS51iqBO61FFL3yFL335L3x7nU4lMtS06KdjyZ/9A+Y/aglwpI0HOYbEgx5WkinUTE6VQsFRIw0hp9av0+lZG3IzQYrk9ns/zBe1fhMGKKXZJRS+j+OE7YA959hGiPOGV/jSBnrfnSwR7lXBVCPiWo6oT8z3d7APi1sEnRmlI9M/QlAFaoBUztEF7dERnJumGnuiNfhiIIZ4bhu8RXn11rGMnYLKxphp3Bmab4ycsMOfP5l4qhhViWSWmtWJbL8aNYt0i5u1iT5TDbrnsk9NBGR+R43GGOiXns3I/rwaX1CJQk/gVXeqSLnWeoc7oUid1qWO61BFd6qClb2/sXLA70is++8/66MufuQXZnokGWRKSKFYyxUquT6Vkp9TOuNKwVnr9K7Ovs3ksl6/yMlx+xb3j1/8/ZidnDj0jl8Upt66Vx3KY13KYz3J4m+Xwdl0rv65VQNcq6CS+kJP4wk7iww9Hh5++LxKvS+z6aET4Jmhu1Jb4Am0ZowM6oSt6ILxAUx+El5cbjO8w3L4jMRrjjDEJU4w5DTPNMcdc88y7EOHtrZaJJbw53xqxJYhxg1g3iXmr2HfIYZdc9sppv9wOy/GoXE/I+bTcz6nBBbW4rCZxtYlfZqgLutRZXeq0LnVClzqqSx2Krgv2/dGf/LzWtiBdpmiQflUsSB8kVaybWCoFUrFXWmT0d1YWy6GYtzLe7YpbSJGLerQ4y5VS/LKefVAX+ztRHiXOk/Z8hlAVCVaJcJUdVYWQbxH0HdQk7gdGqYNPCB7+gtpnDNAULZihFdqgPXN0RHj9nG7oid7oh4EIL5A5FOHlfX9w7FhMMNZkTDX2DMw2V3j3ofnm/xlLxLJcTKvEFt5edL1Yw5sjbxH7NjnslMtuOe2T20E5HpHrMTmfVIkzanBejS6qSaA28UCXuqRLndelzuhSJ2OXgmORBfH4H/UZ9ethi6d5MBqk2J2ErZLpXeGf0GIZWOxmRcyumLkVNZ9HCjJY+AZFMc+UUPx7ifCAV3Y5e4U/gXyCQE/Z+zmCvYhXCPg6qjo6/ID0u8SthQ8JXZfo9dEITYzcHC0Z4gu0RQd8ha7ogW/QBwMwGN9huGNGIrxA+ThMxBRjTzPHTMwx5zxzLxTDYkYK7/64AqvFuE6sv4h5k9i3ymGHXBKZaY/c9svxEEMdlfMJuZ9Sg7NqcUFNLqtN4GUYv6JLXdSlzkUTgzO/869oXbdbPJImGiTpFYvHlCyJ8iXTq5Ir7/+cgeVS1LyKm1+RCyv2XYp+D5OVJkL4A6K/MVl5ez5GoAqEepZgLxCukiMrE/ENYlYj7DuoaaTaxA5/Qa0e4RviMyZoihZoZZY2aI+O6Ixu+Bq90Q8D8a19h2IERhljDMYbM7x/x1RzTDfXLMw193wxLBLLEjEtF9sqMa4Va4KYN4h9sxy2yWWnnHbLbZ8cD8j1sJyPyf2kGpxWi3NqclFtrqhRPIjFg0vRVrrU7/TLpP8pW/iOcBApkSyITkkZxC6mjSdV5mTKnpwUKciTioSp9Ynw7dV0TpXTWw4zOInPpGtldhJ/s5P4LLpWVifx2ZzE3+IkPruulUPXyhl/E9WJ+y6Ra+FDI9ZFfeI3QhNmaI6WaI226MAkX6ErwusXfuOxPuiPQRiC4Y4didHGGoeJxp6Caeaaac45mCeG8O6PP4tpqdhWiHG1WNeJ+Rexb5TDFrlsl1Oi3PbIcb9cD8r5iNyPq8EptTirJueD2PmLanQh+C2vpfAX2VIGkTJpgujMDEEsyKKY2RU1t+LmU+SCil1E0YtZMEsQ4F5i3E+Ucl7pDxPocUI9RbBnCfcCAV/Ga8R8g6jVjFQDNQldG3WIXg8NmaAxmpqlBVohvEBTO4SXl+uMbvgavdAPA/GtY4ZihDFGYYwxx2OSOcLbW0035yxzzxXDfCwS02KxLRNjePftNWJOEPsGOWyWyzY57ZDbLv+V2SvXA3I+LPejanAiiF06HUTHMNRvcymhv/KWNogUzBxEf8xmicyluHkVOXyLtbCiF1X84kxWihBlCfKgV3r4AZ1HCfUkwZ4h3PN4iYivErMKUd9EdQK/S+xa+IjwddEAjRihCcLr57RkjtZoiw74Cl3QA9+gj336YxCGOHYYvscPxhyLCeaYbK6pmGHu2WIIby+6QFw/Y6kYV4h3NdaKfb0cNspli5y2yy1Rjrvluk/OB+V+mKEOB//PK+nd2P7XZonMEkTuzsFgeSyRtzu/KKTodyr+3V7RJQlRhiAPEKYcgR4m1ONe/U8RLfyA9ItEfJmYr6EqcasRuQZqErw26hC/HhqiMUM0RXiBplZog3boiM7ohq8RXj+6LwY6Jry9wlCMMNYojDb2eEwy1xRzTscsMcwRyzwxLRTbYjEuE+tKMa8Re4IcNshlk5y2ym2HHBPlulfOB724rlbixvZ7bXktkWiaP4jtuUPx7/KKvocQpQlyH2HCT4CVJ9RjBKtAuGcIWJGQlfAqUcNfUHsL1Qn9HsFr4SPUZYIGaIQmTNEcLdEabdEBXyG8vG939LRfH/THIAwxxjCEdx/6wdhjzTEBk8051dwzMFss4c2RF4htkRiXiHW5mFeJfa0c1stlo5w2B9E924PIJzuDv8q75tfQdms8kqFwEClbNIj+cLdzj5IEKUuYBwj0EKEeIdgThHuagM/hRWK+QtTXUJXA1QhdA+8TvjbqoB4jNERjNEULhNcvbIN2+NL3ndANX6MXwtsrDHDsYHyH4cYcidHmGGeuiZhi7mlimCmeOZgntoViXCzWZWJeIfbVQezUOrkkBJE7t8vtapo3tj9zyx9EkpeMRyreG0SH3e9/TOUIVZ5gj6EC8Z4lYkViViJqZVQh8luoTvD3UIv4H6EuGjBEIzRBc7Rkktb4Jzr4Prx+dBd0R0/0cUx/DMQQYw3D98b+AWPNNd68kzFVDNPFMktMc8U3H4vEujiI9l0p9nU33ti89rcHg8jb5YNIs0eC6PonnPg+TcTnCfoiXiHu66hK6LdRg+jvozYTfIx6aMgUjRFev7AFPkcbtMOX6ISu+Nq+vdAXA4wxGN8ZczhGmmM0xplzovmnYGoQuzJDTHODSN15wb+5h/KN7frYnrC0PPsr0SEvBNEJlZy/VGa2KoR+C9XxHvFr4SNGqIsGaIQmDNIMLdEa/0R7fOW5LuiOnujt2H4YaKxvMRQjzDEqiCaONee4INJjihgmBpE7roZ1Y/tP2560bL4RRFJXCSLpqgaRLtWCaJcaqBlEV9aOR3WtmK4V07ViulZM14rpWjFdKxb/Au3wJTqhK3o4pqdjexujPwYZc7DxQ7qY6+q0f6EtEvlvLj6dTNsMZuwAAAAASUVORK5CYII=","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAJYAAACWCAYAAAA8AXHiAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAAZdEVYdFNvZnR3YXJlAHBhaW50Lm5ldCA0LjAuMjHxIGmVAACqeElEQVR4Xuz9BbhVZdjufQM2onR3SSPdId0h3d0p3VLSISkp3S3S3SIhKSmpgISUNDLn9xvP5j3e3N+u59nv3vt9psdfFnOOcd/3uK9znec1FmvNFeH/i49aEUJxa0YIpawdIZS6foTQ+EYRQ+OboVXE0LG2EcPhjpHC4c7ohl7oi/4YhCEYgdH4FhMw2TlTnTvTGLMw15iLjR+wNEIo9ttp//3xv9qjVIRw8TIRQiUqRAxt+zJi6HC1SKG/ahFEvXfC4YZo+m443AKt0f69cPgrdEUP9H4/HP4aA/ENhmEUxnptPCZhCqY793vMwXxjLsJSc6yIFLq72pxrI4ZWrreGTRFCRd4u698f/zM+CkYItSwcMTy8eMTww1IKXE6hKyl6FdQghDqoTyCNPwiHm6EV2n7IrdAZ3T7iVuiL/hiMoRiB0RiHifjOsdMwE7ONMQ8LscTYy82xCj+Ycx02WsPmSKHQNmvaGSHUa3eEULO3y/33x/+oj88jhBJmixCqkytiaGk+QiqkiEUVs4TClkEFha6s4NUIoBbqEkVDNI3MrdD6Y26Fr6JwK/RAb3yNgZ9wKwzDKIz13HhMwhTMwCznzsECYy3GMmOvxBpz/YgN5t5sDVutZQd2W9s+a/zJWn+OGPr+sLWfjhCO9/Zy/v3x/+YjVYRQorQRQlUyRAzt+TxS6J8cCpVHwQooXGFFLKaYpRS1nAJXUuwqqKH4tQmhPhoTSTO0+pRboWNUboVu6BWNW6E/BmMoRmA0xmEivsM0x87EbMwzxkIsMeYKrDLHD1hnzo3m3oLt1rLLmvZa2wFr/Nlaj1jzMWs/ESn07JRrORMhVPKCa3t7mf/++O/1SBYhVBijU0cKPUmnIJkUJqsC5VSovApWUOGKKGAJhSyjqOUVt7JCV1P0mqhLBA2JoglaROdWaB+DW6EresTkVvgaA/ENhmMUxmI8JmEqZmCWc+ZiARYbaxlWGnsNfjTXBnNuxjZr2Gkte6xpv7UdtMZD1nrUmo9b+ynXcMa1nHdNF13blQjhAVcjhPK/vex/f/zbPMLvxrbJCSKGtifRp6S0+WkUIoOCfK4w2RUot0LlV7TCilcUJRWzLCoqbhVFrq7gtRW/PhoRRLNY4XBLtI0dDndAZ3SLw63QFwPicisMxQiMwThMxHden4aZmIP5zl2EpVhhzNVYa4715tqIrebeYQ27rGWvNR3Az9Z4BMes+aS1/+oazrmWC67pkmu76hqvu9abrvlmhHD2cIRwpLeb8e+Pf41H1AjhL2JGDB2Ipx9J5DM6mU1PpQBpFSKjgmTx2Z9DcfJwhAIK9oXiFVfE0opZXlEro6pC10RdhW9ACE3QgkBao308boWu8bkVeuPrBNwKQzAcozAW4zEZUzEDsxw7Fwuw2BjLsNKYa7DOHBuw2ZzbzL2T0PZYy34ctLbD1viLtZ6w5lPWfsY1nHctv7mmK67tumv8w7Xecs13XPtfEUM77kUI5Xq7Lf/++K99fBAhVOzjiKGz0Xzmxra58W1yYpud3MZ/pgDpFSKzz/hsCpNLgfIpVCEFK6pwJRWxrGJWUNQvFbe6QtdW9HpoRATNiKIl2ibkVuiciFuhV2Juhf4YjKEYkYRbYRwm4jvPTcf3mIP5zluEpVhhrNVYa+z12GSurebcgd3WsM9afrKmQ9Z21BqPWetJa/7V2s+5houu5bJruurafneNNwnstmu+59of2INH74TePIkYOvgsQrjA223698d/3iP8boQIoXzvRQzv+kgMfGIzY9jUODY3AUEltdkpbXoan+EZFOFzxcihMLkVqIBCFVawYgpXSgHLKWQlBa2quDUVuY6CN1D8JmhOEK2JpB2+Ssqt0CMZt8LXGJicW2E4RmEsJmAypmIGZmGuYxdiCZYbYxV+MOY6bDTHFnNtxy5z77WG/dZy0JoOW9sv1njCWk9b81lrv+AaLrmWK67pumu74Rr/dK13XPNfBPbQHvxtL57Zkxf25rU9CnGwf4/I/9Tjo1DCiO+GFkXiUO/bvMg2MarNjElQ8WxuIp/JyWx2Khufzmd4JkXIqiA5FSavAhVUqCKKVkLxyihiBcX8UlGro5Yi11PsRgrflAhaoi1hdEDnFNwqJbdCXwxIxa0wFCMxBuNScytM8fF0fI85mI9FzlmKFcZZjbXGXI/N5tiKHebcbe591vCTtRzCUes7bp2n8CuRnbP2i67hsmu55pr+cG23XONt13rPNT9w7Y/twVMCe25PXtmbN/YpHCkUDkV8OZHAEr7dxX9//J8eUUKVIn0UfviOjXvPxn2AKD6OZjNj2dT4NjexTU5usz/zmZ3e5mdWiGwKklth8hNUYUUqRkylFK6sIlZUzCqKWkNx6yh0AzRW+OZE0Jog2uErYumCHp9xK3ydhlthCIan5Vb4FhMwGVMxE7MxzzELsQTLnbsKPxhrHTYaewu2m2uXOfea+4B1/Iwj1nTM2k5Y42lrPWvNF6z9kmu46lp+d003XNufrvGua73vmh+59if24Jm9eGlP/rE3IXsUfu9NOPzOq3Ao0rP7oQhPSr3dzX9/EFTsiFFDV9+xce+y//dt3oc2L7II+AQx/D2O1xLY3KQ2OaXNTmPTM9r8LAqRQ0Hy+OwvoDhfKFRxBSutcOUVsLJiVlPUWopbV5EbKnhTtCSANsTQAZ0IpFs6boW+6bkVBmMoRmbgVhiHSZiC6fgeczDfMYuwDCudvwY/YoMxNxt7G3aaa4859+OgNRyylqPWdNzaTlnjGWs9b82/Wftl13DNtfzhmm65tjuu8S/X+sA1P3btT+3BC3vxyp6E7E04cshmvbZpL2zeU+J6HApFfHgqHOFG5Le7+//RR+xQ/UixQ+feYf/v2bwPbN5HIuBjGxjFBkZFTB/H9VwiryezyalsdjqbnsnmZ1WInD7j8ypKQQUqqlAlFayswlVUwCoKWV1BaytufUVurODNFb4VIbTDV8TRJSO3Qm98nYlbYUhmboVR+BYTMBnTMBOzMQ8LsQTLnbMKPxhjPTYadwt2mGOX+fbigLl/toYj1nLMmk5a26/WeM5aL1jzJWu/6hp+dy03XdNt13bPNd53rY9c8xPX/twevLQX/9iTsE/CcJR/bNZLm/bM5j2xiY+4133ReO9sKMKfdd7u8v+HHmlCn0RMGN71ToJQ6F2foe/bwA9tYGQxEMUmfmoToxFbdBsZC/H8PbHnkzvmM8emt+mZbX52n+m5FSO/whRWoGIKVUrByilcJQWsqpA1FbWuAjdEU8VuofBtiKADQXRCt8/D4Z7om8WdIAZn5VYYiTEYl41bYQqmYxbmYoHXFmMZVmKNc3/EBmNtxjZj7zTPHuw350FzH7aGX3DCmk5Z2xlrPG+tv1nzFWu/7hpuENgt13THtf3lGh+61r9d8zPX/sIevLYXIXsSji4Co72yWdwqylOb99gmPrCZ97jXHe5181Uowu9rNfbvvd31/8UfyUM5IyYL/fSODXzPBn5gAz/yWfqxTfzEJkYltOg2MoaNjEVocWxmAh8n8VxKr6dxXEbnZHFuDoLKoxgFFaaIApVQqDIKVkHhvlTA6opZW1HrK24jhW6m4K3QjgA6EkMXAumB3tm5FQbm4FYYjlE5uRUmYDKmYSZmYx4WYSlWOHY11mK9MTZhqzF3YLc59pnrJ3P+jKPWcMxaTlrTr9Z2zhovcrLL1nzN2n93DTcJ7LZruufaHrjGx671iWt+7tpf2YM39iIcRwTGEoExuFV0bvXp3zbvoU28bzPv2tQ/be4N7nWde13ZHYpwKefb3f9f9JE2VCJS6tCbd23g+8TwoU2MbBOj4FNCi4oYNjOmzYxNbHFtaHwbmpDYkvk4lefTeT2TTc/qnJzGyGesQgpTVIFKElRZBauocFUUsIZC1lHQBorbRJFbKHZrhW+PToTQjTB65uJW6J+bW2EoRubhVhiHSZiSl1thFuZigecWYxlWYo1zfsQGbDHWduw09l5z7DfXQRw29y/WcMJaTlvTWWu7YI2/WesVArtu7Tdcw5+u5a5r+su1PXKNf7vWZ675pWv/xx6E7EU4PreKy61iP7dZIjA6t4rKrT7lVlFu29SbNvcPm3yNuC5zr4tPQhEu5Hlbhf+FHoXD70bIEJofKV3o5Xs28QOb+KFN/Bif2MioPluj2cyYNjMWscWxofGQgNAS2dQkNjW5Pz+zyek9n9lx2Z2T27n5jVHYmMUJqrRClVewygpXTQFrKWQ9BW2ksM0UuaVit1X0jgTQhSC6ozeh9MvHrfANhufnVvgWEwpwK0zDTMzGPCzCUqxwzGqsxXrnbsJW4+3AbmPvM89POGTOo+Y+bg2nrOWMNZ2ztovWeNlar1nzH9Z+yzXcdi33XNMD1/bYnjx1rS9c8yvX/sYehBNzq4TcKoEIjMet4nCrWNwq5l828Q5xcatPuFXk6zb5is3+TTSeJ66zf4cinJ4hGiO+rcr/Ao8soRWRbOB7+MAmfmQTP8YnPluj2szoNjMmYhNcXJsa36YmJJzENjapjU1GbClsbhofZ/B8Fq/ncGwe5xR0fhFjlTBuGYWqoGBfKlwNBaytkPUVtLHiNkdrxW6v6J0IoCsx9CSOvuhfkFthaCFuhTGFuRUmYQqmYxbmYgEWYzlW4Qesc85GbDHGduwy5l4cMMfP5jpizl/MfdIaTuOsNV2wtkvWeNVaf7fmm9b+p2u461ruu6ZHru2JvXjmWl/ah3/sQdgehJNp2JNwq8TcKiG3iq9hjysCY4vAmNwqOreK+rvNvWqTL9nsizb9HHH9Gg5HOhkORTi28G1V/id+pAp9EDFHeNk7NvE9m/gBPrKRH9vITxHNZsYgtlg2NA7i2dQExJbIxiaxscmIJ7nNTWlzUxNUWn9m8vesXsvluHyOL+S8osYpabxyxq9krqoKV1MB6ypmQ0VtqrgtFbmNYndAZ8XvTgi9iaLfF9wK3xThVhhVlFthAiZjWjFuhdmYj0VYihVeW4212IBNzt2KncbaY9x9+Mkch8111JzHccoazljLeWv6zdqucLJr1vqHNd+y9juu4S/X8tA1PXZtT13jC9f62jWHXHs4tQhMya2Sc6ukGvYkIjARt0rAreJxqzi3bKYIjCECo3GrT7nVx+dt+hmbf0oRjovGX/Rdh6ZwrnfeVul/skf68PsR84ZWvmMT37eJHyKyYkdBVBsazYbGsKGxEdemxie4hDY2MZLa3OQEl9IGp7LBn9ngtMSW3iZn9mc2z+X2Wn7HfeG84s4vbZzyxq1s/OrmqqWA9RWysYI2U9zWitxOsb9S+K4E0BN9CKI/kQzG0OLh8IgS3ArjMKkkt8IMzMJcLMASLMcq/IB1jt2ILdhujF3G2osDxv7ZHEdwzJwnzf2rNZyzlovWdMnarlrj79Z605pvW/s913DftTyyB09c23PX+Mq1vnHN4XQiMC23+kzDnkoEpuRWyblVUm6VmFslFIHxRWBcbhWbW8XgVtEuENdZm37a5p9UhGPEdYS4fiauA9//TxmLEQuFlr9jI9+3kR8iss38xGZGRXQbGhOxiS6ujY1vYxMhic1NSnApbHAqG5yaaNLY5HQ2OQOhZbLRnyOHv+fxWkHHFHF8CeeVMU5F41Uxbg1z1TFnA/M3UdAWCttGgTsodmdF70YAvQihHwYSxzeluBVGleZWmFAmHP4O0zATs8tyKyzCUqzw3Gr8iA3Y7Jxt2GmMPdhvzIPGPoxfzHXCnKfMfdYazlvLb9Z0xdquW+MNa71lzXes/S/X8NC1/O2anrm2F679tWsNueZwRm6VQQSm41ZpuFVqbpVSw55cw56UWyURgYm4VXxuFfeyzRWBMblVdG4VlVtF4VaRjyrGIeL6ibj2EdfuRW/L9T/BozqnKkZUNvJ9fGgzI9vMKIhqQ6Mjpk2Ng3g2NoGNTURsSZDMBqe0wals8GdIa5PTI6ONzkxsWWx2VoLK6c98nivktaKOK+Wccs6vZKyqxqxljnrma2TuZtbQSmHbKXBHhe6i6D0Uvw8hfE0UgzCUWEaU41YYV55bYQpmVOBWmIsFWILlWIUfsM4xG7EVO5y7C/uM9ZMxf8YRcxw310lz/mruc9Zw0VouW9M1a/vdGm9a621rvmftD1zDY9fyxDU9d22vXPMb1xrOyq2yiMBM3Cojt0qvYU8rAj/jVqm4VQpulYxbJdGwJxKBCbhVPG4Vh1vF5FbRT9j8XxThsGL8rCgHiGsvce0iru0a+mX/g8diaT1VafFnM9+3mR8isg2Ngqg2NTpi2tg4iGdzE9jcxEhqg5Pb4JTElhppbHQ6G53BRmcits9tdlabnY2r5bDhuZHfx4U9X9wxpR1b3nlfGqO68Wobu745GpuvublbW097Re6k2N0UvhcB9MMAgviGQIZV5FYYW4lbYTKmVeZWmIP5WPQlt8JKH6/Bj9iAzY7dhp3YY4z9OGjMw8b+xRwncNqcZ819wRouWcsVa7pubTes8U9rvWvNf1n7Q9fwt2t55ppeurZ/XGPItYZzcKts3Cqrhv1zEZhJBGbgVum4VRoNe2pulVIEJheBSblVYm6VQMMeT8MeRwTG5FbRuVVUbhWFW0Xepzi7iWsHcW0lrk3E1f9/3O+QiFheo24j38eHNjMyPkFUmxrDpsZCXBsbHwmJLjGS2uTkNjkVPrPRaW10ehudkdgyI4sNz2bDsxNbTpue26bnJbYCKOLvJbxW1jEVnVPFuTWMU9eYDY3d1Hwtzd3WGjpaUxfF7q7ovRX/a0IYhCHEMYJgxmBcFW6FKVXdCWJWNW6FhViC5ViFtVjv9U3Yih3O2Y19xvgJh4x51NjHccpcZ8x5ztwXreGytVyzpj+s7ZY13rHWe9b8wNofu4anruWFa3rl2t64xnBebpWbW+UUgdlFYDZu9Tm3yqxhzygC02vY03Krz7hVKm6VXMOeVAQmFoEJRWB8bhWXW8XiVjEOKsZ+4tqjODsVaRtxbSGujcS1/n/AWAy+TlU5tOIdG/q+zfwQkW1oFES1qTEQy8bGRXybmxBJbHAypLDJqWzyZ0hLcBlsdiabnRlZbXh2Ysth03PZ9DyEls/GF7DxhVDUx6U8X87rlRxbzTm1jFHPWI2M28w8rczZzvxfWUtX6+ppjX0VfwAhDCaKYRhFKGOrcytMrsGtMLMmt8J8LMIyrMQa/IgN2Ixtjt2Fvc49gJ+NdcSYx3DSHKfNddacF8x9yRquWsvv1nTTtf9pjXet9b41P7L2J67huWt56Tr/cW1hn0zh/Br2fNwqD7fKxa1ycKtsIjCLCMzMrTJxq/TcKi23+kwEphKBKbhVMm6VhFsl1LDH17DHFYGxRGAMbhWVW0XhVpG3KtYm4lpPXGvDoQirZv+PFYvVQvMj2dD38KENjYwoiGpjYyCWzY2L+DY4IZLY5GRIYaNT2+g0SGezMxBCJnxu07Pa9Ow2PSdy2/i8BJff5he0+YWJ7QsFKI7S/l7e8186prpjazu3vjGaGLOF8duYp4M5O5u/uzX1xtfWOZAIhhDECOIYjXG1uFVtboUZdbgV5mJhXW6F5ViNtVjv+U3Yih3Y7Zx9+MkYh4x1FMeNfcocZ8x13py/4Yo1XLOWP6zplrXdcc1/WetDa35s7U9dwwvX8to1hVxb+AsRWJhbFeRW+blVXg17bm6Vk1tl51ZZudXnGvZMGvYM3Codt0rDrVJzqxTcKpkITCICE4rA+CIwLreKxa1icKuo3CrKZsXaoGg/Kt4P4XCklcS1dOTbqv6//KgVKhGpVujlezb1A0S2qZ8gqo2NjliIa4PjI6FNTmKDkyEFUhNdGpudDhlteGYbngXZbHoOwsiFPDY/n80vYPMLEdsXClBUAYoRWglFKOPjip6r4vUajqvrnIbOb2q8lsZta46O5upi/p7W0sfa+lvnYEIYhpGEMZZYJtTjVpiGmfW5FeY34FZYhpVYg3XYiC3Y7phd2OucA/jZOEdwzJgnjf0rzpnvIi6Z+6rr/91ablrTbWu7Z40PrPWRNT+x9ueu4ZVreeOawiVEYDFuVUTD/oWGvZAILMCt8nGrPNwql4Y9hwjMJgKzcKvM3CoDt0qnYU+jYU8tAlNwq2QiMAm3Ssit4mvY4+5SlO2KIwKjbiSudYq2VvFWh8PvrgiHIi1+FoqwKPfb6v6/9GgUyhmpXujNezb1A3yEKDY2KqLb3JiIi/g2OCGSKGgypLDRqZHGZqdDRkXPbNOzILuNz4ncNj+Pzc9v8wsSW2EUUYSiilCc2EoqRGmFKEdslXxc1fO1vF7P8Y2c19wYrY3X3tidzNXNvL2soZ/1DLS+IdY6nChGYxyRTGzIrTC9EbfC3MbcCkuwHKubcCus9/EmbMNO7Hbsfhx07mH8YqwTxjyFM+Y4b67fzHnF3Net4Ya13LKmu9b2lzU+tNa/rfmZtb90Da9dS8g1hUtzq5IisLgILMqtinCrQhr2ghr2/CIwjwjMxa1ycqtsGvYsGvbMIjCDCEwnAtNwq1TcKgW3SsatkojAhCIwvgiMIwJjisDo3Coqt4qyRvFWKuIy4lqs31rwJhRhbo63Vf7v/GgS+iRi49BP79rcD2zsR/gYUW1udMREHJscHwltchIks9EpkNpmp0E6ZLTpmW16FmSz8TltfG7kJbgCClAQhRWhqCIUI7YSClFKIcoQWjnFqKAYlf1Z3XO1vdbAcU0c38L5bYzTwbhdzNHDXH3M/bV1DLKmodY30nrHWv94TCaaaU25FWY341ZYhGVY2ZxbYR02YovntmMX9uKAc37GEWMcM9ZJ/Grsc+a4aK7L5rxm7j+s4aa13Had96ztgTU+ttan1vzc2l+5hjeuJVyeW5UTgWVEYCluVYJbFROBRUVgYW5VkFsV4FZ5uVVuEZhTBGbjVlm4VWZulYFbpdOwp+FWqTTsKbhVMhGYhFsl5FbxuFUcbhWTW0UXgZ+uUrzlirhEk7xQvzWPuOZsE4sfva32f79HxGbhXe/Y1PfxIT7GpzY3GmIijk2Oh4RIYqOTIYXNTo00NjwdMtr0z5HVxmdHTpufG3kVoIACFMIXhFFUIYorREmFKI2yxFZeQSoqSCViq6IoNXxc13MNvd7Usa2c1875Xxmvq7F7mqevOQeY/xtrGW5do63zW+ueSCxTML0Ft2rJrbAQS1pxK6zGWqzHZmzDTuxxzH4cxGHn/mKMEzhtzLPGvmCOS+a6as7r5r5hDX9ay11rum9tj6zxb2t9Zs0vrf0f1xByLeFK3KoityrPrcpq2EuLwJLcqji3KsqtvuBWhTTsBURgXhGYm1vl5FbZuVVWbvW5CMyoYU/HrdJwq9TcKgW3SsatknCrhNwqnoY9jgiMKQKjrVC8pYq4SDHnK+oc4vpevzV98dty/3d6tAnVf6dVKPSezf0QH+MTRLPBMRAb8Wx0AiRGMpudAqlteBqkQ0Yb/zmy2vwcyKUAeZBPEQoqQiF8oRDFFKIESilGGYIrpyAVFKQSsX2pKFUUpRqh1fJnPX9v7LXmjmvt+PbO62Sc7sbsbeyvzTPQ3EOsZYR1jbHO8Zhs7VNbcyvMacOtsKgtt8JKrME6bMQWbMdu7MNPjj2Eo849jlPGOmPMc7hojsvmu4Y/zH3LGu5Yyz1remhtj63xqet5Yc2vrf2NawhX41ZVuFVlblVJBFbgVuW4VRluVUrDXkLDXoxbfSECC3GrAtwqn4Y9j4Y9l4Y9uwjMKgI/51YZuVU6DXsabpVKw55Cw55Mw55YBCYQgfFEYGxuFUMERlusiNwq8jxFnaWZn6nfmvomFOG78m+r/m/8aB+KHald6Ny77UQgIuMTRLXJMRAbcW10AiRGUpudAqmRxqanQ0ab/jmy2vjsyIU8ip1PAQqiMMEVQXHFKKEYpVBWQcorSEViq6woVVBVYaoTUU3Fqa049f3ZxHMtHNPGsR2d18UYPYzVx/j9zTPYvMOsYZT1fGt9E6z3O0x3Dd+351ZY2IFbYQVWd+RWWI/N2Iad2OO1/TiIw875BSeMcdpYZ3HB2JfMcdVcv5vzprlvu7a71nLfmh65nifW+Nx1vLTmf6w97BrCNTXs1TXsVblVFW5ViVtV1LCXF4FlRGApblWCWxXjVkW4VWERWFAE5uNWebhVLm6VnVtl1bBnFoEZNOzpRGAaEZhKBKbgVklFYGJulYBbxeVWsblVDG4VlVt9wq0if6+40/VbU0TipF9DEcbEeFv9f7tHxK9CV9/5ilviI0RBVBsdHbEQF/FtdiIkRXIbngppkM7GZ0RmZLX5OZBLAfIgnyIURGGFKILiilFSMUqjLFGUV5SK+FJhqipMNaKpoTi1FKcOIdVToIZo6u8tvdbOMV85vqtzexqrnzEHGn+IuUaYd4w1jLOmSdY41Zpnuo7ZmN+JW2EZVnYOh3/AOmzEFuzAbuzDT445hKM47txTOGOs88b8zdhXzHHNXDfMecvcd6zhL9fz0Jr+tran1vjCWl9bc8jaw/VEYB1uVYtb1eBW1TTsVUVgZRFYkVuV51ZlNeyluVVJDXtxEViEWxXmVgW5VT5ulYdb5RKB2UVgVhGYmVtlEIHpuFUabpWKWyXnVkm5VSINe3xuFZdbxVqgiHNFIreKMkNxpyryZJE4gbi+Pf62/P9Gj66hSu905ZL4EB/jU0TrIqoRB/GRyKYnQXKksumfIR0y2vjMyILsCpALeRQhHwqisGIUUYziKKkgpVFOUSooSiV8qTBViaS64tRUnNqoq0D1ia2hIjVSpOb+bO259l7r7NjuzultjK+NNci4Q80x0lxjzT3BOr6zrunW+b11z8UC17Okm94Kq7EW67tzK2zDTuzx3AH8jCOOP4aTzj2Nc8a6aMxLxr5qjt/NddOct819zxoeWMsja3pibc+t8ZW1vrHmcCMR2JBb1edWdTXstUVgTW5VnVtV5VZfcqtKIrCChr0styotAktyq+LcqoiGvbCGvaCGPR+3ysOtcnGr7NwqC7fKzK0ycKt0GvbPuFVKDXtyEZhEw55Iwx5fBMYRgTFnK+ZMRZ2muN8p8kTFHicSR4fCEUb/G/3kde9Qwkg9ww/f7cklERmf9OBWiInYiIeENj4JkiGljf8MaZHB5mdGFmRDTkXIg3wKURCFFaMIiitISZRWlHKooDCVFKYKqilODcWphToKVI/YGihSI0VqTGxNFaoF2vi4o+e7OKaHY/s4d4BxvjHecGOPNt84c0/CFGubgdnWO8/6F2GZa1uJH3pxK2zEVuzAbuzDTzjkmKM47pxTOGOM88b6zfVdMfZ13DDXn+a8a+6/rOGha/jbmp5Z+0trfG2tIWsON+VWjTXsjURgA25Vj1vV4Va1uFUNDXs1EfilCKzErSpwq7LcqrSGvaQILC4Ci3CrwtyqILfKx63ycKucGvZs3CqLhj2zCEyvYU8rAj8TgSlFYDIRmFgEJhSB8URgbBEYQwRGnaK4kxR5vGKPFYmjuNbwP8IR+kd5q4Z/pUf/8LsR+4YWvdOXO+IjROljfsRALMRFgt7WiaRIidQ2Py0yIBOyKEJ25FSE3MiHgopRGEVQXFFKoozClENFhamsMFVQjehqoLYi1VWk+orUgGAao4liNVOsFoTUSsHa+fMrf+/mtV6O6+ecgc4dYpwRxh1jjvHmm2z+adbzvbXNwQJrXuI6lmO1a1yLDdiMbdiFvTiAn3EExxx7Er8695wxLuKyMa8Z+w9z3DTXHddxz9wPrOGxtTy1pufW9soa31hvuBW3aiECm4nAJtyqMbdqoGGvr2Gvy61qicAa3Koat6qiYa/MrSqKwHIisAy3KsmtinOrIhr2whr2ghr2fCIwt4Y9pwjMJgKziMBMIjC9CEwrAlOLwBQiMKkITCwCE3CruCIwlgiMIQI/naDI3yr2aEUfIRKHEtfgaWHd0FtV/Cs8+ofyRRrAFfEhPu5vXkRHTMRB/K+5KpIiBVIhTT/XgUz4HNkUIidyI69iFERhFFGU4iipKGVQXmEqorLiVEV1BaqJ2opUlzDqK1RDNFGsporVXLFaEltrBWurYO3R2cfdPd/b6187drDzhhljlPG+NfZE80wx5wzzz7Keeda3CEuteyXWuKZ12Oh6t2IHdmMffsJhr/2CE449jbPOvYBLxrpqzOvGvmGOP81115z3rf2RNfxtLc+s6aW1/WONYZ8U4bbcqjW3asmtmmvYm4rAJiKwIbeqz63qcqva3KqmCKyuYa/CrSpzq4rcqjy3KqNhLykCi4vAIiKwsAgswK3yisDcIjAnt8rGrT4XgZm4VTpulUYEpuJWyblVEm6VSATG51ZxuFVMERh9HNcao9gjFX2Y4n8TDkcaGA5F6J/trSr+2x8RB4d3vTuYKyIyoiAaYiD2IC6KhEiC5EiFzwZaPzIis0JkRQ7kRl4FKYBCKKIoxVESpRWmHCoqTmVUVaDqqKlIdVBPoRooVCM0UaxmhNJCwVopWBu0U7QOitYRXdDD3/t6foDjvnH8cOePMc44Y042/lRzzTTvHOtYYF2LrXU5Vlv/WmxwfZuxDbuwFwfwM47gmGNO4oxzzuGiMS4b65ox/zD2LXPcMddf5nxo7sfW8NRaXljTa2t7Y43hjtyqA7dqx63aiMBWIrAFt2rGrZpo2BtxqwYa9noisDa3qsmtqnOrKtyqsoa9oggsJwJLi8CS3Kq4CCzCrQpxqwLcKi+3ysWtcnCrrNwqM7fKyK3ScavPuFVKbpVMw56EWyXkVvFEYGxuFYNbRR2l2MMVfQjXcqHv9OdafTe+lcV/42NIqFikYaHQe0QbCPdjfIroiDWUeyIBEiMZUiK1daRFBmRGVmLPjlzIgwKKUghfoLj1lkRplFOciqisQFVRXZFqoo5C1UMDxWqEpgrWXMFaorWitVW09sTWUeE6KVxnYuumeL183M9zA70+1HEjnTfW+ROM9Z1xp5tjlnnnWcdCLLW2lda7Butcx0ZsxQ7Xuhv7cRCHPfcLTuC0Y8/ignMvGeMqfjfmTWPfNsddc9035yNzP7GG59byypr+sbawNYY7a9g7adg7isD23Kott2rNrVqKwOYa9qbcqhG3asCt6nGr2hr2mhr26iKwigisLAIriMBy3Ko0tyrJrYpp2L/gVoW4VQENex4Ney5ulV3DnkXDnplbZdCwp9WwpxaBKbhVMg17Yg17Am4Vl1vFEoHRReCnLvJjFxVE1Xv9NPK9X4Ui9Pxv/7fEiKNCZ/Vu4Q8QGZ8gGneMiTiIj0RIiuRIZS1pkB6ZkAXZiT4n8iA/CirOFyiGEtZdGuVQQYEqoyqqK1RN1HFN9dBAsRqhKeE1d40t0Ubh2ilce4X7Cp0JrQu6KWAPBeyNr/19sKIO8/oox3/rvEnGmWrMmcafY6755l5sLcuxyvrWWvMGbHY927ALe3EAh3AUx3HKMWdw3jm/OfcKrhvrhjFvGfuOOf4y10Nz/m3uZ9bwwlpeW1/I2sI9RGA3EdiFW3XiVl9xq/Ya9nYisA23asmtmnOrptyqkYa9gQisJwJrc6ua3Ko6t6rCrSpzqwoa9nLcqrQILKFhL6Zh/0IEFhSB+TXseURgThGYTcP+uQjMJALTi8A0GvZUIjC5CEzCrRJq2ONr2OModEwXFs2FfGLTI9voD2ymu7dQxG7b38rjv/LxbfiLd8zxXtDD+TMKoiI6YiMeEiCJKE6GlPgM6ZARnxN9NuRAbuSz1oIojKIooTilUBYVFKgSqqC666mJOqinWA0UqxGaormitXStbdBO4TooXCd0du1dFbC7Ava0B70Vsa8iDvDnN54b7rUxjhvvnMnGmGas74091xwLzbnUGlZY0xqss9aN1r8VO7Ab+13nQRz28S84gdM469iLzrmEq8b43Vg3jXnb2PfM8cA6H5nzibmfW8Mra3ljTeE+IrA3t+rJrbpzq64a9s4i8CsR2IFbteNWbTTsLTXszblVUxHYiFs14Fb1uFVtblWTW1XnVlVEYCUNewURWFYElhKBJURgURFYWAQWFIH5RGBuEZhDBGYTgZlFYEYRmE4EfiYCU2rYk4nAxIqdwEXFdSGxbFR0C49q0R/bzA99NrzXnWt1CYUidP7srUr+Cx873QlOCB1411wfIDI+QTTERBzEJ+5ESIoUSI20yIDM3DQrsiMX8qKANRdGURRHKYUqi/KopEhVUA01XVcd1EMDBWuEporWAq1cbxu0V7yOitcJXRSwmz3ooYi90Ech+9mP/sQ2UDGH+Hik58Y6ZoJjpzh3hjFmG2++sReZZ5l5V1nHWutaj83Wuw27XMteHMAhHMVxnPLaGZx37G+44tzrxrhhrD+NedfY983x0Fx/m/OZuV9awz/WErKm8Nfcqh+36qNh7yUCe3CrbtyqC7fqpGHvIALbicA23KoVt2rBrZpyq0Ya9gYa9noa9toa9poisJoI/JJbVRKB5blVWW5VilsVF4FFuFUhEVhABOblVrlEYHYRmFUEZhKBGURgWhGYWgSmcEFJXUQQQfFtbBwLjmmx0XwmfMJmI8vwD+T3u524VodN/3V3iFNC+SOZ7z18hCiIiuBONDbiISGSIDlSIQ0nTYdMyIJsyIk8yG/dhVAExVCSMMugPCriS8Wqhhqo7frqoYGCNUJTtFC4VmjrutujowJ2RldF7G4feipib/RVyK/tyQDFHKiY3xDaMH+O8tw4r01y7FTnzHTuHOMsMOYSc63AGnOvs5aN1rcFO6x7N/bjIA7jGE7iV5xzzEVcds415/5hjFu4Y8x7xn5gjsfmemrOF+Z+ZU1vrCU8mFsN1LAPEIH9uFVfbtWbW/XgVt1EYFcR2JlbdeRW7TXsbblVKw17CxHYVAQ2EoENuFU9EVhbBNbgVtW41ZfcqiK3Ks+tynCrktyqGLcqwq0Kcqv83CqPCMzJrbJxqywiMKMIDIqWxgWksvDkFpzEYhNaaFyfBbHZf/A1pU81sR9rXj90K/6eW/BI7dwhtvz8rVr+8x8Rp4W2v0vMHyAyPkE0xEQcxEciJEUKThq4aVpkQGZkRQ7ktu58KIgvUBQlCLQ0yqEiviTKqqiB2qjrOhugkaI1RXO0Ury2aO/6O6KzAnZFd6LrZT96o69i9lfMgRikmN9gKLENt09jfDzenk12zHTHznLePOMsMuYy468y3w/mXo/N1rTNOndhLw64jkM4iuM45bmzOI/fHHvVOddxwxh/GuuuMe8b+5E5npjrmTlfmvsfawlZS3got/pGBA7iVgO51dca9r4a9t7cqie36s6tunKrTiKwo4a9vQhsKwJbicDm3Kopt2rErRpwq7rcqpaGvQa3qqphr6xhr6BhL8etSmvYS3CrotzqCw17QW6Vj1vl5lY5RGBWxcts4RksOK3FprZxKSwyqc+ARNwqvgiMIwJjisBo7jY+cSsb+SuiaM+1WnOtFpveyuU/8/F9qHCk790J6us+wsccMypiIDbiISGSIDlSIQ3SI5P1ZkF25EJeFEBhFPUJUhylUBYVUNm1VUV11EJdhauPRmiK5orXEm0UsD06orO96IruCtlLIfugn73pr5gDMZjghtinYYo6QlFH2a+x/pzo71O8NsMxs50z3/mLjbPcmKvN8aP5NlrDFuywtt3Yb90HcRjHcBK/4pzXLuKyY6/hD+feMsYdY/1lzIfG/tuanprrhTlfmztkHeFR3GoEtxrGrYZo2AeLwIHcqj+36set+nCrnhr27iKwqwjsLAI7cqv2IrANt2rJrZpr2Jtyq0bcqr4IrKthryUCq4vAKiKwkoa9gggsq2EvpWEvLgKLaNgLcav8Gva8iprL4rNbcBYbkckC09ugND77UrH25Gw+iT4ioQiMJwKDf1aJIQI/7UQMHbhWG67VUq/V1B1i4/+CO8Q5odHvmP8DREbwD97REBNxEB+JkDS4U8VnSIeMyIxsyIngEyMfxy2EL1AMJVEG5V1bJVRBNdREHcKsj4ZoguYK2BJt0N4+dERnReyK7uilmH3sTT8MUNBB+EZRhyrqcPs1EqMVdizG2btJ/pzque+9PtexC5231BgrjfWDsdebZ5N5t1nLTuy1zgM4hKM4jtM4iwu45Jir+N05N5172xj3jHXfmI+M/cQcz831ypz/mDv8LVGN1bCP5lYjReBwETiUW33DrQZp2Ptr2PuJwD4isCe36s6tunKrztyqI7dqp2FvIwJbatiba9ibiMCGIrC+CKwjAmuKwGoisIoIrCQCy4vAMiKwpAgspmH/QgQWtPB8FpvbInNYXFYLy0z1GVlqWnYafK0ohQhMyq0SicD4IjCOCIwpAqOJwE/aEkWrcPj95uHwO03EYYO+b1Xzn3jMDyWKtCD05D3r+BAf41NCj47YiIfgn5aSIPiibSqkQXoEd7BZEPSGuZAXBVAYRVECpVHO9VXEl6iKGqhNqPXQAE3QDC0Jsw3aoaP96Iyu6K6YvdBHQfthgH0ahG8UdqjCjrBnozBGcb9V3PHENsEeTsY0f5/l+XmOW+T4Zc5bbYy1xt2ALebaYe7d2G9dB3HEmo/hJH7FOc/9hiuOuYY/nHPLuXfwl7EeGvNvYz8zxwtzvTZnyNzhCSJwvIb9W241mluN4lYjNOxDReA3InAQt+rPrfpxqz7cqie36q5h78qtOonADiKwnQhsw61aiMBmIrAxt2ogAuuJwNoisIYIrCoCK4vACiKwrAgsLQKDzS9qoYUtsICF5bUpuSg+O2vPwkqDrw2lF4FpRGAqDXtybpVEBCYQgXFFYCwRGL0dMbQmihbE0ZRrNeJa9W6EIzSM9lY9/38ei0NV3iHw9/ERoiAqYiIO4iMRkiL4p6bUHDYtMiAzsiEn8iA/CiFw4eKurRTKoAIqoQqqoxbx1kUDNEZTtCDQ1miHDvakE7qiO3opah/0U9QBGGy/hmCYwo4guFEYY//GKfAETLSPkzGF2Gb4c7aiL/D6EsetcM4aY6wz3iZjbzPfTuy1hgM4ZH1HcQKncRYXcMlrV/G7Y2867zbuGeOBsR4b84mxn5vjlbnemDM8hVtNFoETudV4bjWOW40RgaNE4AhuNYxbDeFWg7nVAA17Pw17HxHYU8PenVt1EYFficAO3Kott2rNrVpwq6YisDG3asCt6nKrWiKwOreqIgIricDyNr+MRZaysGIW9YUFFaL24G4qN7fKIQKzisDMIjCDCEwrAlNr2FOIwKQiMJEIjC8C44jAGCIwakuiaEYcjYmkAdeqw7Vq/KffeyvistCedwn9A0TGp4jOTWMhLhIgMZIjFdIgPTIhC7IjF/KigOsqjKIogdIoh4r4EtV8MtVEHdRHIzRBc4JthbZoj072pgu6o5ei9kE/DFDYwRhi34ZhpOKOxlgFHmcfJ2ASwX2n0FPt6XSFnom5Pl7o+aVeX+X4tc7dYJwtxtxujt3m3I+D1nIEx3ASZ3Aev+EKrjvmBv50zl3n3jfGQ2P9bcxnxn5pjn/MFTJneDq3msqtvtOwT9KwTxCB47jVWG41mluN1LAP07APEYGDRWB/EdiPW/XhVj25VTdu1YVbfaVhb8+t2nKrVhr25tyqCbdqxK3qc6s63Komt6qmAF9aXEWLCiKitE0o4bOsqM+uwtyqAFHlFYG5RGDwFewsIjCTCExPVGk07ClFYDIRmFgEJhCBcUVgLBEYTQR+0oQ4iOqDupr4Wpr46ivfyuc/8lgaShhpVeif96zrQ3yMqIiB4DtY4yEhkiIFUiMtMojy4J+gsiIH8iA/CiG40y2OUiiLCqjsk6kqaqA26qEhGqMZIbdEG7THV/anM7qhJ3oTZD8MwCDFHYJhGGkPRyvwWIxX5ImYbE+nKPQ0hZ6B7xV7NuZhsb8v99pqx/3onI3O32qcncbdY54D5j6Eo9Z0AqdxFhdwCde89gduOva2c+4594ExHhvrqTFfGPuVOd6YKzyLW33PrWaIwGkicAq3msytJnKr8Rr2sSJwtAgcKQKHcash3GoQt+rPrfpp2Htzqx7cqpsI7Kxh76hhby8C23Crlhr2Zhr2xhr2htyqroY92NQaFhVEQmWLqEDhZam7FOssLpe/4FaFRGB+EZhbBOYQgVlFYPCPuhmIKviWlNQiMLkITEJUCUVgPBEYWwTGEIHBT8x8XI9IaovDGuKwyutQhNIfvFXR/8NjbajOO9b2Pj7CJ8QfDTERB/GRGMkQfK/YZ0iHTMiC7Aj+SSovCqAwinLlEiiNcqiIL1ENNVEH9e1FIzRFC7RGO3Qk2s7oih7oTZR90R+D7N03GIaRCjwaYxV5PCba08mYqtjTFXsmZin4HPs8l9gWKPoSH6/w3BrHrHfsZudtN9Zu7DP+QfMdtoZjOIkzOI/fcAXXccMxfzr2rnPum/+RMZ4Y65kxXxr7H3OEzRWeq2GfIwK/51YzudV0bjVFwz5ZBE4UgeO51VhuNZpbjeRWw7jVNxr2QSKwv4a9r4a9twjsIQK7isBOIrCDhr2dCGwtAluIwKYa9kbBZlpQHQup6aKrmfxLyq7INsuJwNIisIRmr6g7mcIisIAIzCsCg3/EzSYCg29BySgC04nAz0RgSn1VMhEYfI95fBEYRwTGFIHR6ovDOkRSk1iqisPK4XCE8pXfquj//oi4PrT0XcL/AB/jU0RHLAQ/1JEQSZAcqZAGGZCZA2dFDuRGPhREEQRf/C2FsqiAyqiKGvahNuqhIZqgOVqhLToQdid0QXf0Ql9C7Y+B+MYeDsUIjFbksRiPiYo9GVPt73QFn4nZij7XXs/DAoVfZM+XKv4qH6/12gbHbHHODufvMd4B4x/CUXOewGnrOYuLuIxrnvsDtxxzx/F/4aFz/zbnU2O9MOZrY4fMEV7ErRaIwHncai63mq1hnykCp4vAqdxqMreayK3Gc6uxGvbRGvYRInCoCPxGBA4UgV+LwL4isJcI7C4Cu4jAr0RgBxHYVgS2sqHNLaaJi2ho8nomru0zKLgrqioCK4vACiKwrAgsJQKLicAvRGBBEZhPBOYWgTlEYFZ3gZlFYHoRmEYEpiKq5CIwiQhMIALjElUsERhdBH5aSxxWI5YvxWFFcVj2P/4TPZE46nsIfpw/CqIiBmIjPhIhKYLvx0+NdMiIz5ENwbf95EEBFEZRlEDp4Ot1qIgvUQ01URcN0BjN0AJtfPK1R0d0Rjf0RB8C/hoDMRhD7eUIjMJYjFfwiZis4FMx3T7PxGxFn4v5Cr/Ivi9W/KWKv9z+r/bnj57b5LVtjt3lvH3G+Ml4h81xDCfNfQbn8Ruu4Hfc9Npt3HPsfec8cu4TYzw31itjvjF2eDlRLeVWi7nVQg37fBE4l1vN4lYzudV0bjVVwz5Zwz5RBI7nVmNF4CgROIJbDRWBg0XgQG7Vj1v1EYE9RWA3EdhZBHa0ue0sorXJA6tvZtJGFF2fVdYRgTVFYDUR+KUIDL4SXW6CYnCrEiKwqAgsLALzi8A8/RVPBGYTgZ+LwIxElVYEphaBwU/CJCWq4Of44onA2CIwhgiMWp37VCGWSkRTThyWevFWRv+Xx7ZQy3c46/v4CFEQDTERBwmQGMmQEp8hPTK5vuA7X7MjN/KhIL5A8A/sJVEGFVAZVVEDtVEPDX3SBb1nc7QKPgERfCJ2Qlf04PS90Q8DMAhD7OdwjMIYjCPIiZis4FMxHd/b7zmYp/ALFH4Rltj/ZYq/AqvU4Qes9/Fmr2133G7H73fuz8Y6atwT5jqNs7hoLZdxzcd/4BbuOOYvxz50zt/OfWaMl+Z4bcyQscOrNOwruNUyEbiEWy3kVgu41TxuNVvDPlMETheBU0TgZG41kVuNE4FjuNUobjWcWw3hVoO4VX9u1VcE9uZWPWx8VwvoZOIOFt/WZ04rnzHNWXITdtyQWwVfu6ktAmuIwKoisJIILE9UZURgSREYfGvJFyKwoL4qrwjMJQKzi8As+qpMIjB9e0UWgSlFYDJ9VeJG3EUExhGBMWsQhwiMIgI/Kk80ZcRhSXeHxRu/VdP//oi4Mzz8XbH9AYJ3uPkU0RELcZEQSZAcwY+opUEGZEZW5EAe5EfwPWZFUBylUc4nWEV8iWqoiTqoj8ZohpYIetH2+ApdOH139EJf9MdAfGNPh2EkxmAcJhDoZEzFdMWfiTn2fR4WYDEBLCWA5VihFquJ4AciWKsmG/y51XM7vbbXcT85/rDzfzHWSWOfwXnzXsJV/I6bnruNe4554NjHznni3OfGeGWsN8YMr+VWP2jYV3OrFdxqObdaqmFfpGFfIALnicDZ3Gomt5rOraZq2CdzqwncapyGfTS3GsmthmnYv9GwD+RWX3OrPhbQ06TdTdbFRF9RcTsW2ZoFtxSBTblVI25VXwTWEYE1RWA1ERj8Y2xFEVhWBJYSgcWJqoi+qpAIzCcC84jAHPqqrJ0UVQRmEIFpiCqVviq5CEwiAhMQVVx9VSwRGJ2oPqlALGWJppQ4LEZYRfq9ldP//oi4J/wweJO3D/ExPkUMxPZJEg+JkBQpkBrpkBGfIxtyIi8KoDCKogTKoDwqoQqqozbqIfiicRM0t1+t0BYd0Ald0QN90A8DfKIOxlCMwGh8iwmEOwlTMB0ziXI25mGBGizGUiJYTgSrsEZNfiCEH7GeGDapzzZ/7vL8PscddPwR5x7HaeOdNcdFXMY13MCfuOu1+455iL+d88zYL43xj7FCxgyv51Y/cqsfuNUaDftKEbhcBC4VgYu41QJuNY9bzeJWM0XgdA37FG41SQSO17B/q2EfLQJHiMChGvbBNmqASftZZGDhPXx2dGWPnVhjBxHYVgS2csfQnKiaiMDgny/qisBaRFXdXWAVd4GVRGB5EVhGBJbQVxUVgYVFYAERmFdflVMEZhOBnxNVBn1VWhGYWgSmEIFJ9FUJ9VXxRGBsfVWMikRSjliI6sPihFVEn1XwzFs5vX0cCBePxGnfw0eIgqiIgTiIj0RIhpT4DOmRCVmQHbmRDwXxBYqhFMrakwqojKqoiTqoj0ZoipZog/b4Cl3QHb18kvZFfwzCEAzHKIwl+vGYiO8wDTPt/WzMxQJiXIylRLAcK7FGXdYSwjpsIIZNarSFILb7c4+/H/D8Icf94ryTxjhjzPP4zXxX8Ttu4rbn7nn9AR479qlzXjj3tTHeGC+8hVtt4lYbNOzrROBabrWGW63kVsu51VJutUjDvkDDPlcEzhKBMzTs00TgdyJwoggcLwLHisBRNnG4CYeYZJAJ+lNvX7bYi912F4FdRGBHEdhOBLYWgS1EYFMR2EgE1heBdYiqpgisKgIri8AKIrCsvqqkCCwmAr8gquAnWvKJwFwiMLu+Kou+KlML7iECPyOqlPqqZPqqREQVX18VR18VQwRGLU0sJYimKPEUDocj5eda+TO8VZXHT6ES77iG9xG8ReUniIZYCN6vKwESIzlSIQ3SIzOCH7jNgdzIj0IoguD7+ksj+I7ZivgS1VELdRH8w3xjNEcrn5TBF5M7oBO6Iriz7o2gZx2AwRiGkRgjGb7FBEzGVMzALDWYi/lYRJhLsRwriWEN1qrPOmwkiM0EsRXb1Wsnwe3150+eP+L144495byzxrlo3Mu4jhv4E3dx32uPHPPEsc+d89K5/xgjbKzwdg37VhG4WQRu5FbruNVabrWGW63UsC8XgUtF4EIROF8EzhGBs7jVDBE4VQROFoETRGBwkaNNMMJCh1LuYKodwA77icDeIjD4GkxXEdhJBHYQgW3dBbYSgc1EYGMRGHyLSF0RWEsEVhOBXxJVRREYfA94KRFYXAQW0VcVEoH5RWBufVUOfVVWEZiZqNLrq9Loq1KJwGT6qsT6qgQiMA5RxdRXRStJLET1EVG9X0CflZewcv7vwop4JLTtXdfyAYI31v0UwVtWxkI8JETw/l3JkRppkcEn1OfIhpzIgwIojKIogTIoj0qoihoIvjetHhqiCVqgNYJ/AuuIzuiOXuiL/hgkEYZgOEZhLMZjEqZguhp8jzmYh0VYQrDLsQpriHEt1qnTRmwmiq3YQRi71G03YezDz/5+1PMnHPOr48879zdjXcXv5rmJOz7+Cw+99rdjnjr2hXNeOzdkjPBuEbhLBO7gVlu51WYN+0YN+zoN+1oRuEYEruRWy7nVEhG4UATO41ZzROD3InC6CAwuapLBxxt0LMWOotbhbHWICBwkAvuLwL4isJcI7CYCO4vAjiIw+EfV1iKwBVE1cRfY0F1gPRFYWwRWF4FVhiiGCCwvAssQVQl9VVERGPxQZwF9VR4RmFMEZtNXZdZXZdBXpSWq4D2nkuurkojAhPqquPqqWCIwejHC+oJoiOqDvOIwlzjMvuCtrAjreOjwuz5RPsTH+BQxEBvxkAhJkQKpkQ4Z8TmC96DIhbwogC9QDCVRFhVQGVVRE3VQH8H3qjXj+C3RBu3xFbqiB3qjHwZgMIZiJMZgHIK0+E4NpmEmZmMuFmAx4S/DCqzBWuJch43qtQXbCGMHdhHHHvXbRxwHcMjHxzx3yjFnHX/BuZdx3Zg38Cfu4r7nHnn9CZ479pVz3jg3fEAE7uNWe7jVLm61QwRuE4FbuNVGbrWOW63lVqu51QputYxbLeZWCzTsc7nVLJsyw6BTDTiZWidQ6jg2OEYEjhCBQ0XgYBE4QAT2E4G9RWAPouoy3+aJwPYisI0IbElUwTeyNRKB9UVgHaKqqa+qKgIrE1UFfVVZEVhSBBbTV32hryogAvOKwFz6qmz6qs9FYEZ9VTp9VWoRmIKokuqrgvf5jEdUsfVV0YsQS0GiyUc8uQkrO2Fl+fE/qOpkKG6kk6G/3nNdHyIKgrcFj4E4iI9ESIaU+AzpkQlZkB25kQ/B2wcUQXGUQjlUxJeohlqoiwZojOZohbbogM7ohp7og68xCEOCO28Ed+BjMR6TMAXT8T3mYD4W+aRfihVYjR+wTr02YjO2EeRO7CaQvdhPJD+p5c8EcgTHfXza8+cc85vjrzr/d9zCHfyFh/jba88c89Kxr50Tcm74Z271E7far2HfKwJ3i8Cd3Gobt9rMrTZyq3Ua9h807Ku51QputVQELuJW8w06x2CB9U6n8imsdJIIHC8Cx4rAUSJwuAj8RgQOFIFfi8A+IrCnvqqrCAy+9aMDUbXVV7USgc1EYGOiaqCvqisCaxJVNX3Vl/qqir0Ji6hK6auCHz3/QgQGb5yRT1+VWwRmJ6os+qpM+qp0RPWZviqlviopUSXSV8XXV8UmqhiFiCU/YRHVhzn0WVkJK9ONUIRUH0SIcCqUMpJPmPcQ/GaMKIiGmIiDBAjegDcZUiEN0iMzsiIHgnfQyY9CKIISKI3gB3UrIfgRuOoIfrikHhqiCYLvtG2NduiILuiOXuiL4J/KBmMoRuhrR+NbTAx6XAS97kzMxjwsxBIsxyq1+gE/YgM2E+hW7MBuAtyLA2p5EIeI5AiR/KKuJ/x5xnMXvH7ZsdecewN/4i4e4DGeeu25Y1459o1zwr9wqyMa9kMi8KAIPMCt9nKr3Rr2HRr2rRr2zSJwgwj8UcO+RsO+SgQGi11ioIUGmUehs1nfTBE4TQROFoETROC3InC0CBwhAoeKwMEisD9R9dVX9RKB3UVgF31VRxHYzl1gaxHYXF/VRF/VcLhNF4G19FXV9VVVRGBFfVXwo+alRWAJoiqiryqkr8pPVLn1VTn0VVmJKpO+Kr2+Kg1RpdRXJdNXJSaq+PqqOPqqmEQVNQ/R5CSerESUWQOfXp+V+eMIEX4LpX6HG7+Pj/AJoiEW4iIBkiA5UiF479QMyIxsyIk8KIDCKIoSKIPyqISqqIHaqI9GaIqWaIP2+Apd0AO90Q8D8A2GYSTGYDwmYQqm43sEve98NVqEpViB1ViL9diErYxhB3ZhLw4Q60EcUtejOEYsx4nllBqf9fFFz13x+u+OveX8O/gLD/G355557aVj/nFsyDnh4yLwGLc6wq0OcauD3Gq/CNwrAneJwB0icKsI3CQC14vAtRa92iArTLqUshexzvncao4I/F4ETheBU0TgJKIaLwLHiMCRIjD4x9Fv9FUDRGA/EdhbBPbQV3WZZhNFYHuiaqOvaqGvaioCGxFVfX1VbRFYg6iq6qsq6avKE1UZfVUJfVVRoiqsr8qvr8pDVDn1VVn1VZmJKoNmPXj34VRElVyznlhflYCo4uqrYuqrgt9d80k24vmciDJo4NMSVqpPI0S4GBr/Dlf+AJHxCaIjFuIiIZIgOVIjLTLic2RDLgRvKlcAX6AYSqIMKqAyqqIm6qA+GqMZWqItOqATuqEn+uBrDLL/wT/0D8cojMUETEbw9cQZmIV5WIglWI5V+AHrsJExbMF27MIe7MdBKXQIR9X3GE4QzCmC+VWtz/nzkr9f8/oN/On4e3iAx3jquRd47Zg3jg3/yq1OcasT3OoYtzqiYT/ErQ6KwP0icA+32iUCt4vALS5so5PXOTGw1FUsbzmrXCJLF4rAuSJwlgicIQKn6qsmbyIsEThWBI4SgcP1VUMWi0MR+LUI7KOv6iECu4rATvqqDvqqNiKwJVE101c1FoH1RWAdfVVNfVVVERi8IUYFfVUZfVVJzXoxfVVhfVUBzXrwdorB+3Vm06x/rq/KQFRpNeup9VXJiSqJZj2BviouUcXKRSzZiYaoImckrLSElZqwUo6PEPFKaPy7rvcDRManiI7g9/zEQ0IkRQqkRjpkxOfIjlzIh4L4AsH7gZVC8E47FfElqiF424G6CH6gtzGCH5VrhbboiM7ohl7oi/4YjKEYgeAf/sdhIr7DNMzEHMzHIkawFEFPvBo/YgMCg9iGndiNfVLoJxzCURxT5xM4TYRncI5wLqr7ZR9f9/xNx9zBX859hCc+fo6XXvvHMWHHhs9xqzMa9lMa9hPc6hi3OsKtDnGrn7jVPhG4m1vtMMBWEwQWup7drWV1q0XgChG4VAQGXyOZLwJni8CZInAaUX0nAieKwG+JKvgWjhEicKgIHERU/fVVfUVgT6Lqpq/qrK/qSFRt9VWt9FXNiaoxUQU/Ql5XXxW8AUY1fdWXRFWBqMrqq0oRVTGi+kJfVZCo8mrWc+mrshPV55r1jPqq4A34U2vWU+irkhBVQs16PKKKRVTRsxANUUVOR0SfEVYKfVZSwrpOWD6ZPsDH+BQxEBvxkAhJEfxGjc+QDhmRBdmRG/lQEEVQHKVQDhURvPNOddRCPTREEzRHawQ/OvcVuqA7eqEfBmAwgu99G4kxGIdJmILgn9hmYS4WYDGWYRV+QNAjb8QWbMcudd2LA/gZR3AMJ7Q8p3EW5wn0otpfIpyr/vzD3//0/D3HPcBjPMULz732Wsgx4Usa9osi8LwIPMOtTnGrExr2Y9zqCLf6WcN+wAL2OmEXJW5nj1vY4kYRGNxV/CACV7oLXCYCF4vABSJwDlF9LwKDf/ScQlST9FXjROAYEThSBA7VVwXfNjtABPbTV/XSV3UXgV30VR31Ve30Va2/scn6qiZE1ZCo6uqrahFVdc36l/qqikRVVrNeSl9VnKiKaNYL6qvyEVUuzXp2fVUWosqoWU9HVKmJKoVmPam+KqFmPZ5mPTZRRc9ENOmJh6g+SOnOMClhJSKsbceOvcupP8THiIoYiI34SIRkSInPEPyGjUzIghzIjXwohCII3iKzNMqhEqqgOmqjHhqiKVqgNdrjK3RBD/RGPwzENxiGUQi+F248gu8ymYoZ6jUr+FcRLMQSrMBqrMV6bMI27MAe7MdBHMYvWp7jOIUzOM9ULuIyDVzBNQK64c87nvvL64+c8wTPffzKc2+8Fr4mAq9wq8vc6iK3Oq9hPyMCT2nYj2vYj1roIQcfpMT91LqbvQWN3lYRuEkErheBa/VVq0TgchG4RAQu1FfNE4Gz3AXO0FdN1VdNWuniRWDwXYwj9VXD9FXfENVAfVU/fVVvouqhr+pCVF8RVTt9VWuiaqFZb6qvaqivqqdZr6Wvqk5UVTTrFfVV5YiqtGa9uL6qCFEV0qznI6rcRJVds56FqIJfE5JOs/4ZUaUkqqSa9UREFU+zHpuoYhDVp2mIh6g+TEZYicPHIsY6FiGi638PHyIKoiIG4iA+EiMZUiIN0iMTsiIHciM/CqEoSqA0yqMSqqAGaqMeGqEpWiJ4e4L26ISu6IE++BoDMQTDMQrfYgImYxpmYjbmYxGWYgXW4EdswGZsxy7sZR4HAgNBYCTHcBK/4hwuSqzLuIrr9HCDiG7hro8feP1vPMNL/OO5kNfCf3Cr69zqKre6LAIvisBzIvBXEXjSQMeoMLDGn1nbARG4VwTuEoHbROBmotqgr/pRBK4RgStE4FJ91aKthCUCZ+urgu/7mSoCJxPVBH3VWH3VKKIarq8aQlQDieprfVVvouqhWe+qr+pEVO0168EbW7QgqqZE1UizXo+oamvWaxBVFaKqpFkvp1kvTVQlNOtFiKqQZj14Y/3cRJVDs56VqDIRVXrN+mdElZKokmnWExFVfHeAsYkqBlFFTUVYRPVhYmJKEA5HjBOOEMkn13v4EFEQFcGvF46D+EiMZEiFNEiP4PcDZUUO5EF+FEbwNuQlELzBb3lUQlXUQB0E7yPWCME79LREG3RAJ3RDT/TB1xiEIRiB0fgWwXfyfodp+B5zMB+LsQzBP8X9gHXYiC3YgeCOfx9+wmH8ghM4jbO4ILUu4Qqu4wZu0cZtgvzLn4/8/Qme4xXeeC58m1vd0rDf0LBfF4FXROAlERgMdpb6TlPeCbZ2lKgOach+EoH7ROBuEbhDBG7RV20UgetE4BqiWqmvWiYCFxHVfH3VHBE4k6im6au+01dNIKpv9VWj9VXDNetD9FWDiOprzXoffVXwo+BdNeud9FUdiKqNZr2lZr0pUTXSrAfvVFfbHWANzXpVoqpEVOU166WJqoRmvahmvRBR5des5yGqHO4As2rWMxFVeneAaYgqJVElcweYmKjiuwOMQ1QxiCpqcuJJQkRE9V7ccDhSTMLySfYePkIURENMxEECJEbwizxTIQ3SIzOyIifyID8KoyhKogzKozKqIngrzTqoj8ZohpYI3rGnAzqhG3qiL/pjEIIfuRuBMRiHiZiC4Dt7v8ccLMBiLMcqKfQD1mMTtmIH9mA/DuIIjuEkfsU5/IYruIYbuEUft3GP+dzHYx8/8/xL/OPjsOfCd0XgbW51i1v9IQKvWcAVL1ykxnMs7VcReFIEBncHh0XgQRG4XwTuIaod+qqtInATUQX/ePmDvmoVUS3TVy0mqgVENUdf9b2+ajpRfadZn0hU44hqtGZ9BFEN0awP0qz3J6q+mvWemvVuRNVJs95BXxW8t1NLzXozomqkWa+vWa9DVDU061WJqhJRldeslyGqkkRVVLNemKjyuwPMQ1Q5iSqrO8DMRJXeHWAaokpFVMncASYmqvjuAOMEvyGeqKISVRSi+oio3otFWNEIi4O/h48QBdEQ/Mb9uEiAxEiOVEiLDMiMrMiJPCiAwiiKkiiDCqiMaqiJOmiAxmiGVmiLDuiMbgjeG6Mv+mMwhmIkxmAcgh9umYLpmIW5WIAlWI7VWIv12Ixt2Ingi+AH8DOO4jhO4Qwu4BKu4nf6uInbuIf7eMiInuCFj18j5OPwQ251n1vd41a3udVNT/5OcVdZ2SUReD5o3IjqlL7quAg8IgJ/JqrgK7J7ROBOotqmr9qkr1pPVGv1Vav0Vcs160v0VQv0VXOJapZmfTpRTdGsT9SsBz/PNkazPkKzPpSoBmnW+xNVX6LqqVnvRlSdiaqDZr0tUbXSrDcjqsZEVZ+o6hBVTXeAVYmqMlGVdwdYhqhKElXwu2QKE1UBd4B5iConUWV1B5iZqDK4A0xDVKmIKpk7wMRElYCo4hBVTKKKmpB4iOojonovOmF9Qlg+4d7HR4iCaIiJuEiA4JelJ0cqpEUGZEY25ETw284KoDCKoSTKoAIqoxpqoi4aoDGaoRXaoiM6oxt6oS8GYDCGYiTGYDwmYQpmYBbmYiGWYAVWYy02YDO2YRf24iccwlGcwGmcxQVcxjX8gcCA7uI+HuJvPflTvPTxPwg/Jaq/udVDDft9L9yhtlus7A8ReE0EXhaBF/RVZ0Vg8DWM40QVfAX2kL7qAFHt1Vft0ldtI6rgWyw26KvWEtVqzfpyolpCVAs163OJKvgJkOlENYWoJmnWxxHVGKIaQVRDiWqwZn2AZr0vUfXSrHcjqs5E1ZGo2hJVK3eAzYiqsTvA+u4A6xBVTXeAVYmqMlGVdwdYhqhKVlQ8d4CFiaqAO8Dg9/flJKpsRJWZqDJkJyyiSkVUyYgqMVElSEFYRBWTqKLGIx6i+oio3v+EsCITFjd/Hx/hE0RDTMRFAgS/iT85UiEtgl9LnBnBL/zMibwogMIohuD3CpVFBVRGNdREXTRA8MbAzdEKbdERndEdvdAXAzAYwzASYxD8APEkBD+aNwOzMA8LsQTBdwCvRvC9dRuwGdsRfKPBPgT/hHcIv+AETuMcgq8UXEbQg99AkG738ACP8RQv8BohhF9o2IMnH1PZAzZ3l6j+1KjdEIFB1x/cVl68anCiOh185VVfdZSoDh2zCH3VXqLapVnfRlSbiWqDZv1HolqtWQ++Z3oJUS3UrM8jqlnuAGcQ1RSimqRZH0dUY9wBjtSsDyWqwUQ1gKj6ElUvd4DdiapzD5tKVG2JqpU7wGZEFbyldAOiqkNUNesRFlFVJqoK7gDLElXwG6+KEVVhoipQRFGJKmc+RSaqzESVIQthEVWqdMRAVImJKkFSwiKqmEQVLTbxENVHnxJTZML6gLB8Ar6Pj/AJoiEm4iIBkiA5UiMtMiAzsiEngl8AWgCFUQwlURYV8CWC3+BRE3XRAE3QHMEbBbdF8BacndEdvdAXAxC8088wjMRYjMckTMUMBD+qNw8LsQQrsBo/YgOC77Xbjl3Yh59wGME/6Z3AaZzDRVzBddxE0JPfQ5B2f+M5XuENPYXf+OClCHwmAv8mqof6qqARC7r8G0R1XV91JfhimL7qHFGdJqoTmvVfiOoQUf1EVHuJapdmfTtRBd9luEGz/iNRrSaqFUS1hKgWEtU8oprlDnAGUU0hqklENZ6oxhDVSKIaSlSD3QEOIKq+RNWLqLoTVeeuNpWognf5Dd5CujlRNW5q84mqDlHVrE1YRFWZqCoQVVmiKlla8YiqMFEVIKrgV9jmzK3IRJWZqDIQVRqiSvUZMRBVYqJKQFRxiComUUUjqk+I6qOPiekDwnqXsMJvwu/jI3yCaIiJuEiAJEiO1EiLDMiMbMiJvCiAwiiGkiiLCvgS1VATddEATdAcrdAWHdEZ3dELfTEAgzEMIzEW4zEJUzEDszAPC7EEK7AaP2IDtmA7dmEffsJh/IITOI1zuIgruI6buI17eIi/8RyvEPwXDonA1yLwRZCPIvARt7ovAu+IwFv6qj9EYPCV1Uv6qgsi8Iy+6pS+6rgIPKKv+llftV+zvkdftUNftVUEbtJXrROBwU92rNJXLdOsL9ZXzReBczTr3+urpmnWv9OsTxCB32rWR+urhrsDHKJZD95Z7mt3gH006z1EYFfNeid9VXt3gG30VcEb3zfVrDfUV9VzB1hbs169ajhcxR1gJX1VOX1Vac16cX1VEXeABTXr+URgbs16Dn1VFneAmTTr6dwBfuYOMKW+KmnicDiRZj1enHA4dsxwOHq0cPhTEfjxR+HwB++Hw+9GCoT1irBeEdYrwnpFWK8I6xVhvSKsV4T1irBehVMhLTIgM7IhJ/KiAAqjGEqiLCqgMqqhJuqiARqjOVqhLTqiM7qjF/piAAZjGEZiDMZjEqZiBmZhHhZiCVZgNX7EBmzGduzCPvyEQ/gFJ3Aa53ARl3EdN3Ab9/AAj/EUL8Ivw68RQvgNt3qlYX8edPUa9kca9r807HcI6xZh/R582Z6wgn9sPE9YwbdKnHQXeIywjhDWQcLaT1i73QXucBcY/CTHRsJaR1g/ENZKwlpGWMGPas8nrDmENZOwphHW5HHERVjfEtYowhpOWEMIayBhfU1YvQmrB2F1Iazgje7bE1abZsRFWE0JqyFhBb/JqhZhBb+HrwphVSSscoRVirCKE1bwi7YLElY+wspFWNkJKwthZSSsdIT1GWGlIKykhJWQsOIRVuyoxBWFuAgrMmF98C/Cek5YzwnreTgKoiEm4iIBEiM5UiEtMiAzsiEn8qAACqMYSqIMKqAyqqEm6qABGqMZWqEtOqIzuqEX+mIABmMoRmIMxmMSpmAGZmEuFmIJVmA11mIDNmMbdmEvfsIhHMUJnMZZXMBlXAs/C/+BW7iL+3iIv/HUfy/9+Q9YlS6eWwVfe3gmBv8Wgw/F4D0xeNudYPCPi79fEIlnw+HfCOv88XD4V8I6+TNxHZDHhHWQsIKf3NhNWDvWi8S1xEVY65aH/+VHs1cS1tK54fAiwpo/PRyeTVgzCWsaYQXvHDdhhP6AsEYR1vD+4fA3hBW8NXS/bsRFWD0IqwthfUVY7QmrNWG1qK8PIayGhFWPsGoRVvXy+pUyxEVY5QirFGEVJ6wv8hAXYeUjrFyElZ2wshBWRsJKl0xfRFgpCCspYSUkrHiEFYuwohPWp4QV+V+E9Xf4PXyEKIiGmIiDBEiM5EiFtMiAzMiKnMiDAiiMoiiJMqiAyqiKmqiDBmiMZmiFtuiAzuiGXuiL/hiMoRiJMRiHSZiC6ZiFuViAJViO1ViL9diMbdiJPTiAn3EEx3EKZ3ABl3AVv+MmbuMu7vOsh3iC5/7+Gm98HA4R1WuiesGtnorBx+4EH2ja7wb/uKi/uqG/uq6/Cr6h6yJhndNf/UpYJwjrF/3V4Z36LcLap7/aRVjbCSv4UewNhPXjYuJaoN8irKWEFbzX0jzCCt4pbgZhTSWsyYQ1nrDGDiIuwhpGWN/01G8RVj/C6t1Bv0VYXQgr+E1V7QirNWE1J6wmNYiLsOoSVi3CqkZYXxJWxaL6LcIqRVjFCesLwiqYlbgIKxdhZSeszwkrI2GlJazUhJWCsJIQVkLCikdYsQgr+nv6rX8R1iPCekRYjwjrEWE9IqxHhPWIsB4R1iPCekRYj8JpkB6ZkRU5kQf5URhFURJlUB6VURU1UQf10RjN0BJt0QGd0A090Rf9MQhDMQJjMA4TMQXT8T3mYAEWYzlWkcEPWI9N2Iod2IP9OIgjOIaT+BXn8Buu4Br+EIK3cBv3SCv477GPA/96iX98rLHiWkT1iqiec6u/udUjbnWfW90Rg8E3cP3xazh8zd3gJY37hcPh8FmN+2mN+3HCOqpxP6Rx/4mw9mrcd2nctxNW8AYSGwhrLWGt1riv+F4zT1gLvyMuwppFWDNGa+YJa5LGfTxhjSGs4A3shxHWYMIa0Im4CKsXYXVvqZknrI6NiIuwWhFWc8JqQlgNKhEXYdUkrODX/39JWBUIq2x+4iKsYoT1BWEVIKy86YmLsLIR1ueElYGw0sYnLsJKHoO4CCshYcUlrFiEFe1fhPUXYf0V/hBREBUxEQfxkRjJkAppkB6ZkRU5kAf5URhFUQJlUB6VUBU1UAf10QjN0BJt0AGd0BU90QdfYxCGYARG41tMxHeYhu8xB/OxGMuwEmuwDhuxBTuwG/vwEw7jF5zAaZwlnwu4hCu4zqtu4Fb4DnHd8cwdcrrLte5xraD7usu1xF+IqF4T1QuiCr7l4bGm/QG3uicGb4vBm2Lwd251VQxe0l+d11+d2aeZ301chHVE4x78yPUBwgreMGKnO8JthLXJHeF6d4RrCSt4R7jl7giXENYCd4Rz3RHOIqzp7ginEFbwhvXj3BGO6RMOjyCsoe4IBxNW8Bup+rYhLsLq5o6wM2F1JKy27ghbEVYzwmpMWA0Iq447wpqEVY2wKhciLsIqS1glcxAXYRXORFyElZewcqYkLsLKTFgZCCstYaUirOSElYSwEnxIXIQVi7Ai2qT38CGiICpiIA7iIxGSISXSID0yIStyIDfyoxCKogRKozwqoQpqoDbqoRGaoiXaoD06oSt6oA++xkAMwXCMwreYgMmYhpmYjXlYhKVYgTX4ERuwGduxC3vJ5AB+xhEcw0n8inO4GP5Tr/WnSLxFXLc4103/v/kvEnvg+ceOeYaXPv7HcyGvhd8Q1Suiei4CnxDVI251n1vd5VZ/cqsb3Oq6GLwiBi+KweCHFH8Vg8GPWB/TXx3RuB/UuO/XX+3RuO9YqpknrOAd4NbN1swT1qqpmvnJmnnCCt7iee4od4qENZ2wpgwMhycS1rje7hR7EBdhDf0qHB7UPhzuT1h9WoTDPQmrG2F1qhf+l1+Q3bZ6ONyyCnERVuNy4XB9wqpDWDWLhMNVCasyYZXPHQ6XIayShFWUsAoTVoHPwuE8hJWTsLImIi7CyhA7HE5DWKkIK/nH4XBiwkpAWHEiElbo5rF3bdSH+BhREQOxER+JkAwp8RnSIROyIAdyIx8KoQhKoDTKoRKqoDpqox4aoilaoDXa4yt0QQ/0Rj8MxDcYhlEYi/GYjKmYobCzMA8LsQTLsRprsR6bsBU7sAf7cRCH8QtfOo5TOIPzpHQRl3VaV3CNvG7487bn/vLRIzzBc7zy3BuvhUPi7x9OFXzX3zOi+ltv9VBv9Zfe6g63usWt/uBW18TgZTF4gVud5VanxeAJMfiL/uqQ/uonMbhPf7Vb475d476FsDbqr9a5I1xDWCs17svG67cIa747wjnDNPPfaOYJ67t+mnnC+pawRnfRzBPWkHbE1dqdImH1IayeDcPhroTVqRZxEVYbwmpZ0Z0iYTUirPrFw+HahFWDsKrkC4crEVb57MSVJRwuQVhF04XDhQgrP2HlSRoO5yCsrPGIi7DSE1aaT8PhlISVjLASvxsOxY94jLCuj3/XJn2Aj/EpYiA24iERkiIFPkM6ZEQWZEdu5ENBFEFxlEI5VMSXqI5aqIuGaILmaI12+Apd0B290A8DMBjDMBJjMA6TMAXTMQtzsQCLsQwr8QPWYSO2YDt2EcpeHMDPOIJjOEFCp3CGV53HRbK6RF5X/fmH///ptbuOe4DHeIoXnnvttZDjwm+I6jVRvSCqp0T1mKgenBCJ3Oq23uomt/qdW13lVpfcDQZvBHFGDJ4Sg8fF4FExeEgMHhCDe/VXu/RX28TgZv3VBv3VWo37Gv1V8Eb0SzXuiwhrnsZ9tjvCmQM08/qrye4IJ3TXzBPWKHeEwwnrG437wObE1UQzT1jBr/HvSlhfEVb7L4mLsFqUJa5SmnnCqvcFcRV0p0hYVXIRF2GVI6zSGYmLsIqkJq4UxEVYuRMSF2FlIaxM0YmLsD4jrJQfEBdhJYo4nrCuENZVwroajoxPER2xEQ8JkRQpkBrpkBGfIztyIS8K4gsUQymURUV8iWqoibpogMZojlZoi47ojG7ohb7oj8EYihEYjXGYiO8wDTMxB/OxiBCWYgVWYy02YBO2Yid2Yx8x/IRDOIJjZHQCp7TwZ8jqHC7477I/r3v+po/u4C/nPsITHwdfoHjptX8cw4a4lvh7SVTPiOoJUT0iqvsi8C63Cn50+obe6jq3usKtfuNW57jVr9zqJLcK3tntiBj8WQzuF4N79Fc7xeA2MbhJf7Vef7VWDK7SXy3XXy3RuC8Ug/P0V7M07jMIa6r+apLGfbw7wrH6q5Ea9+AXX39DWAPcEfZrQFyE1b2mO8VqxOWOsF0Fd4qE1YKwmhQjLsKqR1i18hIXYX1JWBU/Jy7CKpXWnSJhFSGsgkncKRJWbsLKHou4CCsTYaWLTFyElfKdcCgpYUUIXRz/jk36AJHxCaIjFuIiIZIgOVIjLTLgc2RDLuRFARRGMZREGVRAZVRFTdRBfTRGM7REW3RAJ3RFT/TB1xik2EMwHKMwFhMwGVMxA7MwDwuxBMuxCj9gncJvxBZsxy7swX5iOIhDOMKnjpHTCZzSyv9KXuf8ecn/r3nthmP+dM49PMBjPPXcC6+9dswbx4ZDeqrXRPWCqJ4S1WOiekhU90TgbRF4y53g79zqmt4qeC+kC9zqLLc67W7whBj8RQwe5lY/cat9c0WiGNwhBreKwU36q3Vi8AcxuEp/tUx/tZiwFojBufqr7zXu08XgFP3VRI37OMIao78aqXEf6o5wMGEN0Lj3dUfYi7C6a9w7E1ZHwmrnjrBVSXeKhNXEHWGDAu4UCauWO8Jq2YjLHWHFDJp5wipFWMWSu1MkrIIJNPNx3SkSVnbC+vyTcDgjYaV7350iYaWMEAjrAo2dD7+Pj/AJoiEW4iIBkiA5UiENMiAzsiEn8qAACqMoSqAMyqMSqqIGaqM+GqEpWqIN2uMrdEEP9EY/DMA3GIaRGIPxmIQpmI7vMQfzFXkRlmIFVmMt1mOT4m/FDuzCXuI5gIM4REpH3B8ew3HSOqWlP+vji56/4vXf/e2WMe7gLwRfoPjbc8+89tIx/zg25JzwGz3VK6J6TlRPiOoRUd0nqrsiMHh7mhsi8Dq3usKtfuNW57lV8P6Tp7jVcW51lFsd4lYHxOBeMbhLDG4Xg5vF4EYx+KMYXCMGV+qvlumvFonB+fqrOfqrmYQ1TQx+p7+aqHEPfj3/aP3VCP3VEI37IP1Vf417H3eEPQmrm8a9szvCDoTVVuPeyh1hM8JqrHFv4I6wDmHV1LhXI6zKhFXBHWGZVJp5wirmjvALwipAWHljauajuVMkrM8/0swTVlrCyhzhY8I6lTKSTXoPHyEKoiEm4iABEiMZUiEN0iMTsiIHciM/CqEISqA0yqESqqA6aqMeGqIJWqA12qEjuqA7eqEv+mMwhmKEIo7Gt5iA7zANMzEb87AQS7BcsVfhB/yIDdhMMluxA7sJYS/286mDOERSR0jrF/+d8OcZ/7/g9cuOvebcG/gTd/EAj/DUa88d88q5b5wTDmnUX+upXhLVM6L6m6geEtVfIvCOCLxFVME7tl1zJxi83+RFvdU5bvUrtzrJrY5p2oM3lP9ZDB4Qg3u41U5utU0MbhaD68Vg8PvuVnOrFWJwiRhcKAbn6a+CX2g9UwwGv45/sv5qgsZ9rBgcpb8arr8aIgYH6q++1l/10bj30F911bh30rh3IKw2GveWGvdmhNVI417fHWEdwqqhca/qjrASYZXXuJdxR1iSsIq6IywcR79FWHncEeaMQlyEldkdYYZI/5uwLsSOFDp59z0b9SGiICpiIA7iIxGSISU+QzpkQhZkR27kQ0EUQXGUQjlUxJeohpqoiwZojGYK0wpt0QGd0Q090QdfYxC+wXCMwliMxyRMwXQi+B5zMB+LsBQrsFrRf8A6bFT8zdiGnQS0G3vDR4nriJ7riIb+sP8f/heJnfb8Ocf95m9X8buxbuEOgq+APfRc8PX7Z4556djXzgmRZ/iNRv2Vnuo5UT0lqkdE9YCo7onA20R1k6h+F4FXReAlorpAVGe51WludYJb/cKtDnGrg9xqP7cKfkPUDjG4VQxuEoPruNUP3GqVGFwuBoNfYL1AfzVXDM4SgzPE4BT91ST91XgxOEYMjtRfDSOsb8TgQP1VP417b8Lqob/qor/6SuPeXn/VWn/VQuPeVH/VUH9VT+Nem7BqaNyruCOsRFjlNe6l3RGWIKwiGvdC7gjzE1ZujXsOd4RZ3wuHMkW8HkoV4T+8g3LE0PHD79qoD23Ux/gUMRAb8ZAISZECqZEOGfE5siMX8qIAvkAxlERZVEBlVEVN1EF9NEIztEQbtMdX6IIe6I1+GIDBGEoIIzEG4zAR32EaZmIW5iryAizGMqzAGkVfi3XYSDhbsI0IdmAXOe3hWftI6wAO+fiY50766Kzjgg7ssjGu44bx/8RdH9/HI689cUzwL5CvnPPGuaxGI69RD97T6Jn4+5uoHhLVfaK6S1R/EtUNERi85fIVEfibO8Hz3OqM3uqU3ir4nSpH9VY/c6sD3Govt9rFrbZzqy3caoO7wXXuBteIwZVicJkYXCwG54vBOWLwezE4XQx+p7+aKAbHicEx+qsR+quhYnCwGBygv+qrv+pFWN31V130Vx0Jq53+qrX+qjlhNdFfNdS419W419JfVddffalxr0hY5TTupTTuxQmriP6qkMY9H2Hl1rhnd0eYJeLbNwXxiBg6svJdG/UBIuNTREcsxENCJEFypEZaZMDnyIacyIMCKIyiKIEyKI9KqIoaqI16aIgmaIHWCtQOHdEZ3dALfdEfgzAEwzEKYzFeQSdhCqbje8zBPEVeiCVYjpUKvgZrCWcdNmIzAWzlVTuwi6x28659+Nnfj3rthGN+dc55z/xmzKv4HTdxG395/iEeO+apY18457VzQ8YIh7jUa6J6oad6Kv6C95F8QFTBu+DeIapbIvCPlSKRqC4vEYki8JwI/JVbnRSBx7jVEW4V/B67/dxqD7faya22ado3i8ENYnAtt1rNrVZwq6XuBheJwflicLYYnCkGp4nB78TgBDH4rf5qtP5qhBgcIgYH6a/666/6iMGeYrCb/qqz/qqjGGyrv2qlv2pOWI31Vw30V3UJq6b+qpr+6kuNewXCKqu/KqVxL0ZYX+ivCmrc8xJWLv1V9giT38rKI/RTiXds1PuIjE8QDTERFwmQGMmQCmmQHpmRFTmQG/lRCEVQHKVtfDlUxJeohlqoiwZojGZohbbogE7oih7ojX4KNwCDMRQjMBrfYgImK+pUzMD3mIv5irwQS7GcZFZijaKvxToetRGbyWkrWW0XjMF/e338k+eO+OiY408596yxLiL4AsU13MCfuOu5+3jkmCeODb5/4qVz/zGG7OJaXOoVUT0jqidE9Yio7hPVXU51m6huiMDrIvAqUf0mAs8T1VkReIpbBb+37hdudYhb/cSt9nGr3dxqB7fayq02cat13OoHbrWKWy0Xg0vE4EIxOFcMzuJWM8TgVDE4SQxOEINj9VejxOBwMThEDA7UX30tBvuIwR76q676q05isL3+qo3+qqX+qhlhNdJf1ddf1SGsmvqrqvqryhr3CvqrMvqrkhr3YoRVWH9VQOOel7ByRvg/vKNfaF+RSKH9ofds1EeIgqiIgTiIj0RIhpT4DOmRCVmQHbmRDwXxBYqhFMqiAiqjKmqiDuqjEZqiBdooUDt8hS7ojl7oi/4YhCEYroijMBbjMRHfYRqxzMRszMUChV6EpYq9HCuJZw3WKvw6ctqATUJxC3ltxx7/P/A2IIMO7KRnfsV5Y/+Gq/gdN3Eb97z2AI8d+9S4L5wbfAfYG2OFQ1u4lru/F0T1lKj+JqqHnOovorpDVLeI6g991TUReFkEXhSB54jq12lc6zuu5U7wiDvBn90JHuBWe7nVLm61nVtt0bRv1LT/qGlfo2lfKQaXcavF3GoBt5rjbvB7MThdDE4Rg5O41Tj91RgxOFIMDhODg8XgADHYTwz2FoPd9VddCOsrMdhef9Vaf9VCf9VUf9VQf1VPf1VbDNbQX1XRX1UirPL6qzL6qxIa96L6q8L6q/yR3oRyR0j3VlX/4RExvOfhezbqQ3yMTxEDsREPiZAUKZAa6ZARnyMbciIvCqAwiqIEyqC8za+EKqiOWqiHhmiC5miFtuiATuiKHorcG/0wAIMxFCMwWjG/xXhMwhSFnY6ZmKXA87AAi4hnKZYr+EoyWo0f+NWPZLWedwX/bfPxLs/vc8xBfztijOM4bdzgCxTBV8Au4xr+wJ+447Xgn7iD758IvkHnmXNfGuMfY4WMGX6znmu5+3uuUX/CqR4R1QOiukdUt4nqJlH9TlRXieqSCLwgAs8S1WkReEIE/iICD3Org9xqP7faw612cqtt3Gozt9rArdZyq9XcagW3WsqtFmna54nBOWJwJreaxq2+41YTxeC3YnC0GBzBrYaKwcFisL8Y7CsGe+mvuonBzmKwoxhsp79qLQabi8Em+quG+qu6YrCWGKyuv6qiv6ooBsvpr0rrr4oTVhH9VcGI/5c3tw0eoZ293rVZHyAyPkV0xEJcJEASJEcqpEEGm5oZWZEDeZAfhVAExVEaZVERX6IaaqIO6qMRmhFAS7RGe3yFLuiOXuiDrxVvIL7BMIzEaIxT0AmYjCkKOx0zMZt45mGBQi/CUsVezqdWYDVJreFba8lrgz+3+PtOr+91XNCBBS3+L8Y7afwzOI/frOEqfvfxTdzGPcc8cOxj5zxx7nNjvDLWG2OGQ1zqNZd66e7vmUb9bz3VQ6L6i6juENWf+qobs0UiUV0hqt/0VedF4BkReEoEHieq4NflH3In+JM7wX3uBHfrrXborbbqrTZyq/V6qx+41SputZxbLRGDC7nVPG41i1vN0LRP5VaTxeB4MfitGBzFrYaLwSFicJAY/FoM9uFWPcVgVzHYSQx2EINtCaulGGwmBhvrrxoQVl0xWFN/VU1/9SVhVRSDZfVXpfRXxcVg0QhfvVXT/+ER2tbsHZv1Pj5CFERDTMRBfCRGMqTEZzY1PTIhC7IjF/KhIL5AMZREGZRHZVRFDdRGPUVpiCZojlZoiw7ohK4K1gO90Q8DMEgBh2A4RmGMYo7DREwmk6mYjpkKPBvzFHkBAS3EElJaxq9WkNUq8lrzLxIL/GstyazjkeuF8gbd4UZN/CZN/CautZlrbeZaW7jWFq61mWttDt/y2h0E36Dz0DnBtxc+M8ZLY702ZsjY4TdE9YpLvSCqpxr1x3qqB0QV/P6520R1k6j+IKqrRHWZqIJfMH1OBP4qAk+KwGMi8IgI/FkEHhCBe0XgLm61jVtt5lYbuNWP3GoNt1rJrZZxq8XcaoGmfY6m/XsxON3d4BQxOIlbjdO0jykjEsXgMDH4jRgcIAb7uRvsLQZ7iMGuYvArMdheDLYRgy3FYFP9VSP9VX0xWEcM1tBfVdVfVRaD5fVXZfRXJQmrWIQGb9X0f35EslHv4UNEQVTEQGzERyIkRQqkRlpkxOfIhpzIgwIojKIogdI2vxwq4ktUQ03UQX00RjO0UKDWaIeO6Ixu6KlofdAPAzFYAYdiBEYRzFiMx0RFnYypCjsdM0lnFuYq8nxSWojFAnEpaS3332p//ui5TT7a5vhdzt3nmeD+8TCOmeuk+c/gPH5D8C+Qv3v+Bv50zF3cd84j5z4xV/AN0q+MGfx4RzhEVP9wqZeLuRZR/a1Rf0RU98XfXaL6k6huEFXwC6WvENUlojovAs8Q1WkReEIE/iICD3OrgyJwP7faza12uBPcyq02cav13Gott1qtt1rBrZZyq4Xcaj63ms2tZnKradzqO241UQyOE4OjxeAIMTiUWw12NzhADPYVg73EYHcx2JlbfSUG24nB1mKwhf6qqRhsKAbricHa+qsaYrCKGKwkBsvrr8pEevFWRv/3R8TQuu/ftWEf4GN8iuiIhbhIiCRIjlRIg/TIbHOzIgdyIx8KogiKoxTKogIqoypqKEZt1ENDNEFztEJbReqATuiC7uil8H3xNQbiG0UcihEYrZhjMV5BJ2Iy8UzBdMWdiVlENIdXzSOpBXxrEXkt9ecq/1/7NiC3OH6HZ/YY7wAOmeOoV48j+Pr9WVzEZVzz3B+45ZjgO8D+MvcD5z42xlNjvTDma2OHzBMOib7XXOqF6Hvq7i/4LZkPiOovorpDVLeI6g+iukZUl4nqogg8R1S/EtVJEXicqI6KwJ+51QEN+z4RuEvDvv0rjXx7kdjGXSK3+oFbreJWy7nVEm61kFvN5VazuNUMTftUTftkMTiBW33LrUZxq+HcaogYHCQG+4vBPmKwJ7fq5m6wsxjsIAbbisFWYrC5GGwsBhuIwbpisBZhVReDX4rBivqrchFnvpXR/8MjtLbOOzbsfXyET2xcNMREHMRHYiRDSnyGdMiELMiOXMiLAiiMoja+BEqjHCriS1RDTdRBfYVphKZogdZoh46K1Qld0QO9Fa4v+mOQAn6DYRipkKMxlnjGY6KiTsZU4pmuuDMwi5zm8Ky5pLWAfy3x8QrPrfHResdudt52Y+z2bPAFioPmO4xj1nESZ3AevyH4/onrXruBPx171zn3nfvIGE+M9cx8L439jzlYB9fiUi+J6vn3Gnl3f4+I6j5R3SWq20R1k6h+J6qrRHVJX3VBX3WWqE6LwBMi8BeiOiwCD4rA/SJwjwjcKQK3cavN3GoDt/qRW63hViu51TJutZhbzedWc7jV99xqOreawq0mcavx3GqMpn2kpn2YGPyGWw3kVv24Ve+MIlEMdhWDncRgBzHYRgy2FIPNxGBjMVhfDNYRgzXFYDUxWPkdrhXhP/5r5SKEl8WLFFr17D0b9iE+RlTEQGzEQ0IkRQqkRlpksLmZkRU5kAf5UQhFUBylUBYVFKEyqqIGaqMeGqKx4jRDS7RBe3ylWJ3RDT3QW+H6oT8GEcUQDFPIkRitmGMxXkEnYjIJTVHYabxqBkl9T1qzMQ+L/H+511Y77kd/2+j8rcbaadw95jmAQ444iuAfiE7jLC7gkueuIvgOsJu47Zx7zn1gjMfGemreF8YOfkDtjbnCIS71mku9IKqn00Siu7+HRPUXUd0hqltE9QdRXSeqK0T1m77qPFGdIapTIvA4UR0lqkMi8CcRuE8E7uZWO7jVVg37pmYisbFIdCe42p3gCm61lFstdCc4j1vN5lYzudU0bvUdt5rIrcZxq9FicAS3GsqtBnOrAZr2vmKwlxjsLga7cKuO3Kq9GGwtBluIwaZisFFUkSgGa4vBGmKwSqS/w9UjvP9WRf/Pj4ihZXvetWkfIDI+tXHREQtxkQCJkQwpkQbpkQlZkB25kNdmF0BhFEUJlEY5VMSXClENNVEH9dEITRSnOVqhLdor1Ffogm7oSQh90E/x+mMwhijiMIxUyNEENBbjFHQCGU3Cd/xqKllNF4zBf4HEFnp+qWNW+tsPzl1vnM2eDb5AEXwFbL+5D1rPYRzDSQT/xH0ewTfoXPH6ddxw7J+449z7xnhorODnh54Z+6U5XpsrRNbhN1zq1VSuRVRPJnEtd38PiOoeUd0mqptE9TtRXSWqy0R1kajOEdWv+qqT+qpjRHVEBP4sAg8Q1V4N+y4RuF0EbhGBG0XgOhH4A7daxa2WcavF3GoBt5rLrWZxqxncaiq3msytJnCrb7nVKE37cE37EE37IDHYn1v15VY9uVU3btWZW3UUg23FYCsx2JxbNXE32FAM1hODtcRg9Yj/iV/dGzxCi/X3i8XhYnG4WBO/mGstFoeLxeFicbhYE7+Yay3mWou51iKutYhrLeJai7jWIk38Iq61iGst4lqL3CEu5FoLudZCd4gL3SEuDFdCFVRXjFqoiwZojKaK0wKt0Q4dCKYTuqK7ovVEH4XrhwGKNxhDiGcYRijkKIwhoHEKOp6cJvKsyaQ1BTMw23MLvL7EcUEHtsYz64y1yfjbsNOcex1xAIes8SiO4zTO4gIuee0qfnds8A3St3HPGA+M9diYT4z93ByvzBX8/HY4JPr+4VIvudSz8VzrW67l7u++Rv2unupPorpBVNeJ6soArkVU54nqDFGd1ledIKpfiOqwCDxIVPuJao8I3CkCt4nAzSJwA7daW0skVheJ3GqpO8FF7gTnuxOcU0okcqvp3GqKpn2S3mo8txrDrUZyq2Hc6htuNZBbfc2t+mjae2jauyYSiWKwA7dqw61acqtmYrCxGGwgBjVPoVr/x6+2/8ceofmJIoUWPHnPpn2Ij/GpzYuO2IiHhEiC5EiFNEiPTMiC7DY5F/KiAAqjKEqgNFGUQ0VURlXUQG1FqYcGaIJmCtQSbdBOoTqgM7oqWHf0RB+F64f+5DJIAb/BUCIaoZCjMJqUvuVX48lqAu+ajEBiszw/z0eLHL/MuauMsdZ4G7wSfAVsh/l3Y791HcRhRx/DSQTfoHPOcxdxxTHX8Idzbjn3jjH+MtZDYwY//fjMGl6Y67U5Q+YOv+FSr7jUCy71lEs9JqoHRHVPo35HT3WLqP7gVNeI6jJRXSSqc0T1q77qpL7qGFEd0Vcd0lcdIKq9InC3CNwuArdyq00icL0I/EHDvkoELheBS0TgQm41j1vN5lYzudU0bvUdt5rIrb7lVqO51QhuNVTTPljTPkDT3k8M9uJW3blVF271Fbdqp2lvo2lvIQabisFGYrBexBvhhhGi/Qfx/Kce4bkD3rFhHyAyPkE0xEQcxEciJLWhKZAaaZERmZEVOZAb+Wx4QXyBYiiJMiivCJVQBdVQE3UUpT4aooniNEdLtFGkduiITgTRFd0VrSf6KFw/9CegQQr4DYYq4nA+NZKcRpPVWN4V/DfJx1M9N9NHcx230HlBi7/SeMEXKNaZa5NXt2Gn9ey1zgM4hKM4jlM4iwu45JjgG6R/xw3n3jbGXWPdN2bwE5BPzBH8/PYrc/5jblXkWlzqJVE9E31PhotEorpPVHeJ6k+iukFUvxPVVaK6RFQXiOosUZ3WV50gql+I6rC+6qAI3E9Ue0TgTqLaJgI3i8ANIvBHbrVGBK7kVsu41WK91QJuNZdbzdJbzeBWU7nVZG41nluN5VajuNVwbjWEWw3iVv25VV9u1ZNbddO0d9a0dxSD7cRgK27VnFs14VYNInR6q5r/jEdodv5IoZmh92zchzbtY0RFDMRGPCREEiRHKqSxsemRCVmQHbmQF/lR2KYXQXGUQllUUIRKqIrqqKUgdVEfjRSmKZqjJdG0QXuF6ojO6Kpg3dGTgPooXD/0V7yBBDRYAYdgGEmNEIqjyGssJvj/lLcBOdvf5jt/sbGWG3u1V34070ZssZbgH4h2Yz8OOuMwjuEkfvXcOVzEZcdec84fuGWMO8b6y5gPrOuxOZ6a64W1vDZ3yBrCIS71mku9EH1PRd/jwSJxoEaeqO4Q1S2i+oOorhHVZaK6SFTnieqMvuqUZv04UR0lqkP6qp9E4D4RuFsE7iCqrSJwE1GtF4FrudVqbrVCBC4tLhKLiEQROEfD/j23mu5OcIo7wYncahy3GqO3GsmthnGrb7jVQE17P27VW9PeQwx25VaduFUHbtWWW7XkVk0jvQo1iZDjrWr+8x4RQ9O2v2vTPkBkfIJoiIk4NjE+EiEpUiA10iIDMiOrTc6B3MiHgvgCRW18CZRGOVRUhMqoihqopdh10QCNFKcpmqOVIrVFe4XqiM4E0hXdFa2novVGXyL6WvEGktIgfvUNhvKu4L8xJDbe85N9NN2xs5w3zzPBPWTwBYpV5vsB6x2xybq2YZf17sUBBN+gcxTHcQpncd4xv+GKc64794Zx/rTGu8a8b22PzPHEXM+s6aW5/7GGkLWE33Cpl1zqOZd6QlSPvuZafUWiu7/bRHWTqH4nqqtEdYmoLhDVWaI6ra86SVTHiOoIUf0sAg8Q1V591S4RuF0EbhGBG4lqnYb9BxG4SgQuF4FLROBCbjWPW83mVjO41TRu9R23msCtvuVWo7nVCG41lFsN5lYDuFVfbtWLW3XnVl241Vea9vaa9taa9hYRN72Vy3/BI/xd9kg27D18iCiIihiIjXhIiCRIblNTIg3SISOyIJuNzok8yI9CKIJiNr8kyqA8KirEl6iGGgpSG/XQQGEaoanitEAromiL9grVEZ0Uqwu6EVAPReutaH3Rj1f1J6mBfGsweQ3z5yh/H+e1SW87sJnOn2OsBcZdYo4VXg2+xPqj9WzEFuvcgd3O2I+DOIxfEHz/6q9eO4eLjr2Ma879wxg3jXXbmPeM/cAcj8311JwvzP3KGt5YSzjEpV4T1Asu9YxL/U1UD4nqrx5cy93fnxr1G0R1naiuENVvRHWeqM4Q1SmiOk5UvxDVYRF4UF+1n6j2iMCd7gK3icDNInADUf0oAteIwJUicBlRLeZWC/KIRG41i1tN/5xrZdTIc6vx7gTHuhMcxa2Gc6sh3GqQ3qo/t+rDrXpyq27cqjO36vieSIwUDrWN8NlbtfwXPML9I0UMTdjxrk37AJHxic2LhpiIg/hIhKRIgdQ2Ni0yIBOyIjty2ey8KIBCKGrji6MUyqC8IlTCl6imGDVRG/UUpQEaEU5TtFCgVmijSO3QgWS+Uqwu6KZgPYioFyn14Vd9yepr94wDMeRf/GuwmYa4iqG8ZrhAGyEOgy9QjOJao7nWGK41VhM/lmt9G95s3cE/ce/CXhxwfYdw1MfHcQpncN6xvznnCq4b44ax/jTmHWPfN8dDawze3uSZuV9aw2trCVlT+A2XekVQz0Xfk14ikageENU9orrt7u+mRv13PdU1orpMVBeJ6pw7wF+J6iRRHSOqo0T1swg8QFT7iGq3CNxBVFv1VZtE4DoRuFYErhaBKzTsS0XgIg37PA37HBH4vQicxq2+41YTudU4bjWGW43kVsO41WBuNZBbfc2tenOrHtyqK7fqxK06RFz9Vin/FY/QmFzvhMa+ec+mfYgoiIroiI14NjIBEiMZUuIzpLO5GfE5siEHctvsfCiIwihq40ugFMqigiJUQhVUV/iaqK0o9dBAYRqhqeI0R0sCaoN2CtVBob4in87oqmDdeVVPkurNt/r6b4A/v/HccB+Ncex45wQt/jTjfW/suV5ZaM6l1hB8DX+Ntf1ovRux1Rk7sBv7cRCHEXyD9AmcdsxZXHDOJedexe/GumnM28a+Z60PzPXInE/MHbxB0ytreWNN4RBB/cOlXoq+Z6Lvb9H3qLNIJKq7RPUnUd3QqF/XU10lqkuc6gJRnSWq00R1gqh+IarD+qqDRLWfqPaIwJ36qm1EtUUEbhCBP4rAH7jVSqJaJgIXi8AFInCuCJzFrWZwq6ncajK3mpBMJLoTHM2tRnCroe4EB3Or/tyqL7fqxa266606R3odah8h0VuV/Nc9IoZGHnzXhn2AyPgE0RATcRAfCW1mEiRHKqRBepubCZ8jG3Iij83Oj4L4QmGLoQRKo6wiVEBlhaiC6qipILVRT1EaoBHxNFWc5mipQG0IqC3aK1RHIurEq7qQVDe+1YO8er+VWOBfwxwzyjnfOneScaYad4Y5gq+AzTf/Yix31CrrXIv1rmEztmGXa9yLA/gZRz13HKdwxrHn8ZtzrxjjmvH+QPAGAXfM/Je5Hprzbyt5ag0vrOW1NYWsLfyGS73mUi+41FPR91j0PRB999qKRKK6RVR/ENU1orpMVBeJ6hxRnSGqU0R1nKiOatYP6at+Iqp9RLVbBO4gqq1EtUkErieqtfqq1SJwhQhcKgIXicD53GpOeq6lYZ+uYZ8iAieJwPEJRSK3GsWthnOrIdxqILf6mlv14VY9uVXX/xa3+t8e4eEFIoWGukMcxrWGuUMcFv7UBkZHLMRFAiRGUhuaEqmRFhmQ2QZnQXbkQh4FLYBC+MLGF0NJlFaAsqiIygpRBdUJoSZqK0o9NFCYRgrTFM2JqIUCtSaitmivUB3I6Sue1Zm0uvqvl4/7eW6gj4Y6dqTzxnpmgrG+M+50c8zy6jzzL7Sepda30prXYB02OmsrdmA39uMgDuMXnHDMaZzFBedeMsZVY/1uzBvGvm2Ou+a6b85H1vvEGoK3l3tlTf9Ym1zhWlzqJZd6zqWeENUjorov+u624FpEdZOofieqq0R1iaguENVZojpNVCeJ6heiOkJUPxPVAaLaq6/apa/aTlRbROBGfdU6ovpBBK4SgctF4BJutVAEzhOBs0XgTBE4TQR+x60mcqtx3GoMtxrBrYZxq8HcagC36setekd6EeoRIetbdfy3PSKGB+96x6Z9gMiIgmiIYRNjIx4SIgmS29SU+AzpkBGZbXJW5EAum50XBVAIRWx8cZS0+aVRTvErojKqKEZ1xaiJ2gpSDw0IqJHCNEEzxWlBRK0UqA2vakdSHfhWR/Lq4s8e/t/3bUB+42/DnT/aWOOMO8krU80309xzrGOBoxZb63Ksdh1rsR6bXec2BN+/uhcH8DOOeO0Ygh9QO+Occ7hojMvGumbMP4x9yxzB++fcM+cD635sDU+t5YU1vbbWN9YYDnGp1wT1QvQ91U89JqqHRPVXM67VmGsR1Q2iuk5UV4jqN6I6T1RniOoUUR3XrB91B3iIqA4S1T6i2qOv2klU24hqswjcQFQ/isA1InAlUS0TgYtF4AIROFcEzhKBM7jVVG41OZ5I1LB/G4NrReVaUbgWtxr0vkh8JxzqG3HjW1n8KzxC/XNFsmnv4UMb9zE+RXTERBwbGR+JkBTJbWoqpEF6ZLLBnyMbctro3MiLAja8MIqguKKXRBkFKIeKilAZVRSiOmoSUG0FqYv6BNNQYRorTFM0J6SW5NSarNryruC/Tj7u7vnePvra8YOdN8wYo4wZfIFiormmeHWGdcyyrnnWuQhLHb0Sa1zXOmx0zVuxA7uxDz95Pvj5oV9wwrGncda5F4xzCVeNed3YN8zxp7numvO+uR9aw9/W8syaXlrvP9YY8ukQfkNQr0Tfc9H3hEs90qTfJ6p7DTXy9blWXa5FVFeJ6hJRXSSqc0T1K1GdJKpjmvUjRPUzUR0gqr36qt2a9R1EtVVftUkErieqtSJwNVGtIKqlInCRCJwvAucQ1fca9ukicIoInCgCx4nAMSJwJLcaxq2+cSc40J1g/wiZ36riX+HxL3eIfSa+Y9Pex0eIYvM+RXTEQlwksJmJkRQpkNrGpkV6ZLLBWZANOW10buRDQeUvjCI2vjhK2vwyKKcAFVCZgKqgmmLUIJRaqKso9RWlAQE1Vpgm5NSMZ7UgrVZoh688181HvRwXdGADnT/EOCOMOcb448052fzTEPwD0RxHLrDmJVjuWla7xrVYj83Yhp3YiwP4GUdwzLEnnfMrzhnjorEuG/Ma/jDHTXPdNuc9cz+whsfW8tSanltb8Pa+b6w1HOJS/3CpF1zqmej7m0s95FJ/cam7RPVnLa5Vg2u5+7uiUf+NqM6Lv7NEdZqoThDVL0R1mKgOEtV+otqjr9pJVNuIaou+aoMIXKev+kFftYqolovAJSJwoQicJwJni8AZInCqCPxOBE4Qgd9yq9EfiURuNZRbDYo4+K0i/hUfod4JI4V63H/Xxn2AyPjE5kVFTMRGPBuZEEmQDCmV9jOkRQYbnBlZkM1G50Qem50PBVHYphdBcZIoidIKUA4VFKESAX2JaopRQzFqEVEd1FOUBqTUiF81JqumvKsFAol19HwXr/dwfB/nDTDON54dbuzR5hvn1YmYYj0zrG+29c5z9CIsc20r8QPWEctGbMEO7Ebw80M/ee0QjuK4c04heIOA88b6zZhXjH3dPDdcU/AOYHfNHbx/4UNrCd599Zm1vbTG19YasubwGy71iks951JPudRjonpQh2txqdtEdZOo/iCqa+7+LhPVRT3VOfF3hqhOEtVxojpKVIeI6iei2qev2k1UO4hqK1FtEoHriWqtvmq1CFxBVEtF4GKimk9Uc0TgLBE4XQROEYGTuNV4EThWwz5Kwz484vVw/whR3qrhX/kR6l4qUqirRr6rSOwqErtyrS76rS7E1UUkdhGJnUViZ+LqLBI7i8ROxNVJv9WJuL4irq+Iq6NmvqN+qyNxdSCuDsTVnrjaE1c74mpHXG2Jqw1xtSGu1sTVirhahasSUXXFqKkYtflUXXKqj4Z8qxF5NfNna/9v7/VOju3unKDFD+4fBxl3qFdGmm+suSdYy3eOmmad31v7XCxwTUuwnEBWYy3WG2UztmEn9nhuPw7iiGOP4aRzT+OcsS4a85Kxgzdo+t1cN81529z3rOGBtTyypifW9twaX1l78O734RCX+odLvSSoZ1zqb9H3iKjui767VbkWUd0gqutEdZWoLhHVBaI6S1SnieoEUR1zB3iEqH4mqgP6qr2a9V1EtZ2otmjWN4rAdUT1g75qlQhcLgKX6KsWisB5InC2CJwpAqdxq+9E4EQROE7DPibS69CYCLnequDf5hEx1OnUOzbtfXyEKPjUBkZHLMS1kfGRCEmR3KamQhqks7kZkNkGZ0V25CKcPDY7HwqisE0vYtOLoyQBlUZZBShPLBUVobIiVEE1IqpBSrVIqg7fqkteDd9KrKXng4D8yt+6OrenMfoZd6Dxh5hvhHnHOGKcNU2yxqnWPQOznTGfKBZhGVYSyRqsw0ZswXbsxj785JhDOOq84zhljDPGO4/fjH3FHNfM9Yc5g/cvDN4g8y9reWhNf1vbU2t8Ya2vrTlk7eE3BPWaS70QfU+51GMu9VA/9Zfou6OfulWeaxHVNaK6TFS/EdV5ojpDVKc41XGiOkpUh4jqJ6Lap6/aQ1Q7iWobUW0WgRuI6keiWiMCV+qrlhHVYhG4QATOFYGziGqGCJwqAieLwAki8NsI+9+W/9/wEW4ROWKo/dl3bdoHiIxPbF5UxEBsxLWRCZAYSW1oCqRW2DRIhww2+HNktcnZkctG50E+4imIwja9iE0vhhIEVMrml0V5BahARJUUoYogrEpO1VGTdwX/1SexJp5v4aM2ju3onC6e6WG8Psbt75XB5h1mDaOs6VtHTcB31hx8/8T3mEsQCwljCZYj+AbptViPzdiGndjjtf0Ifn77sHN+ce4JnDbWWWNewCVzBG8v97s5b7q+P63hrrXct6ZH1vbEGp9b60tr/sfaw64h/A+XesmlnnOpJ0T1iEvd51J3ieq2fupmKY18Ca5FVJeI6gJRnSWqX4nqJFEdI6ojRPUzUR0gqr1EtYuothPVVs36JhG4jqjWEtVqEbiCqJYS1SIROF8EzhGB34vA6SJwigicGPF0eNl/4rtD/9UeoVZ1IoVavXrPpn2IyPjE5kVDDMRWwHhIgMQ2NBlSILWNTYN0NjcjPrfBWZEduQgoj83OhwI2vBC+IKJiNr6EjS9FQGVQTgEqKEAlXlWZpKrwrWrkVdOf9fy/kdeaO6a1v7V3bifjdPNsb+N/bZ7gS6xDrGGEo8ZY33jrnWz9U50xE8F3gM3HIgJZhpVYg3XYiOAH1LZjF/bhJ8cewlHnHjPOKZwx5jljXzTHZXNdM+cf5r5lDcHb+95zXQ+s7bE1PrXWF9Yc/P6ON64hHOJSrwnqBZd6yqX+JqqHmvS/uNQdorpFVDeKisQvNPKFuBZRnSeqM0R1iqhOENUvRHXYHeBBd4D7iWoPUe0kqm1EtVlftYGofiSqNfqqVfqq5US1WAQuJKp5RDVbBM4UgVMjPQ9NjlDubdX/Oz1Czde+Y9Pex4f42OZ9imiIiTg2Mh4S2swkSIYUNjUV0ih2OmS0wZmR1SZnR04bnZt48qKADS9kw79AUSIqbuNL2vjSRFSWlMrzqwpkVUnnVQU1/L+u5xv6qKljWzqvnTGCe8jgCxQ9zdPXqwPM/421DLe2UY781tqD75/4DtOJYRbmOnshlhDJcqzGWqzHJmzFTuxxzH4cdM5h/GKMEzhtzLPGvmCO38x1xZzXzX3DGv60lrvWdN/aHlpj8OsVnlnzS2v/xzWEXEv4DZd6RVDPudQT0feYqB6IvnvFuRZR3SSq34nqWn6RmFcj7+7vnEb9V6I6SVTHOdURojpEVD8R1T6i2k1UO4hqq2Z9E1GtJ6q1RLVaX7WCqJaKwEX6qvlENVcEfi8Cp0eY9rba/x0f4RbvRQw12v2OTfsAH9m4j/EpotvAmIiD+DYyIZIQTTKkQCobm8bGpkMGZLbBWYgnG3La6Nw2Oi8KEFFBG16YiIqgmI0vYeNL8aoyJFVW11WevCr7s7r/1/ZaA8cFHVgL57cxVgdjdjZHd3P2NvfX1hL8A9FQ6xxp3WMVfjwmO2sqMczEbMwnjkVYhpVYQzDBD6gFPwG5BduxC3sdewA/I3j/nGPGOolfjX3OHBfNddmc18wdvL3vTau8bU33rO2BNT621qfW/Nzag98+9Ma1hEME9Q9BvRB9z7jU31zqoej7S/TdFX1/atJvENV1orpCVL8R1QV3f2c16qeJ6oT4+4WoDhPVQaI6QFR7iWoXUW3XrG8hqo1EtY6oftBXrSKq5US1RF+1kKjmEdXsiOvdBb77ttr/nR+hRjkjheo/edemfYCPbFwUREV0xYyJuIhvMxMiiQ1NhhQ2NTXS2Nh0yEAWmW1wFmSzyTkJKBfy2Oz8NrsgERWy4UWIqCiKk1NJsipNXuX+RWLlnFXByBWtorKSfkkCVYVTNXFYXRwGX16tFe5lDf2sZ6D1DXHkcAUfjeAbdCYSwRRMd/YszMVCAlmC5ViNtViPTdiKnY7ZjeDtTX5y7iEcNdZxY54y/hnznMdv5rxi7uvWcMNagjcov2ttwa9XeGitwS+HeWbtL1zDa9cSck3hN1zqFZd6zqWecqnHXOoBl7pHVHdE303R94fou0ZUl4nqIlGdI6pfieoUUR0nqqNEdYiofiKqfUS1m6h2aNa3uQPcRFQbiOpHfdUazfpKolqmr1qsr1oQ8Ulo7n/hN/D9qz9CdfNECtX6+12b9oFNi4woiEow0RHLJsZFfBuZEElsZjKkIJxUSGNj0yGDzc1MIlmQzSbnsMm5CCgP8tnsAoRU0IZ/QU5FeFYx0irhvzI+rui5Kl6v4bi6zmvomabGaWnctl7paL4u5u5hHX2sLfgXyMHWO1SxRyr6WGeNx2RimIbgG6TnYD4WYRmxrMQa/Ijg57e3YDt2Ya9zDuBnYxxB8PZyJ439qznOmuuClV0yd/D+0b9by01rum1t96zxvrU+suYn1v7cNbxyLf+4pnCIS/3DpV5yqWdc6m+CeqSfus+l7hLVn0R1I4dIFH1XieoSUV0gqrNE9StRnSCqY0R1hKh+JqoDRLWXqHYR1XbN+hai2khU64lqrb5qNVGtIKolke6HlkTI+La6/y8/QtVnRLJp79m0DxHZxkVBVMSwgbEQl3DiI6HNTIJkNjSFDU2FNMSTDultbiab+zmykkx2m5zTJucmorxElB8FSaoQ3/oCxVHa38t7vrLjqvtbbefWN04Tz7YwRxtzdfBqZ2vobj29re9rax3o6CEKPkLhg+8AG0cEkzDFCNMxizjmYiGCH1BbjlX4AeuxCVuxw7G7sc+5P+GQsY7iuLFPmeOMuYK39/3N3Fes4Zq1/GFNt6wt+P0df1nrQ2t+bO1PXecL1/LaNb1xbeE3XOo1l3pBVE9F32Oieij6/uJSd/RTt4jqD036tUwiMb1IJKrzRHWGqE4R1XGiOkpUh4nqIFHtJ6o9RLVTs75N/G0mqg1E9aO+6of3uFakcGh5hH+Dr67/1z7CESJGCFVe+I5Ne8+mfYjINi4KohJODMSyiXER30YmRBKbmQwpCCiVTf0MaYkjvc3NZHMzIwvpZLPJOWxyLj6Vh5zy6bjyk1bwX1Efl/RcOR9Vcmw159QyRj1jNTJuM+O3Mmc7839lLV0d1dMa+ypw8P0TgxV8GEY5cywRTEDwDdLTMBNzCGQ+FmEZViL4+e0fscHrm7ENu5y3Fwfws7EOG/MXnDDHaXOdNecFc1+yhqvWEvx6hZvW9qc13rXW+67ikbU/ca3PXctL1/SPawv7NAr/Q1CvRN9zLvWESz3iUvdF310udZtL3dSk/05UV9Nyrc+4VkqRSFS/EtVJojpGVEeI6meiOkBU+4hqN6faQVRbiWoTUa0nKrdioTURvntb0f+xHhFD5aa8Y9Pes2kfIrKNi4KoiGEDYyl6HMSzkQmR2GYmJYjkSGlTP7OpaZGOiDLa3Mw293MCyobswjAnSeVGXvIqgCL+X8JrZR1X0fFVnFvDOHU828D4Tc3V0txtHRH8A1FnIuuusL0d/TUGKXbwHWAjFD/4/tVxRpiEKUQxHbMQ/IDaQizBcqzCD1iPTQjeP2eHc4J3/9pnjJ+MdwhHjX3cHCdxxpznzH3RGi5byzV78Ye13bLG29Z6z5ofWPtj1/DUtbxwTcGvF33jGsMhLvWaS73gUs+41N9c6iGX+ouo7hDVn1zqBpe6TlRXiOq35FwrKddKpJF393dCo/4LUR0mqoNEtZ+o9hDVLqLaTlRbiGojUa0P3vT/f9RHuPo7EUOl3KiWIq6SxFWSuEoQVwniKq7nKq6hL0ZcRYmraDgBaSS2mUmR3IamtKGpfZamQTobm4GIMtnczKSUlV9lI6scvCv4L5BYYc8X91Fpx5Z3bmXPVDdW8AWK+uZp7NXm5m5tHe2tqRORdVPYXuiryAOc9Y2iD8MoAhiLCQQxGcHPD8004hzMxyIsRfAGAWvwIzY4ZjO2Yadz9yB4/8KDOGzsX8xxwlyncdYqL1jDb9ZyxZquW9sNa/zTWu9ac/D70x667uC3Pz5zzS9d2z+uMeTTKfyGS73iUs+51FOCeiz6Huin7hHVbaK6mVokcqlrRHWZqC4S1Tmi+pWoTrr7O65RP6qn+v+1d5/RUpTZGse7G5CcBSQKShIRkSAYBgczRlRUFFFEFBFFJIgwhIsgQxDJIjmIBEFykAySJMeD5HDIOWeovr/y8mHWXWu+3GuAkWL94Zzuqvfdez9P77fo06dqieVvEVPNZ6q5TDWbqaYz1Y/RdvFw1bmmNwFGg4eHJlGwZEjBPKkULg3SK15GZGaCrIp4C3IoZC7myIO8CnqbguZnooKKWpiBiqAoO92F4vrWPexV2r/3+76c5x623xOOedrxzxvrJWO+ao4q5qtm7hr2eJ+AtQn5MUHrE7aRI/5B6OaM9jnCz6+2Q0ejdEZ3puiJ3gh/A3IQowzBcIzEaI+Nw0RMwXTHzMIcY8zHImMuxjJzrDTXGnMmmHuDGDaLZZuYdoptlxj3yuKAmA+L/ZgcTsrltJzOye2iHMO7b8cDXeqyLnWBoc7qUqcsfcctfUd1qUPOp/Yz1R5LX2IeXYuptjLVJqb6hanWMdVqplqhUy1lqsVMtZCp5iWLB3OSBMHMaPdr31T/skWDcn2SKFgypFC0VEijcOlZIiMyK2AWBsqG7AqZSyFzs8ytyKegtzNPAUUtxEp3sNSdFsWietfdCC1W1uMP2qe87x5zbAVjPGfMF439inleN++bRKvOZO8R8AN71iFoPcKGH9Bp7Khm+C+ityZ+W3RghE7oih5G7IW+GMAs32IoRmCUx8ZgAibbdypmYLYxfsICY/5s7KVYYa7V5lxr7vD2ChvFskVM28WWKMY9Yg3vn3ZQ7EfkcFwup+R0Vm7n5XhJroGc41cY6pIudV6XOqNLndSljln6DutSB3Wpfc6ndjuf2ul8als2XYupNjLVeqZay1SrmGo5Uy1hqkU61QKdak60+1W5rqPt12XxPua6j7nKMldZ5irDXPfG0yEDA2VSwCzIpojZmSinQuZWyDzskxe36VP5UZClCutd4Z9iLFbCY2V89YB9H3LMo45/0jjPGLeiZyqZq7J5qxIs/AFR+BPI9wn5ob3rErYBGhH5H8RuQfTwA9JtjNIOHZmhM7ozR0/0Rvj724MwBMMwEqMxzn4TMQXTHDsTc4w1DwuNHV4/epm5wqvfrzF3ghg2iGWTmLaKLby91S6x7hXzAfU4JIejcgnvX3tabuHdty/I9bKc415e8cu61AVd6qwudVqXOqFLHdWlDjHVAV1qD1PtYqodzqe2Op/alEHXsvwlMNUaplrJVMuYajFTLbgelr9/t8UjsWhQyrJYirlKxpMjJVukVrh0yKB4mRjoZgXMilsUMQcT5VLIPEyUVzHzsdTt+lYB9irs37v8fY/nStvvft+Vc9zDxnnco08b+3lzhW+xvspkVYj2FvHesWdNNvyAoHUQfgLsU0c2JnYztCR8ayZoiw4If0GtK3qgF5P0xQB8i6EYgVGeG4PxmOyYHxFeIHM2wsv7zscicywx13JzrjJ/eP+O9QjvPrSFmbaJcadYd4t5n9jD24sekctxOZ2U2xl1OK8Gl+QcyD8e6FKXdKnzutQZXeokUx239B1hqoOWvn1O0ncz1U6m2s5UW5hqY2pdK6WuldySyFQrmGpptMv1a6p/3YLiA2IMlFTBkiOloqVmjLQKlx4ZGSWzAmZRwGzMkx05WSk38uhZefWu8E8hX9/pseK+KmXfso77m0fKGy98g6KCOZ4lzgtEepmJX7NX+BPItwn4LiFrOeIjRvuEuA0I/RnCD0i3MMrnaMMI7dERnRmjO3qiN/pjEIZgGL7HDxhn34mYgmnGmIk5xpxn7IVYbK5l5lxh7tViWCeWX8S0SWxbxbhDrLvEvEfs++VwSC5H5RTefTu8vftZuV6Q82Uvr7gaxC/rUhcZ6pwuddrSd0KXOqpLHbb0HbD07bX07bL07UirazHVZqbawFQJSXWtWDxYeY2+pfB/2iyLkaBo+1hQ5GxSBroJKRQtlaKlRTqvxgyKl4lxblbArAp4i16Vg6VyOuvKzV75/FvQ30U8V8x+4RlYGcc+YJyHPPooMZ5k1mc8W5FI4Q+IKhPsDcJVs/c7hKxJ0PATYB87sj4+JXYTojdDSwZojbZG7IBO6MogPdALfTEA4fVzhiK8+tco+4zBeExy7I+YbqxZmGvs+eZYZL4lWG7uVWII7z6UIKYNYtssxm1i3clMu8W+Tw4H1OawnI7J7aQcz8j1nJwvyv2KGsQDhrrEUOd1qbO61Cld6rgudUSXOqhL7del9jBVoqVvu6Vvy02WxKTxYH3saLDuWnrz87fcggJlokGBK0kU6yakYKJUipZG0dIxUXpkYqLMyMJO2SyK2dkr568Wy+WIPMp+KxnykeU2UuUnZQG9opAFqbDl8A6n1kWcxBd1En+Xk/hiTuLvdhJf3El8+OmvErpWCV2rpK5VStcqrWuVjjclfAu0YoQ2aM8UHdEZ3dGTUXqjHwZhiMeG4XuE1y8c65gJmGyMaZhpzNn4yRzh7RV+NudSrBDDarGsE9MvYtskxi3MtF3MiWLfI4f9Xj6H5BTe3v24HE/J9aycL8j9shoEahG/oktd1KXO6VJndKmTutQxXeowUx1wPrWXqXYz1U6m2mbp2xw9Hay/Vn5M83ttwW2lokHeGUkUKxmSK1hKJkqtaGlZKJ3CZWSnTHrWzayV1Z8c/s3jsds9X+jqGVhxx5ZS9LKK/zfP/J0YjxGlgj2eJdALxHrZnq/hDQJWI2QNvE/UDx39MZHr41OCNyF+M7REa6O2RQfG6ISu6IFe6IsBGIzvMAKj7DsG4x07CT9iujHDq9/PxXxzLTJneIOY5VgpljViSsAGZtos1m1i3iH2XXLYK5cDcjost2NyPCnX03I+pwoX1eCKWsQDXeqyLnVBlzqrS51iqBO61FFL3yFL335L3x7nU4lMtS06KdjyZ/9A+Y/aglwpI0HOYbEgx5WkinUTE6VQsFRIw0hp9av0+lZG3IzQYrk9ns/zBe1fhMGKKXZJRS+j+OE7YA959hGiPOGV/jSBnrfnSwR7lXBVCPiWo6oT8z3d7APi1sEnRmlI9M/QlAFaoBUztEF7dERnJumGnuiNfhiIIZ4bhu8RXn11rGMnYLKxphp3Bmab4ycsMOfP5l4qhhViWSWmtWJbL8aNYt0i5u1iT5TDbrnsk9NBGR+R43GGOiXns3I/rwaX1CJQk/gVXeqSLnWeoc7oUid1qWO61BFd6qClb2/sXLA70is++8/66MufuQXZnokGWRKSKFYyxUquT6Vkp9TOuNKwVnr9K7Ovs3ksl6/yMlx+xb3j1/8/ZidnDj0jl8Upt66Vx3KY13KYz3J4m+Xwdl0rv65VQNcq6CS+kJP4wk7iww9Hh5++LxKvS+z6aET4Jmhu1Jb4Am0ZowM6oSt6ILxAUx+El5cbjO8w3L4jMRrjjDEJU4w5DTPNMcdc88y7EOHtrZaJJbw53xqxJYhxg1g3iXmr2HfIYZdc9sppv9wOy/GoXE/I+bTcz6nBBbW4rCZxtYlfZqgLutRZXeq0LnVClzqqSx2Krgv2/dGf/LzWtiBdpmiQflUsSB8kVaybWCoFUrFXWmT0d1YWy6GYtzLe7YpbSJGLerQ4y5VS/LKefVAX+ztRHiXOk/Z8hlAVCVaJcJUdVYWQbxH0HdQk7gdGqYNPCB7+gtpnDNAULZihFdqgPXN0RHj9nG7oid7oh4EIL5A5FOHlfX9w7FhMMNZkTDX2DMw2V3j3ofnm/xlLxLJcTKvEFt5edL1Yw5sjbxH7NjnslMtuOe2T20E5HpHrMTmfVIkzanBejS6qSaA28UCXuqRLndelzuhSJ2OXgmORBfH4H/UZ9ethi6d5MBqk2J2ErZLpXeGf0GIZWOxmRcyumLkVNZ9HCjJY+AZFMc+UUPx7ifCAV3Y5e4U/gXyCQE/Z+zmCvYhXCPg6qjo6/ID0u8SthQ8JXZfo9dEITYzcHC0Z4gu0RQd8ha7ogW/QBwMwGN9huGNGIrxA+ThMxBRjTzPHTMwx5zxzLxTDYkYK7/64AqvFuE6sv4h5k9i3ymGHXBKZaY/c9svxEEMdlfMJuZ9Sg7NqcUFNLqtN4GUYv6JLXdSlzkUTgzO/869oXbdbPJImGiTpFYvHlCyJ8iXTq5Ir7/+cgeVS1LyKm1+RCyv2XYp+D5OVJkL4A6K/MVl5ez5GoAqEepZgLxCukiMrE/ENYlYj7DuoaaTaxA5/Qa0e4RviMyZoihZoZZY2aI+O6Ixu+Bq90Q8D8a19h2IERhljDMYbM7x/x1RzTDfXLMw193wxLBLLEjEtF9sqMa4Va4KYN4h9sxy2yWWnnHbLbZ8cD8j1sJyPyf2kGpxWi3NqclFtrqhRPIjFg0vRVrrU7/TLpP8pW/iOcBApkSyITkkZxC6mjSdV5mTKnpwUKciTioSp9Ynw7dV0TpXTWw4zOInPpGtldhJ/s5P4LLpWVifx2ZzE3+IkPruulUPXyhl/E9WJ+y6Ra+FDI9ZFfeI3QhNmaI6WaI226MAkX6ErwusXfuOxPuiPQRiC4Y4didHGGoeJxp6Caeaaac45mCeG8O6PP4tpqdhWiHG1WNeJ+Rexb5TDFrlsl1Oi3PbIcb9cD8r5iNyPq8EptTirJueD2PmLanQh+C2vpfAX2VIGkTJpgujMDEEsyKKY2RU1t+LmU+SCil1E0YtZMEsQ4F5i3E+Ucl7pDxPocUI9RbBnCfcCAV/Ga8R8g6jVjFQDNQldG3WIXg8NmaAxmpqlBVohvEBTO4SXl+uMbvgavdAPA/GtY4ZihDFGYYwxx2OSOcLbW0035yxzzxXDfCwS02KxLRNjePftNWJOEPsGOWyWyzY57ZDbLv+V2SvXA3I+LPejanAiiF06HUTHMNRvcymhv/KWNogUzBxEf8xmicyluHkVOXyLtbCiF1X84kxWihBlCfKgV3r4AZ1HCfUkwZ4h3PN4iYivErMKUd9EdQK/S+xa+IjwddEAjRihCcLr57RkjtZoiw74Cl3QA9+gj336YxCGOHYYvscPxhyLCeaYbK6pmGHu2WIIby+6QFw/Y6kYV4h3NdaKfb0cNspli5y2yy1Rjrvluk/OB+V+mKEOB//PK+nd2P7XZonMEkTuzsFgeSyRtzu/KKTodyr+3V7RJQlRhiAPEKYcgR4m1ONe/U8RLfyA9ItEfJmYr6EqcasRuQZqErw26hC/HhqiMUM0RXiBplZog3boiM7ohq8RXj+6LwY6Jry9wlCMMNYojDb2eEwy1xRzTscsMcwRyzwxLRTbYjEuE+tKMa8Re4IcNshlk5y2ym2HHBPlulfOB724rlbixvZ7bXktkWiaP4jtuUPx7/KKvocQpQlyH2HCT4CVJ9RjBKtAuGcIWJGQlfAqUcNfUHsL1Qn9HsFr4SPUZYIGaIQmTNEcLdEabdEBXyG8vG939LRfH/THIAwxxjCEdx/6wdhjzTEBk8051dwzMFss4c2RF4htkRiXiHW5mFeJfa0c1stlo5w2B9E924PIJzuDv8q75tfQdms8kqFwEClbNIj+cLdzj5IEKUuYBwj0EKEeIdgThHuagM/hRWK+QtTXUJXA1QhdA+8TvjbqoB4jNERjNEULhNcvbIN2+NL3ndANX6MXwtsrDHDsYHyH4cYcidHmGGeuiZhi7mlimCmeOZgntoViXCzWZWJeIfbVQezUOrkkBJE7t8vtapo3tj9zyx9EkpeMRyreG0SH3e9/TOUIVZ5gj6EC8Z4lYkViViJqZVQh8luoTvD3UIv4H6EuGjBEIzRBc7Rkktb4Jzr4Prx+dBd0R0/0cUx/DMQQYw3D98b+AWPNNd68kzFVDNPFMktMc8U3H4vEujiI9l0p9nU33ti89rcHg8jb5YNIs0eC6PonnPg+TcTnCfoiXiHu66hK6LdRg+jvozYTfIx6aMgUjRFev7AFPkcbtMOX6ISu+Nq+vdAXA4wxGN8ZczhGmmM0xplzovmnYGoQuzJDTHODSN15wb+5h/KN7frYnrC0PPsr0SEvBNEJlZy/VGa2KoR+C9XxHvFr4SNGqIsGaIQmDNIMLdEa/0R7fOW5LuiOnujt2H4YaKxvMRQjzDEqiCaONee4INJjihgmBpE7roZ1Y/tP2560bL4RRFJXCSLpqgaRLtWCaJcaqBlEV9aOR3WtmK4V07ViulZM14rpWjFdKxb/Au3wJTqhK3o4pqdjexujPwYZc7DxQ7qY6+q0f6EtEvlvLj6dTNsMZuwAAAAASUVORK5CYII="}})),rtl.module("WEBLib.TMSFNCColorWheel",["System","WEBLib.ExtCtrls","WEBLib.Controls","Web","Classes","Types","WEBLib.Graphics","WEBLib.TMSFNCCustomControl","WEBLib.TMSFNCImage","WEBLib.TMSFNCGraphics","WEBLib.TMSFNCGraphicsTypes","WEBLib.TMSFNCTypes","WEBLib.TMSFNCEdit","WEBLib.TMSFNCStyles","WEBLib.TMSFNCUtils"],(function(){"use strict";var t=this;this.MAJ_VER=1,this.MIN_VER=0,this.REL_VER=1,this.BLD_VER=0,rtl.createClass(this,"TTMSFNCRGBTrackBar",pas["WEBLib.ExtCtrls"].TWebTrackBar,(function(){this.SetValue=function(t){this.SetPosition(Math.round(t))},this.GetV=function(){return this.GetPosition()},this.Create$1=function(t){return pas["WEBLib.Controls"].TControl.Create$1.apply(this,arguments),this.SetMax(255),this.SetWidth(100),this},rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TTMSFNCImageColor",pas["WEBLib.TMSFNCImage"].TTMSFNCImage,(function(){this.$init=function(){pas["WEBLib.TMSFNCImage"].TTMSFNCImage.$init.call(this),this.FDPIChanged=!1,this.FMouseDown=!1,this.FImageLoaded=!1,this.FPixelColor=0,this.FOnColorChanged=null,this.FX=0,this.FY=0,this.FImgDt=null,this.FOffS=0,this.Fsc=0},this.$final=function(){this.FOnColorChanged=void 0,this.FImgDt=void 0,pas["WEBLib.TMSFNCImage"].TTMSFNCImage.$final.call(this)},this.SetPixelColor=function(t){this.FPixelColor!==t&&(this.FPixelColor=t)},this.SetX=function(t){this.FX!==t&&(this.FX=t)},this.SetY=function(t){this.FY!==t&&(this.FY=t)},this.SetCoordinates=function(t,e){var i,s=0,o=0,n=0,r=pas["WEBLib.TMSFNCTypes"].TPointF.$new();r.$assign(this.GetCenterPoint()),i=this.GetRadius()-1*this.Fsc,0===(s=Math.abs(r.X-e))&&(s=1),0===(o=Math.abs(r.Y-t))&&(o=1),n=180*Math.atan(s/o)/Math.PI,t>=r.X&&e<=r.Y?n=360-n:t<=r.X&&e>=r.Y?n=180-n:t<=r.X&&e<=r.Y&&(n=180+n),n=pas.Math.DegToRad(n),this.FX=r.X-.5+i*Math.cos(n),this.FY=r.Y-.5+i*Math.sin(n)},this.PtInColorWheel=function(t,e){return pas.System.Sqr$1(t-75*this.GetDPIScale())+pas.System.Sqr$1(e-75*this.GetDPIScale())<=pas.System.Sqr$1(74*this.GetDPIScale())},this.DoAfterDraw=function(t,e){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.DoAfterDraw.apply(this,arguments),this.FDPIChanged&&(this.FDPIChanged=!1,this.MapPixels())},this.ColorChanged=function(){null!=this.FOnColorChanged&&this.FOnColorChanged(this)},this.BitmapLoaded=function(t){this.FImageLoaded=!0},this.HandleMouseDown=function(t,e,i,s){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleMouseDown.apply(this,arguments),this.CaptureEx(),this.FMouseDown=!0,this.PtInColorWheel(i,s)&&(this.SetPixelColor(this.XYToColor(i,s)),this.ColorChanged(),this.Invalidate())},this.HandleMouseMove=function(t,e,i){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleMouseMove.apply(this,arguments),this.FMouseDown&&(this.PtInColorWheel(e,i)?this.SetPixelColor(this.XYToColor(e,i)):(this.SetCoordinates(e,i),this.SetPixelColor(this.XYToColor(this.FX,this.FY))),this.ColorChanged(),this.Invalidate())},this.HandleMouseUp=function(t,e,i,s){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleMouseUp.apply(this,arguments),this.FMouseDown=!1,this.ReleaseCaptureEx()},this.GetDPIScale=function(){return this.FPaintScaleFactor},this.Create$1=function(t){return pas["WEBLib.TMSFNCImage"].TTMSFNCCustomImage.Create$1.apply(this,arguments),this.SetWidth(150),this.SetHeight(150),this.SetX(this.GetWidth()/2*this.GetDPIScale()),this.SetY(this.GetHeight()/2*this.GetDPIScale()),this.FImageLoaded=!1,this.FDPIChanged=!1,this.FStroke.SetKind(0),this.FOnBitmapChanged=rtl.createCallback(this,"BitmapLoaded"),this},this.Destroy=function(){this.UnmapPixels(),pas["WEBLib.TMSFNCImage"].TTMSFNCCustomImage.Destroy.call(this)},this.Draw=function(t,e){pas["WEBLib.TMSFNCImage"].TTMSFNCCustomImage.Draw.apply(this,arguments),this.FImageLoaded&&(this.FImageLoaded=!1,this.MapPixels()),t.FStroke.SetKind(1),t.FFill.SetKind(0),t.FStroke.SetColor(0),t.DrawEllipse(this.FX-this.ScalePaintValue(5),this.FY-this.ScalePaintValue(5),this.FX+this.ScalePaintValue(5),this.FY+this.ScalePaintValue(5),2),t.FStroke.SetColor(16777215),t.DrawEllipse(this.FX-this.ScalePaintValue(4),this.FY-this.ScalePaintValue(4),this.FX+this.ScalePaintValue(4),this.FY+this.ScalePaintValue(4),2)},this.MapPixels=function(){0!==this.GetWidth()?this.Fsc=Math.round(this.GetCanvas().FElementCanvas.width/this.GetWidth()*100)/100:this.Fsc=1,this.FImgDt=this.GetCanvas().FContext.getImageData(0,0,Math.round(this.GetWidth()*this.Fsc),Math.round(this.GetHeight()*this.Fsc))},this.UnmapPixels=function(){},this.XYToColor=function(t,e){return this.FOffS=4*(Math.round(t*this.Fsc)+Math.round(e*this.Fsc)*Math.round(this.GetWidth()*this.Fsc)),pas["WEBLib.Graphics"].RGB(this.FImgDt.data[this.FOffS+0],this.FImgDt.data[this.FOffS+1],this.FImgDt.data[this.FOffS+2])},this.GetCenterPoint=function(){var t=pas["WEBLib.TMSFNCTypes"].TPointF.$new();return t.$assign(pas["WEBLib.TMSFNCTypes"].PointF(this.GetWidth()/2,this.GetHeight()/2)),t},this.GetRadius=function(){return this.GetWidth()/2},rtl.addIntf(this,pas["WEBLib.TMSFNCBitmapContainer"].ITMSFNCBitmapContainer),rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas["WEBLib.TMSFNCTypes"].ITMSFNCProductInfo),rtl.addIntf(this,pas.System.IUnknown)})),rtl.recNewT(this,"TTMSFNCColorWheelHSColor",(function(){this.Hue=0,this.Saturation=0,this.$eq=function(t){return this.Hue===t.Hue&&this.Saturation===t.Saturation},this.$assign=function(t){return this.Hue=t.Hue,this.Saturation=t.Saturation,this}})),this.$rtti.$MethodVar("TTMSFNCCustomColorWheelBeforeDrawSelectedColorPanelEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARectF",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["ASelectedColor",pas["WEBLib.Graphics"].$rtti.TColor],["AAllow",rtl.boolean,1],["ADefaultDraw",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCCustomColorWheelAfterDrawSelectedColorPanelEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARectF",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["ASelectedColor",pas["WEBLib.Graphics"].$rtti.TColor]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCCustomColorWheelSelectedColorChangedEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ASelectedColor",pas["WEBLib.Graphics"].$rtti.TColor]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCCustomColorWheelRValueChangedEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AR",rtl.longint],["ASelectedColor",pas["WEBLib.Graphics"].$rtti.TColor]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCCustomColorWheelGValueChangedEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AG",rtl.longint],["ASelectedColor",pas["WEBLib.Graphics"].$rtti.TColor]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCCustomColorWheelBValueChangedEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AB",rtl.longint],["ASelectedColor",pas["WEBLib.Graphics"].$rtti.TColor]]),methodkind:0}),rtl.createClass(this,"TTMSFNCCustomColorWheel",pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl,(function(){this.$init=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.$init.call(this),this.FImage=null,this.FREdit=null,this.FGEdit=null,this.FBEdit=null,this.FHEXEdit=null,this.FRTrackBar=null,this.FGTrackBar=null,this.FBTrackBar=null,this.FSelectedColor=0,this.FGValue=0,this.FRValue=0,this.FBValue=0,this.FHSColor=t.TTMSFNCColorWheelHSColor.$new(),this.FOnBValueChanged=null,this.FOnGValueChanged=null,this.FOnAfterDrawSelectedColorPanel=null,this.FOnSelectedColorChanged=null,this.FOnRValueChanged=null,this.FOnBeforeDrawSelectedColorPanel=null,this.FFont$1=null},this.$final=function(){this.FImage=void 0,this.FREdit=void 0,this.FGEdit=void 0,this.FBEdit=void 0,this.FHEXEdit=void 0,this.FRTrackBar=void 0,this.FGTrackBar=void 0,this.FBTrackBar=void 0,this.FHSColor=void 0,this.FOnBValueChanged=void 0,this.FOnGValueChanged=void 0,this.FOnAfterDrawSelectedColorPanel=void 0,this.FOnSelectedColorChanged=void 0,this.FOnRValueChanged=void 0,this.FOnBeforeDrawSelectedColorPanel=void 0,this.FFont$1=void 0,pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.$final.call(this)},this.SetSelectedColor=function(t){this.FSelectedColor!==t&&(this.FSelectedColor=t,this.FRValue=this.ColorToRValue(this.FSelectedColor),this.FREdit.SetT(pas.SysUtils.IntToStr(this.FRValue)),this.FGValue=this.ColorToGValue(this.FSelectedColor),this.FGEdit.SetT(pas.SysUtils.IntToStr(this.FGValue)),this.FBValue=this.ColorToBValue(this.FSelectedColor),this.FBEdit.SetT(pas.SysUtils.IntToStr(this.FBValue)),this.FHEXEdit.SetT(pas.SysUtils.IntToHex(this.FRValue,2)+pas.SysUtils.IntToHex(this.FGValue,2)+pas.SysUtils.IntToHex(this.FBValue,2)),this.FRTrackBar.FOnChange=null,this.FRTrackBar.GetV()!==this.FRValue&&(this.FRTrackBar.SetValue(this.FRValue),this.DoRValueChanged(this.FRValue,this.FSelectedColor)),this.FRTrackBar.FOnChange=rtl.createCallback(this,"RTrackBarChanged"),this.FGTrackBar.FOnChange=null,this.FGTrackBar.GetV()!==this.FGValue&&(this.FGTrackBar.SetValue(this.FGValue),this.DoGValueChanged(this.FGValue,this.FSelectedColor)),this.FGTrackBar.FOnChange=rtl.createCallback(this,"GTrackBarChanged"),this.FBTrackBar.FOnChange=null,this.FBTrackBar.GetV()!==this.FBValue&&(this.FBTrackBar.SetValue(this.FBValue),this.DoBValueChanged(this.FBValue,this.FSelectedColor)),this.FBTrackBar.FOnChange=rtl.createCallback(this,"BTrackBarChanged"),this.FHSColor.$assign(this.RGBToHS(this.FRValue,this.FGValue,this.FBValue)),this.SetIndicator(),this.DoSelectedColorChanged(this.FSelectedColor),this.Invalidate())},this.SetBValue=function(t){this.FBValue!==t&&(this.FBValue=t,this.FBEdit.SetT(pas.SysUtils.IntToStr(t)),this.FHEXEdit.SetT(pas.SysUtils.IntToHex(this.FRValue,2)+pas.SysUtils.IntToHex(this.FGValue,2)+pas.SysUtils.IntToHex(this.FBValue,2)),this.FBTrackBar.SetValue(this.FBValue),this.FSelectedColor=this.RGBToGraphicsColor(this.FRValue,this.FGValue,this.FBValue),this.FHSColor.$assign(this.RGBToHS(this.FRValue,this.FGValue,this.FBValue)),this.SetIndicator(),this.DoBValueChanged(this.FBValue,this.FSelectedColor),this.DoSelectedColorChanged(this.FSelectedColor),this.Invalidate())},this.SetGValue=function(t){this.FGValue!==t&&(this.FGValue=t,this.FGEdit.SetT(pas.SysUtils.IntToStr(t)),this.FHEXEdit.SetT(pas.SysUtils.IntToHex(this.FRValue,2)+pas.SysUtils.IntToHex(this.FGValue,2)+pas.SysUtils.IntToHex(this.FBValue,2)),this.FGTrackBar.SetValue(this.FGValue),this.FSelectedColor=this.RGBToGraphicsColor(this.FRValue,this.FGValue,this.FBValue),this.FHSColor.$assign(this.RGBToHS(this.FRValue,this.FGValue,this.FBValue)),this.SetIndicator(),this.DoGValueChanged(this.FGValue,this.FSelectedColor),this.DoSelectedColorChanged(this.FSelectedColor),this.Invalidate())},this.SetRValue=function(t){this.FRValue!==t&&(this.FRValue=t,this.FREdit.SetT(pas.SysUtils.IntToStr(t)),this.FHEXEdit.SetT(pas.SysUtils.IntToHex(this.FRValue,2)+pas.SysUtils.IntToHex(this.FGValue,2)+pas.SysUtils.IntToHex(this.FBValue,2)),this.FRTrackBar.SetValue(this.FRValue),this.FSelectedColor=this.RGBToGraphicsColor(this.FRValue,this.FGValue,this.FBValue),this.FHSColor.$assign(this.RGBToHS(this.FRValue,this.FGValue,this.FBValue)),this.SetIndicator(),this.DoRValueChanged(this.FRValue,this.FSelectedColor),this.DoSelectedColorChanged(this.FSelectedColor),this.Invalidate())},this.SetHEXValue=function(t){var e="",i=0,s=0,o=0;6===t.length&&(e=pas.System.Copy(t,1,2),i=pas.SysUtils.StrToInt("$"+e),e=pas.System.Copy(t,3,2),s=pas.SysUtils.StrToInt("$"+e),e=pas.System.Copy(t,5,2),o=pas.SysUtils.StrToInt("$"+e),this.SetSelectedColor(this.RGBToGraphicsColor(i,s,o)),this.FHSColor.$assign(this.RGBToHS(i,s,o)),this.SetIndicator())},this.GetHEXValue=function(){return this.FHEXEdit.GetT()},this.IsHEXValueStored=function(){return"FFFFFF"!==this.GetHEXValue()},this.SetFnt=function(t){this.FFont$1.AssignSource(t)},this.Loaded=function(){pas["WEBLib.Controls"].TCustomControl.Loaded.call(this)},this.Draw=function(t,e){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Draw.apply(this,arguments),this.DrawColorPanel(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e)),this.DrawText(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e))},this.DrawColorPanel=function(t,e){var i,s=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),o=!1,n=!1;i=35+this.FREdit.GetHeight()+this.FBEdit.GetHeight()+this.FGEdit.GetHeight()+this.FHEXEdit.GetHeight(),s.$assign(pas["WEBLib.TMSFNCTypes"].RectF(0,0,this.ScalePaintValue(25),this.ScalePaintValue(25))),pas["WEBLib.TMSFNCTypes"].OffsetRectEx$1(s,this.ScalePaintValue(30)+this.FImage.GetWidth(),i),s.Right=this.FREdit.GetLeft()+this.FREdit.GetWidth(),t.FFill.SetColor(this.FSelectedColor),o=!0,n=!0,this.DoBeforeDrawSelectedColorPanel(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(s),this.FSelectedColor,{get:function(){return o},set:function(t){o=t}},{get:function(){return n},set:function(t){n=t}}),o&&(n&&t.DrawRectangle$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(s),2),this.DoAfterDrawSelectedColorPanel(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(s),this.FSelectedColor))},this.DrawText=function(t,e){t.FFont.AssignSource(this.FFont$1),t.DrawText(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(30+this.FImage.GetWidth(),this.FREdit.GetTop()+7)),"R",0,!0,!1,-1,-1),t.DrawText(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(30+this.FImage.GetWidth(),this.FGEdit.GetTop()+7)),"G",0,!0,!1,-1,-1),t.DrawText(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(30+this.FImage.GetWidth(),this.FBEdit.GetTop()+7)),"B",0,!0,!1,-1,-1),t.DrawText(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(30+this.FImage.GetWidth(),this.FHEXEdit.GetTop()+7)),"HEX",0,!0,!1,-1,-1)},this.RFieldKeyDown=function(t,e,i){var s=0;13===e.get()&&((s=this.FREdit.GetInt())<0?s=0:s>255&&(s=255),s===this.FRValue?this.FREdit.SetT(pas.SysUtils.IntToStr(s)):(this.SetSelectedColor(this.RGBToGraphicsColor(s,this.FGValue,this.FBValue)),this.FHSColor.$assign(this.RGBToHS(s,this.FGValue,this.FBValue)),this.SetIndicator()))},this.GFieldKeyDown=function(t,e,i){var s=0;13===e.get()&&((s=this.FGEdit.GetInt())<0?s=0:s>255&&(s=255),s===this.FGValue?this.FGEdit.SetT(pas.SysUtils.IntToStr(s)):(this.SetSelectedColor(this.RGBToGraphicsColor(this.FRValue,s,this.FBValue)),this.FHSColor.$assign(this.RGBToHS(this.FRValue,s,this.FBValue)),this.SetIndicator()))},this.BFieldKeyDown=function(t,e,i){var s=0;13===e.get()&&((s=this.FBEdit.GetInt())<0?s=0:s>255&&(s=255),s===this.FBValue?this.FBEdit.SetT(pas.SysUtils.IntToStr(s)):(this.SetSelectedColor(this.RGBToGraphicsColor(this.FRValue,this.FGValue,s)),this.FHSColor.$assign(this.RGBToHS(this.FRValue,this.FGValue,s)),this.SetIndicator()))},this.HEXFieldKeyDown=function(t,e,i){var s="",o=0,n=0,r=0;13===e.get()&&6===this.FHEXEdit.GetT().length&&(s=pas.System.Copy(this.FHEXEdit.GetT(),1,2),o=pas.SysUtils.StrToInt("$"+s),s=pas.System.Copy(this.FHEXEdit.GetT(),3,2),n=pas.SysUtils.StrToInt("$"+s),s=pas.System.Copy(this.FHEXEdit.GetT(),5,2),r=pas.SysUtils.StrToInt("$"+s),this.SetSelectedColor(this.RGBToGraphicsColor(o,n,r)),this.FHSColor.$assign(this.RGBToHS(o,n,r)),this.SetIndicator())},this.DoBeforeDrawSelectedColorPanel=function(t,e,i,s,o){null!=this.FOnBeforeDrawSelectedColorPanel&&this.FOnBeforeDrawSelectedColorPanel(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i,s,o)},this.DoAfterDrawSelectedColorPanel=function(t,e,i){null!=this.FOnAfterDrawSelectedColorPanel&&this.FOnAfterDrawSelectedColorPanel(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i)},this.DoSelectedColorChanged=function(t){null!=this.FOnSelectedColorChanged&&this.FOnSelectedColorChanged(this,t)},this.DoRValueChanged=function(t,e){null!=this.FOnRValueChanged&&this.FOnRValueChanged(this,t,e)},this.DoGValueChanged=function(t,e){null!=this.FOnGValueChanged&&this.FOnGValueChanged(this,t,e)},this.DoBValueChanged=function(t,e){null!=this.FOnBValueChanged&&this.FOnBValueChanged(this,t,e)},this.ColorChanged=function(t){this.SetSelectedColor(this.FImage.FPixelColor)},this.RTrackBarChanged=function(t){this.SetRValue(Math.round(this.FRTrackBar.GetV()))},this.GTrackBarChanged=function(t){this.SetGValue(Math.round(this.FGTrackBar.GetV()))},this.BTrackBarChanged=function(t){this.SetBValue(Math.round(this.FBTrackBar.GetV()))},this.FillColorChanged=function(t){this.FillChanged(this),this.FImage.FFill.SetColor(this.FColor)},this.ApplyStyle=function(){var t=0;pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.ApplyStyle.call(this),t=-1,pas["WEBLib.TMSFNCStyles"].TTMSFNCStyles.GetStyleBackgroundFillColor({get:function(){return t},set:function(e){t=e}})&&this.FFill.SetColor(t)},this.ResetToDefaultStyle=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.ResetToDefaultStyle.call(this),this.FFill.SetColor(16777215)},this.UpdateControlAfterResize=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.UpdateControlAfterResize.call(this),null!=this.FImage&&this.FImage.SetTop(Math.round(this.GetHeight()/2-this.FImage.GetHeight()/2))},this.SetIndicator=function(){var t,e,i=pas["WEBLib.TMSFNCTypes"].TPointF.$new();i.$assign(this.FImage.GetCenterPoint()),e=this.FImage.GetRadius()-.5,t=pas.Math.DegToRad(this.FHSColor.Hue),this.FImage.SetX(i.X+e*this.FHSColor.Saturation*Math.cos(t)),this.FImage.SetY(i.Y+e*this.FHSColor.Saturation*Math.sin(t)),this.FImage.Invalidate()},this.GetVersion=function(){return this.$class.GetVersionNumber(1,0,1,0)},this.RGBToHS=function(e,i,s){var o,n,r=t.TTMSFNCColorWheelHSColor.$new(),a=0,l=0;return a=0,n=(o=Math.max(Math.max(e,i),s))-Math.min(Math.min(e,i),s),l=0===o?0:n/o,0===n?a=0:o===e?a=(i-s)/n:o===i?a=(s-e)/n+2:o===s&&(a=(e-i)/n+4),a*=60,r.Hue=a,r.Saturation=l,r},this.Create$1=function(e){return pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Create$1.apply(this,arguments),this.SetWidth(350),this.SetHeight(175),this.FRValue=255,this.FGValue=255,this.FBValue=255,this.FSelectedColor=16777215,this.FFill.FOnChanged=rtl.createCallback(this,"FillColorChanged"),this.FFont$1=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFont.$create("Create$2"),this.FImage=t.TTMSFNCImageColor.$create("Create$1",[this]),this.FImage.SetParent(this),this.FImage.FBitmaps.AddBitmapFromResource$1(pas["WEBLib.TMSFNCColorWheelResources"].GetColorWheelResource(),pas["WEBLib.TMSFNCTypes"].HInstance(),1),this.FImage.SetTop(Math.round(this.GetHeight()/2-this.FImage.GetHeight()/2)),this.FImage.SetLeft(10),this.FImage.FOnColorChanged=rtl.createCallback(this,"ColorChanged"),this.FImage.SetStretch(!0),this.FREdit=pas["WEBLib.TMSFNCEdit"].TTMSFNCEdit.$create("Create$1",[this]),this.FREdit.SetParent(this),this.FREdit.SetWidth(35),this.FREdit.SetLeft(this.GetWidth()-this.FREdit.GetWidth()-15),this.FREdit.SetTop(15),this.FREdit.SetEditType$1(1),this.FREdit.FOnKeyDown=rtl.createCallback(this,"RFieldKeyDown"),this.FREdit.SetMaxLength(3),this.FREdit.SetT("255"),this.FGEdit=pas["WEBLib.TMSFNCEdit"].TTMSFNCEdit.$create("Create$1",[this]),this.FGEdit.SetParent(this),this.FGEdit.SetWidth(35),this.FGEdit.SetLeft(this.GetWidth()-this.FGEdit.GetWidth()-15),this.FGEdit.SetTop(45),this.FGEdit.SetEditType$1(1),this.FGEdit.FOnKeyDown=rtl.createCallback(this,"GFieldKeyDown"),this.FGEdit.SetMaxLength(3),this.FGEdit.SetT("255"),this.FBEdit=pas["WEBLib.TMSFNCEdit"].TTMSFNCEdit.$create("Create$1",[this]),this.FBEdit.SetParent(this),this.FBEdit.SetWidth(35),this.FBEdit.SetLeft(this.GetWidth()-this.FBEdit.GetWidth()-15),this.FBEdit.SetTop(75),this.FBEdit.SetEditType$1(1),this.FBEdit.FOnKeyDown=rtl.createCallback(this,"BFieldKeyDown"),this.FBEdit.SetMaxLength(3),this.FBEdit.SetT("255"),this.FHEXEdit=pas["WEBLib.TMSFNCEdit"].TTMSFNCEdit.$create("Create$1",[this]),this.FHEXEdit.SetParent(this),this.FHEXEdit.SetWidth(125),this.FHEXEdit.SetLeft(210),this.FHEXEdit.SetTop(105),this.FHEXEdit.SetEditType$1(9),this.FHEXEdit.FOnKeyDown=rtl.createCallback(this,"HEXFieldKeyDown"),this.FHEXEdit.SetMaxLength(6),this.FHEXEdit.SetT("FFFFFF"),this.FRTrackBar=t.TTMSFNCRGBTrackBar.$create("Create$1",[this]),this.FRTrackBar.SetParent(this),this.FRTrackBar.SetLeft(195),this.FRTrackBar.SetTop(this.FREdit.GetTop()-1),this.FRTrackBar.SetValue(255),this.FRTrackBar.FOnChange=rtl.createCallback(this,"RTrackBarChanged"),this.FGTrackBar=t.TTMSFNCRGBTrackBar.$create("Create$1",[this]),this.FGTrackBar.SetParent(this),this.FGTrackBar.SetLeft(195),this.FGTrackBar.SetTop(this.FGEdit.GetTop()-1),this.FGTrackBar.SetValue(255),this.FGTrackBar.FOnChange=rtl.createCallback(this,"GTrackBarChanged"),this.FBTrackBar=t.TTMSFNCRGBTrackBar.$create("Create$1",[this]),this.FBTrackBar.SetParent(this),this.FBTrackBar.SetLeft(195),this.FBTrackBar.SetTop(this.FBEdit.GetTop()-1),this.FBTrackBar.SetValue(255),this.FBTrackBar.FOnChange=rtl.createCallback(this,"BTrackBarChanged"),this},this.Destroy=function(){rtl.free(this,"FImage"),rtl.free(this,"FREdit"),rtl.free(this,"FGEdit"),rtl.free(this,"FBEdit"),rtl.free(this,"FRTrackBar"),rtl.free(this,"FGTrackBar"),rtl.free(this,"FBTrackBar"),rtl.free(this,"FFont$1"),pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Destroy.call(this)},this.ColorToRValue=function(t){return 255&t},this.ColorToGValue=function(t){return Math.floor((65280&t)/256)},this.ColorToBValue=function(t){return Math.floor((16711680&t)/65536)},this.RGBToGraphicsColor=function(t,e,i){return pas["WEBLib.Graphics"].RGB(t,e,i)},rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas["WEBLib.TMSFNCTypes"].ITMSFNCProductInfo),rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TTMSFNCColorWheel",this.TTMSFNCCustomColorWheel,(function(){rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas["WEBLib.TMSFNCTypes"].ITMSFNCProductInfo),rtl.addIntf(this,pas.System.IUnknown);var e=this.$rtti;e.addProperty("Font",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFont,"FFont$1","SetFnt"),e.addProperty("Fill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FFill","SetFill"),e.addProperty("Stroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FStroke","SetStroke"),e.addProperty("SelectedColor",2,pas["WEBLib.Graphics"].$rtti.TColor,"FSelectedColor","SetSelectedColor",{Default:16777215}),e.addProperty("RValue",2,rtl.longint,"FRValue","SetRValue",{Default:255}),e.addProperty("BValue",2,rtl.longint,"FBValue","SetBValue",{Default:255}),e.addProperty("GValue",2,rtl.longint,"FGValue","SetGValue",{Default:255}),e.addProperty("HEXValue",15,rtl.string,"GetHEXValue","SetHEXValue",{stored:"IsHEXValueStored"}),e.addProperty("OnBeforeDrawSelectedColorPanel",0,t.$rtti.TTMSFNCCustomColorWheelBeforeDrawSelectedColorPanelEvent,"FOnBeforeDrawSelectedColorPanel","FOnBeforeDrawSelectedColorPanel"),e.addProperty("OnAfterDrawSelectedColorPanel",0,t.$rtti.TTMSFNCCustomColorWheelAfterDrawSelectedColorPanelEvent,"FOnAfterDrawSelectedColorPanel","FOnAfterDrawSelectedColorPanel"),e.addProperty("OnSelectedColorChanged",0,t.$rtti.TTMSFNCCustomColorWheelSelectedColorChangedEvent,"FOnSelectedColorChanged","FOnSelectedColorChanged"),e.addProperty("OnRValueChanged",0,t.$rtti.TTMSFNCCustomColorWheelRValueChangedEvent,"FOnRValueChanged","FOnRValueChanged"),e.addProperty("OnGValueChanged",0,t.$rtti.TTMSFNCCustomColorWheelGValueChangedEvent,"FOnGValueChanged","FOnGValueChanged"),e.addProperty("OnBValueChanged",0,t.$rtti.TTMSFNCCustomColorWheelBValueChangedEvent,"FOnBValueChanged","FOnBValueChanged"),e.attr=[pas.Classes.ComponentPlatformsAttribute,"Create$1",[0]]}))}),["Math","SysUtils","WEBLib.TMSFNCColorWheelResources"]),rtl.module("WEBLib.TMSFNCColorSelector",["System","Classes","WEBLib.TMSFNCGraphics","WEBLib.TMSFNCCustomControl","WEBLib.TMSFNCCustomSelector","WEBLib.Controls","WEBLib.TMSFNCTypes","WEBLib.ExtCtrls","WEBLib.TMSFNCGraphicsTypes","WEBLib.StdCtrls","Types"],(function(){"use strict";var t=this,e=t.$impl;this.MAJ_VER=1,this.MIN_VER=0,this.REL_VER=0,this.BLD_VER=1,this.TMSFNCColorSelectorColorSetCount=15,this.TMSFNCColorSelectorColorSet=[0,128,32768,32896,8388608,8388736,8421376,12632256,8421504,255,65280,65535,16711680,16711935,16776960,16777215],this.TMSFNCColorSelectorExtendedColorSetCount=39,this.TMSFNCColorSelectorExtendedColorSet=[0,10040064,3355392,13056,13158,8388608,3355445,3355443,128,26367,32896,32768,8421376,16711680,10053222,8421504,255,39423,52377,6723891,13421619,16737843,8388736,10066329,16711935,52479,65535,65280,16776960,16763904,6697881,12632256,13408767,10079487,10092543,13434828,16777164,16764057,16751052,16777215],rtl.createClass(this,"TTMSFNCColorSelectorItem",pas["WEBLib.TMSFNCCustomSelector"].TTMSFNCCustomSelectorItem,(function(){this.$init=function(){pas["WEBLib.TMSFNCCustomSelector"].TTMSFNCCustomSelectorItem.$init.call(this),this.FOwner$1=null,this.FColor=0},this.$final=function(){this.FOwner$1=void 0,pas["WEBLib.TMSFNCCustomSelector"].TTMSFNCCustomSelectorItem.$final.call(this)},this.SetColor=function(t){this.FColor!==t&&(this.FColor=t,null!=this.FOwner$1&&this.FOwner$1.InvalidateItems())},this.Create$1=function(e){return pas["WEBLib.TMSFNCCustomSelector"].TTMSFNCCustomSelectorItem.Create$1.apply(this,arguments),null!=this.FCollection&&(this.FOwner$1=rtl.as(this.FCollection,t.TTMSFNCColorSelectorItems).FOwner$2),this},this.Assign=function(e){pas["WEBLib.TMSFNCCustomSelector"].TTMSFNCCustomSelectorItem.Assign.apply(this,arguments),t.TTMSFNCColorSelectorItem.isPrototypeOf(e)&&(this.FColor=rtl.as(e,t.TTMSFNCColorSelectorItem).FColor)},this.$rtti.addProperty("Color",2,pas["WEBLib.Graphics"].$rtti.TColor,"FColor","SetColor",{Default:-1})})),rtl.createClass(this,"TTMSFNCColorSelectorItems",pas["WEBLib.TMSFNCCustomSelector"].TTMSFNCCustomSelectorItems,(function(){this.$init=function(){pas["WEBLib.TMSFNCCustomSelector"].TTMSFNCCustomSelectorItems.$init.call(this),this.FOwner$2=null},this.$final=function(){this.FOwner$2=void 0,pas["WEBLib.TMSFNCCustomSelector"].TTMSFNCCustomSelectorItems.$final.call(this)},this.GetItem$2=function(t){return this.GetItem$1(t)},this.CreateItemClass=function(){return t.TTMSFNCColorSelectorItem},this.Create$3=function(e){return pas["WEBLib.TMSFNCCustomSelector"].TTMSFNCCustomSelectorItems.Create$3.apply(this,arguments),this.FOwner$2=rtl.as(e,t.TTMSFNCCustomColorSelector),this},this.Add$2=function(){return pas["WEBLib.TMSFNCCustomSelector"].TTMSFNCCustomSelectorItems.Add$1.call(this)},this.Insert$2=function(t){return pas["WEBLib.TMSFNCCustomSelector"].TTMSFNCCustomSelectorItems.Insert$1.call(this,t)}})),this.$rtti.$MethodVar("TTMSFNCCustomSelectorColorSelected",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AColor",pas["WEBLib.Graphics"].$rtti.TColor]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCCustomSelectorColorDeselected",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AColor",pas["WEBLib.Graphics"].$rtti.TColor]]),methodkind:0}),this.TTMSFNCCustomColorSelectorMode={0:"csmSimple",csmSimple:0,1:"csmExtended",csmExtended:1,2:"csmExtendedMore",csmExtendedMore:2},this.$rtti.$Enum("TTMSFNCCustomColorSelectorMode",{minvalue:0,maxvalue:2,ordtype:1,enumtype:this.TTMSFNCCustomColorSelectorMode}),rtl.createClass(this,"TTMSFNCCustomColorSelector",pas["WEBLib.TMSFNCCustomSelector"].TTMSFNCDefaultSelector,(function(){this.$init=function(){pas["WEBLib.TMSFNCCustomSelector"].TTMSFNCDefaultSelector.$init.call(this),this.w=0,this.h=0,this.FColorWheel=null,this.FPanel=null,this.FBackButton=null,this.FOnColorSelected=null,this.FOnColorDeselected=null,this.FMode=0},this.$final=function(){this.FColorWheel=void 0,this.FPanel=void 0,this.FBackButton=void 0,this.FOnColorSelected=void 0,this.FOnColorDeselected=void 0,pas["WEBLib.TMSFNCCustomSelector"].TTMSFNCDefaultSelector.$final.call(this)},this.SetSelectedColor=function(t){2===this.FMode&&this.GetItems().GetCount()>0&&this.GetItems().GetItem$2(this.GetItems().GetCount()-1).SetColor(t),this.SetSelectedItemIndex(this.FindItemByColor(t))},this.GetSelectedColor=function(){return this.FindColorByItem(this.FSelectedItemIndex)},this.GetItems=function(){return this.FItems},this.SetItems$1=function(t){this.GetItems().Assign(t)},this.SetMode=function(t){if(1,this.FMode!==t){this.FMode=t;var e=this.FMode;0===e?(this.SetWidth(Math.round(135)),this.SetHeight(Math.round(135))):1===e?(this.SetWidth(Math.round(200)),this.SetHeight(Math.round(135))):2===e&&(this.SetWidth(Math.round(200)),this.SetHeight(Math.round(175))),this.AddColors()}},this.GetVersion=function(){return this.$class.GetVersionNumber(1,0,1,0)},this.BackButtonClicked=function(t){null!=this.FPanel&&(this.FPanel.SetVisible(!1),this.FPanel.SetParent(null),this.SetWidth(Math.round(this.w)),this.SetHeight(Math.round(this.h)),this.WrapperSizeChanged(this.w,this.h),this.Invalidate())},this.ColorWheelChange=function(t,i){this.FBlockChange||(this.FBlockChange=!0,this.SetSelectedItemIndex(-1),this.GetItems().GetItem$2(this.GetItems().GetCount()-1).SetColor(e.AsColorWheel(this.FColorWheel).FSelectedColor),this.SetSelectedColor(e.AsColorWheel(this.FColorWheel).FSelectedColor),this.DoItemSelected(this.FSelectedItemIndex),this.Invalidate(),this.FBlockChange=!1)},this.DoItemClick=function(t){var i=0,s=0,o=0,n=0,r=0,a=0;if(this.FClosedRemotely)return this.FClosedRemotely=!1,void pas["WEBLib.TMSFNCCustomSelector"].TTMSFNCCustomSelector.DoItemClick.apply(this,arguments);2===this.FMode&&null!=this.FPanel&&t===this.GetItems().GetCount()-2&&(this.w=this.GetWidth(),this.h=this.GetHeight(),i=0,s=0,o=0,n=0,this.FColorWheel.GetControlMargins({get:function(){return i},set:function(t){i=t}},{get:function(){return s},set:function(t){s=t}},{get:function(){return o},set:function(t){o=t}},{get:function(){return n},set:function(t){n=t}}),a=this.ScalePaintValue(205)+this.FBackButton.GetHeight()+s+n,this.SetHeight(Math.round(a)),r=this.ScalePaintValue(350),this.SetWidth(Math.round(r)),this.WrapperSizeChanged(r,a),this.FBlockChange=!0,e.AsColorWheel(this.FColorWheel).SetSelectedColor(this.FindColorByItem(t+1)),this.FBlockChange=!1,this.FPanel.SetVisible(!0),this.FPanel.SetParent(this)),pas["WEBLib.TMSFNCCustomSelector"].TTMSFNCCustomSelector.DoItemClick.apply(this,arguments)},this.WrapperSizeChanged=function(t,e){},this.DoItemSelected=function(t){var i=0;pas["WEBLib.TMSFNCCustomSelector"].TTMSFNCCustomSelector.DoItemSelected.apply(this,arguments),i=this.FindColorByItem(t),null==this.FColorWheel||this.FBlockChange||(this.FBlockChange=!0,e.AsColorWheel(this.FColorWheel).SetSelectedColor(i),2===this.FMode&&this.GetItems().GetCount()>0&&this.GetItems().GetItem$2(this.GetItems().GetCount()-1).SetColor(i),this.FBlockChange=!1),null!=this.FOnColorSelected&&this.FOnColorSelected(this,i)},this.DoItemDeselected=function(t){pas["WEBLib.TMSFNCCustomSelector"].TTMSFNCCustomSelector.DoItemDeselected.apply(this,arguments),null!=this.FOnColorDeselected&&this.FOnColorDeselected(this,this.FindColorByItem(t))},this.CreateItemsCollection=function(){return t.TTMSFNCColorSelectorItems.$create("Create$3",[this])},this.DoItemBeforeDrawContent=function(t,e,i,s){2===this.FMode&&i>=0&&i<=this.GetItems().GetCount()-1&&s.set(!this.GetItems().GetItem$2(i).FDataBoolean),pas["WEBLib.TMSFNCCustomSelector"].TTMSFNCCustomSelector.DoItemBeforeDrawContent.apply(this,arguments)},this.DrawItemContent=function(e,i){var s=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),o=null,n=!1;if(null!=(o=i.Item)&&t.TTMSFNCColorSelectorItem.isPrototypeOf(o)&&(s.$assign(i.Rect),n=!0,this.DoItemBeforeDrawContent(e,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i.Rect),o.GetIndex(),{get:function(){return n},set:function(t){n=t}}),n)){var r=this.FMode;0===r?pas["WEBLib.TMSFNCTypes"].InflateRectEx(s,-5,-5):1!==r&&2!==r||pas["WEBLib.TMSFNCTypes"].InflateRectEx(s,-3,-3),e.FFill.SetKind(1),e.FFill.SetColor(rtl.as(o,t.TTMSFNCColorSelectorItem).FColor),e.FStroke.SetColor(e.FFill.FColor),e.DrawRectangle$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(s),2),this.DoItemAfterDrawContent(e,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i.Rect),o.GetIndex())}},this.AddColors=function(){var e=0,i=null;this.BeginUpdate(),this.GetItems().Clear();var s=this.FMode;if(0===s)for(this.SetColumns(4),this.SetRows(4),e=0;e<=15;e++)this.GetItems().Add$2().SetColor(t.TMSFNCColorSelectorColorSet[e]);else if(1===s)for(this.SetColumns(8),this.SetRows(5),e=0;e<=39;e++)this.GetItems().Add$2().SetColor(t.TMSFNCColorSelectorExtendedColorSet[e]);else if(2===s){for(this.SetColumns(8),this.SetRows(7),e=0;e<=39;e++)this.GetItems().Add$2().SetColor(t.TMSFNCColorSelectorExtendedColorSet[e]);(i=this.GetItems().Insert$2(0)).SetColor(0),i.SetColumnSpan(8),i.SetText("Automatic"),i.FDataBoolean=!0,(i=this.GetItems().Add$2()).SetColumnSpan(8),i.SetText("More Colors..."),i.SetCanSelect(!1),i.FDataBoolean=!0,this.GetItems().Add$2().SetVisible(!1)}this.EndUpdate()},this.ResetToDefaultStyle=function(){pas["WEBLib.TMSFNCCustomSelector"].TTMSFNCCustomSelector.ResetToDefaultStyle.call(this),this.BeginUpdate(),this.FAppearance.FFont.SetColor(4539717),this.FAppearance.FFill.SetColor(16380654),this.FAppearance.FFillSelected.SetColor(15776936),this.FAppearance.FStrokeSelected.SetColor(15702829),this.FAppearance.FFillDown.SetColor(15106394),this.FAppearance.FFillSelected.SetKind(1),this.FAppearance.FFill.SetKind(1),this.FAppearance.FFillDown.SetKind(1),this.FAppearance.FFillHover.SetKind(1),this.FAppearance.FStroke.SetKind(1),this.FAppearance.FStrokeSelected.SetKind(1),this.FAppearance.FStrokeHover.SetKind(1),this.FAppearance.FStroke.SetColor(11119017),this.FAppearance.FStrokeHover.SetColor(this.FAppearance.FFillDown.FColor),this.FAppearance.FStrokeDown.Assign(this.FAppearance.FStroke),this.EndUpdate()},this.Create$1=function(t){return pas["WEBLib.TMSFNCCustomSelector"].TTMSFNCCustomSelector.Create$1.apply(this,arguments),this.SetWidth(135),this.SetHeight(135),this.FMode=0,this.FPanel=pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.$create("Create$1",[this]),this.FPanel.SetVisible(!1),this.FPanel.FStored=!1,this.FPanel.SetControlAlignment(5),this.FBackButton=pas["WEBLib.StdCtrls"].TButton.$create("Create$1",[this.FPanel]),this.FBackButton.SetAlignWithMargins(!0),this.FBackButton.FMargins.SetTop(3),this.FBackButton.FMargins.SetLeft(3),this.FBackButton.FMargins.SetBottom(3),this.FBackButton.FMargins.SetRight(3),this.FBackButton.SetCaption("Back"),this.FBackButton.SetAlign(1),this.FBackButton.SetParent(this.FPanel),this.FBackButton.FOnClick=rtl.createCallback(this,"BackButtonClicked"),this.FColorWheel=pas["WEBLib.TMSFNCColorWheel"].TTMSFNCColorWheel.$create("Create$1",[this.FPanel]),e.AsColorWheel(this.FColorWheel).SetControlAlignment(5),e.AsColorWheel(this.FColorWheel).SetControlMargins(3,0,3,3),e.AsColorWheel(this.FColorWheel).SetParent(this.FPanel),e.AsColorWheel(this.FColorWheel).FOnSelectedColorChanged=rtl.createCallback(this,"ColorWheelChange"),this.IsDesignTime()&&this.InitSample(),this},this.FindItemByColor=function(e){var i=0,s=0,o=null;i=-1;for(var n=0,r=this.GetItems().GetCount()-1;n<=r;n++)if(s=n,(o=rtl.as(this.GetItems().GetItem$2(s),t.TTMSFNCColorSelectorItem)).FColor===e&&o.FCanSelect){i=o.GetIndex();break}return i},this.FindColorByItem=function(e){var i=0,s=0,o=null;i=-1;for(var n=0,r=this.GetItems().GetCount()-1;n<=r;n++)if(s=n,(o=rtl.as(this.GetItems().GetItem$2(s),t.TTMSFNCColorSelectorItem)).GetIndex()===e){i=o.FColor;break}return i},this.ColorWheelActive=function(){return null!=this.FPanel&&null!=this.FPanel.FParent&&this.FPanel.FVisible&&null!=this.FColorWheel&&null!=this.FColorWheel.FParent&&this.FColorWheel.FVisible},this.InitializeDefault=function(){pas["WEBLib.TMSFNCCustomSelector"].TTMSFNCCustomSelector.InitializeDefault.call(this),this.AddColors()},this.InitSample=function(){this.ResetToDefaultStyle()},rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas["WEBLib.TMSFNCTypes"].ITMSFNCProductInfo),rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TTMSFNCColorSelector",this.TTMSFNCCustomColorSelector,(function(){this.RegisterRuntimeClasses=function(){pas["WEBLib.TMSFNCCustomSelector"].TTMSFNCCustomSelector.RegisterRuntimeClasses.call(this),pas.Classes.RegisterClasses([t.TTMSFNCColorSelector,t.TTMSFNCColorSelectorItem])},rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas["WEBLib.TMSFNCTypes"].ITMSFNCProductInfo),rtl.addIntf(this,pas.System.IUnknown);var e=this.$rtti;e.addProperty("Appearance",2,pas["WEBLib.TMSFNCCustomSelector"].$rtti.TTMSFNCCustomSelectorAppearance,"FAppearance","SetAppearance"),e.addProperty("Rows",2,rtl.longint,"FRows","SetRows",{Default:4}),e.addProperty("Columns",2,rtl.longint,"FColumns","SetColumns",{Default:4}),e.addProperty("Items",3,t.$rtti.TTMSFNCColorSelectorItems,"GetItems","SetItems$1"),e.addProperty("Mode",2,t.$rtti.TTMSFNCCustomColorSelectorMode,"FMode","SetMode",{Default:t.TTMSFNCCustomColorSelectorMode.csmSimple}),e.addProperty("OnColorSelected",0,t.$rtti.TTMSFNCCustomSelectorColorSelected,"FOnColorSelected","FOnColorSelected"),e.addProperty("OnColorDeselected",0,t.$rtti.TTMSFNCCustomSelectorColorDeselected,"FOnColorDeselected","FOnColorDeselected"),e.addProperty("SelectedColor",3,pas["WEBLib.Graphics"].$rtti.TColor,"GetSelectedColor","SetSelectedColor",{Default:-1}),e.addProperty("OnItemSelected",0,pas["WEBLib.TMSFNCCustomSelector"].$rtti.TTMSFNCCustomSelectorItemSelected,"FOnItemSelected","FOnItemSelected"),e.addProperty("OnItemDeselected",0,pas["WEBLib.TMSFNCCustomSelector"].$rtti.TTMSFNCCustomSelectorItemDeselected,"FOnItemDeselected","FOnItemDeselected"),e.addProperty("OnItemClick",0,pas["WEBLib.TMSFNCCustomSelector"].$rtti.TTMSFNCCustomSelectorItemClick,"FOnItemClick","FOnItemClick"),e.addProperty("SelectedItemIndex",2,rtl.longint,"FSelectedItemIndex","SetSelectedItemIndex",{Default:-1}),e.addProperty("OnItemBeforeDrawBackground",0,pas["WEBLib.TMSFNCCustomSelector"].$rtti.TTMSFNCCustomSelectorItemBeforeDrawBackground,"FOnItemBeforeDrawBackground","FOnItemBeforeDrawBackground"),e.addProperty("OnItemAfterDrawBackground",0,pas["WEBLib.TMSFNCCustomSelector"].$rtti.TTMSFNCCustomSelectorItemAfterDrawBackground,"FOnItemAfterDrawBackground","FOnItemAfterDrawBackground"),e.addProperty("OnItemBeforeDrawContent",0,pas["WEBLib.TMSFNCCustomSelector"].$rtti.TTMSFNCCustomSelectorItemBeforeDrawContent,"FOnItemBeforeDrawContent","FOnItemBeforeDrawContent"),e.addProperty("OnItemAfterDrawContent",0,pas["WEBLib.TMSFNCCustomSelector"].$rtti.TTMSFNCCustomSelectorItemAfterDrawContent,"FOnItemAfterDrawContent","FOnItemAfterDrawContent"),e.addProperty("OnBeforeDraw",0,pas["WEBLib.TMSFNCCustomSelector"].$rtti.TTMSFNCCustomSelectorBeforeDraw,"FOnBeforeDraw$1","FOnBeforeDraw$1"),e.addProperty("OnAfterDraw",0,pas["WEBLib.TMSFNCCustomSelector"].$rtti.TTMSFNCCustomSelectorAfterDraw,"FOnAfterDraw$1","FOnAfterDraw$1"),e.addProperty("OnItemBeforeDrawText",0,pas["WEBLib.TMSFNCCustomSelector"].$rtti.TTMSFNCCustomSelectorItemBeforeDrawText,"FOnItemBeforeDrawText","FOnItemBeforeDrawText"),e.addProperty("OnItemAfterDrawText",0,pas["WEBLib.TMSFNCCustomSelector"].$rtti.TTMSFNCCustomSelectorItemAfterDrawText,"FOnItemAfterDrawText","FOnItemAfterDrawText"),e.attr=[pas.Classes.ComponentPlatformsAttribute,"Create$1",[0]]})),t.$implcode=function(){e.AsColorWheel=function(t){return rtl.as(t,pas["WEBLib.TMSFNCColorWheel"].TTMSFNCColorWheel)}}}),["SysUtils","WEBLib.TMSFNCUtils","WEBLib.TMSFNCColorWheel"]),rtl.module("WEBLib.TMSFNCToolBar",["System","Classes","WEBLib.TMSFNCGraphics","WEBLib.TMSFNCPersistence","WEBLib.TMSFNCStyles","WEBLib.TMSFNCCustomControl","WEBLib.Controls","Types","WEBLib.TMSFNCPopup","WEBLib.TMSFNCTypes","WEBLib.TMSFNCBitmapContainer","WEBLib.StdCtrls","WEBLib.TMSFNCColorSelector","WEBLib.TMSFNCToolBarRes","WEBLib.TMSFNCGraphicsTypes","contnrs","WEBLib.Menus","WEBLib.ExtCtrls"],(function(){"use strict";var t=this;this.MAJ_VER=1,this.MIN_VER=0,this.REL_VER=2,this.BLD_VER=2,this.TMSFNCTOOLBAREXPANDSVG="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMTIiIHdpZHRoPSIxMCI+DQogIDxwYXRoIGQ9Ik0gMiA0IEwgNSA3IEwgOCA0IFoiIHN0eWxlPSJzdHJva2U6YmxhY2s7c3Ryb2tlLXdpZHRoOjEiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgLz4NCjwvc3ZnPg==",rtl.createClass(this,"TTMSFNCToolBarCustomButtonAppearance",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FOwner=null,this.FHoverStroke=null,this.FDownFill=null,this.FNormalFill=null,this.FDownStroke=null,this.FDisabledFill=null,this.FNormalStroke=null,this.FDisabledStroke=null,this.FHoverFill=null,this.FCorners={},this.FRounding=0,this.FTransparent=!1,this.FShowInnerStroke=!1,this.FInnerStroke=null,this.FFlatStyle=!1,this.FOnChange=null},this.$final=function(){this.FOwner=void 0,this.FHoverStroke=void 0,this.FDownFill=void 0,this.FNormalFill=void 0,this.FDownStroke=void 0,this.FDisabledFill=void 0,this.FNormalStroke=void 0,this.FDisabledStroke=void 0,this.FHoverFill=void 0,this.FCorners=void 0,this.FInnerStroke=void 0,this.FOnChange=void 0,pas.Classes.TPersistent.$final.call(this)},this.SetDisabledFill=function(t){this.FDisabledFill.Assign(t)},this.SetDisabledStroke=function(t){this.FDisabledStroke.Assign(t)},this.SetDownFill=function(t){this.FDownFill.Assign(t)},this.SetDownStroke=function(t){this.FDownStroke.Assign(t)},this.SetHoverFill=function(t){this.FHoverFill.Assign(t)},this.SetHoverStroke=function(t){this.FHoverStroke.Assign(t)},this.SetNormalFill=function(t){this.FNormalFill.Assign(t)},this.SetNormalStroke=function(t){this.FNormalStroke.Assign(t)},this.SetCorners=function(t){rtl.neSet(this.FCorners,t)&&(this.FCorners=rtl.refSet(t),this.Changed())},this.SetRounding=function(t){this.FRounding!==t&&(this.FRounding=t,this.Changed())},this.SetInnerStroke=function(t){this.FInnerStroke.Assign(t)},this.SetShowInnerStroke=function(t){this.FShowInnerStroke!==t&&(this.FShowInnerStroke=t,this.Changed())},this.SetTransparent=function(t){this.FTransparent!==t&&(this.FTransparent=t,this.Changed())},this.IsRoundingStored=function(){return 3!==this.FRounding},this.SetFlatStyle=function(e){var i=null,s=0;if(this.FFlatStyle!==e){if(this.FFlatStyle=e,null!=this.FOwner)for(var o=0,n=this.FOwner.GetControlsCount()-1;o<=n;o++)s=o,i=this.FOwner.GetControls(s),t.TTMSFNCDefaultToolBarButton.isPrototypeOf(i)&&rtl.as(i,t.TTMSFNCDefaultToolBarButton).FAppearance.SetFlatStyle(this.FFlatStyle),t.TTMSFNCCustomToolBar.isPrototypeOf(i)&&rtl.as(i,t.TTMSFNCCustomToolBar).FAppearance.SetFlatStyle(this.FFlatStyle);this.Changed()}},this.FillChanged=function(t){this.Changed()},this.StrokeChanged=function(t){this.Changed()},this.Changed=function(){null!=this.FOwner?this.FOwner.AppearanceChanged():null!=this.FOnChange&&this.FOnChange(this)},this.Assign=function(e){t.TTMSFNCToolBarCustomButtonAppearance.isPrototypeOf(e)?(this.FNormalFill.Assign(rtl.as(e,t.TTMSFNCToolBarCustomButtonAppearance).FNormalFill),this.FDisabledFill.Assign(rtl.as(e,t.TTMSFNCToolBarCustomButtonAppearance).FDisabledFill),this.FHoverFill.Assign(rtl.as(e,t.TTMSFNCToolBarCustomButtonAppearance).FHoverFill),this.FDownFill.Assign(rtl.as(e,t.TTMSFNCToolBarCustomButtonAppearance).FDownFill),this.FNormalStroke.Assign(rtl.as(e,t.TTMSFNCToolBarCustomButtonAppearance).FNormalStroke),this.FDisabledStroke.Assign(rtl.as(e,t.TTMSFNCToolBarCustomButtonAppearance).FDisabledStroke),this.FHoverStroke.Assign(rtl.as(e,t.TTMSFNCToolBarCustomButtonAppearance).FHoverStroke),this.FDownStroke.Assign(rtl.as(e,t.TTMSFNCToolBarCustomButtonAppearance).FDownStroke),this.FRounding=rtl.as(e,t.TTMSFNCToolBarCustomButtonAppearance).FRounding,this.FCorners=rtl.refSet(rtl.as(e,t.TTMSFNCToolBarCustomButtonAppearance).FCorners),this.FShowInnerStroke=rtl.as(e,t.TTMSFNCToolBarCustomButtonAppearance).FShowInnerStroke,this.FTransparent=rtl.as(e,t.TTMSFNCToolBarCustomButtonAppearance).FTransparent,this.FFlatStyle=rtl.as(e,t.TTMSFNCToolBarCustomButtonAppearance).FFlatStyle):pas.Classes.TPersistent.Assign.apply(this,arguments)},this.Create$1=function(t){return this.FOwner=t,this.FCorners=rtl.createSet(0,1,2,3),this.FRounding=3,this.FTransparent=!1,this.FShowInnerStroke=!0,this.FFlatStyle=!1,this.FNormalFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[2,pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(249,251,252),pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(230,235,235),pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(220,220,236),pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(220,225,236)]),this.FHoverFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[2,pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(229,231,232),pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(210,215,215),pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(200,200,216),pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(200,205,216)]),this.FDownFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[2,pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(219,221,222),pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(200,205,205),pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(190,190,206),pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(190,195,206)]),this.FDisabledFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[1,13882323,8421504,-1,-1]),this.FNormalStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,8421504]),this.FInnerStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,16777215]),this.FHoverStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,8421504]),this.FDownStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,8421504]),this.FDisabledStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,8421504]),this.FNormalFill.FOnChanged=rtl.createCallback(this,"FillChanged"),this.FHoverFill.FOnChanged=rtl.createCallback(this,"FillChanged"),this.FDownFill.FOnChanged=rtl.createCallback(this,"FillChanged"),this.FDisabledFill.FOnChanged=rtl.createCallback(this,"FillChanged"),this.FInnerStroke.FOnChanged=rtl.createCallback(this,"StrokeChanged"),this.FNormalStroke.FOnChanged=rtl.createCallback(this,"StrokeChanged"),this.FHoverStroke.FOnChanged=rtl.createCallback(this,"StrokeChanged"),this.FDownStroke.FOnChanged=rtl.createCallback(this,"StrokeChanged"),this.FDisabledStroke.FOnChanged=rtl.createCallback(this,"StrokeChanged"),this},this.Destroy=function(){rtl.free(this,"FNormalFill"),rtl.free(this,"FHoverFill"),rtl.free(this,"FDownFill"),rtl.free(this,"FDisabledFill"),rtl.free(this,"FInnerStroke"),rtl.free(this,"FNormalStroke"),rtl.free(this,"FHoverStroke"),rtl.free(this,"FDownStroke"),rtl.free(this,"FDisabledStroke"),pas.System.TObject.Destroy.call(this)}})),rtl.createClass(this,"TTMSFNCToolBarButtonAppearance",this.TTMSFNCToolBarCustomButtonAppearance,(function(){var t=this.$rtti;t.addProperty("Transparent",2,rtl.boolean,"FTransparent","SetTransparent",{Default:!1}),t.addProperty("ShowInnerStroke",2,rtl.boolean,"FShowInnerStroke","SetShowInnerStroke",{Default:!0}),t.addProperty("Rounding",14,rtl.double,"FRounding","SetRounding",{stored:"IsRoundingStored"}),t.addProperty("Corners",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsCorners,"FCorners","SetCorners",{Default:rtl.createSet(0,1,2,3)}),t.addProperty("InnerStroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FInnerStroke","SetInnerStroke"),t.addProperty("NormalFill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FNormalFill","SetNormalFill"),t.addProperty("NormalStroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FNormalStroke","SetNormalStroke"),t.addProperty("HoverFill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FHoverFill","SetHoverFill"),t.addProperty("HoverStroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FHoverStroke","SetHoverStroke"),t.addProperty("DownFill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FDownFill","SetDownFill"),t.addProperty("DownStroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FDownStroke","SetDownStroke"),t.addProperty("DisabledFill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FDisabledFill","SetDisabledFill"),t.addProperty("DisabledStroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FDisabledStroke","SetDisabledStroke"),t.addProperty("FlatStyle",2,rtl.boolean,"FFlatStyle","SetFlatStyle",{Default:!1})})),rtl.createClass(this,"TTMSFNCToolBarCompactAppearance",this.TTMSFNCToolBarCustomButtonAppearance,(function(){var t=this.$rtti;t.addProperty("NormalFill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FNormalFill","SetNormalFill"),t.addProperty("NormalStroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FNormalStroke","SetNormalStroke"),t.addProperty("HoverFill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FHoverFill","SetHoverFill"),t.addProperty("HoverStroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FHoverStroke","SetHoverStroke"),t.addProperty("DownFill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FDownFill","SetDownFill"),t.addProperty("DownStroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FDownStroke","SetDownStroke"),t.addProperty("DisabledFill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FDisabledFill","SetDisabledFill"),t.addProperty("DisabledStroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FDisabledStroke","SetDisabledStroke"),t.addProperty("FlatStyle",2,rtl.boolean,"FFlatStyle","SetFlatStyle",{Default:!1})})),rtl.createClass(this,"TTMSFNCToolBarQuickMenuButtonAppearance",this.TTMSFNCToolBarCustomButtonAppearance,(function(){var t=this.$rtti;t.addProperty("NormalFill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FNormalFill","SetNormalFill"),t.addProperty("NormalStroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FNormalStroke","SetNormalStroke"),t.addProperty("HoverFill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FHoverFill","SetHoverFill"),t.addProperty("HoverStroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FHoverStroke","SetHoverStroke"),t.addProperty("DownFill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FDownFill","SetDownFill"),t.addProperty("DownStroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FDownStroke","SetDownStroke"),t.addProperty("DisabledFill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FDisabledFill","SetDisabledFill"),t.addProperty("DisabledStroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FDisabledStroke","SetDisabledStroke"),t.addProperty("FlatStyle",2,rtl.boolean,"FFlatStyle","SetFlatStyle",{Default:!1})})),this.TTMSFNCToolBarElementState={0:"esNormal",esNormal:0,1:"esLarge",esLarge:1},this.$rtti.$Enum("TTMSFNCToolBarElementState",{minvalue:0,maxvalue:1,ordtype:1,enumtype:this.TTMSFNCToolBarElementState}),rtl.createClass(this,"TTMSFNCCustomToolBarElement",pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl,(function(){this.$init=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.$init.call(this),this.FBlockUpdate=!1,this.FOnUpdateToolBar=null,this.FOnUpdateToolBarControl=null,this.FCanCopy=!1,this.FState=0,this.FLastElement=!1,this.FControlIndex=0},this.$final=function(){this.FOnUpdateToolBar=void 0,this.FOnUpdateToolBarControl=void 0,pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.$final.call(this)},this.SetState=function(t){this.FState!==t&&(this.FState=t,this.UpdateState())},this.SetLastElement=function(t){this.FLastElement!==t&&(this.FLastElement=t,this.UpdateToolBar())},this.GetDocURL=function(){return pas["WEBLib.TMSFNCTypes"].TTMSFNCBaseDocURL+"tmsfncuipack/components/ttmsfnctoolbar"},this.UpdateState=function(){},this.UpdateToolBar=function(){null==this.FOnUpdateToolBar||this.FBlockUpdate||this.FOnUpdateToolBar(this)},this.VisibleChanging=function(){pas["WEBLib.Controls"].TControl.VisibleChanging.call(this),this.UpdateToolBar()},this.UpdateControlAfterResize=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.UpdateControlAfterResize.call(this),this.UpdateToolBar()},this.Assign=function(e){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Assign.apply(this,arguments),t.TTMSFNCCustomToolBarElement.isPrototypeOf(e)&&(this.FState=rtl.as(e,t.TTMSFNCCustomToolBarElement).FState,this.FLastElement=rtl.as(e,t.TTMSFNCCustomToolBarElement).FLastElement,this.FCanCopy=rtl.as(e,t.TTMSFNCCustomToolBarElement).FCanCopy)},this.Create$1=function(t){return pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Create$1.apply(this,arguments),this.DisableBackground(),this.FLastElement=!1,this.FCanCopy=!0,this.FState=0,this},this.Destroy=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Destroy.call(this)},rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas["WEBLib.TMSFNCTypes"].ITMSFNCProductInfo),rtl.addIntf(this,pas.System.IUnknown)})),this.TTMSFNCToolBarButtonBitmapPosition={0:"bbpLeft",bbpLeft:0,1:"bbpTop",bbpTop:1},this.$rtti.$Enum("TTMSFNCToolBarButtonBitmapPosition",{minvalue:0,maxvalue:1,ordtype:1,enumtype:this.TTMSFNCToolBarButtonBitmapPosition}),this.TTMSFNCToolBarButtonLayout={0:"bblNone",bblNone:0,1:"bblBitmap",bblBitmap:1,2:"bblLabel",bblLabel:2,3:"bblLarge",bblLarge:3},this.$rtti.$Enum("TTMSFNCToolBarButtonLayout",{minvalue:0,maxvalue:3,ordtype:1,enumtype:this.TTMSFNCToolBarButtonLayout}),rtl.createClass(this,"TTMSFNCDefaultToolBarButton",this.TTMSFNCCustomToolBarElement,(function(){this.$init=function(){t.TTMSFNCCustomToolBarElement.$init.call(this),this.FOldHeight=0,this.FBitmapVisible=!1,this.FText="",this.FPopup=null,this.FPopupPlacement=0,this.FDropDownHeight=0,this.FDropDownWidth=0,this.FDown=!1,this.FHover=!1,this.FPrevHover=!1,this.FAppearance=null,this.FBitmapContainer=null,this.FBitmaps=null,this.FApplyName=!1,this.FDropDownControl=null,this.FFont$1=null,this.FOnBeforeDropDown=null,this.FCloseOnSelection=!1,this.FDownState=!1,this.FTextVisible=!1,this.FOnCloseDropDown=null,this.FOnDropDown=null,this.FVerticalTextAlign=0,this.FHorizontalTextAlign=0,this.FWordWrapping=!1,this.FTrimming=0,this.FBitmapSize=0,this.FStretchText=!1,this.FDisabledBitmaps=null,this.FHoverBitmaps=null,this.FShowFocus$1=!1,this.FDropDownAutoWidth=!1,this.FHoverFontColor=0,this.FDownFontColor=0,this.FDisabledFontColor=0,this.FStretchBitmapIfNoText=!1,this.FBitmapPosition=0,this.FMaximumLayout=0,this.FMinimumLayout=0,this.FLayout=0,this.FCompactLayout=0,this.FLargeLayoutBitmapSize=0,this.FLargeLayoutBitmaps=null,this.FLargeLayoutHoverBitmaps=null,this.FLargeLayoutDisabledBitmaps=null,this.FAutoBitmapSize=!1,this.FLargeLayoutAutoBitmapSize=!1},this.$final=function(){this.FPopup=void 0,this.FAppearance=void 0,this.FBitmapContainer=void 0,this.FBitmaps=void 0,this.FDropDownControl=void 0,this.FFont$1=void 0,this.FOnBeforeDropDown=void 0,this.FOnCloseDropDown=void 0,this.FOnDropDown=void 0,this.FDisabledBitmaps=void 0,this.FHoverBitmaps=void 0,this.FLargeLayoutBitmaps=void 0,this.FLargeLayoutHoverBitmaps=void 0,this.FLargeLayoutDisabledBitmaps=void 0,t.TTMSFNCCustomToolBarElement.$final.call(this)},this.SetAppearance=function(t){this.FAppearance.Assign(t)},this.SetBitmapContainer=function(t){this.FBitmapContainer=t,this.UpdateLayout(),this.Invalidate()},this.SetBitmaps=function(t){this.FBitmaps.Assign(t)},this.SetText=function(t){this.FText!==t&&(this.FText=t,this.FTextVisible=""!==t,this.UpdateLayout(),this.Invalidate())},this.SetDropDownHeight=function(t){this.FDropDownHeight=t,null==this.FPopup||this.FDropDownAutoWidth||this.FPopup.SetDropDownHeight(this.FDropDownHeight)},this.SetDropDownWidth=function(t){this.FDropDownWidth=t,null!=this.FPopup&&this.FPopup.SetDropDownWidth(this.FDropDownWidth)},this.SetBitmapVisible=function(t){this.FBitmapVisible=t,this.UpdateLayout(),this.Invalidate()},this.SetTextVisible=function(t){this.FTextVisible!==t&&(this.FTextVisible=t,this.UpdateLayout(),this.Invalidate())},this.SetFont$1=function(t){this.FFont$1.Assign(t)},this.SetDropDownControl=function(t){this.FDropDownControl=t,null!=this.FDropDownControl&&(4 in this.FComponentState?4 in this.FComponentState&&(this.SetDropDownHeight(this.FDropDownControl.GetHeight()),this.SetDropDownWidth(this.FDropDownControl.GetWidth())):null!=this.FPopup&&(this.FPopup.SetContentControl(this.FDropDownControl),this.FPopup.FFocusedControl=this.FDropDownControl))},this.IsDropDownHeightStored=function(){return 135!==this.FDropDownHeight},this.IsDropDownWidthStored=function(){return 135!==this.FDropDownWidth},this.SetHorizontalTextAlign=function(t){this.FHorizontalTextAlign!==t&&(this.FHorizontalTextAlign=t,this.Invalidate())},this.SetVerticalTextAlign=function(t){this.FVerticalTextAlign!==t&&(this.FVerticalTextAlign=t,this.Invalidate())},this.SetWordWrapping=function(t){this.FWordWrapping!==t&&(this.FWordWrapping=t,this.Invalidate())},this.SetTrimming=function(t){this.FTrimming!==t&&(this.FTrimming=t,this.Invalidate())},this.IsBitmapSizeStored=function(){return 24!==this.FBitmapSize},this.SetBitmapSize=function(t){this.FBitmapSize!==t&&(this.FBitmapSize=t,this.UpdateLayout(),this.Invalidate())},this.SetStretchText=function(t){this.FStretchText!==t&&(this.FStretchText=t,this.UpdateLayout(),this.Invalidate())},this.SetDisabledBitmaps=function(t){this.FDisabledBitmaps.Assign(t)},this.SetHoverBitmaps=function(t){this.FHoverBitmaps.Assign(t)},this.GetBitmapContainer=function(){return this.FBitmapContainer},this.SetShowFocus$1=function(t){this.FShowFocus$1!==t&&(this.FShowFocus$1=t,this.Invalidate())},this.SetDropDownAutoWidth=function(t){this.FDropDownAutoWidth!==t&&(this.FDropDownAutoWidth=t,null!=this.FPopup&&(this.FDropDownAutoWidth?this.FPopup.SetDropDownWidth(this.GetWidth()):this.FPopup.SetDropDownWidth(this.FDropDownWidth)))},this.SetStretchBitmapIfNoText=function(t){this.FStretchBitmapIfNoText!==t&&(this.FStretchBitmapIfNoText=t,this.UpdateLayout(),this.Invalidate())},this.SetBitmapPosition=function(t){this.FBitmapPosition!==t&&(this.FBitmapPosition=t,this.Invalidate())},this.SetMaximumLayout=function(t){this.FMaximumLayout!==t&&(this.FMaximumLayout=t,this.UpdateToolBar())},this.SetMinimumLayout=function(t){this.FMinimumLayout!==t&&(this.FMinimumLayout=t,this.UpdateToolBar())},this.SetLayout=function(t){this.FLayout!==t&&(this.FLayout=t,this.UpdateLayout())},this.SetCompactLayout=function(t){this.FCompactLayout!==t&&(this.FCompactLayout=t)},this.IsLargeLayoutBitmapSizeStored=function(){return 32!==this.FLargeLayoutBitmapSize},this.SetLargeLayoutBitmaps=function(t){this.FLargeLayoutBitmaps.Assign(t)},this.SetLargeLayoutBitmapSize=function(t){this.FLargeLayoutBitmapSize!==t&&(this.FLargeLayoutBitmapSize=t,this.UpdateLayout(),this.Invalidate())},this.SetLargeLayoutDisabledBitmaps=function(t){this.FLargeLayoutDisabledBitmaps.Assign(t)},this.SetLargeLayoutHoverBitmaps=function(t){this.FLargeLayoutHoverBitmaps.Assign(t)},this.SetAutoBitmapSize=function(t){this.FAutoBitmapSize!==t&&(this.FAutoBitmapSize=t,this.UpdateLayout(),this.Invalidate())},this.SetLargeLayoutAutoBitmapSize=function(t){this.FLargeLayoutAutoBitmapSize!==t&&(this.FLargeLayoutAutoBitmapSize=t,this.UpdateLayout(),this.Invalidate())},this.CanDrawDesignTime=function(){return!1,!1},this.GetText=function(){return this.FText},this.GetTextSize=function(){var t=pas["WEBLib.TMSFNCTypes"].TSizeF.$new(),e=null,i=pas["WEBLib.TMSFNCTypes"].TRectF.$new();if(t.cx=0,t.cy=0,this.FTextVisible&&""!==this.GetText()){e=pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.$create("CreateBitmapCanvas",[1,1,this.FNativeCanvas,!0]),this.FNativeCanvas||e.BeginScene(),e.FBitmapContainer=this.GetBitmapContainer(),e.FOptimizedHTMLDrawing=this.FOptimizedHTMLDrawing;try{e.FFont.Assign(this.FFont$1),i.$assign(this.GetLocalRect()),pas["WEBLib.TMSFNCTypes"].InflateRectEx(i,this.ScalePaintValue(-2),this.ScalePaintValue(-2)),t.$assign(e.CalculateTextSize(this.GetText(),pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),this.FWordWrapping,!0))}finally{this.FNativeCanvas||e.EndScene(),e=rtl.freeLoc(e)}}return t},this.UpdateControlAfterResize=function(){t.TTMSFNCCustomToolBarElement.UpdateControlAfterResize.call(this),3===this.FLayout&&(this.FOldHeight=this.GetHeight())},this.ApplyStyle=function(){var t=0;pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.ApplyStyle.call(this),t=-1,pas["WEBLib.TMSFNCStyles"].TTMSFNCStyles.GetStyleBackgroundFillColor({get:function(){return t},set:function(e){t=e}})&&(this.FAppearance.FNormalFill.SetColor(t),this.FAppearance.FNormalFill.SetKind(1),this.FAppearance.FDisabledFill.SetColor(pas["WEBLib.TMSFNCGraphicsTypes"].Blend(t,11119017,20)),this.FAppearance.FDisabledFill.SetKind(1),this.FAppearance.FInnerStroke.SetColor(pas["WEBLib.TMSFNCGraphicsTypes"].Blend(this.FAppearance.FNormalFill.FColor,this.FAppearance.FNormalStroke.FColor,75)),this.FAppearance.FInnerStroke.SetKind(1)),t=-1,pas["WEBLib.TMSFNCStyles"].TTMSFNCStyles.GetStyleTextFontColor({get:function(){return t},set:function(e){t=e}})&&this.FFont$1.SetColor(t),t=-1,pas["WEBLib.TMSFNCStyles"].TTMSFNCStyles.GetStyleBackgroundStrokeColor({get:function(){return t},set:function(e){t=e}})&&(this.FAppearance.FNormalStroke.SetColor(t),this.FAppearance.FDownStroke.SetColor(t),this.FAppearance.FDisabledStroke.SetColor(t),this.FAppearance.FNormalStroke.SetColor(t),this.FAppearance.FDownStroke.SetColor(t),this.FAppearance.FDisabledStroke.SetColor(t),this.FAppearance.FHoverStroke.SetColor(t)),t=-1,pas["WEBLib.TMSFNCStyles"].TTMSFNCStyles.GetStyleSelectionFillColor({get:function(){return t},set:function(e){t=e}})&&(this.FAppearance.FHoverFill.SetColor(t),this.FAppearance.FHoverFill.SetKind(1),this.FAppearance.FDownFill.SetColor(pas["WEBLib.TMSFNCGraphicsTypes"].Blend(t,this.FFill.FColor,20)),this.FAppearance.FDownFill.SetKind(1))},this.ResetToDefaultStyle=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.ResetToDefaultStyle.call(this),this.FFont$1.SetColor(0),this.FAppearance.FNormalFill.SetColor(16777215),this.FAppearance.FHoverFill.SetColor(16777215),this.FAppearance.FDownFill.SetColor(16777215),this.FAppearance.FDisabledFill.SetColor(13882323),this.FAppearance.FNormalStroke.SetColor(8421504),this.FAppearance.FInnerStroke.SetColor(16777215),this.FAppearance.FHoverStroke.SetColor(8421504),this.FAppearance.FDownStroke.SetColor(8421504),this.FAppearance.FDisabledStroke.SetColor(8421504),this.FAppearance.FNormalFill.SetKind(2),this.FAppearance.FHoverFill.SetKind(2),this.FAppearance.FDownFill.SetKind(2),this.FAppearance.FDisabledFill.SetKind(1),this.FAppearance.FNormalStroke.SetKind(1),this.FAppearance.FInnerStroke.SetKind(1),this.FAppearance.FHoverStroke.SetKind(1),this.FAppearance.FDownStroke.SetKind(1),this.FAppearance.FDisabledStroke.SetKind(1),this.FAppearance.FNormalFill.SetColor(pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(249,251,252)),this.FAppearance.FNormalFill.SetColorTo(pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(230,235,235)),this.FAppearance.FNormalFill.SetColorMirror(pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(220,220,236)),this.FAppearance.FNormalFill.SetColorMirrorTo(pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(220,225,236)),this.FAppearance.FHoverFill.SetColor(pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(229,231,232)),this.FAppearance.FHoverFill.SetColorTo(pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(210,215,215)),this.FAppearance.FHoverFill.SetColorMirror(pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(200,200,216)),this.FAppearance.FHoverFill.SetColorMirrorTo(pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(200,205,216)),this.FAppearance.FDownFill.SetColor(pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(219,221,222)),this.FAppearance.FDownFill.SetColorTo(pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(200,205,205)),this.FAppearance.FDownFill.SetColorMirror(pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(190,190,206)),this.FAppearance.FDownFill.SetColorMirrorTo(pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(190,195,206))},this.SetAdaptToStyle=function(t){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.SetAdaptToStyle.apply(this,arguments),null!=this.FPopup&&this.FPopup.SetAdaptToStyle(this.GetAdaptToStyle())},this.BitmapsChanged=function(t){var e=null;e=pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.GetScaledBitmap(this.FBitmaps,0,this.GetBitmapContainer()),this.SetBitmapVisible(null!=e&&!pas["WEBLib.TMSFNCTypes"].IsBitmapEmpty(e)),this.FBitmapVisible||3!==this.FLayout||(e=pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.GetScaledBitmap(this.FLargeLayoutBitmaps,0,this.GetBitmapContainer()),this.SetBitmapVisible(null!=e&&!pas["WEBLib.TMSFNCTypes"].IsBitmapEmpty(e))),this.Invalidate()},this.DoFontChanged=function(t){this.Invalidate()},this.UpdateLayout=function(){var t=pas["WEBLib.TMSFNCTypes"].TSizeF.$new(),e=0;if(0!==this.FLayout&&!this.FBlockUpdate){this.FBlockUpdate=!0;var i=this.FLayout;1===i?(this.SetTextVisible(!1),this.SetBitmapPosition(0),this.SetStretchText(!1),this.SetHeight(Math.round(this.GetBitmapSize()+6)),this.SetWidth(Math.round(this.GetBitmapSize()+6))):2===i?(this.SetTextVisible(!0),this.SetBitmapPosition(0),this.SetStretchText(!1),t.$assign(this.GetTextSize()),this.FBitmapVisible?(this.SetHeight(Math.round(Math.max(this.GetBitmapSize(),t.cy)+6)),this.SetWidth(Math.round(this.GetBitmapSize()+t.cx+12))):this.FTextVisible&&""!==this.GetText()?(this.SetHeight(Math.round(t.cy+6)),this.SetWidth(Math.round(t.cx+6))):(this.SetWidth(75),this.SetHeight(24))):3===i&&(this.SetTextVisible(!0),this.SetBitmapPosition(1),this.SetStretchText(!this.FBitmapVisible),t.$assign(this.GetTextSize()),e=30,this.FBitmapVisible&&(e=Math.max(e,this.GetLargeLayoutBitmapSize()+6)),this.FTextVisible&&""!==this.GetText()&&(e=Math.max(e,t.cx+12)),this.SetWidth(Math.round(e)),-1!==this.FOldHeight&&this.SetHeight(Math.round(this.FOldHeight))),this.FBlockUpdate=!1,this.UpdateToolBar()}},this.DoClosePopup=function(t){null!=this.FOnCloseDropDown&&this.FOnCloseDropDown(this)},this.DoPopup=function(t){this.InitializePopup()},this.InitializePopup=function(){},this.UpdateState=function(){var e=0;t.TTMSFNCCustomToolBarElement.UpdateState.call(this);var i=this.FState;e=0===i?.8:1===i?1.25:1,0 in this.FComponentState||(this.SetDropDownWidth(this.FDropDownWidth*e),this.SetDropDownHeight(this.FDropDownHeight*e),this.FFont$1.SetSize(Math.round(this.FFont$1.FSize*e)),this.SetBounds(this.GetLeft(),this.GetTop(),Math.round(this.GetWidth()*e),Math.round(this.GetHeight()*e)))},this.AppearanceChanged=function(){this.Invalidate()},this.Notification=function(t,e){pas["WEBLib.Menus"].TWebCustomControl.Notification.apply(this,arguments),1===e&&t===this.FBitmapContainer&&(this.FBitmapContainer=null),1===e&&t===this.FDropDownControl&&(this.FDropDownControl=null)},this.SetName=function(t){var e;e=!(0 in this.FComponentState||this.FName!==this.GetText()||null!=this.FOwner&&pas.Classes.TComponent.isPrototypeOf(this.FOwner)&&0 in this.FOwner.FComponentState),pas["WEBLib.Controls"].TCustomControl.SetName.call(this,t),e&&this.FApplyName&&this.CanChangeText()&&this.SetText(pas.SysUtils.StringReplace(this.GetText(),"TMSFNCToolBar","",rtl.createSet(0)))},this.HandleMouseDown=function(t,e,i,s){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleMouseDown.apply(this,arguments),this.CanFocus()&&this.SetFocus(),this.FDown=!0,this.Invalidate()},this.HandleMouseMove=function(t,e,i){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleMouseMove.apply(this,arguments),this.FHover=!0,this.FPrevHover!==this.FHover&&this.Invalidate(),this.FPrevHover=this.FHover},this.HandleMouseUp=function(t,e,i,s){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleMouseUp.apply(this,arguments),this.FDown=!1,this.Invalidate()},this.HandleKeyUp=function(t,e){if(pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleKeyUp.apply(this,arguments),!rtl.neSet(e,{})){var i=t.get();13!==i&&115!==i||this.CanDropDown()&&this.DropDown()}},this.HandleKeyDown=function(t,e){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleKeyDown.apply(this,arguments);var i=t.get();36===i?this.SelectFirstValue():35===i?this.SelectLastValue():38===i||37===i?this.SelectPreviousValue():40===i||39===i?this.SelectNextValue():32===i&&this.Click()},this.HandleKeyPress=function(t){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleKeyPress.apply(this,arguments),t.get()>=" "&&!(t.get().charCodeAt()in rtl.createSet(113,13,32,27,36,35,38,37,40,39))&&this.SelectValueWithCharacter(t.get())},this.HandleMouseEnter=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleMouseEnter.call(this)},this.HandleMouseLeave=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleMouseLeave.call(this),this.FDown=!1,this.FHover=!1,this.FPrevHover=!1,this.Invalidate()},this.SelectFirstValue=function(){},this.SelectValueWithCharacter=function(t){},this.SelectLastValue=function(){},this.SelectNextValue=function(){},this.SelectPreviousValue=function(){},this.DrawText=function(t){var e,i=pas["WEBLib.TMSFNCTypes"].TRectF.$new();if(this.FTextVisible&&""!==this.GetText()){i.$assign(this.GetTextRect()),e=t.SaveState(!1);try{t.ClipRect(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i)),t.FFont.Assign(this.FFont$1),this.FEnabled?(this.FDown||this.FDownState)&&-1!==this.FDownFontColor?t.FFont.SetColor(this.FDownFontColor):this.FHover&&-1!==this.FHoverFontColor&&t.FFont.SetColor(this.FHoverFontColor):-1!==this.FDisabledFontColor&&t.FFont.SetColor(this.FDisabledFontColor),t.DrawText$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),this.GetText(),this.FWordWrapping,this.FHorizontalTextAlign,this.FVerticalTextAlign,this.FTrimming,0,-1,-1,!0,!1,-1,-1)}finally{t.RestoreState(e,!1)}}},this.DrawBitmap=function(e,i){var s=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),o=null,n=null,r=null,a=0,l=0;if(this.FBitmapVisible)if(s.$assign(this.GetBitmapRect$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i))),t.TTMSFNCToolBarDropDownButton.isPrototypeOf(this)&&this.GetAdaptToStyle()){(o=pas["WEBLib.Graphics"].TBitmap.$create("Create$3")).SetSize(this.ScalePaintValue(7),this.ScalePaintValue(7)),r=pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.$create("Create$1",[o.GetCanvas(),!1]);try{r.BeginScene(),r.FStroke.SetKind(1),r.FStroke.SetColor(pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.DefaultSelectionFillColor);for(var h=this.ScalePaintValue(1),F=this.ScalePaintValue(5);h<=F&&(l=h,a=Math.max(0,l-this.ScalePaintValue(2)),r.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(a,l)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(o.GetWidth()-1-a,l)),2,2),!(a>=o.GetWidth()-1-a));h++);}finally{r.EndScene(),r=rtl.freeLoc(r)}try{n=pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.$create("Create$3");try{n.Assign(o),e.DrawBitmap$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(s),n,!0,!1,!0,!1)}finally{n=rtl.freeLoc(n)}}finally{o=rtl.freeLoc(o)}}else{e.FBitmapContainer=this.GetBitmapContainer(),3===this.FLayout?this.FEnabled?this.FHover&&this.FLargeLayoutHoverBitmaps.GetCount()>0?e.DrawScaledBitmap(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(s),this.FLargeLayoutHoverBitmaps,this.FResourceScaleFactor,!0,!1,!0,!1):this.FHover&&this.FHoverBitmaps.GetCount()>0?e.DrawScaledBitmap(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(s),this.FHoverBitmaps,this.FResourceScaleFactor,!0,!1,!0,!1):this.FLargeLayoutBitmaps.GetCount()>0?e.DrawScaledBitmap(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(s),this.FLargeLayoutBitmaps,this.FResourceScaleFactor,!0,!1,!0,!1):e.DrawScaledBitmap(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(s),this.FBitmaps,this.FResourceScaleFactor,!0,!1,!0,!1):this.FLargeLayoutDisabledBitmaps.GetCount()>0?e.DrawScaledBitmap(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(s),this.FLargeLayoutDisabledBitmaps,this.FResourceScaleFactor,!0,!1,!0,!1):this.FDisabledBitmaps.GetCount()>0?e.DrawScaledBitmap(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(s),this.FDisabledBitmaps,this.FResourceScaleFactor,!0,!1,!0,!1):e.DrawScaledBitmap(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(s),this.FBitmaps,this.FResourceScaleFactor,!0,!1,!0,!1):this.FEnabled?this.FHover&&this.FHoverBitmaps.GetCount()>0?e.DrawScaledBitmap(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(s),this.FHoverBitmaps,this.FResourceScaleFactor,!0,!1,!0,!1):e.DrawScaledBitmap(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(s),this.FBitmaps,this.FResourceScaleFactor,!0,!1,!0,!1):this.FDisabledBitmaps.GetCount()>0?e.DrawScaledBitmap(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(s),this.FDisabledBitmaps,this.FResourceScaleFactor,!0,!1,!0,!1):e.DrawScaledBitmap(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(s),this.FBitmaps,this.FResourceScaleFactor,!0,!1,!0,!1)}},this.DrawButton=function(t){},this.CanDropDown=function(){return!1,!1},this.CanChangeText=function(){return!0,!0},this.GetTextRect=function(){var t=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),e=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),i=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),s=pas["WEBLib.TMSFNCTypes"].TRectF.$new();if(s.$assign(this.GetLocalRect()),e.$assign(this.GetBitmapRect()),i.$assign(this.GetDropDownRect()),this.FStretchText)t.$assign(pas["WEBLib.TMSFNCTypes"].RectF(s.Left+3,s.Top+3,i.Left-3,s.Bottom-3));else{var o=this.FBitmapPosition;0===o?t.$assign(pas["WEBLib.TMSFNCTypes"].RectF(e.Right+3,s.Top+3,i.Left-3,s.Bottom-3)):1===o&&t.$assign(pas["WEBLib.TMSFNCTypes"].RectF(s.Left+3,e.Bottom+3,i.Left-3,s.Bottom-3))}return t},this.GetDropDownRect=function(){var t=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),e=pas["WEBLib.TMSFNCTypes"].TRectF.$new();return e.$assign(this.GetLocalRect()),t.$assign(pas["WEBLib.TMSFNCTypes"].RectF(e.Right,e.Top,e.Right,e.Bottom)),t},this.GetBitmapRect=function(){var t=pas["WEBLib.TMSFNCTypes"].TRectF.$new();return t.$assign(this.GetBitmapRect$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(this.GetLocalRect()))),t},this.GetBitmapRect$1=function(t){var e=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),i=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),s=0;if(s=this.GetBitmapSize(),3===this.FLayout&&(s=this.GetLargeLayoutBitmapSize()),i.$assign(t),e.$assign(pas["WEBLib.TMSFNCTypes"].RectF(i.Left,i.Top,i.Left,i.Bottom)),this.FBitmapVisible){var o=this.FBitmapPosition;0===o?e.$assign(pas["WEBLib.TMSFNCTypes"].RectF(e.Left+3,e.Top+3,e.Left+3+s,e.Bottom-3)):1===o&&e.$assign(pas["WEBLib.TMSFNCTypes"].RectF(e.Left+3,e.Top+3,e.Right-3,e.Top+3+s))}return e},this.GetBitmapSize=function(){var t=0,e=null;return t=this.FBitmapSize,this.FAutoBitmapSize&&(null==(e=pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.GetScaledBitmap(this.FBitmaps,0,this.GetBitmapContainer()))||pas["WEBLib.TMSFNCTypes"].IsBitmapEmpty(e)||(t=Math.max(e.GetHeight(),e.GetWidth()))),t},this.GetLargeLayoutBitmapSize=function(){var t=0,e=null;return t=this.FLargeLayoutBitmapSize,this.FLargeLayoutAutoBitmapSize&&(null==(e=pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.GetScaledBitmap(this.FLargeLayoutBitmaps,0,this.GetBitmapContainer()))||pas["WEBLib.TMSFNCTypes"].IsBitmapEmpty(e)||(t=Math.max(e.GetHeight(),e.GetWidth()))),t},this.Assign=function(e){t.TTMSFNCCustomToolBarElement.Assign.apply(this,arguments),t.TTMSFNCDefaultToolBarButton.isPrototypeOf(e)&&(this.FLayout=rtl.as(e,t.TTMSFNCDefaultToolBarButton).FLayout,this.FCompactLayout=rtl.as(e,t.TTMSFNCDefaultToolBarButton).FCompactLayout,this.FMinimumLayout=rtl.as(e,t.TTMSFNCDefaultToolBarButton).FMinimumLayout,this.FMaximumLayout=rtl.as(e,t.TTMSFNCDefaultToolBarButton).FMaximumLayout,this.FBitmapPosition=rtl.as(e,t.TTMSFNCDefaultToolBarButton).FBitmapPosition,this.FBitmapSize=rtl.as(e,t.TTMSFNCDefaultToolBarButton).FBitmapSize,this.FLargeLayoutBitmapSize=rtl.as(e,t.TTMSFNCDefaultToolBarButton).FLargeLayoutBitmapSize,this.FAutoBitmapSize=rtl.as(e,t.TTMSFNCDefaultToolBarButton).FAutoBitmapSize,this.FLargeLayoutAutoBitmapSize=rtl.as(e,t.TTMSFNCDefaultToolBarButton).FLargeLayoutAutoBitmapSize,this.FStretchBitmapIfNoText=rtl.as(e,t.TTMSFNCDefaultToolBarButton).FStretchBitmapIfNoText,this.FAppearance.Assign(rtl.as(e,t.TTMSFNCDefaultToolBarButton).FAppearance),this.FBitmapContainer=rtl.as(e,t.TTMSFNCDefaultToolBarButton).GetBitmapContainer(),this.FBitmaps.Assign(rtl.as(e,t.TTMSFNCDefaultToolBarButton).FBitmaps),this.FDisabledBitmaps.Assign(rtl.as(e,t.TTMSFNCDefaultToolBarButton).FDisabledBitmaps),this.FLargeLayoutHoverBitmaps.Assign(rtl.as(e,t.TTMSFNCDefaultToolBarButton).FLargeLayoutHoverBitmaps),this.FLargeLayoutBitmaps.Assign(rtl.as(e,t.TTMSFNCDefaultToolBarButton).FLargeLayoutBitmaps),this.FLargeLayoutDisabledBitmaps.Assign(rtl.as(e,t.TTMSFNCDefaultToolBarButton).FLargeLayoutDisabledBitmaps),this.FHoverBitmaps.Assign(rtl.as(e,t.TTMSFNCDefaultToolBarButton).FHoverBitmaps),this.FBitmapVisible=rtl.as(e,t.TTMSFNCDefaultToolBarButton).FBitmapVisible,this.FText=rtl.as(e,t.TTMSFNCDefaultToolBarButton).GetText(),this.FTextVisible=rtl.as(e,t.TTMSFNCDefaultToolBarButton).FTextVisible,this.FDropDownHeight=rtl.as(e,t.TTMSFNCDefaultToolBarButton).FDropDownHeight,this.FDropDownWidth=rtl.as(e,t.TTMSFNCDefaultToolBarButton).FDropDownWidth,this.FDropDownAutoWidth=rtl.as(e,t.TTMSFNCDefaultToolBarButton).FDropDownAutoWidth,this.FWordWrapping=rtl.as(e,t.TTMSFNCDefaultToolBarButton).FWordWrapping,this.FHorizontalTextAlign=rtl.as(e,t.TTMSFNCDefaultToolBarButton).FHorizontalTextAlign,this.FVerticalTextAlign=rtl.as(e,t.TTMSFNCDefaultToolBarButton).FVerticalTextAlign,this.FTrimming=rtl.as(e,t.TTMSFNCDefaultToolBarButton).FTrimming,this.FFont$1.Assign(rtl.as(e,t.TTMSFNCDefaultToolBarButton).FFont$1),this.FHoverFontColor=rtl.as(e,t.TTMSFNCDefaultToolBarButton).FHoverFontColor,this.FDownFontColor=rtl.as(e,t.TTMSFNCDefaultToolBarButton).FDownFontColor,this.FDisabledFontColor=rtl.as(e,t.TTMSFNCDefaultToolBarButton).FDisabledFontColor,this.FStretchText=rtl.as(e,t.TTMSFNCDefaultToolBarButton).FStretchText,this.Invalidate())},this.Create$1=function(e){return t.TTMSFNCCustomToolBarElement.Create$1.apply(this,arguments),this.FOldHeight=-1,this.FLayout=0,this.FCompactLayout=0,this.FMinimumLayout=1,this.FMaximumLayout=3,this.FFont$1=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFont.$create("Create$2"),this.FFont$1.FOnChanged=rtl.createCallback(this,"DoFontChanged"),this.FHoverFontColor=-1,this.FDownFontColor=-1,this.FDisabledFontColor=-1,this.FDownState=!1,this.FApplyName=!0,this.FCloseOnSelection=!0,this.FBitmapSize=24,this.FLargeLayoutBitmapSize=32,this.FAutoBitmapSize=!1,this.FLargeLayoutAutoBitmapSize=!1,this.FStretchBitmapIfNoText=!0,this.FStretchText=!1,this.FDropDownWidth=135,this.FDropDownHeight=135,this.FDropDownAutoWidth=!1,this.FPopup=pas["WEBLib.TMSFNCPopup"].TTMSFNCPopup.$create("Create$1",[this]),this.FPopup.SetDragWithParent(!0),this.FPopup.SetDropDownWidth(this.FDropDownWidth),this.FPopup.SetDropDownHeight(this.FDropDownHeight),this.FPopup.FOnPopup=rtl.createCallback(this,"DoPopup"),this.FPopup.FOnClosePopup=rtl.createCallback(this,"DoClosePopup"),this.FPopupPlacement=0,this.FBitmaps=pas["WEBLib.TMSFNCTypes"].TTMSFNCScaledBitmaps.$create("Create$3",[this]),this.FBitmaps.FOnChange=rtl.createCallback(this,"BitmapsChanged"),this.FDisabledBitmaps=pas["WEBLib.TMSFNCTypes"].TTMSFNCScaledBitmaps.$create("Create$3",[this]),this.FDisabledBitmaps.FOnChange=rtl.createCallback(this,"BitmapsChanged"),this.FHoverBitmaps=pas["WEBLib.TMSFNCTypes"].TTMSFNCScaledBitmaps.$create("Create$3",[this]),this.FHoverBitmaps.FOnChange=rtl.createCallback(this,"BitmapsChanged"),this.FLargeLayoutBitmaps=pas["WEBLib.TMSFNCTypes"].TTMSFNCScaledBitmaps.$create("Create$3",[this]),this.FLargeLayoutBitmaps.FOnChange=rtl.createCallback(this,"BitmapsChanged"),this.FLargeLayoutDisabledBitmaps=pas["WEBLib.TMSFNCTypes"].TTMSFNCScaledBitmaps.$create("Create$3",[this]),this.FLargeLayoutDisabledBitmaps.FOnChange=rtl.createCallback(this,"BitmapsChanged"),this.FLargeLayoutHoverBitmaps=pas["WEBLib.TMSFNCTypes"].TTMSFNCScaledBitmaps.$create("Create$3",[this]),this.FLargeLayoutHoverBitmaps.FOnChange=rtl.createCallback(this,"BitmapsChanged"),this.FAppearance=t.TTMSFNCToolBarButtonAppearance.$create("Create$1",[this]),this.FTextVisible=!0,this.FBitmapVisible=!1,this.FWordWrapping=!1,this.FHorizontalTextAlign=0,this.FVerticalTextAlign=0,this.FTrimming=1,this.FBitmapPosition=0,this.SetWidth(100),this.SetHeight(24),this},this.Destroy=function(){rtl.free(this,"FFont$1"),rtl.free(this,"FPopup"),rtl.free(this,"FBitmaps"),rtl.free(this,"FDisabledBitmaps"),rtl.free(this,"FHoverBitmaps"),rtl.free(this,"FLargeLayoutBitmaps"),rtl.free(this,"FLargeLayoutDisabledBitmaps"),rtl.free(this,"FLargeLayoutHoverBitmaps"),rtl.free(this,"FAppearance"),t.TTMSFNCCustomToolBarElement.Destroy.call(this)},this.Draw=function(t,e){var i=pas["WEBLib.TMSFNCTypes"].TRectF.$new();pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Draw.apply(this,arguments),this.FAppearance.FTransparent||(this.FEnabled?this.FDown||this.FDownState?(t.FFill.Assign(this.FAppearance.FDownFill),t.FStroke.Assign(this.FAppearance.FDownStroke)):this.FHover?(t.FFill.Assign(this.FAppearance.FHoverFill),t.FStroke.Assign(this.FAppearance.FHoverStroke)):(t.FFill.Assign(this.FAppearance.FNormalFill),t.FStroke.Assign(this.FAppearance.FNormalStroke)):(t.FFill.Assign(this.FAppearance.FDisabledFill),t.FStroke.Assign(this.FAppearance.FDisabledStroke)),i.$assign(this.GetLocalRect()),this.FAppearance.FFlatStyle?(t.FFill.SetKind(1),t.DrawRectangle$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),2)):t.DrawRoundRectangle$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),this.FAppearance.FRounding,rtl.refSet(this.FAppearance.FCorners),2),this.FAppearance.FShowInnerStroke&&!this.FAppearance.FFlatStyle&&(pas["WEBLib.TMSFNCTypes"].InflateRectEx(i,-1,-1),t.FStroke.Assign(this.FAppearance.FInnerStroke),t.FFill.SetKind(0),t.DrawRoundRectangle$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),this.FAppearance.FRounding,rtl.refSet(this.FAppearance.FCorners),2))),this.DrawBitmap(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e)),this.DrawText(t),this.DrawButton(t),this.FShowFocus$1&&this.IsFocused()&&(i.$assign(this.GetTextRect()),t.DrawFocusRectangle$3(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),0,2)),this.IsDesignTime()&&this.CanDrawDesignTime()&&t.DrawFocusRectangle$3(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),0,2)},this.DropDown=function(){null!=this.FPopup&&(this.FPopup.SetPlacementControl(this),this.FPopup.FIsOpen?this.FPopup.SetIsOpen(!1):(null!=this.FOnBeforeDropDown&&this.FOnBeforeDropDown(this),this.FDropDownAutoWidth&&this.FPopup.SetDropDownWidth(this.GetWidth()),this.FPopup.SetPlacement(this.FPopupPlacement),this.FPopup.SetIsOpen(!0),null!=this.FOnDropDown&&this.FOnDropDown(this)))},rtl.addIntf(this,pas["WEBLib.TMSFNCBitmapContainer"].ITMSFNCBitmapContainer),rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas["WEBLib.TMSFNCTypes"].ITMSFNCProductInfo),rtl.addIntf(this,pas.System.IUnknown)})),this.TTMSFNCToolBarButtonDropDownKind={0:"ddkNormal",ddkNormal:0,1:"ddkDropDown",ddkDropDown:1,2:"ddkDropDownButton",ddkDropDownButton:2},this.$rtti.$Enum("TTMSFNCToolBarButtonDropDownKind",{minvalue:0,maxvalue:2,ordtype:1,enumtype:this.TTMSFNCToolBarButtonDropDownKind}),this.TTMSFNCToolBarButtonDropDownPosition={0:"ddpRight",ddpRight:0,1:"ddpBottom",ddpBottom:1},this.$rtti.$Enum("TTMSFNCToolBarButtonDropDownPosition",{minvalue:0,maxvalue:1,ordtype:1,enumtype:this.TTMSFNCToolBarButtonDropDownPosition}),rtl.createClass(this,"TTMSFNCToolBarDropDownButton",this.TTMSFNCDefaultToolBarButton,(function(){this.$init=function(){t.TTMSFNCDefaultToolBarButton.$init.call(this),this.FDefaultStyle=!1},this.SetDefaultStyle=function(t){this.FDefaultStyle!==t&&(this.FDefaultStyle=t,this.Invalidate())},this.RegisterRuntimeClasses=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.RegisterRuntimeClasses.call(this),pas.Classes.RegisterClass(t.TTMSFNCToolBarDropDownButton)},this.DrawBitmap=function(e,i){var s=null,o=null,n=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),r=null;if(this.FDefaultStyle)n.$assign(i),null!=this.FOwner&&t.TTMSFNCCustomToolBarButton.isPrototypeOf(this.FOwner)&&1===rtl.as(this.FOwner,t.TTMSFNCCustomToolBarButton).FDropDownPosition||pas["WEBLib.TMSFNCTypes"].InflateRectEx(n,this.ScalePaintValue(-2),this.ScalePaintValue(-2)),t.TTMSFNCDefaultToolBarButton.DrawBitmap.call(this,e,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(n));else{(o=pas["WEBLib.Graphics"].TBitmap.$create("Create$3")).SetSize(7,7),r=pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.$create("Create$1",[o.GetCanvas(),!1]);try{r.BeginScene(),r.FStroke.SetKind(1),r.FStroke.SetColor(11119017),r.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(0,1)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(6,1)),2,2),r.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(0,2)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(6,2)),2,2),r.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(1,3)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(5,3)),2,2),r.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(2,4)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(4,4)),2,2),r.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(3,5)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(3,5)),2,2)}finally{r.EndScene(),r=rtl.freeLoc(r)}try{n.$assign(i),s=pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.$create("Create$3");try{s.Assign(o),e.DrawBitmap$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(n),s,!0,!1,!0,!1)}finally{s=rtl.freeLoc(s)}}finally{o=rtl.freeLoc(o)}}},this.GetBitmapRect$1=function(t){var e=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),i=pas["WEBLib.TMSFNCTypes"].TRectF.$new();return i.$assign(t),e.$assign(pas["WEBLib.TMSFNCTypes"].RectF(i.Left+3,i.Top+3,i.Right-3,i.Bottom-3)),e},this.Create$1=function(e){return t.TTMSFNCDefaultToolBarButton.Create$1.apply(this,arguments),this.FDefaultStyle=!0,this},rtl.addIntf(this,pas["WEBLib.TMSFNCBitmapContainer"].ITMSFNCBitmapContainer),rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas["WEBLib.TMSFNCTypes"].ITMSFNCProductInfo),rtl.addIntf(this,pas.System.IUnknown);var e=this.$rtti;e.addProperty("DefaultStyle",2,rtl.boolean,"FDefaultStyle","SetDefaultStyle",{Default:!0}),e.addProperty("Font",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFont,"FFont$1","SetFont$1"),e.addProperty("Text",3,rtl.string,"GetText","SetText"),e.addProperty("ShowFocus",2,rtl.boolean,"FShowFocus$1","SetShowFocus$1",{Default:!1}),e.addProperty("TextVisible",2,rtl.boolean,"FTextVisible","SetTextVisible",{Default:!0}),e.addProperty("StretchText",2,rtl.boolean,"FStretchText","SetStretchText",{Default:!1}),e.addProperty("WordWrapping",2,rtl.boolean,"FWordWrapping","SetWordWrapping",{Default:!1}),e.addProperty("HorizontalTextAlign",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsTextAlign,"FHorizontalTextAlign","SetHorizontalTextAlign",{Default:pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsTextAlign.gtaCenter}),e.addProperty("VerticalTextAlign",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsTextAlign,"FVerticalTextAlign","SetVerticalTextAlign",{Default:pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsTextAlign.gtaCenter}),e.addProperty("Trimming",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsTextTrimming,"FTrimming","SetTrimming",{Default:pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsTextTrimming.gttCharacter}),e.addProperty("Bitmaps",2,pas["WEBLib.TMSFNCTypes"].$rtti.TTMSFNCScaledBitmaps,"FBitmaps","SetBitmaps"),e.addProperty("DisabledBitmaps",2,pas["WEBLib.TMSFNCTypes"].$rtti.TTMSFNCScaledBitmaps,"FDisabledBitmaps","SetDisabledBitmaps"),e.addProperty("HoverBitmaps",2,pas["WEBLib.TMSFNCTypes"].$rtti.TTMSFNCScaledBitmaps,"FHoverBitmaps","SetHoverBitmaps"),e.addProperty("BitmapVisible",2,rtl.boolean,"FBitmapVisible","SetBitmapVisible",{Default:!1}),e.addProperty("BitmapContainer",3,pas["WEBLib.TMSFNCBitmapContainer"].$rtti.TTMSFNCBitmapContainer,"GetBitmapContainer","SetBitmapContainer"),e.addProperty("State",2,t.$rtti.TTMSFNCToolBarElementState,"FState","SetState",{Default:t.TTMSFNCToolBarElementState.esNormal}),e.addProperty("LastElement",2,rtl.boolean,"FLastElement","SetLastElement",{Default:!1}),e.addProperty("Appearance",2,t.$rtti.TTMSFNCToolBarButtonAppearance,"FAppearance","SetAppearance")})),rtl.createClass(this,"TTMSFNCCustomToolBarButton",this.TTMSFNCDefaultToolBarButton,(function(){this.$init=function(){t.TTMSFNCDefaultToolBarButton.$init.call(this),this.FDropDownButton=null,this.FDropDownKind=0,this.FDropDownPosition=0,this.FHidden=!1,this.FAutoOptionsMenuText=""},this.$final=function(){this.FDropDownButton=void 0,t.TTMSFNCDefaultToolBarButton.$final.call(this)},this.SetDropDownKind=function(t){if(this.FDropDownKind!==t){if(this.FDropDownKind=t,null!=this.FDropDownButton){var e=this.FDropDownKind;0===e?(this.FDropDownButton.SetVisible(!1),this.FDropDownButton.SetParent(null),this.FDropDownButton.FAppearance.SetTransparent(!1)):1===e?(this.FDropDownButton.SetVisible(!1),this.FDropDownButton.SetParent(this),this.FDropDownButton.FAppearance.SetTransparent(!0)):2===e&&(this.FDropDownButton.SetVisible(!0),this.FDropDownButton.SetParent(this),this.FDropDownButton.FAppearance.SetTransparent(!1))}this.Invalidate()}},this.SetDropDownPosition=function(t){var e=0;if(this.FDropDownPosition!==t&&(e=pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.GetDPIScale(this,96),this.FDropDownPosition=t,null!=this.FDropDownButton)){var i=t;0===i?(this.FDropDownButton.SetAlign(4),this.FDropDownButton.SetWidth(Math.round(17*e)),this.FDropDownButton.FAppearance.SetCorners(rtl.createSet(1,3))):1===i&&(this.FDropDownButton.SetAlign(2),this.FDropDownButton.SetHeight(Math.round(10*e)),this.FDropDownButton.FAppearance.SetCorners(rtl.createSet(2,3)))}},this.SetAdaptToStyle=function(e){t.TTMSFNCDefaultToolBarButton.SetAdaptToStyle.apply(this,arguments),null!=this.FDropDownButton&&this.FDropDownButton.SetAdaptToStyle(this.GetAdaptToStyle())},this.AppearanceChanged=function(){t.TTMSFNCDefaultToolBarButton.AppearanceChanged.call(this),this.UpdateDropDownButton()},this.UpdateDropDownButton=function(){null!=this.FDropDownButton&&this.FDropDownButton.FAppearance.SetRounding(this.FAppearance.FRounding)},this.HandleMouseDown=function(e,i,s,o){t.TTMSFNCDefaultToolBarButton.HandleMouseDown.apply(this,arguments),1===this.FDropDownKind&&this.DropDown()},this.DropDownButtonClick=function(t){this.DropDown()},this.DrawButton=function(e){var i=pas["WEBLib.TMSFNCTypes"].TRectF.$new();if(t.TTMSFNCDefaultToolBarButton.DrawButton.apply(this,arguments),null!=this.FDropDownButton&&1===this.FDropDownKind){var s=this.FDropDownPosition;0===s?i.$assign(pas["WEBLib.TMSFNCTypes"].RectF(this.GetWidth()-this.FDropDownButton.GetWidth(),0,this.GetWidth(),this.GetHeight())):1===s&&i.$assign(pas["WEBLib.TMSFNCTypes"].RectF(0,this.GetHeight()-this.FDropDownButton.GetHeight(),this.GetWidth(),this.GetHeight())),this.FDropDownButton.DrawBitmap(e,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i))}},this.SetEnabled=function(t){var e=null;pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.SetEnabled.apply(this,arguments),null!=(e=this.GetDropDownButtonControl())&&e.SetEnabled(t)},this.GetDropDownButtonClass=function(){return t.TTMSFNCToolBarDropDownButton},this.GetDropDownRect=function(){var e=pas["WEBLib.TMSFNCTypes"].TRectF.$new();if(e.$assign(t.TTMSFNCDefaultToolBarButton.GetDropDownRect.call(this)),null!=this.FDropDownButton&&0!==this.FDropDownKind)if(1===this.FDropDownKind){var i=this.FDropDownPosition;0===i?e.$assign(pas["WEBLib.TMSFNCTypes"].RectF(this.GetWidth()-this.FDropDownButton.GetWidth(),0,this.GetWidth(),this.GetHeight())):1===i&&e.$assign(pas["WEBLib.TMSFNCTypes"].RectF(0,this.GetHeight()-this.FDropDownButton.GetHeight(),this.GetWidth(),this.GetHeight()))}else e.$assign(pas["WEBLib.TMSFNCTypes"].RectF(this.FDropDownButton.GetLeft(),this.FDropDownButton.GetTop(),this.FDropDownButton.GetLeft()+this.FDropDownButton.GetWidth(),this.FDropDownButton.GetTop()+this.FDropDownButton.GetHeight()));return e},this.GetTextRect=function(){var t=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),e=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),i=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),s=pas["WEBLib.TMSFNCTypes"].TRectF.$new();if(s.$assign(this.GetLocalRect()),e.$assign(this.GetBitmapRect$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(s))),i.$assign(this.GetDropDownRect()),0!==this.FDropDownKind)if(this.FStretchText){var o=this.FDropDownPosition;0===o?t.$assign(pas["WEBLib.TMSFNCTypes"].RectF(s.Left+3,s.Top+3,i.Left-3,s.Bottom-3)):1===o&&t.$assign(pas["WEBLib.TMSFNCTypes"].RectF(s.Left+3,s.Top+3,s.Right-3,i.Top-3))}else{var n=this.FBitmapPosition;if(0===n){var r=this.FDropDownPosition;0===r?t.$assign(pas["WEBLib.TMSFNCTypes"].RectF(e.Right+3,s.Top+3,i.Left-3,s.Bottom-3)):1===r&&t.$assign(pas["WEBLib.TMSFNCTypes"].RectF(e.Right+3,s.Top+3,s.Right-3,i.Top-3))}else if(1===n){var a=this.FDropDownPosition;0===a?t.$assign(pas["WEBLib.TMSFNCTypes"].RectF(s.Left+3,e.Bottom+3,i.Left-3,s.Bottom-3)):1===a&&t.$assign(pas["WEBLib.TMSFNCTypes"].RectF(s.Left+3,e.Bottom+3,s.Right-3,i.Top-3))}}else if(this.FStretchText)t.$assign(pas["WEBLib.TMSFNCTypes"].RectF(s.Left+3,s.Top+3,i.Left-3,s.Bottom-3));else{var l=this.FBitmapPosition;0===l?t.$assign(pas["WEBLib.TMSFNCTypes"].RectF(e.Right+3,s.Top+3,i.Left-3,s.Bottom-3)):1===l&&t.$assign(pas["WEBLib.TMSFNCTypes"].RectF(s.Left+3,e.Bottom+3,i.Left-3,s.Bottom-3))}return t},this.GetBitmapRect$1=function(t){var e=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),i=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),s=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),o=0;if(o=this.GetBitmapSize(),3===this.FLayout&&(o=this.GetLargeLayoutBitmapSize()),i.$assign(t),e.$assign(pas["WEBLib.TMSFNCTypes"].RectF(i.Left,i.Top,i.Left,i.Bottom)),this.FBitmapVisible)if(0!==this.FDropDownKind){s.$assign(this.GetDropDownRect());var n=this.FBitmapPosition;if(0===n){var r=this.FDropDownPosition;0===r?e.$assign(pas["WEBLib.TMSFNCTypes"].RectF(e.Left+3,e.Top+3,e.Left+3+o,e.Bottom-3)):1===r&&e.$assign(pas["WEBLib.TMSFNCTypes"].RectF(e.Left+3,e.Top+3,e.Left+3+o,s.Top-3))}else if(1===n){var a=this.FDropDownPosition;0===a?e.$assign(pas["WEBLib.TMSFNCTypes"].RectF(e.Left+3,e.Top+3,s.Left-3,e.Top+3+o)):1===a&&e.$assign(pas["WEBLib.TMSFNCTypes"].RectF(e.Left+3,e.Top+3,i.Right-3,e.Top+3+o))}}else if(this.FTextVisible&&""!==this.GetText()){if(this.FTextVisible&&""!==this.GetText()){var l=this.FBitmapPosition;0===l?e.$assign(pas["WEBLib.TMSFNCTypes"].RectF(i.Left+3,i.Top+3,i.Left+3+o,i.Bottom-3)):1===l&&e.$assign(pas["WEBLib.TMSFNCTypes"].RectF(i.Left+3,i.Top+3,i.Right-3,i.Top+3+o))}}else e.$assign(pas["WEBLib.TMSFNCTypes"].RectF(i.Left+3,i.Top+3,i.Right-3,i.Bottom-3)),-1===o||this.FStretchBitmapIfNoText||(e.Left=Math.round(i.Left+(i.Right-i.Left-o)/2),e.Top=Math.round(i.Top+(i.Bottom-i.Top-o)/2),e.Right=e.Left+o,e.Bottom=e.Top+o);return e},this.GetBitmapRect=function(){var e=pas["WEBLib.TMSFNCTypes"].TRectF.$new();return e.$assign(t.TTMSFNCDefaultToolBarButton.GetBitmapRect.call(this)),e},this.CanDropDown=function(){return 0!==this.FDropDownKind},this.Loaded=function(){pas["WEBLib.Controls"].TCustomControl.Loaded.call(this)},this.Assign=function(e){t.TTMSFNCDefaultToolBarButton.Assign.apply(this,arguments),t.TTMSFNCCustomToolBarButton.isPrototypeOf(e)&&(this.FDropDownKind=rtl.as(e,t.TTMSFNCCustomToolBarButton).FDropDownKind,this.FDropDownPosition=rtl.as(e,t.TTMSFNCCustomToolBarButton).FDropDownPosition,this.FAutoOptionsMenuText=rtl.as(e,t.TTMSFNCCustomToolBarButton).FAutoOptionsMenuText,this.FHidden=rtl.as(e,t.TTMSFNCCustomToolBarButton).FHidden,this.Invalidate())},this.Create$1=function(e){var i="";return t.TTMSFNCDefaultToolBarButton.Create$1.apply(this,arguments),this.FHidden=!1,this.FDropDownPosition=0,this.FDropDownButton=this.GetDropDownButtonClass().$create("Create$1",[this]),this.FDropDownButton.SetTabStop(!1),this.FDropDownButton.SetText(""),this.FDropDownButton.FOnClick=rtl.createCallback(this,"DropDownButtonClick"),this.FDropDownButton.SetVisible(!1),this.FDropDownButton.SetWidth(17),this.FDropDownButton.FAppearance.SetCorners(rtl.createSet(1,3)),this.FDropDownButton.SetAlign(4),this.FDropDownButton.FStored=!1,i=t.TMSFNCTOOLBAREXPANDSVG,this.FDropDownButton.FBitmaps.AddBitmapFromResource$1(i,pas["WEBLib.TMSFNCTypes"].HInstance(),1),this.FDropDownButton.FDisabledBitmaps.AddBitmapFromResource$1(i,pas["WEBLib.TMSFNCTypes"].HInstance(),1),this.FDropDownButton.FHoverBitmaps.AddBitmapFromResource$1(i,pas["WEBLib.TMSFNCTypes"].HInstance(),1),this},this.Destroy=function(){rtl.free(this,"FDropDownButton"),t.TTMSFNCDefaultToolBarButton.Destroy.call(this)},this.GetDropDownButtonControl=function(){return this.FDropDownButton},rtl.addIntf(this,pas["WEBLib.TMSFNCBitmapContainer"].ITMSFNCBitmapContainer),rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas["WEBLib.TMSFNCTypes"].ITMSFNCProductInfo),rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TTMSFNCToolBarButton",this.TTMSFNCCustomToolBarButton,(function(){this.RegisterRuntimeClasses=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.RegisterRuntimeClasses.call(this),pas.Classes.RegisterClass(t.TTMSFNCToolBarButton)},rtl.addIntf(this,pas["WEBLib.TMSFNCBitmapContainer"].ITMSFNCBitmapContainer),rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas["WEBLib.TMSFNCTypes"].ITMSFNCProductInfo),rtl.addIntf(this,pas.System.IUnknown);var e=this.$rtti;e.addProperty("Font",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFont,"FFont$1","SetFont$1"),e.addProperty("AutoOptionsMenuText",0,rtl.string,"FAutoOptionsMenuText","FAutoOptionsMenuText"),e.addProperty("DropDownAutoWidth",2,rtl.boolean,"FDropDownAutoWidth","SetDropDownAutoWidth",{Default:!1}),e.addProperty("DropDownKind",2,t.$rtti.TTMSFNCToolBarButtonDropDownKind,"FDropDownKind","SetDropDownKind",{Default:t.TTMSFNCToolBarButtonDropDownKind.ddkNormal}),e.addProperty("DropDownPosition",2,t.$rtti.TTMSFNCToolBarButtonDropDownPosition,"FDropDownPosition","SetDropDownPosition",{Default:t.TTMSFNCToolBarButtonDropDownPosition.ddpRight}),e.addProperty("DropDownHeight",14,rtl.double,"FDropDownHeight","SetDropDownHeight",{stored:"IsDropDownHeightStored"}),e.addProperty("DropDownWidth",14,rtl.double,"FDropDownWidth","SetDropDownWidth",{stored:"IsDropDownWidthStored"}),e.addProperty("DropDownControl",2,pas["WEBLib.Controls"].$rtti.TControl,"FDropDownControl","SetDropDownControl"),e.addProperty("OnBeforeDropDown",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnBeforeDropDown","FOnBeforeDropDown"),e.addProperty("OnDropDown",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnDropDown","FOnDropDown"),e.addProperty("OnCloseDropDown",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnCloseDropDown","FOnCloseDropDown"),e.addProperty("Text",3,rtl.string,"GetText","SetText"),e.addProperty("ShowFocus",2,rtl.boolean,"FShowFocus$1","SetShowFocus$1",{Default:!1}),e.addProperty("TextVisible",2,rtl.boolean,"FTextVisible","SetTextVisible",{Default:!0}),e.addProperty("StretchText",2,rtl.boolean,"FStretchText","SetStretchText",{Default:!1}),e.addProperty("StretchBitmapIfNoText",2,rtl.boolean,"FStretchBitmapIfNoText","SetStretchBitmapIfNoText",{Default:!0}),e.addProperty("HorizontalTextAlign",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsTextAlign,"FHorizontalTextAlign","SetHorizontalTextAlign",{Default:pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsTextAlign.gtaCenter}),e.addProperty("VerticalTextAlign",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsTextAlign,"FVerticalTextAlign","SetVerticalTextAlign",{Default:pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsTextAlign.gtaCenter}),e.addProperty("Trimming",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsTextTrimming,"FTrimming","SetTrimming",{Default:pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsTextTrimming.gttCharacter}),e.addProperty("Bitmaps",2,pas["WEBLib.TMSFNCTypes"].$rtti.TTMSFNCScaledBitmaps,"FBitmaps","SetBitmaps"),e.addProperty("LargeLayoutBitmaps",2,pas["WEBLib.TMSFNCTypes"].$rtti.TTMSFNCScaledBitmaps,"FLargeLayoutBitmaps","SetLargeLayoutBitmaps"),e.addProperty("Layout",2,t.$rtti.TTMSFNCToolBarButtonLayout,"FLayout","SetLayout",{Default:t.TTMSFNCToolBarButtonLayout.bblNone}),e.addProperty("CompactLayout",2,t.$rtti.TTMSFNCToolBarButtonLayout,"FCompactLayout","SetCompactLayout",{Default:t.TTMSFNCToolBarButtonLayout.bblNone}),e.addProperty("MinimumLayout",2,t.$rtti.TTMSFNCToolBarButtonLayout,"FMinimumLayout","SetMinimumLayout",{Default:t.TTMSFNCToolBarButtonLayout.bblBitmap}),e.addProperty("MaximumLayout",2,t.$rtti.TTMSFNCToolBarButtonLayout,"FMaximumLayout","SetMaximumLayout",{Default:t.TTMSFNCToolBarButtonLayout.bblLarge}),e.addProperty("BitmapPosition",2,t.$rtti.TTMSFNCToolBarButtonBitmapPosition,"FBitmapPosition","SetBitmapPosition",{Default:t.TTMSFNCToolBarButtonBitmapPosition.bbpLeft}),e.addProperty("DisabledBitmaps",2,pas["WEBLib.TMSFNCTypes"].$rtti.TTMSFNCScaledBitmaps,"FDisabledBitmaps","SetDisabledBitmaps"),e.addProperty("HoverBitmaps",2,pas["WEBLib.TMSFNCTypes"].$rtti.TTMSFNCScaledBitmaps,"FHoverBitmaps","SetHoverBitmaps"),e.addProperty("LargeLayoutDisabledBitmaps",2,pas["WEBLib.TMSFNCTypes"].$rtti.TTMSFNCScaledBitmaps,"FLargeLayoutDisabledBitmaps","SetLargeLayoutDisabledBitmaps"),e.addProperty("LargeLayoutHoverBitmaps",2,pas["WEBLib.TMSFNCTypes"].$rtti.TTMSFNCScaledBitmaps,"FLargeLayoutHoverBitmaps","SetLargeLayoutHoverBitmaps"),e.addProperty("BitmapVisible",2,rtl.boolean,"FBitmapVisible","SetBitmapVisible",{Default:!1}),e.addProperty("BitmapContainer",3,pas["WEBLib.TMSFNCBitmapContainer"].$rtti.TTMSFNCBitmapContainer,"GetBitmapContainer","SetBitmapContainer"),e.addProperty("BitmapSize",14,rtl.double,"FBitmapSize","SetBitmapSize",{stored:"IsBitmapSizeStored"}),e.addProperty("AutoBitmapSize",2,rtl.boolean,"FAutoBitmapSize","SetAutoBitmapSize",{Default:!1}),e.addProperty("LargeLayoutBitmapSize",14,rtl.double,"FLargeLayoutBitmapSize","SetLargeLayoutBitmapSize",{stored:"IsLargeLayoutBitmapSizeStored"}),e.addProperty("LargeLayoutAutoBitmapSize",2,rtl.boolean,"FLargeLayoutAutoBitmapSize","SetLargeLayoutAutoBitmapSize",{Default:!1}),e.addProperty("State",2,t.$rtti.TTMSFNCToolBarElementState,"FState","SetState",{Default:t.TTMSFNCToolBarElementState.esNormal}),e.addProperty("LastElement",2,rtl.boolean,"FLastElement","SetLastElement",{Default:!1}),e.addProperty("Appearance",2,t.$rtti.TTMSFNCToolBarButtonAppearance,"FAppearance","SetAppearance"),e.addProperty("WordWrapping",2,rtl.boolean,"FWordWrapping","SetWordWrapping",{Default:!1}),e.attr=[pas.Classes.ComponentPlatformsAttribute,"Create$1",[0]]})),rtl.createClass(this,"TTMSFNCCustomToolBarAppearance",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FOwner=null,this.FFill=null,this.FStroke=null,this.FVerticalSpacing=0,this.FHorizontalSpacing=0,this.FDragGripColor=0,this.FDragGrip=!1,this.FFlatStyle=!1,this.FFont=null,this.FSeparatorStroke=null,this.FSeparator=!1},this.$final=function(){this.FOwner=void 0,this.FFill=void 0,this.FStroke=void 0,this.FFont=void 0,this.FSeparatorStroke=void 0,pas.Classes.TPersistent.$final.call(this)},this.SetFill=function(t){this.FFill.Assign(t)},this.SetStroke=function(t){this.FStroke.Assign(t)},this.SetHorizontalSpacing=function(t){this.FHorizontalSpacing!==t&&(this.FHorizontalSpacing=t,this.FOwner.UpdateControls())},this.SetVerticalSpacing=function(t){this.FVerticalSpacing!==t&&(this.FVerticalSpacing=t,this.FOwner.UpdateControls())},this.SetDragGrip=function(t){this.FDragGrip!==t&&(this.FDragGrip=t,this.FOwner.UpdateControls())},this.SetDragGripColor=function(t){this.FDragGripColor!==t&&(this.FDragGripColor=t,this.FOwner.Invalidate())},this.IsHorizontalSpacingStored=function(){return 3!==this.FHorizontalSpacing},this.IsVerticalSpacingStored=function(){return 3!==this.FVerticalSpacing},this.SetFlatStyle=function(t){this.FFlatStyle!==t&&(this.FFlatStyle=t,null!=this.FOwner&&this.FOwner.ApplyFlatStyle())},this.SetSeparator=function(t){this.FSeparator!==t&&(this.FSeparator=t,this.FOwner.Invalidate())},this.SetSeparatorStroke=function(t){this.FSeparatorStroke.Assign(t)},this.FillChanged=function(t){this.FOwner.Invalidate()},this.StrokeChanged=function(t){this.FOwner.Invalidate()},this.Assign=function(e){t.TTMSFNCCustomToolBarAppearance.isPrototypeOf(e)&&(this.FSeparatorStroke.Assign(rtl.as(e,t.TTMSFNCCustomToolBarAppearance).FSeparatorStroke),this.FSeparator=rtl.as(e,t.TTMSFNCCustomToolBarAppearance).FSeparator,this.FFill.Assign(rtl.as(e,t.TTMSFNCCustomToolBarAppearance).FFill),this.FStroke.Assign(rtl.as(e,t.TTMSFNCCustomToolBarAppearance).FStroke),this.FHorizontalSpacing=rtl.as(e,t.TTMSFNCCustomToolBarAppearance).FHorizontalSpacing,this.FVerticalSpacing=rtl.as(e,t.TTMSFNCCustomToolBarAppearance).FVerticalSpacing,this.FDragGripColor=rtl.as(e,t.TTMSFNCCustomToolBarAppearance).FDragGripColor,this.FDragGrip=rtl.as(e,t.TTMSFNCCustomToolBarAppearance).FDragGrip,this.FFlatStyle=rtl.as(e,t.TTMSFNCCustomToolBarAppearance).FFlatStyle)},this.Create$1=function(t){return this.FOwner=t,this.FFont=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFont.$create("Create$2"),this.FFlatStyle=!1,this.FHorizontalSpacing=3,this.FVerticalSpacing=3,this.FDragGrip=!0,this.FDragGripColor=13882323,this.FFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[2,16777215,pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(230,230,230),-1,-1]),this.FStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,8421504]),this.FFill.FOnChanged=rtl.createCallback(this,"FillChanged"),this.FStroke.FOnChanged=rtl.createCallback(this,"StrokeChanged"),this.FSeparatorStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,16777215]),this.FSeparatorStroke.FOnChanged=rtl.createCallback(this,"StrokeChanged"),this},this.Destroy=function(){rtl.free(this,"FSeparatorStroke"),rtl.free(this,"FFont"),rtl.free(this,"FFill"),rtl.free(this,"FStroke"),pas.System.TObject.Destroy.call(this)}})),rtl.createClass(this,"TTMSFNCToolBarAppearance",this.TTMSFNCCustomToolBarAppearance,(function(){var t=this.$rtti;t.addProperty("FlatStyle",2,rtl.boolean,"FFlatStyle","SetFlatStyle",{Default:!1}),t.addProperty("Fill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FFill","SetFill"),t.addProperty("Stroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FStroke","SetStroke"),t.addProperty("Separator",2,rtl.boolean,"FSeparator","SetSeparator",{Default:!1}),t.addProperty("SeparatorStroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FSeparatorStroke","SetSeparatorStroke"),t.addProperty("HorizontalSpacing",14,rtl.double,"FHorizontalSpacing","SetHorizontalSpacing",{stored:"IsHorizontalSpacingStored"}),t.addProperty("VerticalSpacing",14,rtl.double,"FVerticalSpacing","SetVerticalSpacing",{stored:"IsVerticalSpacingStored"}),t.addProperty("DragGrip",2,rtl.boolean,"FDragGrip","SetDragGrip",{Default:!0}),t.addProperty("DragGripColor",2,pas["WEBLib.Graphics"].$rtti.TColor,"FDragGripColor","SetDragGripColor",{Default:13882323})})),rtl.createClass(this,"TTMSFNCToolBarControl",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FControlIndex=0,this.FControl=null,this.FLayout=0,this.FBitmap=null},this.$final=function(){this.FControl=void 0,this.FBitmap=void 0,pas.Classes.TPersistent.$final.call(this)},this.Create$1=function(){return this.FBitmap=pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.$create("Create$3"),this},this.Destroy=function(){rtl.free(this,"FBitmap"),pas.System.TObject.Destroy.call(this)}})),this.$rtti.$MethodVar("TTMSFNCToolBarCustomizeOptionsMenu",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["APopupMenu",pas["WEBLib.Menus"].$rtti.TPopupMenu]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCToolBarCustomizeOptionsMenuItem",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AControl",pas["WEBLib.Controls"].$rtti.TControl],["AMenuItem",pas["WEBLib.Menus"].$rtti.TMenuItem]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCToolBarCanShowOptionsMenuItem",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AControl",pas["WEBLib.Controls"].$rtti.TControl],["ACanShowItem",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCToolBarOptionsMenuItemClick",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AControl",pas["WEBLib.Controls"].$rtti.TControl],["AMenuItem",pas["WEBLib.Menus"].$rtti.TMenuItem],["AExecuteDefaultAction",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCToolBarIsLastElement",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AControl",pas["WEBLib.Controls"].$rtti.TControl],["AIsLastElement",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCToolBarAnchorClickEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AAnchor",rtl.string]]),methodkind:0}),rtl.createClass(this,"TTMSFNCCustomToolBarOptionsMenu",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FOwner=null,this.FShowItemText=!1,this.FShowItemBitmap=!1,this.FShowButton=!1,this.FItemBitmapWidth=0,this.FAutoItemBitmapWidth=!1},this.$final=function(){this.FOwner=void 0,pas.Classes.TPersistent.$final.call(this)},this.SetShowButton=function(t){this.FShowButton!==t&&(this.FShowButton=t,this.FOwner.FOptionsMenuButton.SetVisible(this.FShowButton),this.FShowButton?this.FOwner.FOptionsMenuButton.SetParent(this.FOwner):this.FOwner.FOptionsMenuButton.SetParent(null),this.FOwner.UpdateControls())},this.SetShowItemBitmap=function(t){this.FShowItemBitmap!==t&&(this.FShowItemBitmap=t)},this.SetShowItemText=function(t){this.FShowItemText!==t&&(this.FShowItemText=t)},this.SetAutoItemBitmapWidth=function(t){this.FAutoItemBitmapWidth!==t&&(this.FAutoItemBitmapWidth=t)},this.SetItemBitmapWidth=function(t){this.FItemBitmapWidth!==t&&(this.FItemBitmapWidth=t)},this.IsItemBitmapWidthStored=function(){return 50!==this.FItemBitmapWidth},this.Assign=function(e){t.TTMSFNCCustomToolBarOptionsMenu.isPrototypeOf(e)&&(this.FShowItemText=rtl.as(e,t.TTMSFNCCustomToolBarOptionsMenu).FShowItemText,this.FShowItemBitmap=rtl.as(e,t.TTMSFNCCustomToolBarOptionsMenu).FShowItemBitmap,this.FShowButton=rtl.as(e,t.TTMSFNCCustomToolBarOptionsMenu).FShowButton,this.FAutoItemBitmapWidth=rtl.as(e,t.TTMSFNCCustomToolBarOptionsMenu).FAutoItemBitmapWidth,this.FItemBitmapWidth=rtl.as(e,t.TTMSFNCCustomToolBarOptionsMenu).FItemBitmapWidth)},this.Create$1=function(t){return this.FOwner=t,this.FShowItemText=!0,this.FShowButton=!0,this.FShowItemBitmap=!0,this.FAutoItemBitmapWidth=!0,this.FItemBitmapWidth=50,this},this.Destroy=function(){pas.System.TObject.Destroy.call(this)}})),rtl.createClass(this,"TTMSFNCToolBarOptionsMenu",this.TTMSFNCCustomToolBarOptionsMenu,(function(){var t=this.$rtti;t.addProperty("ShowButton",2,rtl.boolean,"FShowButton","SetShowButton",{Default:!0}),t.addProperty("ShowItemBitmap",2,rtl.boolean,"FShowItemBitmap","SetShowItemBitmap",{Default:!0}),t.addProperty("ShowItemText",2,rtl.boolean,"FShowItemText","SetShowItemText",{Default:!0}),t.addProperty("AutoItemBitmapWidth",2,rtl.boolean,"FAutoItemBitmapWidth","SetAutoItemBitmapWidth",{Default:!0}),t.addProperty("ItemBitmapWidth",14,rtl.double,"FItemBitmapWidth","SetItemBitmapWidth",{stored:"IsItemBitmapWidthStored"})})),rtl.createClass(this,"TTMSFNCToolBarControlObjectList",pas.contnrs.TObjectList,(function(){this.GetItem$1=function(t){return this.GetItem(t)}})),rtl.createClass(this,"TTMSFNCToolBarControlList",pas.Classes.TList,(function(){this.GetItem=function(t){return rtl.getObject(this.Get(t))}})),this.$rtti.$MethodVar("TTMSFNCToolBarDragGripMovingEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["DeltaX",rtl.double],["DeltaY",rtl.double]]),methodkind:0}),rtl.createClass(this,"TTMSFNCToolBarPopup",pas["WEBLib.TMSFNCPopup"].TTMSFNCPopup,(function(){rtl.addIntf(this,pas["WEBLib.TMSFNCTypes"].ITMSFNCProductInfo),rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TTMSFNCCustomToolBar",pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl,(function(){this.$init=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.$init.call(this),this.FCompactToolbar=null,this.FCompactPopup=null,this.FHover=!1,this.FHoverP=!1,this.FQuickMenuButtonHover=!1,this.FQuickMenuButtonHoverP=!1,this.FDown=!1,this.FQuickMenuButtonDown=!1,this.FOldWidth=0,this.FOldMenuButtonState=!1,this.FBitmapContainer=null,this.FInsideDrag=!1,this.FDragGripMoving=!1,this.FDragGripDown=!1,this.FDragGripDownPt=pas["WEBLib.TMSFNCTypes"].TPointF.$new(),this.FHiddenControls=null,this.FCompactControls=null,this.FBlockUpdate=!1,this.FBlockResize=!1,this.FAutoSize=!1,this.FAppearance=null,this.FAutoAlign=!1,this.FOptionsMenuButton=null,this.FAutoOptionsMenu=null,this.FOnOptionsMenuCustomize=null,this.FOnOptionsMenuItemCustomize=null,this.FOnOptionsMenuButtonClick=null,this.FOptionsMenu=null,this.FCustomOptionsMenu=null,this.FOnOptionsMenuItemCanShow=null,this.FState=0,this.FOnOptionsMenuItemClick=null,this.FOnOptionsMenuItemApplyStyle=null,this.FOnUpdateDockPanel=null,this.FOnUpdateControls=null,this.FOnIsLastElement=null,this.FOnDragGripMoving=null,this.FAutoMoveToolBar=!1,this.FOnInternalDblClick$1=null,this.FOnInternalMouseDown$1=null,this.FOnInternalMouseMove$1=null,this.FOnInternalMouseUp$1=null,this.FAutoHeight=!1,this.FAutoWidth=!1,this.FOnInternalInsertControl=null,this.FAutoStretchHeight=!1,this.FText="",this.FFirstLoad=!1,this.FFont$1=null,this.FVerticalTextAlign=0,this.FTrimming=0,this.FHorizontalTextAlign=0,this.FWordWrapping=!1,this.FTextVisible=!1,this.FMinimumWidth=0,this.FCompact=!1,this.FCanCompact=!1,this.FCompactWidth=0,this.FCompactAppearance=null,this.FCompactBitmaps=null,this.FOnCompactClick=null,this.FCompactBitmapSize=0,this.FCompactBitmapVisible=!1,this.FCompactExpanderBitmaps=null,this.FQuickMenuButton=!1,this.FQuickMenuButtonAppearance=null,this.FOnQuickMenuButtonClick=null,this.FQuickMenuButtonBitmaps=null,this.FQuickMenuButtonHint="",this.FCompactAutoBitmapSize=!1,this.FOnAnchorClick=null},this.$final=function(){this.FCompactToolbar=void 0,this.FCompactPopup=void 0,this.FBitmapContainer=void 0,this.FDragGripDownPt=void 0,this.FHiddenControls=void 0,this.FCompactControls=void 0,this.FAppearance=void 0,this.FOptionsMenuButton=void 0,this.FAutoOptionsMenu=void 0,this.FOnOptionsMenuCustomize=void 0,this.FOnOptionsMenuItemCustomize=void 0,this.FOnOptionsMenuButtonClick=void 0,this.FOptionsMenu=void 0,this.FCustomOptionsMenu=void 0,this.FOnOptionsMenuItemCanShow=void 0,this.FOnOptionsMenuItemClick=void 0,this.FOnOptionsMenuItemApplyStyle=void 0,this.FOnUpdateDockPanel=void 0,this.FOnUpdateControls=void 0,this.FOnIsLastElement=void 0,this.FOnDragGripMoving=void 0,this.FOnInternalDblClick$1=void 0,this.FOnInternalMouseDown$1=void 0,this.FOnInternalMouseMove$1=void 0,this.FOnInternalMouseUp$1=void 0,this.FOnInternalInsertControl=void 0,this.FFont$1=void 0,this.FCompactAppearance=void 0,this.FCompactBitmaps=void 0,this.FOnCompactClick=void 0,this.FCompactExpanderBitmaps=void 0,this.FQuickMenuButtonAppearance=void 0,this.FOnQuickMenuButtonClick=void 0,this.FQuickMenuButtonBitmaps=void 0,this.FOnAnchorClick=void 0,pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.$final.call(this)},this.SetAppearance=function(t){this.FAppearance.Assign(t)},this.SetAS=function(t){this.FAutoSize!==t&&(this.FAutoSize=t,this.UpdateControls())},this.SetAutoAlign=function(t){this.FAutoAlign!==t&&(this.FAutoAlign=t,this.UpdateControls())},this.SetOptionsMenu=function(t){this.FOptionsMenu.Assign(t)},this.SetState=function(e){var i=0,s=null;if(this.FState!==e){this.FState=e;for(var o=0,n=this.GetControlsCount()-1;o<=n;o++)i=o,s=this.GetControls(i),t.TTMSFNCCustomToolBarElement.isPrototypeOf(s)&&rtl.as(s,t.TTMSFNCCustomToolBarElement).SetState(this.FState)}},this.SetAutoHeight=function(t){this.FAutoHeight!==t&&(this.FAutoHeight=t,this.UpdateControls())},this.SetAutoWidth=function(t){this.FAutoWidth!==t&&(this.FAutoWidth=t,this.UpdateControls())},this.SetAutoStretchHeight=function(t){this.FAutoStretchHeight!==t&&(this.FAutoStretchHeight=t,this.UpdateControls())},this.SetText=function(t){this.FText!==t&&(this.FText=t,this.UpdateControls())},this.GetBitmapContainer=function(){return this.FBitmapContainer},this.SetFont$1=function(t){this.FFont$1.Assign(t)},this.SetHorizontalTextAlign=function(t){this.FHorizontalTextAlign!==t&&(this.FHorizontalTextAlign=t,this.Invalidate())},this.SetTrimming=function(t){this.FTrimming!==t&&(this.FTrimming=t,this.UpdateControls())},this.SetVerticalTextAlign=function(t){this.FVerticalTextAlign!==t&&(this.FVerticalTextAlign=t,this.UpdateControls())},this.SetWordWrapping=function(t){this.FWordWrapping!==t&&(this.FWordWrapping=t,this.UpdateControls())},this.IsMinimumWidthStored=function(){return 30!==this.FMinimumWidth},this.SetMinimumWidth=function(t){this.FMinimumWidth!==t&&(this.FMinimumWidth=t,this.UpdateControls())},this.SetCompact=function(t){this.FCompact!==t&&this.FCanCompact&&(this.FCompact=t,this.FCompact?(this.FOldMenuButtonState=this.FOptionsMenu.FShowButton,this.FOptionsMenu.SetShowButton(!1),this.FOldWidth=this.GetWidth(),this.CompactControls(),this.SetWidth(Math.round(this.FCompactWidth))):(this.SetWidth(Math.round(this.FOldWidth)),this.UncompactControls(),this.FOptionsMenu.SetShowButton(this.FOldMenuButtonState)),this.UpdateControls())},this.SetCanCompact=function(t){this.FCanCompact!==t&&(this.FCanCompact=t)},this.IsCompactWidthStored=function(){return 50!==this.FCompactWidth},this.SetCompactWidth=function(t){this.FCompactWidth!==t&&(this.FCompactWidth=t,this.FCompact&&this.SetWidth(Math.round(this.FCompactWidth)))},this.SetCompactAppearance=function(t){this.FCompactAppearance.Assign(t)},this.SetCompactBitmaps=function(t){this.FCompactBitmaps.Assign(t)},this.IsCompactBitmapSizeStored=function(){return 24!==this.FCompactBitmapSize},this.SetCompactBitmapSize=function(t){this.FCompactBitmapSize!==t&&(this.FCompactBitmapSize=t,this.Invalidate())},this.SetCompactBitmapVisible=function(t){this.FCompactBitmapVisible!==t&&(this.FCompactBitmapVisible=t,this.Invalidate())},this.SetQuickMenuButton=function(t){this.FQuickMenuButton!==t&&(this.FQuickMenuButton=t,this.Invalidate())},this.SetQuickMenuButtonAppearance=function(t){this.FQuickMenuButtonAppearance.Assign(t)},this.SetCompactAutoBitmapSize=function(t){this.FCompactAutoBitmapSize!==t&&(this.FCompactAutoBitmapSize=t,this.Invalidate())},this.GetTextRect=function(){var t,e=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),i=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),s=0;return s=0,this.FAppearance.FDragGrip&&(s=1===this.FState?3:2),i.$assign(this.GetLocalRect()),i.$assign(pas["WEBLib.TMSFNCTypes"].RectF(i.Left+this.ScalePaintValue$1(s),i.Top,i.Right,i.Bottom)),pas["WEBLib.TMSFNCTypes"].InflateRectEx(i,this.ScalePaintValue(-2),this.ScalePaintValue(-2)),t=this.GetTextSize().cy,e.$assign(pas["WEBLib.TMSFNCTypes"].RectF(i.Left,i.Bottom-t,i.Right,i.Bottom)),e},this.GetDocURL=function(){return pas["WEBLib.TMSFNCTypes"].TTMSFNCBaseDocURL+"tmsfncuipack/components/"+pas.SysUtils.LowerCase(this.$classname)},this.GetVersion=function(){return this.$class.GetVersionNumber(1,0,2,2)},this.CanDrawDesignTime=function(){return!1,!1},this.CanBuildControls=function(){return!0,!0},this.GetOptionsMenuButtonClass=function(){return t.TTMSFNCToolBarDropDownButton},this.GetToolBarButtonClass=function(){return t.TTMSFNCToolBarButton},this.GetTextSize=function(){var t=pas["WEBLib.TMSFNCTypes"].TSizeF.$new(),e=null,i=0,s=pas["WEBLib.TMSFNCTypes"].TRectF.$new();if(t.cx=0,t.cy=0,this.FTextVisible&&""!==this.FText){e=pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.$create("CreateBitmapCanvas",[1,1,this.FNativeCanvas,!0]),this.FNativeCanvas||e.BeginScene(),e.FBitmapContainer=this.GetBitmapContainer(),e.FOptimizedHTMLDrawing=this.FOptimizedHTMLDrawing;try{i=0,this.FAppearance.FDragGrip&&(i=1===this.FState?3:2),e.FFont.Assign(this.FFont$1),s.$assign(this.GetLocalRect()),s.$assign(pas["WEBLib.TMSFNCTypes"].RectF(s.Left+i,s.Top,s.Right,s.Bottom)),pas["WEBLib.TMSFNCTypes"].InflateRectEx(s,-2,-2),t.$assign(e.CalculateTextSize(this.FText,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(s),this.FWordWrapping,!0))}finally{this.FNativeCanvas||e.EndScene(),e=rtl.freeLoc(e)}}return t},this.GetHiddenControl=function(t){var e=null,i=0;e=null;for(var s=0,o=this.FHiddenControls.GetCount()-1;s<=o;s++)if(i=s,this.FHiddenControls.GetItem$1(i).FControl===t){e=this.FHiddenControls.GetItem$1(i);break}return e},this.GetHiddenControlCount=function(e){var i=0,s=0,o=null;o=t.TTMSFNCToolBarControlList.$create("Create$1");for(var n=0,r=this.FHiddenControls.GetCount()-1;n<=r;n++)s=n,o.Add(this.FHiddenControls.GetItem$1(s));i=0;for(var a=0,l=o.GetCount()-1;a<=l&&(s=a,o.GetItem(s).FControl!==e);a++)i+=1;return o=rtl.freeLoc(o),i},this.GetCompactTextRect=function(){var t=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),e=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),i=pas["WEBLib.TMSFNCTypes"].TRectF.$new();return i.$assign(this.GetLocalRect()),e.$assign(this.GetCompactBitmapRect(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i))),t.$assign(pas["WEBLib.TMSFNCTypes"].RectF(i.Left+3,e.Bottom+3,i.Right-3,i.Bottom-23)),t},this.GetCompactBitmapRect=function(t){var e=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),i=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),s=0;return i.$assign(t),e.$assign(pas["WEBLib.TMSFNCTypes"].RectF(i.Left,i.Top,i.Right,i.Top)),this.FCompactBitmapVisible&&(s=this.GetCompactBitmapSize(),this.FTextVisible&&""!==this.FText?this.FTextVisible&&""!==this.FText&&e.$assign(pas["WEBLib.TMSFNCTypes"].RectF(i.Left+3,i.Top+3,i.Right-3,i.Top+s)):(e.$assign(pas["WEBLib.TMSFNCTypes"].RectF(i.Left+3,i.Top+3,i.Right-3,i.Bottom-3)),-1!==s&&(e.Left=Math.round(i.Left+(i.Right-i.Left-s)/2),e.Top=Math.round(i.Top+(i.Bottom-i.Top-s)/2),e.Right=e.Left+s,e.Bottom=e.Top+s))),e},this.GetCompactBitmapSize=function(){var t=0,e=null;return t=this.FCompactBitmapSize,this.FCompactAutoBitmapSize&&(null==(e=pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.GetScaledBitmap(this.FCompactBitmaps,0,this.GetBitmapContainer()))||pas["WEBLib.TMSFNCTypes"].IsBitmapEmpty(e)||(t=Math.max(e.GetHeight(),e.GetWidth()))),t},this.GetQuickMenuButtonRect=function(){var t=pas["WEBLib.TMSFNCTypes"].TRectF.$new();return t.$assign(pas["WEBLib.TMSFNCTypes"].RectF(this.GetWidth()-16,this.GetHeight()-16,this.GetWidth(),this.GetHeight())),this.FAppearance.FSeparator&&(t.Left=t.Left-this.FAppearance.FSeparatorStroke.FWidth,t.Right=t.Right-this.FAppearance.FSeparatorStroke.FWidth),t},this.HandleQuickMenuButton=function(){null!=this.FOnQuickMenuButtonClick&&this.FOnQuickMenuButtonClick(this)},this.CompactAppearanceChanged=function(t){this.Invalidate()},this.QuickMenuButtonAppearanceChanged=function(t){this.Invalidate()},this.CompactBitmapsChanged=function(t){var e;e=pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.GetScaledBitmap(this.FCompactBitmaps,0,this.GetBitmapContainer()),this.SetCompactBitmapVisible(null!=e&&!pas["WEBLib.TMSFNCTypes"].IsBitmapEmpty(e)),this.Invalidate()},this.CompactExpanderBitmapsChanged=function(t){this.Invalidate()},this.QuickMenuButtonBitmapsChanged=function(t){this.Invalidate()},this.ApplyFlatStyle=function(){for(var e=0,i=null,s=0,o=this.GetControlsCount()-1;s<=o;s++)e=s,i=this.GetControls(e),t.TTMSFNCDefaultToolBarButton.isPrototypeOf(i)&&rtl.as(i,t.TTMSFNCDefaultToolBarButton).FAppearance.SetFlatStyle(this.FAppearance.FFlatStyle),t.TTMSFNCCustomToolBar.isPrototypeOf(i)&&rtl.as(i,t.TTMSFNCCustomToolBar).FAppearance.SetFlatStyle(this.FAppearance.FFlatStyle);this.Invalidate()},this.SetAdaptToStyle=function(t){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.SetAdaptToStyle.apply(this,arguments),this.UpdateControls()},this.ApplyStyle=function(){var t=0;pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.ApplyStyle.call(this),t=-1,pas["WEBLib.TMSFNCStyles"].TTMSFNCStyles.GetStyleHeaderFillColor({get:function(){return t},set:function(e){t=e}})&&(this.FAppearance.FFill.SetKind(1),this.FAppearance.FFill.SetColor(t)),pas["WEBLib.TMSFNCStyles"].TTMSFNCStyles.GetStyleHeaderFillColorTo({get:function(){return t},set:function(e){t=e}})&&(this.FAppearance.FFill.SetKind(2),this.FAppearance.FFill.SetColorTo(t))},this.ResetToDefaultStyle=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.ResetToDefaultStyle.call(this),this.FAppearance.SetDragGripColor(13882323),this.FAppearance.FFill.SetColor(16777215),this.FAppearance.FStroke.SetColor(8421504),this.FAppearance.FFill.SetKind(2),this.FAppearance.FStroke.SetKind(1),this.FAppearance.FFill.SetColor(16777215),this.FAppearance.FFill.SetColorTo(pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(230,230,230))},this.HandleMouseDown=function(t,e,i,s){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleMouseDown.apply(this,arguments),this.FAppearance.FDragGrip&&!this.FDragGripMoving&&(this.FDragGripDown=pas["WEBLib.TMSFNCTypes"].PtInRectEx(this.GetDragGripRect(!0),pas["WEBLib.TMSFNCTypes"].PointF(i,s)),this.FDragGripDownPt.$assign(pas["WEBLib.TMSFNCTypes"].PointF(i,s))),this.FDragGripDown||(this.FCompact?(this.FDown=!0,this.Invalidate(),this.CaptureEx()):this.FQuickMenuButton&&(this.FQuickMenuButtonDown=pas["WEBLib.TMSFNCTypes"].PtInRectEx(this.GetQuickMenuButtonRect(),pas["WEBLib.TMSFNCTypes"].PointF(i,s)),this.FQuickMenuButtonDown&&(this.Invalidate(),this.CaptureEx()))),null!=this.FOnInternalMouseDown$1&&1!==t&&this.FOnInternalMouseDown$1(this)},this.HandleMouseMove=function(e,i,s){var o=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),n=0,r=0,a=pas["WEBLib.TMSFNCTypes"].TPointF.$new(),l=null;pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleMouseMove.apply(this,arguments),this.FCompact?(this.FHoverP=this.FHover,this.FHover=!0,this.FHover!==this.FHoverP&&this.Invalidate()):this.FQuickMenuButton&&(this.FQuickMenuButtonHoverP=this.FQuickMenuButtonHover,this.FQuickMenuButtonHover=pas["WEBLib.TMSFNCTypes"].PtInRectEx(this.GetQuickMenuButtonRect(),pas["WEBLib.TMSFNCTypes"].PointF(i,s)),this.FQuickMenuButtonHover!==this.FQuickMenuButtonHoverP&&this.Invalidate()),this.FAppearance.FDragGrip&&(this.FDragGripDown?(this.FDragGripMoving||(this.CaptureEx(),this.FDragGripMoving=!0),this.FDragGripMoving&&(n=this.FDragGripDownPt.X-i,r=this.FDragGripDownPt.Y-s,this.FAutoMoveToolBar&&(a.$assign(pas["WEBLib.TMSFNCTypes"].PointF(this.GetLeft()-n,this.GetTop()-r)),t.TTMSFNCCustomDockPanel.isPrototypeOf(this.FParent)&&(l=rtl.as(this.FParent,t.TTMSFNCCustomDockPanel)).FAutoAlign&&(a.Y<l.FAppearance.FMargins.FTop&&(a.Y=Math.round(l.FAppearance.FMargins.FTop)),a.X<l.FAppearance.FMargins.FLeft?a.X=Math.round(l.FAppearance.FMargins.FLeft):a.X+this.GetWidth()>l.GetWidth()-l.FAppearance.FMargins.FRight&&(a.X=Math.round(l.GetWidth()-l.FAppearance.FMargins.FRight-this.GetWidth())),this.SetBounds(Math.round(a.X),Math.round(a.Y),this.GetWidth(),this.GetHeight()))),this.FDragGripDownPt.$assign(pas["WEBLib.TMSFNCTypes"].PointF(i+n,s+r)),this.DoDragGripMoving(n,r))):(o.$assign(this.GetDragGripRect(!0)),pas["WEBLib.TMSFNCTypes"].PtInRectEx(o,pas["WEBLib.TMSFNCTypes"].PointF(i,s))?this.FInsideDrag||(this.FInsideDrag=!0,this.SetControlCursor(5)):this.FInsideDrag&&(this.FInsideDrag=!1,this.SetControlCursor(0)))),""!==this.XYToAnchor(i,s)?this.SetControlCursor(21):21===this.FCursor&&this.SetControlCursor(0),null!=this.FOnInternalMouseMove$1&&this.FOnInternalMouseMove$1(this)},this.HandleMouseLeave=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleMouseLeave.call(this),this.FHoverP=!1,this.FQuickMenuButtonHover=!1,this.SetControlCursor(0),this.FInsideDrag=!1,this.FHoverP!==this.FHover&&(this.FHover=!1,this.Invalidate())},this.HandleMouseUp=function(t,e,i,s){var o="";pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleMouseUp.apply(this,arguments),this.FDragGripDown?this.ReleaseCaptureEx():this.FDown&&this.FCompact?(this.Invalidate(),this.ReleaseCaptureEx(),this.HandleCompact()):this.FQuickMenuButtonDown&&this.FQuickMenuButton&&!this.FCompact&&(this.Invalidate(),this.ReleaseCaptureEx(),this.HandleQuickMenuButton()),this.FDragGripDown=!1,this.FDragGripMoving=!1,this.FDown=!1,this.FQuickMenuButtonDown=!1,""!==(o=this.XYToAnchor(i,s))&&this.DoAnchorClick(o),null!=this.FOnInternalMouseUp$1&&1!==t&&this.FOnInternalMouseUp$1(this)},this.HandleCompact=function(){var e=0,i=null;this.DeactivateAllPopups(),null!=this.FCompactToolbar&&(rtl.free(this,"FCompactToolbar"),this.FCompactToolbar=null),null!=this.FCompactPopup&&(rtl.free(this,"FCompactPopup"),this.FCompactPopup=null),this.FCompactPopup=t.TTMSFNCToolBarPopup.$create("Create$1",[this]),this.FCompactPopup.FOnClosePopup=rtl.createCallback(this,"DoCloseCompactPopup"),this.FCompactToolbar=t.TTMSFNCCustomToolBar.$create("Create$1",[this.FCompactPopup]),this.FCompactToolbar.Assign(this),this.FCompactToolbar.SetCompact(!1),this.FCompactToolbar.SetAS(!0),this.FCompactToolbar.SetAutoHeight(!1),this.FCompactToolbar.SetAutoWidth(!0),this.FCompactToolbar.SetAutoStretchHeight(!1),this.FCompactToolbar.FAppearance.SetSeparator(!1),this.FCompactToolbar.SetControlMargins(1,1,1,1),this.FCompactToolbar.SetHeight(this.GetHeight()+2);for(var s=this.FCompactControls.GetCount()-1;s>=0;s--)e=s,null!=(i=this.FCompactControls.GetItem$1(e)).FControl&&(t.TTMSFNCDefaultToolBarButton.isPrototypeOf(i.FControl)&&rtl.as(i.FControl,t.TTMSFNCDefaultToolBarButton).SetLayout(rtl.as(i.FControl,t.TTMSFNCDefaultToolBarButton).FCompactLayout),i.FControl.SetVisible(!0),i.FControl.SetParent(this.FCompactToolbar));this.FCompactToolbar.UpdateControls(),this.FCompactPopup.SetPlacementControl(this),this.FCompactPopup.SetContentControl(this.FCompactToolbar),this.FCompactPopup.SetIsOpen(!0),this.DoCompactClick()},this.DeactivateAllPopups=function(){var e=0;if(null!=this.FParent&&pas["WEBLib.Controls"].TWinControl.isPrototypeOf(this.FParent))for(var i=0,s=rtl.as(this.FParent,pas["WEBLib.Controls"].TWinControl).GetControlsCount()-1;i<=s;i++)e=i,t.TTMSFNCCustomToolBar.isPrototypeOf(rtl.as(this.FParent,pas["WEBLib.Controls"].TWinControl).GetControls(e))&&rtl.as(rtl.as(this.FParent,pas["WEBLib.Controls"].TWinControl).GetControls(e),t.TTMSFNCCustomToolBar).CloseCompactPopup()},this.DoCompactClick=function(){null!=this.FOnCompactClick&&this.FOnCompactClick(this)},this.HandleDblClick=function(t,e){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleDblClick.apply(this,arguments),null!=this.FOnInternalDblClick$1&&this.FOnInternalDblClick$1(this)},this.UpdateDockPanel=function(){null!=this.FOnUpdateDockPanel&&this.FOnUpdateDockPanel(this)},this.InsertToolBarControl=function(t,e){t.SetParent(this),e>-1&&this.SetChildOrder(t,e),null!=this.FOnInternalInsertControl&&this.FOnInternalInsertControl(t)},this.DoDragGripMoving=function(t,e){null!=this.FOnDragGripMoving&&this.FOnDragGripMoving(this,t,e)},this.VisibleChanging=function(){pas["WEBLib.Controls"].TControl.VisibleChanging.call(this),this.UpdateDockPanel()},this.GetDragGripRect=function(t){var e=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),i=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),s=0;return i.$assign(this.GetLocalRect()),s=1,1===this.FState&&(s=1.75),t?e.$assign(pas["WEBLib.TMSFNCTypes"].RectF(i.Left,i.Top,i.Left+this.ScalePaintValue$1(8*s),i.Bottom)):e.$assign(pas["WEBLib.TMSFNCTypes"].RectF(i.Left+this.ScalePaintValue(3),i.Top+this.ScalePaintValue(3),i.Left+this.ScalePaintValue$1(6*s),i.Bottom-this.ScalePaintValue(3))),e},this.CompactControls=function(){var e=0,i=null,s=null;this.FBlockUpdate=!0,this.FCompactControls.Clear();for(var o=this.GetControlsCount()-1;o>=0;o--)e=o,(s=this.GetControls(e))!==this.FOptionsMenuButton&&((i=t.TTMSFNCToolBarControl.$create("Create$1")).FControl=s,t.TTMSFNCDefaultToolBarButton.isPrototypeOf(s)&&(i.FLayout=rtl.as(s,t.TTMSFNCDefaultToolBarButton).FLayout,0===rtl.as(s,t.TTMSFNCDefaultToolBarButton).FCompactLayout&&0!==rtl.as(s,t.TTMSFNCDefaultToolBarButton).FLayout&&rtl.as(s,t.TTMSFNCDefaultToolBarButton).SetCompactLayout(rtl.as(s,t.TTMSFNCDefaultToolBarButton).FMaximumLayout)),t.TTMSFNCCustomToolBarElement.isPrototypeOf(s)?i.FControlIndex=rtl.as(s,t.TTMSFNCCustomToolBarElement).FControlIndex:i.FControlIndex=s.FTag$1,s.SetParent(null),s.SetVisible(!1),this.FCompactControls.Add$1(i));this.FBlockUpdate=!0,this.UpdateControls(),this.Invalidate()},this.UncompactControls=function(){var e=0,i=null;this.FBlockUpdate=!0;for(var s=this.FCompactControls.GetCount()-1;s>=0;s--)e=s,null!=(i=this.FCompactControls.GetItem$1(e).FControl)&&(t.TTMSFNCCustomToolBarElement.isPrototypeOf(i)&&(rtl.as(i,t.TTMSFNCCustomToolBarElement).FBlockUpdate=!0),i.SetParent(this),i.SetVisible(!0),t.TTMSFNCCustomToolBarElement.isPrototypeOf(i)&&(rtl.as(i,t.TTMSFNCCustomToolBarElement).FBlockUpdate=!1));this.FBlockUpdate=!1,this.UpdateControls(),this.Invalidate()},this.UpdateToolBar=function(t){this.UpdateControls()},this.DoIsLastElement=function(t,e){null!=this.FOnIsLastElement&&this.FOnIsLastElement(this,t,e)},this.UpdateToolBarControl=function(e){var i=null,s=null,o=null,n=null,r=0;null!=e&&(this.FBlockUpdate=!0,o=rtl.as(e,pas["WEBLib.Controls"].TControl),null!=(i=this.GetHiddenControl(o))?(n=i.FControl,r=Math.max(0,Math.min(this.GetControlsCount(),i.FControlIndex-this.GetHiddenControlCount(n))),this.FHiddenControls.Remove$1(i),this.InsertToolBarControl(n,r),n.SetVisible(!0)):(i=t.TTMSFNCToolBarControl.$create("Create$1"),t.TTMSFNCCustomToolBarElement.isPrototypeOf(o)?i.FControlIndex=rtl.as(o,t.TTMSFNCCustomToolBarElement).FControlIndex:i.FControlIndex=o.FTag$1,i.FControl=o,this.FBlockUpdate=!0,s=o.MakeScreenshot(),this.FBlockUpdate=!1,i.FBitmap.Assign(s),s=rtl.freeLoc(s),this.FHiddenControls.Add$1(i),o.SetParent(null),o.SetVisible(!1)),this.FBlockUpdate=!1,this.UpdateControls())},this.OptionsButtonClick=function(t){var e=pas["WEBLib.TMSFNCTypes"].TPointF.$new();null!=this.FOnOptionsMenuButtonClick?this.FOnOptionsMenuButtonClick(this):(e.$assign(pas["WEBLib.TMSFNCTypes"].PointF(this.FOptionsMenuButton.GetLeft(),this.FOptionsMenuButton.GetTop())),e.$assign(this.LocalToScreenEx(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(e.X,e.Y+this.FOptionsMenuButton.GetHeight())))),this.ShowOptionsMenu(e.X,e.Y))},this.DoCloseCompactPopup=function(e){var i=0,s=null;this.FCompactPopup.SetContentControl(null);for(var o=0,n=this.FCompactControls.GetCount()-1;o<=n;o++)i=o,null!=(s=this.FCompactControls.GetItem$1(i)).FControl&&(t.TTMSFNCDefaultToolBarButton.isPrototypeOf(s.FControl)&&rtl.as(s.FControl,t.TTMSFNCDefaultToolBarButton).SetLayout(s.FLayout),s.FControl.SetParent(null),s.FControl.SetVisible(!1));null!=this.FCompactToolbar&&(rtl.free(this,"FCompactToolbar"),this.FCompactToolbar=null)},this.Notification=function(t,e){pas["WEBLib.Menus"].TWebCustomControl.Notification.apply(this,arguments),1===e&&t===this.FBitmapContainer&&(this.FBitmapContainer=null),1===e&&t===this.FCustomOptionsMenu&&(this.FCustomOptionsMenu=null)},this.AlignControls=function(t,e){pas["WEBLib.Controls"].TControl.AlignControls.apply(this,arguments),this.UpdateControls()},this.UpdateControlAfterResize=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.UpdateControlAfterResize.call(this),this.UpdateDockPanel()},this.UpdateControls=function(){var e=this,i=0,s=null,o=0,n=!1,r=0,a=0,l=0,h=0,F=0,p=0,c=0,u=0,C=0,T=0,S=0,d=0,m=null,f=!1,g=null,y=pas["WEBLib.TMSFNCTypes"].TSizeF.$new(),M=null,b=0,N=0,B=0,E=0;function D(t){var i=null;if(i=null,t>=0&&t<=e.GetControlsCount()-1&&e.GetControls(t).FVisible)return i=e.GetControls(t);for(;t>=0&&t<=e.GetControlsCount()-1;)if((t+=1)>=0&&t<=e.GetControlsCount()-1&&e.GetControls(t).FVisible)return i=e.GetControls(t);return i}var L=rtl.createIntfRefs();try{if(this.FBlockUpdate||this.FBlockResize||function(){var t=!1,i=0;if(!(t=e.IsLoading()))for(var s=e.GetControlsCount()-1;s>=0;s--)if(i=s,0 in e.GetControls(i).FComponentState)return t=!0;return t}()||this.IsDestroying()||!this.CanBuildControls())return;this.FFirstLoad=!1,this.FBlockUpdate=!0,p=Math.round(this.FAppearance.FHorizontalSpacing),u=Math.round(this.FAppearance.FVerticalSpacing),a=p,this.FAppearance.FDragGrip&&(a+=Math.round(this.GetDragGripRect(!1).Right),0===p&&(a+=this.ScalePaintValue(3))),C=a,T=h=u,c=this.ScalePaintValue(30),S=0,d=0,y.$assign(this.GetTextSize()),y.cy>0&&(S=Math.round(y.cy+this.ScalePaintValue(4))),y.cx>0&&(d=Math.round(y.cx+this.ScalePaintValue(8))),l=d,r=0,F=0,o=0,n=!1;for(var G=0,A=e.GetControlsCount()-1;G<=A&&(i=G,s=e.GetControls(i),!(n=!(null!=this.GetHiddenControl(s))));G++);f=!1;for(var I=0,P=e.GetControlsCount()-1;I<=P;I++)if(i=I,s=e.GetControls(i),pas.SysUtils.Supports$1(L.ref(1,rtl.queryIntfT(s,pas.System.IUnknown)),rtl.getIntfGUIDR(pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),{get:function(){return g},set:function(t){g=t}})&&g.SetAdaptToStyle(this.GetAdaptToStyle()),f&&(a=C,T=h=T+F-u),f=!1,t.TTMSFNCCustomToolBarElement.isPrototypeOf(s)&&(f=rtl.as(s,t.TTMSFNCCustomToolBarElement).FLastElement,rtl.as(s,t.TTMSFNCCustomToolBarElement).FOnUpdateToolBar=rtl.createCallback(e,"UpdateToolBar"),rtl.as(s,t.TTMSFNCCustomToolBarElement).FOnUpdateToolBarControl=rtl.createCallback(e,"UpdateToolBarControl")),this.DoIsLastElement(s,{get:function(){return f},set:function(t){f=t}}),f&&(f=!0),s!==this.FOptionsMenuButton){if(n&&(t.TTMSFNCCustomToolBarElement.isPrototypeOf(s)?rtl.as(s,t.TTMSFNCCustomToolBarElement).FControlIndex=o:s.FTag$1=o),s.FVisible){if(s.FAlignWithMargins)if(this.FAutoAlign&&(s.SetLeft(a+s.FMargins.FLeft),s.SetTop(h+s.FMargins.FTop)),this.FAutoStretchHeight||t.TTMSFNCDefaultToolBarButton.isPrototypeOf(s)&&3===rtl.as(s,t.TTMSFNCDefaultToolBarButton).FLayout?(F=this.GetHeight()-s.FMargins.FBottom-S-h,s.SetHeight(F)):F=Math.max(F,s.GetTop()+s.GetHeight()+u+s.FMargins.FBottom),null!=(M=D(i+1))&&t.TTMSFNCDefaultToolBarButton.isPrototypeOf(M)){var w=rtl.as(M,t.TTMSFNCDefaultToolBarButton).FLayout;1===w||2===w?(h=Math.max(h,s.GetTop()+s.GetHeight()+u+s.FMargins.FBottom))+M.FMargins.FTop+M.GetHeight()>this.GetHeight()-M.FMargins.FBottom-S?(a=Math.max(a,Math.max(r,s.GetLeft()+s.GetWidth()+p+s.FMargins.FRight)),h=T):(s.SetLeft(a+s.FMargins.FLeft),r=Math.max(a,Math.max(r,s.GetLeft()+s.GetWidth()+p+s.FMargins.FRight))):0!==w&&3!==w||(a=Math.max(a,s.GetLeft()+s.GetWidth()+p+s.FMargins.FRight),h=T)}else a=Math.max(a,Math.max(r,s.GetLeft()+s.GetWidth()+p+s.FMargins.FRight)),h=T;else if(this.FAutoAlign&&(s.SetLeft(a),s.SetTop(h)),this.FAutoStretchHeight||t.TTMSFNCDefaultToolBarButton.isPrototypeOf(s)&&3===rtl.as(s,t.TTMSFNCDefaultToolBarButton).FLayout?(F=this.GetHeight()-S-h,s.SetHeight(F)):F=Math.max(F,s.GetTop()+s.GetHeight()+u),null!=(M=D(i+1))&&t.TTMSFNCDefaultToolBarButton.isPrototypeOf(M)){var $=rtl.as(M,t.TTMSFNCDefaultToolBarButton).FLayout;1===$||2===$?(h=Math.max(h,s.GetTop()+s.GetHeight()+u))+M.GetHeight()>this.GetHeight()-S?(a=Math.max(a,Math.max(r,s.GetLeft()+s.GetWidth()+p)),h=T):(s.SetLeft(a),r=Math.max(a,Math.max(r,s.GetLeft()+s.GetWidth()+p))):0!==$&&3!==$||(a=Math.max(a,s.GetLeft()+s.GetWidth()+p),h=T)}else a=Math.max(a,Math.max(r,s.GetLeft()+s.GetWidth()+p)),h=T;l=Math.max(l,a)}o+=1}0===F&&(F=c),this.FOptionsMenuButton.SetVisible(this.FOptionsMenu.FShowButton),this.FOptionsMenu.FShowButton?this.FOptionsMenuButton.SetParent(e):this.FOptionsMenuButton.SetParent(null),this.FOptionsMenuButton.FVisible&&(this.FOptionsMenuButton.FControlIndex=e.GetControlsCount()-1,this.FOptionsMenuButton.SetTop(this.FOptionsMenuButton.FMargins.FTop),m=this.FOptionsMenuButton.FMargins,this.FOptionsMenuButton.FAlignWithMargins||(m.SetLeft(0),m.SetTop(0),m.SetRight(0),m.SetBottom(0)),this.FAutoSize?(this.FOptionsMenuButton.SetLeft(l+m.FLeft),this.FAutoHeight?this.FOptionsMenuButton.SetHeight(F-m.FBottom-m.FTop):this.FAutoStretchHeight&&this.FOptionsMenuButton.SetHeight(this.GetHeight()-m.FBottom-S-m.FTop)):(this.FOptionsMenuButton.SetLeft(this.GetWidth()-this.FOptionsMenuButton.GetWidth()-m.FRight),this.FOptionsMenuButton.SetHeight(this.GetHeight()-m.FBottom-m.FTop-S)),l=l+this.FOptionsMenuButton.GetWidth()+m.FRight+m.FLeft),this.FAutoSize&&(this.FAppearance.FSeparator&&(l+=Math.round(this.FAppearance.FSeparatorStroke.FWidth)),l=Math.round(Math.max(this.FMinimumWidth,l)),0===this.GetControlAlignment()&&(b=0,B=0,N=0,E=0,this.GetControlMargins({get:function(){return b},set:function(t){b=t}},{get:function(){return N},set:function(t){N=t}},{get:function(){return B},set:function(t){B=t}},{get:function(){return E},set:function(t){E=t}}),l+=Math.round(b+B)),F+=S,this.FAutoHeight&&this.FAutoWidth&&0===this.GetControlAlignment()?this.SetBounds(this.GetLeft(),this.GetTop(),l,F):this.FAutoHeight&&!(this.GetControlAlignment()in rtl.createSet(3,4,5))?this.SetBounds(this.GetLeft(),this.GetTop(),this.GetWidth(),F):this.FAutoWidth&&!(this.GetControlAlignment()in rtl.createSet(1,2,5))&&this.SetBounds(this.GetLeft(),this.GetTop(),l,this.GetHeight())),null!=this.FOnUpdateControls&&this.FOnUpdateControls(e),this.FBlockUpdate=!1}finally{L.free(),rtl._Release(g)}},this.DrawDragGrip=function(t){var e=this;var i=pas["WEBLib.TMSFNCTypes"].TRectF.$new();t.FFill.SetColor(this.FAppearance.FDragGripColor),t.FFill.SetKind(1),i.$assign(this.GetDragGripRect(!1)),function(i){var s=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),o=0;o=1===e.FState?e.ScalePaintValue(3):e.ScalePaintValue(2),i.Left=i.Left,i.Top=i.Top;for(var n=1,r=rtl.trunc(Math.round(i.Bottom)/(2*Math.round(o)));n<=r;n++)n,s.$assign(pas["WEBLib.TMSFNCTypes"].RectF(i.Left+(i.Right-i.Left-o)/2,i.Top+1,i.Left+o+(i.Right-i.Left-o)/2,i.Top+1+o)),s.$assign(pas["WEBLib.TMSFNCTypes"].RectF(pas.System.Int(s.Left),pas.System.Int(s.Top),pas.System.Int(s.Right),pas.System.Int(s.Bottom))),t.DrawRectangle$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(s),2),i.Top=i.Top+2*o}(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i))},this.DrawText=function(t){var e=pas["WEBLib.TMSFNCTypes"].TRectF.$new();this.FTextVisible&&""!==this.FText&&(t.FFont.Assign(this.FFont$1),e.$assign(this.GetTextRect()),t.DrawText$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),this.FText,this.FWordWrapping,this.FHorizontalTextAlign,this.FVerticalTextAlign,this.FTrimming,0,-1,-1,!0,!1,-1,-1))},this.DrawCompactBitmap=function(t,e){var i=pas["WEBLib.TMSFNCTypes"].TRectF.$new();i.$assign(this.GetCompactBitmapRect(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e))),t.FBitmapContainer=this.GetBitmapContainer(),t.DrawScaledBitmap(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),this.FCompactBitmaps,0,!0,!1,!0,!1)},this.DrawCompactText=function(t){var e,i=pas["WEBLib.TMSFNCTypes"].TRectF.$new();if(this.FTextVisible&&""!==this.FText){i.$assign(this.GetCompactTextRect()),e=t.SaveState(!1);try{t.ClipRect(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i)),t.FFont.Assign(this.FFont$1),t.DrawText$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),this.FText,this.FWordWrapping,this.FHorizontalTextAlign,this.FVerticalTextAlign,this.FTrimming,0,-1,-1,!0,!1,-1,-1)}finally{t.RestoreState(e,!1)}}},this.DrawCompactExpander=function(t){var e=pas["WEBLib.TMSFNCTypes"].TRectF.$new();e.$assign(this.GetLocalRect()),e.$assign(pas["WEBLib.TMSFNCTypes"].RectF(e.Left,e.Bottom-20,e.Right,e.Bottom)),pas["WEBLib.TMSFNCTypes"].InflateRectEx(e,-2,-2),t.DrawScaledBitmap(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),this.FCompactExpanderBitmaps,0,!0,!1,!0,!1)},this.ShowOptionsMenu=function(t,e){},this.XYToAnchor=function(t,e){var i="",s=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),o=null;i="",s.$assign(this.GetTextRect()),(o=pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.$create("CreateBitmapCanvas",[1,1,!1,!0])).BeginScene(),o.FBitmapContainer=this.GetBitmapContainer();try{o.FFont.Assign(this.FFont$1),i=o.DrawText$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(s),this.FText,this.FWordWrapping,this.FHorizontalTextAlign,this.FVerticalTextAlign,this.FTrimming,0,-1,-1,!0,!0,t,e)}finally{o.EndScene(),o=rtl.freeLoc(o)}return i},this.DoAnchorClick=function(t){null!=this.FOnAnchorClick?this.FOnAnchorClick(this,t):pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.OpenURL(t)},this.Loaded=function(){pas["WEBLib.Controls"].TCustomControl.Loaded.call(this)},this.Assign=function(e){var i=null,s=null,o=0;if(pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Assign.apply(this,arguments),t.TTMSFNCCustomToolBar.isPrototypeOf(e)){this.FCompactAppearance.Assign(rtl.as(e,t.TTMSFNCCustomToolBar).FCompactAppearance),this.FQuickMenuButtonAppearance.Assign(rtl.as(e,t.TTMSFNCCustomToolBar).FQuickMenuButtonAppearance),this.FQuickMenuButton=rtl.as(e,t.TTMSFNCCustomToolBar).FQuickMenuButton,this.FCompactBitmaps.Assign(rtl.as(e,t.TTMSFNCCustomToolBar).FCompactBitmaps),this.FCompact=rtl.as(e,t.TTMSFNCCustomToolBar).FCompact,this.FCanCompact=rtl.as(e,t.TTMSFNCCustomToolBar).FCanCompact,this.FMinimumWidth=rtl.as(e,t.TTMSFNCCustomToolBar).FMinimumWidth,this.FCompactWidth=rtl.as(e,t.TTMSFNCCustomToolBar).FCompactWidth,this.FCompactBitmapSize=rtl.as(e,t.TTMSFNCCustomToolBar).FCompactBitmapSize,this.FCompactAutoBitmapSize=rtl.as(e,t.TTMSFNCCustomToolBar).FCompactAutoBitmapSize,this.FCompactExpanderBitmaps.Assign(rtl.as(e,t.TTMSFNCCustomToolBar).FCompactExpanderBitmaps),this.FQuickMenuButtonBitmaps.Assign(rtl.as(e,t.TTMSFNCCustomToolBar).FQuickMenuButtonBitmaps),this.FCompactBitmapVisible=rtl.as(e,t.TTMSFNCCustomToolBar).FCompactBitmapVisible,this.FText=rtl.as(e,t.TTMSFNCCustomToolBar).FText,this.FTextVisible=rtl.as(e,t.TTMSFNCCustomToolBar).FTextVisible,this.FWordWrapping=rtl.as(e,t.TTMSFNCCustomToolBar).FWordWrapping,this.FHorizontalTextAlign=rtl.as(e,t.TTMSFNCCustomToolBar).FHorizontalTextAlign,this.FVerticalTextAlign=rtl.as(e,t.TTMSFNCCustomToolBar).FVerticalTextAlign,this.FTrimming=rtl.as(e,t.TTMSFNCCustomToolBar).FTrimming,this.FFont$1.Assign(rtl.as(e,t.TTMSFNCCustomToolBar).FFont$1),this.FAutoSize=rtl.as(e,t.TTMSFNCCustomToolBar).FAutoSize,this.FAutoHeight=rtl.as(e,t.TTMSFNCCustomToolBar).FAutoHeight,this.FAutoWidth=rtl.as(e,t.TTMSFNCCustomToolBar).FAutoWidth,this.FAutoAlign=rtl.as(e,t.TTMSFNCCustomToolBar).FAutoAlign,this.FAutoStretchHeight=rtl.as(e,t.TTMSFNCCustomToolBar).FAutoStretchHeight,this.FAutoMoveToolBar=rtl.as(e,t.TTMSFNCCustomToolBar).FAutoMoveToolBar,this.FAppearance.Assign(rtl.as(e,t.TTMSFNCCustomToolBar).FAppearance);for(var n=0,r=rtl.as(e,t.TTMSFNCCustomToolBar).GetControlsCount()-1;n<=r;n++)o=n,s=rtl.as(e,t.TTMSFNCCustomToolBar).GetControls(o),(t.TTMSFNCDefaultToolBarButton.isPrototypeOf(s)&&rtl.as(s,t.TTMSFNCDefaultToolBarButton).FCanCopy||!t.TTMSFNCDefaultToolBarButton.isPrototypeOf(s)||!pas["WEBLib.Controls"].TControl.isPrototypeOf(s))&&(t.TTMSFNCDefaultToolBarButton.isPrototypeOf(s)&&(rtl.as(s,t.TTMSFNCDefaultToolBarButton).FApplyName=!1),i=rtl.as(pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.Clone(s),pas["WEBLib.Controls"].TControl),t.TTMSFNCDefaultToolBarButton.isPrototypeOf(s)&&(rtl.as(s,t.TTMSFNCDefaultToolBarButton).FApplyName=!0),this.AddCustomControl(i,-1));this.Invalidate()}else pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Assign.apply(this,arguments)},this.Create$1=function(e){var i=0;return pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Create$1.apply(this,arguments),this.FFirstLoad=!0,this.FHiddenControls=t.TTMSFNCToolBarControlObjectList.$create("Create$2"),this.FCompactControls=t.TTMSFNCToolBarControlObjectList.$create("Create$2"),this.FState=0,this.FAppearance=t.TTMSFNCToolBarAppearance.$create("Create$1",[this]),this.FCompactAppearance=t.TTMSFNCToolBarCompactAppearance.$create("Create$1",[null]),this.FCompactAppearance.FOnChange=rtl.createCallback(this,"CompactAppearanceChanged"),this.FQuickMenuButtonAppearance=t.TTMSFNCToolBarQuickMenuButtonAppearance.$create("Create$1",[null]),this.FQuickMenuButtonAppearance.FOnChange=rtl.createCallback(this,"QuickMenuButtonAppearanceChanged"),this.FCompactBitmaps=pas["WEBLib.TMSFNCTypes"].TTMSFNCScaledBitmaps.$create("Create$3",[this]),this.FCompactBitmaps.FOnChange=rtl.createCallback(this,"CompactBitmapsChanged"),this.FOptionsMenu=t.TTMSFNCToolBarOptionsMenu.$create("Create$1",[this]),this.FMinimumWidth=30,this.FCompactWidth=50,this.FCompactBitmapSize=24,this.FCompactAutoBitmapSize=!1,this.FCompactBitmapVisible=!1,this.FCompactExpanderBitmaps=pas["WEBLib.TMSFNCTypes"].TTMSFNCScaledBitmaps.$create("Create$3",[this]),this.FCompactExpanderBitmaps.FOnChange=rtl.createCallback(this,"CompactExpanderBitmapsChanged"),this.FQuickMenuButtonBitmaps=pas["WEBLib.TMSFNCTypes"].TTMSFNCScaledBitmaps.$create("Create$3",[this]),this.FQuickMenuButtonBitmaps.FOnChange=rtl.createCallback(this,"QuickMenuButtonBitmapsChanged"),this.FCanCompact=!0,this.FQuickMenuButton=!1,this.FCompact=!1,this.FAutoSize=!0,this.FAutoWidth=!0,this.FAutoHeight=!0,this.FAutoAlign=!0,this.FAutoStretchHeight=!1,this.FAutoMoveToolBar=!0,this.FOptionsMenuButton=this.GetOptionsMenuButtonClass().$create("Create$1",[this]),this.FOptionsMenuButton.FAppearance.FNormalFill.SetKind(1),i=13882323,this.FOptionsMenuButton.FAppearance.FNormalFill.SetColor(i),this.FOptionsMenuButton.FAppearance.SetShowInnerStroke(!1),this.FOptionsMenuButton.FAppearance.SetRounding(0),this.FOptionsMenuButton.FAppearance.FHoverFill.Assign(this.FOptionsMenuButton.FAppearance.FNormalFill),this.FOptionsMenuButton.FAppearance.FDisabledFill.Assign(this.FOptionsMenuButton.FAppearance.FNormalFill),this.FOptionsMenuButton.FAppearance.FDownFill.Assign(this.FOptionsMenuButton.FAppearance.FNormalFill),this.FOptionsMenuButton.FAppearance.FHoverFill.SetColor(15128749),this.FOptionsMenuButton.FAppearance.FDownFill.SetColor(14599344),this.FOptionsMenuButton.FAppearance.FDisabledFill.SetColor(13882323),this.FOptionsMenuButton.SetAlignWithMargins(!0),this.FOptionsMenuButton.FMargins.SetTop(3),this.FOptionsMenuButton.FMargins.SetBottom(3),this.FOptionsMenuButton.FMargins.SetRight(3),this.FOptionsMenuButton.FCanCopy=!1,this.FAutoOptionsMenu=pas["WEBLib.Menus"].TPopupMenu.$create("Create$1",[this]),this.FOptionsMenuButton.FOnClick=rtl.createCallback(this,"OptionsButtonClick"),this.FOptionsMenuButton.SetWidth(17),this.FOptionsMenuButton.SetText(""),this.FOptionsMenuButton.FStored=!1,this.FOptionsMenuButton.FBitmaps.AddBitmapFromResource$1(pas["WEBLib.TMSFNCToolBarRes"].TMSFNCTOOLBAROPTIONSMENU,pas["WEBLib.TMSFNCTypes"].HInstance(),1),this.FOptionsMenuButton.FBitmaps.AddBitmapFromResource$1(pas["WEBLib.TMSFNCToolBarRes"].TMSFNCTOOLBAROPTIONSMENULARGE,pas["WEBLib.TMSFNCTypes"].HInstance(),1.5),this.FOptionsMenuButton.FDisabledBitmaps.AddBitmapFromResource$1(pas["WEBLib.TMSFNCToolBarRes"].TMSFNCTOOLBAROPTIONSMENU,pas["WEBLib.TMSFNCTypes"].HInstance(),1),this.FOptionsMenuButton.FDisabledBitmaps.AddBitmapFromResource$1(pas["WEBLib.TMSFNCToolBarRes"].TMSFNCTOOLBAROPTIONSMENULARGE,pas["WEBLib.TMSFNCTypes"].HInstance(),1.5),this.FOptionsMenuButton.FHoverBitmaps.AddBitmapFromResource$1(pas["WEBLib.TMSFNCToolBarRes"].TMSFNCTOOLBAROPTIONSMENU,pas["WEBLib.TMSFNCTypes"].HInstance(),1),this.FOptionsMenuButton.FHoverBitmaps.AddBitmapFromResource$1(pas["WEBLib.TMSFNCToolBarRes"].TMSFNCTOOLBAROPTIONSMENULARGE,pas["WEBLib.TMSFNCTypes"].HInstance(),1.5),this.FHorizontalTextAlign=0,this.FVerticalTextAlign=0,this.FTrimming=1,this.FWordWrapping=!1,this.FTextVisible=!0,this.FFont$1=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFont.$create("Create$2"),this.FCompactPopup=t.TTMSFNCToolBarPopup.$create("Create$1",[this]),this.FCompactPopup.FOnClosePopup=rtl.createCallback(this,"DoCloseCompactPopup"),this.FCompactExpanderBitmaps.AddBitmapFromResource$1(pas["WEBLib.TMSFNCGraphics"].TMSFNCGRAPHICSDOWN,pas["WEBLib.TMSFNCTypes"].HInstance(),1),this.FQuickMenuButtonBitmaps.AddBitmapFromResource$1(pas["WEBLib.TMSFNCToolBarRes"].TMSFNCTOOLBARQUICKMENU,pas["WEBLib.TMSFNCTypes"].HInstance(),1),this},this.Destroy=function(){rtl.free(this,"FQuickMenuButtonBitmaps"),rtl.free(this,"FCompactExpanderBitmaps"),rtl.free(this,"FCompactPopup"),rtl.free(this,"FQuickMenuButtonAppearance"),rtl.free(this,"FCompactAppearance"),rtl.free(this,"FCompactBitmaps"),rtl.free(this,"FFont$1"),rtl.free(this,"FOptionsMenu"),rtl.free(this,"FAppearance"),rtl.free(this,"FHiddenControls"),rtl.free(this,"FCompactControls"),pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Destroy.call(this)},this.Draw=function(t,e){var i=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),s=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),o=0;pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Draw.apply(this,arguments),s.$assign(this.GetLocalRect()),this.FCompact?(this.FDown?(t.FFill.Assign(this.FCompactAppearance.FDownFill),t.FStroke.Assign(this.FCompactAppearance.FDownStroke)):this.FHover?(t.FFill.Assign(this.FCompactAppearance.FHoverFill),t.FStroke.Assign(this.FCompactAppearance.FHoverStroke)):(t.FFill.Assign(this.FCompactAppearance.FNormalFill),t.FStroke.Assign(this.FCompactAppearance.FNormalStroke)),this.FCompactAppearance.FFlatStyle&&t.FFill.SetKind(1),t.DrawRectangle$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(s.Left,s.Top+2,s.Right-3,s.Bottom-2)),2)):(t.FFill.Assign(this.FAppearance.FFill),t.FStroke.Assign(this.FAppearance.FStroke),this.FAppearance.FFlatStyle&&t.FFill.SetKind(1),t.DrawRectangle$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(s),2)),this.FCompact?(this.DrawCompactBitmap(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e)),this.DrawCompactText(t),this.DrawCompactExpander(t)):(this.FAppearance.FDragGrip&&this.DrawDragGrip(t),this.DrawText(t),this.FQuickMenuButton&&(this.FQuickMenuButtonDown?(t.FFill.Assign(this.FQuickMenuButtonAppearance.FDownFill),t.FStroke.Assign(this.FQuickMenuButtonAppearance.FDownStroke)):this.FQuickMenuButtonHover?(t.FFill.Assign(this.FQuickMenuButtonAppearance.FHoverFill),t.FStroke.Assign(this.FQuickMenuButtonAppearance.FHoverStroke)):(t.FFill.Assign(this.FQuickMenuButtonAppearance.FNormalFill),t.FStroke.Assign(this.FQuickMenuButtonAppearance.FNormalStroke)),this.FQuickMenuButtonAppearance.FFlatStyle&&t.FFill.SetKind(1),i.$assign(this.GetQuickMenuButtonRect()),t.DrawRectangle$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),2),pas["WEBLib.TMSFNCTypes"].InflateRectEx(i,-2,-2),t.DrawScaledBitmap(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),this.FQuickMenuButtonBitmaps,0,!0,!1,!0,!1))),this.FAppearance.FSeparator&&(t.FStroke.Assign(this.FAppearance.FSeparatorStroke),o=this.FAppearance.FSeparatorStroke.FWidth,t.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(s.Right-o,s.Top+4)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(s.Right-o,s.Bottom-4)),2,2)),this.IsDesignTime()&&this.CanDrawDesignTime()&&t.DrawFocusRectangle$3(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),0,2)},this.DropDownActive=function(){var e=!1,i=0,s=null;e=!1;for(var o=0,n=this.GetControlsCount()-1;o<=n&&(i=o,s=this.GetControls(i),!t.TTMSFNCDefaultToolBarButton.isPrototypeOf(s)||null==rtl.as(s,t.TTMSFNCDefaultToolBarButton).FPopup||!(e=rtl.as(s,t.TTMSFNCDefaultToolBarButton).FPopup.FIsOpen));o++);return e},this.CloseCompactPopup=function(){null!=this.FCompactPopup&&this.FCompactPopup.SetIsOpen(!1)},this.AddCustomControl=function(t,e){this.FBlockUpdate=!0,this.InsertToolBarControl(t,e),this.FBlockUpdate=!1,this.UpdateControls()},this.AddButton=function(t,e,i,s,o,n){var r=null;return this.FBlockUpdate=!0,(r=this.GetToolBarButtonClass().$create("Create$1",[this])).FAppearance.SetFlatStyle(this.FAppearance.FFlatStyle),r.SetText(o),-1!==t&&r.SetWidth(Math.round(t)),-1!==e&&r.SetHeight(Math.round(e)),""!==i&&(r.FBitmaps.AddBitmapFromResource$1(i,pas["WEBLib.TMSFNCTypes"].HInstance(),1),r.FDisabledBitmaps.AddBitmapFromResource$1(i,pas["WEBLib.TMSFNCTypes"].HInstance(),1),r.FHoverBitmaps.AddBitmapFromResource$1(i,pas["WEBLib.TMSFNCTypes"].HInstance(),1)),""!==s&&(r.FBitmaps.AddBitmapFromResource$1(s,pas["WEBLib.TMSFNCTypes"].HInstance(),1.5),r.FDisabledBitmaps.AddBitmapFromResource$1(s,pas["WEBLib.TMSFNCTypes"].HInstance(),1.5),r.FHoverBitmaps.AddBitmapFromResource$1(s,pas["WEBLib.TMSFNCTypes"].HInstance(),1.5)),this.InsertToolBarControl(r,n),this.FBlockUpdate=!1,this.UpdateControls(),r},rtl.addIntf(this,pas["WEBLib.TMSFNCBitmapContainer"].ITMSFNCBitmapContainer),rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas["WEBLib.TMSFNCTypes"].ITMSFNCProductInfo),rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TTMSFNCToolBar",this.TTMSFNCCustomToolBar,(function(){this.RegisterRuntimeClasses=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.RegisterRuntimeClasses.call(this),pas.Classes.RegisterClass(t.TTMSFNCToolBar)},rtl.addIntf(this,pas["WEBLib.TMSFNCBitmapContainer"].ITMSFNCBitmapContainer),rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas["WEBLib.TMSFNCTypes"].ITMSFNCProductInfo),rtl.addIntf(this,pas.System.IUnknown);var e=this.$rtti;e.addProperty("OnOptionsMenuButtonClick",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnOptionsMenuButtonClick","FOnOptionsMenuButtonClick"),e.addProperty("OnOptionsMenuItemCanShow",0,t.$rtti.TTMSFNCToolBarCanShowOptionsMenuItem,"FOnOptionsMenuItemCanShow","FOnOptionsMenuItemCanShow"),e.addProperty("OnOptionsMenuCustomize",0,t.$rtti.TTMSFNCToolBarCustomizeOptionsMenu,"FOnOptionsMenuCustomize","FOnOptionsMenuCustomize"),e.addProperty("OnOptionsMenuItemCustomize",0,t.$rtti.TTMSFNCToolBarCustomizeOptionsMenuItem,"FOnOptionsMenuItemCustomize","FOnOptionsMenuItemCustomize"),e.addProperty("OnOptionsMenuItemApplyStyle",0,t.$rtti.TTMSFNCToolBarCustomizeOptionsMenuItem,"FOnOptionsMenuItemApplyStyle","FOnOptionsMenuItemApplyStyle"),e.addProperty("OnOptionsMenuItemClick",0,t.$rtti.TTMSFNCToolBarOptionsMenuItemClick,"FOnOptionsMenuItemClick","FOnOptionsMenuItemClick"),e.addProperty("OnIsLastElement",0,t.$rtti.TTMSFNCToolBarIsLastElement,"FOnIsLastElement","FOnIsLastElement"),e.addProperty("OnDragGripMoving",0,t.$rtti.TTMSFNCToolBarDragGripMovingEvent,"FOnDragGripMoving","FOnDragGripMoving"),e.addProperty("OnQuickMenuButtonClick",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnQuickMenuButtonClick","FOnQuickMenuButtonClick"),e.addProperty("OnAnchorClick",0,t.$rtti.TTMSFNCToolBarAnchorClickEvent,"FOnAnchorClick","FOnAnchorClick"),e.addProperty("Version",1,rtl.string,"GetVersion",""),e.addProperty("AutoHeight",2,rtl.boolean,"FAutoHeight","SetAutoHeight",{Default:!0}),e.addProperty("AutoWidth",2,rtl.boolean,"FAutoWidth","SetAutoWidth",{Default:!0}),e.addProperty("AutoSize",2,rtl.boolean,"FAutoSize","SetAS",{Default:!0}),e.addProperty("AutoAlign",2,rtl.boolean,"FAutoAlign","SetAutoAlign",{Default:!0}),e.addProperty("AutoStretchHeight",2,rtl.boolean,"FAutoStretchHeight","SetAutoStretchHeight",{Default:!1}),e.addProperty("AutoMoveToolBar",0,rtl.boolean,"FAutoMoveToolBar","FAutoMoveToolBar",{Default:!0}),e.addProperty("Appearance",2,t.$rtti.TTMSFNCToolBarAppearance,"FAppearance","SetAppearance"),e.addProperty("CanCompact",2,rtl.boolean,"FCanCompact","SetCanCompact",{Default:!0}),e.addProperty("OnCompactClick",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnCompactClick","FOnCompactClick"),e.addProperty("CompactBitmapVisible",2,rtl.boolean,"FCompactBitmapVisible","SetCompactBitmapVisible",{Default:!1}),e.addProperty("CompactBitmaps",2,pas["WEBLib.TMSFNCTypes"].$rtti.TTMSFNCScaledBitmaps,"FCompactBitmaps","SetCompactBitmaps"),e.addProperty("Compact",2,rtl.boolean,"FCompact","SetCompact",{Default:!1}),e.addProperty("CompactWidth",14,rtl.double,"FCompactWidth","SetCompactWidth",{stored:"IsCompactWidthStored"}),e.addProperty("CompactAppearance",2,t.$rtti.TTMSFNCToolBarCompactAppearance,"FCompactAppearance","SetCompactAppearance"),e.addProperty("CompactBitmapSize",14,rtl.double,"FCompactBitmapSize","SetCompactBitmapSize",{stored:"IsCompactBitmapSizeStored"}),e.addProperty("CompactAutoBitmapSize",2,rtl.boolean,"FCompactAutoBitmapSize","SetCompactAutoBitmapSize",{Default:!1}),e.addProperty("QuickMenuButtonHint",0,rtl.string,"FQuickMenuButtonHint","FQuickMenuButtonHint"),e.addProperty("QuickMenuButton",2,rtl.boolean,"FQuickMenuButton","SetQuickMenuButton",{Default:!1}),e.addProperty("QuickMenuButtonAppearance",2,t.$rtti.TTMSFNCToolBarQuickMenuButtonAppearance,"FQuickMenuButtonAppearance","SetQuickMenuButtonAppearance"),e.addProperty("MinimumWidth",14,rtl.double,"FMinimumWidth","SetMinimumWidth",{stored:"IsMinimumWidthStored"}),e.addProperty("WordWrapping",2,rtl.boolean,"FWordWrapping","SetWordWrapping",{Default:!1}),e.addProperty("Text",2,rtl.string,"FText","SetText"),e.addProperty("Trimming",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsTextTrimming,"FTrimming","SetTrimming",{Default:pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsTextTrimming.gttCharacter}),e.addProperty("HorizontalTextAlign",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsTextAlign,"FHorizontalTextAlign","SetHorizontalTextAlign",{Default:pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsTextAlign.gtaCenter}),e.addProperty("VerticalTextAlign",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsTextAlign,"FVerticalTextAlign","SetVerticalTextAlign",{Default:pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsTextAlign.gtaCenter}),e.addProperty("Font",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFont,"FFont$1","SetFont$1"),e.addProperty("OptionsMenu",2,t.$rtti.TTMSFNCToolBarOptionsMenu,"FOptionsMenu","SetOptionsMenu"),e.addProperty("CustomOptionsMenu",0,pas["WEBLib.Menus"].$rtti.TPopupMenu,"FCustomOptionsMenu","FCustomOptionsMenu"),e.addProperty("State",2,t.$rtti.TTMSFNCToolBarElementState,"FState","SetState",{Default:t.TTMSFNCToolBarElementState.esNormal}),e.attr=[pas.Classes.ComponentPlatformsAttribute,"Create$1",[0]]})),rtl.createClass(this,"TTMSFNCCustomDockPanelAppearance",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FOwner=null,this.FFill=null,this.FStroke=null,this.FMargins=null},this.$final=function(){this.FOwner=void 0,this.FFill=void 0,this.FStroke=void 0,this.FMargins=void 0,pas.Classes.TPersistent.$final.call(this)},this.SetFill=function(t){this.FFill.Assign(t)},this.SetStroke=function(t){this.FStroke.Assign(t)},this.FillChanged=function(t){this.FOwner.Invalidate()},this.StrokeChanged=function(t){this.FOwner.Invalidate()},this.Create$1=function(t){return this.FOwner=t,this.FFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[1,16777215,8421504,-1,-1]),this.FStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,8421504]),this.FFill.FOnChanged=rtl.createCallback(this,"FillChanged"),this.FStroke.FOnChanged=rtl.createCallback(this,"StrokeChanged"),this.FMargins=pas["WEBLib.TMSFNCTypes"].TTMSFNCMargins.$create("Create$1"),this.FMargins.SetLeft(3),this.FMargins.SetTop(3),this.FMargins.SetBottom(3),this.FMargins.SetRight(3),this},this.Destroy=function(){rtl.free(this,"FMargins"),rtl.free(this,"FFill"),rtl.free(this,"FStroke"),pas.System.TObject.Destroy.call(this)}})),rtl.createClass(this,"TTMSFNCDockPanelAppearance",this.TTMSFNCCustomDockPanelAppearance,(function(){var t=this.$rtti;t.addProperty("Fill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FFill","SetFill"),t.addProperty("Stroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FStroke","SetStroke")})),rtl.createClass(this,"TTMSFNCCustomDockPanel",pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl,(function(){this.$init=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.$init.call(this),this.FBlockUpdate=!1,this.FAppearance=null,this.FAutoSize=!1,this.FAutoAlign=!1,this.FState=0},this.$final=function(){this.FAppearance=void 0,pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.$final.call(this)},this.SetAutoAlign=function(t){this.FAutoAlign!==t&&(this.FAutoAlign=t,this.UpdateControls())},this.SetAS=function(t){this.FAutoSize!==t&&(this.FAutoSize=t,this.UpdateControls())},this.SetState=function(e){var i=0,s=null;if(this.FState!==e){this.FState=e;for(var o=0,n=this.GetControlsCount()-1;o<=n;o++)i=o,s=this.GetControls(i),t.TTMSFNCCustomToolBar.isPrototypeOf(s)&&rtl.as(s,t.TTMSFNCCustomToolBar).SetState(this.FState)}},this.GetDocURL=function(){return pas["WEBLib.TMSFNCTypes"].TTMSFNCBaseDocURL+"tmsfncuipack/components/ttmsfnctoolbar"},this.GetVersion=function(){return this.$class.GetVersionNumber(1,0,2,2)},this.SetAdaptToStyle=function(t){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.SetAdaptToStyle.apply(this,arguments),this.UpdateControls()},this.UpdateControls=function(){var t=0,e=0,i=0,s=null,o=null,n=rtl.createIntfRefs();try{if(this.FBlockUpdate||this.IsLoading()||this.IsDestroying())return;if(this.FBlockUpdate=!0,e=0,i=this.ScalePaintValue(30),this.FAutoAlign&&(this.InitializeControls(),this.RearrangeControls()),this.FAutoSize){for(var r=0,a=this.GetControlsCount()-1;r<=a;r++)t=r,s=this.GetControls(t),pas.SysUtils.Supports$1(n.ref(1,rtl.queryIntfT(s,pas.System.IUnknown)),rtl.getIntfGUIDR(pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),{get:function(){return o},set:function(t){o=t}})&&o.SetAdaptToStyle(this.GetAdaptToStyle()),s.FVisible&&(e=Math.round(Math.max(e,s.GetTop()+s.GetHeight()+this.FAppearance.FMargins.FBottom)));0===e&&(e=i),4 in this.FComponentState&&(e+=this.ScalePaintValue(15)),this.SetBounds(this.GetLeft(),this.GetTop(),this.GetWidth(),e)}this.FBlockUpdate=!1}finally{n.free(),rtl._Release(o)}},this.InitializeControls=function(){for(var e=0,i=null,s=0,o=this.GetControlsCount()-1;s<=o;s++)e=s,i=this.GetControls(e),t.TTMSFNCCustomToolBar.isPrototypeOf(i)&&(rtl.as(i,t.TTMSFNCCustomToolBar).FOnUpdateDockPanel=rtl.createCallback(this,"UpdateDockPanel"),rtl.as(i,t.TTMSFNCCustomToolBar).FDragGripMoving)||i.FVisible&&(i.GetTop()<this.FAppearance.FMargins.FTop&&i.SetTop(Math.round(this.FAppearance.FMargins.FTop)),i.GetLeft()<this.FAppearance.FMargins.FLeft?i.SetLeft(Math.round(this.FAppearance.FMargins.FLeft)):i.GetLeft()+i.GetWidth()>this.GetWidth()-this.FAppearance.FMargins.FRight&&i.SetLeft(Math.round(this.GetWidth()-this.FAppearance.FMargins.FRight-i.GetWidth())))},this.RearrangeControls=function(){for(var e=null,i=null,s=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),o=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),n=0,r=0,a=0,l=this.GetControlsCount()-1;a<=l;a++)if(n=a,(e=this.GetControls(n)).FVisible&&(!t.TTMSFNCCustomToolBar.isPrototypeOf(e)||!rtl.as(e,t.TTMSFNCCustomToolBar).FDragGripMoving))for(var h=0,F=this.GetControlsCount()-1;h<=F;h++)r=h,(i=this.GetControls(r))!==e&&i.FVisible&&(s.$assign(pas["WEBLib.TMSFNCTypes"].RectF(e.GetLeft(),e.GetTop(),e.GetLeft()+e.GetWidth(),e.GetTop()+e.GetHeight())),o.$assign(pas["WEBLib.TMSFNCTypes"].RectF(i.GetLeft(),i.GetTop(),i.GetLeft()+i.GetWidth(),i.GetTop()+i.GetHeight())),o.Left>=s.Left-3&&o.Left<=s.Right+3&&(o.Top<pas["WEBLib.TMSFNCTypes"].CenterPointEx(s).Y&&o.Top>=s.Top-3?(i.SetLeft(e.GetLeft()+e.GetWidth()+3),i.SetTop(e.GetTop())):o.Top>=pas["WEBLib.TMSFNCTypes"].CenterPointEx(s).Y&&o.Top<=s.Bottom+3&&(i.SetTop(e.GetTop()+e.GetHeight()+3),i.SetLeft(e.GetLeft()))))},this.UpdateDockPanel=function(t){this.UpdateControls()},this.ApplyStyle=function(){var t=0;pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.ApplyStyle.call(this),t=-1,pas["WEBLib.TMSFNCStyles"].TTMSFNCStyles.GetStyleHeaderFillColor({get:function(){return t},set:function(e){t=e}})&&(this.FAppearance.FFill.SetKind(1),this.FAppearance.FFill.SetColor(t)),pas["WEBLib.TMSFNCStyles"].TTMSFNCStyles.GetStyleHeaderFillColorTo({get:function(){return t},set:function(e){t=e}})&&(this.FAppearance.FFill.SetKind(2),this.FAppearance.FFill.SetColorTo(t))},this.ResetToDefaultStyle=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.ResetToDefaultStyle.call(this)},this.AlignControls=function(t,e){pas["WEBLib.Controls"].TControl.AlignControls.apply(this,arguments),this.UpdateControls()},this.Assign=function(e){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Assign.apply(this,arguments),t.TTMSFNCCustomDockPanel.isPrototypeOf(e)?(this.FAppearance.Assign(rtl.as(e,t.TTMSFNCCustomDockPanel).FAppearance),this.SetAS(rtl.as(e,t.TTMSFNCCustomDockPanel).FAutoSize),this.SetAutoAlign(rtl.as(e,t.TTMSFNCCustomDockPanel).FAutoAlign),this.SetState(rtl.as(e,t.TTMSFNCCustomDockPanel).FState)):pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Assign.apply(this,arguments)},this.Create$1=function(e){return pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Create$1.apply(this,arguments),this.FState=0,this.FAppearance=t.TTMSFNCDockPanelAppearance.$create("Create$1",[this]),this.FAutoSize=!0,this.FAutoAlign=!0,this.SetAlign(1),this.SetHeight(40),this},this.Destroy=function(){rtl.free(this,"FAppearance"),pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Destroy.call(this)},this.Draw=function(t,e){var i=pas["WEBLib.TMSFNCTypes"].TRectF.$new();pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Draw.apply(this,arguments),t.FFill.Assign(this.FAppearance.FFill),t.FStroke.Assign(this.FAppearance.FStroke),i.$assign(this.GetLocalRect()),t.DrawRectangle$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),2)},rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas["WEBLib.TMSFNCTypes"].ITMSFNCProductInfo),rtl.addIntf(this,pas.System.IUnknown)})),t.$init=function(){pas.Classes.RegisterClass(t.TTMSFNCToolBarButton),pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.CreateFromResource(t.TMSFNCTOOLBAREXPANDSVG)}}),["Math","SysUtils","WEBLib.TMSFNCUtils","WEBLib.Graphics","StrUtils"]),rtl.module("WEBLib.TMSFNCHTMLText",["System","Classes","WEBLib.TMSFNCCustomControl","WEBLib.TMSFNCBitmapContainer","WEBLib.TMSFNCGraphics","WEBLib.TMSFNCGraphicsTypes","WEBLib.TMSFNCTypes","WEBLib.Controls"],(function(){"use strict";var t=this;this.MAJ_VER=1,this.MIN_VER=1,this.REL_VER=0,this.BLD_VER=5,this.$rtti.$MethodVar("TTMSFNCHTMLTextAnchorClickEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AAnchor",rtl.string]]),methodkind:0}),rtl.createClass(this,"TTMSFNCHTMLText",pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl,(function(){this.$init=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.$init.call(this),this.FDisableAdjustSize=!1,this.FBitmapContainer=null,this.FOnAnchorClick=null,this.FURLColor=0,this.FShadowOffset=0,this.FShadowColor=0,this.FDisplayHTML=!1,this.FURLUnderline=!1,this.FText="",this.FFont$1=null,this.FWordWrapping=!1,this.FAutoSize=!1,this.FVerticalTextAlign=0,this.FHorizontalTextAlign=0,this.FAutoOpenURL=!1,this.FAutoSizeSpacing=0,this.FAutoHeight=!1,this.FAutoWidth=!1,this.FTrimming=0},this.$final=function(){this.FBitmapContainer=void 0,this.FOnAnchorClick=void 0,this.FFont$1=void 0,pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.$final.call(this)},this.SetShadowOffset=function(t){this.FShadowOffset!==t&&(this.FShadowOffset=t,this.Invalidate())},this.SetURLColor=function(t){this.FURLColor!==t&&(this.FURLColor=t,this.Invalidate())},this.SetShadowColor=function(t){this.FShadowColor!==t&&(this.FShadowColor=t,this.Invalidate())},this.SetBitmapContainer=function(t){this.FBitmapContainer=t,this.ApplyAutoSize()},this.SetText=function(t){this.FText!==t&&(this.FText=t,this.ApplyAutoSize(),this.Invalidate())},this.SetDisplayHTML=function(t){this.FDisplayHTML!==t&&(this.FDisplayHTML=t,this.ApplyAutoSize(),this.Invalidate())},this.SetURLUnderline=function(t){this.FURLUnderline!==t&&(this.FURLUnderline=t,this.Invalidate())},this.SetFnt=function(t){this.FFont$1.AssignSource(t)},this.SetWordWrapping=function(t){this.FWordWrapping!==t&&(this.FWordWrapping=t,this.ApplyAutoSize(),this.Invalidate())},this.SetAS=function(t){this.FAutoSize!==t&&(this.FAutoSize=t,this.ApplyAutoSize(),this.Invalidate())},this.SetHorizontalTextAlign=function(t){this.FHorizontalTextAlign!==t&&(this.FHorizontalTextAlign=t,this.ApplyAutoSize(),this.Invalidate())},this.SetVerticalTextAlign=function(t){this.FVerticalTextAlign!==t&&(this.FVerticalTextAlign=t,this.ApplyAutoSize(),this.Invalidate())},this.SetAutoSizeSpacing=function(t){this.FAutoSizeSpacing!==t&&(this.FAutoSizeSpacing=t,this.ApplyAutoSize(),this.Invalidate())},this.GetBitmapContainer=function(){return this.FBitmapContainer},this.SetAutoHeight=function(t){this.FAutoHeight!==t&&(this.FAutoHeight=t,this.ApplyAutoSize(),this.Invalidate())},this.SetAutoWidth=function(t){this.FAutoWidth!==t&&(this.FAutoWidth=t,this.ApplyAutoSize(),this.Invalidate())},this.SetTrimming=function(t){this.FTrimming!==t&&(this.FTrimming=t,this.Invalidate())},this.GetVersion=function(){return this.$class.GetVersionNumber(1,1,0,5)},this.CanDrawDesignTime=function(){return!0,!0},this.RegisterRuntimeClasses=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.RegisterRuntimeClasses.call(this),pas.Classes.RegisterClass(t.TTMSFNCHTMLText)},this.ApplyStyle=function(){var t=0;pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.ApplyStyle.call(this),t=-1,pas["WEBLib.TMSFNCStyles"].TTMSFNCStyles.GetStyleBackgroundFillColor({get:function(){return t},set:function(e){t=e}})&&this.FFill.SetColor(t),t=-1,pas["WEBLib.TMSFNCStyles"].TTMSFNCStyles.GetStyleBackgroundStrokeColor({get:function(){return t},set:function(e){t=e}})&&this.FStroke.SetColor(t),t=-1,pas["WEBLib.TMSFNCStyles"].TTMSFNCStyles.GetStyleTextFontColor({get:function(){return t},set:function(e){t=e}})&&this.FFont$1.SetColor(t)},this.ResetToDefaultStyle=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.ResetToDefaultStyle.call(this),this.FFill.SetColor(16777215),this.FStroke.SetColor(12632256),this.FFont$1.SetColor(0)},this.ApplyAutoSize=function(){var t=pas["WEBLib.TMSFNCTypes"].TRectF.$new();if(!this.FDisableAdjustSize&&!(0 in this.FComponentState)){this.FDisableAdjustSize=!0;try{this.FAutoSize&&""!==this.FText&&(t.$assign(this.GetTextRect()),this.FAutoHeight&&this.FAutoWidth?this.SetBounds(this.GetLeft(),this.GetTop(),Math.round(t.Right-t.Left+2*t.Left+this.FFont$1.FSize/3),Math.round(t.Bottom-t.Top+2*t.Top)):this.FAutoWidth?this.SetBounds(this.GetLeft(),this.GetTop(),Math.round(t.Right-t.Left+2*t.Left+this.FFont$1.FSize/3),this.GetHeight()):this.FAutoHeight&&this.SetBounds(this.GetLeft(),this.GetTop(),this.GetWidth(),Math.round(t.Bottom-t.Top+2*t.Top)))}finally{this.FDisableAdjustSize=!1}}},this.DoFontChanged=function(t){this.Invalidate()},this.Notification=function(t,e){pas["WEBLib.Menus"].TWebCustomControl.Notification.apply(this,arguments),1===e&&t===this.FBitmapContainer&&(this.FBitmapContainer=null)},this.HandleMouseDown=function(t,e,i,s){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleMouseDown.apply(this,arguments),this.DoMouseDown(t,rtl.refSet(e),i,s)},this.HandleMouseMove=function(t,e,i){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleMouseMove.apply(this,arguments),this.DoMouseMove(rtl.refSet(t),e,i)},this.DoAnchorClick=function(t){null!=this.FOnAnchorClick?this.FOnAnchorClick(this,t):this.FAutoOpenURL&&pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.OpenURL(t)},this.DrawHTMLText=function(t){var e=pas["WEBLib.TMSFNCTypes"].TRectF.$new();t.FFont.AssignSource(this.FFont$1),this.FEnabled||t.FFont.SetColor(10789024),t.FURLColor=this.FURLColor,t.FURLUnderline=this.FURLUnderline,this.FAutoSize?this.FAutoWidth&&this.FAutoHeight?e.$assign(pas["WEBLib.TMSFNCTypes"].RectF(this.FAutoSizeSpacing,this.FAutoSizeSpacing,this.GetWidth()-this.FAutoSizeSpacing,this.GetHeight()-this.FAutoSizeSpacing)):this.FAutoWidth?e.$assign(pas["WEBLib.TMSFNCTypes"].RectF(this.FAutoSizeSpacing,0,this.GetWidth()-this.FAutoSizeSpacing,this.GetHeight())):this.FAutoHeight&&e.$assign(pas["WEBLib.TMSFNCTypes"].RectF(0,this.FAutoSizeSpacing,this.GetWidth(),this.GetHeight()-this.FAutoSizeSpacing)):e.$assign(this.GetLocalRect()),t.DrawText$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),this.FText,this.FWordWrapping,this.FHorizontalTextAlign,this.FVerticalTextAlign,this.FTrimming,0,-1,-1,this.FDisplayHTML,!1,-1,-1)},this.SetEnabled=function(t){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.SetEnabled.apply(this,arguments),this.Invalidate()},this.Create$1=function(t){return pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Create$1.apply(this,arguments),this.FURLColor=16711680,this.FTrimming=0,this.FURLUnderline=!0,this.FDisplayHTML=!0,this.FShadowOffset=1,this.FAutoOpenURL=!0,this.FShadowColor=8421504,this.FWordWrapping=!1,this.FAutoSize=!1,this.FAutoHeight=!0,this.FAutoWidth=!0,this.FHorizontalTextAlign=0,this.FVerticalTextAlign=0,this.FFont$1=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFont.$create("Create$2"),this.FFont$1.FOnChanged=rtl.createCallback(this,"DoFontChanged"),this.FAutoSizeSpacing=0,this.FStroke.SetColor(-1),this.IsDesignTime()&&(this.SetText("TTMSFNCHTMLText"),this.DisableBackground()),this.SetWidth(100),this.SetHeight(50),this},this.Destroy=function(){rtl.free(this,"FFont$1"),pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Destroy.call(this)},this.GetTextRect=function(){var t=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),e=null,i=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),s=0,o=0;(e=pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.$create("CreateBitmapCanvas",[1,1,!1,!0])).BeginScene(),e.FOptimizedHTMLDrawing=this.FOptimizedHTMLDrawing,e.FBitmapContainer=this.GetBitmapContainer(),e.FFont.AssignSource(this.FFont$1);try{e.FFont.AssignSource(this.FFont$1),this.FWordWrapping?i.$assign(pas["WEBLib.TMSFNCTypes"].RectF(0,0,this.GetWidth(),1e4)):i.$assign(pas["WEBLib.TMSFNCTypes"].RectF(0,0,1e4,1e4)),t.$assign(e.CalculateText(this.FText,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),this.FWordWrapping,this.FDisplayHTML)),s=t.Right-t.Left,o=t.Bottom-t.Top,t.Right=t.Left+s+2*this.FAutoSizeSpacing,t.Bottom=t.Top+o+2*this.FAutoSizeSpacing}finally{e.EndScene(),e=rtl.freeLoc(e)}return t},this.Assign=function(e){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Assign.apply(this,arguments),t.TTMSFNCHTMLText.isPrototypeOf(e)&&(this.FTrimming=rtl.as(e,t.TTMSFNCHTMLText).FTrimming,this.FAutoSize=rtl.as(e,t.TTMSFNCHTMLText).FAutoSize,this.FAutoWidth=rtl.as(e,t.TTMSFNCHTMLText).FAutoWidth,this.FAutoHeight=rtl.as(e,t.TTMSFNCHTMLText).FAutoHeight,this.FAutoSizeSpacing=rtl.as(e,t.TTMSFNCHTMLText).FAutoSizeSpacing,this.FAutoOpenURL=rtl.as(e,t.TTMSFNCHTMLText).FAutoOpenURL,this.FDisplayHTML=rtl.as(e,t.TTMSFNCHTMLText).FDisplayHTML,this.FFont$1.AssignSource(rtl.as(e,t.TTMSFNCHTMLText).FFont$1),this.FHorizontalTextAlign=rtl.as(e,t.TTMSFNCHTMLText).FHorizontalTextAlign,this.FShadowColor=rtl.as(e,t.TTMSFNCHTMLText).FShadowColor,this.FShadowOffset=rtl.as(e,t.TTMSFNCHTMLText).FShadowOffset,this.FText=rtl.as(e,t.TTMSFNCHTMLText).FText,this.FURLColor=rtl.as(e,t.TTMSFNCHTMLText).FURLColor,this.FURLUnderline=rtl.as(e,t.TTMSFNCHTMLText).FURLUnderline,this.FVerticalTextAlign=rtl.as(e,t.TTMSFNCHTMLText).FVerticalTextAlign,this.FWordWrapping=rtl.as(e,t.TTMSFNCHTMLText).FWordWrapping)},this.DoMouseMove=function(t,e,i){var s=null,o=pas["WEBLib.TMSFNCTypes"].TRectF.$new();if(this.IsHTML()){(s=pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.$create("CreateBitmapCanvas",[1,1,!1,!0])).BeginScene(),s.FOptimizedHTMLDrawing=this.FOptimizedHTMLDrawing,s.FBitmapContainer=this.GetBitmapContainer(),s.FFont.AssignSource(this.FFont$1);try{this.FAutoSize?this.FAutoWidth&&this.FAutoHeight?o.$assign(pas["WEBLib.TMSFNCTypes"].RectF(this.FAutoSizeSpacing,this.FAutoSizeSpacing,this.GetWidth()-this.FAutoSizeSpacing,this.GetHeight()-this.FAutoSizeSpacing)):this.FAutoWidth?o.$assign(pas["WEBLib.TMSFNCTypes"].RectF(this.FAutoSizeSpacing,0,this.GetWidth()-this.FAutoSizeSpacing,this.GetHeight())):this.FAutoHeight&&o.$assign(pas["WEBLib.TMSFNCTypes"].RectF(0,this.FAutoSizeSpacing,this.GetWidth(),this.GetHeight()-this.FAutoSizeSpacing)):o.$assign(this.GetLocalRect()),""!==s.DrawText$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(o),this.FText,this.FWordWrapping,this.FHorizontalTextAlign,this.FVerticalTextAlign,this.FTrimming,0,-1,-1,!0,!0,e,i)?this.SetControlCursor(21):this.SetControlCursor(0)}finally{s.EndScene(),s=rtl.freeLoc(s)}}},this.DoMouseDown=function(t,e,i,s){var o="",n=null,r=pas["WEBLib.TMSFNCTypes"].TRectF.$new();if(this.IsHTML()){(n=pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.$create("CreateBitmapCanvas",[1,1,!1,!0])).BeginScene(),n.FOptimizedHTMLDrawing=this.FOptimizedHTMLDrawing,n.FBitmapContainer=this.GetBitmapContainer(),n.FFont.AssignSource(this.FFont$1);try{this.FAutoSize?this.FAutoWidth&&this.FAutoHeight?r.$assign(pas["WEBLib.TMSFNCTypes"].RectF(this.FAutoSizeSpacing,this.FAutoSizeSpacing,this.GetWidth()-this.FAutoSizeSpacing,this.GetHeight()-this.FAutoSizeSpacing)):this.FAutoWidth?r.$assign(pas["WEBLib.TMSFNCTypes"].RectF(this.FAutoSizeSpacing,0,this.GetWidth()-this.FAutoSizeSpacing,this.GetHeight())):this.FAutoHeight&&r.$assign(pas["WEBLib.TMSFNCTypes"].RectF(0,this.FAutoSizeSpacing,this.GetWidth(),this.GetHeight()-this.FAutoSizeSpacing)):r.$assign(this.GetLocalRect()),""!==(o=n.DrawText$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(r),this.FText,this.FWordWrapping,this.FHorizontalTextAlign,this.FVerticalTextAlign,this.FTrimming,0,-1,-1,!0,!0,i,s))&&this.DoAnchorClick(o)}finally{n.EndScene(),n=rtl.freeLoc(n)}}},this.UpdateControlAfterResize=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.UpdateControlAfterResize.call(this),this.ApplyAutoSize()},this.IsHTML=function(){return!!this.FDisplayHTML&&(pas.System.Pos("</",this.FText)>0||pas.System.Pos("/>",this.FText)>0||pas.System.Pos("<BR>",pas.SysUtils.UpperCase(this.FText))>0)},this.Draw=function(t,e){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Draw.apply(this,arguments),t.FBitmapContainer=this.GetBitmapContainer(),this.DrawHTMLText(t),this.IsDesignTime()&&this.CanDrawDesignTime()&&t.DrawFocusRectangle$3(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),0,2)},rtl.addIntf(this,pas["WEBLib.TMSFNCBitmapContainer"].ITMSFNCBitmapContainer),rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas["WEBLib.TMSFNCTypes"].ITMSFNCProductInfo),rtl.addIntf(this,pas.System.IUnknown);var e=this.$rtti;e.addProperty("AutoSize",2,rtl.boolean,"FAutoSize","SetAS"),e.addProperty("AutoHeight",2,rtl.boolean,"FAutoHeight","SetAutoHeight"),e.addProperty("AutoWidth",2,rtl.boolean,"FAutoWidth","SetAutoWidth"),e.addProperty("AutoSizeSpacing",2,rtl.double,"FAutoSizeSpacing","SetAutoSizeSpacing"),e.addProperty("AutoOpenURL",0,rtl.boolean,"FAutoOpenURL","FAutoOpenURL"),e.addProperty("BitmapContainer",3,pas["WEBLib.TMSFNCBitmapContainer"].$rtti.TTMSFNCBitmapContainer,"GetBitmapContainer","SetBitmapContainer"),e.addProperty("DisplayHTML",2,rtl.boolean,"FDisplayHTML","SetDisplayHTML"),e.addProperty("Font",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFont,"FFont$1","SetFnt"),e.addProperty("HorizontalTextAlign",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsTextAlign,"FHorizontalTextAlign","SetHorizontalTextAlign"),e.addProperty("Trimming",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsTextTrimming,"FTrimming","SetTrimming"),e.addProperty("ShadowColor",2,pas["WEBLib.Graphics"].$rtti.TColor,"FShadowColor","SetShadowColor"),e.addProperty("ShadowOffset",2,rtl.longint,"FShadowOffset","SetShadowOffset"),e.addProperty("Fill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FFill","SetFill"),e.addProperty("Stroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FStroke","SetStroke"),e.addProperty("Text",2,rtl.string,"FText","SetText"),e.addProperty("URLColor",2,pas["WEBLib.Graphics"].$rtti.TColor,"FURLColor","SetURLColor"),e.addProperty("URLUnderline",2,rtl.boolean,"FURLUnderline","SetURLUnderline"),e.addProperty("VerticalTextAlign",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsTextAlign,"FVerticalTextAlign","SetVerticalTextAlign"),e.addProperty("Version",1,rtl.string,"GetVersion",""),e.addProperty("WordWrapping",2,rtl.boolean,"FWordWrapping","SetWordWrapping"),e.addProperty("OnAnchorClick",0,t.$rtti.TTMSFNCHTMLTextAnchorClickEvent,"FOnAnchorClick","FOnAnchorClick"),e.attr=[pas.Classes.ComponentPlatformsAttribute,"Create$1",[0]]}))}),["SysUtils","WEBLib.TMSFNCUtils","WEBLib.TMSFNCStyles","WEBLib.Graphics"]),rtl.module("WEBLib.TMSFNCStatusBar",["System","Classes","SysUtils","Types","WEBLib.Controls","WEBLib.ExtCtrls","WEBLib.TMSFNCCustomControl","WEBLib.TMSFNCTypes","WEBLib.TMSFNCGraphics","WEBLib.TMSFNCGraphicsTypes","WEBLib.TMSFNCBitmapContainer","WEBLib.TMSFNCUtils","WEBLib.TMSFNCStyles"],(function(){"use strict";var t=this;this.MAJ_VER=1,this.MIN_VER=1,this.REL_VER=1,this.BLD_VER=0,this.TTMSFNCStatusBarPanelStyle={0:"spsHTML",spsHTML:0,1:"spsText",spsText:1,2:"spsOwnerDraw",spsOwnerDraw:2,3:"spsTime",spsTime:3,4:"spsDate",spsDate:4,5:"spsProgress",spsProgress:5,6:"spsImage",spsImage:6,7:"spsImageList",spsImageList:7,8:"spsEllipsText",spsEllipsText:8},this.$rtti.$Enum("TTMSFNCStatusBarPanelStyle",{minvalue:0,maxvalue:8,ordtype:1,enumtype:this.TTMSFNCStatusBarPanelStyle}),this.TTMSFNCStatusBarVerticalPanelAlignment={0:"spaTop",spaTop:0,1:"spaCenter",spaCenter:1,2:"spaBottom",spaBottom:2},this.$rtti.$Enum("TTMSFNCStatusBarVerticalPanelAlignment",{minvalue:0,maxvalue:2,ordtype:1,enumtype:this.TTMSFNCStatusBarVerticalPanelAlignment}),this.TTMSFNCStatusBarPanelProgressIndication={0:"ppiPercentage",ppiPercentage:0,1:"ppiAbsolute",ppiAbsolute:1},this.$rtti.$Enum("TTMSFNCStatusBarPanelProgressIndication",{minvalue:0,maxvalue:1,ordtype:1,enumtype:this.TTMSFNCStatusBarPanelProgressIndication}),rtl.recNewT(this,"TTMSFNCStatusBarPanelAnchor",(function(){this.AAnchor="",this.AIndex=0,this.$eq=function(t){return this.AAnchor===t.AAnchor&&this.AIndex===t.AIndex},this.$assign=function(t){return this.AAnchor=t.AAnchor,this.AIndex=t.AIndex,this}})),rtl.createClass(this,"TTMSFNCStatusBarAppearance",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FFont=null,this.FFill=null,this.FOnChange=null,this.FStroke=null},this.$final=function(){this.FFont=void 0,this.FFill=void 0,this.FOnChange=void 0,this.FStroke=void 0,pas.Classes.TPersistent.$final.call(this)},this.SetFill=function(t){this.FFill.Assign(t)},this.SetFont=function(t){this.FFont.AssignSource(t)},this.SetStroke=function(t){this.FStroke.Assign(t)},this.Changed=function(){null!=this.FOnChange&&this.FOnChange(this)},this.FillChanged=function(t){this.Changed()},this.FontChanged=function(t){this.Changed()},this.StrokeChanged=function(t){this.Changed()},this.Create$1=function(){return this.FFont=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFont.$create("Create$2"),this.FFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[1,16777215,8421504,-1,-1]),this.FStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,12632256]),this.FFont.FOnChanged=rtl.createCallback(this,"FontChanged"),this.FFill.FOnChanged=rtl.createCallback(this,"FillChanged"),this.FStroke.FOnChanged=rtl.createCallback(this,"StrokeChanged"),this},this.Destroy=function(){rtl.free(this,"FFont"),rtl.free(this,"FFill"),rtl.free(this,"FStroke"),pas.System.TObject.Destroy.call(this)},this.Assign=function(e){t.TTMSFNCStatusBarAppearance.isPrototypeOf(e)?(this.FFill.Assign(rtl.as(e,t.TTMSFNCStatusBarAppearance).FFill),this.FStroke.Assign(rtl.as(e,t.TTMSFNCStatusBarAppearance).FStroke),this.FFont.AssignSource(rtl.as(e,t.TTMSFNCStatusBarAppearance).FFont)):pas.Classes.TPersistent.Assign.apply(this,arguments)};var e=this.$rtti;e.addProperty("Font",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFont,"FFont","SetFont"),e.addProperty("Fill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FFill","SetFill"),e.addProperty("Stroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FStroke","SetStroke")})),rtl.createClass(this,"TTMSFNCStatusBarProgressAppearance",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FMax=0,this.FLevel1Perc=0,this.FShowIndication=!1,this.FBackgroundFill=null,this.FMin=0,this.FIndication=0,this.FLevel2Fill=null,this.FLevel3Fill=null,this.FLevel0Fill=null,this.FLevel1Fill=null,this.FBorderStroke=null,this.FOnChange=null,this.FPosition=0,this.FLevel2Perc=0},this.$final=function(){this.FBackgroundFill=void 0,this.FLevel2Fill=void 0,this.FLevel3Fill=void 0,this.FLevel0Fill=void 0,this.FLevel1Fill=void 0,this.FBorderStroke=void 0,this.FOnChange=void 0,pas.Classes.TPersistent.$final.call(this)},this.SetBackgroundFill=function(t){this.FBackgroundFill.Assign(t)},this.SetBorderStroke=function(t){this.FBorderStroke.Assign(t)},this.SetIndication=function(t){this.FIndication!==t&&(this.FIndication=t,this.Changed())},this.SetLevel0Fill=function(t){this.FLevel0Fill.Assign(t)},this.SetLevel1Fill=function(t){this.FLevel1Fill.Assign(t)},this.SetLevel1Perc=function(t){this.FLevel1Perc!==t&&(this.FLevel1Perc=t,this.Changed())},this.SetLevel2Fill=function(t){this.FLevel2Fill.Assign(t)},this.SetLevel2Perc=function(t){this.FLevel2Perc!==t&&(this.FLevel2Perc=t,this.Changed())},this.SetLevel3Fill=function(t){this.FLevel3Fill.Assign(t)},this.SetMax=function(t){this.FMax!==t&&(this.FMax=t,this.Changed())},this.SetMin=function(t){this.FMin!==t&&(this.FMin=t,this.Changed())},this.SetPosition=function(t){this.FPosition!==t&&(this.FPosition=t,this.Changed())},this.SetShowIndication=function(t){this.FShowIndication!==t&&(this.FShowIndication=t,this.Changed())},this.Changed=function(){null!=this.FOnChange&&this.FOnChange(this)},this.FillChanged=function(t){this.Changed()},this.StrokeChanged=function(t){this.Changed()},this.Create$1=function(){return this.FLevel0Fill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[1,16777215,8421504,-1,-1]),this.FLevel1Fill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[1,16777215,8421504,-1,-1]),this.FLevel2Fill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[1,16777215,8421504,-1,-1]),this.FLevel3Fill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[1,16777215,8421504,-1,-1]),this.FBackgroundFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[1,16777215,8421504,-1,-1]),this.FBorderStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,12632256]),this.FIndication=0,this.FMin=0,this.FMax=100,this.FPosition=0,this.FLevel1Perc=70,this.FLevel2Perc=90,this.FShowIndication=!0,this.FLevel0Fill.FOnChanged=rtl.createCallback(this,"FillChanged"),this.FLevel1Fill.FOnChanged=rtl.createCallback(this,"FillChanged"),this.FLevel2Fill.FOnChanged=rtl.createCallback(this,"FillChanged"),this.FLevel3Fill.FOnChanged=rtl.createCallback(this,"FillChanged"),this.FBackgroundFill.FOnChanged=rtl.createCallback(this,"FillChanged"),this.FBorderStroke.FOnChanged=rtl.createCallback(this,"StrokeChanged"),this.FBackgroundFill.SetColor(16777215),this.FBorderStroke.SetColor(12632256),this.FLevel0Fill.SetColor(65280),this.FLevel1Fill.SetColor(65535),this.FLevel2Fill.SetColor(42495),this.FLevel3Fill.SetColor(255),this},this.Destroy=function(){rtl.free(this,"FLevel0Fill"),rtl.free(this,"FLevel1Fill"),rtl.free(this,"FLevel2Fill"),rtl.free(this,"FLevel3Fill"),rtl.free(this,"FBackgroundFill"),rtl.free(this,"FBorderStroke"),pas.System.TObject.Destroy.call(this)},this.Assign=function(e){t.TTMSFNCStatusBarProgressAppearance.isPrototypeOf(e)?(this.FLevel0Fill.Assign(rtl.as(e,t.TTMSFNCStatusBarProgressAppearance).FLevel0Fill),this.FLevel1Fill.Assign(rtl.as(e,t.TTMSFNCStatusBarProgressAppearance).FLevel1Fill),this.FLevel2Fill.Assign(rtl.as(e,t.TTMSFNCStatusBarProgressAppearance).FLevel2Fill),this.FLevel3Fill.Assign(rtl.as(e,t.TTMSFNCStatusBarProgressAppearance).FLevel3Fill),this.FBackgroundFill.Assign(rtl.as(e,t.TTMSFNCStatusBarProgressAppearance).FBackgroundFill),this.FBorderStroke.Assign(rtl.as(e,t.TTMSFNCStatusBarProgressAppearance).FBorderStroke),this.FLevel1Perc=rtl.as(e,t.TTMSFNCStatusBarProgressAppearance).FLevel1Perc,this.FLevel2Perc=rtl.as(e,t.TTMSFNCStatusBarProgressAppearance).FLevel2Perc,this.FIndication=rtl.as(e,t.TTMSFNCStatusBarProgressAppearance).FIndication,this.FMin=rtl.as(e,t.TTMSFNCStatusBarProgressAppearance).FMin,this.FMax=rtl.as(e,t.TTMSFNCStatusBarProgressAppearance).FMax,this.FPosition=rtl.as(e,t.TTMSFNCStatusBarProgressAppearance).FPosition,this.FShowIndication=rtl.as(e,t.TTMSFNCStatusBarProgressAppearance).FShowIndication):pas.Classes.TPersistent.Assign.apply(this,arguments)};var e=this.$rtti;e.addProperty("BackgroundFill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FBackgroundFill","SetBackgroundFill"),e.addProperty("BorderStroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FBorderStroke","SetBorderStroke"),e.addProperty("Indication",2,t.$rtti.TTMSFNCStatusBarPanelProgressIndication,"FIndication","SetIndication",{Default:t.TTMSFNCStatusBarPanelProgressIndication.ppiPercentage}),e.addProperty("Level0Fill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FLevel0Fill","SetLevel0Fill"),e.addProperty("Level1Fill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FLevel1Fill","SetLevel1Fill"),e.addProperty("Level2Fill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FLevel2Fill","SetLevel2Fill"),e.addProperty("Level3Fill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FLevel3Fill","SetLevel3Fill"),e.addProperty("Level1Perc",2,rtl.longint,"FLevel1Perc","SetLevel1Perc",{Default:70}),e.addProperty("Level2Perc",2,rtl.longint,"FLevel2Perc","SetLevel2Perc",{Default:90}),e.addProperty("Max",2,rtl.longint,"FMax","SetMax",{Default:100}),e.addProperty("Min",2,rtl.longint,"FMin","SetMin",{Default:0}),e.addProperty("Position",2,rtl.longint,"FPosition","SetPosition"),e.addProperty("ShowIndication",2,rtl.boolean,"FShowIndication","SetShowIndication",{Default:!0})})),rtl.createClass(this,"TTMSFNCStatusBarPanel",pas.Classes.TCollectionItem,(function(){this.$init=function(){pas.Classes.TCollectionItem.$init.call(this),this.FEnabled=!1,this.FButton=!1,this.FTimeFormat="",this.FWidth=0,this.FAlignment=0,this.FMinWidth=0,this.FDateFormat="",this.FVerticalAlign=0,this.FText="",this.FStyle=0,this.FImageIndex=0,this.FImageCount=0,this.FAutoSize=!1,this.FHint="",this.FProgress=null,this.FOffset=null,this.FVisible=!1,this.FControl=null,this.FControlAlign=0,this.FControlParent=null,this.FControlVisible=!1,this.FControlPrevAlign=0,this.FControlLeft=0,this.FControlTop=0,this.FControlWidth=0,this.FControlHeight=0,this.FURLColor=0},this.$final=function(){this.FProgress=void 0,this.FOffset=void 0,this.FControl=void 0,this.FControlParent=void 0,pas.Classes.TCollectionItem.$final.call(this)},this.SetAlignment=function(t){this.FAlignment!==t&&(this.FAlignment=t,this.Update())},this.SetButton=function(t){this.FButton!==t&&(this.FButton=t,this.Update())},this.SetDateFormat=function(t){this.FDateFormat!==t&&(this.FDateFormat=t,this.Update())},this.SetEnabled=function(t){this.FEnabled!==t&&(this.FEnabled=t,this.Update())},this.SetMinWidth=function(t){this.FMinWidth!==t&&(this.FMinWidth=t,this.Update())},this.SetStyle=function(t){this.FStyle!==t&&(this.FStyle=t,3===this.FStyle?this.FText=pas.SysUtils.FormatDateTime(this.FTimeFormat,pas.SysUtils.Now()):4===this.FStyle&&(this.FText=pas.SysUtils.FormatDateTime(this.FDateFormat,pas.SysUtils.Now())),this.Update())},this.SetText=function(t){this.FText!==t&&(this.FText=t,this.FAutoSize&&null!=this.FCollection&&this.FCollection.FOwner.AutoSizePanels(),this.Update())},this.SetTimeFormat=function(t){this.FTimeFormat!==t&&(this.FTimeFormat=t,this.Update())},this.SetVerticalAlign=function(t){this.FVerticalAlign!==t&&(this.FVerticalAlign=t,this.Update())},this.SetWidth=function(t){this.FWidth!==t&&(this.FWidth=t,this.Update())},this.SetImageIndex=function(t){this.FImageIndex!==t&&(this.FImageIndex=t,this.Update())},this.SetImageCount=function(t){this.FImageCount!==t&&(this.FImageCount=t,this.Update())},this.SetAutoSize=function(t){this.FAutoSize!==t&&(this.FAutoSize=t,this.FAutoSize&&null!=this.FCollection&&this.FCollection.FOwner.AutoSizePanels(),this.Update())},this.SetHint=function(t){this.FHint!==t&&(this.FHint=t)},this.SetProgress=function(t){this.FProgress.Assign(t)},this.SetOffset=function(t){this.FOffset!==t&&(this.FOffset=t,this.Update())},this.IsDateFormatStored=function(){return"dd/MM/yyyy"!==this.FDateFormat},this.IsTextStored=function(){return""!==this.FText},this.IsTimeFormatStored=function(){return"hh:mm:ss"!==this.FTimeFormat},this.IsHintStored=function(){return""!==this.FHint},this.SetVisible=function(t){this.FVisible!==t&&(this.FVisible=t,this.Update())},this.SetControl=function(e){var i=0,s=null;if(this.FControl!==e){if(null==(s=rtl.as(this.FCollection,t.TTMSFNCStatusBarPanels).FOwner)||0 in s.FComponentState||null==this.FControl||(this.FControl.SetParent(this.FControlParent),this.FControl.SetVisible(this.FControlVisible),this.FControl.SetAlign(this.FControlPrevAlign),this.FControl.SetLeft(Math.round(this.FControlLeft)),this.FControl.SetTop(Math.round(this.FControlTop)),this.FControl.SetWidth(Math.round(this.FControlWidth)),this.FControl.SetHeight(Math.round(this.FControlHeight))),null!=s)for(var o=0,n=s.FPanels.GetCount()-1;o<=n;o++)i=o,s.FPanels.GetItem$1(i).FControl===e&&(s.FPanels.GetItem$1(i).FControl=null);this.FControl=e,null!=this.FControl&&(this.FControlParent=this.FControl.FParent,this.FControlVisible=this.FControl.FVisible,this.FControlPrevAlign=this.FControl.FAlign,this.FControl.SetAlign(0),this.FControlLeft=this.FControl.GetLeft(),this.FControlTop=this.FControl.GetTop(),this.FControlWidth=this.FControl.GetWidth(),this.FControlHeight=this.FControl.GetHeight(),null!=s&&this.FControl.FParent!==s&&this.FControl.SetParent(s)),null!=this.FControl&&this.UpdateControlBounds()}},this.SetControlAlign=function(t){this.FControlAlign!==t&&(this.FControlAlign=t,null!=this.FControl&&this.UpdateControlBounds())},this.SetURLColor=function(t){this.FURLColor!==t&&(this.FURLColor=t,this.Update())},this.Update=function(){this.FCollection.Update(this)},this.OffsetChanged=function(t){this.Update()},this.ProgressChanged=function(t){this.Update()},this.UpdateControlBounds=function(){var e=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),i=null;if(null!=this.FControl&&null!=this.FCollection&&t.TTMSFNCStatusBarPanels.isPrototypeOf(this.FCollection)&&null!=rtl.as(this.FCollection,t.TTMSFNCStatusBarPanels).FOwner){i=rtl.as(this.FCollection,t.TTMSFNCStatusBarPanels).FOwner,e.$assign(i.GetPanelRect(this.GetIndex()));var s=this.FControlAlign;0===s?(e.Left=e.Left+this.FControl.GetLeft(),e.Right=e.Left+this.FControl.GetWidth(),e.Top=e.Top+this.FControl.GetTop(),e.Bottom=e.Top+this.FControl.GetHeight()):1===s?e.Bottom=e.Top+this.FControl.GetHeight():2===s?e.Top=e.Bottom-this.FControl.GetHeight():3===s?e.Right=e.Left+this.FControl.GetWidth():4===s&&(e.Left=e.Right-this.FControl.GetWidth()),pas["WEBLib.TMSFNCTypes"].EqualRectEx(pas["WEBLib.TMSFNCTypes"].ConvertToRectF(this.FControl.GetBoundsRect()),e)||(this.FControl.SetBounds(Math.round(e.Left),Math.round(e.Top),Math.round(e.Right-e.Left),Math.round(e.Bottom-e.Top)),i.Invalidate())}},this.Create$1=function(e){return pas.Classes.TCollectionItem.Create$1.apply(this,arguments),this.FText="",this.FStyle=0,this.FMinWidth=20,this.FWidth=50,this.FEnabled=!0,this.FDateFormat="dd/MM/yyyy",this.FTimeFormat="hh:mm:ss",this.FAlignment=0,this.FVerticalAlign=1,this.FButton=!1,this.FImageIndex=-1,this.FImageCount=1,this.FAutoSize=!1,this.FProgress=t.TTMSFNCStatusBarProgressAppearance.$create("Create$1"),this.FProgress.FOnChange=rtl.createCallback(this,"ProgressChanged"),this.FOffset=pas["WEBLib.TMSFNCTypes"].TTMSFNCPoint.$create("Create$1"),this.FOffset.FOnChange=rtl.createCallback(this,"OffsetChanged"),this.FVisible=!0,this.FControlAlign=5,this.FURLColor=16711680,this},this.Destroy=function(){rtl.free(this,"FProgress"),rtl.free(this,"FOffset"),pas.Classes.TCollectionItem.Destroy.call(this)},this.Assign=function(e){t.TTMSFNCStatusBarPanel.isPrototypeOf(e)?(this.FText=rtl.as(e,t.TTMSFNCStatusBarPanel).FText,this.FStyle=rtl.as(e,t.TTMSFNCStatusBarPanel).FStyle,this.FMinWidth=rtl.as(e,t.TTMSFNCStatusBarPanel).FMinWidth,this.FWidth=rtl.as(e,t.TTMSFNCStatusBarPanel).FWidth,this.FEnabled=rtl.as(e,t.TTMSFNCStatusBarPanel).FEnabled,this.FDateFormat=rtl.as(e,t.TTMSFNCStatusBarPanel).FDateFormat,this.FTimeFormat=rtl.as(e,t.TTMSFNCStatusBarPanel).FTimeFormat,this.FAlignment=rtl.as(e,t.TTMSFNCStatusBarPanel).FAlignment,this.FVerticalAlign=rtl.as(e,t.TTMSFNCStatusBarPanel).FVerticalAlign,this.FButton=rtl.as(e,t.TTMSFNCStatusBarPanel).FButton,this.FImageIndex=rtl.as(e,t.TTMSFNCStatusBarPanel).FImageIndex,this.FImageCount=rtl.as(e,t.TTMSFNCStatusBarPanel).FImageCount,this.FAutoSize=rtl.as(e,t.TTMSFNCStatusBarPanel).FAutoSize,this.FProgress.Assign(rtl.as(e,t.TTMSFNCStatusBarPanel).FProgress),this.FOffset.Assign(rtl.as(e,t.TTMSFNCStatusBarPanel).FOffset),this.FControl=rtl.as(e,t.TTMSFNCStatusBarPanel).FControl,this.FControlAlign=rtl.as(e,t.TTMSFNCStatusBarPanel).FControlAlign,this.FURLColor=rtl.as(e,t.TTMSFNCStatusBarPanel).FURLColor):pas.Classes.TPersistent.Assign.apply(this,arguments)};var e=this.$rtti;e.addProperty("AutoSize",2,rtl.boolean,"FAutoSize","SetAutoSize",{Default:!1}),e.addProperty("Text",14,rtl.string,"FText","SetText",{stored:"IsTextStored"}),e.addProperty("Style",2,t.$rtti.TTMSFNCStatusBarPanelStyle,"FStyle","SetStyle",{Default:t.TTMSFNCStatusBarPanelStyle.spsHTML}),e.addProperty("MinWidth",2,rtl.longint,"FMinWidth","SetMinWidth",{Default:20}),e.addProperty("Enabled",2,rtl.boolean,"FEnabled","SetEnabled",{Default:!0}),e.addProperty("DateFormat",14,rtl.string,"FDateFormat","SetDateFormat",{stored:"IsDateFormatStored"}),e.addProperty("TimeFormat",14,rtl.string,"FTimeFormat","SetTimeFormat",{stored:"IsTimeFormatStored"}),e.addProperty("Alignment",2,pas.Classes.$rtti.TAlignment,"FAlignment","SetAlignment",{Default:pas.Classes.TAlignment.taLeftJustify}),e.addProperty("ImageIndex",2,rtl.longint,"FImageIndex","SetImageIndex",{Default:-1}),e.addProperty("ImageCount",2,rtl.longint,"FImageCount","SetImageCount",{Default:1}),e.addProperty("VerticalAlign",2,t.$rtti.TTMSFNCStatusBarVerticalPanelAlignment,"FVerticalAlign","SetVerticalAlign",{Default:t.TTMSFNCStatusBarVerticalPanelAlignment.spaCenter}),e.addProperty("Button",2,rtl.boolean,"FButton","SetButton",{Default:!1}),e.addProperty("Width",2,rtl.longint,"FWidth","SetWidth"),e.addProperty("Hint",14,rtl.string,"FHint","SetHint",{stored:"IsHintStored"}),e.addProperty("Progress",2,t.$rtti.TTMSFNCStatusBarProgressAppearance,"FProgress","SetProgress"),e.addProperty("Offset",2,pas["WEBLib.TMSFNCTypes"].$rtti.TTMSFNCPoint,"FOffset","SetOffset"),e.addProperty("Visible",2,rtl.boolean,"FVisible","SetVisible",{Default:!0}),e.addProperty("URLColor",2,pas["WEBLib.Graphics"].$rtti.TColor,"FURLColor","SetURLColor",{Default:16711680}),e.addProperty("Control",2,pas["WEBLib.Controls"].$rtti.TControl,"FControl","SetControl"),e.addProperty("ControlAlign",2,pas["WEBLib.TMSFNCCustomControl"].$rtti.TTMSFNCControlAlignment,"FControlAlign","SetControlAlign",{Default:pas["WEBLib.TMSFNCCustomControl"].TTMSFNCControlAlignment.caClient})})),rtl.createClass(this,"TTMSFNCStatusBarPanels",pas.Classes.TCollection,(function(){this.$init=function(){pas.Classes.TCollection.$init.call(this),this.FOwner=null,this.FOnChange=null},this.$final=function(){this.FOwner=void 0,this.FOnChange=void 0,pas.Classes.TCollection.$final.call(this)},this.GetItem$1=function(t){return this.GetItem(t)},this.DoChange=function(){null!=this.FOnChange&&this.FOnChange(this)},this.Update=function(t){pas.Classes.TCollection.Update.apply(this,arguments),this.DoChange()},this.Create$2=function(e){return pas.Classes.TCollection.Create$1.call(this,t.TTMSFNCStatusBarPanel),this.FOwner=e,this},this.Add$1=function(){return pas.Classes.TCollection.Add.call(this)}})),this.$rtti.$MethodVar("TTMSFNCStatusBarBeforeDrawPanelEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["APanel",this.$rtti.TTMSFNCStatusBarPanel],["AAllow",rtl.boolean],["ADefaultDraw",rtl.boolean]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCStatusBarAfterDrawPanelEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["APanel",this.$rtti.TTMSFNCStatusBarPanel]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCStatusBarDrawCustomPanelEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["APanel",this.$rtti.TTMSFNCStatusBarPanel]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCStatusBarPanelLeftClickEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["PanelIndex",rtl.longint]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCStatusBarPanelRightClickEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["PanelIndex",rtl.longint]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCStatusBarPanelAnchorClickEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["APanel",this.$rtti.TTMSFNCStatusBarPanel],["AAnchor",rtl.string]]),methodkind:0}),rtl.createClass(this,"TTMSFNCCustomStatusBar",pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl,(function(){this.$init=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.$init.call(this),this.FTimer=null,this.FHoverPanelIndex=0,this.FDownPanelIndex=0,this.FBitmapContainer=null,this.FPanels=null,this.FPanelPos=0,this.FOnDrawCustomPanel=null,this.FOnPanelLeftClick=null,this.FOnPanelRightClick=null,this.FOnAnchorClick=null,this.FOnAfterDrawPanel=null,this.FOnBeforeDrawPanel=null,this.FAppearance=null,this.FShowSplitter=!1,this.FMouseDown=!1,this.FVerMargin=0},this.$final=function(){this.FTimer=void 0,this.FBitmapContainer=void 0,this.FPanels=void 0,this.FOnDrawCustomPanel=void 0,this.FOnPanelLeftClick=void 0,this.FOnPanelRightClick=void 0,this.FOnAnchorClick=void 0,this.FOnAfterDrawPanel=void 0,this.FOnBeforeDrawPanel=void 0,this.FAppearance=void 0,pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.$final.call(this)},this.SetPanels=function(t){this.FPanels.Assign(t)},this.SetBitmapContainer=function(t){this.FBitmapContainer=t,this.Invalidate()},this.SetAppearance=function(t){this.FAppearance.Assign(t)},this.SetShowSplitter=function(t){this.FShowSplitter!==t&&(this.FShowSplitter=t,this.Invalidate())},this.GetBitmapContainer=function(){return this.FBitmapContainer},this.DoAnchorClick=function(t,e){null!=this.FOnAnchorClick?this.FOnAnchorClick(this,t,e):pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.OpenURL(e)},this.DoBeforeDrawPanel=function(t,e,i,s,o){null!=this.FOnBeforeDrawPanel&&this.FOnBeforeDrawPanel(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i,s,o)},this.DoAfterDrawPanel=function(t,e,i){null!=this.FOnAfterDrawPanel&&this.FOnAfterDrawPanel(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i)},this.Notification=function(t,e){var i=0;if(pas["WEBLib.Menus"].TWebCustomControl.Notification.apply(this,arguments),1===e&&t===this.FBitmapContainer&&(this.FBitmapContainer=null),!(3 in this.FComponentState)&&1===e)for(var s=0,o=this.FPanels.GetCount()-1;s<=o;s++)i=s,t===this.FPanels.GetItem$1(i).FControl&&(this.FPanels.GetItem$1(i).FControl=null)},this.Draw=function(t,e){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Draw.apply(this,arguments),t.FBitmapContainer=this.GetBitmapContainer(),this.DrawAllPanels(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e))},this.DoAfterDraw=function(t,e){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.DoAfterDraw.apply(this,arguments),t.FStroke.Assign(this.FAppearance.FStroke),t.FFill.SetKind(0),t.DrawRectangle$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),2)},this.HandleMouseDown=function(t,e,i,s){var o=0;pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleMouseDown.apply(this,arguments),this.CaptureEx(),this.FMouseDown=!0,-1!==(o=this.GetPanelIndex(i,s))&&(this.FDownPanelIndex=o,null!=this.FOnPanelLeftClick&&0===t&&this.FOnPanelLeftClick(this,o),null!=this.FOnPanelRightClick&&1===t&&this.FOnPanelRightClick(this,o)),this.Invalidate()},this.HandleMouseMove=function(e,i,s){var o=t.TTMSFNCStatusBarPanelAnchor.$new();pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleMouseMove.apply(this,arguments),o.$assign(this.XYToPanelAnchor(i,s)),""!==o.AAnchor?this.SetControlCursor(21):this.SetControlCursor(0),this.FHoverPanelIndex!==o.AIndex&&(this.FHoverPanelIndex=o.AIndex,this.Invalidate())},this.HandleMouseUp=function(t,e,i,s){var o=0,n="";pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleMouseUp.apply(this,arguments),""!==(n=this.XYToPanelAnchor(i,s).AAnchor)&&(o=this.GetPanelIndex(i,s),this.DoAnchorClick(this.FPanels.GetItem$1(o),n)),this.FMouseDown=!1,this.FDownPanelIndex=-1,this.ReleaseCaptureEx(),this.Invalidate()},this.HandleMouseLeave=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleMouseLeave.call(this),this.FHoverPanelIndex=-1,this.Invalidate()},this.DrawAllPanels=function(t,e){var i=0,s=0,o=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),n=!1,r=!1;s=-1;for(var a=this.FPanels.GetCount()-1;a>=0;a--)if(i=a,this.FPanels.GetItem$1(i).FVisible){s=i;break}for(var l=0,h=this.FPanels.GetCount()-1;l<=h;l++)i=l,this.FPanels.GetItem$1(i).FVisible&&(i===s?o.$assign(pas["WEBLib.TMSFNCTypes"].RectF(this.FPanelPos,0,this.FPanelPos+this.GetLastPanelWidth(),this.GetHeight())):o.$assign(pas["WEBLib.TMSFNCTypes"].RectF(this.FPanelPos,0,this.FPanelPos+this.FPanels.GetItem$1(i).FWidth,this.GetHeight())),n=!0,r=!0,this.DoBeforeDrawPanel(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(o),this.FPanels.GetItem$1(i),n,r),n&&(r&&this.DrawPanel(this.FPanels.GetItem$1(i),t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(o)),this.DoAfterDrawPanel(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(o),this.FPanels.GetItem$1(i))),this.FPanelPos=this.FPanelPos+this.FPanels.GetItem$1(i).FWidth);this.FPanelPos=0},this.DrawPanel=function(t,e,i){var s=0,o=0,n=0,r=0,a=0,l=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),h=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),F=0,p=0;t.FButton?t.FEnabled?t.GetIndex()===this.FDownPanelIndex?e.DrawButton(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),!0,!1,!0,!0,1):t.GetIndex()===this.FHoverPanelIndex?e.DrawButton(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),!1,!0,!0,!0,1):e.DrawButton(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),!1,!1,!0,!0,1):e.DrawButton(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),!1,!1,!1,!0,1):(e.FFill.Assign(this.FAppearance.FFill),e.FStroke.SetColor(this.FAppearance.FFill.FColor),e.DrawRectangle$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),0)),this.FShowSplitter&&(e.FStroke.Assign(this.FAppearance.FStroke),e.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(i.Left,i.Top)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(i.Left,i.Bottom)),2,2)),e.FFont.AssignSource(this.FAppearance.FFont),t.FEnabled?e.FFont.SetColor(this.FAppearance.FFont.FColor):e.FFont.SetColor(12632256),h.$assign(i),h.Right=h.Right-t.FOffset.FX,h.Bottom=h.Bottom-t.FOffset.FY,pas["WEBLib.TMSFNCTypes"].OffsetRectEx$1(h,t.FOffset.FX,t.FOffset.FY),p=0,F=0;var c=t.FAlignment;0===c?p=1:1===c?p=2:2===c&&(p=0);var u=t.FVerticalAlign;if(0===u?F=1:1===u?F=0:2===u&&(F=2),null==t.FControl){var C=t.FStyle;if(1===C)pas["WEBLib.TMSFNCTypes"].InflateRectEx(h,-this.ScalePaintValue(10),0),e.DrawText$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(h),t.FText,!1,p,F,0,0,-1,-1,!1,!1,-1,-1);else if(0===C)pas["WEBLib.TMSFNCTypes"].InflateRectEx(h,-this.ScalePaintValue(10),0),e.FURLColor=t.FURLColor,e.DrawText$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(h),t.FText,!1,p,F,0,0,-1,-1,!0,!1,-1,-1);else if(2===C)null!=this.FOnDrawCustomPanel&&this.FOnDrawCustomPanel(this,e,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),t);else if(5===C)this.DrawProgressBar(e,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),t);else if(6===C){if(null!=this.GetBitmapContainer()&&-1!==t.FImageIndex){r=this.GetBitmapContainer().GetBitmap(t.FImageIndex).GetWidth(),a=this.GetBitmapContainer().GetBitmap(t.FImageIndex).GetHeight(),l.$assign(i),l.Right=l.Left+r,n=0,""!==t.FText&&(h.$assign(i),h.Right=i.Right-r-this.ScalePaintValue(this.FVerMargin),pas["WEBLib.TMSFNCTypes"].OffsetRectEx$1(h,r+this.ScalePaintValue(this.FVerMargin),0),n=Math.round(e.CalculateTextWidth(t.FText,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(h),!1,!1)),h.Right=h.Right-t.FOffset.FX,h.Bottom=h.Bottom-t.FOffset.FY,pas["WEBLib.TMSFNCTypes"].OffsetRectEx$1(h,t.FOffset.FX,t.FOffset.FY),pas["WEBLib.TMSFNCTypes"].InflateRectEx(h,-this.ScalePaintValue(this.FVerMargin),0),e.DrawText$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(h),t.FText,!1,p,F,0,0,-1,-1,!1,!1,-1,-1));var T=p;0===T?l.Left=i.Left+(i.Right-i.Left-n)/2-r:1===T?l.Left=i.Left+this.ScalePaintValue(this.FVerMargin):2===T&&(l.Left=i.Right-r-this.ScalePaintValue(2*this.FVerMargin)-n);var S=F;0===S?l.Top=(this.GetHeight()-a)/2:1===S?l.Top=1:2===S&&(l.Top=this.GetHeight()-a),e.DrawBitmap$5(l.Left,l.Top,this.GetBitmapContainer().GetBitmap(t.FImageIndex))}}else if(7===C){if(null!=this.GetBitmapContainer()&&t.FImageIndex>-1&&t.FImageIndex<this.GetBitmapContainer().ItemCount()){r=this.GetBitmapContainer().GetBitmap(t.FImageIndex).GetWidth(),a=this.GetBitmapContainer().GetBitmap(t.FImageIndex).GetHeight(),l.$assign(i),l.Right=l.Left+r,pas["WEBLib.TMSFNCTypes"].OffsetRectEx$1(l,this.ScalePaintValue(this.FVerMargin),0);var d=F;0===d?l.Top=(this.GetHeight()-a)/2:1===d?l.Top=1:2===d&&(l.Top=this.GetHeight()-a),o=Math.min(t.FImageIndex+t.FImageCount,this.GetBitmapContainer().ItemCount());for(var m=t.FImageIndex,f=o-1;m<=f;m++)s=m,e.DrawBitmap$5(l.Left,l.Top,this.GetBitmapContainer().GetBitmap(s)),pas["WEBLib.TMSFNCTypes"].OffsetRectEx$1(l,r,0)}}else 8!==C&&3!==C&&4!==C||(pas["WEBLib.TMSFNCTypes"].InflateRectEx(h,-this.ScalePaintValue(this.FVerMargin),0),e.DrawText$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(h),t.FText,!1,p,F,1,0,-1,-1,!1,!1,-1,-1))}},this.DrawProgressBar=function(t,e,i){var s,o,n=pas["WEBLib.TMSFNCTypes"].TRectF.$new();if(pas["WEBLib.TMSFNCTypes"].InflateRectEx(e,-this.ScalePaintValue(2),-this.ScalePaintValue(2)),t.FFill.Assign(i.FProgress.FBackgroundFill),t.FFont.AssignSource(this.FAppearance.FFont),t.FStroke.SetColor(-1),t.DrawRectangle$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),2),(s=Math.round(i.FProgress.FPosition/i.FProgress.FMax*100))<=i.FProgress.FLevel1Perc?t.FFill.Assign(i.FProgress.FLevel0Fill):s>i.FProgress.FLevel1Perc&&s<=i.FProgress.FLevel2Perc?t.FFill.Assign(i.FProgress.FLevel1Fill):s>i.FProgress.FLevel2Perc&&s<i.FProgress.FMax?t.FFill.Assign(i.FProgress.FLevel2Fill):t.FFill.Assign(i.FProgress.FLevel3Fill),n.$assign(e),o=s/100*(n.Right-n.Left),n.Right=n.Left+o,t.DrawRectangle$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(n),0),i.FProgress.FShowIndication){var r=i.FProgress.FIndication;0===r?t.DrawText$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),pas.SysUtils.IntToStr(s)+"%",!1,0,0,0,0,-1,-1,!0,!1,-1,-1):1===r&&t.DrawText$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),pas.SysUtils.IntToStr(i.FProgress.FPosition),!1,0,0,0,0,-1,-1,!0,!1,-1,-1)}t.FStroke.Assign(i.FProgress.FBorderStroke),t.FFill.SetColor(-1),t.DrawRectangle$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),2)},this.AutoSizePanels=function(){for(var t=0,e=0,i=0,s=null,o=0,n=this.FPanels.GetCount()-1;o<=n;o++)if(t=o,(s=this.FPanels.GetItem$1(t)).FAutoSize){e=0,i=0;var r=s.FStyle;0===r?i=this.GetTextWidth(s.FText,!0):1===r||4===r||3===r?i=this.GetTextWidth(s.FText,!1):6===r&&(i=this.GetTextWidth(s.FText,!1),null!=this.GetBitmapContainer()&&s.FImageIndex>-1&&s.FImageIndex<this.GetBitmapContainer().ItemCount()&&(e=this.GetBitmapContainer().GetItems().GetItemEx(s.FImageIndex).FBitmap.GetWidth()+this.ScalePaintValue(this.FVerMargin))),s.SetWidth(Math.max(e+i+this.ScalePaintValue(2*this.FVerMargin),s.FMinWidth))}},this.Loaded=function(){pas["WEBLib.Controls"].TCustomControl.Loaded.call(this),this.AutoSizePanels()},this.ApplyStyle=function(){var t=0;pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.ApplyStyle.call(this),t=-1,pas["WEBLib.TMSFNCStyles"].TTMSFNCStyles.GetStyleTextFontColor({get:function(){return t},set:function(e){t=e}})&&this.FAppearance.FFont.SetColor(t),t=-1,pas["WEBLib.TMSFNCStyles"].TTMSFNCStyles.GetStyleLineFillColor({get:function(){return t},set:function(e){t=e}})&&(this.FAppearance.FStroke.SetColor(t),this.FStroke.SetColor(t)),t=-1,pas["WEBLib.TMSFNCStyles"].TTMSFNCStyles.GetStyleAlternativeBackgroundFillColor({get:function(){return t},set:function(e){t=e}})&&(this.FAppearance.FFill.SetColor(t),this.FFill.SetColor(t))},this.ResetToDefaultStyle=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.ResetToDefaultStyle.call(this),this.FAppearance.FFill.SetColor(16777215),this.FAppearance.FStroke.SetColor(12632256),this.FAppearance.FFont.SetColor(0),this.FFill.SetColor(16777215),this.FStroke.SetColor(12632256)},this.UpdateStatusBar=function(){for(var t=0,e=0,i=this.FPanels.GetCount()-1;e<=i;e++){t=e;var s=this.FPanels.GetItem$1(t).FStyle;4===s?this.FPanels.GetItem$1(t).SetText(pas.SysUtils.FormatDateTime(this.FPanels.GetItem$1(t).FDateFormat,pas.SysUtils.Now())):3===s&&this.FPanels.GetItem$1(t).SetText(pas.SysUtils.FormatDateTime(this.FPanels.GetItem$1(t).FTimeFormat,pas.SysUtils.Now()))}},this.PanelsChanged=function(t){this.FPanels.FUpdateCount>0||0 in this.FComponentState||this.Invalidate()},this.AppearanceChanged=function(t){this.Invalidate()},this.StatusBarTimer=function(t){this.UpdateStatusBar()},this.GetVersion=function(){return this.$class.GetVersionNumber(1,1,1,0)},this.GetLastPanelWidth=function(){var t=0,e=0,i=0;i=-1;for(var s=this.FPanels.GetCount()-1;s>=0;s--)if(e=s,this.FPanels.GetItem$1(e).FVisible){i=e;break}t=0;for(var o=0,n=this.FPanels.GetCount()-1;o<=n;o++)if(e=o,this.FPanels.GetItem$1(e).FVisible){if(t+this.ScalePaintValue(2*this.FVerMargin)>this.GetWidth())return this.ScalePaintValue(2*this.FVerMargin);if(e===i)return Math.round(this.GetWidth())-t;t+=this.FPanels.GetItem$1(e).FWidth}return Math.round(this.GetWidth())-t},this.GetTextWidth=function(t,e){var i=0,s=null;(s=pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.$create("CreateBitmapCanvas",[1,1,!1,!0])).FFont.AssignSource(this.FAppearance.FFont),s.BeginScene();try{i=e?Math.round(s.CalculateTextWidth$1(t)):Math.round(s.CalculateTextWidth(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(0,0,1e4,1e4)),!1,!1))}finally{s.EndScene(),s=rtl.freeLoc(s)}return i},this.GetPanelIndex=function(t,e){var i=0,s=0,o=0,n=0,r=0;if(i=-1,e>this.GetHeight()||e<0)return i;o=0,r=-1;for(var a=this.FPanels.GetCount()-1;a>=0;a--)if(s=a,this.FPanels.GetItem$1(s).FVisible){r=s;break}for(var l=0,h=this.FPanels.GetCount()-1;l<=h;l++)if(s=l,this.FPanels.GetItem$1(s).FVisible){if(t<=o+(n=s===r?this.GetLastPanelWidth():this.FPanels.GetItem$1(s).FWidth))return i=s;o+=n}return i},this.XYToPanelAnchor=function(e,i){var s,o=t.TTMSFNCStatusBarPanelAnchor.$new(),n=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),r=null,a=0,l=0,h="",F="",p=null;if(o.AAnchor="",s=this.GetPanelIndex(e,i),o.AIndex=s,-1!==s&&0===(r=this.FPanels.GetItem$1(s)).FStyle){n.$assign(this.GetPanelRect(s)),s===this.FPanels.GetCount()-1&&(n.Right=n.Left+this.GetLastPanelWidth()),pas["WEBLib.TMSFNCTypes"].InflateRectEx(n,-this.ScalePaintValue(this.FVerMargin),0),n.Right=n.Right-r.FOffset.FX,n.Bottom=n.Bottom-r.FOffset.FY,pas["WEBLib.TMSFNCTypes"].OffsetRectEx$1(n,r.FOffset.FX,r.FOffset.FY),l=1,a=0;var c=r.FAlignment;0===c?l=1:1===c?l=2:2===c&&(l=0);var u=r.FVerticalAlign;0===u?a=1:1===u?a=0:2===u&&(a=2),h=r.FText,F="",(p=pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.$create("CreateBitmapCanvas",[1,1,!1,!0])).BeginScene(),p.FBitmapContainer=this.GetBitmapContainer(),p.FFont.AssignSource(this.FAppearance.FFont);try{F=p.DrawText$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(n),h,!1,l,a,0,0,-1,-1,!0,!0,e,i)}finally{p.EndScene(),p=rtl.freeLoc(p)}o.AAnchor=F}return o},this.Create$1=function(e){return pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Create$1.apply(this,arguments),this.FPanels=t.TTMSFNCStatusBarPanels.$create("Create$2",[this]),this.FTimer=pas["WEBLib.ExtCtrls"].TTimer.$create("Create$1",[this]),this.FTimer.SetInterval(100),this.FAppearance=t.TTMSFNCStatusBarAppearance.$create("Create$1"),this.FPanelPos=0,this.SetHeight(20),this.FHoverPanelIndex=-1,this.FDownPanelIndex=-1,this.FVerMargin=10,this.FShowSplitter=!0,this.FMouseDown=!1,this.SetAlign(2),this.FTimer.FOnTimer=rtl.createCallback(this,"StatusBarTimer"),this.FPanels.FOnChange=rtl.createCallback(this,"PanelsChanged"),this.FAppearance.FOnChange=rtl.createCallback(this,"AppearanceChanged"),this},this.Destroy=function(){rtl.free(this,"FPanels"),rtl.free(this,"FAppearance"),pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Destroy.call(this)},this.Assign=function(e){t.TTMSFNCCustomStatusBar.isPrototypeOf(e)?(this.FBitmapContainer.Assign(rtl.as(e,t.TTMSFNCCustomStatusBar).GetBitmapContainer()),this.FPanels.Assign(rtl.as(e,t.TTMSFNCCustomStatusBar).FPanels),this.FAppearance.Assign(rtl.as(e,t.TTMSFNCCustomStatusBar).FAppearance),this.FShowSplitter=rtl.as(e,t.TTMSFNCCustomStatusBar).FShowSplitter):pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Assign.apply(this,arguments)},this.GetPanelRect=function(t){var e=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),i=0,s=0,o=pas["WEBLib.TMSFNCTypes"].TRectF.$new();o.$assign(pas["WEBLib.TMSFNCTypes"].RectF(-1,-1,-1,-1)),s=0;for(var n=0,r=t-1;n<=r;n++)i=n,this.FPanels.GetItem$1(i).FVisible&&(s+=this.FPanels.GetItem$1(i).FWidth);return t>=0&&t<=this.FPanels.GetCount()-1&&this.FPanels.GetItem$1(t).FVisible&&(o.Left=s,o.Top=0,o.Bottom=this.GetHeight(),o.Right=o.Left+this.FPanels.GetItem$1(t).FWidth),e.$assign(o),e},rtl.addIntf(this,pas["WEBLib.TMSFNCBitmapContainer"].ITMSFNCBitmapContainer),rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas["WEBLib.TMSFNCTypes"].ITMSFNCProductInfo),rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TTMSFNCStatusBar",this.TTMSFNCCustomStatusBar,(function(){rtl.addIntf(this,pas["WEBLib.TMSFNCBitmapContainer"].ITMSFNCBitmapContainer),rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas["WEBLib.TMSFNCTypes"].ITMSFNCProductInfo),rtl.addIntf(this,pas.System.IUnknown);var e=this.$rtti;e.addProperty("Align",2,pas["WEBLib.Controls"].$rtti.TAlign,"FAlign","SetAlign",{Default:pas["WEBLib.Controls"].TAlign.alBottom}),e.addProperty("Panels",2,t.$rtti.TTMSFNCStatusBarPanels,"FPanels","SetPanels"),e.addProperty("PanelAppearance",2,t.$rtti.TTMSFNCStatusBarAppearance,"FAppearance","SetAppearance"),e.addProperty("BitmapContainer",3,pas["WEBLib.TMSFNCBitmapContainer"].$rtti.TTMSFNCBitmapContainer,"GetBitmapContainer","SetBitmapContainer"),e.addProperty("ShowSplitter",2,rtl.boolean,"FShowSplitter","SetShowSplitter",{Default:!0}),e.addProperty("Fill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FFill","SetFill"),e.addProperty("Stroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FStroke","SetStroke"),e.addProperty("OnDrawCustomPanel",0,t.$rtti.TTMSFNCStatusBarDrawCustomPanelEvent,"FOnDrawCustomPanel","FOnDrawCustomPanel"),e.addProperty("OnPanelLeftClick",0,t.$rtti.TTMSFNCStatusBarPanelLeftClickEvent,"FOnPanelLeftClick","FOnPanelLeftClick"),e.addProperty("OnPanelRightClick",0,t.$rtti.TTMSFNCStatusBarPanelRightClickEvent,"FOnPanelRightClick","FOnPanelRightClick"),e.addProperty("OnAnchorClick",0,t.$rtti.TTMSFNCStatusBarPanelAnchorClickEvent,"FOnAnchorClick","FOnAnchorClick"),e.addProperty("OnBeforeDrawPanel",0,t.$rtti.TTMSFNCStatusBarBeforeDrawPanelEvent,"FOnBeforeDrawPanel","FOnBeforeDrawPanel"),e.addProperty("OnAfterDrawPanel",0,t.$rtti.TTMSFNCStatusBarAfterDrawPanelEvent,"FOnAfterDrawPanel","FOnAfterDrawPanel"),e.attr=[pas.Classes.ComponentPlatformsAttribute,"Create$1",[0]]}))}),["Math"]),rtl.module("WEBLib.TMSFNCTabSet",["System","Classes","Types","WEBLib.TMSFNCPersistence","WEBLib.TMSFNCCustomControl","WEBLib.TMSFNCBitmapContainer","WEBLib.TMSFNCPopup","WEBLib.TMSFNCGraphics","WEBLib.TMSFNCTypes","WEBLib.Controls","WEBLib.ExtCtrls","WEBLib.StdCtrls","WEBLib.TMSFNCGraphicsTypes"],(function(){"use strict";var t=this,e=t.$impl;this.MAJ_VER=1,this.MIN_VER=0,this.REL_VER=1,this.BLD_VER=1,this.TMSFNCTABSETLISTSVG="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjRweCIgaGVpZ2h0PSIyNHB4IiB2aWV3Qm94PSIwIDAgMjQgMjQiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHBhdGggc3Ryb2tlPSJjdXJyZW50Q29sb3IiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIgc3Ryb2tlLXdpZHRoPSIyIiBkPSJtMTcgMTAtNSA1LTUtNSIgZmlsbD0ibm9uZSIvPjwvc3ZnPg==",this.TMSFNCTABSETCLOSESVG="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjRweCIgaGVpZ2h0PSIyNHB4IiB2aWV3Qm94PSIwIDAgMjQgMjQiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgZmlsbD0ibm9uZSI+PHBhdGggc3Ryb2tlPSJjdXJyZW50Q29sb3IiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIgc3Ryb2tlLXdpZHRoPSIyIiBkPSJNMTIgMTIgNyA3bTUgNSA1IDVtLTUtNSA1LTVtLTUgNS01IDUiLz48L3N2Zz4=",this.TMSFNCTABSETADDSVG="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB3aWR0aD0iMjRweCIgaGVpZ2h0PSIyNHB4IiB2aWV3Qm94PSIwIDAgMjQgMjQiIHZlcnNpb249IjEuMSI+CjxnIGlkPSJzdXJmYWNlMSI+CjxwYXRoIHN0eWxlPSIgc3Ryb2tlOm5vbmU7ZmlsbC1ydWxlOm5vbnplcm87ZmlsbDpyZ2IoMCUsMCUsMCUpO2ZpbGwtb3BhY2l0eToxOyIgZD0iTSAxMiA2IEMgMTIuNDE0MDYyIDYgMTIuNzUgNi4zMzU5MzggMTIuNzUgNi43NSBMIDEyLjc1IDExLjI1IEwgMTcuMjUgMTEuMjUgQyAxNy42NjQwNjIgMTEuMjUgMTggMTEuNTg1OTM4IDE4IDEyIEMgMTggMTIuNDE0MDYyIDE3LjY2NDA2MiAxMi43NSAxNy4yNSAxMi43NSBMIDEyLjc1IDEyLjc1IEwgMTIuNzUgMTcuMjUgQyAxMi43NSAxNy42NjQwNjIgMTIuNDE0MDYyIDE4IDEyIDE4IEMgMTEuNTg1OTM4IDE4IDExLjI1IDE3LjY2NDA2MiAxMS4yNSAxNy4yNSBMIDExLjI1IDEyLjc1IEwgNi43NSAxMi43NSBDIDYuMzM1OTM4IDEyLjc1IDYgMTIuNDE0MDYyIDYgMTIgQyA2IDExLjU4NTkzOCA2LjMzNTkzOCAxMS4yNSA2Ljc1IDExLjI1IEwgMTEuMjUgMTEuMjUgTCAxMS4yNSA2Ljc1IEMgMTEuMjUgNi4zMzU5MzggMTEuNTg1OTM4IDYgMTIgNiBaIE0gMTIgNiAiLz4KPC9nPgo8L3N2Zz4K",this.TMSFNCTABSETNEXTSVG="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjRweCIgaGVpZ2h0PSIyNHB4IiB2aWV3Qm94PSIwIDAgMjQgMjQiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSJjdXJyZW50Q29sb3IiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIgc3Ryb2tlLXdpZHRoPSIyIiBkPSJtMTAgNyA1IDUtNSA1Ii8+PC9zdmc+",this.TMSFNCTABSETPREVIOUSSVG="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjRweCIgaGVpZ2h0PSIyNHB4IiB2aWV3Qm94PSIwIDAgMjQgMjQiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSJjdXJyZW50Q29sb3IiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIgc3Ryb2tlLXdpZHRoPSIyIiBkPSJtMTQgNy01IDUgNSA1Ii8+PC9zdmc+",this.TTMSFNCTabSetColorProgress=16297243,this.TTMSFNCTabSetColor=16316397,this.TTMSFNCTabSetDownColor=15655897,this.TTMSFNCTabSetHoverColor=16313827,this.$rtti.$Class("TTMSFNCTabSetTab"),this.TTMSFNCTabSetTabShape={0:"tsRectangle",tsRectangle:0,1:"tsPyramidLeft",tsPyramidLeft:1,2:"tsPyramidRight",tsPyramidRight:2,3:"tsPyramid",tsPyramid:3,4:"tsRoundLeft",tsRoundLeft:4,5:"tsRoundRight",tsRoundRight:5,6:"tsRound",tsRound:6},this.$rtti.$Enum("TTMSFNCTabSetTabShape",{minvalue:0,maxvalue:6,ordtype:1,enumtype:this.TTMSFNCTabSetTabShape}),this.TTMSFNCTabSetTabKind={0:"ttkNormal",ttkNormal:0,1:"ttkInsert",ttkInsert:1},this.TTMSFNCTabSetTabProgressMode={0:"tpmNormal",tpmNormal:0,1:"tpmMarquee",tpmMarquee:1},this.$rtti.$Enum("TTMSFNCTabSetTabProgressMode",{minvalue:0,maxvalue:1,ordtype:1,enumtype:this.TTMSFNCTabSetTabProgressMode}),this.TTMSFNCTabSetTabProgressKind={0:"tpkNone",tpkNone:0,1:"tpkCircular",tpkCircular:1,2:"tpkRectangular",tpkRectangular:2},this.$rtti.$Enum("TTMSFNCTabSetTabProgressKind",{minvalue:0,maxvalue:2,ordtype:1,enumtype:this.TTMSFNCTabSetTabProgressKind}),this.TTMSFNCTabSetTabSizeMode={0:"tsmAutoSize",tsmAutoSize:0,1:"tsmFixedSize",tsmFixedSize:1,2:"tsmFixedSizeAutoShrink",tsmFixedSizeAutoShrink:2,3:"tsmAutoTabSize",tsmAutoTabSize:3},this.$rtti.$Enum("TTMSFNCTabSetTabSizeMode",{minvalue:0,maxvalue:3,ordtype:1,enumtype:this.TTMSFNCTabSetTabSizeMode}),this.TTMSFNCTabSetLayoutPosition={0:"tlpLeft",tlpLeft:0,1:"tlpTop",tlpTop:1,2:"tlpBottom",tlpBottom:2,3:"tlpRight",tlpRight:3},this.$rtti.$Enum("TTMSFNCTabSetLayoutPosition",{minvalue:0,maxvalue:3,ordtype:1,enumtype:this.TTMSFNCTabSetLayoutPosition}),this.TTMSFNCTabSetLayoutMultiline={0:"tlmNone",tlmNone:0,1:"tlmEnabled",tlmEnabled:1,2:"tlmEnabledActiveTab",tlmEnabledActiveTab:2},this.$rtti.$Enum("TTMSFNCTabSetLayoutMultiline",{minvalue:0,maxvalue:2,ordtype:1,enumtype:this.TTMSFNCTabSetLayoutMultiline}),this.TTMSFNCTabSetTabCloseAction={0:"ttcaNone",ttcaNone:0,1:"ttcaFree",ttcaFree:1,2:"ttcaHide",ttcaHide:2},this.$rtti.$Enum("TTMSFNCTabSetTabCloseAction",{minvalue:0,maxvalue:2,ordtype:1,enumtype:this.TTMSFNCTabSetTabCloseAction}),rtl.recNewT(this,"TTMSFNCTabSetDisplayTab",(function(){this.Tab=null,this.TabKind=0,this.First=!1,this.Last=!1,this.Index=0,this.Row=0,this.$new=function(){var t=Object.create(this);return t.ContentRect=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),t.ProgressRect=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),t.CloseButtonRect=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),t.Rect=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),t.BitmapRect=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),t.TextRect=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),t},this.$eq=function(t){return this.Tab===t.Tab&&this.TabKind===t.TabKind&&this.First===t.First&&this.Last===t.Last&&this.ContentRect.$eq(t.ContentRect)&&this.ProgressRect.$eq(t.ProgressRect)&&this.CloseButtonRect.$eq(t.CloseButtonRect)&&this.Rect.$eq(t.Rect)&&this.BitmapRect.$eq(t.BitmapRect)&&this.Index===t.Index&&this.Row===t.Row&&this.TextRect.$eq(t.TextRect)},this.$assign=function(t){return this.Tab=t.Tab,this.TabKind=t.TabKind,this.First=t.First,this.Last=t.Last,this.ContentRect.$assign(t.ContentRect),this.ProgressRect.$assign(t.ProgressRect),this.CloseButtonRect.$assign(t.CloseButtonRect),this.Rect.$assign(t.Rect),this.BitmapRect.$assign(t.BitmapRect),this.Index=t.Index,this.Row=t.Row,this.TextRect.$assign(t.TextRect),this}})),rtl.createClass(this,"TTMSFNCTabSetDisplayList",pas.Classes.TList,(function(){this.GetItem=function(e){var i=t.TTMSFNCTabSetDisplayTab.$new();return i.$assign(rtl.getObject(this.Get(e))),i},this.SetItem=function(e,i){var s=t.TTMSFNCTabSetDisplayTab.$new();s.$assign(i),this.Put(e,s)}})),rtl.createClass(this,"TTMSFNCTabSetInvisibleTabList",pas.Classes.TList,(function(){this.GetItem=function(t){return rtl.getObject(this.Get(t))}})),rtl.createClass(this,"TTMSFNCTabSetTab",pas.Classes.TCollectionItem,(function(){this.$init=function(){pas.Classes.TCollectionItem.$init.call(this),this.FAnimMarqueeStartAngle=0,this.FAnimMarqueeSweepAngle=0,this.FAnimMarqueeSwitch=!1,this.FTag=0,this.FDataObject=null,this.FTabSet=null,this.FText="",this.FWordWrapping=!1,this.FTrimming=0,this.FTextAlign=0,this.FActiveTextColor=0,this.FTextColor=0,this.FDisabledTextColor=0,this.FEnabled=!1,this.FBitmaps=null,this.FDisabledBitmaps=null,this.FVisible=!1,this.FUseDefaultAppearance=!1,this.FWidth=0,this.FHeight=0,this.FDisabledColor=0,this.FActiveColor=0,this.FHoverTextColor=0,this.FColor=0,this.FHoverColor=0,this.FDownTextColor=0,this.FDownColor=0,this.FBitmapVisible=!1,this.FBitmapSize=0,this.FTextVisible=!1,this.FStretchText=!1,this.FShape=0,this.FProgressColor=0,this.FProgress=0,this.FProgressMax=0,this.FProgressMode=0,this.FCloseButton=!1,this.FProgressKind=0,this.FBadge="",this.FBadgeColor=0,this.FBadgeTextColor=0,this.FHint=""},this.$final=function(){this.FDataObject=void 0,this.FTabSet=void 0,this.FBitmaps=void 0,this.FDisabledBitmaps=void 0,pas.Classes.TCollectionItem.$final.call(this)},this.SetTrimming=function(t){this.FTrimming!==t&&(this.FTrimming=t,this.UpdateTab())},this.SetWordWrapping=function(t){this.FWordWrapping!==t&&(this.FWordWrapping=t,this.UpdateTab())},this.SetTextAlign=function(t){this.FTextAlign!==t&&(this.FTextAlign=t,this.UpdateTab())},this.SetActiveTextColor=function(t){this.FActiveTextColor!==t&&(this.FActiveTextColor=t,this.UpdateTab())},this.SetTextColor=function(t){this.FTextColor!==t&&(this.FTextColor=t,this.UpdateTab())},this.SetDisabledTextColor=function(t){this.FDisabledTextColor!==t&&(this.FDisabledTextColor=t,this.UpdateTab())},this.SetEnabled=function(t){this.FEnabled!==t&&(this.FEnabled=t,this.UpdateTab())},this.SetBitmaps=function(t){this.FBitmaps.Assign(t)},this.SetDisabledBitmaps=function(t){this.FDisabledBitmaps.Assign(t)},this.GetBitmapContainer=function(){var t=null,e=null;return t=null,null!=(e=this.TabSet())&&(t=e.GetBitmapContainer()),t},this.SetVisible=function(t){this.FVisible!==t&&(this.FVisible=t,this.UpdateTab())},this.SetUseDefaultAppearance=function(t){this.FUseDefaultAppearance!==t&&(this.FUseDefaultAppearance=t,this.UpdateTab())},this.IsWidthStored=function(){return-1!==this.FWidth},this.SetWidth=function(t){this.FWidth!==t&&(this.FWidth=t,this.UpdateTab())},this.SetColor=function(t){this.FColor!==t&&(this.FColor=t,this.UpdateTab())},this.SetDisabledColor=function(t){this.FDisabledColor!==t&&(this.FDisabledColor=t,this.UpdateTab())},this.SetDownColor=function(t){this.FDownColor!==t&&(this.FDownColor=t,this.UpdateTab())},this.SetDownTextColor=function(t){this.FDownTextColor!==t&&(this.FDownTextColor=t,this.UpdateTab())},this.SetHoverColor=function(t){this.FHoverColor!==t&&(this.FHoverColor=t,this.UpdateTab())},this.SetHoverTextColor=function(t){this.FHoverTextColor!==t&&(this.FHoverTextColor=t,this.UpdateTab())},this.SetActiveColor=function(t){this.FActiveColor!==t&&(this.FActiveColor=t,this.UpdateTab())},this.SetBitmapVisible=function(t){this.FBitmapVisible!==t&&(this.FBitmapVisible=t,this.UpdateTab())},this.IsBitmapSizeStored=function(){return 24!==this.FBitmapSize},this.SetBitmapSize=function(t){this.FBitmapSize!==t&&(this.FBitmapSize=t,this.UpdateTab())},this.SetTextVisible=function(t){this.FTextVisible!==t&&(this.FTextVisible=t,this.UpdateTab())},this.SetStretchText=function(t){this.FStretchText!==t&&(this.FStretchText=t,this.UpdateTab())},this.SetShape=function(t){this.FShape!==t&&(this.FShape=t,this.UpdateTab())},this.SetProgressColor=function(t){this.FProgressColor!==t&&(this.FProgressColor=t,this.UpdateTab())},this.IsProgressStored=function(){return 0!==this.FProgress},this.SetProgress=function(t){this.FProgress!==t&&(this.FProgress=t,this.UpdateTab())},this.IsProgressMaxStored=function(){return 100!==this.FProgressMax},this.SetProgressMax=function(t){this.FProgressMax!==t&&(this.FProgressMax=t,this.UpdateTab())},this.SetProgressMode=function(t){this.FProgressMode!==t&&(this.FProgressMode=t,1===this.FProgressMode&&0!==this.FProgressKind&&this.FTabSet.StartProgressAnimationTimer(),this.UpdateTab())},this.SetCloseButton=function(t){this.FCloseButton!==t&&(this.FCloseButton=t,this.UpdateTab())},this.SetProgressKind=function(t){this.FProgressKind!==t&&(this.FProgressKind=t,1===this.FProgressMode&&0!==this.FProgressKind&&this.FTabSet.StartProgressAnimationTimer(),this.UpdateTab())},this.SetBadge=function(t){this.FBadge!==t&&(this.FBadge=t,this.UpdateTab())},this.SetBadgeColor=function(t){this.FBadgeColor!==t&&(this.FBadgeColor=t,this.UpdateTab())},this.SetBadgeTextColor=function(t){this.FBadgeTextColor!==t&&(this.FBadgeTextColor=t,this.UpdateTab())},this.SetHint=function(t){this.FHint!==t&&(this.FHint=t,this.UpdateTab())},this.SetText=function(t){this.FText!==t&&(this.FText=t,this.UpdateTab())},this.UpdateTab=function(){var t=null;null!=(t=this.TabSet())&&t.UpdateTabs(!1,!1)},this.BitmapsChanged=function(t){var e;e=pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.GetScaledBitmap(this.FBitmaps,0,this.GetBitmapContainer()),this.SetBitmapVisible(null!=e&&!pas["WEBLib.TMSFNCTypes"].IsBitmapEmpty(e))},this.Draw=function(e,i){var s=pas["WEBLib.TMSFNCTypes"].TRectF.$new();null!=this.FTabSet&&null!=i.Tab&&(s.$assign(this.GetFixedRect(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i.Rect),t.TTMSFNCTabSetDisplayTab.$clone(i))),s.Right-s.Left<=0||s.Bottom-s.Top<=0||(e.FFont.Assign(this.TabSet().FTabAppearance.FFont),this.FEnabled?i.Tab===this.TabSet().FActiveTab?(e.FFill.Assign(this.TabSet().FTabAppearance.FActiveFill),e.FStroke.Assign(this.TabSet().FTabAppearance.FActiveStroke)):i.Tab===this.TabSet().FDownTab?(e.FFill.Assign(this.TabSet().FTabAppearance.FDownFill),e.FStroke.Assign(this.TabSet().FTabAppearance.FDownStroke)):i.Tab===this.TabSet().FHoverTab?(e.FFill.Assign(this.TabSet().FTabAppearance.FHoverFill),e.FStroke.Assign(this.TabSet().FTabAppearance.FHoverStroke)):(e.FFill.Assign(this.TabSet().FTabAppearance.FFill),e.FStroke.Assign(this.TabSet().FTabAppearance.FStroke)):(e.FFill.Assign(this.TabSet().FTabAppearance.FDisabledFill),e.FStroke.Assign(this.TabSet().FTabAppearance.FDisabledStroke)),this.FUseDefaultAppearance||(this.FEnabled?i.Tab===this.TabSet().FActiveTab?e.FFill.SetColor(this.FActiveColor):i.Tab===this.TabSet().FDownTab?e.FFill.SetColor(this.FDownColor):i.Tab===this.TabSet().FHoverTab?e.FFill.SetColor(this.FHoverColor):e.FFill.SetColor(this.FColor):e.FFill.SetColor(this.FDisabledColor)),this.DrawBackground(e,t.TTMSFNCTabSetDisplayTab.$clone(i)),this.DrawProgress(e,t.TTMSFNCTabSetDisplayTab.$clone(i)),this.DrawBitmap(e,t.TTMSFNCTabSetDisplayTab.$clone(i)),this.DrawText(e,t.TTMSFNCTabSetDisplayTab.$clone(i)),this.DrawCloseButton(e,t.TTMSFNCTabSetDisplayTab.$clone(i)),this.DrawFocus(e,t.TTMSFNCTabSetDisplayTab.$clone(i))))},this.DrawBackground=function(e,i){var s=null,o=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),n=!1,r=0;null!=this.FTabSet&&(o.$assign(this.GetFixedRect(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i.Rect),t.TTMSFNCTabSetDisplayTab.$clone(i))),r=this.FEnabled?i.Tab===this.TabSet().FActiveTab?3:i.Tab===this.TabSet().FDownTab?2:i.Tab===this.TabSet().FHoverTab?1:0:4,n=!0,this.FTabSet.DoBeforeDrawTabBackground(e,this.GetIndex(),pas["WEBLib.TMSFNCTypes"].TRectF.$clone(o),r,{get:function(){return n},set:function(t){n=t}}),n&&(this===this.TabSet().FInsertTab?e.DrawRoundRectangle$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(o),this.TabSet().FButtonAppearance.FRounding,rtl.createSet(0,1,2,3),2):null!=(s=this.GetShapePath(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(o)))&&(e.DrawPath(s,0),s=rtl.freeLoc(s)),this.FTabSet.DoAfterDrawTabBackground(e,this.GetIndex(),pas["WEBLib.TMSFNCTypes"].TRectF.$clone(o),r)))},this.DrawText=function(t,e){var i,s=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),o=!1,n=0,r=0,a=0,l="",h=!1;if(null!=this.FTabSet&&this.FTextVisible&&""!==this.FText&&(!this.FTabSet.FInplaceEditorActive||this.FTabSet.FUpdateTab.Tab!==this)){s.$assign(e.TextRect),i=t.SaveState(!1);try{if(t.ClipRect(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(s)),this.FUseDefaultAppearance?(o=this.TabSet().FTabAppearance.FWordWrapping,n=this.TabSet().FTabAppearance.FTrimming,r=this.TabSet().FTabAppearance.FTextAlign,this.FEnabled?this===this.TabSet().FActiveTab?t.FFont.SetColor(this.TabSet().FTabAppearance.FActiveTextColor):this===this.TabSet().FDownTab?t.FFont.SetColor(this.TabSet().FTabAppearance.FDownTextColor):this===this.TabSet().FHoverTab?t.FFont.SetColor(this.TabSet().FTabAppearance.FHoverTextColor):t.FFont.SetColor(this.TabSet().FTabAppearance.FTextColor):t.FFont.SetColor(this.TabSet().FTabAppearance.FDisabledTextColor)):(o=this.FWordWrapping,n=this.FTrimming,r=this.FTextAlign,this.FEnabled?this===this.TabSet().FActiveTab?t.FFont.SetColor(this.FActiveTextColor):this===this.TabSet().FDownTab?t.FFont.SetColor(this.FDownTextColor):this===this.TabSet().FHoverTab?t.FFont.SetColor(this.FHoverTextColor):t.FFont.SetColor(this.FTextColor):t.FFont.SetColor(this.FDisabledTextColor)),a=0,l=this.FText,h=!0,this.FTabSet.DoBeforeDrawTabText(t,this.GetIndex(),pas["WEBLib.TMSFNCTypes"].TRectF.$clone(s),l,{get:function(){return h},set:function(t){h=t}}),h){var F=this.TabSet().FLayout.FPosition;1===F||2===F?t.DrawText$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(s),l,o,r,a,n,0,-1,-1,!0,!1,-1,-1):0===F?t.DrawText$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(s),l,o,r,a,n,-90,-1,-1,!0,!1,-1,-1):3===F&&t.DrawText$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(s),l,o,r,a,n,90,-1,-1,!0,!1,-1,-1),this.FTabSet.DoAfterDrawTabText(t,this.GetIndex(),pas["WEBLib.TMSFNCTypes"].TRectF.$clone(s),l)}}finally{t.RestoreState(i,!1)}}},this.DrawFocus=function(t,e){var i=pas["WEBLib.TMSFNCTypes"].TRectF.$new();null!=this.FTabSet&&this.FTabSet.FTabAppearance.FShowFocus&&this.FTabSet.IsFocused()&&this===this.FTabSet.FFocusedTab&&(i.$assign(e.ContentRect),pas["WEBLib.TMSFNCTypes"].InflateRectEx(i,-1,-1),t.DrawFocusRectangle$3(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),this.FTabSet.FTabAppearance.FFocusBorderColor,2))},this.DrawProgress=function(t,e){var i=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),s=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),o=!1;if(null!=this.FTabSet&&0!==this.FProgressKind&&(this.FProgress>0&&this.FProgressMax>0&&0===this.FProgressMode||1===this.FProgressMode)){var n=this.FProgressKind;if(1===n){if(t.FFill.SetKind(0),t.FStroke.Assign(this.FTabSet.FTabAppearance.FProgressStroke),this.FUseDefaultAppearance||t.FStroke.SetColor(this.FProgressColor),t.FStroke.SetWidth(2),i.$assign(e.ProgressRect),pas["WEBLib.TMSFNCTypes"].InflateRectEx(i,-2,-2),o=!0,this.FTabSet.DoBeforeDrawTabProgress(t,this.GetIndex(),pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),this.FProgressMode,this.FProgressKind,this.FAnimMarqueeStartAngle,this.FAnimMarqueeSweepAngle,this.FProgress,this.FProgressMax,{get:function(){return o},set:function(t){o=t}}),o){var r=this.FProgressMode;0===r?t.DrawArc(pas["WEBLib.TMSFNCTypes"].CenterPointEx(i),pas["WEBLib.TMSFNCTypes"].PointF((i.Right-i.Left)/2,(i.Bottom-i.Top)/2),0,360/this.FProgressMax*this.FProgress):1===r&&t.DrawArc(pas["WEBLib.TMSFNCTypes"].CenterPointEx(i),pas["WEBLib.TMSFNCTypes"].PointF((i.Right-i.Left)/2,(i.Bottom-i.Top)/2),this.FAnimMarqueeStartAngle,this.FAnimMarqueeSweepAngle),this.FTabSet.DoAfterDrawTabProgress(t,this.GetIndex(),pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),this.FProgressMode,this.FProgressKind,this.FAnimMarqueeStartAngle,this.FAnimMarqueeSweepAngle,this.FProgress,this.FProgressMax)}}else if(2===n&&(t.FFill.Assign(this.FTabSet.FTabAppearance.FProgressFill),this.FUseDefaultAppearance||t.FFill.SetColor(this.FProgressColor),t.FStroke.Assign(this.FTabSet.FTabAppearance.FProgressStroke),i.$assign(e.ContentRect),pas["WEBLib.TMSFNCTypes"].InflateRectEx(i,-4,-4),o=!0,this.FTabSet.DoBeforeDrawTabProgress(t,this.GetIndex(),pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),this.FProgressMode,this.FProgressKind,this.FAnimMarqueeStartAngle,this.FAnimMarqueeSweepAngle,this.FProgress,this.FProgressMax,{get:function(){return o},set:function(t){o=t}}),o)){var a=this.FTabSet.FLayout.FPosition;if(1===a||2===a){var l=this.FProgressMode;0===l?s.$assign(pas["WEBLib.TMSFNCTypes"].RectF(i.Left,i.Top,i.Left+(i.Right-i.Left)/this.FProgressMax*this.FProgress,i.Bottom)):1===l&&s.$assign(pas["WEBLib.TMSFNCTypes"].RectF(i.Left+(i.Right-i.Left)/360*this.FAnimMarqueeSweepAngle-5,i.Top,i.Left+5+(i.Right-i.Left)/360*this.FAnimMarqueeSweepAngle,i.Bottom)),t.DrawRectangle$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(s),2)}else if(0===a){var h=this.FProgressMode;0===h?s.$assign(pas["WEBLib.TMSFNCTypes"].RectF(i.Left,i.Bottom-(i.Bottom-i.Top)/this.FProgressMax*this.FProgress,i.Right,i.Bottom)):1===h&&s.$assign(pas["WEBLib.TMSFNCTypes"].RectF(i.Left,i.Bottom-(i.Bottom-i.Top)/360*this.FAnimMarqueeSweepAngle,i.Right,i.Bottom)),t.DrawRectangle$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(s),2)}else if(3===a){var F=this.FProgressMode;0===F?s.$assign(pas["WEBLib.TMSFNCTypes"].RectF(i.Left,i.Top,i.Right,i.Bottom-(i.Bottom-i.Top)/this.FProgressMax*this.FProgress)):1===F&&s.$assign(pas["WEBLib.TMSFNCTypes"].RectF(i.Left,i.Top,i.Right,i.Bottom-(i.Bottom-i.Top)/360*this.FAnimMarqueeSweepAngle)),t.DrawRectangle$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(s),2)}this.FTabSet.DoAfterDrawTabProgress(t,this.GetIndex(),pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),this.FProgressMode,this.FProgressKind,this.FAnimMarqueeStartAngle,this.FAnimMarqueeSweepAngle,this.FProgress,this.FProgressMax)}}},this.DrawCloseButton=function(t,e){var i=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),s=0,o=0,n=!1,r=0,a=0;null!=this.FTabSet&&1===this.TabSet().FOptions.FCloseMode&&this.FCloseButton&&(i.$assign(e.CloseButtonRect),i.$assign(pas["WEBLib.TMSFNCTypes"].RectF(pas.System.Int(i.Left),pas.System.Int(i.Top),pas.System.Int(i.Right),pas.System.Int(i.Bottom))),e.Tab===this.TabSet().FDownCloseTab?(t.FFill.Assign(this.TabSet().FTabAppearance.FCloseDownFill),t.FStroke.Assign(this.TabSet().FTabAppearance.FCloseDownStroke)):e.Tab===this.TabSet().FHoverCloseTab?(t.FFill.Assign(this.TabSet().FTabAppearance.FCloseHoverFill),t.FStroke.Assign(this.TabSet().FTabAppearance.FCloseHoverStroke)):(t.FFill.Assign(this.TabSet().FTabAppearance.FCloseFill),t.FStroke.Assign(this.TabSet().FTabAppearance.FCloseStroke)),r=e.Tab===this.TabSet().FDownCloseTab?2:e.Tab===this.TabSet().FHoverCloseTab?1:0,n=!0,this.FTabSet.DoBeforeDrawTabCloseButton(t,this.GetIndex(),pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),r,{get:function(){return n},set:function(t){n=t}}),n&&(0!==t.FFill.FKind&&(s=t.FStroke.FKind,o=t.FStroke.FColor,t.FStroke.SetKind(1),t.FStroke.SetColor(t.FFill.FColor),t.DrawEllipse$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),0),t.FStroke.SetKind(s),t.FStroke.SetColor(o)),a=this.FTabSet.FPaintScaleFactor,pas["WEBLib.TMSFNCTypes"].InflateRectEx(i,-4*a,-4*a),t.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(i.Left,i.Top)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(i.Right,i.Bottom)),0,0),t.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(i.Left,i.Bottom)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(i.Right,i.Top)),0,0),this.FTabSet.DoAfterDrawTabCloseButton(t,this.GetIndex(),pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),r)))},this.DrawBitmap=function(t,e){var i=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),s=!1;null!=this.FTabSet&&this.FBitmapVisible&&(i.$assign(e.BitmapRect),s=!0,this.FTabSet.DoBeforeDrawTabBitmap(t,this.GetIndex(),pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),{get:function(){return s},set:function(t){s=t}}),s&&(this.FEnabled?t.DrawScaledBitmap(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),this.FBitmaps,0,!0,!1,!0,!1):t.DrawScaledBitmap(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),this.FDisabledBitmaps,0,!0,!1,!0,!1),this.FTabSet.DoAfterDrawTabBitmap(t,this.GetIndex(),pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i))))},this.DrawBadge=function(t,e){var i,s=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),o=pas["WEBLib.TMSFNCTypes"].TSizeF.$new(),n=null,r=0,a=!1;if(null!=this.FTabSet&&""!==this.FBadge&&(t.FFont.Assign(this.TabSet().FTabAppearance.FBadgeFont),t.FStroke.Assign(this.TabSet().FTabAppearance.FBadgeStroke),t.FFill.Assign(this.TabSet().FTabAppearance.FBadgeFill),this.FUseDefaultAppearance||(t.FFont.SetColor(this.FBadgeTextColor),t.FFill.SetColor(this.FBadgeColor)),i=this.FBadge,o.$assign(t.CalculateTextSize$1(i)),o.cy=o.cy+4,o.cx=Math.max(o.cy,o.cx+6),this.GetShape()in rtl.createSet(0,4,5,6)?s.$assign(e.Rect):s.$assign(e.ContentRect),!((s.Right-s.Left)/3*2<o.cx))){var l=this.TabSet().FLayout.FPosition;if(1===l?s.$assign(pas["WEBLib.TMSFNCTypes"].RectF(pas.System.Int(s.Right-o.cx/2),pas.System.Int(s.Top-o.cy/2),pas.System.Int(s.Right+o.cx/2),pas.System.Int(s.Top+o.cy/2))):2===l?s.$assign(pas["WEBLib.TMSFNCTypes"].RectF(pas.System.Int(s.Right-o.cx/2),pas.System.Int(s.Bottom-o.cy/2),pas.System.Int(s.Right+o.cx/2),pas.System.Int(s.Bottom+o.cy/2))):0===l?s.$assign(pas["WEBLib.TMSFNCTypes"].RectF(pas.System.Int(s.Left-o.cy/2),pas.System.Int(s.Top-o.cx/2),pas.System.Int(s.Left+o.cy/2),pas.System.Int(s.Top+o.cx/2))):3===l&&s.$assign(pas["WEBLib.TMSFNCTypes"].RectF(pas.System.Int(s.Right-o.cy/2),pas.System.Int(s.Bottom-o.cx/2),pas.System.Int(s.Right+o.cy/2),pas.System.Int(s.Bottom+o.cx/2))),a=!0,this.FTabSet.DoBeforeDrawTabBadge(t,this.GetIndex(),pas["WEBLib.TMSFNCTypes"].TRectF.$clone(s),i,{get:function(){return a},set:function(t){a=t}}),a){var h=this.TabSet().FLayout.FPosition;r=1===h||2===h?(s.Bottom-s.Top)/2:0===h||3===h?(s.Right-s.Left)/2:0,(n=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsPath.$create("Create$1")).AddArc(pas["WEBLib.TMSFNCTypes"].PointF(s.Left+r,s.Top+r),pas["WEBLib.TMSFNCTypes"].PointF(r,r),180,90),n.AddArc(pas["WEBLib.TMSFNCTypes"].PointF(s.Right-r,s.Top+r),pas["WEBLib.TMSFNCTypes"].PointF(r,r),-90,90),n.AddArc(pas["WEBLib.TMSFNCTypes"].PointF(s.Right-r,s.Bottom-r),pas["WEBLib.TMSFNCTypes"].PointF(r,r),0,90),n.AddArc(pas["WEBLib.TMSFNCTypes"].PointF(s.Left+r,s.Bottom-r),pas["WEBLib.TMSFNCTypes"].PointF(r,r),-270,90),n.ClosePath(),t.DrawPath(n,0);var F=this.TabSet().FLayout.FPosition;1===F||2===F?t.DrawText$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(s),i,!1,0,0,0,0,-1,-1,!0,!1,-1,-1):0===F?t.DrawText$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(s),i,!1,0,0,0,-90,-1,-1,!0,!1,-1,-1):3===F&&t.DrawText$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(s),i,!1,0,0,0,90,-1,-1,!0,!1,-1,-1),n=rtl.freeLoc(n),this.FTabSet.DoAfterDrawTabBadge(t,this.GetIndex(),pas["WEBLib.TMSFNCTypes"].TRectF.$clone(s),i)}}},this.GetInsertShapePath=function(t){var e,i=null,s=pas["WEBLib.TMSFNCTypes"].TRectF.$new();return s.$assign(t),e=this.TabSet().FTabAppearance.FShapeRounding,(i=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsPath.$create("Create$1")).AddArc(pas["WEBLib.TMSFNCTypes"].PointF(s.Left+e,s.Top+e),pas["WEBLib.TMSFNCTypes"].PointF(e,e),180,90),i.AddArc(pas["WEBLib.TMSFNCTypes"].PointF(s.Right-e,s.Top+e),pas["WEBLib.TMSFNCTypes"].PointF(e,e),-90,90),i.AddArc(pas["WEBLib.TMSFNCTypes"].PointF(s.Right-e,s.Bottom-e),pas["WEBLib.TMSFNCTypes"].PointF(e,e),0,90),i.AddArc(pas["WEBLib.TMSFNCTypes"].PointF(s.Left+e,s.Bottom-e),pas["WEBLib.TMSFNCTypes"].PointF(e,e),-270,90),i.ClosePath(),i},this.GetShapePath=function(t){var e,i,s=null,o=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),n=0,r=0;if(o.$assign(t),n=this.GetShape(),0===(e=this.TabSet().FTabAppearance.FShapeSlope)&&n in rtl.createSet(1,2,3)&&(n=0),i=this.TabSet().FTabAppearance.FShapeRounding,r=0,e>0){var a=this.TabSet().FLayout.FPosition;1===a||2===a?r=pas.Math.RadToDeg(Math.asin((o.Bottom-o.Top)/Math.sqrt(Math.pow(o.Bottom-o.Top,2)+Math.pow(e,2)))):0!==a&&3!==a||(r=pas.Math.RadToDeg(Math.asin((o.Right-o.Left)/Math.sqrt(Math.pow(o.Right-o.Left,2)+Math.pow(e,2)))))}var l=this.TabSet().FLayout.FPosition;if(1===l){(s=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsPath.$create("Create$1")).MoveTo(pas["WEBLib.TMSFNCTypes"].PointF(o.Left,o.Bottom));var h=n;0===h||2===h||5===h?s.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(o.Left,o.Top)):1===h||3===h?(s.AddArc(pas["WEBLib.TMSFNCTypes"].PointF(o.Left,o.Bottom-i),pas["WEBLib.TMSFNCTypes"].PointF(i,i),-270,-r),s.AddArc(pas["WEBLib.TMSFNCTypes"].PointF(o.Left+e+i,o.Top+i),pas["WEBLib.TMSFNCTypes"].PointF(i,i),-r-90,r)):4!==h&&6!==h||(s.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(o.Left,o.Top+i)),s.AddArc(pas["WEBLib.TMSFNCTypes"].PointF(o.Left+i,o.Top+i),pas["WEBLib.TMSFNCTypes"].PointF(i,i),180,90));var F=n;0===F||1===F||4===F?s.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(o.Right,o.Top)):2===F||3===F?(s.AddArc(pas["WEBLib.TMSFNCTypes"].PointF(o.Right-e-i,o.Top+i),pas["WEBLib.TMSFNCTypes"].PointF(i,i),270,r),s.AddArc(pas["WEBLib.TMSFNCTypes"].PointF(o.Right,o.Bottom-i),pas["WEBLib.TMSFNCTypes"].PointF(i,i),r+90,-r)):5!==F&&6!==F||(s.AddArc(pas["WEBLib.TMSFNCTypes"].PointF(o.Right-i,o.Top+i),pas["WEBLib.TMSFNCTypes"].PointF(i,i),270,90),s.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(o.Right,o.Top+i))),s.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(o.Right,o.Bottom)),s.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(o.Left,o.Bottom)),s.ClosePath()}else if(2===l){(s=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsPath.$create("Create$1")).MoveTo(pas["WEBLib.TMSFNCTypes"].PointF(o.Left,o.Top));var p=n;0===p||2===p||5===p?s.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(o.Left,o.Bottom)):1===p||3===p?(s.AddArc(pas["WEBLib.TMSFNCTypes"].PointF(o.Left,o.Top+i),pas["WEBLib.TMSFNCTypes"].PointF(i,i),270,r),s.AddArc(pas["WEBLib.TMSFNCTypes"].PointF(o.Left+e+i,o.Bottom-i),pas["WEBLib.TMSFNCTypes"].PointF(i,i),r-270,-r)):4!==p&&6!==p||(s.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(o.Left,o.Bottom-i)),s.AddArc(pas["WEBLib.TMSFNCTypes"].PointF(o.Left+i,o.Bottom-i),pas["WEBLib.TMSFNCTypes"].PointF(i,i),-180,-90));var c=n;0===c||1===c||4===c?s.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(o.Right,o.Bottom)):2===c||3===c?(s.AddArc(pas["WEBLib.TMSFNCTypes"].PointF(o.Right-e-i,o.Bottom-i),pas["WEBLib.TMSFNCTypes"].PointF(i,i),-270,-r),s.AddArc(pas["WEBLib.TMSFNCTypes"].PointF(o.Right,o.Top+i),pas["WEBLib.TMSFNCTypes"].PointF(i,i),270-r,r)):5!==c&&6!==c||(s.AddArc(pas["WEBLib.TMSFNCTypes"].PointF(o.Right-i,o.Bottom-i),pas["WEBLib.TMSFNCTypes"].PointF(i,i),-270,-90),s.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(o.Right,o.Bottom-i))),s.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(o.Right,o.Top)),s.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(o.Left,o.Top)),s.ClosePath()}else if(0===l){(s=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsPath.$create("Create$1")).MoveTo(pas["WEBLib.TMSFNCTypes"].PointF(o.Right,o.Bottom));var u=n;0===u||2===u||5===u?s.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(o.Left,o.Bottom)):1===u||3===u?(s.AddArc(pas["WEBLib.TMSFNCTypes"].PointF(o.Right-i,o.Bottom),pas["WEBLib.TMSFNCTypes"].PointF(i,i),0,-r),s.AddArc(pas["WEBLib.TMSFNCTypes"].PointF(o.Left+i,o.Bottom-e-i),pas["WEBLib.TMSFNCTypes"].PointF(i,i),180-r,r)):4!==u&&6!==u||(s.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(o.Left+i,o.Bottom)),s.AddArc(pas["WEBLib.TMSFNCTypes"].PointF(o.Left+i,o.Bottom-i),pas["WEBLib.TMSFNCTypes"].PointF(i,i),90,90));var C=n;0===C||1===C||4===C?s.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(o.Left,o.Top)):2===C||3===C?(s.AddArc(pas["WEBLib.TMSFNCTypes"].PointF(o.Left+i,o.Top+e+i),pas["WEBLib.TMSFNCTypes"].PointF(i,i),180,r),s.AddArc(pas["WEBLib.TMSFNCTypes"].PointF(o.Right-i,o.Top),pas["WEBLib.TMSFNCTypes"].PointF(i,i),r,-r)):5!==C&&6!==C||(s.AddArc(pas["WEBLib.TMSFNCTypes"].PointF(o.Left+i,o.Top+i),pas["WEBLib.TMSFNCTypes"].PointF(i,i),180,90),s.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(o.Left+i,o.Top))),s.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(o.Right,o.Top)),s.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(o.Right,o.Bottom)),s.ClosePath()}else if(3===l){(s=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsPath.$create("Create$1")).MoveTo(pas["WEBLib.TMSFNCTypes"].PointF(o.Left,o.Top));var T=n;0===T||2===T||5===T?s.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(o.Right,o.Top)):1===T||3===T?(s.AddArc(pas["WEBLib.TMSFNCTypes"].PointF(o.Left+i,o.Top),pas["WEBLib.TMSFNCTypes"].PointF(i,i),-180,-r),s.AddArc(pas["WEBLib.TMSFNCTypes"].PointF(o.Right-i,o.Top+e+i),pas["WEBLib.TMSFNCTypes"].PointF(i,i),-r,r)):4!==T&&6!==T||(s.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(o.Right-i,o.Top)),s.AddArc(pas["WEBLib.TMSFNCTypes"].PointF(o.Right-i,o.Top+i),pas["WEBLib.TMSFNCTypes"].PointF(i,i),-90,90));var S=n;0===S||1===S||4===S?s.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(o.Right,o.Bottom)):2===S||3===S?(s.AddArc(pas["WEBLib.TMSFNCTypes"].PointF(o.Right-i,o.Bottom-e-i),pas["WEBLib.TMSFNCTypes"].PointF(i,i),0,r),s.AddArc(pas["WEBLib.TMSFNCTypes"].PointF(o.Left+i,o.Bottom),pas["WEBLib.TMSFNCTypes"].PointF(i,i),-180+r,-r)):5!==S&&6!==S||(s.AddArc(pas["WEBLib.TMSFNCTypes"].PointF(o.Right-i,o.Bottom-i),pas["WEBLib.TMSFNCTypes"].PointF(i,i),0,90),s.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(o.Right-i,o.Bottom))),s.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(o.Left,o.Bottom)),s.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(o.Left,o.Top)),s.ClosePath()}else s=null;return s},this.GetBitmapRect=function(t){var e=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),i=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),s=pas["WEBLib.TMSFNCTypes"].TRectF.$new();i.$assign(t),s.$assign(this.GetProgressRect(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i))),e.$assign(i);var o=this.TabSet().FLayout.FPosition;return 1===o||2===o?this.FBitmapVisible?this.FTextVisible&&""!==this.FText?this.FTextVisible&&""!==this.FText&&e.$assign(pas["WEBLib.TMSFNCTypes"].RectF(s.Right+2,i.Top+2,s.Right+this.FBitmapSize+2,i.Bottom-2)):e.$assign(pas["WEBLib.TMSFNCTypes"].RectF(s.Right+2,i.Top+2,i.Right-2,i.Bottom-2)):e.$assign(pas["WEBLib.TMSFNCTypes"].RectF(s.Right,i.Top,s.Right,i.Bottom)):0===o?this.FBitmapVisible?this.FTextVisible&&""!==this.FText?this.FTextVisible&&""!==this.FText&&e.$assign(pas["WEBLib.TMSFNCTypes"].RectF(i.Left+2,s.Top-this.FBitmapSize-2,i.Right-2,s.Top-2)):e.$assign(pas["WEBLib.TMSFNCTypes"].RectF(i.Left+2,i.Top+2,i.Right-2,s.Bottom-2)):e.$assign(pas["WEBLib.TMSFNCTypes"].RectF(i.Left,s.Top,i.Right,s.Top)):3===o&&(this.FBitmapVisible?this.FTextVisible&&""!==this.FText?this.FTextVisible&&""!==this.FText&&e.$assign(pas["WEBLib.TMSFNCTypes"].RectF(i.Left+2,s.Bottom+2,i.Right-2,s.Bottom+this.FBitmapSize+2)):e.$assign(pas["WEBLib.TMSFNCTypes"].RectF(i.Left+2,s.Top+2,i.Right-2,i.Bottom-2)):e.$assign(pas["WEBLib.TMSFNCTypes"].RectF(i.Left,s.Bottom,i.Right,s.Bottom))),e},this.GetTextRect=function(t){var e=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),i=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),s=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),o=pas["WEBLib.TMSFNCTypes"].TRectF.$new();o.$assign(t),i.$assign(this.GetBitmapRect(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(t))),s.$assign(this.GetCloseButtonRect(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(t)));var n=this.TabSet().FLayout.FPosition;return 1===n||2===n?this.FStretchText?e.$assign(pas["WEBLib.TMSFNCTypes"].RectF(o.Left+2,o.Top+2,o.Right-2,o.Bottom-2)):e.$assign(pas["WEBLib.TMSFNCTypes"].RectF(i.Right+2,o.Top+2,s.Left-4,o.Bottom-2)):0===n?this.FStretchText?e.$assign(pas["WEBLib.TMSFNCTypes"].RectF(o.Left+2,o.Top+2,o.Right-2,o.Bottom-2)):e.$assign(pas["WEBLib.TMSFNCTypes"].RectF(o.Left+2,s.Bottom+4,o.Right-2,i.Top-2)):3===n&&(this.FStretchText?e.$assign(pas["WEBLib.TMSFNCTypes"].RectF(o.Left+2,o.Top+2,o.Right-2,o.Bottom-2)):e.$assign(pas["WEBLib.TMSFNCTypes"].RectF(o.Left+2,i.Bottom+2,o.Right-2,s.Top-4))),e},this.GetProgressRect=function(t){var e=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),i=0,s=this.FTabSet.FLayout.FPosition;if(0===s?e.$assign(pas["WEBLib.TMSFNCTypes"].RectF(t.Left,t.Bottom,t.Right,t.Bottom)):1===s||2===s?e.$assign(pas["WEBLib.TMSFNCTypes"].RectF(t.Left,t.Top,t.Left,t.Bottom)):3===s&&e.$assign(pas["WEBLib.TMSFNCTypes"].RectF(t.Left,t.Top,t.Right,t.Top)),1===this.FProgressKind){i=this.TabSet().FTabAppearance.FProgressCircularSize+4;var o=this.FTabSet.FLayout.FPosition;1===o||2===o?e.$assign(pas["WEBLib.TMSFNCTypes"].RectF(e.Left+4,e.Top+(e.Bottom-e.Top-i)/2,e.Left+i+4,e.Top+(e.Bottom-e.Top-i)/2+i)):0===o?e.$assign(pas["WEBLib.TMSFNCTypes"].RectF(e.Left+(e.Right-e.Left-i)/2,e.Bottom-i-4,e.Left+(e.Right-e.Left-i)/2+i,e.Bottom-4)):3===o&&e.$assign(pas["WEBLib.TMSFNCTypes"].RectF(e.Left+(e.Right-e.Left-i)/2,e.Top+4,e.Left+(e.Right-e.Left-i)/2+i,e.Top+i+4))}return e},this.GetCloseButtonRect=function(t){var e=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),i=0,s=this.FTabSet.FLayout.FPosition;if(0===s?e.$assign(pas["WEBLib.TMSFNCTypes"].RectF(t.Left,t.Top,t.Right,t.Top)):1===s||2===s?e.$assign(pas["WEBLib.TMSFNCTypes"].RectF(t.Right,t.Top,t.Right,t.Bottom)):3===s&&e.$assign(pas["WEBLib.TMSFNCTypes"].RectF(t.Left,t.Bottom,t.Right,t.Bottom)),1===this.FTabSet.FOptions.FCloseMode&&this.FCloseButton){i=this.FTabSet.FTabAppearance.FCloseSize;var o=this.FTabSet.FLayout.FPosition;1===o||2===o?e.$assign(pas["WEBLib.TMSFNCTypes"].RectF(e.Right-i-4,e.Top+(e.Bottom-e.Top-i)/2,e.Right-4,e.Top+(e.Bottom-e.Top-i)/2+i)):0===o?e.$assign(pas["WEBLib.TMSFNCTypes"].RectF(e.Left+(e.Right-e.Left-i)/2,e.Top+4,e.Left+(e.Right-e.Left-i)/2+i,e.Top+i+4)):3===o&&e.$assign(pas["WEBLib.TMSFNCTypes"].RectF(e.Left+(e.Right-e.Left-i)/2,e.Bottom-i-4,e.Left+(e.Right-e.Left-i)/2+i,e.Bottom-4))}return e},this.GetFriendlyName=function(){var t="";return""===(t=this.GetStrippedHTMLText())&&(t="Tab "+pas.SysUtils.IntToStr(this.GetIndex())),t},this.GetStrippedHTMLText=function(){var t;return t=this.FText,this.IsHTML()?pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.HTMLStrip(t):t},this.IsHTML=function(){return pas.System.Pos("</",this.FText)>0||pas.System.Pos("/>",this.FText)>0||pas.System.Pos("<BR>",pas.SysUtils.UpperCase(this.FText))>0},this.GetFixedRect=function(t,e){var i=pas["WEBLib.TMSFNCTypes"].TRectF.$new();if(i.$assign(pas["WEBLib.TMSFNCTypes"].EmptyRect()),null==this.TabSet())return i;i.$assign(t);var s=this.TabSet().FLayout.FPosition;return 1===s||2===s?e.First?i.$assign(pas["WEBLib.TMSFNCTypes"].RectF(pas.System.Int(i.Left)+.5,pas.System.Int(i.Top)+.5,pas.System.Int(i.Right)+.5,pas.System.Int(i.Bottom)-.5)):e.Last?i.$assign(pas["WEBLib.TMSFNCTypes"].RectF(pas.System.Int(i.Left)-.5,pas.System.Int(i.Top)+.5,pas.System.Int(i.Right)-.5,pas.System.Int(i.Bottom)-.5)):i.$assign(pas["WEBLib.TMSFNCTypes"].RectF(pas.System.Int(i.Left)-.5,pas.System.Int(i.Top)+.5,pas.System.Int(i.Right)+.5,pas.System.Int(i.Bottom)-.5)):0!==s&&3!==s||(e.First?i.$assign(pas["WEBLib.TMSFNCTypes"].RectF(pas.System.Int(i.Left)+.5,pas.System.Int(i.Top)+.5,pas.System.Int(i.Right)-.5,pas.System.Int(i.Bottom)+.5)):e.Last?i.$assign(pas["WEBLib.TMSFNCTypes"].RectF(pas.System.Int(i.Left)+.5,pas.System.Int(i.Top)-.5,pas.System.Int(i.Right)-.5,pas.System.Int(i.Bottom)-.5)):i.$assign(pas["WEBLib.TMSFNCTypes"].RectF(pas.System.Int(i.Left)+.5,pas.System.Int(i.Top)-.5,pas.System.Int(i.Right)-.5,pas.System.Int(i.Bottom)+.5))),i},this.Create$1=function(e){return pas.Classes.TCollectionItem.Create$1.apply(this,arguments),null!=this.FCollection&&(this.FTabSet=rtl.as(this.FCollection,t.TTMSFNCTabSetTabs).TabSet()),null!=this.FTabSet&&this.FTabSet.IsDesignTime()&&(this.FText="Tab Item "+pas.SysUtils.IntToStr(this.GetIndex())),this.FEnabled=!0,this.FProgress=0,this.FProgressMax=100,this.FProgressMode=0,this.FProgressKind=0,this.FUseDefaultAppearance=!1,this.FTextColor=0,this.FActiveTextColor=0,this.FDisabledTextColor=0,this.FBadgeColor=42495,this.FBadgeTextColor=139,this.FDownTextColor=0,this.FHoverTextColor=0,this.FColor=16316397,this.FProgressColor=16297243,this.FActiveColor=16777215,this.FDisabledColor=13882323,this.FDownColor=15655897,this.FHoverColor=16313827,this.FWordWrapping=!1,this.FTextAlign=0,this.FTrimming=1,this.FCloseButton=!0,this.FWidth=-1,this.FHeight=-1,this.FStretchText=!1,this.FBitmapVisible=!1,this.FBitmapSize=24,this.FTextVisible=!0,this.FShape=3,this.FVisible=!0,this.FBitmaps=pas["WEBLib.TMSFNCTypes"].TTMSFNCScaledBitmaps.$create("Create$3",[this.FTabSet]),this.FBitmaps.FOnChange=rtl.createCallback(this,"BitmapsChanged"),this.FDisabledBitmaps=pas["WEBLib.TMSFNCTypes"].TTMSFNCScaledBitmaps.$create("Create$3",[this.FTabSet]),this.FDisabledBitmaps.FOnChange=rtl.createCallback(this,"BitmapsChanged"),this.UpdateTab(),this},this.Destroy=function(){var t=null;rtl.free(this,"FDisabledBitmaps"),rtl.free(this,"FBitmaps"),null!=(t=this.TabSet())&&t.FActiveTab===this&&(t.FActiveTab=null),pas.Classes.TCollectionItem.Destroy.call(this),this.UpdateTab()},this.TabSet=function(){return this.FTabSet},this.GetShape=function(){return this.FUseDefaultAppearance?this.TabSet().FTabAppearance.FShape:this.FShape},this.GetAutoSize=function(){var t,e=0,i=null,s=null,o=pas["WEBLib.TMSFNCTypes"].TSizeF.$new(),n=0;if(e=0,n=1,null!=(t=this.TabSet())){i=pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.$create("CreateBitmapCanvas",[1,1,t.FNativeCanvas,!0]),t.FNativeCanvas||i.BeginScene();try{s=this.GetBitmap(),""!==this.FText&&this.FTextVisible&&(i.SetFont(t.FTabAppearance.FFont),o.$assign(i.CalculateTextSize(this.FText,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(0,0,1e4,1e4)),!0,!0)),e=e+o.cx+6,(0!==t.FTabAppearance.FTrimming&&this.FUseDefaultAppearance||0!==this.FTrimming&&!this.FUseDefaultAppearance)&&(e+=2)),null!=s&&this.FBitmapVisible&&(e=e+this.FBitmapSize+4),1===this.FProgressKind&&(e=e+t.FTabAppearance.FProgressCircularSize+8),1===t.FOptions.FCloseMode&&this.FCloseButton&&(e=e+t.FTabAppearance.FCloseSize+4)}finally{t.FNativeCanvas||i.EndScene(),i=rtl.freeLoc(i)}n=t.FPaintScaleFactor}return e=Math.max(30*n,e)},this.GetBitmap=function(){return this.FEnabled?pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.GetScaledBitmap(this.FBitmaps,0,this.GetBitmapContainer()):pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.GetScaledBitmap(this.FDisabledBitmaps,0,this.GetBitmapContainer())},this.Assign=function(e){t.TTMSFNCTabSetTab.isPrototypeOf(e)&&(this.FTag=rtl.as(e,t.TTMSFNCTabSetTab).FTag,this.FText=rtl.as(e,t.TTMSFNCTabSetTab).FText,this.FTrimming=rtl.as(e,t.TTMSFNCTabSetTab).FTrimming,this.FWordWrapping=rtl.as(e,t.TTMSFNCTabSetTab).FWordWrapping,this.FTextAlign=rtl.as(e,t.TTMSFNCTabSetTab).FTextAlign,this.FTextColor=rtl.as(e,t.TTMSFNCTabSetTab).FTextColor,this.FActiveTextColor=rtl.as(e,t.TTMSFNCTabSetTab).FActiveTextColor,this.FDisabledTextColor=rtl.as(e,t.TTMSFNCTabSetTab).FDisabledTextColor,this.FDownTextColor=rtl.as(e,t.TTMSFNCTabSetTab).FDownTextColor,this.FHoverTextColor=rtl.as(e,t.TTMSFNCTabSetTab).FHoverTextColor,this.FColor=rtl.as(e,t.TTMSFNCTabSetTab).FColor,this.FProgressColor=rtl.as(e,t.TTMSFNCTabSetTab).FProgressColor,this.FActiveColor=rtl.as(e,t.TTMSFNCTabSetTab).FActiveColor,this.FDisabledColor=rtl.as(e,t.TTMSFNCTabSetTab).FDisabledColor,this.FDownColor=rtl.as(e,t.TTMSFNCTabSetTab).FDownColor,this.FHoverColor=rtl.as(e,t.TTMSFNCTabSetTab).FHoverColor,this.FEnabled=rtl.as(e,t.TTMSFNCTabSetTab).FEnabled,this.FVisible=rtl.as(e,t.TTMSFNCTabSetTab).FVisible,this.FBitmaps.Assign(rtl.as(e,t.TTMSFNCTabSetTab).FBitmaps),this.FDisabledBitmaps.Assign(rtl.as(e,t.TTMSFNCTabSetTab).FDisabledBitmaps),this.FWidth=rtl.as(e,t.TTMSFNCTabSetTab).FWidth,this.FBitmapVisible=rtl.as(e,t.TTMSFNCTabSetTab).FBitmapVisible,this.FBitmapSize=rtl.as(e,t.TTMSFNCTabSetTab).FBitmapSize,this.FUseDefaultAppearance=rtl.as(e,t.TTMSFNCTabSetTab).FUseDefaultAppearance,this.FTextVisible=rtl.as(e,t.TTMSFNCTabSetTab).FTextVisible,this.FStretchText=rtl.as(e,t.TTMSFNCTabSetTab).FStretchText,this.FShape=rtl.as(e,t.TTMSFNCTabSetTab).FShape,this.FProgress=rtl.as(e,t.TTMSFNCTabSetTab).FProgress,this.FProgressMax=rtl.as(e,t.TTMSFNCTabSetTab).FProgressMax,this.FProgressMode=rtl.as(e,t.TTMSFNCTabSetTab).FProgressMode,this.FProgressKind=rtl.as(e,t.TTMSFNCTabSetTab).FProgressKind,this.FCloseButton=rtl.as(e,t.TTMSFNCTabSetTab).FCloseButton,this.FBadge=rtl.as(e,t.TTMSFNCTabSetTab).FBadge,this.FBadgeColor=rtl.as(e,t.TTMSFNCTabSetTab).FBadgeColor,this.FBadgeTextColor=rtl.as(e,t.TTMSFNCTabSetTab).FBadgeTextColor,this.FHint=rtl.as(e,t.TTMSFNCTabSetTab).FHint)};var e=this.$rtti;e.addProperty("Text",2,rtl.string,"FText","SetText"),e.addProperty("Badge",2,rtl.string,"FBadge","SetBadge"),e.addProperty("Hint",2,rtl.string,"FHint","SetHint"),e.addProperty("StretchText",2,rtl.boolean,"FStretchText","SetStretchText",{Default:!1}),e.addProperty("TextVisible",2,rtl.boolean,"FTextVisible","SetTextVisible",{Default:!0}),e.addProperty("TabVisible",2,rtl.boolean,"FVisible","SetVisible",{Default:!0}),e.addProperty("Bitmaps",2,pas["WEBLib.TMSFNCTypes"].$rtti.TTMSFNCScaledBitmaps,"FBitmaps","SetBitmaps"),e.addProperty("DisabledBitmaps",2,pas["WEBLib.TMSFNCTypes"].$rtti.TTMSFNCScaledBitmaps,"FDisabledBitmaps","SetDisabledBitmaps"),e.addProperty("BitmapVisible",2,rtl.boolean,"FBitmapVisible","SetBitmapVisible",{Default:!1}),e.addProperty("BitmapSize",14,rtl.double,"FBitmapSize","SetBitmapSize",{stored:"IsBitmapSizeStored"}),e.addProperty("WordWrapping",2,rtl.boolean,"FWordWrapping","SetWordWrapping",{Default:!1}),e.addProperty("Trimming",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsTextTrimming,"FTrimming","SetTrimming",{Default:pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsTextTrimming.gttCharacter}),e.addProperty("TextAlign",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsTextAlign,"FTextAlign","SetTextAlign",{Default:pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsTextAlign.gtaCenter}),e.addProperty("TextColor",2,pas["WEBLib.Graphics"].$rtti.TColor,"FTextColor","SetTextColor",{Default:0}),e.addProperty("ActiveTextColor",2,pas["WEBLib.Graphics"].$rtti.TColor,"FActiveTextColor","SetActiveTextColor",{Default:0}),e.addProperty("HoverTextColor",2,pas["WEBLib.Graphics"].$rtti.TColor,"FHoverTextColor","SetHoverTextColor",{Default:0}),e.addProperty("DownTextColor",2,pas["WEBLib.Graphics"].$rtti.TColor,"FDownTextColor","SetDownTextColor",{Default:0}),e.addProperty("DisabledTextColor",2,pas["WEBLib.Graphics"].$rtti.TColor,"FDisabledTextColor","SetDisabledTextColor",{Default:0}),e.addProperty("Color",2,pas["WEBLib.Graphics"].$rtti.TColor,"FColor","SetColor",{Default:16316397}),e.addProperty("ProgressColor",2,pas["WEBLib.Graphics"].$rtti.TColor,"FProgressColor","SetProgressColor",{Default:16297243}),e.addProperty("ActiveColor",2,pas["WEBLib.Graphics"].$rtti.TColor,"FActiveColor","SetActiveColor",{Default:16777215}),e.addProperty("HoverColor",2,pas["WEBLib.Graphics"].$rtti.TColor,"FHoverColor","SetHoverColor",{Default:16313827}),e.addProperty("DownColor",2,pas["WEBLib.Graphics"].$rtti.TColor,"FDownColor","SetDownColor",{Default:15655897}),e.addProperty("DisabledColor",2,pas["WEBLib.Graphics"].$rtti.TColor,"FDisabledColor","SetDisabledColor",{Default:13882323}),e.addProperty("Enabled",2,rtl.boolean,"FEnabled","SetEnabled",{Default:!0}),e.addProperty("Visible",2,rtl.boolean,"FVisible","SetVisible",{Default:!0}),e.addProperty("UseDefaultAppearance",2,rtl.boolean,"FUseDefaultAppearance","SetUseDefaultAppearance",{Default:!1}),e.addProperty("Width",14,rtl.double,"FWidth","SetWidth",{stored:"IsWidthStored"}),e.addProperty("Shape",2,t.$rtti.TTMSFNCTabSetTabShape,"FShape","SetShape",{Default:t.TTMSFNCTabSetTabShape.tsPyramid}),e.addProperty("Tag",0,rtl.nativeint,"FTag","FTag",{Default:0}),e.addProperty("Progress",14,rtl.double,"FProgress","SetProgress",{stored:"IsProgressStored"}),e.addProperty("ProgressMax",14,rtl.double,"FProgressMax","SetProgressMax",{stored:"IsProgressMaxStored"}),e.addProperty("ProgressMode",2,t.$rtti.TTMSFNCTabSetTabProgressMode,"FProgressMode","SetProgressMode",{Default:t.TTMSFNCTabSetTabProgressMode.tpmNormal}),e.addProperty("ProgressKind",2,t.$rtti.TTMSFNCTabSetTabProgressKind,"FProgressKind","SetProgressKind",{Default:t.TTMSFNCTabSetTabProgressKind.tpkNone}),e.addProperty("CloseButton",2,rtl.boolean,"FCloseButton","SetCloseButton",{Default:!0}),e.addProperty("BadgeTextColor",2,pas["WEBLib.Graphics"].$rtti.TColor,"FBadgeTextColor","SetBadgeTextColor",{Default:139}),e.addProperty("BadgeColor",2,pas["WEBLib.Graphics"].$rtti.TColor,"FBadgeColor","SetBadgeColor",{Default:42495})})),rtl.createClass(this,"TTMSFNCTabSetTabs",pas["WEBLib.TMSFNCTypes"].TTMSFNCOwnedCollection,(function(){this.$init=function(){pas["WEBLib.TMSFNCTypes"].TTMSFNCOwnedCollection.$init.call(this),this.FTabSet=null},this.$final=function(){this.FTabSet=void 0,pas["WEBLib.TMSFNCTypes"].TTMSFNCOwnedCollection.$final.call(this)},this.GetTab=function(t){return this.GetItem(t)},this.GetTabClass=function(){return t.TTMSFNCTabSetTab},this.TabSet=function(){return this.FTabSet},this.Create$3=function(t){return pas.Classes.TOwnedCollection.Create$2.call(this,t,this.GetTabClass()),this.FTabSet=t,this},this.Add$1=function(){return pas.Classes.TCollection.Add.call(this)},this.Clear$1=function(){var t=null,e=null;if(null!=(t=this.TabSet())&&(t.BeginUpdate(),t.SetActiveTabIndex(-1)),this.GetCount()>0)for(;this.GetCount()>0;)e=this.GetItem(this.GetCount()-1),e=rtl.freeLoc(e);null!=t&&t.EndUpdate()}})),rtl.createClass(this,"TTMSFNCTabSetTabSize",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FTabSet=null,this.FMode=0,this.FWidth=0,this.FHeight=0,this.FSpacing=0,this.FMargins=null,this.FOnChange=null},this.$final=function(){this.FTabSet=void 0,this.FMargins=void 0,this.FOnChange=void 0,pas.Classes.TPersistent.$final.call(this)},this.IsHeightStored=function(){return 22!==this.FHeight},this.IsWidthStored=function(){return 100!==this.FWidth},this.SetHeight=function(t){this.FHeight!==t&&(this.FHeight=t,this.UpdateTabs())},this.SetMode=function(t){this.FMode!==t&&(this.FMode=t,this.UpdateTabs())},this.SetWidth=function(t){this.FWidth!==t&&(this.FWidth=t,this.UpdateTabs())},this.IsSpacingStored=function(){return 0!==this.FSpacing},this.SetMargins=function(t){this.FMargins.Assign(t)},this.SetSpacing=function(t){this.FSpacing!==t&&(this.FSpacing=t,this.UpdateTabs())},this.UpdateTabs=function(){null!=this.FOnChange&&this.FOnChange(this),null!=this.FTabSet&&this.FTabSet.UpdateTabs(!1,!1)},this.MarginsChanged=function(t){this.UpdateTabs()},this.Create$1=function(t){return this.FTabSet=t,this.FWidth=100,this.FHeight=22,this.FSpacing=0,this.FMode=3,this.FMargins=pas["WEBLib.TMSFNCTypes"].TTMSFNCMargins.$create("Create$1"),null!=this.FTabSet&&this.FTabSet.IsDesignTime()&&(this.FMargins.SetLeft(8),this.FMargins.SetTop(8),this.FMargins.SetRight(8),this.FMargins.SetBottom(8)),this.FMargins.FOnChange=rtl.createCallback(this,"MarginsChanged"),this},this.Destroy=function(){rtl.free(this,"FMargins"),pas.System.TObject.Destroy.call(this)},this.Assign=function(e){t.TTMSFNCTabSetTabSize.isPrototypeOf(e)&&(this.FMode=rtl.as(e,t.TTMSFNCTabSetTabSize).FMode,this.FWidth=rtl.as(e,t.TTMSFNCTabSetTabSize).FWidth,this.FHeight=rtl.as(e,t.TTMSFNCTabSetTabSize).FHeight,this.FMargins.Assign(rtl.as(e,t.TTMSFNCTabSetTabSize).FMargins),this.FSpacing=rtl.as(e,t.TTMSFNCTabSetTabSize).FSpacing)};var e=this.$rtti;e.addProperty("Mode",2,t.$rtti.TTMSFNCTabSetTabSizeMode,"FMode","SetMode",{Default:t.TTMSFNCTabSetTabSizeMode.tsmAutoTabSize}),e.addProperty("Width",14,rtl.double,"FWidth","SetWidth",{stored:"IsWidthStored"}),e.addProperty("Height",14,rtl.double,"FHeight","SetHeight",{stored:"IsHeightStored"}),e.addProperty("Margins",2,pas["WEBLib.TMSFNCTypes"].$rtti.TTMSFNCMargins,"FMargins","SetMargins"),e.addProperty("Spacing",14,rtl.double,"FSpacing","SetSpacing",{stored:"IsSpacingStored"})})),this.TTMSFNCTabSetCloseMode={0:"tcmNone",tcmNone:0,1:"tcmTab",tcmTab:1,2:"tcmMenu",tcmMenu:2},this.$rtti.$Enum("TTMSFNCTabSetCloseMode",{minvalue:0,maxvalue:2,ordtype:1,enumtype:this.TTMSFNCTabSetCloseMode}),this.TTMSFNCTabSetInsertMode={0:"timNone",timNone:0,1:"timTab",timTab:1,2:"timMenu",timMenu:2},this.$rtti.$Enum("TTMSFNCTabSetInsertMode",{minvalue:0,maxvalue:2,ordtype:1,enumtype:this.TTMSFNCTabSetInsertMode}),rtl.createClass(this,"TTMSFNCTabSetButtonAppearance",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FTabSet=null,this.FSize=0,this.FHoverFill=null,this.FStroke=null,this.FHoverStroke=null,this.FDownFill=null,this.FDownStroke=null,this.FDisabledFill=null,this.FDisabledStroke=null,this.FFill=null,this.FCloseIcon=null,this.FScrollPreviousIcon=null,this.FInsertIcon=null,this.FScrollNextIcon=null,this.FTabListIcon=null,this.FRounding=0},this.$final=function(){this.FTabSet=void 0,this.FHoverFill=void 0,this.FStroke=void 0,this.FHoverStroke=void 0,this.FDownFill=void 0,this.FDownStroke=void 0,this.FDisabledFill=void 0,this.FDisabledStroke=void 0,this.FFill=void 0,this.FCloseIcon=void 0,this.FScrollPreviousIcon=void 0,this.FInsertIcon=void 0,this.FScrollNextIcon=void 0,this.FTabListIcon=void 0,pas.Classes.TPersistent.$final.call(this)},this.IsSizedStored=function(){return 20!==this.FSize},this.SetSize=function(t){this.FSize!==t&&(this.FSize=t,this.UpdateTabs())},this.SetDisabledFill=function(t){this.FDisabledFill.Assign(t)},this.SetDisabledStroke=function(t){this.FDisabledStroke.Assign(t)},this.SetDownFill=function(t){this.FDownFill.Assign(t)},this.SetDownStroke=function(t){this.FDownStroke.Assign(t)},this.SetFill=function(t){this.FFill.Assign(t)},this.SetHoverFill=function(t){this.FHoverFill.Assign(t)},this.SetHoverStroke=function(t){this.FHoverStroke.Assign(t)},this.SetStroke=function(t){this.FStroke.Assign(t)},this.SetCloseIcon=function(t){this.FCloseIcon.Assign(t)},this.SetInsertIcon=function(t){this.FInsertIcon.Assign(t)},this.SetScrollNextIcon=function(t){this.FScrollNextIcon.Assign(t)},this.SetScrollPreviousIcon=function(t){this.FScrollPreviousIcon.Assign(t)},this.SetTabListIcon=function(t){this.FTabListIcon.Assign(t)},this.IsRoundingStored=function(){return 5!==this.FRounding},this.SetRounding=function(t){this.FRounding=t},this.UpdateTabs=function(){null!=this.FTabSet&&this.FTabSet.UpdateTabs(!1,!1)},this.FillChanged=function(t){this.UpdateTabs()},this.StrokeChanged=function(t){this.UpdateTabs()},this.BitmapChanged=function(t){null!=this.FTabSet&&null!=this.FTabSet.FInsertTab&&(this.FTabSet.FInsertTab.FBitmaps.Clear(),this.FTabSet.FInsertTab.FBitmaps.AddBitmap(this.FInsertIcon,1),this.FTabSet.FInsertTab.FDisabledBitmaps.Clear(),this.FTabSet.FInsertTab.FDisabledBitmaps.AddBitmap(this.FInsertIcon,1)),this.UpdateTabs()},this.Create$1=function(e){return this.FTabSet=e,this.FSize=20,this.FRounding=5,this.FFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[1,16316397,8421504,-1,-1]),this.FFill.FOnChanged=rtl.createCallback(this,"FillChanged"),this.FDownFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[1,15655897,8421504,-1,-1]),this.FDownFill.FOnChanged=rtl.createCallback(this,"FillChanged"),this.FHoverFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[1,16313827,8421504,-1,-1]),this.FHoverFill.FOnChanged=rtl.createCallback(this,"FillChanged"),this.FDisabledFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[1,13882323,8421504,-1,-1]),this.FDisabledFill.FOnChanged=rtl.createCallback(this,"FillChanged"),this.FStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,11119017]),this.FStroke.FOnChanged=rtl.createCallback(this,"StrokeChanged"),this.FDownStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,11119017]),this.FDownStroke.FOnChanged=rtl.createCallback(this,"StrokeChanged"),this.FHoverStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,11119017]),this.FHoverStroke.FOnChanged=rtl.createCallback(this,"StrokeChanged"),this.FDisabledStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,11119017]),this.FDisabledStroke.FOnChanged=rtl.createCallback(this,"StrokeChanged"),this.FTabListIcon=pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.CreateFromResource$1(t.TMSFNCTABSETLISTSVG,pas["WEBLib.TMSFNCTypes"].HInstance()),this.FTabListIcon.FOnChange=rtl.createCallback(this,"BitmapChanged"),this.FCloseIcon=pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.CreateFromResource$1(t.TMSFNCTABSETCLOSESVG,pas["WEBLib.TMSFNCTypes"].HInstance()),this.FCloseIcon.FOnChange=rtl.createCallback(this,"BitmapChanged"),this.FInsertIcon=pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.CreateFromResource$1(t.TMSFNCTABSETADDSVG,pas["WEBLib.TMSFNCTypes"].HInstance()),this.FInsertIcon.FOnChange=rtl.createCallback(this,"BitmapChanged"),this.FScrollNextIcon=pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.CreateFromResource$1(t.TMSFNCTABSETNEXTSVG,pas["WEBLib.TMSFNCTypes"].HInstance()),this.FScrollNextIcon.FOnChange=rtl.createCallback(this,"BitmapChanged"),this.FScrollPreviousIcon=pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.CreateFromResource$1(t.TMSFNCTABSETPREVIOUSSVG,pas["WEBLib.TMSFNCTypes"].HInstance()),this.FScrollPreviousIcon.FOnChange=rtl.createCallback(this,"BitmapChanged"),this},this.Assign=function(e){t.TTMSFNCTabSetButtonAppearance.isPrototypeOf(e)&&(this.FSize=rtl.as(e,t.TTMSFNCTabSetButtonAppearance).FSize,this.FRounding=rtl.as(e,t.TTMSFNCTabSetButtonAppearance).FRounding,this.FFill.Assign(rtl.as(e,t.TTMSFNCTabSetButtonAppearance).FFill),this.FDownFill.Assign(rtl.as(e,t.TTMSFNCTabSetButtonAppearance).FDownFill),this.FHoverFill.Assign(rtl.as(e,t.TTMSFNCTabSetButtonAppearance).FHoverFill),this.FDisabledFill.Assign(rtl.as(e,t.TTMSFNCTabSetButtonAppearance).FDisabledFill),this.FStroke.Assign(rtl.as(e,t.TTMSFNCTabSetButtonAppearance).FStroke),this.FDownStroke.Assign(rtl.as(e,t.TTMSFNCTabSetButtonAppearance).FDownStroke),this.FHoverStroke.Assign(rtl.as(e,t.TTMSFNCTabSetButtonAppearance).FHoverStroke),this.FDisabledStroke.Assign(rtl.as(e,t.TTMSFNCTabSetButtonAppearance).FDisabledStroke),this.FTabListIcon.Assign(rtl.as(e,t.TTMSFNCTabSetButtonAppearance).FTabListIcon),this.FCloseIcon.Assign(rtl.as(e,t.TTMSFNCTabSetButtonAppearance).FCloseIcon),this.FInsertIcon.Assign(rtl.as(e,t.TTMSFNCTabSetButtonAppearance).FInsertIcon),this.FScrollNextIcon.Assign(rtl.as(e,t.TTMSFNCTabSetButtonAppearance).FScrollNextIcon),this.FScrollPreviousIcon.Assign(rtl.as(e,t.TTMSFNCTabSetButtonAppearance).FScrollPreviousIcon))},this.Destroy=function(){rtl.free(this,"FTabListIcon"),rtl.free(this,"FCloseIcon"),rtl.free(this,"FInsertIcon"),rtl.free(this,"FScrollPreviousIcon"),rtl.free(this,"FScrollNextIcon"),rtl.free(this,"FFill"),rtl.free(this,"FStroke"),rtl.free(this,"FHoverFill"),rtl.free(this,"FHoverStroke"),rtl.free(this,"FDownFill"),rtl.free(this,"FDownStroke"),rtl.free(this,"FDisabledFill"),rtl.free(this,"FDisabledStroke"),pas.System.TObject.Destroy.call(this)};var e=this.$rtti;e.addProperty("Rounding",14,rtl.double,"FRounding","SetRounding",{stored:"IsRoundingStored"}),e.addProperty("Size",14,rtl.double,"FSize","SetSize",{stored:"IsSizedStored"}),e.addProperty("Fill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FFill","SetFill"),e.addProperty("Stroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FStroke","SetStroke"),e.addProperty("DownFill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FDownFill","SetDownFill"),e.addProperty("DownStroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FDownStroke","SetDownStroke"),e.addProperty("DisabledFill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FDisabledFill","SetDisabledFill"),e.addProperty("DisabledStroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FDisabledStroke","SetDisabledStroke"),e.addProperty("HoverFill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FHoverFill","SetHoverFill"),e.addProperty("HoverStroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FHoverStroke","SetHoverStroke"),e.addProperty("CloseIcon",2,pas["WEBLib.TMSFNCTypes"].$rtti.TTMSFNCBitmap,"FCloseIcon","SetCloseIcon"),e.addProperty("InsertIcon",2,pas["WEBLib.TMSFNCTypes"].$rtti.TTMSFNCBitmap,"FInsertIcon","SetInsertIcon"),e.addProperty("TabListIcon",2,pas["WEBLib.TMSFNCTypes"].$rtti.TTMSFNCBitmap,"FTabListIcon","SetTabListIcon"),e.addProperty("ScrollNextIcon",2,pas["WEBLib.TMSFNCTypes"].$rtti.TTMSFNCBitmap,"FScrollNextIcon","SetScrollNextIcon"),e.addProperty("ScrollPreviousIcon",2,pas["WEBLib.TMSFNCTypes"].$rtti.TTMSFNCBitmap,"FScrollPreviousIcon","SetScrollPreviousIcon")})),rtl.createClass(this,"TTMSFNCTabSetTabAppearance",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FTabSet=null,this.FHoverStroke=null,this.FDownFill=null,this.FDownStroke=null,this.FDisabledFill=null,this.FFont=null,this.FActiveFill=null,this.FDisabledStroke=null,this.FActiveStroke=null,this.FFill=null,this.FHoverFill=null,this.FStroke=null,this.FWordWrapping=!1,this.FTrimming=0,this.FTextAlign=0,this.FShape=0,this.FShapeOverlap=0,this.FShapeSlope=0,this.FTextColor=0,this.FHoverTextColor=0,this.FDownTextColor=0,this.FDisabledTextColor=0,this.FActiveTextColor=0,this.FShowFocus=!1,this.FFocusBorderColor=0,this.FProgressFill=null,this.FShapeRounding=0,this.FProgressStroke=null,this.FCloseSize=0,this.FProgressCircularSize=0,this.FCloseHoverStroke=null,this.FCloseDownFill=null,this.FCloseDownStroke=null,this.FCloseFill=null,this.FCloseHoverFill=null,this.FCloseStroke=null,this.FInsertSize=0,this.FBadgeFont=null,this.FBadgeFill=null,this.FBadgeStroke=null,this.FTextSpacing=0},this.$final=function(){this.FTabSet=void 0,this.FHoverStroke=void 0,this.FDownFill=void 0,this.FDownStroke=void 0,this.FDisabledFill=void 0,this.FFont=void 0,this.FActiveFill=void 0,this.FDisabledStroke=void 0,this.FActiveStroke=void 0,this.FFill=void 0,this.FHoverFill=void 0,this.FStroke=void 0,this.FProgressFill=void 0,this.FProgressStroke=void 0,this.FCloseHoverStroke=void 0,this.FCloseDownFill=void 0,this.FCloseDownStroke=void 0,this.FCloseFill=void 0,this.FCloseHoverFill=void 0,this.FCloseStroke=void 0,this.FBadgeFont=void 0,this.FBadgeFill=void 0,this.FBadgeStroke=void 0,pas.Classes.TPersistent.$final.call(this)},this.SetDisabledFill=function(t){this.FDisabledFill.Assign(t)},this.SetDisabledStroke=function(t){this.FDisabledStroke.Assign(t)},this.SetDownFill=function(t){this.FDownFill.Assign(t)},this.SetDownStroke=function(t){this.FDownStroke.Assign(t)},this.SetFill=function(t){this.FFill.Assign(t)},this.SetFont=function(t){this.FFont.Assign(t)},this.SetHoverFill=function(t){this.FHoverFill.Assign(t)},this.SetHoverStroke=function(t){this.FHoverStroke.Assign(t)},this.SetActiveFill=function(t){this.FActiveFill.Assign(t)},this.SetActiveStroke=function(t){this.FActiveStroke.Assign(t)},this.SetStroke=function(t){this.FStroke.Assign(t)},this.SetTextAlign=function(t){this.FTextAlign!==t&&(this.FTextAlign=t,this.UpdateTabs())},this.SetTrimming=function(t){this.FTrimming!==t&&(this.FTrimming=t,this.UpdateTabs())},this.SetWordWrapping=function(t){this.FWordWrapping!==t&&(this.FWordWrapping=t,this.UpdateTabs())},this.SetShape=function(t){this.FShape!==t&&(this.FShape=t,this.UpdateTabs())},this.SetShapeOverlap=function(t){this.FShapeOverlap!==t&&(this.FShapeOverlap=t,this.UpdateTabs())},this.IsShapeOverlapStored=function(){return 12!==this.FShapeOverlap},this.IsShapeSlopeStored=function(){return 11!==this.FShapeSlope},this.SetShapeSlope=function(t){this.FShapeSlope!==t&&(this.FShapeSlope=t,this.UpdateTabs())},this.SetActiveTextColor=function(t){this.FActiveTextColor!==t&&(this.FActiveTextColor=t,this.UpdateTabs())},this.SetDisabledTextColor=function(t){this.FDisabledTextColor!==t&&(this.FDisabledTextColor=t,this.UpdateTabs())},this.SetDownTextColor=function(t){this.FDownTextColor!==t&&(this.FDownTextColor=t,this.UpdateTabs())},this.SetHoverTextColor=function(t){this.FHoverTextColor!==t&&(this.FHoverTextColor=t,this.UpdateTabs())},this.SetTextColor=function(t){this.FTextColor!==t&&(this.FTextColor=t,this.UpdateTabs())},this.SetFocusBorderColor=function(t){this.FFocusBorderColor!==t&&(this.FFocusBorderColor=t,this.UpdateTabs())},this.SetShowFocus=function(t){this.FShowFocus!==t&&(this.FShowFocus=t,this.UpdateTabs())},this.SetProgressFill=function(t){this.FProgressFill.Assign(t)},this.IsShapeRoundingStored=function(){return 5!==this.FShapeRounding},this.SetShapeRounding=function(t){this.FShapeRounding!==t&&(this.FShapeRounding=t,this.UpdateTabs())},this.SetProgressStroke=function(t){this.FProgressStroke.Assign(t)},this.IsCloseSizeStored=function(){return 14!==this.FCloseSize},this.SetCloseSize=function(t){this.FCloseSize!==t&&(this.FCloseSize=t,this.UpdateTabs())},this.IsProgressCircularSizeStored=function(){return 15!==this.FProgressCircularSize},this.SetProgressCircularSize=function(t){this.FProgressCircularSize!==t&&(this.FProgressCircularSize=t,this.UpdateTabs())},this.SetCloseDownFill=function(t){this.FCloseDownFill.Assign(t)},this.SetCloseDownStroke=function(t){this.FCloseDownStroke.Assign(t)},this.SetCloseFill=function(t){this.FCloseFill.Assign(t)},this.SetCloseHoverFill=function(t){this.FCloseHoverFill.Assign(t)},this.SetCloseHoverStroke=function(t){this.FCloseHoverStroke.Assign(t)},this.SetCloseStroke=function(t){this.FCloseStroke.Assign(t)},this.IsInsertSizeStored=function(){return 20!==this.FInsertSize},this.SetInsertSize=function(t){this.FInsertSize!==t&&(this.FInsertSize=t,this.UpdateTabs())},this.SetBadgeFill=function(t){this.FBadgeFill.Assign(t)},this.SetBadgeFont=function(t){this.FBadgeFont.Assign(t)},this.SetBadgeStroke=function(t){this.FBadgeStroke.Assign(t)},this.SetTextSpacing=function(t){this.FTextSpacing!==t&&(this.FTextSpacing=t,this.UpdateTabs())},this.UpdateTabs=function(){null!=this.FTabSet&&this.FTabSet.UpdateTabs(!1,!1)},this.FillChanged=function(t){this.UpdateTabs()},this.StrokeChanged=function(t){this.UpdateTabs()},this.FontChanged=function(t){this.UpdateTabs()},this.Create$1=function(t){return this.FTabSet=t,this.FWordWrapping=!1,this.FTrimming=1,this.FShapeOverlap=12,this.FTextAlign=0,this.FShapeSlope=11,this.FTextSpacing=0,this.FProgressCircularSize=15,this.FCloseSize=14,this.FInsertSize=20,this.FShapeRounding=5,this.FTextColor=0,this.FBadgeFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[1,42495,8421504,-1,-1]),this.FBadgeFill.FOnChanged=rtl.createCallback(this,"FillChanged"),this.FBadgeStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,139]),this.FBadgeStroke.FOnChanged=rtl.createCallback(this,"StrokeChanged"),this.FBadgeFont=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFont.$create("Create$2"),null!=this.FTabSet&&this.FTabSet.IsDesignTime()&&(this.FBadgeFont.SetColor(139),this.FBadgeFont.SetStyle(rtl.createSet(0))),this.FBadgeFont.FOnChanged=rtl.createCallback(this,"FontChanged"),this.FActiveTextColor=0,this.FDisabledTextColor=0,this.FDownTextColor=0,this.FShowFocus=!0,this.FFocusBorderColor=0,this.FHoverTextColor=0,this.FFont=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFont.$create("Create$2"),this.FFont.FOnChanged=rtl.createCallback(this,"FontChanged"),this.FProgressFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[1,16297243,8421504,-1,-1]),this.FProgressFill.FOnChanged=rtl.createCallback(this,"FillChanged"),this.FProgressStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,16297243]),this.FProgressStroke.FOnChanged=rtl.createCallback(this,"StrokeChanged"),this.FFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[1,16316397,8421504,-1,-1]),this.FFill.FOnChanged=rtl.createCallback(this,"FillChanged"),this.FDownFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[1,15655897,8421504,-1,-1]),this.FDownFill.FOnChanged=rtl.createCallback(this,"FillChanged"),this.FActiveFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[1,16777215,8421504,-1,-1]),this.FActiveFill.FOnChanged=rtl.createCallback(this,"FillChanged"),this.FHoverFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[1,16313827,8421504,-1,-1]),this.FHoverFill.FOnChanged=rtl.createCallback(this,"FillChanged"),this.FDisabledFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[1,13882323,8421504,-1,-1]),this.FDisabledFill.FOnChanged=rtl.createCallback(this,"FillChanged"),this.FStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,11119017]),this.FStroke.FOnChanged=rtl.createCallback(this,"StrokeChanged"),this.FDownStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,11119017]),this.FDownStroke.FOnChanged=rtl.createCallback(this,"StrokeChanged"),this.FActiveStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,11119017]),this.FActiveStroke.FOnChanged=rtl.createCallback(this,"StrokeChanged"),this.FHoverStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,11119017]),this.FHoverStroke.FOnChanged=rtl.createCallback(this,"StrokeChanged"),this.FDisabledStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,11119017]),this.FDisabledStroke.FOnChanged=rtl.createCallback(this,"StrokeChanged"),this.FCloseFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[0,16316397,8421504,-1,-1]),this.FCloseFill.FOnChanged=rtl.createCallback(this,"FillChanged"),this.FCloseStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,11119017]),this.FCloseStroke.SetWidth(2),this.FCloseStroke.FOnChanged=rtl.createCallback(this,"StrokeChanged"),this.FCloseHoverFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[1,255,8421504,-1,-1]),this.FCloseHoverFill.FOnChanged=rtl.createCallback(this,"FillChanged"),this.FCloseHoverStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,16777215]),this.FCloseHoverStroke.SetWidth(2),this.FCloseHoverStroke.FOnChanged=rtl.createCallback(this,"StrokeChanged"),this.FCloseDownFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[1,3937500,8421504,-1,-1]),this.FCloseDownFill.FOnChanged=rtl.createCallback(this,"FillChanged"),this.FCloseDownStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,16777215]),this.FCloseDownStroke.SetWidth(2),this.FCloseDownStroke.FOnChanged=rtl.createCallback(this,"StrokeChanged"),this.FShape=3,this},this.Assign=function(e){t.TTMSFNCTabSetTabAppearance.isPrototypeOf(e)&&(this.FWordWrapping=rtl.as(e,t.TTMSFNCTabSetTabAppearance).FWordWrapping,this.FTrimming=rtl.as(e,t.TTMSFNCTabSetTabAppearance).FTrimming,this.FShapeOverlap=rtl.as(e,t.TTMSFNCTabSetTabAppearance).FShapeOverlap,this.FTextAlign=rtl.as(e,t.TTMSFNCTabSetTabAppearance).FTextAlign,this.FShapeSlope=rtl.as(e,t.TTMSFNCTabSetTabAppearance).FShapeSlope,this.FTextSpacing=rtl.as(e,t.TTMSFNCTabSetTabAppearance).FTextSpacing,this.FShapeRounding=rtl.as(e,t.TTMSFNCTabSetTabAppearance).FShapeRounding,this.FFont.Assign(rtl.as(e,t.TTMSFNCTabSetTabAppearance).FFont),this.FTextColor=rtl.as(e,t.TTMSFNCTabSetTabAppearance).FTextColor,this.FActiveTextColor=rtl.as(e,t.TTMSFNCTabSetTabAppearance).FActiveTextColor,this.FDisabledTextColor=rtl.as(e,t.TTMSFNCTabSetTabAppearance).FDisabledTextColor,this.FDownTextColor=rtl.as(e,t.TTMSFNCTabSetTabAppearance).FDownTextColor,this.FHoverTextColor=rtl.as(e,t.TTMSFNCTabSetTabAppearance).FHoverTextColor,this.FFill.Assign(rtl.as(e,t.TTMSFNCTabSetTabAppearance).FFill),this.FProgressFill.Assign(rtl.as(e,t.TTMSFNCTabSetTabAppearance).FProgressFill),this.FProgressStroke.Assign(rtl.as(e,t.TTMSFNCTabSetTabAppearance).FProgressStroke),this.FDownFill.Assign(rtl.as(e,t.TTMSFNCTabSetTabAppearance).FDownFill),this.FActiveFill.Assign(rtl.as(e,t.TTMSFNCTabSetTabAppearance).FActiveFill),this.FHoverFill.Assign(rtl.as(e,t.TTMSFNCTabSetTabAppearance).FHoverFill),this.FDisabledFill.Assign(rtl.as(e,t.TTMSFNCTabSetTabAppearance).FDisabledFill),this.FStroke.Assign(rtl.as(e,t.TTMSFNCTabSetTabAppearance).FStroke),this.FDownStroke.Assign(rtl.as(e,t.TTMSFNCTabSetTabAppearance).FDownStroke),this.FActiveStroke.Assign(rtl.as(e,t.TTMSFNCTabSetTabAppearance).FActiveStroke),this.FHoverStroke.Assign(rtl.as(e,t.TTMSFNCTabSetTabAppearance).FHoverStroke),this.FDisabledStroke.Assign(rtl.as(e,t.TTMSFNCTabSetTabAppearance).FDisabledStroke),this.FShape=rtl.as(e,t.TTMSFNCTabSetTabAppearance).FShape,this.FShowFocus=rtl.as(e,t.TTMSFNCTabSetTabAppearance).FShowFocus,this.FFocusBorderColor=rtl.as(e,t.TTMSFNCTabSetTabAppearance).FFocusBorderColor,this.FCloseSize=rtl.as(e,t.TTMSFNCTabSetTabAppearance).FCloseSize,this.FInsertSize=rtl.as(e,t.TTMSFNCTabSetTabAppearance).FInsertSize,this.FProgressCircularSize=rtl.as(e,t.TTMSFNCTabSetTabAppearance).FProgressCircularSize,this.FCloseFill.Assign(rtl.as(e,t.TTMSFNCTabSetTabAppearance).FCloseFill),this.FCloseStroke.Assign(rtl.as(e,t.TTMSFNCTabSetTabAppearance).FCloseStroke),this.FCloseHoverFill.Assign(rtl.as(e,t.TTMSFNCTabSetTabAppearance).FCloseHoverFill),this.FCloseHoverStroke.Assign(rtl.as(e,t.TTMSFNCTabSetTabAppearance).FCloseHoverStroke),this.FCloseDownFill.Assign(rtl.as(e,t.TTMSFNCTabSetTabAppearance).FCloseDownFill),this.FCloseDownStroke.Assign(rtl.as(e,t.TTMSFNCTabSetTabAppearance).FCloseDownStroke),this.FBadgeFont.Assign(rtl.as(e,t.TTMSFNCTabSetTabAppearance).FBadgeFont),this.FBadgeFill.Assign(rtl.as(e,t.TTMSFNCTabSetTabAppearance).FBadgeFill),this.FBadgeStroke.Assign(rtl.as(e,t.TTMSFNCTabSetTabAppearance).FBadgeStroke))},this.Destroy=function(){rtl.free(this,"FBadgeFont"),rtl.free(this,"FBadgeFill"),rtl.free(this,"FBadgeStroke"),rtl.free(this,"FFont"),rtl.free(this,"FFill"),rtl.free(this,"FProgressFill"),rtl.free(this,"FProgressStroke"),rtl.free(this,"FDownFill"),rtl.free(this,"FHoverFill"),rtl.free(this,"FDisabledFill"),rtl.free(this,"FActiveFill"),rtl.free(this,"FStroke"),rtl.free(this,"FDownStroke"),rtl.free(this,"FHoverStroke"),rtl.free(this,"FDisabledStroke"),rtl.free(this,"FActiveStroke"),rtl.free(this,"FCloseHoverStroke"),rtl.free(this,"FCloseHoverFill"),rtl.free(this,"FCloseFill"),rtl.free(this,"FCloseStroke"),rtl.free(this,"FCloseDownFill"),rtl.free(this,"FCloseDownStroke"),pas.System.TObject.Destroy.call(this)};var e=this.$rtti;e.addProperty("Font",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFont,"FFont","SetFont"),e.addProperty("ProgressFill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FProgressFill","SetProgressFill"),e.addProperty("ProgressStroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FProgressStroke","SetProgressStroke"),e.addProperty("Fill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FFill","SetFill"),e.addProperty("Stroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FStroke","SetStroke"),e.addProperty("ActiveFill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FActiveFill","SetActiveFill"),e.addProperty("ActiveStroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FActiveStroke","SetActiveStroke"),e.addProperty("DisabledFill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FDisabledFill","SetDisabledFill"),e.addProperty("DisabledStroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FDisabledStroke","SetDisabledStroke"),e.addProperty("DownFill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FDownFill","SetDownFill"),e.addProperty("DownStroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FDownStroke","SetDownStroke"),e.addProperty("HoverFill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FHoverFill","SetHoverFill"),e.addProperty("HoverStroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FHoverStroke","SetHoverStroke"),e.addProperty("WordWrapping",2,rtl.boolean,"FWordWrapping","SetWordWrapping",{Default:!1}),e.addProperty("Trimming",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsTextTrimming,"FTrimming","SetTrimming",{Default:pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsTextTrimming.gttCharacter}),e.addProperty("TextAlign",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsTextAlign,"FTextAlign","SetTextAlign",{Default:pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsTextAlign.gtaCenter}),e.addProperty("TextSpacing",2,rtl.double,"FTextSpacing","SetTextSpacing"),e.addProperty("Shape",2,t.$rtti.TTMSFNCTabSetTabShape,"FShape","SetShape",{Default:t.TTMSFNCTabSetTabShape.tsPyramid}),e.addProperty("ShapeOverlap",14,rtl.double,"FShapeOverlap","SetShapeOverlap",{stored:"IsShapeOverlapStored"}),e.addProperty("ShapeSlope",14,rtl.double,"FShapeSlope","SetShapeSlope",{stored:"IsShapeSlopeStored"}),e.addProperty("ShapeRounding",14,rtl.double,"FShapeRounding","SetShapeRounding",{stored:"IsShapeRoundingStored"}),e.addProperty("TextColor",2,pas["WEBLib.Graphics"].$rtti.TColor,"FTextColor","SetTextColor",{Default:0}),e.addProperty("ActiveTextColor",2,pas["WEBLib.Graphics"].$rtti.TColor,"FActiveTextColor","SetActiveTextColor",{Default:0}),e.addProperty("HoverTextColor",2,pas["WEBLib.Graphics"].$rtti.TColor,"FHoverTextColor","SetHoverTextColor",{Default:0}),e.addProperty("DownTextColor",2,pas["WEBLib.Graphics"].$rtti.TColor,"FDownTextColor","SetDownTextColor",{Default:0}),e.addProperty("DisabledTextColor",2,pas["WEBLib.Graphics"].$rtti.TColor,"FDisabledTextColor","SetDisabledTextColor",{Default:0}),e.addProperty("ShowFocus",2,rtl.boolean,"FShowFocus","SetShowFocus",{Default:!0}),e.addProperty("FocusBorderColor",2,pas["WEBLib.Graphics"].$rtti.TColor,"FFocusBorderColor","SetFocusBorderColor",{Default:0}),e.addProperty("ProgressCircularSize",14,rtl.double,"FProgressCircularSize","SetProgressCircularSize",{stored:"IsProgressCircularSizeStored"}),e.addProperty("InsertSize",14,rtl.double,"FInsertSize","SetInsertSize",{stored:"IsInsertSizeStored"}),e.addProperty("CloseSize",14,rtl.double,"FCloseSize","SetCloseSize",{stored:"IsCloseSizeStored"}),e.addProperty("CloseFill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FCloseFill","SetCloseFill"),e.addProperty("CloseStroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FCloseStroke","SetCloseStroke"),e.addProperty("CloseDownFill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FCloseDownFill","SetCloseDownFill"),e.addProperty("CloseDownStroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FCloseDownStroke","SetCloseDownStroke"),e.addProperty("CloseHoverFill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FCloseHoverFill","SetCloseHoverFill"),e.addProperty("CloseHoverStroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FCloseHoverStroke","SetCloseHoverStroke"),e.addProperty("BadgeFill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FBadgeFill","SetBadgeFill"),e.addProperty("BadgeStroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FBadgeStroke","SetBadgeStroke"),e.addProperty("BadgeFont",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFont,"FBadgeFont","SetBadgeFont")})),rtl.createClass(this,"TTMSFNCTabSetLayout",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FTabSet=null,this.FMultiline=0,this.FPosition=0,this.FOnChange=null},this.$final=function(){this.FTabSet=void 0,this.FOnChange=void 0,pas.Classes.TPersistent.$final.call(this)},this.SetMultiline=function(t){this.FMultiline!==t&&(this.FMultiline=t,this.UpdateTabs())},this.SetPosition=function(t){if(this.FPosition!==t){if(this.FPosition=t,null!=this.FTabSet&&null!=this.FTabSet.FTabList){var e=this.FPosition;0===e?this.FTabSet.FTabListPopup.SetPlacement(3):1===e?this.FTabSet.FTabListPopup.SetPlacement(0):2===e?this.FTabSet.FTabListPopup.SetPlacement(1):3===e&&this.FTabSet.FTabListPopup.SetPlacement(2)}this.UpdateTabs()}},this.UpdateTabs=function(){null!=this.FOnChange&&this.FOnChange(this),null!=this.FTabSet&&this.FTabSet.UpdateTabs(!1,!1)},this.Assign=function(e){t.TTMSFNCTabSetLayout.isPrototypeOf(e)&&(this.FMultiline=rtl.as(e,t.TTMSFNCTabSetLayout).FMultiline,this.FPosition=rtl.as(e,t.TTMSFNCTabSetLayout).FPosition)},this.Create$1=function(t){return this.FTabSet=t,this.FMultiline=0,this.FPosition=1,this};var e=this.$rtti;e.addProperty("Position",2,t.$rtti.TTMSFNCTabSetLayoutPosition,"FPosition","SetPosition",{Default:t.TTMSFNCTabSetLayoutPosition.tlpTop}),e.addProperty("Multiline",2,t.$rtti.TTMSFNCTabSetLayoutMultiline,"FMultiline","SetMultiline",{Default:t.TTMSFNCTabSetLayoutMultiline.tlmNone})})),rtl.createClass(this,"TTMSFNCTabSetInteraction",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FTabSet=null,this.FSelectTabOnFocus=!1,this.FEditing=!1,this.FSelectTabOnInsert=!1,this.FSelectTabOnScroll=!1,this.FInsertTabWithKeyboard=!1,this.FCloseTabWithKeyboard=!1,this.FAutoOpenURL=!1,this.FReorder=!1},this.$final=function(){this.FTabSet=void 0,pas.Classes.TPersistent.$final.call(this)},this.Assign=function(e){t.TTMSFNCTabSetInteraction.isPrototypeOf(e)&&(this.FSelectTabOnFocus=rtl.as(e,t.TTMSFNCTabSetInteraction).FSelectTabOnFocus,this.FSelectTabOnInsert=rtl.as(e,t.TTMSFNCTabSetInteraction).FSelectTabOnInsert,this.FSelectTabOnScroll=rtl.as(e,t.TTMSFNCTabSetInteraction).FSelectTabOnScroll,this.FEditing=rtl.as(e,t.TTMSFNCTabSetInteraction).FEditing,this.FCloseTabWithKeyboard=rtl.as(e,t.TTMSFNCTabSetInteraction).FCloseTabWithKeyboard,this.FInsertTabWithKeyboard=rtl.as(e,t.TTMSFNCTabSetInteraction).FInsertTabWithKeyboard,this.FAutoOpenURL=rtl.as(e,t.TTMSFNCTabSetInteraction).FAutoOpenURL,this.FReorder=rtl.as(e,t.TTMSFNCTabSetInteraction).FReorder)},this.Create$1=function(t){return this.FTabSet=t,this.FSelectTabOnFocus=!0,this.FSelectTabOnInsert=!0,this.FSelectTabOnScroll=!0,this.FEditing=!1,this.FInsertTabWithKeyboard=!0,this.FCloseTabWithKeyboard=!0,this.FAutoOpenURL=!0,this.FReorder=!1,this};var e=this.$rtti;e.addProperty("SelectTabOnFocus",0,rtl.boolean,"FSelectTabOnFocus","FSelectTabOnFocus",{Default:!0}),e.addProperty("SelectTabOnInsert",0,rtl.boolean,"FSelectTabOnInsert","FSelectTabOnInsert",{Default:!0}),e.addProperty("SelectTabOnScroll",0,rtl.boolean,"FSelectTabOnScroll","FSelectTabOnScroll",{Default:!0}),e.addProperty("Editing",0,rtl.boolean,"FEditing","FEditing",{Default:!1}),e.addProperty("CloseTabWithKeyboard",0,rtl.boolean,"FCloseTabWithKeyboard","FCloseTabWithKeyboard",{Default:!0}),e.addProperty("InsertTabWithKeyboard",0,rtl.boolean,"FInsertTabWithKeyboard","FInsertTabWithKeyboard",{Default:!0}),e.addProperty("AutoOpenURL",0,rtl.boolean,"FAutoOpenURL","FAutoOpenURL",{Default:!0}),e.addProperty("Reorder",0,rtl.boolean,"FReorder","FReorder",{Default:!1})})),rtl.createClass(this,"TTMSFNCTabSetOptions",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FTabSet=null,this.FCloseMode=0,this.FInsertMode=0,this.FTabListButton=!1,this.FCloseAction=0},this.$final=function(){this.FTabSet=void 0,pas.Classes.TPersistent.$final.call(this)},this.SetCloseMode=function(t){this.FCloseMode!==t&&(this.FCloseMode=t,this.UpdateTabs())},this.SetInsertMode=function(t){this.FInsertMode!==t&&(this.FInsertMode=t,this.UpdateTabs())},this.SetTabListButton=function(t){this.FTabListButton!==t&&(this.FTabListButton=t,this.UpdateTabs())},this.UpdateTabs=function(){null!=this.FTabSet&&this.FTabSet.UpdateTabs(!1,!1)},this.Assign=function(e){t.TTMSFNCTabSetOptions.isPrototypeOf(e)&&(this.FCloseMode=rtl.as(e,t.TTMSFNCTabSetOptions).FCloseMode,this.FInsertMode=rtl.as(e,t.TTMSFNCTabSetOptions).FInsertMode,this.FTabListButton=rtl.as(e,t.TTMSFNCTabSetOptions).FTabListButton,this.FCloseAction=rtl.as(e,t.TTMSFNCTabSetOptions).FCloseAction)},this.Create$1=function(t){return this.FTabSet=t,this.FCloseMode=0,this.FInsertMode=0,this.FTabListButton=!1,this.FCloseAction=2,this};var e=this.$rtti;e.addProperty("CloseMode",2,t.$rtti.TTMSFNCTabSetCloseMode,"FCloseMode","SetCloseMode",{Default:t.TTMSFNCTabSetCloseMode.tcmNone}),e.addProperty("CloseAction",0,t.$rtti.TTMSFNCTabSetTabCloseAction,"FCloseAction","FCloseAction",{Default:t.TTMSFNCTabSetTabCloseAction.ttcaHide}),e.addProperty("InsertMode",2,t.$rtti.TTMSFNCTabSetInsertMode,"FInsertMode","SetInsertMode",{Default:t.TTMSFNCTabSetInsertMode.timNone}),e.addProperty("TabListButton",2,rtl.boolean,"FTabListButton","SetTabListButton",{Default:!1})})),this.TTMSFNCTabSetButtonState={0:"tbsNormal",tbsNormal:0,1:"tbsHover",tbsHover:1,2:"tbsDown",tbsDown:2,3:"tbsDisabled",tbsDisabled:3},this.$rtti.$Enum("TTMSFNCTabSetButtonState",{minvalue:0,maxvalue:3,ordtype:1,enumtype:this.TTMSFNCTabSetButtonState}),this.TTMSFNCTabSetTabState={0:"ttsNormal",ttsNormal:0,1:"ttsHover",ttsHover:1,2:"ttsDown",ttsDown:2,3:"ttsActive",ttsActive:3,4:"ttsDisabled",ttsDisabled:4},this.$rtti.$Enum("TTMSFNCTabSetTabState",{minvalue:0,maxvalue:4,ordtype:1,enumtype:this.TTMSFNCTabSetTabState}),this.TTMSFNCTabSetMenuButton={0:"tmbClose",tmbClose:0,1:"tmbInsert",tmbInsert:1,2:"tmbTabList",tmbTabList:2,3:"tmbScrollPrevious",tmbScrollPrevious:3,4:"tmbScrollNext",tmbScrollNext:4},this.$rtti.$Enum("TTMSFNCTabSetMenuButton",{minvalue:0,maxvalue:4,ordtype:1,enumtype:this.TTMSFNCTabSetMenuButton}),this.$rtti.$ClassRef("TTMSFNCTabSetInplaceEditorClass",{instancetype:pas["WEBLib.Controls"].$rtti.TWinControl}),this.$rtti.$MethodVar("TTMSFNCTabSetCustomizeInplaceEditorEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ATabIndex",rtl.longint],["AInplaceEditor",pas["WEBLib.Controls"].$rtti.TWinControl]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTabSetGetInplaceEditorRectEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ATabIndex",rtl.longint],["AInplaceEditor",pas["WEBLib.Controls"].$rtti.TWinControl],["AInplaceEditorRect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTabSetGetInplaceEditorEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ATabIndex",rtl.longint],["AInplaceEditorClass",this.$rtti.TTMSFNCTabSetInplaceEditorClass,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTabSetBeforeOpenInplaceEditorEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ATabIndex",rtl.longint],["ACanOpen",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTabSetOpenInplaceEditorEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ATabIndex",rtl.longint],["AInplaceEditor",pas["WEBLib.Controls"].$rtti.TWinControl],["AInplaceEditorRect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTabSetCloseInplaceEditorEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ATabIndex",rtl.longint],["AInplaceEditor",pas["WEBLib.Controls"].$rtti.TWinControl],["ACancelled",rtl.boolean],["ACanClose",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTabSetBeforeUpdateTabEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ATabIndex",rtl.longint],["AText",rtl.string,1],["ACanUpdate",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTabSetUpdateTabEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ATabIndex",rtl.longint]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTabSetAnchorTabClickEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ATabIndex",rtl.longint],["AAnchor",rtl.string]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTabSetBeforeDrawTabBackgroundEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ATabIndex",rtl.longint],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["AState",this.$rtti.TTMSFNCTabSetTabState],["ADefaultDraw",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTabSetBeforeDrawTabProgressEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ATabIndex",rtl.longint],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["AProgressMode",this.$rtti.TTMSFNCTabSetTabProgressMode],["AProgressKind",this.$rtti.TTMSFNCTabSetTabProgressKind],["AAnimationStartAngle",rtl.double],["AAnimationSweepAngle",rtl.double],["AProgress",rtl.double],["AProgressMax",rtl.double],["ADefaultDraw",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTabSetBeforeDrawTabBadgeEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ATabIndex",rtl.longint],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["AText",rtl.string],["ADefaultDraw",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTabSetBeforeDrawTabTextEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ATabIndex",rtl.longint],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["AText",rtl.string],["ADefaultDraw",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTabSetBeforeDrawTabCloseButtonEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ATabIndex",rtl.longint],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["AState",this.$rtti.TTMSFNCTabSetButtonState],["ADefaultDraw",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTabSetBeforeDrawTabBitmapEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ATabIndex",rtl.longint],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["ADefaultDraw",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTabSetAfterDrawTabBackgroundEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ATabIndex",rtl.longint],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["AState",this.$rtti.TTMSFNCTabSetTabState]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTabSetAfterDrawTabProgressEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ATabIndex",rtl.longint],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["AProgressMode",this.$rtti.TTMSFNCTabSetTabProgressMode],["AProgressKind",this.$rtti.TTMSFNCTabSetTabProgressKind],["AAnimationStartAngle",rtl.double],["AAnimationSweepAngle",rtl.double],["AProgress",rtl.double],["AProgressMax",rtl.double]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTabSetAfterDrawTabBadgeEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ATabIndex",rtl.longint],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["AText",rtl.string]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTabSetAfterDrawTabTextEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ATabIndex",rtl.longint],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["AText",rtl.string]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTabSetAfterDrawTabCloseButtonEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ATabIndex",rtl.longint],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["AState",this.$rtti.TTMSFNCTabSetButtonState]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTabSetAfterDrawTabBitmapEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ATabIndex",rtl.longint],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTabSetBeforeDrawMenuButton",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["AButton",this.$rtti.TTMSFNCTabSetMenuButton],["AState",this.$rtti.TTMSFNCTabSetButtonState],["ADefaultDraw",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTabSetAfterDrawMenuButton",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["AButton",this.$rtti.TTMSFNCTabSetMenuButton],["AState",this.$rtti.TTMSFNCTabSetButtonState]]),methodkind:0}),rtl.createClass(this,"TTMSFNCTabSetEdit",pas["WEBLib.StdCtrls"].TEdit,(function(){this.$init=function(){pas["WEBLib.StdCtrls"].TEdit.$init.call(this),this.FTabSet=null},this.$final=function(){this.FTabSet=void 0,pas["WEBLib.StdCtrls"].TEdit.$final.call(this)},this.KeyDown=function(t,e){if(pas["WEBLib.Controls"].TControl.KeyDown.apply(this,arguments),null!=this.FTabSet&&this.FTabSet.FInplaceEditorActive){var i=t.get();27===i?(this.FTabSet.CloseInplaceEditor(!0),this.FTabSet.FInplaceEditorClosed=!0,t.set(0)):113!==i&&13!==i||(this.FTabSet.CloseInplaceEditor(!1),this.FTabSet.FInplaceEditorClosed=!0,t.set(0))}},this.DoExit=function(){pas["WEBLib.Controls"].TControl.DoExit.call(this),null!=this.FTabSet&&this.FTabSet.FInplaceEditorActive&&this.FTabSet.CloseInplaceEditor(!1)},this.Create$1=function(e){return pas["WEBLib.Controls"].TControl.Create$1.apply(this,arguments),t.TTMSFNCCustomTabSet.isPrototypeOf(e)&&(this.FTabSet=rtl.as(e,t.TTMSFNCCustomTabSet)),this},rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TTMSFNCCustomTabSet",pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl,(function(){this.$init=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.$init.call(this),this.FTotalTabHeight=0,this.FDownX=0,this.FDownY=0,this.FDragDownX=0,this.FDragDownY=0,this.FClosing=!1,this.FTabAnchor="",this.FDblClicked=!1,this.FInplaceEditorClosed=!1,this.FCloseWithDialogKey=!1,this.FUpdateTab=t.TTMSFNCTabSetDisplayTab.$new(),this.FInplaceEditorClass=null,this.FInplaceEditor=null,this.FInplaceEditorActive=!1,this.FMenuSize=0,this.FInvisibleTabList=null,this.FTabListPopup=null,this.FTabList=null,this.FFirstTabIndex=0,this.FLastTabIndex=0,this.FTabListButtonState=0,this.FCloseButtonState=0,this.FInsertButtonState=0,this.FScrollButtonPreviousState=0,this.FScrollButtonNextState=0,this.FPrevTabListButtonState=0,this.FPrevCloseButtonState=0,this.FPrevInsertButtonState=0,this.FPrevScrollButtonPreviousState=0,this.FPrevScrollButtonNextState=0,this.FScrollButtonNextDisabled=!1,this.FScrollButtonPreviousDisabled=!1,this.FShowMenu=!1,this.FShowScrollButtons=!1,this.FAllowScrolling=!1,this.FShowCloseButton=!1,this.FShowTabListButton=!1,this.FShowInsertButton=!1,this.FInsertTab=null,this.FDragTab=null,this.FActiveTabIndex=0,this.FDownCount=0,this.FAnimTimer=null,this.FDownTimer=null,this.FActiveTab=null,this.FFocusedTab=null,this.FPrevTab=null,this.FDownTab=null,this.FPrevHoverTab=null,this.FHoverTab=null,this.FTabChanging=!1,this.FDownCloseTab=null,this.FHoverCloseTab=null,this.FPrevHoverCloseTab=null,this.FDragTabDisplay=t.TTMSFNCTabSetDisplayTab.$new(),this.FOrigRect$1=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),this.FStartTab=0,this.FScrollCount=0,this.FUpdateCount$1=0,this.FDisplayList=null,this.FBitmapContainer=null,this.FTabs=null,this.FTabSize=null,this.FLayout=null,this.FTabAppearance=null,this.FInteraction=null,this.FOnChangeTab=null,this.FOnCloseTab=null,this.FOnBeforeChangeTab=null,this.FOnBeforeCloseTab=null,this.FOptions=null,this.FOnInsertTab=null,this.FOnBeforeInsertTab=null,this.FButtonAppearance=null,this.FOnGetInplaceEditorRect=null,this.FOnCustomizeInplaceEditor=null,this.FOnOpenInplaceEditor=null,this.FOnGetInplaceEditor=null,this.FOnCloseInplaceEditor=null,this.FOnBeforeOpenInplaceEditor=null,this.FOnUpdateTab=null,this.FOnBeforeUpdateTab=null,this.FOnAnchorTabClick=null,this.FOnReorderTab=null,this.FOnBeforeReorderTab=null,this.FOnBeforeDrawTabBadge=null,this.FOnBeforeDrawTabText=null,this.FOnAfterDrawTabBackground=null,this.FOnAfterDrawTabBitmap=null,this.FOnBeforeDrawTabCloseButton=null,this.FOnAfterDrawTabProgress=null,this.FOnAfterDrawTabBadge=null,this.FOnAfterDrawTabText=null,this.FOnAfterDrawTabCloseButton=null,this.FOnBeforeDrawTabBackground=null,this.FOnBeforeDrawTabBitmap=null,this.FOnBeforeDrawTabProgress=null,this.FOnAfterDrawMenuButton=null,this.FOnBeforeDrawMenuButton=null,this.FGlobalFont=null},this.$final=function(){this.FUpdateTab=void 0,this.FInplaceEditorClass=void 0,this.FInplaceEditor=void 0,this.FInvisibleTabList=void 0,this.FTabListPopup=void 0,this.FTabList=void 0,this.FInsertTab=void 0,this.FDragTab=void 0,this.FAnimTimer=void 0,this.FDownTimer=void 0,this.FActiveTab=void 0,this.FFocusedTab=void 0,this.FPrevTab=void 0,this.FDownTab=void 0,this.FPrevHoverTab=void 0,this.FHoverTab=void 0,this.FDownCloseTab=void 0,this.FHoverCloseTab=void 0,this.FPrevHoverCloseTab=void 0,this.FDragTabDisplay=void 0,this.FOrigRect$1=void 0,this.FDisplayList=void 0,this.FBitmapContainer=void 0,this.FTabs=void 0,this.FTabSize=void 0,this.FLayout=void 0,this.FTabAppearance=void 0,this.FInteraction=void 0,this.FOnChangeTab=void 0,this.FOnCloseTab=void 0,this.FOnBeforeChangeTab=void 0,this.FOnBeforeCloseTab=void 0,this.FOptions=void 0,this.FOnInsertTab=void 0,this.FOnBeforeInsertTab=void 0,this.FButtonAppearance=void 0,this.FOnGetInplaceEditorRect=void 0,this.FOnCustomizeInplaceEditor=void 0,this.FOnOpenInplaceEditor=void 0,this.FOnGetInplaceEditor=void 0,this.FOnCloseInplaceEditor=void 0,this.FOnBeforeOpenInplaceEditor=void 0,this.FOnUpdateTab=void 0,this.FOnBeforeUpdateTab=void 0,this.FOnAnchorTabClick=void 0,this.FOnReorderTab=void 0,this.FOnBeforeReorderTab=void 0,this.FOnBeforeDrawTabBadge=void 0,this.FOnBeforeDrawTabText=void 0,this.FOnAfterDrawTabBackground=void 0,this.FOnAfterDrawTabBitmap=void 0,this.FOnBeforeDrawTabCloseButton=void 0,this.FOnAfterDrawTabProgress=void 0,this.FOnAfterDrawTabBadge=void 0,this.FOnAfterDrawTabText=void 0,this.FOnAfterDrawTabCloseButton=void 0,this.FOnBeforeDrawTabBackground=void 0,this.FOnBeforeDrawTabBitmap=void 0,this.FOnBeforeDrawTabProgress=void 0,this.FOnAfterDrawMenuButton=void 0,this.FOnBeforeDrawMenuButton=void 0,this.FGlobalFont=void 0,pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.$final.call(this)},this.SetTabSize=function(t){this.FTabSize.Assign(t)},this.SetLayout=function(t){this.FLayout!==t&&(this.FLayout=t,this.UpdateTabs(!1,!1))},this.SetTabAppearance=function(t){this.FTabAppearance.Assign(t)},this.GetActiveTab=function(){var t=null;return t=null,this.FActiveTabIndex>=0&&this.FActiveTabIndex<=this.FTabs.GetCount()-1&&(t=this.FTabs.GetTab(this.FActiveTabIndex)),t},this.GetActiveTabIndex=function(){var t=0;return t=this.FActiveTabIndex,null!=this.FActiveTab&&(t=this.FActiveTab.GetIndex()),t},this.SetActiveTab=function(t){this.HandleChangeTab(t)},this.SetActiveTabIndex=function(t){this.FActiveTabIndex=Math.max(0,Math.min(t,this.FTabs.GetCount()-1)),this.FActiveTabIndex>=0&&this.FActiveTabIndex<=this.FTabs.GetCount()-1?this.SetActiveTab(this.FTabs.GetTab(this.FActiveTabIndex)):this.SetActiveTab(null)},this.SetInteraction=function(t){this.FInteraction.Assign(t)},this.SetOptions=function(t){this.FOptions.Assign(t)},this.SetButtonAppearance=function(t){this.FButtonAppearance.Assign(t)},this.GetBitmapContainer=function(){return this.FBitmapContainer},this.GetDocURL=function(){return pas["WEBLib.TMSFNCTypes"].TTMSFNCBaseDocURL+"tmsfncuipack/components/"+pas.SysUtils.LowerCase(this.$classname)},this.CreateTabs=function(){return t.TTMSFNCTabSetTabs.$create("Create$3",[this])},this.GetTotalTabHeight=function(){return this.FTotalTabHeight},this.GetVersion=function(){return this.$class.GetVersionNumber(1,0,1,1)},this.GetTabSize=function(t){var e=0;if(e=0,t===this.GetTotalTabCount()-1&&1===this.FOptions.FInsertMode)e=this.FTabAppearance.FInsertSize;else if(t>=0&&t<=this.FTabs.GetCount()-1){var i=this.FTabSize.FMode;3===i?(e=this.FTabs.GetTab(t).GetAutoSize(),this.FTabAppearance.FShape in rtl.createSet(1,2,3)?e+=2*this.FTabAppearance.FShapeSlope:this.FTabAppearance.FShape in rtl.createSet(4,5,6)?e+=this.FTabAppearance.FShapeSlope:e+=2*this.FTabAppearance.FShapeOverlap,e+=this.FTabAppearance.FTextSpacing):1!==i&&2!==i||(e=this.FTabs.GetTab(t).FWidth>-1?this.FTabs.GetTab(t).FWidth:this.FTabSize.FWidth)}return e},this.GetTotalTabCount=function(){var t=0;return t=this.FTabs.GetCount(),1===this.FOptions.FInsertMode&&(t+=1),t},this.GetTabRect=function(){var t,e=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),i=pas["WEBLib.TMSFNCTypes"].TRectF.$new();e.$assign(this.GetLocalRect()),i.$assign(e),t=this.FMenuSize;var s=this.FLayout.FPosition;return 0===s?(e.Left=i.Left+this.FTabSize.FMargins.FLeft+1,e.Top=i.Top+this.FTabSize.FMargins.FTop,e.Right=i.Left+this.FTabSize.FMargins.FLeft+this.FTabSize.FHeight,this.FShowMenu?e.Bottom=i.Bottom-this.FTabSize.FMargins.FBottom-t:e.Bottom=i.Bottom-this.FTabSize.FMargins.FBottom):1===s?(e.Left=i.Left+this.FTabSize.FMargins.FLeft,e.Top=i.Top+this.FTabSize.FMargins.FTop+1,this.FShowMenu?e.Right=i.Right-this.FTabSize.FMargins.FRight-t:e.Right=i.Right-this.FTabSize.FMargins.FRight,e.Bottom=i.Top+this.FTabSize.FMargins.FTop+this.FTabSize.FHeight):2===s?(e.Left=i.Left+this.FTabSize.FMargins.FLeft,e.Top=i.Bottom-this.FTabSize.FMargins.FBottom-this.FTabSize.FHeight,this.FShowMenu?e.Right=i.Right-this.FTabSize.FMargins.FRight-t:e.Right=i.Right-this.FTabSize.FMargins.FRight,e.Bottom=i.Bottom-this.FTabSize.FMargins.FBottom-1):3===s&&(e.Left=i.Right-this.FTabSize.FMargins.FRight-this.FTabSize.FHeight,e.Top=i.Top+this.FTabSize.FMargins.FTop,e.Right=i.Right-this.FTabSize.FMargins.FRight-1,this.FShowMenu?e.Bottom=i.Bottom-this.FTabSize.FMargins.FBottom-t:e.Bottom=i.Bottom-this.FTabSize.FMargins.FBottom),e},this.GetMenuRect=function(){var t,e=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),i=pas["WEBLib.TMSFNCTypes"].TRectF.$new();e.$assign(this.GetTabRect()),i.$assign(e),t=this.FMenuSize;var s=this.FLayout.FPosition;return 1===s||2===s?(e.Left=i.Right,e.Top=i.Top,e.Right=i.Right+t,e.Bottom=i.Bottom):0!==s&&3!==s||(e.Left=i.Left,e.Top=i.Bottom,e.Right=i.Right,e.Bottom=i.Bottom+t),e},this.GetVisibleTabCount=function(){var t=0,e=0;t=0;for(var i=0,s=this.FTabs.GetCount()-1;i<=s;i++)e=i,this.IsTabVisible(e)&&(t+=1);return t},this.GetInvisibleTabCount=function(){var t=0,e=0;t=0;for(var i=0,s=this.FTabs.GetCount()-1;i<=s;i++)e=i,this.IsTabVisible(e)||(t+=1);return t},this.GetInvisibleTabCountForScrolling=function(){var t=0,e=0;t=0;for(var i=this.FStartTab,s=this.FLastTabIndex;i<=s;i++)e=i,this.IsTabVisible(e)||(t+=1);return t},this.GetLastScrollableTabIndex=function(){var t=0,e=0;t=0;for(var i=this.FTabs.GetCount()-1;i>=0;i--)if(e=i,this.IsTabVisible(e)&&this.IsTabEnabled(e)){t=e;break}return t},this.GetFirstScrollableTabIndex=function(){var t=0,e=0;t=0;for(var i=0,s=this.FTabs.GetCount()-1;i<=s;i++)if(e=i,this.IsTabVisible(e)&&this.IsTabEnabled(e)){t=e;break}return t},this.GetDisplayCount=function(){return this.FDisplayList.GetCount()},this.GetNormalDisplayCount=function(){var t=0;return t=this.GetDisplayCount(),1===this.FOptions.FInsertMode&&(t-=1),t},this.GetAdditionalTabSpacing=function(){var t=0;return t=0,1===this.FOptions.FInsertMode&&(t=t+this.FTabAppearance.FInsertSize+10),t},this.GetTabListButtonRect=function(){var t,e,i=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),s=pas["WEBLib.TMSFNCTypes"].TRectF.$new();s.$assign(this.GetMenuRect()),t=this.FButtonAppearance.FSize,e=this.ScalePaintValue(3);var o=this.FLayout.FPosition;return 1===o||2===o?this.FShowTabListButton?i.$assign(pas["WEBLib.TMSFNCTypes"].RectF(s.Right-e-t,s.Top+(s.Bottom-s.Top-t)/2,s.Right-e,s.Top+(s.Bottom-s.Top-t)/2+t)):i.$assign(pas["WEBLib.TMSFNCTypes"].RectF(s.Right,s.Top,s.Right,s.Bottom)):0!==o&&3!==o||(this.FShowTabListButton?i.$assign(pas["WEBLib.TMSFNCTypes"].RectF(s.Left+(s.Right-s.Left-t)/2,s.Bottom-e-t,s.Left+(s.Right-s.Left-t)/2+t,s.Bottom-e)):i.$assign(pas["WEBLib.TMSFNCTypes"].RectF(s.Left,s.Bottom,s.Right,s.Bottom))),i},this.GetCloseButtonRect=function(){var t,e=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),i=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),s=0;i.$assign(this.GetTabListButtonRect()),t=this.FButtonAppearance.FSize,s=this.FShowTabListButton?this.ScalePaintValue(6):this.ScalePaintValue(3);var o=this.FLayout.FPosition;return 1===o||2===o?this.FShowCloseButton?e.$assign(pas["WEBLib.TMSFNCTypes"].RectF(i.Left-s-t,i.Top+(i.Bottom-i.Top-t)/2,i.Left-s,i.Top+(i.Bottom-i.Top-t)/2+t)):e.$assign(pas["WEBLib.TMSFNCTypes"].RectF(i.Left,i.Top,i.Left,i.Bottom)):0!==o&&3!==o||(this.FShowCloseButton?e.$assign(pas["WEBLib.TMSFNCTypes"].RectF(i.Left+(i.Right-i.Left-t)/2,i.Top-s-t,i.Left+(i.Right-i.Left-t)/2+t,i.Top-s)):e.$assign(pas["WEBLib.TMSFNCTypes"].RectF(i.Left,i.Top,i.Right,i.Top))),e},this.GetInsertButtonRect=function(){var t,e=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),i=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),s=0;i.$assign(this.GetCloseButtonRect()),t=this.FButtonAppearance.FSize,s=this.FShowTabListButton||this.FShowCloseButton?6:3;var o=this.FLayout.FPosition;return 1===o||2===o?this.FShowInsertButton?e.$assign(pas["WEBLib.TMSFNCTypes"].RectF(i.Left-s-t,i.Top+(i.Bottom-i.Top-t)/2,i.Left-s,i.Top+(i.Bottom-i.Top-t)/2+t)):e.$assign(pas["WEBLib.TMSFNCTypes"].RectF(i.Left,i.Top,i.Left,i.Bottom)):0!==o&&3!==o||(this.FShowInsertButton?e.$assign(pas["WEBLib.TMSFNCTypes"].RectF(i.Left+(i.Right-i.Left-t)/2,i.Top-s-t,i.Left+(i.Right-i.Left-t)/2+t,i.Top-s)):e.$assign(pas["WEBLib.TMSFNCTypes"].RectF(i.Left,i.Top,i.Right,i.Top))),e},this.GetScrollButtonNextRect=function(){var t,e=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),i=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),s=0;i.$assign(this.GetInsertButtonRect()),t=this.FButtonAppearance.FSize,s=this.FShowTabListButton||this.FShowCloseButton||this.FShowInsertButton?this.ScalePaintValue(6):this.ScalePaintValue(3);var o=this.FLayout.FPosition;return 1===o||2===o?this.FShowScrollButtons?e.$assign(pas["WEBLib.TMSFNCTypes"].RectF(i.Left-s-t,i.Top+(i.Bottom-i.Top-t)/2,i.Left-s,i.Top+(i.Bottom-i.Top-t)/2+t)):e.$assign(pas["WEBLib.TMSFNCTypes"].RectF(i.Left,i.Top,i.Left,i.Bottom)):0!==o&&3!==o||(this.FShowScrollButtons?e.$assign(pas["WEBLib.TMSFNCTypes"].RectF(i.Left+(i.Right-i.Left-t)/2,i.Top-s-t,i.Left+(i.Right-i.Left-t)/2+t,i.Top-s)):e.$assign(pas["WEBLib.TMSFNCTypes"].RectF(i.Left,i.Top,i.Right,i.Top))),e},this.GetScrollButtonPreviousRect=function(){var t,e=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),i=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),s=0;i.$assign(this.GetScrollButtonNextRect()),t=this.FButtonAppearance.FSize,s=this.FShowScrollButtons?this.ScalePaintValue(6):this.ScalePaintValue(3);var o=this.FLayout.FPosition;return 1===o||2===o?this.FShowScrollButtons?e.$assign(pas["WEBLib.TMSFNCTypes"].RectF(i.Left-s-t,i.Top+(i.Bottom-i.Top-t)/2,i.Left-s,i.Top+(i.Bottom-i.Top-t)/2+t)):e.$assign(pas["WEBLib.TMSFNCTypes"].RectF(i.Left,i.Top,i.Left,i.Bottom)):0!==o&&3!==o||(this.FShowScrollButtons?e.$assign(pas["WEBLib.TMSFNCTypes"].RectF(i.Left+(i.Right-i.Left-t)/2,i.Top-s-t,i.Left+(i.Right-i.Left-t)/2+t,i.Top-s)):e.$assign(pas["WEBLib.TMSFNCTypes"].RectF(i.Left,i.Top,i.Right,i.Top))),e},this.IsButtonStateDown=function(){return 2===this.FTabListButtonState||2===this.FInsertButtonState||2===this.FCloseButtonState||2===this.FScrollButtonPreviousState||2===this.FScrollButtonNextState},this.DragTabDisplay=function(){var e=t.TTMSFNCTabSetDisplayTab.$new();return e.$assign(this.FDragTabDisplay),e},this.IsButtonStateChanged=function(){return this.FTabListButtonState!==this.FPrevTabListButtonState||this.FInsertButtonState!==this.FPrevInsertButtonState||this.FCloseButtonState!==this.FPrevCloseButtonState||this.FScrollButtonPreviousState!==this.FPrevScrollButtonPreviousState||this.FScrollButtonNextState!==this.FPrevScrollButtonNextState},this.GetNextTab=function(t){var e=0,i=0,s=0;if(e=t,t<0)return e;for(i=t,s=1;s<this.FTabs.GetCount();){if((i+=1)>=this.FTabs.GetCount()&&(i=0),t!==i&&this.IsTabVisible(i)&&this.IsTabEnabled(i)){e=i;break}s+=1}return e},this.GetPreviousTab=function(t){var e=0,i=0,s=0;if(e=t,t<0)return e;for(i=t,s=1;s<this.FTabs.GetCount();){if((i-=1)>=this.FTabs.GetCount()&&(i=0),i<0&&(i=this.FTabs.GetCount()-1),t!==i&&this.IsTabVisible(i)&&this.IsTabEnabled(i)){e=i;break}s+=1}return e},this.GetDisplayTab=function(i){var s=t.TTMSFNCTabSetDisplayTab.$new(),o=0,n=t.TTMSFNCTabSetDisplayTab.$new();s.$assign(e.EmptyDisplayTab());for(var r=0,a=this.GetNormalDisplayCount()-1;r<=a;r++)if(o=r,n.$assign(this.FDisplayList.GetItem(o)),null!=n.Tab&&n.Tab.GetIndex()===i){s.$assign(n);break}return s},this.HandleInsertTab=function(t){var e=null,i=0,s=!1;return e=null,i=this.FTabs.GetCount(),s=!0,this.DoBeforeInsertTab({get:function(){return i},set:function(t){i=t}},{get:function(){return s},set:function(t){s=t}}),s&&((e=this.FTabs.Add$1()).SetIndex(i),this.DoInsertTab(i),t.set(!0)),e},this.GetInplaceEditorRect=function(t){var e=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),i=pas["WEBLib.TMSFNCTypes"].TRectF.$new();return e.$assign(pas["WEBLib.TMSFNCTypes"].RectF(0,0,0,0)),null==t.Tab||(i.$assign(t.TextRect),pas["WEBLib.TMSFNCTypes"].InflateRectEx(i,2,0),e.$assign(pas["WEBLib.TMSFNCTypes"].RectF(pas.Math.Floor(i.Left),pas.Math.Floor(i.Top),Math.round(i.Right),Math.round(i.Bottom))),null!=this.FOnGetInplaceEditorRect&&this.FOnGetInplaceEditorRect(this,t.Tab.GetIndex(),this.FInplaceEditor,e)),e},this.XYToAnchor=function(t,e,i){var s="",o=null,n=0,r=0,a=!1,l=0;if(s="",null==t.Tab)return s;if(t.Tab.IsHTML()){o=pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.$create("CreateBitmapCanvas",[1,1,this.FNativeCanvas,!0]),this.FNativeCanvas||o.BeginScene(),o.FBitmapContainer=this.GetBitmapContainer(),o.FOptimizedHTMLDrawing=this.FOptimizedHTMLDrawing;try{o.FFont.Assign(this.FTabAppearance.FFont),t.Tab.FUseDefaultAppearance?(a=this.FTabAppearance.FWordWrapping,l=this.FTabAppearance.FTrimming,n=this.FTabAppearance.FTextAlign):(a=t.Tab.FWordWrapping,l=t.Tab.FTrimming,n=t.Tab.FTextAlign),r=0;var h=this.FLayout.FPosition;1===h||2===h?s=o.DrawText$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(t.TextRect),t.Tab.FText,a,n,r,l,0,-1,-1,!0,!0,e,i):0===h?s=o.DrawText$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(t.TextRect),t.Tab.FText,a,n,r,l,-90,-1,-1,!0,!0,e,i):3===h&&(s=o.DrawText$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(t.TextRect),t.Tab.FText,a,n,r,l,90,-1,-1,!0,!0,e,i))}finally{this.FNativeCanvas||o.EndScene(),o=rtl.freeLoc(o)}}return s},this.SetBitmapContainer=function(t){this.FBitmapContainer=t,this.UpdateTabs(!1,!1)},this.PopupListSelected=function(e){var i=null;this.FTabListPopup.SetIsOpen(!1),this.FTabList.GetItemIndex()>=0&&this.FTabList.GetItemIndex()<=this.FTabList.GetCount()-1&&null!=(i=rtl.as(this.FTabList.FItems.GetObject(this.FTabList.GetItemIndex()),t.TTMSFNCTabSetTab))&&i.SetVisible(!0)},this.ApplyStyle=function(){var t=0,e=0,i=0,s=0;pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.ApplyStyle.call(this),i=t=-1,pas["WEBLib.TMSFNCStyles"].TTMSFNCStyles.GetStyleBackgroundFillColor({get:function(){return t},set:function(e){t=e}})&&(i=t,this.FTabAppearance.FActiveFill.SetColor(t)),t=-1,e=-1,pas["WEBLib.TMSFNCStyles"].TTMSFNCStyles.GetStyleSelectionFillColor({get:function(){return t},set:function(e){t=e}})&&(e=t=pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.GetColorRed(t),pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.GetColorGreen(t),pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.GetColorBlue(t)),this.FTabAppearance.FHoverFill.SetColor(pas["WEBLib.TMSFNCGraphicsTypes"].Lighter(t,20)),this.FTabAppearance.FDownFill.SetColor(pas["WEBLib.TMSFNCGraphicsTypes"].Darker(t,20)),this.FTabAppearance.FFill.SetColor(t),this.FTabAppearance.FBadgeFill.SetColor(t),this.FButtonAppearance.FHoverFill.SetColor(this.FTabAppearance.FHoverFill.FColor),this.FButtonAppearance.FDownFill.SetColor(this.FTabAppearance.FDownFill.FColor),this.FButtonAppearance.FFill.SetColor(this.FTabAppearance.FFill.FColor)),t=-1,pas["WEBLib.TMSFNCStyles"].TTMSFNCStyles.GetStyleLineFillColor({get:function(){return t},set:function(e){t=e}})&&(this.FTabAppearance.FActiveStroke.SetColor(t),this.FTabAppearance.FStroke.SetColor(t),this.FTabAppearance.FHoverStroke.SetColor(t),this.FTabAppearance.FDownStroke.SetColor(t),this.FButtonAppearance.FStroke.SetColor(t),this.FButtonAppearance.FHoverStroke.SetColor(t),this.FButtonAppearance.FDownStroke.SetColor(t)),t=-1,pas["WEBLib.TMSFNCStyles"].TTMSFNCStyles.GetStyleTextFontColor({get:function(){return t},set:function(e){t=e}})&&(i!==t?this.FTabAppearance.SetActiveTextColor(t):16777215===t?this.FTabAppearance.SetActiveTextColor(8421504):this.FTabAppearance.SetActiveTextColor(pas["WEBLib.TMSFNCGraphicsTypes"].Darker(t,40)),e!==t?this.FTabAppearance.SetDownTextColor(t):16777215===t?this.FTabAppearance.SetDownTextColor(8421504):this.FTabAppearance.SetDownTextColor(pas["WEBLib.TMSFNCGraphicsTypes"].Darker(t,40)),e!==t?this.FTabAppearance.SetHoverTextColor(t):16777215===t?this.FTabAppearance.SetHoverTextColor(8421504):this.FTabAppearance.SetHoverTextColor(pas["WEBLib.TMSFNCGraphicsTypes"].Darker(t,40)),e!==t?this.FTabAppearance.SetTextColor(t):16777215===t?this.FTabAppearance.SetTextColor(8421504):this.FTabAppearance.SetTextColor(pas["WEBLib.TMSFNCGraphicsTypes"].Darker(t,40)));for(var o=0,n=this.FTabs.GetCount()-1;o<=n;o++)s=o,this.FTabs.GetTab(s).SetUseDefaultAppearance(!0);null!=this.FInsertTab&&this.FInsertTab.SetUseDefaultAppearance(!0)},this.ResetToDefaultStyle=function(){var t=0;pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.ResetToDefaultStyle.call(this),this.BeginUpdate(),this.FTabAppearance.FBadgeFill.SetColor(42495),this.FButtonAppearance.FHoverFill.SetColor(this.FTabAppearance.FHoverFill.FColor),this.FButtonAppearance.FDownFill.SetColor(this.FTabAppearance.FDownFill.FColor),this.FButtonAppearance.FFill.SetColor(this.FTabAppearance.FFill.FColor),this.FTabAppearance.FActiveStroke.SetColor(11119017),this.FTabAppearance.FStroke.SetColor(11119017),this.FTabAppearance.FHoverStroke.SetColor(11119017),this.FTabAppearance.FDownStroke.SetColor(11119017),this.FButtonAppearance.FStroke.SetColor(11119017),this.FButtonAppearance.FHoverStroke.SetColor(11119017),this.FButtonAppearance.FDownStroke.SetColor(11119017),this.FTabAppearance.FFill.SetColor(16578806),this.FTabAppearance.FHoverFill.SetColor(16380654),this.FTabAppearance.FDownFill.SetColor(15776936),this.FTabAppearance.FHoverStroke.SetColor(15702829),this.FTabAppearance.SetTextColor(8026746),this.FTabAppearance.SetActiveTextColor(4539717),this.FTabAppearance.FActiveFill.SetColor(16777215),this.FTabAppearance.SetHoverTextColor(this.FTabAppearance.FTextColor),this.FTabAppearance.SetDownTextColor(this.FTabAppearance.FActiveTextColor),this.FTabAppearance.FDownStroke.SetColor(this.FTabAppearance.FHoverStroke.FColor),this.FTabAppearance.FHoverFill.SetKind(1),this.FTabAppearance.FDownFill.SetKind(1),this.FTabAppearance.FActiveFill.SetKind(1),this.FTabAppearance.FFill.SetKind(1),this.FTabAppearance.SetShowFocus(!1);for(var e=0,i=this.FTabs.GetCount()-1;e<=i;e++)t=e,this.FTabs.GetTab(t).SetUseDefaultAppearance(!0);null!=this.FInsertTab&&this.FInsertTab.SetUseDefaultAppearance(!1),this.EndUpdate()},this.DoInvalidate=function(){},this.InitializeInvisibleTabs=function(){var t=0,e=null;this.FInvisibleTabList.Clear();for(var i=0,s=this.FTabs.GetCount()-1;i<=s;i++)t=i,(e=this.FTabs.GetTab(t)).FVisible||this.FInvisibleTabList.Add(e)},this.InitializeScrollButtonState=function(){this.FInteraction.FSelectTabOnScroll?(this.FScrollButtonPreviousDisabled=this.GetActiveTabIndex()===this.GetFirstScrollableTabIndex()||-1===this.GetActiveTabIndex(),this.FScrollButtonNextDisabled=this.GetActiveTabIndex()===this.GetLastScrollableTabIndex()||-1===this.GetActiveTabIndex()):(this.FScrollButtonPreviousDisabled=0===this.FStartTab,this.FScrollButtonNextDisabled=this.FScrollCount-this.FStartTab==0)},this.FillTabList=function(){var t=0;this.FTabList.SetParent(this),this.FTabList.FItems.Clear();for(var e=0,i=this.FInvisibleTabList.GetCount()-1;e<=i;e++)t=e,this.FTabList.FItems.AddObject(this.FInvisibleTabList.GetItem(t).GetFriendlyName(),this.FInvisibleTabList.GetItem(t));this.FTabList.SetParent(null)},this.SaveButtonState=function(){this.FPrevTabListButtonState=this.FTabListButtonState,this.FPrevCloseButtonState=this.FCloseButtonState,this.FPrevScrollButtonPreviousState=this.FScrollButtonPreviousState,this.FPrevScrollButtonNextState=this.FScrollButtonNextState,this.FPrevInsertButtonState=this.FInsertButtonState},this.ClearButtonState=function(){this.FTabListButtonState=0,this.FCloseButtonState=0,this.FScrollButtonPreviousState=0,this.FScrollButtonNextState=0,this.FInsertButtonState=0},this.HandleButtonDownState=function(t,e){this.XYToScrollPreviousButton(t,e)?this.FScrollButtonPreviousState=2:this.XYToScrollNextButton(t,e)?this.FScrollButtonNextState=2:this.XYToCloseButton(t,e)?this.FCloseButtonState=2:this.XYToInsertButton(t,e)?this.FInsertButtonState=2:this.XYToTabListButton(t,e)&&(this.FTabListButtonState=2)},this.HandleButtonHoverState=function(t,e){this.XYToScrollPreviousButton(t,e)?this.FScrollButtonPreviousState=1:this.XYToScrollNextButton(t,e)?this.FScrollButtonNextState=1:this.XYToCloseButton(t,e)?this.FCloseButtonState=1:this.XYToInsertButton(t,e)?this.FInsertButtonState=1:this.XYToTabListButton(t,e)&&(this.FTabListButtonState=1)},this.InitializeMenu=function(){this.FMenuSize=0,this.FShowCloseButton=2===this.FOptions.FCloseMode,this.FShowInsertButton=2===this.FOptions.FInsertMode,this.FShowTabListButton=this.GetInvisibleTabCount()>0&&this.FOptions.FTabListButton,this.FShowTabListButton&&(this.FMenuSize=this.FMenuSize+this.FButtonAppearance.FSize+8,this.FShowMenu=!0),this.FShowCloseButton&&(this.FMenuSize=this.FMenuSize+this.FButtonAppearance.FSize+8,this.FShowMenu=!0),this.FShowInsertButton&&(this.FMenuSize=this.FMenuSize+this.FButtonAppearance.FSize+8,this.FShowMenu=!0),this.FShowScrollButtons&&(this.FMenuSize=this.FMenuSize+2*(this.FButtonAppearance.FSize+8),this.FShowMenu=!0)},this.StartProgressAnimationTimer=function(){this.FAnimTimer.SetEnabled(!this.IsDesignTime())},this.Notification=function(t,e){pas["WEBLib.Menus"].TWebCustomControl.Notification.apply(this,arguments),1===e&&t===this.FBitmapContainer&&(this.FBitmapContainer=null)},this.CalculateRects=function(t){var e=pas["WEBLib.TMSFNCTypes"].TRectF.$new();e.$assign(t.Rect);var i=this.FLayout.FPosition;if(1===i||2===i){var s=this.FTabAppearance.FShape;0===s?t.ContentRect.$assign(pas["WEBLib.TMSFNCTypes"].RectF(e.Left+this.FTabAppearance.FShapeOverlap,e.Top,e.Right,e.Bottom)):1===s?t.ContentRect.$assign(pas["WEBLib.TMSFNCTypes"].RectF(e.Left+this.FTabAppearance.FShapeSlope,e.Top,e.Right,e.Bottom)):2===s?t.First||this.FActiveTab===t.Tab?t.ContentRect.$assign(pas["WEBLib.TMSFNCTypes"].RectF(e.Left,e.Top,e.Right-this.FTabAppearance.FShapeSlope,e.Bottom)):t.ContentRect.$assign(pas["WEBLib.TMSFNCTypes"].RectF(e.Left+this.FTabAppearance.FShapeSlope/2,e.Top,e.Right-this.FTabAppearance.FShapeSlope,e.Bottom)):3===s?t.ContentRect.$assign(pas["WEBLib.TMSFNCTypes"].RectF(e.Left+this.FTabAppearance.FShapeSlope,e.Top,e.Right-this.FTabAppearance.FShapeSlope,e.Bottom)):4===s?t.ContentRect.$assign(pas["WEBLib.TMSFNCTypes"].RectF(e.Left+this.FTabAppearance.FShapeSlope/2,e.Top,e.Right,e.Bottom)):5===s?t.First||this.FActiveTab===t.Tab?t.ContentRect.$assign(pas["WEBLib.TMSFNCTypes"].RectF(e.Left,e.Top,e.Right-this.FTabAppearance.FShapeSlope/2,e.Bottom)):t.ContentRect.$assign(pas["WEBLib.TMSFNCTypes"].RectF(e.Left+this.FTabAppearance.FShapeSlope/2,e.Top,e.Right-this.FTabAppearance.FShapeSlope/2,e.Bottom)):6===s&&t.ContentRect.$assign(pas["WEBLib.TMSFNCTypes"].RectF(e.Left+this.FTabAppearance.FShapeSlope/2,e.Top,e.Right-this.FTabAppearance.FShapeSlope/2,e.Bottom))}else if(0===i||3===i){var o=this.FTabAppearance.FShape;0===o?t.ContentRect.$assign(pas["WEBLib.TMSFNCTypes"].RectF(e.Left,e.Top+this.FTabAppearance.FShapeOverlap,e.Right,e.Bottom)):1===o?t.ContentRect.$assign(pas["WEBLib.TMSFNCTypes"].RectF(e.Left,e.Top+this.FTabAppearance.FShapeSlope,e.Right,e.Bottom)):2===o?t.First||this.FActiveTab===t.Tab?t.ContentRect.$assign(pas["WEBLib.TMSFNCTypes"].RectF(e.Left,e.Top,e.Right,e.Bottom-this.FTabAppearance.FShapeSlope)):t.ContentRect.$assign(pas["WEBLib.TMSFNCTypes"].RectF(e.Left,e.Top+this.FTabAppearance.FShapeSlope/2,e.Right,e.Bottom-this.FTabAppearance.FShapeSlope)):3===o?t.ContentRect.$assign(pas["WEBLib.TMSFNCTypes"].RectF(e.Left,e.Top+this.FTabAppearance.FShapeSlope,e.Right,e.Bottom-this.FTabAppearance.FShapeSlope)):4===o?t.ContentRect.$assign(pas["WEBLib.TMSFNCTypes"].RectF(e.Left,e.Top+this.FTabAppearance.FShapeSlope/2,e.Right,e.Bottom)):5===o?t.First||this.FActiveTab===t.Tab?t.ContentRect.$assign(pas["WEBLib.TMSFNCTypes"].RectF(e.Left,e.Top,e.Right,e.Bottom-this.FTabAppearance.FShapeSlope/2)):t.ContentRect.$assign(pas["WEBLib.TMSFNCTypes"].RectF(e.Left,e.Top+this.FTabAppearance.FShapeSlope/2,e.Right,e.Bottom-this.FTabAppearance.FShapeSlope/2)):6===o&&t.ContentRect.$assign(pas["WEBLib.TMSFNCTypes"].RectF(e.Left,e.Top+this.FTabAppearance.FShapeSlope/2,e.Right,e.Bottom-this.FTabAppearance.FShapeSlope/2))}t.ProgressRect.$assign(t.Tab.GetProgressRect(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(t.ContentRect))),t.BitmapRect.$assign(t.Tab.GetBitmapRect(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(t.ContentRect))),t.TextRect.$assign(t.Tab.GetTextRect(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(t.ContentRect))),t.CloseButtonRect.$assign(t.Tab.GetCloseButtonRect(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(t.ContentRect)))},this.FixStartTab=function(){var e=t.TTMSFNCTabSetDisplayTab.$new(),i=t.TTMSFNCTabSetDisplayTab.$new(),s=0,o=0,n=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),r=0,a=0;if(this.FDisplayList.GetCount()>0&&this.FStartTab>0&&2!==this.FTabSize.FMode&&this.FAllowScrolling&&0===this.FLayout.FMultiline&&this.FScrollCount>0&&this.FLastTabIndex===this.GetLastScrollableTabIndex()&&(i.$assign(this.FDisplayList.GetItem(this.FDisplayList.GetCount()-1)),e.$assign(this.FDisplayList.GetItem(0)),null!=i.Tab&&null!=e.Tab&&(r=this.GetPreviousTab(e.Tab.GetIndex()))>=0&&r<=this.FTabs.GetCount()-1)){n.$assign(this.GetTabRect()),o=this.GetTabSize(r);var l=this.FLayout.FPosition;1===l||2===l?(s=i.Rect.Right+o+this.FTabSize.FSpacing-this.FTabAppearance.FShapeOverlap,1===this.FOptions.FInsertMode?s+=this.GetAdditionalTabSpacing():s+=5,a=n.Right):0===l||3===l?(s=i.Rect.Bottom+o+this.FTabSize.FSpacing-this.FTabAppearance.FShapeOverlap,1===this.FOptions.FInsertMode?s+=this.GetAdditionalTabSpacing():s+=5,a=n.Bottom):(s=0,a=0),s<a&&(this.FStartTab-=1,this.FStartTab=Math.max(0,this.FStartTab),this.UpdateTabs(!1,!1))}},this.UpdateTabs=function(e,i){var s,o,n=0,r=t.TTMSFNCTabSetDisplayTab.$new(),a=t.TTMSFNCTabSetDisplayTab.$new(),l=0,h=0,F=0,p=0,c=0,u=0,C=0,T=0,S=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),d=0,m=0,f=0,g=0,y=0,M=0,b=0,N=0,B=pas["WEBLib.TMSFNCTypes"].TRectF.$new();if(!this.FTabChanging&&(this.FDisplayList.Clear(),this.FInvisibleTabList.Clear(),i||!(this.FUpdateCount$1>0||3 in this.FComponentState)))if(this.FShowMenu=!1,e||(this.FShowScrollButtons=!1),this.InitializeMenu(),0!==this.FTabs.GetCount()){S.$assign(this.GetTabRect()),l=S.Left,h=S.Top,d=0,M=0;var E=this.FLayout.FPosition;1===E||2===E?(c=this.FTabSize.FWidth,u=S.Bottom-S.Top):0===E||3===E?(c=S.Right-S.Left,u=this.FTabSize.FWidth):(c=0,u=0),s=this.GetVisibleTabCount();var D=this.FTabSize.FMode;if(0===D){var L=this.FLayout.FPosition;if(1===L||2===L){if((F=s>0?(S.Right-S.Left+(s-1)*this.FTabAppearance.FShapeOverlap-(s-1)*this.FTabSize.FSpacing-this.GetAdditionalTabSpacing())/s:0)>0)for(var G=0,A=this.FTabs.GetCount()-1;G<=A;G++)n=G,this.IsTabVisible(n)&&(r.First=!1,r.Last=!1,r.Tab=this.FTabs.GetTab(n),r.Rect.$assign(pas["WEBLib.TMSFNCTypes"].RectF(l,h,l+F,h+u)),r.Row=0,this.FDisplayList.Add(t.TTMSFNCTabSetDisplayTab.$clone(r)),l=l+F+this.FTabSize.FSpacing-this.FTabAppearance.FShapeOverlap);1===this.FOptions.FInsertMode&&(a.Tab=this.FInsertTab,a.TabKind=1,a.First=!1,a.Last=!1,a.Row=0,this.FDisplayList.GetCount()>0?a.Rect.$assign(pas["WEBLib.TMSFNCTypes"].RectF(l+5+this.FTabAppearance.FShapeOverlap,h,l+5+this.FTabAppearance.FShapeOverlap+this.FTabAppearance.FInsertSize,h+u)):a.Rect.$assign(pas["WEBLib.TMSFNCTypes"].RectF(l+5,h,l+5+this.FTabAppearance.FInsertSize,h+u)),this.FDisplayList.Add(t.TTMSFNCTabSetDisplayTab.$clone(a)))}else if(0===L||3===L){if((p=s>0?(S.Bottom-S.Top+(s-1)*this.FTabAppearance.FShapeOverlap-(s-1)*this.FTabSize.FSpacing-this.GetAdditionalTabSpacing())/s:0)>0)for(var I=0,P=this.FTabs.GetCount()-1;I<=P;I++)n=I,this.IsTabVisible(n)&&(r.First=!1,r.Last=!1,r.Tab=this.FTabs.GetTab(n),r.Rect.$assign(pas["WEBLib.TMSFNCTypes"].RectF(l,h,l+c,h+p)),r.Row=0,this.FDisplayList.Add(t.TTMSFNCTabSetDisplayTab.$clone(r)),h=h+p+this.FTabSize.FSpacing-this.FTabAppearance.FShapeOverlap);1===this.FOptions.FInsertMode&&(a.Tab=this.FInsertTab,a.TabKind=1,a.First=!1,a.Last=!1,a.Row=0,this.FDisplayList.GetCount()>0?a.Rect.$assign(pas["WEBLib.TMSFNCTypes"].RectF(l,h+5+this.FTabAppearance.FShapeOverlap,l+c,h+5+this.FTabAppearance.FShapeOverlap+this.FTabAppearance.FInsertSize)):a.Rect.$assign(pas["WEBLib.TMSFNCTypes"].RectF(l,h+5,l+c,h+5+this.FTabAppearance.FInsertSize)),this.FDisplayList.Add(t.TTMSFNCTabSetDisplayTab.$clone(a)))}}else if(1===D||2===D||3===D){T=0,2!==this.FTabSize.FMode&&this.FAllowScrolling&&0===this.FLayout.FMultiline&&(T=this.FStartTab),b=this.FTabs.GetCount(),1===this.FOptions.FInsertMode&&(b+=1);for(var w=T,$=b-1;w<=$;w++)if((n=w)<=this.FTabs.GetCount()-1&&this.IsTabVisible(n)||n>this.FTabs.GetCount()-1){var R=this.FLayout.FPosition;if(1===R||2===R){if((F=this.GetTabSize(n))>0)if(n===b-1&&1===this.FOptions.FInsertMode?(r.Tab=this.FInsertTab,r.TabKind=1,r.First=!1,r.Last=!1,r.Row=d,this.FDisplayList.GetCount()>0?(r.Rect.$assign(pas["WEBLib.TMSFNCTypes"].RectF(l+5+this.FTabAppearance.FShapeOverlap,h,l+5+this.FTabAppearance.FShapeOverlap+F,h+u)),m=l+F+5+this.FTabAppearance.FShapeOverlap):(r.Rect.$assign(pas["WEBLib.TMSFNCTypes"].RectF(l+5,h,l+5+F,h+u)),m=l+F+5),this.FDisplayList.Add(t.TTMSFNCTabSetDisplayTab.$clone(r))):(r.First=0===this.FDisplayList.GetCount(),r.Last=!1,r.Tab=this.FTabs.GetTab(n),r.Row=d,r.Rect.$assign(pas["WEBLib.TMSFNCTypes"].RectF(l,h,l+F,h+u)),n===this.GetActiveTabIndex()&&(M=d),this.FDisplayList.Add(t.TTMSFNCTabSetDisplayTab.$clone(r)),m=l+F+this.FTabSize.FSpacing,1===this.FOptions.FInsertMode&&n===b-2&&(m=m+this.FTabAppearance.FInsertSize+5)),g=S.Right,1===this.FOptions.FInsertMode?g-=this.GetAdditionalTabSpacing():g-=5,m>g&&this.FAllowScrolling&&this.FDisplayList.GetCount()>1&&(n<b-1&&1===this.FOptions.FInsertMode||1!==this.FOptions.FInsertMode)){if(d+=1,2===this.FTabSize.FMode||0===this.FLayout.FMultiline){this.FDisplayList.Remove(t.TTMSFNCTabSetDisplayTab.$clone(r));break}l=S.Left;var v=this.FLayout.FPosition;1===v?h+=u:2===v&&(h-=u),r.Rect.$assign(pas["WEBLib.TMSFNCTypes"].RectF(l,h,l+F,h+u)),r.First=!0,r.Row=d,n===this.GetActiveTabIndex()&&(M=d),this.FDisplayList.SetItem(this.FDisplayList.GetCount()-1,r),this.FDisplayList.GetCount()>1&&(r.$assign(this.FDisplayList.GetItem(this.FDisplayList.GetCount()-2)),r.Last=!0,this.FDisplayList.SetItem(this.FDisplayList.GetCount()-2,r)),l=m=l+F+this.FTabSize.FSpacing-this.FTabAppearance.FShapeOverlap}else 1===this.FOptions.FInsertMode&&n===b-2&&(m=m-this.FTabAppearance.FInsertSize-5),l=m-this.FTabAppearance.FShapeOverlap}else if((0===R||3===R)&&(p=this.GetTabSize(n))>0)if(n===b-1&&1===this.FOptions.FInsertMode?(r.Tab=this.FInsertTab,r.TabKind=1,r.First=!1,r.Last=!1,r.Row=d,this.FDisplayList.GetCount()>0?(r.Rect.$assign(pas["WEBLib.TMSFNCTypes"].RectF(l,h+5+this.FTabAppearance.FShapeOverlap,l+c,h+5+this.FTabAppearance.FShapeOverlap+p)),f=h+p+5+this.FTabAppearance.FShapeOverlap):(r.Rect.$assign(pas["WEBLib.TMSFNCTypes"].RectF(l,h+5,l+c,h+5+p)),f=h+p+5),this.FDisplayList.Add(t.TTMSFNCTabSetDisplayTab.$clone(r))):(r.First=0===this.FDisplayList.GetCount(),r.Last=!1,r.Tab=this.FTabs.GetTab(n),r.Row=d,r.Rect.$assign(pas["WEBLib.TMSFNCTypes"].RectF(l,h,l+c,h+p)),n===this.GetActiveTabIndex()&&(M=d),this.FDisplayList.Add(t.TTMSFNCTabSetDisplayTab.$clone(r)),f=h+p+this.FTabSize.FSpacing,1===this.FOptions.FInsertMode&&n===b-2&&(f=f+this.FTabAppearance.FInsertSize+5)),y=S.Bottom,1===this.FOptions.FInsertMode?y-=this.GetAdditionalTabSpacing():y-=5,f>y&&this.FAllowScrolling&&this.FDisplayList.GetCount()>1&&(n<b-1&&1===this.FOptions.FInsertMode||1!==this.FOptions.FInsertMode)){if(d+=1,2===this.FTabSize.FMode||0===this.FLayout.FMultiline){this.FDisplayList.Remove(t.TTMSFNCTabSetDisplayTab.$clone(r));break}h=S.Top;var W=this.FLayout.FPosition;0===W?l+=c:3===W&&(l-=c),r.Rect.$assign(pas["WEBLib.TMSFNCTypes"].RectF(l,h,l+c,h+p)),r.First=!0,r.Row=d,n===this.GetActiveTabIndex()&&(M=d),this.FDisplayList.SetItem(this.FDisplayList.GetCount()-1,r),this.FDisplayList.GetCount()>1&&(r.$assign(this.FDisplayList.GetItem(this.FDisplayList.GetCount()-2)),r.Last=!0,this.FDisplayList.SetItem(this.FDisplayList.GetCount()-2,r)),h=f=h+p+this.FTabSize.FSpacing-this.FTabAppearance.FShapeOverlap}else 1===this.FOptions.FInsertMode&&n===b-2&&(f=f-this.FTabAppearance.FInsertSize-5),h=f-this.FTabAppearance.FShapeOverlap}if(d+this.FStartTab>0&&this.GetDisplayCount()>0)if(2===this.FTabSize.FMode){l=S.Left,h=S.Top,this.FDisplayList.Clear();var O=this.FLayout.FPosition;if(1===O||2===O){if((F=s>0?(S.Right-S.Left+(s-1)*this.FTabAppearance.FShapeOverlap-(s-1)*this.FTabSize.FSpacing-this.GetAdditionalTabSpacing())/s:0)>0)for(var x=0,k=this.FTabs.GetCount()-1;x<=k;x++)n=x,this.IsTabVisible(n)&&(r.First=!1,r.Last=!1,r.Tab=this.FTabs.GetTab(n),r.Row=0,r.Rect.$assign(pas["WEBLib.TMSFNCTypes"].RectF(l,h,l+F,h+u)),this.FDisplayList.Add(t.TTMSFNCTabSetDisplayTab.$clone(r)),l=l+F+this.FTabSize.FSpacing-this.FTabAppearance.FShapeOverlap);1===this.FOptions.FInsertMode&&(a.Tab=this.FInsertTab,a.TabKind=1,a.First=!1,a.Last=!1,a.Row=0,this.FDisplayList.GetCount()>0?a.Rect.$assign(pas["WEBLib.TMSFNCTypes"].RectF(l+5+this.FTabAppearance.FShapeOverlap,h,l+5+this.FTabAppearance.FShapeOverlap+this.FTabAppearance.FInsertSize,h+u)):a.Rect.$assign(pas["WEBLib.TMSFNCTypes"].RectF(l+5,h,l+5+this.FTabAppearance.FInsertSize,h+u)),this.FDisplayList.Add(t.TTMSFNCTabSetDisplayTab.$clone(a)))}else if(0===O||3===O){if((p=s>0?(S.Bottom-S.Top+(s-1)*this.FTabAppearance.FShapeOverlap-(s-1)*this.FTabSize.FSpacing-this.GetAdditionalTabSpacing())/s:0)>0)for(var V=0,H=this.FTabs.GetCount()-1;V<=H;V++)n=V,this.IsTabVisible(n)&&(r.First=!1,r.Last=!1,r.Tab=this.FTabs.GetTab(n),r.Row=0,r.Rect.$assign(pas["WEBLib.TMSFNCTypes"].RectF(l,h,l+c,h+p)),this.FDisplayList.Add(t.TTMSFNCTabSetDisplayTab.$clone(r)),h=h+p+this.FTabSize.FSpacing-this.FTabAppearance.FShapeOverlap);1===this.FOptions.FInsertMode&&(a.Tab=this.FInsertTab,a.TabKind=1,a.First=!1,a.Last=!1,a.Row=0,this.FDisplayList.GetCount()>0?a.Rect.$assign(pas["WEBLib.TMSFNCTypes"].RectF(l,h+5+this.FTabAppearance.FShapeOverlap,l+c,h+5+this.FTabAppearance.FShapeOverlap+this.FTabAppearance.FInsertSize)):a.Rect.$assign(pas["WEBLib.TMSFNCTypes"].RectF(l,h+5,l+c,h+5+this.FTabAppearance.FInsertSize)),this.FDisplayList.Add(t.TTMSFNCTabSetDisplayTab.$clone(a)))}}else if(0===this.FLayout.FMultiline)if(!this.FShowScrollButtons&&this.FAllowScrolling)this.FShowScrollButtons=!0,this.UpdateTabs(!0,i);else if(1===this.FOptions.FInsertMode&&d>0){var U=this.FLayout.FPosition;1===U||2===U?(a.Tab=this.FInsertTab,a.TabKind=1,a.First=!1,a.Last=!1,a.Row=d,r.$assign(this.FDisplayList.GetItem(this.FDisplayList.GetCount()-1)),a.Rect.$assign(pas["WEBLib.TMSFNCTypes"].RectF(r.Rect.Right+5,r.Rect.Top,r.Rect.Right+5+this.FTabAppearance.FInsertSize,r.Rect.Top+u)),this.FDisplayList.Add(t.TTMSFNCTabSetDisplayTab.$clone(a))):0!==U&&3!==U||(a.Tab=this.FInsertTab,a.TabKind=1,a.First=!1,a.Last=!1,a.Row=d,r.$assign(this.FDisplayList.GetItem(this.FDisplayList.GetCount()-1)),a.Rect.$assign(pas["WEBLib.TMSFNCTypes"].RectF(r.Rect.Left,r.Rect.Bottom+5,r.Rect.Left+c,r.Rect.Bottom+5+this.FTabAppearance.FInsertSize)),this.FDisplayList.Add(t.TTMSFNCTabSetDisplayTab.$clone(a)))}}o=d>0&&2===this.FLayout.FMultiline&&-1!==this.GetActiveTabIndex()&&(1===this.FTabSize.FMode||3===this.FTabSize.FMode);for(var z=0,K=this.GetNormalDisplayCount()-1;z<=K;z++){if(n=z,r.$assign(this.FDisplayList.GetItem(n)),r.Index=n,r.TabKind=0,0===n&&(r.First=!0,null!=r.Tab&&(this.FFirstTabIndex=r.Tab.GetIndex())),n===this.GetNormalDisplayCount()-1&&(r.Last=!0,null!=r.Tab&&(this.FLastTabIndex=r.Tab.GetIndex())),o){N=0;var j=this.FLayout.FPosition;C=0===j||3===j?c:1===j||2===j?u:0,r.Row===M?N=(d-M)*C:r.Row>M&&(N=-C);var Y=this.FLayout.FPosition;0===Y?r.Rect.$assign(pas["WEBLib.TMSFNCTypes"].RectF(r.Rect.Left+N,r.Rect.Top,r.Rect.Right+N,r.Rect.Bottom)):1===Y?r.Rect.$assign(pas["WEBLib.TMSFNCTypes"].RectF(r.Rect.Left,r.Rect.Top+N,r.Rect.Right,r.Rect.Bottom+N)):2===Y?r.Rect.$assign(pas["WEBLib.TMSFNCTypes"].RectF(r.Rect.Left,r.Rect.Top-N,r.Rect.Right,r.Rect.Bottom-N)):3===Y&&r.Rect.$assign(pas["WEBLib.TMSFNCTypes"].RectF(r.Rect.Left-N,r.Rect.Top,r.Rect.Right-N,r.Rect.Bottom))}this.CalculateRects(r),this.FDisplayList.SetItem(n,r)}if(1===this.FOptions.FInsertMode&&this.FDisplayList.GetCount()>0&&(a.$assign(this.FDisplayList.GetItem(this.FDisplayList.GetCount()-1)),null!=a.Tab)){B.$assign(a.Rect);var q=this.FLayout.FPosition;if(0===q||3===q?a.Rect.$assign(pas["WEBLib.TMSFNCTypes"].RectF(B.Left+(B.Right-B.Left-this.FTabAppearance.FInsertSize)/2,B.Top,B.Left+(B.Right-B.Left-this.FTabAppearance.FInsertSize)/2+this.FTabAppearance.FInsertSize,B.Bottom)):1!==q&&2!==q||a.Rect.$assign(pas["WEBLib.TMSFNCTypes"].RectF(B.Left,B.Top+(B.Bottom-B.Top-this.FTabAppearance.FInsertSize)/2,B.Right,B.Top+(B.Bottom-B.Top-this.FTabAppearance.FInsertSize)/2+this.FTabAppearance.FInsertSize)),o){N=0;var X=this.FLayout.FPosition;C=0===X||3===X?c:1===X||2===X?u:0,r.Row===M?N=(d-M)*C:r.Row>M&&(N=-C);var J=this.FLayout.FPosition;0===J?a.Rect.$assign(pas["WEBLib.TMSFNCTypes"].RectF(a.Rect.Left+N,a.Rect.Top,a.Rect.Right+N,a.Rect.Bottom)):1===J?a.Rect.$assign(pas["WEBLib.TMSFNCTypes"].RectF(a.Rect.Left,a.Rect.Top+N,a.Rect.Right,a.Rect.Bottom+N)):2===J?a.Rect.$assign(pas["WEBLib.TMSFNCTypes"].RectF(a.Rect.Left,a.Rect.Top-N,a.Rect.Right,a.Rect.Bottom-N)):3===J&&a.Rect.$assign(pas["WEBLib.TMSFNCTypes"].RectF(a.Rect.Left-N,a.Rect.Top,a.Rect.Right-N,a.Rect.Bottom))}B.$assign(a.Rect),a.BitmapRect.$assign(pas["WEBLib.TMSFNCTypes"].RectF(pas.Math.Floor(B.Left),pas.Math.Floor(B.Top),pas.Math.Floor(B.Right),pas.Math.Floor(B.Bottom))),this.FDisplayList.SetItem(this.FDisplayList.GetCount()-1,a)}this.FActiveTabIndex>=0&&this.FActiveTabIndex<=this.FTabs.GetCount()-1?this.FActiveTab=this.FTabs.GetTab(this.FActiveTabIndex):this.FActiveTab=null,this.FScrollCount=0,2!==this.FTabSize.FMode&&0===this.FLayout.FMultiline&&this.FAllowScrolling&&(this.FScrollCount=this.FTabs.GetCount()-this.GetNormalDisplayCount()-this.GetInvisibleTabCountForScrolling()),this.InitializeScrollButtonState(),this.InitializeInvisibleTabs(),this.StartProgressAnimationTimer(),this.FixStartTab(),0!==this.FLayout.FMultiline&&this.FTabSize.FMode in rtl.createSet(1,3)?this.FTotalTabHeight=(d+1)*this.FTabSize.FHeight:this.FTotalTabHeight=this.FTabSize.FHeight,this.Invalidate()}else this.Invalidate()},this.DoBeforeDrawMenuButton=function(t,e,i,s,o){null!=this.FOnBeforeDrawMenuButton&&this.FOnBeforeDrawMenuButton(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i,s,o)},this.DoAfterDrawMenuButton=function(t,e,i,s){null!=this.FOnAfterDrawMenuButton&&this.FOnAfterDrawMenuButton(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i,s)},this.DoBeforeDrawTabBackground=function(t,e,i,s,o){null!=this.FOnBeforeDrawTabBackground&&this.FOnBeforeDrawTabBackground(this,t,e,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),s,o)},this.DoBeforeDrawTabProgress=function(t,e,i,s,o,n,r,a,l,h){null!=this.FOnBeforeDrawTabProgress&&this.FOnBeforeDrawTabProgress(this,t,e,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),s,o,n,r,a,l,h)},this.DoBeforeDrawTabBadge=function(t,e,i,s,o){null!=this.FOnBeforeDrawTabBadge&&this.FOnBeforeDrawTabBadge(this,t,e,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),s,o)},this.DoBeforeDrawTabText=function(t,e,i,s,o){null!=this.FOnBeforeDrawTabText&&this.FOnBeforeDrawTabText(this,t,e,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),s,o)},this.DoBeforeDrawTabCloseButton=function(t,e,i,s,o){null!=this.FOnBeforeDrawTabCloseButton&&this.FOnBeforeDrawTabCloseButton(this,t,e,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),s,o)},this.DoBeforeDrawTabBitmap=function(t,e,i,s){null!=this.FOnBeforeDrawTabBitmap&&this.FOnBeforeDrawTabBitmap(this,t,e,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),s)},this.DoAfterDrawTabBackground=function(t,e,i,s){null!=this.FOnAfterDrawTabBackground&&this.FOnAfterDrawTabBackground(this,t,e,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),s)},this.DoAfterDrawTabProgress=function(t,e,i,s,o,n,r,a,l){null!=this.FOnAfterDrawTabProgress&&this.FOnAfterDrawTabProgress(this,t,e,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),s,o,n,r,a,l)},this.DoAfterDrawTabBadge=function(t,e,i,s){null!=this.FOnAfterDrawTabBadge&&this.FOnAfterDrawTabBadge(this,t,e,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),s)},this.DoAfterDrawTabText=function(t,e,i,s){null!=this.FOnAfterDrawTabText&&this.FOnAfterDrawTabText(this,t,e,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),s)},this.DoAfterDrawTabCloseButton=function(t,e,i,s){null!=this.FOnAfterDrawTabCloseButton&&this.FOnAfterDrawTabCloseButton(this,t,e,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),s)},this.DoAfterDrawTabBitmap=function(t,e,i){null!=this.FOnAfterDrawTabBitmap&&this.FOnAfterDrawTabBitmap(this,t,e,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i))},this.DoBeforeChangeTab=function(t,e,i){null!=this.FOnBeforeChangeTab&&this.FOnBeforeChangeTab(this,t,e,i)},this.DoChangeTab=function(t,e){null!=this.FOnChangeTab&&this.FOnChangeTab(this,t,e)},this.DoBeforeReorderTab=function(t,e,i){null!=this.FOnBeforeReorderTab&&this.FOnBeforeReorderTab(this,t,e,i)},this.DoReorderTab=function(t,e){null!=this.FOnReorderTab&&this.FOnReorderTab(this,t,e)},this.DoBeforeCloseTab=function(t,e){null!=this.FOnBeforeCloseTab&&this.FOnBeforeCloseTab(this,t,e)},this.DoCloseTab=function(t,e){null!=this.FOnCloseTab&&this.FOnCloseTab(this,t,e)},this.DoBeforeInsertTab=function(t,e){null!=this.FOnBeforeInsertTab&&this.FOnBeforeInsertTab(this,t,e)},this.DoInsertTab=function(t){null!=this.FOnInsertTab&&this.FOnInsertTab(this,t)},this.DoAnchorTabClick=function(t,e){this.FInteraction.FAutoOpenURL?pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.OpenURL(e):null!=this.FOnAnchorTabClick&&this.FOnAnchorTabClick(this,t,e)},this.Draw=function(t,e){var i=null,s=pas["WEBLib.TMSFNCTypes"].TRectF.$new();pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Draw.apply(this,arguments),i=t.SaveState(!1),this.DrawCustom(t),s.$assign(this.GetLocalRect()),pas["WEBLib.TMSFNCTypes"].InflateRectEx(s,-1,-1),t.ClipRect(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(s)),t.FBitmapContainer=this.GetBitmapContainer(),this.DrawTabs(t),this.DrawBadges(t),this.DrawMenu(t),t.RestoreState(i,!1)},this.DrawTabs=function(i){var s=0,o=t.TTMSFNCTabSetDisplayTab.$new(),n=t.TTMSFNCTabSetDisplayTab.$new(),r=null;n.$assign(e.EmptyDisplayTab());for(var a=this.GetDisplayCount()-1;a>=0;a--)if(s=a,o.$assign(this.FDisplayList.GetItem(s)),null!=(r=o.Tab))if(r===this.FActiveTab)n.$assign(o);else{if(r===this.FDragTab)continue;r.Draw(i,t.TTMSFNCTabSetDisplayTab.$clone(o))}null!=this.FActiveTab&&this.FActiveTab!==this.FDragTab&&null!=n.Tab&&this.FActiveTab.Draw(i,t.TTMSFNCTabSetDisplayTab.$clone(n)),null!=this.FDragTab&&null!=this.FDragTabDisplay.Tab&&this.FDragTab.Draw(i,t.TTMSFNCTabSetDisplayTab.$clone(this.FDragTabDisplay))},this.DrawCustom=function(t){},this.DrawBadges=function(e){for(var i=0,s=t.TTMSFNCTabSetDisplayTab.$new(),o=null,n=this.GetDisplayCount()-1;n>=0;n--)i=n,s.$assign(this.FDisplayList.GetItem(i)),null!=(o=s.Tab)&&o.DrawBadge(e,t.TTMSFNCTabSetDisplayTab.$clone(s))},this.DrawMenu=function(t){var e=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),i=null,s=!1;if(this.FShowTabListButton){var o=this.FTabListButtonState;0===o?(t.FFill.Assign(this.FButtonAppearance.FFill),t.FStroke.Assign(this.FButtonAppearance.FStroke)):1===o?(t.FFill.Assign(this.FButtonAppearance.FHoverFill),t.FStroke.Assign(this.FButtonAppearance.FHoverStroke)):2===o&&(t.FFill.Assign(this.FButtonAppearance.FDownFill),t.FStroke.Assign(this.FButtonAppearance.FDownStroke)),e.$assign(this.GetTabListButtonRect()),s=!0,this.DoBeforeDrawMenuButton(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),2,this.FTabListButtonState,{get:function(){return s},set:function(t){s=t}}),s&&(t.DrawRoundRectangle$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),this.FButtonAppearance.FRounding,rtl.createSet(0,1,2,3),2),null!=(i=this.FButtonAppearance.FTabListIcon)&&t.DrawBitmap$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i,!0,!1,!0,!1),this.DoAfterDrawMenuButton(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),2,this.FTabListButtonState))}if(this.FShowCloseButton){var n=this.FCloseButtonState;0===n?(t.FFill.Assign(this.FButtonAppearance.FFill),t.FStroke.Assign(this.FButtonAppearance.FStroke)):1===n?(t.FFill.Assign(this.FButtonAppearance.FHoverFill),t.FStroke.Assign(this.FButtonAppearance.FHoverStroke)):2===n&&(t.FFill.Assign(this.FButtonAppearance.FDownFill),t.FStroke.Assign(this.FButtonAppearance.FDownStroke)),e.$assign(this.GetCloseButtonRect()),s=!0,this.DoBeforeDrawMenuButton(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),0,this.FCloseButtonState,{get:function(){return s},set:function(t){s=t}}),s&&(t.DrawRoundRectangle$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),this.FButtonAppearance.FRounding,rtl.createSet(0,1,2,3),2),null!=(i=this.FButtonAppearance.FCloseIcon)&&t.DrawBitmap$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i,!0,!1,!0,!1),this.DoAfterDrawMenuButton(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),0,this.FCloseButtonState))}if(this.FShowInsertButton){var r=this.FInsertButtonState;0===r?(t.FFill.Assign(this.FButtonAppearance.FFill),t.FStroke.Assign(this.FButtonAppearance.FStroke)):1===r?(t.FFill.Assign(this.FButtonAppearance.FHoverFill),t.FStroke.Assign(this.FButtonAppearance.FHoverStroke)):2===r&&(t.FFill.Assign(this.FButtonAppearance.FDownFill),t.FStroke.Assign(this.FButtonAppearance.FDownStroke)),e.$assign(this.GetInsertButtonRect()),s=!0,this.DoBeforeDrawMenuButton(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),1,this.FInsertButtonState,{get:function(){return s},set:function(t){s=t}}),s&&(t.DrawRoundRectangle$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),this.FButtonAppearance.FRounding,rtl.createSet(0,1,2,3),2),null!=(i=this.FButtonAppearance.FInsertIcon)&&t.DrawBitmap$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i,!0,!1,!0,!1),this.DoAfterDrawMenuButton(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),1,this.FInsertButtonState))}if(this.FShowScrollButtons){if(this.FScrollButtonPreviousDisabled)t.FFill.Assign(this.FButtonAppearance.FDisabledFill),t.FStroke.Assign(this.FButtonAppearance.FDisabledStroke);else{var a=this.FScrollButtonPreviousState;0===a?(t.FFill.Assign(this.FButtonAppearance.FFill),t.FStroke.Assign(this.FButtonAppearance.FStroke)):1===a?(t.FFill.Assign(this.FButtonAppearance.FHoverFill),t.FStroke.Assign(this.FButtonAppearance.FHoverStroke)):2===a&&(t.FFill.Assign(this.FButtonAppearance.FDownFill),t.FStroke.Assign(this.FButtonAppearance.FDownStroke))}if(e.$assign(this.GetScrollButtonPreviousRect()),s=!0,this.FScrollButtonPreviousDisabled?this.DoBeforeDrawMenuButton(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),3,3,{get:function(){return s},set:function(t){s=t}}):this.DoBeforeDrawMenuButton(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),3,this.FScrollButtonPreviousState,{get:function(){return s},set:function(t){s=t}}),s&&(t.DrawRoundRectangle$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),this.FButtonAppearance.FRounding,rtl.createSet(0,1,2,3),2),null!=(i=this.FButtonAppearance.FScrollPreviousIcon)&&t.DrawBitmap$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i,!0,!1,!0,!1),this.FScrollButtonPreviousDisabled?this.DoAfterDrawMenuButton(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),3,3):this.DoAfterDrawMenuButton(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),3,this.FScrollButtonPreviousState)),this.FScrollButtonNextDisabled)t.FFill.Assign(this.FButtonAppearance.FDisabledFill),t.FStroke.Assign(this.FButtonAppearance.FDisabledStroke);else{var l=this.FScrollButtonNextState;0===l?(t.FFill.Assign(this.FButtonAppearance.FFill),t.FStroke.Assign(this.FButtonAppearance.FStroke)):1===l?(t.FFill.Assign(this.FButtonAppearance.FHoverFill),t.FStroke.Assign(this.FButtonAppearance.FHoverStroke)):2===l&&(t.FFill.Assign(this.FButtonAppearance.FDownFill),t.FStroke.Assign(this.FButtonAppearance.FDownStroke))}e.$assign(this.GetScrollButtonNextRect()),s=!0,this.FScrollButtonNextDisabled?this.DoBeforeDrawMenuButton(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),4,3,{get:function(){return s},set:function(t){s=t}}):this.DoBeforeDrawMenuButton(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),4,this.FScrollButtonNextState,{get:function(){return s},set:function(t){s=t}}),s&&(t.DrawRoundRectangle$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),this.FButtonAppearance.FRounding,rtl.createSet(0,1,2,3),2),null!=(i=this.FButtonAppearance.FScrollNextIcon)&&t.DrawBitmap$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i,!0,!1,!0,!1),this.FScrollButtonNextDisabled?this.DoAfterDrawMenuButton(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),4,3):this.DoAfterDrawMenuButton(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),4,this.FScrollButtonNextState))}},this.HandleMouseDown=function(e,i,s,o){var n=t.TTMSFNCTabSetDisplayTab.$new(),r=t.TTMSFNCTabSetDisplayTab.$new();pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleMouseDown.apply(this,arguments),1!==e&&(this.FDownX=s,this.FDownY=o,this.FDownCount=0,this.FDragDownX=s,this.FDragDownY=o,this.CaptureEx(),!this.FDblClicked&&(this.CanFocus()&&this.SetFocus(),this.FInplaceEditorActive&&(this.CloseInplaceEditor(!1),this.FInplaceEditorActive))||(this.FDblClicked=!1,n.$assign(this.XYToTab(s,o,null)),r.$assign(this.XYToCloseTab(s,o)),null!=r.Tab?this.FDownCloseTab=r.Tab:null==n.Tab||this.XYToScrollNextButton(s,o)||this.XYToScrollPreviousButton(s,o)?(this.SaveButtonState(),this.ClearButtonState(),this.HandleButtonDownState(s,o),this.IsButtonStateDown()&&this.StartDownTimer()):(this.FTabAnchor=this.XYToAnchor(t.TTMSFNCTabSetDisplayTab.$clone(n),s,o),""===this.FTabAnchor&&n.Tab.FEnabled&&(this.FDownTab=n.Tab,this.FDragTabDisplay.$assign(this.GetDisplayTab(this.FDownTab.GetIndex())),this.FOrigRect$1.$assign(this.FDragTabDisplay.Rect))),this.Invalidate()))},this.HandleMouseMove=function(e,i,s){var o=t.TTMSFNCTabSetDisplayTab.$new(),n=t.TTMSFNCTabSetDisplayTab.$new(),r=0,a=!1,l=pas["WEBLib.TMSFNCTypes"].TRectF.$new();if(pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleMouseMove.apply(this,arguments),null==this.FDownTab&&null==this.FDownCloseTab)o.$assign(this.XYToTab(i,s,null)),this.FPrevHoverTab=this.FHoverTab,this.FHoverTab=o.Tab,null==this.FHoverTab||this.XYToScrollNextButton(i,s)||this.XYToScrollPreviousButton(i,s)?this.IsButtonStateDown()||(this.SetControlCursor(0),this.FPrevHoverCloseTab=null,this.FHoverCloseTab=null,this.SaveButtonState(),this.ClearButtonState(),this.HandleButtonHoverState(i,s)):(n.$assign(this.XYToCloseTab(i,s)),this.FPrevHoverCloseTab=this.FHoverCloseTab,this.FHoverCloseTab=n.Tab,null==this.FHoverCloseTab&&(""!==this.XYToAnchor(t.TTMSFNCTabSetDisplayTab.$clone(o),i,s)&&this.FHoverTab.IsHTML()?this.SetControlCursor(21):this.SetControlCursor(0))),this.FHoverTab!==this.FPrevHoverTab&&this.CancelHint(),(this.FHoverTab!==this.FPrevHoverTab||this.FPrevHoverCloseTab!==this.FHoverCloseTab||this.IsButtonStateChanged()&&!this.IsButtonStateDown())&&this.Invalidate();else if(null==this.FDownCloseTab&&this.FInteraction.FReorder&&(Math.abs(this.FDownX-i)>3||Math.abs(this.FDownY-s)>3)){this.FDragTab=this.FDownTab,l.$assign(this.GetTabRect());var h=this.FLayout.FPosition;1===h||2===h?(r=i-this.FDragDownX,this.FOrigRect$1.Left+r<l.Left?r=l.Left-this.FOrigRect$1.Left:this.FOrigRect$1.Right+r>l.Right&&(r=l.Right-this.FOrigRect$1.Right),this.FDragTabDisplay.Rect.$assign(pas["WEBLib.TMSFNCTypes"].RectF(this.FOrigRect$1.Left+r,this.FOrigRect$1.Top,this.FOrigRect$1.Right+r,this.FOrigRect$1.Bottom))):0!==h&&3!==h||(r=s-this.FDragDownY,this.FOrigRect$1.Top+r<l.Top?r=l.Top-this.FOrigRect$1.Top:this.FOrigRect$1.Bottom+r>l.Bottom&&(r=l.Bottom-this.FOrigRect$1.Bottom),this.FDragTabDisplay.Rect.$assign(pas["WEBLib.TMSFNCTypes"].RectF(this.FOrigRect$1.Left,this.FOrigRect$1.Top+r,this.FOrigRect$1.Right,this.FOrigRect$1.Bottom+r))),this.CalculateRects(this.FDragTabDisplay),a=!1;var F=this.FLayout.FPosition;1===F||2===F?(this.FDownX=i,i>l.Right-10&&this.HandleScrollNext({get:function(){return a},set:function(t){a=t}},!1),i<l.Left+10&&this.HandleScrollPrevious({get:function(){return a},set:function(t){a=t}},!1)):0!==F&&3!==F||(this.FDownY=s,s<l.Top+10&&this.HandleScrollNext({get:function(){return a},set:function(t){a=t}},!1),s>l.Bottom-10&&this.HandleScrollPrevious({get:function(){return a},set:function(t){a=t}},!1)),a?this.UpdateTabs(!1,!1):(this.Invalidate(),this.DoInvalidate())}},this.HandleDblClick=function(t,e){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleDblClick.apply(this,arguments),this.FDblClicked=!0},this.HandleMouseUp=function(i,s,o,n){var r=t.TTMSFNCTabSetDisplayTab.$new(),a=t.TTMSFNCTabSetDisplayTab.$new(),l=null,h=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),F=!1,p=null;if(pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleMouseUp.apply(this,arguments),l=null,F=!1,null!=this.FDragTab){var c=this.FLayout.FPosition;1===c||2===c?r.$assign(this.XYToTab(o,this.FDragTabDisplay.Rect.Top+(this.FDragTabDisplay.Rect.Bottom-this.FDragTabDisplay.Rect.Top)/2,this.FDragTab)):0!==c&&3!==c||r.$assign(this.XYToTab(this.FDragTabDisplay.Rect.Left+(this.FDragTabDisplay.Rect.Right-this.FDragTabDisplay.Rect.Left)/2,n,this.FDragTab))}else r.$assign(this.XYToTab(o,n,null)),a.$assign(this.XYToCloseTab(o,n));this.ReleaseCaptureEx(),null!=this.FDragTab?(this.HandleDragTab(this.FDragTab,r.Tab),F=!0):""!==this.FTabAnchor&&null!=r.Tab&&""!==this.XYToAnchor(t.TTMSFNCTabSetDisplayTab.$clone(r),o,n)?this.DoAnchorTabClick(r.Tab.GetIndex(),this.FTabAnchor):(this.FUpdateCount$1+=1,null!=this.FDownCloseTab&&this.FDownCloseTab===a.Tab?this.HandleCloseTab(this.FDownCloseTab,{get:function(){return F},set:function(t){F=t}}):null!=this.FDownTab&&this.FDownTab===this.FInsertTab?l=this.HandleInsertTab({get:function(){return F},set:function(t){F=t}}):null!=this.FDownTab&&this.FDownTab===r.Tab?(p=this.FActiveTab)===this.FDownTab&&this.FInteraction.FEditing?this.HandleTabEditing(t.TTMSFNCTabSetDisplayTab.$clone(r)):(this.FFocusedTab=this.FDownTab,this.HandleChangeTab(this.FDownTab),F=2===this.FLayout.FMultiline&&p!==this.FActiveTab&&-1!==this.GetActiveTabIndex()):2===this.FTabListButtonState&&this.XYToTabListButton(o,n)?(this.FillTabList(),h.$assign(this.GetTabListButtonRect()),this.FTabListPopup.SetPlacementControl(this),this.FTabListPopup.FPlacementRectangle.SetLeft(h.Left),this.FTabListPopup.FPlacementRectangle.SetTop(h.Top),this.FTabListPopup.FPlacementRectangle.SetRight(h.Right),this.FTabListPopup.FPlacementRectangle.SetBottom(h.Bottom),this.FTabListPopup.Popup(!1)):2===this.FCloseButtonState&&this.XYToCloseButton(o,n)?this.HandleCloseTab(this.FActiveTab,{get:function(){return F},set:function(t){F=t}}):2===this.FInsertButtonState&&this.XYToInsertButton(o,n)?l=this.HandleInsertTab({get:function(){return F},set:function(t){F=t}}):2===this.FScrollButtonPreviousState&&this.XYToScrollPreviousButton(o,n)?this.HandleScrollPrevious({get:function(){return F},set:function(t){F=t}},!0):2===this.FScrollButtonNextState&&this.XYToScrollNextButton(o,n)&&this.HandleScrollNext({get:function(){return F},set:function(t){F=t}},!0)),this.StopDownTimer(),this.FTabAnchor="",this.FDragTab=null,this.FDragTabDisplay.$assign(e.EmptyDisplayTab()),this.FDownTab=null,this.FHoverTab=null,this.FDownCloseTab=null,this.FHoverCloseTab=null,this.ClearButtonState(),this.FUpdateCount$1-=1,F&&this.UpdateTabs(!1,!1),null!=l&&this.FInteraction.FSelectTabOnInsert?this.HandleChangeTab(l):F||this.Invalidate()},this.HandleMouseEnter=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleMouseEnter.call(this),this.Invalidate()},this.HandleMouseLeave=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleMouseLeave.call(this),this.ClearButtonState(),this.FHoverTab=null,this.FDownTab=null,this.FHoverCloseTab=null,this.FDownCloseTab=null,this.Invalidate()},this.DoExit=function(){pas["WEBLib.Controls"].TControl.DoExit.call(this),this.FInplaceEditorActive&&this.CloseInplaceEditor(!1),this.Invalidate()},this.DoEnter=function(){pas["WEBLib.Controls"].TControl.DoEnter.call(this),this.Invalidate()},this.UpdateControlAfterResize=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.UpdateControlAfterResize.call(this),this.UpdateTabs(!1,!1)},this.StartDownTimer=function(){this.FDownTimer.SetEnabled(!this.IsDesignTime())},this.StopDownTimer=function(){this.FDownTimer.SetEnabled(!1)},this.HandleKeyDown=function(t,e){var i=0;if(pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleKeyDown.apply(this,arguments),!this.FInplaceEditorClosed){var s=t.get();37===s||38===s?this.FocusPreviousTab(this.FInteraction.FSelectTabOnFocus):39===s||40===s?this.FocusNextTab(this.FInteraction.FSelectTabOnFocus):36===s?(i=this.GetFirstScrollableTabIndex(),this.IsTabVisible(i)&&this.IsTabEnabled(i)?this.FocusTab(i,this.FInteraction.FSelectTabOnFocus):(i>=0&&i<this.FTabs.GetCount()-1&&(this.FFocusedTab=this.FTabs.GetTab(i)),this.FocusNextTab(this.FInteraction.FSelectTabOnFocus))):35===s&&(i=this.GetLastScrollableTabIndex(),this.IsTabVisible(i)&&this.IsTabEnabled(i)?this.FocusTab(i,this.FInteraction.FSelectTabOnFocus):(i>=0&&i<this.FTabs.GetCount()-1&&(this.FFocusedTab=this.FTabs.GetTab(i)),this.FocusPreviousTab(this.FInteraction.FSelectTabOnFocus)))}},this.HandleDialogKey=function(t,e){this.FInplaceEditorClosed||null!=this.FInplaceEditor&&this.FInplaceEditorActive&&(27===t.get()||9===t.get()||113===t.get()||pas["WEBLib.StdCtrls"].TEdit.isPrototypeOf(this.FInplaceEditor)&&13===t.get())&&(this.FCloseWithDialogKey=!0,this.CloseInplaceEditor(27===t.get())),pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleDialogKey.apply(this,arguments)},this.HandleKeyUp=function(e,i){var s=t.TTMSFNCTabSetDisplayTab.$new(),o=!1,n=!1,r=null;if(pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleKeyUp.apply(this,arguments),this.FInplaceEditorClosed)this.FInplaceEditorClosed=!1;else if(this.FCloseWithDialogKey)this.FCloseWithDialogKey=!1;else{n=!1,o=!1,r=null;var a=e.get();if(13===a||32===a?this.FInteraction.FSelectTabOnFocus||null==this.FFocusedTab||this.FFocusedTab===this.FActiveTab||(this.HandleChangeTab(this.FFocusedTab),o=!0):45===a&&this.FInteraction.FInsertTabWithKeyboard&&(r=this.HandleInsertTab({get:function(){return n},set:function(t){n=t}})),null!=this.FFocusedTab&&!o){var l=e.get();46===l?this.FInteraction.FCloseTabWithKeyboard&&this.HandleCloseTab(this.FFocusedTab,{get:function(){return n},set:function(t){n=t}}):113!==l&&13!==l||this.IsTabEnabled(this.FFocusedTab.GetIndex())&&this.FInteraction.FEditing&&(s.$assign(this.GetDisplayTab(this.FFocusedTab.GetIndex())),this.HandleTabEditing(t.TTMSFNCTabSetDisplayTab.$clone(s)))}n&&this.UpdateTabs(!1,!1),null!=r&&this.FInteraction.FSelectTabOnInsert?this.HandleChangeTab(r):n||this.Invalidate()}},this.HandleMouseWheel=function(t,e,i){var s=!1;pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleMouseWheel.apply(this,arguments),this.IsFocused()&&(s=!1,e>0?this.HandleScrollNext({get:function(){return s},set:function(t){s=t}},!0):this.HandleScrollPrevious({get:function(){return s},set:function(t){s=t}},!0),s&&this.UpdateTabs(!1,!1))},this.HandleCloseTab=function(t,e){var i,s=0,o=0,n=!1,r=!1,a=null;if(null!=t&&(s=this.FOptions.FCloseAction,i=t.GetIndex(),this.DoBeforeCloseTab(t.GetIndex(),{get:function(){return s},set:function(t){s=t}}),0!==s)){var l=s;1===l?(n=(o=t.GetIndex())===this.FActiveTabIndex,this.FUpdateCount$1+=1,t=rtl.freeLoc(t),e.set(!0),this.FUpdateCount$1-=1,o<=this.FActiveTabIndex&&(this.FActiveTabIndex=Math.max(0,this.FActiveTabIndex-1)),this.FActiveTabIndex>=0&&this.FActiveTabIndex<=this.FTabs.GetCount()-1?this.IsTabEnabled(this.FActiveTabIndex)&&this.IsTabVisible(this.FActiveTabIndex)||this.SelectNextSequentialTab():(this.FActiveTabIndex=-1,this.FActiveTab=null,this.FFocusedTab=null),n&&(r=!0,this.FActiveTabIndex>=0&&this.FActiveTabIndex<=this.FTabs.GetCount()-1&&((a=this.FTabs.GetTab(this.FActiveTabIndex)).FEnabled&&a.FVisible?(this.DoBeforeChangeTab(o,a.GetIndex(),{get:function(){return r},set:function(t){r=t}}),r&&(this.FActiveTab=a,this.FActiveTabIndex=this.FActiveTab.GetIndex(),this.FFocusedTab=this.FActiveTab,this.FTabChanging=!0,this.DoChangeTab(o,this.FActiveTab.GetIndex()),this.FTabChanging=!1)):(this.FTabChanging=!0,this.DoChangeTab(o,this.FActiveTabIndex),this.FTabChanging=!1)))):2===l&&(t.SetVisible(!1),this.FActiveTabIndex===t.GetIndex()&&(this.SelectNextSequentialTab(),this.FActiveTabIndex>=0&&this.FActiveTabIndex<=this.FTabs.GetCount()-1&&this.GetNormalDisplayCount()>0?this.HandleChangeTab(this.FTabs.GetTab(this.FActiveTabIndex)):this.HandleChangeTab(null)),e.set(!0)),this.DoCloseTab(i,s)}},this.HandleDragTab=function(t,e){var i=!1,s=0;null!=t&&null!=e&&(i=!0,this.DoBeforeReorderTab(t.GetIndex(),e.GetIndex(),{get:function(){return i},set:function(t){i=t}}),i&&(s=this.FDragTab.GetIndex(),t.SetIndex(e.GetIndex()),null!=this.FActiveTab&&(this.FActiveTabIndex=this.FActiveTab.GetIndex()),this.DoReorderTab(s,t.GetIndex())))},this.HandleChangeTab=function(t){var e=!1,i=0,s=0;this.FPrevTab=this.FActiveTab,this.FPrevTab!==t&&(null!=t&&this.IsTabVisible(t.GetIndex())&&this.IsTabEnabled(t.GetIndex())||null==t)&&(i=null!=this.FPrevTab?this.FPrevTab.GetIndex():-1,s=null!=t?t.GetIndex():-1,e=!0,this.DoBeforeChangeTab(i,s,{get:function(){return e},set:function(t){e=t}}),e&&(this.FActiveTab=t,this.FFocusedTab=t,this.FActiveTabIndex=s,this.FTabChanging=!0,this.DoChangeTab(i,s),this.FTabChanging=!1,2===this.FLayout.FMultiline&&-1!==this.GetActiveTabIndex()?this.UpdateTabs(!1,!1):this.ScrollToTab(this.FActiveTabIndex)))},this.HandleTabEditing=function(e){var i=!1,s=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),o=pas.Types.TRect.$new();if(null!=e.Tab&&(this.FInplaceEditorClass=t.TTMSFNCTabSetEdit,i=!0,this.DoBeforeOpenInplaceEditor(e.Index,{get:function(){return i},set:function(t){i=t}}),i)){if(this.DoGetInplaceEditor(e.Tab.GetIndex(),{p:this,get:function(){return this.p.FInplaceEditorClass},set:function(t){this.p.FInplaceEditorClass=t}}),null!=this.FInplaceEditor&&(rtl.free(this,"FInplaceEditor"),this.FInplaceEditor=null),null!=this.FInplaceEditorClass?this.FInplaceEditor=this.FInplaceEditorClass.$create("Create$1",[this]):this.FInplaceEditor=t.TTMSFNCTabSetEdit.$create("Create$1",[this]),s.$assign(this.GetInplaceEditorRect(t.TTMSFNCTabSetDisplayTab.$clone(e))),null!=this.FInplaceEditor){this.FUpdateTab.$assign(e),this.FInplaceEditor.SetShowFocus(!1),this.FInplaceEditor.SetParent(this),this.FInplaceEditor.SetVisible(!1),o.$assign(pas.Types.Rect(Math.round(s.Left),Math.round(s.Top),Math.round(s.Right),Math.round(s.Bottom))),this.FInplaceEditor.SetBoundsRect(o),this.FInplaceEditor.SetBoundsRect(pas.Types.Rect(o.Left,o.Top+rtl.trunc((o.Bottom-o.Top-this.FInplaceEditor.GetHeight())/2),o.Right,o.Top+rtl.trunc((o.Bottom-o.Top-this.FInplaceEditor.GetHeight())/2)+this.FInplaceEditor.GetHeight())),this.FInplaceEditor.SetVisible(!0),this.CustomizeInplaceEditor(this.FInplaceEditor,t.TTMSFNCTabSetDisplayTab.$clone(e));try{e.Tab.FText}finally{}this.FInplaceEditor.CanFocus()&&this.FInplaceEditor.SetFocus(),pas["WEBLib.StdCtrls"].TEdit.isPrototypeOf(this.FInplaceEditor)&&rtl.as(this.FInplaceEditor,pas["WEBLib.StdCtrls"].TEdit).SetSelStart(rtl.as(this.FInplaceEditor,pas["WEBLib.StdCtrls"].TEdit).GetText().length),this.FInplaceEditorActive=!0,this.Invalidate()}this.DoOpenInplaceEditor(e.Tab.GetIndex(),this.FInplaceEditor,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(s))}},this.CustomizeInplaceEditor=function(t,e){null!=e.Tab&&null!=t&&null!=this.FOnCustomizeInplaceEditor&&this.FOnCustomizeInplaceEditor(this,e.Tab.GetIndex(),this.FInplaceEditor)},this.SelectNextSequentialTab=function(){var t=0,e=0,i=!1;if(!(this.FActiveTabIndex<0)){for(i=!1,t=this.FActiveTabIndex,e=1;e<this.FTabs.GetCount()&&!((t+=1)>=this.FTabs.GetCount());){if(this.FActiveTabIndex!==t&&this.IsTabVisible(t)&&this.IsTabEnabled(t)){this.FActiveTabIndex=t,i=!0;break}e+=1}if(!i)for(t=this.FActiveTabIndex,e=1;e<this.FTabs.GetCount()&&!((t-=1)>=this.FTabs.GetCount())&&!(t<0);){if(this.FActiveTabIndex!==t&&this.IsTabVisible(t)&&this.IsTabEnabled(t)){this.FActiveTabIndex=t;break}e+=1}}},this.AnimateTimerChanged=function(e){var i=0,s=t.TTMSFNCTabSetDisplayTab.$new(),o=!1;o=!1;for(var n=0,r=this.GetDisplayCount()-1;n<=r;n++)i=n,s.$assign(this.FDisplayList.GetItem(i)),null!=s.Tab&&(o||1!==s.Tab.FProgressMode||0===s.Tab.FProgressKind||(o=!0),s.Tab.FAnimMarqueeSwitch?(s.Tab.FAnimMarqueeStartAngle=s.Tab.FAnimMarqueeStartAngle+5,s.Tab.FAnimMarqueeSweepAngle=s.Tab.FAnimMarqueeSweepAngle-5):s.Tab.FAnimMarqueeSweepAngle=s.Tab.FAnimMarqueeSweepAngle+5,360===s.Tab.FAnimMarqueeSweepAngle&&0===s.Tab.FAnimMarqueeStartAngle?s.Tab.FAnimMarqueeSwitch=!0:360===s.Tab.FAnimMarqueeStartAngle&&0===s.Tab.FAnimMarqueeSweepAngle&&(s.Tab.FAnimMarqueeSwitch=!1,s.Tab.FAnimMarqueeStartAngle=0));o&&this.Invalidate(),this.FAnimTimer.SetEnabled(o)},this.DownTimerChanged=function(t){var e=!1;this.FDownCount+=1,this.FDownCount>3&&(e=!1,2!==this.FScrollButtonNextState||this.FScrollButtonNextDisabled||this.HandleScrollNext({get:function(){return e},set:function(t){e=t}},!0),2!==this.FScrollButtonPreviousState||this.FScrollButtonPreviousDisabled||this.HandleScrollPrevious({get:function(){return e},set:function(t){e=t}},!0),e&&this.UpdateTabs(!1,!1))},this.HandleScrollNext=function(t,e){var i=0;this.FInteraction.FSelectTabOnScroll&&e?this.SelectNextTab():(i=this.FStartTab,this.FStartTab<this.FScrollCount&&(this.FStartTab+=1),!this.IsTabVisible(this.FStartTab)&&this.FStartTab<this.GetLastScrollableTabIndex()&&(this.FStartTab=this.GetNextTab(this.FStartTab)),t.set(i!==this.FStartTab))},this.HandleScrollPrevious=function(t,e){var i=0;this.FInteraction.FSelectTabOnScroll&&e?this.SelectPreviousTab():(i=this.FStartTab,this.FStartTab>0&&(this.FStartTab-=1),!this.IsTabVisible(this.FStartTab)&&this.FStartTab>this.GetFirstScrollableTabIndex()&&(this.FStartTab=this.GetPreviousTab(this.FStartTab)),t.set(i!==this.FStartTab))},this.DoBeforeOpenInplaceEditor=function(t,e){null!=this.FOnBeforeOpenInplaceEditor&&this.FOnBeforeOpenInplaceEditor(this,t,e)},this.DoOpenInplaceEditor=function(t,e,i){null!=this.FOnOpenInplaceEditor&&this.FOnOpenInplaceEditor(this,t,e,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i))},this.DoBeforeUpdateTab=function(t,e,i){null!=this.FOnBeforeUpdateTab&&this.FOnBeforeUpdateTab(this,t,e,i)},this.DoUpdateTab=function(t){null!=this.FOnUpdateTab&&this.FOnUpdateTab(this,t)},this.DoCloseInplaceEditor=function(t,e,i,s){null!=this.FOnCloseInplaceEditor&&this.FOnCloseInplaceEditor(this,t,e,i,s)},this.DoGetInplaceEditor=function(t,e){null!=this.FOnGetInplaceEditor&&this.FOnGetInplaceEditor(this,t,e)},this.SetFonts=function(t){var e=0;if(this.BeginUpdate(),this.FGlobalFont.ApplyChange(this.FTabAppearance.FFont,t),this.FGlobalFont.ApplyChange(this.FTabAppearance.FBadgeFont,t),1===t){this.FTabAppearance.SetTextColor(this.FGlobalFont.FColor),this.FTabAppearance.SetHoverTextColor(this.FGlobalFont.FColor),this.FTabAppearance.SetActiveTextColor(this.FGlobalFont.FColor),this.FTabAppearance.SetDownTextColor(this.FGlobalFont.FColor);for(var i=0,s=this.FTabs.GetCount()-1;i<=s;i++)e=i,this.FTabs.GetTab(e).SetTextColor(this.FGlobalFont.FColor),this.FTabs.GetTab(e).SetHoverTextColor(this.FGlobalFont.FColor),this.FTabs.GetTab(e).SetActiveTextColor(this.FGlobalFont.FColor),this.FTabs.GetTab(e).SetDownTextColor(this.FGlobalFont.FColor)}this.EndUpdate()},this.Create$1=function(e){return pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Create$1.apply(this,arguments),this.FInsertTab=t.TTMSFNCTabSetTab.$create("Create$1",[null]),this.FInsertTab.SetCloseButton(!1),this.FInsertTab.SetTextVisible(!1),this.FInsertTab.SetText(""),this.FInsertTab.SetProgressKind(0),this.FActiveTabIndex=0,this.FAnimTimer=pas["WEBLib.ExtCtrls"].TTimer.$create("Create$1",[this]),this.FAnimTimer.SetEnabled(!1),this.FAnimTimer.SetInterval(1),this.FAnimTimer.FOnTimer=rtl.createCallback(this,"AnimateTimerChanged"),this.FDownTimer=pas["WEBLib.ExtCtrls"].TTimer.$create("Create$1",[this]),this.FDownTimer.SetEnabled(!1),this.FDownTimer.SetInterval(100),this.FDownTimer.FOnTimer=rtl.createCallback(this,"DownTimerChanged"),this.FDisplayList=t.TTMSFNCTabSetDisplayList.$create("Create$1"),this.FInvisibleTabList=t.TTMSFNCTabSetInvisibleTabList.$create("Create$1"),this.FTabs=this.CreateTabs(),this.FTabSize=t.TTMSFNCTabSetTabSize.$create("Create$1",[this]),this.FTabAppearance=t.TTMSFNCTabSetTabAppearance.$create("Create$1",[this]),this.FButtonAppearance=t.TTMSFNCTabSetButtonAppearance.$create("Create$1",[this]),this.FInteraction=t.TTMSFNCTabSetInteraction.$create("Create$1",[this]),this.FOptions=t.TTMSFNCTabSetOptions.$create("Create$1",[this]),this.FLayout=t.TTMSFNCTabSetLayout.$create("Create$1",[this]),this.FStartTab=0,this.FAllowScrolling=!0,this.FInsertTab.FBitmaps.AddBitmap(this.FButtonAppearance.FInsertIcon,1),this.FInsertTab.FDisabledBitmaps.AddBitmap(this.FButtonAppearance.FInsertIcon,1),this.FInsertTab.FTabSet=this,this.FTabListPopup=pas["WEBLib.TMSFNCPopup"].TTMSFNCPopup.$create("Create$1",[this]),this.FTabList=pas["WEBLib.StdCtrls"].TListBox.$create("Create$1",[this.FTabList]),this.FTabList.FOnClick=rtl.createCallback(this,"PopupListSelected"),this.FTabListPopup.SetContentControl(this.FTabList),this.FTabListPopup.FFocusedControl=this.FTabList,this.FTabListPopup.SetPlacement(0),this.FTabListPopup.SetDropDownHeight(125),this.FTabListPopup.SetDropDownWidth(100),this.FGlobalFont=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCAppearanceGlobalFont.$create("Create$1",[this]),this},this.Destroy=function(){rtl.free(this,"FGlobalFont"),rtl.free(this,"FAnimTimer"),rtl.free(this,"FTabList"),rtl.free(this,"FTabListPopup"),rtl.free(this,"FInsertTab"),rtl.free(this,"FTabSize"),rtl.free(this,"FTabs"),rtl.free(this,"FTabAppearance"),rtl.free(this,"FButtonAppearance"),rtl.free(this,"FInteraction"),rtl.free(this,"FOptions"),rtl.free(this,"FLayout"),rtl.free(this,"FInvisibleTabList"),rtl.free(this,"FDisplayList"),pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Destroy.call(this)},this.XYToTab=function(i,s,o){var n=t.TTMSFNCTabSetDisplayTab.$new(),r=0,a=t.TTMSFNCTabSetDisplayTab.$new(),l=null,h=!1;h=!1,n.$assign(e.EmptyDisplayTab());for(var F=this.GetDisplayCount()-1;F>=0&&(r=F,a.$assign(this.FDisplayList.GetItem(r)),null==a.Tab||a.Tab===o||(null!=(l=a.Tab===this.FInsertTab?a.Tab.GetInsertShapePath(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(a.Rect)):a.Tab.GetShapePath(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(a.Rect)))&&(pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.PointInPath(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(i,s)),l)&&(n.$assign(a),h=!0),l=rtl.freeLoc(l)),!h));F--);return n},this.XYToCloseTab=function(i,s){var o=t.TTMSFNCTabSetDisplayTab.$new(),n=0,r=t.TTMSFNCTabSetDisplayTab.$new();if(o.$assign(e.EmptyDisplayTab()),1!==this.FOptions.FCloseMode)return o;for(var a=this.GetDisplayCount()-1;a>=0;a--)if(n=a,r.$assign(this.FDisplayList.GetItem(n)),null!=r.Tab&&r.Tab.FCloseButton&&pas["WEBLib.TMSFNCTypes"].PtInRectEx(r.CloseButtonRect,pas["WEBLib.TMSFNCTypes"].PointF(i,s))){o.$assign(r);break}return o},this.XYToScrollNextButton=function(t,e){return this.FShowScrollButtons&&!this.FScrollButtonNextDisabled&&pas["WEBLib.TMSFNCTypes"].PtInRectEx(this.GetScrollButtonNextRect(),pas["WEBLib.TMSFNCTypes"].PointF(t,e))},this.XYToScrollPreviousButton=function(t,e){return this.FShowScrollButtons&&!this.FScrollButtonPreviousDisabled&&pas["WEBLib.TMSFNCTypes"].PtInRectEx(this.GetScrollButtonPreviousRect(),pas["WEBLib.TMSFNCTypes"].PointF(t,e))},this.XYToCloseButton=function(t,e){return this.FShowCloseButton&&pas["WEBLib.TMSFNCTypes"].PtInRectEx(this.GetCloseButtonRect(),pas["WEBLib.TMSFNCTypes"].PointF(t,e))},this.XYToInsertButton=function(t,e){return this.FShowInsertButton&&pas["WEBLib.TMSFNCTypes"].PtInRectEx(this.GetInsertButtonRect(),pas["WEBLib.TMSFNCTypes"].PointF(t,e))},this.XYToTabListButton=function(t,e){return this.FShowTabListButton&&pas["WEBLib.TMSFNCTypes"].PtInRectEx(this.GetTabListButtonRect(),pas["WEBLib.TMSFNCTypes"].PointF(t,e))},this.IsTabVisible=function(t){var e=!1;return e=!1,t>=0&&t<=this.FTabs.GetCount()-1&&(e=this.FTabs.GetTab(t).FVisible),e},this.IsTabEnabled=function(t){var e=!1;return e=!1,t>=0&&t<=this.FTabs.GetCount()-1&&(e=this.FTabs.GetTab(t).FEnabled),e},this.Assign=function(e){t.TTMSFNCCustomTabSet.isPrototypeOf(e)&&(this.FTabSize.Assign(rtl.as(e,t.TTMSFNCCustomTabSet).FTabSize),this.FTabAppearance.Assign(rtl.as(e,t.TTMSFNCCustomTabSet).FTabAppearance),this.FInteraction.Assign(rtl.as(e,t.TTMSFNCCustomTabSet).FInteraction),this.FOptions.Assign(rtl.as(e,t.TTMSFNCCustomTabSet).FOptions),this.FLayout.Assign(rtl.as(e,t.TTMSFNCCustomTabSet).FLayout),this.FTabs.Assign(rtl.as(e,t.TTMSFNCCustomTabSet).FTabs))},this.BeginUpdate=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBase.BeginUpdate.call(this),this.FUpdateCount$1+=1},this.EndUpdate=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBase.EndUpdate.call(this),this.FUpdateCount$1-=1,0===this.FUpdateCount$1&&this.UpdateTabs(!1,!1)},this.SelectNextTab=function(){var t=0,e=0;if(!(this.FActiveTabIndex<0)){for(t=this.FActiveTabIndex,e=1;e<this.FTabs.GetCount();){if((t+=1)>=this.FTabs.GetCount()&&(t=0),this.FActiveTabIndex!==t&&this.IsTabVisible(t)&&this.IsTabEnabled(t)){this.FActiveTabIndex=t;break}e+=1}this.FActiveTabIndex>=0&&this.FActiveTabIndex<=this.FTabs.GetCount()-1&&(this.HandleChangeTab(this.FTabs.GetTab(this.FActiveTabIndex)),0===this.FUpdateCount$1&&this.Invalidate())}},this.SelectPreviousTab=function(){var t=0,e=0;if(!(this.FActiveTabIndex<0)){for(t=this.FActiveTabIndex,e=1;e<this.FTabs.GetCount();){if((t-=1)>=this.FTabs.GetCount()&&(t=0),t<0&&(t=this.FTabs.GetCount()-1),this.FActiveTabIndex!==t&&this.IsTabVisible(t)&&this.IsTabEnabled(t)){this.FActiveTabIndex=t;break}e+=1}this.FActiveTabIndex>=0&&this.FActiveTabIndex<=this.FTabs.GetCount()-1&&(this.HandleChangeTab(this.FTabs.GetTab(this.FActiveTabIndex)),0===this.FUpdateCount$1&&this.Invalidate())}},this.ScrollToTab=function(t){if(2!==this.FTabSize.FMode&&this.FAllowScrolling&&0===this.FLayout.FMultiline&&this.FScrollCount>0&&t>=0&&t<=this.FTabs.GetCount()-1&&this.IsTabVisible(t))if(t>this.FLastTabIndex||t<this.FFirstTabIndex){if(this.FStartTab=Math.max(0,t-this.GetNormalDisplayCount()-this.GetInvisibleTabCount()),this.UpdateTabs(!1,!0),t>this.FLastTabIndex)for(;this.FLastTabIndex<t;)this.FStartTab+=1,this.IsTabVisible(this.FStartTab)||(this.FStartTab=this.GetNextTab(this.FStartTab)),this.UpdateTabs(!1,!0);else if(t<this.FFirstTabIndex)for(;this.FFirstTabIndex>t;)this.FStartTab-=1,this.IsTabVisible(this.FStartTab)||(this.FStartTab=this.GetPreviousTab(this.FStartTab)),this.UpdateTabs(!1,!0)}else this.InitializeScrollButtonState(),this.Invalidate();else this.Invalidate()},this.CloseInplaceEditor=function(t){var e="",i=!1,s=!1,o="";if(!this.FClosing){if(this.FClosing=!0,null!=this.FUpdateTab.Tab&&null!=this.FInplaceEditor){if(!t)try{o="",pas["WEBLib.StdCtrls"].TEdit.isPrototypeOf(this.FInplaceEditor)&&(e=rtl.as(this.FInplaceEditor,pas["WEBLib.StdCtrls"].TEdit).GetText()),o=e}finally{}s=!0,this.DoCloseInplaceEditor(this.FUpdateTab.Tab.GetIndex(),this.FInplaceEditor,t,{get:function(){return s},set:function(t){s=t}}),s&&(i=!0,this.DoBeforeUpdateTab(this.FUpdateTab.Tab.GetIndex(),{get:function(){return o},set:function(t){o=t}},{get:function(){return i},set:function(t){i=t}}),i&&!t&&(this.FUpdateCount$1+=1,null!=this.FUpdateTab.Tab&&this.FUpdateTab.Tab.SetText(o),this.FUpdateCount$1-=1,this.DoUpdateTab(this.FUpdateTab.Tab.GetIndex())),this.FInplaceEditor.SetParent(null),rtl.free(this,"FInplaceEditor"),this.FInplaceEditor=null,this.FInplaceEditorActive=!1),s&&(this.UpdateTabs(!1,!1),this.CanFocus()&&this.SetFocus())}this.FClosing=!1}},this.FocusNextTab=function(t){var e=0,i=0,s=0;if(null!=this.FFocusedTab){for(e=s=this.FFocusedTab.GetIndex(),i=1;i<this.FTabs.GetCount();){if((e+=1)>=this.FTabs.GetCount()&&(e=0),s!==e&&this.IsTabVisible(e)&&this.IsTabEnabled(e)){s=e;break}i+=1}s>=0&&s<=this.FTabs.GetCount()-1&&(this.FFocusedTab=this.FTabs.GetTab(s),t?this.HandleChangeTab(this.FFocusedTab):this.ScrollToTab(s))}},this.FocusPreviousTab=function(t){var e=0,i=0,s=0;if(null!=this.FFocusedTab){for(e=s=this.FFocusedTab.GetIndex(),i=1;i<this.FTabs.GetCount();){if((e-=1)>=this.FTabs.GetCount()&&(e=0),e<0&&(e=this.FTabs.GetCount()-1),s!==e&&this.IsTabVisible(e)&&this.IsTabEnabled(e)){s=e;break}i+=1}s>=0&&s<=this.FTabs.GetCount()-1&&(this.FFocusedTab=this.FTabs.GetTab(s),t?this.HandleChangeTab(this.FFocusedTab):this.ScrollToTab(s))}},this.FocusTab=function(t,e){t>=0&&t<=this.FTabs.GetCount()-1&&this.IsTabVisible(t)&&(this.FFocusedTab=this.FTabs.GetTab(t),e?this.HandleChangeTab(this.FFocusedTab):this.ScrollToTab(t))},rtl.addIntf(this,pas["WEBLib.TMSFNCBitmapContainer"].ITMSFNCBitmapContainer),rtl.addIntf(this,pas["WEBLib.TMSFNCGraphicsTypes"].ITMSFNCAppearanceGlobalFont),rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas["WEBLib.TMSFNCTypes"].ITMSFNCProductInfo),rtl.addIntf(this,pas.System.IUnknown)})),this.TMSFNCTABSETLIST="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAcAAAAJCAYAAAD+WDajAAAABGdBTUEAALGPC/xhBQAAAAlwSFlzAAAOvwAADr8BOAVTJAAAABh0RVh0U29mdHdhcmUAcGFpbnQubmV0IDQuMC4zjOaXUAAAACpJREFUKFNjwAvCwsL+48IM///jxvh1YhOEYZz2giVgAKcEDOCUwAQMDAAqj1EKDJG5XAAAAABJRU5ErkJggg==",this.TMSFNCTABSETCLOSE="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAACxIAAAsSAdLdfvwAAAAYdEVYdFNvZnR3YXJlAHBhaW50Lm5ldCA0LjAuOWwzfk4AAABVSURBVDhPYxh+QBSI/0OYWAFIThjCxA5ACmAYHeCTQwHYFGITwwuQNSBjkgBFmkGAIgNAGv5BaZINQdYMA0Qbgk0zDBBlCCiR4FMAkhOCMIcJYGAAAHvVMBv6PIFYAAAAAElFTkSuQmCC",this.TMSFNCTABSETPREVIOUS="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEwAACxMBAJqcGAAAAEpJREFUOI3lzKENgEAQAMEJBkkIDdDTSxp6gqMyCkB8IQgMFdwZAutn+U19Bi84MUbxhZrBawSXB+8RDDMaDkyvmQyZyYYuOvh6N24uDUKEV//MAAAAAElFTkSuQmCC",this.TMSFNCTABSETNEXT="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEwAACxMBAJqcGAAAAFNJREFUOI3tzzsSQFAQRNFDqSezHUuwYBJLsBuhEomE4/ll3HBq+nY1PxENRrS5xzK4L1jPSiISesxPJcORJJqwU9xthjrX/ko4mpBQocN0tf1rbDeZDIfcSud0AAAAAElFTkSuQmCC",this.TMSFNCTABSETADD="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABGdBTUEAALGPC/xhBQAAAAlwSFlzAAALEAAACxABrSO9dQAAABh0RVh0U29mdHdhcmUAcGFpbnQubmV0IDQuMC45bDN+TgAAAEtJREFUOE/dzEEKACAIRFHvf2nLhZDyI6VVBS9yahJVvYJhB4YdGLq5bJtHvjcYugc/8MJJ6IQhPdwJnXXIqJBh6D74oALDDgzrVAajy7VnCteJXAAAAABJRU5ErkJggg==",t.$implcode=function(){e.EmptyDisplayTab=function(){var e=t.TTMSFNCTabSetDisplayTab.$new();return e.Tab=null,e.ContentRect.$assign(pas["WEBLib.TMSFNCTypes"].RectF(0,0,0,0)),e.BitmapRect.$assign(pas["WEBLib.TMSFNCTypes"].RectF(0,0,0,0)),e.TextRect.$assign(pas["WEBLib.TMSFNCTypes"].RectF(0,0,0,0)),e.ProgressRect.$assign(pas["WEBLib.TMSFNCTypes"].RectF(0,0,0,0)),e.CloseButtonRect.$assign(pas["WEBLib.TMSFNCTypes"].RectF(0,0,0,0)),e.Rect.$assign(pas["WEBLib.TMSFNCTypes"].RectF(0,0,0,0)),e.First=!1,e.Last=!1,e.Index=-1,e.Row=0,e}},t.$init=function(){pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.CreateFromResource(t.TMSFNCTABSETLIST),pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.CreateFromResource(t.TMSFNCTABSETCLOSE),pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.CreateFromResource(t.TMSFNCTABSETPREVIOUS),pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.CreateFromResource(t.TMSFNCTABSETNEXT),pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.CreateFromResource(t.TMSFNCTABSETADD)}}),["WEBLib.TMSFNCUtils","WEBLib.Forms","WEBLib.Graphics","SysUtils","Math","WEBLib.TMSFNCStyles"]),rtl.module("WEBLib.TMSFNCPageControl",["System","Classes","WEBLib.TMSFNCTabSet","WEBLib.TMSFNCPersistence","WEBLib.TMSFNCTypes","WEBLib.Controls","WEBLib.TMSFNCCustomControl","WEBLib.TMSFNCGraphics","WEBLib.TMSFNCPopup","Types"],(function(){"use strict";var t=this,e=t.$impl;this.MAJ_VER=1,this.MIN_VER=0,this.REL_VER=0,this.BLD_VER=6,rtl.createClass(this,"TTMSFNCPageControlContainer",pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl,(function(){this.$init=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.$init.call(this),this.FIsDestroying=!1,this.FPage=null,this.FPageControl=null,this.FPageIndex=0,this.FIsActive=!1},this.$final=function(){this.FPage=void 0,this.FPageControl=void 0,pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.$final.call(this)},this.SetPageControl=function(t){this.SetParent(t),this.FPageControl=t},this.RegisterRuntimeClasses=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.RegisterRuntimeClasses.call(this),pas.Classes.RegisterClass(t.TTMSFNCPageControlContainer)},this.SetParent=function(e){t.TTMSFNCCustomPageControl.isPrototypeOf(e)&&(this.FPageControl=rtl.as(e,t.TTMSFNCCustomPageControl)),pas["WEBLib.Controls"].TControl.SetParent.apply(this,arguments)},this.Create$1=function(t){return this.Create$8(t,null),this},this.Create$8=function(t,e){return pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Create$1.call(this,t),this.FPage=e,null!=this.FPage&&null!=this.FPage.FPageControl&&(this.FTransparent=this.FPage.FPageControl.FTransparent,this.FBufferedPainting=this.FPage.FPageControl.FBufferedPainting),this},this.Destroy=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Destroy.call(this),this.FPage=null},this.Draw=function(t,e){var i=null,s=pas["WEBLib.TMSFNCTabSet"].TTMSFNCTabSetDisplayTab.$new(),o=null,n=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),r=0;if(pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Draw.apply(this,arguments),!(3 in this.FComponentState)&&null!=this.FPage&&null!=this.FPage.FContainer&&this.FPage.FContainer===this&&(this.IsDesignTime()&&(t.FFont.SetHeight(this.ScalePaintValue(t.FFont.FHeight)),t.DrawText$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(this.GetLocalRect()),this.FPage.GetFriendlyName(),!1,0,0,0,0,-1,-1,!0,!1,-1,-1)),null!=(i=this.FPage.PageControl())&&i.GetActivePage()===this.FPage&&(s.$assign(i.GetDisplayTab(this.FPage.GetIndex())),null!=s.Tab&&s.Tab===this.FPage))){if(o=s.Tab,null!=i.DragTabDisplay().Tab&&i.DragTabDisplay().Tab===this.FPage?n.$assign(o.GetFixedRect(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i.DragTabDisplay().Rect),pas["WEBLib.TMSFNCTabSet"].TTMSFNCTabSetDisplayTab.$clone(i.DragTabDisplay()))):n.$assign(o.GetFixedRect(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(s.Rect),pas["WEBLib.TMSFNCTabSet"].TTMSFNCTabSetDisplayTab.$clone(s))),n.Right-n.Left<=0||n.Bottom-n.Top<=0)return;2===i.FTabAppearance.FActiveFill.FKind?t.FStroke.SetColor(i.FTabAppearance.FActiveFill.FColorTo):o.FUseDefaultAppearance?t.FStroke.SetColor(i.FTabAppearance.FActiveFill.FColor):t.FStroke.SetColor(o.FActiveColor),t.FStroke.SetWidth(t.FStroke.FWidth*pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.GetDPIScale(null,-1));var a=i.FLayout.FPosition;if(0===a||3===a){if(n.Top=n.Top+t.FStroke.FWidth,n.Bottom=n.Bottom-t.FStroke.FWidth,i.FCollapsed){var l=i.FLayout.FPosition;0===l?(n.Left=.5,n.Right=.5):3===l&&(n.Left=this.GetWidth()-.5,n.Right=this.GetWidth()-.5)}}else if((1===a||2===a)&&(n.Left=n.Left+t.FStroke.FWidth,n.Right=n.Right-t.FStroke.FWidth,i.FCollapsed)){var h=i.FLayout.FPosition;1===h?(n.Top=.5,n.Bottom=.5):2===h&&(n.Top=this.GetHeight()-.5,n.Bottom=this.GetHeight()-.5)}r=Math.round(4*pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.GetDPIScale(null,-1));var F=i.FLayout.FPosition;if(3===F){var p=o.GetShape();1===p?n.Top=n.Top+r:2===p?n.Bottom=n.Bottom-r:3===p&&(n.Top=n.Top+r,n.Bottom=n.Bottom-r),t.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(n.Left-this.GetLeft(),n.Top-this.GetTop())),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(n.Left-this.GetLeft(),n.Bottom-this.GetTop())),0,0)}else if(0===F){var c=o.GetShape();1===c?n.Bottom=n.Bottom-r:2===c?n.Top=n.Top+r:3===c&&(n.Top=n.Top+r,n.Bottom=n.Bottom-r),t.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(n.Right-this.GetLeft(),n.Top-this.GetTop())),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(n.Right-this.GetLeft(),n.Bottom-this.GetTop())),0,0)}else if(1===F||2===F){var u=o.GetShape();1===u?n.Left=n.Left+r:2===u?n.Right=n.Right-r:3===u&&(n.Left=n.Left+r,n.Right=n.Right-r);var C=i.FLayout.FPosition;1===C?t.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(n.Left-this.GetLeft(),n.Bottom-this.GetTop())),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(n.Right-this.GetLeft(),n.Bottom-this.GetTop())),0,0):2===C&&t.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(n.Left-this.GetLeft(),n.Top-this.GetTop())),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(n.Right-this.GetLeft(),n.Top-this.GetTop())),0,0)}}},rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas["WEBLib.TMSFNCTypes"].ITMSFNCProductInfo),rtl.addIntf(this,pas.System.IUnknown);var e=this.$rtti;e.addProperty("Fill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FFill","SetFill"),e.addProperty("Stroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FStroke","SetStroke")})),rtl.createClass(this,"TTMSFNCPageControlPage",pas["WEBLib.TMSFNCTabSet"].TTMSFNCTabSetTab,(function(){this.$init=function(){pas["WEBLib.TMSFNCTabSet"].TTMSFNCTabSetTab.$init.call(this),this.FContainer=null,this.FPageControl=null},this.$final=function(){this.FContainer=void 0,this.FPageControl=void 0,pas["WEBLib.TMSFNCTabSet"].TTMSFNCTabSetTab.$final.call(this)},this.UpdatePage=function(){null!=this.FPageControl&&this.FPageControl.UpdatePages()},this.GetFriendlyName=function(){var t="";return""===(t=this.GetStrippedHTMLText())&&(t="Page "+pas.SysUtils.IntToStr(this.GetIndex())),t},this.Create$1=function(e){var i=null;return pas["WEBLib.TMSFNCTabSet"].TTMSFNCTabSetTab.Create$1.apply(this,arguments),null!=this.FCollection&&(this.FPageControl=rtl.as(this.FCollection,t.TTMSFNCPageControlPages).PageControl(),null==(i=this.PageControl())||i.IsReading()||i.IsLoading()||0 in i.FComponentState||(this.FContainer=i.GetContainerClass().$create("Create$8",[i.FOwner,this]),this.FContainer.SetPageControl(i),this.FContainer.SetAdaptToStyle(i.GetAdaptToStyle()),this.FContainer.SetTabStop(!1),i.IsDesigning()&&this.FContainer.SetName(i.FName+"Page"+pas.SysUtils.IntToStr(this.GetIndex())),this.FContainer.SetAlignWithMargins(!0),this.FContainer.SetAlign(5),this.FContainer.SetVisible(!1),i.UpdateMargins(this.FContainer),this.SetText(this.GetFriendlyName()))),null!=this.FPageControl&&(this.FPageControl.FUpdateMargins=!0,null!=this.FPageControl.FOnInternalInsertPage&&this.FPageControl.FOnInternalInsertPage(this)),this.UpdatePage(),this},this.Destroy=function(){null!=this.FContainer&&(this.FContainer.FIsDestroying=!0,null!=this.FPageControl&&this.FPageControl.FPrevActivePageContainer===this.FContainer&&(this.FPageControl.FPrevActivePageContainer=null),null==this.FContainer.FParent||null==this.FPageControl||this.FPageControl.IsDestroying()||rtl.free(this,"FContainer"),this.FContainer=null),pas["WEBLib.TMSFNCTabSet"].TTMSFNCTabSetTab.Destroy.call(this),null!=this.FPageControl&&(this.FPageControl.FUpdateMargins=!0),this.UpdatePage()},this.PageControl=function(){return this.FPageControl}})),rtl.createClass(this,"TTMSFNCPageControlPages",pas["WEBLib.TMSFNCTabSet"].TTMSFNCTabSetTabs,(function(){this.$init=function(){pas["WEBLib.TMSFNCTabSet"].TTMSFNCTabSetTabs.$init.call(this),this.FPageControl=null},this.$final=function(){this.FPageControl=void 0,pas["WEBLib.TMSFNCTabSet"].TTMSFNCTabSetTabs.$final.call(this)},this.GetTabClass=function(){return t.TTMSFNCPageControlPage},this.PageControl=function(){return this.FPageControl},this.Create$3=function(e){return pas["WEBLib.TMSFNCTabSet"].TTMSFNCTabSetTabs.Create$3.apply(this,arguments),this.FPageControl=rtl.as(e,t.TTMSFNCCustomPageControl),this},this.Clear$1=function(){null!=this.FPageControl&&(this.FPageControl.FPrevActivePageContainer=null,this.FPageControl.BeginUpdate()),pas["WEBLib.TMSFNCTabSet"].TTMSFNCTabSetTabs.Clear$1.call(this),null!=this.FPageControl&&this.FPageControl.EndUpdate()},this.Add$2=function(){return pas["WEBLib.TMSFNCTabSet"].TTMSFNCTabSetTabs.Add$1.call(this)}})),this.TTMSFNCPageControlPageCloseAction={0:"ttcaNone",ttcaNone:0,1:"ttcaFree",ttcaFree:1,2:"ttcaHide",ttcaHide:2},this.$rtti.$Enum("TTMSFNCPageControlPageCloseAction",{minvalue:0,maxvalue:2,ordtype:1,enumtype:this.TTMSFNCPageControlPageCloseAction}),this.$rtti.$MethodVar("TTMSFNCPageControlBeforeReorderPageEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ACurrentPageIndex",rtl.longint],["ANewPageIndex",rtl.longint],["ACanReorder",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCPageControlBeforeChangePageEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ACurrentPageIndex",rtl.longint],["ANewPageIndex",rtl.longint],["ACanChange",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCPageControlChangePageEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["APreviousPageIndex",rtl.longint],["ACurrentPageIndex",rtl.longint]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCPageControlReorderPageEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["APreviousPageIndex",rtl.longint],["ACurrentPageIndex",rtl.longint]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCPageControlBeforeClosePageEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["APageIndex",rtl.longint],["ACloseAction",this.$rtti.TTMSFNCPageControlPageCloseAction,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCPageControlClosePageEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["APageIndex",rtl.longint],["ACloseAction",this.$rtti.TTMSFNCPageControlPageCloseAction]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCPageControlBeforeInsertPageEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ANewPageIndex",rtl.longint,1],["ACanInsert",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCPageControlInsertPageEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ANewPageIndex",rtl.longint]]),methodkind:0}),rtl.createClass(this,"TTMSFNCPageControlPopupForm",pas["WEBLib.TMSFNCPopup"].TTMSFNCCustomPopupForm,(function(){rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TTMSFNCPageControlPopup",pas["WEBLib.TMSFNCPopup"].TTMSFNCNonFocusablePopup,(function(){this.GetPopupFormClass=function(){return t.TTMSFNCPageControlPopupForm},rtl.addIntf(this,pas["WEBLib.TMSFNCTypes"].ITMSFNCProductInfo),rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TTMSFNCCustomPageControl",pas["WEBLib.TMSFNCTabSet"].TTMSFNCCustomTabSet,(function(){this.$init=function(){pas["WEBLib.TMSFNCTabSet"].TTMSFNCCustomTabSet.$init.call(this),this.FBlockAssign=!1,this.FSaveActivePage=null,this.FPopup=null,this.FSaveHeight=0,this.FSaveWidth=0,this.FUpdateMargins=!1,this.FUpdateVisibility=!1,this.FPrevActivePageContainer=null,this.FUpdateCount$2=0,this.FOnInsertPage=null,this.FOnBeforeClosePage=null,this.FOnBeforeInsertPage=null,this.FOnChangePage=null,this.FOnReorderPage=null,this.FOnClosePage=null,this.FOnBeforeChangePage=null,this.FOnBeforeReorderPage=null,this.FOnInternalInsertPage=null,this.FCollapsed=!1},this.$final=function(){this.FSaveActivePage=void 0,this.FPopup=void 0,this.FPrevActivePageContainer=void 0,this.FOnInsertPage=void 0,this.FOnBeforeClosePage=void 0,this.FOnBeforeInsertPage=void 0,this.FOnChangePage=void 0,this.FOnReorderPage=void 0,this.FOnClosePage=void 0,this.FOnBeforeChangePage=void 0,this.FOnBeforeReorderPage=void 0,this.FOnInternalInsertPage=void 0,pas["WEBLib.TMSFNCTabSet"].TTMSFNCCustomTabSet.$final.call(this)},this.GetActivePageIndex=function(){return this.GetActiveTabIndex()},this.SetActivePageIndex=function(t){this.SetActiveTabIndex(t)},this.SetPages=function(t){this.FTabs.Assign(t)},this.GetActivePage=function(){return rtl.as(this.GetActiveTab(),t.TTMSFNCPageControlPage)},this.SetActivePage=function(t){this.SetActiveTab(t)},this.GetPageContainer=function(e){var i=null;return i=null,e>=0&&e<=this.GetPages().GetCount()-1&&(i=rtl.as(this.GetPages().GetTab(e),t.TTMSFNCPageControlPage).FContainer),i},this.GetDocURL=function(){return pas["WEBLib.TMSFNCTypes"].TTMSFNCBaseDocURL+"tmsfncuipack/components/"+pas.SysUtils.LowerCase(this.$classname)},this.GetVersion=function(){return this.$class.GetVersionNumber(1,0,0,6)},this.CreateTabs=function(){return t.TTMSFNCPageControlPages.$create("Create$3",[this])},this.GetContainerClass=function(){return t.TTMSFNCPageControlContainer},this.GetPages=function(){return rtl.as(this.FTabs,t.TTMSFNCPageControlPages)},this.Loaded=function(){var e=0,i=null;pas["WEBLib.Controls"].TCustomControl.Loaded.call(this);for(var s=0,o=this.GetPages().GetCount()-1;s<=o;s++)e=s,null!=(i=rtl.as(this.GetPages().GetTab(e),t.TTMSFNCPageControlPage).FContainer)&&i.SetVisible(!0);this.UpdatePages();for(var n=0,r=this.GetPages().GetCount()-1;n<=r;n++)e=n,null!=(i=rtl.as(this.GetPages().GetTab(e),t.TTMSFNCPageControlPage).FContainer)&&i.SetVisible(i.FIsActive)},this.SetCollapsed=function(t){if(this.FCollapsed!==t){this.FCollapsed=t,this.FBlockAssign=!this.FCollapsed,this.FPopup.Deactivate(),this.FBlockAssign=!1;var e=this.FLayout.FPosition;0===e||3===e?this.FCollapsed&&-1===this.FSaveWidth&&(this.FSaveWidth=this.GetWidth()):1!==e&&2!==e||this.FCollapsed&&-1===this.FSaveHeight&&(this.FSaveHeight=Math.round(this.GetHeight())),this.FCollapsed?(this.FSaveActivePage=this.GetActivePage(),this.SetActivePage(null),this.FUpdateVisibility=!0,this.FUpdateMargins=!0,this.UpdatePages()):null!=this.FSaveActivePage&&this.SetActivePage(this.FSaveActivePage);var i=this.FLayout.FPosition;0===i||3===i?this.FCollapsed?(0===this.FLayout.FPosition?this.SetWidth(Math.round(this.FTabSize.FHeight+this.FTabSize.FMargins.FLeft)):this.SetWidth(Math.round(this.FTabSize.FHeight+this.FTabSize.FMargins.FRight)),3===this.FLayout.FPosition&&this.SetLeft(this.GetLeft()+Math.round(this.FSaveWidth-this.GetWidth()))):(3===this.FLayout.FPosition&&this.SetLeft(this.GetLeft()-Math.round(this.FSaveWidth-this.GetWidth())),this.SetWidth(Math.round(this.FSaveWidth))):1!==i&&2!==i||(this.FCollapsed?(1===this.FLayout.FPosition?this.SetHeight(Math.round(this.FTabSize.FHeight+this.FTabSize.FMargins.FTop)):this.SetHeight(Math.round(this.FTabSize.FHeight+this.FTabSize.FMargins.FBottom)),2===this.FLayout.FPosition&&this.SetTop(this.GetTop()+Math.round(this.FSaveHeight-this.GetHeight()))):(2===this.FLayout.FPosition&&this.SetTop(this.GetTop()-Math.round(this.FSaveHeight-this.GetHeight())),this.SetHeight(Math.round(this.FSaveHeight)))),this.FCollapsed||(this.FUpdateVisibility=!0,this.FUpdateMargins=!0,this.UpdatePages())}},this.DoClosePopup=function(t){this.FBlockAssign||this.SetActivePage(null)},this.SetAdaptToStyle=function(e){var i=0,s=null;pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.SetAdaptToStyle.apply(this,arguments);for(var o=0,n=this.GetPages().GetCount()-1;o<=n;o++)i=o,null!=(s=rtl.as(this.GetPages().GetTab(i),t.TTMSFNCPageControlPage).FContainer)&&s.SetAdaptToStyle(this.GetAdaptToStyle())},this.UpdateAllPages=function(t){this.FUpdateMargins=!0},this.Notification=function(e,i){var s=null;!(3 in this.FComponentState)&&1===i&&t.TTMSFNCPageControlContainer.isPrototypeOf(e)&&((s=rtl.as(e,t.TTMSFNCPageControlContainer)).FIsDestroying||null==s.FPage||(this.FPrevActivePageContainer===s.FPage.FContainer&&(this.FPrevActivePageContainer=null),s.FPage.FContainer=null,rtl.free(s,"FPage"),s.FPage=null,this.SetActivePageIndex(Math.max(0,Math.min(this.GetActivePageIndex(),this.GetPages().GetCount()-1))))),pas["WEBLib.TMSFNCTabSet"].TTMSFNCCustomTabSet.Notification.apply(this,arguments)},this.UpdatePages=function(){var e,i=null;this.FUpdateCount$2>0||3 in this.FComponentState||(!0,this.UpdatePageIndexes(),this.UpdateVisibility(),(e=this.GetActivePageIndex())>=0&&e<=this.GetPages().GetCount()-1?null!=(i=rtl.as(this.GetPages().GetTab(e),t.TTMSFNCPageControlPage).FContainer)&&(this.UpdateMargins(i),i.SetVisible(!this.FCollapsed),null!=i.FParent&&i.BringToFront(),i.Invalidate(),null!=this.FPrevActivePageContainer&&this.FPrevActivePageContainer!==i&&this.FPrevActivePageContainer.SetVisible(!1),this.FPrevActivePageContainer=i):null!=this.FPrevActivePageContainer&&(this.FPrevActivePageContainer.SetVisible(!1),this.FPrevActivePageContainer.SendToBack()))},this.UpdateTabs=function(t,e){pas["WEBLib.TMSFNCTabSet"].TTMSFNCCustomTabSet.UpdateTabs.apply(this,arguments),this.UpdatePages()},this.UpdateMargins=function(t){var e;if(e=this.GetTotalTabHeight(),this.FCollapsed||e<=0){var i=this.FLayout.FPosition;0===i||3===i?(t.SetWidth(Math.round(this.FSaveWidth)),t.SetHeight(Math.round(this.GetHeight()))):1!==i&&2!==i||(t.SetWidth(Math.round(this.GetWidth())),t.SetHeight(Math.round(this.FSaveHeight)));var s=this.FLayout.FPosition;0===s?t.SetWidth(t.GetWidth()-Math.round(this.FTabSize.FHeight-this.FTabSize.FMargins.FLeft+1)):1===s?t.SetHeight(t.GetHeight()-Math.round(this.FTabSize.FHeight-this.FTabSize.FMargins.FTop+1)):2===s?t.SetHeight(t.GetHeight()-Math.round(this.FTabSize.FHeight-this.FTabSize.FMargins.FBottom+1)):3===s&&t.SetWidth(t.GetWidth()-Math.round(this.FTabSize.FHeight-this.FTabSize.FMargins.FRight+1)),t.FMargins.SetTop(0),t.FMargins.SetLeft(0),t.FMargins.SetRight(0),t.FMargins.SetBottom(0)}else{var o=this.FLayout.FPosition;0===o?(t.FMargins.SetTop(0),t.FMargins.SetLeft(Math.round(e+this.FTabSize.FMargins.FLeft-1)),t.FMargins.SetRight(0),t.FMargins.SetBottom(0)):1===o?(t.FMargins.SetTop(Math.round(e+this.FTabSize.FMargins.FTop-1)),t.FMargins.SetLeft(0),t.FMargins.SetRight(0),t.FMargins.SetBottom(0)):2===o?(t.FMargins.SetTop(0),t.FMargins.SetLeft(0),t.FMargins.SetRight(0),t.FMargins.SetBottom(Math.round(this.FTabSize.FMargins.FBottom+e-1))):3===o&&(t.FMargins.SetTop(0),t.FMargins.SetLeft(0),t.FMargins.SetRight(Math.round(this.FTabSize.FMargins.FRight+e-1)),t.FMargins.SetBottom(0))}},this.UpdatePageIndexes=function(){for(var e=null,i=0,s=0,o=this.GetPages().GetCount()-1;s<=o;s++)i=s,null!=(e=rtl.as(this.GetPages().GetTab(i),t.TTMSFNCPageControlPage).FContainer)&&(e.FPageIndex=i,e.FIsActive=e.FPageIndex===this.GetActivePageIndex(),this.FUpdateMargins&&this.UpdateMargins(e));this.FUpdateMargins=!1},this.UpdateVisibility=function(){var e=null,i=0;if(this.FUpdateVisibility&&this.FCollapsed)for(var s=0,o=this.GetPages().GetCount()-1;s<=o;s++)i=s,null!=(e=rtl.as(this.GetPages().GetTab(i),t.TTMSFNCPageControlPage).FContainer)&&e.SetVisible(!this.FCollapsed)},this.DoInvalidate=function(){var t=null;pas["WEBLib.TMSFNCTabSet"].TTMSFNCCustomTabSet.DoInvalidate.call(this),null!=this.GetActivePage()&&null!=(t=this.GetActivePage().FContainer)&&t.Invalidate()},this.Draw=function(t,e){pas["WEBLib.TMSFNCTabSet"].TTMSFNCCustomTabSet.Draw.apply(this,arguments),4 in this.FComponentState&&0===this.GetPages().GetCount()&&(t.DrawFocusRectangle$3(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),0,2),t.FFont.SetHeight(this.ScalePaintValue(t.FFont.FHeight)),t.DrawText$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),'Please add pages by clicking "New Page" in the context menu',!1,0,0,0,0,-1,-1,!0,!1,-1,-1))},this.DoBeforeChangeTab=function(t,e,i){pas["WEBLib.TMSFNCTabSet"].TTMSFNCCustomTabSet.DoBeforeChangeTab.apply(this,arguments),this.DoBeforeChangePage(t,e,i)},this.DoChangeTab=function(t,e){var i=null;if(pas["WEBLib.TMSFNCTabSet"].TTMSFNCCustomTabSet.DoChangeTab.apply(this,arguments),this.UpdatePages(),this.DoChangePage(t,e),this.FCollapsed&&null!=this.GetActivePage()){this.FSaveActivePage=this.GetActivePage(),this.FBlockAssign=!0,this.FPopup.Deactivate(),this.FBlockAssign=!1,i=this.GetActivePage().FContainer,this.FPopup.SetContentControl(i),this.FPopup.SetPlacementControl(this);var s=this.FLayout.FPosition;0===s?(this.FPopup.SetDropDownWidth(this.FSaveWidth-Math.round(this.FTabSize.FHeight+this.FTabSize.FMargins.FTop+1)),this.FPopup.SetDropDownHeight(this.GetHeight())):3===s?(this.FPopup.SetDropDownWidth(this.FSaveWidth-Math.round(this.FTabSize.FHeight+this.FTabSize.FMargins.FRight+1)),this.FPopup.SetDropDownHeight(this.GetHeight())):1===s?(this.FPopup.SetDropDownWidth(this.GetWidth()),this.FPopup.SetDropDownHeight(this.FSaveHeight-Math.round(this.FTabSize.FHeight+this.FTabSize.FMargins.FTop+1))):2===s&&(this.FPopup.SetDropDownWidth(this.GetWidth()),this.FPopup.SetDropDownHeight(this.FSaveHeight-Math.round(this.FTabSize.FHeight+this.FTabSize.FMargins.FBottom+1)));var o=this.FLayout.FPosition;0===o||3===o?(this.FPopup.FHorizontalOffset=-1,this.FPopup.FVerticalOffset=0,this.FPopup.SetDropDownWidth(this.FPopup.FDropDownWidth+2)):1!==o&&2!==o||(this.FPopup.FVerticalOffset=-1,this.FPopup.FHorizontalOffset=0,this.FPopup.SetDropDownHeight(this.FPopup.FDropDownHeight+2));var n=this.FLayout.FPosition;0===n?this.FPopup.SetPlacement(3):1===n?this.FPopup.SetPlacement(0):2===n?this.FPopup.SetPlacement(1):3===n&&this.FPopup.SetPlacement(2),this.FPopup.Activate()}},this.DoBeforeReorderTab=function(t,e,i){pas["WEBLib.TMSFNCTabSet"].TTMSFNCCustomTabSet.DoBeforeReorderTab.apply(this,arguments),this.DoBeforeReorderPage(t,e,i)},this.DoReorderTab=function(t,e){pas["WEBLib.TMSFNCTabSet"].TTMSFNCCustomTabSet.DoReorderTab.apply(this,arguments),this.DoReorderPage(t,e),this.FUpdateMargins=!0},this.DoBeforeCloseTab=function(t,e){var i=0,s=0;pas["WEBLib.TMSFNCTabSet"].TTMSFNCCustomTabSet.DoBeforeCloseTab.apply(this,arguments),s=e.get(),i=s,this.DoBeforeClosePage(t,{get:function(){return i},set:function(t){i=t}}),s=i,e.set(s)},this.DoCloseTab=function(t,e){var i=0;pas["WEBLib.TMSFNCTabSet"].TTMSFNCCustomTabSet.DoCloseTab.apply(this,arguments),i=e,this.DoClosePage(t,i),this.FUpdateMargins=!0},this.DoBeforeInsertTab=function(t,e){pas["WEBLib.TMSFNCTabSet"].TTMSFNCCustomTabSet.DoBeforeInsertTab.apply(this,arguments),this.DoBeforeInsertPage(t,e)},this.DoInsertTab=function(t){pas["WEBLib.TMSFNCTabSet"].TTMSFNCCustomTabSet.DoInsertTab.apply(this,arguments),this.DoInsertPage(t),this.FUpdateMargins=!0},this.DoBeforeChangePage=function(t,e,i){null!=this.FOnBeforeChangePage&&this.FOnBeforeChangePage(this,t,e,i)},this.DoChangePage=function(t,e){null!=this.FOnChangePage&&this.FOnChangePage(this,t,e)},this.DoBeforeReorderPage=function(t,e,i){null!=this.FOnBeforeReorderPage&&this.FOnBeforeReorderPage(this,t,e,i)},this.DoReorderPage=function(t,e){null!=this.FOnReorderPage&&this.FOnReorderPage(this,t,e)},this.DoBeforeClosePage=function(t,e){null!=this.FOnBeforeClosePage&&this.FOnBeforeClosePage(this,t,e)},this.DoClosePage=function(t,e){null!=this.FOnClosePage&&this.FOnClosePage(this,t,e)},this.DoBeforeInsertPage=function(t,e){null!=this.FOnBeforeInsertPage&&this.FOnBeforeInsertPage(this,t,e)},this.DoInsertPage=function(t){null!=this.FOnInsertPage&&this.FOnInsertPage(this,t)},this.Create$1=function(e){return pas["WEBLib.TMSFNCTabSet"].TTMSFNCCustomTabSet.Create$1.apply(this,arguments),this.FPopup=t.TTMSFNCPageControlPopup.$create("Create$1",[this]),this.FPopup.FOnClosePopup=rtl.createCallback(this,"DoClosePopup"),this.IsDesignTime()&&this.DisableBackground(),this.FTabSize.FOnChange=rtl.createCallback(this,"UpdateAllPages"),this.FLayout.FOnChange=rtl.createCallback(this,"UpdateAllPages"),this.FSaveWidth=-1,this.FSaveHeight=-1,this},this.Destroy=function(){rtl.free(this,"FPopup"),pas["WEBLib.TMSFNCTabSet"].TTMSFNCCustomTabSet.Destroy.call(this)},this.AddPage=function(t){var e=null;return(e=this.GetPages().Add$2()).SetText(t),null!=this.FOnInternalInsertPage&&this.FOnInternalInsertPage(e),e},this.GetChildren=function(t,e){for(var i=0,s=0,o=this.GetPages().GetCount()-1;s<=o;s++)i=s,t(this.GetPageContainer(i))},this.BeginUpdate=function(){pas["WEBLib.TMSFNCTabSet"].TTMSFNCCustomTabSet.BeginUpdate.call(this),this.FUpdateCount$2+=1},this.EndUpdate=function(){pas["WEBLib.TMSFNCTabSet"].TTMSFNCCustomTabSet.EndUpdate.call(this),this.FUpdateCount$2-=1,0===this.FUpdateCount$2&&this.UpdatePages()},this.RemovePage=function(t){t>=0&&t<=this.GetPages().GetCount()-1&&this.GetPages().Delete(t)},this.UpdateControlAfterResize=function(){this.FUpdateMargins=!0,pas["WEBLib.TMSFNCTabSet"].TTMSFNCCustomTabSet.UpdateControlAfterResize.call(this)},rtl.addIntf(this,pas["WEBLib.TMSFNCBitmapContainer"].ITMSFNCBitmapContainer),rtl.addIntf(this,pas["WEBLib.TMSFNCGraphicsTypes"].ITMSFNCAppearanceGlobalFont),rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas["WEBLib.TMSFNCTypes"].ITMSFNCProductInfo),rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TTMSFNCPageControl",this.TTMSFNCCustomPageControl,(function(){this.$init=function(){t.TTMSFNCCustomPageControl.$init.call(this),this.FInitialize=!1},this.RegisterRuntimeClasses=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.RegisterRuntimeClasses.call(this),pas.Classes.RegisterClasses([t.TTMSFNCPageControl,t.TTMSFNCPageControlPage])},this.SetName=function(t){pas["WEBLib.Controls"].TCustomControl.SetName.apply(this,arguments),this.FInitialize&&(this.InitSample$1(),this.FInitialize=!1)},this.Create$1=function(e){return t.TTMSFNCCustomPageControl.Create$1.apply(this,arguments),this.SetWidth(500),this.SetHeight(500),this.FInitialize=this.IsDesignTime(),this},this.InitSample$1=function(){this.BeginUpdate(),this.ResetToDefaultStyle(),this.GetPages().Clear$1(),this.AddPage("Page 1").SetUseDefaultAppearance(!0),this.AddPage("Page 2").SetUseDefaultAppearance(!0),this.AddPage("Page 3").SetUseDefaultAppearance(!0),this.EndUpdate()},rtl.addIntf(this,pas["WEBLib.TMSFNCBitmapContainer"].ITMSFNCBitmapContainer),rtl.addIntf(this,pas["WEBLib.TMSFNCGraphicsTypes"].ITMSFNCAppearanceGlobalFont),rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas["WEBLib.TMSFNCTypes"].ITMSFNCProductInfo),rtl.addIntf(this,pas.System.IUnknown);var e=this.$rtti;e.addProperty("ActivePageIndex",3,rtl.longint,"GetActivePageIndex","SetActivePageIndex",{Default:0}),e.addProperty("Collapsed",2,rtl.boolean,"FCollapsed","SetCollapsed",{Default:!1}),e.addProperty("Fill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FFill","SetFill"),e.addProperty("Stroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FStroke","SetStroke"),e.addProperty("TabAppearance",2,pas["WEBLib.TMSFNCTabSet"].$rtti.TTMSFNCTabSetTabAppearance,"FTabAppearance","SetTabAppearance"),e.addProperty("ButtonAppearance",2,pas["WEBLib.TMSFNCTabSet"].$rtti.TTMSFNCTabSetButtonAppearance,"FButtonAppearance","SetButtonAppearance"),e.addProperty("BitmapContainer",3,pas["WEBLib.TMSFNCBitmapContainer"].$rtti.TTMSFNCBitmapContainer,"GetBitmapContainer","SetBitmapContainer"),e.addProperty("Interaction",2,pas["WEBLib.TMSFNCTabSet"].$rtti.TTMSFNCTabSetInteraction,"FInteraction","SetInteraction"),e.addProperty("Options",2,pas["WEBLib.TMSFNCTabSet"].$rtti.TTMSFNCTabSetOptions,"FOptions","SetOptions"),e.addProperty("TabSize",2,pas["WEBLib.TMSFNCTabSet"].$rtti.TTMSFNCTabSetTabSize,"FTabSize","SetTabSize"),e.addProperty("Layout",2,pas["WEBLib.TMSFNCTabSet"].$rtti.TTMSFNCTabSetLayout,"FLayout","SetLayout"),e.addProperty("Version",1,rtl.string,"GetVersion",""),e.addProperty("Pages",3,t.$rtti.TTMSFNCPageControlPages,"GetPages","SetPages"),e.addProperty("OnBeforeClosePage",0,t.$rtti.TTMSFNCPageControlBeforeClosePageEvent,"FOnBeforeClosePage","FOnBeforeClosePage"),e.addProperty("OnBeforeChangePage",0,t.$rtti.TTMSFNCPageControlBeforeChangePageEvent,"FOnBeforeChangePage","FOnBeforeChangePage"),e.addProperty("OnClosePage",0,t.$rtti.TTMSFNCPageControlClosePageEvent,"FOnClosePage","FOnClosePage"),e.addProperty("OnChangePage",0,t.$rtti.TTMSFNCPageControlChangePageEvent,"FOnChangePage","FOnChangePage"),e.addProperty("OnAnchorTabClick",0,pas["WEBLib.TMSFNCTabSet"].$rtti.TTMSFNCTabSetAnchorTabClickEvent,"FOnAnchorTabClick","FOnAnchorTabClick"),e.addProperty("OnBeforeInsertPage",0,t.$rtti.TTMSFNCPageControlBeforeInsertPageEvent,"FOnBeforeInsertPage","FOnBeforeInsertPage"),e.addProperty("OnInsertPage",0,t.$rtti.TTMSFNCPageControlInsertPageEvent,"FOnInsertPage","FOnInsertPage"),e.addProperty("OnBeforeUpdateTab",0,pas["WEBLib.TMSFNCTabSet"].$rtti.TTMSFNCTabSetBeforeUpdateTabEvent,"FOnBeforeUpdateTab","FOnBeforeUpdateTab"),e.addProperty("OnUpdateTab",0,pas["WEBLib.TMSFNCTabSet"].$rtti.TTMSFNCTabSetUpdateTabEvent,"FOnUpdateTab","FOnUpdateTab"),e.addProperty("OnBeforeOpenInplaceEditor",0,pas["WEBLib.TMSFNCTabSet"].$rtti.TTMSFNCTabSetBeforeOpenInplaceEditorEvent,"FOnBeforeOpenInplaceEditor","FOnBeforeOpenInplaceEditor"),e.addProperty("OnCloseInplaceEditor",0,pas["WEBLib.TMSFNCTabSet"].$rtti.TTMSFNCTabSetCloseInplaceEditorEvent,"FOnCloseInplaceEditor","FOnCloseInplaceEditor"),e.addProperty("OnOpenInplaceEditor",0,pas["WEBLib.TMSFNCTabSet"].$rtti.TTMSFNCTabSetOpenInplaceEditorEvent,"FOnOpenInplaceEditor","FOnOpenInplaceEditor"),e.addProperty("OnGetInplaceEditor",0,pas["WEBLib.TMSFNCTabSet"].$rtti.TTMSFNCTabSetGetInplaceEditorEvent,"FOnGetInplaceEditor","FOnGetInplaceEditor"),e.addProperty("OnCustomizeInplaceEditor",0,pas["WEBLib.TMSFNCTabSet"].$rtti.TTMSFNCTabSetCustomizeInplaceEditorEvent,"FOnCustomizeInplaceEditor","FOnCustomizeInplaceEditor"),e.addProperty("OnGetInplaceEditorRect",0,pas["WEBLib.TMSFNCTabSet"].$rtti.TTMSFNCTabSetGetInplaceEditorRectEvent,"FOnGetInplaceEditorRect","FOnGetInplaceEditorRect"),e.addProperty("OnBeforeReorderPage",0,t.$rtti.TTMSFNCPageControlBeforeReorderPageEvent,"FOnBeforeReorderPage","FOnBeforeReorderPage"),e.addProperty("OnReorderPage",0,t.$rtti.TTMSFNCPageControlReorderPageEvent,"FOnReorderPage","FOnReorderPage"),e.addProperty("OnBeforeDrawTabBackground",0,pas["WEBLib.TMSFNCTabSet"].$rtti.TTMSFNCTabSetBeforeDrawTabBackgroundEvent,"FOnBeforeDrawTabBackground","FOnBeforeDrawTabBackground"),e.addProperty("OnBeforeDrawTabProgress",0,pas["WEBLib.TMSFNCTabSet"].$rtti.TTMSFNCTabSetBeforeDrawTabProgressEvent,"FOnBeforeDrawTabProgress","FOnBeforeDrawTabProgress"),e.addProperty("OnBeforeDrawTabBadge",0,pas["WEBLib.TMSFNCTabSet"].$rtti.TTMSFNCTabSetBeforeDrawTabBadgeEvent,"FOnBeforeDrawTabBadge","FOnBeforeDrawTabBadge"),e.addProperty("OnBeforeDrawTabText",0,pas["WEBLib.TMSFNCTabSet"].$rtti.TTMSFNCTabSetBeforeDrawTabTextEvent,"FOnBeforeDrawTabText","FOnBeforeDrawTabText"),e.addProperty("OnBeforeDrawTabCloseButton",0,pas["WEBLib.TMSFNCTabSet"].$rtti.TTMSFNCTabSetBeforeDrawTabCloseButtonEvent,"FOnBeforeDrawTabCloseButton","FOnBeforeDrawTabCloseButton"),e.addProperty("OnBeforeDrawTabBitmap",0,pas["WEBLib.TMSFNCTabSet"].$rtti.TTMSFNCTabSetBeforeDrawTabBitmapEvent,"FOnBeforeDrawTabBitmap","FOnBeforeDrawTabBitmap"),e.addProperty("OnAfterDrawTabBackground",0,pas["WEBLib.TMSFNCTabSet"].$rtti.TTMSFNCTabSetAfterDrawTabBackgroundEvent,"FOnAfterDrawTabBackground","FOnAfterDrawTabBackground"),e.addProperty("OnAfterDrawTabProgress",0,pas["WEBLib.TMSFNCTabSet"].$rtti.TTMSFNCTabSetAfterDrawTabProgressEvent,"FOnAfterDrawTabProgress","FOnAfterDrawTabProgress"),e.addProperty("OnAfterDrawTabBadge",0,pas["WEBLib.TMSFNCTabSet"].$rtti.TTMSFNCTabSetAfterDrawTabBadgeEvent,"FOnAfterDrawTabBadge","FOnAfterDrawTabBadge"),e.addProperty("OnAfterDrawTabText",0,pas["WEBLib.TMSFNCTabSet"].$rtti.TTMSFNCTabSetAfterDrawTabTextEvent,"FOnAfterDrawTabText","FOnAfterDrawTabText"),e.addProperty("OnAfterDrawTabCloseButton",0,pas["WEBLib.TMSFNCTabSet"].$rtti.TTMSFNCTabSetAfterDrawTabCloseButtonEvent,"FOnAfterDrawTabCloseButton","FOnAfterDrawTabCloseButton"),e.addProperty("OnAfterDrawTabBitmap",0,pas["WEBLib.TMSFNCTabSet"].$rtti.TTMSFNCTabSetAfterDrawTabBitmapEvent,"FOnAfterDrawTabBitmap","FOnAfterDrawTabBitmap"),e.addProperty("OnBeforeDrawMenuButton",0,pas["WEBLib.TMSFNCTabSet"].$rtti.TTMSFNCTabSetBeforeDrawMenuButton,"FOnBeforeDrawMenuButton","FOnBeforeDrawMenuButton"),e.addProperty("OnAfterDrawMenuButton",0,pas["WEBLib.TMSFNCTabSet"].$rtti.TTMSFNCTabSetAfterDrawMenuButton,"FOnAfterDrawMenuButton","FOnAfterDrawMenuButton"),e.attr=[pas.Classes.ComponentPlatformsAttribute,"Create$1",[0]]})),t.$implcode=function(){rtl.createClass(e,"TTMSFNCTabSetTabOpen",pas["WEBLib.TMSFNCTabSet"].TTMSFNCTabSetTab,(function(){}))},t.$init=function(){pas.Classes.RegisterClass(t.TTMSFNCPageControlContainer)}}),["WEBLib.TMSFNCUtils","WEBLib.Graphics","SysUtils","Math","WEBLib.TMSFNCGraphicsTypes"]),rtl.module("WEBLib.TMSFNCSplitter",["System","Classes","SysUtils","Types","WEBLib.ExtCtrls","WEBLib.Controls","WEBLib.TMSFNCCustomControl","WEBLib.TMSFNCGraphics","WEBLib.TMSFNCTypes","WEBLib.TMSFNCGraphicsTypes","WEBLib.TMSFNCStyles","WEBLib.Graphics","WEBLib.Forms"],(function(){"use strict";var t=this;this.TTMSFNCSplitterIndicator={0:"siCircle",siCircle:0,1:"siCircles",siCircles:1,2:"siLine",siLine:2,3:"siSquare",siSquare:3,4:"siSquares",siSquares:4,5:"siImage",siImage:5},this.$rtti.$Enum("TTMSFNCSplitterIndicator",{minvalue:0,maxvalue:5,ordtype:1,enumtype:this.TTMSFNCSplitterIndicator}),this.TTMSFNCSplitterResizeStyle={0:"rsOnce",rsOnce:0,1:"rsContinuous",rsContinuous:1},this.$rtti.$Enum("TTMSFNCSplitterResizeStyle",{minvalue:0,maxvalue:1,ordtype:1,enumtype:this.TTMSFNCSplitterResizeStyle}),rtl.createClass(this,"TTMSFNCCustomSplitterAppearance",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FIndicatorBitmap=null,this.FIndicatorDownFill=null,this.FIndicatorDownStroke=null,this.FIndicatorFill=null,this.FIndicatorHoverFill=null,this.FIndicatorHoverStroke=null,this.FIndicatorMargin=0,this.FIndicatorStroke=null,this.FOwner=null,this.FSplitterDownFill=null,this.FSplitterDownStroke=null,this.FSplitterFill=null,this.FSplitterHoverFill=null,this.FSplitterHoverStroke=null,this.FSplitterStroke=null,this.FOnChange=null},this.$final=function(){this.FIndicatorBitmap=void 0,this.FIndicatorDownFill=void 0,this.FIndicatorDownStroke=void 0,this.FIndicatorFill=void 0,this.FIndicatorHoverFill=void 0,this.FIndicatorHoverStroke=void 0,this.FIndicatorStroke=void 0,this.FOwner=void 0,this.FSplitterDownFill=void 0,this.FSplitterDownStroke=void 0,this.FSplitterFill=void 0,this.FSplitterHoverFill=void 0,this.FSplitterHoverStroke=void 0,this.FSplitterStroke=void 0,this.FOnChange=void 0,pas.Classes.TPersistent.$final.call(this)},this.SetIndicatorBitmap=function(t){this.FIndicatorBitmap.Assign(t),this.BitmapChanged(this.FIndicatorBitmap)},this.SetIndicatorDownFill=function(t){this.FIndicatorDownFill.Assign(t),this.FillChanged(this.FIndicatorDownFill)},this.SetIndicatorDownStroke=function(t){this.FIndicatorDownStroke.Assign(t),this.StrokeChanged(this.FIndicatorDownStroke)},this.SetIndicatorFill=function(t){this.FIndicatorFill.Assign(t),this.FillChanged(this.FIndicatorFill)},this.SetIndicatorHoverFill=function(t){this.FIndicatorHoverFill.Assign(t),this.FillChanged(this.FIndicatorHoverFill)},this.SetIndicatorHoverStroke=function(t){this.FIndicatorHoverStroke.Assign(t),this.StrokeChanged(this.FIndicatorHoverStroke)},this.SetIndicatorMargin=function(t){this.FIndicatorMargin!==t&&(this.FIndicatorMargin=t,this.Changed())},this.SetIndicatorStroke=function(t){this.FIndicatorStroke.Assign(t),this.StrokeChanged(this.FIndicatorStroke)},this.SetSplitterDownFill=function(t){this.FSplitterDownFill.Assign(t),this.FillChanged(this.FSplitterDownFill)},this.SetSplitterDownStroke=function(t){this.FSplitterDownStroke.Assign(t),this.StrokeChanged(this.FSplitterDownStroke)},this.SetSplitterHoverFill=function(t){this.FSplitterHoverFill.Assign(t),this.FillChanged(this.FSplitterHoverFill)},this.SetSplitterHoverStroke=function(t){this.FSplitterHoverStroke.Assign(t),this.StrokeChanged(this.FSplitterHoverStroke)},this.SetSplitterFill=function(t){this.FSplitterFill.Assign(t),this.FillChanged(this.FSplitterFill)},this.SetSplitterStroke=function(t){this.FSplitterStroke.Assign(t),this.StrokeChanged(this.FSplitterStroke)},this.Changed=function(){null!=this.FOnChange&&this.FOnChange(this)},this.BitmapChanged=function(t){this.Changed()},this.FillChanged=function(t){this.Changed()},this.StrokeChanged=function(t){this.Changed()},this.Create$1=function(t){return this.FOwner=t,this.FSplitterFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[1,pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.HTMLToColor("#E9E9E9"),8421504,-1,-1]),this.FSplitterFill.FOnChanged=rtl.createCallback(this,"FillChanged"),this.FSplitterStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,11119017]),this.FSplitterStroke.FOnChanged=rtl.createCallback(this,"StrokeChanged"),this.FSplitterHoverFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[1,pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.HTMLToColor("#BBC4CC"),8421504,-1,-1]),this.FSplitterHoverFill.FOnChanged=rtl.createCallback(this,"FillChanged"),this.FSplitterHoverStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,10061943]),this.FSplitterHoverStroke.FOnChanged=rtl.createCallback(this,"StrokeChanged"),this.FSplitterDownFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[1,pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.HTMLToColor("#B8C0C8"),8421504,-1,-1]),this.FSplitterDownFill.FOnChanged=rtl.createCallback(this,"FillChanged"),this.FSplitterDownStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,9470064]),this.FSplitterDownStroke.FOnChanged=rtl.createCallback(this,"StrokeChanged"),this.FIndicatorMargin=1,this.FIndicatorFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[1,16777215,8421504,-1,-1]),this.FIndicatorFill.FOnChanged=rtl.createCallback(this,"FillChanged"),this.FIndicatorStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,8421504]),this.FIndicatorStroke.FOnChanged=rtl.createCallback(this,"StrokeChanged"),this.FIndicatorHoverFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[1,16777215,8421504,-1,-1]),this.FIndicatorHoverFill.FOnChanged=rtl.createCallback(this,"FillChanged"),this.FIndicatorHoverStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,8421504]),this.FIndicatorHoverStroke.FOnChanged=rtl.createCallback(this,"StrokeChanged"),this.FIndicatorDownFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[1,pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.HTMLToColor("#1BADF8"),8421504,-1,-1]),this.FIndicatorDownFill.FOnChanged=rtl.createCallback(this,"FillChanged"),this.FIndicatorDownStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,8421504]),this.FIndicatorDownStroke.FOnChanged=rtl.createCallback(this,"StrokeChanged"),this.FIndicatorBitmap=pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.$create("Create$3"),this},this.Destroy=function(){rtl.free(this,"FSplitterFill"),rtl.free(this,"FSplitterStroke"),rtl.free(this,"FSplitterHoverFill"),rtl.free(this,"FSplitterHoverStroke"),rtl.free(this,"FSplitterDownFill"),rtl.free(this,"FSplitterDownStroke"),rtl.free(this,"FIndicatorFill"),rtl.free(this,"FIndicatorStroke"),rtl.free(this,"FIndicatorHoverFill"),rtl.free(this,"FIndicatorHoverStroke"),rtl.free(this,"FIndicatorDownFill"),rtl.free(this,"FIndicatorDownStroke"),rtl.free(this,"FIndicatorBitmap"),pas.System.TObject.Destroy.call(this)},this.Assign=function(e){t.TTMSFNCCustomSplitterAppearance.isPrototypeOf(e)?(this.SetIndicatorBitmap(rtl.as(e,t.TTMSFNCCustomSplitterAppearance).FIndicatorBitmap),this.SetIndicatorFill(rtl.as(e,t.TTMSFNCCustomSplitterAppearance).FIndicatorFill),this.SetIndicatorStroke(rtl.as(e,t.TTMSFNCCustomSplitterAppearance).FIndicatorStroke),this.SetIndicatorHoverFill(rtl.as(e,t.TTMSFNCCustomSplitterAppearance).FIndicatorHoverFill),this.SetIndicatorHoverStroke(rtl.as(e,t.TTMSFNCCustomSplitterAppearance).FIndicatorHoverStroke),this.SetIndicatorDownFill(rtl.as(e,t.TTMSFNCCustomSplitterAppearance).FIndicatorDownFill),this.SetIndicatorDownStroke(rtl.as(e,t.TTMSFNCCustomSplitterAppearance).FIndicatorDownStroke),this.SetIndicatorMargin(rtl.as(e,t.TTMSFNCCustomSplitterAppearance).FIndicatorMargin),this.SetSplitterFill(rtl.as(e,t.TTMSFNCCustomSplitterAppearance).FSplitterFill),this.SetSplitterStroke(rtl.as(e,t.TTMSFNCCustomSplitterAppearance).FSplitterStroke),this.SetSplitterHoverFill(rtl.as(e,t.TTMSFNCCustomSplitterAppearance).FSplitterHoverFill),this.SetSplitterHoverStroke(rtl.as(e,t.TTMSFNCCustomSplitterAppearance).FSplitterHoverStroke),this.SetSplitterDownFill(rtl.as(e,t.TTMSFNCCustomSplitterAppearance).FSplitterDownFill),this.SetSplitterDownStroke(rtl.as(e,t.TTMSFNCCustomSplitterAppearance).FSplitterDownStroke)):pas.Classes.TPersistent.Assign.apply(this,arguments)}})),rtl.createClass(this,"TTMSFNCSplitterAppearance",this.TTMSFNCCustomSplitterAppearance,(function(){var t=this.$rtti;t.addProperty("IndicatorBitmap",2,pas["WEBLib.TMSFNCTypes"].$rtti.TTMSFNCBitmap,"FIndicatorBitmap","SetIndicatorBitmap"),t.addProperty("IndicatorDownFill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FIndicatorDownFill","SetIndicatorDownFill"),t.addProperty("IndicatorDownStroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FIndicatorDownStroke","SetIndicatorDownStroke"),t.addProperty("IndicatorFill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FIndicatorFill","SetIndicatorFill"),t.addProperty("IndicatorHoverFill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FIndicatorHoverFill","SetIndicatorHoverFill"),t.addProperty("IndicatorHoverStroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FIndicatorHoverStroke","SetIndicatorHoverStroke"),t.addProperty("IndicatorMargin",2,rtl.longint,"FIndicatorMargin","SetIndicatorMargin",{Default:1}),t.addProperty("IndicatorStroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FIndicatorStroke","SetIndicatorStroke"),t.addProperty("SplitterDownFill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FSplitterDownFill","SetSplitterDownFill"),t.addProperty("SplitterDownStroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FSplitterDownStroke","SetSplitterDownStroke"),t.addProperty("SplitterFill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FSplitterFill","SetSplitterFill"),t.addProperty("SplitterHoverFill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FSplitterHoverFill","SetSplitterHoverFill"),t.addProperty("SplitterHoverStroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FSplitterHoverStroke","SetSplitterHoverStroke"),t.addProperty("SplitterStroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FSplitterStroke","SetSplitterStroke")})),rtl.createClass(this,"TTMSFNCSplitterCache",pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl,(function(){this.$init=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.$init.call(this),this.FSplitter=null},this.$final=function(){this.FSplitter=void 0,pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.$final.call(this)},this.Draw=function(t,e){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Draw.apply(this,arguments),null!=this.FSplitter&&(0!==this.FSplitter.FAppearance.FSplitterDownFill.FKind?t.FFill.Assign(this.FSplitter.FAppearance.FSplitterDownFill):(t.FFill.SetKind(1),t.FFill.SetColor(8421504)),t.FStroke.Assign(this.FSplitter.FAppearance.FSplitterDownStroke),t.DrawRectangle$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),2))},rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas["WEBLib.TMSFNCTypes"].ITMSFNCProductInfo),rtl.addIntf(this,pas.System.IUnknown)})),this.$rtti.$MethodVar("TTMSFNCSplitterMoveEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AResizeStyle",this.$rtti.TTMSFNCSplitterResizeStyle],["ADownPos",pas["WEBLib.TMSFNCTypes"].$rtti.TPointF],["ACurrentPos",pas["WEBLib.TMSFNCTypes"].$rtti.TPointF],["ASplit",rtl.double]]),methodkind:0}),rtl.createClass(this,"TTMSFNCCustomSplitter",pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl,(function(){this.$init=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.$init.call(this),this.FAppearance=null,this.FCache=null,this.FControl=null,this.FDownPos=pas["WEBLib.TMSFNCTypes"].TPointF.$new(),this.FMaxSize=0,this.FMinSize=0,this.FMouseDown=!1,this.FMouseHover=!1,this.FNewSize=0,this.FOldSize=0,this.FShowIndicator=!1,this.FSplit=0,this.FSplitterIndicator=0,this.FResizeStyle=0,this.FOnAppearanceChanged=null,this.FOnAfterDrawIndicator=null,this.FOnBeforeDrawIndicator=null,this.FOnChanged=null,this.FOnSplitterMove=null,this.FOnSplitterMoved=null},this.$final=function(){this.FAppearance=void 0,this.FCache=void 0,this.FControl=void 0,this.FDownPos=void 0,this.FOnAppearanceChanged=void 0,this.FOnAfterDrawIndicator=void 0,this.FOnBeforeDrawIndicator=void 0,this.FOnChanged=void 0,this.FOnSplitterMove=void 0,this.FOnSplitterMoved=void 0,pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.$final.call(this)},this.AppearanceChanged=function(t){this.Invalidate(),this.DoAppearanceChanged(t)},this.CalcSplitSize=function(t,e,i,s){var o=0;this.GetSplitterAlign()in rtl.createSet(3,4)?s.set(t-this.FDownPos.X):s.set(e-this.FDownPos.Y),o=0;var n=this.GetSplitterAlign();3===n?o=this.FControl.GetWidth()+s.get():4===n?o=this.FControl.GetWidth()-s.get():1===n?o=this.FControl.GetHeight()+s.get():2===n&&(o=this.FControl.GetHeight()-s.get()),i.set(o),o<this.FMinSize?i.set(this.FMinSize):o>this.FMaxSize&&i.set(this.FMaxSize),o!==i.get()&&(this.GetSplitterAlign()in rtl.createSet(2,4)?o-=i.get():o=i.get()-o,s.set(s.get()+o))},this.DrawIndicatorCircle=function(t,e){var i=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),s=!1,o=!1;i.$assign(this.GetDrawingRect(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e))),s=!0,o=!0,this.DoBeforeDrawIndicator(t,this.FSplitterIndicator,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),this.FResizeStyle,{get:function(){return s},set:function(t){s=t}},{get:function(){return o},set:function(t){o=t}}),s&&(o&&t.DrawEllipse$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),2),this.DoAfterDrawIndicator(t,this.FSplitterIndicator,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),this.FResizeStyle))},this.DrawIndicatorCircles=function(t,e){var i=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),s=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),o=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),n=!1,r=!1;this.GetDrawingRects(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i,s,o),n=!0,r=!0,this.DoBeforeDrawIndicator(t,this.FSplitterIndicator,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(i.Left,i.Top,o.Right,o.Bottom)),this.FResizeStyle,{get:function(){return n},set:function(t){n=t}},{get:function(){return r},set:function(t){r=t}}),n&&(r&&(t.DrawEllipse$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),2),t.DrawEllipse$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(s),2),t.DrawEllipse$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(o),2)),this.DoAfterDrawIndicator(t,this.FSplitterIndicator,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(i.Left,i.Top,o.Right,o.Bottom)),this.FResizeStyle))},this.DrawIndicatorImage=function(t,e){var i=0,s=0,o=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),n=!1,r=!1;null==this.FAppearance.FIndicatorBitmap||pas["WEBLib.TMSFNCTypes"].IsBitmapEmpty(this.FAppearance.FIndicatorBitmap)||(i=(this.GetWidth()-this.FAppearance.FIndicatorBitmap.GetWidth())/2,s=(this.GetHeight()-this.FAppearance.FIndicatorBitmap.GetHeight())/2,o.$assign(pas["WEBLib.TMSFNCTypes"].RectF(i,s,i+this.FAppearance.FIndicatorBitmap.GetWidth(),s+this.FAppearance.FIndicatorBitmap.GetHeight())),n=!0,r=!0,this.DoBeforeDrawIndicator(t,this.FSplitterIndicator,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(o),this.FResizeStyle,{get:function(){return n},set:function(t){n=t}},{get:function(){return r},set:function(t){r=t}}),n&&(r&&t.DrawBitmap$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(o),this.FAppearance.FIndicatorBitmap,!0,!1,!0,!1),this.DoAfterDrawIndicator(t,this.FSplitterIndicator,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(o),this.FResizeStyle)))},this.DrawIndicatorLine=function(t,e){var i,s=pas["WEBLib.TMSFNCTypes"].TPointF.$new(),o=pas["WEBLib.TMSFNCTypes"].TPointF.$new(),n=!1,r=!1;i=this.ScalePaintValue(10),this.GetSplitterAlign()in rtl.createSet(3,4)?(s.$assign(pas["WEBLib.TMSFNCTypes"].PointF(this.GetWidth()/2,this.GetHeight()/2+i)),o.$assign(pas["WEBLib.TMSFNCTypes"].PointF(this.GetWidth()/2,this.GetHeight()/2-i))):(s.$assign(pas["WEBLib.TMSFNCTypes"].PointF(this.GetWidth()/2+i,this.GetHeight()/2)),o.$assign(pas["WEBLib.TMSFNCTypes"].PointF(this.GetWidth()/2-i,this.GetHeight()/2))),n=!0,r=!0,this.DoBeforeDrawIndicator(t,this.FSplitterIndicator,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(s.X,s.Y,o.X,o.Y)),this.FResizeStyle,{get:function(){return n},set:function(t){n=t}},{get:function(){return r},set:function(t){r=t}}),n&&(r&&t.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(s),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(o),2,2),this.DoAfterDrawIndicator(t,this.FSplitterIndicator,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(s.X,s.Y,o.X,o.Y)),this.FResizeStyle))},this.DrawIndicatorSquare=function(t,e){var i=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),s=!1,o=!1;i.$assign(this.GetDrawingRect(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e))),s=!0,o=!0,this.DoBeforeDrawIndicator(t,this.FSplitterIndicator,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),this.FResizeStyle,{get:function(){return s},set:function(t){s=t}},{get:function(){return o},set:function(t){o=t}}),s&&(o&&t.DrawRectangle$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),2),this.DoAfterDrawIndicator(t,this.FSplitterIndicator,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),this.FResizeStyle))},this.DrawIndicatorSquares=function(t,e){var i=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),s=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),o=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),n=!1,r=!1;this.GetDrawingRects(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i,s,o),n=!0,r=!0,this.DoBeforeDrawIndicator(t,this.FSplitterIndicator,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(i.Left,i.Top,o.Right,o.Bottom)),this.FResizeStyle,{get:function(){return n},set:function(t){n=t}},{get:function(){return r},set:function(t){r=t}}),n&&(r&&(t.DrawRectangle$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),2),t.DrawRectangle$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(s),2),t.DrawRectangle$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(o),2)),this.DoAfterDrawIndicator(t,this.FSplitterIndicator,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(i.Left,i.Top,o.Right,o.Bottom)),this.FResizeStyle))},this.DrawLine=function(){null==this.FCache&&(this.FCache=t.TTMSFNCSplitterCache.$create("Create$1",[this]),this.FCache.FSplitter=this),this.FCache.SetBoundsRect(this.GetBoundsRect()),this.GetSplitterAlign()in rtl.createSet(3,4)?this.FCache.SetLeft(this.GetLeft()+Math.round(this.FSplit)):this.FCache.SetTop(this.GetTop()+Math.round(this.FSplit)),this.FCache.SetParent(this.FParent)},this.GetDrawingRect=function(t){var e,i,s,o,n=pas["WEBLib.TMSFNCTypes"].TRectF.$new();return o=this.FAppearance.FIndicatorMargin,i=Math.max(this.GetWidth()-2*o,1),s=Math.max(this.GetHeight()-2*o,1),e=Math.min(i,s),n.$assign(pas["WEBLib.TMSFNCTypes"].RectF(t.Left+o+(i-e)/2,t.Top+o+(s-e)/2,t.Left+o+(i+e)/2,t.Top+o+(s+e)/2)),n},this.GetDrawingRects=function(t,e,i,s){var o,n,r,a;a=this.FAppearance.FIndicatorMargin,n=this.GetWidth()-2*a,r=this.GetHeight()-2*a,o=Math.min(n,r),this.GetSplitterAlign()in rtl.createSet(3,4)?(i.$assign(pas["WEBLib.TMSFNCTypes"].RectF(t.Left+a+(n-o)/2,t.Top+a+(r-o)/2,t.Left+a+(n+o)/2,t.Top+a+(r+o)/2)),e.$assign(pas["WEBLib.TMSFNCTypes"].RectF(t.Left+a+(n-o)/2,t.Top+a+(r-o)/2-o-this.ScalePaintValue(2),t.Left+a+(n+o)/2,t.Top+a+(r+o)/2-o-this.ScalePaintValue(2))),s.$assign(pas["WEBLib.TMSFNCTypes"].RectF(t.Left+a+(n-o)/2,t.Top+a+(r-o)/2+o+this.ScalePaintValue(2),t.Left+a+(n+o)/2,t.Top+a+(r+o)/2+o+this.ScalePaintValue(2)))):(i.$assign(pas["WEBLib.TMSFNCTypes"].RectF(t.Left+a+(n-o)/2,t.Top+a+(r-o)/2,t.Left+a+(n+o)/2,t.Top+a+(r+o)/2)),e.$assign(pas["WEBLib.TMSFNCTypes"].RectF(t.Left+a+(n-o)/2-o-this.ScalePaintValue(2),t.Top+a+(r-o)/2,t.Left+a+(n+o)/2-o-this.ScalePaintValue(2),t.Top+a+(r+o)/2)),s.$assign(pas["WEBLib.TMSFNCTypes"].RectF(t.Left+a+(n-o)/2+o+this.ScalePaintValue(2),t.Top+a+(r-o)/2,t.Left+a+(n+o)/2+o+this.ScalePaintValue(2),t.Top+a+(r+o)/2)))},this.SetAppearance=function(t){this.FAppearance.Assign(t)},this.SetMinSize=function(t){this.FMinSize!==t&&t>=0&&(this.FMinSize=t,this.DoChanged())},this.SetShowIndicator=function(t){this.FShowIndicator!==t&&(this.FShowIndicator=t,this.DoChanged())},this.SetSplitterIndicator=function(t){this.FSplitterIndicator!==t&&(this.FSplitterIndicator=t,this.DoChanged())},this.SetResizeStyle=function(t){this.FResizeStyle!==t&&(this.FResizeStyle=t,this.DoChanged())},this.DoAppearanceChanged=function(t){null!=this.FOnAppearanceChanged&&this.FOnAppearanceChanged(this)},this.DoAfterDrawIndicator=function(t,e,i,s){null!=this.FOnAfterDrawIndicator&&this.FOnAfterDrawIndicator(this,t,e,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),s)},this.DoBeforeDrawIndicator=function(t,e,i,s,o,n){null!=this.FOnBeforeDrawIndicator&&this.FOnBeforeDrawIndicator(this,t,e,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),s,o,n)},this.DoSplitterMove=function(t,e,i,s){null!=this.FOnSplitterMove&&this.FOnSplitterMove(this,t,pas["WEBLib.TMSFNCTypes"].TPointF.$clone(e),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(i),s)},this.DoSplitterMoved=function(t,e,i,s){null!=this.FOnSplitterMoved&&this.FOnSplitterMoved(this,t,pas["WEBLib.TMSFNCTypes"].TPointF.$clone(e),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(i),s)},this.DoCanResize=function(t){return!0,t.get()<=this.FMinSize&&t.set(this.FMinSize),!0},this.DoChanged=function(){this.Invalidate(),null!=this.FOnChanged&&this.FOnChanged(this)},this.DrawBackGroundColor=function(t,e){this.FMouseDown&&0!==this.FResizeStyle?(t.FFill.Assign(this.FAppearance.FSplitterDownFill),t.FStroke.Assign(this.FAppearance.FSplitterDownStroke)):this.FMouseHover?(t.FFill.Assign(this.FAppearance.FSplitterHoverFill),t.FStroke.Assign(this.FAppearance.FSplitterHoverStroke)):(t.FFill.Assign(this.FAppearance.FSplitterFill),t.FStroke.Assign(this.FAppearance.FSplitterStroke)),t.DrawRectangle$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),2)},this.DrawIndicator=function(t,e){if(this.FShowIndicator){this.FMouseDown?(t.FFill.Assign(this.FAppearance.FIndicatorDownFill),t.FStroke.Assign(this.FAppearance.FIndicatorDownStroke)):this.FMouseHover?(t.FFill.Assign(this.FAppearance.FIndicatorHoverFill),t.FStroke.Assign(this.FAppearance.FIndicatorHoverStroke)):(t.FFill.Assign(this.FAppearance.FIndicatorFill),t.FStroke.Assign(this.FAppearance.FIndicatorStroke));var i=this.FSplitterIndicator;0===i?this.DrawIndicatorCircle(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e)):1===i?this.DrawIndicatorCircles(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e)):5===i?this.DrawIndicatorImage(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e)):2===i?this.DrawIndicatorLine(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e)):3===i?this.DrawIndicatorSquare(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e)):4===i&&this.DrawIndicatorSquares(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e))}},this.FindControl=function(){var t=null,e=pas["WEBLib.TMSFNCTypes"].TPointF.$new(),i=0,s=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),o=!1,n=!1;t=null,e.$assign(pas["WEBLib.TMSFNCTypes"].PointF(this.GetLeft(),this.GetTop()));var r=this.GetSplitterAlign();if(3===r)e.X=e.X-1;else if(4===r)e.X=e.X+this.GetWidth();else if(1===r)e.Y=e.Y-1;else{if(2!==r)return t;e.Y=e.Y+this.GetHeight()}if(null!==this.FParent){n=this.GetSplitterAlign()in rtl.createSet(1,2),o=this.GetSplitterAlign()in rtl.createSet(3,4);for(var a=0,l=this.FParent.GetControlsCount()-1;a<=l;a++)if(i=a,t=this.FParent.GetControls(i),(!o||t.FAlign in rtl.createSet(3,4))&&(!n||t.FAlign in rtl.createSet(1,2))&&t.FVisible&&(s.$assign(pas["WEBLib.TMSFNCTypes"].RectF(t.GetBoundsRect().Left,t.GetBoundsRect().Top,t.GetBoundsRect().Right,t.GetBoundsRect().Bottom)),s.Right-s.Left==0&&(this.GetSplitterAlign()in rtl.createSet(1,3)?s.Left=s.Left-1:s.Right=s.Right+1),s.Bottom-s.Top==0&&(this.GetSplitterAlign()in rtl.createSet(1,3)?s.Top=s.Top-1:s.Bottom=s.Bottom+1),pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.PointInRect(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(e),pas["WEBLib.TMSFNCTypes"].TRectF.$clone(s))))return t}return t=null},this.HandleMouseDown=function(t,e,i,s){var o=0,n=null;if(pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleMouseDown.apply(this,arguments),this.CaptureEx(),0===t&&null!=this.FParent){if(this.FDownPos.$assign(pas["WEBLib.TMSFNCTypes"].PointF(i,s)),this.FControl=this.FindControl(),null!==this.FControl){if(this.GetSplitterAlign()in rtl.createSet(4,3)){this.FMaxSize=this.FParent.GetClientWidth()-this.FMinSize;for(var r=0,a=this.FParent.GetControlsCount()-1;r<=a;r++)o=r,pas["WEBLib.Controls"].TControl.isPrototypeOf(this.FParent.GetControls(o))&&(n=this.FParent.GetControls(o)).FVisible&&n.FAlign in rtl.createSet(3,4)&&(this.FMaxSize=this.FMaxSize-n.GetWidth());this.FMaxSize=this.FMaxSize+this.FControl.GetWidth()}else{this.FMaxSize=this.FParent.GetClientHeight()-this.FMinSize;for(var l=0,h=this.FParent.GetControlsCount()-1;l<=h;l++)o=l,pas["WEBLib.Controls"].TControl.isPrototypeOf(this.FParent.GetControls(o))&&(n=this.FParent.GetControls(o)).FVisible&&n.FAlign in rtl.createSet(1,2)&&(this.FMaxSize=this.FMaxSize-n.GetHeight());this.FMaxSize=this.FMaxSize+this.FControl.GetHeight()}this.UpdateSplitterSize(i,s)}0===this.FResizeStyle&&this.DrawLine(),this.FMouseDown=!0,this.Invalidate()}},this.HandleMouseEnter=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleMouseEnter.call(this),this.FMouseHover=!0,this.Invalidate()},this.HandleMouseLeave=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleMouseLeave.call(this),this.FMouseHover=!1,this.Invalidate()},this.HandleMouseMove=function(t,e,i){var s=0,o=0;pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleMouseMove.apply(this,arguments),this.FMouseDown&&null!==this.FControl&&this.FControl.FVisible&&(this.CalcSplitSize(e,i,{get:function(){return s},set:function(t){s=t}},{get:function(){return o},set:function(t){o=t}}),this.DoCanResize({get:function(){return s},set:function(t){s=t}})&&(this.FNewSize=s,this.FSplit=o,this.DoSplitterMove(this.FResizeStyle,pas["WEBLib.TMSFNCTypes"].TPointF.$clone(this.FDownPos),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(e,i)),this.FSplit),1===this.FResizeStyle&&this.UpdateSplitterControlSize(),0===this.FResizeStyle&&this.DrawLine()))},this.HandleMouseUp=function(t,e,i,s){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleMouseUp.apply(this,arguments),null!=this.FControl&&(this.UpdateSplitterControlSize(),this.DoSplitterMoved(this.FResizeStyle,pas["WEBLib.TMSFNCTypes"].TPointF.$clone(this.FDownPos),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(i,s)),this.FSplit)),null!=this.FCache&&(rtl.free(this,"FCache"),this.FCache=null),this.ReleaseCaptureEx(),this.FMouseDown=!1,this.FControl=null,this.FDownPos.$assign(pas["WEBLib.TMSFNCTypes"].PointF(-1,-1)),this.Invalidate()},this.Notification=function(t,e){pas["WEBLib.Menus"].TWebCustomControl.Notification.apply(this,arguments)},this.UpdateSplitterControlSize=function(){if(this.FNewSize!==this.FOldSize){var t=this.GetSplitterAlign();3===t?this.FControl.SetWidth(Math.round(this.FNewSize)):4===t?(this.FControl.SetLeft(this.FControl.GetLeft()+(this.FControl.GetWidth()-Math.round(this.FNewSize))),this.FControl.SetWidth(Math.round(this.FNewSize))):1===t?this.FControl.SetHeight(Math.round(this.FNewSize)):2===t&&(this.FControl.SetTop(this.FControl.GetTop()+(this.FControl.GetHeight()-Math.round(this.FNewSize))),this.FControl.SetHeight(Math.round(this.FNewSize)))}this.FOldSize=this.FNewSize},this.UpdateSplitterSize=function(t,e){this.CalcSplitSize(t,e,{p:this,get:function(){return this.p.FNewSize},set:function(t){this.p.FNewSize=t}},{p:this,get:function(){return this.p.FSplit},set:function(t){this.p.FSplit=t}})},this.SetSplitterAlign=function(t){var e;e=Math.min(this.GetWidth(),this.GetHeight()),this.SetAlign(t),this.GetSplitterAlign()in rtl.createSet(1,2)?this.SetControlCursor(15):this.SetControlCursor(14),this.SetBounds(this.GetLeft(),this.GetTop(),Math.round(e),Math.round(e))},this.GetSplitterAlign=function(){return this.FAlign},this.SetParent=function(t){pas["WEBLib.Controls"].TControl.SetParent.apply(this,arguments),this.SetSplitterAlign(this.GetSplitterAlign())},this.Create$1=function(e){return pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Create$1.apply(this,arguments),this.FAppearance=t.TTMSFNCSplitterAppearance.$create("Create$1",[this]),this.FAppearance.FOnChange=rtl.createCallback(this,"AppearanceChanged"),this.FSplitterIndicator=0,this.FShowIndicator=!0,this.FResizeStyle=1,this.FMouseHover=!1,this.FMouseDown=!1,this.FDownPos.$assign(pas["WEBLib.TMSFNCTypes"].PointF(-1,-1)),this.FMinSize=20,this.SetWidth(10),this.SetHeight(15),this.SetAlign(3),this},this.Destroy=function(){rtl.free(this,"FAppearance"),null!=this.FCache&&rtl.free(this,"FCache"),pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Destroy.call(this)},this.Draw=function(t,e){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Draw.apply(this,arguments),t.DrawRectangle$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),2),this.DrawBackGroundColor(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e)),this.DrawIndicator(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e))},rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas["WEBLib.TMSFNCTypes"].ITMSFNCProductInfo),rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TTMSFNCSplitter",this.TTMSFNCCustomSplitter,(function(){rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas["WEBLib.TMSFNCTypes"].ITMSFNCProductInfo),rtl.addIntf(this,pas.System.IUnknown);var e=this.$rtti;e.addProperty("Align",3,pas["WEBLib.Controls"].$rtti.TAlign,"GetSplitterAlign","SetSplitterAlign"),e.addProperty("Appearance",2,t.$rtti.TTMSFNCSplitterAppearance,"FAppearance","SetAppearance"),e.addProperty("MinSize",2,rtl.double,"FMinSize","SetMinSize"),e.addProperty("ResizeStyle",2,t.$rtti.TTMSFNCSplitterResizeStyle,"FResizeStyle","SetResizeStyle",{Default:t.TTMSFNCSplitterResizeStyle.rsContinuous}),e.addProperty("ShowIndicator",2,rtl.boolean,"FShowIndicator","SetShowIndicator",{Default:!0}),e.addProperty("SplitterIndicator",2,t.$rtti.TTMSFNCSplitterIndicator,"FSplitterIndicator","SetSplitterIndicator",{Default:t.TTMSFNCSplitterIndicator.siCircle}),e.addProperty("OnAppearanceChanged",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnAppearanceChanged","FOnAppearanceChanged"),e.addProperty("OnChanged",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnChanged","FOnChanged"),e.addProperty("OnSplitterMove",0,t.$rtti.TTMSFNCSplitterMoveEvent,"FOnSplitterMove","FOnSplitterMove"),e.addProperty("OnSplitterMoved",0,t.$rtti.TTMSFNCSplitterMoveEvent,"FOnSplitterMoved","FOnSplitterMoved"),e.attr=[pas.Classes.ComponentPlatformsAttribute,"Create$1",[0]]}))}),["Math","WEBLib.TMSFNCUtils"]),rtl.module("WEBLib.Buttons",["System","Classes","SysUtils","WEBLib.Controls","Web","WEBLib.Graphics","WEBLib.StdCtrls","WEBLib.ComCtrls","WEBLib.ExtCtrls","WEBLib.Forms","WEBLib.Menus"],(function(){"use strict";var t=this;this.TButtonLayout={0:"blGlyphLeft",blGlyphLeft:0,1:"blGlyphRight",blGlyphRight:1,2:"blGlyphTop",blGlyphTop:2,3:"blGlyphBottom",blGlyphBottom:3},this.$rtti.$Enum("TButtonLayout",{minvalue:0,maxvalue:3,ordtype:1,enumtype:this.TButtonLayout}),rtl.createClass(this,"TCustomSpeedButton",pas["WEBLib.Menus"].TWebCustomControl,(function(){this.$init=function(){pas["WEBLib.Menus"].TWebCustomControl.$init.call(this),this.FMaterialGlyph="",this.FColor$1=0,this.FIntColor=0,this.FDown=!1,this.FFlat=!1,this.FGroupIndex=0,this.FAllowAllUp=!1,this.FGlyph=null,this.FLayout=0,this.FGlyphURL="",this.FMaterialGlyphSize=0,this.FMaterialGlyphColor=0,this.FMaterialGlyphType=0,this.FGlyphSize=0},this.$final=function(){this.FGlyph=void 0,pas["WEBLib.Menus"].TWebCustomControl.$final.call(this)},this.SetMaterialGlyph=function(t){this.FMaterialGlyph!==t&&(this.FMaterialGlyph=t,this.UpdateElement())},this.SetColorEx=function(t){this.FColor$1!==t&&(this.FColor$1=t,this.FIntColor=t,this.UpdateElement())},this.SetIntColor=function(t){this.FIntColor!==t&&(this.FIntColor=t,this.UpdateElement())},this.SetGroupIndex=function(t){this.FGroupIndex=t},this.SetDown=function(t){this.FDown!==t&&(this.FDown=t,this.UpdateElement())},this.SetFlat=function(t){this.FFlat!==t&&(this.FFlat=t,this.RecreateElement())},this.SetGlyph=function(t){this.FGlyph.Assign(t),this.UpdateElement()},this.SetGlyphURL=function(t){this.FGlyphURL!==t&&(this.FGlyphURL=t,this.RecreateElement())},this.SetMaterialGlyphSize=function(t){t>0&&t<100&&(this.FMaterialGlyphSize=t,this.UpdateElement())},this.SetMaterialGyphColor=function(t){this.FMaterialGlyphColor!==t&&(this.FMaterialGlyphColor=t,this.UpdateElement())},this.SetMaterialGlyphType=function(t){this.FMaterialGlyphType!==t&&(this.FMaterialGlyphType=t,this.UpdateElement())},this.SetGlyphSize=function(t){this.FGlyphSize!==t&&(this.FGlyphSize=t,this.UpdateElement())},this.SetEnabled=function(t){pas["WEBLib.Controls"].TControl.SetEnabled.apply(this,arguments),this.UpdateElement()},this.SetCaption=function(t){this.FCaption!==t&&(pas["WEBLib.Controls"].TCustomControl.SetCaption.call(this,t),this.UpdateElement())},this.CreateElement=function(){return this.FFlat?document.createElement("SPAN"):document.createElement("BUTTON")},this.UpdateElement=function(){var t="",e="",i="",s="",o="",n="",r="",a="",l="";if(pas["WEBLib.Controls"].TControl.UpdateElement.call(this),this.IsUpdating()||""===this.FMaterialGlyph||this.AddControlLink("googlematerial","https://fonts.googleapis.com/icon?family=Material+Icons"),null!=this.GetElementHandle()){this.GetElementHandle().style.setProperty("vertical-align","middle"),this.GetElementHandle().style.setProperty("overflow","hidden"),this.GetElementHandle().style.setProperty("padding","0px"),this.GetElementHandle().style.setProperty("text-align","center"),this.FFlat&&this.FVisible&&(this.GetElementHandle().style.setProperty("display","flex"),this.GetElementHandle().style.setProperty("justify-content","center")),t="",e="",i="",this.FEnabled||(e=" md-light md-inactive"),i="pointer-events:none",""!==this.FMaterialGlyph&&(r="",-1!==this.FMaterialGlyphColor&&(r=";color:"+pas["WEBLib.Graphics"].ColorToHTML(this.FMaterialGlyphColor)),s='<i class="'+pas["WEBLib.Controls"].GetMaterialClass(this.FMaterialGlyphType)+e+'" style="'+i+";font-size:"+pas.SysUtils.IntToStr(this.FMaterialGlyphSize)+"px"+r+'">'+this.FMaterialGlyph+"</i>"),""!==this.FGlyph.GetData()?o="data:image/jpeg;base64,"+pas["WEBLib.WebTools"].HexImageDecodeAsBase64(this.FGlyph.GetData()):""!==this.FGlyph.FFilename?o=this.FGlyph.FFilename:""!==this.FGlyphURL&&(o=this.FGlyphURL),n="",0!==this.FGlyphSize&&(n="width:"+pas.SysUtils.TIntegerHelper.ToString$1.call({p:this,get:function(){return this.p.FGlyphSize},set:function(t){this.p.FGlyphSize=t}})+"px"),""!==o&&(s='<img style="'+i+";vertical-align:middle;"+n+'" src="'+o+'">'),0!==this.GetElementHandle().childElementCount&&this.GetIsLinked()||(a=pas["WEBLib.WebTools"].ProcessAccelerator(this.FCaption,{get:function(){return l},set:function(t){l=t}})),""!==l&&this.GetElementHandle().setAttribute("accesskey",l),this.FTabStop?this.GetElementHandle().setAttribute("tabindex",pas.SysUtils.IntToStr(this.FTabOrder)):this.GetElementHandle().setAttribute("tabindex","-1");var h=this.FLayout;0===h?t='<table border="0" align="center" style="'+i+'"><tr><td style="border:none">'+s+'</td><td style="border:none">'+a+"</td></tr></table>":1===h?t='<table border="0" align="center" style="'+i+'"><tr><td style="border:none">'+a+'</td><td style="border:none">'+s+"</td></tr></table>":2===h?t='<table border="0" align="center" style="'+i+'"><tr><td style="border:none">'+s+'</td></tr><tr><td style="border:none">'+a+"</td></tr></table>":3===h&&(t='<table border="0" align="center" style="'+i+'"><tr><td style="border:none">'+a+'</td></tr><tr><td style="border:none">'+s+"</td></tr></table>"),this.GetElementHandle().innerHTML=t,pas["WEBLib.Controls"].SetHTMLElementFont(this.GetElementHandle().firstChild,this.FFont,!(""===this.FElementClassName&&0===this.FElementFont)),this.IsEnabled()?0===this.FElementFont&&""===this.FElementClassName&&(this.GetElementHandle().style.setProperty("color",pas["WEBLib.Graphics"].ColorToHTML(this.FFont.FColor)),4 in this.FComponentState&&this.GetElementHandle().firstChild.style.setProperty("color",pas["WEBLib.Graphics"].ColorToHTML(this.FFont.FColor))):this.GetElementHandle().style.removeProperty("color")}},this.UpdateElementVisual=function(){var t=0;pas["WEBLib.Controls"].TCustomControl.UpdateElementVisual.call(this),null!=this.GetElementHandle()&&(-1!==(t=this.FDown?8421504:this.FIntColor)&&""===this.FElementClassName?this.GetElementHandle().style.setProperty("background-color",pas["WEBLib.Graphics"].ColorToHTML(t)):this.GetElementHandle().style.setProperty("background-color",""),null!=this.GetElementHandle().firstChild&&pas["WEBLib.Controls"].SetHTMLElementFont(this.GetElementHandle().firstChild,this.FFont,!(""===this.FElementClassName&&0===this.FElementFont)),this.IsEnabled()?0===this.FElementFont&&""===this.FElementClassName&&(this.GetElementHandle().style.setProperty("color",pas["WEBLib.Graphics"].ColorToHTML(this.FFont.FColor)),4 in this.FComponentState&&null!=this.GetElementHandle().firstChild&&this.GetElementHandle().firstChild.style.setProperty("color",pas["WEBLib.Graphics"].ColorToHTML(this.FFont.FColor))):this.GetElementHandle().style.removeProperty("color"))},this.UpdateGroup=function(){var e=0;if(null!=this.FParent)for(var i=0,s=this.FParent.GetControlsCount()-1;i<=s;i++)e=i,this.FParent.GetControls(e)!==this&&t.TSpeedButton.isPrototypeOf(this.FParent.GetControls(e))&&rtl.as(this.FParent.GetControls(e),t.TSpeedButton).FGroupIndex===this.FGroupIndex&&rtl.as(this.FParent.GetControls(e),t.TSpeedButton).SetDown(!1)},this.DoMouseLeave=function(){var t;pas["WEBLib.Controls"].TControl.DoMouseLeave.call(this),null!=(t=pas["WEBLib.Forms"].GetParentForm(this))&&1===t.FCSSLibrary&&this.FShowHint&&""!==this.FHint||this.SetIntColor(this.FColor$1)},this.DoMouseEnter=function(){var t;pas["WEBLib.Controls"].TControl.DoMouseEnter.call(this),null!=(t=pas["WEBLib.Forms"].GetParentForm(this))&&1===t.FCSSLibrary&&this.FShowHint&&""!==this.FHint||this.FEnabled&&this.SetIntColor(12632256)},this.MouseUp=function(t,e,i,s){pas["WEBLib.Controls"].TControl.MouseUp.apply(this,arguments),this.FEnabled&&this.SetIntColor(12632256)},this.MouseDown=function(t,e,i,s){pas["WEBLib.Controls"].TControl.MouseDown.apply(this,arguments),this.FEnabled&&(this.SetIntColor(8421504),this.FGroupIndex>0&&(this.FDown&&this.FAllowAllUp?this.SetDown(!1):(this.SetDown(!0),this.UpdateGroup())))},this.GlyphChanged=function(t){this.UpdateElement()},this.Destroy=function(){rtl.free(this,"FGlyph"),pas["WEBLib.Controls"].TCustomControl.Destroy.call(this)},this.CreateInitialize=function(){pas["WEBLib.Controls"].TCustomControl.CreateInitialize.call(this),this.FColor$1=-1,this.FIntColor=-1,this.FGroupIndex=0,this.FDown=!1,this.FFlat=!1,this.FGlyph=pas["WEBLib.Graphics"].TURLPicture.$create("Create"),this.FGlyph.FOnChange=rtl.createCallback(this,"GlyphChanged"),this.FGlyph.FOnDataChange=rtl.createCallback(this,"GlyphChanged"),this.FLayout=0,this.FMaterialGlyphSize=18,this.FMaterialGlyphColor=-1,this.FMaterialGlyphType=0},this.CanFocus=function(){return!1,!1},rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TSpeedButton",this.TCustomSpeedButton,(function(){rtl.addIntf(this,pas.System.IUnknown);var e=this.$rtti;e.addProperty("Align",2,pas["WEBLib.Controls"].$rtti.TAlign,"FAlign","SetAlign",{Default:pas["WEBLib.Controls"].TAlign.alNone}),e.addProperty("AlignWithMargins",2,rtl.boolean,"FAlignWithMargins","SetAlignWithMargins",{Default:!1}),e.addProperty("Anchors",2,pas["WEBLib.Controls"].$rtti.TAnchors,"FAnchors","SetAnchors",{Default:rtl.createSet(0,1)}),e.addProperty("AllowAllUp",0,rtl.boolean,"FAllowAllUp","FAllowAllUp"),e.addProperty("Caption",2,rtl.string,"FCaption","SetCaption"),e.addProperty("Color",2,pas["WEBLib.Graphics"].$rtti.TColor,"FColor$1","SetColorEx",{Default:-1}),e.addProperty("Down",2,rtl.boolean,"FDown","SetDown"),e.addProperty("ElementClassName",2,pas["WEBLib.Controls"].$rtti.TElementClassName,"FElementClassName","SetElementClassName"),e.addProperty("ElementID",3,pas["WEBLib.Controls"].$rtti.TElementID,"GetID","SetID"),e.addProperty("ElementFont",2,pas["WEBLib.Controls"].$rtti.TElementFont,"FElementFont","SetElementFont",{Default:pas["WEBLib.Controls"].TElementFont.efProperty}),e.addProperty("ElementPosition",2,pas["WEBLib.Controls"].$rtti.TElementPosition,"FElementPosition","SetElementPosition",{Default:pas["WEBLib.Controls"].TElementPosition.epAbsolute}),e.addProperty("Enabled",2,rtl.boolean,"FEnabled","SetEnabled",{Default:!0}),e.addProperty("Flat",2,rtl.boolean,"FFlat","SetFlat",{Default:!1}),e.addProperty("Font",2,pas["WEBLib.Graphics"].$rtti.TFont,"FFont","SetFont"),e.addProperty("Glyph",2,pas["WEBLib.Graphics"].$rtti.TURLPicture,"FGlyph","SetGlyph"),e.addProperty("GlyphURL",2,rtl.string,"FGlyphURL","SetGlyphURL"),e.addProperty("GlyphSize",2,rtl.longint,"FGlyphSize","SetGlyphSize",{Default:0}),e.addProperty("GroupIndex",2,rtl.longint,"FGroupIndex","SetGroupIndex"),e.addProperty("Height",3,rtl.longint,"GetHeight","SetHeight"),e.addProperty("HeightPercent",2,rtl.double,"FHeightPercent","SetHeightPercent",{Default:100}),e.addProperty("HeightStyle",2,pas["WEBLib.Controls"].$rtti.TSizeStyle,"FHeightStyle","SetHeightStyle",{Default:pas["WEBLib.Controls"].TSizeStyle.ssAbsolute}),e.addProperty("Hint",2,rtl.string,"FHint","SetHint"),e.addProperty("Layout",0,t.$rtti.TButtonLayout,"FLayout","FLayout",{Default:t.TButtonLayout.blGlyphLeft}),e.addProperty("Margins",2,pas["WEBLib.Controls"].$rtti.TMargins,"FMargins","SetMargins"),e.addProperty("MaterialGlyph",2,rtl.string,"FMaterialGlyph","SetMaterialGlyph"),e.addProperty("MaterialGlyphColor",2,pas["WEBLib.Graphics"].$rtti.TColor,"FMaterialGlyphColor","SetMaterialGyphColor",{Default:-1}),e.addProperty("MaterialGlyphSize",2,rtl.longint,"FMaterialGlyphSize","SetMaterialGlyphSize",{Default:18}),e.addProperty("MaterialGlyphType",2,pas["WEBLib.Controls"].$rtti.TMaterialGlyphType,"FMaterialGlyphType","SetMaterialGlyphType",{Default:pas["WEBLib.Controls"].TMaterialGlyphType.mgNormal}),e.addProperty("ParentFont",2,rtl.boolean,"FParentFont","SetParentFont",{Default:!0}),e.addProperty("PopupMenu",0,pas["WEBLib.Menus"].$rtti.TPopupMenu,"FPopupMenu","FPopupMenu"),e.addProperty("ShowHint",2,rtl.boolean,"FShowHint","SetShowHint",{Default:!1}),e.addProperty("TabOrder",2,rtl.longint,"FTabOrder","SetTabOrder"),e.addProperty("TabStop",2,rtl.boolean,"FTabStop","SetTabStop",{Default:!0}),e.addProperty("Visible",2,rtl.boolean,"FVisible","SetVisible",{Default:!0}),e.addProperty("Width",3,rtl.longint,"GetWidth","SetWidth"),e.addProperty("WidthPercent",2,rtl.double,"FWidthPercent","SetWidthPercent",{Default:100}),e.addProperty("WidthStyle",2,pas["WEBLib.Controls"].$rtti.TSizeStyle,"FWidthStyle","SetWidthStyle",{Default:pas["WEBLib.Controls"].TSizeStyle.ssAbsolute}),e.addProperty("OnClick",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnClick","FOnClick"),e.addProperty("OnDblClick",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnDblClick","FOnDblClick"),e.addProperty("OnKeyDown",0,pas["WEBLib.Controls"].$rtti.TKeyEvent,"FOnKeyDown","FOnKeyDown"),e.addProperty("OnKeyPress",0,pas["WEBLib.Controls"].$rtti.TKeyPressEvent,"FOnKeyPress","FOnKeyPress"),e.addProperty("OnKeyUp",0,pas["WEBLib.Controls"].$rtti.TKeyEvent,"FOnKeyUp","FOnKeyUp"),e.addProperty("OnMouseDown",0,pas["WEBLib.Controls"].$rtti.TMouseEvent,"FOnMouseDown","FOnMouseDown"),e.addProperty("OnMouseUp",0,pas["WEBLib.Controls"].$rtti.TMouseEvent,"FOnMouseUp","FOnMouseUp"),e.addProperty("OnMouseMove",0,pas["WEBLib.Controls"].$rtti.TMouseMoveEvent,"FOnMouseMove","FOnMouseMove"),e.addProperty("OnMouseLeave",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnMouseLeave","FOnMouseLeave"),e.addProperty("OnMouseEnter",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnMouseEnter","FOnMouseEnter"),e.addProperty("OnEnter",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnEnter","FOnEnter"),e.addProperty("OnExit",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnExit","FOnExit")})),rtl.createClass(this,"TCustomToolBar",pas["WEBLib.Controls"].TCustomControl,(function(){this.CreateElement=function(){var t=null,e=null;return t=document.createElement("SPAN"),4 in this.FComponentState&&((e=document.createElement("DIV")).style.setProperty("z-index","10"),e.style.setProperty("width","100%"),e.style.setProperty("height","100%"),e.style.setProperty("webkit-user-select","none"),e.style.setProperty("moz-user-select","none"),e.style.setProperty("khtml-user-select","none"),e.style.setProperty("ms-user-select","none"),e.style.setProperty("user-select","none"),e.style.setProperty("position","absolute"),t.appendChild(e)),t},this.CreateInitialize=function(){pas["WEBLib.Controls"].TCustomControl.CreateInitialize.call(this),this.SetColor(13619151),this.FControlStyle=rtl.unionSet(this.FControlStyle,rtl.createSet(0)),this.SetWidth(300),this.SetHeight(32)},rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TToolBar",this.TCustomToolBar,(function(){rtl.addIntf(this,pas.System.IUnknown);var t=this.$rtti;t.addProperty("Align",2,pas["WEBLib.Controls"].$rtti.TAlign,"FAlign","SetAlign",{Default:pas["WEBLib.Controls"].TAlign.alNone}),t.addProperty("AlignWithMargins",2,rtl.boolean,"FAlignWithMargins","SetAlignWithMargins",{Default:!1}),t.addProperty("Anchors",2,pas["WEBLib.Controls"].$rtti.TAnchors,"FAnchors","SetAnchors",{Default:rtl.createSet(0,1)}),t.addProperty("Color",2,pas["WEBLib.Graphics"].$rtti.TColor,"FColor","SetColor",{Default:13619151}),t.addProperty("DragMode",2,pas["WEBLib.Controls"].$rtti.TDragMode,"FDragMode","SetDragMode",{Default:pas["WEBLib.Controls"].TDragMode.dmManual}),t.addProperty("Enabled",2,rtl.boolean,"FEnabled","SetEnabled",{Default:!0}),t.addProperty("ElementClassName",2,pas["WEBLib.Controls"].$rtti.TElementClassName,"FElementClassName","SetElementClassName"),t.addProperty("ElementID",3,pas["WEBLib.Controls"].$rtti.TElementID,"GetID","SetID"),t.addProperty("ElementFont",2,pas["WEBLib.Controls"].$rtti.TElementFont,"FElementFont","SetElementFont",{Default:pas["WEBLib.Controls"].TElementFont.efProperty}),t.addProperty("ElementPosition",2,pas["WEBLib.Controls"].$rtti.TElementPosition,"FElementPosition","SetElementPosition",{Default:pas["WEBLib.Controls"].TElementPosition.epAbsolute}),t.addProperty("Height",3,rtl.longint,"GetHeight","SetHeight"),t.addProperty("HeightPercent",2,rtl.double,"FHeightPercent","SetHeightPercent",{Default:100}),t.addProperty("HeightStyle",2,pas["WEBLib.Controls"].$rtti.TSizeStyle,"FHeightStyle","SetHeightStyle",{Default:pas["WEBLib.Controls"].TSizeStyle.ssAbsolute}),t.addProperty("Hint",2,rtl.string,"FHint","SetHint"),t.addProperty("Left",3,rtl.longint,"GetLeft","SetLeft"),t.addProperty("Margins",2,pas["WEBLib.Controls"].$rtti.TMargins,"FMargins","SetMargins"),t.addProperty("ShowHint",2,rtl.boolean,"FShowHint","SetShowHint",{Default:!1}),t.addProperty("Top",3,rtl.longint,"GetTop","SetTop"),t.addProperty("Visible",2,rtl.boolean,"FVisible","SetVisible",{Default:!0}),t.addProperty("Width",3,rtl.longint,"GetWidth","SetWidth"),t.addProperty("WidthPercent",2,rtl.double,"FWidthPercent","SetWidthPercent",{Default:100}),t.addProperty("WidthStyle",2,pas["WEBLib.Controls"].$rtti.TSizeStyle,"FWidthStyle","SetWidthStyle",{Default:pas["WEBLib.Controls"].TSizeStyle.ssAbsolute}),t.addProperty("OnClick",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnClick","FOnClick"),t.addProperty("OnDblClick",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnDblClick","FOnDblClick"),t.addProperty("OnDragDrop",0,pas["WEBLib.Controls"].$rtti.TDragDropEvent,"FOnDragDrop","FOnDragDrop"),t.addProperty("OnDragOver",0,pas["WEBLib.Controls"].$rtti.TDragOverEvent,"FOnDragOver","FOnDragOver"),t.addProperty("OnEndDrag",0,pas["WEBLib.Controls"].$rtti.TEndDragEvent,"FonEndDrag","FonEndDrag"),t.addProperty("OnStartDrag",0,pas["WEBLib.Controls"].$rtti.TStartDragEvent,"FOnStartDrag","FOnStartDrag")}))}),["WEBLib.WebTools","Math"]),rtl.module("WEBLib.ComCtrls",["System","Classes","SysUtils","Web","WEBLib.Controls","WEBLib.Graphics","WEBLib.ExtCtrls","WEBLib.Menus"],(function(){"use strict";var t=this;this.TProgressBarStyle={0:"pbstNormal",pbstNormal:0,1:"pbstMarquee",pbstMarquee:1,2:"pbstDiv",pbstDiv:2},this.$rtti.$Enum("TProgressBarStyle",{minvalue:0,maxvalue:2,ordtype:1,enumtype:this.TProgressBarStyle}),this.TProgressBarValue={0:"pbvNone",pbvNone:0,1:"pbvPercentage",pbvPercentage:1,2:"pbvAbsolute",pbvAbsolute:2},this.$rtti.$Enum("TProgressBarValue",{minvalue:0,maxvalue:2,ordtype:1,enumtype:this.TProgressBarValue}),rtl.createClass(this,"TProgressBar",pas["WEBLib.Menus"].TWebCustomControl,(function(){this.$init=function(){pas["WEBLib.Menus"].TWebCustomControl.$init.call(this),this.FMax=0,this.FMin=0,this.FPosition=0,this.FStyle=0,this.FElementBarClassName="",this.FValue=0},this.SetStyle=function(t){this.FStyle!==t&&(this.FStyle=t,null!=this.GetElementHandle()&&(this.CreateProgressElement(this.GetElementHandle()),this.DoUpdate()))},this.SetElementBarClassName=function(t){this.FElementBarClassName=t,this.DoUpdate()},this.SetValue=function(t){this.FValue=t,this.DoUpdate()},this.CreateElement=function(){var t;return t=document.createElement("SPAN"),this.CreateProgressElement(t),t},this.SetMax=function(t){this.FMax=t,this.DoUpdate()},this.SetMin=function(t){this.FMin=t,this.DoUpdate()},this.SetPosition=function(t){t>=this.FMin&&t<=this.FMax&&(this.FPosition=t,this.DoUpdate())},this.DoUpdate=function(){var t=0,e=0,i=null,s=0;if(null!=this.GetContainer())if(s=this.FMax!==this.FMin?Math.round((this.FPosition-this.FMin)/(this.FMax-this.FMin)*100):0,this.GetIsLinked())"DIV"===this.GetElementHandle().tagName?"progressbar"===this.GetElementHandle().getAttribute("role")?this.GetElementHandle().style.setProperty("width",pas.SysUtils.IntToStr(s)+"%"):this.GetElementHandle().innerHTML=pas.SysUtils.IntToStr(s):this.GetElementHandle().setAttribute("value",pas.SysUtils.IntToStr(s));else if(2===this.FStyle){i=this.GetElementHandle().firstChild,""!==this.FElementClassName&&(i.setAttribute("class",this.FElementClassName),this.GetElementHandle().removeAttribute("class")),i.style.setProperty("height",pas.SysUtils.IntToStr(this.GetHeight())+"px"),1===this.FWidthStyle&&i.style.setProperty("width",pas.SysUtils.IntToStr(this.GetWidth())+"px"),i=i.firstChild,""!==this.FElementBarClassName&&i.setAttribute("class",this.FElementBarClassName),i.setAttribute("role","progressbar"),i.style.setProperty("width",pas.SysUtils.IntToStr(s)+"%");var o=this.FValue;1===o?i.innerHTML=pas.SysUtils.IntToStr(s)+"%":2===o?i.innerHTML=pas.SysUtils.IntToStr(this.FPosition):0===o&&(i.innerHTML="")}else(i=this.GetElementHandle().firstChild).style.setProperty("width","100%"),i.style.setProperty("height","100%"),t=this.FPosition-this.FMin,e=this.FMax-this.FMin,i.setAttribute("max",pas.SysUtils.IntToStr(e)),0===this.FStyle?i.setAttribute("value",pas.SysUtils.IntToStr(t)):i.removeAttribute("value")},this.CreateProgressElement=function(t){for(var e=null;null!=t.firstChild;)t.removeChild(t.firstChild);2===this.FStyle?(e=document.createElement("DIV")).appendChild(document.createElement("DIV")):e=document.createElement("PROGRESS"),t.appendChild(e)},this.CreateInitialize=function(){pas["WEBLib.Controls"].TCustomControl.CreateInitialize.call(this),this.FMax=100,this.FMin=0,this.FPosition=0,this.FStyle=0},this.AfterLoadDFMValues=function(){pas.Classes.TComponent.AfterLoadDFMValues.call(this),this.DoUpdate()},rtl.addIntf(this,pas.System.IUnknown);var e=this.$rtti;e.addProperty("Align",2,pas["WEBLib.Controls"].$rtti.TAlign,"FAlign","SetAlign",{Default:pas["WEBLib.Controls"].TAlign.alNone}),e.addProperty("AlignWithMargins",2,rtl.boolean,"FAlignWithMargins","SetAlignWithMargins",{Default:!1}),e.addProperty("Anchors",2,pas["WEBLib.Controls"].$rtti.TAnchors,"FAnchors","SetAnchors",{Default:rtl.createSet(0,1)}),e.addProperty("DragMode",2,pas["WEBLib.Controls"].$rtti.TDragMode,"FDragMode","SetDragMode",{Default:pas["WEBLib.Controls"].TDragMode.dmManual}),e.addProperty("ElementBarClassName",2,rtl.string,"FElementBarClassName","SetElementBarClassName"),e.addProperty("ElementPosition",2,pas["WEBLib.Controls"].$rtti.TElementPosition,"FElementPosition","SetElementPosition",{Default:pas["WEBLib.Controls"].TElementPosition.epAbsolute}),e.addProperty("Height",3,rtl.longint,"GetHeight","SetHeight"),e.addProperty("HeightPercent",2,rtl.double,"FHeightPercent","SetHeightPercent",{Default:100}),e.addProperty("HeightStyle",2,pas["WEBLib.Controls"].$rtti.TSizeStyle,"FHeightStyle","SetHeightStyle",{Default:pas["WEBLib.Controls"].TSizeStyle.ssAbsolute}),e.addProperty("Left",3,rtl.longint,"GetLeft","SetLeft"),e.addProperty("Margins",2,pas["WEBLib.Controls"].$rtti.TMargins,"FMargins","SetMargins"),e.addProperty("Max",2,rtl.longint,"FMax","SetMax"),e.addProperty("Min",2,rtl.longint,"FMin","SetMin"),e.addProperty("PopupMenu",0,pas["WEBLib.Menus"].$rtti.TPopupMenu,"FPopupMenu","FPopupMenu"),e.addProperty("Position",2,rtl.longint,"FPosition","SetPosition"),e.addProperty("Style",2,t.$rtti.TProgressBarStyle,"FStyle","SetStyle"),e.addProperty("Top",3,rtl.longint,"GetTop","SetTop"),e.addProperty("Value",2,t.$rtti.TProgressBarValue,"FValue","SetValue"),e.addProperty("Visible",2,rtl.boolean,"FVisible","SetVisible",{Default:!0}),e.addProperty("Width",3,rtl.longint,"GetWidth","SetWidth"),e.addProperty("WidthPercent",2,rtl.double,"FWidthPercent","SetWidthPercent",{Default:100}),e.addProperty("WidthStyle",2,pas["WEBLib.Controls"].$rtti.TSizeStyle,"FWidthStyle","SetWidthStyle",{Default:pas["WEBLib.Controls"].TSizeStyle.ssAbsolute}),e.addProperty("OnDragDrop",0,pas["WEBLib.Controls"].$rtti.TDragDropEvent,"FOnDragDrop","FOnDragDrop"),e.addProperty("OnDragOver",0,pas["WEBLib.Controls"].$rtti.TDragOverEvent,"FOnDragOver","FOnDragOver"),e.addProperty("OnEndDrag",0,pas["WEBLib.Controls"].$rtti.TEndDragEvent,"FonEndDrag","FonEndDrag"),e.addProperty("OnStartDrag",0,pas["WEBLib.Controls"].$rtti.TStartDragEvent,"FOnStartDrag","FOnStartDrag")})),rtl.createClass(this,"TWebProgressBar",this.TProgressBar,(function(){rtl.addIntf(this,pas.System.IUnknown)}))}),["WEBLib.Buttons","WEBLib.Forms","WEBLib.Utils"]),rtl.module("WEBLib.TMSFNCPanel",["System","Classes","WEBLib.TMSFNCCustomControl","Types","WEBLib.TMSFNCTypes","WEBLib.Controls","WEBLib.TMSFNCBitmapContainer","WEBLib.TMSFNCGraphics","WEBLib.TMSFNCPopup","WEBLib.TMSFNCGraphicsTypes","TypInfo"],(function(){"use strict";var t=this;this.MAJ_VER=1,this.MIN_VER=0,this.REL_VER=2,this.BLD_VER=0,this.MINSECTIONHEIGHT=16,this.TTMSFNCPanelButton={0:"pbCompact",pbCompact:0,1:"pbClose",pbClose:1,2:"pbExpander",pbExpander:2,3:"pbDropDown",pbDropDown:3},this.$rtti.$Enum("TTMSFNCPanelButton",{minvalue:0,maxvalue:3,ordtype:1,enumtype:this.TTMSFNCPanelButton}),this.$rtti.$Set("TTMSFNCPanelButtons",{comptype:this.$rtti.TTMSFNCPanelButton}),this.TTMSFNCPanelCloseAction={0:"pcaNone",pcaNone:0,1:"pcaFree",pcaFree:1,2:"pcaHide",pcaHide:2},this.$rtti.$Enum("TTMSFNCPanelCloseAction",{minvalue:0,maxvalue:2,ordtype:1,enumtype:this.TTMSFNCPanelCloseAction}),this.TTMSFNCPanelDropDownAction={0:"pddaNone",pddaNone:0,1:"pddaPopup",pddaPopup:1},this.$rtti.$Enum("TTMSFNCPanelDropDownAction",{minvalue:0,maxvalue:1,ordtype:1,enumtype:this.TTMSFNCPanelDropDownAction}),this.TTMSFNCPanelExpandAction={0:"peaNone",peaNone:0,1:"peaExpand",peaExpand:1},this.$rtti.$Enum("TTMSFNCPanelExpandAction",{minvalue:0,maxvalue:1,ordtype:1,enumtype:this.TTMSFNCPanelExpandAction}),this.TTMSFNCPanelCompactAction={0:"pcNone",pcNone:0,1:"pcCompact",pcCompact:1},this.$rtti.$Enum("TTMSFNCPanelCompactAction",{minvalue:0,maxvalue:1,ordtype:1,enumtype:this.TTMSFNCPanelCompactAction}),rtl.createClass(this,"TTMSFNCPanelElement",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FOnChanged=null,this.FText="",this.FSize=0,this.FWordWrapping=!1,this.FVerticalTextAlign=0,this.FHorizontalTextAlign=0,this.FTrimming=0,this.FFont=null,this.FShowButtons=!1,this.FButtons={},this.FVisible=!1,this.FButtonSpacing=0,this.FButtonSize=0,this.FFill=null,this.FStroke=null,this.FStretchText=!1,this.FDropDownControl=null,this.FDropDownHeight=0,this.FDropDownWidth=0},this.$final=function(){this.FOnChanged=void 0,this.FFont=void 0,this.FButtons=void 0,this.FFill=void 0,this.FStroke=void 0,this.FDropDownControl=void 0,pas.Classes.TPersistent.$final.call(this)},this.SetText=function(t){this.FText!==t&&(this.FText=t,this.Changed())},this.IsSizeStored=function(){return 28!==this.FSize},this.SetSize=function(t){this.FSize!==t&&(this.FSize=t,this.Changed())},this.SetHorizontalTextAlign=function(t){this.FHorizontalTextAlign!==t&&(this.FHorizontalTextAlign=t,this.Changed())},this.SetVerticalTextAlign=function(t){this.FVerticalTextAlign!==t&&(this.FVerticalTextAlign=t,this.Changed())},this.SetWordWrapping=function(t){this.FWordWrapping!==t&&(this.FWordWrapping=t,this.Changed())},this.SetTrimming=function(t){this.FTrimming!==t&&(this.FTrimming=t,this.Changed())},this.SetFont=function(t){this.FFont.AssignSource(t)},this.SetButtons=function(t){rtl.neSet(this.FButtons,t)&&(this.FButtons=rtl.refSet(t),this.Changed())},this.SetShowButtons=function(t){this.FShowButtons!==t&&(this.FShowButtons=t,this.Changed())},this.SetVisible=function(t){this.FVisible!==t&&(this.FVisible=t,this.Changed())},this.IsButtonSizeStored=function(){return 20!==this.FButtonSize},this.IsButtonSpacingStored=function(){return 4!==this.FButtonSpacing},this.SetButtonSize=function(t){this.FButtonSize!==t&&(this.FButtonSize=t,this.Changed())},this.SetButtonSpacing=function(t){this.FButtonSpacing!==t&&(this.FButtonSpacing=t,this.Changed())},this.SetFill=function(t){this.FFill.Assign(t)},this.SetStroke=function(t){this.FStroke.Assign(t)},this.SetStretchText=function(t){this.FStretchText!==t&&(this.FStretchText=t,this.Changed())},this.SetDropDownControl=function(t){null===t&&null!=this.FDropDownControl&&this.FDropDownControl.SetVisible(!0),this.FDropDownControl=t,null!=this.FDropDownControl&&(this.FDropDownControl.SetVisible(!1),this.FDropDownWidth=this.FDropDownControl.GetWidth(),this.FDropDownHeight=this.FDropDownControl.GetHeight())},this.IsDropDownHeightStored=function(){return 120!==this.FDropDownHeight},this.IsDropDownWidthStored=function(){return 100!==this.FDropDownWidth},this.Changed=function(){null!=this.FOnChanged&&this.FOnChanged(this)},this.FontChanged=function(t){this.Changed()},this.FillChanged=function(t){this.Changed()},this.StrokeChanged=function(t){this.Changed()},this.IsHTML=function(){return pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.IsHTML(this.FText)},this.Create$1=function(){return this.FSize=28,this.FVisible=!0,this.FStretchText=!0,this.FHorizontalTextAlign=0,this.FVerticalTextAlign=0,this.FWordWrapping=!0,this.FTrimming=0,this.FFont=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFont.$create("Create$2"),this.FFont.FOnChanged=rtl.createCallback(this,"FontChanged"),this.FShowButtons=!0,this.FButtons={},this.FButtonSpacing=4,this.FButtonSize=20,this.FFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[1,pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(228,228,228),8421504,-1,-1]),this.FFill.FOnChanged=rtl.createCallback(this,"FillChanged"),this.FStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,12632256]),this.FStroke.FOnChanged=rtl.createCallback(this,"StrokeChanged"),this.FDropDownWidth=100,this.FDropDownHeight=120,this},this.Destroy=function(){rtl.free(this,"FFont"),rtl.free(this,"FFill"),rtl.free(this,"FStroke"),pas.System.TObject.Destroy.call(this)},this.Assign=function(e){t.TTMSFNCPanelElement.isPrototypeOf(e)&&(this.FText=rtl.as(e,t.TTMSFNCPanelElement).FText,this.FStretchText=rtl.as(e,t.TTMSFNCPanelElement).FStretchText,this.FSize=rtl.as(e,t.TTMSFNCPanelElement).FSize,this.FHorizontalTextAlign=rtl.as(e,t.TTMSFNCPanelElement).FHorizontalTextAlign,this.FVerticalTextAlign=rtl.as(e,t.TTMSFNCPanelElement).FVerticalTextAlign,this.FWordWrapping=rtl.as(e,t.TTMSFNCPanelElement).FWordWrapping,this.FTrimming=rtl.as(e,t.TTMSFNCPanelElement).FTrimming,this.FFont.AssignSource(rtl.as(e,t.TTMSFNCPanelElement).FFont),this.FShowButtons=rtl.as(e,t.TTMSFNCPanelElement).FShowButtons,this.FButtons=rtl.refSet(rtl.as(e,t.TTMSFNCPanelElement).FButtons),this.FVisible=rtl.as(e,t.TTMSFNCPanelElement).FVisible,this.FButtonSpacing=rtl.as(e,t.TTMSFNCPanelElement).FButtonSpacing,this.FButtonSize=rtl.as(e,t.TTMSFNCPanelElement).FButtonSize,this.FStretchText=rtl.as(e,t.TTMSFNCPanelElement).FStretchText,this.FDropDownWidth=rtl.as(e,t.TTMSFNCPanelElement).FDropDownWidth,this.FDropDownHeight=rtl.as(e,t.TTMSFNCPanelElement).FDropDownHeight,this.FFill.Assign(rtl.as(e,t.TTMSFNCPanelElement).FFill),this.FStroke.Assign(rtl.as(e,t.TTMSFNCPanelElement).FStroke))};var e=this.$rtti;e.addProperty("StretchText",2,rtl.boolean,"FStretchText","SetStretchText",{Default:!0}),e.addProperty("Text",2,rtl.string,"FText","SetText"),e.addProperty("Size",14,rtl.double,"FSize","SetSize",{stored:"IsSizeStored"}),e.addProperty("HorizontalTextAlign",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsTextAlign,"FHorizontalTextAlign","SetHorizontalTextAlign",{Default:pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsTextAlign.gtaCenter}),e.addProperty("VerticalTextAlign",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsTextAlign,"FVerticalTextAlign","SetVerticalTextAlign",{Default:pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsTextAlign.gtaCenter}),e.addProperty("WordWrapping",2,rtl.boolean,"FWordWrapping","SetWordWrapping",{Default:!0}),e.addProperty("Trimming",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsTextTrimming,"FTrimming","SetTrimming",{Default:pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsTextTrimming.gttNone}),e.addProperty("Font",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFont,"FFont","SetFont"),e.addProperty("Visible",2,rtl.boolean,"FVisible","SetVisible",{Default:!0}),e.addProperty("Fill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FFill","SetFill"),e.addProperty("Stroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FStroke","SetStroke"),e.addProperty("ShowButtons",2,rtl.boolean,"FShowButtons","SetShowButtons",{Default:!0}),e.addProperty("Buttons",2,t.$rtti.TTMSFNCPanelButtons,"FButtons","SetButtons",{Default:{}}),e.addProperty("ButtonSize",14,rtl.double,"FButtonSize","SetButtonSize",{stored:"IsButtonSizeStored"}),e.addProperty("ButtonSpacing",14,rtl.double,"FButtonSpacing","SetButtonSpacing",{stored:"IsButtonSpacingStored"}),e.addProperty("DropDownControl",2,pas["WEBLib.Controls"].$rtti.TControl,"FDropDownControl","SetDropDownControl"),e.addProperty("DropDownWidth",12,rtl.double,"FDropDownWidth","FDropDownWidth",{stored:"IsDropDownWidthStored"}),e.addProperty("DropDownHeight",12,rtl.double,"FDropDownHeight","FDropDownHeight",{stored:"IsDropDownHeightStored"})})),rtl.createClass(this,"TTMSFNCPanelHeader",this.TTMSFNCPanelElement,(function(){})),rtl.createClass(this,"TTMSFNCPanelFooter",this.TTMSFNCPanelElement,(function(){this.Create$1=function(){return t.TTMSFNCPanelElement.Create$1.call(this),this.FShowButtons=!1,this.FVisible=!1,this};var e=this.$rtti;e.addProperty("Visible",2,rtl.boolean,"FVisible","SetVisible",{Default:!1}),e.addProperty("ShowButtons",2,rtl.boolean,"FShowButtons","SetShowButtons",{Default:!1})})),this.TTMSFNCPanelButtonState={0:"bsNormal",bsNormal:0,1:"bsHover",bsHover:1,2:"bsDown",bsDown:2},rtl.createClass(this,"TTMSFNCPanelButtonStates",pas.Classes.TList,(function(){this.GetItem=function(t){return this.Get(t)},this.SetItem=function(t,e){this.Put(t,e)}})),rtl.recNewT(this,"TTMSFNCPanelDownButton",(function(){this.Button=0,this.Down=!1,this.$eq=function(t){return this.Button===t.Button&&this.Down===t.Down},this.$assign=function(t){return this.Button=t.Button,this.Down=t.Down,this}})),this.TTMSFNCPanelExpandState={0:"pesCollapsed",pesCollapsed:0,1:"pesExpanded",pesExpanded:1},this.TTMSFNCPanelCompactState={0:"pcsCollapsed",pcsCollapsed:0,1:"pcsExpanded",pcsExpanded:1},this.$rtti.$MethodVar("TTMSFNCPanelAnchorClickEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AAnchor",rtl.string]]),methodkind:0}),rtl.createClass(this,"TTMSFNCPanelSection",pas.Classes.TCollectionItem,(function(){this.$init=function(){pas.Classes.TCollectionItem.$init.call(this),this.FOwner=null,this.FSize=0,this.FTag=0,this.FText="",this.FControl=null},this.$final=function(){this.FOwner=void 0,this.FControl=void 0,pas.Classes.TCollectionItem.$final.call(this)},this.SetSize=function(t){this.FSize!==t&&(this.FSize=t,this.Changed$1())},this.IsSizeStored=function(){return 48!==this.FSize},this.SetText=function(t){this.FText!==t&&(this.FText=t,this.Changed$1())},this.SetControl=function(t){var e=0,i=null;if(this.FControl!==t){if(null!=t&&null!=(i=this.FOwner)){for(var s=0,o=i.FSections.GetCount()-1;s<=o;s++)e=s,i.FSections.GetItem$1(e).FControl===t&&i.FSections.GetItem$1(e).SetControl(null);t.FParent!==i&&t.SetParent(i)}this.FControl=t,null!=this.FControl&&this.UpdateControlBounds()}},this.Changed$1=function(){null!=this.FOwner&&this.FOwner.Invalidate()},this.UpdateControlBounds=function(){var t=0,e=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),i=null,s=null,o=0;if(null!=this.FControl&&null!=(i=this.FOwner)){e.$assign(i.GetSectionRect(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i.GetLocalRect())));for(var n=0,r=this.GetIndex()-1;n<=r;n++)t=n,e.Top=e.Top+i.FSections.GetItem$1(t).FSize;(s=pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.$create("CreateBitmapCanvas",[1,1,!1,!0])).BeginScene();try{s.FFont.AssignSource(i.FSectionsAppearance.FFont),o=Math.max(16,s.CalculateTextHeight$1(this.FText)+4)}finally{s.EndScene(),s=rtl.freeLoc(s)}e.Top=e.Top+o-1,this.GetIndex()!==i.FSections.GetCount()-1&&(e.Bottom=e.Top+this.FSize-o+1),pas["WEBLib.TMSFNCTypes"].EqualRectEx(pas["WEBLib.TMSFNCTypes"].ConvertToRectF(this.FControl.GetBoundsRect()),e)||(this.FControl.SetBoundsRect(pas["WEBLib.TMSFNCTypes"].ConvertToRect(e)),i.Invalidate())}},this.Create$1=function(e){return pas.Classes.TCollectionItem.Create$1.apply(this,arguments),null!=this.FCollection&&(this.FOwner=rtl.as(this.FCollection,t.TTMSFNCPanelSections).FOwner$1),this.FSize=48,this.Changed$1(),this},this.Assign=function(e){t.TTMSFNCPanelSection.isPrototypeOf(e)&&(this.FText=rtl.as(e,t.TTMSFNCPanelSection).FText,this.FSize=rtl.as(e,t.TTMSFNCPanelSection).FSize)},this.Destroy=function(){pas.Classes.TCollectionItem.Destroy.call(this),this.Changed$1()};var e=this.$rtti;e.addProperty("Text",2,rtl.string,"FText","SetText"),e.addProperty("Size",14,rtl.double,"FSize","SetSize",{stored:"IsSizeStored"}),e.addProperty("Control",2,pas["WEBLib.Controls"].$rtti.TControl,"FControl","SetControl"),e.addProperty("Tag",0,rtl.nativeint,"FTag","FTag",{Default:0})})),rtl.createClass(this,"TTMSFNCPanelSections",pas["WEBLib.TMSFNCTypes"].TTMSFNCOwnedCollection,(function(){this.$init=function(){pas["WEBLib.TMSFNCTypes"].TTMSFNCOwnedCollection.$init.call(this),this.FOwner$1=null,this.FOnChanged=null},this.$final=function(){this.FOwner$1=void 0,this.FOnChanged=void 0,pas["WEBLib.TMSFNCTypes"].TTMSFNCOwnedCollection.$final.call(this)},this.GetItem$1=function(t){return this.GetItem(t)},this.Create$3=function(e){return pas.Classes.TOwnedCollection.Create$2.call(this,e,t.TTMSFNCPanelSection),this.FOwner$1=e,this}})),rtl.createClass(this,"TTMSFNCPanelSectionsAppearance",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FFont=null,this.FFill=null,this.FStroke=null,this.FOnChange=null},this.$final=function(){this.FFont=void 0,this.FFill=void 0,this.FStroke=void 0,this.FOnChange=void 0,pas.Classes.TPersistent.$final.call(this)},this.SetFill=function(t){this.FFill.Assign(t)},this.SetFont=function(t){this.FFont.AssignSource(t)},this.SetStroke=function(t){this.FStroke.Assign(t)},this.Changed=function(){null!=this.FOnChange&&this.FOnChange(this)},this.FillChanged=function(t){this.Changed()},this.StrokeChanged=function(t){this.Changed()},this.FontChanged=function(t){this.Changed()},this.Assign=function(e){t.TTMSFNCPanelSectionsAppearance.isPrototypeOf(e)&&(this.FFill.Assign(rtl.as(e,t.TTMSFNCPanelSectionsAppearance).FFill),this.FStroke.Assign(rtl.as(e,t.TTMSFNCPanelSectionsAppearance).FStroke),this.FFont.AssignSource(rtl.as(e,t.TTMSFNCPanelSectionsAppearance).FFont))},this.Create$1=function(){return this.FFont=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFont.$create("Create$2"),this.FFont.FOnChanged=rtl.createCallback(this,"FontChanged"),this.FFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[1,pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(240,240,240),8421504,-1,-1]),this.FFill.FOnChanged=rtl.createCallback(this,"FillChanged"),this.FStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,12632256]),this.FStroke.FOnChanged=rtl.createCallback(this,"StrokeChanged"),this},this.Destroy=function(){rtl.free(this,"FFill"),rtl.free(this,"FStroke"),rtl.free(this,"FFont"),pas.System.TObject.Destroy.call(this)};var e=this.$rtti;e.addProperty("Font",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFont,"FFont","SetFont"),e.addProperty("Fill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FFill","SetFill"),e.addProperty("Stroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FStroke","SetStroke")})),rtl.createClass(this,"TTMSFNCCustomPanel",pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl,(function(){this.$init=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.$init.call(this),this.FOldHeight=0,this.FOldWidth=0,this.FPopup=null,this.FExpandState=0,this.FCompactState=0,this.FHeaderDownButton=t.TTMSFNCPanelDownButton.$new(),this.FFooterDownButton=t.TTMSFNCPanelDownButton.$new(),this.FHeaderButtonStates=null,this.FFooterButtonStates=null,this.FHeaderAnchor="",this.FFooterAnchor="",this.FBitmapContainer=null,this.FHeader=null,this.FFooter=null,this.FOnHeaderDropDownButtonClick=null,this.FOnHeaderExpandButtonClick=null,this.FOnHeaderCloseButtonClick=null,this.FOnHeaderAnchorClick=null,this.FOnFooterAnchorClick=null,this.FOnFooterDropDownButtonClick=null,this.FOnFooterExpandButtonClick=null,this.FOnFooterCloseButtonClick=null,this.FCloseAction=0,this.FDropDownAction=0,this.FExpandAction=0,this.FCompactAction=0,this.FSections=null,this.FSectionsAppearance=null,this.FOnHeaderCompactButtonClick=null,this.FOnFooterCompactButtonClick=null,this.FOnInternalHeaderCompactButtonClick=null,this.FGlobalFont=null},this.$final=function(){this.FPopup=void 0,this.FHeaderDownButton=void 0,this.FFooterDownButton=void 0,this.FHeaderButtonStates=void 0,this.FFooterButtonStates=void 0,this.FBitmapContainer=void 0,this.FHeader=void 0,this.FFooter=void 0,this.FOnHeaderDropDownButtonClick=void 0,this.FOnHeaderExpandButtonClick=void 0,this.FOnHeaderCloseButtonClick=void 0,this.FOnHeaderAnchorClick=void 0,this.FOnFooterAnchorClick=void 0,this.FOnFooterDropDownButtonClick=void 0,this.FOnFooterExpandButtonClick=void 0,this.FOnFooterCloseButtonClick=void 0,this.FSections=void 0,this.FSectionsAppearance=void 0,this.FOnHeaderCompactButtonClick=void 0,this.FOnFooterCompactButtonClick=void 0,this.FOnInternalHeaderCompactButtonClick=void 0,this.FGlobalFont=void 0,pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.$final.call(this)},this.GetBitmapContainer=function(){return this.FBitmapContainer},this.SetBitmapContainer=function(t){this.FBitmapContainer=t,this.Invalidate()},this.SetFooter=function(t){this.FFooter.Assign(t)},this.SetHeader=function(t){this.FHeader.Assign(t)},this.SetCloseAction=function(t){this.FCloseAction=t},this.SetDropDownAction=function(t){this.FDropDownAction=t},this.SetExpandAction=function(t){this.FExpandAction=t},this.SetCompactAction=function(t){this.FCompactAction=t},this.SetSections=function(t){this.FSections.Assign(t)},this.SetSectionsAppearance=function(t){this.FSectionsAppearance.Assign(t)},this.SetGlobalFont=function(t){this.FGlobalFont.Assign(t)},this.ApplyStyle=function(){var t=0;pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.ApplyStyle.call(this),this.FFill.SetKind(0),this.FHeader.FStroke.SetColor(this.FStroke.FColor),this.FFooter.FStroke.SetColor(this.FStroke.FColor),t=-1,pas["WEBLib.TMSFNCStyles"].TTMSFNCStyles.GetStyleHeaderFillColor({get:function(){return t},set:function(e){t=e}})&&(this.FHeader.FFill.SetKind(1),this.FHeader.FFill.SetColor(t),this.FFooter.FFill.SetKind(1),this.FFooter.FFill.SetColor(t)),t=-1,pas["WEBLib.TMSFNCStyles"].TTMSFNCStyles.GetStyleHeaderFillColorTo({get:function(){return t},set:function(e){t=e}})&&(this.FHeader.FFill.SetKind(2),this.FHeader.FFill.SetColorTo(t),this.FFooter.FFill.SetKind(2),this.FFooter.FFill.SetColorTo(t)),t=-1,pas["WEBLib.TMSFNCStyles"].TTMSFNCStyles.GetStyleTextFontColor({get:function(){return t},set:function(e){t=e}})&&(this.FHeader.FFont.SetColor(t),this.FFooter.FFont.SetColor(t))},this.ResetToDefaultStyle=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.ResetToDefaultStyle.call(this),this.FFill.SetKind(1),this.FHeader.FStroke.SetColor(12632256),this.FFooter.FStroke.SetColor(12632256),this.BeginUpdate(),this.FHeader.FFill.SetColor(16380654),this.FHeader.FFont.SetColor(4539717),this.FFooter.FFill.SetColor(16380654),this.FFooter.FFont.SetColor(4539717),this.FHeader.FStroke.SetKind(0),pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.SetFontSize(this.FHeader.FFont,14,this.FPaintScaleFactor),this.FHeader.FFont.SetStyle(rtl.createSet(0)),pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.SetFontSize(this.FFooter.FFont,14,this.FPaintScaleFactor),this.EndUpdate()},this.GetElementRect=function(t,e){var i=pas["WEBLib.TMSFNCTypes"].TRectF.$new();return e===this.FHeader?i.$assign(pas["WEBLib.TMSFNCTypes"].RectF(t.Left,t.Top,t.Right,t.Top+e.FSize)):e===this.FFooter&&i.$assign(pas["WEBLib.TMSFNCTypes"].RectF(t.Left,t.Bottom-e.FSize,t.Right,t.Bottom)),i},this.GetTextRect=function(t,e){var i=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),s=0;return s=e.FStretchText?t.Right:this.GetButtonsRect(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(t),e).Left,e===this.FHeader?i.$assign(pas["WEBLib.TMSFNCTypes"].RectF(t.Left,t.Top,s,t.Top+e.FSize)):e===this.FFooter&&i.$assign(pas["WEBLib.TMSFNCTypes"].RectF(t.Left,t.Bottom-e.FSize,s,t.Bottom)),i},this.GetSectionRect=function(t){var e=pas["WEBLib.TMSFNCTypes"].TRectF.$new();return e.$assign(t),this.FHeader.FVisible&&(e.Top=e.Top+this.FHeader.FSize),this.FFooter.FVisible&&(e.Bottom=e.Bottom-this.FFooter.FSize),e},this.GetButtonsRect=function(t,e){var i=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),s=0;if(e===this.FHeader?i.$assign(pas["WEBLib.TMSFNCTypes"].RectF(t.Right,t.Top,t.Right,t.Top+e.FSize)):e===this.FFooter&&i.$assign(pas["WEBLib.TMSFNCTypes"].RectF(t.Right,t.Bottom-e.FSize,t.Right,t.Bottom)),e.FShowButtons&&rtl.neSet(e.FButtons,{}))for(s=0;s<=3;s++)s in e.FButtons&&(0===s&&0===this.FCompactState||1===this.FCompactState)&&(i.Left=i.Left-e.FButtonSpacing-e.FButtonSize);return i},this.XYToAnchor=function(t,e,i){var s="",o=null,n=0,r=0;if(s="",i.IsHTML()){(o=pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.$create("CreateBitmapCanvas",[1,1,!1,!0])).BeginScene(),o.FOptimizedHTMLDrawing=this.FOptimizedHTMLDrawing,o.FBitmapContainer=this.GetBitmapContainer();try{o.FFont.Assign(i.FFont),n=i.FHorizontalTextAlign,r=i.FVerticalTextAlign,s=o.DrawText$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(this.GetTextRect(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(this.GetLocalRect()),i)),i.FText,i.FWordWrapping,n,r,i.FTrimming,0,-1,-1,!0,!0,t,e)}finally{o.EndScene(),o=rtl.freeLoc(o)}}return s},this.XYToButton=function(t,e,i,s){var o=!1,n=0,r=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),a=pas["WEBLib.TMSFNCTypes"].TRectF.$new();if(o=!1,!i.FShowButtons||rtl.eqSet(i.FButtons,{}))return o;for(a.$assign(this.GetButtonsRect(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(this.GetLocalRect()),i)),n=0;n<=3;n++)if(n in i.FButtons&&(0===n&&0===this.FCompactState||1===this.FCompactState)){if(r.$assign(pas["WEBLib.TMSFNCTypes"].RectF(a.Right-i.FButtonSpacing-i.FButtonSize,a.Top+(a.Bottom-a.Top-i.FButtonSize)/2,a.Right-i.FButtonSpacing,a.Top+(a.Bottom-a.Top-i.FButtonSize)/2+i.FButtonSize)),pas["WEBLib.TMSFNCTypes"].PtInRectEx(r,pas["WEBLib.TMSFNCTypes"].PointF(t,e))){s.set(n),o=!0;break}a.Right=a.Right-i.FButtonSpacing-i.FButtonSize}return o},this.ClearButtonStates=function(t){var e=!1,i=0,s=0;e=!1;for(var o=0,n=this.FHeaderButtonStates.GetCount()-1;o<=n;o++)i=o,0!==(s=this.FHeaderButtonStates.GetItem(i))&&(e=!0),(t&&1===s||!t)&&this.FHeaderButtonStates.SetItem(i,0);for(var r=0,a=this.FFooterButtonStates.GetCount()-1;r<=a;r++)i=r,0!==(s=this.FFooterButtonStates.GetItem(i))&&(e=!0),(t&&1===s||!t)&&this.FFooterButtonStates.SetItem(i,0);return e},this.GetButtonRect=function(t,e,i){var s=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),o=0,n=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),r=pas["WEBLib.TMSFNCTypes"].TRectF.$new();for(r.$assign(this.GetButtonsRect(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(t),e)),o=0;o<=3;o++)o in e.FButtons&&(0===o&&0===this.FCompactState||1===this.FCompactState)&&(n.$assign(pas["WEBLib.TMSFNCTypes"].RectF(Math.round(r.Right-e.FButtonSpacing-e.FButtonSize),Math.round(r.Top+(r.Bottom-r.Top-e.FButtonSize)/2),Math.round(r.Right-e.FButtonSpacing),Math.round(r.Top+(r.Bottom-r.Top-e.FButtonSize)/2+e.FButtonSize))),r.Right=r.Right-e.FButtonSpacing-e.FButtonSize,o===i&&s.$assign(n));return s},this.GetCollapsedHeight=function(){var t=0;return t=0,this.FHeader.FVisible&&(t+=this.FHeader.FSize),this.FFooter.FVisible&&(t+=this.FFooter.FSize),t},this.GetCollapsedWidth=function(){return this.FHeader.FButtonSize+2*this.FHeader.FButtonSpacing},this.IsAppearanceProperty=function(t,e,i){return pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.IsAppearanceProperty.call(this,t,e,i)||"Header"===e||"Footer"===e},this.Notification=function(t,e){var i=0;if(pas["WEBLib.Menus"].TWebCustomControl.Notification.apply(this,arguments),3 in this.FComponentState||1!==e||t!==this.FBitmapContainer||(this.FBitmapContainer=null),!(3 in this.FComponentState)&&1===e)for(var s=0,o=this.FSections.GetCount()-1;s<=o;s++)i=s,t===this.FSections.GetItem$1(i).FControl&&(this.FSections.GetItem$1(i).FControl=null)},this.FooterChanged=function(t){this.Realign(),this.Invalidate()},this.HeaderChanged=function(t){this.Realign(),this.Invalidate()},this.SectionsChanged=function(t){this.UpdateControlBounds(),this.Invalidate()},this.SectionsAppearanceChanged=function(t){this.UpdateControlBounds(),this.Invalidate()},this.Draw=function(t,e){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Draw.apply(this,arguments),t.FBitmapContainer=this.GetBitmapContainer(),this.DrawSections(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(this.GetSectionRect(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e)))),this.DrawElement(t,this.FHeader,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(this.GetTextRect(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),this.FHeader)),pas["WEBLib.TMSFNCTypes"].TRectF.$clone(this.GetElementRect(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),this.FHeader)),pas["WEBLib.TMSFNCTypes"].TRectF.$clone(this.GetButtonsRect(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),this.FHeader)),this.FHeaderButtonStates),this.DrawElement(t,this.FFooter,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(this.GetTextRect(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),this.FFooter)),pas["WEBLib.TMSFNCTypes"].TRectF.$clone(this.GetElementRect(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),this.FFooter)),pas["WEBLib.TMSFNCTypes"].TRectF.$clone(this.GetButtonsRect(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),this.FFooter)),this.FFooterButtonStates)},this.DrawSections=function(t,e){var i=0,s=null,o=0,n=pas["WEBLib.TMSFNCTypes"].TRectF.$new();o=0,t.FFill.Assign(this.FSectionsAppearance.FFill),t.FStroke.Assign(this.FSectionsAppearance.FStroke),t.FFont.AssignSource(this.FSectionsAppearance.FFont);for(var r=0,a=this.FSections.GetCount()-1;r<=a;r++)i=r,s=this.FSections.GetItem$1(i),n.$assign(pas["WEBLib.TMSFNCTypes"].RectF(e.Left,e.Top+o,e.Right,e.Top+o+Math.max(16,t.CalculateTextHeight$1(s.FText)+4))),t.DrawRectangle$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(n),11),pas["WEBLib.TMSFNCTypes"].InflateRectEx(n,-2,-2),t.DrawText$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(n),s.FText,!1,1,0,0,0,-1,-1,!0,!1,-1,-1),o+=s.FSize},this.DrawElement=function(t,e,i,s,o,n){var r=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),a=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),l=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),h=0,F=0,p=0;if(e.FVisible&&(t.FFill.Assign(e.FFill),t.FStroke.Assign(e.FStroke),t.DrawRectangle$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(s),2),1===this.FCompactState&&(r.$assign(i),pas["WEBLib.TMSFNCTypes"].InflateRectEx(r,this.ScalePaintValue(-3),this.ScalePaintValue(-3)),t.FFont.AssignSource(e.FFont),t.DrawText$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(r),e.FText,e.FWordWrapping,e.FHorizontalTextAlign,e.FVerticalTextAlign,e.FTrimming,0,-1,-1,!0,!1,-1,-1)),e.FShowButtons&&rtl.neSet(e.FButtons,{})))for(a.$assign(o),h=0;h<=3;h++)if(h in e.FButtons&&(0===h&&0===this.FCompactState||1===this.FCompactState)){l.$assign(pas["WEBLib.TMSFNCTypes"].RectF(Math.round(a.Right-e.FButtonSpacing-e.FButtonSize),Math.round(a.Top+(a.Bottom-a.Top-e.FButtonSize)/2),Math.round(a.Right-e.FButtonSpacing),Math.round(a.Top+(a.Bottom-a.Top-e.FButtonSize)/2+e.FButtonSize))),F=this.FExpandState,p=this.FCompactState;var c=h;0===c?t.DrawCompactButton(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(l),p,2===n.GetItem(h),1===n.GetItem(h),!0,this.GetAdaptToStyle(),this.FPaintScaleFactor):1===c?t.DrawCloseButton(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(l),2===n.GetItem(h),1===n.GetItem(h),!0,this.GetAdaptToStyle(),this.FPaintScaleFactor):2===c?t.DrawExpanderButton(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(l),F,2===n.GetItem(h),1===n.GetItem(h),!0,this.GetAdaptToStyle(),this.FPaintScaleFactor):3===c&&t.DrawDropDownButton(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(l),2===n.GetItem(h),1===n.GetItem(h),!0,!0,this.GetAdaptToStyle(),this.FPaintScaleFactor),a.Right=a.Right-e.FButtonSpacing-e.FButtonSize}},this.HandleMouseLeave=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleMouseLeave.call(this),this.ClearButtonStates(!1)&&this.Invalidate()},this.UpdateControlAfterResize=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.UpdateControlAfterResize.call(this),this.UpdateControlBounds()},this.HandleMouseDown=function(t,e,i,s){var o=!1,n=!1,r=0,a=0;pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleMouseDown.apply(this,arguments),this.FHeaderDownButton.Down=!1,this.FFooterDownButton.Down=!1,n=!1,r=1,(o=this.XYToButton(i,s,this.FHeader,{get:function(){return r},set:function(t){r=t}}))?(this.FHeaderButtonStates.SetItem(r,2),this.FHeaderDownButton.Down=!0,this.FHeaderDownButton.Button=r):(a=1,(n=this.XYToButton(i,s,this.FFooter,{get:function(){return a},set:function(t){a=t}}))&&(this.FFooterButtonStates.SetItem(a,2),this.FFooterDownButton.Down=!0,this.FFooterDownButton.Button=a)),o||n||(this.FHeaderAnchor=this.XYToAnchor(i,s,this.FHeader),""===this.FHeaderAnchor&&(this.FFooterAnchor=this.XYToAnchor(i,s,this.FFooter))),(n||o)&&this.Invalidate()},this.HandleMouseMove=function(t,e,i){var s="",o="",n=!1,r=!1,a=!1,l=0,h=0;pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleMouseMove.apply(this,arguments),a=!1,n=!1,r=!1,this.FHeaderDownButton.Down||this.FFooterDownButton.Down||(a=this.ClearButtonStates(!0),r=!1,l=1,(n=this.XYToButton(e,i,this.FHeader,{get:function(){return l},set:function(t){l=t}}))?this.FHeaderButtonStates.SetItem(l,1):(h=1,(r=this.XYToButton(e,i,this.FFooter,{get:function(){return h},set:function(t){h=t}}))&&this.FFooterButtonStates.SetItem(h,1))),n||r||(""===(s=this.XYToAnchor(e,i,this.FHeader))&&(o=this.XYToAnchor(e,i,this.FFooter)),""!==s||""!==o?this.SetControlCursor(21):this.SetControlCursor(0)),(r||n||a)&&this.Invalidate()},this.HandleMouseUp=function(t,e,i,s){var o=0,n=0;if(pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleMouseUp.apply(this,arguments),""===this.FFooterAnchor&&""===this.FHeaderAnchor){if(o=1,this.XYToButton(i,s,this.FHeader,{get:function(){return o},set:function(t){o=t}})){if(o===this.FHeaderDownButton.Button&&this.FHeaderDownButton.Down){var r=o;0===r?this.HandleCompactAction(this.FHeader):1===r?this.HandleCloseAction(this.FHeader):2===r?this.HandleExpandAction(this.FHeader):3===r&&this.HandleDropDownAction(o,this.FHeader)}}else if(n=1,this.XYToButton(i,s,this.FFooter,{get:function(){return n},set:function(t){n=t}})&&n===this.FFooterDownButton.Button&&this.FFooterDownButton.Down){var a=n;0===a?this.HandleCompactAction(this.FFooter):1===a?this.HandleCloseAction(this.FFooter):2===a?this.HandleExpandAction(this.FHeader):3===a&&this.HandleDropDownAction(n,this.FFooter)}}else""!==this.FHeaderAnchor&&this.DoHeaderAnchorClick(this.FHeaderAnchor),""!==this.FFooterAnchor&&this.DoFooterAnchorClick(this.FFooterAnchor);this.FFooterAnchor="",this.FHeaderAnchor="",this.FHeaderDownButton.Down=!1,this.FFooterDownButton.Down=!1,this.ClearButtonStates(!1)&&this.Invalidate()},this.HandleDropDownAction=function(t,e){var i=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),s=pas["WEBLib.TMSFNCTypes"].TPointF.$new();1===this.FDropDownAction&&null!=e.FDropDownControl&&(i.$assign(this.GetButtonRect(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(this.GetLocalRect()),e,t)),s.$assign(this.LocalToScreenEx(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(i.Left,i.Top+(i.Bottom-i.Top))))),e.FDropDownControl.SetWidth(Math.round(e.FDropDownWidth)),e.FDropDownControl.SetHeight(Math.round(e.FDropDownHeight)),this.FPopup.SetDropDownHeight(e.FDropDownHeight),this.FPopup.SetDropDownWidth(e.FDropDownWidth),this.FPopup.SetContentControl(e.FDropDownControl),this.FPopup.FFocusedControl=e.FDropDownControl,this.FPopup.SetPlacementControl(this),this.FPopup.FPlacementRectangle.SetLeft(s.X),this.FPopup.FPlacementRectangle.SetTop(s.Y),this.FPopup.FPlacementRectangle.SetRight(s.X+this.FPopup.FDropDownWidth),this.FPopup.FPlacementRectangle.SetBottom(s.Y+this.FPopup.FDropDownHeight),this.FPopup.Popup(!1)),e===this.FHeader?this.DoHeaderDropDownButtonClick():e===this.FFooter&&this.DoFooterDropDownButtonClick()},this.HandleCloseAction=function(t){2===this.FCloseAction&&this.SetVisible(!1),t===this.FHeader?this.DoHeaderCloseButtonClick():t===this.FFooter&&this.DoFooterCloseButtonClick()},this.HandleExpandAction=function(t){if(1===this.FExpandAction){var e=this.FExpandState;0===e?this.Expand(!1):1===e&&this.Collapse(!1)}t===this.FHeader?this.DoHeaderExpandButtonClick():t===this.FFooter&&this.DoFooterExpandButtonClick()},this.HandleCompactAction=function(t){if(1===this.FCompactAction){var e=this.FCompactState;0===e?this.Expand(!0):1===e&&this.Collapse(!0)}t===this.FHeader?this.DoHeaderCompactButtonClick():t===this.FFooter&&this.DoFooterCompactButtonClick()},this.DoHeaderAnchorClick=function(t){null!=this.FOnHeaderAnchorClick?this.FOnHeaderAnchorClick(this,t):pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.OpenURL(t)},this.DoHeaderCloseButtonClick=function(){null!=this.FOnHeaderCloseButtonClick&&this.FOnHeaderCloseButtonClick(this)},this.DoHeaderExpandButtonClick=function(){null!=this.FOnHeaderExpandButtonClick&&this.FOnHeaderExpandButtonClick(this)},this.DoHeaderDropDownButtonClick=function(){null!=this.FOnHeaderDropDownButtonClick&&this.FOnHeaderDropDownButtonClick(this)},this.DoHeaderCompactButtonClick=function(){null!=this.FOnInternalHeaderCompactButtonClick&&this.FOnInternalHeaderCompactButtonClick(this),null!=this.FOnHeaderCompactButtonClick&&this.FOnHeaderCompactButtonClick(this)},this.DoFooterAnchorClick=function(t){null!=this.FOnFooterAnchorClick?this.FOnFooterAnchorClick(this,t):pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.OpenURL(t)},this.DoFooterCloseButtonClick=function(){null!=this.FOnFooterCloseButtonClick&&this.FOnFooterCloseButtonClick(this)},this.DoFooterExpandButtonClick=function(){null!=this.FOnFooterExpandButtonClick&&this.FOnFooterExpandButtonClick(this)},this.DoFooterDropDownButtonClick=function(){null!=this.FOnFooterDropDownButtonClick&&this.FOnFooterDropDownButtonClick(this)},this.DoFooterCompactButtonClick=function(){null!=this.FOnFooterCompactButtonClick&&this.FOnFooterCompactButtonClick(this)},this.UpdateControlBounds=function(){for(var t=0,e=0,i=this.FSections.GetCount()-1;e<=i;e++)t=e,this.FSections.GetItem$1(t).UpdateControlBounds()},this.AlignControls=function(t,e){this.FHeader.FVisible&&(e.Top=e.Top+Math.round(this.FHeader.FSize)),this.FFooter.FVisible&&(e.Bottom=e.Bottom-Math.round(this.FFooter.FSize)),pas["WEBLib.Controls"].TControl.AlignControls.apply(this,arguments)},this.Loaded=function(){pas["WEBLib.Controls"].TCustomControl.Loaded.call(this)},this.SetFonts=function(t){this.BeginUpdate(),this.FGlobalFont.ApplyChange(this.FHeader.FFont,t),this.FGlobalFont.ApplyChange(this.FFooter.FFont,t),this.FGlobalFont.ApplyChange(this.FSectionsAppearance.FFont,t),this.EndUpdate()},this.Create$1=function(e){var i=0;for(pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Create$1.apply(this,arguments),this.FSectionsAppearance=t.TTMSFNCPanelSectionsAppearance.$create("Create$1"),this.FSectionsAppearance.FOnChange=rtl.createCallback(this,"SectionsAppearanceChanged"),this.FSections=t.TTMSFNCPanelSections.$create("Create$3",[this]),this.FSections.FOnChanged=rtl.createCallback(this,"SectionsChanged"),this.FFooter=t.TTMSFNCPanelFooter.$create("Create$1"),this.IsDesignTime()&&this.FFooter.SetText("Footer"),this.FFooter.FOnChanged=rtl.createCallback(this,"FooterChanged"),this.FHeader=t.TTMSFNCPanelHeader.$create("Create$1"),this.IsDesignTime()&&this.FHeader.SetText("Header"),this.FHeader.FOnChanged=rtl.createCallback(this,"HeaderChanged"),this.FHeaderButtonStates=t.TTMSFNCPanelButtonStates.$create("Create$1"),i=0;i<=3;i++)this.FHeaderButtonStates.Add(0);for(this.FFooterButtonStates=t.TTMSFNCPanelButtonStates.$create("Create$1"),i=0;i<=3;i++)this.FFooterButtonStates.Add(0);return this.FCloseAction=2,this.FExpandAction=1,this.FCompactAction=1,this.FDropDownAction=1,this.FPopup=pas["WEBLib.TMSFNCPopup"].TTMSFNCPopup.$create("Create$1",[this]),this.FPopup.SetPlacement(9),this.FExpandState=1,this.FCompactState=1,this.FGlobalFont=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCAppearanceGlobalFont.$create("Create$1",[this]),this.SetWidth(200),this.SetHeight(275),this.IsDesignTime()&&this.InitSample(),this},this.Destroy=function(){rtl.free(this,"FGlobalFont"),rtl.free(this,"FHeaderButtonStates"),rtl.free(this,"FFooterButtonStates"),rtl.free(this,"FFooter"),rtl.free(this,"FHeader"),rtl.free(this,"FSections"),rtl.free(this,"FSectionsAppearance"),pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Destroy.call(this)},this.Assign=function(e){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Assign.apply(this,arguments),t.TTMSFNCCustomPanel.isPrototypeOf(e)&&(this.FHeader.Assign(rtl.as(e,t.TTMSFNCCustomPanel).FHeader),this.FFooter.Assign(rtl.as(e,t.TTMSFNCCustomPanel).FFooter),this.FCloseAction=rtl.as(e,t.TTMSFNCCustomPanel).FCloseAction,this.FDropDownAction=rtl.as(e,t.TTMSFNCCustomPanel).FDropDownAction,this.FExpandAction=rtl.as(e,t.TTMSFNCCustomPanel).FExpandAction,this.FCompactAction=rtl.as(e,t.TTMSFNCCustomPanel).FCompactAction)},this.Expand=function(t){t?0===this.FCompactState&&(this.SetWidth(Math.round(this.FOldWidth)),this.FCompactState=1):0===this.FExpandState&&(this.SetHeight(Math.round(this.FOldHeight)),this.FExpandState=1)},this.Collapse=function(t){t?1===this.FCompactState&&(this.FOldWidth=this.GetWidth(),this.SetWidth(Math.round(this.GetCollapsedWidth())),this.FCompactState=0):1===this.FExpandState&&(this.FOldHeight=this.GetHeight(),this.SetHeight(Math.round(this.GetCollapsedHeight())),this.FExpandState=0)},this.SetBounds=function(t,e,i,s){pas["WEBLib.Controls"].TControl.SetBounds.call(this,t,e,i,s),this.UpdateControlBounds()},this.InitSample=function(){this.ResetToDefaultStyle()},rtl.addIntf(this,pas["WEBLib.TMSFNCBitmapContainer"].ITMSFNCBitmapContainer),rtl.addIntf(this,pas["WEBLib.TMSFNCGraphicsTypes"].ITMSFNCAppearanceGlobalFont),rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas["WEBLib.TMSFNCTypes"].ITMSFNCProductInfo),rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TTMSFNCPanel",this.TTMSFNCCustomPanel,(function(){this.RegisterRuntimeClasses=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.RegisterRuntimeClasses.call(this),pas.Classes.RegisterClass(t.TTMSFNCPanel)},this.GetVersion=function(){return this.$class.GetVersionNumber(1,0,2,0)},rtl.addIntf(this,pas["WEBLib.TMSFNCBitmapContainer"].ITMSFNCBitmapContainer),rtl.addIntf(this,pas["WEBLib.TMSFNCGraphicsTypes"].ITMSFNCAppearanceGlobalFont),rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas["WEBLib.TMSFNCTypes"].ITMSFNCProductInfo),rtl.addIntf(this,pas.System.IUnknown);var e=this.$rtti;e.addProperty("BitmapContainer",3,pas["WEBLib.TMSFNCBitmapContainer"].$rtti.TTMSFNCBitmapContainer,"GetBitmapContainer","SetBitmapContainer"),e.addProperty("Version",1,rtl.string,"GetVersion",""),e.addProperty("Fill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FFill","SetFill"),e.addProperty("Sections",2,t.$rtti.TTMSFNCPanelSections,"FSections","SetSections"),e.addProperty("SectionsAppearance",2,t.$rtti.TTMSFNCPanelSectionsAppearance,"FSectionsAppearance","SetSectionsAppearance"),e.addProperty("Stroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FStroke","SetStroke"),e.addProperty("Header",2,t.$rtti.TTMSFNCPanelHeader,"FHeader","SetHeader"),e.addProperty("Footer",2,t.$rtti.TTMSFNCPanelFooter,"FFooter","SetFooter"),e.addProperty("CloseAction",2,t.$rtti.TTMSFNCPanelCloseAction,"FCloseAction","SetCloseAction",{Default:t.TTMSFNCPanelCloseAction.pcaHide}),e.addProperty("DropDownAction",2,t.$rtti.TTMSFNCPanelDropDownAction,"FDropDownAction","SetDropDownAction",{Default:t.TTMSFNCPanelDropDownAction.pddaPopup}),e.addProperty("ExpandAction",2,t.$rtti.TTMSFNCPanelExpandAction,"FExpandAction","SetExpandAction",{Default:t.TTMSFNCPanelExpandAction.peaExpand}),e.addProperty("CompactAction",2,t.$rtti.TTMSFNCPanelCompactAction,"FCompactAction","SetCompactAction",{Default:t.TTMSFNCPanelCompactAction.pcCompact}),e.addProperty("GlobalFont",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCAppearanceGlobalFont,"FGlobalFont","SetGlobalFont"),e.addProperty("OnHeaderAnchorClick",0,t.$rtti.TTMSFNCPanelAnchorClickEvent,"FOnHeaderAnchorClick","FOnHeaderAnchorClick"),e.addProperty("OnHeaderCloseButtonClick",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnHeaderCloseButtonClick","FOnHeaderCloseButtonClick"),e.addProperty("OnHeaderExpandButtonClick",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnHeaderExpandButtonClick","FOnHeaderExpandButtonClick"),e.addProperty("OnHeaderCompactButtonClick",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnHeaderCompactButtonClick","FOnHeaderCompactButtonClick"),e.addProperty("OnHeaderDropDownButtonClick",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnHeaderDropDownButtonClick","FOnHeaderDropDownButtonClick"),e.addProperty("OnFooterAnchorClick",0,t.$rtti.TTMSFNCPanelAnchorClickEvent,"FOnFooterAnchorClick","FOnFooterAnchorClick"),e.addProperty("OnFooterCloseButtonClick",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnFooterCloseButtonClick","FOnFooterCloseButtonClick"),e.addProperty("OnFooterExpandButtonClick",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnFooterExpandButtonClick","FOnFooterExpandButtonClick"),e.addProperty("OnFooterCompactButtonClick",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnFooterCompactButtonClick","FOnFooterCompactButtonClick"),e.addProperty("OnFooterDropDownButtonClick",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnFooterDropDownButtonClick","FOnFooterDropDownButtonClick"),e.attr=[pas.Classes.ComponentPlatformsAttribute,"Create$1",[0]]}))}),["Math","SysUtils","WEBLib.TMSFNCUtils","WEBLib.TMSFNCStyles","WEBLib.Graphics"]),rtl.module("WEBLib.TMSFNCTaskDialog",["System","Classes","WEBLib.Forms","WEBLib.StdCtrls","SysUtils","WEBLib.Graphics","Types","WEBLib.Controls","WEBLib.Dialogs","WEBLib.ComCtrls","WEBLib.ExtCtrls","Web","WEBLib.TMSFNCCustomComponent","WEBLib.TMSFNCTypes","WEBLib.TMSFNCHTMLText","WEBLib.TMSFNCGraphicsTypes","WEBLib.TMSFNCGraphics","WEBLib.TMSFNCImage","WEBLib.TMSFNCCustomControl","WEBLib.TMSFNCPanel","WEBLib.TMSFNCEdit","WEBLib.TMSFNCUtils","WEBLib.TMSFNCBitmapContainer","WEBLib.TMSFNCPopup"],(function(){"use strict";var t=this,e=t.$impl;this.MAJ_VER=1,this.MIN_VER=0,this.REL_VER=3,this.BLD_VER=2,rtl.createClass(this,"TTMSFNCCustomTaskDialogForm",pas["WEBLib.Forms"].TForm,(function(){rtl.addIntf(this,pas.System.IUnknown)})),this.TTMSFNCTaskDialogOption={0:"tdoCommandLinks",tdoCommandLinks:0,1:"tdoCommandLinksNoIcon",tdoCommandLinksNoIcon:1,2:"tdoExpandedDefault",tdoExpandedDefault:2,3:"tdoVerifyChecked",tdoVerifyChecked:3,4:"tdoProgressBar",tdoProgressBar:4,5:"tdoTimer",tdoTimer:5,6:"tdoNoDefaultRadioButton",tdoNoDefaultRadioButton:6},this.$rtti.$Enum("TTMSFNCTaskDialogOption",{minvalue:0,maxvalue:6,ordtype:1,enumtype:this.TTMSFNCTaskDialogOption}),this.$rtti.$Set("TTMSFNCTaskDialogOptions",{comptype:this.$rtti.TTMSFNCTaskDialogOption}),this.TTMSFNCTaskDialogDisplayedButtons={0:"tdbNone",tdbNone:0,1:"tdbDefault",tdbDefault:1},this.$rtti.$Enum("TTMSFNCTaskDialogDisplayedButtons",{minvalue:0,maxvalue:1,ordtype:1,enumtype:this.TTMSFNCTaskDialogDisplayedButtons}),this.TTMSFNCTaskDialogCommonButton={0:"tcbOK",tcbOK:0,1:"tcbYes",tcbYes:1,2:"tcbNo",tcbNo:2,3:"tcbCancel",tcbCancel:3,4:"tcbRetry",tcbRetry:4,5:"tcbClose",tcbClose:5},this.$rtti.$Enum("TTMSFNCTaskDialogCommonButton",{minvalue:0,maxvalue:5,ordtype:1,enumtype:this.TTMSFNCTaskDialogCommonButton}),this.$rtti.$Set("TTMSFNCTaskDialogCommonButtons",{comptype:this.$rtti.TTMSFNCTaskDialogCommonButton}),this.TTMSFNCTaskDialogPosition={0:"tdpScreenCenter",tdpScreenCenter:0,1:"tdpOwnerFormCenter",tdpOwnerFormCenter:1},this.$rtti.$Enum("TTMSFNCTaskDialogPosition",{minvalue:0,maxvalue:1,ordtype:1,enumtype:this.TTMSFNCTaskDialogPosition}),this.TTMSFNCTaskDialogInputType={0:"titEdit",titEdit:0,1:"titMemo",titMemo:1,2:"titComboList",titComboList:2,3:"titDate",titDate:3,4:"titCustom",titCustom:4,5:"titNone",titNone:5,6:"titTime",titTime:6,7:"titPassword",titPassword:7},this.$rtti.$Enum("TTMSFNCTaskDialogInputType",{minvalue:0,maxvalue:7,ordtype:1,enumtype:this.TTMSFNCTaskDialogInputType}),this.TTMSFNCTaskDialogIcon={0:"tdiBlank",tdiBlank:0,1:"tdiWarning",tdiWarning:1,2:"tdiQuestion",tdiQuestion:2,3:"tdiError",tdiError:3,4:"tdiInformation",tdiInformation:4,5:"tdiShield",tdiShield:5,6:"tdiAbout",tdiAbout:6},this.$rtti.$Enum("TTMSFNCTaskDialogIcon",{minvalue:0,maxvalue:6,ordtype:1,enumtype:this.TTMSFNCTaskDialogIcon}),rtl.createClass(this,"TTMSFNCTaskDialogButton",pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl,(function(){this.$init=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.$init.call(this),this.FIcon=null,this.FCaption$1="",this.FModalResult=0,this.FInside=!1,this.FMouseDown=!1,this.FTextFont=null,this.FButtonFill=0},this.$final=function(){this.FIcon=void 0,this.FTextFont=void 0,pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.$final.call(this)},this.SetCap=function(t){this.FCaption$1!==t&&(this.FCaption$1=t)},this.SetModalResult=function(t){this.FModalResult!==t&&(this.FModalResult=t)},this.DoEnter=function(){pas["WEBLib.Controls"].TControl.DoEnter.call(this),this.FStroke.SetKind(1),this.Invalidate()},this.DoExit=function(){pas["WEBLib.Controls"].TControl.DoExit.call(this),this.FStroke.SetKind(0),this.Invalidate()},this.Draw=function(t,e){var i=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),s=0;pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Draw.apply(this,arguments),t.FFont.AssignSource(this.FTextFont),i.$assign(e),pas["WEBLib.TMSFNCTypes"].IsBitmapEmpty(this.FIcon.FBitmap)?i.Left=this.ScalePaintValue(10):(s=(i.Bottom-i.Top)/2-this.FIcon.FBitmap.GetHeight()/2,t.DrawBitmap$5(this.ScalePaintValue(10),s,this.FIcon.FBitmap),i.Left=this.ScalePaintValue(10)+this.FIcon.GetWidth()+this.ScalePaintValue(10)),t.DrawText$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),this.FCaption$1,!1,1,0,0,0,-1,-1,!0,!1,-1,-1)},this.BitmapLoaded=function(t){this.Invalidate()},this.HandleMouseLeave=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleMouseLeave.call(this),this.FInside=!1,this.FMouseDown&&(this.FFill.SetColor(16777215),this.FIcon.FFill.SetColor(16777215)),this.IsFocused()||this.FStroke.SetKind(0)},this.HandleMouseEnter=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleMouseEnter.call(this),this.FStroke.SetKind(1),this.FInside=!0,this.FMouseDown&&(this.FFill.SetColor(this.FButtonFill),this.FIcon.FFill.SetColor(this.FButtonFill))},this.HandleMouseDown=function(t,e,i,s){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleMouseDown.apply(this,arguments),this.FInside&&(this.FMouseDown=!0,this.FFill.SetColor(this.FButtonFill),this.FIcon.FFill.SetColor(this.FButtonFill))},this.HandleMouseUp=function(t,e,i,s){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleMouseUp.apply(this,arguments),this.FMouseDown&&(this.FMouseDown=!1,this.FFill.SetColor(16777215),this.FIcon.FFill.SetColor(16777215))},this.Create$1=function(t){return pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Create$1.apply(this,arguments),this.FButtonFill=pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(229,229,229),this.FIcon=pas["WEBLib.TMSFNCImage"].TTMSFNCImage.$create("Create$1",[this]),this.FIcon.SetBounds(0,0,20,20),this.FIcon.FOnBitmapChanged=rtl.createCallback(this,"BitmapLoaded"),this.FTextFont=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFont.$create("Create$2"),this.FInside=!1,this.FStroke.SetColor(pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(204,204,204)),this.FStroke.SetKind(0),this},this.Destroy=function(){rtl.free(this,"FIcon"),rtl.free(this,"FTextFont"),pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Destroy.call(this)},rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas["WEBLib.TMSFNCTypes"].ITMSFNCProductInfo),rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TTMSFNCTaskDialogAppearance",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FDialogPanelStroke=null,this.FColor=0,this.FDialogPanelFill=null,this.FInstructionColor=0,this.FFooterColor=0,this.FContentColor=0,this.FExpandedTextColor=0},this.$final=function(){this.FDialogPanelStroke=void 0,this.FDialogPanelFill=void 0,pas.Classes.TPersistent.$final.call(this)},this.SetColor=function(t){this.FColor!==t&&(this.FColor=t)},this.SetDialogPanelFill=function(t){this.FDialogPanelFill.Assign(t)},this.SetDialogPanelStroke=function(t){this.FDialogPanelStroke.Assign(t)},this.SetInstructionColor=function(t){this.FInstructionColor!==t&&(this.FInstructionColor=t)},this.SetContentColor=function(t){this.FContentColor!==t&&(this.FContentColor=t)},this.SetExpandedTextColor=function(t){this.FExpandedTextColor!==t&&(this.FExpandedTextColor=t)},this.SetFooterColor=function(t){this.FFooterColor!==t&&(this.FFooterColor=t)},this.Create$1=function(){return this.FColor=16777215,this.FInstructionColor=pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(0,83,196),this.FContentColor=0,this.FFooterColor=0,this.FExpandedTextColor=0,this.FDialogPanelFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[1,16777215,8421504,-1,-1]),this.FDialogPanelFill.SetColor(pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(240,240,240)),this.FDialogPanelStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,12632256]),this.FDialogPanelStroke.SetColor(pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(223,223,223)),this},this.Destroy=function(){rtl.free(this,"FDialogPanelFill"),rtl.free(this,"FDialogPanelStroke"),pas.System.TObject.Destroy.call(this)},this.Assign=function(e){t.TTMSFNCTaskDialogAppearance.isPrototypeOf(e)?(this.FColor=rtl.as(e,t.TTMSFNCTaskDialogAppearance).FColor,this.FDialogPanelFill.Assign(rtl.as(e,t.TTMSFNCTaskDialogAppearance).FDialogPanelFill),this.FDialogPanelStroke.Assign(rtl.as(e,t.TTMSFNCTaskDialogAppearance).FDialogPanelStroke)):pas.Classes.TPersistent.Assign.apply(this,arguments)};var e=this.$rtti;e.addProperty("DialogColor",2,pas["WEBLib.Graphics"].$rtti.TColor,"FColor","SetColor"),e.addProperty("DialogPanelFill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FDialogPanelFill","SetDialogPanelFill"),e.addProperty("DialogPanelStroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FDialogPanelStroke","SetDialogPanelStroke"),e.addProperty("InstructionColor",2,pas["WEBLib.Graphics"].$rtti.TColor,"FInstructionColor","SetInstructionColor"),e.addProperty("ContentColor",2,pas["WEBLib.Graphics"].$rtti.TColor,"FContentColor","SetContentColor"),e.addProperty("ExpandedTextColor",2,pas["WEBLib.Graphics"].$rtti.TColor,"FExpandedTextColor","SetExpandedTextColor"),e.addProperty("FooterColor",2,pas["WEBLib.Graphics"].$rtti.TColor,"FFooterColor","SetFooterColor")})),this.$rtti.$MethodVar("TTMSFNCCustomTaskDialogVerifyClickEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["Checked",rtl.boolean]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCCustomTaskDialogRadioClickEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["RadioID",rtl.longint]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCCustomTaskDialogButtonClickEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ButtonID",rtl.longint]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCCustomTaskDialogProgressEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["Pos",rtl.longint,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCCustomTaskDialogExandButtonClickEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["Expanded",rtl.boolean]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCCustomTaskDialogDialogResultEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AModalResult",rtl.longint]]),methodkind:0}),rtl.createClass(this,"TTMSFNCCustomTaskDialog",pas["WEBLib.TMSFNCCustomComponent"].TTMSFNCCustomComponent,(function(){this.$init=function(){pas["WEBLib.TMSFNCCustomComponent"].TTMSFNCCustomComponent.$init.call(this),this.FBitmapContainer=null,this.FTitle="",this.FInstruction="",this.FContent="",this.FOptions={},this.FMinDialogWidth=0,this.FIcon=0,this.FApplicationIsParent=!1,this.FCustomIcon=null,this.FRadioButtons=null,this.FProgressBarMin=0,this.FProgressBarMax=0,this.FDefaultRadioButton=0,this.FDialogPosition=0,this.FCommonButtons={},this.FCustomButtons=null,this.FCollapseControlText="",this.FExpandedText="",this.FExpandControlText="",this.FVerifyText="",this.FFooterIcon=0,this.FFooter="",this.FInputType=0,this.FInputItems=null,this.FInputText="",this.FInputControl=null,this.FOnDialogRadioClick=null,this.FOnDialogVerifyClick=null,this.FOnDialogButtonClick=null,this.FRadioButtonResult=0,this.FVerifyResult=!1,this.FOnDialogCreated=null,this.FOnDialogClosed=null,this.FOnDialogTimer=null,this.FDialogForm=null,this.FOnDialogProgress=null,this.FAutoClose=!1,this.FAutoCloseTimeOut=0,this.FAutoCloseCounter=0,this.FOnAutoClose=null,this.FMaxDialogWidth=0,this.FOnDialogExpandButtonClick=null,this.FOnDialogResult=null,this.FButtonFont=null,this.FCommandLinkFont=null,this.FDisplayedButtons=0,this.FGlobalFont=null,this.FAppearance=null},this.$final=function(){this.FBitmapContainer=void 0,this.FOptions=void 0,this.FCustomIcon=void 0,this.FRadioButtons=void 0,this.FCommonButtons=void 0,this.FCustomButtons=void 0,this.FInputItems=void 0,this.FInputControl=void 0,this.FOnDialogRadioClick=void 0,this.FOnDialogVerifyClick=void 0,this.FOnDialogButtonClick=void 0,this.FOnDialogCreated=void 0,this.FOnDialogClosed=void 0,this.FOnDialogTimer=void 0,this.FDialogForm=void 0,this.FOnDialogProgress=void 0,this.FOnAutoClose=void 0,this.FOnDialogExpandButtonClick=void 0,this.FOnDialogResult=void 0,this.FButtonFont=void 0,this.FCommandLinkFont=void 0,this.FGlobalFont=void 0,this.FAppearance=void 0,pas["WEBLib.TMSFNCCustomComponent"].TTMSFNCCustomComponent.$final.call(this)},this.SetContent=function(t){this.FContent!==t&&(this.FContent=t)},this.SetInstruction=function(t){this.FInstruction!==t&&(this.FInstruction=t)},this.SetTitle=function(t){this.FTitle!==t&&(this.FTitle=t)},this.SetMinDialogWidth=function(t){this.FMinDialogWidth!==t&&(this.FMinDialogWidth=t)},this.SetIcon=function(t){this.FIcon!==t&&(this.FIcon=t)},this.SetApplicationIsParent=function(t){this.FApplicationIsParent!==t&&(this.FApplicationIsParent=t)},this.SetCustomIcon=function(t){this.FCustomIcon!==t&&this.FCustomIcon.Assign(t)},this.SetRadioButtons=function(t){this.FRadioButtons.Assign(t)},this.SetDefaultRadioButton=function(t){this.FDefaultRadioButton!==t&&(this.FDefaultRadioButton=t)},this.SetDialogPosition=function(t){this.FDialogPosition!==t&&(this.FDialogPosition=t)},this.SetCommonButtons=function(t){rtl.neSet(this.FCommonButtons,t)&&(this.FCommonButtons=rtl.refSet(t))},this.SetCustomButtons=function(t){this.FCustomButtons.Assign(t)},this.SetCollapseControlText=function(t){this.FCollapseControlText!==t&&(this.FCollapseControlText=t)},this.SetExpandControlText=function(t){this.FExpandControlText!==t&&(this.FExpandControlText=t)},this.SetExpandedText=function(t){this.FExpandedText!==t&&(this.FExpandedText=t)},this.SetVerifytext=function(t){this.FVerifyText!==t&&(this.FVerifyText=t)},this.SetFooter=function(t){this.FFooter!==t&&(this.FFooter=t)},this.SetFooterIcon=function(t){this.FFooterIcon!==t&&(this.FFooterIcon=t)},this.SetInputItems=function(t){this.FInputItems.Assign(t)},this.SetInputType=function(t){this.FInputType!==t&&(this.FInputType=t)},this.SetInputText=function(t){this.FInputText!==t&&(this.FInputText=t)},this.SetRadioButtonResult=function(t){this.FRadioButtonResult!==t&&(this.FRadioButtonResult=t)},this.SetVerifyResult=function(t){this.FVerifyResult!==t&&(this.FVerifyResult=t)},this.SetAutoClose=function(t){this.FAutoClose!==t&&(this.FAutoClose=t)},this.SetAutoCloseTimeOut=function(t){this.FAutoCloseTimeOut!==t&&(this.FAutoCloseTimeOut=t)},this.SetOnAutoClose=function(t){this.FOnAutoClose=t},this.SetBitmapContainer=function(t){this.FBitmapContainer=t},this.SetMaxDialogWidth=function(t){this.FMaxDialogWidth!==t&&(this.FMaxDialogWidth=t)},this.SetButtonFont=function(t){this.FButtonFont.Assign(t)},this.SetCommandLinkFont=function(t){this.FCommandLinkFont.Assign(t)},this.SetInputControl=function(t){null===t&&null!=this.FInputControl&&this.FInputControl.SetVisible(!0),this.FInputControl=t,null!=this.FInputControl&&this.FInputControl.SetVisible(!1)},this.IsCollapseControlTextStored=function(){return""!==this.FCollapseControlText},this.IsExpandControlTextStored=function(){return""!==this.FExpandControlText},this.IsInputTextStored=function(){return""!==this.FInputText},this.IsInstructionStored=function(){return""!==this.FInstruction},this.IsTitleStored=function(){return""!==this.FTitle},this.IsVerifyTextStored=function(){return""!==this.FVerifyText},this.IsContentStored=function(){return""!==this.FContent},this.IsExpandedTextStored=function(){return""!==this.FExpandedText},this.IsFooterStored=function(){return""!==this.FFooter},this.GetBitmapContainer=function(){return this.FBitmapContainer},this.SetGlobalFont=function(t){this.FGlobalFont.Assign(t)},this.SetAppearance=function(t){this.FAppearance.Assign(t)},this.DoAutoClose=function(){null!=this.FOnAutoClose&&this.FOnAutoClose(this)},this.Close=function(){null!=this.FDialogForm&&this.FDialogForm.Close()},this.Notification=function(t,e){pas.Classes.TComponent.Notification.apply(this,arguments),3 in this.FComponentState||1===e&&(t===this.FInputControl&&(this.FInputControl=null),t===this.FBitmapContainer&&(this.FBitmapContainer=null))},this.TaskDialogFormCreated=function(t){null!=this.FOnDialogCreated&&this.FOnDialogCreated(this)},this.TaskDialogFromClosed=function(t,e){null!=this.FOnDialogClosed&&this.FOnDialogClosed(this),this.FDialogForm=null},this.CreateButton=function(t){return pas["WEBLib.StdCtrls"].TWebButton.$create("Create$1",[this])},this.CreateRadioButton=function(t){return pas["WEBLib.StdCtrls"].TWebRadioButton.$create("Create$1",[t])},this.GetVersion=function(){return this.$class.GetVersionNumber(1,0,3,2)},this.SetFonts=function(t){this.BeginUpdate(),this.FGlobalFont.ApplyChange(this.FButtonFont,t),this.FGlobalFont.ApplyChange(this.FCommandLinkFont,t),this.EndUpdate()},this.Create$1=function(e){return pas["WEBLib.TMSFNCCustomComponent"].TTMSFNCCustomComponent.Create$1.call(this,e),this.FDialogForm=null,this.FOptions={},this.FCommonButtons={},this.FCustomIcon=pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.$create("Create$3"),this.FRadioButtons=pas.Classes.TStringList.$create("Create$1"),this.FCustomButtons=pas.Classes.TStringList.$create("Create$1"),this.FInputItems=pas.Classes.TStringList.$create("Create$1"),this.FApplicationIsParent=!1,this.FMinDialogWidth=350,this.FMaxDialogWidth=1e3,this.FProgressBarMin=0,this.FProgressBarMax=100,this.FDefaultRadioButton=0,this.FDialogPosition=0,this.FIcon=0,this.FInputText="",this.FInputType=5,this.FAutoClose=!1,this.FAutoCloseTimeOut=0,this.FButtonFont=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFont.$create("Create$2"),this.FCommandLinkFont=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFont.$create("Create$2"),this.FCommandLinkFont.SetSize(11),this.FCommandLinkFont.SetColor(pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(0,83,196)),this.FDisplayedButtons=1,this.FAppearance=t.TTMSFNCTaskDialogAppearance.$create("Create$1"),this.FGlobalFont=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCAppearanceGlobalFont.$create("Create$1",[this]),this},this.Destroy=function(){rtl.free(this,"FGlobalFont"),rtl.free(this,"FCustomIcon"),rtl.free(this,"FRadioButtons"),rtl.free(this,"FCustomButtons"),rtl.free(this,"FInputItems"),rtl.free(this,"FButtonFont"),rtl.free(this,"FCommandLinkFont"),rtl.free(this,"FAppearance"),pas["WEBLib.Controls"].TCustomControl.Destroy.call(this)},this.Execute=function(t){var i=0;if(i=0,null==this)return i;this.FAutoCloseCounter=0,this.FDialogForm=e.CreateMessageDlg(this),this.FDialogForm.FOnShow=rtl.createCallback(this,"TaskDialogFormCreated"),this.FDialogForm.FOnClose=rtl.createCallback(this,"TaskDialogFromClosed");var s=this.FDialogForm;return 1===this.FDialogPosition?s.SetPosition(7):s.SetPosition(4),i=this.FDialogForm.ShowModal$1(t)},rtl.addIntf(this,pas["WEBLib.TMSFNCBitmapContainer"].ITMSFNCBitmapContainer),rtl.addIntf(this,pas["WEBLib.TMSFNCGraphicsTypes"].ITMSFNCAppearanceGlobalFont),rtl.addIntf(this,pas["WEBLib.TMSFNCTypes"].ITMSFNCProductInfo),rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TTMSFNCTaskDialogForm",this.TTMSFNCCustomTaskDialogForm,(function(){this.$init=function(){t.TTMSFNCCustomTaskDialogForm.$init.call(this),this.FTaskDialog=null,this.FMessage=null,this.FContent=null,this.FHorMargin=0,this.FVerMargin=0,this.FHorSpacing=0,this.FVerSpacing=0,this.FMinFormWidth=0,this.FIcon=null,this.FRadioButtons=null,this.FProgressBar=null,this.FCommBtnList=null,this.FCustBtnList=null,this.FExpandButtonIcon=null,this.FExpanded=!1,this.FExpandedText=null,this.FExpandButtonText=null,this.FPanel=null,this.FVerify=null,this.FFooter=null,this.FFooterIcon=null,this.FInputEdit=null,this.FInputMemo=null,this.FInputComboBox=null,this.FInputDate=null,this.FInputTime=null,this.FTimer=null,this.FMaxFormWidth=0,this.FOldParent=null,this.FScale=0},this.$final=function(){this.FTaskDialog=void 0,this.FMessage=void 0,this.FContent=void 0,this.FIcon=void 0,this.FRadioButtons=void 0,this.FProgressBar=void 0,this.FCommBtnList=void 0,this.FCustBtnList=void 0,this.FExpandButtonIcon=void 0,this.FExpandedText=void 0,this.FExpandButtonText=void 0,this.FPanel=void 0,this.FVerify=void 0,this.FFooter=void 0,this.FFooterIcon=void 0,this.FInputEdit=void 0,this.FInputMemo=void 0,this.FInputComboBox=void 0,this.FInputDate=void 0,this.FInputTime=void 0,this.FTimer=void 0,this.FOldParent=void 0,t.TTMSFNCCustomTaskDialogForm.$final.call(this)},this.SetFormWidth=function(t){this.FMinFormWidth!==t&&(this.FMinFormWidth=t)},this.SetMaxFormWidth=function(t){this.FMaxFormWidth!==t&&(this.FMaxFormWidth=t)},this.GetBitmapContainer=function(){var t=null,e=null,i=rtl.createIntfRefs();try{t=null,null!=this.FTaskDialog&&pas.SysUtils.Supports$1(i.ref(1,rtl.queryIntfT(this.FTaskDialog,pas.System.IUnknown)),rtl.getIntfGUIDR(pas["WEBLib.TMSFNCBitmapContainer"].ITMSFNCBitmapContainer),{get:function(){return e},set:function(t){e=t}})&&(t=e.GetBitmapContainer())}finally{i.free(),rtl._Release(e)}return t},this.FormBitmapUpdated=function(t){this.Invalidate()},this.DoClose=function(t){null!=this.FTaskDialog&&(4===this.FTaskDialog.FInputType&&null!=this.FTaskDialog.FInputControl&&(this.FTaskDialog.FInputControl.SetVisible(!1),this.FTaskDialog.FInputControl.SetParent(this.FOldParent)),this.DoUpdateInput(),pas["WEBLib.Forms"].TCustomForm.DoClose.apply(this,arguments))},this.DoTimer=function(t){var e=0;null!=this.FTaskDialog&&(this.FTaskDialog.FAutoCloseCounter=this.FTaskDialog.FAutoCloseCounter+100,5 in this.FTaskDialog.FOptions&&null!=this.FTaskDialog.FOnDialogTimer&&this.FTaskDialog.FOnDialogTimer(this.FTaskDialog),null!=this.FTaskDialog.FOnDialogProgress&&(e=this.FProgressBar.FPosition,this.FTaskDialog.FOnDialogProgress(this.FTaskDialog,{get:function(){return e},set:function(t){e=t}}),this.FProgressBar.SetPosition(e)),this.FTaskDialog.FAutoCloseCounter>this.FTaskDialog.FAutoCloseTimeOut&&this.FTaskDialog.FAutoCloseTimeOut>0&&this.FTaskDialog.FAutoClose&&(this.FTaskDialog.DoAutoClose(),this.FTaskDialog.Close()))},this.DoVerifyClick=function(t){null!=this.FTaskDialog&&null!=this.FVerify&&(this.FTaskDialog.SetVerifyResult(this.FVerify.GetChecked()),null!=this.FTaskDialog.FOnDialogVerifyClick&&this.FTaskDialog.FOnDialogVerifyClick(this.FTaskDialog,this.FTaskDialog.FVerifyResult))},this.DoRadioClick=function(t){null!=this.FTaskDialog&&null!=this.FRadioButtons&&(this.FTaskDialog.SetRadioButtonResult(this.FRadioButtons.IndexOf(t)),null!=this.FTaskDialog&&null!=this.FTaskDialog.FOnDialogRadioClick&&this.FTaskDialog.FOnDialogRadioClick(this.FTaskDialog,this.FTaskDialog.FRadioButtonResult))},this.DoUpdateInput=function(){if(null!=this.FTaskDialog){var t=this.FTaskDialog.FInputType;0===t||7===t?this.FTaskDialog.SetInputText(this.FInputEdit.GetT()):2===t?this.FTaskDialog.SetInputText(this.FInputComboBox.GetText()):3===t?this.FTaskDialog.SetInputText(pas.SysUtils.DateToStr(this.FInputDate.GetDate())):6===t?this.FTaskDialog.SetInputText(pas.SysUtils.TimeToStr(this.FInputDate.GetTime())):1===t&&this.FTaskDialog.SetInputText(this.FInputMemo.FLines.GetTextStr())}},this.DoResult=function(t){null!=this.FTaskDialog&&(this.DoUpdateInput(),null!=this.FTimer&&this.FTimer.SetEnabled(!1),null!=this.FTaskDialog.FOnDialogResult&&this.FTaskDialog.FOnDialogResult(this.FTaskDialog,t))},this.BtnClickHandler=function(t){this.SetModalResult(rtl.as(t,pas["WEBLib.StdCtrls"].TWebButton).FTag$1),null!=this.FTaskDialog&&(null!=this.FTaskDialog.FOnDialogButtonClick&&this.FTaskDialog.FOnDialogButtonClick(this.FTaskDialog,rtl.as(t,pas["WEBLib.StdCtrls"].TWebButton).FTag$1),this.DoResult(this.FModalResult))},this.CommandLinkHandler=function(e){this.SetModalResult(rtl.as(e,t.TTMSFNCTaskDialogButton).FModalResult),null!=this.FTaskDialog&&(null!=this.FTaskDialog.FOnDialogButtonClick&&this.FTaskDialog.FOnDialogButtonClick(this.FTaskDialog,rtl.as(e,t.TTMSFNCTaskDialogButton).FModalResult),this.DoResult(this.FModalResult))},this.DrawLines=function(t,e,i){var s,o=0,n=0;null!=this.FTaskDialog&&(s=i.Right-i.Left,e.FStroke.Assign(this.FTaskDialog.FAppearance.FDialogPanelStroke),e.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(i.Left,i.Top+.5)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(s,i.Top+.5)),2,2),null!=this.FPanel&&(n=this.FPanel.GetControlsCount(),null!=this.FFooter&&""!==this.FFooter.FText&&n>1&&(e.FStroke.SetWidth(1),o=i.Bottom-this.FHorSpacing-Math.max(this.FFooter.GetHeight(),16*this.FScale)-this.FHorSpacing,e.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(i.Left,o-.5)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(s,o-.5)),2,2),e.FStroke.SetColor(16777215),e.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(i.Left,o+.5)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(s,o+.5)),2,2))))},this.ExpandIconClicked=function(t){null!=this.FExpandButtonIcon&&(this.SetExpanded(!this.FExpanded),null!=this.FTaskDialog&&null!=this.FTaskDialog.FOnDialogExpandButtonClick&&this.FTaskDialog.FOnDialogExpandButtonClick(this.FTaskDialog,this.FExpanded))},this.ExpandIconChanged=function(t){this.FExpandButtonIcon.Invalidate()},this.ExpandIconKeyDown=function(t,e,i){13!==e.get()&&32!==e.get()||this.SetExpanded(!this.FExpanded)},this.CommandLinkKeyDown=function(e,i,s){13!==i.get()&&32!==i.get()||(this.SetModalResult(rtl.as(e,t.TTMSFNCTaskDialogButton).FModalResult),null!=this.FTaskDialog&&(null!=this.FTaskDialog.FOnDialogButtonClick&&this.FTaskDialog.FOnDialogButtonClick(this.FTaskDialog,rtl.as(e,t.TTMSFNCTaskDialogButton).FModalResult),this.DoResult(this.FModalResult)))},this.SetExpanded=function(e){this.FExpanded?this.FExpandButtonIcon.FBitmap.LoadFromResource$1(t.TTMSFNCTASKDIALOGEXPAND,pas["WEBLib.TMSFNCTypes"].HInstance()):this.FExpandButtonIcon.FBitmap.LoadFromResource$1(t.TTMSFNCTASKDIALOGCOLLAPSE,pas["WEBLib.TMSFNCTypes"].HInstance()),this.FExpanded=e,this.SetPositions(),this.Invalidate()},this.GetParentControl=function(){return this,this},this.CalculateCmButtonWidth=function(){var t=0,e=0,i=null,s=0;if(t=0,null==this.FTaskDialog)return t;for(s=0,i=pas["WEBLib.StdCtrls"].TWebButton.$create("Create$1",[this]),e=0;e<=5;e++)e in this.FTaskDialog.FCommonButtons&&(s+=1);return!(0 in this.FTaskDialog.FOptions)&&rtl.eqSet(this.FTaskDialog.FCommonButtons,{})&&0===this.FTaskDialog.FCustomButtons.GetCount()&&(s+=1),s>0&&(t=s*Math.round(i.GetWidth())+(s-1)*this.FVerSpacing),t},this.CalculateButtonListWidth=function(t,e,i){var s=null,o=0,n=0;if(n=0,null!=t&&1===i){if(0!==t.GetCount()){if(e&&0 in this.FTaskDialog.FOptions)return n;for(var r=0,a=t.GetCount()-1;r<=a;r++)o=r,s=rtl.getObject(t.Get(o)),n=n+Math.round(s.GetWidth())+this.FVerSpacing}n-=this.FVerSpacing}return n},this.CalculateCsButtonWidth=function(){var t=0,e=0,i=0,s=0,o=null;if(i=0,t=0,null==this.FTaskDialog)return t;if(null!=this.FCustBtnList&&!(0 in this.FTaskDialog.FOptions)){(o=pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.$create("CreateBitmapCanvas",[1,1,!1,!0])).BeginScene();try{o.FFont.Assign(this.FTaskDialog.FButtonFont);for(var n=0,r=this.FTaskDialog.FCustomButtons.GetCount()-1;n<=r;n++)s=n,(e=Math.round(o.CalculateTextWidth$1(this.FTaskDialog.FCustomButtons.Get(s))))+20<70&&(e=Math.round(50)),i=i+e+Math.round(20)}finally{o.EndScene(),o=rtl.freeLoc(o)}this.FTaskDialog.FCustomButtons.GetCount()>0&&(i=Math.round(i+(this.FTaskDialog.FCustomButtons.GetCount()-1)*this.FVerSpacing))}return t=i},this.CalculateExpButtonWidth=function(){var t=0,e=0,i=0,s=null;if(t=0,null==this.FTaskDialog)return t;if(""!==this.FTaskDialog.FExpandedText){(s=pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.$create("CreateBitmapCanvas",[1,1,!1,!0])).BeginScene();try{e=Math.round(s.CalculateTextWidth$1(this.FTaskDialog.FCollapseControlText)+2*this.FVerSpacing+20*this.FScale),i=Math.round(s.CalculateTextWidth$1(this.FTaskDialog.FExpandControlText)+2*this.FVerSpacing+20*this.FScale),t=Math.max(e,i)}finally{s.EndScene(),s=rtl.freeLoc(s)}}return t},this.CalculateCheckBoxWidth=function(t){var e=0,i=null;e=0,(i=pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.$create("CreateBitmapCanvas",[1,1,!1,!0])).BeginScene();try{""!==t&&(e=Math.round(i.CalculateTextWidth$1(t)+30*this.FScale))}finally{i.EndScene(),i=rtl.freeLoc(i)}return e},this.CalculateCsInputWidth=function(){var t=0;return t=0,null!=this.FTaskDialog.FInputControl&&4===this.FTaskDialog.FInputType&&(t=Math.round(this.FTaskDialog.FInputControl.GetWidth()/this.FScale)+2*this.FVerMargin,0!==this.FTaskDialog.FIcon?t+=32:null!=this.FTaskDialog.FCustomIcon&&(t+=this.FTaskDialog.FCustomIcon.GetWidth())),t},this.GetCsBtnWidth=function(t){var e=0,i=null;(i=pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.$create("CreateBitmapCanvas",[1,1,!1,!0])).BeginScene();try{i.FFont.Assign(t.FFont),(e=Math.round(i.CalculateTextWidth$1(t.FCaption))+20)<70&&(e=Math.round(70))}finally{i.EndScene(),i=rtl.freeLoc(i)}return e},this.Create$1=function(t){return pas["WEBLib.Forms"].TCustomForm.Create$1.apply(this,arguments),this.FPopupClose=1,this},this.CreateNew=function(t,e){return pas["WEBLib.Forms"].TCustomForm.CreateNew.apply(this,arguments),this.FScale=pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.GetDPIScale(t,96),0===this.FScale&&(this.FScale=1),this.FRadioButtons=pas.Classes.TList.$create("Create$1"),this.FCommBtnList=pas.Classes.TList.$create("Create$1"),this.FCustBtnList=pas.Classes.TList.$create("Create$1"),this.FExpanded=!1,this.FHorMargin=Math.round(15*this.FScale),this.FVerMargin=Math.round(15*this.FScale),this.FHorSpacing=10,this.FVerSpacing=Math.round(8*this.FScale),this.SetColor(16777215),this.FPanel=pas["WEBLib.TMSFNCPanel"].TTMSFNCPanel.$create("Create$1",[this]),this.FPanel.SetParent(this),this.FPanel.FFill.SetColor(pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(240,240,240)),this.FPanel.FStroke.SetKind(0),this.FPanel.FHeader.SetVisible(!1),this.FPanel.FOnAfterDraw=rtl.createCallback(this,"DrawLines"),this},this.Destroy=function(){rtl.free(this,"FRadioButtons"),rtl.free(this,"FCommBtnList"),rtl.free(this,"FCustBtnList"),pas["WEBLib.Forms"].TCustomForm.Destroy.call(this)},this.BuildTaskDialog=function(i){var s,o,n,r,a,l,h,F,p="",c=0,u=0,C=0,T=0,S=!1,d=0,m=null,f=0,g=0,y=0,M=0,b=0,N=0,B=0,E=0,D=0,L=null,G=0,A=null,I=null,P=0,w=0,$=0;if(null!=i){if(this.FTaskDialog=i,this.FTaskDialog.SetRadioButtonResult(this.FTaskDialog.FDefaultRadioButton),null!=this.GetBitmapContainer()&&(this.GetBitmapContainer().FOnBitmapChanged=rtl.createCallback(this,"FormBitmapUpdated")),g=Math.round(this.FVerMargin/this.FScale),y=Math.round(this.FHorMargin/this.FScale),M=Math.round(this.FVerMargin/this.FScale),y+=25,b=this.FMinFormWidth,u=0,l=this.FMaxFormWidth,B=-1,S=!1,h=this.GetParentControl(),""!==i.FTitle?this.SetCaption(i.FTitle):this.SetCaption(e.GetExeName()),o=this.CalculateCmButtonWidth(),n=this.CalculateCsButtonWidth(),c=this.CalculateExpButtonWidth(),a=this.CalculateCheckBoxWidth(i.FVerifyText),""===i.FExpandedText&&(c=a),C=o+n+c+this.FVerSpacing+2*this.FVerMargin+Math.round(20*this.FScale),r=this.CalculateCsInputWidth(),(b=Math.max(b,Math.max(C,r)))>l&&(B=(b=l)-2*this.FVerMargin-c-this.FVerSpacing),N=b,F=i.FAppearance.FColor,s=i.FInstruction,0!==i.FIcon||!pas["WEBLib.TMSFNCTypes"].IsBitmapEmpty(i.FCustomIcon)){if(this.FIcon=pas["WEBLib.TMSFNCImage"].TTMSFNCImage.$create("Create$1",[h]),this.FIcon.SetParent(h),this.FIcon.SetStretch(!0),this.FIcon.FStroke.SetKind(0),this.FIcon.FFill.SetColor(F),pas["WEBLib.TMSFNCTypes"].IsBitmapEmpty(i.FCustomIcon)){var R=i.FIcon;1===R?this.FIcon.FBitmap.LoadFromResource$1(t.TTMSFNCTASKDIALOGWARNING,pas["WEBLib.TMSFNCTypes"].HInstance()):2===R?this.FIcon.FBitmap.LoadFromResource$1(t.TTMSFNCTASKDIALOGQUESTION,pas["WEBLib.TMSFNCTypes"].HInstance()):3===R?this.FIcon.FBitmap.LoadFromResource$1(t.TTMSFNCTASKDIALOGERROR,pas["WEBLib.TMSFNCTypes"].HInstance()):4===R?this.FIcon.FBitmap.LoadFromResource$1(t.TTMSFNCTASKDIALOGINFORMATION,pas["WEBLib.TMSFNCTypes"].HInstance()):5===R?this.FIcon.FBitmap.LoadFromResource$1(t.TTMSFNCTASKDIALOGSHIELD,pas["WEBLib.TMSFNCTypes"].HInstance()):6===R&&this.FIcon.FBitmap.LoadFromResource$1(t.TTMSFNCTASKDIALOGABOUT,pas["WEBLib.TMSFNCTypes"].HInstance())}else this.FIcon.FBitmap.Assign(i.FCustomIcon);this.FIcon.SetBounds(g,y-6,32,32),g=g+Math.round(this.FVerMargin/this.FScale)+this.FIcon.GetWidth(),M=M+this.FIcon.GetHeight()+this.FHorSpacing,N=b-this.FIcon.GetWidth()-this.FVerMargin,this.FIcon.SetTabStop(!1)}if(N-=2*this.FVerMargin,""!==s){this.FMessage=pas["WEBLib.StdCtrls"].TWebLabel.$create("Create$1",[h]),this.FMessage.SetParent(h),this.FMessage.SetWidth(N),this.FMessage.FFont.SetColor(i.FAppearance.FInstructionColor),this.FMessage.FFont.SetSize(11),this.FMessage.SetCaption(s),this.FMessage.FWordWrap=!0,this.FMessage.SetLeft(g),this.FMessage.SetTop(y),(m=pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.$create("CreateBitmapCanvas",[1,1,!1,!0])).BeginScene();try{m.FFont.Assign(this.FMessage.FFont),d=m.CalculateTextHeight(this.FMessage.FCaption,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(0,0,this.FMessage.GetWidth()*this.FScale,1e4)),!0,!0)}finally{m.EndScene(),m=rtl.freeLoc(m)}y=y+Math.round(d/this.FScale)+Math.round(this.FHorSpacing/this.FScale)}(5 in i.FOptions||i.FAutoClose||4 in i.FOptions)&&(this.FTimer=pas["WEBLib.ExtCtrls"].TTimer.$create("Create$1",[this]),this.FTimer.SetInterval(100),this.FTimer.FOnTimer=rtl.createCallback(this,"DoTimer"),this.FTimer.SetEnabled(!0)),""!==i.FContent&&(this.FContent=pas["WEBLib.TMSFNCHTMLText"].TTMSFNCHTMLText.$create("Create$1",[h]),this.FContent.SetBitmapContainer(this.GetBitmapContainer()),this.FContent.SetParent(h),this.FContent.SetWordWrapping(!0),this.FContent.SetVerticalTextAlign(1),this.FContent.SetHorizontalTextAlign(1),this.FContent.SetText(i.FContent),this.FContent.FFont$1.SetColor(i.FAppearance.FContentColor),this.FContent.SetWidth(N),this.FContent.SetAS(!0),this.FContent.SetLeft(g),this.FContent.SetTop(y),this.FContent.SetTabStop(!1),this.FContent.FFill.SetColor(F),y=y+this.FContent.GetHeight()+this.FHorSpacing,D=this.FContent.GetWidth()+this.FVerMargin+g,b=Math.max(b,D),N=(b=Math.min(b,l))-g-this.FVerMargin,this.FContent.SetWidth(N));var v=i.FInputType;if(0===v||7===v)this.FInputEdit=pas["WEBLib.TMSFNCEdit"].TTMSFNCEdit.$create("Create$1",[h]),this.FInputEdit.SetParent(h),this.FInputEdit.SetT(i.FInputText),this.FInputEdit.SetWidth(N),this.FInputEdit.SetLeft(g),this.FInputEdit.SetTop(y),7===i.FInputType&&this.FInputEdit.SetPasswordChar("*"),this.FInputEdit.SetTabStop(!0),this.FInputEdit.SetTabOrder(u),u+=1,y=y+this.FInputEdit.GetHeight()+this.FHorSpacing;else if(1===v)this.FInputMemo=pas["WEBLib.StdCtrls"].TWebMemo.$create("Create$1",[h]),this.FInputMemo.SetParent(h),this.FInputMemo.SetLines(i.FInputItems),this.FInputMemo.SetHeight(60),this.FInputMemo.SetWidth(N),this.FInputMemo.SetLeft(g),this.FInputMemo.SetTop(y),this.FInputMemo.SetTabStop(!0),this.FInputMemo.SetTabOrder(u),u+=1,y=y+this.FInputMemo.GetHeight()+this.FHorSpacing;else if(2===v)this.FInputComboBox=pas["WEBLib.StdCtrls"].TWebComboBox.$create("Create$1",[h]),this.FInputComboBox.SetParent(h),this.FInputComboBox.SetItems(i.FInputItems),this.FInputComboBox.SetWidth(N),this.FInputComboBox.SetLeft(g),this.FInputComboBox.SetTop(y),this.FInputComboBox.SetTabStop(!0),this.FInputComboBox.SetTabOrder(u),u+=1,y=y+this.FInputComboBox.GetHeight()+this.FHorSpacing;else if(3===v)this.FInputDate=pas["WEBLib.StdCtrls"].TWebDateTimePicker.$create("Create$1",[h]),this.FInputDate.SetParent(h),this.FInputDate.SetWidth(120),b=Math.max(b,g+Math.round(120*this.FScale)+this.FVerMargin),this.FInputDate.SetLeft(g),this.FInputDate.SetTop(y),this.FInputDate.SetTabStop(!0),this.FInputDate.SetTabOrder(u),u+=1,y=y+this.FInputDate.GetHeight()+this.FHorSpacing;else if(6===v)this.FInputTime=pas["WEBLib.StdCtrls"].TWebDateTimePicker.$create("Create$1",[h]),this.FInputTime.SetParent(h),this.FInputTime.SetWidth(120),b=Math.max(b,g+Math.round(120*this.FScale)+this.FVerMargin),this.FInputTime.SetKind(1),this.FInputTime.SetLeft(g),this.FInputTime.SetTop(y),this.FInputTime.SetTabStop(!0),this.FInputTime.SetTabOrder(u),u+=1,y=y+this.FInputTime.GetHeight()+this.FHorSpacing;else if(4===v&&null!=i.FInputControl){var W=i.FInputControl;this.FOldParent=W.FParent,W.SetParent(h),W.SetVisible(!0),W.SetLeft(g),W.SetTop(y),rtl.as(i.FInputControl,pas["WEBLib.Controls"].TWinControl).SetTabStop(!0),rtl.as(i.FInputControl,pas["WEBLib.Controls"].TWinControl).SetTabOrder(u),u+=1,i.FInputControl.GetWidth()>l&&0!==i.FInputControl.GetWidth()&&($=i.FInputControl.GetWidth()/(l-g-this.FVerMargin),i.FInputControl.SetWidth(l-g-this.FVerMargin),i.FInputControl.SetHeight(Math.round(i.FInputControl.GetHeight()/$))),N=(b=Math.max(b,g+this.FVerMargin+i.FInputControl.GetWidth()))-g-this.FVerMargin,y=y+i.FInputControl.GetHeight()+this.FHorSpacing}if(4 in i.FOptions&&(this.FProgressBar=pas["WEBLib.ComCtrls"].TWebProgressBar.$create("Create$1",[h]),this.FProgressBar.SetParent(h),this.FProgressBar.SetBounds(g,y,N,Math.round(12*this.FScale)),this.FProgressBar.SetMin(i.FProgressBarMin),this.FProgressBar.SetMax(i.FProgressBarMax),this.FProgressBar.SetPosition(0),this.FProgressBar.SetTabStop(!1),y=y+this.FHorSpacing+this.FProgressBar.GetHeight()),i.FRadioButtons.GetCount()>0){for(var O=0,x=i.FRadioButtons.GetCount()-1;O<=x;O++)C=O,L=i.CreateRadioButton(h),this.FRadioButtons.Add(L),L.SetParent(h),L.SetGroupName(this.FName),L.SetCaption(i.FRadioButtons.Get(C)),L.SetLeft(g),L.SetTop(y),L.SetWidth(N),L.SetTabStop(!0),L.SetTabOrder(u),L.FOnClick=rtl.createCallback(this,"DoRadioClick"),u+=1,y=y+L.GetHeight()+5,6 in i.FOptions?L.SetChecked(!1):L.SetChecked(C===i.FDefaultRadioButton);y=y-5+this.FHorSpacing}if(this.FCustBtnList.Clear(),0 in i.FOptions){for(var k=0,V=i.FCustomButtons.GetCount()-1;k<=V;k++)C=k,I=t.TTMSFNCTaskDialogButton.$create("Create$1",[h]),this.FCustBtnList.Add(I),p=i.FCustomButtons.Get(C),1 in i.FOptions||I.FIcon.FBitmap.LoadFromResource$1(t.TTMSFNCTASKDIALOGARROWRIGHT,pas["WEBLib.TMSFNCTypes"].HInstance()),I.SetCap(i.FCustomButtons.Get(C)),I.SetParent(h),I.SetModalResult(200+C),I.FTextFont.Assign(this.FTaskDialog.FCommandLinkFont),I.SetHeight(40),I.SetWidth(N),I.SetLeft(g),I.SetTop(y),I.SetTabStop(!0),I.SetTabOrder(u),I.FOnClick=rtl.createCallback(this,"CommandLinkHandler"),I.FOnKeyDown=rtl.createCallback(this,"CommandLinkKeyDown"),u+=1,y+=I.GetHeight();y+=this.FHorSpacing}if(this.FPanel.SetTabStop(!1),this.FPanel.SetTabOrder(u),T=0,E=this.FHorSpacing,A=null,1===i.FDisplayedButtons){for(this.FCommBtnList.Clear(),(B<o||B<o+n+this.FVerSpacing)&&-1!==B?(f=B,S=!0):f=o,A=pas["WEBLib.StdCtrls"].TWebButton.$create("Create$1",[this.FPanel]),G=0;G<=5;G++)G in i.FCommonButtons&&(A=i.CreateButton(this.FPanel),this.FCommBtnList.Add(A),A.SetParent(this.FPanel),A.SetCaption(t.ButtonNames[G]),A.FTag$1=t.ModalResults[G],A.FFont.Assign(this.FTaskDialog.FButtonFont),A.SetTabStop(!0),A.SetTabOrder(T),f<A.GetWidth()&&(f=B,E=E+A.GetHeight()+this.FHorSpacing),A.SetTop(E),A.SetLeft(b-this.FVerMargin-f),A.FOnClick=rtl.createCallback(this,"BtnClickHandler"),f=f-A.GetWidth()-this.FVerSpacing,T+=1);if(!(0 in i.FOptions)){!S&&f<=0&&(f=n+o),o>0&&(f+=this.FVerSpacing);for(var H=0,U=i.FCustomButtons.GetCount()-1;H<=U;H++)C=H,A=i.CreateButton(this.FPanel),this.FCustBtnList.Add(A),p=i.FCustomButtons.Get(C),A.SetParent(this.FPanel),A.FFont.Assign(this.FTaskDialog.FButtonFont),A.SetCaption(p),A.FTag$1=100+C,A.SetWidth(this.GetCsBtnWidth(A)),A.SetTabStop(!0),A.SetTabOrder(T),f<A.GetWidth()&&-1!==B&&(f=B,E=E+A.GetHeight()+this.FHorSpacing),A.SetTop(E),A.SetLeft(b-this.FVerMargin-f),A.FOnClick=rtl.createCallback(this,"BtnClickHandler"),A.FFont.Assign(this.FTaskDialog.FButtonFont),f=f-A.GetWidth()-this.FVerSpacing,T+=1}0===this.FCommBtnList.GetCount()&&0===this.FCustBtnList.GetCount()&&(G=0,A=i.CreateButton(this.FPanel),this.FCommBtnList.Add(A),A.SetParent(this.FPanel),A.SetCaption(t.ButtonNames[G]),A.FTag$1=t.ModalResults[G],A.SetDefault(!0),A.SetTabStop(!0),A.SetTabOrder(T),A.FFont.Assign(this.FTaskDialog.FButtonFont),A.FOnClick=rtl.createCallback(this,"BtnClickHandler"),A.SetTop(this.FHorSpacing),A.SetLeft(b-A.GetWidth()-this.FVerMargin),T+=1)}if(w=0===this.FCommBtnList.GetCount()&&0 in i.FOptions?this.FHorSpacing:E+(P=null!=A?A.GetHeight():0)+this.FHorSpacing,C=this.FHorSpacing,""!==i.FExpandedText&&(this.FExpandButtonIcon=pas["WEBLib.TMSFNCImage"].TTMSFNCImage.$create("Create$1",[this.FPanel]),this.FExpandButtonIcon.SetParent(this.FPanel),this.FExpandButtonIcon.FOnClick=rtl.createCallback(this,"ExpandIconClicked"),this.FExpandButtonIcon.FOnKeyDown=rtl.createCallback(this,"ExpandIconKeyDown"),this.FExpandButtonIcon.FOnBitmapChanged=rtl.createCallback(this,"ExpandIconChanged"),this.FExpandButtonIcon.FStroke.SetKind(0),this.FExpandButtonText=pas["WEBLib.StdCtrls"].TWebLabel.$create("Create$1",[this.FPanel]),this.FExpandButtonText.SetParent(this.FPanel),this.FExpandedText=pas["WEBLib.TMSFNCHTMLText"].TTMSFNCHTMLText.$create("Create$1",[h]),this.FExpandedText.SetParent(h),this.FExpandedText.SetWordWrapping(!0),this.FExpandedText.SetVerticalTextAlign(1),this.FExpandedText.SetHorizontalTextAlign(1),this.FExpandedText.SetText(i.FExpandedText),this.FExpandedText.FFont$1.SetColor(i.FAppearance.FExpandedTextColor),this.FExpandedText.SetWidth(N),this.FExpandedText.SetAS(!0),this.FExpandedText.SetVisible(!1),this.FExpandedText.SetTabStop(!1),this.FExpandedText.FFill.SetColor(F),this.FExpandedText.SetBitmapContainer(this.GetBitmapContainer()),2 in i.FOptions?(this.FExpanded=!0,this.FExpandedText.SetVisible(!0),this.FExpandedText.SetLeft(g),this.FExpandedText.SetTop(y),y=y+this.FExpandedText.GetHeight()+this.FHorSpacing,this.FExpandButtonIcon.FBitmap.LoadFromResource$1(t.TTMSFNCTASKDIALOGCOLLAPSE,pas["WEBLib.TMSFNCTypes"].HInstance()),this.FExpandButtonIcon.FFill.SetColor(pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(240,240,240)),this.FExpandButtonIcon.SetTabStop(!0),this.FExpandButtonIcon.SetTabOrder(T),T+=1,this.FExpandButtonText.SetTop(this.FHorSpacing+3),this.FExpandButtonText.SetLeft(this.FVerMargin+20+this.FVerSpacing),this.FExpandButtonText.SetWidth(c),this.FExpandButtonText.SetCaption(this.FTaskDialog.FCollapseControlText)):(this.FExpandButtonIcon.FBitmap.LoadFromResource$1(t.TTMSFNCTASKDIALOGEXPAND,pas["WEBLib.TMSFNCTypes"].HInstance()),this.FExpandButtonIcon.FFill.SetColor(this.FPanel.FFill.FColor),this.FExpandButtonIcon.SetTabStop(!0),this.FExpandButtonIcon.SetTabOrder(T),T+=1,this.FExpandButtonText.SetTop(this.FHorSpacing+3),this.FExpandButtonText.SetLeft(this.FVerMargin+20+this.FVerSpacing),this.FExpandButtonText.SetWidth(c),this.FExpandButtonText.SetCaption(this.FTaskDialog.FExpandControlText)),this.FExpandButtonIcon.SetBounds(this.FVerMargin,this.FHorSpacing,20,20),0===this.FCommBtnList.GetCount()&&0 in i.FOptions&&(w=this.FExpandButtonIcon.GetHeight()+2*this.FHorSpacing),C=Math.round(w)),""!==i.FVerifyText&&(this.FVerify=pas["WEBLib.StdCtrls"].TWebCheckBox.$create("Create$1",[this.FPanel]),this.FVerify.SetParent(this.FPanel),this.FVerify.SetColor(this.FPanel.FColor),this.FVerify.SetCaption(i.FVerifyText),this.FVerify.SetLeft(this.FVerMargin),this.FVerify.SetTop(C),3 in i.FOptions&&this.FVerify.SetChecked(!0),this.FVerify.SetWidth(a),this.FVerify.SetTabStop(!0),this.FVerify.SetTabOrder(T),this.FVerify.FOnClick=rtl.createCallback(this,"DoVerifyClick"),this.FTaskDialog.SetVerifyResult(this.FVerify.GetChecked()),P=this.FVerify.GetHeight(),w=Math.max(w,C+this.FHorSpacing+P)),0===this.FPanel.GetControlsCount()&&(w=0),""!==i.FFooter){if(g=this.FVerMargin,0!==i.FFooterIcon){this.FFooterIcon=pas["WEBLib.TMSFNCImage"].TTMSFNCImage.$create("Create$1",[this.FPanel]),this.FFooterIcon.SetParent(this.FPanel),this.FFooterIcon.FStroke.SetKind(0),this.FFooterIcon.FFill.SetColor(this.FPanel.FFill.FColor);var z=i.FFooterIcon;1===z?this.FFooterIcon.FBitmap.LoadFromResource$1(t.TTMSFNCTASKDIALOGWARNING,pas["WEBLib.TMSFNCTypes"].HInstance()):2===z?this.FFooterIcon.FBitmap.LoadFromResource$1(t.TTMSFNCTASKDIALOGQUESTION,pas["WEBLib.TMSFNCTypes"].HInstance()):3===z?this.FFooterIcon.FBitmap.LoadFromResource$1(t.TTMSFNCTASKDIALOGERROR,pas["WEBLib.TMSFNCTypes"].HInstance()):4===z?this.FFooterIcon.FBitmap.LoadFromResource$1(t.TTMSFNCTASKDIALOGINFORMATION,pas["WEBLib.TMSFNCTypes"].HInstance()):5===z?this.FFooterIcon.FBitmap.LoadFromResource$1(t.TTMSFNCTASKDIALOGSHIELD,pas["WEBLib.TMSFNCTypes"].HInstance()):6===z&&this.FFooterIcon.FBitmap.LoadFromResource$1(t.TTMSFNCTASKDIALOGABOUT,pas["WEBLib.TMSFNCTypes"].HInstance()),this.FFooterIcon.SetBounds(g,Math.round(w)+this.FHorSpacing,16,16),this.FFooterIcon.SetTabStop(!1),g=g+16+this.FVerSpacing}this.FFooter=pas["WEBLib.TMSFNCHTMLText"].TTMSFNCHTMLText.$create("Create$1",[this.FPanel]),this.FFooter.SetParent(this.FPanel),this.FFooter.SetWordWrapping(!0),this.FFooter.SetVerticalTextAlign(1),this.FFooter.SetHorizontalTextAlign(1),this.FFooter.SetText(i.FFooter),this.FFooter.FFont$1.SetColor(i.FAppearance.FFooterColor),this.FFooter.SetWidth(N),this.FFooter.SetAS(!0),this.FFooter.FFill.SetColor(this.FPanel.FFill.FColor),this.FFooter.SetLeft(g),this.FFooter.SetTop(Math.round(w)+this.FHorSpacing),this.FFooter.SetTabStop(!1),this.FFooter.SetBitmapContainer(this.GetBitmapContainer()),w=w+(D=Math.round(Math.max(this.FFooter.GetHeight()/this.FScale,16*this.FScale)))+2*this.FHorSpacing}b=Math.max(b,this.FMinFormWidth),this.SetClientWidth(Math.round(b)),D=Math.max(M,y),this.FPanel.SetTop(D),this.FPanel.SetLeft(0),this.FPanel.SetWidth(b),this.FPanel.SetHeight(Math.round(w)),this.SetClientHeight(Math.round(D+w))}},this.SetPositions=function(){var t,e,i=0,s=0,o=0,n=0,r=0,a=0,l=null;if(null!=this.FTaskDialog){if(s=this.FHorMargin,o=this.FVerMargin,n=this.FVerMargin,o+=25,n+=25,a=r=this.FMinFormWidth,i=this.CalculateButtonListWidth(this.FCommBtnList,!1,this.FTaskDialog.FDisplayedButtons)+this.CalculateButtonListWidth(this.FCustBtnList,!0,this.FTaskDialog.FDisplayedButtons)+this.CalculateExpButtonWidth()+this.FVerSpacing+2*this.FVerMargin+20,e=this.CalculateCsInputWidth(),r=Math.max(r,Math.max(i,e)),0===this.FTaskDialog.FIcon&&pas["WEBLib.TMSFNCTypes"].IsBitmapEmpty(this.FTaskDialog.FCustomIcon)||(this.FIcon.SetBounds(s,o-6,Math.round(32*this.FScale),Math.round(32*this.FScale)),s=s+this.FVerMargin+this.FIcon.GetWidth(),n=n+this.FHorSpacing+this.FIcon.GetHeight(),a=r-this.FIcon.GetWidth()-this.FVerMargin),a-=2*this.FVerMargin,null!=this.FMessage&&""!==this.FMessage.FCaption&&(this.FMessage.SetLeft(s),this.FMessage.SetTop(o),o=o+this.FMessage.GetHeight()+this.FHorSpacing),null!=this.FContent&&""!==this.FContent.FText){var h=this.FContent;h.SetWordWrapping(!0),h.SetVerticalTextAlign(1),h.SetHorizontalTextAlign(1),h.SetWidth(a),h.SetAS(!0),h.SetLeft(s),h.SetTop(o),o=o+this.FContent.GetHeight()+this.FHorSpacing}var F=this.FTaskDialog.FInputType;if(0===F||7===F?(this.FInputEdit.SetTop(o),this.FInputEdit.SetLeft(s),o=o+this.FInputEdit.GetHeight()+this.FHorSpacing):1===F?(this.FInputMemo.SetTop(o),this.FInputMemo.SetLeft(s),o=o+this.FInputMemo.GetHeight()+this.FHorSpacing):2===F?(this.FInputComboBox.SetTop(o),this.FInputComboBox.SetLeft(s),o=o+this.FInputComboBox.GetHeight()+this.FHorSpacing):3===F?(this.FInputDate.SetTop(o),this.FInputDate.SetLeft(s),o=o+this.FInputDate.GetHeight()+this.FHorSpacing):6===F?(this.FInputTime.SetTop(o),this.FInputTime.SetLeft(s),o=o+this.FInputTime.GetHeight()+this.FHorSpacing):4===F&&null!=this.FTaskDialog.FInputControl&&(this.FTaskDialog.FInputControl.SetTop(o),this.FTaskDialog.FInputControl.SetLeft(s),a=(r=Math.max(r,s+this.FVerMargin+this.FTaskDialog.FInputControl.GetWidth()))-s-this.FVerMargin,o=o+this.FTaskDialog.FInputControl.GetHeight()+this.FHorSpacing),null!=this.FProgressBar&&4 in this.FTaskDialog.FOptions&&(this.FProgressBar.SetBounds(s,o,a,Math.round(12*this.FScale)),o=o+this.FHorSpacing+this.FProgressBar.GetHeight()),null!=this.FRadioButtons&&0!==this.FRadioButtons.GetCount()){for(var p=0,c=this.FRadioButtons.GetCount()-1;p<=c;p++)i=p,(l=rtl.getObject(this.FRadioButtons.Get(i))).SetWidth(a),l.SetLeft(s),l.SetTop(o),o=o+l.GetHeight()+5;o=o-5+this.FHorSpacing}if(0 in this.FTaskDialog.FOptions){for(var u=0,C=this.FCustBtnList.GetCount()-1;u<=C;u++)i=u,rtl.getObject(this.FCustBtnList.Get(i)).SetTop(o),o+=rtl.getObject(this.FCustBtnList.Get(i)).GetHeight();o+=this.FHorSpacing}null!=this.FExpandedText&&""!==this.FExpandedText.FText&&(this.FExpanded?(this.FExpandedText.SetLeft(s),this.FExpandedText.SetTop(o),this.FExpandedText.SetWidth(a),this.FExpandedText.SetVisible(!0),this.FExpandButtonText.SetCaption(this.FTaskDialog.FCollapseControlText),o=o+this.FExpandedText.GetHeight()+this.FHorSpacing):(this.FExpandedText.SetVisible(!1),this.FExpandButtonText.SetCaption(this.FTaskDialog.FExpandControlText))),o=(t=Math.max(o,n))+this.FPanel.GetHeight(),this.SetClientHeight(Math.round(o)),this.FPanel.SetTop(t)}},rtl.addIntf(this,pas["WEBLib.TMSFNCBitmapContainer"].ITMSFNCBitmapContainer),rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TTMSFNCTaskDialog",this.TTMSFNCCustomTaskDialog,(function(){rtl.addIntf(this,pas["WEBLib.TMSFNCBitmapContainer"].ITMSFNCBitmapContainer),rtl.addIntf(this,pas["WEBLib.TMSFNCGraphicsTypes"].ITMSFNCAppearanceGlobalFont),rtl.addIntf(this,pas["WEBLib.TMSFNCTypes"].ITMSFNCProductInfo),rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas.System.IUnknown);var e=this.$rtti;e.addProperty("ApplicationIsParent",2,rtl.boolean,"FApplicationIsParent","SetApplicationIsParent",{Default:!1}),e.addProperty("Appearance",2,t.$rtti.TTMSFNCTaskDialogAppearance,"FAppearance","SetAppearance"),e.addProperty("DisplayedButtons",0,t.$rtti.TTMSFNCTaskDialogDisplayedButtons,"FDisplayedButtons","FDisplayedButtons",{Default:t.TTMSFNCTaskDialogDisplayedButtons.tdbDefault}),e.addProperty("BitmapContainer",3,pas["WEBLib.TMSFNCBitmapContainer"].$rtti.TTMSFNCBitmapContainer,"GetBitmapContainer","SetBitmapContainer"),e.addProperty("Title",14,rtl.string,"FTitle","SetTitle",{stored:"IsTitleStored"}),e.addProperty("Instruction",14,rtl.string,"FInstruction","SetInstruction",{stored:"IsInstructionStored"}),e.addProperty("Options",0,t.$rtti.TTMSFNCTaskDialogOptions,"FOptions","FOptions",{Default:{}}),e.addProperty("Icon",2,t.$rtti.TTMSFNCTaskDialogIcon,"FIcon","SetIcon",{Default:t.TTMSFNCTaskDialogIcon.tdiBlank}),e.addProperty("CustomIcon",2,pas["WEBLib.TMSFNCTypes"].$rtti.TTMSFNCBitmap,"FCustomIcon","SetCustomIcon"),e.addProperty("Content",14,rtl.string,"FContent","SetContent",{stored:"IsContentStored"}),e.addProperty("RadioButtons",2,pas.Classes.$rtti.TStringList,"FRadioButtons","SetRadioButtons"),e.addProperty("DefaultRadioButton",2,rtl.longint,"FDefaultRadioButton","SetDefaultRadioButton",{Default:0}),e.addProperty("DialogPosition",2,t.$rtti.TTMSFNCTaskDialogPosition,"FDialogPosition","SetDialogPosition",{Default:t.TTMSFNCTaskDialogPosition.tdpScreenCenter}),e.addProperty("CommonButtons",2,t.$rtti.TTMSFNCTaskDialogCommonButtons,"FCommonButtons","SetCommonButtons",{Default:{}}),e.addProperty("CustomButtons",2,pas.Classes.$rtti.TStringList,"FCustomButtons","SetCustomButtons"),e.addProperty("ButtonFont",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFont,"FButtonFont","SetButtonFont"),e.addProperty("CommandLinkFont",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFont,"FCommandLinkFont","SetCommandLinkFont"),e.addProperty("ExpandedText",14,rtl.string,"FExpandedText","SetExpandedText",{stored:"IsExpandedTextStored"}),e.addProperty("ExpandControlText",14,rtl.string,"FExpandControlText","SetExpandControlText",{stored:"IsExpandControlTextStored"}),e.addProperty("CollapseControlText",14,rtl.string,"FCollapseControlText","SetCollapseControlText",{stored:"IsCollapseControlTextStored"}),e.addProperty("MinDialogWidth",2,rtl.longint,"FMinDialogWidth","SetMinDialogWidth",{Default:350}),e.addProperty("MaxDialogWidth",2,rtl.longint,"FMaxDialogWidth","SetMaxDialogWidth",{Default:1e3}),e.addProperty("VerifyText",14,rtl.string,"FVerifyText","SetVerifytext",{stored:"IsVerifyTextStored"}),e.addProperty("FooterIcon",2,t.$rtti.TTMSFNCTaskDialogIcon,"FFooterIcon","SetFooterIcon",{Default:t.TTMSFNCTaskDialogIcon.tdiBlank}),e.addProperty("Footer",14,rtl.string,"FFooter","SetFooter",{stored:"IsFooterStored"}),e.addProperty("InputType",2,t.$rtti.TTMSFNCTaskDialogInputType,"FInputType","SetInputType",{Default:t.TTMSFNCTaskDialogInputType.titNone}),e.addProperty("InputItems",2,pas.Classes.$rtti.TStringList,"FInputItems","SetInputItems"),e.addProperty("InputText",14,rtl.string,"FInputText","SetInputText",{stored:"IsInputTextStored"}),e.addProperty("InputControl",2,pas["WEBLib.Controls"].$rtti.TControl,"FInputControl","SetInputControl"),e.addProperty("AutoClose",2,rtl.boolean,"FAutoClose","SetAutoClose",{Default:!1}),e.addProperty("AutoCloseTimeOut",2,rtl.longint,"FAutoCloseTimeOut","SetAutoCloseTimeOut",{Default:0}),e.addProperty("GlobalFont",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCAppearanceGlobalFont,"FGlobalFont","SetGlobalFont"),e.addProperty("OnAutoClose",2,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnAutoClose","SetOnAutoClose"),e.addProperty("OnDialogVerifyClick",0,t.$rtti.TTMSFNCCustomTaskDialogVerifyClickEvent,"FOnDialogVerifyClick","FOnDialogVerifyClick"),e.addProperty("OnDialogRadioClick",0,t.$rtti.TTMSFNCCustomTaskDialogRadioClickEvent,"FOnDialogRadioClick","FOnDialogRadioClick"),e.addProperty("OnDialogButtonClick",0,t.$rtti.TTMSFNCCustomTaskDialogButtonClickEvent,"FOnDialogButtonClick","FOnDialogButtonClick"),e.addProperty("OnDialogExpandButtonClick",0,t.$rtti.TTMSFNCCustomTaskDialogExandButtonClickEvent,"FOnDialogExpandButtonClick","FOnDialogExpandButtonClick"),e.addProperty("OnDialogCreated",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnDialogCreated","FOnDialogCreated"),e.addProperty("OnDialogClosed",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnDialogClosed","FOnDialogClosed"),e.addProperty("OnDialogTimer",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnDialogTimer","FOnDialogTimer"),e.addProperty("OnDialogProgress",0,t.$rtti.TTMSFNCCustomTaskDialogProgressEvent,"FOnDialogProgress","FOnDialogProgress"),e.addProperty("OnDialogResult",0,t.$rtti.TTMSFNCCustomTaskDialogDialogResultEvent,"FOnDialogResult","FOnDialogResult"),e.attr=[pas.Classes.ComponentPlatformsAttribute,"Create$1",[0]]})),this.TTMSFNCTASKDIALOGABOUT="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAACXBIWXMAAA7DAAAOwwHHb6hkAAABX0lEQVRYhcXXMU/CQBQH8L8wu3SQsTqx2EQ3VidYdHRygK9BogN8EBriFwAXWHA2ri6yGEcYTAgSmkAIS3uh3Dt699K7vq2B6/8Hfde8AwquM+7C+86oB6AZX4ZvL42WM8BReFIshDFAEc5GGAEywlkIbQAVflU5BwD8zJZshBaACm8/3qJWvQAAfP3+od3/ZCFKnPDA90Q4AFz7HgLfO17ajNfyAapnPluspe/+RxvqFpmIsmk4AKyiLeaLCIHvYbPdoT+Z4uN7rrrVTfXu6XL6/jqgPiR7QLPbTYvsCQlgKVyJSAFMwofP9dT1Q3fMQogmtPzLDyvVmCXH4RIi+QdchgvEIaCwSgBhAdmhAMRd6RIhdoJ4BA4R9DZ0hJBeRFITWkSQr2JyF1hAKGcD5TbMEXFyMDn5HsgBkTkVsUeyPMK1AQxEvkOpIcLOWK6JsHswyUC4OZopEOzDaeG1B3J6q66a2wm6AAAAAElFTkSuQmCC",this.TTMSFNCTASKDIALOGERROR="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAACXBIWXMAAA7DAAAOwwHHb6hkAAACnElEQVRYhc2XP0zbQBTGP4IEUVEgY2FAZslgFpSKhaXJRBcUlgzdOmWApVPX2FOlSlW7JAOqBJ06eGgQUyfcBXWywuIhC1YG3CpCDYosJQqROuTOuTh39jkJKt+U3D3f7/P9eX4H/GctyAbaxawC4BBAAcAOgDQnzARwDqCmGpYzFwME/InA48gEoKuGZU5twC5mNQDlmOCgPhMjbWkDdjGbBnCJ4VTPQ3UAeZ6JCQOPAA81keAEfg/C13IHyJyaSCqZSMriSgpbH75hLXcQ7NoBcElecBTP/iFr/iYI3zjSkFhaxurePrzrKzy074TwzfIJkkoGqd0c+i0XPafBhjwHkKzY7g/a4C8B2e03PDirgddBUy+hOz7wGJzVbVXDvXkR9Jqnp4NdgrHdzoOLQCI4AGwcabzl8FkLgL/x/rIRmVMTiyupiQGp6Ez0W64QTtV1Grh59zrYvKUalkNnYCLJNPUSBl5HOCh9axl4Uy/xug6B0RIURA9GmZCBC8YosAaUKQYIlcSzOdaAMOlMY2LgdeBWy1LP8BLRTCZEx3QmA48pKQNJJYPN8knosaQKywlhBurzgMc00Y40MA08hok6a+DnNPCB15FKVgIT56yBGsiUUMnAm3pJOmNyVPMNkCKhxvb++foxEt51GlJHlDPWGS1a2VOgg5mFe/MCt1UtFE4VZkLwOdbpD78gqdhu+3h7vQfgFW3rOQ30Wy5SuzkhnOqhfQfv+gqre/tILC2HwlXD8md7rCKq2O6v4+11BUxqpiaeqS8iMxxr4veX9zx4XTWsse/y0ytKSUAegU05o0weHIi+mLzFsHziXcNkpauGpYk6Za9mZQwrmDhGzgjcCQuKczlNExMvMdwfwT1SB+BgdDnlXsWenP4BbVdo/mzjj6gAAAAASUVORK5CYII=",this.TTMSFNCTASKDIALOGINFORMATION="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAACXBIWXMAAA7DAAAOwwHHb6hkAAABt0lEQVRYhe2XsU7CQBjHfxodjIOMLBB0IW6wOdrIxlBceQgDD0AI4QHaycEHYIUOxMkUn4AmurAIiYsxJtYBQ8LiwLUepUKrtF38b/16d/9f7r67+w4S1k7QhuWGkQMqgAoUgJSniQ1YgAH0+m11shWAcsMoABpwHhRWaADU+23V+hVAuWGkgCZQC2nslQ60+m3VDgwgzE0WU+2rs9M0pUKWw4N9HsZvdMzROggLUPwgVgCCmJeKGWqXxaXY3fAZrTsMDbEb1hzgopj1iWXWdUGMaQoPfwAWa77WHOD1/XM1Zq/GfoBo+gKIbA+UcDe3jzy9fLjf09kcrbs22WXVhBcAe9IPLegI09mcq+t7TtJHbhKGlAYoIJJQHDLjsKP8Ucf9tjpxlqASs7nr6SyBGqZnVclTVfJLsY452nQWeKUCujMDGzM/AhXgexd4L5Y4lJIBEtM/gAPge1VGLFsGCHyOblGWDGAkAGDIAL0EAHougCggBzGaD5yiVd4F9RgBXC8XQFSvegzmulwpe8+BFtHuCEt4uFoCEAWjEhHE5qI0QojgZbmjRB8mHpBknmY+IDkieJwmri+yuJWo4dhEEQAAAABJRU5ErkJggg==",this.TTMSFNCTASKDIALOGQUESTION="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAACXBIWXMAAA7DAAAOwwHHb6hkAAACmklEQVRYhcWXsUsbURzHPy0KNkJzpSU9ByFmaQMV4mYmE9qlZDi7dm8Hh6KjQxDJHxBx6NCCo2PJCcHFELtotwQUisspZGgKFZIhbSBLh1zOu8u7d+9Si98p/N7v3veb3/u93+/34I5xT9WxUDSTwCpgABlA87l0gCZgApVqybi6FQGFopkBykBOVayNY2CjWjKaEwkoFE0N2ALWIxL7sQNsV0tGR1mATV5nGOrbQBPIi0SMCZCRL6d1ss/nWJh7SEqPO3ar3eXs8pqDU4ufnd+RRHgEyMh311Y8pEHYr1+wX79QFnHf57AlIgeUyAHe5p+xnNaDljM2hwNHgJ3t/5pwALx//UK2vG5zATDlWiiHbdzrDzhqtKg1WljtLgBGNsU7H2FCi5HS446PAGUgD3YE7CKTk5Fb7S4fPn7l8+G5Z2Pz1KLWaI35zz6Ylm2XszmdI1iVeQNs7p0EZrgk82VYdQswwrx7/UHg2uLCkzHb2eWvsC0Nt4CJC86rpXkWk489NtGRCJBxC/A3FmXy9TdLHluvP+DT4bnK55pbwK2Rb+6dSI/Lj4kELKf1QHLJ1RNiKtxlHP5CY7W7kf/5CKMICFulCCk9TkKLeWw7X5qTkHfcAqRDgxv+AnN2dR057G7OkQBT9aven+hhDoAJNzlQQaEXwPC8Je02CirgmgcKRbNO9LlvUhxXS0YevLdgA2iofJ3S4xjZFIlHMawfw4hETMKN0Q//RFQmZCZ4qsXYXVthduYmGUedUhE71ZLhCPAXom1CbsTLpXkPOQwjImpIAjRtDgceAfaslpeJCAq1wu0QDqVjpThMxJFrGhqhJrCpkMOED5PZmWmyaZ2EFsNqd/n2vS0jj/4w8Qm5m6eZQEiS//A4vXP8BV1DBp8MQbulAAAAAElFTkSuQmCC",this.TTMSFNCTASKDIALOGSHIELD="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAACXBIWXMAAA7DAAAOwwHHb6hkAAABcklEQVRYhe2XwW2DMBSGv1S9V2KBsEF741hGyAb1CNnAsEGzAd2g3YAefQsbkAWsZAJ6wGoRGGwnUHroL3GILN7/BZv3fjZN07Cm7lZ1B+6vvVErKYDM/HwFiijJz6F1NiFboJWMAQHsgYfe8qUDUs8GoJVMgRTYAY+edSvgHSijJC+DALSSBRCba+tp6NIJqIE6SnLRXbCdgZeZTLvamuuZdgu/tfpb8A9gA/hc0G9Q+08+geOCfoNOaQMIbqcBGvw5G0C5IMCg9m9vgfsJmIlWLWBe2abl2FtQLgBgrTkGUCwAYK05Oo61kjXzTcMqSvIn28JUI8pmMoc2qFg1GUi0kkf8Q8iYTlGSx2OLrla8v9EcevM/CMDEqcMN5gdXJPMZRhnX9YUKj3PkBDDNQ9CmXl9dAOET073GcZTkR9pk7ANRAam5xynvPNCBmNqOIPMggB7Eh2X5zZgHjfOgL6OutJI7fhqMcJ322QHm0uqZ8At4gHIZ+agWPAAAAABJRU5ErkJggg==",this.TTMSFNCTASKDIALOGWARNING="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAACXBIWXMAAA7DAAAOwwHHb6hkAAABk0lEQVRYhe2WoVICQRzGfzo2CTdDoDGnBSM2AoEngKNa5A3EYlwYooU30GYFg2+gM9sMJos6mgw7EnwAg3vMAXt3/70Bi3zpbmf3+7797v+/Xdjiv2On6EKj1QSI7Ou03Bh1i/DsFhTvJ8QBIjv2NwaAgWPszGgVbNyA0WoIuIRCwDsFrxowWoXAIxBc3rzw/P4NQK1a4uLkEGAGHJcbozcpp28CY9y7jxHYOWKIDRitWiwWXhoiO3e9BvDbmXiuyIBtsXpy7Ki673y2qEvbMteAbS1X2+VhIGlLSQJ5hZcGUUFmGjBa1YFeAfEYPctRzAAZO6hVS85nH45MA0arHtDKWixEy3LJDdji8fqh5GCcVpBpCfQpVnhpCEg5J1bOAvu/f12jeBIHy+eEK4HrDYk7uRcSMFpFwETC9PD0xdXdBwCdZoV2syI10S03RtP4ZTkBceHF4gC395/SZSsacwP2ohH6MBVEaLUWDQCnPiydROQdefwrWnuJQa+2a/t992XMtZIJnPN7pdo0ZlZriy0A+AEf2GjRMLvNlAAAAABJRU5ErkJggg==",this.TTMSFNCTASKDIALOGEXPAND="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEwAACxMBAJqcGAAAAmtJREFUOI2dlMFOE2EQx/8zu22V0N2db5aDJIRL3wBOCij4AFaTihhfQq96IBBvajQh8R00Ws8KXvDII3BBIbRdsu2hly5pPw9dm9JuUZzbzv8/v/lmM99HyIpSqWDieN0SlQlYAHAjVU4tcGCBakvkIw4PO6OlNJqQMHxku93XzDxlgSpZ+wPAcSrPWaIlAu73gDb1es+azeaHzEMBYGPMe6OaiOrmzMzM9CSjqhZFdcuoJiKyA4DHTCksFpGbk0Bj04gspTU7Y2Om3f4ZNgS9ZVQTY0ylnymVCoHIiahuXhU2gKpuBqq/AOTZxPE6M0+5zK/+F+gyv2JgOlCtsCUqW6AaRVF70DEMN0TEn3giET9QffznO4qitgWqAMpMwEK6GoMga59b5q9ZUN/3Awt8A/BipGafgUVGf2mPh0XXce4CKALY9X1fhmDCzLtgns4xr10AEh0BmB3fHwCNRqNecN07xHzdcZw9z/OM53nGcZw9Yr6Wd5zVKIpqWbUM4BTA3KhQr9cbSS63CiLXdd0913W/g8hNcrnVRqNRH/Vba+cBnLAFDizRUla3dq0WJZ3OGtIrmnQ6a+1aLcryWqIVAAcIVJ8Y1ZaqFrOMAIBSqQAgP0lW1aJRbUkYbvQXW/VYVLcmAv8SorptVI8GTUXkYXr1Mke/LIIwXDGq58aYBxe7iOwY1WYQhstXgN02qk1RfZelcwo9F9Xty/6pMcYT1Zep9y2Gnq+xB9YYU+kRvQHgEfAFvd4+Ef0EAMs8j2532TLfY6AFa5/Gcfx5uH4MmEY+UK0AKDOwCGA2zZ+gv2bV5tnZJwDJaOFvIMS2gQ33gdwAAAAASUVORK5CYII=",this.TTMSFNCTASKDIALOGCOLLAPSE="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEwAACxMBAJqcGAAAAopJREFUOI2dlE1PU1EQht8zQGuaQjozt0gxpJv+A0jUCHGBGN2hSUUT/4BLdWNYGIOJCxO/EhLXbiWCexPA4LI/gZWCRKH3thUjpfee44KL6WcCznLemee8kzPnGHSLQiEpvj/njJk1wDiAXKzsOKDkgJUK8xI2N+vtraY9wZ5320XRCyJKOWDFOPcFwFYsjzljJg1wwwL7xtoHQRC872oKAInIW1Gti8jjbDab7lWoqoOsuiCqh8y8CIA6imJYWUQu9AJ1TMM8KapBDG0dU0QOROT8SWHHkfG8KVFtiEjxKFMoJDPM2yIyf1rYP0OqTzOq3wAkSHx/joiSqVTqVa+GXC6XyufzZ3rpBDwHMJRRLRpWXTbO/fB9/1634mw2O9KwdpWcOwjD8EqtVvN7uHzngBQZYNwas9GtSFVHG2G4Dmv3AZj+/v7VdDrtdbVp7QYBEwQgB2O22nUROWetXQdRYICZMAynAdhEMrmaHhnJttcbY74CGO3cHwDMPAbgsyH62QdcDYKgWqvV/CiKpp219USjsTY8PHy2Wy8B2IFzY62HmTUA3/uIrpXL5V/HQrVaDay1Mxb4HUbRp2aQI8oD2CYHlMi5qWbNOTc/MDBwfXd3d7/dQbVarZBzM3DuSYsQRVMASsio3hXVci6XS3Ub4SQhIkMZ5hp73h2qMC9Z4E+9Xn/4v0BnzCMiCoK9vQ8AAGa+Jap1Zr54WljG8y7HT+9mi8DMi6LqM/OlU8IqrPqmm04x9JBVF1R1sBdIRIZY9ZmoNlj1NZq+r44PVkSK1piXAIYM8BHWbsRLe7QaUTTlgFkiCuDcfd/3l5v7O4BxJDKqRQCzBEwAGI3z2wBKzpiV+AIO2xv/Ag295uDBZxPuAAAAAElFTkSuQmCC",this.TTMSFNCTASKDIALOGARROWRIGHT="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEwAACxMBAJqcGAAAASdJREFUOI3N1D9Lw2AQx/HvXaKEpIivwaEgTm46iSJklYq+Acd2E1wciouTICi4uutSkA4uiqs4OPhGin+oJLnHJSqUYp7Upb/5+DzPHdzBtEd8Cw8fs01RWR7M6dl5Uz//Be5cuaC5kL0pGplxG74HW0frMhxXqz7g9a4UmD4AqJLmSdHr3rtoYhAg1KCFcVeFes8QoPvkYrPiBmUDYFz7tUAfVAC6L27WPrJVQ2Z8UIFYVI6BpVE0BCiG+YWo7nkPdCSqpNbIT4COli/mE1o/cY4CIATQ17BjjezSBK+WFUkwTlFZBHBGfzAfHJSfq5f9Z0ui3PoKa7+Ybn9vTy2wCqsF+mBQztAncW49KjDwXT3nxMxWqjB/UMQBKdAO4qD11/ma/nwBeY6UFXvuI2AAAAAASUVORK5CYII=",this.ButtonNames=["OK","Yes","No","Cancel","Retry","Close"],this.ModalResults=[1,6,7,2,4,3],t.$implcode=function(){e.CreateMessageDlg=function(e){var i=null;return i=null,null==e||(e.FApplicationIsParent?(i=t.TTMSFNCTaskDialogForm.$create("CreateNew",[pas["WEBLib.Forms"].Application,0])).SetParent(pas["WEBLib.Forms"].Application.FMainForm):null!=e.FOwner&&pas["WEBLib.Forms"].TCustomForm.isPrototypeOf(e.FOwner)?(i=t.TTMSFNCTaskDialogForm.$create("CreateNew",[rtl.as(e.FOwner,pas["WEBLib.Forms"].TCustomForm),0])).SetParent(rtl.as(e.FOwner,pas["WEBLib.Forms"].TCustomForm)):(i=t.TTMSFNCTaskDialogForm.$create("CreateNew",[pas["WEBLib.Forms"].Application,0])).SetParent(pas["WEBLib.Forms"].Application.FMainForm),i.SetBorder(3),i.FPopup=!0,i.SetShadow(!0),i.SetColor(e.FAppearance.FColor),i.FPanel.FFill.Assign(e.FAppearance.FDialogPanelFill),i.SetFormWidth(e.FMinDialogWidth),i.SetMaxFormWidth(e.FMaxDialogWidth),i.BuildTaskDialog(e),pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.ScaleForCurrentDPI(i)),i},e.GetExeName=function(){return document.title}}}),["Math"]),rtl.module("WebLib.SEFNC.Logger",["System","Classes","SysUtils","Generics.Collections","JS"],(function(){"use strict";var t=this;this.TSEFNCLogLevel={0:"sellTrace",sellTrace:0,1:"sellDebug",sellDebug:1,2:"sellInfo",sellInfo:2,3:"sellWarn",sellWarn:3,4:"sellError",sellError:4,5:"sellExceptElse",sellExceptElse:5},this.SEFNCLogLevels=["Trace","Debug","Info","Warn","Error","ExceptElse"],this.fmt_dts_long="yy-mm-dd hh:nn:ss.zzz",this.fmt_dts_short="hh:nn:ss.zzz",this.SEFNCLogLevelColors=["a6fade","94ff69","d0a9e1","f6f58d","fbb8ce","fbb8ce"],this.html_Start='<P bgcolor="#',this.html_CloseColor='">',this.Html_End="</P>",rtl.createClass(this,"TSEFNCLogMsg",pas.System.TObject,(function(){this.$init=function(){pas.System.TObject.$init.call(this),this.FDTS=0,this.FLogLevel=0,this.FSrcClassName="",this.FSrcUnitName="",this.FExceptionMsg="",this.Msg=""},this.ColorWrap=function(e){return t.html_Start+t.SEFNCLogLevelColors[this.FLogLevel]+t.html_CloseColor+e+t.Html_End},this.PrintDTS=function(e){return e?pas.SysUtils.FormatDateTime(t.fmt_dts_long,this.FDTS):pas.SysUtils.FormatDateTime(t.fmt_dts_short,this.FDTS)},this.DispDTS=function(t){return this.ColorWrap(this.PrintDTS(t))},this.PrintLogLevel=function(){return t.SEFNCLogLevels[this.FLogLevel]},this.DispLogLevel=function(){return this.ColorWrap(this.PrintLogLevel())},this.IsException=function(){return pas.SysUtils.TStringHelper.GetLength.call({p:this,get:function(){return this.p.FExceptionMsg},set:function(t){this.p.FExceptionMsg=t}})>0},this.Create$1=function(t,e){return this.FLogLevel=t,this.Msg=e,this.FDTS=pas.SysUtils.Now(),this},this.Create$2=function(t,e,i){return this.Create$1(t,e),null!==i&&(this.FSrcClassName=i.$classname,this.FSrcUnitName=i.$module.$name),this},this.Create$3=function(t,e,i,s){return this.Create$2(t,e,i),null!==s&&pas.SysUtils.TStringHelper.GetLength.call({p:s,get:function(){return this.p.FMessage},set:function(t){this.p.FMessage=t}})>0?this.FExceptionMsg=s.FMessage:this.FExceptionMsg="null message",this}})),rtl.createInterface(this,"ISEFNCLogger","{A79FD981-6953-4D86-B4ED-D758D9CD06DA}",["Debug","Debug$1","Debug$2","Error$1","Error$2","Info$1","Warn","Warn$1","Warn$2","Trace","Trace$1","Trace$2","LoggerLevelSet","LoggerLevelGet","LogQueueList"],pas.System.IUnknown),rtl.createClass(this,"TSEFNCLoggerFactory",pas.System.TObject,(function(){this.FLogger=null})),rtl.createClass(this,"TSEFNCLogger",pas.System.TInterfacedObject,(function(){this.$init=function(){pas.System.TInterfacedObject.$init.call(this),this.FHistory=null,this.FLogHistory=null,this.FLoggerLevel={}},this.$final=function(){this.FHistory=void 0,this.FLogHistory=void 0,this.FLoggerLevel=void 0,pas.System.TInterfacedObject.$final.call(this)},this.WriteMsg=function(e,i){var s;s=t.TSEFNCLogMsg.$create("Create$1",[e,i]),this.FHistory.Add(s)},this.WriteMsg$1=function(e,i,s){var o;o=t.TSEFNCLogMsg.$create("Create$2",[e,i,s]),this.FHistory.Add(o)},this.WriteMsg$2=function(e,i,s,o){var n;n=t.TSEFNCLogMsg.$create("Create$3",[e,i,o,s]),this.FHistory.Add(n)},this.Create$1=function(){return this.FHistory=pas["Generics.Collections"].TObjectList$G5.$create("Create$4",[!0]),this.FLogHistory=pas.Classes.TStringList.$create("Create$1"),this.FLogHistory.FOwnsObjects=!0,this.FLoggerLevel=rtl.createSet(2,3,4),this},this.Destroy=function(){rtl.free(this,"FLogHistory"),rtl.free(this,"FHistory"),pas.System.TObject.Destroy.call(this)},this.Debug=function(t){1 in this.FLoggerLevel&&this.WriteMsg(1,t)},this.Debug$1=function(t,e){1 in this.FLoggerLevel&&this.WriteMsg$1(1,t,e)},this.Debug$2=function(t,e,i){1 in this.FLoggerLevel&&this.WriteMsg$2(1,t,e,i)},this.Error$1=function(t,e){4 in this.FLoggerLevel&&this.WriteMsg$1(4,t,e)},this.Error$2=function(t,e,i){4 in this.FLoggerLevel&&this.WriteMsg$2(4,t,e,i)},this.Info$1=function(t,e){2 in this.FLoggerLevel&&this.WriteMsg$1(2,t,e)},this.Warn=function(t){3 in this.FLoggerLevel&&this.WriteMsg(3,t)},this.Warn$1=function(t,e){3 in this.FLoggerLevel&&this.WriteMsg$1(3,t,e)},this.Warn$2=function(t,e,i){3 in this.FLoggerLevel&&this.WriteMsg$2(3,t,e,i)},this.Trace=function(t){0 in this.FLoggerLevel&&this.WriteMsg(0,t)},this.Trace$1=function(t,e){0 in this.FLoggerLevel&&this.WriteMsg$1(0,t,e)},this.Trace$2=function(t,e,i){0 in this.FLoggerLevel&&this.WriteMsg$2(0,t,e,i)},this.LogQueueList=function(t,e){var i=!1,s=0;if(t===this.FHistory.FLength)return!1;try{e.get().Clear(),e.get().SetCapacity(this.FHistory.FLength-t);for(var o=t,n=this.FHistory.FLength-1;o<=n;o++)s=o,e.get().Add(this.FHistory.GetItem(s));i=e.get().FLength>0}catch(t){if(!pas.SysUtils.Exception.isPrototypeOf(t))throw t;i=!1}return i},this.LoggerLevelSet=function(t){this.FLoggerLevel=rtl.refSet(t)},this.LoggerLevelGet=function(){return rtl.refSet(this.FLoggerLevel)},rtl.addIntf(this,t.ISEFNCLogger),rtl.addIntf(this,pas.System.IUnknown)})),this.Logger=function(){var e=null,i=!1;try{e=rtl.setIntfL(e,t.TSEFNCLoggerFactory.FLogger),i=!0}finally{i||rtl._Release(e)}return e},t.$init=function(){rtl.setIntfP(t.TSEFNCLoggerFactory,"FLogger",rtl.queryIntfT(t.TSEFNCLogger.$create("Create$1"),t.ISEFNCLogger),!0)}})),rtl.module("WEBLib.Crypto",["System","Classes","JS","Web","Types"],(function(){"use strict";var t=this;this.TCryptoHash={0:"ehSHA1",ehSHA1:0,1:"ehSHA256",ehSHA256:1,2:"ehSHA384",ehSHA384:2,3:"ehSHA512",ehSHA512:3},rtl.createClass(this,"TSHAHash",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FHashType=0},this.Create$2=function(t){return this.FHashType=t,this},this.Hash=function(e){var i=this;return new Promise((function(s,o){var n,r="";n=t.GetMessageEncoding(e);var a=i.FHashType;r=0===a?"SHA-1":2===a?"SHA-384":3===a?"SHA-512":"SHA-256",window.crypto.subtle.digest(r,n).then((function(e){s(t.ABToHex(e))}))}))}})),rtl.createClass(this,"TWebSHAHash",this.TSHAHash,(function(){})),this.GetMessageEncoding=function(t){return(new TextEncoder).encode(t)},this.ABToHex=function(t){var e="",i=null,s=0,o=0;e="",i=new DataView(t);for(var n=0,r=rtl.trunc(i.byteLength/4)-1;n<=r;n++)s=n,o=i.getUint32(4*s),e+=pas.SysUtils.IntToHex(o,8);return e}}),["SysUtils"]),rtl.module("IOUtils",["System"],(function(){"use strict";rtl.recNewT(this,"TPath",(function(){this.$eq=function(t){return!0},this.$assign=function(t){return this},this.Combine=function(t,e){return pas.SysUtils.TStringHelper.IsEmpty.call({get:function(){return t},set:function(t){rtl.raiseE("EPropReadOnly")}})||pas.SysUtils.TStringHelper.GetChar.call({get:function(){return t},set:function(t){rtl.raiseE("EPropReadOnly")}},pas.SysUtils.TStringHelper.GetLength.call({get:function(){return t},set:function(t){rtl.raiseE("EPropReadOnly")}})-1)===pas.System.PathDelim?t+e:t+pas.System.PathDelim+e}}))}),["SysUtils","Web"]),rtl.module("NetEncoding",["System","Web","Classes","JS","SysUtils"],(function(){"use strict";rtl.createClass(this,"TNetEncoding",pas.System.TObject,(function(){})),rtl.createClass(this,"TBase64Encoding",this.TNetEncoding,(function(){}))})),rtl.module("WebLib.SERTTK.Session",["System","Generics.Collections","Types","SysUtils","WEBLib.TMSFNCTypes","WEBLib.TMSFNCBitmapContainer","WEBLib.TMSFNCJSONReader","WEBLib.TMSFNCPersistence","WEBLib.ExtCtrls","WEBLib.TMSFNCJSONWriter","Classes"],(function(){"use strict";var t=this,e=t.$impl;this.file_ext_session_json=".rttkjson",this.file_dt_fmt="yyyy-mm-dd_hh-nn-ss",this.zip_dir_nm_infostreams="InfoStreams/",this.stream_nilval_hash="nilhash",this.stream_nilval_b64string="nilval",this.stream_fileext_csv="csv",this.stream_fileext_json="json",rtl.createClass(this,"TSERTTKSessionStorageBase",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FID=pas.System.TGuid.$new()},this.$final=function(){this.FID=void 0,pas.Classes.TPersistent.$final.call(this)},this.IDRead=function(){return pas.SysUtils.TGuidHelper.ToString.call(this.FID,!1)},this.IDWrite=function(t){this.FID.$assign(pas.SysUtils.StringToGUID(t))},this.Create$1=function(){return pas.SysUtils.CreateGUID(this.FID),this},this.$rtti.addProperty("ID",3,rtl.string,"IDRead","IDWrite")})),rtl.createClass(this,"TSESSessionStepBase",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FDTS=0,this.FSysGenerated=!1,this.FID=pas.System.TGuid.$new()},this.$final=function(){this.FID=void 0,pas.Classes.TPersistent.$final.call(this)},this.IDRead=function(){return pas.SysUtils.TGuidHelper.ToString.call(this.FID,!1)},this.IDWrite=function(t){this.FID.$assign(pas.SysUtils.StringToGUID(t))},this.GetDisplayDTS=function(){return'<FONT color="#003399"  face="Consolas" >'+pas.SysUtils.FormatDateTime("hh:nn:ss.zzz",this.FDTS)+"</FONT> :: "},this.Create$1=function(t){return pas.SysUtils.CreateGUID(this.FID),this.FSysGenerated=t,this.FDTS=pas.SysUtils.Now(),this};var t=this.$rtti;t.addProperty("DTS",0,pas.System.$rtti.TDateTime,"FDTS","FDTS"),t.addProperty("SysGenerated",0,rtl.boolean,"FSysGenerated","FSysGenerated"),t.addProperty("ID",3,rtl.string,"IDRead","IDWrite")})),rtl.createClass(this,"TSESSessionStepLog",this.TSESSessionStepBase,(function(){this.$init=function(){t.TSESSessionStepBase.$init.call(this),this.FStepMessage=""},this.GetDisplayString=function(){return this.GetDisplayDTS()+this.FStepMessage},this.Create$2=function(e,i){return t.TSESSessionStepBase.Create$1.call(this,i),this.FStepMessage=e,this},this.$rtti.addProperty("StepMessage",0,rtl.string,"FStepMessage","FStepMessage")})),rtl.createClass(this,"TSESSessionScreenShot",this.TSESSessionStepLog,(function(){this.$init=function(){t.TSESSessionStepLog.$init.call(this),this.FFormName="",this.FBitmapGuid=pas.System.TGuid.$new()},this.$final=function(){this.FBitmapGuid=void 0,t.TSESSessionStepLog.$final.call(this)},this.BitmapGuidGet=function(){return pas.SysUtils.TGuidHelper.ToString.call(this.FBitmapGuid,!1)},this.BitmapGuidSet=function(t){this.FBitmapGuid.$assign(pas.SysUtils.StringToGUID(t))},this.GetDisplayString=function(){return this.GetDisplayDTS()+this.FStepMessage+" "+this.FFormName+" Screen Shot "},this.Create$3=function(e,i,s){return t.TSESSessionStepLog.Create$2.call(this,i,s),this.FFormName=e,pas.SysUtils.CreateGUID(this.FBitmapGuid),this};var e=this.$rtti;e.addProperty("FormName",0,rtl.string,"FFormName","FFormName"),e.addProperty("BitmapString",3,rtl.string,"BitmapGuidGet","BitmapGuidSet")})),this.TSESSessionBookmarkLevel={0:"sblInfo",sblInfo:0,1:"sblWarn",sblWarn:1,2:"sblError",sblError:2},this.$rtti.$Enum("TSESSessionBookmarkLevel",{minvalue:0,maxvalue:2,ordtype:1,enumtype:this.TSESSessionBookmarkLevel}),this.BookmarkLevels=["Info","Warn","Error"],rtl.createClass(this,"TSESSessionBookmark",this.TSESSessionStepLog,(function(){this.$init=function(){t.TSESSessionStepLog.$init.call(this),this.FBookmarkLevel=0},this.GetDisplayString=function(){return this.GetDisplayDTS()+t.BookmarkLevels[this.FBookmarkLevel]+" : "+this.FStepMessage},this.Create$3=function(e){return t.TSESSessionStepLog.Create$2.call(this,e,!0),this.FStepMessage=e,this.FBookmarkLevel=0,this},this.$rtti.addProperty("Level",0,t.$rtti.TSESSessionBookmarkLevel,"FBookmarkLevel","FBookmarkLevel")})),rtl.createClass(this,"TSESSessionStepBitmap",this.TSESSessionStepLog,(function(){this.$init=function(){t.TSESSessionStepLog.$init.call(this),this.FBMGUID=pas.System.TGuid.$new()},this.$final=function(){this.FBMGUID=void 0,t.TSESSessionStepLog.$final.call(this)},this.FBMGUIDRead=function(){return pas.SysUtils.TGuidHelper.ToString.call(this.FBMGUID,!1)},this.FBMGUIDWrite=function(t){this.FBMGUID.$assign(pas.SysUtils.StringToGUID(t))},this.GetDisplayString=function(){return this.GetDisplayDTS()+this.FStepMessage},this.Create$3=function(e,i){return t.TSESSessionStepLog.Create$2.call(this,e,i),pas.SysUtils.CreateGUID(this.FBMGUID),this},this.Destroy=function(){pas.System.TObject.Destroy.call(this)},this.$rtti.addProperty("BitmapGuid",3,rtl.string,"FBMGUIDRead","FBMGUIDWrite")})),rtl.createClass(this,"TSESSessionCompExport",this.TSESSessionStepLog,(function(){this.$init=function(){t.TSESSessionStepLog.$init.call(this),this.FCompExport=""},this.$rtti.addProperty("TxtExport",0,rtl.string,"FCompExport","FCompExport")})),rtl.createClass(this,"TSESSessionScreenDiff",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FScreenName="",this.FBeforeGuid=pas.System.TGuid.$new(),this.FAfterGuid=pas.System.TGuid.$new()},this.$final=function(){this.FBeforeGuid=void 0,this.FAfterGuid=void 0,pas.Classes.TPersistent.$final.call(this)},this.AfterGuidGet=function(){return pas.SysUtils.TGuidHelper.ToString.call(this.FAfterGuid,!1)},this.AfterGuidSet=function(t){this.FAfterGuid.$assign(pas.SysUtils.StringToGUID(t))},this.BeforeGuidGet=function(){return pas.SysUtils.TGuidHelper.ToString.call(this.FBeforeGuid,!1)},this.BeforeGuidSet=function(t){this.FBeforeGuid.$assign(pas.SysUtils.StringToGUID(t))},this.Create$1=function(t){return this.FScreenName=t,this};var t=this.$rtti;t.addProperty("ScreenName",0,rtl.string,"FScreenName","FScreenName"),t.addProperty("BeforeGuidStr",3,rtl.string,"BeforeGuidGet","BeforeGuidSet"),t.addProperty("AfterGuidStr",3,rtl.string,"AfterGuidGet","AfterGuidSet")})),rtl.createClass(this,"TSERTTKSessionScreenDiffs",pas["Generics.Collections"].TObjectList$G6,(function(){this.$init=function(){pas["Generics.Collections"].TObjectList$G6.$init.call(this),this.FOwnerInterface=null},this.$final=function(){rtl.setIntfP(this,"FOwnerInterface",null),pas["Generics.Collections"].TObjectList$G6.$final.call(this)},this.GetItemClass=function(){return t.TSESSessionScreenDiff},this._AddRef=function(){return null!==this.FOwnerInterface?this.FOwnerInterface._AddRef():-1},this._Release=function(){return null!==this.FOwnerInterface?this.FOwnerInterface._Release():-1},this.QueryInterface=function(t,e){return this.GetInterface(t,e)?0:-2147467262},rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCBaseListIO)})),rtl.createClass(this,"TSESSessionStepInspector",this.TSESSessionStepLog,(function(){this.$init=function(){t.TSESSessionStepLog.$init.call(this),this.FScreenDiffs=null,this.FPropertyName="",this.FPropertyValue="",this.FCompPath="",this.FPreviousValue=""},this.$final=function(){this.FScreenDiffs=void 0,t.TSESSessionStepLog.$final.call(this)},this.GetCompDisplayPath=function(){var t="";return t=pas.SysUtils.TStringHelper.Replace$2.call({p:this,get:function(){return this.p.FCompPath},set:function(t){this.p.FCompPath=t}},"|",' <FONT color="#FF0000">\\</FONT> '),pas.SysUtils.TStringHelper.Contains.call({get:function(){return t},set:function(e){t=e}},"}")&&pas.SysUtils.TStringHelper.Contains.call({get:function(){return t},set:function(e){t=e}},"{")&&(t=pas.SysUtils.TStringHelper.Replace$2.call({get:function(){return t},set:function(e){t=e}},"}",'<FONT color="#800000">'),t=pas.SysUtils.TStringHelper.Replace$2.call({get:function(){return t},set:function(e){t=e}},"{","</FONT>")),t},this.GetDisplayString=function(){return this.GetDisplayDTS()+this.FStepMessage+"<BR>"+this.DispPropertyName()+"<BR>"+this.DispPropertyPreviousValue()+"<BR>"+this.DispPropertyValue()+" <BR> path= "+this.GetCompDisplayPath()},this.DispPropertyName=function(){return'<FONT color="#800000"><B>Property Changed:</B> '+this.FPropertyName+"</FONT>"},this.DispPropertyValue=function(){return'<FONT color="#0000FF"><B>After:</B> '+this.FPropertyValue+"</FONT>"},this.DispPropertyPreviousValue=function(){return'<FONT color="#993366"><B>Before:</B> '+this.FPreviousValue+"</FONT>"},this.ScreensInit=function(e){var i=null,s="",o=e.GetEnumerator();try{for(;o.MoveNext();)s=o.GetCurrent(),i=t.TSESSessionScreenDiff.$create("Create$1",[s]),this.FScreenDiffs.Add(i)}finally{o=rtl.freeLoc(o)}},this.Create$3=function(e,i){return t.TSESSessionStepLog.Create$2.call(this,e,i),this.FScreenDiffs=t.TSERTTKSessionScreenDiffs.$create("Create$4",[!0]),this},this.Destroy=function(){rtl.free(this,"FScreenDiffs"),pas.System.TObject.Destroy.call(this)};var e=this.$rtti;e.addProperty("ScreenDiffs",0,t.$rtti.TSERTTKSessionScreenDiffs,"FScreenDiffs","FScreenDiffs"),e.addProperty("PropertyName",0,rtl.string,"FPropertyName","FPropertyName"),e.addProperty("PropertyValue",0,rtl.string,"FPropertyValue","FPropertyValue"),e.addProperty("PreviousValue",0,rtl.string,"FPreviousValue","FPreviousValue"),e.addProperty("CompPath",0,rtl.string,"FCompPath","FCompPath")})),rtl.createClass(this,"TSERTTKSessionInfoStream",this.TSERTTKSessionStorageBase,(function(){this.$init=function(){t.TSERTTKSessionStorageBase.$init.call(this),this.FPayload=[],this.FStream=null,this.FStreamExtension="",this.FB64String="",this.FDecodeString="",this.FHash64Src="",this.FHash64Ret="",this.FHashVal="",this.FReloaded=!1,this.FExported=!1},this.$final=function(){this.FPayload=void 0,this.FStream=void 0,t.TSERTTKSessionStorageBase.$final.call(this)},this.DataB64Read=function(){return this.FExported||this.FReloaded?this.FB64String:"not exported"},this.DataB64Write=function(e){try{this.FB64String=e,this.HashForString(this.FB64String),this.FHash64Ret=this.FHashVal,this.FHash64Ret===this.FHash64Src&&(pas.NetEncoding.TBase64Encoding.$create("Create"),this.FPayload=pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.Decode64ToBytes(this.FB64String,!1),this.FStream.Clear(),this.FStream.Write(this.FPayload,rtl.length(this.FPayload)),this.FStream.SetPosition(0)),this.FReloaded=!0}catch(e){if(!pas.SysUtils.Exception.isPrototypeOf(e))throw e;this.FDecodeString=t.stream_nilval_b64string}},this.Hash64SrcGet=function(){return this.FExported||this.FReloaded?this.HashSrcBase64():"notExported"},this.Hash64SrcSet=function(t){this.FHash64Src=t},this.HashSrcBase64=function(){var e="";return this.FB64String===t.stream_nilval_b64string?e=t.stream_nilval_hash:(this.HashForString(this.FB64String),e=this.FHashVal),e},this.HashForString=async function(t){var e=null;e=pas["WEBLib.Crypto"].TWebSHAHash.$create("Create$2",[1]);try{this.FHashVal=await e.Hash(t)}finally{e=rtl.freeLoc(e)}},this.PrepareExportBase64=function(){try{this.FStream.SetPosition(0),this.FPayload=rtl.arraySetLength(this.FPayload,0,this.FStream.GetSize()),this.FStream.Read({p:this,get:function(){return this.p.FPayload},set:function(t){this.p.FPayload=t}},this.FStream.GetSize()),this.FB64String=pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.Encode64$1(this.FPayload,!1),this.FExported=!0}catch(e){if(!pas.SysUtils.Exception.isPrototypeOf(e))throw e;this.FB64String=t.stream_nilval_b64string}},this.Create$2=function(e){return t.TSERTTKSessionStorageBase.Create$1.call(this),this.FStreamExtension=e,this.FStream=pas.Classes.TMemoryStream.$create("Create"),this.FB64String=t.stream_nilval_b64string,this.FDecodeString=t.stream_nilval_b64string,this.FHash64Src=t.stream_nilval_hash,this.FHash64Ret=t.stream_nilval_hash,this.FReloaded=!1,this.FExported=!1,this},this.Destroy=function(){rtl.free(this,"FStream"),this.FPayload=rtl.arraySetLength(this.FPayload,0,0),pas.System.TObject.Destroy.call(this)},this.InfoStreamFileName=function(){return t.zip_dir_nm_infostreams+this.IDRead()+"."+this.FStreamExtension},this.DataLoaded=function(){return this.FExported||this.FReloaded};var e=this.$rtti;e.addProperty("AHashBase64",3,rtl.string,"Hash64SrcGet","Hash64SrcSet"),e.addProperty("InfoStreamExtension",0,rtl.string,"FStreamExtension","FStreamExtension"),e.addProperty("DataBase64",3,rtl.string,"DataB64Read","DataB64Write")})),rtl.createClass(this,"TSESSessionStepInfoStream",this.TSESSessionStepLog,(function(){this.$init=function(){t.TSESSessionStepLog.$init.call(this),this.FInfoStream=null,this.FStreamRegistered=!1},this.$final=function(){this.FInfoStream=void 0,t.TSESSessionStepLog.$final.call(this)},this.InfoStreamIDGet=function(){return this.FInfoStream.IDRead()},this.InfoStreamIDSet=function(t){this.FInfoStream.IDWrite(t)},this.ReplaceInfoStream=function(t){null!==this.FInfoStream&&rtl.free(this,"FInfoStream"),this.FInfoStream=t,this.FStreamRegistered=!0},this.Create$3=function(e,i){return t.TSESSessionStepLog.Create$2.call(this,e,!0),this.FInfoStream=t.TSERTTKSessionInfoStream.$create("Create$2",[i]),this.FStreamRegistered=!1,this},this.Destroy=function(){this.FStreamRegistered||rtl.free(this,"FInfoStream"),pas.System.TObject.Destroy.call(this)},this.$rtti.addProperty("InfoStreamID",3,rtl.string,"InfoStreamIDGet","InfoStreamIDSet")})),rtl.createClass(this,"TSERTTKSessionInfoStreams",pas["Generics.Collections"].TObjectDictionary$G2,(function(){this.$init=function(){pas["Generics.Collections"].TObjectDictionary$G2.$init.call(this),this.FOwnerInterface=null},this.$final=function(){rtl.setIntfP(this,"FOwnerInterface",null),pas["Generics.Collections"].TObjectDictionary$G2.$final.call(this)},this.GetItemClass=function(){return t.TSERTTKSessionInfoStream},this._AddRef=function(){return null!==this.FOwnerInterface?this.FOwnerInterface._AddRef():-1},this._Release=function(){return null!==this.FOwnerInterface?this.FOwnerInterface._Release():-1},this.QueryInterface=function(t,e){return this.GetInterface(t,e)?0:-2147467262},rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCBaseListIO)})),rtl.createClass(this,"TSESSessionStepInfoTree",this.TSESSessionStepInfoStream,(function(){this.FilterWrite=function(t,e,i,s,o){(9===i||pas.SysUtils.TStringHelper.Contains.call({a:pas.SysUtils.TStringHelper.ToUpper.call({get:function(){return e},set:function(t){e=t}}),get:function(){return this.a},set:function(t){this.a=t}},"ICON"))&&o.set(!1)},this.Create$4=function(e){return t.TSESSessionStepInfoStream.Create$3.call(this,e,t.stream_fileext_json),this},this.CanSaveProperty=function(t,e,i,s,o){(9===s||pas.StrUtils.MatchText(i,pas["WEBLib.TMSFNCPersistence"].ExcludePropertyList)||pas.SysUtils.TStringHelper.Contains.call({a:pas.SysUtils.TStringHelper.ToUpper.call({get:function(){return i},set:function(t){i=t}}),get:function(){return this.a},set:function(t){this.a=t}},"ICON"))&&o.set(!1)},this.SaveFNCTree=function(t){var e=null;e=null!=pas["WEBLib.TMSFNCPersistence"].TTMSFNCPersistence.FOnCustomWriteProperty?pas["WEBLib.TMSFNCPersistence"].TTMSFNCPersistence.FOnCustomWriteProperty:null;try{pas["WEBLib.TMSFNCPersistence"].TTMSFNCPersistence.FOnCustomWriteProperty=rtl.createCallback(this,"FilterWrite"),t.SaveSettingsToStream(this.FInfoStream.FStream,!1),this.FInfoStream.FStream.SetPosition(0)}finally{pas["WEBLib.TMSFNCPersistence"].TTMSFNCPersistence.FOnCustomWriteProperty=e}}})),rtl.createClass(this,"TSESSessionStepInfoCSV",this.TSESSessionStepInfoStream,(function(){this.Create$4=function(e){return t.TSESSessionStepInfoStream.Create$3.call(this,e,t.stream_fileext_csv),this}})),rtl.createClass(this,"TSESScreenDiffInfo",pas.System.TObject,(function(){this.$init=function(){pas.System.TObject.$init.call(this),this.Score=0,this.Diffs=null},this.$final=function(){this.Diffs=void 0,pas.System.TObject.$final.call(this)},this.Destroy=function(){rtl.free(this,"Diffs"),pas.System.TObject.Destroy.call(this)}})),rtl.createClass(this,"TSEStepDiffAnalysis",pas.System.TObject,(function(){this.$init=function(){pas.System.TObject.$init.call(this),this.FScreenList=null},this.$final=function(){this.FScreenList=void 0,pas.System.TObject.$final.call(this)},this.Destroy=function(){rtl.free(this,"FScreenList"),pas.System.TObject.Destroy.call(this)},this.ScreenDiffInfo=function(t,e){return this.FScreenList.TryGetValue(t,e)}})),rtl.createClass(this,"TSESupSessionStepInfo",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FID=pas.System.TGuid.$new(),this.FClassType=""},this.$final=function(){this.FID=void 0,pas.Classes.TPersistent.$final.call(this)},this.GuidRead=function(){return pas.SysUtils.TGuidHelper.ToString.call(this.FID,!1)},this.GuidWrite=function(t){this.FID.$assign(pas.SysUtils.StringToGUID(t))},this.ClassTypeWrite=function(t){},this.Create$1=function(t,e){return this.FID.$assign(t),this.FClassType=e,this.ClassTypeWrite(e),this};var t=this.$rtti;t.addProperty("ID",3,rtl.string,"GuidRead","GuidWrite"),t.addProperty("ClassTypeName",2,rtl.string,"FClassType","ClassTypeWrite")})),rtl.createClass(this,"TSERTTKSessionStepInfos",pas["Generics.Collections"].TObjectList$G7,(function(){this.$init=function(){pas["Generics.Collections"].TObjectList$G7.$init.call(this),this.FOwnerInterface=null},this.$final=function(){rtl.setIntfP(this,"FOwnerInterface",null),pas["Generics.Collections"].TObjectList$G7.$final.call(this)},this.GetItemClass=function(){return t.TSESupSessionStepInfo},this._AddRef=function(){return null!==this.FOwnerInterface?this.FOwnerInterface._AddRef():-1},this._Release=function(){return null!==this.FOwnerInterface?this.FOwnerInterface._Release():-1},this.QueryInterface=function(t,e){return this.GetInterface(t,e)?0:-2147467262},rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCBaseListIO)})),rtl.createClass(this,"TSESupSessionManifest",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FStartTime=0,this.FEndTime=0,this.FStepInfos=null,this.FApplicationName=""},this.$final=function(){this.FStepInfos=void 0,pas.Classes.TPersistent.$final.call(this)},this.AddStep=function(e,i){var s;s=t.TSESupSessionStepInfo.$create("Create$1",[e,i]),this.FStepInfos.Add(s),this.UpdateEndTime()},this.Create$1=function(e){return this.FStartTime=pas.SysUtils.Now(),this.FApplicationName=e,this.FStepInfos=t.TSERTTKSessionStepInfos.$create("Create$4",[!0]),this.UpdateEndTime(),this},this.Destroy=function(){rtl.free(this,"FStepInfos"),pas.System.TObject.Destroy.call(this)},this.UpdateEndTime=function(){this.FEndTime=pas.SysUtils.Now()};var e=this.$rtti;e.addProperty("ApplicationName",0,rtl.string,"FApplicationName","FApplicationName"),e.addProperty("EndTime",0,pas.System.$rtti.TDateTime,"FEndTime","FEndTime"),e.addProperty("StartTime",0,pas.System.$rtti.TDateTime,"FStartTime","FStartTime"),e.addProperty("StepInfos",0,t.$rtti.TSERTTKSessionStepInfos,"FStepInfos","FStepInfos")})),rtl.createClass(this,"TSESupSessionInfo",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FStartTime=0,this.FApplicationName="",this.FVersion=0};var t=this.$rtti;t.addProperty("Version",0,rtl.longint,"FVersion","FVersion"),t.addProperty("StartTime",0,pas.System.$rtti.TDateTime,"FStartTime","FStartTime"),t.addProperty("ApplicationName",0,rtl.string,"FApplicationName","FApplicationName")})),rtl.createClass(this,"TSERTTKSessionStorageBitmap",this.TSERTTKSessionStorageBase,(function(){this.$init=function(){t.TSERTTKSessionStorageBase.$init.call(this),this.FBitmap=null},this.$final=function(){this.FBitmap=void 0,t.TSERTTKSessionStorageBase.$final.call(this)},this.Create$2=function(e){return t.TSERTTKSessionStorageBase.Create$1.call(this),this.FBitmap=null===e?pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.$create("Create$3"):e,this},this.Destroy=function(){null!==this.FBitmap&&rtl.free(this,"FBitmap"),pas.System.TObject.Destroy.call(this)},this.$rtti.addProperty("Bitmap",0,pas["WEBLib.TMSFNCTypes"].$rtti.TTMSFNCBitmap,"FBitmap","FBitmap")})),rtl.createClass(this,"TSERTTKSessionBitmaps",pas["Generics.Collections"].TObjectDictionary$G4,(function(){this.$init=function(){pas["Generics.Collections"].TObjectDictionary$G4.$init.call(this),this.FOwnerInterface=null},this.$final=function(){rtl.setIntfP(this,"FOwnerInterface",null),pas["Generics.Collections"].TObjectDictionary$G4.$final.call(this)},this.GetItemClass=function(){return t.TSERTTKSessionStorageBitmap},this._AddRef=function(){return null!==this.FOwnerInterface?this.FOwnerInterface._AddRef():-1},this._Release=function(){return null!==this.FOwnerInterface?this.FOwnerInterface._Release():-1},this.QueryInterface=function(t,e){return this.GetInterface(t,e)?0:-2147467262},rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCBaseListIO)})),rtl.createClass(this,"TSERTTKSessionSteps",pas["Generics.Collections"].TObjectDictionary$G5,(function(){this.$init=function(){pas["Generics.Collections"].TObjectDictionary$G5.$init.call(this),this.FOwnerInterface=null},this.$final=function(){rtl.setIntfP(this,"FOwnerInterface",null),pas["Generics.Collections"].TObjectDictionary$G5.$final.call(this)},this.GetItemClass=function(){return t.TSESSessionStepLog},this._AddRef=function(){return null!==this.FOwnerInterface?this.FOwnerInterface._AddRef():-1},this._Release=function(){return null!==this.FOwnerInterface?this.FOwnerInterface._Release():-1},this.QueryInterface=function(t,e){return this.GetInterface(t,e)?0:-2147467262},rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCBaseListIO)})),rtl.createClass(this,"TSERTTKSessionStorageMemory",pas.Classes.TInterfacedPersistent,(function(){this.$init=function(){pas.Classes.TInterfacedPersistent.$init.call(this),this.FSteps=null,this.FBitmaps=null,this.FInfoStreams=null,this.FManifest=null,this.FEvents=null},this.$final=function(){this.FSteps=void 0,this.FBitmaps=void 0,this.FInfoStreams=void 0,this.FManifest=void 0,this.FEvents=void 0,pas.Classes.TInterfacedPersistent.$final.call(this)},this.ApplicationNameGet=function(){return this.FManifest.FApplicationName},this.StartTimeGet=function(){return this.FManifest.FStartTime},this.CreateObject=function(e,i){var s=null,o=pas.System.TGuid.$new(),n=rtl.createIntfRefs();try{s=null,n.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("Create Object class = "+e+" base class = "+i.$classname,this),"TTMSFNCBitmap"===e?s=pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.$create("Create$3"):"TSERTTKSessionStorageBitmap"===e?s=t.TSERTTKSessionStorageBitmap.$create("Create$2",[null]):"TSESSessionStepLog"===e?s=t.TSESSessionStepLog.$create("Create$2",["",!0]):"TSESSessionStepInspector"===e?s=t.TSESSessionStepInspector.$create("Create$3",["",!0]):"TSESSessionBookmark"===e?s=t.TSESSessionBookmark.$create("Create$3",[""]):"TSESSessionScreenDiff"===e?s=t.TSESSessionScreenDiff.$create("Create$1",[""]):"TSERTTKSessionScreenDiffs"===e?s=t.TSERTTKSessionScreenDiffs.$create("Create$4",[!0]):"TSESSessionScreenShot"===e?s=t.TSESSessionScreenShot.$create("Create$3",["","",!0]):"TSESSessionCompExport"===e?s=t.TSESSessionCompExport.$create("Create$2",["",!0]):"TSESSessionStepInfoTree"===e?s=t.TSESSessionStepInfoTree.$create("Create$4",[""]):"TSESSessionStepInfoCSV"===e?s=t.TSESSessionStepInfoCSV.$create("Create$4",[""]):"TSESupSessionStepInfo"===e?s=t.TSESupSessionStepInfo.$create("Create$1",[o,""]):"TSESSessionStepBitmap"===e?s=t.TSESSessionStepBitmap.$create("Create$3",["",!1]):"TSERTTKSessionInfoStream"===e?s=t.TSERTTKSessionInfoStream.$create("Create$2",["rest"]):"TSESSessionStepInfoStream"===e?s=t.TSESSessionStepInfoStream.$create("Create$3",["","rest"]):n.ref(2,pas["WebLib.SEFNC.Logger"].Logger()).Warn$1("Unknown class on JSON restore class = "+e+" Base="+i.$classname,this)}finally{n.free()}return s},this.Create$1=function(e){var i=null;return this.FManifest=t.TSESupSessionManifest.$create("Create$1",[e]),this.FSteps=t.TSERTTKSessionSteps.$create("Create$5",[rtl.createSet(1)]),this.FInfoStreams=t.TSERTTKSessionInfoStreams.$create("Create$5",[rtl.createSet(1)]),i=t.TSESSessionStepLog.$create("Create$2",["Memory store ready",!0]),this.FSteps.Add(i.IDRead(),i),this.FBitmaps=t.TSERTTKSessionBitmaps.$create("Create$5",[rtl.createSet(1)]),this.FEvents=pas.Classes.TStringList.$create("Create$1"),this},this.Destroy=function(){rtl.free(this,"FBitmaps"),rtl.free(this,"FSteps"),rtl.free(this,"FManifest"),rtl.free(this,"FEvents"),rtl.free(this,"FInfoStreams"),pas.System.TObject.Destroy.call(this)},this.AddSessionStep=function(e){var i=rtl.createIntfRefs();try{this.FSteps.Add(e.IDRead(),e),this.FManifest.AddStep(e.FID,e.$classname),this.FEvents.Add(e.IDRead()),t.TSESSessionStepInfoStream.isPrototypeOf(e)&&(this.AddInfoStream(e.FInfoStream)?e.FStreamRegistered=!0:i.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Error$1("Stream not correctly registred in session memory",this))}finally{i.free()}},this.BitmapByGuid=function(t,e){var i,s=null;return(i=this.FBitmaps.TryGetValue(pas.SysUtils.TGuidHelper.ToString.call(t,!1),{get:function(){return s},set:function(t){s=t}}))&&e.set(s.FBitmap),i},this.SaveToFile=function(t){var e=rtl.createIntfRefs();try{e.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("Begin save memory to JSON",this),this.FManifest.UpdateEndTime();try{pas["WEBLib.TMSFNCTypes"].TTMSFNCObjectHelper.SaveToJSONFile.call(this,t),e.ref(2,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("End save memory to JSON",this)}catch(t){if(pas.SysUtils.Exception.isPrototypeOf(t)){var i=t;e.ref(3,pas["WebLib.SEFNC.Logger"].Logger()).Trace$2("Save to JSON failed",i,this)}else e.ref(4,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("Save to JSON failed - js:"+t,this)}}finally{e.free()}},this.AddInfoStream=function(t){return!0,t.PrepareExportBase64(),this.FInfoStreams.Add(t.IDRead(),t),!0},this.LoadStepInfoStream=function(t){var e=!1,i=null,s=rtl.createIntfRefs();try{(e=this.FInfoStreams.TryGetValue(t.InfoStreamIDGet(),{get:function(){return i},set:function(t){i=t}}))?t.ReplaceInfoStream(i):s.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Warn$1("Could not load step stream from Memory "+t.InfoStreamIDGet(),this)}finally{s.free()}return e},rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCBasePersistenceIO),rtl.addIntf(this,pas.System.IUnknown);var e=this.$rtti;e.addProperty("Manifest",0,t.$rtti.TSESupSessionManifest,"FManifest",""),e.addProperty("Bitmaps",0,t.$rtti.TSERTTKSessionBitmaps,"FBitmaps","FBitmaps"),e.addProperty("InfoStreams",0,t.$rtti.TSERTTKSessionInfoStreams,"FInfoStreams","FInfoStreams"),e.addProperty("Steps",0,t.$rtti.TSERTTKSessionSteps,"FSteps","FSteps"),e.addProperty("Events",0,pas.Classes.$rtti.TStringList,"FEvents","FEvents")})),rtl.createClass(this,"TSESSession",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FStepDiffAnalysis=null,this.FStorePersist=!1,this.FStorageMemory=null},this.$final=function(){this.FStepDiffAnalysis=void 0,this.FStorageMemory=void 0,pas.Classes.TPersistent.$final.call(this)},this.CreateCommon=function(t){this.FStepDiffAnalysis=pas["Generics.Collections"].TObjectDictionary$G6.$create("Create$5",[rtl.createSet(1)])},this.SessionStepsGet=function(){return this.FStorageMemory.FSteps},this.EventsGet=function(){return this.FStorageMemory.FEvents},this.ApplicationNameGet=function(){return null!==this.FStorageMemory?this.FStorageMemory.ApplicationNameGet():"Name unset in Manifest"},this.RegisterJSONDependency=function(){pas.Classes.RegisterClass(t.TSESSessionStepBase),pas.Classes.RegisterClass(t.TSESSessionStepLog),pas.Classes.RegisterClass(t.TSESSessionStepInspector),pas.Classes.RegisterClass(t.TSESSessionScreenDiff),pas.Classes.RegisterClass(t.TSESSessionScreenShot),pas.Classes.RegisterClass(t.TSESupSessionStepInfo),pas.Classes.RegisterClass(t.TSESupSessionInfo),pas.Classes.RegisterClass(t.TSESupSessionManifest),pas.Classes.RegisterClass(t.TSESSessionCompExport),pas.Classes.RegisterClass(t.TSESSessionStepBitmap),pas.Classes.RegisterClass(t.TSERTTKSessionInfoStream),pas.Classes.RegisterClass(t.TSESSessionStepInfoStream),pas.Classes.RegisterClass(t.TSESSessionStepInfoTree),pas.Classes.RegisterClass(t.TSESSessionStepInfoCSV),pas.Classes.RegisterClass(t.TSESSessionBookmark),pas.Classes.RegisterClass(t.TSERTTKSessionStorageMemory),pas.Classes.RegisterClass(t.TSERTTKSessionStorageBitmap),pas.Classes.RegisterClass(pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap)},this.StepAdd=function(t){if(null==t)throw pas.SysUtils.Exception.$create("Create$1",["Step not assigned, unable to add"]);this.FStorageMemory.AddSessionStep(t)},this.AddBookmark=function(t){this.StepAdd(t)},this.AddStep=function(e,i){this.StepAdd(t.TSESSessionStepLog.$create("Create$2",[e,i]))},this.SessionJsonFileName=function(){return"RTM."+this.ApplicationNameGet()+"."+pas.SysUtils.FormatDateTime(t.file_dt_fmt,this.FStorageMemory.StartTimeGet())+t.file_ext_session_json},this.SessionJSONSaveToFile=function(t){this.$class.RegisterJSONDependency(),null!=this.FStorageMemory&&this.FStorageMemory.SaveToFile(t)},this.Create$1=function(e,i,s){return this.FStorageMemory=t.TSERTTKSessionStorageMemory.$create("Create$1",[e]),this.CreateCommon(!0),this.$class.RegisterJSONDependency(),this.FStorePersist=i,this.AddStep("Session started",!0),this},this.Destroy=function(){rtl.free(this,"FStepDiffAnalysis"),rtl.free(this,"FStorageMemory"),pas.System.TObject.Destroy.call(this)},this.BitmapByGuid=function(t,e){var i=null;return this.FStorageMemory.BitmapByGuid(t,{get:function(){return i},set:function(t){i=t}})?(e.set(i),!0):!1},this.InfoStreamByStep=function(t){var e=!1,i=rtl.createIntfRefs();try{(e=this.FStorageMemory.LoadStepInfoStream(t))?i.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Debug$1("Memory returned info stream",this):(i.ref(2,pas["WebLib.SEFNC.Logger"].Logger()).Warn$1("Store is not persisted - info stream",this),e=!1),e&&t.FInfoStream.FStream.SetPosition(0)}finally{i.free()}return e},this.StepDiffAnalysis=function(t,e){return!1!==this.FStorePersist&&this.FStepDiffAnalysis.TryGetValue(t,e)}})),t.$implcode=function(){e.E_NOINTERFACE=2147500034}}),["DateUtils","StrUtils","WEBLib.TMSFNCUtils","WebLib.SEFNC.Logger","WEBLib.Crypto","JS","IOUtils","NetEncoding"]),rtl.module("WEBLib.TMSFNCColorPicker",["System","Classes","WEBLib.TMSFNCCustomPicker","WEBLib.Controls","WEBLib.TMSFNCColorSelector","WEBLib.TMSFNCCustomSelector","WEBLib.TMSFNCGraphics","WEBLib.TMSFNCTypes","WEBLib.TMSFNCGraphicsTypes","Types"],(function(){"use strict";var t=this;this.MAJ_VER=1,this.MIN_VER=0,this.REL_VER=0,this.BLD_VER=1,rtl.createClass(this,"TTMSFNCColorSelectorEx",pas["WEBLib.TMSFNCColorSelector"].TTMSFNCColorSelector,(function(){this.$init=function(){pas["WEBLib.TMSFNCColorSelector"].TTMSFNCColorSelector.$init.call(this),this.FPicker=null},this.$final=function(){this.FPicker=void 0,pas["WEBLib.TMSFNCColorSelector"].TTMSFNCColorSelector.$final.call(this)},this.WrapperSizeChanged=function(t,e){var i=pas["WEBLib.TMSFNCTypes"].TSizeF.$new();pas["WEBLib.TMSFNCColorSelector"].TTMSFNCCustomColorSelector.WrapperSizeChanged.apply(this,arguments),null!=this.FPicker&&(this.FPicker.SetDropDownHeight(e),this.FPicker.SetDropDownWidth(t),i.cx=t,i.cy=e,this.FPicker.GetPopup().SetPopupFormSize(i),this.SetWidth(this.GetWidth()+1),this.SetWidth(this.GetWidth()-1))},this.Create$1=function(e){return pas["WEBLib.TMSFNCColorSelector"].TTMSFNCCustomColorSelector.Create$1.apply(this,arguments),null!=e&&t.TTMSFNCCustomColorPicker.isPrototypeOf(e)&&(this.FPicker=rtl.as(e,t.TTMSFNCCustomColorPicker)),this},rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas["WEBLib.TMSFNCTypes"].ITMSFNCProductInfo),rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TTMSFNCCustomColorPicker",pas["WEBLib.TMSFNCCustomPicker"].TTMSFNCDefaultPicker,(function(){this.$init=function(){pas["WEBLib.TMSFNCCustomPicker"].TTMSFNCDefaultPicker.$init.call(this),this.FColorSelector=null,this.FOnColorSelected=null,this.FCloseOnSelection=!1,this.FOnColorDeselected=null},this.$final=function(){this.FColorSelector=void 0,this.FOnColorSelected=void 0,this.FOnColorDeselected=void 0,pas["WEBLib.TMSFNCCustomPicker"].TTMSFNCDefaultPicker.$final.call(this)},this.GetSelectedColor=function(){return this.FColorSelector.GetSelectedColor()},this.SetSelectedColor=function(t){this.FColorSelector.SetSelectedColor(t),this.Invalidate()},this.GetItems$1=function(){return this.FColorSelector.GetItems()},this.SetItems$1=function(t){this.FColorSelector.GetItems().Assign(t)},this.GetMode=function(){return this.FColorSelector.FMode},this.SetMode=function(t){this.FColorSelector.SetMode(t);var e=this.GetMode();0===e?(this.SetDropDownWidth(135),this.SetDropDownHeight(135)):1===e?(this.SetDropDownWidth(200),this.SetDropDownHeight(135)):2===e&&(this.SetDropDownWidth(200),this.SetDropDownHeight(175))},this.DoColorSelected=function(){null!=this.FOnColorSelected&&this.FOnColorSelected(this,this.GetSelectedColor()),this.Invalidate()},this.ColorSelected=function(t,e){this.FCloseOnSelection&&!this.GetSelector().FBlockChange&&this.DropDown(),null!=this.FOnColorSelected&&this.FOnColorSelected(this,e),this.Invalidate()},this.ColorDeselected=function(t,e){null!=this.FOnColorDeselected&&this.FOnColorDeselected(this,e),this.Invalidate()},this.DrawContent=function(t,e){var i,s=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),o=0,n=0;s.$assign(e),pas["WEBLib.TMSFNCTypes"].InflateRectEx(s,this.ScalePaintValue$1(-3),this.ScalePaintValue$1(-4)),pas["WEBLib.TMSFNCTypes"].OffsetRectEx$1(s,this.ScalePaintValue$1(1),.5),i=t.SaveState(!1);try{t.ClipRect(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(s)),t.FStroke.SetKind(0),t.FFill.SetKind(1),t.FStroke.SetWidth(1),t.FFill.SetColor(pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(255,255,255)),t.DrawRectangle$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(s),2),t.FFill.SetColor(pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(211,211,211));for(var r=0,a=pas.System.Trunc((s.Right-s.Left)/5)+1;r<=a;r++){o=r;for(var l=0,h=pas.System.Trunc((s.Bottom-s.Top)/5)+1;l<=h;l++)n=l,pas.System.Odd(o+n)&&t.DrawRectangle$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(5*o,5*n,5*(o+1),5*(n+1))),0)}t.FFill.SetKind(1),t.FFill.SetColor(this.GetSelectedColor()),t.FStroke.SetColor(0),t.FStroke.SetKind(1),t.DrawRectangle$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(s),2)}finally{t.RestoreState(i,!1)}},this.SelectFirstValue=function(){pas["WEBLib.TMSFNCCustomPicker"].TTMSFNCCustomPicker.SelectFirstValue.call(this),this.FColorSelector.GetItems().GetCount()>0&&(this.FColorSelector.SetSelectedItemIndex(0),this.DoColorSelected())},this.SelectLastValue=function(){pas["WEBLib.TMSFNCCustomPicker"].TTMSFNCCustomPicker.SelectLastValue.call(this),this.FColorSelector.GetItems().GetCount()>0&&(this.FColorSelector.SetSelectedItemIndex(this.FColorSelector.GetItems().GetCount()-1),this.DoColorSelected())},this.SelectNextValue=function(){pas["WEBLib.TMSFNCCustomPicker"].TTMSFNCCustomPicker.SelectNextValue.call(this),this.FColorSelector.GetItems().GetCount()>0&&(-1===this.FColorSelector.FSelectedItemIndex?this.FColorSelector.SetSelectedItemIndex(0):this.FColorSelector.SetSelectedItemIndex(Math.min(this.FColorSelector.GetItems().GetCount()-1,this.FColorSelector.FSelectedItemIndex+1)),this.DoColorSelected())},this.SelectPreviousValue=function(){pas["WEBLib.TMSFNCCustomPicker"].TTMSFNCCustomPicker.SelectPreviousValue.call(this),this.FColorSelector.GetItems().GetCount()>0&&(-1===this.FColorSelector.FSelectedItemIndex?this.FColorSelector.SetSelectedItemIndex(0):this.FColorSelector.SetSelectedItemIndex(Math.max(0,this.FColorSelector.FSelectedItemIndex-1)),this.DoColorSelected())},this.GetVersion=function(){return this.$class.GetVersionNumber(1,0,0,1)},this.CreateSelector=function(){return this.FColorSelector=t.TTMSFNCColorSelectorEx.$create("Create$1",[this]),this.FColorSelector.FOnColorSelected=rtl.createCallback(this,"ColorSelected"),this.FColorSelector.FOnColorDeselected=rtl.createCallback(this,"ColorDeselected"),this.FColorSelector.InitializeDefault(),this.FColorSelector},this.GetFocusedControl=function(){return this.FColorSelector},this.Create$1=function(t){return pas["WEBLib.TMSFNCCustomPicker"].TTMSFNCCustomPicker.Create$1.apply(this,arguments),this.FCloseOnSelection=!0,this},rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas["WEBLib.TMSFNCTypes"].ITMSFNCProductInfo),rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TTMSFNCColorPicker",this.TTMSFNCCustomColorPicker,(function(){this.RegisterRuntimeClasses=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.RegisterRuntimeClasses.call(this),pas.Classes.RegisterClass(t.TTMSFNCColorPicker)},rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas["WEBLib.TMSFNCTypes"].ITMSFNCProductInfo),rtl.addIntf(this,pas.System.IUnknown);var e=this.$rtti;e.addProperty("DropDownWidth",14,rtl.double,"FDropDownWidth","SetDropDownWidth",{stored:"IsDropDownWidthStored"}),e.addProperty("DropDownHeight",14,rtl.double,"FDropDownHeight","SetDropDownHeight",{stored:"IsDropDownHeightStored"}),e.addProperty("Appearance",3,pas["WEBLib.TMSFNCCustomSelector"].$rtti.TTMSFNCCustomSelectorAppearance,"GetAppearance","SetAppearance"),e.addProperty("Rows",3,rtl.longint,"GetRows","SetRows",{Default:4}),e.addProperty("Columns",3,rtl.longint,"GetColumns","SetColumns",{Default:4}),e.addProperty("Items",3,pas["WEBLib.TMSFNCColorSelector"].$rtti.TTMSFNCColorSelectorItems,"GetItems$1","SetItems$1"),e.addProperty("Mode",3,pas["WEBLib.TMSFNCColorSelector"].$rtti.TTMSFNCCustomColorSelectorMode,"GetMode","SetMode",{Default:pas["WEBLib.TMSFNCColorSelector"].TTMSFNCCustomColorSelectorMode.csmSimple}),e.addProperty("CloseOnSelection",0,rtl.boolean,"FCloseOnSelection","FCloseOnSelection",{Default:!0}),e.addProperty("OnColorSelected",0,pas["WEBLib.TMSFNCColorSelector"].$rtti.TTMSFNCCustomSelectorColorSelected,"FOnColorSelected","FOnColorSelected"),e.addProperty("OnColorDeselected",0,pas["WEBLib.TMSFNCColorSelector"].$rtti.TTMSFNCCustomSelectorColorDeselected,"FOnColorDeselected","FOnColorDeselected"),e.addProperty("SelectedColor",3,pas["WEBLib.Graphics"].$rtti.TColor,"GetSelectedColor","SetSelectedColor",{Default:-1}),e.addProperty("OnItemSelected",0,pas["WEBLib.TMSFNCCustomSelector"].$rtti.TTMSFNCCustomSelectorItemSelected,"FOnItemSelected","FOnItemSelected"),e.addProperty("OnItemDeselected",0,pas["WEBLib.TMSFNCCustomSelector"].$rtti.TTMSFNCCustomSelectorItemDeselected,"FOnItemDeselected","FOnItemDeselected"),e.addProperty("OnItemClick",0,pas["WEBLib.TMSFNCCustomSelector"].$rtti.TTMSFNCCustomSelectorItemClick,"FOnItemClick","FOnItemClick"),e.addProperty("SelectedItemIndex",3,rtl.longint,"GetSelectedItemIndex","SetSelectedItemIndex",{Default:-1}),e.addProperty("OnPickerBeforeDraw",0,pas["WEBLib.TMSFNCCustomPicker"].$rtti.TTMSFNCCustomPickerBeforeDraw,"FOnPickerBeforeDraw","FOnPickerBeforeDraw"),e.addProperty("OnPickerAfterDraw",0,pas["WEBLib.TMSFNCCustomPicker"].$rtti.TTMSFNCCustomPickerAfterDraw,"FOnPickerAfterDraw","FOnPickerAfterDraw"),e.addProperty("OnItemBeforeDrawBackground",0,pas["WEBLib.TMSFNCCustomSelector"].$rtti.TTMSFNCCustomSelectorItemBeforeDrawBackground,"FOnItemBeforeDrawBackground","FOnItemBeforeDrawBackground"),e.addProperty("OnItemAfterDrawBackground",0,pas["WEBLib.TMSFNCCustomSelector"].$rtti.TTMSFNCCustomSelectorItemAfterDrawBackground,"FOnItemAfterDrawBackground","FOnItemAfterDrawBackground"),e.addProperty("OnItemBeforeDrawContent",0,pas["WEBLib.TMSFNCCustomSelector"].$rtti.TTMSFNCCustomSelectorItemBeforeDrawContent,"FOnItemBeforeDrawContent","FOnItemBeforeDrawContent"),e.addProperty("OnItemAfterDrawContent",0,pas["WEBLib.TMSFNCCustomSelector"].$rtti.TTMSFNCCustomSelectorItemAfterDrawContent,"FOnItemAfterDrawContent","FOnItemAfterDrawContent"),e.addProperty("OnBeforeDraw",0,pas["WEBLib.TMSFNCCustomSelector"].$rtti.TTMSFNCCustomSelectorBeforeDraw,"FOnBeforeDraw$1","FOnBeforeDraw$1"),e.addProperty("OnAfterDraw",0,pas["WEBLib.TMSFNCCustomSelector"].$rtti.TTMSFNCCustomSelectorAfterDraw,"FOnAfterDraw$1","FOnAfterDraw$1"),e.addProperty("OnItemBeforeDrawText",0,pas["WEBLib.TMSFNCCustomSelector"].$rtti.TTMSFNCCustomSelectorItemBeforeDrawText,"FOnItemBeforeDrawText","FOnItemBeforeDrawText"),e.addProperty("OnItemAfterDrawText",0,pas["WEBLib.TMSFNCCustomSelector"].$rtti.TTMSFNCCustomSelectorItemAfterDrawText,"FOnItemAfterDrawText","FOnItemAfterDrawText"),e.attr=[pas.Classes.ComponentPlatformsAttribute,"Create$1",[0]]}))}),["Math","WEBLib.TMSFNCUtils"]),rtl.module("WEBLib.TMSFNCGridCell",["System","Classes","WEBLib.TMSFNCGraphics","WEBLib.TMSFNCBitmapContainer","WEBLib.TMSFNCTypes","WEBLib.Controls","WEBLib.TMSFNCGraphicsTypes"],(function(){"use strict";var t=this;this.TTMSFNCGridNodeState={0:"nsClosed",nsClosed:0,1:"nsOpen",nsOpen:1},this.$rtti.$Enum("TTMSFNCGridNodeState",{minvalue:0,maxvalue:1,ordtype:1,enumtype:this.TTMSFNCGridNodeState}),this.TTMSFNCGridSortKind={0:"skNone",skNone:0,1:"skAscending",skAscending:1,2:"skDescending",skDescending:2},this.$rtti.$Enum("TTMSFNCGridSortKind",{minvalue:0,maxvalue:2,ordtype:1,enumtype:this.TTMSFNCGridSortKind}),rtl.createClass(this,"TTMSFNCGridCellLayout",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FSides={},this.FFill=null,this.FStroke=null,this.FVerticalTextAlign=0,this.FFont=null,this.FTextAlign=0,this.FWordWrapping=!1,this.FOnChange=null},this.$final=function(){this.FSides=void 0,this.FFill=void 0,this.FStroke=void 0,this.FFont=void 0,this.FOnChange=void 0,pas.Classes.TPersistent.$final.call(this)},this.SetFill=function(t){this.FFill!==t&&(this.FFill.Assign(t),this.Changed())},this.SetSides=function(t){rtl.neSet(this.FSides,t)&&(this.FSides=rtl.refSet(t),this.Changed())},this.SetStroke=function(t){this.FStroke!==t&&(this.FStroke.Assign(t),this.Changed())},this.SetFont=function(t){this.FFont!==t&&(this.FFont.Assign(t),this.Changed())},this.SetTextAlign=function(t){this.FTextAlign!==t&&(this.FTextAlign=t,this.Changed())},this.SetVerticalTextAlign=function(t){this.FVerticalTextAlign!==t&&(this.FVerticalTextAlign=t,this.Changed())},this.SetWordWrapping=function(t){this.FWordWrapping!==t&&(this.FWordWrapping=t,this.Changed())},this.Changed=function(){null!=this.FOnChange&&this.FOnChange(this)},this.FillChanged=function(t){this.Changed()},this.FontChanged=function(t){this.Changed()},this.StrokeChanged=function(t){this.Changed()},this.Create$1=function(){return this.FFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[1,16777215,8421504,-1,-1]),this.FFill.SetKind(1),this.FFill.SetColor(16777215),this.FFill.FOnChanged=rtl.createCallback(this,"FillChanged"),this.FStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,12632256]),this.FStroke.SetKind(1),this.FStroke.SetColor(12632256),this.FStroke.FOnChanged=rtl.createCallback(this,"StrokeChanged"),this.FSides=rtl.createSet(0,1,2,3),this.FFont=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFont.$create("Create$2"),this.FFont.FOnChanged=rtl.createCallback(this,"FontChanged"),this.FTextAlign=1,this.FVerticalTextAlign=0,this.FWordWrapping=!1,this},this.Destroy=function(){rtl.free(this,"FFont"),rtl.free(this,"FFill"),rtl.free(this,"FStroke"),pas.System.TObject.Destroy.call(this)},this.Assign=function(e){t.TTMSFNCGridCellLayout.isPrototypeOf(e)&&(this.FFill.Assign(rtl.as(e,t.TTMSFNCGridCellLayout).FFill),this.FStroke.Assign(rtl.as(e,t.TTMSFNCGridCellLayout).FStroke),this.FSides=rtl.refSet(rtl.as(e,t.TTMSFNCGridCellLayout).FSides),this.FFont.Assign(rtl.as(e,t.TTMSFNCGridCellLayout).FFont),this.FTextAlign=rtl.as(e,t.TTMSFNCGridCellLayout).FTextAlign,this.FVerticalTextAlign=rtl.as(e,t.TTMSFNCGridCellLayout).FVerticalTextAlign,this.FWordWrapping=rtl.as(e,t.TTMSFNCGridCellLayout).FWordWrapping)};var e=this.$rtti;e.addProperty("Sides",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsSides,"FSides","SetSides",{Default:rtl.createSet(0,1,2,3)}),e.addProperty("Fill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FFill","SetFill"),e.addProperty("Stroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FStroke","SetStroke"),e.addProperty("Font",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFont,"FFont","SetFont"),e.addProperty("TextAlign",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsTextAlign,"FTextAlign","SetTextAlign",{Default:pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsTextAlign.gtaLeading}),e.addProperty("VerticalTextAlign",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsTextAlign,"FVerticalTextAlign","SetVerticalTextAlign",{Default:pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsTextAlign.gtaCenter}),e.addProperty("WordWrapping",2,rtl.boolean,"FWordWrapping","SetWordWrapping",{Default:!1}),e.addProperty("OnChange",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnChange","FOnChange")})),rtl.createClass(this,"TTMSFNCGridCellProgressLayout",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FTextColor=0,this.FColor=0,this.FFormat="",this.FOnChange=null,this.FShowText=!1},this.$final=function(){this.FOnChange=void 0,pas.Classes.TPersistent.$final.call(this)},this.SetColor=function(t){this.FColor!==t&&(this.FColor=t,this.Changed())},this.SetTextColor=function(t){this.FTextColor!==t&&(this.FTextColor=t,this.Changed())},this.SetFormat=function(t){this.FFormat!==t&&(this.FFormat=t,this.Changed())},this.SetShowText=function(t){this.FShowText!==t&&(this.FShowText=t,this.Changed())},this.Changed=function(){null!=this.FOnChange&&this.FOnChange(this)},this.Create$1=function(){return this.FTextColor=0,this.FColor=3329434,this.FFormat="%.0f%%",this.FShowText=!0,this},this.Assign=function(e){t.TTMSFNCGridCellProgressLayout.isPrototypeOf(e)&&(this.FColor=rtl.as(e,t.TTMSFNCGridCellProgressLayout).FColor,this.FTextColor=rtl.as(e,t.TTMSFNCGridCellProgressLayout).FTextColor,this.FFormat=rtl.as(e,t.TTMSFNCGridCellProgressLayout).FFormat,this.FShowText=rtl.as(e,t.TTMSFNCGridCellProgressLayout).FShowText)};var e=this.$rtti;e.addProperty("Color",2,pas["WEBLib.Graphics"].$rtti.TColor,"FColor","SetColor",{Default:3329434}),e.addProperty("TextColor",2,pas["WEBLib.Graphics"].$rtti.TColor,"FTextColor","SetTextColor",{Default:0}),e.addProperty("Format",2,rtl.string,"FFormat","SetFormat"),e.addProperty("ShowText",2,rtl.boolean,"FShowText","SetShowText",{Default:!0}),e.addProperty("OnChange",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnChange","FOnChange")})),this.TTMSFNCGridCellControlPosition={0:"gcpLeft",gcpLeft:0,1:"gcpTop",gcpTop:1,2:"gcpRight",gcpRight:2,3:"gcpBottom",gcpBottom:3},rtl.createClass(this,"TTMSFNCGridCell",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FOwner=null,this.FText="",this.FLayout=null,this.FBitmapContainer=null,this.FDisplayHTMLFormatting=!1,this.FWidth=0,this.FHeight=0,this.FTop=0,this.FLeft=0,this.FControlBitmap=null,this.FControlEnabled=!1,this.FOnBeforeDraw=null,this.FOnAfterDraw=null,this.FOnControlClick=null,this.FControlStretched=!1,this.FControlPosition=0,this.FOptimizedHTMLDrawing=!1,this.FScaleFactor=0,this.FAngle=0},this.$final=function(){this.FOwner=void 0,this.FLayout=void 0,this.FBitmapContainer=void 0,this.FControlBitmap=void 0,this.FOnBeforeDraw=void 0,this.FOnAfterDraw=void 0,this.FOnControlClick=void 0,pas.Classes.TPersistent.$final.call(this)},this.SetText=function(t){this.FText!==t&&(this.FText=t)},this.SetLayout=function(t){this.FLayout.Assign(t)},this.SetDisplayHTMLFormatting=function(t){this.FDisplayHTMLFormatting!==t&&(this.FDisplayHTMLFormatting=t)},this.SetHeight=function(t){this.FHeight!==t&&(this.FHeight=t)},this.SetWidth=function(t){this.FWidth!==t&&(this.FWidth=t)},this.SetLeft=function(t){this.FLeft!==t&&(this.FLeft=t)},this.SetTop=function(t){this.FTop!==t&&(this.FTop=t)},this.SetControlBitmap=function(t){this.FControlBitmap!==t&&(this.FControlBitmap=t)},this.GetControlBitmap=function(){return this.FControlBitmap},this.SetControlEnabled=function(t){this.FControlEnabled!==t&&(this.FControlEnabled=t)},this.SetAngle=function(t){this.FAngle!==t&&(this.FAngle=t)},this.Changed=function(t){},this.DoControlClick=function(t){null!=this.FOnControlClick&&this.FOnControlClick(this)},this.HandleControlMouseDown=function(t,e,i,s){},this.HandleControlMouseUp=function(t,e,i,s){this.DoControlClick(this)},this.HandleControlMouseMove=function(t,e,i,s){},this.DoBeforeDraw=function(t,e,i,s,o,n,r){null!=this.FOnBeforeDraw&&this.FOnBeforeDraw(this,t,e,i,s,o,n,r)},this.DoAfterDraw=function(t,e,i){null!=this.FOnAfterDraw&&this.FOnAfterDraw(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i))},this.IsHTML=function(){return!this.FDisplayHTMLFormatting&&(pas.System.Pos("</",this.FText)>0||pas.System.Pos("/>",this.FText)>0||pas.System.Pos("<BR>",pas.SysUtils.UpperCase(this.FText))>0)},this.GetTextWidth=function(){var t,e=0,i=null,s=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),o=pas["WEBLib.TMSFNCTypes"].TRectF.$new();if(e=0,""!==(t=this.FText)){(i=pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.$create("CreateBitmapCanvas",[1,1,!1,!0])).BeginScene(),i.FOptimizedHTMLDrawing=this.FOptimizedHTMLDrawing,i.FBitmapContainer=this.FBitmapContainer;try{i.SetFont(this.FLayout.FFont),s.$assign(this.GetTextRect(!1)),o.$assign(i.CalculateText(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(s),this.FLayout.FWordWrapping,!0)),e=90===Math.abs(this.FAngle)?o.Bottom-o.Top:o.Right-o.Left}finally{i.EndScene(),i=rtl.freeLoc(i)}}return e},this.GetTextHeight=function(){var t,e=0,i=null,s=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),o=pas["WEBLib.TMSFNCTypes"].TRectF.$new();if(e=0,""!==(t=this.FText)){(i=pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.$create("CreateBitmapCanvas",[1,1,!1,!0])).BeginScene(),i.FOptimizedHTMLDrawing=this.FOptimizedHTMLDrawing,i.FBitmapContainer=this.FBitmapContainer;try{i.SetFont(this.FLayout.FFont),s.$assign(this.GetTextRect(!1)),o.$assign(i.CalculateText(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(s),this.FLayout.FWordWrapping,!0)),e=0===Math.abs(this.FAngle)?o.Bottom-o.Top:o.Right-o.Left}finally{i.EndScene(),i=rtl.freeLoc(i)}}return e},this.XYToAnchor=function(t,e){var i="",s=null,o=0,n=0;if(i="",this.IsHTML()){(s=pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.$create("CreateBitmapCanvas",[1,1,!1,!0])).BeginScene(),s.FOptimizedHTMLDrawing=this.FOptimizedHTMLDrawing,s.FBitmapContainer=this.FBitmapContainer;try{s.FFont.Assign(this.FLayout.FFont),o=this.FLayout.FTextAlign,n=this.FLayout.FVerticalTextAlign,i=s.DrawText$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(this.GetTextRect(!0)),this.FText,!1,o,n,0,0,-1,-1,!0,!0,t,e)}finally{s.EndScene(),s=rtl.freeLoc(s)}}return i},this.GetStrippedHTMLText=function(){var t;return t=this.FText,this.IsHTML()?pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.HTMLStrip(t):t},this.GetControlWidth=function(){var t=0,e=null;return t=0,null!=(e=this.GetControlBitmap())&&(t=e.GetWidth()),t},this.GetControlHeight=function(){var t=0,e=null;return t=0,null!=(e=this.GetControlBitmap())&&(t=e.GetHeight()),t},this.GetTextRect=function(t){var e,i=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),s=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),o=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),n=pas["WEBLib.TMSFNCTypes"].TRectF.$new();if(t?s.$assign(pas["WEBLib.TMSFNCTypes"].RectF(this.FLeft,this.FTop,this.FLeft+this.FWidth,this.FTop+this.FHeight)):s.$assign(pas["WEBLib.TMSFNCTypes"].RectF(0,0,this.FWidth,this.FHeight)),o.$assign(this.GetControlRect(!1)),e=this.GetControlBitmap(),this.FControlStretched||null==e||pas["WEBLib.TMSFNCTypes"].IsBitmapEmpty(e))n.$assign(s);else{var r=this.FControlPosition;0===r?n.$assign(pas["WEBLib.TMSFNCTypes"].RectF(s.Left+(o.Right-o.Left)+2,s.Top,s.Right,s.Bottom)):1===r?n.$assign(pas["WEBLib.TMSFNCTypes"].RectF(s.Left,s.Top+(o.Bottom-o.Top)+2,s.Right,s.Bottom)):2===r?n.$assign(pas["WEBLib.TMSFNCTypes"].RectF(s.Left,s.Top,s.Right-(o.Right-o.Left)-2,s.Bottom)):3===r&&n.$assign(pas["WEBLib.TMSFNCTypes"].RectF(s.Left,s.Top,s.Right,s.Bottom-(o.Bottom-o.Top)-2))}return pas["WEBLib.TMSFNCTypes"].InflateRectEx(n,-3,-3),i.$assign(n),i},this.GetControlRect=function(t){var e,i=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),s=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),o=0,n=0;if(i.$assign(pas["WEBLib.TMSFNCTypes"].RectF(0,0,0,0)),null!=(e=this.GetControlBitmap())&&!pas["WEBLib.TMSFNCTypes"].IsBitmapEmpty(e))if(t?s.$assign(pas["WEBLib.TMSFNCTypes"].RectF(this.FLeft,this.FTop,this.FLeft+this.FWidth,this.FTop+this.FHeight)):s.$assign(pas["WEBLib.TMSFNCTypes"].RectF(0,0,this.FWidth,this.FHeight)),this.FControlStretched)i.$assign(s),pas["WEBLib.TMSFNCTypes"].InflateRectEx(i,-2*this.FScaleFactor,-2*this.FScaleFactor);else{o=this.GetControlWidth()*this.FScaleFactor,n=this.GetControlHeight()*this.FScaleFactor;var r=this.FControlPosition;0===r?i.$assign(pas["WEBLib.TMSFNCTypes"].RectF(s.Left+2,s.Top+(s.Bottom-s.Top-n)/2,s.Left+o+2,s.Top+(s.Bottom-s.Top-n)/2+n)):1===r?i.$assign(pas["WEBLib.TMSFNCTypes"].RectF(s.Left+(s.Right-s.Left-o)/2,s.Top+2,s.Left+(s.Right-s.Left-o)/2+o,s.Top+2+n)):2===r?i.$assign(pas["WEBLib.TMSFNCTypes"].RectF(s.Right-o-2,s.Top+(s.Bottom-s.Top-n)/2,s.Right-2,s.Top+(s.Bottom-s.Top-n)/2+n)):3===r&&i.$assign(pas["WEBLib.TMSFNCTypes"].RectF(s.Left+(s.Right-s.Left-o)/2,s.Bottom-2-n,s.Left+(s.Right-s.Left-o)/2+o,s.Bottom-2))}return i},this.HandleMouseMove=function(t,e,i,s,o){var n=pas["WEBLib.TMSFNCTypes"].TRectF.$new();this.FControlEnabled&&(n.$assign(this.GetControlRect(!0)),s.set(pas["WEBLib.TMSFNCTypes"].PtInRectEx(n,pas["WEBLib.TMSFNCTypes"].PointF(e,i))),s.get()&&this.HandleControlMouseMove(rtl.refSet(t),e,i,o))},this.HandleMouseDown=function(t,e,i,s,o){var n=pas["WEBLib.TMSFNCTypes"].TRectF.$new();this.FControlEnabled&&(n.$assign(this.GetControlRect(!0)),o.set(pas["WEBLib.TMSFNCTypes"].PtInRectEx(n,pas["WEBLib.TMSFNCTypes"].PointF(i,s))),o.get()&&this.HandleControlMouseDown(t,rtl.refSet(e),i,s))},this.HandleMouseUp=function(t,e,i,s,o){var n=pas["WEBLib.TMSFNCTypes"].TRectF.$new();this.FControlEnabled&&(n.$assign(this.GetControlRect(!0)),o.set(pas["WEBLib.TMSFNCTypes"].PtInRectEx(n,pas["WEBLib.TMSFNCTypes"].PointF(i,s))),o.get()&&this.HandleControlMouseUp(t,rtl.refSet(e),i,s))},this.Draw=function(t,e,i,s){var o=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),n=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),r="",a=!1,l=null;if(o.$assign(pas["WEBLib.TMSFNCTypes"].RectF(this.FLeft,this.FTop,this.FLeft+this.FWidth,this.FTop+this.FHeight)),n.$assign(this.GetTextRect(!0)),a=!0,t.SetFill(this.FLayout.FFill),t.SetStroke(this.FLayout.FStroke),t.SetFont(this.FLayout.FFont),this.DoBeforeDraw(t,o,n,{get:function(){return e},set:function(t){e=t}},{get:function(){return i},set:function(t){i=t}},{get:function(){return s},set:function(t){s=t}},{get:function(){return a},set:function(t){a=t}}),a){if(i||(t.FFill.SetKind(0),t.FFill.SetColor(-1)),s||(t.FStroke.SetKind(0),t.FStroke.SetColor(-1)),(i||s)&&t.DrawRectangle$3(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(o),rtl.refSet(this.FLayout.FSides),2),""!==(r=this.FText)&&e){t.SetFont(this.FLayout.FFont),l=null,0!==this.FAngle&&(l=t.SaveState(!1));try{0!==this.FAngle&&t.ClipRect(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(n)),t.DrawText$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(n),r,this.FLayout.FWordWrapping,this.FLayout.FTextAlign,this.FLayout.FVerticalTextAlign,0,this.FAngle,-1,-1,!this.FDisplayHTMLFormatting,!1,-1,-1)}finally{0!==this.FAngle&&t.RestoreState(l,!1)}}this.DrawControl(t),this.DoAfterDraw(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(o),pas["WEBLib.TMSFNCTypes"].TRectF.$clone(n))}},this.DrawControl=function(t){var e,i=pas["WEBLib.TMSFNCTypes"].TRectF.$new();null!=(e=this.GetControlBitmap())&&(i.$assign(this.GetControlRect(!0)),i.$assign(pas["WEBLib.TMSFNCTypes"].RectF(Math.round(i.Left),Math.round(i.Top),Math.round(i.Right),Math.round(i.Bottom))),t.DrawBitmap$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),e,!0,!1,!0,!1))},this.Assign=function(e){t.TTMSFNCGridCell.isPrototypeOf(e)?(this.FText=rtl.as(e,t.TTMSFNCGridCell).FText,this.FLayout.Assign(rtl.as(e,t.TTMSFNCGridCell).FLayout),this.FLeft=rtl.as(e,t.TTMSFNCGridCell).FLeft,this.FTop=rtl.as(e,t.TTMSFNCGridCell).FTop,this.FWidth=rtl.as(e,t.TTMSFNCGridCell).FWidth,this.FHeight=rtl.as(e,t.TTMSFNCGridCell).FHeight,this.FControlStretched=rtl.as(e,t.TTMSFNCGridCell).FControlStretched):pas.Classes.TPersistent.Assign.apply(this,arguments)},this.AssignLayout=function(e){t.TTMSFNCGridCellLayout.isPrototypeOf(e)&&this.SetLayout(e)},this.Create$1=function(e){return this.FOwner=e,this.FScaleFactor=1,this.FLayout=t.TTMSFNCGridCellLayout.$create("Create$1"),this.FLayout.FOnChange=rtl.createCallback(this,"Changed"),this.FControlStretched=!1,this.FControlEnabled=!0,this},this.Destroy=function(){this.FControlBitmap=null,rtl.free(this,"FLayout"),pas.System.TObject.Destroy.call(this)}})),this.$rtti.$ClassRef("TTMSFNCGridCellClass",{instancetype:this.$rtti.TTMSFNCGridCell}),rtl.createClass(this,"TTMSFNCBaseCheckGridCell",this.TTMSFNCGridCell,(function(){this.$init=function(){t.TTMSFNCGridCell.$init.call(this),this.FChecked=!1,this.FOnCheckChanged=null},this.$final=function(){this.FOnCheckChanged=void 0,t.TTMSFNCGridCell.$final.call(this)},this.SetChecked=function(t){this.FChecked!==t&&(this.FChecked=t,this.DoCheckChanged(this))},this.HandleControlMouseUp=function(e,i,s,o){t.TTMSFNCGridCell.HandleControlMouseUp.apply(this,arguments),this.SetChecked(!this.FChecked)},this.DoCheckChanged=function(t){null!=this.FOnCheckChanged&&this.FOnCheckChanged(this)},this.GetControlWidth=function(){return 19,19},this.GetControlHeight=function(){return 19,19};var e=this.$rtti;e.addProperty("Checked",2,rtl.boolean,"FChecked","SetChecked",{Default:!1}),e.addProperty("OnCheckChanged",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnCheckChanged","FOnCheckChanged")})),rtl.createClass(this,"TTMSFNCRadioGridCell",this.TTMSFNCBaseCheckGridCell,(function(){})),rtl.createClass(this,"TTMSFNCCheckGridCell",this.TTMSFNCBaseCheckGridCell,(function(){})),rtl.createClass(this,"TTMSFNCButtonGridCell",this.TTMSFNCGridCell,(function(){this.$init=function(){t.TTMSFNCGridCell.$init.call(this),this.FButtonDown=!1,this.FButtonWidth=0,this.FButtonText="",this.FButtonHeight=0},this.SetButtonText=function(t){this.FButtonText!==t&&(this.FButtonText=t)},this.SetButtonWidth=function(t){this.FButtonWidth!==t&&(this.FButtonWidth=t)},this.SetButtonHeight=function(t){this.FButtonHeight!==t&&(this.FButtonHeight=t)},this.HandleControlMouseDown=function(e,i,s,o){t.TTMSFNCGridCell.HandleControlMouseDown.apply(this,arguments),this.FButtonDown=!0},this.HandleControlMouseUp=function(e,i,s,o){t.TTMSFNCGridCell.HandleControlMouseUp.apply(this,arguments),this.FButtonDown=!1},this.GetControlWidth=function(){return this.FButtonWidth},this.GetControlHeight=function(){return this.FButtonHeight},this.Create$1=function(e){return t.TTMSFNCGridCell.Create$1.apply(this,arguments),this.FButtonWidth=24,this.FButtonHeight=20,this.FButtonDown=!1,this},this.DrawControl=function(t){var e=pas["WEBLib.TMSFNCTypes"].TRectF.$new();e.$assign(this.GetControlRect(!0)),e.$assign(pas["WEBLib.TMSFNCTypes"].RectF(Math.round(e.Left),Math.round(e.Top),Math.round(e.Right),Math.round(e.Bottom))),t.DrawButton(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),!1,this.FButtonDown,this.FControlEnabled,!0,1),""!==this.FButtonText&&(pas["WEBLib.TMSFNCTypes"].InflateRectEx(e,-2,-2),t.FFont.SetColor(0),t.DrawText$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),this.FButtonText,!1,0,0,2,0,-1,-1,!0,!1,-1,-1))};var e=this.$rtti;e.addProperty("ButtonText",2,rtl.string,"FButtonText","SetButtonText"),e.addProperty("ButtonWidth",2,rtl.longint,"FButtonWidth","SetButtonWidth",{Default:24}),e.addProperty("ButtonHeight",2,rtl.longint,"FButtonHeight","SetButtonHeight",{Default:20})})),rtl.createClass(this,"TTMSFNCProgressGridCell",this.TTMSFNCGridCell,(function(){this.$init=function(){t.TTMSFNCGridCell.$init.call(this),this.FValue=0,this.FColor=0,this.FShowText=!1,this.FTextColor=0,this.FFormat=""},this.SetValue=function(t){this.FValue=t},this.SetColor=function(t){this.FColor=t},this.SetShowText=function(t){this.FShowText=t},this.SetTextColor=function(t){this.FTextColor=t},this.SetFormat=function(t){this.FFormat=t},this.Draw=function(e,i,s,o){var n=pas["WEBLib.TMSFNCTypes"].TRectF.$new();t.TTMSFNCGridCell.Draw.apply(this,arguments),s&&(n.$assign(pas["WEBLib.TMSFNCTypes"].RectF(this.FLeft+4,this.FTop+4,this.FLeft+this.FWidth-4,this.FTop+this.FHeight-4)),e.DrawProgressBar(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(n),this.FValue,this.FFormat,100,this.FColor,this.FTextColor,this.FShowText,!0,1))},this.Create$1=function(e){return t.TTMSFNCGridCell.Create$1.apply(this,arguments),this.FValue=0,this.FColor=3329434,this.FTextColor=0,this.FShowText=!0,this.FFormat="%.0f%%",this};var e=this.$rtti;e.addProperty("Value",2,rtl.double,"FValue","SetValue"),e.addProperty("Color",2,pas["WEBLib.Graphics"].$rtti.TColor,"FColor","SetColor",{Default:3329434}),e.addProperty("TextColor",2,pas["WEBLib.Graphics"].$rtti.TColor,"FTextColor","SetTextColor",{Default:0}),e.addProperty("ShowText",2,rtl.boolean,"FShowText","SetShowText",{Default:!0}),e.addProperty("Format",2,rtl.string,"FFormat","SetFormat")})),rtl.createClass(this,"TTMSFNCCommentGridCell",this.TTMSFNCGridCell,(function(){this.$init=function(){t.TTMSFNCGridCell.$init.call(this),this.FCommentColor=0,this.FCommentText="",this.FCommentTextColor=0},this.PtInComment=function(t,e){var i=!1,s=null,o=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),n=null;o.$assign(pas["WEBLib.TMSFNCTypes"].RectF(this.FLeft,this.FTop,this.FLeft+this.FWidth,this.FTop+this.FHeight)),pas["WEBLib.TMSFNCTypes"].InflateRectEx(o,-3,-3),(n=pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.$create("CreateBitmapCanvas",[1,1,!1,!0])).BeginScene(),n.FOptimizedHTMLDrawing=this.FOptimizedHTMLDrawing,n.FBitmapContainer=this.FBitmapContainer,s=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsPath.$create("Create$1");try{s.MoveTo(pas["WEBLib.TMSFNCTypes"].PointF(o.Right-7,o.Top)),s.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(o.Right,o.Top)),s.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(o.Right,o.Top+7)),s.ClosePath(),i=n.$class.PointInPath(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(t,e)),s)}finally{s=rtl.freeLoc(s),n.EndScene(),n=rtl.freeLoc(n)}return i},this.Create$1=function(e){return t.TTMSFNCGridCell.Create$1.apply(this,arguments),this.FCommentColor=255,this.FCommentTextColor=0,this},this.HandleMouseDown=function(e,i,s,o,n){t.TTMSFNCGridCell.HandleMouseDown.apply(this,arguments),n.set(this.PtInComment(s,o))},this.HandleMouseMove=function(e,i,s,o,n){t.TTMSFNCGridCell.HandleMouseMove.apply(this,arguments),o.set(this.PtInComment(i,s)),o.get()&&n.set(21)},this.HandleMouseUp=function(e,i,s,o,n){t.TTMSFNCGridCell.HandleMouseUp.apply(this,arguments),n.set(this.PtInComment(s,o)),n.get()&&this.DoControlClick(this)},this.Draw=function(e,i,s,o){var n=null,r=pas["WEBLib.TMSFNCTypes"].TRectF.$new();t.TTMSFNCGridCell.Draw.apply(this,arguments),r.$assign(pas["WEBLib.TMSFNCTypes"].RectF(this.FLeft,this.FTop,this.FLeft+this.FWidth,this.FTop+this.FHeight)),pas["WEBLib.TMSFNCTypes"].InflateRectEx(r,-3,-3),e.FFill.SetKind(1),e.FStroke.SetKind(1),e.FFill.SetColor(this.FCommentColor),e.FStroke.SetColor(this.FCommentColor),n=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsPath.$create("Create$1");try{n.MoveTo(pas["WEBLib.TMSFNCTypes"].PointF(r.Right-7,r.Top)),n.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(r.Right,r.Top)),n.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(r.Right,r.Top+7)),n.ClosePath(),e.DrawPath(n,0)}finally{n=rtl.freeLoc(n)}};var e=this.$rtti;e.addProperty("CommentText",0,rtl.string,"FCommentText","FCommentText"),e.addProperty("CommentColor",0,pas["WEBLib.Graphics"].$rtti.TColor,"FCommentColor","FCommentColor",{Default:255}),e.addProperty("CommentTextColor",0,pas["WEBLib.Graphics"].$rtti.TColor,"FCommentTextColor","FCommentTextColor",{Default:0})})),rtl.createClass(this,"TTMSFNCFixedGridCell",this.TTMSFNCGridCell,(function(){this.$init=function(){t.TTMSFNCGridCell.$init.call(this),this.FShowDropDownButton=!1,this.FSortIndex=0,this.FSortKind=0,this.FSizeMargin=0},this.PtInDropDown=function(t,e){var i,s,o=!1,n=pas["WEBLib.TMSFNCTypes"].TRectF.$new();return o=!1,this.FShowDropDownButton?(i=(this.FSizeMargin+2)*this.FScaleFactor,s=15*this.FScaleFactor,n.$assign(pas["WEBLib.TMSFNCTypes"].RectF(this.FLeft+this.FWidth-s-i,this.FTop+(this.FHeight-s)/2,this.FLeft+this.FWidth-i,this.FTop+(this.FHeight-s)/2+s)),o=pas["WEBLib.TMSFNCTypes"].PtInRectEx(n,pas["WEBLib.TMSFNCTypes"].PointF(t,e))):o},this.Create$1=function(e){return t.TTMSFNCGridCell.Create$1.apply(this,arguments),this.FSizeMargin=0,this},this.HandleMouseDown=function(e,i,s,o,n){t.TTMSFNCGridCell.HandleMouseDown.apply(this,arguments),n.set(this.PtInDropDown(s,o))},this.HandleMouseMove=function(e,i,s,o,n){t.TTMSFNCGridCell.HandleMouseMove.apply(this,arguments),o.set(this.PtInDropDown(i,s))},this.HandleMouseUp=function(e,i,s,o,n){t.TTMSFNCGridCell.HandleMouseUp.apply(this,arguments),n.set(this.PtInDropDown(s,o)),n.get()&&this.DoControlClick(this)},this.Draw=function(e,i,s,o){var n=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),r=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),a=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),l=0,h=0,F=0;t.TTMSFNCGridCell.Draw.apply(this,arguments),n.$assign(pas["WEBLib.TMSFNCTypes"].RectF(this.FLeft,this.FTop,this.FLeft+this.FWidth,this.FTop+this.FHeight)),a.$assign(n),F=(this.FSizeMargin+2)*this.FScaleFactor,this.FShowDropDownButton&&(l=15*this.FScaleFactor,r.$assign(pas["WEBLib.TMSFNCTypes"].RectF(n.Right-l-F,n.Top+(n.Bottom-n.Top-l)/2,n.Right-F,n.Top+(n.Bottom-n.Top-l)/2+l)),e.DrawDropDownButton(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(pas.System.Int(r.Left),pas.System.Int(r.Top),pas.System.Int(r.Right),pas.System.Int(r.Bottom))),!1,!1,!0,!0,!1,1),a.Right=r.Left),0!==this.FSortKind&&(h=12*this.FScaleFactor,a.$assign(pas["WEBLib.TMSFNCTypes"].RectF(a.Right-h-3*this.FScaleFactor-F,a.Top+(a.Bottom-a.Top-h)/2,a.Right-3*this.FScaleFactor-F,a.Top+(a.Bottom-a.Top-h)/2+h)),this.DrawSortIndicator(e,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(a)))},this.DrawSortIndicator=function(t,e){var i=null,s=0,o=0,n=pas["WEBLib.TMSFNCTypes"].TRectF.$new();o=-1===this.FSortIndex?11829830:17919,t.FFill.SetKind(1),t.FFill.SetColor(o),t.FStroke.SetKind(1),t.FStroke.SetColor(o),s=0,n.$assign(e),i=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsPath.$create("Create$1");try{var r=this.FSortKind;1===r?(s=2,i.MoveTo(pas["WEBLib.TMSFNCTypes"].PointF(e.Left+(e.Right-e.Left)/2,e.Top)),i.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(e.Right,e.Bottom)),i.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(e.Left,e.Bottom)),n.$assign(pas["WEBLib.TMSFNCTypes"].RectF(e.Left,e.Top+2,e.Right,e.Bottom+2))):2===r&&(s=1,i.MoveTo(pas["WEBLib.TMSFNCTypes"].PointF(e.Left,e.Top)),i.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(e.Right,e.Top)),i.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(e.Left+(e.Right-e.Left)/2,e.Bottom)),n.$assign(pas["WEBLib.TMSFNCTypes"].RectF(e.Left,e.Top-2,e.Right,e.Bottom-2))),i.ClosePath(),t.DrawPath(i,0),-1!==this.FSortIndex&&(t.FFont.SetColor(16777215),pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.SetFontSize(t.FFont,9,1),t.DrawText$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(n),pas.SysUtils.IntToStr(this.FSortIndex),!1,0,s,0,0,-1,-1,!0,!1,-1,-1))}finally{i=rtl.freeLoc(i)}};var e=this.$rtti;e.addProperty("ShowDropDownButton",0,rtl.boolean,"FShowDropDownButton","FShowDropDownButton",{Default:!1}),e.addProperty("SortKind",0,t.$rtti.TTMSFNCGridSortKind,"FSortKind","FSortKind",{Default:t.TTMSFNCGridSortKind.skDescending}),e.addProperty("SortIndex",0,rtl.longint,"FSortIndex","FSortIndex",{Default:-1}),e.addProperty("SizeMargin",0,rtl.longint,"FSizeMargin","FSizeMargin",{Default:0})})),rtl.createClass(this,"TTMSFNCNodeGridCell",this.TTMSFNCGridCell,(function(){this.$init=function(){t.TTMSFNCGridCell.$init.call(this),this.FState=0},this.HandleControlMouseMove=function(e,i,s,o){t.TTMSFNCGridCell.HandleControlMouseMove.apply(this,arguments),o.set(21)},this.$rtti.addProperty("State",0,t.$rtti.TTMSFNCGridNodeState,"FState","FState",{Default:t.TTMSFNCGridNodeState.nsClosed})})),rtl.createClass(this,"TTMSFNCBitmapGridCell",this.TTMSFNCGridCell,(function(){this.$init=function(){t.TTMSFNCGridCell.$init.call(this),this.FBitmap=null,this.FBitmapName=""},this.$final=function(){this.FBitmap=void 0,t.TTMSFNCGridCell.$final.call(this)},this.SetBitmap=function(t){this.FBitmap!==t&&this.FBitmap.Assign(t)},this.SetBitmapName=function(t){this.FBitmapName!==t&&(this.FBitmapName=t)},this.Create$1=function(e){return t.TTMSFNCGridCell.Create$1.apply(this,arguments),this.FBitmap=pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.$create("Create$3"),this.SetControlEnabled(!1),this},this.Destroy=function(){rtl.free(this,"FBitmap"),t.TTMSFNCGridCell.Destroy.call(this)},this.GetControlBitmap=function(){var t=null;return t=null,null==this.FBitmap||pas["WEBLib.TMSFNCTypes"].IsBitmapEmpty(this.FBitmap)?null!=this.FBitmapContainer&&""!==this.FBitmapName&&(t=this.FBitmapContainer.FindBitmap$1(this.FBitmapName)):t=this.FBitmap,t};var e=this.$rtti;e.addProperty("BitmapName",2,rtl.string,"FBitmapName","SetBitmapName"),e.addProperty("Bitmap",2,pas["WEBLib.TMSFNCTypes"].$rtti.TTMSFNCBitmap,"FBitmap","SetBitmap")}))}),["Math","SysUtils","WEBLib.TMSFNCUtils"]),rtl.module("WEBLib.TMSFNCGridDataUtil",["System","Classes","Types","SysUtils"],(function(){"use strict";var t=this.$impl;this.TTMSFNCGridAutoType={0:"atNumeric",atNumeric:0,1:"atFloat",atFloat:1,2:"atString",atString:2,3:"atDate",atDate:3,4:"atTime",atTime:4,5:"atScientific",atScientific:5},rtl.createClass(this,"TTMSFNCGridIntList",pas.Classes.TList,(function(){this.SetInteger=function(t,e){this.Put(t,e)},this.GetInteger=function(t){return rtl.trunc(this.Get(t))},this.HasValue=function(t){return-1!==this.IndexOfValue(t)},this.IndexOfValue=function(t){return this.IndexOf(t)},this.Add$1=function(t){pas.Classes.TList.Add.call(this,t)},this.Insert$1=function(t,e){pas.Classes.TList.Insert.call(this,t,e)},this.Delete$1=function(t){pas.Classes.TList.Delete.call(this,t)}})),this.IsType=function(e){var i=0,s=0,o=!1,n=!1,r=!1,a=0,l=0,h=0,F=!1;if(i=2,""===e)return i;o=!0,n=!0,r=!0,F=!1,a=-1,l=0,h=0;for(var p=1,c=e.length;p<=c;p++)s=p,t.CheckSignedNum(e.charAt(s-1))||(o=!1),"e"!==e.charAt(s-1)&&"E"!==e.charAt(s-1)||(F&&(r=!1),F=!0),s>1&&"-"===e.charAt(s-1)&&(o=!1,n=!1),1!==s||"e"!==e.charAt(s-1)&&"E"!==e.charAt(s-1)||(r=!1),s!==e.length||"e"!==e.charAt(s-1)&&"E"!==e.charAt(s-1)&&"+"!==e.charAt(s-1)&&"-"!==e.charAt(s-1)||(r=!1),t.CheckNum(e.charAt(s-1))||"-"===e.charAt(s-1)||e.charAt(s-1)===pas.SysUtils.FormatSettings.ThousandSeparator||e.charAt(s-1)===pas.SysUtils.FormatSettings.DecimalSeparator||(n=!1),t.CheckSignedFloatNum(e.charAt(s-1))&&e.charAt(s-1)!==pas.SysUtils.FormatSettings.ThousandSeparator||(r=!1),e.charAt(s-1)===pas.SysUtils.FormatSettings.ThousandSeparator&&s-a<4&&-1!==a&&(n=!1),e.charAt(s-1)===pas.SysUtils.FormatSettings.ThousandSeparator&&(a=s),e.charAt(s-1)===pas.SysUtils.FormatSettings.DecimalSeparator&&(l+=1),"-"===e.charAt(s-1)&&(h+=1);return o?i=0:(n&&!F&&(i=1),r&&F&&(2===h&&(h=1),i=5)),(h>1||l>1)&&(i=2),i},this.IsURL=function(t){var e;return e=pas.SysUtils.UpperCase(t),1===pas.System.Pos("HTTP://",e)||1===pas.System.Pos("HTTPS://",e)||1===pas.System.Pos("FTP://",e)||1===pas.System.Pos("NNTP://",e)||1===pas.System.Pos("MAILTO:",e)},this.$implcode=function(){t.IsNumber=function(t){return t.charCodeAt()in rtl.createSet(null,48,57)},t.CheckNum=function(e){return t.IsNumber(e)},t.CheckSignedNum=function(e){return t.IsNumber(e)||"-"===e},t.CheckFloatNum=function(e){return t.IsNumber(e)||e===pas.SysUtils.FormatSettings.ThousandSeparator||e===pas.SysUtils.FormatSettings.DecimalSeparator||"e"===e||"E"===e},t.CheckSignedFloatNum=function(e){return t.CheckFloatNum(e)||"+"===e||"-"===e}}}),["WEBLib.TMSFNCUtils"]),rtl.module("WEBLib.TMSFNCCustomScrollControl",["System","Classes","WEBLib.TMSFNCCustomControl","WEBLib.StdCtrls","WEBLib.TMSFNCScrollBar","WEBLib.TMSFNCGraphics","WEBLib.TMSFNCTypes","WEBLib.ExtCtrls","Types","WEBLib.Controls"],(function(){"use strict";var t=this,e=t.$impl;this.SCROLLINGDELAY=0,this.SWIPECOUNT=300,this.DOWNCOUNT=100,this.TTMSFNCCustomScrollControlMode={0:"scmPixelScrolling",scmPixelScrolling:0,1:"scmItemScrolling",scmItemScrolling:1},this.$rtti.$Enum("TTMSFNCCustomScrollControlMode",{minvalue:0,maxvalue:1,ordtype:1,enumtype:this.TTMSFNCCustomScrollControlMode}),this.TTMSFNCCustomScrollControlUpdate={0:"scuContinuous",scuContinuous:0,1:"scuOnce",scuOnce:1},this.$rtti.$Enum("TTMSFNCCustomScrollControlUpdate",{minvalue:0,maxvalue:1,ordtype:1,enumtype:this.TTMSFNCCustomScrollControlUpdate}),rtl.createClass(this,"TTMSFNCCustomScrollControl",pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl,(function(){this.$init=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.$init.call(this),this.FDownTime=0,this.FMouseUp=!1,this.FAnimateVerticalPos=!1,this.FAnimateHorizontalPos=!1,this.FAnimating=!1,this.FSpX=0,this.FSpY=0,this.FDoubleSelection=!1,this.FRangeSelection=!1,this.FScrolling=!1,this.FScrollX=0,this.FScrollY=0,this.FDownX=0,this.FDownY=0,this.FMouseX=0,this.FMouseY=0,this.FScrollVTo=0,this.FScrollHTo=0,this.FTimeStart=0,this.FTimeStop=0,this.FAnimateTimer=null,this.FDownTimer=null,this.FSaveHScrollPos=0,this.FSaveVScrollPos=0,this.FBlockScrollingUpdate=!1,this.FIsMouseDown=!1,this.FStretchScrollBars=!1,this.FUpdateCount$1=0,this.FVerticalScrollBar=null,this.FHorizontalScrollBar=null,this.FCustomVerticalScrollBar=null,this.FCustomHorizontalScrollBar=null,this.FVerticalScrollBarVisible=!1,this.FHorizontalScrollBarVisible=!1,this.FScrollMode=0,this.FApplyClipRect=!1,this.FScrollUpdate=0,this.FCustomScrollBars=!1,this.FTouchScrolling=!1},this.$final=function(){this.FAnimateTimer=void 0,this.FDownTimer=void 0,this.FVerticalScrollBar=void 0,this.FHorizontalScrollBar=void 0,this.FCustomVerticalScrollBar=void 0,this.FCustomHorizontalScrollBar=void 0,pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.$final.call(this)},this.SetScrollMode=function(t){this.FScrollMode!==t&&(this.FScrollMode=t,this.UpdateControl(!0,!0))},this.SetScrollUpdate=function(t){this.FScrollUpdate!==t&&(this.FScrollUpdate=t,null!=this.FCustomVerticalScrollBar&&this.FCustomVerticalScrollBar.SetTracking(0===this.FScrollUpdate),null!=this.FCustomHorizontalScrollBar&&this.FCustomHorizontalScrollBar.SetTracking(0===this.FScrollUpdate),this.UpdateControl(!0,!0))},this.SetCustomScrollBars=function(t){this.FCustomScrollBars!==t&&(this.FCustomScrollBars=t,this.UpdateControl(!0,!0))},this.GetVersion=function(){return"",""},this.GetCanvasHeightOffset=function(){var t=0,e=null,i=null;return t=0,e=this.HorizontalScrollBar(),i=this.CustomHorizontalScrollBar(),null!=e&&null!=i&&(this.FCustomScrollBars&&i.FVisible&&null!=i.FParent?t=i.GetHeight():!this.FCustomScrollBars&&e.FVisible&&null!=e.FParent&&(t=e.GetHeight())),t},this.GetCanvasWidthOffset=function(){var t=0,e=null,i=null;return t=0,e=this.VerticalScrollBar(),i=this.CustomVerticalScrollBar(),null!=e&&null!=i&&(this.FCustomScrollBars&&i.FVisible&&null!=i.FParent?t=i.GetWidth():!this.FCustomScrollBars&&e.FVisible&&null!=e.FParent&&(t=e.GetWidth())),t},this.SetHorizontalScrollBarVisible=function(t){this.FHorizontalScrollBarVisible!==t&&(this.FHorizontalScrollBarVisible=t,this.UpdateControl(!0,!0))},this.SetVerticalScrollBarVisible=function(t){this.FVerticalScrollBarVisible!==t&&(this.FVerticalScrollBarVisible=t,this.UpdateControl(!0,!0))},this.Animate=function(t){var i,s,o=0,n=0,r=!1,a=!1;n=this.GetVScrollValue(),o=this.GetHScrollValue(),i=Math.abs(this.FScrollHTo-o)/Math.max(1,6*Math.abs(this.FSpX)),s=Math.abs(this.FScrollVTo-n)/Math.max(1,6*Math.abs(this.FSpY)),a=!1,this.FAnimateVerticalPos&&(a=e.AnimateDouble({get:function(){return n},set:function(t){n=t}},{p:this,get:function(){return this.p.FScrollVTo},set:function(t){this.p.FScrollVTo=t}},s,.01)),r=!1,this.FAnimateHorizontalPos&&(r=e.AnimateDouble({get:function(){return o},set:function(t){o=t}},{p:this,get:function(){return this.p.FScrollHTo},set:function(t){this.p.FScrollHTo=t}},i,.01)),this.FAnimating=a||r,this.FAnimating?this.Scroll(o,n):(this.FAnimateVerticalPos=!1,this.FAnimateTimer.SetEnabled(!1),this.FAnimateHorizontalPos=!1)},this.DownTime=function(t){this.FDownTime+=1,100!==this.FDownTime&&this.FTouchScrolling||(this.FRangeSelection=!0,this.FDownTimer.SetEnabled(!1))},this.UpdateControlAfterResize=function(){this.FUpdateCount$1>0||3 in this.FComponentState||0 in this.FComponentState||(this.SaveScrollPosition(),this.UpdateControl(!1,!0),this.RestoreScrollPosition())},this.Scroll=function(t,e){var i,s;this.FBlockScrollingUpdate=!0,i=this.GetHScrollValue(),s=this.GetVScrollValue(),this.SetHScrollValue(t),this.SetVScrollValue(e),this.FBlockScrollingUpdate=!1,this.UpdateControlScroll(i,s,t,e)},this.UpdateControlScroll=function(t,e,i,s){},this.VerticalScrollPositionChanged=function(){},this.HorizontalScrollPositionChanged=function(){},this.VScrollChanged=function(t){this.FBlockScrollingUpdate||this.FCustomScrollBars||(this.FIsMouseDown||this.StopAnimationTimer(),this.VerticalScrollPositionChanged(),this.SetVScrollValue(this.GetVScrollValue()))},this.HScrollChanged=function(t){this.FBlockScrollingUpdate||this.FCustomScrollBars||(this.FIsMouseDown||this.StopAnimationTimer(),this.HorizontalScrollPositionChanged(),this.SetHScrollValue(this.GetHScrollValue()))},this.HandleMouseDown=function(t,i,s,o){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleMouseDown.apply(this,arguments),this.CaptureEx(),this.ProcessTouchScrolling(s,o)&&(this.FIsMouseDown=!0,this.FTimeStart=e.GetTickCountX(),this.FTimeStop=this.FTimeStart,this.FScrollVTo=this.GetVScrollValue(),this.FScrollHTo=this.GetHScrollValue(),this.FScrollX=s,this.FScrollY=o,this.FDownX=s,this.FDownY=o,this.FMouseX=s,this.FMouseY=o,this.FMouseUp=!1,this.FDownTimer.SetEnabled(!0),this.FDoubleSelection=!this.FAnimateTimer.FEnabled,this.FRangeSelection=!1,this.FScrolling=!1,this.FDownTime=0)},this.HandleMouseMove=function(t,e,i){var s=0;pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleMouseMove.apply(this,arguments),this.ProcessTouchScrolling(e,i)&&this.FIsMouseDown&&(!0?(s=1,(this.FScrolling||Math.abs(this.FMouseX-e)>3||Math.abs(this.FMouseY-i)>3)&&!this.FRangeSelection&&this.FTouchScrolling&&(Math.abs(e-this.FDownX)>0||Math.abs(i-this.FDownY)>0)&&(this.FScrolling=!0,this.FDownTimer.SetEnabled(!1),this.FDoubleSelection=!1,this.FIsMouseDown&&!this.FMouseUp&&(this.Scroll(this.GetHScrollValue()-(e-this.FDownX)*s,this.GetVScrollValue()-(i-this.FDownY)*s),this.FDownY=i,this.FDownX=e))):this.FRangeSelection)},this.HandleMouseUp=function(t,i,s,o){var n=0;pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleMouseUp.apply(this,arguments),this.ReleaseCaptureEx(),this.ProcessTouchScrolling(s,o)&&this.FIsMouseDown&&(n=1,this.FIsMouseDown=!1,this.FMouseUp=!0,this.FScrolling=!1,this.FDownTimer.SetEnabled(!1),!this.FDoubleSelection&&this.FTouchScrolling?(this.FTimeStop=e.GetTickCountX(),this.FTimeStop-this.FTimeStart<300&&this.FTimeStop-this.FTimeStart>0&&(this.FSpY=Math.abs(o-this.FScrollY)/(this.FTimeStop-this.FTimeStart),this.FSpY>0&&(o-this.FScrollY>0?this.FScrollVTo=Math.max(0,Math.min(this.VerticalScrollBar().FMax-this.GetVViewPortSize(),this.FScrollVTo-Math.round(Math.abs(o-this.FScrollY)*this.FSpY*n*3))):this.FScrollVTo=Math.max(0,Math.min(this.VerticalScrollBar().FMax-this.GetVViewPortSize(),this.FScrollVTo+Math.round(Math.abs(o-this.FScrollY)*this.FSpY*n*3))),this.FAnimateVerticalPos=!0,this.FAnimateTimer.SetEnabled(!0)),this.FSpX=Math.abs(s-this.FScrollX)/(this.FTimeStop-this.FTimeStart),this.FSpX>0&&(s-this.FScrollX>0?this.FScrollHTo=Math.max(0,Math.min(this.HorizontalScrollBar().FMax-this.GetHViewPortSize(),this.FScrollHTo-Math.round(Math.abs(s-this.FScrollX)*this.FSpX*n*3))):this.FScrollHTo=Math.max(0,Math.min(this.HorizontalScrollBar().FMax-this.GetHViewPortSize(),this.FScrollHTo+Math.round(Math.abs(s-this.FScrollX)*this.FSpX*n*3))),this.FAnimateHorizontalPos=!0,this.FAnimateTimer.SetEnabled(!0)))):this.HandleSelection(t,rtl.refSet(i),s,o),this.FRangeSelection=!1)},this.HandleSelection=function(t,e,i,s){},this.HCustomScrollChanged=function(t,e){!this.FBlockScrollingUpdate&&this.FCustomScrollBars&&(this.FIsMouseDown||this.StopAnimationTimer(),this.HorizontalScrollPositionChanged(),this.SetHScrollValue(this.GetHScrollValue()))},this.VCustomScrollChanged=function(t,e){!this.FBlockScrollingUpdate&&this.FCustomScrollBars&&(this.FIsMouseDown||this.StopAnimationTimer(),this.VerticalScrollPositionChanged(),this.SetVScrollValue(this.GetVScrollValue()))},this.UpdateControlScrollBarCalculations=function(){},this.UpdateControlScrollBars=function(t,e){var i=null,s=null,o=null,n=null,r=0,a=0,l=0,h=0,F=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),p=null,c=null;this.FUpdateCount$1>0||3 in this.FComponentState||(this.FBlockScrollingUpdate=!0,e&&this.UpdateControlScrollBarCalculations(),i=this.VerticalScrollBar(),s=this.HorizontalScrollBar(),o=this.CustomVerticalScrollBar(),n=this.CustomHorizontalScrollBar(),null!=i&&null!=s&&null!=o&&null!=n&&(e?F.$assign(this.GetCalculationRect()):F.$assign(this.GetContentRect()),l=F.Right-F.Left,h=F.Bottom-F.Top,r=this.GetTotalContentWidth(),a=this.GetTotalContentHeight(),s.SetVisible(r>0&&1===pas["WEBLib.TMSFNCTypes"].CompareValueEx(r,l,0)&&this.FHorizontalScrollBarVisible&&!this.ColumnStretchingActive()&&!this.FCustomScrollBars),i.SetVisible(a>0&&1===pas["WEBLib.TMSFNCTypes"].CompareValueEx(a,h,0)&&this.FVerticalScrollBarVisible&&!this.FCustomScrollBars),n.SetVisible(r>0&&1===pas["WEBLib.TMSFNCTypes"].CompareValueEx(r,l,0)&&this.FHorizontalScrollBarVisible&&!this.ColumnStretchingActive()&&this.FCustomScrollBars),o.SetVisible(a>0&&1===pas["WEBLib.TMSFNCTypes"].CompareValueEx(a,h,0)&&this.FVerticalScrollBarVisible&&this.FCustomScrollBars),o.FVisible&&this.FCustomScrollBars?o.SetParent(this):o.SetParent(null),n.FVisible&&this.FCustomScrollBars?n.SetParent(this):n.SetParent(null),i.FVisible&&!this.FCustomScrollBars?i.SetParent(this):i.SetParent(null),s.FVisible&&!this.FCustomScrollBars?s.SetParent(this):s.SetParent(null),p=pas["WEBLib.TMSFNCTypes"].TTMSFNCMargins.$create("Create$1"),c=pas["WEBLib.TMSFNCTypes"].TTMSFNCMargins.$create("Create$1"),this.FCustomScrollBars?o.FVisible&&this.FStretchScrollBars?c.SetRight(o.GetWidth()+1):c.SetRight(1):i.FVisible&&this.FStretchScrollBars?c.SetRight(i.GetWidth()+1):c.SetRight(1),p.SetTop(1),p.SetRight(1),c.SetBottom(1),c.SetLeft(1),this.FCustomScrollBars?n.FVisible?p.SetBottom(n.GetHeight()+1):p.SetBottom(1):s.FVisible?p.SetBottom(s.GetHeight()+1):p.SetBottom(1),this.FStretchScrollBars||(F.$assign(this.GetCalculationRect()),c.SetLeft(c.FLeft+F.Left),c.SetRight(c.FRight+(this.GetWidth()-F.Right)),p.SetTop(p.FTop+F.Top),p.SetBottom(p.FBottom+(this.GetHeight()-F.Bottom))),s.SetLeft(Math.round(c.FLeft)),s.SetTop(Math.round(this.GetHeight()-c.FBottom-s.GetHeight())),i.SetLeft(Math.round(this.GetWidth()-p.FRight-i.GetWidth())),i.SetTop(Math.round(p.FTop)),s.SetWidth(Math.round(Math.max(0,this.GetWidth()-c.FRight-c.FLeft))),i.SetHeight(Math.round(Math.max(0,this.GetHeight()-p.FBottom-p.FTop))),n.SetLeft(Math.round(c.FLeft)),n.SetTop(Math.round(this.GetHeight()-c.FBottom-n.GetHeight())),o.SetLeft(Math.round(this.GetWidth()-p.FRight-o.GetWidth())),o.SetTop(Math.round(p.FTop)),n.SetWidth(Math.round(Math.max(0,this.GetWidth()-c.FRight-c.FLeft))),o.SetHeight(Math.round(Math.max(0,this.GetHeight()-p.FBottom-p.FTop))),c=rtl.freeLoc(c),p=rtl.freeLoc(p),F.$assign(this.GetContentRect()),l=F.Right-F.Left,h=F.Bottom-F.Top,1===this.FScrollMode?(i.SetPageSize(Math.round(Math.max(0,this.GetVerticalContentViewPortSize()))),i.SetMax(Math.max(i.GetPageSize(),this.GetVerticalContentCount()))):(i.SetPageSize(Math.round(Math.max(0,Math.min(a,h)))),i.SetMax(Math.round(Math.max(i.GetPageSize(),a))),i.SetPosition(Math.min(i.GetPosition(),i.FMax))),i.FSmallChange=Math.max(-2147483648,rtl.trunc(i.GetPageSize()/5)),i.FLargeChange=Math.max(-2147483648,i.GetPageSize()),1===this.FScrollMode?(s.SetPageSize(Math.round(Math.max(0,this.GetHorizontalContentViewPortSize()))),s.SetMax(Math.max(s.GetPageSize(),this.GetHorizontalContentCount()))):(s.SetPageSize(Math.round(Math.max(0,Math.min(r,l)))),s.SetMax(Math.round(Math.max(s.GetPageSize(),r))),s.SetPosition(Math.min(s.GetPosition(),s.FMax))),s.FSmallChange=Math.max(-2147483648,rtl.trunc(s.GetPageSize()/5)),s.FLargeChange=Math.max(-2147483648,s.GetPageSize()),1===this.FScrollMode?(o.SetPageSize(Math.max(0,Math.round(this.GetVerticalContentViewPortSize()))),o.SetMax(this.GetVerticalContentCount()-o.FPageSize)):(o.SetPageSize(Math.round(Math.max(0,Math.min(a,h)))),o.SetMax(Math.round(a-h))),o.FSmallChange=o.FPageSize/5,o.FLargeChange=o.FPageSize,1===this.FScrollMode?(n.SetPageSize(Math.max(0,Math.round(this.GetHorizontalContentViewPortSize()))),n.SetMax(this.GetHorizontalContentCount()-n.FPageSize)):(n.SetPageSize(Math.round(Math.max(0,Math.min(r,l)))),n.SetMax(Math.round(r-l))),n.FSmallChange=n.FPageSize/5,n.FLargeChange=n.FPageSize),this.FBlockScrollingUpdate=!1,t&&this.UpdateControlScrollBars(!1,!1))},this.UpdateControl=function(t,e){this.UpdateControlCache(),this.UpdateControlScrollBars(!0,!0),this.UpdateControlDisplay()},this.UpdateControlCache=function(){},this.UpdateControlDisplay=function(){},this.StopAnimationTimer=function(){this.FAnimateTimer.SetEnabled(!1),this.FAnimating=!1},this.SetHScrollValue=function(t){this.FCustomScrollBars?this.CustomHorizontalScrollBar().SetValue(t):this.HorizontalScrollBar().GetPageSize()>0&&this.HorizontalScrollBar().SetPosition(Math.round(Math.min(this.HorizontalScrollBar().FMax-this.HorizontalScrollBar().GetPageSize(),Math.max(0,t))))},this.SetVScrollValue=function(t){this.FCustomScrollBars?this.CustomVerticalScrollBar().SetValue(t):this.VerticalScrollBar().GetPageSize()>0&&this.VerticalScrollBar().SetPosition(Math.round(Math.min(this.VerticalScrollBar().FMax-this.VerticalScrollBar().GetPageSize(),Math.max(0,t))))},this.Loaded=function(){pas["WEBLib.Controls"].TCustomControl.Loaded.call(this),this.UpdateControl(!0,!0)},this.Draw=function(t,e){var i=null,s=pas["WEBLib.TMSFNCTypes"].TRectF.$new();pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Draw.apply(this,arguments),s.$assign(this.GetContentClipRect()),i=null,this.FApplyClipRect&&(i=t.SaveState(!1),t.ClipRect(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(s))),this.DrawContent(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(s)),this.FApplyClipRect&&t.RestoreState(i,!1)},this.DrawContent=function(t,e){},this.UpdateScrollingMode=function(t){this.FScrollMode=t},this.GetTotalContentWidth=function(){return 0,0},this.GetTotalContentHeight=function(){return 0,0},this.GetHorizontalContentViewPortSize=function(){return 0,0},this.GetVerticalContentViewPortSize=function(){return 0,0},this.GetHorizontalContentCount=function(){return 0,0},this.GetVerticalContentCount=function(){return 0,0},this.GetCalculationRect=function(){var t=pas["WEBLib.TMSFNCTypes"].TRectF.$new();return t.$assign(this.GetLocalRect()),t},this.GetContentClipRect=function(){var t=pas["WEBLib.TMSFNCTypes"].TRectF.$new();return t.$assign(this.GetContentRect()),t},this.GetContentRect=function(){var t=pas["WEBLib.TMSFNCTypes"].TRectF.$new();return t.$assign(pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.GetContentRect.call(this)),this.FCustomScrollBars?(this.CustomHorizontalScrollBar().FVisible&&(t.Bottom=t.Bottom-this.CustomHorizontalScrollBar().GetHeight()-1),this.CustomVerticalScrollBar().FVisible&&(t.Right=t.Right-this.CustomVerticalScrollBar().GetWidth()-1)):(this.HorizontalScrollBar().FVisible&&(t.Bottom=t.Bottom-this.HorizontalScrollBar().GetHeight()-1),this.VerticalScrollBar().FVisible&&(t.Right=t.Right-this.VerticalScrollBar().GetWidth()-1)),t},this.GetHScrollValue=function(){return this.FCustomScrollBars?this.CustomHorizontalScrollBar().FValue:Math.min(this.HorizontalScrollBar().FMax-this.HorizontalScrollBar().GetPageSize(),Math.max(0,Math.round(this.HorizontalScrollBar().GetPosition())))},this.GetVScrollValue=function(){return this.FCustomScrollBars?this.CustomVerticalScrollBar().FValue:Math.min(this.VerticalScrollBar().FMax-this.VerticalScrollBar().GetPageSize(),Math.max(0,Math.round(this.VerticalScrollBar().GetPosition())))},this.GetVViewPortSize=function(){return this.FCustomScrollBars?this.CustomVerticalScrollBar().FPageSize:this.VerticalScrollBar().GetPageSize()},this.GetHViewPortSize=function(){return this.FCustomScrollBars?this.CustomHorizontalScrollBar().FPageSize:this.HorizontalScrollBar().GetPageSize()},this.GetVMax=function(){return this.FCustomScrollBars?this.CustomVerticalScrollBar().FMax:this.VerticalScrollBar().FMax},this.GetHMax=function(){return this.FCustomScrollBars?this.CustomHorizontalScrollBar().FMax:this.HorizontalScrollBar().FMax},this.GetHVisible=function(){return this.FCustomScrollBars?this.CustomHorizontalScrollBar().FVisible:this.HorizontalScrollBar().FVisible},this.GetVVisible=function(){return this.FCustomScrollBars?this.CustomVerticalScrollBar().FVisible:this.VerticalScrollBar().FVisible},this.ProcessTouchScrolling=function(t,e){return this.FTouchScrolling},this.Create$1=function(t){return pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Create$1.apply(this,arguments),this.FTouchScrolling=!1,this.FAnimateTimer=pas["WEBLib.ExtCtrls"].TTimer.$create("Create$1",[this]),this.FAnimateTimer.SetInterval(1),this.FAnimateTimer.SetEnabled(!1),this.FAnimateTimer.FOnTimer=rtl.createCallback(this,"Animate"),this.FDownTimer=pas["WEBLib.ExtCtrls"].TTimer.$create("Create$1",[this]),this.FDownTimer.SetInterval(1),this.FDownTimer.SetEnabled(!1),this.FDownTimer.FOnTimer=rtl.createCallback(this,"DownTime"),this.FApplyClipRect=!0,this.FStretchScrollBars=!0,this.FScrollMode=0,this.FScrollUpdate=0,this.FCustomVerticalScrollBar=pas["WEBLib.TMSFNCScrollBar"].TTMSFNCScrollBar.$create("Create$1",[this]),this.FCustomVerticalScrollBar.SetParent(this),this.FCustomHorizontalScrollBar=pas["WEBLib.TMSFNCScrollBar"].TTMSFNCScrollBar.$create("Create$1",[this]),this.FCustomHorizontalScrollBar.SetParent(this),this.FVerticalScrollBar=pas["WEBLib.StdCtrls"].TScrollBar.$create("Create$1",[this]),this.FVerticalScrollBar.SetParent(this),this.FHorizontalScrollBar=pas["WEBLib.StdCtrls"].TScrollBar.$create("Create$1",[this]),this.FHorizontalScrollBar.SetParent(this),this.FCustomVerticalScrollBar.FAppearance.SetThumbButtonSize(0),this.FCustomHorizontalScrollBar.FAppearance.SetThumbButtonSize(0),this.FCustomHorizontalScrollBar.SetKind(0),this.FVerticalScrollBar.FDoubleBuffered=!1,this.FHorizontalScrollBar.FDoubleBuffered=!1,this.FVerticalScrollBar.SetKind(1),this.FVerticalScrollBar.SetVisible(!0),this.FHorizontalScrollBar.SetVisible(!0),this.FCustomVerticalScrollBar.SetVisible(!1),this.FCustomHorizontalScrollBar.SetVisible(!1),this.FVerticalScrollBar.FOnChange=rtl.createCallback(this,"VScrollChanged"),this.FHorizontalScrollBar.FOnChange=rtl.createCallback(this,"HScrollChanged"),this.FCustomHorizontalScrollBar.FOnValueChange=rtl.createCallback(this,"HCustomScrollChanged"),this.FCustomVerticalScrollBar.FOnValueChange=rtl.createCallback(this,"VCustomScrollChanged"),this.FVerticalScrollBarVisible=!0,this.FHorizontalScrollBarVisible=!0,this},this.Destroy=function(){rtl.free(this,"FCustomVerticalScrollBar"),rtl.free(this,"FCustomHorizontalScrollBar"),rtl.free(this,"FVerticalScrollBar"),rtl.free(this,"FHorizontalScrollBar"),pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Destroy.call(this)},this.Assign=function(e){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Assign.apply(this,arguments),t.TTMSFNCCustomScrollControl.isPrototypeOf(e)&&(this.FStretchScrollBars=rtl.as(e,t.TTMSFNCCustomScrollControl).FStretchScrollBars,this.FScrollMode=rtl.as(e,t.TTMSFNCCustomScrollControl).FScrollMode,this.FScrollUpdate=rtl.as(e,t.TTMSFNCCustomScrollControl).FScrollUpdate,this.FApplyClipRect=rtl.as(e,t.TTMSFNCCustomScrollControl).FApplyClipRect)},this.BeginUpdate=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBase.BeginUpdate.call(this),this.FUpdateCount$1+=1},this.EndUpdate=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBase.EndUpdate.call(this),this.FUpdateCount$1-=1,0===this.FUpdateCount$1&&this.UpdateControl(!0,!0)},this.SaveScrollPosition=function(){this.FSaveHScrollPos=this.GetHScrollValue(),this.FSaveVScrollPos=this.GetVScrollValue()},this.RestoreScrollPosition=function(){this.Scroll(this.FSaveHScrollPos,this.FSaveVScrollPos)},this.GetVerticalScrollPosition=function(){return this.GetVScrollValue()},this.GetHorizontalScrollPosition=function(){return this.GetHScrollValue()},this.GetHorizontalScrollMax=function(){return this.GetHMax()},this.GetVerticalScrollMax=function(){return this.GetVMax()},this.HorizontalScrollBar=function(){return this.FHorizontalScrollBar},this.VerticalScrollBar=function(){return this.FVerticalScrollBar},this.CustomHorizontalScrollBar=function(){return this.FCustomHorizontalScrollBar},this.CustomVerticalScrollBar=function(){return this.FCustomVerticalScrollBar},rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas["WEBLib.TMSFNCTypes"].ITMSFNCProductInfo),rtl.addIntf(this,pas.System.IUnknown)})),t.$implcode=function(){e.GetTickCountX=function(){var t=0,e=0,i=0,s=0;return pas.SysUtils.DecodeTime(pas.SysUtils.Now(),{get:function(){return t},set:function(e){t=e}},{get:function(){return e},set:function(t){e=t}},{get:function(){return i},set:function(t){i=t}},{get:function(){return s},set:function(t){s=t}}),s+1e3*i+60*e*1e3+60*t*60*1e3},e.AnimateDouble=function(t,e,i,s){var o=!1;return o=!0,t.get()>e.get()-s&&t.get()<e.get()+s?(t.set(e.get()),o=!1):(i=Math.max(s,i),t.get()<e.get()?t.set(t.get()+i):t.set(t.get()-i)),o}}}),["WEBLib.Forms","Math","WEBLib.TMSFNCGraphicsTypes","SysUtils"]),rtl.module("WEBLib.TMSFNCGridOptions",["System","Classes","WEBLib.TMSFNCGridDataUtil","WEBLib.TMSFNCGraphicsTypes"],(function(){"use strict";var t=this;this.TTMSFNCGridTabKeyHandling={0:"tkhNextControl",tkhNextControl:0,1:"tkhNextCell",tkhNextCell:1,2:"tkhMixed",tkhMixed:2},this.$rtti.$Enum("TTMSFNCGridTabKeyHandling",{minvalue:0,maxvalue:2,ordtype:1,enumtype:this.TTMSFNCGridTabKeyHandling}),this.TTMSFNCGridTabKeyDirection={0:"tkdNextColumnCell",tkdNextColumnCell:0,1:"tkdNextRowCell",tkdNextRowCell:1},this.$rtti.$Enum("TTMSFNCGridTabKeyDirection",{minvalue:0,maxvalue:1,ordtype:1,enumtype:this.TTMSFNCGridTabKeyDirection}),rtl.createClass(this,"TTMSFNCGridScrollBarOptions",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FOnChange=null,this.FVerticalScrollBarVisible=!1,this.FHorizontalScrollBarVisible=!1},this.$final=function(){this.FOnChange=void 0,pas.Classes.TPersistent.$final.call(this)},this.SetHorizontalScrollBarVisible=function(t){this.FHorizontalScrollBarVisible!==t&&(this.FHorizontalScrollBarVisible=t,null!=this.FOnChange&&this.FOnChange(this))},this.SetVerticalScrollBarVisible=function(t){this.FVerticalScrollBarVisible!==t&&(this.FVerticalScrollBarVisible=t,null!=this.FOnChange&&this.FOnChange(this))},this.Assign=function(e){t.TTMSFNCGridScrollBarOptions.isPrototypeOf(e)&&(this.SetVerticalScrollBarVisible(rtl.as(e,t.TTMSFNCGridScrollBarOptions).FVerticalScrollBarVisible),this.SetHorizontalScrollBarVisible(rtl.as(e,t.TTMSFNCGridScrollBarOptions).FHorizontalScrollBarVisible))},this.Create$1=function(){return this.FVerticalScrollBarVisible=!0,this.FHorizontalScrollBarVisible=!0,this},this.Destroy=function(){pas.System.TObject.Destroy.call(this)};var e=this.$rtti;e.addProperty("HorizontalScrollBarVisible",2,rtl.boolean,"FHorizontalScrollBarVisible","SetHorizontalScrollBarVisible",{Default:!0}),e.addProperty("VerticalScrollBarVisible",2,rtl.boolean,"FVerticalScrollBarVisible","SetVerticalScrollBarVisible",{Default:!0})})),rtl.createClass(this,"TTMSFNCGridBandOptions",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FEnabled=!1,this.FOnChange=null,this.FBandRowCount=0,this.FNormalRowCount=0,this.FTotalRowCount=0},this.$final=function(){this.FOnChange=void 0,pas.Classes.TPersistent.$final.call(this)},this.SetEnabled=function(t){this.FEnabled!==t&&(this.FEnabled=t,this.Changed())},this.SetBandRowCount=function(t){t>0&&this.FBandRowCount!==t&&(this.FBandRowCount=t,this.FTotalRowCount=this.FNormalRowCount+this.FBandRowCount,this.Changed())},this.SetNormalRowCount=function(t){t>0&&this.FNormalRowCount!==t&&(this.FNormalRowCount=t,this.FTotalRowCount=this.FNormalRowCount+this.FBandRowCount,this.Changed())},this.Assign=function(e){t.TTMSFNCGridBandOptions.isPrototypeOf(e)&&(this.FEnabled=rtl.as(e,t.TTMSFNCGridBandOptions).FEnabled)},this.Create$1=function(){return pas.System.TObject.Create.call(this),this.FEnabled=!1,this.FNormalRowCount=1,this.FBandRowCount=1,this},this.Changed=function(){null!=this.FOnChange&&this.FOnChange(this)};var e=this.$rtti;e.addProperty("NormalRowCount",2,rtl.longint,"FNormalRowCount","SetNormalRowCount",{Default:1}),e.addProperty("BandRowCount",2,rtl.longint,"FBandRowCount","SetBandRowCount",{Default:1}),e.addProperty("Enabled",2,rtl.boolean,"FEnabled","SetEnabled",{Default:!1}),e.addProperty("OnChange",0,pas.Classes.$rtti.TNotifyEvent,"FOnChange","FOnChange")})),this.TTMSFNCGridSelectionMode={0:"smNone",smNone:0,1:"smSingleCell",smSingleCell:1,2:"smSingleRow",smSingleRow:2,3:"smSingleColumn",smSingleColumn:3,4:"smCellRange",smCellRange:4,5:"smRowRange",smRowRange:5,6:"smColumnRange",smColumnRange:6,7:"smDisjunctRow",smDisjunctRow:7,8:"smDisjunctColumn",smDisjunctColumn:8,9:"smDisjunctCell",smDisjunctCell:9},this.$rtti.$Enum("TTMSFNCGridSelectionMode",{minvalue:0,maxvalue:9,ordtype:1,enumtype:this.TTMSFNCGridSelectionMode}),rtl.createClass(this,"TTMSFNCGridSelection",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FMode=0,this.FOnChange=null,this.FShowSelectionInFixedCells=!1},this.$final=function(){this.FOnChange=void 0,pas.Classes.TPersistent.$final.call(this)},this.SetMode=function(t){this.FMode!==t&&(this.FMode=t,this.Changed())},this.SetShowSelectionInFixedCells=function(t){this.FShowSelectionInFixedCells!==t&&(this.FShowSelectionInFixedCells=t,this.Changed())},this.Assign=function(e){t.TTMSFNCGridSelection.isPrototypeOf(e)&&(this.FMode=rtl.as(e,t.TTMSFNCGridSelection).FMode,this.FShowSelectionInFixedCells=rtl.as(e,t.TTMSFNCGridSelection).FShowSelectionInFixedCells)},this.Create$1=function(){return this.FMode=1,this},this.Changed=function(){null!=this.FOnChange&&this.FOnChange(this)};var e=this.$rtti;e.addProperty("Mode",2,t.$rtti.TTMSFNCGridSelectionMode,"FMode","SetMode",{Default:t.TTMSFNCGridSelectionMode.smSingleCell}),e.addProperty("ShowSelectionInFixedCells",2,rtl.boolean,"FShowSelectionInFixedCells","SetShowSelectionInFixedCells",{Default:!1}),e.addProperty("OnChange",0,pas.Classes.$rtti.TNotifyEvent,"FOnChange","FOnChange")})),this.TTMSFNCGridFixedCellSelectionMode={0:"fcsAll",fcsAll:0,1:"fcsRow",fcsRow:1,2:"fcsColumn",fcsColumn:2,3:"fcsRowRange",fcsRowRange:3,4:"fcsColumnRange",fcsColumnRange:4,5:"fcsDisjunctRow",fcsDisjunctRow:5,6:"fcsDisjunctColumn",fcsDisjunctColumn:6},this.$rtti.$Enum("TTMSFNCGridFixedCellSelectionMode",{minvalue:0,maxvalue:6,ordtype:1,enumtype:this.TTMSFNCGridFixedCellSelectionMode}),this.$rtti.$Set("TTMSFNCGridFixedCellSelection",{comptype:this.$rtti.TTMSFNCGridFixedCellSelectionMode}),this.TTMSFNCGridAutoScrollingSpeedMode={0:"asmPixels",asmPixels:0,1:"asmCell",asmCell:1},this.$rtti.$Enum("TTMSFNCGridAutoScrollingSpeedMode",{minvalue:0,maxvalue:1,ordtype:1,enumtype:this.TTMSFNCGridAutoScrollingSpeedMode}),rtl.createClass(this,"TTMSFNCGridMouseOptions",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FDirectEdit=!1,this.FWheelScrollSize=0,this.FAutoDragging=!1,this.FFixedRowSizing=!1,this.FFixedColumnSizing=!1,this.FRowDragging=!1,this.FColumnDragging=!1,this.FAutoScrollingInterval=0,this.FRowSizing=!1,this.FColumnSizing=!1,this.FAutoScrollingSpeed=0,this.FAutoScrolling=!1,this.FTouchScrolling=!1,this.FTouchScrollingSensitivity=0,this.FFixedCellSelection={},this.FRowAutoSizeOnDblClick=!1,this.FColumnAutoSizeOnDblClick=!1,this.FWheelScrollKeepSelection=!1,this.FRowSizeMargin=0,this.FColumnSizeMargin=0,this.FAutoScrollingSpeedMode=0,this.FClickMargin=0},this.$final=function(){this.FFixedCellSelection=void 0,pas.Classes.TPersistent.$final.call(this)},this.SetWheelScrollSize=function(t){this.FWheelScrollSize=t},this.SetAutoScrollingInterval=function(t){this.FAutoScrollingInterval=t},this.SetTouchScrolling=function(t){this.FTouchScrolling=t},this.SetWheelScrollKeepSelection=function(t){this.FWheelScrollKeepSelection=t},this.IsTouchScrollingSensitivityStored=function(){return 1!==this.FTouchScrollingSensitivity},this.SetColumnSizeMargin=function(t){this.FColumnSizeMargin=t},this.SetRowSizeMargin=function(t){this.FRowSizeMargin=t},this.SetClickMargin=function(t){this.FClickMargin=t},this.Assign=function(e){t.TTMSFNCGridMouseOptions.isPrototypeOf(e)&&(this.FDirectEdit=rtl.as(e,t.TTMSFNCGridMouseOptions).FDirectEdit,this.FWheelScrollSize=rtl.as(e,t.TTMSFNCGridMouseOptions).FWheelScrollSize,this.FColumnSizing=rtl.as(e,t.TTMSFNCGridMouseOptions).FColumnSizing,this.FRowSizing=rtl.as(e,t.TTMSFNCGridMouseOptions).FRowSizing,this.FFixedColumnSizing=rtl.as(e,t.TTMSFNCGridMouseOptions).FFixedColumnSizing,this.FFixedRowSizing=rtl.as(e,t.TTMSFNCGridMouseOptions).FFixedRowSizing,this.FColumnDragging=rtl.as(e,t.TTMSFNCGridMouseOptions).FColumnDragging,this.FRowDragging=rtl.as(e,t.TTMSFNCGridMouseOptions).FRowDragging,this.FAutoScrolling=rtl.as(e,t.TTMSFNCGridMouseOptions).FAutoScrolling,this.FAutoDragging=rtl.as(e,t.TTMSFNCGridMouseOptions).FAutoDragging,this.FAutoScrollingSpeed=rtl.as(e,t.TTMSFNCGridMouseOptions).FAutoScrollingSpeed,this.FAutoScrollingInterval=rtl.as(e,t.TTMSFNCGridMouseOptions).FAutoScrollingInterval,this.FTouchScrolling=rtl.as(e,t.TTMSFNCGridMouseOptions).FTouchScrolling,this.FTouchScrollingSensitivity=rtl.as(e,t.TTMSFNCGridMouseOptions).FTouchScrollingSensitivity,this.FFixedCellSelection=rtl.refSet(rtl.as(e,t.TTMSFNCGridMouseOptions).FFixedCellSelection),this.FRowAutoSizeOnDblClick=rtl.as(e,t.TTMSFNCGridMouseOptions).FRowAutoSizeOnDblClick,this.FColumnAutoSizeOnDblClick=rtl.as(e,t.TTMSFNCGridMouseOptions).FColumnAutoSizeOnDblClick,this.FWheelScrollKeepSelection=rtl.as(e,t.TTMSFNCGridMouseOptions).FWheelScrollKeepSelection,this.FColumnSizeMargin=rtl.as(e,t.TTMSFNCGridMouseOptions).FColumnSizeMargin,this.FClickMargin=rtl.as(e,t.TTMSFNCGridMouseOptions).FClickMargin,this.FRowSizeMargin=rtl.as(e,t.TTMSFNCGridMouseOptions).FRowSizeMargin,this.FAutoScrollingSpeedMode=rtl.as(e,t.TTMSFNCGridMouseOptions).FAutoScrollingSpeedMode)},this.Create$1=function(){return this.FTouchScrollingSensitivity=1,this.FTouchScrolling=!1,this.FDirectEdit=!1,this.FWheelScrollSize=4,this.FColumnSizing=!1,this.FRowSizing=!1,this.FFixedColumnSizing=!1,this.FFixedRowSizing=!1,this.FColumnDragging=!1,this.FRowDragging=!1,this.FAutoScrolling=!0,this.FAutoDragging=!0,this.FAutoScrollingSpeed=1,this.FAutoScrollingInterval=100,this.FFixedCellSelection={},this.FRowAutoSizeOnDblClick=!0,this.FColumnAutoSizeOnDblClick=!0,this.FWheelScrollKeepSelection=!1,this.FColumnSizeMargin=6,this.FRowSizeMargin=6,this.FAutoScrollingSpeedMode=0,this};var e=this.$rtti;e.addProperty("DirectEdit",0,rtl.boolean,"FDirectEdit","FDirectEdit",{Default:!1}),e.addProperty("WheelScrollSize",2,rtl.longint,"FWheelScrollSize","SetWheelScrollSize",{Default:4}),e.addProperty("WheelScrollKeepSelection",2,rtl.boolean,"FWheelScrollKeepSelection","SetWheelScrollKeepSelection",{Default:!1}),e.addProperty("ColumnSizing",0,rtl.boolean,"FColumnSizing","FColumnSizing",{Default:!1}),e.addProperty("ClickMargin",2,rtl.longint,"FClickMargin","SetClickMargin",{Default:2}),e.addProperty("ColumnSizeMargin",2,rtl.longint,"FColumnSizeMargin","SetColumnSizeMargin",{Default:2}),e.addProperty("RowSizing",0,rtl.boolean,"FRowSizing","FRowSizing",{Default:!1}),e.addProperty("RowSizeMargin",2,rtl.longint,"FRowSizeMargin","SetRowSizeMargin",{Default:2}),e.addProperty("FixedColumnSizing",0,rtl.boolean,"FFixedColumnSizing","FFixedColumnSizing",{Default:!1}),e.addProperty("FixedRowSizing",0,rtl.boolean,"FFixedRowSizing","FFixedRowSizing",{Default:!1}),e.addProperty("FixedCellSelection",0,t.$rtti.TTMSFNCGridFixedCellSelection,"FFixedCellSelection","FFixedCellSelection",{Default:{}}),e.addProperty("ColumnAutoSizeOnDblClick",0,rtl.boolean,"FColumnAutoSizeOnDblClick","FColumnAutoSizeOnDblClick",{Default:!0}),e.addProperty("RowAutoSizeOnDblClick",0,rtl.boolean,"FRowAutoSizeOnDblClick","FRowAutoSizeOnDblClick",{Default:!0}),e.addProperty("ColumnDragging",0,rtl.boolean,"FColumnDragging","FColumnDragging",{Default:!1}),e.addProperty("RowDragging",0,rtl.boolean,"FRowDragging","FRowDragging",{Default:!1}),e.addProperty("AutoScrolling",0,rtl.boolean,"FAutoScrolling","FAutoScrolling",{Default:!0}),e.addProperty("AutoDragging",0,rtl.boolean,"FAutoDragging","FAutoDragging",{Default:!0}),e.addProperty("AutoScrollingSpeedMode",0,t.$rtti.TTMSFNCGridAutoScrollingSpeedMode,"FAutoScrollingSpeedMode","FAutoScrollingSpeedMode",{Default:t.TTMSFNCGridAutoScrollingSpeedMode.asmPixels}),e.addProperty("AutoScrollingSpeed",0,rtl.longint,"FAutoScrollingSpeed","FAutoScrollingSpeed",{Default:1}),e.addProperty("AutoScrollingInterval",2,rtl.longint,"FAutoScrollingInterval","SetAutoScrollingInterval",{Default:100}),e.addProperty("TouchScrolling",2,rtl.boolean,"FTouchScrolling","SetTouchScrolling",{Default:!1}),e.addProperty("TouchScrollingSensitivity",12,rtl.double,"FTouchScrollingSensitivity","FTouchScrollingSensitivity",{stored:"IsTouchScrollingSensitivityStored"})})),this.TTMSFNCGridInsertKeyHandling={0:"ikhNone",ikhNone:0,1:"ikhInsertRowBefore",ikhInsertRowBefore:1,2:"ikhInsertRowAfter",ikhInsertRowAfter:2},this.$rtti.$Enum("TTMSFNCGridInsertKeyHandling",{minvalue:0,maxvalue:2,ordtype:1,enumtype:this.TTMSFNCGridInsertKeyHandling}),this.TTMSFNCGridEnterKeyHandling={0:"ekhNone",ekhNone:0,1:"ekhNextColumn",ekhNextColumn:1,2:"ekhNextRow",ekhNextRow:2,3:"ekhNextColumnInRow",ekhNextColumnInRow:3,4:"ekhNextRowInColumn",ekhNextRowInColumn:4,5:"ekhNextColumnAndAppend",ekhNextColumnAndAppend:5,6:"ekhNextRowAndAppend",ekhNextRowAndAppend:6,7:"ekhNextRowAndColumnAppend",ekhNextRowAndColumnAppend:7,8:"ekhNextColumnAndRowAppend",ekhNextColumnAndRowAppend:8},this.$rtti.$Enum("TTMSFNCGridEnterKeyHandling",{minvalue:0,maxvalue:8,ordtype:1,enumtype:this.TTMSFNCGridEnterKeyHandling}),this.TTMSFNCGridDeleteKeyHandling={0:"dkhNone",dkhNone:0,1:"dkhDeleteRow",dkhDeleteRow:1},this.$rtti.$Enum("TTMSFNCGridDeleteKeyHandling",{minvalue:0,maxvalue:1,ordtype:1,enumtype:this.TTMSFNCGridDeleteKeyHandling}),rtl.createClass(this,"TTMSFNCGridKeyboardOptions",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FTabKeyDirection=0,this.FTabKeyHandling=0,this.FPageScrollSize=0,this.FEnterKeyHandling=0,this.FEnterKeyDirectEdit=!1,this.FDeleteKeyHandling=0,this.FInsertKeyHandling=0,this.FTabKeyDirectEdit=!1,this.FArrowKeyDirectEdit=!1,this.FAllowCellMergeShortCut=!1},this.SetPageScrollSize=function(t){this.FPageScrollSize=t},this.Assign=function(e){t.TTMSFNCGridKeyboardOptions.isPrototypeOf(e)&&(this.FTabKeyDirection=rtl.as(e,t.TTMSFNCGridKeyboardOptions).FTabKeyDirection,this.FTabKeyHandling=rtl.as(e,t.TTMSFNCGridKeyboardOptions).FTabKeyHandling,this.FEnterKeyHandling=rtl.as(e,t.TTMSFNCGridKeyboardOptions).FEnterKeyHandling,this.FDeleteKeyHandling=rtl.as(e,t.TTMSFNCGridKeyboardOptions).FDeleteKeyHandling,this.FInsertKeyHandling=rtl.as(e,t.TTMSFNCGridKeyboardOptions).FInsertKeyHandling,this.FEnterKeyDirectEdit=rtl.as(e,t.TTMSFNCGridKeyboardOptions).FEnterKeyDirectEdit,this.FTabKeyDirectEdit=rtl.as(e,t.TTMSFNCGridKeyboardOptions).FTabKeyDirectEdit,this.FArrowKeyDirectEdit=rtl.as(e,t.TTMSFNCGridKeyboardOptions).FArrowKeyDirectEdit,this.FAllowCellMergeShortCut=rtl.as(e,t.TTMSFNCGridKeyboardOptions).FAllowCellMergeShortCut)},this.Create$1=function(){return this.FTabKeyDirection=0,this.FTabKeyHandling=2,this.FPageScrollSize=0,this.FEnterKeyHandling=0,this.FDeleteKeyHandling=0,this.FInsertKeyHandling=0,this.FEnterKeyDirectEdit=!1,this.FArrowKeyDirectEdit=!1,this.FTabKeyDirectEdit=!1,this.FAllowCellMergeShortCut=!1,this};var e=this.$rtti;e.addProperty("AllowCellMergeShortCut",0,rtl.boolean,"FAllowCellMergeShortCut","FAllowCellMergeShortCut",{Default:!1}),e.addProperty("TabKeyDirectEdit",0,rtl.boolean,"FTabKeyDirectEdit","FTabKeyDirectEdit",{Default:!1}),e.addProperty("ArrowKeyDirectEdit",0,rtl.boolean,"FArrowKeyDirectEdit","FArrowKeyDirectEdit",{Default:!1}),e.addProperty("InsertKeyHandling",0,t.$rtti.TTMSFNCGridInsertKeyHandling,"FInsertKeyHandling","FInsertKeyHandling",{Default:t.TTMSFNCGridInsertKeyHandling.ikhNone}),e.addProperty("DeleteKeyHandling",0,t.$rtti.TTMSFNCGridDeleteKeyHandling,"FDeleteKeyHandling","FDeleteKeyHandling",{Default:t.TTMSFNCGridDeleteKeyHandling.dkhNone}),e.addProperty("EnterKeyHandling",0,t.$rtti.TTMSFNCGridEnterKeyHandling,"FEnterKeyHandling","FEnterKeyHandling",{Default:t.TTMSFNCGridEnterKeyHandling.ekhNone}),e.addProperty("EnterKeyDirectEdit",0,rtl.boolean,"FEnterKeyDirectEdit","FEnterKeyDirectEdit",{Default:!1}),e.addProperty("TabKeyHandling",0,t.$rtti.TTMSFNCGridTabKeyHandling,"FTabKeyHandling","FTabKeyHandling",{Default:t.TTMSFNCGridTabKeyHandling.tkhMixed}),e.addProperty("TabKeyDirection",0,t.$rtti.TTMSFNCGridTabKeyDirection,"FTabKeyDirection","FTabKeyDirection",{Default:t.TTMSFNCGridTabKeyDirection.tkdNextColumnCell}),e.addProperty("PageScrollSize",2,rtl.longint,"FPageScrollSize","SetPageScrollSize",{Default:0})})),this.TTMSFNCGridSortBlankPosition={0:"blFirst",blFirst:0,1:"blLast",blLast:1},this.$rtti.$Enum("TTMSFNCGridSortBlankPosition",{minvalue:0,maxvalue:1,ordtype:1,enumtype:this.TTMSFNCGridSortBlankPosition}),this.TTMSFNCGridSortingMode={0:"gsmNone",gsmNone:0,1:"gsmNormal",gsmNormal:1,2:"gsmIndexed",gsmIndexed:2},this.$rtti.$Enum("TTMSFNCGridSortingMode",{minvalue:0,maxvalue:2,ordtype:1,enumtype:this.TTMSFNCGridSortingMode}),this.TTMSFNCGridSortColumns={0:"scAll",scAll:0,1:"scNormal",scNormal:1,2:"scSingle",scSingle:2},this.$rtti.$Enum("TTMSFNCGridSortColumns",{minvalue:0,maxvalue:2,ordtype:1,enumtype:this.TTMSFNCGridSortColumns}),this.TTMSFNCGridBorders={0:"bNone",bNone:0,1:"bAll",bAll:1,2:"bVertical",bVertical:2,3:"bHorizontal",bHorizontal:3},this.$rtti.$Enum("TTMSFNCGridBorders",{minvalue:0,maxvalue:3,ordtype:1,enumtype:this.TTMSFNCGridBorders}),rtl.createClass(this,"TTMSFNCGridSortingOptions",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FMode=0,this.FRow=0,this.FColumns=0,this.FMultiColumn=!1,this.FIgnoreCase=!1,this.FIgnoreBlanks=!1,this.FBlankPosition=0},this.SetMode=function(t){this.FMode=t},this.Assign=function(e){t.TTMSFNCGridSortingOptions.isPrototypeOf(e)&&(this.FMultiColumn=rtl.as(e,t.TTMSFNCGridSortingOptions).FMultiColumn,this.FMode=rtl.as(e,t.TTMSFNCGridSortingOptions).FMode,this.FColumns=rtl.as(e,t.TTMSFNCGridSortingOptions).FColumns,this.FRow=rtl.as(e,t.TTMSFNCGridSortingOptions).FRow,this.FBlankPosition=rtl.as(e,t.TTMSFNCGridSortingOptions).FBlankPosition,this.FIgnoreCase=rtl.as(e,t.TTMSFNCGridSortingOptions).FIgnoreCase,this.FIgnoreBlanks=rtl.as(e,t.TTMSFNCGridSortingOptions).FIgnoreBlanks)},this.Create$1=function(){return pas.System.TObject.Create.call(this),this.FMode=0,this.FMultiColumn=!0,this.FRow=0,this};var e=this.$rtti;e.addProperty("BlankPosition",0,t.$rtti.TTMSFNCGridSortBlankPosition,"FBlankPosition","FBlankPosition",{Default:t.TTMSFNCGridSortBlankPosition.blFirst}),e.addProperty("Row",0,rtl.longint,"FRow","FRow",{Default:0}),e.addProperty("IgnoreCase",0,rtl.boolean,"FIgnoreCase","FIgnoreCase",{Default:!1}),e.addProperty("IgnoreBlanks",0,rtl.boolean,"FIgnoreBlanks","FIgnoreBlanks",{Default:!1}),e.addProperty("MultiColumn",0,rtl.boolean,"FMultiColumn","FMultiColumn",{Default:!0}),e.addProperty("Mode",2,t.$rtti.TTMSFNCGridSortingMode,"FMode","SetMode",{Default:t.TTMSFNCGridSortingMode.gsmNone}),e.addProperty("Columns",0,t.$rtti.TTMSFNCGridSortColumns,"FColumns","FColumns",{Default:t.TTMSFNCGridSortColumns.scAll})})),rtl.createClass(this,"TTMSFNCGridBorderOptions",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FFixedCellBorders=0,this.FCellBorders=0},this.Assign=function(e){t.TTMSFNCGridBorderOptions.isPrototypeOf(e)&&(this.FFixedCellBorders=rtl.as(e,t.TTMSFNCGridBorderOptions).FFixedCellBorders,this.FCellBorders=rtl.as(e,t.TTMSFNCGridBorderOptions).FCellBorders)},this.Create$1=function(){return this.FFixedCellBorders=1,this.FCellBorders=1,this};var e=this.$rtti;e.addProperty("FixedCellBorders",0,t.$rtti.TTMSFNCGridBorders,"FFixedCellBorders","FFixedCellBorders",{Default:t.TTMSFNCGridBorders.bAll}),e.addProperty("CellBorders",0,t.$rtti.TTMSFNCGridBorders,"FCellBorders","FCellBorders",{Default:t.TTMSFNCGridBorders.bAll})})),this.TTMSFNCGridAutoComplete={0:"acDisabled",acDisabled:0,1:"acNormal",acNormal:1,2:"acLookupList",acLookupList:2},this.$rtti.$Enum("TTMSFNCGridAutoComplete",{minvalue:0,maxvalue:2,ordtype:1,enumtype:this.TTMSFNCGridAutoComplete}),this.TTMSFNCGridAutoPost={0:"apNone",apNone:0,1:"apCell",apCell:1,2:"apRow",apRow:2},this.$rtti.$Enum("TTMSFNCGridAutoPost",{minvalue:0,maxvalue:2,ordtype:1,enumtype:this.TTMSFNCGridAutoPost}),rtl.createClass(this,"TTMSFNCGridEditingOptions",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FEnabled=!1,this.FAutoComplete=0,this.FAutoCompleteItems=null,this.FAutoHistory=!1,this.FAutoCompleteCaseSensitive=!1,this.FCalcFormat="",this.FAutoPost=0,this.FAutoCancel=!1,this.FDirectComboClose=!1,this.FDirectComboDrop=!1,this.FEditWithTags=!1},this.$final=function(){this.FAutoCompleteItems=void 0,pas.Classes.TPersistent.$final.call(this)},this.SetAutoCompleteItems=function(t){this.FAutoCompleteItems.Assign(t)},this.SetAutoPost=function(t){this.FAutoPost=t},this.SetAutoCancel=function(t){this.FAutoCancel=t},this.Assign=function(e){t.TTMSFNCGridEditingOptions.isPrototypeOf(e)&&(this.FEnabled=rtl.as(e,t.TTMSFNCGridEditingOptions).FEnabled,this.FAutoComplete=rtl.as(e,t.TTMSFNCGridEditingOptions).FAutoComplete,this.FAutoCompleteItems.Assign(rtl.as(e,t.TTMSFNCGridEditingOptions).FAutoCompleteItems),this.FAutoHistory=rtl.as(e,t.TTMSFNCGridEditingOptions).FAutoHistory,this.FAutoCompleteCaseSensitive=rtl.as(e,t.TTMSFNCGridEditingOptions).FAutoCompleteCaseSensitive,this.FCalcFormat=rtl.as(e,t.TTMSFNCGridEditingOptions).FCalcFormat,this.FAutoPost=rtl.as(e,t.TTMSFNCGridEditingOptions).FAutoPost,this.FAutoCancel=rtl.as(e,t.TTMSFNCGridEditingOptions).FAutoCancel,this.FEditWithTags=rtl.as(e,t.TTMSFNCGridEditingOptions).FEditWithTags)},this.Create$1=function(){return pas.System.TObject.Create.call(this),this.FEnabled=!0,this.FAutoCompleteItems=pas.Classes.TStringList.$create("Create$1"),this.FAutoCompleteItems.FDuplicates=0,this.FAutoComplete=0,this.FAutoHistory=!1,this.FAutoCompleteCaseSensitive=!0,this.FCalcFormat="%g",this.FAutoPost=1,this.FAutoCancel=!1,this.FEditWithTags=!0,this},this.Destroy=function(){rtl.free(this,"FAutoCompleteItems"),pas.System.TObject.Destroy.call(this)};var e=this.$rtti;e.addProperty("AutoCancel",2,rtl.boolean,"FAutoCancel","SetAutoCancel",{Default:!1}),e.addProperty("AutoComplete",0,t.$rtti.TTMSFNCGridAutoComplete,"FAutoComplete","FAutoComplete",{Default:t.TTMSFNCGridAutoComplete.acDisabled}),e.addProperty("AutoCompleteCaseSensitive",0,rtl.boolean,"FAutoCompleteCaseSensitive","FAutoCompleteCaseSensitive",{Default:!0}),e.addProperty("AutoCompleteItems",2,pas.Classes.$rtti.TStringList,"FAutoCompleteItems","SetAutoCompleteItems"),e.addProperty("AutoHistory",0,rtl.boolean,"FAutoHistory","FAutoHistory",{Default:!1}),e.addProperty("AutoPost",2,t.$rtti.TTMSFNCGridAutoPost,"FAutoPost","SetAutoPost",{Default:t.TTMSFNCGridAutoPost.apCell}),e.addProperty("CalcFormat",0,rtl.string,"FCalcFormat","FCalcFormat"),e.addProperty("DirectComboDrop",0,rtl.boolean,"FDirectComboDrop","FDirectComboDrop",{Default:!1}),e.addProperty("DirectComboClose",0,rtl.boolean,"FDirectComboClose","FDirectComboClose",{Default:!1}),e.addProperty("Enabled",0,rtl.boolean,"FEnabled","FEnabled",{Default:!0}),e.addProperty("EditWithTags",0,rtl.boolean,"FEditWithTags","FEditWithTags",{Default:!0})})),rtl.createClass(this,"TTMSFNCGridLookupOptions",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FCaseSensitive=!1,this.FIncremental=!1,this.FEnabled=!1},this.Assign=function(e){t.TTMSFNCGridLookupOptions.isPrototypeOf(e)&&(this.FCaseSensitive=rtl.as(e,t.TTMSFNCGridLookupOptions).FCaseSensitive,this.FIncremental=rtl.as(e,t.TTMSFNCGridLookupOptions).FIncremental,this.FEnabled=rtl.as(e,t.TTMSFNCGridLookupOptions).FEnabled)},this.Create$1=function(){return pas.System.TObject.Create.call(this),this.FCaseSensitive=!1,this.FIncremental=!0,this};var e=this.$rtti;e.addProperty("CaseSensitive",0,rtl.boolean,"FCaseSensitive","FCaseSensitive",{Default:!1}),e.addProperty("Enabled",0,rtl.boolean,"FEnabled","FEnabled",{Default:!1}),e.addProperty("Incremental",0,rtl.boolean,"FIncremental","FIncremental",{Default:!0})})),this.TTMSFNCGridFilterRows={0:"frNormal",frNormal:0,1:"frAll",frAll:1},this.$rtti.$Enum("TTMSFNCGridFilterRows",{minvalue:0,maxvalue:1,ordtype:1,enumtype:this.TTMSFNCGridFilterRows}),rtl.createClass(this,"TTMSFNCGridFilteringOptions",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FRows=0,this.FDropDownFixedRow=0,this.FDropDown=!1,this.FOnChange=null,this.FDropDownHeight=0,this.FDropDownWidth=0,this.FMultiColumn=!1},this.$final=function(){this.FOnChange=void 0,pas.Classes.TPersistent.$final.call(this)},this.SetDropDown=function(t){this.FDropDown!==t&&(this.FDropDown=t,this.Changed())},this.SetDropDownFixedRow=function(t){this.FDropDownFixedRow!==t&&(this.FDropDownFixedRow=t,this.Changed())},this.Create$1=function(){return pas.System.TObject.Create.call(this),this.FRows=0,this.FDropDown=!1,this.FDropDownFixedRow=0,this.FDropDownWidth=100,this.FDropDownHeight=120,this},this.Assign=function(e){t.TTMSFNCGridFilteringOptions.isPrototypeOf(e)&&(this.FRows=rtl.as(e,t.TTMSFNCGridFilteringOptions).FRows,this.FDropDown=rtl.as(e,t.TTMSFNCGridFilteringOptions).FDropDown,this.FDropDownFixedRow=rtl.as(e,t.TTMSFNCGridFilteringOptions).FDropDownFixedRow,this.FDropDownWidth=rtl.as(e,t.TTMSFNCGridFilteringOptions).FDropDownWidth,this.FDropDownHeight=rtl.as(e,t.TTMSFNCGridFilteringOptions).FDropDownHeight,this.FMultiColumn=rtl.as(e,t.TTMSFNCGridFilteringOptions).FMultiColumn)},this.Changed=function(){null!=this.FOnChange&&this.FOnChange(this)};var e=this.$rtti;e.addProperty("Rows",0,t.$rtti.TTMSFNCGridFilterRows,"FRows","FRows",{Default:t.TTMSFNCGridFilterRows.frNormal}),e.addProperty("DropDown",2,rtl.boolean,"FDropDown","SetDropDown",{Default:!1}),e.addProperty("DropDownFixedRow",2,rtl.longint,"FDropDownFixedRow","SetDropDownFixedRow",{Default:0}),e.addProperty("DropDownWidth",0,rtl.longint,"FDropDownWidth","FDropDownWidth",{Default:100}),e.addProperty("DropDownHeight",0,rtl.longint,"FDropDownHeight","FDropDownHeight",{Default:120}),e.addProperty("MultiColumn",0,rtl.boolean,"FMultiColumn","FMultiColumn",{Default:!1}),e.addProperty("OnChange",0,pas.Classes.$rtti.TNotifyEvent,"FOnChange","FOnChange")})),rtl.createClass(this,"TTMSFNCGridGroupingOptions",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FMergeHeader=!1,this.FMergeSummary=!1,this.FSummary=!1,this.FShowGroupCount=!1,this.FCalcFormat="",this.FAutoSelectGroup=!1,this.FAutoCheckGroup=!1,this.FGroupCountFormat=""},this.Create$1=function(){return pas.System.TObject.Create.call(this),this.FCalcFormat="%g",this.FGroupCountFormat="(%d)",this},this.Assign=function(e){t.TTMSFNCGridGroupingOptions.isPrototypeOf(e)&&(this.FCalcFormat=rtl.as(e,t.TTMSFNCGridGroupingOptions).FCalcFormat,this.FMergeHeader=rtl.as(e,t.TTMSFNCGridGroupingOptions).FMergeHeader,this.FMergeSummary=rtl.as(e,t.TTMSFNCGridGroupingOptions).FMergeSummary,this.FShowGroupCount=rtl.as(e,t.TTMSFNCGridGroupingOptions).FShowGroupCount,this.FAutoCheckGroup=rtl.as(e,t.TTMSFNCGridGroupingOptions).FAutoCheckGroup,this.FAutoSelectGroup=rtl.as(e,t.TTMSFNCGridGroupingOptions).FAutoSelectGroup,this.FGroupCountFormat=rtl.as(e,t.TTMSFNCGridGroupingOptions).FGroupCountFormat)};var e=this.$rtti;e.addProperty("AutoSelectGroup",0,rtl.boolean,"FAutoSelectGroup","FAutoSelectGroup",{Default:!1}),e.addProperty("AutoCheckGroup",0,rtl.boolean,"FAutoCheckGroup","FAutoCheckGroup",{Default:!1}),e.addProperty("CalcFormat",0,rtl.string,"FCalcFormat","FCalcFormat"),e.addProperty("MergeHeader",0,rtl.boolean,"FMergeHeader","FMergeHeader",{Default:!1}),e.addProperty("MergeSummary",0,rtl.boolean,"FMergeSummary","FMergeSummary",{Default:!1}),e.addProperty("ShowGroupCount",0,rtl.boolean,"FShowGroupCount","FShowGroupCount",{Default:!1}),e.addProperty("GroupCountFormat",0,rtl.string,"FGroupCountFormat","FGroupCountFormat"),e.addProperty("Summary",0,rtl.boolean,"FSummary","FSummary",{Default:!1})})),this.TTMSFNCGridClipboardPasteAction={0:"paReplace",paReplace:0,1:"paInsert",paInsert:1},this.$rtti.$Enum("TTMSFNCGridClipboardPasteAction",{minvalue:0,maxvalue:1,ordtype:1,enumtype:this.TTMSFNCGridClipboardPasteAction}),rtl.createClass(this,"TTMSFNCGridClipboardOptions",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FEnabled=!1,this.FIgnoreReadOnly=!1,this.FAllowColGrow=!1,this.FAllowRowGrow=!1,this.FPasteAction=0},this.Create$1=function(){return pas.System.TObject.Create.call(this),this.FEnabled=!0,this.FIgnoreReadOnly=!1,this.FAllowColGrow=!1,this.FAllowRowGrow=!1,this.FPasteAction=0,this},this.Assign=function(e){t.TTMSFNCGridClipboardOptions.isPrototypeOf(e)&&(this.FEnabled=rtl.as(e,t.TTMSFNCGridClipboardOptions).FEnabled,this.FIgnoreReadOnly=rtl.as(e,t.TTMSFNCGridClipboardOptions).FIgnoreReadOnly,this.FAllowColGrow=rtl.as(e,t.TTMSFNCGridClipboardOptions).FAllowColGrow,this.FAllowRowGrow=rtl.as(e,t.TTMSFNCGridClipboardOptions).FAllowRowGrow,this.FPasteAction=rtl.as(e,t.TTMSFNCGridClipboardOptions).FPasteAction)};var e=this.$rtti;e.addProperty("Enabled",0,rtl.boolean,"FEnabled","FEnabled",{Default:!0}),e.addProperty("IgnoreReadOnly",0,rtl.boolean,"FIgnoreReadOnly","FIgnoreReadOnly",{Default:!1}),e.addProperty("AllowColGrow",0,rtl.boolean,"FAllowColGrow","FAllowColGrow",{Default:!1}),e.addProperty("AllowRowGrow",0,rtl.boolean,"FAllowRowGrow","FAllowRowGrow",{Default:!1}),e.addProperty("PasteAction",0,t.$rtti.TTMSFNCGridClipboardPasteAction,"FPasteAction","FPasteAction",{Default:t.TTMSFNCGridClipboardPasteAction.paReplace})})),rtl.createClass(this,"TTMSFNCGridHTMLExportOptions",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FHeaderFile="",this.FFooterFile="",this.FShow=!1,this.FConvertSpecialChars=!1,this.FWidth=0,this.FNonBreakingText=!1,this.FBorderSize=0,this.FCellPadding=0,this.FPrefixTag="",this.FSuffixTag="",this.FSaveFonts=!1,this.FExportImages=!1,this.FCellSpacing=0,this.FSummary="",this.FSaveColors=!1,this.FXHTML=!1,this.FTableStyle="",this.FColumnWidths=null},this.$final=function(){this.FColumnWidths=void 0,pas.Classes.TPersistent.$final.call(this)},this.Create$1=function(){return pas.System.TObject.Create.call(this),this.FShow=!1,this.FSaveColors=!0,this.FSaveFonts=!0,this.FBorderSize=1,this.FCellSpacing=0,this.FCellPadding=0,this.FWidth=100,this.FExportImages=!0,this.FColumnWidths=pas["WEBLib.TMSFNCGridDataUtil"].TTMSFNCGridIntList.$create("Create$1"),this},this.Destroy=function(){rtl.free(this,"FColumnWidths"),pas.System.TObject.Destroy.call(this)},this.Assign=function(e){t.TTMSFNCGridHTMLExportOptions.isPrototypeOf(e)&&(this.FHeaderFile=rtl.as(e,t.TTMSFNCGridHTMLExportOptions).FHeaderFile,this.FFooterFile=rtl.as(e,t.TTMSFNCGridHTMLExportOptions).FFooterFile,this.FShow=rtl.as(e,t.TTMSFNCGridHTMLExportOptions).FShow,this.FBorderSize=rtl.as(e,t.TTMSFNCGridHTMLExportOptions).FBorderSize,this.FCellSpacing=rtl.as(e,t.TTMSFNCGridHTMLExportOptions).FCellSpacing,this.FCellPadding=rtl.as(e,t.TTMSFNCGridHTMLExportOptions).FCellPadding,this.FConvertSpecialChars=rtl.as(e,t.TTMSFNCGridHTMLExportOptions).FConvertSpecialChars,this.FExportImages=rtl.as(e,t.TTMSFNCGridHTMLExportOptions).FExportImages,this.FNonBreakingText=rtl.as(e,t.TTMSFNCGridHTMLExportOptions).FNonBreakingText,this.FPrefixTag=rtl.as(e,t.TTMSFNCGridHTMLExportOptions).FPrefixTag,this.FSaveColors=rtl.as(e,t.TTMSFNCGridHTMLExportOptions).FSaveColors,this.FSaveFonts=rtl.as(e,t.TTMSFNCGridHTMLExportOptions).FSaveFonts,this.FSuffixTag=rtl.as(e,t.TTMSFNCGridHTMLExportOptions).FSuffixTag,this.FSummary=rtl.as(e,t.TTMSFNCGridHTMLExportOptions).FSummary,this.FTableStyle=rtl.as(e,t.TTMSFNCGridHTMLExportOptions).FTableStyle,this.FWidth=rtl.as(e,t.TTMSFNCGridHTMLExportOptions).FWidth,this.FXHTML=rtl.as(e,t.TTMSFNCGridHTMLExportOptions).FXHTML)};var e=this.$rtti;e.addProperty("BorderSize",0,rtl.longint,"FBorderSize","FBorderSize",{Default:1}),e.addProperty("CellSpacing",0,rtl.longint,"FCellSpacing","FCellSpacing",{Default:0}),e.addProperty("CellPadding",0,rtl.longint,"FCellPadding","FCellPadding",{Default:0}),e.addProperty("ConvertSpecialChars",0,rtl.boolean,"FConvertSpecialChars","FConvertSpecialChars",{Default:!1}),e.addProperty("ExportImages",0,rtl.boolean,"FExportImages","FExportImages",{Default:!0}),e.addProperty("FooterFile",0,rtl.string,"FFooterFile","FFooterFile"),e.addProperty("HeaderFile",0,rtl.string,"FHeaderFile","FHeaderFile"),e.addProperty("NonBreakingText",0,rtl.boolean,"FNonBreakingText","FNonBreakingText",{Default:!1}),e.addProperty("PrefixTag",0,rtl.string,"FPrefixTag","FPrefixTag"),e.addProperty("SaveColors",0,rtl.boolean,"FSaveColors","FSaveColors",{Default:!0}),e.addProperty("SaveFonts",0,rtl.boolean,"FSaveFonts","FSaveFonts",{Default:!0}),e.addProperty("SuffixTag",0,rtl.string,"FSuffixTag","FSuffixTag"),e.addProperty("Show",0,rtl.boolean,"FShow","FShow",{Default:!1}),e.addProperty("Summary",0,rtl.string,"FSummary","FSummary"),e.addProperty("TableStyle",0,rtl.string,"FTableStyle","FTableStyle"),e.addProperty("Width",0,rtl.longint,"FWidth","FWidth",{Default:100}),e.addProperty("XHTML",0,rtl.boolean,"FXHTML","FXHTML",{Default:!1})})),rtl.createClass(this,"TTMSFNCGridURLOptions",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FUnderline=!1,this.FColor=0,this.FShow=!1,this.FOnChange=null,this.FFull=!1,this.FOpen=!1},this.$final=function(){this.FOnChange=void 0,pas.Classes.TPersistent.$final.call(this)},this.SetColor=function(t){this.FColor!==t&&(this.FColor=t,this.Changed())},this.SetUnderline=function(t){this.FUnderline!==t&&(this.FUnderline=t,this.Changed())},this.SetFull=function(t){this.FFull!==t&&(this.FFull=t,this.Changed())},this.Create$1=function(){return pas.System.TObject.Create.call(this),this.FShow=!0,this.FColor=16711680,this.FUnderline=!0,this.FFull=!0,this.FOpen=!0,this},this.Assign=function(e){t.TTMSFNCGridURLOptions.isPrototypeOf(e)&&(this.FShow=rtl.as(e,t.TTMSFNCGridURLOptions).FShow,this.FUnderline=rtl.as(e,t.TTMSFNCGridURLOptions).FUnderline,this.FColor=rtl.as(e,t.TTMSFNCGridURLOptions).FColor,this.FOpen=rtl.as(e,t.TTMSFNCGridURLOptions).FOpen,this.FFull=rtl.as(e,t.TTMSFNCGridURLOptions).FFull)},this.Changed=function(){null!=this.FOnChange&&this.FOnChange(this)};var e=this.$rtti;e.addProperty("Color",2,pas["WEBLib.Graphics"].$rtti.TColor,"FColor","SetColor",{Default:16711680}),e.addProperty("Full",2,rtl.boolean,"FFull","SetFull",{Default:!0}),e.addProperty("Open",0,rtl.boolean,"FOpen","FOpen",{Default:!0}),e.addProperty("Show",0,rtl.boolean,"FShow","FShow",{Default:!0}),e.addProperty("Underline",2,rtl.boolean,"FUnderline","SetUnderline",{Default:!0}),e.addProperty("OnChange",0,pas.Classes.$rtti.TNotifyEvent,"FOnChange","FOnChange")})),rtl.createClass(this,"TTMSFNCGridIOOptions",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FDelimiter="",this.FQuoteEmptyCells=!1,this.FXMLEncoding="",this.FAlwaysQuotes=!1,this.FSaveVirtualCellData=!1},this.Create$1=function(){return pas.System.TObject.Create.call(this),this.FDelimiter="\0",this.FQuoteEmptyCells=!0,this.FXMLEncoding="ISO-8859-1",this.FAlwaysQuotes=!1,this.FSaveVirtualCellData=!0,this},this.Assign=function(e){t.TTMSFNCGridIOOptions.isPrototypeOf(e)&&(this.FAlwaysQuotes=rtl.as(e,t.TTMSFNCGridIOOptions).FAlwaysQuotes,this.FDelimiter=rtl.as(e,t.TTMSFNCGridIOOptions).FDelimiter,this.FQuoteEmptyCells=rtl.as(e,t.TTMSFNCGridIOOptions).FQuoteEmptyCells,this.FXMLEncoding=rtl.as(e,t.TTMSFNCGridIOOptions).FXMLEncoding,this.FSaveVirtualCellData=rtl.as(e,t.TTMSFNCGridIOOptions).FSaveVirtualCellData)};var e=this.$rtti;e.addProperty("AlwaysQuotes",0,rtl.boolean,"FAlwaysQuotes","FAlwaysQuotes",{Default:!1}),e.addProperty("Delimiter",0,rtl.char,"FDelimiter","FDelimiter",{Default:"\0"}),e.addProperty("QuoteEmptyCells",0,rtl.boolean,"FQuoteEmptyCells","FQuoteEmptyCells",{Default:!0}),e.addProperty("XMLEncoding",0,rtl.string,"FXMLEncoding","FXMLEncoding"),e.addProperty("SaveVirtualCellData",0,rtl.boolean,"FSaveVirtualCellData","FSaveVirtualCellData",{Default:!0})})),rtl.createClass(this,"TTMSFNCGridCellOptions",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FDisplayHTMLFormatting=!1,this.FOnChange=null},this.$final=function(){this.FOnChange=void 0,pas.Classes.TPersistent.$final.call(this)},this.SetDisplayHTMLFormatting=function(t){this.FDisplayHTMLFormatting!==t&&(this.FDisplayHTMLFormatting=t,null!=this.FOnChange&&this.FOnChange(this))},this.Create$1=function(){return pas.System.TObject.Create.call(this),this.FDisplayHTMLFormatting=!1,this},this.Assign=function(e){t.TTMSFNCGridCellOptions.isPrototypeOf(e)&&(this.FDisplayHTMLFormatting=rtl.as(e,t.TTMSFNCGridCellOptions).FDisplayHTMLFormatting)},this.$rtti.addProperty("DisplayHTMLFormatting",2,rtl.boolean,"FDisplayHTMLFormatting","SetDisplayHTMLFormatting",{Default:!1})})),rtl.createClass(this,"TTMSFNCGridColumnSizeOptions",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FStretch=!1,this.FStretchAll=!1,this.FStretchColumn=0,this.FOnChange=null,this.FSyncWithGrid=!1,this.FSyncNormalCellsOnly=!1},this.$final=function(){this.FOnChange=void 0,pas.Classes.TPersistent.$final.call(this)},this.SetStretch=function(t){this.FStretch!==t&&(this.FStretch=t,null!=this.FOnChange&&this.FOnChange(this))},this.SetStretchAll=function(t){this.FStretchAll!==t&&(this.FStretchAll=t,null!=this.FOnChange&&this.FOnChange(this))},this.SetStretchColumn=function(t){this.FStretchColumn!==t&&(this.FStretchColumn=t,null!=this.FOnChange&&this.FOnChange(this))},this.SetNormalCellsOnly=function(t){this.FSyncNormalCellsOnly!==t&&(this.FSyncNormalCellsOnly=t,null!=this.FOnChange&&this.FOnChange(this))},this.SetSyncWithGrid=function(t){this.FSyncWithGrid!==t&&(this.FSyncWithGrid=t,null!=this.FOnChange&&this.FOnChange(this))},this.Create$1=function(){return this.FStretch=!1,this.FStretchAll=!1,this.FStretchColumn=-1,this.FSyncWithGrid=!1,this.FSyncNormalCellsOnly=!1,this},this.Assign=function(e){t.TTMSFNCGridColumnSizeOptions.isPrototypeOf(e)&&(this.FStretch=rtl.as(e,t.TTMSFNCGridColumnSizeOptions).FStretch,this.FStretchAll=rtl.as(e,t.TTMSFNCGridColumnSizeOptions).FStretchAll,this.FStretchColumn=rtl.as(e,t.TTMSFNCGridColumnSizeOptions).FStretchColumn,this.FSyncNormalCellsOnly=rtl.as(e,t.TTMSFNCGridColumnSizeOptions).FSyncNormalCellsOnly,this.FSyncWithGrid=rtl.as(e,t.TTMSFNCGridColumnSizeOptions).FSyncWithGrid)};var e=this.$rtti;e.addProperty("Stretch",2,rtl.boolean,"FStretch","SetStretch",{Default:!1}),e.addProperty("StretchColumn",2,rtl.longint,"FStretchColumn","SetStretchColumn",{Default:-1}),e.addProperty("StretchAll",2,rtl.boolean,"FStretchAll","SetStretchAll",{Default:!1}),e.addProperty("SyncWithGrid",2,rtl.boolean,"FSyncWithGrid","SetSyncWithGrid",{Default:!1}),e.addProperty("SyncNormalCellsOnly",2,rtl.boolean,"FSyncNormalCellsOnly","SetNormalCellsOnly",{Default:!1}),e.addProperty("OnChange",0,pas.Classes.$rtti.TNotifyEvent,"FOnChange","FOnChange")})),rtl.createClass(this,"TTMSFNCGridOptions",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FMouse=null,this.FKeyboard=null,this.FSorting=null,this.FGrouping=null,this.FFiltering=null,this.FEditing=null,this.FBorders=null,this.FLookup=null,this.FClipboard=null,this.FHTMLExport=null,this.FBands=null,this.FOnChange=null,this.FURL=null,this.FScrollBar=null,this.FIO=null,this.FCell=null,this.FColumnSize=null,this.FSelection=null},this.$final=function(){this.FMouse=void 0,this.FKeyboard=void 0,this.FSorting=void 0,this.FGrouping=void 0,this.FFiltering=void 0,this.FEditing=void 0,this.FBorders=void 0,this.FLookup=void 0,this.FClipboard=void 0,this.FHTMLExport=void 0,this.FBands=void 0,this.FOnChange=void 0,this.FURL=void 0,this.FScrollBar=void 0,this.FIO=void 0,this.FCell=void 0,this.FColumnSize=void 0,this.FSelection=void 0,pas.Classes.TPersistent.$final.call(this)},this.SetKeyboard=function(t){this.FKeyboard.Assign(t)},this.SetMouse=function(t){this.FMouse.Assign(t)},this.SetGrouping=function(t){this.FGrouping.Assign(t)},this.SetSorting=function(t){this.FSorting.Assign(t)},this.SetFiltering=function(t){this.FFiltering.Assign(t)},this.SetEditing=function(t){this.FEditing.Assign(t)},this.SetBorders=function(t){this.FBorders.Assign(t)},this.SetLookup=function(t){this.FLookup.Assign(t)},this.SetClipboard=function(t){this.FClipboard.Assign(t)},this.SetHTMLExport=function(t){this.FHTMLExport.Assign(t)},this.SetBands=function(t){this.FBands.Assign(t)},this.SetURL=function(t){this.FURL.Assign(t)},this.SetScrollBar=function(t){this.FScrollBar.Assign(t)},this.SetIO=function(t){this.FIO.Assign(t)},this.SetCell=function(t){this.FCell.Assign(t)},this.SetColumnSize=function(t){this.FColumnSize.Assign(t)},this.SetSelection=function(t){this.FSelection.Assign(t)},this.DoChange=function(t){null!=this.FOnChange&&this.FOnChange(this)},this.Create$1=function(){return pas.System.TObject.Create.call(this),this.FScrollBar=t.TTMSFNCGridScrollBarOptions.$create("Create$1"),this.FScrollBar.FOnChange=rtl.createCallback(this,"DoChange"),this.FMouse=t.TTMSFNCGridMouseOptions.$create("Create$1"),this.FKeyboard=t.TTMSFNCGridKeyboardOptions.$create("Create$1"),this.FSorting=t.TTMSFNCGridSortingOptions.$create("Create$1"),this.FGrouping=t.TTMSFNCGridGroupingOptions.$create("Create$1"),this.FFiltering=t.TTMSFNCGridFilteringOptions.$create("Create$1"),this.FFiltering.FOnChange=rtl.createCallback(this,"DoChange"),this.FCell=t.TTMSFNCGridCellOptions.$create("Create$1"),this.FCell.FOnChange=rtl.createCallback(this,"DoChange"),this.FEditing=t.TTMSFNCGridEditingOptions.$create("Create$1"),this.FColumnSize=t.TTMSFNCGridColumnSizeOptions.$create("Create$1"),this.FColumnSize.FOnChange=rtl.createCallback(this,"DoChange"),this.FBorders=t.TTMSFNCGridBorderOptions.$create("Create$1"),this.FLookup=t.TTMSFNCGridLookupOptions.$create("Create$1"),this.FClipboard=t.TTMSFNCGridClipboardOptions.$create("Create$1"),this.FHTMLExport=t.TTMSFNCGridHTMLExportOptions.$create("Create$1"),this.FIO=t.TTMSFNCGridIOOptions.$create("Create$1"),this.FBands=t.TTMSFNCGridBandOptions.$create("Create$1"),this.FBands.FOnChange=rtl.createCallback(this,"DoChange"),this.FURL=t.TTMSFNCGridURLOptions.$create("Create$1"),this.FURL.FOnChange=rtl.createCallback(this,"DoChange"),this.FSelection=t.TTMSFNCGridSelection.$create("Create$1"),this.FSelection.FOnChange=rtl.createCallback(this,"DoChange"),this},this.Destroy=function(){rtl.free(this,"FCell"),rtl.free(this,"FColumnSize"),rtl.free(this,"FScrollBar"),rtl.free(this,"FBands"),rtl.free(this,"FBorders"),rtl.free(this,"FEditing"),rtl.free(this,"FMouse"),rtl.free(this,"FKeyboard"),rtl.free(this,"FSorting"),rtl.free(this,"FGrouping"),rtl.free(this,"FFiltering"),rtl.free(this,"FLookup"),rtl.free(this,"FClipboard"),rtl.free(this,"FHTMLExport"),rtl.free(this,"FURL"),rtl.free(this,"FIO"),rtl.free(this,"FSelection"),pas.System.TObject.Destroy.call(this)},this.Assign=function(e){t.TTMSFNCGridOptions.isPrototypeOf(e)&&(this.FMouse.Assign(rtl.as(e,t.TTMSFNCGridOptions).FMouse),this.FKeyboard.Assign(rtl.as(e,t.TTMSFNCGridOptions).FKeyboard),this.FFiltering.Assign(rtl.as(e,t.TTMSFNCGridOptions).FFiltering),this.FSorting.Assign(rtl.as(e,t.TTMSFNCGridOptions).FSorting),this.FGrouping.Assign(rtl.as(e,t.TTMSFNCGridOptions).FGrouping),this.FEditing.Assign(rtl.as(e,t.TTMSFNCGridOptions).FEditing),this.FBorders.Assign(rtl.as(e,t.TTMSFNCGridOptions).FBorders),this.FLookup.Assign(rtl.as(e,t.TTMSFNCGridOptions).FLookup),this.FClipboard.Assign(rtl.as(e,t.TTMSFNCGridOptions).FClipboard),this.FCell.Assign(rtl.as(e,t.TTMSFNCGridOptions).FCell),this.FBands.Assign(rtl.as(e,t.TTMSFNCGridOptions).FBands),this.FHTMLExport.Assign(rtl.as(e,t.TTMSFNCGridOptions).FHTMLExport),this.FURL.Assign(rtl.as(e,t.TTMSFNCGridOptions).FURL),this.FScrollBar.Assign(rtl.as(e,t.TTMSFNCGridOptions).FScrollBar),this.FIO.Assign(rtl.as(e,t.TTMSFNCGridOptions).FIO),this.FSelection.Assign(rtl.as(e,t.TTMSFNCGridOptions).FSelection),this.FColumnSize.Assign(rtl.as(e,t.TTMSFNCGridOptions).FColumnSize))};var e=this.$rtti;e.addProperty("Bands",2,t.$rtti.TTMSFNCGridBandOptions,"FBands","SetBands"),e.addProperty("Borders",2,t.$rtti.TTMSFNCGridBorderOptions,"FBorders","SetBorders"),e.addProperty("Cell",2,t.$rtti.TTMSFNCGridCellOptions,"FCell","SetCell"),e.addProperty("ColumnSize",2,t.$rtti.TTMSFNCGridColumnSizeOptions,"FColumnSize","SetColumnSize"),e.addProperty("Clipboard",2,t.$rtti.TTMSFNCGridClipboardOptions,"FClipboard","SetClipboard"),e.addProperty("Editing",2,t.$rtti.TTMSFNCGridEditingOptions,"FEditing","SetEditing"),e.addProperty("Filtering",2,t.$rtti.TTMSFNCGridFilteringOptions,"FFiltering","SetFiltering"),e.addProperty("Grouping",2,t.$rtti.TTMSFNCGridGroupingOptions,"FGrouping","SetGrouping"),e.addProperty("HTMLExport",2,t.$rtti.TTMSFNCGridHTMLExportOptions,"FHTMLExport","SetHTMLExport"),e.addProperty("IO",2,t.$rtti.TTMSFNCGridIOOptions,"FIO","SetIO"),e.addProperty("Keyboard",2,t.$rtti.TTMSFNCGridKeyboardOptions,"FKeyboard","SetKeyboard"),e.addProperty("Lookup",2,t.$rtti.TTMSFNCGridLookupOptions,"FLookup","SetLookup"),e.addProperty("Mouse",2,t.$rtti.TTMSFNCGridMouseOptions,"FMouse","SetMouse"),e.addProperty("Sorting",2,t.$rtti.TTMSFNCGridSortingOptions,"FSorting","SetSorting"),e.addProperty("URL",2,t.$rtti.TTMSFNCGridURLOptions,"FURL","SetURL"),e.addProperty("ScrollBar",2,t.$rtti.TTMSFNCGridScrollBarOptions,"FScrollBar","SetScrollBar"),e.addProperty("Selection",2,t.$rtti.TTMSFNCGridSelection,"FSelection","SetSelection")}))}),["Types"]),rtl.module("WEBLib.TMSFNCGridData",["System","Classes","SysUtils","WEBLib.Controls","WEBLib.TMSFNCGraphics","WEBLib.TMSFNCGridCell","WEBLib.TMSFNCGridDataUtil","WEBLib.Graphics","WEBLib.TMSFNCTypes","WEBLib.TMSFNCCustomScrollControl","Types","WEBLib.TMSFNCBitmapContainer","WEBLib.TMSFNCGridOptions","WEBLib.TMSFNCGraphicsTypes","Web","contnrs","WEBLib.StdCtrls"],(function(){"use strict";var t=this,e=t.$impl;this.$rtti.$ClassRef("TTMSFNCGridEditorClass",{instancetype:pas["WEBLib.Controls"].$rtti.TWinControl}),this.$rtti.$Class("TTMSFNCGridData"),rtl.recNewT(this,"TTMSFNCGridCellRec",(function(){this.Col=0,this.Row=0,this.$eq=function(t){return this.Col===t.Col&&this.Row===t.Row},this.$assign=function(t){return this.Col=t.Col,this.Row=t.Row,this}})),rtl.recNewT(this,"TTMSFNCGridCellRecRange",(function(){this.StartCol=0,this.StartRow=0,this.EndCol=0,this.EndRow=0,this.$eq=function(t){return this.StartCol===t.StartCol&&this.StartRow===t.StartRow&&this.EndCol===t.EndCol&&this.EndRow===t.EndRow},this.$assign=function(t){return this.StartCol=t.StartCol,this.StartRow=t.StartRow,this.EndCol=t.EndCol,this.EndRow=t.EndRow,this};var e=t.$rtti.$Record("TTMSFNCGridCellRecRange",{});e.addField("StartCol",rtl.longint),e.addField("StartRow",rtl.longint),e.addField("EndCol",rtl.longint),e.addField("EndRow",rtl.longint)})),this.TTMSFNCGridCellState={0:"csNormal",csNormal:0,1:"csFocused",csFocused:1,2:"csFixed",csFixed:2,3:"csFixedSelected",csFixedSelected:3,4:"csSelected",csSelected:4},this.$rtti.$Enum("TTMSFNCGridCellState",{minvalue:0,maxvalue:4,ordtype:1,enumtype:this.TTMSFNCGridCellState}),this.TTMSFNCGridSortDirection={0:"sdAscending",sdAscending:0,1:"sdDescending",sdDescending:1},this.$rtti.$Enum("TTMSFNCGridSortDirection",{minvalue:0,maxvalue:1,ordtype:1,enumtype:this.TTMSFNCGridSortDirection}),this.TTMSFNCGridSortFormat={0:"ssAutomatic",ssAutomatic:0,1:"ssAlphabetic",ssAlphabetic:1,2:"ssAlphabeticNoCase",ssAlphabeticNoCase:2,3:"ssNumeric",ssNumeric:3,4:"ssDate",ssDate:4,5:"ssHTML",ssHTML:5,6:"ssCheckBox",ssCheckBox:6,7:"ssCustom",ssCustom:7,8:"ssRaw",ssRaw:8},this.$rtti.$Enum("TTMSFNCGridSortFormat",{minvalue:0,maxvalue:8,ordtype:1,enumtype:this.TTMSFNCGridSortFormat}),this.$rtti.$MethodVar("TTMSFNCGridSortFormatEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["Col",rtl.longint],["SortFormat",this.$rtti.TTMSFNCGridSortFormat,1],["APrefix",rtl.string,1],["ASuffix",rtl.string,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCGridCustomCompareEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["Value1",rtl.string],["Value2",rtl.string],["res",rtl.longint,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCGridRawCompareEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["Col",rtl.longint],["Row1",rtl.longint],["Row2",rtl.longint],["res",rtl.longint,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCGridClipboardBeforePasteEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["Col",rtl.longint],["Row",rtl.longint],["Value",rtl.string,1],["Allow",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCGridClipboardAfterPasteEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["Col",rtl.longint],["Row",rtl.longint],["Value",rtl.string]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCGridNeedFilterDropDownEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["Col",rtl.longint],["Row",rtl.longint],["Allow",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCGridNeedFilterDropDownDataEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["Col",rtl.longint],["Row",rtl.longint],["AValues",pas.Classes.$rtti.TStrings]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCGridFilterSelectEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["Col",rtl.longint],["Condition",rtl.string,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCGridAfterApplyFilterEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["Col",rtl.longint],["Condition",rtl.string],["UpdateCalculations",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCGridCellsChangedEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["Cells",this.$rtti.TTMSFNCGridCellRecRange]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCGridColumnCalcEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ACol",rtl.longint],["FromRow",rtl.longint],["ToRow",rtl.longint],["Res",rtl.double,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCGridOnSelectCell",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ACol",rtl.longint],["ARow",rtl.longint],["Allow",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCGridOnSelectedCell",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ACol",rtl.longint],["ARow",rtl.longint]]),methodkind:0}),this.TTMSFNCGridColumnCalculation={0:"ccNone",ccNone:0,1:"ccSum",ccSum:1,2:"ccAvg",ccAvg:2,3:"ccCount",ccCount:3,4:"ccMin",ccMin:4,5:"ccMax",ccMax:5,6:"ccCUSTOM",ccCUSTOM:6,7:"ccDistinct",ccDistinct:7,8:"ccStdDev",ccStdDev:8},this.TTMSFNCGridCellCalcState={0:"csNoCalc",csNoCalc:0,1:"csCalcOk",csCalcOk:1,2:"csCalcErr",csCalcErr:2},rtl.createClass(this,"TTMSFNCGridCellProperty",pas.System.TObject,(function(){this.$init=function(){pas.System.TObject.$init.call(this),this.FDefaultFont=null,this.FColor=0,this.FBaseCol=0,this.FBaseRow=0,this.FColSpan=0,this.FRowSpan=0,this.FAlignHorz=0,this.FAlignVert=0,this.FControl=null,this.FObject=null,this.FReadOnly=!1,this.FPrintPageNr=0,this.FFontStyle={},this.FFontSize=0,this.FFontName="",this.FFontColor=0,this.FAngle=0,this.FComment="",this.FCommentColor=0,this.FBorderColor=0,this.FBorderWidth=0,this.FWordWrap=!1,this.FFixed=!1,this.FCalcState=0,this.FNameIndex=0},this.$final=function(){this.FDefaultFont=void 0,this.FControl=void 0,this.FObject=void 0,this.FFontStyle=void 0,pas.System.TObject.$final.call(this)},this.Create$1=function(t){return pas.System.TObject.Create.call(this),this.FDefaultFont=t,this.FColSpan=-1,this.FRowSpan=-1,this.FBaseCol=-1,this.FBaseRow=-1,this.FColor=-1,this.FBorderColor=-1,this.FControl=null,this.FPrintPageNr=-1,this.FBorderWidth=1,this.FAngle=0,this.FAlignHorz=1,this.FAlignVert=0,this.FFontSize=t.FSize,this.FFontStyle=rtl.refSet(t.FStyle),this.FCommentColor=-1,this.FComment="",this.FCalcState=0,this.FNameIndex=-1,this},this.Destroy=function(){null!=this.FControl&&pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FControl},set:function(t){this.p.FControl=t}}),pas.System.TObject.Destroy.call(this)},this.IsBaseCell=function(t,e){return t===this.FBaseCol&&e===this.FBaseRow||-1===this.FBaseCol&&-1===this.FBaseRow},this.FreeControl=function(){pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FControl},set:function(t){this.p.FControl=t}})}})),rtl.createClass(this,"TTMSFNCGridCellCheckBox",pas.System.TObject,(function(){this.$init=function(){pas.System.TObject.$init.call(this),this.FChecked=!1,this.FHeader=!1}})),rtl.createClass(this,"TTMSFNCGridCellDataCheckBox",pas.System.TObject,(function(){})),rtl.createClass(this,"TTMSFNCGridCellRadioButton",pas.System.TObject,(function(){this.$init=function(){pas.System.TObject.$init.call(this),this.FChecked=!1,this.FIndex=0}})),rtl.createClass(this,"TTMSFNCGridCellButton",pas.System.TObject,(function(){this.$init=function(){pas.System.TObject.$init.call(this),this.FText="",this.FWidth=0,this.FHeight=0}})),rtl.createClass(this,"TTMSFNCGridCellBitmapName",pas.System.TObject,(function(){this.$init=function(){pas.System.TObject.$init.call(this),this.FBitmapName="",this.FData=!1}})),rtl.createClass(this,"TTMSFNCGridCellBitmap",pas.System.TObject,(function(){this.$init=function(){pas.System.TObject.$init.call(this),this.FBitmap=null},this.$final=function(){this.FBitmap=void 0,pas.System.TObject.$final.call(this)},this.Destroy=function(){rtl.free(this,"FBitmap"),pas.System.TObject.Destroy.call(this)}})),rtl.createClass(this,"TTMSFNCGridCellNode",pas.System.TObject,(function(){this.$init=function(){pas.System.TObject.$init.call(this),this.FState=0,this.FSpan=0}})),rtl.createClass(this,"TTMSFNCGridCellSummary",pas.System.TObject,(function(){})),rtl.createClass(this,"TTMSFNCGridCellProgressBar",pas.System.TObject,(function(){this.$init=function(){pas.System.TObject.$init.call(this),this.FValue=0,this.FData=!1}})),rtl.createClass(this,"TTMSFNCGridCellCombo",pas.System.TObject,(function(){this.$init=function(){pas.System.TObject.$init.call(this),this.FItems=null},this.$final=function(){this.FItems=void 0,pas.System.TObject.$final.call(this)},this.Destroy=function(){rtl.free(this,"FItems"),pas.System.TObject.Destroy.call(this)}})),rtl.createClass(this,"TTMSFNCGridSortIndexList",pas["WEBLib.TMSFNCGridDataUtil"].TTMSFNCGridIntList,(function(){this.GetSortDirections=function(t){return!(2147483648==(2147483648&this.GetInteger(t)))},this.AddIndex=function(t,e){0===e?this.Add$1(t):this.Add$1(2147483648|t)},this.FindIndex=function(t){var e=0,i=0;for(e=-1,i=0;i<this.GetCount();){if((2147483647&this.GetInteger(i))===t){e=i;break}i+=1}return e},this.ToggleIndex=function(t){var e=0;for(e=0;e<this.GetCount();){if((2147483647&this.GetInteger(e))===t){2147483648==(2147483648&this.GetInteger(e))?this.SetInteger(e,2147483647&this.GetInteger(e)):this.SetInteger(e,2147483648|this.GetInteger(e));break}e+=1}}})),this.TTMSFNCGridFilterCells={0:"fcVirtual",fcVirtual:0,1:"fcNormal",fcNormal:1,2:"fcStripHTML",fcStripHTML:2,3:"fcRow",fcRow:3},this.$rtti.$Enum("TTMSFNCGridFilterCells",{minvalue:0,maxvalue:3,ordtype:1,enumtype:this.TTMSFNCGridFilterCells}),this.TTMSFNCGridFilterOperation={0:"foSHORT",foSHORT:0,1:"foNONE",foNONE:1,2:"foAND",foAND:2,3:"foXOR",foXOR:3,4:"foOR",foOR:4},this.$rtti.$Enum("TTMSFNCGridFilterOperation",{minvalue:0,maxvalue:4,ordtype:1,enumtype:this.TTMSFNCGridFilterOperation}),this.TTMSFNCGridRowState={0:"rsDefault",rsDefault:0,1:"rsSelected",rsSelected:1},rtl.createClass(this,"TTMSFNCGridDataList",pas.Classes.TStringList,(function(){})),rtl.createClass(this,"TTMSFNCGridRowInfo",pas.System.TObject,(function(){this.$init=function(){pas.System.TObject.$init.call(this),this.FData=null,this.FState=0},this.$final=function(){this.FData=void 0,pas.System.TObject.$final.call(this)},this.SetState=function(t){this.FState=t},this.Create$1=function(){return pas.System.TObject.Create.call(this),this.FData=t.TTMSFNCGridDataList.$create("Create$1"),this.FState=0,this},this.Destroy=function(){rtl.free(this,"FData"),pas.System.TObject.Destroy.call(this)}})),rtl.createClass(this,"TTMSFNCGridFilterData",pas.Classes.TCollectionItem,(function(){this.$init=function(){pas.Classes.TCollectionItem.$init.call(this),this.FColumn=0,this.FCondition="",this.FCaseSensitive=!1,this.FSuffix="",this.FPrefix="",this.FOperation=0,this.FData=0},this.Create$1=function(t){return pas.Classes.TCollectionItem.Create$1.apply(this,arguments),this.FCaseSensitive=!0,this.FData=0,this},this.Assign=function(e){var i;null!=(i=rtl.as(e,t.TTMSFNCGridFilterData))&&(this.FColumn=i.FColumn,this.FCondition=i.FCondition,this.FCaseSensitive=i.FCaseSensitive,this.FData=i.FData,this.FPrefix=i.FPrefix,this.FSuffix=i.FSuffix,this.FOperation=i.FOperation)};var e=this.$rtti;e.addProperty("Column",0,rtl.smallint,"FColumn","FColumn"),e.addProperty("Condition",0,rtl.string,"FCondition","FCondition"),e.addProperty("CaseSensitive",0,rtl.boolean,"FCaseSensitive","FCaseSensitive",{Default:!0}),e.addProperty("Data",0,t.$rtti.TTMSFNCGridFilterCells,"FData","FData",{Default:t.TTMSFNCGridFilterCells.fcVirtual}),e.addProperty("Prefix",0,rtl.string,"FPrefix","FPrefix"),e.addProperty("Suffix",0,rtl.string,"FSuffix","FSuffix"),e.addProperty("Operation",0,t.$rtti.TTMSFNCGridFilterOperation,"FOperation","FOperation")})),rtl.createClass(this,"TTMSFNCGridFilter",pas["WEBLib.TMSFNCTypes"].TTMSFNCOwnedCollection,(function(){this.$init=function(){pas["WEBLib.TMSFNCTypes"].TTMSFNCOwnedCollection.$init.call(this),this.FOwner$1=null},this.$final=function(){this.FOwner$1=void 0,pas["WEBLib.TMSFNCTypes"].TTMSFNCOwnedCollection.$final.call(this)},this.GetItem$1=function(t){return pas.Classes.TCollection.GetItem.call(this,t)},this.Create$3=function(e){return pas.Classes.TOwnedCollection.Create$2.call(this,e,t.TTMSFNCGridFilterData),this.FOwner$1=e,this},this.Add$1=function(){var t=null;return t=pas.Classes.TCollection.Add.call(this),1===this.GetCount()?t.FOperation=1:t.FOperation=2,t}})),rtl.createClass(this,"TTMSFNCGridSingleListItem",pas.Classes.TCollectionItem,(function(){this.$init=function(){pas.Classes.TCollectionItem.$init.call(this),this.FOwner=null,this.FValue=0,this.FCellVal=0},this.$final=function(){this.FOwner=void 0,pas.Classes.TCollectionItem.$final.call(this)},this.SetValue=function(t){this.FValue=t},this.Create$1=function(e){return pas.Classes.TCollectionItem.Create$1.apply(this,arguments),null!=this.FCollection&&(this.FOwner=rtl.as(this.FCollection,t.TTMSFNCGridSingleList).FOwner$1),this};var e=this.$rtti;e.addProperty("Value",2,rtl.double,"FValue","SetValue"),e.addProperty("CellVal",0,rtl.longint,"FCellVal","FCellVal")})),rtl.createClass(this,"TTMSFNCGridSingleList",pas["WEBLib.TMSFNCTypes"].TTMSFNCOwnedCollection,(function(){this.$init=function(){pas["WEBLib.TMSFNCTypes"].TTMSFNCOwnedCollection.$init.call(this),this.FOwner$1=null},this.$final=function(){this.FOwner$1=void 0,pas["WEBLib.TMSFNCTypes"].TTMSFNCOwnedCollection.$final.call(this)},this.GetItem$1=function(t){return this.GetItem(t)},this.IndexOf=function(t){var e=0,i=0;e=-1;for(var s=0,o=this.GetCount()-1;s<=o;s++)if(i=s,this.GetItem$1(i).FCellVal===t)return e=i;return e},this.Create$3=function(e){return pas.Classes.TOwnedCollection.Create$2.call(this,e,t.TTMSFNCGridSingleListItem),this.FOwner$1=e,this},this.Add$1=function(){return pas.Classes.TCollection.Add.call(this)},this.Insert$1=function(t){return pas.Classes.TCollection.Insert.call(this,t)}})),this.TTMSFNCGridMarkType={0:"mtHighlight",mtHighlight:0,1:"mtError",mtError:1},this.$rtti.$Enum("TTMSFNCGridMarkType",{minvalue:0,maxvalue:1,ordtype:1,enumtype:this.TTMSFNCGridMarkType}),rtl.createClass(this,"TTMSFNCGridCellMarkItem",pas.Classes.TCollectionItem,(function(){this.$init=function(){pas.Classes.TCollectionItem.$init.call(this),this.FCellRange=t.TTMSFNCGridCellRecRange.$new(),this.FValue="",this.FCaseSensitive=!1,this.FMarkType=0},this.$final=function(){this.FCellRange=void 0,pas.Classes.TCollectionItem.$final.call(this)};var e=this.$rtti;e.addProperty("CaseSensitive",0,rtl.boolean,"FCaseSensitive","FCaseSensitive"),e.addProperty("Value",0,rtl.string,"FValue","FValue"),e.addProperty("MarkType",0,t.$rtti.TTMSFNCGridMarkType,"FMarkType","FMarkType")})),rtl.createClass(this,"TTMSFNCGridCellMarkList",pas["WEBLib.TMSFNCTypes"].TTMSFNCOwnedCollection,(function(){this.GetItem$1=function(t){return this.GetItem(t)},this.Create$3=function(e){return pas.Classes.TOwnedCollection.Create$2.call(this,e,t.TTMSFNCGridCellMarkItem),this}})),rtl.createClass(this,"TTMSFNCGridCellList",pas.Classes.TList,(function(){this.GetItem=function(e){var i=t.TTMSFNCGridCellRec.$new();return i.$assign(rtl.getObject(this.Get(e))),i},this.Create$2=function(){return pas.Classes.TList.Create$1.call(this),this},this.Destroy=function(){this.Clear$1(),pas.Classes.TList.Destroy.call(this)},this.AddCell=function(e){this.Add(t.TTMSFNCGridCellRec.$clone(e))},this.DeleteCell$1=function(t){t>=0&&t<this.GetCount()&&this.Delete(t)},this.Clear$1=function(){for(;this.GetCount()>0;)this.Delete(this.GetCount()-1)},this.Find=function(e){var i=0,s=0,o=t.TTMSFNCGridCellRec.$new();i=-1;for(var n=this.GetCount()-1;n>=0;n--)if(s=n,o.$assign(this.GetItem(s)),o.Col===e.Col&&o.Row===e.Row){i=s;break}return i},this.FindFixed=function(e){var i=0,s=0,o=t.TTMSFNCGridCellRec.$new();i=-1;for(var n=this.GetCount()-1;n>=0;n--)if(s=n,o.$assign(this.GetItem(s)),o.Row===e.Row||o.Col===e.Col){i=s;break}return i}})),this.TTMSFNCGridExportState={0:"esExportStart",esExportStart:0,1:"esExportNewRow",esExportNewRow:1,2:"esExportDone",esExportDone:2,3:"esExportSelRow",esExportSelRow:3,4:"esExportFail",esExportFail:4,5:"esExportNextRow",esExportNextRow:5,6:"esExportFindRow",esExportFindRow:6},this.TTMSFNCGridEditorType={0:"etEdit",etEdit:0,1:"etNumericEdit",etNumericEdit:1,2:"etSignedNumericEdit",etSignedNumericEdit:2,3:"etFloatEdit",etFloatEdit:3,4:"etSignedFloatEdit",etSignedFloatEdit:4,5:"etUppercaseEdit",etUppercaseEdit:5,6:"etMixedCaseEdit",etMixedCaseEdit:6,7:"etLowerCaseEdit",etLowerCaseEdit:7,8:"etMoneyEdit",etMoneyEdit:8,9:"etHexEdit",etHexEdit:9,10:"etAlphaNumericEdit",etAlphaNumericEdit:10,11:"etValidCharsEdit",etValidCharsEdit:11,12:"etComboBox",etComboBox:12,13:"etSpinBox",etSpinBox:13,14:"etDatePicker",etDatePicker:14,15:"etColorPicker",etColorPicker:15,16:"etTrackBar",etTrackBar:16,17:"etMemo",etMemo:17,18:"etCustom",etCustom:18},this.$rtti.$Enum("TTMSFNCGridEditorType",{minvalue:0,maxvalue:18,ordtype:1,enumtype:this.TTMSFNCGridEditorType}),this.$rtti.$MethodVar("TTMSFNCGridIOProgressEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["CurrentRow",rtl.longint],["TotalRows",rtl.longint],["Progres",rtl.smallint]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCGridIOEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["Col",rtl.longint],["Row",rtl.longint],["Value",rtl.string,1]]),methodkind:0}),this.TTMSFNCGridColumnType={0:"ctDefault",ctDefault:0,1:"ctButton",ctButton:1,2:"ctCheckBox",ctCheckBox:2,3:"ctProgressBar",ctProgressBar:3,4:"ctRadioButton",ctRadioButton:4},this.$rtti.$Enum("TTMSFNCGridColumnType",{minvalue:0,maxvalue:4,ordtype:1,enumtype:this.TTMSFNCGridColumnType}),rtl.createClass(this,"TTMSFNCGridColumn",pas.Classes.TCollectionItem,(function(){this.$init=function(){pas.Classes.TCollectionItem.$init.call(this),this.FGrid=null,this.FColor=0,this.FVertAlignment=0,this.FHorzAlignment=0,this.FSortFormat=0,this.FFont=null,this.FEditor=0,this.FReadOnly=!1,this.FBorderColor=0,this.FID$1="",this.FBorderWidth=0,this.FWordWrap=!1,this.FFixed=!1,this.FSortPrefix="",this.FSortSuffix="",this.FTag=0,this.FComboItems=null,this.FColumnType=0,this.FName="",this.FFixedFont=null},this.$final=function(){this.FGrid=void 0,this.FFont=void 0,this.FComboItems=void 0,this.FFixedFont=void 0,pas.Classes.TCollectionItem.$final.call(this)},this.SetColor=function(t){this.FColor!==t&&(this.FColor=t,this.Changed$1())},this.SetHorzAlignment=function(t){this.FHorzAlignment!==t&&(this.FHorzAlignment=t,this.Changed$1())},this.SetVertAlignment=function(t){this.FVertAlignment!==t&&(this.FVertAlignment=t,this.Changed$1())},this.SetFont=function(t){this.FFont.Assign(t),this.Changed$1()},this.SetBorderColor=function(t){this.FBorderColor!==t&&(this.FBorderColor=t,this.Changed$1())},this.SetBorderWidth=function(t){this.FBorderWidth!==t&&(this.FBorderWidth=t,this.Changed$1())},this.SetWordWrap=function(t){this.FWordWrap!==t&&(this.FWordWrap=t,this.Changed$1())},this.SetFixed=function(t){this.FFixed!==t&&(this.FFixed=t,this.Changed$1())},this.SetComboItems=function(t){this.FComboItems.Assign(t)},this.SetColumnType=function(t){this.FColumnType!==t&&(this.FColumnType=t,this.Changed$1())},this.GetWidth=function(){return rtl.as(this.FCollection.Owner(),t.TTMSFNCGridData).GetColWidths(this.GetIndex())},this.SetWidth=function(e){null!==this.FCollection&&(rtl.as(this.FCollection.Owner(),t.TTMSFNCGridData).BeginUpdate(),rtl.as(this.FCollection.Owner(),t.TTMSFNCGridData).SetColWidths(this.GetIndex(),e),rtl.as(this.FCollection.Owner(),t.TTMSFNCGridData).EndUpdate())},this.SetFixedFont=function(t){this.FFixedFont.Assign(t),this.Changed$1()},this.IsWidthStored=function(){return 64!==this.GetWidth()},this.Changed$1=function(){null!=this.FGrid&&this.FGrid.UpdateGridCells(!1)},this.Create$1=function(e){return pas.Classes.TCollectionItem.Create$1.apply(this,arguments),null!=this.FCollection&&(this.FGrid=rtl.as(this.FCollection,t.TTMSFNCGridColumns).FGrid),this.FColor=-1,this.FFont=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFont.$create("Create$2"),this.FFixedFont=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFont.$create("Create$2"),this.FFixedFont.SetStyle(rtl.createSet(0)),this.FEditor=0,this.FBorderColor=12632256,this.FBorderWidth=1,this.FComboItems=pas.Classes.TStringList.$create("Create$1"),this.FColumnType=0,this.FHorzAlignment=1,this},this.Destroy=function(){rtl.free(this,"FComboItems"),rtl.free(this,"FFont"),rtl.free(this,"FFixedFont"),pas.Classes.TCollectionItem.Destroy.call(this)},this.Assign=function(e){t.TTMSFNCGridColumn.isPrototypeOf(e)&&(this.FBorderColor=rtl.as(e,t.TTMSFNCGridColumn).FBorderColor,this.FBorderWidth=rtl.as(e,t.TTMSFNCGridColumn).FBorderWidth,this.FColor=rtl.as(e,t.TTMSFNCGridColumn).FColor,this.FFixed=rtl.as(e,t.TTMSFNCGridColumn).FFixed,this.FFont.Assign(rtl.as(e,t.TTMSFNCGridColumn).FFont),this.FHorzAlignment=rtl.as(e,t.TTMSFNCGridColumn).FHorzAlignment,this.FID$1=rtl.as(e,t.TTMSFNCGridColumn).FID$1,this.FVertAlignment=rtl.as(e,t.TTMSFNCGridColumn).FVertAlignment,this.FEditor=rtl.as(e,t.TTMSFNCGridColumn).FEditor,this.FReadOnly=rtl.as(e,t.TTMSFNCGridColumn).FReadOnly,this.FSortFormat=rtl.as(e,t.TTMSFNCGridColumn).FSortFormat,this.FSortSuffix=rtl.as(e,t.TTMSFNCGridColumn).FSortSuffix,this.FSortPrefix=rtl.as(e,t.TTMSFNCGridColumn).FSortPrefix,this.FWordWrap=rtl.as(e,t.TTMSFNCGridColumn).FWordWrap,this.FColumnType=rtl.as(e,t.TTMSFNCGridColumn).FColumnType,this.FComboItems.Assign(rtl.as(e,t.TTMSFNCGridColumn).FComboItems))};var e=this.$rtti;e.addProperty("BorderColor",2,pas["WEBLib.Graphics"].$rtti.TColor,"FBorderColor","SetBorderColor",{Default:12632256}),e.addProperty("BorderWidth",2,rtl.longint,"FBorderWidth","SetBorderWidth"),e.addProperty("Color",2,pas["WEBLib.Graphics"].$rtti.TColor,"FColor","SetColor",{Default:-1}),e.addProperty("ColumnType",2,t.$rtti.TTMSFNCGridColumnType,"FColumnType","SetColumnType",{Default:t.TTMSFNCGridColumnType.ctDefault}),e.addProperty("ComboItems",2,pas.Classes.$rtti.TStringList,"FComboItems","SetComboItems"),e.addProperty("Editor",0,t.$rtti.TTMSFNCGridEditorType,"FEditor","FEditor",{Default:t.TTMSFNCGridEditorType.etEdit}),e.addProperty("Fixed",2,rtl.boolean,"FFixed","SetFixed",{Default:!1}),e.addProperty("FixedFont",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFont,"FFixedFont","SetFixedFont"),e.addProperty("Font",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFont,"FFont","SetFont"),e.addProperty("HorzAlignment",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsTextAlign,"FHorzAlignment","SetHorzAlignment",{Default:pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsTextAlign.gtaLeading}),e.addProperty("ID",0,rtl.string,"FID$1","FID$1"),e.addProperty("Name",0,rtl.string,"FName","FName"),e.addProperty("ReadOnly",0,rtl.boolean,"FReadOnly","FReadOnly",{Default:!1}),e.addProperty("SortFormat",0,t.$rtti.TTMSFNCGridSortFormat,"FSortFormat","FSortFormat",{Default:t.TTMSFNCGridSortFormat.ssAutomatic}),e.addProperty("SortSuffix",0,rtl.string,"FSortSuffix","FSortSuffix"),e.addProperty("SortPrefix",0,rtl.string,"FSortPrefix","FSortPrefix"),e.addProperty("Tag",0,rtl.nativeint,"FTag","FTag",{Default:0}),e.addProperty("VertAlignment",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsTextAlign,"FVertAlignment","SetVertAlignment",{Default:pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsTextAlign.gtaCenter}),e.addProperty("Width",15,rtl.double,"GetWidth","SetWidth",{stored:"IsWidthStored"}),e.addProperty("WordWrap",2,rtl.boolean,"FWordWrap","SetWordWrap",{Default:!1})})),rtl.createClass(this,"TTMSFNCGridColumns",pas["WEBLib.TMSFNCTypes"].TTMSFNCOwnedCollection,(function(){this.$init=function(){pas["WEBLib.TMSFNCTypes"].TTMSFNCOwnedCollection.$init.call(this),this.FGrid=null},this.$final=function(){this.FGrid=void 0,pas["WEBLib.TMSFNCTypes"].TTMSFNCOwnedCollection.$final.call(this)},this.GetItem$1=function(t){return this.GetItem(t)},this.Create$3=function(e){return pas.Classes.TOwnedCollection.Create$2.call(this,e,t.TTMSFNCGridColumn),this.FGrid=e,this},this.Add$1=function(){return pas.Classes.TCollection.Add.call(this)}})),rtl.createClass(this,"TTMSFNCGridRowInfoList",pas.Classes.TList,(function(){this.GetItem=function(t){return rtl.getObject(this.Get(t))},this.SetItem=function(t,e){this.Put(t,e)}})),rtl.createClass(this,"TTMSFNCGridIntegerList",pas.Classes.TList,(function(){this.GetItem=function(t){return rtl.trunc(this.Get(t))},this.SetItem=function(t,e){this.Put(t,e)}})),rtl.createClass(this,"TTMSFNCGridSList",pas.Classes.TList,(function(){this.GetItem=function(t){return rtl.getNumber(this.Get(t))}})),rtl.createClass(this,"TTMSFNCGridData",pas["WEBLib.TMSFNCCustomScrollControl"].TTMSFNCCustomScrollControl,(function(){this.$init=function(){pas["WEBLib.TMSFNCCustomScrollControl"].TTMSFNCCustomScrollControl.$init.call(this),this.FDefaultLayout=null,this.FOldSize=0,this.FInternalColumnUpdate=!1,this.FInternalRowUpdate=!1,this.FColumnProp=null,this.FColumns=null,this.FUseColumns=!1,this.FFirstCellApply=!1,this.FBlockUpdate=!1,this.FFocusedCell=t.TTMSFNCGridCellRec.$new(),this.FStartCell=t.TTMSFNCGridCellRec.$new(),this.FStopCell=t.TTMSFNCGridCellRec.$new(),this.FRowList=null,this.FRowDisplayList=null,this.FColumnDisplayList=null,this.FSuppressedColumnList=null,this.FHiddenColumnList=null,this.FHiddenRowList=null,this.FColSelect=null,this.FSelectedCells=null,this.FRowCount=0,this.FFilterApplied=!1,this.FSortDirection=0,this.FSortColumn=0,this.FSortDir=0,this.FIOOffset=pas.Types.TPoint.$new(),this.FFilter=null,this.FSortIndexes=null,this.FCellCalcList=null,this.FColumnCount=0,this.FFixedRows=0,this.FFixedColumns=0,this.FRowH=null,this.FFixedRightColumns=0,this.FColumnW=null,this.FOrigColumnW=null,this.FFixedFooterRows=0,this.FDefaultRowHeight=0,this.FDefaultColumnWidth=0,this.FCheckFalse="",this.FCheckTrue="",this.FPrevProgress=0,this.FGroupColumn=0,this.FFloatFormat="",this.FColumnOrder=null,this.FBitmapContainer=null,this.FOnIOProgress=null,this.FOnSortFormat=null,this.FOnCustomCompare=null,this.FOnRawCompare=null,this.FOptions=null,this.FMarkList=null,this.FDefaultFont=null,this.FOnClipboardAfterPasteCell=null,this.FOnClipboardBeforePasteCell=null,this.FOnCellsChanged=null,this.FOnClipboardPaste=null,this.FOnLoadCell=null,this.FOnSaveCell=null,this.FOnNeedFilterDropDown=null,this.FOnNeedFilterDropDownData=null,this.FOnFilterSelect=null,this.FOnGroupCalc=null,this.FOnColumnCalc=null,this.FOnAfterApplyFilter=null,this.FBlockSelectEventHandler=!1,this.FOnSelectedCell=null,this.FOnSelectCell=null,this.FGlobalFont=null},this.$final=function(){this.FDefaultLayout=void 0,this.FColumnProp=void 0,this.FColumns=void 0,this.FFocusedCell=void 0,this.FStartCell=void 0,this.FStopCell=void 0,this.FRowList=void 0,this.FRowDisplayList=void 0,this.FColumnDisplayList=void 0,this.FSuppressedColumnList=void 0,this.FHiddenColumnList=void 0,this.FHiddenRowList=void 0,this.FColSelect=void 0,this.FSelectedCells=void 0,this.FIOOffset=void 0,this.FFilter=void 0,this.FSortIndexes=void 0,this.FCellCalcList=void 0,this.FRowH=void 0,this.FColumnW=void 0,this.FOrigColumnW=void 0,this.FColumnOrder=void 0,this.FBitmapContainer=void 0,this.FOnIOProgress=void 0,this.FOnSortFormat=void 0,this.FOnCustomCompare=void 0,this.FOnRawCompare=void 0,this.FOptions=void 0,this.FMarkList=void 0,this.FDefaultFont=void 0,this.FOnClipboardAfterPasteCell=void 0,this.FOnClipboardBeforePasteCell=void 0,this.FOnCellsChanged=void 0,this.FOnClipboardPaste=void 0,this.FOnLoadCell=void 0,this.FOnSaveCell=void 0,this.FOnNeedFilterDropDown=void 0,this.FOnNeedFilterDropDownData=void 0,this.FOnFilterSelect=void 0,this.FOnGroupCalc=void 0,this.FOnColumnCalc=void 0,this.FOnAfterApplyFilter=void 0,this.FOnSelectedCell=void 0,this.FOnSelectCell=void 0,this.FGlobalFont=void 0,pas["WEBLib.TMSFNCCustomScrollControl"].TTMSFNCCustomScrollControl.$final.call(this)},this.SetDefaultColumnWidth=function(t){this.FDefaultColumnWidth!==t&&(this.BeginUpdate(),this.FDefaultColumnWidth=t,this.EndUpdate())},this.SetDefaultRowHeight=function(t){this.FDefaultRowHeight!==t&&(this.BeginUpdate(),this.FDefaultRowHeight=t,this.EndUpdate())},this.EnsureRow=function(t){for(;this.FRowList.GetCount()<=t;)this.FRowList.Add(null);for(;this.FRowDisplayList.GetCount()<=t;)this.FRowDisplayList.Add(this.FRowDisplayList.GetCount())},this.EnsureCol=function(t){for(;this.FColumnDisplayList.GetCount()<=t;)this.FColumnDisplayList.Add(this.FColumnDisplayList.GetCount()),this.SetColumnCount(t+1)},this.GetCells=function(t,e){var i="",s=null,o=0,n=0;return i="",e>=this.FRowDisplayList.GetCount()||t>=this.FColumnDisplayList.GetCount()||(o=-1,e>=0&&e<=this.FRowDisplayList.GetCount()-1&&(o=this.FRowDisplayList.GetItem(e)),n=-1,t>=0&&t<=this.FColumnDisplayList.GetCount()-1&&(n=this.FColumnDisplayList.GetItem(t)),o>=0&&o<this.FRowList.GetCount()&&null!=this.FRowList.GetItem(o)&&(s=this.FRowList.GetItem(o).FData,n>=0&&n<s.GetCount()&&(i=s.Get(n)))),i},this.SetCells=function(e,i,s){var o,n,r=null;for(this.EnsureRow(i),this.EnsureCol(e),o=this.FRowDisplayList.GetItem(i),n=this.FColumnDisplayList.GetItem(e),null!=this.FRowList.GetItem(o)?r=this.FRowList.GetItem(o):(r=t.TTMSFNCGridRowInfo.$create("Create$1"),this.FRowList.SetItem(o,r));r.FData.GetCount()<=n;)r.FData.AddObject("",null);r.FData.Put(n,s),this.UpdateGridCells(!1)},this.GetIntObjects=function(t,e){var i=null,s=null;return i=null,e>=0&&e<=this.FRowList.GetCount()-1&&null!=this.FRowList.GetItem(e)&&(s=this.FRowList.GetItem(e).FData,t>=0&&t<=s.GetCount()-1&&(i=s.GetObject(t))),i},this.SetIntObjects=function(e,i,s){for(var o=null;this.FRowList.GetCount()<=i;)this.FRowList.Add(null),this.FRowDisplayList.Add(this.FRowDisplayList.GetCount());for(null!=this.FRowList.GetItem(i)?o=this.FRowList.GetItem(i):(o=t.TTMSFNCGridRowInfo.$create("Create$1"),this.FRowList.SetItem(i,o));o.FData.GetCount()<=e;)o.FData.AddObject("",null);o.FData.PutObject(e,s),this.UpdateGridCells(!1)},this.GetRowCount=function(){return this.FRowCount},this.GetHiddenColCount=function(){return this.FHiddenColumnList.GetCount()},this.GetHiddenRowCount=function(){return this.FRowList.GetCount()-this.FRowDisplayList.GetCount()},this.GetTotalColCount=function(){return this.GetColumnCount()+this.FHiddenColumnList.GetCount()},this.GetAllCells=function(t,e){var i="",s=null;return i="",e<this.FRowList.GetCount()&&null!=this.FRowList.GetItem(e)&&t<(s=this.FRowList.GetItem(e).FData).GetCount()&&(i=s.Get(t)),i},this.GetColors=function(t,e){var i,s=0;return s=-1,null!=(i=this.GetIntObjects(t,e))&&(s=i.FColor),s},this.SetColors=function(e,i,s){var o=null;null!=(o=this.GetIntObjects(e,i))?o.FColor=s:((o=t.TTMSFNCGridCellProperty.$create("Create$1",[this.GetDefaultFont(e,i)])).FColor=s,this.SetIntObjects(e,i,o))},this.SetColumnCount=function(e){for(var i=0;e>this.FColumns.GetCount();)this.FColumns.Add$1();if(this.BeginUpdate(),e<this.FColumnCount&&this.ClearCells(t.TTMSFNCGridCellRecRange.$clone(this.CellRange(e,0,this.FColumnCount-1,this.GetRowCount()-1))),this.FColumnCount=e,e<this.FColumnDisplayList.GetCount())for(;this.FColumnDisplayList.GetCount()>e;)this.FColumnDisplayList.Delete(this.FColumnDisplayList.GetCount()-1);else for(i=0,this.FColumnDisplayList.GetCount()>0&&(i=this.FColumnDisplayList.GetItem(this.FColumnDisplayList.GetCount()-1)+1);this.FColumnDisplayList.GetCount()<e;)this.FColumnDisplayList.Add(i),i+=1;this.DoColumnCountChanged(),this.EndUpdate()},this.SetRowCount=function(e){var i=null;if(this.BeginUpdate(),e<this.FRowCount&&this.ClearCells(t.TTMSFNCGridCellRecRange.$clone(this.CellRange(0,e,this.GetColumnCount()-1,this.FRowCount-1))),this.FRowCount=e,e<this.FRowList.GetCount())for(;this.FRowList.GetCount()>e;)null!=this.FRowList.GetItem(this.FRowList.GetCount()-1)&&(i=this.FRowList.GetItem(this.FRowList.GetCount()-1),i=rtl.freeLoc(i)),this.FRowList.Delete(this.FRowList.GetCount()-1);else for(;this.FRowList.GetCount()<e;)this.FRowList.Add(null);for(;this.FRowDisplayList.GetCount()>this.FRowCount;)this.FRowDisplayList.Delete(this.FRowDisplayList.GetCount()-1);this.DoRowCountChanged(),this.EndUpdate()},this.SetFixedColumns=function(t){this.FFixedColumns!==t&&t>=0&&(this.BeginUpdate(),this.FFirstCellApply=!1,this.FFixedColumns=t,this.EndUpdate())},this.SetFixedFooterRows=function(t){this.FFixedFooterRows!==t&&t>=0&&(this.BeginUpdate(),this.FFirstCellApply=!1,this.FFixedFooterRows=t,this.EndUpdate())},this.SetFixedRightColumns=function(t){this.FFixedRightColumns!==t&&t>=0&&(this.BeginUpdate(),this.FFirstCellApply=!1,this.FFixedRightColumns=t,this.EndUpdate())},this.SetFixedRows=function(t){this.FFixedRows!==t&&t>=0&&(this.BeginUpdate(),this.FFirstCellApply=!1,this.FFixedRows=t,this.EndUpdate())},this.GetColumnCount=function(){return this.FColumnCount},this.SetColWidths=function(t,e){var i,s=null;(i=this.FColumnW.IndexOf(t))>=0&&i<=this.FColumnW.GetCount()-1?e===this.FDefaultColumnWidth?this.FColumnW.Delete(i):(this.FColumnW.GetItem$1(i).SetValue(Math.max(0,e)),this.FColumnW.GetItem$1(i).FCellVal=t):e!==this.FDefaultColumnWidth&&((s=this.FColumnW.Add$1()).SetValue(Math.max(0,e)),s.FCellVal=t)},this.SetRowHeights=function(t,e){var i,s=null;(i=this.FRowH.IndexOf(t))>=0&&i<=this.FRowH.GetCount()-1?e===this.FDefaultRowHeight?this.FRowH.Delete(i):(this.FRowH.GetItem$1(i).SetValue(Math.max(0,e)),this.FRowH.GetItem$1(i).FCellVal=t):e!==this.FDefaultRowHeight&&((s=this.FRowH.Add$1()).SetValue(Math.max(0,e)),s.FCellVal=t)},this.GetSelection=function(){var e=t.TTMSFNCGridCellRecRange.$new();return e.StartCol=this.FStartCell.Col,e.StartRow=this.FStartCell.Row,e.EndCol=this.FStopCell.Col,e.EndRow=this.FStopCell.Row,e},this.SetSelection=function(e){var i=t.TTMSFNCGridCellRec.$new(),s=t.TTMSFNCGridCellRec.$new(),o=t.TTMSFNCGridCellRecRange.$new(),n=t.TTMSFNCGridCellRec.$new(),r=!1;o.$assign(e),this.IsNormalFixed(o.StartCol,o.StartRow)&&(n.$assign(this.NextSelectableColumn(o.StartCol,o.StartRow)),o.StartCol=n.Col,o.StartRow=n.Row),this.FStartCell.Col=o.StartCol,this.FStartCell.Row=o.StartRow,this.FStopCell.Col=o.EndCol,this.FStopCell.Row=o.EndRow,i.$assign(this.FStartCell),s.$assign(this.FStopCell),r=!0,null!=this.FOnSelectCell&&this.FOnSelectCell(this,i.Col,i.Row,{get:function(){return r},set:function(t){r=t}}),r&&(this.FBlockSelectEventHandler=!0,this.SelectCell(t.TTMSFNCGridCellRec.$clone(i),{},!0),this.SelectCell(t.TTMSFNCGridCellRec.$clone(s),{},!0),this.FBlockSelectEventHandler=!1,null!=this.FOnSelectedCell&&this.FOnSelectedCell(this,i.Col,i.Row)),this.FFocusedCell.$assign(this.FStartCell),this.UpdateGridCells(!1)},this.GetFocusedCell=function(){var e=t.TTMSFNCGridCellRec.$new();return e.$assign(this.FFocusedCell),e},this.SetFocusedCell=function(e){var i=t.TTMSFNCGridCellRec.$new();this.SetFocusCell(e.Col,e.Row),this.IsNormalFixed(this.GetFocusedCell().Col,this.GetFocusedCell().Row)&&(i.$assign(this.NextSelectableColumn(this.GetFocusedCell().Col,this.GetFocusedCell().Row)),this.SetFocusCell(i.Col,i.Row)),this.SelectCell(t.TTMSFNCGridCellRec.$clone(this.FFocusedCell),{},!1)},this.GetCellProps=function(t,e){return this.GetIntObjects(t,e)},this.GetRowSelect=function(t){var e=!1;return e=!1,t<this.FRowList.GetCount()&&null!=this.FRowList.GetItem(t)&&(e=1===this.FRowList.GetItem(t).FState),e},this.SetOptions=function(t){this.FOptions!==t&&this.FOptions.Assign(t)},this.GetObjects=function(t,e){var i,s=null;return s=null,null!=(i=this.GetIntObjects(t,e))&&(s=i.FObject),s},this.SetObjects=function(e,i,s){var o=null;null==(o=this.GetIntObjects(e,i))&&(o=t.TTMSFNCGridCellProperty.$create("Create$1",[this.GetDefaultFont(e,i)])),o.FObject=s,this.SetIntObjects(e,i,o)},this.GetColumnSelect=function(t){return this.FColSelect.HasValue(t)},this.SetColumnSelect=function(t,e){var i;-1===(i=this.FColSelect.IndexOfValue(t))&&e&&this.FColSelect.Add$1(t),-1===i||e||this.FColSelect.Delete$1(i),this.UpdateGridCells(!1)},this.GetCellSelect=function(e,i){return-1!==this.FSelectedCells.Find(t.TTMSFNCGridCellRec.$clone(t.MakeCell(e,i)))},this.SetCellSelect=function(e,i,s){var o,n=t.TTMSFNCGridCellRec.$new();n.$assign(t.MakeCell(e,i)),-1===(o=this.FSelectedCells.Find(t.TTMSFNCGridCellRec.$clone(n)))&&s&&this.FSelectedCells.AddCell(t.TTMSFNCGridCellRec.$clone(n)),-1===o||s||this.FSelectedCells.DeleteCell$1(o),this.UpdateGridCells(!1)},this.GetCheckBoxState=function(e,i){var s,o=!1,n=0;return o=!1,s=this.GetIntObjects(e,i),this.FUseColumns&&null==s?(n=this.DisplToRealColumn(e))<this.FColumns.GetCount()&&2===this.FColumns.GetItem$1(n).FColumnType&&(o=this.GetCells(e,i)===this.FCheckTrue):(null!=s&&null!=s.FControl&&t.TTMSFNCGridCellCheckBox.isPrototypeOf(s.FControl)&&(o=rtl.as(s.FControl,t.TTMSFNCGridCellCheckBox).FChecked),null!=s&&null!=s.FControl&&t.TTMSFNCGridCellDataCheckBox.isPrototypeOf(s.FControl)&&(o=this.GetCells(e,i)===this.FCheckTrue)),o},this.SetCheckBoxState=function(e,i,s){var o,n=0;o=this.GetIntObjects(e,i),this.FUseColumns&&null==o?(n=this.DisplToRealColumn(e))<this.FColumns.GetCount()&&2===this.FColumns.GetItem$1(n).FColumnType&&(s?this.SetCells(e,i,this.FCheckTrue):this.SetCells(e,i,this.FCheckFalse)):(null!=o&&null!=o.FControl&&t.TTMSFNCGridCellCheckBox.isPrototypeOf(o.FControl)&&(rtl.as(o.FControl,t.TTMSFNCGridCellCheckBox).FChecked=s),null!=o&&null!=o.FControl&&t.TTMSFNCGridCellDataCheckBox.isPrototypeOf(o.FControl)&&(s?this.SetCells(e,i,this.FCheckTrue):this.SetCells(e,i,this.FCheckFalse))),this.UpdateGridCells(!1)},this.GetFixedCellSelect=function(e,i){return-1!==this.FSelectedCells.FindFixed(t.TTMSFNCGridCellRec.$clone(t.MakeCell(e,i)))},this.GetColumnCalculation=function(t){return t>=this.FCellCalcList.GetCount()?0:this.FCellCalcList.GetInteger(t)},this.UpdateColumnCalc=function(t,e){var i="",s=0;if(0!==this.FFixedFooterRows){var o=e;0===o?i="":1===o?i=pas.SysUtils.Format(this.FOptions.FEditing.FCalcFormat,pas.System.VarRecs(3,this.ColumnSum(t,this.FFixedRows,this.GetRowCount()-this.FFixedFooterRows-1))):2===o?i=pas.SysUtils.Format(this.FOptions.FEditing.FCalcFormat,pas.System.VarRecs(3,this.ColumnAvg(t,this.FFixedRows,this.GetRowCount()-this.FFixedFooterRows-1))):3===o?(s=this.GetRowCount()-this.FFixedFooterRows-this.FFixedRows,i=pas.SysUtils.Format(this.FOptions.FEditing.FCalcFormat,pas.System.VarRecs(3,s))):4===o?i=pas.SysUtils.Format(this.FOptions.FEditing.FCalcFormat,pas.System.VarRecs(3,this.ColumnMin(t,this.FFixedRows,this.GetRowCount()-this.FFixedFooterRows-1))):5===o?i=pas.SysUtils.Format(this.FOptions.FEditing.FCalcFormat,pas.System.VarRecs(3,this.ColumnMax(t,this.FFixedRows,this.GetRowCount()-this.FFixedFooterRows-1))):6===o?i=pas.SysUtils.Format(this.FOptions.FEditing.FCalcFormat,pas.System.VarRecs(3,this.ColumnCustomCalc(t,this.FFixedRows,this.GetRowCount()-this.FFixedFooterRows-1))):7===o?i=pas.SysUtils.Format(this.FOptions.FEditing.FCalcFormat,pas.System.VarRecs(3,this.ColumnDistinct(t,this.FFixedRows,this.GetRowCount()-this.FFixedFooterRows-1))):8===o&&(i=pas.SysUtils.Format(this.FOptions.FEditing.FCalcFormat,pas.System.VarRecs(3,this.ColumnStdDev(t,this.FFixedRows,this.GetRowCount()-this.FFixedFooterRows-1)))),this.SetCells(t,this.GetRowCount()-this.FFixedFooterRows,i)}},this.GetFloats=function(t,i){var s="",o=0,n=0;return s=this.GetCells(t,i),this.DoGetCellData(t,i,{get:function(){return s},set:function(t){s=t}}),""!==s&&"-"!==s||(s="0"),s=e.CleanupSep(s),pas.System.val$8(s,{get:function(){return o},set:function(t){o=t}},{get:function(){return n},set:function(t){n=t}}),0!==n?0:o},this.GetStrippedCells=function(t,e){return pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.HTMLStrip(this.GetCells(t,e))},this.GetRowText=function(t){var e,i="",s=null;return i="",t>=this.FRowDisplayList.GetCount()||(e=this.FRowDisplayList.GetItem(t))<this.FRowList.GetCount()&&null!=this.FRowList.GetItem(e)&&((s=this.FRowList.GetItem(e).FData).SetDelimiter(this.FOptions.FIO.FDelimiter),i=s.GetDelimitedText()),i},this.SetColumns=function(t){this.FColumns.Assign(t)},this.IsDefaultColumnWidthStored=function(){return 68!==this.FDefaultColumnWidth},this.IsDefaultRowHeightStored=function(){return 24!==this.FDefaultRowHeight},this.GetBitmapContainer=function(){return this.FBitmapContainer},this.SetBitmapContainer=function(t){this.FBitmapContainer=t},this.SetDefaultFont=function(t){this.FDefaultFont.Assign(t)},this.SetGlobalFont=function(t){this.FGlobalFont.Assign(t)},this.SetRowSelect=function(e,i){var s=null;this.EnsureRow(e),null==this.FRowList.GetItem(e)&&(s=t.TTMSFNCGridRowInfo.$create("Create$1"),this.FRowList.SetItem(e,s)),i?this.FRowList.GetItem(e).SetState(1):this.FRowList.GetItem(e).SetState(0),this.UpdateGridCells(!1)},this.SelectCell=function(t,e,i){},this.SetStartCell=function(t,e){this.FStartCell.Col=t,this.FStartCell.Row=e,this.FStartCell.Col=Math.max(this.FFixedColumns,Math.min(this.GetColumnCount()-1-this.FFixedRightColumns,this.FStartCell.Col)),this.FStartCell.Row=Math.max(this.FFixedRows,Math.min(this.GetRowCount()-1-this.FFixedFooterRows,this.FStartCell.Row))},this.SetStopCell=function(t,e){this.FStopCell.Col=t,this.FStopCell.Row=e,this.FStopCell.Col=Math.max(this.FFixedColumns,Math.min(this.GetColumnCount()-1-this.FFixedRightColumns,this.FStopCell.Col)),this.FStopCell.Row=Math.max(this.FFixedRows,Math.min(this.GetRowCount()-1-this.FFixedFooterRows,this.FStopCell.Row))},this.SetFocusCell=function(t,e){this.FFocusedCell.Col=t,this.FFocusedCell.Row=e,this.FFocusedCell.Col=Math.max(this.FFixedColumns,Math.min(this.GetColumnCount()-1-this.FFixedRightColumns,this.FFocusedCell.Col)),this.FFocusedCell.Row=Math.max(this.FFixedRows,Math.min(this.GetRowCount()-1-this.FFixedFooterRows,this.FFocusedCell.Row))},this.GetColWidths=function(t){var e,i=0;return i=0,-1!==this.FSuppressedColumnList.IndexOf(t)?i:i=-1!==(e=this.FColumnW.IndexOf(t))?this.FColumnW.GetItem$1(e).FValue:this.FDefaultColumnWidth},this.GetRowHeights=function(t){var e;return-1!==(e=this.FRowH.IndexOf(t))?this.FRowH.GetItem$1(e).FValue:this.FDefaultRowHeight},this.CompareRows=function(t,e,i){var s="",o="",n=0,r="",a="",l=0,h=0,F=0,p=0,c="",u="",C=!1,T=!1,S=0,d=0,m=0,f=0,g=0;s=this.GetCells(t,e),o=this.GetCells(t,i),this.FOptions.FSorting.FIgnoreCase&&(s=pas.SysUtils.UpperCase(s),o=pas.SysUtils.UpperCase(o)),a="",r="",n=0,this.DoSortFormat(t,{get:function(){return n},set:function(t){n=t}},{get:function(){return r},set:function(t){r=t}},{get:function(){return a},set:function(t){a=t}});var y=n;if(0===y)m=pas["WEBLib.TMSFNCGridDataUtil"].IsType(s),f=pas["WEBLib.TMSFNCGridDataUtil"].IsType(o),m in rtl.createSet(0,1)&&f in rtl.createSet(0,1)?(pas.System.val$8(s,{get:function(){return F},set:function(t){F=t}},{get:function(){return d},set:function(t){d=t}}),pas.System.val$8(o,{get:function(){return p},set:function(t){p=t}},{get:function(){return d},set:function(t){d=t}}),S=F===p?0:F>p?1:-1):S=s===o?0:s>o?1:-1;else if(1===y||5===y)c=s,u=o,5===n&&(c=pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.HTMLStrip(c),u=pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.HTMLStrip(u)),S=c===u?0:c>u?1:-1;else if(2===y)c=pas.SysUtils.UpperCase(pas["WEBLib.TMSFNCTypes"].VarToStr(s)),u=pas.SysUtils.UpperCase(pas["WEBLib.TMSFNCTypes"].VarToStr(o)),S=c===u?0:c>u?1:-1;else if(3===y)""!==s?(g=1/0,pas.SysUtils.TryStrToFloat$2(s,{get:function(){return g},set:function(t){g=t}})):g=1/0,F=g,""!==o?(g=1/0,pas.SysUtils.TryStrToFloat$2(o,{get:function(){return g},set:function(t){g=t}})):g=1/0,S=F===(p=g)?0:F>p?1:-1;else if(4===y){if(l=0,""!==s)try{l=pas["WEBLib.TMSFNCTypes"].VarToDateTime(s)}catch(t){}if(h=0,""!==o)try{h=pas["WEBLib.TMSFNCTypes"].VarToDateTime(o)}catch(t){}S=l===h?0:l>h?1:-1}else 6===y?(C=this.GetCheckBoxState(t,e),T=this.GetCheckBoxState(t,i),S=C&&!T?1:C===T?0:-1):7===y?this.DoCustomCompare(s,o,{get:function(){return S},set:function(t){S=t}}):8===y&&this.DoRawCompare(t,e,i,{get:function(){return S},set:function(t){S=t}});if(this.FOptions.FSorting.FIgnoreBlanks){var M=this.FSortDirection;0===M?(""===s&&""!==o&&(S=0===this.FOptions.FSorting.FBlankPosition?-1:1),""===o&&""!==s&&(S=0===this.FOptions.FSorting.FBlankPosition?1:-1)):1===M&&(""===s&&""!==o&&(S=0===this.FOptions.FSorting.FBlankPosition?1:-1),""===o&&""!==s&&(S=0===this.FOptions.FSorting.FBlankPosition?-1:1))}return S},this.CompareRowsIndexed=function(t,e,i){var s,o=0,n=0;return s=2147483647&this.FSortIndexes.GetInteger(t),n=2147483648==(2147483648&this.FSortIndexes.GetInteger(t))?1:0,0===(o=this.IsIgnoredColumn(s)?0:this.CompareRows(s,e,i))&&this.FOptions.FSorting.FMultiColumn?t<this.FSortIndexes.GetCount()-1&&(t+=1,o=this.CompareRowsIndexed(t,e,i)):1===n&&(o=-o),o},this.QuickSortRows=function(t,e,i){var s,o=0,n=0,r=0;0===this.FSortDirection?this.FSortDir=1:this.FSortDir=-1,o=e,n=i,s=e+i>>>1;for(var a=0,l=this.GetColumnCount()-1;a<=l;a++)r=a,this.SetCells(r,this.GetRowCount()-1,this.GetCells(r,s)),this.SetObjects(r,this.GetRowCount()-1,this.GetObjects(r,s));do{for(;this.CompareRows(t,this.GetRowCount()-1,o)===this.FSortDir&&o<i;)o+=1;for(;this.CompareRows(t,n,this.GetRowCount()-1)===this.FSortDir&&n>e;)n-=1;if(o<=n){if(o!==n&&0!==this.CompareRows(t,o,n)){var h=this.FOptions.FSorting.FColumns;0===h?this.SwapRows(o,n):2===h?this.SwapCells(t,o,n):1===h&&this.SwapNormalCells(o,n)}o+=1,n-=1}}while(!(o>n));e<n&&this.QuickSortRows(t,e,n),o<i&&this.QuickSortRows(t,o,i)},this.QuickSortRowsIndexed=function(t,e,i){var s,o=0,n=0,r=0;0===this.FSortDirection?this.FSortDir=1:this.FSortDir=-1,o=e,n=i,s=e+i>>>1;for(var a=0,l=this.GetColumnCount()-1;a<=l;a++)r=a,this.SetCells(r,this.GetRowCount()-1,this.GetCells(r,s)),this.SetObjects(r,this.GetRowCount()-1,this.GetObjects(r,s));do{for(;this.CompareRowsIndexed(t,this.GetRowCount()-1,o)===this.FSortDir&&o<i;)o+=1;for(;this.CompareRowsIndexed(t,n,this.GetRowCount()-1)===this.FSortDir&&n>e;)n-=1;if(o<=n){if(o!==n&&0!==this.CompareRowsIndexed(t,o,n)){var h=this.FOptions.FSorting.FColumns;0===h?this.SwapRows(o,n):1===h?this.SwapNormalCells(o,n):2===h&&this.SwapCells(t,o,n)}o+=1,n-=1}}while(!(o>n));e<n&&this.QuickSortRowsIndexed(t,e,n),o<i&&this.QuickSortRowsIndexed(t,o,i)},this.SortGroupedInt=function(e){var i=0,s=0,o=0,n=0,r=0,a=0,l=[],h=!1;for(l=rtl.arraySetLength(l,!1,0),h=!1,i=this.FFixedRows;i<=this.FRowCount-this.FFixedFooterRows;)s=this.DisplToRealRow(i),this.IsNode(s)&&(a=rtl.length(l),l=rtl.arraySetLength(l,!1,a+1),0===this.GetNodeState(s)?l[a]=!0:l[a]=!1),i+=1;this.OpenAllNodes(),this.FFilterApplied&&(this.RemoveFilter(),h=!0),this.BeginUpdate();try{for(this.SetRowCount(this.GetRowCount()+1),i=this.FFixedRows;i<=this.FRowCount-this.FFixedFooterRows-3;)s=this.DisplToRealRow(i),this.IsNode(s)?((n=s+(r=this.GetNodeSpan(s)))-(o=s+1)>=1&&(e?this.QuickSortRowsIndexed(0,o,n):this.QuickSortRows(this.FSortColumn,o,n)),i+=r):i+=1;for(this.ClearCells(t.TTMSFNCGridCellRecRange.$clone(this.CellRange(0,this.GetRowCount()-1,this.GetColumnCount()-1,this.GetRowCount()-1))),this.SetRowCount(this.GetRowCount()-1),i=this.FFixedRows,a=0;i<=this.FRowCount-this.FFixedFooterRows;)s=this.DisplToRealRow(i),this.IsNode(s)&&(l[a]&&this.CloseNode(s),a+=1),i+=1}finally{h&&this.ApplyFilter(),this.EndUpdate()}this.UpdateGridCells(!1)},this.MatchFilter=function(t){var e=!1,i=0,s="",o=!1;e=!0;for(var n=1,r=this.FFilter.GetCount();n<=r;n++){i=n;var a=this.FFilter.GetItem$1(i-1),l=this.FFilter.GetItem$1(i-1).FData;if(0===l?s=this.GetCells(a.FColumn,t):1===l?(s=this.GetCells(a.FColumn,t),this.DoGetCellData(a.FColumn,t,{get:function(){return s},set:function(t){s=t}})):2===l?s=this.GetStrippedCells(a.FColumn,t):3===l&&(s=this.GetRowText(t)),s=pas.SysUtils.Trim(s),3===this.FFilter.GetItem$1(i-1).FData)o=pas.System.Pos(pas.SysUtils.UpperCase(a.FCondition),pas.SysUtils.UpperCase(s))>0;else{""!==a.FPrefix&&1===pas.System.Pos(a.FPrefix,s)&&pas.System.Delete({get:function(){return s},set:function(t){s=t}},1,this.FFilter.GetItem$1(i-1).FPrefix.length),""!==a.FSuffix&&pas.System.Pos(a.FSuffix,s)===1+s.length-a.FSuffix.length&&pas.System.Delete({get:function(){return s},set:function(t){s=t}},1+s.length-a.FSuffix.length,s.length);try{o=pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.MatchStrEx(a.FCondition,s,a.FCaseSensitive)}catch(t){o=!1}}var h=this.FFilter.GetItem$1(i-1).FOperation;if(0===h){if(!(e=o))break}else 1===h?e=o:2===h?e=e&&o:4===h?e=e||o:3===h&&(e^=o)}return e},this.UpdateGridCells=function(t){},this.ExportNotification=function(t,e){0===t&&(this.FPrevProgress=-1)},this.DoRowCountChanged=function(){},this.DoColumnCountChanged=function(){},this.DoSortFormat=function(t,e,i,s){var o;e.set(0),i.set(""),s.set(""),o=this.DisplToRealColumn(t),this.FUseColumns&&o<this.FColumns.GetCount()&&(e.set(this.FColumns.GetItem$1(o).FSortFormat),s.set(this.FColumns.GetItem$1(o).FSortSuffix),i.set(this.FColumns.GetItem$1(o).FSortPrefix)),null!=this.FOnSortFormat&&this.FOnSortFormat(this,t,e,i,s)},this.DoCustomCompare=function(t,e,i){null!=this.FOnCustomCompare&&this.FOnCustomCompare(this,t,e,i)},this.DoRawCompare=function(t,e,i,s){null!=this.FOnRawCompare&&this.FOnRawCompare(this,t,e,i,s)},this.DoNeedFilterDropDown=function(t,e,i){null!=this.FOnNeedFilterDropDown&&this.FOnNeedFilterDropDown(this,t,e,i)},this.DoNeedFilterDropDownData=function(t,e,i){null!=this.FOnNeedFilterDropDownData&&this.FOnNeedFilterDropDownData(this,t,e,i)},this.DoFilterSelect=function(t,e){null!=this.FOnFilterSelect&&this.FOnFilterSelect(this,t,e)},this.DoAfterApplyFilter=function(t,e,i){null!=this.FOnAfterApplyFilter&&this.FOnAfterApplyFilter(this,t,e,i)},this.SetHorizontalScrollBarVisible=function(t){pas["WEBLib.TMSFNCCustomScrollControl"].TTMSFNCCustomScrollControl.SetHorizontalScrollBarVisible.apply(this,arguments),0===this.FUpdateCount$1&&this.FOptions.FScrollBar.SetHorizontalScrollBarVisible(this.FHorizontalScrollBarVisible)},this.SetVerticalScrollBarVisible=function(t){pas["WEBLib.TMSFNCCustomScrollControl"].TTMSFNCCustomScrollControl.SetVerticalScrollBarVisible.apply(this,arguments),0===this.FUpdateCount$1&&this.FOptions.FScrollBar.SetVerticalScrollBarVisible(this.FVerticalScrollBarVisible)},this.IsCellControl=function(t,e,i){var s,o,n;return o=this.DisplToRealColumn(t),n=this.DisplToRealRow(e),null!=(s=this.GetIntObjects(o,n))&&null!=s.FControl&&i.isPrototypeOf(s.FControl)},this.IsIgnoredColumn=function(t){return!1,!1},this.Notification=function(t,e){pas["WEBLib.Menus"].TWebCustomControl.Notification.apply(this,arguments),1===e&&t===this.FBitmapContainer&&(this.FBitmapContainer=null)},this.Loaded=function(){pas["WEBLib.TMSFNCCustomScrollControl"].TTMSFNCCustomScrollControl.Loaded.call(this),this.InitOriginalColumnSizes(),this.FIOOffset.$assign(pas.Types.Point(this.FFixedColumns,this.FFixedRows)),this.SetColumnOrder()},this.GetDefaultFont=function(t,e){var i=null;return null!=(i=this.IsFixed(t,e)?this.GetDefaultFixedLayout():this.GetDefaultNormalLayout())?i.FFont:this.FDefaultFont},this.GetDefaultFixedLayout=function(){return null,null},this.GetDefaultNormalLayout=function(){return null,null},this.GetDefaultGroupLayout=function(){return null,null},this.GetDefaultSummaryLayout=function(){return null,null},this.GetDefaultSelectedLayout=function(){return null,null},this.GetDefaultFocusedLayout=function(){return null,null},this.GetDefaultFixedSelectedLayout=function(){return null,null},this.GetDefaultBandLayout=function(){return null,null},this.SetFonts=function(t){var e=0;this.BeginUpdate(),this.FGlobalFont.ApplyChange(this.FDefaultFont,t),this.FGlobalFont.ApplyChange(this.FDefaultLayout.FFont,t);for(var i=0,s=this.FColumns.GetCount()-1;i<=s;i++){e=i,this.FGlobalFont.ApplyChange(this.FColumns.GetItem$1(e).FFont,t),this.FGlobalFont.ApplyChange(this.FColumns.GetItem$1(e).FFixedFont,t);for(var o=0,n=this.GetRowCount()-1;o<=n;o++)o,this.FGlobalFont.ApplyChange(this.GetDefaultBandLayout().FFont,t),this.FGlobalFont.ApplyChange(this.GetDefaultNormalLayout().FFont,t),this.FGlobalFont.ApplyChange(this.GetDefaultFixedLayout().FFont,t),this.FGlobalFont.ApplyChange(this.GetDefaultSelectedLayout().FFont,t),this.FGlobalFont.ApplyChange(this.GetDefaultFixedSelectedLayout().FFont,t),this.FGlobalFont.ApplyChange(this.GetDefaultFocusedLayout().FFont,t),this.FGlobalFont.ApplyChange(this.GetDefaultGroupLayout().FFont,t),this.FGlobalFont.ApplyChange(this.GetDefaultSummaryLayout().FFont,t),this.FGlobalFont.ApplyChange(this.GetDefaultBandLayout().FFont,t)}this.EndUpdate()},this.DoOptionsChange=function(t){this.FUpdateCount$1>0||this.FBlockUpdate||3 in this.FComponentState||(this.SaveScrollPosition(),this.BeginUpdate(),this.SetHorizontalScrollBarVisible(this.FOptions.FScrollBar.FHorizontalScrollBarVisible),this.SetVerticalScrollBarVisible(this.FOptions.FScrollBar.FVerticalScrollBarVisible),this.EndUpdate(),this.RestoreScrollPosition())},this.DoGetCellReadOnly=function(t,e,i){var s;null!=(s=this.GetCellProps(t,e))?i.set(s.FReadOnly):this.FUseColumns&&t>=0&&t<=this.FColumns.GetCount()-1&&(t=this.DisplToRealColumn(t),i.set(this.FColumns.GetItem$1(t).FReadOnly))},this.DoGetCellIsDataCheckBox=function(e,i){var s,o,n,r=!1;return o=this.DisplToRealColumn(e),n=this.DisplToRealRow(i),r=!1,s=this.GetCellProps(o,n),this.FUseColumns&&null==this.GetIntObjects(o,n)?o<this.FColumns.GetCount()&&(r=2===this.FColumns.GetItem$1(o).FColumnType||4===this.FColumns.GetItem$1(o).FColumnType):null!=s&&(r=t.TTMSFNCGridCellDataCheckBox.isPrototypeOf(s.FControl)),r},this.DoFixedCellDropDownButtonClick=function(t,e,i){},this.DoCellRightClick=function(t,e){},this.DoFixedCellRightClick=function(t,e){},this.DoCellClick=function(t,e){var i=0,s=0,o=0;if(-1!==this.FGroupColumn&&this.FOptions.FGrouping.FAutoSelectGroup&&(i=this.DisplToRealRow(e),this.IsNode(i)))if(o=this.GetNodeSpan(i),7===this.FOptions.FSelection.FMode)for(var n=i,r=i+o;n<=r;n++)s=n,this.SetRowSelect(s,!0);else 4===this.FOptions.FSelection.FMode&&this.SetSelection(this.CellRange(this.FFixedColumns,e,this.GetColumnCount()-1-this.FFixedRightColumns,e+o))},this.DoFixedCellClick=function(t,e,i){},this.DoCellDblClick=function(t,e){},this.DoFixedCellDblClick=function(t,e){},this.DoCellCheckBoxClick=function(e,i,s){var o,n,r=0,a=0,l=0;if(l=this.DisplToRealColumn(e),n=this.DisplToRealRow(i),null!=(o=this.GetIntObjects(l,n))&&null!=o.FControl&&t.TTMSFNCGridCellCheckBox.isPrototypeOf(o.FControl)){if(rtl.as(o.FControl,t.TTMSFNCGridCellCheckBox).FChecked=rtl.as(s,pas["WEBLib.TMSFNCGridCell"].TTMSFNCCheckGridCell).FChecked,rtl.as(o.FControl,t.TTMSFNCGridCellCheckBox).FHeader)for(var h=i+1,F=this.GetRowCount()-1-this.FFixedFooterRows;h<=F&&(r=h,this.IsCheckBox(e,r));h++)this.SetCheckBoxState(e,r,rtl.as(o.FControl,t.TTMSFNCGridCellCheckBox).FChecked);this.UpdateGridCells(!1)}if(this.FOptions.FGrouping.FAutoCheckGroup&&(a=this.DisplToRealRow(i),this.IsNode(a))){for(var p=a,c=a+this.GetNodeSpan(a);p<=c;p++)r=p,this.SetCheckBoxState(e,r,rtl.as(o.FControl,t.TTMSFNCGridCellCheckBox).FChecked);this.UpdateGridCells(!1)}this.FUseColumns&&null==o?(l=this.DisplToRealColumn(e))<this.FColumns.GetCount()&&pas["WEBLib.TMSFNCGridCell"].TTMSFNCCheckGridCell.isPrototypeOf(s)&&2===this.FColumns.GetItem$1(l).FColumnType&&(rtl.as(s,pas["WEBLib.TMSFNCGridCell"].TTMSFNCCheckGridCell).FChecked?this.SetCells(e,i,this.FCheckTrue):this.SetCells(e,i,this.FCheckFalse)):null!=o&&null!=o.FControl&&t.TTMSFNCGridCellDataCheckBox.isPrototypeOf(o.FControl)&&(rtl.as(s,pas["WEBLib.TMSFNCGridCell"].TTMSFNCCheckGridCell).FChecked?this.SetCells(e,i,this.FCheckTrue):this.SetCells(e,i,this.FCheckFalse))},this.DoCellRadioButtonClick=function(e,i,s){var o,n,r,a=null,l=0;if(r=this.DisplToRealColumn(e),n=this.DisplToRealRow(i),o=this.GetIntObjects(r,n),this.FUseColumns&&null==o){for(var h=this.FFixedRows,F=this.GetRowCount()-1-this.FFixedFooterRows;h<=F;h++)l=h,this.SetCells(e,l,this.FCheckFalse);this.SetCells(e,i,this.FCheckTrue)}else if(null!=o&&null!=o.FControl&&t.TTMSFNCGridCellRadioButton.isPrototypeOf(o.FControl)){for(var p=0,c=this.GetRowCount()-1;p<=c;p++)l=p,null!=(a=this.GetIntObjects(e,l))&&null!=a.FControl&&t.TTMSFNCGridCellRadioButton.isPrototypeOf(a.FControl)&&a!==o&&rtl.as(a.FControl,t.TTMSFNCGridCellRadioButton).FIndex===rtl.as(o.FControl,t.TTMSFNCGridCellRadioButton).FIndex&&(rtl.as(a.FControl,t.TTMSFNCGridCellRadioButton).FChecked=!1);rtl.as(o.FControl,t.TTMSFNCGridCellRadioButton).FChecked=rtl.as(s,pas["WEBLib.TMSFNCGridCell"].TTMSFNCRadioGridCell).FChecked,this.UpdateGridCells(!1)}},this.DoCellButtonClick=function(t,e,i){},this.DoCellBitmapClick=function(t,e,i){},this.DoCellCommentClick=function(t,e,i){},this.DoCellSortClick=function(t,e,i,s,o){if(-1!==this.FGroupColumn){var n=this.FOptions.FSorting.FMode;1===n?this.SortGrouped(e,s):2===n&&this.SortGroupedIndexed()}else{var r=this.FOptions.FSorting.FMode;1===r?this.SortData(e,s):2===r&&this.SortIndexed()}},this.DoCellNodeClick=function(t,e,i){var s,o;o=this.DisplToRealRow(e),null!=(s=this.GetNode(o))&&-1!==s.FSpan&&(1===s.FState?this.CloseNode(o):this.OpenNode(o))},this.DoGetCellIsFixed=function(t,e,i){var s;null!=(s=this.GetCellProps(t,e))?i.set(s.FFixed):this.FUseColumns&&t>=0&&t<=this.FColumns.GetCount()-1&&(t=this.DisplToRealColumn(t),i.set(this.FColumns.GetItem$1(t).FFixed))},this.DoGetRowIsBand=function(t,e){this.FOptions.FBands.FTotalRowCount>0?e.set((t-this.FFixedRows)%this.FOptions.FBands.FTotalRowCount<this.FOptions.FBands.FBandRowCount):e.set(pas.System.Odd(t))},this.DoCanInsertRow=function(t,e){},this.DoCanDeleteRow=function(t,e){},this.DoCanAppendRow=function(t,e){},this.DoCanAppendColumn=function(t,e){},this.DoInsertRow=function(t){},this.DoDeleteRow=function(t){},this.DoAppendRow=function(t){},this.DoAppendColumn=function(t){},this.DoGetCellClass=function(e,i,s){var o,n,r;if((e>=this.FFixedColumns||e<=this.GetColumnCount()-1-this.FFixedRightColumns)&&(i<this.FFixedRows||i>this.GetRowCount()-this.FFixedFooterRows-1)?s.set(pas["WEBLib.TMSFNCGridCell"].TTMSFNCFixedGridCell):s.set(pas["WEBLib.TMSFNCGridCell"].TTMSFNCGridCell),n=this.DisplToRealColumn(e),r=this.DisplToRealRow(i),o=this.GetCellProps(n,r),null==this.GetIntObjects(n,r)&&this.FUseColumns&&n<this.FColumns.GetCount()&&!this.IsFixed(n,r)){var a=this.FColumns.GetItem$1(n).FColumnType;1===a?s.set(pas["WEBLib.TMSFNCGridCell"].TTMSFNCButtonGridCell):2===a?s.set(pas["WEBLib.TMSFNCGridCell"].TTMSFNCCheckGridCell):3===a?s.set(pas["WEBLib.TMSFNCGridCell"].TTMSFNCProgressGridCell):4===a&&s.set(pas["WEBLib.TMSFNCGridCell"].TTMSFNCRadioGridCell)}null!=o&&null!=o.FControl&&(t.TTMSFNCGridCellCheckBox.isPrototypeOf(o.FControl)&&s.set(pas["WEBLib.TMSFNCGridCell"].TTMSFNCCheckGridCell),t.TTMSFNCGridCellDataCheckBox.isPrototypeOf(o.FControl)&&s.set(pas["WEBLib.TMSFNCGridCell"].TTMSFNCCheckGridCell),t.TTMSFNCGridCellRadioButton.isPrototypeOf(o.FControl)&&s.set(pas["WEBLib.TMSFNCGridCell"].TTMSFNCRadioGridCell),t.TTMSFNCGridCellBitmapName.isPrototypeOf(o.FControl)&&s.set(pas["WEBLib.TMSFNCGridCell"].TTMSFNCBitmapGridCell),t.TTMSFNCGridCellButton.isPrototypeOf(o.FControl)&&s.set(pas["WEBLib.TMSFNCGridCell"].TTMSFNCButtonGridCell),t.TTMSFNCGridCellProgressBar.isPrototypeOf(o.FControl)&&s.set(pas["WEBLib.TMSFNCGridCell"].TTMSFNCProgressGridCell),t.TTMSFNCGridCellBitmap.isPrototypeOf(o.FControl)&&s.set(pas["WEBLib.TMSFNCGridCell"].TTMSFNCBitmapGridCell),t.TTMSFNCGridCellNode.isPrototypeOf(o.FControl)&&s.set(pas["WEBLib.TMSFNCGridCell"].TTMSFNCNodeGridCell)),null!=o&&s.get()===pas["WEBLib.TMSFNCGridCell"].TTMSFNCGridCell&&""!==o.FComment&&s.set(pas["WEBLib.TMSFNCGridCell"].TTMSFNCCommentGridCell)},this.DoGetCellData=function(e,i,s){var o,n,r,a=!1,l=0,h=0,F=0;if(n=this.DisplToRealRow(i),r=this.DisplToRealColumn(e),a=!1,null!=(o=this.GetCellProps(r,n))&&null!=o.FControl&&(t.TTMSFNCGridCellBitmapName.isPrototypeOf(o.FControl)&&(a=rtl.as(o.FControl,t.TTMSFNCGridCellBitmapName).FData),t.TTMSFNCGridCellDataCheckBox.isPrototypeOf(o.FControl)&&(a=!0)),this.FUseColumns&&null==this.GetIntObjects(r,n)&&r>=0&&r<this.FColumns.GetCount()&&!this.IsFixed(r,n)&&(a=2===this.FColumns.GetItem$1(r).FColumnType||4===this.FColumns.GetItem$1(r).FColumnType),a)s.set("");else{s.set(this.GetCells(e,i));for(var p=0,c=this.FMarkList.GetCount()-1;p<=c;p++)if(l=p,t.InCellRange(e,i,t.TTMSFNCGridCellRecRange.$clone(this.FMarkList.GetItem$1(l).FCellRange))){var u=this.FMarkList.GetItem$1(l).FMarkType;0===u?s.set(pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.ApplyHilight(s.get(),this.FMarkList.GetItem$1(l).FValue,"hi",this.FMarkList.GetItem$1(l).FCaseSensitive)):1===u&&s.set(pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.ApplyHilight(s.get(),this.FMarkList.GetItem$1(l).FValue,"e",this.FMarkList.GetItem$1(l).FCaseSensitive))}this.FOptions.FURL.FShow&&!this.FOptions.FURL.FFull&&(h=0,pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.VarPos("://",s.get(),{get:function(){return h},set:function(t){h=t}})>0?s.set(pas.System.Copy(s.get(),h+3,255)):1===pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.VarPos("mailto:",s.get(),{get:function(){return h},set:function(t){h=t}})&&s.set(pas.System.Copy(s.get(),h+7,255))),this.FOptions.FGrouping.FShowGroupCount&&-1!==this.FGroupColumn&&1===e&&this.IsNode(n)&&(F=this.GetNodeSpan(n),""!==this.FOptions.FGrouping.FGroupCountFormat?s.set(s.get()+" "+pas.SysUtils.Format(this.FOptions.FGrouping.FGroupCountFormat,pas.System.VarRecs(0,F))):s.set(s.get()+" ("+pas.SysUtils.IntToStr(F)+")"))}},this.DoGetCellRotation=function(t,e,i){var s,o,n;o=this.DisplToRealColumn(t),n=this.DisplToRealRow(e),null!=(s=this.GetCellProps(o,n))&&i.set(s.FAngle)},this.DoGetCellLayout=function(t,e,i,s){var o,n,r=null;o=this.DisplToRealColumn(t),n=this.DisplToRealRow(e),r=this.GetCellProps(o,n),this.FUseColumns&&o>=0&&o<=this.FColumns.GetCount()-1&&null==r&&(null!=this.FColumnProp.FDefaultFont&&(this.FColumnProp.FFontSize=this.FColumnProp.FDefaultFont.FSize,this.FColumnProp.FFontStyle=rtl.refSet(this.FColumnProp.FDefaultFont.FStyle)),0===s&&(this.FColumnProp.FColor=this.FColumns.GetItem$1(o).FColor,this.FColumnProp.FFontColor=this.FColumns.GetItem$1(o).FFont.FColor,this.FColumnProp.FFontName=this.FColumns.GetItem$1(o).FFont.FName,this.FColumnProp.FFontStyle=rtl.refSet(this.FColumns.GetItem$1(o).FFont.FStyle),this.FColumnProp.FFontSize=this.FColumns.GetItem$1(o).FFont.FSize,this.FColumnProp.FBorderColor=this.FColumns.GetItem$1(o).FBorderColor,this.FColumnProp.FBorderWidth=this.FColumns.GetItem$1(o).FBorderWidth),2!==s&&3!==s||(this.FColumnProp.FFontColor=this.FColumns.GetItem$1(o).FFixedFont.FColor,this.FColumnProp.FFontName=this.FColumns.GetItem$1(o).FFixedFont.FName,this.FColumnProp.FFontStyle=rtl.refSet(this.FColumns.GetItem$1(o).FFixedFont.FStyle),this.FColumnProp.FFontSize=this.FColumns.GetItem$1(o).FFixedFont.FSize),this.FColumnProp.FAlignHorz=this.FColumns.GetItem$1(o).FHorzAlignment,this.FColumnProp.FAlignVert=this.FColumns.GetItem$1(o).FVertAlignment,this.FColumnProp.FReadOnly=this.FColumns.GetItem$1(o).FReadOnly,this.FColumnProp.FFixed=this.FColumns.GetItem$1(o).FFixed,this.FColumnProp.FWordWrap=this.FColumns.GetItem$1(o).FWordWrap,r=this.FColumnProp),this.FUseColumns&&o>=0&&o<=this.FColumns.GetCount()-1&&i.SetWordWrapping(this.FColumns.GetItem$1(o).FWordWrap),null!=r&&(-1!==r.FColor&&0===s&&i.FFill.SetColor(r.FColor),-1!==r.FFontColor&&0===s&&i.FFont.SetColor(r.FFontColor),-1!==r.FBorderColor&&0===s&&i.FStroke.SetColor(r.FBorderColor),i.SetTextAlign(r.FAlignHorz),i.SetVerticalTextAlign(r.FAlignVert),i.FFont.SetStyle(rtl.refSet(r.FFontStyle)),i.FFont.SetSize(Math.round(r.FFontSize)),""!==r.FFontName&&i.FFont.SetName(r.FFontName),i.FStroke.SetWidth(r.FBorderWidth),this.FUseColumns||i.SetWordWrapping(r.FWordWrap)),this.FOptions.FURL.FShow&&pas["WEBLib.TMSFNCGridDataUtil"].IsURL(this.GetCells(o,n))&&(i.FFont.SetColor(this.FOptions.FURL.FColor),this.FOptions.FURL.FUnderline&&i.FFont.SetStyle(rtl.unionSet(i.FFont.FStyle,rtl.createSet(3))))},this.DoGetCellProperties=function(e,i,s){var o,n,r=null,a=!1,l=null,h=0;o=this.DisplToRealColumn(e),n=this.DisplToRealRow(i),pas["WEBLib.TMSFNCGridCell"].TTMSFNCButtonGridCell.isPrototypeOf(s)&&null!=(r=this.GetCellProps(o,n))&&t.TTMSFNCGridCellButton.isPrototypeOf(r.FControl)&&(rtl.as(s,pas["WEBLib.TMSFNCGridCell"].TTMSFNCButtonGridCell).SetControlEnabled(!this.IsReadOnly(o,n)),rtl.as(s,pas["WEBLib.TMSFNCGridCell"].TTMSFNCButtonGridCell).SetButtonText(rtl.as(r.FControl,t.TTMSFNCGridCellButton).FText),rtl.as(s,pas["WEBLib.TMSFNCGridCell"].TTMSFNCButtonGridCell).SetButtonWidth(rtl.as(r.FControl,t.TTMSFNCGridCellButton).FWidth),rtl.as(s,pas["WEBLib.TMSFNCGridCell"].TTMSFNCButtonGridCell).SetButtonHeight(rtl.as(r.FControl,t.TTMSFNCGridCellButton).FHeight)),pas["WEBLib.TMSFNCGridCell"].TTMSFNCRadioGridCell.isPrototypeOf(s)&&(r=this.GetCellProps(o,n),this.FUseColumns&&null==this.GetIntObjects(o,n)?o<this.FColumns.GetCount()&&4===this.FColumns.GetItem$1(o).FColumnType&&(rtl.as(s,pas["WEBLib.TMSFNCGridCell"].TTMSFNCRadioGridCell).SetControlEnabled(!this.IsReadOnly(o,n)),l=rtl.as(s,pas["WEBLib.TMSFNCGridCell"].TTMSFNCRadioGridCell).FOnCheckChanged,rtl.as(s,pas["WEBLib.TMSFNCGridCell"].TTMSFNCRadioGridCell).FOnCheckChanged=null,rtl.as(s,pas["WEBLib.TMSFNCGridCell"].TTMSFNCRadioGridCell).SetChecked(this.GetCells(e,i)===this.FCheckTrue),rtl.as(s,pas["WEBLib.TMSFNCGridCell"].TTMSFNCRadioGridCell).FOnCheckChanged=l):null!=r&&t.TTMSFNCGridCellRadioButton.isPrototypeOf(r.FControl)&&(rtl.as(s,pas["WEBLib.TMSFNCGridCell"].TTMSFNCRadioGridCell).SetControlEnabled(!this.IsReadOnly(o,n)),l=rtl.as(s,pas["WEBLib.TMSFNCGridCell"].TTMSFNCRadioGridCell).FOnCheckChanged,rtl.as(s,pas["WEBLib.TMSFNCGridCell"].TTMSFNCRadioGridCell).FOnCheckChanged=null,rtl.as(s,pas["WEBLib.TMSFNCGridCell"].TTMSFNCRadioGridCell).SetChecked(rtl.as(r.FControl,t.TTMSFNCGridCellRadioButton).FChecked),rtl.as(s,pas["WEBLib.TMSFNCGridCell"].TTMSFNCRadioGridCell).FOnCheckChanged=l)),pas["WEBLib.TMSFNCGridCell"].TTMSFNCCommentGridCell.isPrototypeOf(s)&&null!=(r=this.GetCellProps(o,n))&&(rtl.as(s,pas["WEBLib.TMSFNCGridCell"].TTMSFNCCommentGridCell).FCommentText=r.FComment,-1!==r.FCommentColor&&(rtl.as(s,pas["WEBLib.TMSFNCGridCell"].TTMSFNCCommentGridCell).FCommentColor=r.FCommentColor)),pas["WEBLib.TMSFNCGridCell"].TTMSFNCCheckGridCell.isPrototypeOf(s)&&(r=this.GetCellProps(o,n),this.FUseColumns&&null==this.GetIntObjects(o,n)?o<this.FColumns.GetCount()&&2===this.FColumns.GetItem$1(o).FColumnType&&(rtl.as(s,pas["WEBLib.TMSFNCGridCell"].TTMSFNCCheckGridCell).SetControlEnabled(!this.IsReadOnly(o,n)),l=rtl.as(s,pas["WEBLib.TMSFNCGridCell"].TTMSFNCCheckGridCell).FOnCheckChanged,rtl.as(s,pas["WEBLib.TMSFNCGridCell"].TTMSFNCCheckGridCell).FOnCheckChanged=null,rtl.as(s,pas["WEBLib.TMSFNCGridCell"].TTMSFNCCheckGridCell).SetChecked(this.GetCells(e,i)===this.FCheckTrue),rtl.as(s,pas["WEBLib.TMSFNCGridCell"].TTMSFNCCheckGridCell).FOnCheckChanged=l):(null!=r&&t.TTMSFNCGridCellCheckBox.isPrototypeOf(r.FControl)&&(rtl.as(s,pas["WEBLib.TMSFNCGridCell"].TTMSFNCCheckGridCell).SetControlEnabled(!this.IsReadOnly(o,n)),l=rtl.as(s,pas["WEBLib.TMSFNCGridCell"].TTMSFNCCheckGridCell).FOnCheckChanged,rtl.as(s,pas["WEBLib.TMSFNCGridCell"].TTMSFNCCheckGridCell).FOnCheckChanged=null,rtl.as(s,pas["WEBLib.TMSFNCGridCell"].TTMSFNCCheckGridCell).SetChecked(rtl.as(r.FControl,t.TTMSFNCGridCellCheckBox).FChecked),rtl.as(s,pas["WEBLib.TMSFNCGridCell"].TTMSFNCCheckGridCell).FOnCheckChanged=l),null!=r&&t.TTMSFNCGridCellDataCheckBox.isPrototypeOf(r.FControl)&&(rtl.as(s,pas["WEBLib.TMSFNCGridCell"].TTMSFNCCheckGridCell).SetControlEnabled(!this.IsReadOnly(o,n)),l=rtl.as(s,pas["WEBLib.TMSFNCGridCell"].TTMSFNCCheckGridCell).FOnCheckChanged,rtl.as(s,pas["WEBLib.TMSFNCGridCell"].TTMSFNCCheckGridCell).FOnCheckChanged=null,rtl.as(s,pas["WEBLib.TMSFNCGridCell"].TTMSFNCCheckGridCell).SetChecked(this.GetCells(e,i)===this.FCheckTrue),rtl.as(s,pas["WEBLib.TMSFNCGridCell"].TTMSFNCCheckGridCell).FOnCheckChanged=l))),pas["WEBLib.TMSFNCGridCell"].TTMSFNCBitmapGridCell.isPrototypeOf(s)&&(r=this.GetCellProps(o,n),rtl.as(s,pas["WEBLib.TMSFNCGridCell"].TTMSFNCBitmapGridCell).FBitmapContainer=this.GetBitmapContainer(),null!=r&&t.TTMSFNCGridCellBitmapName.isPrototypeOf(r.FControl)&&(rtl.as(r.FControl,t.TTMSFNCGridCellBitmapName).FData?rtl.as(s,pas["WEBLib.TMSFNCGridCell"].TTMSFNCBitmapGridCell).SetBitmapName(this.GetCells(e,i)):rtl.as(s,pas["WEBLib.TMSFNCGridCell"].TTMSFNCBitmapGridCell).SetBitmapName(rtl.as(r.FControl,t.TTMSFNCGridCellBitmapName).FBitmapName)),null!=r&&t.TTMSFNCGridCellBitmap.isPrototypeOf(r.FControl)&&rtl.as(s,pas["WEBLib.TMSFNCGridCell"].TTMSFNCBitmapGridCell).FBitmap.Assign(rtl.as(r.FControl,t.TTMSFNCGridCellBitmap).FBitmap)),pas["WEBLib.TMSFNCGridCell"].TTMSFNCNodeGridCell.isPrototypeOf(s)&&null!=(r=this.GetCellProps(o,n))&&t.TTMSFNCGridCellNode.isPrototypeOf(r.FControl)&&(rtl.as(s,pas["WEBLib.TMSFNCGridCell"].TTMSFNCNodeGridCell).FState=rtl.as(r.FControl,t.TTMSFNCGridCellNode).FState),pas["WEBLib.TMSFNCGridCell"].TTMSFNCProgressGridCell.isPrototypeOf(s)&&(r=this.GetCellProps(o,n),this.FUseColumns&&null==this.GetIntObjects(o,n)?o<this.FColumns.GetCount()&&3===this.FColumns.GetItem$1(o).FColumnType&&(h=0,pas.SysUtils.TryStrToInt(this.GetCells(e,i),{get:function(){return h},set:function(t){h=t}})?rtl.as(s,pas["WEBLib.TMSFNCGridCell"].TTMSFNCProgressGridCell).SetValue(h):rtl.as(s,pas["WEBLib.TMSFNCGridCell"].TTMSFNCProgressGridCell).SetValue(0)):null!=r&&t.TTMSFNCGridCellProgressBar.isPrototypeOf(r.FControl)&&(rtl.as(r.FControl,t.TTMSFNCGridCellProgressBar).FData?(h=0,pas.SysUtils.TryStrToInt(this.GetCells(e,i),{get:function(){return h},set:function(t){h=t}})?rtl.as(s,pas["WEBLib.TMSFNCGridCell"].TTMSFNCProgressGridCell).SetValue(h):rtl.as(s,pas["WEBLib.TMSFNCGridCell"].TTMSFNCProgressGridCell).SetValue(0)):rtl.as(s,pas["WEBLib.TMSFNCGridCell"].TTMSFNCProgressGridCell).SetValue(rtl.as(r.FControl,t.TTMSFNCGridCellProgressBar).FValue))),this.FOptions.FFiltering.FDropDown&&pas["WEBLib.TMSFNCGridCell"].TTMSFNCFixedGridCell.isPrototypeOf(s)&&(a=!1,this.FOptions.FFiltering.FDropDownFixedRow===n&&o>=this.FFixedColumns&&o<this.GetColumnCount()-this.FFixedRightColumns&&(a=!0,this.DoNeedFilterDropDown(o,n,{get:function(){return a},set:function(t){a=t}})),rtl.as(s,pas["WEBLib.TMSFNCGridCell"].TTMSFNCFixedGridCell).FShowDropDownButton=a,rtl.as(s,pas["WEBLib.TMSFNCGridCell"].TTMSFNCFixedGridCell).FSizeMargin=this.FOptions.FMouse.FColumnSizeMargin-2)},this.DoGetCellMergeInfo=function(t,e,i,s,o,n){var r;null!=(r=this.GetIntObjects(this.DisplToRealColumn(t),this.DisplToRealRow(e)))&&-1!==r.FBaseCol&&(i.set(this.RealToDisplColumn(r.FBaseCol)),s.set(this.RealToDisplRow(r.FBaseRow)),o.set(r.FColSpan),n.set(r.FRowSpan))},this.DoGetCellEditorType=function(e,i,s){var o;(o=this.DisplToRealColumn(e))<this.FColumns.GetCount()&&s.set(this.FColumns.GetItem$1(o).FEditor),this.IsCellControl(e,i,t.TTMSFNCGridCellCombo)&&s.set(12)},this.DoGetCellEditorCustomClassType=function(t,e,i){var s;null!=(s=this.GetIntObjects(t,e))&&s.FReadOnly&&i.set(null)},this.DoCellEditGetData=function(t,e,i,s){},this.DoCellEditValidateData=function(t,e,i,s,o){},this.DoCellEditSetData=function(t,e,i,s){this.SetCells(t,e,s.get())},this.DoCellEditGetColor=function(t,e,i,s){},this.DoCellEditValidateColor=function(t,e,i,s,o){},this.DoCellEditSetColor=function(t,e,i,s){this.SetColors(t,e,s.get())},this.DoCellEditDone=function(t,e,i){for(var s=0,o=0,n=0,r=this.GetColumnCount()-1;n<=r;n++)o=n,0!==(s=this.GetColumnCalculation(o))&&this.UpdateColumnCalc(o,s)},this.DoGetCellEditorProperties=function(e,i,s){var o=null,n=0;pas["WEBLib.StdCtrls"].TComboBox.isPrototypeOf(s)&&(rtl.as(s,pas["WEBLib.StdCtrls"].TComboBox).SetParent(this),n=this.DisplToRealColumn(e),this.FUseColumns&&n<this.FColumns.GetCount()&&this.FColumns.GetItem$1(n).FEditor in rtl.createSet(12)&&pas["WEBLib.StdCtrls"].TComboBox.isPrototypeOf(s)&&rtl.as(s,pas["WEBLib.StdCtrls"].TComboBox).FItems.Assign(this.FColumns.GetItem$1(n).FComboItems),this.IsCellControl(e,i,t.TTMSFNCGridCellCombo)&&null!=(o=this.GetIntObjects(e,i))&&pas["WEBLib.StdCtrls"].TComboBox.isPrototypeOf(s)&&rtl.as(s,pas["WEBLib.StdCtrls"].TComboBox).FItems.Assign(rtl.as(o.FControl,t.TTMSFNCGridCellCombo).FItems),rtl.as(s,pas["WEBLib.StdCtrls"].TComboBox).SetParent(null))},this.DoColumnCalc=function(t,e,i){var s=0;return s=0,null!=this.FOnColumnCalc&&this.FOnColumnCalc(this,t,e,i,{get:function(){return s},set:function(t){s=t}}),s},this.DoCellAnchorClick=function(t,e,i){},this.DoCanEditCell=function(t,e,i){i.set(this.FOptions.FEditing.FEnabled),i.set(i.get()&&!this.IsReadOnly(t,e))},this.DoCanSizeColumn=function(t,e){},this.DoCanSizeRow=function(t,e){},this.DoColumnSize=function(t,e){},this.DoRowSize=function(t,e){},this.DoColumnSized=function(t,e){},this.DoRowSized=function(t,e){},this.DoCanSortColumn=function(t,e){},this.DoColumnSorted=function(t,e){},this.DoIsCellSelected=function(t,e){var i=!1;i=!1;var s=this.FOptions.FSelection.FMode;return 8===s?i=this.GetColumnSelect(t):7===s?i=this.GetRowSelect(e):9===s&&(i=this.GetCellSelect(t,e)),i},this.CreateColumnProp=function(){null!=this.FColumnProp&&rtl.free(this,"FColumnProp"),this.FColumnProp=t.TTMSFNCGridCellProperty.$create("Create$1",[this.FDefaultFont])},this.Create$1=function(e){var i=0;for(pas["WEBLib.TMSFNCCustomScrollControl"].TTMSFNCCustomScrollControl.Create$1.apply(this,arguments),this.FDefaultLayout=pas["WEBLib.TMSFNCGridCell"].TTMSFNCGridCellLayout.$create("Create$1"),this.FUseColumns=!0,this.FColumns=t.TTMSFNCGridColumns.$create("Create$3",[this]),i=0;i<=4;i++)this.FColumns.Add$1();return this.FGroupColumn=-1,this.FSortColumn=-1,this.FRowCount=10,this.FColumnCount=5,this.FDefaultRowHeight=24,this.FDefaultColumnWidth=68,this.FFixedRows=1,this.FFixedColumns=1,this.FFixedRightColumns=0,this.FFixedFooterRows=0,this.FFilterApplied=!1,this.FCheckTrue="TRUE",this.FCheckFalse="FALSE",this.FFloatFormat="%g",this.FColumnOrder=pas["WEBLib.TMSFNCGridDataUtil"].TTMSFNCGridIntList.$create("Create$1"),this.FDefaultFont=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFont.$create("Create$2"),this.FOptions=pas["WEBLib.TMSFNCGridOptions"].TTMSFNCGridOptions.$create("Create$1"),this.FOptions.FOnChange=rtl.createCallback(this,"DoOptionsChange"),this.FGlobalFont=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCAppearanceGlobalFont.$create("Create$1",[this]),this.FColumnW=t.TTMSFNCGridSingleList.$create("Create$3",[this]),this.FOrigColumnW=t.TTMSFNCGridSingleList.$create("Create$3",[this]),this.FRowH=t.TTMSFNCGridSingleList.$create("Create$3",[this]),this.FRowList=t.TTMSFNCGridRowInfoList.$create("Create$1"),this.FRowDisplayList=t.TTMSFNCGridIntegerList.$create("Create$1"),this.FColumnDisplayList=t.TTMSFNCGridIntegerList.$create("Create$1"),this.FHiddenColumnList=t.TTMSFNCGridIntegerList.$create("Create$1"),this.FSuppressedColumnList=t.TTMSFNCGridIntegerList.$create("Create$1"),this.FHiddenRowList=t.TTMSFNCGridIntegerList.$create("Create$1"),this.FColSelect=pas["WEBLib.TMSFNCGridDataUtil"].TTMSFNCGridIntList.$create("Create$1"),this.FSelectedCells=t.TTMSFNCGridCellList.$create("Create$2"),this.FMarkList=t.TTMSFNCGridCellMarkList.$create("Create$3",[this]),this.FCellCalcList=pas["WEBLib.TMSFNCGridDataUtil"].TTMSFNCGridIntList.$create("Create$1"),this.FIOOffset.$assign(pas.Types.Point(this.FFixedColumns,this.FFixedRows)),this.FFilter=t.TTMSFNCGridFilter.$create("Create$3",[this]),this.FSortIndexes=t.TTMSFNCGridSortIndexList.$create("Create$1"),this.CreateColumnProp(),this.FUpdateCount$1=this.FUpdateCount$1+1,this.SetColumnCount(this.FColumnCount),this.FUpdateCount$1=this.FUpdateCount$1-1,this},this.Destroy=function(){this.Clear(),rtl.free(this,"FGlobalFont"),rtl.free(this,"FDefaultLayout"),rtl.free(this,"FColumns"),rtl.free(this,"FColumnProp"),rtl.free(this,"FDefaultFont"),rtl.free(this,"FOptions"),rtl.free(this,"FColumnW"),rtl.free(this,"FOrigColumnW"),rtl.free(this,"FRowH"),rtl.free(this,"FRowDisplayList"),rtl.free(this,"FColumnDisplayList"),rtl.free(this,"FHiddenColumnList"),rtl.free(this,"FSuppressedColumnList"),rtl.free(this,"FHiddenRowList"),rtl.free(this,"FRowList"),rtl.free(this,"FFilter"),rtl.free(this,"FSortIndexes"),rtl.free(this,"FMarkList"),rtl.free(this,"FColSelect"),rtl.free(this,"FSelectedCells"),rtl.free(this,"FCellCalcList"),this.FColumnOrder.Clear(),rtl.free(this,"FColumnOrder"),pas["WEBLib.TMSFNCCustomScrollControl"].TTMSFNCCustomScrollControl.Destroy.call(this)},this.Clear=function(){var t=0,e=0,i=null,s=null;this.BeginUpdate(),this.UnHideRowsAll(),this.UnHideColumnsAll();for(var o=this.FRowList.GetCount()-1;o>=0;o--)if(t=o,null!=this.FRowList.GetItem(t)){for(var n=0,r=this.FRowList.GetItem(t).FData.GetCount()-1;n<=r;n++)e=n,null!=(i=this.FRowList.GetItem(t).FData.GetObject(e))&&i.IsBaseCell(e,t)&&(i.FreeControl(),i=rtl.freeLoc(i));s=this.FRowList.GetItem(t),s=rtl.freeLoc(s)}this.FRowList.Clear(),this.FRowDisplayList.Clear(),this.FColumnDisplayList.Clear(),this.FHiddenColumnList.Clear(),this.FSuppressedColumnList.Clear(),this.FHiddenRowList.Clear(),this.EndUpdate()},this.ClearCells=function(t){var e=0,i=0,s=null,o=null;this.BeginUpdate();for(var n=t.StartRow,r=t.EndRow;n<=r;n++)if((e=n)<this.FRowList.GetCount()&&null!=this.FRowList.GetItem(e))for(var a=t.StartCol,l=Math.min(t.EndCol,this.FRowList.GetItem(e).FData.GetCount()-1);a<=l;a++)i=a,this.SplitCell(i,e),(o=this.FRowList.GetItem(e).FData).Put(i,""),null!=(s=o.GetObject(i))&&(null!=s.FControl&&s.FreeControl(),s=rtl.freeLoc(s),o.PutObject(i,null));this.EndUpdate()},this.DisplToRealRow=function(t){return t>=0&&t<this.FRowDisplayList.GetCount()?this.FRowDisplayList.GetItem(t):t},this.RealToDisplRow=function(t){var e=0,i=0;for(e=t,i=0;i<this.FRowDisplayList.GetCount();){if(this.FRowDisplayList.GetItem(i)===t){e=i;break}i+=1}return e},this.DisplToRealColumn=function(t){return t>=0&&t<this.FColumnDisplayList.GetCount()?this.FColumnDisplayList.GetItem(t):t},this.RealToDisplColumn=function(t){var e=0,i=0;for(e=-1,i=0;i<this.FColumnDisplayList.GetCount();){if(this.FColumnDisplayList.GetItem(i)===t){e=i;break}i+=1}return e},this.InitOriginalColumnSizes=function(){var t=0;this.FOrigColumnW.Clear();for(var e=0,i=this.GetColumnCount()-1;e<=i;e++){t=e,this.FOrigColumnW.Add$1().SetValue(this.GetColWidths(t))}this.FOldSize=this.GetWidth()},this.CellRange=function(e,i,s,o){var n=t.TTMSFNCGridCellRecRange.$new();return n.StartCol=e,n.StartRow=i,n.EndCol=s,n.EndRow=o,n},this.IsReadOnly=function(t,e){var i=!1;return i=!1,this.DoGetCellReadOnly(t,e,{get:function(){return i},set:function(t){i=t}}),i},this.ClearRowSelect=function(){for(var t=0,e=this.FFixedRows,i=this.GetRowCount()-this.FFixedFooterRows-1;e<=i&&!((t=e)>=this.FRowList.GetCount());e++)null!=this.FRowList.GetItem(t)&&this.FRowList.GetItem(t).SetState(0)},this.GetSelectedRowCount=function(){var t=0,e=0;t=0;for(var i=this.FFixedRows,s=this.GetRowCount()-this.FFixedFooterRows-1;i<=s&&!((e=i)>=this.FRowList.GetCount());i++)null!=this.FRowList.GetItem(e)&&1===this.FRowList.GetItem(e).FState&&(t+=1);return t},this.ClearColumnSelect=function(){this.FColSelect.Clear()},this.GetSelectedColumnCount=function(){return this.FColSelect.GetCount()},this.ClearCellSelect=function(){this.FSelectedCells.Clear$1()},this.GetSelectedCellCount=function(){return this.FSelectedCells.GetCount()},this.SetColumnOrder=function(){var t=0;this.FColumnOrder.Clear();for(var e=1,i=this.GetColumnCount();e<=i;e++)t=e,this.FColumnOrder.Add$1(t-1)},this.IsFixed=function(t,e){return e<this.FFixedRows||e>this.GetRowCount()-1-this.FFixedFooterRows||t<this.FFixedColumns||t>this.GetColumnCount()-1-this.FFixedRightColumns||this.IsNormalFixed(t,e)},this.IsBand=function(t){var e=!1;return e=pas.System.Odd(t),this.DoGetRowIsBand(t,{get:function(){return e},set:function(t){e=t}}),e},this.IsNormalFixed=function(t,e){var i=!1;return i=!1,this.DoGetCellIsFixed(t,e,{get:function(){return i},set:function(t){i=t}}),i},this.NextSelectableRow=function(e,i){var s,o,n,r,a=t.TTMSFNCGridCellRec.$new(),l=0,h=!1;if(n=s=e,r=o=i,a.Col=e,a.Row=i,(l=this.RowSpan(s,o))>0?(h=a.Row+l<=this.GetRowCount()-1-this.FFixedFooterRows)&&(a.Row=a.Row+l):(h=a.Row+1<=this.GetRowCount()-1-this.FFixedFooterRows)&&(a.Row=a.Row+1),h)for(;this.IsNormalFixed(a.Col,a.Row)&&a.Row<this.GetRowCount()-1-this.FFixedFooterRows;)l=this.RowSpan(s,o),a.Row=l>0?a.Row+l:a.Row+1;return this.IsNormalFixed(a.Col,a.Row)&&(a.Col=n,a.Row=r),a},this.NextSelectableColumn=function(e,i){var s,o,n,r,a=t.TTMSFNCGridCellRec.$new(),l=0,h=!1;if(o=s=e,r=n=i,a.Col=e,a.Row=i,(l=this.ColSpan(s,n))>0?(h=a.Col+l<=this.GetColumnCount()-1-this.FFixedRightColumns)&&(a.Col=a.Col+l):(h=a.Col+1<=this.GetColumnCount()-1-this.FFixedRightColumns)&&(a.Col=a.Col+1),h)for(;(this.IsNormalFixed(a.Col,a.Row)||this.IsSuppressedColumn(a.Col))&&a.Col<this.GetColumnCount()-1-this.FFixedRightColumns;)l=this.ColSpan(s,n),a.Col=l>0?a.Col+l:a.Col+1;return(this.IsNormalFixed(a.Col,a.Row)||this.IsSuppressedColumn(a.Col))&&(a.Col=o,a.Row=r),a},this.PreviousSelectableColumn=function(e,i){var s,o,n=t.TTMSFNCGridCellRec.$new();if(o=e,s=i,n.Col=e,n.Row=i,n.Col-1>=this.FFixedColumns)for(n.Col=n.Col-1;(this.IsNormalFixed(n.Col,n.Row)||this.IsSuppressedColumn(n.Col))&&n.Col>this.FFixedColumns;)n.Col=n.Col-1;return(this.IsNormalFixed(n.Col,n.Row)||this.IsSuppressedColumn(n.Col))&&(n.Col=o,n.Row=s),n},this.PreviousSelectableRow=function(e,i){var s,o,n=t.TTMSFNCGridCellRec.$new();if(s=e,o=i,n.Col=e,n.Row=i,n.Row-1>=this.FFixedRows)for(n.Row=n.Row-1;this.IsNormalFixed(n.Col,n.Row)&&n.Row>this.FFixedRows;)n.Row=n.Row-1;return this.IsNormalFixed(n.Col,n.Row)&&(n.Col=s,n.Row=o),n},this.ApplyFilter=function(){var e=0,i=0,s=null,o=!1;s=t.TTMSFNCGridIntegerList.$create("Create$1");try{for(var n=this.FFixedRows,r=this.GetRowCount()-1;n<=r;n++)e=n,o=1===this.FOptions.FFiltering.FRows||0===this.FOptions.FFiltering.FRows&&!this.IsNode(e)&&!this.IsSummary(e)&&!this.IsFixed(this.FFixedColumns,e),!this.MatchFilter(e)&&o&&s.Add(e);i=0;for(var a=0,l=s.GetCount()-1;a<=l;a++){for(e=a;this.FRowDisplayList.GetItem(i)!==s.GetItem(e);)i+=1;this.FRowDisplayList.GetItem(i)===s.GetItem(e)&&this.FRowDisplayList.Delete(i)}this.FRowCount=this.FRowCount-s.GetCount()}finally{s=rtl.freeLoc(s),this.FFilterApplied=!0,this.UpdateControl(!0,!0)}},this.RemoveFilter=function(){this.UnHideRowsAll(),this.FFilterApplied=!1},this.LookupInColumn=function(t,e,i,s){var o=0;return o=i?0:this.FFixedRows,this.LookupInColumnFromRow(t,o,e,i,s)},this.LookupInColumnFromRow=function(e,i,s,o,n){var r=0,a=0,l=0,h=0,F=0,p="",c="";if(r=-1,c=s,this.FOptions.FLookup.FCaseSensitive||(c=pas.SysUtils.UpperCase(c)),o?(l=this.FFixedRows,h=this.GetRowCount()-1):(l=i,h=this.GetRowCount()-1-this.FFixedFooterRows),e===this.FSortColumn){do{if(F=l+Math.round((h-l)/2),p=this.GetCells(e,this.DisplToRealRow(F)),this.FOptions.FLookup.FCaseSensitive||(p=pas.SysUtils.UpperCase(p)),1===pas.System.Pos(c,p)){r=F;break}c>p?l=F:h=F}while(!(h-l<=1));if(F>l&&-1!==r){do{if(p=this.GetCells(e,this.DisplToRealRow(F-1)),this.FOptions.FLookup.FCaseSensitive||(p=pas.SysUtils.UpperCase(p)),1!==pas.System.Pos(c,p))break;F-=1}while(!(F<=l));r=F}}else for(var u=l,C=h;u<=C;u++)if(a=u,p=this.GetCells(e,this.DisplToRealRow(a)),this.FOptions.FLookup.FCaseSensitive||(p=pas.SysUtils.UpperCase(p)),1===pas.System.Pos(c,p)){r=a;break}return n&&-1!==r&&this.SetFocusedCell(t.MakeCell(e,r)),r},this.IsCheckBox=function(e,i){return this.IsCellControl(e,i,t.TTMSFNCGridCellCheckBox)||this.IsCellControl(e,i,t.TTMSFNCGridCellDataCheckBox)},this.IsSummary=function(e){return this.IsCellControl(0,e,t.TTMSFNCGridCellSummary)},this.IsNode=function(e){return this.IsCellControl(this.FFixedColumns-1,e,t.TTMSFNCGridCellNode)},this.GetNodeState=function(t){var e,i=0;return i=1,null!=(e=this.GetNode(t))&&(i=e.FState),i},this.GetNodeSpan=function(t){var e,i=0;return i=-1,null!=(e=this.GetNode(t))&&(i=e.FSpan),i},this.GetNode=function(e){var i,s=null;return s=null,null!=(i=this.GetIntObjects(this.FFixedColumns-1,e))&&null!=i.FControl&&t.TTMSFNCGridCellNode.isPrototypeOf(i.FControl)&&(s=rtl.as(i.FControl,t.TTMSFNCGridCellNode)),s},this.OpenNode=function(t){var e=null;null!=(e=this.GetNode(t))&&-1!==e.FSpan&&0===e.FState&&(e.FState=1,this.UnHideRows(t+1,e.FSpan))},this.CloseNode=function(t){var e=null;null!=(e=this.GetNode(t))&&-1!==e.FSpan&&1===e.FState&&(e.FState=0,this.HideRows(t+1,e.FSpan))},this.OpenAllNodes=function(){var t=0,e=0;for(t=this.FFixedRows;t<this.GetRowCount()-this.FFixedFooterRows;)e=this.DisplToRealRow(t),this.IsNode(e)&&this.OpenNode(e),t+=1;this.UpdateGridCells(!1)},this.MergeSelection=function(t){this.MergeCells(t.StartCol,t.StartRow,t.EndCol-t.StartCol+1,t.EndRow-t.StartRow+1)},this.MergeCells=function(e,i,s,o){var n=null,r=null,a=0,l=0,h=t.TTMSFNCGridCellRec.$new(),F=!1;this.FBlockUpdate=!0,F=!1,n=null;for(var p=e,c=e+s-1;p<=c;p++){a=p;for(var u=i,C=i+o-1;u<=C;u++)l=u,F?null!=(r=this.GetIntObjects(a,l))&&(null!=r.FControl&&r.FreeControl(),r=rtl.freeLoc(r)):(null==(n=this.GetIntObjects(a,l))&&(n=t.TTMSFNCGridCellProperty.$create("Create$1",[this.GetDefaultFont(this.RealToDisplColumn(e),this.RealToDisplRow(i))])),n.FBaseCol=e,n.FBaseRow=i,n.FColSpan=s,n.FRowSpan=o,F=!0),this.SetIntObjects(a,l,n)}h.$assign(this.BaseCell(e,i)),h.Col=e,h.Row=i,this.SetFocusedCell(h),this.FBlockUpdate=!1,this.UpdateGridCells(!1)},this.IsMerged=function(t,e){var i,s=!1;return s=!1,null!=(i=this.GetIntObjects(t,this.DisplToRealRow(e)))&&-1!==i.FBaseCol&&-1!==i.FBaseRow&&(s=i.FColSpan>1||i.FRowSpan>1),s},this.IsYMergedCell=function(t,e){var i,s=!1;return s=!1,null!=(i=this.GetIntObjects(t,this.DisplToRealRow(e)))&&-1!==i.FBaseCol&&-1!==i.FBaseRow&&(s=i.FRowSpan>1),s},this.IsXMergedCell=function(t,e){var i,s=!1;return s=!1,null!=(i=this.GetIntObjects(t,this.DisplToRealRow(e)))&&-1!==i.FBaseCol&&-1!==i.FBaseRow&&(s=i.FColSpan>1),s},this.IsBaseCell=function(e,i){var s=t.TTMSFNCGridCellRec.$new();return s.$assign(this.BaseCell(e,i)),s.Col===e&&s.Row===i},this.ColSpan=function(t,e){var i,s=0;return s=0,null!=(i=this.GetIntObjects(this.DisplToRealColumn(t),this.DisplToRealRow(e)))&&-1!==i.FBaseCol&&-1!==i.FBaseRow&&(s=i.FColSpan),s},this.RowSpan=function(t,e){var i,s=0;return s=0,null!=(i=this.GetIntObjects(this.DisplToRealColumn(t),this.DisplToRealRow(e)))&&-1!==i.FBaseCol&&-1!==i.FBaseRow&&(s=i.FRowSpan),s},this.BaseCell=function(e,i){var s,o=t.TTMSFNCGridCellRec.$new();return s=this.GetIntObjects(this.DisplToRealColumn(e),this.DisplToRealRow(i)),o.Col=e,o.Row=i,null!=s&&-1!==s.FBaseCol&&-1!==s.FBaseRow&&(o.Col=s.FBaseCol,o.Row=this.RealToDisplRow(s.FBaseRow)),o},this.SplitCell=function(t,e){var i=null,s=0,o=0,n=0,r=0,a=0,l=0;if(null!=(i=this.GetIntObjects(t,e))&&i.IsBaseCell(t,e)){n=i.FBaseCol,a=i.FBaseRow,r=i.FBaseCol+i.FColSpan,l=i.FBaseRow+i.FRowSpan;for(var h=n,F=r-1;h<=F;h++){s=h;for(var p=a,c=l-1;p<=c;p++)o=p,null!=(i=this.GetIntObjects(s,o))&&(i.FBaseCol=-1,i.FBaseRow=-1,i.FColSpan=0,i.FRowSpan=0),o===a&&s===n||this.SetIntObjects(s,o,null)}this.UpdateGridCells(!1)}},this.DeleteRow=function(t){this.DeleteRows(t,1)},this.DeleteRows=function(e,i){var s=0,o=0,n=null,r=null;this.BeginUpdate(),this.ClearCells(t.TTMSFNCGridCellRecRange.$clone(this.CellRange(0,e,this.GetColumnCount()-1+this.GetHiddenColCount(),e+i-1)));for(var a=e,l=this.FRowDisplayList.GetCount()-1;a<=l;a++){s=a;for(var h=0,F=this.GetColumnCount()-1;h<=F;h++)o=h,this.IsBaseCell(o,s)&&null!=(r=this.GetIntObjects(o,s))&&r.FBaseRow>=e&&(r.FBaseRow=r.FBaseRow-i)}for(;this.FRowList.GetCount()<this.GetRowCount();)this.FRowList.Add(null);for(var p=1,c=i;p<=c;p++)s=p,null!=this.FRowList.GetItem(e)&&(n=this.FRowList.GetItem(e),n=rtl.freeLoc(n)),e<this.FRowList.GetCount()&&this.FRowList.Delete(e),e<this.FRowDisplayList.GetCount()&&this.FRowDisplayList.Delete(e),this.FRowCount=this.FRowCount-1;for(var u=e,C=this.FRowDisplayList.GetCount()-1;u<=C;u++)s=u,this.FRowDisplayList.SetItem(s,this.FRowDisplayList.GetItem(s)-i);this.EndUpdate()},this.InsertRow=function(t){this.InsertRows(t,1)},this.InsertRows=function(e,i){var s=0,o=0,n=0,r=null;if(!(e>this.GetRowCount())){this.BeginUpdate(),this.EnsureRow(e);for(var a=e,l=this.FRowDisplayList.GetCount()-1;a<=l;a++){s=a;for(var h=0,F=this.GetColumnCount()-1;h<=F;h++)o=h,this.IsBaseCell(o,s)&&null!=(r=this.GetIntObjects(o,s))&&r.FBaseRow>=e&&(r.FBaseRow=r.FBaseRow+i)}for(var p=1,c=i;p<=c;p++)s=p,this.FRowList.Insert(e,t.TTMSFNCGridRowInfo.$create("Create$1"));for(var u=1,C=i;u<=C;u++)s=u,this.FRowDisplayList.Insert(e,e+s-1);for(var T=1,S=i;T<=S;T++)s=T,this.FRowDisplayList.SetItem(e+s-1,e+s-1);for(var d=e+i,m=this.FRowDisplayList.GetCount()-1;d<=m;d++)s=d,this.FRowDisplayList.SetItem(s,this.FRowDisplayList.GetItem(s)+i);if(!this.FInternalRowUpdate&&(n=e<=this.FRowH.GetCount()-1?this.FRowH.Insert$1(e).GetIndex():this.FRowH.Add$1().GetIndex())>=0&&n<=this.FRowH.GetCount()-1){this.FRowH.GetItem$1(n).SetValue(this.FDefaultRowHeight),this.FRowH.GetItem$1(n).FCellVal=e;for(var f=n+1,g=this.FRowH.GetCount()-1;f<=g;f++)s=f,this.FRowH.GetItem$1(s).FCellVal=this.FRowH.GetItem$1(s).FCellVal+1}this.FRowCount=this.FRowCount+i,this.EndUpdate()}},this.SwapCells=function(t,e,i){var s,o;s=this.GetCells(t,e),o=this.GetIntObjects(t,e),this.SetCells(t,e,this.GetCells(t,i)),this.SetIntObjects(t,e,this.GetIntObjects(t,i)),this.SetCells(t,i,s),this.SetIntObjects(t,i,o)},this.SwapNormalCells=function(t,e){for(var i=0,s="",o=null,n=this.FFixedColumns,r=this.GetColumnCount()-this.FFixedRightColumns-1;n<=r;n++)i=n,s=this.GetCells(i,t),o=this.GetIntObjects(i,t),this.SetCells(i,t,this.GetCells(i,e)),this.SetIntObjects(i,t,this.GetIntObjects(i,e)),this.SetCells(i,e,s),this.SetIntObjects(i,e,o)},this.SwapRows=function(t,e){var i,s,o,n,r,a,l;n=this.DisplToRealRow(t),r=this.DisplToRealRow(e),i=this.FRowList.GetItem(n),this.FRowList.SetItem(n,this.FRowList.GetItem(r)),this.FRowList.SetItem(r,i),s=this.GetRowHeights(t),o=this.GetRowHeights(e),this.SetRowHeights(t,o),this.SetRowHeights(e,s),a=this.GetRowSelect(t),l=this.GetRowSelect(e),this.SetRowSelect(t,l),this.SetRowSelect(e,a),this.UpdateGridCells(!1)},this.MoveRow=function(e,i){var s=null,o=null,n=0;this.FRowList.Move(e,i),s=t.TTMSFNCGridSList.$create("Create$1");try{for(var r=0,a=this.GetRowCount()-1;r<=a;r++)n=r,s.Add(this.GetRowHeights(n));s.Move(e,i),this.FRowH.Clear();for(var l=0,h=this.GetRowCount()-1;l<=h;l++)n=l,(o=this.FRowH.Add$1()).FCellVal=n,o.SetValue(s.GetItem(n))}finally{s=rtl.freeLoc(s)}this.UpdateControl(!0,!0)},this.ColumnSum=function(t,e,i){var s=0,o=0;-1!==e&&-1!==i||(e=this.FFixedRows,i=this.GetRowCount()-1-this.FFixedFooterRows),o=0,this.ExportNotification(0,e);for(var n=e,r=i;n<=r;n++)if(s=n,this.IsBaseCell(t,s)){this.ExportNotification(5,s);try{o+=this.GetFloats(t,s)}catch(t){}}return this.ExportNotification(2,-1),o},this.ColumnAvg=function(t,e,i){return-1!==e&&-1!==i||(e=this.FFixedRows,i=this.GetRowCount()-1-this.FFixedFooterRows),i-e+1>0?this.ColumnSum(t,e,i)/(i-e+1):0},this.ColumnMin=function(t,e,i){var s=0,o=0;-1!==e&&-1!==i||(e=this.FFixedRows,i=this.GetRowCount()-1-this.FFixedFooterRows),s=this.GetFloats(t,e),this.ExportNotification(0,e);for(var n=e,r=i;n<=r;n++)if(o=n,this.IsBaseCell(t,o)){this.ExportNotification(5,o);try{s>this.GetFloats(t,o)&&(s=this.GetFloats(t,o))}catch(t){}}return this.ExportNotification(2,-1),s},this.ColumnMax=function(t,e,i){var s=0,o=0;-1!==e&&-1!==i||(e=this.FFixedRows,i=this.GetRowCount()-1-this.FFixedFooterRows),s=this.GetFloats(t,e),this.ExportNotification(0,e);for(var n=e,r=i;n<=r;n++)if(o=n,this.IsBaseCell(t,o)){this.ExportNotification(5,o);try{s<this.GetFloats(t,o)&&(s=this.GetFloats(t,o))}catch(t){}}return this.ExportNotification(2,-1),s},this.ColumnDistinct=function(t,e,i){var s=0,o=null,n=0;-1!==e&&-1!==i||(e=this.FFixedRows,i=this.GetRowCount()-1-this.FFixedFooterRows),this.ExportNotification(0,e),o=pas.Classes.TStringList.$create("Create$1");try{o.FDuplicates=0,o.SetSorted(!0),o.SetCaseSensitive(!1);for(var r=e,a=i;r<=a;r++)n=r,this.ExportNotification(5,n),o.Add(this.GetCells(t,n));s=o.GetCount()}finally{this.ExportNotification(2,-1),o=rtl.freeLoc(o)}return s},this.ColumnStdDev=function(t,e,i){var s,o,n=0,r=0;-1!==e&&-1!==i||(e=this.FFixedRows,i=this.GetRowCount()-1-this.FFixedFooterRows),o=this.ColumnAvg(t,e,i),this.ExportNotification(0,e),n=0;for(var a=e,l=i;a<=l;a++)r=a,n+=pas.System.Sqr$1(this.GetFloats(t,r)-o);return s=Math.sqrt(n/(i-e+1)),this.ExportNotification(2,-1),s},this.ColumnCustomCalc=function(t,e,i){return this.DoColumnCalc(t,e,i)},this.UpdateCalculations=function(){for(var t=0,e=0,i=0,s=this.GetColumnCount()-1;i<=s;i++)t=i,0!==(e=this.GetColumnCalculation(t))&&this.UpdateColumnCalc(t,e)},this.HideRows=function(t,e){var i=0,s=0,o=!1;for(s=0,i=0,o=!1;i<this.FRowDisplayList.GetCount();)if(this.FRowDisplayList.GetItem(i)===t+s){if(this.FHiddenRowList.Add(t+s),this.FRowDisplayList.Delete(i),this.FRowCount=this.FRowCount-1,o=!0,!(s<e-1))break;s+=1}else i+=1;o&&this.UpdateControl(!0,!0)},this.UnHideRows=function(t,e){var i=0,s=0,o=0,n=0,r=!1;if(0!==this.FHiddenRowList.GetCount()){if(i=0,o=0,0===this.FRowDisplayList.GetCount()||t>this.FRowDisplayList.GetItem(this.FRowDisplayList.GetCount()-1)){for(var a=0,l=Math.max(0,e-1);a<=l;a++)i=a,-1!==this.FHiddenRowList.IndexOf(i+t)&&(o+=1,this.FRowDisplayList.Add(i+t),this.FHiddenRowList.Delete(this.FHiddenRowList.IndexOf(i+t)));return this.FRowCount=this.FRowCount+o,void this.UpdateControl(!0,!0)}for(r=!1;i<this.FRowDisplayList.GetCount();){if(this.FRowDisplayList.GetItem(i)>=t){r=!0;break}i+=1}if(r&&(n=this.FHiddenRowList.IndexOf(t))>=0)for(this.FRowDisplayList.Insert(i,t),this.FHiddenRowList.Delete(n),this.FRowCount=this.FRowCount+1,s=1,i+=1;s<=e;)this.FRowDisplayList.GetItem(i)!==t+s&&(n=this.FHiddenRowList.IndexOf(t+s))>=0&&(this.FRowDisplayList.Insert(i,t+s),this.FHiddenRowList.Delete(n),this.FRowCount=this.FRowCount+1),i+=1,s+=1;r&&this.UpdateControl(!0,!0)}},this.UnHideRowsAll=function(){for(var t=0;this.FRowDisplayList.GetCount()<this.FRowList.GetCount();)this.FRowDisplayList.Add(0);for(var e=0,i=this.FRowList.GetCount()-1;e<=i;e++)t=e,this.FRowDisplayList.SetItem(t,t);this.FRowCount=this.FRowList.GetCount(),this.UpdateControl(!0,!0)},this.UnHideColumnsAll=function(){var t=0;for(this.BeginUpdate();this.FColumnDisplayList.GetCount()<this.GetTotalColCount();)this.FColumnDisplayList.Add(0);for(var e=0,i=this.GetTotalColCount()-1;e<=i;e++)t=e,this.FColumnDisplayList.SetItem(t,t);this.FColumnCount=this.GetTotalColCount(),this.FHiddenColumnList.Clear(),this.EndUpdate()},this.IsSuppressedColumn=function(t){var e=!1,i=0;e=!1;for(var s=0,o=this.FSuppressedColumnList.GetCount()-1;s<=o;s++)if(i=s,this.FSuppressedColumnList.GetItem(i)===t){e=!0;break}return e},this.InsertColumn=function(t){var e=0,i=null,s=0;this.BeginUpdate();for(var o=0,n=this.FRowList.GetCount()-1;o<=n;o++)e=o,null!=(i=this.FRowList.GetItem(e))&&t<i.FData.GetCount()&&i.FData.InsertObject(t,"",null);if(!this.FInternalColumnUpdate&&(s=t<=this.FColumnW.GetCount()-1?this.FColumnW.Insert$1(t).GetIndex():this.FColumnW.Add$1().GetIndex())>=0&&s<=this.FColumnW.GetCount()-1){this.FColumnW.GetItem$1(s).SetValue(this.FDefaultColumnWidth),this.FColumnW.GetItem$1(s).FCellVal=t;for(var r=s+1,a=this.FColumnW.GetCount()-1;r<=a;r++)e=r,this.FColumnW.GetItem$1(e).FCellVal=this.FColumnW.GetItem$1(e).FCellVal+1}this.EndUpdate(),this.FColumnDisplayList.Insert(t,t);for(var l=t+1,h=this.FColumnDisplayList.GetCount()-1;l<=h;l++)e=l,this.FColumnDisplayList.SetItem(e,this.FColumnDisplayList.GetItem(e)+1);this.SetColumnCount(this.GetColumnCount()+1)},this.MoveColumn=function(e,i){var s,o,n=0,r=null,a=null;0===this.FColumnOrder.GetCount()&&this.SetColumnOrder(),this.FColumnDisplayList.Move(e,i),a=t.TTMSFNCGridSList.$create("Create$1");try{for(var l=0,h=this.GetColumnCount()-1;l<=h;l++)n=l,a.Add(this.GetColWidths(n));a.Move(e,i),this.FColumnW.Clear();for(var F=0,p=this.GetColumnCount()-1;F<=p;F++)n=F,(r=this.FColumnW.Add$1()).FCellVal=n,r.SetValue(a.GetItem(n))}finally{a=rtl.freeLoc(a)}s=e,o=i,this.FColumnOrder.GetCount()>s&&this.FColumnOrder.GetCount()>o&&(n=this.FColumnOrder.GetInteger(s),this.FColumnOrder.Delete$1(s),this.FColumnOrder.Insert$1(o,n)),this.UpdateControl(!0,!0)},this.SortData=function(e,i){var s,o,n=!1,r=null;for(this.FBlockUpdate=!0,n=!1,this.FFilterApplied&&(this.RemoveFilter(),n=!0),this.FSortColumn=e,this.FSortDirection=i,s=this.FRowDisplayList.GetCount(),o=this.FRowList.GetCount(),this.FRowCount=this.FRowCount+1,this.QuickSortRows(this.FSortColumn,this.FFixedRows,this.FRowCount-2-this.FFixedFooterRows),this.ClearCells(t.TTMSFNCGridCellRecRange.$clone(this.CellRange(0,this.GetRowCount()-1,this.GetColumnCount()-1,this.GetRowCount()-1))),this.FRowCount=this.FRowCount-1;s<this.FRowDisplayList.GetCount();)this.FRowDisplayList.Delete(this.FRowDisplayList.GetCount()-1);for(;o<this.FRowList.GetCount();)r=this.FRowList.GetItem(this.FRowList.GetCount()-1),r=rtl.freeLoc(r),this.FRowList.Delete(this.FRowList.GetCount()-1);n&&this.ApplyFilter(),this.FBlockUpdate=!1,this.UpdateGridCells(!1)},this.SortIndexed=function(){var e=0,i=0,s=null,o=!1;if(0===this.FSortIndexes.GetCount())throw pas.SysUtils.Exception.$create("Create$1",["No indexes specified for indexed sort"]);o=!1,this.FFilterApplied&&(this.RemoveFilter(),o=!0),this.BeginUpdate();try{for(e=this.FRowDisplayList.GetCount(),i=this.FRowList.GetCount(),this.FRowCount=this.FRowCount+1,this.QuickSortRowsIndexed(0,this.FFixedRows,this.FRowCount-2-this.FFixedFooterRows),this.ClearCells(t.TTMSFNCGridCellRecRange.$clone(this.CellRange(0,this.GetRowCount()-1,this.GetColumnCount()-1,this.GetRowCount()-1))),this.FRowCount=this.FRowCount-1;e<this.FRowDisplayList.GetCount();)this.FRowDisplayList.Delete(this.FRowDisplayList.GetCount()-1);for(;i<this.FRowList.GetCount();)s=this.FRowList.GetItem(this.FRowList.GetCount()-1),s=rtl.freeLoc(s),this.FRowList.Delete(this.FRowList.GetCount()-1)}finally{o&&this.ApplyFilter(),this.EndUpdate()}this.UpdateGridCells(!1)},this.SortGrouped=function(t,e){this.FSortColumn=t,this.FSortDirection=e,this.SortGroupedInt(!1)},this.SortGroupedIndexed=function(){this.SortGroupedInt(!0)},this.CopyToClipboard=function(t){},this.CutToClipboard=function(t){},this.PasteFromClipboard=function(){},rtl.addIntf(this,pas["WEBLib.TMSFNCBitmapContainer"].ITMSFNCBitmapContainer),rtl.addIntf(this,pas["WEBLib.TMSFNCGraphicsTypes"].ITMSFNCAppearanceGlobalFont),rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas["WEBLib.TMSFNCTypes"].ITMSFNCProductInfo),rtl.addIntf(this,pas.System.IUnknown);var i=this.$rtti;i.addProperty("BitmapContainer",3,pas["WEBLib.TMSFNCBitmapContainer"].$rtti.TTMSFNCBitmapContainer,"GetBitmapContainer","SetBitmapContainer"),i.addProperty("DefaultRowHeight",14,rtl.double,"FDefaultRowHeight","SetDefaultRowHeight",{stored:"IsDefaultRowHeightStored"}),i.addProperty("DefaultColumnWidth",14,rtl.double,"FDefaultColumnWidth","SetDefaultColumnWidth",{stored:"IsDefaultColumnWidthStored"}),i.addProperty("FixedColumns",2,rtl.longint,"FFixedColumns","SetFixedColumns",{Default:1}),i.addProperty("FixedRows",2,rtl.longint,"FFixedRows","SetFixedRows",{Default:1}),i.addProperty("FixedRightColumns",2,rtl.longint,"FFixedRightColumns","SetFixedRightColumns",{Default:0}),i.addProperty("FixedFooterRows",2,rtl.longint,"FFixedFooterRows","SetFixedFooterRows",{Default:0}),i.addProperty("ColumnCount",3,rtl.longint,"GetColumnCount","SetColumnCount",{Default:5}),i.addProperty("RowCount",3,rtl.longint,"GetRowCount","SetRowCount",{Default:10}),i.addProperty("OnColumnCalc",0,t.$rtti.TTMSFNCGridColumnCalcEvent,"FOnColumnCalc","FOnColumnCalc"),i.addProperty("OnGroupCalc",0,t.$rtti.TTMSFNCGridColumnCalcEvent,"FOnGroupCalc","FOnGroupCalc"),i.addProperty("OnCustomCompare",0,t.$rtti.TTMSFNCGridCustomCompareEvent,"FOnCustomCompare","FOnCustomCompare"),i.addProperty("OnIOProgress",0,t.$rtti.TTMSFNCGridIOProgressEvent,"FOnIOProgress","FOnIOProgress"),i.addProperty("OnRawCompare",0,t.$rtti.TTMSFNCGridRawCompareEvent,"FOnRawCompare","FOnRawCompare"),i.addProperty("OnSortFormat",0,t.$rtti.TTMSFNCGridSortFormatEvent,"FOnSortFormat","FOnSortFormat"),i.addProperty("OnCellsChanged",0,t.$rtti.TTMSFNCGridCellsChangedEvent,"FOnCellsChanged","FOnCellsChanged"),i.addProperty("OnClipboardBeforePasteCell",0,t.$rtti.TTMSFNCGridClipboardBeforePasteEvent,"FOnClipboardBeforePasteCell","FOnClipboardBeforePasteCell"),i.addProperty("OnClipboardAfterPasteCell",0,t.$rtti.TTMSFNCGridClipboardAfterPasteEvent,"FOnClipboardAfterPasteCell","FOnClipboardAfterPasteCell"),i.addProperty("OnClipboardPaste",0,t.$rtti.TTMSFNCGridCellsChangedEvent,"FOnClipboardPaste","FOnClipboardPaste"),i.addProperty("OnNeedFilterDropDown",0,t.$rtti.TTMSFNCGridNeedFilterDropDownEvent,"FOnNeedFilterDropDown","FOnNeedFilterDropDown"),i.addProperty("OnNeedFilterDropDownData",0,t.$rtti.TTMSFNCGridNeedFilterDropDownDataEvent,"FOnNeedFilterDropDownData","FOnNeedFilterDropDownData"),i.addProperty("OnFilterSelect",0,t.$rtti.TTMSFNCGridFilterSelectEvent,"FOnFilterSelect","FOnFilterSelect"),i.addProperty("OnAfterApplyFilter",0,t.$rtti.TTMSFNCGridAfterApplyFilterEvent,"FOnAfterApplyFilter","FOnAfterApplyFilter"),i.addProperty("OnLoadCell",0,t.$rtti.TTMSFNCGridIOEvent,"FOnLoadCell","FOnLoadCell"),i.addProperty("OnSaveCell",0,t.$rtti.TTMSFNCGridIOEvent,"FOnSaveCell","FOnSaveCell"),i.addProperty("Options",2,pas["WEBLib.TMSFNCGridOptions"].$rtti.TTMSFNCGridOptions,"FOptions","SetOptions"),i.addProperty("OnSelectCell",0,t.$rtti.TTMSFNCGridOnSelectCell,"FOnSelectCell","FOnSelectCell"),i.addProperty("OnSelectedCell",0,t.$rtti.TTMSFNCGridOnSelectedCell,"FOnSelectedCell","FOnSelectedCell")})),this.InCellRange=function(t,e,i){return t>=i.StartCol&&t<=i.EndCol&&e>=i.StartRow&&e<=i.EndRow},this.MakeCell=function(e,i){var s=t.TTMSFNCGridCellRec.$new();return s.Col=e,s.Row=i,s},t.$implcode=function(){e.CleanupSep=function(t){var e=0,i="";i="";for(var s=1,o=t.length;s<=o;s++)e=s,t.charAt(e-1)!==pas.SysUtils.FormatSettings.ThousandSeparator&&(t.charAt(e-1)===pas.SysUtils.FormatSettings.DecimalSeparator?i+=".":i+=t.charAt(e-1));return i}}}),["RTLConsts","Math","WEBLib.TMSFNCUtils"]),rtl.module("WEBLib.TMSFNCToolBarPopup",["System","Classes","WEBLib.TMSFNCPopup","WEBLib.TMSFNCToolBar","WEBLib.TMSFNCTypes"],(function(){"use strict";var t=this,e=t.$impl;this.MAJ_VER=1,this.MIN_VER=0,this.REL_VER=0,this.BLD_VER=0,rtl.createClass(this,"TTMSFNCToolBarPopupButton",pas.Classes.TCollectionItem,(function(){this.$init=function(){pas.Classes.TCollectionItem.$init.call(this),this.FOwner=null,this.FButton=null,this.FText="",this.FTag=0,this.FWidth=0,this.FHeight=0,this.FEnabled=!1,this.FVisible=!1,this.FTop=0,this.FLeft=0,this.FLastElement=!1,this.FBitmap=null},this.$final=function(){this.FOwner=void 0,this.FButton=void 0,this.FBitmap=void 0,pas.Classes.TCollectionItem.$final.call(this)},this.SetText=function(t){this.FText!==t&&(this.FText=t,null!=this.FButton&&this.FButton.SetText(this.FText),null!=this.FOwner&&this.FOwner.UpdateToolBar())},this.SetHeight=function(t){this.FHeight!==t&&(this.FHeight=t,null!=this.FButton&&this.FHeight>-1&&this.FButton.SetHeight(Math.round(this.FHeight)),null!=this.FOwner&&this.FOwner.UpdateToolBar())},this.SetWidth=function(t){this.FWidth!==t&&(this.FWidth=t,null!=this.FButton&&this.FWidth>-1&&this.FButton.SetWidth(Math.round(this.FWidth)),null!=this.FOwner&&this.FOwner.UpdateToolBar())},this.IsHeightStored=function(){return-1!==this.FHeight},this.IsWidthStored=function(){return-1!==this.FWidth},this.SetEnabled=function(t){this.FEnabled!==t&&(this.FEnabled=t,null!=this.FButton&&this.FButton.SetEnabled(this.FEnabled),null!=this.FOwner&&this.FOwner.UpdateToolBar())},this.SetVisible=function(t){this.FVisible!==t&&(this.FVisible=t,null!=this.FButton&&this.FButton.SetVisible(this.FVisible),null!=this.FOwner&&this.FOwner.UpdateToolBar())},this.IsLeftStored=function(){return-1!==this.FLeft},this.IsTopStored=function(){return-1!==this.FTop},this.SetLeft=function(t){this.FLeft!==t&&(this.FLeft=t,null!=this.FButton&&this.FLeft>-1&&this.FButton.SetLeft(Math.round(this.FLeft)),null!=this.FOwner&&this.FOwner.UpdateToolBar())},this.SetTop=function(t){this.FTop!==t&&(this.FTop=t,null!=this.FButton&&this.FTop>-1&&this.FButton.SetTop(Math.round(this.FTop)),null!=this.FOwner&&this.FOwner.UpdateToolBar())},this.SetLastElement=function(t){this.FLastElement!==t&&(this.FLastElement=t,null!=this.FButton&&this.FButton.SetLastElement(this.FLastElement),null!=this.FOwner&&this.FOwner.UpdateToolBar())},this.SetBitmap=function(t){this.FBitmap!==t&&(this.FBitmap.Assign(t),null==this.FButton||pas["WEBLib.TMSFNCTypes"].IsBitmapEmpty(this.FBitmap)||(this.FButton.FBitmaps.Clear(),this.FButton.FBitmaps.AddBitmap(this.FBitmap,1)),null!=this.FOwner&&this.FOwner.UpdateToolBar())},this.BitmapChanged=function(t){null==this.FButton||pas["WEBLib.TMSFNCTypes"].IsBitmapEmpty(this.FBitmap)||(this.FButton.FBitmaps.Clear(),this.FButton.FBitmaps.AddBitmap(this.FBitmap,1)),null!=this.FOwner&&this.FOwner.UpdateToolBar()},this.Create$1=function(e){return pas.Classes.TCollectionItem.Create$1.apply(this,arguments),null!=this.FCollection&&(this.FOwner=rtl.as(this.FCollection,t.TTMSFNCToolBarPopupButtons).FOwner$1),this.FBitmap=pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.$create("Create$3"),this.FBitmap.FOnChange=rtl.createCallback(this,"BitmapChanged"),this.FWidth=-1,this.FHeight=-1,this.FTop=-1,this.FLeft=-1,this.FVisible=!0,this.FEnabled=!0,this.FLastElement=!1,null!=this.FOwner&&null!=this.FOwner.FToolBar&&(this.FButton=pas["WEBLib.TMSFNCToolBar"].TTMSFNCToolBarButton.$create("Create$1",[this.FOwner.FToolBar]),this.FButton.SetTabStop(!1),this.FButton.SetAllowFocus(!1),this.FButton.SetParent(this.FOwner.FToolBar),this.FButton.FOnClick=rtl.createCallback(this.FOwner,"ToolBarButtonClick")),null!=this.FOwner&&(null!=this.FOwner.FToolBar&&this.FOwner.FToolBar.AddCustomControl(this.FButton,this.GetIndex()),this.FOwner.UpdateToolBar()),this},this.Assign=function(e){t.TTMSFNCToolBarPopupButton.isPrototypeOf(e)&&(this.FText=rtl.as(e,t.TTMSFNCToolBarPopupButton).FText,this.FWidth=rtl.as(e,t.TTMSFNCToolBarPopupButton).FWidth,this.FHeight=rtl.as(e,t.TTMSFNCToolBarPopupButton).FHeight,this.FLeft=rtl.as(e,t.TTMSFNCToolBarPopupButton).FLeft,this.FTop=rtl.as(e,t.TTMSFNCToolBarPopupButton).FTop,this.FEnabled=rtl.as(e,t.TTMSFNCToolBarPopupButton).FEnabled,this.FVisible=rtl.as(e,t.TTMSFNCToolBarPopupButton).FVisible,this.FBitmap.Assign(rtl.as(e,t.TTMSFNCToolBarPopupButton).FBitmap),this.FLastElement=rtl.as(e,t.TTMSFNCToolBarPopupButton).FLastElement)},this.Destroy=function(){rtl.free(this,"FBitmap"),pas.Classes.TCollectionItem.Destroy.call(this),null!=this.FOwner&&this.FOwner.UpdateToolBar()};var e=this.$rtti;e.addProperty("Text",2,rtl.string,"FText","SetText"),e.addProperty("Tag",0,rtl.longint,"FTag","FTag"),e.addProperty("Left",14,rtl.double,"FLeft","SetLeft",{stored:"IsLeftStored"}),e.addProperty("Top",14,rtl.double,"FTop","SetTop",{stored:"IsTopStored"}),e.addProperty("Width",14,rtl.double,"FWidth","SetWidth",{stored:"IsWidthStored"}),e.addProperty("Height",14,rtl.double,"FHeight","SetHeight",{stored:"IsHeightStored"}),e.addProperty("Enabled",2,rtl.boolean,"FEnabled","SetEnabled",{Default:!0}),e.addProperty("Visible",2,rtl.boolean,"FVisible","SetVisible",{Default:!0}),e.addProperty("LastElement",2,rtl.boolean,"FLastElement","SetLastElement",{Default:!1}),e.addProperty("Bitmap",2,pas["WEBLib.TMSFNCTypes"].$rtti.TTMSFNCBitmap,"FBitmap","SetBitmap")})),rtl.createClass(this,"TTMSFNCToolBarPopupButtons",pas["WEBLib.TMSFNCTypes"].TTMSFNCOwnedCollection,(function(){this.$init=function(){pas["WEBLib.TMSFNCTypes"].TTMSFNCOwnedCollection.$init.call(this),this.FOwner$1=null},this.$final=function(){this.FOwner$1=void 0,pas["WEBLib.TMSFNCTypes"].TTMSFNCOwnedCollection.$final.call(this)},this.GetItem$1=function(t){return this.GetItem(t)},this.CreateItemClass=function(){return t.TTMSFNCToolBarPopupButton},this.GetOwner=function(){return this.FOwner$1},this.Create$3=function(t){return pas.Classes.TOwnedCollection.Create$2.call(this,t,this.CreateItemClass()),this.FOwner$1=t,this}})),rtl.createClass(this,"TTMSFNCCustomToolBarPopup",pas["WEBLib.TMSFNCPopup"].TTMSFNCCustomNonFocusablePopup,(function(){this.$init=function(){pas["WEBLib.TMSFNCPopup"].TTMSFNCCustomNonFocusablePopup.$init.call(this),this.FActivate=!1,this.FToolBar=null,this.FButtons=null,this.FButtonClick=null,this.FOnDeactivate=null,this.FOnActivate=null},this.$final=function(){this.FToolBar=void 0,this.FButtons=void 0,this.FButtonClick=void 0,this.FOnDeactivate=void 0,this.FOnActivate=void 0,pas["WEBLib.TMSFNCPopup"].TTMSFNCCustomNonFocusablePopup.$final.call(this)},this.GetAutoAlign=function(){return this.FToolBar.FAutoAlign},this.SetAutoAlign=function(t){this.FToolBar.SetAutoAlign(t)},this.GetDragGrip=function(){return this.FToolBar.FAppearance.FDragGrip},this.SetDragGrip=function(t){this.FToolBar.FAppearance.SetDragGrip(t)},this.GetVersion=function(){return this.$class.GetVersionNumber(1,0,0,0)},this.CreateToolBar=function(){return pas["WEBLib.TMSFNCToolBar"].TTMSFNCToolBar.$create("Create$1",[this])},this.FindPopupButton=function(t){var e=null,i=0;e=null;for(var s=0,o=this.FButtons.GetCount()-1;s<=o;s++)if(i=s,t===this.FButtons.GetItem$1(i).FButton){e=this.FButtons.GetItem$1(i);break}return e},this.SetAdaptToStyle=function(t){pas["WEBLib.TMSFNCPopup"].TTMSFNCCustomPopup.SetAdaptToStyle.apply(this,arguments),null!=this.FToolBar&&this.FToolBar.SetAdaptToStyle(this.FAdaptToStyle)},this.UpdateControls=function(t){this.UpdateToolBar()},this.UpdateToolBar=function(){0 in this.FComponentState||3 in this.FComponentState||(this.SetDropDownWidth(this.FToolBar.GetWidth()),this.SetDropDownHeight(this.FToolBar.GetHeight()))},this.PrepareToolBar=function(){null!=this.FToolBar&&this.FToolBar.SetAdaptToStyle(this.FAdaptToStyle)},this.ActivatePopup=function(){this.DoCreatePopup(!1)},this.DeactivatePopup=function(){this.ClosePopup()},this.DoClosePopup=function(){pas["WEBLib.TMSFNCPopup"].TTMSFNCCustomPopup.DoClosePopup.call(this),null!=this.FPopupForm&&this.FPopupForm.DisposeOf()},this.ToolBarClick=function(t){this.ActivatePreviousWindow()},this.ToolBarButtonClick=function(t){null!=this.FButtonClick&&this.FButtonClick(this,this.FindPopupButton(rtl.as(t,pas["WEBLib.TMSFNCToolBar"].TTMSFNCToolBarButton))),this.ActivatePreviousWindow()},this.DoDragGripMoving=function(t,e,i){null!=this.FPopupForm&&(this.FPopupForm.SetLeft(this.FPopupForm.GetLeft()-Math.round(e)),this.FPopupForm.SetTop(this.FPopupForm.GetTop()-Math.round(i)))},this.Create$1=function(e){return pas["WEBLib.TMSFNCPopup"].TTMSFNCCustomNonFocusablePopup.Create$1.apply(this,arguments),this.SetPlacement(10),this.FButtons=t.TTMSFNCToolBarPopupButtons.$create("Create$3",[this]),this.FToolBar=this.CreateToolBar(),4 in this.FComponentState||this.FToolBar.SetParent(this),this.FToolBar.SetAutoAlign(!0),this.FToolBar.FOnClick=rtl.createCallback(this,"ToolBarClick"),this.FToolBar.SetTabStop(!1),this.FToolBar.SetAllowFocus(!1),this.FToolBar.FOptionsMenu.SetShowButton(!1),this.FToolBar.FAppearance.SetDragGrip(!1),this.FToolBar.FOnDragGripMoving=rtl.createCallback(this,"DoDragGripMoving"),this.FToolBar.FAutoMoveToolBar=!1,this.FToolBar.FOnUpdateControls=rtl.createCallback(this,"UpdateControls"),this.SetContentControl(this.FToolBar),this},this.Assign=function(e){pas["WEBLib.TMSFNCPopup"].TTMSFNCCustomPopup.Assign.apply(this,arguments),t.TTMSFNCCustomToolBarPopup.isPrototypeOf(e)&&(this.FButtons.Assign(rtl.as(e,t.TTMSFNCCustomToolBarPopup).FButtons),this.SetAutoAlign(rtl.as(e,t.TTMSFNCCustomToolBarPopup).GetAutoAlign()),this.SetDragGrip(rtl.as(e,t.TTMSFNCCustomToolBarPopup).GetDragGrip()))},this.Destroy=function(){rtl.free(this,"FButtons"),pas["WEBLib.TMSFNCPopup"].TTMSFNCCustomNonFocusablePopup.Destroy.call(this)},this.Activate=function(){this.Activated()&&this.Deactivate(),null!=this.FToolBar&&(this.FToolBar.SetParent(null),this.FToolBar.SetVisible(!1)),this.PrepareToolBar(),this.ActivatePopup(),this.UpdateToolBar(),this.FActivate=!0,null!=this.FOnActivate&&this.FOnActivate(this)},this.Deactivate=function(){this.DeactivatePopup(),this.FActivate=!1,null!=this.FOnDeactivate&&this.FOnDeactivate(this)},this.DropDownActive=function(){var t=!1;return t=!1,null!=this.FToolBar&&(t=this.FToolBar.DropDownActive()),t},this.Activated=function(){return this.HasPopupForm()},rtl.addIntf(this,pas["WEBLib.TMSFNCTypes"].ITMSFNCProductInfo),rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas.System.IUnknown)})),t.$implcode=function(){rtl.createClass(e,"TTMSFNCToolBarOpen",pas["WEBLib.TMSFNCToolBar"].TTMSFNCToolBar,(function(){rtl.addIntf(this,pas["WEBLib.TMSFNCBitmapContainer"].ITMSFNCBitmapContainer),rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas["WEBLib.TMSFNCTypes"].ITMSFNCProductInfo),rtl.addIntf(this,pas.System.IUnknown)}))}}),["WEBLib.Forms","WEBLib.TMSFNCUtils","Types"]),rtl.module("WEBLib.TMSFNCCustomGrid",["System","Classes","WEBLib.TMSFNCEdit","WEBLib.TMSFNCPersistence","WEBLib.TMSFNCCustomComponent","WEBLib.StdCtrls","WEBLib.TMSFNCColorPicker","WEBLib.TMSFNCImage","WEBLib.TMSFNCGridData","WEBLib.TMSFNCGridCell","WEBLib.TMSFNCPopup","WEBLib.TMSFNCGraphics","WEBLib.TMSFNCToolBarPopup","Types","WEBLib.TMSFNCTypes","WEBLib.Controls","WEBLib.TMSFNCGridOptions","WEBLib.TMSFNCGridDataUtil","WEBLib.TMSFNCGraphicsTypes","WEBLib.ExtCtrls"],(function(){"use strict";var t=this,e=t.$impl;this.TTMSFNCGridDocURL=pas["WEBLib.TMSFNCTypes"].TTMSFNCBaseDocURL+"tmsfncuipack/components/ttmsfncgrid/",this.TTMSFNCGridCustomToolBarPopupMode={0:"tpmActiveCell",tpmActiveCell:0,1:"tpmHoverCell",tpmHoverCell:1,2:"tpmHoverNormalCell",tpmHoverNormalCell:2,3:"tpmNone",tpmNone:3},this.$rtti.$Enum("TTMSFNCGridCustomToolBarPopupMode",{minvalue:0,maxvalue:3,ordtype:1,enumtype:this.TTMSFNCGridCustomToolBarPopupMode}),rtl.createClass(this,"TTMSFNCGridCustomToolBarPopup",pas["WEBLib.TMSFNCToolBarPopup"].TTMSFNCCustomToolBarPopup,(function(){this.$init=function(){pas["WEBLib.TMSFNCToolBarPopup"].TTMSFNCCustomToolBarPopup.$init.call(this),this.FGrid=null,this.FGridCell=pas["WEBLib.TMSFNCGridData"].TTMSFNCGridCellRec.$new()},this.$final=function(){this.FGrid=void 0,this.FGridCell=void 0,pas["WEBLib.TMSFNCToolBarPopup"].TTMSFNCCustomToolBarPopup.$final.call(this)},this.Notification=function(t,e){pas["WEBLib.TMSFNCPopup"].TTMSFNCCustomPopup.Notification.apply(this,arguments),1===e&&t===this.FGrid&&(this.FGrid=null)},this.Create$1=function(e){var i=0;if(pas["WEBLib.TMSFNCToolBarPopup"].TTMSFNCCustomToolBarPopup.Create$1.apply(this,arguments),this.IsDesignTime()&&null!=e&&pas["WEBLib.Forms"].TCustomForm.isPrototypeOf(e))for(var s=0,o=e.GetComponentCount()-1;s<=o;s++)if(i=s,t.TTMSFNCCustomGrid.isPrototypeOf(e.GetComponent(i))){this.FGrid=rtl.as(e.GetComponent(i),t.TTMSFNCCustomGrid),this.FGrid.FToolBarPopup=this;break}return this},rtl.addIntf(this,pas["WEBLib.TMSFNCTypes"].ITMSFNCProductInfo),rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TTMSFNCGridColorPicker",pas["WEBLib.TMSFNCColorPicker"].TTMSFNCColorPicker,(function(){rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas["WEBLib.TMSFNCTypes"].ITMSFNCProductInfo),rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TTMSFNCGridEdit",pas["WEBLib.TMSFNCEdit"].TTMSFNCEdit,(function(){this.Create$1=function(t){return pas["WEBLib.TMSFNCEdit"].TTMSFNCEdit.Create$1.apply(this,arguments),this.FAutoClose=!1,this},rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TTMSFNCGridComboBox",pas["WEBLib.StdCtrls"].TComboBox,(function(){rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TTMSFNCGridTrackBar",pas["WEBLib.ExtCtrls"].TTrackBar,(function(){rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TTMSFNCGridMemo",pas["WEBLib.StdCtrls"].TMemo,(function(){rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TTMSFNCGridDatePicker",pas["WEBLib.StdCtrls"].TDateTimePicker,(function(){rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TTMSFNCGridSpinBox",pas["WEBLib.StdCtrls"].TSpinEdit,(function(){rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TTMSFNCGridProtectedControl",pas["WEBLib.Controls"].TWinControl,(function(){rtl.addIntf(this,pas.System.IUnknown)})),this.$rtti.$MethodVar("TTMSFNCGridOnGetCellClass",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ACol",rtl.longint],["ARow",rtl.longint],["CellClassType",pas["WEBLib.TMSFNCGridCell"].$rtti.TTMSFNCGridCellClass,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCGridTopLeftChanged",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ATopRow",rtl.longint],["ALeftCol",rtl.longint]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCGridOnGetCellData",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ACol",rtl.longint],["ARow",rtl.longint],["CellString",rtl.string,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCGridOnGetCellProperties",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ACol",rtl.longint],["ARow",rtl.longint],["Cell",pas["WEBLib.TMSFNCGridCell"].$rtti.TTMSFNCGridCell]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCGridOnGetCellMergeInfo",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ACol",rtl.longint],["ARow",rtl.longint],["ABaseCol",rtl.longint,1],["ABaseRow",rtl.longint,1],["AColSpan",rtl.longint,1],["ARowSpan",rtl.longint,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCGridOnGetCellEditorCustomClassType",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ACol",rtl.longint],["ARow",rtl.longint],["CellEditorCustomClassType",pas["WEBLib.TMSFNCGridData"].$rtti.TTMSFNCGridEditorClass,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCGridOnGetCellEditorType",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ACol",rtl.longint],["ARow",rtl.longint],["CellEditorType",pas["WEBLib.TMSFNCGridData"].$rtti.TTMSFNCGridEditorType,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCGridOnCellEditGetData",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ACol",rtl.longint],["ARow",rtl.longint],["CellEditor",pas["WEBLib.Controls"].$rtti.TWinControl],["CellString",rtl.string,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCGridOnGetCellEditorProperties",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ACol",rtl.longint],["ARow",rtl.longint],["CellEditor",pas["WEBLib.Controls"].$rtti.TWinControl]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCGridOnCellEditValidateData",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ACol",rtl.longint],["ARow",rtl.longint],["CellEditor",pas["WEBLib.Controls"].$rtti.TWinControl],["CellString",rtl.string,1],["Allow",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCGridOnCellEditSetData",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ACol",rtl.longint],["ARow",rtl.longint],["CellEditor",pas["WEBLib.Controls"].$rtti.TWinControl],["CellString",rtl.string,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCGridOnCellComboCloseUp",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ACol",rtl.longint],["ARow",rtl.longint],["ItemIndex",rtl.longint],["AValue",rtl.string]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCGridOnCellEditGetColor",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ACol",rtl.longint],["ARow",rtl.longint],["CellEditor",pas["WEBLib.Controls"].$rtti.TWinControl],["CellColor",pas["WEBLib.Graphics"].$rtti.TColor,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCGridOnCellEditValidateColor",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ACol",rtl.longint],["ARow",rtl.longint],["CellEditor",pas["WEBLib.Controls"].$rtti.TWinControl],["CellColor",pas["WEBLib.Graphics"].$rtti.TColor,1],["Allow",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCGridOnCellEditSetColor",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ACol",rtl.longint],["ARow",rtl.longint],["CellEditor",pas["WEBLib.Controls"].$rtti.TWinControl],["CellColor",pas["WEBLib.Graphics"].$rtti.TColor,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCGridOnCellEditDone",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ACol",rtl.longint],["ARow",rtl.longint],["CellEditor",pas["WEBLib.Controls"].$rtti.TWinControl]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCGridOnCellEditCancel",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ACol",rtl.longint],["ARow",rtl.longint]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCGridOnCanSizeColumn",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ACol",rtl.longint],["Allow",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCGridOnCanSizeRow",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ARow",rtl.longint],["Allow",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCGridOnColumnSize",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ACol",rtl.longint],["NewWidth",rtl.double,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCGridOnRowSize",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ARow",rtl.longint],["NewHeight",rtl.double,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCGridOnColumnSized",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ACol",rtl.longint],["NewWidth",rtl.double]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCGridOnRowSized",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ARow",rtl.longint],["NewHeight",rtl.double]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCGridOnColumnDragged",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["FromCol",rtl.longint],["ToCol",rtl.longint]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCGridOnRowDragged",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["FromRow",rtl.longint],["ToRow",rtl.longint]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCGridOnBeforeRowDrop",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["FromRow",rtl.longint],["ToRow",rtl.longint,1],["Allow",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCGridOnBeforeColumnDrop",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["FromColumn",rtl.longint],["ToColumn",rtl.longint,1],["Allow",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCGridOnCanSortColumn",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ACol",rtl.longint],["Allow",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCGridOnColumnSorted",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ACol",rtl.longint],["Direction",pas["WEBLib.TMSFNCGridData"].$rtti.TTMSFNCGridSortDirection]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCGridOnCellAnchorClick",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ACol",rtl.longint],["ARow",rtl.longint],["AAnchor",rtl.string]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCGridOnGetCellReadOnly",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ACol",rtl.longint],["ARow",rtl.longint],["AReadOnly",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCGridOnGetCellLayout",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ACol",rtl.longint],["ARow",rtl.longint],["ALayout",pas["WEBLib.TMSFNCGridCell"].$rtti.TTMSFNCGridCellLayout],["ACellState",pas["WEBLib.TMSFNCGridData"].$rtti.TTMSFNCGridCellState]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCGridOnCellClick",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ACol",rtl.longint],["ARow",rtl.longint]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCGridOnGetCellIsFixed",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ACol",rtl.longint],["ARow",rtl.longint],["ACellFixed",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCGridOnGetCellRotation",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ACol",rtl.longint],["ARow",rtl.longint],["Angle",rtl.longint,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCGridOnGetRowIsBand",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ARow",rtl.longint],["ARowBand",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCGridOnCanInsertRow",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ARow",rtl.longint],["Allow",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCGridOnCanDeleteRow",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ARow",rtl.longint],["Allow",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCGridOnCanAppendColumn",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ACol",rtl.longint],["Allow",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCGridOnCanAppendRow",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ARow",rtl.longint],["Allow",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCGridOnInsertRow",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ARow",rtl.longint]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCGridOnDeleteRow",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ARow",rtl.longint]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCGridOnAppendColumn",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ACol",rtl.longint]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCGridOnAppendRow",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ARow",rtl.longint]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCGridCellControlEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ACol",rtl.longint],["ARow",rtl.longint],["ACell",pas["WEBLib.TMSFNCGridCell"].$rtti.TTMSFNCGridCell]]),methodkind:0}),this.TTMSFNCGridSizeMode={0:"smColumnSizing",smColumnSizing:0,1:"smRowSizing",smRowSizing:1,2:"smPreviousColumnSizing",smPreviousColumnSizing:2,3:"smPreviousRowSizing",smPreviousRowSizing:3},this.TTMSFNCGridDraggingMode={0:"dmNone",dmNone:0,1:"dmRowDragging",dmRowDragging:1,2:"dmColumnDragging",dmColumnDragging:2},this.$rtti.$MethodVar("TTMSFNCGridCellBeforeDraw",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ACol",rtl.longint],["ARow",rtl.longint],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF,1],["ATextRect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF,1],["ADrawText",rtl.boolean,1],["ADrawBackGround",rtl.boolean,1],["ADrawBorder",rtl.boolean,1],["AllowDraw",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCGridCellEditBeforeExit",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ACol",rtl.longint],["ARow",rtl.longint],["CellEditor",pas["WEBLib.Controls"].$rtti.TWinControl],["AllowExit",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCGridCellAfterDraw",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ACol",rtl.longint],["ARow",rtl.longint],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["ATextRect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF]]),methodkind:0}),this.TTMSFNCGridEditCellStart={0:"csNone",csNone:0,1:"csStart",csStart:1,2:"csEnd",csEnd:2},this.TTMSFNCGridTabKeyMode={0:"tkmNone",tkmNone:0,1:"tkmNormal",tkmNormal:1,2:"tkmShift",tkmShift:2},rtl.createClass(this,"TTMSFNCGridAppearance",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FBandLayout=null,this.FFocusedLayout=null,this.FFixedSelectedLayout=null,this.FNormalLayout=null,this.FSummaryLayout=null,this.FOnChange=null,this.FSelectedLayout=null,this.FFixedLayout=null,this.FGroupLayout=null,this.FProgressLayout=null,this.FShowFocus=!1},this.$final=function(){this.FBandLayout=void 0,this.FFocusedLayout=void 0,this.FFixedSelectedLayout=void 0,this.FNormalLayout=void 0,this.FSummaryLayout=void 0,this.FOnChange=void 0,this.FSelectedLayout=void 0,this.FFixedLayout=void 0,this.FGroupLayout=void 0,this.FProgressLayout=void 0,pas.Classes.TPersistent.$final.call(this)},this.SetBandLayout=function(t){this.FBandLayout.Assign(t)},this.SetFixedLayout=function(t){this.FFixedLayout.Assign(t)},this.SetFixedSelectedLayout=function(t){this.FFixedSelectedLayout.Assign(t)},this.SetFocusedLayout=function(t){this.FFocusedLayout.Assign(t)},this.SetGroupLayout=function(t){this.FGroupLayout.Assign(t)},this.SetNormalLayout=function(t){this.FNormalLayout.Assign(t)},this.SetSelectedLayout=function(t){this.FSelectedLayout.Assign(t)},this.SetSummaryLayout=function(t){this.FSummaryLayout.Assign(t)},this.SetProgressLayout=function(t){this.FProgressLayout.Assign(t)},this.SetShowFocus=function(t){this.FShowFocus!==t&&(this.FShowFocus=t,this.LayoutChanged(this))},this.LayoutChanged=function(t){null!=this.FOnChange&&this.FOnChange(this)},this.InitializeDefaultLayout=function(){this.FNormalLayout.FFill.SetColor(-1),this.FFixedLayout.FFill.SetKind(1),this.FFixedLayout.FFill.SetColor(pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(230,230,230)),this.FFixedLayout.FFont.SetStyle(rtl.createSet(0)),this.FFixedSelectedLayout.FFill.SetKind(1),this.FFixedSelectedLayout.FFill.SetColor(14599344),this.FFocusedLayout.FFill.SetColor(14599344),this.FFocusedLayout.FFont.SetColor(16777215),this.FSelectedLayout.FFill.SetColor(14599344),this.FSelectedLayout.FFont.SetColor(16777215),this.FBandLayout.FFill.SetColor(14745599),this.FGroupLayout.FFill.SetColor(pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(110,147,195)),this.FGroupLayout.FFont.SetColor(16777215),this.FSummaryLayout.FFill.SetColor(pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(185,197,213))},this.Create$1=function(){return this.FBandLayout=pas["WEBLib.TMSFNCGridCell"].TTMSFNCGridCellLayout.$create("Create$1"),this.FFixedLayout=pas["WEBLib.TMSFNCGridCell"].TTMSFNCGridCellLayout.$create("Create$1"),this.FNormalLayout=pas["WEBLib.TMSFNCGridCell"].TTMSFNCGridCellLayout.$create("Create$1"),this.FGroupLayout=pas["WEBLib.TMSFNCGridCell"].TTMSFNCGridCellLayout.$create("Create$1"),this.FSummaryLayout=pas["WEBLib.TMSFNCGridCell"].TTMSFNCGridCellLayout.$create("Create$1"),this.FSelectedLayout=pas["WEBLib.TMSFNCGridCell"].TTMSFNCGridCellLayout.$create("Create$1"),this.FFocusedLayout=pas["WEBLib.TMSFNCGridCell"].TTMSFNCGridCellLayout.$create("Create$1"),this.FFixedSelectedLayout=pas["WEBLib.TMSFNCGridCell"].TTMSFNCGridCellLayout.$create("Create$1"),this.FProgressLayout=pas["WEBLib.TMSFNCGridCell"].TTMSFNCGridCellProgressLayout.$create("Create$1"),this.FShowFocus=!0,this.InitializeDefaultLayout(),this.FProgressLayout.FOnChange=rtl.createCallback(this,"LayoutChanged"),this.FBandLayout.FOnChange=rtl.createCallback(this,"LayoutChanged"),this.FFixedLayout.FOnChange=rtl.createCallback(this,"LayoutChanged"),this.FNormalLayout.FOnChange=rtl.createCallback(this,"LayoutChanged"),this.FGroupLayout.FOnChange=rtl.createCallback(this,"LayoutChanged"),this.FSummaryLayout.FOnChange=rtl.createCallback(this,"LayoutChanged"),this.FSelectedLayout.FOnChange=rtl.createCallback(this,"LayoutChanged"),this.FFocusedLayout.FOnChange=rtl.createCallback(this,"LayoutChanged"),this.FFixedSelectedLayout.FOnChange=rtl.createCallback(this,"LayoutChanged"),this},this.Assign=function(e){t.TTMSFNCGridAppearance.isPrototypeOf(e)&&(this.FBandLayout.Assign(rtl.as(e,t.TTMSFNCGridAppearance).FBandLayout),this.FFixedSelectedLayout.Assign(rtl.as(e,t.TTMSFNCGridAppearance).FFixedSelectedLayout),this.FFixedLayout.Assign(rtl.as(e,t.TTMSFNCGridAppearance).FFixedLayout),this.FNormalLayout.Assign(rtl.as(e,t.TTMSFNCGridAppearance).FNormalLayout),this.FGroupLayout.Assign(rtl.as(e,t.TTMSFNCGridAppearance).FGroupLayout),this.FSummaryLayout.Assign(rtl.as(e,t.TTMSFNCGridAppearance).FSummaryLayout),this.FSelectedLayout.Assign(rtl.as(e,t.TTMSFNCGridAppearance).FSelectedLayout),this.FFocusedLayout.Assign(rtl.as(e,t.TTMSFNCGridAppearance).FFocusedLayout),this.FProgressLayout.Assign(rtl.as(e,t.TTMSFNCGridAppearance).FProgressLayout),this.FShowFocus=rtl.as(e,t.TTMSFNCGridAppearance).FShowFocus)},this.Destroy=function(){rtl.free(this,"FProgressLayout"),rtl.free(this,"FBandLayout"),rtl.free(this,"FFixedLayout"),rtl.free(this,"FNormalLayout"),rtl.free(this,"FGroupLayout"),rtl.free(this,"FSummaryLayout"),rtl.free(this,"FSelectedLayout"),rtl.free(this,"FFocusedLayout"),rtl.free(this,"FFixedSelectedLayout"),pas.System.TObject.Destroy.call(this)};var e=this.$rtti;e.addProperty("FixedLayout",2,pas["WEBLib.TMSFNCGridCell"].$rtti.TTMSFNCGridCellLayout,"FFixedLayout","SetFixedLayout"),e.addProperty("NormalLayout",2,pas["WEBLib.TMSFNCGridCell"].$rtti.TTMSFNCGridCellLayout,"FNormalLayout","SetNormalLayout"),e.addProperty("GroupLayout",2,pas["WEBLib.TMSFNCGridCell"].$rtti.TTMSFNCGridCellLayout,"FGroupLayout","SetGroupLayout"),e.addProperty("SummaryLayout",2,pas["WEBLib.TMSFNCGridCell"].$rtti.TTMSFNCGridCellLayout,"FSummaryLayout","SetSummaryLayout"),e.addProperty("SelectedLayout",2,pas["WEBLib.TMSFNCGridCell"].$rtti.TTMSFNCGridCellLayout,"FSelectedLayout","SetSelectedLayout"),e.addProperty("FocusedLayout",2,pas["WEBLib.TMSFNCGridCell"].$rtti.TTMSFNCGridCellLayout,"FFocusedLayout","SetFocusedLayout"),e.addProperty("FixedSelectedLayout",2,pas["WEBLib.TMSFNCGridCell"].$rtti.TTMSFNCGridCellLayout,"FFixedSelectedLayout","SetFixedSelectedLayout"),e.addProperty("BandLayout",2,pas["WEBLib.TMSFNCGridCell"].$rtti.TTMSFNCGridCellLayout,"FBandLayout","SetBandLayout"),e.addProperty("ProgressLayout",2,pas["WEBLib.TMSFNCGridCell"].$rtti.TTMSFNCGridCellProgressLayout,"FProgressLayout","SetProgressLayout"),e.addProperty("ShowFocus",2,rtl.boolean,"FShowFocus","SetShowFocus",{Default:!0}),e.addProperty("OnChange",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnChange","FOnChange")})),rtl.createClass(this,"TTMSFNCGridAdapter",pas["WEBLib.TMSFNCCustomComponent"].TTMSFNCCustomComponent,(function(){this.$init=function(){pas["WEBLib.TMSFNCCustomComponent"].TTMSFNCCustomComponent.$init.call(this),this.FBlockAdd=!1,this.FGrid=null,this.FActive=!1},this.$final=function(){this.FGrid=void 0,pas["WEBLib.TMSFNCCustomComponent"].TTMSFNCCustomComponent.$final.call(this)},this.SetActive=function(t){this.FActive=t,null!=this.FGrid&&this.Initialize()},this.SetGrid=function(t){if(this.FGrid!==t){if(this.FGrid=t,this.FBlockAdd)return;this.FBlockAdd=!0,null!=this.FGrid&&(this.FGrid.SetAdapter(this),this.Initialize()),this.FBlockAdd=!1}},this.AlternateDisplayBuildUp=function(){return!1,!1},this.CanCancelEdit=function(){return!0,!0},this.StartBuild=function(t){},this.Notification=function(t,e){pas.Classes.TComponent.Notification.apply(this,arguments),1===e&&t===this.FGrid&&(this.FGrid=null)},this.UpdateBounds=function(){},this.Initialize=function(){},this.ScrollGrid=function(t,e,i){},this.SelectCell=function(t){},this.GetCellData=function(t,e,i){},this.GetCellClass=function(t,e,i){},this.GetCellProperties=function(t,e,i){},this.GetCellEditorProperties=function(t,e,i){},this.GetCellEditorType=function(t,e,i){},this.GetCellReadOnly=function(t,e,i){},this.CellEditGetData=function(t,e,i,s){},this.CellEditValidateData=function(t,e,i,s,o){},this.CellEditSetData=function(t,e,i,s){},this.CellEditDone=function(t,e,i){},this.CellEditCancel=function(t,e){},this.CellBeforeEdit=function(t,e){},this.CellCheckBoxClick=function(t,e,i){},this.CellBeforeEditExit=function(t,e,i,s){},this.ExportNotification=function(t,e){},this.Create$1=function(e){var i=0;if(pas["WEBLib.TMSFNCCustomComponent"].TTMSFNCCustomComponent.Create$1.apply(this,arguments),this.FActive=!1,this.IsDesignTime()&&null!=e&&pas["WEBLib.Forms"].TCustomForm.isPrototypeOf(e))for(var s=0,o=e.GetComponentCount()-1;s<=o;s++)if(i=s,t.TTMSFNCCustomGrid.isPrototypeOf(e.GetComponent(i))){this.SetGrid(rtl.as(e.GetComponent(i),t.TTMSFNCCustomGrid));break}return this},rtl.addIntf(this,pas["WEBLib.TMSFNCTypes"].ITMSFNCProductInfo),rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas.System.IUnknown);var e=this.$rtti;e.addProperty("Active",2,rtl.boolean,"FActive","SetActive",{Default:!1}),e.addProperty("Grid",2,t.$rtti.TTMSFNCCustomGrid,"FGrid","SetGrid")})),rtl.createClass(this,"TTMSFNCCustomGrid",pas["WEBLib.TMSFNCGridData"].TTMSFNCGridData,(function(){this.$init=function(){pas["WEBLib.TMSFNCGridData"].TTMSFNCGridData.$init.call(this),this.FToolBarPopupCell=pas["WEBLib.TMSFNCGridData"].TTMSFNCGridCellRec.$new(),this.FDummyButtonBitmap=null,this.FBlockUpdateAdapter=0,this.FBlockAdd=!1,this.FKeyUsed=!1,this.FTimeStart$1=0,this.FTimeStop$1=0,this.FAnimating$1=!1,this.FAnimateVerticalPos$1=!1,this.FAnimateHorizontalPos$1=!1,this.FScrollVTo$1=0,this.FScrollHTo$1=0,this.FAnimateTimer$1=null,this.FFreeEditControlTimer=null,this.FDoubleSelection$1=!1,this.FSpX$1=0,this.FSpY$1=0,this.FScrollX$1=0,this.FScrollY$1=0,this.FCommentPopup=null,this.FDoTouchScroll=!1,this.FFilterPopup=null,this.FActiveComment="",this.FActiveCommentTextColor=0,this.FNodeOpenBitmap=null,this.FNodeClosedBitmap=null,this.FCellKeyDown=!1,this.FCellPosX=0,this.FCellPosY=0,this.FContainerWidth=0,this.FContainerHeight=0,this.FClearMouseDown=!1,this.ChangeCursor=!1,this.OldCursor=0,this.FBlockHide=!1,this.FTabKey=0,this.FTopr=0,this.FLeftC=0,this.FDblClick=!1,this.FSaveTopCell=null,this.FPrevSelection=pas["WEBLib.TMSFNCGridData"].TTMSFNCGridCellRecRange.$new(),this.FCellAnchor=pas["WEBLib.TMSFNCGridData"].TTMSFNCGridCellRec.$new(),this.FCellAnchorString="",this.FLookupString="",this.FDraggingMode=0,this.FDragBitmap=null,this.FDragFixed=!1,this.FTouchScrolling$1=!1,this.FMouseX$1=0,this.FMouseY$1=0,this.FDragCell=pas["WEBLib.TMSFNCGridData"].TTMSFNCGridCellRec.$new(),this.FDragScrollCell=pas["WEBLib.TMSFNCGridData"].TTMSFNCGridCellRec.$new(),this.FEditCell=pas["WEBLib.TMSFNCGridData"].TTMSFNCGridCellRec.$new(),this.FEditControl=null,this.FCellEdit=null,this.FCellComboBox=null,this.FRealCell=pas["WEBLib.TMSFNCGridData"].TTMSFNCGridCellRec.$new(),this.FX=0,this.FY=0,this.FPrevX=0,this.FPrevY=0,this.FSizeX=0,this.FSaveDragX=0,this.FSaveDragY=0,this.FSizeY=0,this.FDragX=0,this.FDragY=0,this.FDownX$1=0,this.FDownY$1=0,this.FTouchX=0,this.FTouchY=0,this.FScrollTimer=null,this.FDragTimer=null,this.FPrevSelectedCell=pas["WEBLib.TMSFNCGridData"].TTMSFNCGridCellRec.$new(),this.FFirstCell=pas["WEBLib.TMSFNCGridData"].TTMSFNCGridCellRec.$new(),this.FSaveCell=pas["WEBLib.TMSFNCGridData"].TTMSFNCGridCellRec.$new(),this.FMouseDown=!1,this.FMouseDblClick=!1,this.FMouseUp$1=!1,this.FMouseScrollingUp=!1,this.FMouseSizing=!1,this.FSizing=!1,this.FSizeMode=0,this.FMouseDragging=!1,this.FCStart=0,this.FRStart=0,this.FCStop=0,this.FRStop=0,this.FOldTopRow=0,this.FReset=!1,this.FCellArray=[],this.FOnGetCellClass=null,this.FOnGetCellData=null,this.FFreezeRows=0,this.FFreezeColumns=0,this.FOnGetCellMergeInfo=null,this.FOnCellEditSetData=null,this.FOnCellEditDone=null,this.FOnGetCellEditorCustomClassType=null,this.FOnCellEditValidateData=null,this.FOnCellEditGetData=null,this.FOnGetCellEditorProperties=null,this.FOnCellRadioButtonClick=null,this.FOnCellCheckBoxClick=null,this.FOnCellBitmapClick=null,this.FOnCellCommentClick=null,this.FOnCellSortClick=null,this.FOnRowSized=null,this.FOnColumnSized=null,this.FOnCanSizeRow=null,this.FOnCanSizeColumn=null,this.FOnCanDragRow=null,this.FOnCanDragColumn=null,this.FOnColumnDragged=null,this.FOnRowDragged=null,this.FOnRowSize=null,this.FOnColumnSize=null,this.FOnCellNodeClick=null,this.FOnCanSortColumn=null,this.FOnColumnSorted=null,this.FOnCellAnchorClick=null,this.FOnCellClick=null,this.FOnFixedCellClick=null,this.FOnCellRightClick=null,this.FOnFixedCellRightClick=null,this.FOnGetCellReadOnly=null,this.FOnGetCellLayout=null,this.FOnGetCellIsFixed=null,this.FOnGetCellEditorType=null,this.FCellSpinBox=null,this.FCellColorPicker=null,this.FCellDatePicker=null,this.FCellTrackBar=null,this.FOnCellEditGetColor=null,this.FOnCellEditSetColor=null,this.FOnCellEditValidateColor=null,this.FOnGetRowIsBand=null,this.FOnCanDeleteRow=null,this.FOnCanAppendRow=null,this.FOnCanAppendColumn=null,this.FOnCanInsertRow=null,this.FOnDeleteRow=null,this.FOnAppendRow=null,this.FOnAppendColumn=null,this.FOnInsertRow=null,this.FOnCellAfterDraw=null,this.FOnCellBeforeDraw=null,this.FOnFixedCellDropDownButtonClick=null,this.FEditing=!1,this.FFilterListBox=null,this.FFilterTimer=null,this.FOnTopLeftChanged=null,this.FOnCellEditCancel=null,this.FCellMemo=null,this.FOnBeforeRowDrop=null,this.FOnBeforeColumnDrop=null,this.FOnGetCellProperties=null,this.FAppearance=null,this.FOnBeforeCellEditExit=null,this.FAdapter=null,this.FOnCellButtonClick=null,this.FToolBarPopupMode=0,this.FToolBarPopup=null,this.FOnCellComboCloseUp=null,this.FOnInternalCellEditDone=null,this.FDesignTimeSampleData=!1,this.FOnFixedCellDblClick=null,this.FOnCellDblClick=null,this.FOnGetCellRotation=null},this.$final=function(){this.FToolBarPopupCell=void 0,this.FDummyButtonBitmap=void 0,this.FAnimateTimer$1=void 0,this.FFreeEditControlTimer=void 0,this.FCommentPopup=void 0,this.FFilterPopup=void 0,this.FNodeOpenBitmap=void 0,this.FNodeClosedBitmap=void 0,this.FSaveTopCell=void 0,this.FPrevSelection=void 0,this.FCellAnchor=void 0,this.FDragBitmap=void 0,this.FDragCell=void 0,this.FDragScrollCell=void 0,this.FEditCell=void 0,this.FEditControl=void 0,this.FCellEdit=void 0,this.FCellComboBox=void 0,this.FRealCell=void 0,this.FScrollTimer=void 0,this.FDragTimer=void 0,this.FPrevSelectedCell=void 0,this.FFirstCell=void 0,this.FSaveCell=void 0,this.FCellArray=void 0,this.FOnGetCellClass=void 0,this.FOnGetCellData=void 0,this.FOnGetCellMergeInfo=void 0,this.FOnCellEditSetData=void 0,this.FOnCellEditDone=void 0,this.FOnGetCellEditorCustomClassType=void 0,this.FOnCellEditValidateData=void 0,this.FOnCellEditGetData=void 0,this.FOnGetCellEditorProperties=void 0,this.FOnCellRadioButtonClick=void 0,this.FOnCellCheckBoxClick=void 0,this.FOnCellBitmapClick=void 0,this.FOnCellCommentClick=void 0,this.FOnCellSortClick=void 0,this.FOnRowSized=void 0,this.FOnColumnSized=void 0,this.FOnCanSizeRow=void 0,this.FOnCanSizeColumn=void 0,this.FOnCanDragRow=void 0,this.FOnCanDragColumn=void 0,this.FOnColumnDragged=void 0,this.FOnRowDragged=void 0,this.FOnRowSize=void 0,this.FOnColumnSize=void 0,this.FOnCellNodeClick=void 0,this.FOnCanSortColumn=void 0,this.FOnColumnSorted=void 0,this.FOnCellAnchorClick=void 0,this.FOnCellClick=void 0,this.FOnFixedCellClick=void 0,this.FOnCellRightClick=void 0,this.FOnFixedCellRightClick=void 0,this.FOnGetCellReadOnly=void 0,this.FOnGetCellLayout=void 0,this.FOnGetCellIsFixed=void 0,this.FOnGetCellEditorType=void 0,this.FCellSpinBox=void 0,this.FCellColorPicker=void 0,this.FCellDatePicker=void 0,this.FCellTrackBar=void 0,this.FOnCellEditGetColor=void 0,this.FOnCellEditSetColor=void 0,this.FOnCellEditValidateColor=void 0,this.FOnGetRowIsBand=void 0,this.FOnCanDeleteRow=void 0,this.FOnCanAppendRow=void 0,this.FOnCanAppendColumn=void 0,this.FOnCanInsertRow=void 0,this.FOnDeleteRow=void 0,this.FOnAppendRow=void 0,this.FOnAppendColumn=void 0,this.FOnInsertRow=void 0,this.FOnCellAfterDraw=void 0,this.FOnCellBeforeDraw=void 0,this.FOnFixedCellDropDownButtonClick=void 0,this.FFilterListBox=void 0,this.FFilterTimer=void 0,this.FOnTopLeftChanged=void 0,this.FOnCellEditCancel=void 0,this.FCellMemo=void 0,this.FOnBeforeRowDrop=void 0,this.FOnBeforeColumnDrop=void 0,this.FOnGetCellProperties=void 0,this.FAppearance=void 0,this.FOnBeforeCellEditExit=void 0,this.FAdapter=void 0,this.FOnCellButtonClick=void 0,this.FToolBarPopup=void 0,this.FOnCellComboCloseUp=void 0,this.FOnInternalCellEditDone=void 0,this.FOnFixedCellDblClick=void 0,this.FOnCellDblClick=void 0,this.FOnGetCellRotation=void 0,pas["WEBLib.TMSFNCGridData"].TTMSFNCGridData.$final.call(this)},this.SetFreezeColumns=function(t){this.FFreezeColumns!==t&&(this.FFreezeColumns=t,this.UpdateControl(!0,!0))},this.SetFreezeRows=function(t){this.FFreezeRows!==t&&(this.FFreezeRows=t,this.UpdateControl(!0,!0))},this.SetLeftCol=function(t){var e=pas["WEBLib.TMSFNCGridData"].TTMSFNCGridCellRec.$new();e.Row=Math.max(this.FFixedRows,Math.min(this.FRStart,this.GetRowCount()-1-this.FFixedFooterRows)),e.Col=Math.max(this.FFixedColumns,Math.min(t,this.GetColumnCount()-1-this.FFixedRightColumns)),this.Navigate(pas["WEBLib.TMSFNCGridData"].TTMSFNCGridCellRec.$clone(e),!0)},this.SetTopRow=function(t){var e=pas["WEBLib.TMSFNCGridData"].TTMSFNCGridCellRec.$new();e.Row=Math.max(this.FFixedRows,Math.min(t,this.GetRowCount()-1-this.FFixedFooterRows)),e.Col=Math.max(this.FFixedColumns,Math.min(this.FCStart,this.GetColumnCount()-1-this.FFixedRightColumns)),this.Navigate(pas["WEBLib.TMSFNCGridData"].TTMSFNCGridCellRec.$clone(e),!0)},this.SetC=function(t){this.SetControlCursor(t),this.ChangeCursor&&(this.OldCursor=t)},this.GetLeftCol=function(){return this.FCStart},this.GetTopRow=function(){return this.FRStart},this.GetCellMemo=function(){return null==this.FCellMemo&&(this.FCellMemo=t.TTMSFNCGridMemo.$create("Create$1",[this]),this.FCellMemo.SetBorderStyle(0),this.FCellMemo.SetAutoSize(!1),this.FCellMemo.SetTabStop(!1),this.FCellMemo.SetBorderStyle(0),this.FCellMemo.FDoubleBuffered=!1,this.FCellMemo.SetShowFocus(!1),this.FCellMemo.FOnKeyDown=rtl.createCallback(this,"CellEditKeyDown"),this.FCellMemo.FOnExit=rtl.createCallback(this,"CellExit")),this.FCellMemo},this.GetCellEdit=function(){return null==this.FCellEdit&&(this.FCellEdit=t.TTMSFNCGridEdit.$create("Create$1",[this]),this.FCellEdit.SetBorderStyle(0),this.FCellEdit.SetAutoSize(!1),this.FCellEdit.SetShowFocus(!1),this.FCellEdit.SetTabStop(!1),this.FCellEdit.SetBorderStyle(0),this.FCellEdit.FDoubleBuffered=!1,this.FCellEdit.FOnKeyDown=rtl.createCallback(this,"CellEditKeyDown"),this.FCellEdit.FOnExit=rtl.createCallback(this,"CellExit")),this.FCellEdit},this.GetCellSpinBox=function(){return null==this.FCellSpinBox&&(this.FCellSpinBox=t.TTMSFNCGridSpinBox.$create("Create$1",[this]),this.FCellSpinBox.SetBorderStyle(0),this.FCellSpinBox.FAutoSize=!1,this.FCellSpinBox.SetShowFocus(!1),this.FCellSpinBox.SetTabStop(!1),this.FCellSpinBox.SetBorderStyle(0),this.FCellSpinBox.FDoubleBuffered=!1,this.FCellSpinBox.FOnKeyDown=rtl.createCallback(this,"CellControlKeyDown"),this.FCellSpinBox.FOnExit=rtl.createCallback(this,"CellExit")),this.FCellSpinBox},this.GetCellColorPicker=function(){return null==this.FCellColorPicker&&(this.FCellColorPicker=t.TTMSFNCGridColorPicker.$create("Create$1",[this]),this.FCellColorPicker.FCloseOnSelection=!0,this.FCellColorPicker.SetMode(1),this.FCellColorPicker.FOnKeyDown=rtl.createCallback(this,"CellComboBoxKeyDown"),this.FCellColorPicker.FOnExit=rtl.createCallback(this,"CellExit")),this.FCellColorPicker},this.GetCellDatePicker=function(){return null==this.FCellDatePicker&&(this.FCellDatePicker=t.TTMSFNCGridDatePicker.$create("Create$1",[this]),this.FCellDatePicker.SetShowFocus(!1),this.FCellDatePicker.FOnKeyDown=rtl.createCallback(this,"CellComboBoxKeyDown"),this.FCellDatePicker.FOnExit=rtl.createCallback(this,"CellExit")),this.FCellDatePicker},this.GetCellTrackBar=function(){return null==this.FCellTrackBar&&(this.FCellTrackBar=t.TTMSFNCGridTrackBar.$create("Create$1",[this]),this.FCellTrackBar.SetShowFocus(!1),this.FCellTrackBar.FOnKeyDown=rtl.createCallback(this,"CellControlKeyDown"),this.FCellTrackBar.FOnExit=rtl.createCallback(this,"CellExit")),this.FCellTrackBar},this.GetCellComboBox=function(){return null==this.FCellComboBox&&(this.FCellComboBox=t.TTMSFNCGridComboBox.$create("Create$1",[this]),this.FCellComboBox.SetStyle(0),this.FCellComboBox.FOnChange=rtl.createCallback(this,"CellComboBoxChange"),this.FCellComboBox.SetShowFocus(!1),this.FCellComboBox.FOnKeyDown=rtl.createCallback(this,"CellComboBoxKeyDown"),this.FCellComboBox.FOnExit=rtl.createCallback(this,"CellExit")),this.FCellComboBox},this.SetAppearance=function(t){this.FAppearance!==t&&this.FAppearance.Assign(t)},this.SetAdapter=function(t){if(this.FAdapter!==t){if(this.FAdapter=t,this.FBlockAdd)return;this.FBlockAdd=!0,null!=this.FAdapter&&(this.FAdapter.SetGrid(this),this.FAdapter.Initialize()),this.FBlockAdd=!1}},this.GetBottomRow=function(){return this.FRStop},this.GetPrevFocusedCell=function(){var t=pas["WEBLib.TMSFNCGridData"].TTMSFNCGridCellRec.$new();return t.$assign(this.FPrevSelectedCell),t},this.SetDesignTimeSampleData=function(t){this.FDesignTimeSampleData=t,this.FDesignTimeSampleData&&(0 in this.FComponentState||1 in this.FComponentState)&&4 in this.FComponentState&&this.LoadSampleData()},this.Animate$1=function(t){var i,s,o=0,n=0,r=!1,a=!1;n=this.GetVScrollValue(),o=this.GetHScrollValue(),i=Math.abs(this.FScrollHTo$1-o)/Math.max(1,6*Math.abs(this.FSpX$1)),s=Math.abs(this.FScrollVTo$1-n)/Math.max(1,6*Math.abs(this.FSpY$1)),a=!1,this.FAnimateVerticalPos$1&&(a=e.AnimateDouble({get:function(){return n},set:function(t){n=t}},{p:this,get:function(){return this.p.FScrollVTo$1},set:function(t){this.p.FScrollVTo$1=t}},s,.01)),r=!1,this.FAnimateHorizontalPos$1&&(r=e.AnimateDouble({get:function(){return o},set:function(t){o=t}},{p:this,get:function(){return this.p.FScrollHTo$1},set:function(t){this.p.FScrollHTo$1=t}},i,.01)),this.FAnimating$1=a||r,this.FAnimating$1?this.Scroll(o,n):(this.FAnimateVerticalPos$1=!1,this.FAnimateTimer$1.SetEnabled(!1),this.FAnimateHorizontalPos$1=!1)},this.DoFreeEditControl=function(t){null!=this.FEditControl&&(rtl.free(this,"FEditControl"),this.FEditControl=null),this.FFreeEditControlTimer.SetEnabled(!1)},this.ApplyStyle=function(){var t=0,e=0,i=0,s=null;pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.ApplyStyle.call(this),this.BeginUpdate(),t=-1,pas["WEBLib.TMSFNCStyles"].TTMSFNCStyles.GetStyleBackgroundFillColor({get:function(){return t},set:function(e){t=e}})&&this.FFill.SetColor(t),t=-1,pas["WEBLib.TMSFNCStyles"].TTMSFNCStyles.GetStyleLineFillColor({get:function(){return t},set:function(e){t=e}})&&(this.FStroke.SetColor(t),this.FAppearance.FFixedLayout.FStroke.SetColor(t),this.FAppearance.FFixedSelectedLayout.FStroke.SetColor(t),this.FAppearance.FSelectedLayout.FStroke.SetColor(t),this.FAppearance.FNormalLayout.FStroke.SetColor(t),this.FAppearance.FFocusedLayout.FStroke.SetColor(t),this.FAppearance.FBandLayout.FStroke.SetColor(t),this.FAppearance.FGroupLayout.FStroke.SetColor(t),this.FAppearance.FSummaryLayout.FStroke.SetColor(t)),t=-1,pas["WEBLib.TMSFNCStyles"].TTMSFNCStyles.GetStyleHeaderFillColor({get:function(){return t},set:function(e){t=e}})&&(this.FAppearance.FFixedLayout.FFill.SetKind(1),this.FAppearance.FFixedLayout.FFill.SetColor(t)),t=-1,pas["WEBLib.TMSFNCStyles"].TTMSFNCStyles.GetStyleHeaderFillColorTo({get:function(){return t},set:function(e){t=e}})&&(this.FAppearance.FFixedLayout.FFill.SetKind(2),this.FAppearance.FFixedLayout.FFill.SetColorTo(t)),t=-1,pas["WEBLib.TMSFNCStyles"].TTMSFNCStyles.GetStyleSelectionFillColor({get:function(){return t},set:function(e){t=e}})&&(this.FAppearance.FFixedSelectedLayout.FFill.SetColor(t),this.FAppearance.FFocusedLayout.FFill.SetColor(t),this.FAppearance.FSelectedLayout.FFill.SetColor(t),this.FAppearance.FGroupLayout.FFill.SetColor(t),this.FAppearance.FSummaryLayout.FFill.SetColor(t),this.FAppearance.FProgressLayout.SetColor(t),this.FAppearance.FFixedSelectedLayout.FFill.SetKind(1),this.FAppearance.FFocusedLayout.FFill.SetKind(1),this.FAppearance.FSelectedLayout.FFill.SetKind(1),this.FAppearance.FGroupLayout.FFill.SetKind(1),this.FAppearance.FSummaryLayout.FFill.SetKind(1)),t=-1,pas["WEBLib.TMSFNCStyles"].TTMSFNCStyles.GetStyleSelectionFillColorTo({get:function(){return t},set:function(e){t=e}})&&(this.FAppearance.FFixedSelectedLayout.FFill.SetColorTo(t),this.FAppearance.FFocusedLayout.FFill.SetColorTo(t),this.FAppearance.FSelectedLayout.FFill.SetColorTo(t),this.FAppearance.FGroupLayout.FFill.SetColorTo(t),this.FAppearance.FSummaryLayout.FFill.SetColorTo(t),this.FAppearance.FFixedSelectedLayout.FFill.SetKind(2),this.FAppearance.FFocusedLayout.FFill.SetKind(2),this.FAppearance.FSelectedLayout.FFill.SetKind(2),this.FAppearance.FGroupLayout.FFill.SetKind(2),this.FAppearance.FSummaryLayout.FFill.SetKind(2)),t=-1,pas["WEBLib.TMSFNCStyles"].TTMSFNCStyles.GetStyleTextFontColor({get:function(){return t},set:function(e){t=e}})&&(this.FDefaultFont.SetColor(t),this.FAppearance.FFixedLayout.FFont.SetColor(t),this.FAppearance.FNormalLayout.FFont.SetColor(t),this.FAppearance.FFixedSelectedLayout.FFont.SetColor(t),this.FAppearance.FSelectedLayout.FFont.SetColor(t),this.FAppearance.FFocusedLayout.FFont.SetColor(t),this.FAppearance.FGroupLayout.FFont.SetColor(t),this.FAppearance.FSummaryLayout.FFont.SetColor(t)),this.RemoveAllCells();for(var o=0,n=this.FRowList.GetCount()-1;o<=n;o++)if(e=o,null!=this.FRowList.GetItem(e))for(var r=0,a=this.FRowList.GetItem(e).FData.GetCount()-1;r<=a;r++)i=r,null!=(s=this.FRowList.GetItem(e).FData.GetObject(i))&&(s.FFontColor=t);this.EndUpdate()},this.SetAdaptToStyle=function(t){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.SetAdaptToStyle.apply(this,arguments),null!=this.FCommentPopup&&this.FCommentPopup.SetAdaptToStyle(!0),null!=this.FFilterPopup&&this.FFilterPopup.SetAdaptToStyle(!0)},this.ResetToDefaultStyle=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.ResetToDefaultStyle.call(this),this.FAppearance.InitializeDefaultLayout(),this.FAppearance.SetShowFocus(!0),this.FAppearance.FFixedLayout.FFill.SetColor(16380654),this.FAppearance.FFixedLayout.FFont.SetColor(4539717),this.FAppearance.FNormalLayout.FFill.SetColor(16578806),this.FAppearance.FNormalLayout.FFont.SetColor(8026746),this.FAppearance.FSelectedLayout.FFill.SetColor(16441019),this.FAppearance.FSelectedLayout.FFont.SetColor(4539717),this.FAppearance.FFocusedLayout.FFill.SetColor(16039284),this.FAppearance.FFocusedLayout.FFont.SetColor(4539717),this.FAppearance.FBandLayout.FFill.SetColor(16711679),this.FAppearance.FBandLayout.FFont.SetColor(8026746),this.FAppearance.FSelectedLayout.FStroke.SetColor(12632256),this.FAppearance.FFocusedLayout.FStroke.SetColor(12632256),this.FAppearance.FNormalLayout.FStroke.SetColor(12632256),this.FAppearance.FNormalLayout.FStroke.SetKind(1),this.FAppearance.FFixedLayout.FFill.SetKind(1),this.FAppearance.FFixedLayout.FStroke.SetColor(12632256),this.FAppearance.FFixedLayout.FStroke.SetKind(1),this.FAppearance.FFixedLayout.FFont.SetStyle(rtl.createSet(0)),pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.SetFontSize(this.FAppearance.FFixedLayout.FFont,14,1),this.FAppearance.FFixedSelectedLayout.FFont.SetColor(0),this.FAppearance.FFixedSelectedLayout.FStroke.SetColor(12632256),this.FAppearance.FFixedSelectedLayout.FFill.SetKind(1),this.FAppearance.FSelectedLayout.FFill.SetKind(1),this.FAppearance.FBandLayout.FStroke.SetKind(1),this.FAppearance.FBandLayout.FStroke.SetColor(12632256),this.FAppearance.FGroupLayout.FFont.SetColor(0),this.FAppearance.FGroupLayout.FFill.SetKind(1),this.FAppearance.FSummaryLayout.FFill.SetKind(1),this.FAppearance.FSummaryLayout.FFont.SetColor(0),this.FAppearance.FFocusedLayout.FFill.SetKind(1),this.FAppearance.FFocusedLayout.FStroke.SetKind(1),this.FFill.SetColor(16777215),this.FStroke.SetColor(12632256),this.RemoveAllCells(),this.UpdateGridCells(!1)},this.SetRowSelect=function(t,e){!this.FBlockUpdate&&e?(this.FBlockSelectEventHandler=!0,this.SelectCell(pas["WEBLib.TMSFNCGridData"].TTMSFNCGridCellRec.$clone(pas["WEBLib.TMSFNCGridData"].MakeCell(this.FFixedColumns,t)),rtl.createSet(2),!1)):pas["WEBLib.TMSFNCGridData"].TTMSFNCGridData.SetRowSelect.apply(this,arguments)},this.GetCellAppearance=function(t,e,i){var s=null,o=0,n=t;return 0===n?-1!==this.FGroupColumn?(o=i,s=this.IsNode(o)?this.GetDefaultGroupLayout():this.IsSummary(o)?this.GetDefaultSummaryLayout():this.IsBand(this.DisplToRealRow(i))&&this.FOptions.FBands.FEnabled?this.GetDefaultBandLayout():this.GetDefaultNormalLayout()):s=this.IsBand(this.DisplToRealRow(i))&&this.FOptions.FBands.FEnabled?this.GetDefaultBandLayout():this.GetDefaultNormalLayout():s=1===n?this.GetDefaultFocusedLayout():2===n?this.GetDefaultFixedLayout():3===n?this.GetDefaultFixedSelectedLayout():4===n?this.GetDefaultSelectedLayout():null,s},this.GetPageScrollSize=function(){return 0===this.FOptions.FKeyboard.FPageScrollSize&&this.GetVerticalScrollMax()*this.GetRowCount()>0?Math.round(this.GetVerticalContentViewPortSize()/this.GetVerticalScrollMax()*this.GetRowCount()):this.FOptions.FKeyboard.FPageScrollSize},this.GetColumnViewPortSize=function(){var t=0,e=0,i=0,s=0,o=pas["WEBLib.TMSFNCTypes"].TRectF.$new();t=0,s=this.GetFixedWidth()+this.GetFixedRightWidth(),i=0,o.$assign(this.GetContentRect());for(var n=this.GetColumnCount()-1-this.FFixedRightColumns;n>=0;n--){if(e=n,(s+=this.GetColWidths(e))>o.Right-o.Left){t=Math.max(1,i);break}i+=1}return t},this.GetRowViewPortSize=function(){var t=0,e=0,i=0,s=0,o=pas["WEBLib.TMSFNCTypes"].TRectF.$new();t=0,s=this.GetFixedHeight()+this.GetFixedFooterHeight(),i=0,o.$assign(this.GetContentRect());for(var n=this.GetRowCount()-1-this.FFixedFooterRows;n>=0;n--){if(e=n,(s+=this.GetRowHeights(e))>o.Bottom-o.Top){t=Math.max(1,i);break}i+=1}return t},this.GetVersion=function(){return this.$class.GetVersionNumber(1,0,0,1)},this.GetDocURL=function(){return t.TTMSFNCGridDocURL},this.GetHorizontalContentCount=function(){return this.GetColumnCount()-this.FFixedColumns-this.FFreezeColumns-this.FFixedRightColumns},this.GetHorizontalContentViewPortSize=function(){return this.GetColumnViewPortSize()},this.GetVerticalContentCount=function(){return this.GetRowCount()-this.FFixedRows-this.FFreezeRows-this.FFixedFooterRows},this.GetVerticalContentViewPortSize=function(){return this.GetRowViewPortSize()},this.GetHorizontalPos=function(t,e){var i=0,s=0;i=0;for(var o=t,n=e-1;o<=n;o++)s=o,i+=this.GetColWidths(s);return i},this.GetVerticalPos=function(t,e){var i=0,s=0;i=0;for(var o=t,n=e-1;o<=n;o++)s=o,i+=this.GetRowHeights(s);return i},this.DoIsCellSelected=function(t,e){return this.FOptions.FSelection.FMode in rtl.createSet(7,8,9)?pas["WEBLib.TMSFNCGridData"].TTMSFNCGridData.DoIsCellSelected.call(this,t,e):t>=this.FStartCell.Col&&e>=this.FStartCell.Row&&t<=this.FStopCell.Col&&e<=this.FStopCell.Row},this.DoIsFixedCellSelected=function(t,e){var i=!1;return i=t>=this.FStartCell.Col&&t<=this.FStopCell.Col&&2!==this.FOptions.FSelection.FMode&&7!==this.FOptions.FSelection.FMode&&9!==this.FOptions.FSelection.FMode&&5!==this.FOptions.FSelection.FMode||e>=this.FStartCell.Row&&e<=this.FStopCell.Row&&3!==this.FOptions.FSelection.FMode&&8!==this.FOptions.FSelection.FMode&&9!==this.FOptions.FSelection.FMode&&6!==this.FOptions.FSelection.FMode,7===this.FOptions.FSelection.FMode?i=this.GetRowSelect(e):8===this.FOptions.FSelection.FMode?i=this.GetColumnSelect(t):9===this.FOptions.FSelection.FMode&&(i=this.GetFixedCellSelect(t,e)),i},this.GetDefaultFixedLayout=function(){return this.FAppearance.FFixedLayout},this.GetDefaultNormalLayout=function(){return this.FAppearance.FNormalLayout},this.GetDefaultGroupLayout=function(){return this.FAppearance.FGroupLayout},this.GetDefaultSummaryLayout=function(){return this.FAppearance.FSummaryLayout},this.GetDefaultSelectedLayout=function(){return this.FAppearance.FSelectedLayout},this.GetDefaultFocusedLayout=function(){return this.FAppearance.FFocusedLayout},this.GetDefaultFixedSelectedLayout=function(){return this.FAppearance.FFixedSelectedLayout},this.GetDefaultBandLayout=function(){return this.FAppearance.FBandLayout},this.GetNodeBitmap=function(e){var i=null,s=e;return 1===s?(null==this.FNodeClosedBitmap&&(this.FNodeClosedBitmap=pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.CreateFromResource$1(t.TMSFNCGRIDCELLNODECLOSED,pas["WEBLib.TMSFNCTypes"].HInstance())),i=this.FNodeClosedBitmap):0===s?(null==this.FNodeOpenBitmap&&(this.FNodeOpenBitmap=pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.CreateFromResource$1(t.TMSFNCGRIDCELLNODEOPEN,pas["WEBLib.TMSFNCTypes"].HInstance())),i=this.FNodeOpenBitmap):i=null,i},this.GetDummyButtonBitmap=function(t){return null==this.FDummyButtonBitmap||this.FDummyButtonBitmap.GetWidth()===t.FWidth&&this.FDummyButtonBitmap.GetHeight()===t.FHeight||(rtl.free(this,"FDummyButtonBitmap"),this.FDummyButtonBitmap=null),null==this.FDummyButtonBitmap&&(this.FDummyButtonBitmap=pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.$create("Create$3"),this.FDummyButtonBitmap.SetSize(t.FButtonWidth,t.FButtonHeight)),this.FDummyButtonBitmap},this.Notification=function(t,e){pas["WEBLib.TMSFNCGridData"].TTMSFNCGridData.Notification.apply(this,arguments),t===this.FAdapter&&1===e&&this.SetAdapter(null),t===this.FToolBarPopup&&1===e&&(this.FToolBarPopup=null)},this.AppearanceChanged=function(t){this.UpdateControl(!0,!0)},this.DoPaintCommentPopup=function(t,e,i){var s=pas["WEBLib.TMSFNCTypes"].TRectF.$new();e.FFont.SetColor(this.FActiveCommentTextColor),s.$assign(i),pas["WEBLib.TMSFNCTypes"].InflateRectEx(s,-4,-4),e.DrawText$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(s),this.FActiveComment,!0,1,1,0,0,-1,-1,!0,!1,-1,-1)},this.ClearFixedSorting=function(t){for(var e=0,i=0,s=null,o=null,n=0,r=rtl.length(this.FCellArray)-1;n<=r;n++){e=n;for(var a=0,l=this.FFixedRows-1;a<=l;a++)i=a,null!=(o=this.FCellArray[e][i])&&pas["WEBLib.TMSFNCGridCell"].TTMSFNCFixedGridCell.isPrototypeOf(o)&&o!==t&&((s=rtl.as(o,pas["WEBLib.TMSFNCGridCell"].TTMSFNCFixedGridCell)).FSortIndex=-1,s.FSortKind=0)}},this.HandleMouseLeave=function(){var t=pas["WEBLib.TMSFNCTypes"].TPointF.$new();pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleMouseLeave.call(this),null!=this.FToolBarPopup&&this.FToolBarPopup.Activated()&&!this.FEditing&&(t.$assign(pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.GetMousePos()),this.FToolBarPopup.PointInPopup(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(t))||this.FToolBarPopup.DropDownActive()||this.FToolBarPopup.Deactivate())},this.HandleDblClick=function(t,e){var i=pas["WEBLib.TMSFNCTypes"].TPointF.$new(),s=pas["WEBLib.TMSFNCGridData"].TTMSFNCGridCellRec.$new();if(pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleDblClick.apply(this,arguments),this.FDblClick=!0,this.FMouseDblClick){this.FMouseDblClick=!1;var o=this.FSizeMode;2===o||0===o?this.FOptions.FMouse.FColumnAutoSizeOnDblClick&&this.AutoSizeColumn(this.FDragCell.Col,!0,5):3!==o&&1!==o||this.FOptions.FMouse.FRowAutoSizeOnDblClick&&this.AutoSizeRow(this.FDragCell.Row,5)}i.$assign(this.ScreenToLocalEx(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.GetMousePos()))),s.$assign(this.XYToCell(i.X,i.Y)),-1!==s.Col&&-1!==s.Row&&(this.IsFixed(s.Col,s.Row)?this.DoFixedCellDblClick(s.Col,s.Row):this.DoCellDblClick(s.Col,s.Row))},this.HandleMouseDown=function(t,i,s,o){var n=pas["WEBLib.TMSFNCGridData"].TTMSFNCGridCellRec.$new(),r=null,a=0,l=0,h=!1,F=!1,p=!1,c=!1,u=!1,C=pas["WEBLib.TMSFNCGridData"].TTMSFNCGridCellRec.$new(),T=!1;pas["WEBLib.TMSFNCCustomScrollControl"].TTMSFNCCustomScrollControl.HandleMouseDown.apply(this,arguments),!this.HideEdit(!1,!0)&&(C.$assign(this.XYToCell(s,o)),T=!0,C.Col===this.FEditCell.Col&&C.Row===this.FEditCell.Row||(this.CancelEdit(),T=!1),T)||(this.CanFocus()&&this.SetFocus(),this.CaptureEx(),0===t&&(a=s,l=o,n.$assign(this.XYToCell(s,o)),null!=(r=this.GetCellObject(pas["WEBLib.TMSFNCGridData"].TTMSFNCGridCellRec.$clone(this.GetDisplayCell(pas["WEBLib.TMSFNCGridData"].TTMSFNCGridCellRec.$clone(n)))))&&(this.FDragCell.$assign(n),(h=this.IsFixed(n.Col,n.Row))?(F=this.FOptions.FMouse.FFixedRowSizing,p=this.FOptions.FMouse.FFixedColumnSizing):(F=this.FOptions.FMouse.FRowSizing,p=this.FOptions.FMouse.FColumnSizing),F&&(n.Row<this.GetRowCount()-this.FFixedFooterRows&&h||!h)&&l>=r.FTop+r.FHeight-this.FOptions.FMouse.FRowSizeMargin&&a>r.FLeft+this.FOptions.FMouse.FColumnSizeMargin&&a<r.FLeft+r.FWidth-this.FOptions.FMouse.FColumnSizeMargin?(c=!0,this.DoCanSizeRow(n.Row,{get:function(){return c},set:function(t){c=t}}),c&&(this.FMouseSizing=!0,this.FSizeMode=1)):F&&(n.Row>this.FFixedRows&&h||!h)&&l<=r.FTop+this.FOptions.FMouse.FRowSizeMargin&&a>r.FLeft+this.FOptions.FMouse.FColumnSizeMargin&&a<r.FLeft+r.FWidth-this.FOptions.FMouse.FColumnSizeMargin?(c=!0,this.DoCanSizeRow(n.Row-1,{get:function(){return c},set:function(t){c=t}}),c&&(this.FMouseSizing=!0,this.FSizeMode=3)):p&&(n.Col<this.GetColumnCount()-this.FFixedRightColumns&&h||!h)&&a>=r.FLeft+r.FWidth-this.FOptions.FMouse.FColumnSizeMargin&&l>r.FTop+this.FOptions.FMouse.FRowSizeMargin&&l<r.FTop+r.FHeight-this.FOptions.FMouse.FRowSizeMargin?(c=!0,this.DoCanSizeColumn(n.Col,{get:function(){return c},set:function(t){c=t}}),c&&(this.FMouseSizing=!0,this.FSizeMode=0)):p&&(n.Col>this.FFixedColumns&&h||!h)&&a<=r.FLeft-this.FOptions.FMouse.FColumnSizeMargin&&l>r.FTop+this.FOptions.FMouse.FRowSizeMargin&&l<r.FTop+r.FHeight-this.FOptions.FMouse.FRowSizeMargin?(c=!0,this.DoCanSizeColumn(n.Col-1,{get:function(){return c},set:function(t){c=t}}),c&&(this.FMouseSizing=!0,this.FSizeMode=2)):(this.FMouseDown=!0,this.FMouseUp$1=!0,u=!1,pas["WEBLib.TMSFNCGridCell"].TTMSFNCGridCell.isPrototypeOf(r)&&(u=!1,rtl.as(r,pas["WEBLib.TMSFNCGridCell"].TTMSFNCGridCell).HandleMouseDown(t,rtl.refSet(i),s,o,{get:function(){return u},set:function(t){u=t}}),u&&this.Invalidate()),u||(this.IsFixed(n.Col,n.Row)?(this.FDragFixed=this.FOptions.FMouse.FRowDragging&&(n.Col<this.FFixedColumns||n.Col>this.GetColumnCount()-1-this.FFixedRightColumns),this.FDragFixed=this.FDragFixed||(0!==this.FOptions.FSorting.FMode||this.FOptions.FMouse.FColumnDragging)&&(n.Row<this.FFixedRows||n.Row>this.GetRowCount()-1-this.FFixedFooterRows)):(n.$assign(this.BaseCell(n.Col,n.Row)),n.Col!==this.GetFocusedCell().Col||n.Row!==this.GetFocusedCell().Row||this.FOptions.FMouse.FDirectEdit?this.HideEdit(!1,!1):(this.FMouseUp$1=!1,c=!0,this.DoCanEditCell(this.GetFocusedCell().Col,this.GetFocusedCell().Row,{get:function(){return c},set:function(t){c=t}}),this.FMouseUp$1=!c,c&&this.EditCell(pas["WEBLib.TMSFNCGridData"].TTMSFNCGridCellRec.$clone(this.GetFocusedCell()),0,!1,"",0)))))),this.FTouchScrolling$1=!1,this.FPrevX=s,this.FPrevY=o,this.FSizeX=this.FPrevX,this.FSizeY=this.FPrevY,this.FDragX=this.FPrevX,this.FDragY=this.FPrevY,this.FDownX$1=this.FPrevX,this.FDownY$1=this.FPrevY,this.FTouchX=this.FPrevX,this.FTouchY=this.FPrevY,this.FScrollX$1=this.FPrevX,this.FScrollY$1=this.FPrevY,this.FMouseX$1=this.FPrevX,this.FMouseY$1=this.FPrevY,this.GetHVisible()?this.FScrollHTo$1=this.GetHScrollValue():this.FScrollHTo$1=0,this.GetVVisible()?this.FScrollVTo$1=this.GetVScrollValue():this.FScrollVTo$1=0,this.FCellAnchor.Col=-1,this.FCellAnchor.Row=-1,this.FFirstCell.Col=-1,this.FFirstCell.Row=-1,this.FCellAnchorString="",this.FDoubleSelection$1=!this.FAnimateTimer$1.FEnabled,this.FTimeStart$1=e.GetTickCountX(),this.FTimeStop$1=this.FTimeStart$1,this.FIsMouseDown=!0,this.FMouseScrollingUp=!1))},this.HandleMouseMove=function(t,e,i){var s=this,o=pas["WEBLib.TMSFNCGridData"].TTMSFNCGridCellRec.$new(),n=!1,r=null,a=0,l=0,h=!1,F=!1,p=!1,c=null,u=null,C=null,T=0,S=0,d=!1,m=0,f=0,g=0,y=0,M=0,b=!1,N=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),B=!1,E=0,D=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),L=0,G=0,A=0,I=pas["WEBLib.TMSFNCTypes"].TPointF.$new();function P(){s.FToolBarPopup.SetPlacementControl(s),s.FToolBarPopup.SetPlacement(9),s.FToolBarPopup.FGrid=s,s.FToolBarPopupCell.$assign(o),s.FToolBarPopup.FGridCell.$assign(s.FToolBarPopupCell),s.FToolBarPopup.Activate(),I.$assign(pas["WEBLib.TMSFNCTypes"].PointF(r.FLeft+(r.FWidth-s.FToolBarPopup.FToolBar.GetWidth())/2,r.FTop-s.FToolBarPopup.FToolBar.GetHeight()+1)),I.$assign(s.ConvertClientToScreen(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(I))),s.FToolBarPopup.FPlacementRectangle.SetLeft(I.X),s.FToolBarPopup.FPlacementRectangle.SetTop(I.Y),s.FToolBarPopup.FPlacementRectangle.SetRight(I.X),s.FToolBarPopup.FPlacementRectangle.SetBottom(I.Y)}if(pas["WEBLib.TMSFNCCustomScrollControl"].TTMSFNCCustomScrollControl.HandleMouseMove.apply(this,arguments),this.HideEdit(!1,!0))if(this.FClearMouseDown&&(this.FMouseDown=!1,this.FClearMouseDown=!1),this.FDblClick&&(this.FDblClick=!1,this.FMouseDown=!1,this.ReleaseCaptureEx()),this.FCellAnchor.Col=-1,this.FCellAnchor.Row=-1,this.FCellAnchorString="",this.FX=e,this.FY=i,D.$assign(this.GetContentClipRect()),this.FMouseDown&&(this.FX<this.FDownX$1-this.FOptions.FMouse.FClickMargin||this.FX>this.FDownX$1+this.FOptions.FMouse.FClickMargin||this.FY<this.FDownY$1-this.FOptions.FMouse.FClickMargin||this.FY>this.FDownY$1+this.FOptions.FMouse.FClickMargin)){if(this.FDragFixed){if(-1!==this.FDragCell.Col&&-1!==this.FDragCell.Row)if(null==this.FDragBitmap){if(null!=(c=this.GetCellObject(pas["WEBLib.TMSFNCGridData"].TTMSFNCGridCellRec.$clone(this.GetDisplayCell(pas["WEBLib.TMSFNCGridData"].TTMSFNCGridCellRec.$clone(this.FDragCell))))))if((d=this.FOptions.FMouse.FColumnDragging)&&this.DoCanDragColumn(this.FDragCell.Col,{get:function(){return d},set:function(t){d=t}}),(this.FDragCell.Row<this.FFixedRows||this.FDragCell.Row>this.GetRowCount()-1-this.FFixedFooterRows)&&d){this.UpdateCursor(10),this.FDragBitmap=pas["WEBLib.TMSFNCImage"].TTMSFNCImage.$create("Create$1",[s]),this.FDragBitmap.SetWidth(Math.round(c.FWidth)+2),this.FDragBitmap.SetHeight(Math.round(Math.min(this.GetHeight(),D.Bottom-D.Top))+2),T=-c.FLeft,this.FDragBitmap.SetLeft(Math.round(-T)),this.FDragBitmap.SetTop(0),(u=pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.$create("CreateBitmapCanvas",[Math.round(this.FDragBitmap.GetWidth()),Math.round(this.FDragBitmap.GetHeight()),!1,!0])).BeginScene(),u.FBitmapContainer=this.GetBitmapContainer(),u.FOptimizedHTMLDrawing=this.FOptimizedHTMLDrawing,C=this.MakeScreenshot();try{u.BeginScene(),u.DrawRectangle$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(0,0,this.FDragBitmap.GetWidth(),this.FDragBitmap.GetHeight())),2),u.DrawBitmapPart$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(this.FDragBitmap.GetLeft(),this.FDragBitmap.GetTop(),this.FDragBitmap.GetLeft()+this.FDragBitmap.GetWidth()-2,this.FDragBitmap.GetTop()+this.FDragBitmap.GetHeight()-2)),pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(0,0,this.FDragBitmap.GetWidth(),this.FDragBitmap.GetHeight())),C,!0,!1,!0,!1),u.EndScene(),this.FDragBitmap.FBitmaps.AddDrawBitmap(u.FBitmap,1)}finally{C=rtl.freeLoc(C),u.EndScene(),u=rtl.freeLoc(u)}this.FDraggingMode=2,this.FSaveDragX=this.FDragBitmap.GetLeft(),this.FDragBitmap.SetParent(s),this.FDragX=this.FX,this.FDragY=this.FY}else if((d=this.FOptions.FMouse.FRowDragging)&&this.DoCanDragRow(this.FDragCell.Row,{get:function(){return d},set:function(t){d=t}}),(this.FDragCell.Col<this.FFixedColumns||this.FDragCell.Col>this.GetColumnCount()-1-this.FFixedRightColumns)&&d){this.UpdateCursor(10),this.FDragBitmap=pas["WEBLib.TMSFNCImage"].TTMSFNCImage.$create("Create$1",[s]),this.FDragBitmap.SetWidth(Math.round(Math.min(this.GetWidth(),D.Right-D.Left))+2),this.FDragBitmap.SetHeight(Math.round(c.FHeight)+2),S=-c.FTop,this.FDragBitmap.SetLeft(0),this.FDragBitmap.SetTop(Math.round(-S)),(u=pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.$create("CreateBitmapCanvas",[Math.round(this.FDragBitmap.GetWidth()),Math.round(this.FDragBitmap.GetHeight()),!1,!0])).BeginScene(),u.FOptimizedHTMLDrawing=this.FOptimizedHTMLDrawing,u.FBitmapContainer=this.GetBitmapContainer(),C=this.MakeScreenshot();try{u.BeginScene(),u.DrawRectangle$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(0,0,this.FDragBitmap.GetWidth(),this.FDragBitmap.GetHeight())),2),u.DrawBitmapPart$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(this.FDragBitmap.GetLeft(),this.FDragBitmap.GetTop(),this.FDragBitmap.GetLeft()+this.FDragBitmap.GetWidth()-2,this.FDragBitmap.GetTop()+this.FDragBitmap.GetHeight()-2)),pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(0,0,this.FDragBitmap.GetWidth(),this.FDragBitmap.GetHeight())),C,!0,!1,!0,!1),u.EndScene(),this.FDragBitmap.FBitmaps.AddDrawBitmap(u.FBitmap,1)}finally{C=rtl.freeLoc(C),u.EndScene(),u=rtl.freeLoc(u)}this.FDraggingMode=1,this.FSaveDragY=this.FDragBitmap.GetTop(),this.FDragBitmap.SetParent(s),this.FDragX=this.FX,this.FDragY=this.FY}}else(this.FDragCell.Row<this.FFixedRows||this.FDragCell.Row>this.GetRowCount()-1-this.FFixedFooterRows)&&this.FOptions.FMouse.FColumnDragging?((f=this.FSaveDragX+(this.FX-this.FDragX))<=D.Right-D.Left-this.FDragBitmap.GetWidth()&&f>=0?(this.FDragBitmap.SetLeft(Math.round(Math.max(0,Math.min(D.Right-D.Left-this.FDragBitmap.GetWidth(),f)))),this.FSaveDragX=this.FDragBitmap.GetLeft(),this.FDragTimer.SetEnabled(!1),f>this.GetFixedWidth()&&f<D.Right-D.Left-this.GetFixedRightWidth()&&this.FDragScrollCell.$assign(this.XYToCell(f,(D.Bottom-D.Top)/2))):f>D.Right-D.Left-this.FDragBitmap.GetWidth()?(this.FDragBitmap.SetLeft(Math.round(D.Right-D.Left-this.FDragBitmap.GetWidth())),this.FSaveDragX=f,this.FDragTimer.SetEnabled(!0)):f<0&&(this.FDragBitmap.SetLeft(0),this.FSaveDragX=f,this.FDragTimer.SetEnabled(!0)),this.FDragX=this.FX,this.FDragY=this.FY):(this.FDragCell.Col<this.FFixedColumns||this.FDragCell.Col>this.GetColumnCount()-1-this.FFixedRightColumns)&&this.FOptions.FMouse.FRowDragging&&((g=this.FSaveDragY+(this.FY-this.FDragY))<=D.Bottom-D.Top-this.FDragBitmap.GetHeight()?(this.FDragBitmap.SetTop(Math.round(Math.max(0,Math.min(D.Bottom-D.Top-this.FDragBitmap.GetHeight(),g)))),this.FSaveDragY=this.FDragBitmap.GetTop(),this.FDragTimer.SetEnabled(!1),g>this.GetFixedHeight()&&g<D.Bottom-D.Top-this.GetFixedFooterHeight()&&this.FDragScrollCell.$assign(this.XYToCell((D.Right-D.Left)/2,g))):g>D.Bottom-D.Top-this.FDragBitmap.GetHeight()&&(this.FDragBitmap.SetTop(Math.round(D.Bottom-D.Top-this.FDragBitmap.GetHeight())),this.FSaveDragY=g,this.FDragTimer.SetEnabled(!0)),this.FDragX=this.FX,this.FDragY=this.FY),pas["WEBLib.TMSFNCTypes"].PtInRectEx(this.GetLocalRect(),pas["WEBLib.TMSFNCTypes"].PointF(e,i))?this.UpdateCursor(10):this.UpdateCursor(13)}else if(this.HideEdit(!1,!1),M=this.GetCellContainerPosX(),y=this.GetCellContainerPosY(),N.$assign(this.GetContentRect()),this.FDoTouchScroll=this.FOptions.FMouse.FTouchScrolling&&(1===this.FOptions.FSelection.FMode||2===this.FOptions.FSelection.FMode||3===this.FOptions.FSelection.FMode||0===this.FOptions.FSelection.FMode),n=!1,(-M>0&&this.FX<this.GetFixedWidth()||-M<this.GetTotalContentWidth()-this.GetFixedRightWidth()&&this.FX>N.Right-N.Left-this.GetFixedRightWidth()||-y>0&&this.FY<this.GetFixedHeight()||-y<this.GetTotalContentHeight()-this.GetFixedFooterHeight()&&this.FY>N.Bottom-N.Top-this.GetFixedFooterHeight())&&(n=this.FOptions.FMouse.FAutoScrolling&&!this.FDoTouchScroll),this.FX>N.Right-N.Left-this.GetFixedRightWidth()&&(n=!(1 in this.FOptions.FMouse.FFixedCellSelection)&&!(3 in this.FOptions.FMouse.FFixedCellSelection)),this.FY>N.Bottom-N.Top-this.GetFixedFooterHeight()&&(n=!(2 in this.FOptions.FMouse.FFixedCellSelection)&&!(4 in this.FOptions.FMouse.FFixedCellSelection)),this.FScrollTimer.SetEnabled(n),!this.FScrollTimer.FEnabled)if(this.FOptions.FMouse.FTouchScrolling&&this.FDoTouchScroll)L=this.FOptions.FMouse.FTouchScrollingSensitivity,1===this.FScrollMode&&(L/=10),(this.FTouchScrolling$1||Math.abs(this.FMouseX$1-e)>3||Math.abs(this.FMouseY$1-i)>3)&&(Math.abs(e-this.FTouchX)>0||Math.abs(i-this.FTouchY)>0)&&(this.FTouchScrolling$1=!0,this.FDoubleSelection$1=!1,this.FIsMouseDown&&!this.FMouseScrollingUp&&(G=this.GetHVisible()?this.GetHScrollValue()-(e-this.FTouchX)*L:0,A=this.GetVVisible()?this.GetVScrollValue()-(i-this.FTouchY)*L:0,this.Scroll(G,A),this.FTouchY=i,this.FTouchX=e));else if(this.FMouseDragging=!0,o.$assign(this.XYToCell(e,i)),-1!==o.Col&&-1!==o.Row){b=this.IsFixed(o.Col,o.Row);var w=this.FOptions.FSelection.FMode;2===w?1 in this.FOptions.FMouse.FFixedCellSelection&&(b=!1):3===w?2 in this.FOptions.FMouse.FFixedCellSelection&&(b=!1):5===w?3 in this.FOptions.FMouse.FFixedCellSelection&&(b=!1):6===w&&4 in this.FOptions.FMouse.FFixedCellSelection&&(b=!1),b||this.SelectCell(pas["WEBLib.TMSFNCGridData"].TTMSFNCGridCellRec.$clone(o),rtl.refSet(t),this.FMouseDragging)}}else if(this.FMouseSizing){if(-1!==this.FDragCell.Col&&-1!==this.FDragCell.Col){this.HideEdit(!1,!1);var $=this.FSizeMode;0===$?(m=this.GetColWidths(this.FDragCell.Col)+(this.FX-this.FSizeX),this.DoColumnSize(this.FDragCell.Col,{get:function(){return m},set:function(t){m=t}}),this.SetColWidths(this.FDragCell.Col,m)):1===$?(m=this.GetRowHeights(this.FDragCell.Row)+(this.FY-this.FSizeY),this.DoRowSize(this.FDragCell.Row,{get:function(){return m},set:function(t){m=t}}),this.SetRowHeights(this.FDragCell.Row,m)):2===$?(m=this.GetColWidths(this.FDragCell.Col-1)+(this.FX-this.FSizeX),this.DoColumnSize(this.FDragCell.Col-1,{get:function(){return m},set:function(t){m=t}}),this.SetColWidths(this.FDragCell.Col-1,m)):3===$&&(m=this.GetRowHeights(this.FDragCell.Row-1)+(this.FY-this.FSizeY),this.DoRowSize(this.FDragCell.Row-1,{get:function(){return m},set:function(t){m=t}}),this.SetRowHeights(this.FDragCell.Row-1,m)),this.FSizeX=this.FX,this.FSizeY=this.FY,this.UpdateControl(!0,!0),this.FSizing=!0}}else a=e,l=i,o.$assign(this.XYToCell(e,i)),-1!==o.Col&&-1!==o.Row?null!=(r=this.GetCellObject(pas["WEBLib.TMSFNCGridData"].TTMSFNCGridCellRec.$clone(this.GetDisplayCell(pas["WEBLib.TMSFNCGridData"].TTMSFNCGridCellRec.$clone(o)))))&&(h=this.IsFixed(o.Col,o.Row),null!=this.FToolBarPopup&&3!==this.FToolBarPopupMode&&(0===this.FToolBarPopupMode&&(o.Col!==this.GetFocusedCell().Col||o.Row!==this.GetFocusedCell().Row||this.FToolBarPopup.Activated()||P(),o.Col===this.GetFocusedCell().Col&&o.Row===this.GetFocusedCell().Row||null==this.FToolBarPopup||!this.FToolBarPopup.Activated()||this.FToolBarPopup.DropDownActive()||this.FToolBarPopup.Deactivate()),this.FToolBarPopupMode in rtl.createSet(1,2)&&(o.Col===this.FToolBarPopupCell.Col&&o.Row===this.FToolBarPopupCell.Row||this.FToolBarPopup.Activated()||h&&1!==this.FToolBarPopupMode||P(),o.Col===this.FToolBarPopupCell.Col&&o.Row===this.FToolBarPopupCell.Row||!this.FToolBarPopup.Activated()||this.FToolBarPopup.DropDownActive()||this.FToolBarPopup.Deactivate())),h?(F=this.FOptions.FMouse.FFixedRowSizing,p=this.FOptions.FMouse.FFixedColumnSizing):(F=this.FOptions.FMouse.FRowSizing,p=this.FOptions.FMouse.FColumnSizing),F&&o.Row>this.FFixedRows&&l<=r.FTop+this.FOptions.FMouse.FRowSizeMargin&&a>r.FLeft+this.FOptions.FMouse.FColumnSizeMargin&&a<r.FLeft+r.FWidth-this.FOptions.FMouse.FColumnSizeMargin?(d=!0,this.DoCanSizeRow(o.Row-1,{get:function(){return d},set:function(t){d=t}}),d&&this.UpdateCursor(7)):F&&(o.Row<this.GetRowCount()-this.FFixedRows&&h||!h)&&l>=r.FTop+r.FHeight-this.FOptions.FMouse.FRowSizeMargin&&a>r.FLeft+this.FOptions.FMouse.FColumnSizeMargin&&a<r.FLeft+r.FWidth-this.FOptions.FMouse.FColumnSizeMargin?(d=!0,this.DoCanSizeRow(o.Row,{get:function(){return d},set:function(t){d=t}}),d&&this.UpdateCursor(7)):p&&o.Col>this.FFixedColumns&&a<=r.FLeft-this.FOptions.FMouse.FColumnSizeMargin&&l>r.FTop+this.FOptions.FMouse.FRowSizeMargin&&l<r.FTop+r.FHeight-this.FOptions.FMouse.FRowSizeMargin?(d=!0,this.DoCanSizeColumn(o.Col-1,{get:function(){return d},set:function(t){d=t}}),d&&this.UpdateCursor(9)):p&&(o.Col<this.GetColumnCount()-this.FFixedColumns&&h||!h)&&a>=r.FLeft+r.FWidth-this.FOptions.FMouse.FColumnSizeMargin&&l>r.FTop+this.FOptions.FMouse.FRowSizeMargin&&l<r.FTop+r.FHeight-this.FOptions.FMouse.FRowSizeMargin?(d=!0,this.DoCanSizeColumn(o.Col,{get:function(){return d},set:function(t){d=t}}),d&&this.UpdateCursor(9)):pas["WEBLib.TMSFNCGridCell"].TTMSFNCGridCell.isPrototypeOf(r)&&(B=!1,E=this.OldCursor,rtl.as(r,pas["WEBLib.TMSFNCGridCell"].TTMSFNCGridCell).HandleMouseMove(rtl.refSet(t),e,i,{get:function(){return B},set:function(t){B=t}},{get:function(){return E},set:function(t){E=t}}),B&&(this.UpdateCursor(E),this.Invalidate()),B||(rtl.as(r,pas["WEBLib.TMSFNCGridCell"].TTMSFNCGridCell).IsHTML()?this.FCellAnchorString=rtl.as(r,pas["WEBLib.TMSFNCGridCell"].TTMSFNCGridCell).XYToAnchor(e,i):(this.FCellAnchorString=rtl.as(r,pas["WEBLib.TMSFNCGridCell"].TTMSFNCGridCell).FText,pas["WEBLib.TMSFNCGridDataUtil"].IsURL(this.FCellAnchorString)||(this.FCellAnchorString="")),""!==this.FCellAnchorString&&this.FOptions.FURL.FShow?this.UpdateCursor(21):this.UpdateCursor(this.OldCursor)))):this.UpdateCursor(this.OldCursor)},this.HandleMouseUp=function(t,i,s,o){var n=pas["WEBLib.TMSFNCGridData"].TTMSFNCGridCellRec.$new(),r=!1,a=null,l=!1,h=!1,F=!1,p=0;if(pas["WEBLib.TMSFNCCustomScrollControl"].TTMSFNCCustomScrollControl.HandleMouseUp.apply(this,arguments),this.HideEdit(!1,!0))if(this.ReleaseCaptureEx(),0===t){if(this.FIsMouseDown){if(this.FMouseScrollingUp=!0,this.FIsMouseDown=!1,this.FScrollTimer.SetEnabled(!1),this.FDragTimer.SetEnabled(!1),this.FSizing){var c=this.FSizeMode;0===c?this.DoColumnSized(this.FDragCell.Col,this.GetColWidths(this.FDragCell.Col)):1===c?this.DoRowSized(this.FDragCell.Row,this.GetRowHeights(this.FDragCell.Row)):2===c?this.DoColumnSized(this.FDragCell.Col-1,this.GetColWidths(this.FDragCell.Col-1)):3===c&&this.DoRowSized(this.FDragCell.Row-1,this.GetRowHeights(this.FDragCell.Row-1)),this.UpdateControl(!0,!0)}if(null!=this.FDragBitmap&&(this.FDragBitmap.SetParent(null),rtl.free(this,"FDragBitmap"),this.FDragBitmap=null),!this.FDoubleSelection$1&&this.FOptions.FMouse.FTouchScrolling&&this.FDoTouchScroll&&(p=this.FOptions.FMouse.FTouchScrollingSensitivity,1===this.FScrollMode&&(p/=10),this.FTimeStop$1=e.GetTickCountX(),this.FTimeStop$1-this.FTimeStart$1<300&&this.FTimeStop$1-this.FTimeStart$1>0&&(this.FSpY$1=Math.abs(o-this.FScrollY$1)/(this.FTimeStop$1-this.FTimeStart$1),this.FSpY$1>0&&(this.GetVVisible()?o-this.FScrollY$1>0?this.FScrollVTo$1=Math.max(0,Math.min(this.GetVMax()-this.GetVViewPortSize(),this.FScrollVTo$1-Math.round(Math.abs(o-this.FScrollY$1)*this.FSpY$1*p*3))):this.FScrollVTo$1=Math.max(0,Math.min(this.GetVMax()-this.GetVViewPortSize(),this.FScrollVTo$1+Math.round(Math.abs(o-this.FScrollY$1)*this.FSpY$1*p*3))):this.FScrollVTo$1=0,this.FAnimateVerticalPos$1=!0,this.FAnimateTimer$1.SetEnabled(!0)),this.FSpX$1=Math.abs(s-this.FScrollX$1)/(this.FTimeStop$1-this.FTimeStart$1),this.FSpX$1>0&&(this.GetHVisible()?s-this.FScrollX$1>0?this.FScrollHTo$1=Math.max(0,Math.min(this.GetHMax()-this.GetHViewPortSize(),this.FScrollHTo$1-Math.round(Math.abs(s-this.FScrollX$1)*this.FSpX$1*p*3))):this.FScrollHTo$1=Math.max(0,Math.min(this.GetHMax()-this.GetHViewPortSize(),this.FScrollHTo$1+Math.round(Math.abs(s-this.FScrollX$1)*this.FSpX$1*p*3))):this.FScrollHTo$1=0,this.FAnimateHorizontalPos$1=!0,this.FAnimateTimer$1.SetEnabled(!0)))),h=!1,this.FMouseUp$1&&(n.$assign(this.XYToCell(s,o)),-1!==n.Col&&-1!==n.Row&&(null!=(a=this.GetCellObject(pas["WEBLib.TMSFNCGridData"].TTMSFNCGridCellRec.$clone(this.GetDisplayCell(pas["WEBLib.TMSFNCGridData"].TTMSFNCGridCellRec.$clone(n)))))&&(this.FCellAnchor.Col=-1,this.FCellAnchor.Row=-1,pas["WEBLib.TMSFNCGridCell"].TTMSFNCGridCell.isPrototypeOf(a)&&!this.FMouseDragging&&(h=!1,rtl.as(a,pas["WEBLib.TMSFNCGridCell"].TTMSFNCGridCell).HandleMouseUp(t,rtl.refSet(i),s,o,{get:function(){return h},set:function(t){h=t}}),h&&this.Invalidate(),rtl.as(a,pas["WEBLib.TMSFNCGridCell"].TTMSFNCGridCell).IsHTML()?this.FCellAnchorString=rtl.as(a,pas["WEBLib.TMSFNCGridCell"].TTMSFNCGridCell).XYToAnchor(s,o):(this.FCellAnchorString=rtl.as(a,pas["WEBLib.TMSFNCGridCell"].TTMSFNCGridCell).FText,pas["WEBLib.TMSFNCGridDataUtil"].IsURL(this.FCellAnchorString)&&this.FOptions.FURL.FShow||(this.FCellAnchorString="")),""!==this.FCellAnchorString&&this.FCellAnchor.$assign(n))),!h)))if(-1===this.FCellAnchor.Col&&-1===this.FCellAnchor.Row&&""===this.FCellAnchorString){l=this.IsFixed(n.Col,n.Row);var u=this.FOptions.FSelection.FMode;4===u?0 in this.FOptions.FMouse.FFixedCellSelection&&n.Col<this.FFixedColumns&&n.Row<this.FFixedRows&&(l=!1):2===u?1 in this.FOptions.FMouse.FFixedCellSelection&&(l=!1):3===u?2 in this.FOptions.FMouse.FFixedCellSelection&&(l=!1):5===u?3 in this.FOptions.FMouse.FFixedCellSelection&&(l=!1):6===u?4 in this.FOptions.FMouse.FFixedCellSelection&&(l=!1):7===u?5 in this.FOptions.FMouse.FFixedCellSelection&&(l=!1):8===u&&6 in this.FOptions.FMouse.FFixedCellSelection&&(l=!1),l||this.FDragFixed||this.FTouchScrolling$1?2===this.FDraggingMode?(F=!0,this.DoBeforeColumnDrop(this.FDragCell.Col,{p:n,get:function(){return this.p.Col},set:function(t){this.p.Col=t}},{get:function(){return F},set:function(t){F=t}}),F&&(this.BeginUpdate(),this.MoveColumn(this.FDragCell.Col,n.Col),this.EndUpdate(),this.DoColumnDragged(this.FDragCell.Col,n.Col))):1===this.FDraggingMode?(F=!0,this.DoBeforeRowDrop(this.FDragCell.Row,{p:n,get:function(){return this.p.Row},set:function(t){this.p.Row=t}},{get:function(){return F},set:function(t){F=t}}),F&&(this.BeginUpdate(),this.MoveRow(this.FDragCell.Row,n.Row),this.EndUpdate(),this.DoRowDragged(this.FDragCell.Row,n.Row))):this.DoFixedCellClick(rtl.refSet(i),n.Col,n.Row):(this.SelectCell(pas["WEBLib.TMSFNCGridData"].TTMSFNCGridCellRec.$clone(n),rtl.refSet(i),this.FMouseDragging),this.DoCellClick(n.Col,n.Row),!this.FMouseDragging&&this.FOptions.FMouse.FDirectEdit&&(r=!0,this.DoCanEditCell(this.GetFocusedCell().Col,this.GetFocusedCell().Row,{get:function(){return r},set:function(t){r=t}}),r&&this.EditCell(pas["WEBLib.TMSFNCGridData"].TTMSFNCGridCellRec.$clone(this.GetFocusedCell()),0,!1,"",0)))}else this.DoCellAnchorClick(this.FCellAnchor.Col,this.FCellAnchor.Row,this.FCellAnchorString);this.FTouchScrolling$1=!1,this.FDraggingMode=0,this.FDragFixed=!1,this.FFirstCell.Row=-1,this.FFirstCell.Col=-1,this.FMouseDown=!1,this.FMouseUp$1=!1,this.FMouseDragging=!1,this.FMouseDblClick=this.FMouseSizing,this.FMouseSizing=!1,this.FSizing=!1}}else 1===t&&(n.$assign(this.XYToCell(s,o)),-1!==n.Col&&-1!==n.Row&&((l=this.IsFixed(n.Col,n.Row))?this.DoFixedCellRightClick(n.Col,n.Row):this.DoCellRightClick(n.Col,n.Row)))},this.HandleMouseWheel=function(t,e,i){var s=pas["WEBLib.TMSFNCGridData"].TTMSFNCGridCellRec.$new(),o=pas["WEBLib.TMSFNCGridData"].TTMSFNCGridCellRec.$new(),n=0;pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleMouseWheel.apply(this,arguments),2 in t||this.FOptions.FMouse.FWheelScrollKeepSelection?(e>0?this.SetTopRow(this.GetTopRow()-this.FOptions.FMouse.FWheelScrollSize):this.SetTopRow(this.GetTopRow()+this.FOptions.FMouse.FWheelScrollSize),n=this.GetTopRow(),o.$assign(this.BaseCell(this.GetLeftCol(),n)),this.SetTopRow(o.Row)):(s.$assign(this.GetFocusedCell()),s.Row=e>0?s.Row-this.FOptions.FMouse.FWheelScrollSize:s.Row+this.FOptions.FMouse.FWheelScrollSize,o.$assign(this.BaseCell(s.Col,s.Row)),s.$assign(o),this.CancelEdit(),this.SelectCell(pas["WEBLib.TMSFNCGridData"].TTMSFNCGridCellRec.$clone(s),rtl.refSet(t),!1)),i.set(!0)},this.HandleKeyDown=function(t,e){var i=pas["WEBLib.TMSFNCGridData"].TTMSFNCGridCellRec.$new(),s=pas["WEBLib.TMSFNCGridData"].TTMSFNCGridCellRec.$new(),o=0,n=0,r=0,a=0,l=!1;if(9!==t.get())if(pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleKeyDown.apply(this,arguments),t.get()in rtl.createSet(27,45,46,38,40,37,39,36,35,33,34,9)&&(this.FLookupString=""),!this.FOptions.FEditing.FEnabled||(l=!0,this.DoCanEditCell(this.GetFocusedCell().Col,this.GetFocusedCell().Row,{get:function(){return l},set:function(t){l=t}}),!l||113!==t.get()&&13!==t.get())){if(32===t.get())return t.set(32),void(-1!==this.GetFocusedCell().Row&&-1!==this.GetFocusedCell().Col&&this.DoCellKeyDown(this.GetFocusedCell().Col,this.GetFocusedCell().Row,t,rtl.refSet(e)));if(this.FPrevSelectedCell.$assign(this.GetFocusedCell()),!(0 in e)||2 in e||1 in e||45!==t.get()||this.FEditing||!this.FOptions.FClipboard.FEnabled||this.PasteFromClipboard(),!(2 in e)||0 in e||1 in e){i.$assign(this.GetFocusedCell()),s.$assign(this.FRealCell);var h=t.get();if(46===h)rtl.eqSet(e,{})&&1===this.FOptions.FKeyboard.FDeleteKeyHandling&&this.GetRowCount()>this.FFixedRows+this.FFixedFooterRows&&(l=!0,this.DoCanDeleteRow(i.Row,{get:function(){return l},set:function(t){l=t}}),l&&(this.DeleteRow(i.Row),i.Row=Math.max(this.FFixedRows,Math.min(i.Row,this.GetRowCount()-1-this.FFixedFooterRows)),this.DoDeleteRow(i.Row)));else if(45===h){if(rtl.eqSet(e,{})){-1===i.Row&&(i.Row=this.FFixedRows-1);var F=this.FOptions.FKeyboard.FInsertKeyHandling;1===F?(l=!0,this.DoCanInsertRow(i.Row,{get:function(){return l},set:function(t){l=t}}),l&&(this.InsertRow(i.Row),i.Row=Math.max(this.FFixedRows,Math.min(i.Row,this.GetRowCount()-1-this.FFixedFooterRows)),this.DoInsertRow(i.Row))):2===F&&(l=!0,this.DoCanInsertRow(i.Row,{get:function(){return l},set:function(t){l=t}}),l&&(this.InsertRow(i.Row+1),i.Row=Math.max(this.FFixedRows,Math.min(i.Row+1,this.GetRowCount()-1-this.FFixedFooterRows)),this.DoInsertRow(i.Row)))}}else 34===h?(i.$assign(this.NextSelectableRow(i.Col,i.Row+this.GetPageScrollSize()-1)),i.Col=s.Col):33===h?(i.$assign(this.PreviousSelectableRow(i.Col,i.Row-this.GetPageScrollSize()+1)),i.Col=s.Col):38===h?(i.$assign(this.PreviousSelectableRow(i.Col,i.Row)),i.Col=s.Col):40===h?(i.$assign(this.NextSelectableRow(i.Col,i.Row)),i.Col=s.Col):37===h?(i.$assign(this.PreviousSelectableColumn(i.Col,i.Row)),i.Row=s.Row):39===h?(i.$assign(this.NextSelectableColumn(i.Col,i.Row)),i.Row=s.Row):36===h?1 in e?(i.Row=this.FFixedRows,i.Col=s.Col,i.$assign(this.NextSelectableRow(i.Col,i.Row-1))):(i.Col=this.FFixedColumns,i.Row=s.Row,i.$assign(this.NextSelectableColumn(i.Col-1,i.Row))):35===h&&(1 in e?(i.Row=this.GetRowCount()-1-this.FFixedFooterRows,i.Col=s.Col,i.$assign(this.PreviousSelectableRow(i.Col,i.Row+1))):(i.Col=this.GetColumnCount()-1-this.FFixedRightColumns,i.Row=s.Row,i.$assign(this.PreviousSelectableColumn(i.Col+1,i.Row))));var p=t.get();38!==p&&37!==p&&40!==p&&39!==p&&36!==p&&35!==p&&34!==p&&33!==p&&46!==p&&45!==p||(2 in e?this.Navigate(pas["WEBLib.TMSFNCGridData"].TTMSFNCGridCellRec.$clone(i),!1):this.SelectCell(pas["WEBLib.TMSFNCGridData"].TTMSFNCGridCellRec.$clone(i),rtl.refSet(e),!1),t.set(0))}else{var c=t.get();if(77===c)this.FOptions.FKeyboard.FAllowCellMergeShortCut&&this.MergeSelection(pas["WEBLib.TMSFNCGridData"].TTMSFNCGridCellRecRange.$clone(this.GetSelection()));else if(83===c)this.FOptions.FKeyboard.FAllowCellMergeShortCut&&this.SplitCell(this.GetSelection().StartCol,this.GetSelection().StartRow);else if(88===c)this.FOptions.FClipboard.FEnabled&&!this.FEditing&&this.CutToClipboard(!0);else if(67===c)this.FOptions.FClipboard.FEnabled&&!this.FEditing&&this.CopyToClipboard(!0);else if(86===c)this.FOptions.FClipboard.FEnabled&&!this.FEditing&&this.PasteFromClipboard();else if(65===c){if(this.FOptions.FSelection.FMode in rtl.createSet(4,5,6,9,8,7)&&(this.SetStartCell(this.FFixedColumns,this.FFixedRows),this.SetStopCell(this.GetColumnCount()-1-this.FFixedRightColumns,this.GetRowCount()-1-this.FFixedFooterRows),this.SetFocusCell(this.FFixedColumns,this.FFixedRows)),this.FOptions.FSelection.FMode in rtl.createSet(7)){this.FBlockUpdate=!0;for(var u=this.FFixedRows,C=this.GetRowCount()-this.FFixedFooterRows-1;u<=C;u++)r=u,this.SetRowSelect(r,!0);this.FBlockUpdate=!1}if(this.FOptions.FSelection.FMode in rtl.createSet(8)){this.FBlockUpdate=!0;for(var T=this.FFixedColumns,S=this.GetColumnCount()-1-this.FFixedRightColumns;T<=S;T++)r=T,this.SetColumnSelect(r,!0);this.FBlockUpdate=!1}if(this.FOptions.FSelection.FMode in rtl.createSet(9)){this.FBlockUpdate=!0;for(var d=this.FFixedColumns,m=this.GetColumnCount()-1-this.FFixedRightColumns;d<=m;d++){r=d;for(var f=this.FFixedRows,g=this.GetRowCount()-this.FFixedFooterRows-1;f<=g;f++)a=f,this.SetCellSelect(r,a,!0)}this.FBlockUpdate=!1}this.Navigate(pas["WEBLib.TMSFNCGridData"].TTMSFNCGridCellRec.$clone(this.GetFocusedCell()),!1),null!=this.FOnSelectedCell&&this.FOnSelectedCell(this,this.GetFocusedCell().Col,this.GetFocusedCell().Row)}else 46===c?this.FOptions.FClipboard.FEnabled&&this.CutToClipboard(!0):45===c?this.FOptions.FClipboard.FEnabled&&this.CopyToClipboard(!0):34===c?this.SetTopRow(this.GetTopRow()+this.GetPageScrollSize()):33===c?this.SetTopRow(this.GetTopRow()-this.GetPageScrollSize()):38===c?this.SetTopRow(this.GetTopRow()-1):40===c?(n=this.RowSpan(this.GetLeftCol(),this.GetTopRow()))>0?this.SetTopRow(this.GetTopRow()+n):this.SetTopRow(this.GetTopRow()+1):37===c?this.SetLeftCol(this.GetLeftCol()-1):39===c?(o=this.ColSpan(this.GetLeftCol(),this.GetTopRow()))>0?this.SetLeftCol(this.GetLeftCol()+o):this.SetLeftCol(this.GetLeftCol()+1):36===c?this.SetTopRow(this.FFixedRows):35===c&&this.SetTopRow(this.GetRowCount()-1-this.FFixedFooterRows)}}else this.EditCell(pas["WEBLib.TMSFNCGridData"].TTMSFNCGridCellRec.$clone(this.GetFocusedCell()),0,!1,"",0)},this.HandleKeyPress=function(t){var e=!1,i=0;if(pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleKeyPress.apply(this,arguments),!((i=t.get().charCodeAt())in rtl.createSet(9)))return!this.FOptions.FEditing.FEnabled&&this.FOptions.FLookup.FEnabled&&(i in rtl.createSet(27,45,46,38,40,37,39,36,35,33,34,9)?this.FLookupString="":(this.FOptions.FLookup.FIncremental?this.FLookupString=this.FLookupString+t.get():this.FLookupString=t.get(),this.LookupInColumn(this.GetFocusedCell().Col,this.FLookupString,!0,!0))),this.FOptions.FEditing.FEnabled&&(e=!0,this.DoCanEditCell(this.GetFocusedCell().Col,this.GetFocusedCell().Row,{get:function(){return e},set:function(t){e=t}}),e&&i>=32)?(this.EditCell(pas["WEBLib.TMSFNCGridData"].TTMSFNCGridCellRec.$clone(this.GetFocusedCell()),1,!0,t.get(),t.get().charCodeAt()),void t.set("\0")):void 0},this.HandleDialogKey=function(t,e){this.FTabKey=0,9===t.get()&&2===this.FOptions.FKeyboard.FTabKeyHandling&&(this.FTabKey=0 in e?2:1),(this.IsFocused()||null!==this.FEditControl&&this.FEditControl.IsFocused())&&this.ProcessTab(t,rtl.refSet(e),this.FOptions.FKeyboard.FTabKeyDirection,this.FOptions.FKeyboard.FTabKeyHandling,this.FOptions.FKeyboard.FTabKeyDirectEdit,0),pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleDialogKey.apply(this,arguments)},this.HandleFilterListClick=function(t){this.FFilterTimer.SetEnabled(!0)},this.HandleFilterTimer=function(e){var i=null,s="",o=0,n=0,r=!1;if(this.FFilterTimer.SetEnabled(!1),null!=this.FFilterListBox){if(n=this.FFilterListBox.FTag$1,this.FOptions.FFiltering.FMultiColumn)for(var a=this.FFilter.GetCount()-1;a>=0;a--)o=a,this.FFilter.GetItem$1(o).FColumn===n&&this.FFilter.Delete(o);else this.FFilter.Clear();(i=this.FFilter.Add$1()).FColumn=n,s="",this.FFilterListBox.GetItemIndex()>=0&&this.FFilterListBox.GetItemIndex()<=this.FFilterListBox.FItems.GetCount()-1&&(s=this.FFilterListBox.FItems.Get(this.FFilterListBox.GetItemIndex())),pas.System.Pos(" ",s)>0&&(s='"'+s+'"'),this.FFilterPopup.SetIsOpen(!1),s===rtl.getResStr(t,"sTMSFNCGridFilterAll")?(this.FBlockUpdate=!0,this.UnHideRowsAll(),this.FBlockUpdate=!1,this.FFilter.Clear(),this.ApplyFilter()):(this.DoFilterSelect(i.FColumn,{get:function(){return s},set:function(t){s=t}}),i.FCondition=s,this.FBlockUpdate=!0,this.UnHideRowsAll(),this.FBlockUpdate=!1,this.ApplyFilter()),r=!1,this.DoAfterApplyFilter(i.FColumn,s,{get:function(){return r},set:function(t){r=t}}),r&&(this.BeginUpdate(),this.UpdateCalculations(),this.EndUpdate())}},this.HandleKeyUp=function(t,e){9!==t.get()&&(pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleKeyUp.apply(this,arguments),32===t.get()&&(t.set(32),-1!==this.GetFocusedCell().Row&&-1!==this.GetFocusedCell().Col&&this.DoCellKeyUp(this.GetFocusedCell().Col,this.GetFocusedCell().Row,t,rtl.refSet(e))))},this.DoCellKeyDown=function(t,e,i,s){var o=pas["WEBLib.TMSFNCGridData"].TTMSFNCGridCellRec.$new();(o.Col=t,o.Row=e,null!=this.GetCellObject(pas["WEBLib.TMSFNCGridData"].TTMSFNCGridCellRec.$clone(this.GetDisplayCell(pas["WEBLib.TMSFNCGridData"].TTMSFNCGridCellRec.$clone(o)))))&&(32===i.get()&&(this.FCellKeyDown=!0))},this.DoCellKeyUp=function(t,e,i,s){var o,n=pas["WEBLib.TMSFNCGridData"].TTMSFNCGridCellRec.$new();(n.Col=t,n.Row=e,null!=(o=this.GetCellObject(pas["WEBLib.TMSFNCGridData"].TTMSFNCGridCellRec.$clone(this.GetDisplayCell(pas["WEBLib.TMSFNCGridData"].TTMSFNCGridCellRec.$clone(n))))))&&(32===i.get()&&(this.FCellKeyDown&&!this.IsReadOnly(n.Col,n.Row)&&(pas["WEBLib.TMSFNCGridCell"].TTMSFNCCheckGridCell.isPrototypeOf(o)?rtl.as(o,pas["WEBLib.TMSFNCGridCell"].TTMSFNCCheckGridCell).SetChecked(!rtl.as(o,pas["WEBLib.TMSFNCGridCell"].TTMSFNCCheckGridCell).FChecked):pas["WEBLib.TMSFNCGridCell"].TTMSFNCRadioGridCell.isPrototypeOf(o)&&rtl.as(o,pas["WEBLib.TMSFNCGridCell"].TTMSFNCRadioGridCell).SetChecked(!rtl.as(o,pas["WEBLib.TMSFNCGridCell"].TTMSFNCRadioGridCell).FChecked)),this.FCellKeyDown=!1))},this.ProcessTab=function(t,e,i,s,o,n){var r=pas["WEBLib.TMSFNCGridData"].TTMSFNCGridCellRec.$new(),a=pas["WEBLib.TMSFNCGridData"].TTMSFNCGridCellRec.$new(),l=pas["WEBLib.TMSFNCGridData"].TTMSFNCGridCellRec.$new(),h=0,F=0,p=!1,c=pas["WEBLib.TMSFNCGridData"].TTMSFNCGridCellRec.$new();if(9===t.get()&&this.GetRowCount()>this.FFixedRows+this.FFixedFooterRows&&this.GetColumnCount()>this.FFixedColumns+this.FFixedRightColumns){if(c.$assign(this.GetFocusedCell()),!this.HideEdit(!1,!1))return;if(this.SetFocusedCell(c),this.IsFocused()){var u=s;if(1===u)t.set(0);else if(2===u)if(0 in e){if(r.Col=this.FFixedColumns,r.Row=this.FFixedRows,this.IsNormalFixed(r.Col,r.Row)){var C=i;0===C?r.$assign(this.NextSelectableColumn(r.Col,r.Row)):1===C&&r.$assign(this.NextSelectableRow(r.Col,r.Row))}2!==s||this.GetFocusedCell().Col===r.Col&&this.GetFocusedCell().Row===r.Row||t.set(0)}else{if(r.Col=this.GetColumnCount()-1-this.FFixedRightColumns,r.Row=this.GetRowCount()-1-this.FFixedFooterRows,this.IsNormalFixed(r.Col,r.Row)){var T=i;0===T?r.$assign(this.PreviousSelectableColumn(r.Col,r.Row)):1===T&&r.$assign(this.PreviousSelectableRow(r.Col,r.Row))}2!==s||this.GetFocusedCell().Col===r.Col&&this.GetFocusedCell().Row===r.Row||t.set(0)}if(0===t.get()){if(1===s||2===s)if(r.$assign(this.GetFocusedCell()),l.$assign(this.FRealCell),r.$assign(this.BaseCell(r.Col,r.Row)),0 in e){if(a.$assign(pas["WEBLib.TMSFNCGridData"].MakeCell(this.FFixedColumns,this.FFixedRows)),this.GetFocusedCell().Col===a.Col&&this.GetFocusedCell().Row===a.Row)return a.$assign(pas["WEBLib.TMSFNCGridData"].MakeCell(this.GetColumnCount()-1-this.FFixedRightColumns,this.GetRowCount()-1-this.FFixedFooterRows)),void this.SetFocusedCell(a);var S=i;if(0===S){if(h=r.Col,r.$assign(this.PreviousSelectableColumn(r.Col,r.Row)),r.Row=l.Row,h===r.Col){if(F=r.Row,r.Col=this.GetColumnCount()-1-this.FFixedRightColumns,r.$assign(this.PreviousSelectableColumn(r.Col,r.Row)),F===r.Row)for(r.$assign(this.PreviousSelectableColumn(this.GetColumnCount()-this.FFixedRightColumns,r.Row-1));r.Col===this.GetColumnCount()-this.FFixedRightColumns&&r.Row===F-1;)F=r.Row,r.$assign(this.PreviousSelectableColumn(this.GetColumnCount()-this.FFixedRightColumns,r.Row-1));1===s&&(r.Row<this.FFixedRows||F===r.Row)&&(r.Col=this.GetColumnCount()-1-this.FFixedRightColumns,r.Row=this.GetRowCount()-1-this.FFixedFooterRows,r.$assign(this.PreviousSelectableColumn(r.Col,r.Row)))}}else if(1===S&&(F=r.Row,r.$assign(this.PreviousSelectableRow(r.Col,r.Row)),r.Col=l.Col,F===r.Row)){if(h=r.Col,r.Row=this.GetRowCount()-1-this.FFixedFooterRows,r.$assign(this.PreviousSelectableRow(r.Col,r.Row)),h===r.Col)for(r.$assign(this.PreviousSelectableRow(r.Col-1,this.GetRowCount()-this.FFixedFooterRows));r.Row===this.GetRowCount()-this.FFixedFooterRows&&r.Col===h-1;)h=r.Col,r.$assign(this.PreviousSelectableRow(r.Col-1,this.GetRowCount()-this.FFixedFooterRows));1===s&&(r.Col<this.FFixedColumns||h===r.Col)&&(r.Col=this.GetColumnCount()-1-this.FFixedRightColumns,r.Row=this.GetRowCount()-1-this.FFixedFooterRows,r.$assign(this.PreviousSelectableRow(r.Col,r.Row)))}this.SelectCell(pas["WEBLib.TMSFNCGridData"].TTMSFNCGridCellRec.$clone(r),{},!1),o&&(p=!0,this.DoCanEditCell(this.GetFocusedCell().Col,this.GetFocusedCell().Row,{get:function(){return p},set:function(t){p=t}}),p&&this.EditCell(pas["WEBLib.TMSFNCGridData"].TTMSFNCGridCellRec.$clone(this.GetFocusedCell()),n,!1,"",0))}else{if(a.$assign(pas["WEBLib.TMSFNCGridData"].MakeCell(this.GetColumnCount()-1-this.FFixedRightColumns,this.GetRowCount()-1-this.FFixedFooterRows)),this.GetFocusedCell().Col===a.Col&&this.GetFocusedCell().Row===a.Row)return a.$assign(pas["WEBLib.TMSFNCGridData"].MakeCell(this.FFixedColumns,this.FFixedRows)),void this.SetFocusedCell(a);var d=i;if(0===d){if(h=r.Col,r.$assign(this.NextSelectableColumn(r.Col,r.Row)),r.Row=l.Row,h===r.Col){if(F=r.Row,r.Col=this.FFixedColumns,r.$assign(this.NextSelectableColumn(r.Col,r.Row)),F===r.Row)for(r.$assign(this.NextSelectableColumn(this.FFixedColumns-1,r.Row+1));r.Col===this.FFixedColumns-1&&r.Row===F+1;)F=r.Row,r.$assign(this.NextSelectableColumn(this.FFixedColumns-1,r.Row+1));1===s&&(r.Row>this.GetRowCount()-1-this.FFixedFooterRows||F===r.Row)&&(r.Col=this.FFixedColumns,r.Row=this.FFixedRows,r.$assign(this.NextSelectableColumn(r.Col,r.Row)))}}else if(1===d&&(F=r.Row,r.$assign(this.NextSelectableRow(r.Col,r.Row)),r.Col=l.Col,F===r.Row)){if(h=r.Col,r.Row=this.FFixedRows,r.$assign(this.NextSelectableRow(r.Col,r.Row)),h===r.Col)for(r.$assign(this.NextSelectableRow(r.Col+1,this.FFixedRows-1));r.Row===this.FFixedRows-1&&r.Col===h+1;)h=r.Col,r.$assign(this.NextSelectableRow(r.Col+1,this.FFixedRows-1));1===s&&(r.Col>this.GetColumnCount()-1-this.FFixedRightColumns||h===r.Col)&&(r.Col=this.FFixedColumns,r.Row=this.FFixedRows,r.$assign(this.NextSelectableRow(r.Col,r.Row)))}this.SelectCell(pas["WEBLib.TMSFNCGridData"].TTMSFNCGridCellRec.$clone(r),{},!1),o&&(p=!0,this.DoCanEditCell(this.GetFocusedCell().Col,this.GetFocusedCell().Row,{get:function(){return p},set:function(t){p=t}}),p&&this.EditCell(pas["WEBLib.TMSFNCGridData"].TTMSFNCGridCellRec.$clone(this.GetFocusedCell()),n,!1,"",0))}}}else if(0!==s)if(0 in e){if(r.Col=this.GetColumnCount()-1-this.FFixedRightColumns,r.Row=this.GetRowCount()-1-this.FFixedFooterRows,this.IsNormalFixed(r.Col,r.Row)){var m=i;0===m?r.$assign(this.PreviousSelectableColumn(r.Col,r.Row)):1===m&&r.$assign(this.PreviousSelectableRow(r.Col,r.Row))}this.SelectCell(pas["WEBLib.TMSFNCGridData"].TTMSFNCGridCellRec.$clone(r),{},!1)}else{if(r.Col=this.FFixedColumns,r.Row=this.FFixedRows,this.IsNormalFixed(r.Col,r.Row)){var f=i;0===f?r.$assign(this.NextSelectableColumn(r.Col,r.Row)):1===f&&r.$assign(this.NextSelectableRow(r.Col,r.Row))}this.SelectCell(pas["WEBLib.TMSFNCGridData"].TTMSFNCGridCellRec.$clone(r),{},!1)}}},this.UpdateCursor=function(t){this.ChangeCursor=!1,this.SetC(t),this.ChangeCursor=!0},this.DoExit=function(){pas["WEBLib.Controls"].TControl.DoExit.call(this),this.FClearMouseDown=this.FBlockHide,this.FDblClick=!1,this.FMouseDown=!1,this.FMouseDblClick=!1,this.UpdateGridCellDisplay()},this.DoEnter=function(){var t=pas["WEBLib.TMSFNCGridData"].TTMSFNCGridCellRec.$new();pas["WEBLib.Controls"].TControl.DoEnter.call(this),1===this.FTabKey?this.SetFocusedCell(pas["WEBLib.TMSFNCGridData"].MakeCell(this.FFixedColumns,this.FFixedRows)):2===this.FTabKey?(t.Col=this.GetColumnCount()-1-this.FFixedRightColumns,t.Row=this.GetRowCount()-1-this.FFixedFooterRows,this.SetFocusedCell(t)):this.UpdateGridCellDisplay(),this.FTabKey=0},this.StopAnimationTimer=function(){this.FAnimateTimer$1.SetEnabled(!1),this.FAnimating$1=!1},this.UpdateControlCache=function(){var t=0,e=0,i=0,s=0,o=pas["WEBLib.TMSFNCGridData"].TTMSFNCGridCellRec.$new();if(!(this.FUpdateCount$1>0||this.FBlockUpdate||3 in this.FComponentState)){if(this.FOldSize>0&&this.FOptions.FColumnSize.FSyncWithGrid){t=this.GetWidth()/this.FOldSize,this.FOptions.FColumnSize.FSyncNormalCellsOnly?(e=this.FFixedColumns,i=this.GetColumnCount()-1-this.FFixedRightColumns):(e=0,i=this.GetColumnCount()-1);for(var n=e,r=i;n<=r;n++)s=n,this.FOrigColumnW.GetCount()>s&&this.SetColWidths(s,this.FOrigColumnW.GetItem$1(s).FValue*t)}if(this.FOptions.FColumnSize.FStretch&&this.StretchColumn(this.FOptions.FColumnSize.FStretchColumn,-1),this.UpdateControlScrollBars(!0,!0),this.FContainerWidth=this.GetTotalColumnWidth(),this.FContainerHeight=this.GetTotalRowHeight(),this.UpdateControlScrollBars(!1,!1),this.FOptions.FColumnSize.FStretch&&this.StretchColumn(this.FOptions.FColumnSize.FStretchColumn,-1),this.FContainerWidth=this.GetTotalColumnWidth(),this.FContainerHeight=this.GetTotalRowHeight(),this.GetColumnCount()>this.FFixedColumns&&this.GetRowCount()>this.FFixedRows)if(this.FFirstCellApply){var a=this.FOptions.FSelection.FMode;5===a||2===a||7===a?this.SetStopCell(this.GetColumnCount()-1-this.FFixedRightColumns,this.FStopCell.Row):6!==a&&3!==a&&8!==a||this.SetStopCell(this.FStopCell.Col,this.GetRowCount()-1-this.FFixedFooterRows)}else{o.Col=this.FFixedColumns,o.Row=this.FFixedRows,this.IsNormalFixed(o.Col,o.Row)&&o.$assign(this.NextSelectableColumn(o.Col,o.Row)),this.SetStartCell(o.Col,o.Row),this.SetStopCell(o.Col,o.Row),this.SetFocusCell(o.Col,o.Row),this.FPrevSelectedCell.$assign(this.GetFocusedCell()),this.FSaveCell.$assign(this.GetFocusedCell()),this.FFirstCell.Col=-1,this.FFirstCell.Row=-1,this.FRealCell.$assign(this.GetFocusedCell()),this.FPrevSelection.$assign(this.GetSelection());var l=this.FOptions.FSelection.FMode;5===l||2===l||7===l?this.SetStopCell(this.GetColumnCount()-1-this.FFixedRightColumns,this.FStopCell.Row):6!==l&&3!==l&&8!==l||this.SetStopCell(this.FStopCell.Col,this.GetRowCount()-1-this.FFixedFooterRows),this.FBlockUpdate=!0;var h=this.FOptions.FSelection.FMode;7===h?this.SetRowSelect(this.GetFocusedCell().Row,!0):8===h?this.SetColumnSelect(this.GetFocusedCell().Col,!0):9===h&&this.SetCellSelect(this.GetFocusedCell().Col,this.GetFocusedCell().Row,!0),this.FBlockUpdate=!1,this.FFirstCellApply=!0}else o.Col=-1,o.Row=-1,this.FStartCell.$assign(o),this.FStopCell.$assign(o),this.FFocusedCell.$assign(o),this.FPrevSelectedCell.$assign(this.GetFocusedCell()),this.FSaveCell.$assign(this.GetFocusedCell()),this.FFirstCell.Col=-1,this.FFirstCell.Row=-1,this.FRealCell.$assign(this.GetFocusedCell()),this.FPrevSelection.$assign(this.GetSelection());this.UpdateGridCells(!1)}},this.UpdateControlDisplay=function(){pas["WEBLib.TMSFNCCustomScrollControl"].TTMSFNCCustomScrollControl.UpdateControlDisplay.call(this),this.UpdateGridCellDisplay()},this.VerticalScrollPositionChanged=function(){this.FReset||(this.StopEdit(),this.UpdateGridCells(!0))},this.HorizontalScrollPositionChanged=function(){this.FReset||(this.StopEdit(),this.UpdateGridCells(!0))},this.HideEdit=function(e,i){var s=!1,o="",n=!1,r=pas["WEBLib.TMSFNCGridData"].TTMSFNCGridCellRec.$new(),a=pas["WEBLib.TMSFNCGridData"].TTMSFNCGridCellRec.$new(),l=!1,h=0,F=0,p=0,c=0;if(s=!0,null==this.FEditControl||this.FBlockHide)return s;this.FBlockHide=!0;try{if(null!=this.FEditControl){if(o="",t.TTMSFNCGridEdit.isPrototypeOf(this.FEditControl)?o=rtl.as(this.FEditControl,t.TTMSFNCGridEdit).GetT():t.TTMSFNCGridMemo.isPrototypeOf(this.FEditControl)?o=rtl.as(this.FEditControl,t.TTMSFNCGridMemo).GetText():t.TTMSFNCGridSpinBox.isPrototypeOf(this.FEditControl)?o=rtl.as(this.FEditControl,t.TTMSFNCGridSpinBox).GetText():t.TTMSFNCGridDatePicker.isPrototypeOf(this.FEditControl)?o=pas.SysUtils.DateToStr(rtl.as(this.FEditControl,t.TTMSFNCGridDatePicker).GetDate()):t.TTMSFNCGridColorPicker.isPrototypeOf(this.FEditControl)?F=rtl.as(this.FEditControl,t.TTMSFNCGridColorPicker).GetSelectedColor():t.TTMSFNCGridTrackBar.isPrototypeOf(this.FEditControl)?o=pas.SysUtils.IntToStr(rtl.as(this.FEditControl,t.TTMSFNCGridTrackBar).GetPosition()):t.TTMSFNCGridComboBox.isPrototypeOf(this.FEditControl)&&(o=rtl.as(this.FEditControl,t.TTMSFNCGridComboBox).GetText()),n=!0,t.TTMSFNCGridColorPicker.isPrototypeOf(this.FEditControl)?this.DoCellEditValidateColor(this.FEditCell.Col,this.FEditCell.Row,this.FEditControl,{get:function(){return F},set:function(t){F=t}},{get:function(){return n},set:function(t){n=t}}):this.DoCellEditValidateData(this.FEditCell.Col,this.FEditCell.Row,this.FEditControl,{get:function(){return o},set:function(t){o=t}},{get:function(){return n},set:function(t){n=t}}),i)return s=n;if(n){if(this.FEditing=!1,t.TTMSFNCGridColorPicker.isPrototypeOf(this.FEditControl)?this.DoCellEditSetColor(this.FEditCell.Col,this.FEditCell.Row,this.FEditControl,{get:function(){return F},set:function(t){F=t}}):this.DoCellEditSetData(this.FEditCell.Col,this.FEditCell.Row,this.FEditControl,{get:function(){return o},set:function(t){o=t}}),this.FOptions.FEditing.FAutoHistory&&t.TTMSFNCGridEdit.isPrototypeOf(this.FEditControl)&&this.FOptions.FEditing.FAutoCompleteItems.Add(o),this.DoCellEditDone(this.FEditCell.Col,this.FEditCell.Row,this.FEditControl),h=0,this.DoGetCellEditorType(this.FEditCell.Col,this.FEditCell.Row,{get:function(){return h},set:function(t){h=t}}),18!==h?null!=this.FEditControl&&(this.FEditControl.SetParent(null),this.FEditControl=null):this.FFreeEditControlTimer.SetEnabled(!0),l=!1,r.$assign(this.GetFocusedCell()),a.$assign(this.FRealCell),e){var u=this.FOptions.FKeyboard.FEnterKeyHandling;if(1===u||3===u||5===u||8===u){if(l=!0,c=r.Col,r.$assign(this.NextSelectableColumn(r.Col,r.Row)),r.Row=a.Row,n=!0,this.DoCanAppendColumn(r.Col+1,{get:function(){return n},set:function(t){n=t}}),n&&5===this.FOptions.FKeyboard.FEnterKeyHandling)for(;c===r.Col;)this.InsertRow(this.GetColumnCount()-this.FFixedRightColumns),r.$assign(this.NextSelectableColumn(r.Col,r.Row)),this.DoAppendColumn(this.GetColumnCount()-this.FFixedRightColumns-1);if(c===r.Col&&(p=r.Row,r.Col=this.FFixedColumns-1,r.$assign(this.NextSelectableColumn(r.Col,r.Row)),p===r.Row)){if(3===this.FOptions.FKeyboard.FEnterKeyHandling)r.$assign(this.NextSelectableColumn(this.FFixedColumns-1,r.Row-1));else if(n=!0,this.DoCanAppendRow(r.Row+1,{get:function(){return n},set:function(t){n=t}}),n&&r.Row===this.GetRowCount()-1-this.FFixedFooterRows){if(8===this.FOptions.FKeyboard.FEnterKeyHandling)for(;p===r.Row;)this.InsertRow(this.GetRowCount()-this.FFixedFooterRows),r.$assign(this.NextSelectableColumn(this.FFixedColumns-1,r.Row+1)),this.DoAppendRow(this.GetRowCount()-this.FFixedFooterRows-1)}else r.$assign(this.NextSelectableColumn(this.FFixedColumns-1,r.Row+1));for(;r.Col===this.FFixedColumns-1&&r.Row===p+1;)p=r.Row,r.$assign(this.NextSelectableColumn(this.FFixedColumns-1,r.Row+1))}}else if(2===u||4===u||6===u||7===u){if(l=!0,p=r.Row,r.$assign(this.NextSelectableRow(r.Col,r.Row)),r.Col=a.Col,n=!0,this.DoCanAppendRow(r.Row+1,{get:function(){return n},set:function(t){n=t}}),n&&6===this.FOptions.FKeyboard.FEnterKeyHandling)for(;p===r.Row;)this.InsertRow(this.GetRowCount()-this.FFixedFooterRows),r.$assign(this.NextSelectableRow(r.Col,r.Row)),this.DoAppendRow(this.GetRowCount()-this.FFixedFooterRows-1);if(p===r.Row&&(c=r.Col,r.Row=this.FFixedRows-1,r.$assign(this.NextSelectableRow(r.Col,r.Row)),c===r.Col)){if(3===this.FOptions.FKeyboard.FEnterKeyHandling)r.$assign(this.NextSelectableRow(r.Col-1,this.FFixedRows-1));else if(n=!0,this.DoCanAppendColumn(r.Col+1,{get:function(){return n},set:function(t){n=t}}),n&&r.Col===this.GetColumnCount()-1-this.FFixedRightColumns){if(7===this.FOptions.FKeyboard.FEnterKeyHandling)for(;c===r.Col;)this.InsertColumn(this.GetColumnCount()-this.FFixedRightColumns),r.$assign(this.NextSelectableRow(r.Col+1,this.FFixedRows-1)),this.DoAppendColumn(this.GetColumnCount()-this.FFixedRightColumns-1)}else r.$assign(this.NextSelectableRow(r.Col+1,this.FFixedRows-1));for(;r.Row===this.FFixedRows-1&&r.Col===c+1;)c=r.Col,r.$assign(this.NextSelectableRow(r.Col+1,this.FFixedRows-1))}}}this.CanFocus()&&this.SetFocus(),l&&(this.SelectCell(pas["WEBLib.TMSFNCGridData"].TTMSFNCGridCellRec.$clone(r),{},!1),e&&this.FOptions.FKeyboard.FEnterKeyDirectEdit&&(n=!0,this.DoCanEditCell(this.GetFocusedCell().Col,this.GetFocusedCell().Row,{get:function(){return n},set:function(t){n=t}}),n&&this.EditCell(pas["WEBLib.TMSFNCGridData"].TTMSFNCGridCellRec.$clone(this.GetFocusedCell()),0,!1,"",0))),s=!0}else s=!1}}finally{this.FBlockHide=!1}return s},this.CellControlKeyDown=function(t,e,i){if(9===e.get()&&this.HandleDialogKey(e,rtl.refSet(i)),!rtl.neSet(i,{})){var s=e.get();27===s?this.CancelEdit():13!==s&&113!==s||(this.HideEdit(13===e.get(),!1),13===e.get()&&e.set(0))}},this.CellEditKeyDown=function(t,e,i){var s=0,o=!1;if(9===e.get()&&this.HandleDialogKey(e,rtl.refSet(i)),!rtl.neSet(i,{})){var n=e.get();27===n?this.CancelEdit():13===n||113===n?this.HideEdit(13===e.get(),!1):37===n?this.FOptions.FKeyboard.FArrowKeyDirectEdit&&(this.FEditControl===this.GetCellEdit()&&0===this.GetCellEdit().GetSelStart()||this.FEditControl===this.GetCellMemo()&&0===this.GetCellMemo().GetSelStart())&&(s=9,e.set(0),this.ProcessTab({get:function(){return s},set:function(t){s=t}},rtl.createSet(0),0,1,!0,2)):39===n?this.FOptions.FKeyboard.FArrowKeyDirectEdit&&(this.FEditControl===this.GetCellEdit()&&this.GetCellEdit().GetSelStart()===this.GetCellEdit().GetT().length||this.FEditControl===this.GetCellMemo()&&this.GetCellMemo().GetSelStart()===this.GetCellMemo().GetText().length)&&(s=9,e.set(0),this.ProcessTab({get:function(){return s},set:function(t){s=t}},{},0,1,!0,1)):38!==n&&40!==n||this.HideEdit(!1,!1)&&(this.HandleKeyDown(e,rtl.refSet(i)),this.FOptions.FKeyboard.FArrowKeyDirectEdit&&(o=!0,this.DoCanEditCell(this.GetFocusedCell().Col,this.GetFocusedCell().Row,{get:function(){return o},set:function(t){o=t}}),o&&this.EditCell(pas["WEBLib.TMSFNCGridData"].TTMSFNCGridCellRec.$clone(this.GetFocusedCell()),0,!1,"",0)))}},this.CellExit=function(t){var e=!1,i=null;pas["WEBLib.TMSFNCColorPicker"].TTMSFNCColorPicker.isPrototypeOf(t)&&null!=(i=rtl.as(t,pas["WEBLib.TMSFNCColorPicker"].TTMSFNCColorPicker).GetPopup())&&i.FIsOpen||pas["WEBLib.TMSFNCEdit"].TTMSFNCEdit.isPrototypeOf(t)&&null!=(i=rtl.as(t,pas["WEBLib.TMSFNCEdit"].TTMSFNCEdit).LookupList())&&i.FIsOpen||(e=!0,this.FEditing&&null!=this.FEditControl&&this.DoBeforeCellEditExit(this.FEditCell.Col,this.FEditCell.Row,this.FEditControl,{get:function(){return e},set:function(t){e=t}}),e&&this.StopEdit())},this.CellComboBoxKeyDown=function(t,e,i){if(9===e.get()&&this.HandleDialogKey(e,rtl.refSet(i)),this.FKeyUsed=!0,!rtl.neSet(i,{})){var s=e.get();115===s?(this.FEditControl,this.GetCellDatePicker()):13===s||113===s?(this.HideEdit(13===e.get(),!1),13===e.get()&&e.set(0)):27===s&&this.CancelEdit()}},this.CellComboBoxChange=function(t){this.FKeyUsed?this.FKeyUsed=!1:this.FOptions.FEditing.FDirectComboClose&&this.FEditing&&this.StopEdit()},this.ScrollTimer=function(t){var e=pas["WEBLib.TMSFNCGridData"].TTMSFNCGridCellRec.$new(),i=pas["WEBLib.TMSFNCTypes"].TRectF.$new();this.FOptions.FMouse.FAutoScrolling?(i.$assign(this.GetContentRect()),this.FX>=i.Right-i.Left-this.GetFixedRightWidth()?(e.$assign(this.GetFocusedCell()),0===this.FOptions.FMouse.FAutoScrollingSpeedMode?e.Col=e.Col+Math.round(this.FX-(i.Right-i.Left-this.GetFixedRightWidth()))*this.FOptions.FMouse.FAutoScrollingSpeed:e.Col=e.Col+this.FOptions.FMouse.FAutoScrollingSpeed,this.SetFocusCell(e.Col,e.Row),this.SelectCell(pas["WEBLib.TMSFNCGridData"].TTMSFNCGridCellRec.$clone(this.GetFocusedCell()),{},this.FMouseDragging)):this.FX<=this.GetFixedWidth()&&(e.$assign(this.GetFocusedCell()),0===this.FOptions.FMouse.FAutoScrollingSpeedMode?e.Col=e.Col+Math.round(this.FX-this.GetFixedWidth())*this.FOptions.FMouse.FAutoScrollingSpeed:e.Col=e.Col-this.FOptions.FMouse.FAutoScrollingSpeed,this.SetFocusCell(e.Col,e.Row),this.SelectCell(pas["WEBLib.TMSFNCGridData"].TTMSFNCGridCellRec.$clone(this.GetFocusedCell()),{},this.FMouseDragging)),this.FY>=i.Bottom-i.Top-this.GetFixedFooterHeight()?(e.$assign(this.GetFocusedCell()),0===this.FOptions.FMouse.FAutoScrollingSpeedMode?e.Row=e.Row+Math.round(this.FY-(i.Bottom-i.Top-this.GetFixedFooterHeight()))*this.FOptions.FMouse.FAutoScrollingSpeed:e.Row=e.Row+this.FOptions.FMouse.FAutoScrollingSpeed,this.SetFocusCell(e.Col,e.Row),this.SelectCell(pas["WEBLib.TMSFNCGridData"].TTMSFNCGridCellRec.$clone(this.GetFocusedCell()),{},this.FMouseDragging)):this.FY<=this.GetFixedHeight()&&(e.$assign(this.GetFocusedCell()),0===this.FOptions.FMouse.FAutoScrollingSpeedMode?e.Row=e.Row+Math.round(this.FY-this.GetFixedHeight())*this.FOptions.FMouse.FAutoScrollingSpeed:e.Row=e.Row-this.FOptions.FMouse.FAutoScrollingSpeed,this.SetFocusCell(e.Col,e.Row),this.SelectCell(pas["WEBLib.TMSFNCGridData"].TTMSFNCGridCellRec.$clone(this.GetFocusedCell()),{},this.FMouseDragging))):this.FScrollTimer.SetEnabled(!1)},this.DragTimer=function(t){var e=pas["WEBLib.TMSFNCTypes"].TRectF.$new();this.FOptions.FMouse.FAutoDragging?(e.$assign(this.GetContentRect()),this.FX>=e.Right-e.Left?(0===this.FOptions.FMouse.FAutoScrollingSpeedMode?this.FDragScrollCell.Col=this.FDragScrollCell.Col+Math.round(this.FX-(e.Right-e.Left))*this.FOptions.FMouse.FAutoScrollingSpeed:this.FDragScrollCell.Col=this.FDragScrollCell.Col+this.FOptions.FMouse.FAutoScrollingSpeed,this.Navigate(pas["WEBLib.TMSFNCGridData"].TTMSFNCGridCellRec.$clone(this.FDragScrollCell),!1)):this.FX<=0&&(0===this.FOptions.FMouse.FAutoScrollingSpeedMode?this.FDragScrollCell.Col=this.FDragScrollCell.Col+Math.round(this.FX)*this.FOptions.FMouse.FAutoScrollingSpeed:this.FDragScrollCell.Col=this.FDragScrollCell.Col-this.FOptions.FMouse.FAutoScrollingSpeed,this.Navigate(pas["WEBLib.TMSFNCGridData"].TTMSFNCGridCellRec.$clone(this.FDragScrollCell),!1)),this.FY>=e.Bottom-e.Top?(0===this.FOptions.FMouse.FAutoScrollingSpeedMode?this.FDragScrollCell.Row=this.FDragScrollCell.Row+Math.round(this.FY-(e.Bottom-e.Top))*this.FOptions.FMouse.FAutoScrollingSpeed:this.FDragScrollCell.Row=this.FDragScrollCell.Row+this.FOptions.FMouse.FAutoScrollingSpeed,this.Navigate(pas["WEBLib.TMSFNCGridData"].TTMSFNCGridCellRec.$clone(this.FDragScrollCell),!1)):this.FY<=0&&(0===this.FOptions.FMouse.FAutoScrollingSpeedMode?this.FDragScrollCell.Row=this.FDragScrollCell.Row+Math.round(this.FY)*this.FOptions.FMouse.FAutoScrollingSpeed:this.FDragScrollCell.Row=this.FDragScrollCell.Row-this.FOptions.FMouse.FAutoScrollingSpeed,this.Navigate(pas["WEBLib.TMSFNCGridData"].TTMSFNCGridCellRec.$clone(this.FDragScrollCell),!1))):this.FDragTimer.SetEnabled(!1)},this.AutoSizeColumnInt=function(t,e,i){var s=0,o=0,n=null,r=null,a=null,l="",h=0,F=0,p=0,c=null,u=null,C=null,T=0,S=0,d=pas["WEBLib.TMSFNCGridData"].TTMSFNCGridCellRec.$new(),m=0;u=pas["WEBLib.TMSFNCGridCell"].TTMSFNCGridCellLayout.$create("Create$1"),h=0,F=0,n=null,a=null,e||(a=pas["WEBLib.TMSFNCGridCell"].TTMSFNCGridCell,(n=pas["WEBLib.TMSFNCGridCell"].TTMSFNCGridCell.$create("Create$1",[this])).FScaleFactor=this.FPaintScaleFactor,this.DoGetCellLayout(this.FFixedColumns,this.FFixedRows,n.FLayout,0),n.SetWidth(1e4),n.SetHeight(1e4),rtl.as(n,pas["WEBLib.TMSFNCGridCell"].TTMSFNCGridCell).SetText("g"),F=rtl.as(n,pas["WEBLib.TMSFNCGridCell"].TTMSFNCGridCell).GetTextWidth());for(var f=0,g=this.GetRowCount()-1;f<=g;f++)if(s=f,!this.IsXMergedCell(t,s)){if(r=null,this.DoGetCellClass(t,s,{get:function(){return r},set:function(t){r=t}}),l="",this.DoGetCellData(t,s,{get:function(){return l},set:function(t){l=t}}),a!==r&&null!==a&&null!=n&&(n=rtl.freeLoc(n)),a!==r&&(n=r.$create("Create$1",[this]),pas["WEBLib.TMSFNCGridCell"].TTMSFNCGridCell.isPrototypeOf(n)&&(rtl.as(n,pas["WEBLib.TMSFNCGridCell"].TTMSFNCGridCell).FBitmapContainer=this.GetBitmapContainer(),rtl.as(n,pas["WEBLib.TMSFNCGridCell"].TTMSFNCGridCell).FOptimizedHTMLDrawing=this.FOptimizedHTMLDrawing)),n.FScaleFactor=this.FPaintScaleFactor,a=r,pas["WEBLib.TMSFNCGridCell"].TTMSFNCGridCell.isPrototypeOf(n)&&(m=0,this.DoGetCellRotation(t,s,{get:function(){return m},set:function(t){m=t}}),rtl.as(n,pas["WEBLib.TMSFNCGridCell"].TTMSFNCGridCell).SetAngle(m),rtl.as(n,pas["WEBLib.TMSFNCGridCell"].TTMSFNCGridCell).SetText(l),rtl.as(n,pas["WEBLib.TMSFNCGridCell"].TTMSFNCGridCell).SetDisplayHTMLFormatting(this.FOptions.FCell.FDisplayHTMLFormatting),rtl.as(n,pas["WEBLib.TMSFNCGridCell"].TTMSFNCGridCell).SetWidth(this.GetColWidths(t)),rtl.as(n,pas["WEBLib.TMSFNCGridCell"].TTMSFNCGridCell).SetHeight(this.GetRowHeights(s))),pas["WEBLib.TMSFNCGridCell"].TTMSFNCProgressGridCell.isPrototypeOf(n)&&(rtl.as(n,pas["WEBLib.TMSFNCGridCell"].TTMSFNCProgressGridCell).SetFormat(this.FAppearance.FProgressLayout.FFormat),rtl.as(n,pas["WEBLib.TMSFNCGridCell"].TTMSFNCProgressGridCell).SetTextColor(this.FAppearance.FProgressLayout.FTextColor),rtl.as(n,pas["WEBLib.TMSFNCGridCell"].TTMSFNCProgressGridCell).SetColor(this.FAppearance.FProgressLayout.FColor),rtl.as(n,pas["WEBLib.TMSFNCGridCell"].TTMSFNCProgressGridCell).SetShowText(this.FAppearance.FProgressLayout.FShowText)),pas["WEBLib.TMSFNCGridCell"].TTMSFNCCheckGridCell.isPrototypeOf(n)&&rtl.as(n,pas["WEBLib.TMSFNCGridCell"].TTMSFNCCheckGridCell).SetControlBitmap(this.GetCheckBoxBitmap(rtl.as(n,pas["WEBLib.TMSFNCGridCell"].TTMSFNCCheckGridCell).FChecked,!1,!0)),pas["WEBLib.TMSFNCGridCell"].TTMSFNCRadioGridCell.isPrototypeOf(n)&&rtl.as(n,pas["WEBLib.TMSFNCGridCell"].TTMSFNCRadioGridCell).SetControlBitmap(this.GetRadioButtonBitmap(rtl.as(n,pas["WEBLib.TMSFNCGridCell"].TTMSFNCRadioGridCell).FChecked,!1,!0)),pas["WEBLib.TMSFNCGridCell"].TTMSFNCNodeGridCell.isPrototypeOf(n)&&rtl.as(n,pas["WEBLib.TMSFNCGridCell"].TTMSFNCNodeGridCell).SetControlBitmap(this.GetNodeBitmap(rtl.as(n,pas["WEBLib.TMSFNCGridCell"].TTMSFNCNodeGridCell).FState)),pas["WEBLib.TMSFNCGridCell"].TTMSFNCButtonGridCell.isPrototypeOf(n)&&rtl.as(n,pas["WEBLib.TMSFNCGridCell"].TTMSFNCButtonGridCell).SetControlBitmap(this.GetDummyButtonBitmap(rtl.as(n,pas["WEBLib.TMSFNCGridCell"].TTMSFNCButtonGridCell))),this.ApplyCellState(t,s,n),pas["WEBLib.TMSFNCGridCell"].TTMSFNCGridCell.isPrototypeOf(n)&&(u.Assign(rtl.as(n,pas["WEBLib.TMSFNCGridCell"].TTMSFNCGridCell).FLayout),this.DoGetCellLayout(t,s,u,this.GetCellState(t,s)),rtl.as(n,pas["WEBLib.TMSFNCGridCell"].TTMSFNCGridCell).AssignLayout(u)),this.DoGetCellProperties(t,s,n),T=0,d.$assign(pas["WEBLib.TMSFNCGridData"].MakeCell(t,s)),d.$assign(this.BaseCell(d.Col,d.Row)),(S=this.RowSpan(d.Col,d.Row))>0)for(var y=d.Row,M=d.Row+S-1;y<=M;y++)o=y,T+=this.GetRowHeights(o);else T=this.GetRowHeights(d.Row);pas["WEBLib.TMSFNCGridCell"].TTMSFNCGridCell.isPrototypeOf(n)&&((c=rtl.as(n,pas["WEBLib.TMSFNCGridCell"].TTMSFNCGridCell)).SetWidth(1e4),c.SetHeight(T-4),e?(F=c.GetTextWidth(),null==(C=c.GetControlBitmap())||pas["WEBLib.TMSFNCTypes"].IsBitmapEmpty(C)||(F+=C.GetWidth()),pas["WEBLib.TMSFNCGridCell"].TTMSFNCFixedGridCell.isPrototypeOf(c)&&(rtl.as(c,pas["WEBLib.TMSFNCGridCell"].TTMSFNCFixedGridCell).FShowDropDownButton&&(F+=19),0!==rtl.as(c,pas["WEBLib.TMSFNCGridCell"].TTMSFNCFixedGridCell).FSortKind&&(F+=16)),F>h&&(h=F)):(p=c.GetStrippedHTMLText().length*F,null==(C=c.GetControlBitmap())||pas["WEBLib.TMSFNCTypes"].IsBitmapEmpty(C)||(p+=C.GetWidth()),pas["WEBLib.TMSFNCGridCell"].TTMSFNCFixedGridCell.isPrototypeOf(c)&&(rtl.as(c,pas["WEBLib.TMSFNCGridCell"].TTMSFNCFixedGridCell).FShowDropDownButton&&(F+=19),0!==rtl.as(c,pas["WEBLib.TMSFNCGridCell"].TTMSFNCFixedGridCell).FSortKind&&(F+=16)),p>h&&(h=p)))}null!=n&&(n=rtl.freeLoc(n)),this.SetColWidths(t,h+i),u=rtl.freeLoc(u)},this.AutoSizeRowInt=function(t,e){var i=0,s=0,o=null,n=null,r=null,a="",l=0,h=0,F=null,p=null,c=null,u=pas["WEBLib.TMSFNCGridData"].TTMSFNCGridCellRec.$new(),C=0,T=0,S=0;p=pas["WEBLib.TMSFNCGridCell"].TTMSFNCGridCellLayout.$create("Create$1"),l=0,r=null,o=null;for(var d=0,m=this.GetColumnCount()-1;d<=m;d++)if(i=d,!this.IsYMergedCell(i,t)){if(n=null,this.DoGetCellClass(i,t,{get:function(){return n},set:function(t){n=t}}),a="",this.DoGetCellData(i,t,{get:function(){return a},set:function(t){a=t}}),r!==n&&null!==r&&null!=o&&(o=rtl.freeLoc(o)),r!==n&&(o=n.$create("Create$1",[this]),pas["WEBLib.TMSFNCGridCell"].TTMSFNCGridCell.isPrototypeOf(o)&&(rtl.as(o,pas["WEBLib.TMSFNCGridCell"].TTMSFNCGridCell).SetLayout(null),rtl.as(o,pas["WEBLib.TMSFNCGridCell"].TTMSFNCGridCell).FBitmapContainer=this.GetBitmapContainer(),rtl.as(o,pas["WEBLib.TMSFNCGridCell"].TTMSFNCGridCell).FOptimizedHTMLDrawing=this.FOptimizedHTMLDrawing)),o.FScaleFactor=this.FPaintScaleFactor,r=n,pas["WEBLib.TMSFNCGridCell"].TTMSFNCGridCell.isPrototypeOf(o)&&(S=0,this.DoGetCellRotation(i,t,{get:function(){return S},set:function(t){S=t}}),rtl.as(o,pas["WEBLib.TMSFNCGridCell"].TTMSFNCGridCell).SetAngle(S),rtl.as(o,pas["WEBLib.TMSFNCGridCell"].TTMSFNCGridCell).SetText(a),rtl.as(o,pas["WEBLib.TMSFNCGridCell"].TTMSFNCGridCell).SetDisplayHTMLFormatting(this.FOptions.FCell.FDisplayHTMLFormatting),rtl.as(o,pas["WEBLib.TMSFNCGridCell"].TTMSFNCGridCell).SetWidth(this.GetColWidths(i)),rtl.as(o,pas["WEBLib.TMSFNCGridCell"].TTMSFNCGridCell).SetHeight(this.GetRowHeights(t))),pas["WEBLib.TMSFNCGridCell"].TTMSFNCProgressGridCell.isPrototypeOf(o)&&(rtl.as(o,pas["WEBLib.TMSFNCGridCell"].TTMSFNCProgressGridCell).SetFormat(this.FAppearance.FProgressLayout.FFormat),rtl.as(o,pas["WEBLib.TMSFNCGridCell"].TTMSFNCProgressGridCell).SetTextColor(this.FAppearance.FProgressLayout.FTextColor),rtl.as(o,pas["WEBLib.TMSFNCGridCell"].TTMSFNCProgressGridCell).SetColor(this.FAppearance.FProgressLayout.FColor),rtl.as(o,pas["WEBLib.TMSFNCGridCell"].TTMSFNCProgressGridCell).SetShowText(this.FAppearance.FProgressLayout.FShowText)),pas["WEBLib.TMSFNCGridCell"].TTMSFNCCheckGridCell.isPrototypeOf(o)&&rtl.as(o,pas["WEBLib.TMSFNCGridCell"].TTMSFNCCheckGridCell).SetControlBitmap(this.GetCheckBoxBitmap(rtl.as(o,pas["WEBLib.TMSFNCGridCell"].TTMSFNCCheckGridCell).FChecked,!1,!0)),pas["WEBLib.TMSFNCGridCell"].TTMSFNCRadioGridCell.isPrototypeOf(o)&&rtl.as(o,pas["WEBLib.TMSFNCGridCell"].TTMSFNCRadioGridCell).SetControlBitmap(this.GetRadioButtonBitmap(rtl.as(o,pas["WEBLib.TMSFNCGridCell"].TTMSFNCRadioGridCell).FChecked,!1,!0)),pas["WEBLib.TMSFNCGridCell"].TTMSFNCNodeGridCell.isPrototypeOf(o)&&rtl.as(o,pas["WEBLib.TMSFNCGridCell"].TTMSFNCNodeGridCell).SetControlBitmap(this.GetNodeBitmap(rtl.as(o,pas["WEBLib.TMSFNCGridCell"].TTMSFNCNodeGridCell).FState)),pas["WEBLib.TMSFNCGridCell"].TTMSFNCButtonGridCell.isPrototypeOf(o)&&rtl.as(o,pas["WEBLib.TMSFNCGridCell"].TTMSFNCButtonGridCell).SetControlBitmap(this.GetDummyButtonBitmap(rtl.as(o,pas["WEBLib.TMSFNCGridCell"].TTMSFNCButtonGridCell))),this.ApplyCellState(i,t,o),pas["WEBLib.TMSFNCGridCell"].TTMSFNCGridCell.isPrototypeOf(o)&&(p.Assign(rtl.as(o,pas["WEBLib.TMSFNCGridCell"].TTMSFNCGridCell).FLayout),this.DoGetCellLayout(i,t,p,this.GetCellState(i,t)),rtl.as(o,pas["WEBLib.TMSFNCGridCell"].TTMSFNCGridCell).AssignLayout(p)),this.DoGetCellProperties(i,t,o),C=0,u.$assign(pas["WEBLib.TMSFNCGridData"].MakeCell(i,t)),u.$assign(this.BaseCell(u.Col,u.Row)),(T=this.ColSpan(u.Col,u.Row))>0)for(var f=u.Col,g=u.Col+T-1;f<=g;f++)s=f,C+=this.GetColWidths(s);else C=this.GetColWidths(u.Col);pas["WEBLib.TMSFNCGridCell"].TTMSFNCGridCell.isPrototypeOf(o)&&((F=rtl.as(o,pas["WEBLib.TMSFNCGridCell"].TTMSFNCGridCell)).SetWidth(C-4),F.SetHeight(1e4),h=F.GetTextHeight(),null==(c=F.GetControlBitmap())||pas["WEBLib.TMSFNCTypes"].IsBitmapEmpty(c)||c.GetHeight()>h&&(h=c.GetHeight()),pas["WEBLib.TMSFNCGridCell"].TTMSFNCFixedGridCell.isPrototypeOf(F)&&(rtl.as(F,pas["WEBLib.TMSFNCGridCell"].TTMSFNCFixedGridCell).FShowDropDownButton&&15>h&&(h=15),0!==rtl.as(F,pas["WEBLib.TMSFNCGridCell"].TTMSFNCFixedGridCell).FSortKind&&12>h&&(h=12)),h>l&&(l=h))}null!=o&&(o=rtl.freeLoc(o)),this.SetRowHeights(t,l+e),p=rtl.freeLoc(p)},this.DoCheckBoxClick=function(t){var e=pas["WEBLib.TMSFNCGridData"].TTMSFNCGridCellRec.$new(),i=null;this.StopEdit(),pas["WEBLib.TMSFNCGridCell"].TTMSFNCGridCell.isPrototypeOf(t)&&(i=rtl.as(t,pas["WEBLib.TMSFNCGridCell"].TTMSFNCGridCell),e.$assign(this.GetCellByObject(i)),-1!==e.Row&&-1!==e.Col&&(null!=this.FAdapter&&this.FAdapter.CellCheckBoxClick(e.Col,e.Row,i),this.DoCellCheckBoxClick(e.Col,e.Row,i)))},this.DoRadioButtonClick=function(t){var e=pas["WEBLib.TMSFNCGridData"].TTMSFNCGridCellRec.$new(),i=null;pas["WEBLib.TMSFNCGridCell"].TTMSFNCGridCell.isPrototypeOf(t)&&(i=rtl.as(t,pas["WEBLib.TMSFNCGridCell"].TTMSFNCGridCell),e.$assign(this.GetCellByObject(i)),-1!==e.Row&&-1!==e.Col&&this.DoCellRadioButtonClick(e.Col,e.Row,i))},this.DoButtonClick=function(t){var e=pas["WEBLib.TMSFNCGridData"].TTMSFNCGridCellRec.$new(),i=null;pas["WEBLib.TMSFNCGridCell"].TTMSFNCGridCell.isPrototypeOf(t)&&(i=rtl.as(t,pas["WEBLib.TMSFNCGridCell"].TTMSFNCGridCell),e.$assign(this.GetCellByObject(i)),-1!==e.Row&&-1!==e.Col&&this.DoCellButtonClick(e.Col,e.Row,i))},this.DoNodeClick=function(t){var e=pas["WEBLib.TMSFNCGridData"].TTMSFNCGridCellRec.$new(),i=null;pas["WEBLib.TMSFNCGridCell"].TTMSFNCGridCell.isPrototypeOf(t)&&(i=rtl.as(t,pas["WEBLib.TMSFNCGridCell"].TTMSFNCGridCell),e.$assign(this.GetCellByObject(i)),-1!==e.Row&&-1!==e.Col&&this.DoCellNodeClick(e.Col,e.Row,i))},this.DoBitmapClick=function(t){var e=pas["WEBLib.TMSFNCGridData"].TTMSFNCGridCellRec.$new(),i=null;pas["WEBLib.TMSFNCGridCell"].TTMSFNCGridCell.isPrototypeOf(t)&&(i=rtl.as(t,pas["WEBLib.TMSFNCGridCell"].TTMSFNCGridCell),e.$assign(this.GetCellByObject(i)),-1!==e.Row&&-1!==e.Col&&this.DoCellBitmapClick(e.Col,e.Row,i))},this.DoCommentClick=function(t){var e=pas["WEBLib.TMSFNCGridData"].TTMSFNCGridCellRec.$new(),i=null;pas["WEBLib.TMSFNCGridCell"].TTMSFNCGridCell.isPrototypeOf(t)&&(i=rtl.as(t,pas["WEBLib.TMSFNCGridCell"].TTMSFNCGridCell),e.$assign(this.GetCellByObject(i)),-1!==e.Row&&-1!==e.Col&&this.DoCellCommentClick(e.Col,e.Row,i))},this.DoFixedDropDownButtonClick=function(t){var e=pas["WEBLib.TMSFNCGridData"].TTMSFNCGridCellRec.$new(),i=null;pas["WEBLib.TMSFNCGridCell"].TTMSFNCGridCell.isPrototypeOf(t)&&(i=rtl.as(t,pas["WEBLib.TMSFNCGridCell"].TTMSFNCGridCell),e.$assign(this.GetCellByObject(i)),-1!==e.Row&&-1!==e.Col&&this.DoFixedCellDropDownButtonClick(e.Col,e.Row,i))},this.DoCellAnchorClick=function(t,e,i){pas["WEBLib.TMSFNCGridData"].TTMSFNCGridData.DoCellAnchorClick.apply(this,arguments),this.FOptions.FURL.FOpen&&pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.OpenURL(i),null!=this.FOnCellAnchorClick&&this.FOnCellAnchorClick(this,t,e,i)},this.DoCanSizeColumn=function(t,e){pas["WEBLib.TMSFNCGridData"].TTMSFNCGridData.DoCanSizeColumn.apply(this,arguments),null!=this.FOnCanSizeColumn&&this.FOnCanSizeColumn(this,t,e)},this.DoCanSizeRow=function(t,e){pas["WEBLib.TMSFNCGridData"].TTMSFNCGridData.DoCanSizeRow.apply(this,arguments),null!=this.FOnCanSizeRow&&this.FOnCanSizeRow(this,t,e)},this.DoColumnSize=function(t,e){pas["WEBLib.TMSFNCGridData"].TTMSFNCGridData.DoColumnSize.apply(this,arguments),null!=this.FOnColumnSize&&this.FOnColumnSize(this,t,e)},this.DoRowSize=function(t,e){pas["WEBLib.TMSFNCGridData"].TTMSFNCGridData.DoRowSize.apply(this,arguments),null!=this.FOnRowSize&&this.FOnRowSize(this,t,e)},this.DoColumnSized=function(t,e){pas["WEBLib.TMSFNCGridData"].TTMSFNCGridData.DoColumnSized.apply(this,arguments),null!=this.FOnColumnSized&&this.FOnColumnSized(this,t,e)},this.DoRowSized=function(t,e){pas["WEBLib.TMSFNCGridData"].TTMSFNCGridData.DoRowSized.apply(this,arguments),null!=this.FOnRowSized&&this.FOnRowSized(this,t,e)},this.DoCanSortColumn=function(t,e){pas["WEBLib.TMSFNCGridData"].TTMSFNCGridData.DoCanSortColumn.apply(this,arguments),null!=this.FOnCanSortColumn&&this.FOnCanSortColumn(this,t,e)},this.DoColumnSorted=function(t,e){pas["WEBLib.TMSFNCGridData"].TTMSFNCGridData.DoColumnSorted.apply(this,arguments),null!=this.FOnColumnSorted&&this.FOnColumnSorted(this,t,e)},this.DoCanDragColumn=function(t,e){null!=this.FOnCanDragColumn&&this.FOnCanDragColumn(this,t,e)},this.DoCanDragRow=function(t,e){null!=this.FOnCanDragRow&&this.FOnCanDragRow(this,t,e)},this.DoColumnDragged=function(t,e){null!=this.FOnColumnDragged&&this.FOnColumnDragged(this,t,e)},this.DoRowDragged=function(t,e){null!=this.FOnRowDragged&&this.FOnRowDragged(this,t,e)},this.DoBeforeCellEditExit=function(t,e,i,s){null!=this.FAdapter&&this.FAdapter.CellBeforeEditExit(t,e,i,s),null!=this.FOnBeforeCellEditExit&&this.FOnBeforeCellEditExit(this,t,e,i,s)},this.DoBeforeColumnDrop=function(t,e,i){null!=this.FOnBeforeColumnDrop&&this.FOnBeforeColumnDrop(this,t,e,i)},this.DoBeforeRowDrop=function(t,e,i){null!=this.FOnBeforeRowDrop&&this.FOnBeforeRowDrop(this,t,e,i)},this.DoFixedCellDropDownButtonClick=function(e,i,s){var o=null,n=0,r=0,a=pas["WEBLib.TMSFNCTypes"].TPointF.$new();if(pas["WEBLib.TMSFNCGridData"].TTMSFNCGridData.DoFixedCellDropDownButtonClick.apply(this,arguments),this.FOptions.FFiltering.FDropDown&&this.FOptions.FFiltering.FDropDownFixedRow===i){o=pas.Classes.TStringList.$create("Create$1");try{o.FDuplicates=0,o.SetSorted(!0),o.Add(rtl.getResStr(t,"sTMSFNCGridFilterAll")),r=this.DisplToRealColumn(e);for(var l=this.FFixedRows,h=this.GetRowCount()-this.FFixedFooterRows-1+this.GetHiddenRowCount();l<=h;l++)n=l,o.Add(pas.SysUtils.Trim(this.GetAllCells(r,n)));this.DoNeedFilterDropDownData(r,i,o),this.FFilterListBox.SetParent(this),this.FFilterListBox.FItems.Assign(o),this.FFilterListBox.SetItemIndex(-1),this.FFilterListBox.SetParent(null),this.FFilterListBox.FTag$1=e}finally{o=rtl.freeLoc(o)}}this.FFilterPopup.SetPlacementControl(this),a.$assign(this.LocalToScreenEx(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(s.FLeft+s.FWidth-17*this.FPaintScaleFactor,s.FTop+(s.FHeight+15*this.FPaintScaleFactor)/2)))),this.FFilterPopup.FPlacementRectangle.SetLeft(a.X),this.FFilterPopup.FPlacementRectangle.SetTop(a.Y),this.FFilterPopup.FPlacementRectangle.SetRight(a.X+this.FFilterPopup.FDropDownWidth),this.FFilterPopup.FPlacementRectangle.SetBottom(a.Y+this.FFilterPopup.FDropDownHeight),this.FFilterListBox.SetWidth(this.FOptions.FFiltering.FDropDownWidth),this.FFilterListBox.SetHeight(this.FOptions.FFiltering.FDropDownHeight),this.FFilterPopup.SetDropDownHeight(this.FOptions.FFiltering.FDropDownHeight),this.FFilterPopup.SetDropDownWidth(this.FOptions.FFiltering.FDropDownWidth),this.FFilterPopup.SetContentControl(this.FFilterListBox),this.FFilterPopup.FFocusedControl=this.FFilterListBox,this.FFilterPopup.Popup(!1),null!=this.FOnFixedCellDropDownButtonClick&&this.FOnFixedCellDropDownButtonClick(this,e,i,s)},this.DoCellCheckBoxClick=function(t,e,i){pas["WEBLib.TMSFNCGridData"].TTMSFNCGridData.DoCellCheckBoxClick.apply(this,arguments),null!=this.FOnCellCheckBoxClick&&this.FOnCellCheckBoxClick(this,t,e,i)},this.DoCellRadioButtonClick=function(t,e,i){pas["WEBLib.TMSFNCGridData"].TTMSFNCGridData.DoCellRadioButtonClick.apply(this,arguments),null!=this.FOnCellRadioButtonClick&&this.FOnCellRadioButtonClick(this,t,e,i)},this.DoCellButtonClick=function(t,e,i){pas["WEBLib.TMSFNCGridData"].TTMSFNCGridData.DoCellButtonClick.apply(this,arguments),null!=this.FOnCellButtonClick&&this.FOnCellButtonClick(this,t,e,i)},this.DoGetCellIsFixed=function(t,e,i){pas["WEBLib.TMSFNCGridData"].TTMSFNCGridData.DoGetCellIsFixed.apply(this,arguments),null!=this.FOnGetCellIsFixed&&this.FOnGetCellIsFixed(this,t,e,i)},this.DoGetRowIsBand=function(t,e){pas["WEBLib.TMSFNCGridData"].TTMSFNCGridData.DoGetRowIsBand.apply(this,arguments),null!=this.FOnGetRowIsBand&&this.FOnGetRowIsBand(this,t,e)},this.DoCellBitmapClick=function(t,e,i){pas["WEBLib.TMSFNCGridData"].TTMSFNCGridData.DoCellBitmapClick.apply(this,arguments),null!=this.FOnCellBitmapClick&&this.FOnCellBitmapClick(this,t,e,i)},this.DoCellCommentClick=function(t,e,i){var s=null,o=pas["WEBLib.TMSFNCTypes"].TSizeF.$new(),n=pas["WEBLib.TMSFNCTypes"].TPointF.$new();pas["WEBLib.TMSFNCGridData"].TTMSFNCGridData.DoCellCommentClick.apply(this,arguments),this.FCommentPopup.SetPlacementControl(this),this.FActiveComment=rtl.as(i,pas["WEBLib.TMSFNCGridCell"].TTMSFNCCommentGridCell).FCommentText,this.FActiveCommentTextColor=rtl.as(i,pas["WEBLib.TMSFNCGridCell"].TTMSFNCCommentGridCell).FCommentTextColor,(s=pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.$create("CreateBitmapCanvas",[1,1,!1,!0])).BeginScene(),s.FBitmapContainer=this.GetBitmapContainer(),s.FOptimizedHTMLDrawing=this.FOptimizedHTMLDrawing;try{o.$assign(s.CalculateTextSize(this.FActiveComment,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(0,0,1e4,1e4)),!0,!0)),this.FCommentPopup.SetDropDownHeight(o.cy+10),this.FCommentPopup.SetDropDownWidth(o.cx+10)}finally{s.EndScene(),s=rtl.freeLoc(s)}n.$assign(this.LocalToScreenEx(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(i.FLeft+i.FWidth-this.FCommentPopup.FDropDownWidth,i.FTop-this.FCommentPopup.FDropDownHeight)))),this.FCommentPopup.FPlacementRectangle.SetLeft(n.X),this.FCommentPopup.FPlacementRectangle.SetTop(n.Y),this.FCommentPopup.FPlacementRectangle.SetRight(n.X+this.FCommentPopup.FDropDownWidth),this.FCommentPopup.FPlacementRectangle.SetBottom(n.Y+this.FCommentPopup.FDropDownHeight),this.FCommentPopup.Popup(!1),null!=this.FOnCellCommentClick&&this.FOnCellCommentClick(this,t,e,i)},this.DoCellSortClick=function(t,e,i,s,o){var n=!1,r=null;if(0!==this.FOptions.FSorting.FMode&&(n=!0,this.DoCanSortColumn(e,{get:function(){return n},set:function(t){n=t}}),n&&null!=(r=rtl.as(o,pas["WEBLib.TMSFNCGridCell"].TTMSFNCFixedGridCell)))){2===this.FOptions.FSorting.FMode?0 in t||(this.FSortIndexes.Clear(),this.ClearFixedSorting(r)):this.ClearFixedSorting(r);var a=r.FSortKind;1===a?(s=1,2===this.FOptions.FSorting.FMode?(-1===this.FSortIndexes.FindIndex(e)?this.FSortIndexes.AddIndex(e,1):this.FSortIndexes.ToggleIndex(e),r.FSortIndex=this.FSortIndexes.FindIndex(e)+1):r.FSortIndex=-1,r.FSortKind=2):0!==a&&2!==a||(s=0,2===this.FOptions.FSorting.FMode?(-1===this.FSortIndexes.FindIndex(e)?this.FSortIndexes.AddIndex(e,0):this.FSortIndexes.ToggleIndex(e),r.FSortIndex=this.FSortIndexes.FindIndex(e)+1):r.FSortIndex=-1,r.FSortKind=1),pas["WEBLib.TMSFNCGridData"].TTMSFNCGridData.DoCellSortClick.call(this,rtl.refSet(t),e,i,s,o),null!=this.FOnCellSortClick&&this.FOnCellSortClick(this,e,i,o),this.DoColumnSorted(e,s)}},this.DoCellNodeClick=function(t,e,i){pas["WEBLib.TMSFNCGridData"].TTMSFNCGridData.DoCellNodeClick.apply(this,arguments),null!=this.FOnCellNodeClick&&this.FOnCellNodeClick(this,t,e,i)},this.DoInsertRow=function(t){pas["WEBLib.TMSFNCGridData"].TTMSFNCGridData.DoInsertRow.apply(this,arguments),null!=this.FOnInsertRow&&this.FOnInsertRow(this,t)},this.DoDeleteRow=function(t){pas["WEBLib.TMSFNCGridData"].TTMSFNCGridData.DoDeleteRow.apply(this,arguments),null!=this.FOnDeleteRow&&this.FOnDeleteRow(this,t)},this.DoAppendRow=function(t){pas["WEBLib.TMSFNCGridData"].TTMSFNCGridData.DoAppendRow.apply(this,arguments),null!=this.FOnAppendRow&&this.FOnAppendRow(this,t)},this.DoAppendColumn=function(t){pas["WEBLib.TMSFNCGridData"].TTMSFNCGridData.DoAppendColumn.apply(this,arguments),null!=this.FOnAppendColumn&&this.FOnAppendColumn(this,t)},this.DoCanInsertRow=function(t,e){pas["WEBLib.TMSFNCGridData"].TTMSFNCGridData.DoCanInsertRow.apply(this,arguments),null!=this.FOnCanInsertRow&&this.FOnCanInsertRow(this,t,e)},this.DoCanDeleteRow=function(t,e){pas["WEBLib.TMSFNCGridData"].TTMSFNCGridData.DoCanDeleteRow.apply(this,arguments),null!=this.FOnCanDeleteRow&&this.FOnCanDeleteRow(this,t,e)},this.DoCanAppendRow=function(t,e){pas["WEBLib.TMSFNCGridData"].TTMSFNCGridData.DoCanAppendRow.apply(this,arguments),null!=this.FOnCanAppendRow&&this.FOnCanAppendRow(this,t,e)},this.DoCanAppendColumn=function(t,e){pas["WEBLib.TMSFNCGridData"].TTMSFNCGridData.DoCanAppendColumn.apply(this,arguments),null!=this.FOnCanAppendColumn&&this.FOnCanAppendColumn(this,t,e)},this.DoCellRightClick=function(t,e){pas["WEBLib.TMSFNCGridData"].TTMSFNCGridData.DoCellRightClick.apply(this,arguments),null!=this.FOnCellRightClick&&this.FOnCellRightClick(this,t,e)},this.DoFixedCellRightClick=function(t,e){pas["WEBLib.TMSFNCGridData"].TTMSFNCGridData.DoFixedCellRightClick.apply(this,arguments),null!=this.FOnFixedCellRightClick&&this.FOnFixedCellRightClick(this,t,e)},this.DoCellClick=function(t,e){pas["WEBLib.TMSFNCGridData"].TTMSFNCGridData.DoCellClick.apply(this,arguments),null!=this.FOnCellClick&&this.FOnCellClick(this,t,e)},this.DoFixedCellClick=function(t,e,i){var s=null,o=pas["WEBLib.TMSFNCGridData"].TTMSFNCGridCellRec.$new();pas["WEBLib.TMSFNCGridData"].TTMSFNCGridData.DoFixedCellClick.apply(this,arguments),o.Col=e,o.Row=i,null!=(s=this.GetCellObject(pas["WEBLib.TMSFNCGridData"].TTMSFNCGridCellRec.$clone(this.GetDisplayCell(pas["WEBLib.TMSFNCGridData"].TTMSFNCGridCellRec.$clone(o)))))&&pas["WEBLib.TMSFNCGridCell"].TTMSFNCFixedGridCell.isPrototypeOf(s)&&i===this.FOptions.FSorting.FRow&&this.DoCellSortClick(rtl.refSet(t),e,i,0,s),null!=this.FOnFixedCellClick&&this.FOnFixedCellClick(this,e,i)},this.DoCellDblClick=function(t,e){pas["WEBLib.TMSFNCGridData"].TTMSFNCGridData.DoCellDblClick.apply(this,arguments),null!=this.FOnCellDblClick&&this.FOnCellDblClick(this,t,e)},this.DoFixedCellDblClick=function(t,e){pas["WEBLib.TMSFNCGridData"].TTMSFNCGridData.DoFixedCellDblClick.apply(this,arguments),null!=this.FOnFixedCellDblClick&&this.FOnFixedCellDblClick(this,t,e)},this.DoGetCellClass=function(t,e,i){pas["WEBLib.TMSFNCGridData"].TTMSFNCGridData.DoGetCellClass.apply(this,arguments),null!=this.FAdapter&&this.FAdapter.GetCellClass(t,e,i),null!=this.FOnGetCellClass&&this.FOnGetCellClass(this,t,e,i)},this.DoGetCellData=function(t,e,i){pas["WEBLib.TMSFNCGridData"].TTMSFNCGridData.DoGetCellData.apply(this,arguments),null!=this.FAdapter&&this.FAdapter.GetCellData(t,e,i),null!=this.FOnGetCellData&&this.FOnGetCellData(this,t,e,i)},this.DoGetCellRotation=function(t,e,i){pas["WEBLib.TMSFNCGridData"].TTMSFNCGridData.DoGetCellRotation.apply(this,arguments),null!=this.FOnGetCellRotation&&this.FOnGetCellRotation(this,t,e,i)},this.DoGetCellLayout=function(t,e,i,s){pas["WEBLib.TMSFNCGridData"].TTMSFNCGridData.DoGetCellLayout.apply(this,arguments),null!=this.FOnGetCellLayout&&this.FOnGetCellLayout(this,t,e,i,s)},this.DoGetCellProperties=function(t,e,i){pas["WEBLib.TMSFNCGridData"].TTMSFNCGridData.DoGetCellProperties.apply(this,arguments),null!=this.FAdapter&&this.FAdapter.GetCellProperties(t,e,i),null!=this.FOnGetCellProperties&&this.FOnGetCellProperties(this,t,e,i)},this.DoGetCellMergeInfo=function(t,e,i,s,o,n){pas["WEBLib.TMSFNCGridData"].TTMSFNCGridData.DoGetCellMergeInfo.apply(this,arguments),null!=this.FOnGetCellMergeInfo&&this.FOnGetCellMergeInfo(this,t,e,i,s,o,n)},this.DoGetCellEditorCustomClassType=function(t,e,i){pas["WEBLib.TMSFNCGridData"].TTMSFNCGridData.DoGetCellEditorCustomClassType.apply(this,arguments),null!=this.FOnGetCellEditorCustomClassType&&this.FOnGetCellEditorCustomClassType(this,t,e,i)},this.DoGetCellEditorType=function(t,e,i){pas["WEBLib.TMSFNCGridData"].TTMSFNCGridData.DoGetCellEditorType.apply(this,arguments),null!=this.FAdapter&&this.FAdapter.GetCellEditorType(t,e,i),null!=this.FOnGetCellEditorType&&this.FOnGetCellEditorType(this,t,e,i)},this.DoCellEditGetData=function(t,e,i,s){pas["WEBLib.TMSFNCGridData"].TTMSFNCGridData.DoCellEditGetData.apply(this,arguments),null!=this.FAdapter&&this.FAdapter.CellEditGetData(t,e,i,s),null!=this.FOnCellEditGetData&&this.FOnCellEditGetData(this,t,e,i,s)},this.DoCellEditValidateData=function(t,e,i,s,o){pas["WEBLib.TMSFNCGridData"].TTMSFNCGridData.DoCellEditValidateData.apply(this,arguments),null!=this.FOnCellEditValidateData&&this.FOnCellEditValidateData(this,t,e,i,s,o),null!=this.FAdapter&&this.FAdapter.CellEditValidateData(t,e,i,s,o)},this.DoCellEditSetData=function(t,e,i,s){null!=this.FAdapter&&this.FAdapter.CellEditSetData(t,e,i,s),null!=this.FOnCellEditSetData&&this.FOnCellEditSetData(this,t,e,i,s),pas["WEBLib.TMSFNCGridData"].TTMSFNCGridData.DoCellEditSetData.apply(this,arguments)},this.DoCellEditGetColor=function(t,e,i,s){pas["WEBLib.TMSFNCGridData"].TTMSFNCGridData.DoCellEditGetColor.apply(this,arguments),null!=this.FOnCellEditGetColor&&this.FOnCellEditGetColor(this,t,e,i,s)},this.DoCellEditValidateColor=function(t,e,i,s,o){pas["WEBLib.TMSFNCGridData"].TTMSFNCGridData.DoCellEditValidateColor.apply(this,arguments),null!=this.FOnCellEditValidateColor&&this.FOnCellEditValidateColor(this,t,e,i,s,o)},this.DoCellEditSetColor=function(t,e,i,s){null!=this.FOnCellEditSetColor&&this.FOnCellEditSetColor(this,t,e,i,s),pas["WEBLib.TMSFNCGridData"].TTMSFNCGridData.DoCellEditSetColor.apply(this,arguments)},this.DoCellEditDone=function(t,e,i){pas["WEBLib.TMSFNCGridData"].TTMSFNCGridData.DoCellEditDone.apply(this,arguments),null!=this.FAdapter&&this.FAdapter.CellEditDone(t,e,i),null!=this.FOnCellEditDone&&this.FOnCellEditDone(this,t,e,i),null!=this.FOnInternalCellEditDone&&this.FOnInternalCellEditDone(this,t,e,i)},this.DoCellEditCancel=function(t,e){null!=this.FAdapter&&this.FAdapter.CellEditCancel(t,e),null!=this.FOnCellEditCancel&&this.FOnCellEditCancel(this,t,e)},this.DoGetCellEditorProperties=function(t,e,i){pas["WEBLib.TMSFNCGridData"].TTMSFNCGridData.DoGetCellEditorProperties.apply(this,arguments),pas["WEBLib.StdCtrls"].TComboBox.isPrototypeOf(i)&&rtl.as(i,pas["WEBLib.StdCtrls"].TComboBox).SetParent(this),null!=this.FAdapter&&this.FAdapter.GetCellEditorProperties(t,e,i),null!=this.FOnGetCellEditorProperties&&this.FOnGetCellEditorProperties(this,t,e,i),pas["WEBLib.StdCtrls"].TComboBox.isPrototypeOf(i)&&rtl.as(i,pas["WEBLib.StdCtrls"].TComboBox).SetParent(null)},this.DoGetCellReadOnly=function(t,e,i){pas["WEBLib.TMSFNCGridData"].TTMSFNCGridData.DoGetCellReadOnly.apply(this,arguments),null!=this.FAdapter&&this.FAdapter.GetCellReadOnly(t,e,i),null!=this.FOnGetCellReadOnly&&this.FOnGetCellReadOnly(this,t,e,i)},this.DoBeforeDrawCell=function(t,e,i,s,o,n,r,a){var l=pas["WEBLib.TMSFNCGridData"].TTMSFNCGridCellRec.$new(),h=null;pas["WEBLib.TMSFNCGridCell"].TTMSFNCGridCell.isPrototypeOf(t)&&(h=rtl.as(t,pas["WEBLib.TMSFNCGridCell"].TTMSFNCGridCell),l.$assign(this.GetCellByObject(h)),-1!==l.Row&&-1!==l.Col&&this.DoBeforeDrawGridCell(l.Col,l.Row,e,i,s,o,n,r,a))},this.DoAfterDrawCell=function(t,e,i,s){var o=pas["WEBLib.TMSFNCGridData"].TTMSFNCGridCellRec.$new(),n=null;pas["WEBLib.TMSFNCGridCell"].TTMSFNCGridCell.isPrototypeOf(t)&&(n=rtl.as(t,pas["WEBLib.TMSFNCGridCell"].TTMSFNCGridCell),o.$assign(this.GetCellByObject(n)),-1!==o.Row&&-1!==o.Col&&this.DoAfterDrawGridCell(o.Col,o.Row,e,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),pas["WEBLib.TMSFNCTypes"].TRectF.$clone(s)))},this.DoBeforeDrawGridCell=function(t,e,i,s,o,n,r,a,l){null!=this.FOnCellBeforeDraw&&this.FOnCellBeforeDraw(this,t,e,i,s,o,n,r,a,l)},this.DoAfterDrawGridCell=function(t,e,i,s,o){null!=this.FOnCellAfterDraw&&this.FOnCellAfterDraw(this,t,e,i,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(s),pas["WEBLib.TMSFNCTypes"].TRectF.$clone(o))},this.DisplayCellsAlternate=function(t,e,i,s,o,n,r,a,l,h,F,p){var c=0,u=0,C=0,T=0,S=0,d=0,m=0,f=0,g=null,y=0,M=0,b=0,N=0,B=0,E=0,D=null,L=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),G="",A=0,I=null,P=0;I=pas["WEBLib.TMSFNCGridCell"].TTMSFNCGridCellLayout.$create("Create$1");for(var w=r,$=a;w<=$;w++){M=w,u=this.GetRowHeights(M),null!=this.FAdapter&&this.FAdapter.StartBuild(M);for(var R=o,v=n;R<=v;R++){b=y=R,N=M,B=0,E=0,c=this.GetColWidths(y),this.DoGetCellMergeInfo(y,M,{get:function(){return b},set:function(t){b=t}},{get:function(){return N},set:function(t){N=t}},{get:function(){return B},set:function(t){B=t}},{get:function(){return E},set:function(t){E=t}}),D=null,this.DoGetCellClass(b,N,{get:function(){return D},set:function(t){D=t}}),g=null,rtl.length(this.FCellArray)>l&&rtl.length(this.FCellArray[l])>h&&(g=this.FCellArray[l][h]),null!=g&&g.$class.ClassType()!==D&&(g=rtl.freeLoc(g),g=null,this.FCellArray[l][h]=null),C=c,T=u,S=0;for(var W=b,O=b+B-1;W<=O;W++)A=W,S+=this.GetColWidths(A);S>0&&(C=S),d=0;for(var x=N,k=N+E-1;x<=k;x++)A=x,d+=this.GetRowHeights(A);d>0&&(T=d),m=0;for(var V=b,H=y-1;V<=H;V++)A=V,m+=this.GetColWidths(A);f=0;for(var U=N,z=M-1;U<=z;U++)A=U,f+=this.GetRowHeights(A);L.$assign(pas["WEBLib.TMSFNCTypes"].RectF(t-m,e-f,t-m+C+1,e-f+T+1)),null==g&&(g=D.$create("Create$1",[this]),rtl.length(this.FCellArray)<=l&&(this.FCellArray=rtl.arraySetLength(this.FCellArray,[],l+1)),rtl.length(this.FCellArray[l])<=h&&(this.FCellArray[l]=rtl.arraySetLength(this.FCellArray[l],null,h+1))),null!=g&&(g.FScaleFactor=this.FPaintScaleFactor,this.FCellArray[b][N]=g,G="",this.DoGetCellData(b,N,{get:function(){return G},set:function(t){G=t}}),pas["WEBLib.TMSFNCGridCell"].TTMSFNCGridCell.isPrototypeOf(g)&&(P=0,this.DoGetCellRotation(b,N,{get:function(){return P},set:function(t){P=t}}),rtl.as(g,pas["WEBLib.TMSFNCGridCell"].TTMSFNCGridCell).SetAngle(P),rtl.as(g,pas["WEBLib.TMSFNCGridCell"].TTMSFNCGridCell).FOnBeforeDraw=rtl.createCallback(this,"DoBeforeDrawCell"),rtl.as(g,pas["WEBLib.TMSFNCGridCell"].TTMSFNCGridCell).FOnAfterDraw=rtl.createCallback(this,"DoAfterDrawCell"),rtl.as(g,pas["WEBLib.TMSFNCGridCell"].TTMSFNCGridCell).SetLayout(null),rtl.as(g,pas["WEBLib.TMSFNCGridCell"].TTMSFNCGridCell).SetText(G),rtl.as(g,pas["WEBLib.TMSFNCGridCell"].TTMSFNCGridCell).SetDisplayHTMLFormatting(this.FOptions.FCell.FDisplayHTMLFormatting),rtl.as(g,pas["WEBLib.TMSFNCGridCell"].TTMSFNCGridCell).FBitmapContainer=this.GetBitmapContainer(),rtl.as(g,pas["WEBLib.TMSFNCGridCell"].TTMSFNCGridCell).FOptimizedHTMLDrawing=this.FOptimizedHTMLDrawing),pas["WEBLib.TMSFNCGridCell"].TTMSFNCProgressGridCell.isPrototypeOf(g)&&(rtl.as(g,pas["WEBLib.TMSFNCGridCell"].TTMSFNCProgressGridCell).SetFormat(this.FAppearance.FProgressLayout.FFormat),rtl.as(g,pas["WEBLib.TMSFNCGridCell"].TTMSFNCProgressGridCell).SetTextColor(this.FAppearance.FProgressLayout.FTextColor),rtl.as(g,pas["WEBLib.TMSFNCGridCell"].TTMSFNCProgressGridCell).SetColor(this.FAppearance.FProgressLayout.FColor),rtl.as(g,pas["WEBLib.TMSFNCGridCell"].TTMSFNCProgressGridCell).SetShowText(this.FAppearance.FProgressLayout.FShowText)),pas["WEBLib.TMSFNCGridCell"].TTMSFNCNodeGridCell.isPrototypeOf(g)&&(rtl.as(g,pas["WEBLib.TMSFNCGridCell"].TTMSFNCNodeGridCell).FOnControlClick=rtl.createCallback(this,"DoNodeClick")),pas["WEBLib.TMSFNCGridCell"].TTMSFNCCommentGridCell.isPrototypeOf(g)&&(rtl.as(g,pas["WEBLib.TMSFNCGridCell"].TTMSFNCCommentGridCell).FOnControlClick=rtl.createCallback(this,"DoCommentClick")),pas["WEBLib.TMSFNCGridCell"].TTMSFNCBitmapGridCell.isPrototypeOf(g)&&(rtl.as(g,pas["WEBLib.TMSFNCGridCell"].TTMSFNCBitmapGridCell).FOnControlClick=rtl.createCallback(this,"DoBitmapClick")),pas["WEBLib.TMSFNCGridCell"].TTMSFNCFixedGridCell.isPrototypeOf(g)&&(rtl.as(g,pas["WEBLib.TMSFNCGridCell"].TTMSFNCFixedGridCell).FOnControlClick=rtl.createCallback(this,"DoFixedDropDownButtonClick")),g.SetLeft(L.Left),g.SetTop(L.Top),g.SetWidth(L.Right-L.Left),g.SetHeight(L.Bottom-L.Top),pas["WEBLib.TMSFNCGridCell"].TTMSFNCCheckGridCell.isPrototypeOf(g)&&(rtl.as(g,pas["WEBLib.TMSFNCGridCell"].TTMSFNCCheckGridCell).FOnCheckChanged=rtl.createCallback(this,"DoCheckBoxClick")),pas["WEBLib.TMSFNCGridCell"].TTMSFNCButtonGridCell.isPrototypeOf(g)&&(rtl.as(g,pas["WEBLib.TMSFNCGridCell"].TTMSFNCButtonGridCell).FOnControlClick=rtl.createCallback(this,"DoButtonClick")),pas["WEBLib.TMSFNCGridCell"].TTMSFNCRadioGridCell.isPrototypeOf(g)&&(rtl.as(g,pas["WEBLib.TMSFNCGridCell"].TTMSFNCRadioGridCell).FOnCheckChanged=rtl.createCallback(this,"DoRadioButtonClick")),this.ApplyCellState(b,N,g),pas["WEBLib.TMSFNCGridCell"].TTMSFNCGridCell.isPrototypeOf(g)&&(I.Assign(rtl.as(g,pas["WEBLib.TMSFNCGridCell"].TTMSFNCGridCell).FLayout),this.DoGetCellLayout(b,N,I,this.GetCellState(b,N)),rtl.as(g,pas["WEBLib.TMSFNCGridCell"].TTMSFNCGridCell).AssignLayout(I)),this.DoGetCellProperties(b,N,g)),t+=c,l+=1}t=i,e+=u,h+=1,l=o}I=rtl.freeLoc(I)},this.DisplayCellsNormal=function(t,e,i,s,o,n,r,a,l,h,F,p){var c=0,u=0,C=0,T=0,S=0,d=0,m=0,f=0,g=null,y=0,M=0,b=0,N=0,B=0,E=0,D=null,L=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),G="",A=0,I=null,P=0;I=pas["WEBLib.TMSFNCGridCell"].TTMSFNCGridCellLayout.$create("Create$1");for(var w=o,$=n;w<=$;w++){y=w,c=this.GetColWidths(y);for(var R=r,v=a;R<=v;R++){M=R,null!=this.FAdapter&&this.FAdapter.StartBuild(M),b=y,N=M,B=0,E=0,u=this.GetRowHeights(M),this.DoGetCellMergeInfo(y,M,{get:function(){return b},set:function(t){b=t}},{get:function(){return N},set:function(t){N=t}},{get:function(){return B},set:function(t){B=t}},{get:function(){return E},set:function(t){E=t}}),D=null,this.DoGetCellClass(b,N,{get:function(){return D},set:function(t){D=t}}),g=null,rtl.length(this.FCellArray)>l&&rtl.length(this.FCellArray[l])>h&&(g=this.FCellArray[l][h]),null!=g&&g.$class.ClassType()!==D&&(g=rtl.freeLoc(g),g=null,this.FCellArray[l][h]=null),C=c,T=u,S=0;for(var W=b,O=b+B-1;W<=O;W++)A=W,S+=this.GetColWidths(A);S>0&&(C=S),d=0;for(var x=N,k=N+E-1;x<=k;x++)A=x,d+=this.GetRowHeights(A);d>0&&(T=d),m=0;for(var V=b,H=y-1;V<=H;V++)A=V,m+=this.GetColWidths(A);f=0;for(var U=N,z=M-1;U<=z;U++)A=U,f+=this.GetRowHeights(A);L.$assign(pas["WEBLib.TMSFNCTypes"].RectF(t-m,e-f,t-m+C+1,e-f+T+1)),pas["WEBLib.TMSFNCTypes"].OffsetRectEx$1(L,this.GetContentRect().Left,this.GetContentRect().Top),null==g&&(g=D.$create("Create$1",[this]),rtl.length(this.FCellArray)<=l&&(this.FCellArray=rtl.arraySetLength(this.FCellArray,[],l+1)),rtl.length(this.FCellArray[l])<=h&&(this.FCellArray[l]=rtl.arraySetLength(this.FCellArray[l],null,h+1))),null!=g&&(P=0,this.DoGetCellRotation(b,N,{get:function(){return P},set:function(t){P=t}}),rtl.as(g,pas["WEBLib.TMSFNCGridCell"].TTMSFNCGridCell).SetAngle(P),g.FScaleFactor=this.FPaintScaleFactor,this.FCellArray[l][h]=g,G="",this.DoGetCellData(b,N,{get:function(){return G},set:function(t){G=t}}),pas["WEBLib.TMSFNCGridCell"].TTMSFNCGridCell.isPrototypeOf(g)&&(rtl.as(g,pas["WEBLib.TMSFNCGridCell"].TTMSFNCGridCell).FOnBeforeDraw=rtl.createCallback(this,"DoBeforeDrawCell"),rtl.as(g,pas["WEBLib.TMSFNCGridCell"].TTMSFNCGridCell).FOnAfterDraw=rtl.createCallback(this,"DoAfterDrawCell"),rtl.as(g,pas["WEBLib.TMSFNCGridCell"].TTMSFNCGridCell).SetLayout(null),rtl.as(g,pas["WEBLib.TMSFNCGridCell"].TTMSFNCGridCell).SetText(G),rtl.as(g,pas["WEBLib.TMSFNCGridCell"].TTMSFNCGridCell).SetDisplayHTMLFormatting(this.FOptions.FCell.FDisplayHTMLFormatting),rtl.as(g,pas["WEBLib.TMSFNCGridCell"].TTMSFNCGridCell).FBitmapContainer=this.GetBitmapContainer(),rtl.as(g,pas["WEBLib.TMSFNCGridCell"].TTMSFNCGridCell).FOptimizedHTMLDrawing=this.FOptimizedHTMLDrawing),pas["WEBLib.TMSFNCGridCell"].TTMSFNCProgressGridCell.isPrototypeOf(g)&&(rtl.as(g,pas["WEBLib.TMSFNCGridCell"].TTMSFNCProgressGridCell).SetFormat(this.FAppearance.FProgressLayout.FFormat),rtl.as(g,pas["WEBLib.TMSFNCGridCell"].TTMSFNCProgressGridCell).SetTextColor(this.FAppearance.FProgressLayout.FTextColor),rtl.as(g,pas["WEBLib.TMSFNCGridCell"].TTMSFNCProgressGridCell).SetColor(this.FAppearance.FProgressLayout.FColor),rtl.as(g,pas["WEBLib.TMSFNCGridCell"].TTMSFNCProgressGridCell).SetShowText(this.FAppearance.FProgressLayout.FShowText)),pas["WEBLib.TMSFNCGridCell"].TTMSFNCNodeGridCell.isPrototypeOf(g)&&(rtl.as(g,pas["WEBLib.TMSFNCGridCell"].TTMSFNCNodeGridCell).FOnControlClick=rtl.createCallback(this,"DoNodeClick")),pas["WEBLib.TMSFNCGridCell"].TTMSFNCCommentGridCell.isPrototypeOf(g)&&(rtl.as(g,pas["WEBLib.TMSFNCGridCell"].TTMSFNCCommentGridCell).FOnControlClick=rtl.createCallback(this,"DoCommentClick")),pas["WEBLib.TMSFNCGridCell"].TTMSFNCBitmapGridCell.isPrototypeOf(g)&&(rtl.as(g,pas["WEBLib.TMSFNCGridCell"].TTMSFNCBitmapGridCell).FOnControlClick=rtl.createCallback(this,"DoBitmapClick")),pas["WEBLib.TMSFNCGridCell"].TTMSFNCFixedGridCell.isPrototypeOf(g)&&(rtl.as(g,pas["WEBLib.TMSFNCGridCell"].TTMSFNCFixedGridCell).FOnControlClick=rtl.createCallback(this,"DoFixedDropDownButtonClick")),g.SetLeft(L.Left),g.SetTop(L.Top),g.SetWidth(L.Right-L.Left),g.SetHeight(L.Bottom-L.Top),pas["WEBLib.TMSFNCGridCell"].TTMSFNCCheckGridCell.isPrototypeOf(g)&&(rtl.as(g,pas["WEBLib.TMSFNCGridCell"].TTMSFNCCheckGridCell).FOnCheckChanged=rtl.createCallback(this,"DoCheckBoxClick")),pas["WEBLib.TMSFNCGridCell"].TTMSFNCButtonGridCell.isPrototypeOf(g)&&(rtl.as(g,pas["WEBLib.TMSFNCGridCell"].TTMSFNCButtonGridCell).FOnControlClick=rtl.createCallback(this,"DoButtonClick")),pas["WEBLib.TMSFNCGridCell"].TTMSFNCRadioGridCell.isPrototypeOf(g)&&(rtl.as(g,pas["WEBLib.TMSFNCGridCell"].TTMSFNCRadioGridCell).FOnCheckChanged=rtl.createCallback(this,"DoRadioButtonClick")),this.ApplyCellState(b,N,g),pas["WEBLib.TMSFNCGridCell"].TTMSFNCGridCell.isPrototypeOf(g)&&(I.Assign(rtl.as(g,pas["WEBLib.TMSFNCGridCell"].TTMSFNCGridCell).FLayout),this.DoGetCellLayout(b,N,I,this.GetCellState(b,N)),rtl.as(g,pas["WEBLib.TMSFNCGridCell"].TTMSFNCGridCell).AssignLayout(I)),this.DoGetCellProperties(b,N,g)),e+=u,h+=1}e=s,t+=c,l+=1,h=F}I=rtl.freeLoc(I)},this.Create$1=function(e){return pas["WEBLib.TMSFNCGridData"].TTMSFNCGridData.Create$1.apply(this,arguments),this.UpdateScrollingMode(1),this.ChangeCursor=!0,this.FLeftC=0,this.FTopr=0,this.FFreezeRows=0,this.FFreezeColumns=0,this.FToolBarPopupMode=0,this.FFreeEditControlTimer=pas["WEBLib.ExtCtrls"].TTimer.$create("Create$1",[this]),this.FFreeEditControlTimer.SetInterval(1),this.FFreeEditControlTimer.SetEnabled(!1),this.FFreeEditControlTimer.FOnTimer=rtl.createCallback(this,"DoFreeEditControl"),this.FAnimateTimer$1=pas["WEBLib.ExtCtrls"].TTimer.$create("Create$1",[this]),this.FAnimateTimer$1.SetInterval(1),this.FAnimateTimer$1.SetEnabled(!1),this.FAnimateTimer$1.FOnTimer=rtl.createCallback(this,"Animate$1"),this.FScrollTimer=pas["WEBLib.ExtCtrls"].TTimer.$create("Create$1",[this]),this.FScrollTimer.FOnTimer=rtl.createCallback(this,"ScrollTimer"),this.FScrollTimer.SetInterval(this.FOptions.FMouse.FAutoScrollingInterval),this.FScrollTimer.SetEnabled(!1),this.FDragTimer=pas["WEBLib.ExtCtrls"].TTimer.$create("Create$1",[this]),this.FDragTimer.FOnTimer=rtl.createCallback(this,"DragTimer"),this.FDragTimer.SetInterval(this.FOptions.FMouse.FAutoScrollingInterval),this.FDragTimer.SetEnabled(!1),this.FActiveCommentTextColor=0,this.FActiveComment="",this.FFilterListBox=pas["WEBLib.StdCtrls"].TListBox.$create("Create$1",[this]),this.FFilterListBox.FTag$1=-1,this.FFilterListBox.FOnClick=rtl.createCallback(this,"HandleFilterListClick"),this.FFilterTimer=pas["WEBLib.ExtCtrls"].TTimer.$create("Create$1",[this]),this.FFilterTimer.FOnTimer=rtl.createCallback(this,"HandleFilterTimer"),this.FFilterTimer.SetInterval(100),this.FFilterTimer.SetEnabled(!1),this.FCommentPopup=pas["WEBLib.TMSFNCPopup"].TTMSFNCPopup.$create("Create$1",[this]),this.FCommentPopup.SetPlacement(9),this.FCommentPopup.FOnPopupPaint=rtl.createCallback(this,"DoPaintCommentPopup"),this.FFilterPopup=pas["WEBLib.TMSFNCPopup"].TTMSFNCPopup.$create("Create$1",[this]),this.FFilterPopup.SetPlacement(9),this.FAppearance=t.TTMSFNCGridAppearance.$create("Create$1"),this.FAppearance.FOnChange=rtl.createCallback(this,"AppearanceChanged"),this.SetWidth(370),this.SetHeight(270),this.IsDesignTime()&&this.InitSample(),this.FDesignTimeSampleData=!0,this},this.Destroy=function(){pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FDragTimer},set:function(t){this.p.FDragTimer=t}}),pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FFilterTimer},set:function(t){this.p.FFilterTimer=t}}),pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FScrollTimer},set:function(t){this.p.FScrollTimer=t}}),pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FAnimateTimer$1},set:function(t){this.p.FAnimateTimer$1=t}}),pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FFreeEditControlTimer},set:function(t){this.p.FFreeEditControlTimer=t}}),this.RemoveAllCells(),null!=this.FDummyButtonBitmap&&rtl.free(this,"FDummyButtonBitmap"),null!=this.FNodeOpenBitmap&&rtl.free(this,"FNodeOpenBitmap"),null!=this.FNodeClosedBitmap&&rtl.free(this,"FNodeClosedBitmap"),null!=this.FCellMemo&&rtl.free(this,"FCellMemo"),null!=this.FCellEdit&&rtl.free(this,"FCellEdit"),null!=this.FCellColorPicker&&rtl.free(this,"FCellColorPicker"),null!=this.FCellSpinBox&&rtl.free(this,"FCellSpinBox"),null!=this.FCellComboBox&&rtl.free(this,"FCellComboBox"),null!=this.FCellDatePicker&&rtl.free(this,"FCellDatePicker"),null!=this.FCellTrackBar&&rtl.free(this,"FCellTrackBar"),rtl.free(this,"FFilterListBox"),rtl.free(this,"FCommentPopup"),rtl.free(this,"FFilterPopup"),rtl.free(this,"FAppearance"),pas["WEBLib.TMSFNCGridData"].TTMSFNCGridData.Destroy.call(this)},this.VisibleRowCount=function(){return this.FRStop-this.FRStart+this.FFixedFooterRows+this.GetFixedRows()+1},this.GetDisplayCell=function(t){var e,i=pas["WEBLib.TMSFNCGridData"].TTMSFNCGridCellRec.$new(),s=0;return e=rtl.length(this.FCellArray)-1,t.Col>this.GetColumnCount()-1-this.FFixedRightColumns?i.Col=this.FCStop-this.FCStart+this.FFixedRightColumns+this.FFixedColumns-(this.GetColumnCount()-t.Col-1):t.Col>=this.GetFixedCols()?i.Col=t.Col-this.FCStart+this.GetFixedCols():i.Col=t.Col,i.Col=Math.max(0,Math.min(i.Col,e)),s=0,i.Col>=0&&i.Col<=e&&(s=rtl.length(this.FCellArray[i.Col])-1,t.Row>this.GetRowCount()-1-this.FFixedRightColumns?i.Row=this.FRStop-this.FRStart+this.FFixedFooterRows+this.FFixedRows-(this.GetRowCount()-t.Row-1):t.Row>=this.GetFixedRows()?i.Row=t.Row-this.FRStart+this.GetFixedRows():i.Row=t.Row),i.Row=Math.max(0,Math.min(i.Row,s)),i},this.GetRealCell=function(t){var e=pas["WEBLib.TMSFNCGridData"].TTMSFNCGridCellRec.$new();return t.Col>rtl.length(this.FCellArray)-1-this.FFixedRightColumns?e.Col=this.GetColumnCount()-1-(rtl.length(this.FCellArray)-1-t.Col):t.Col>=this.GetFixedCols()?e.Col=t.Col+this.FCStart-this.GetFixedCols():e.Col=t.Col,t.Col>=0&&t.Col<=rtl.length(this.FCellArray)-1&&(t.Row>rtl.length(this.FCellArray[t.Col])-1-this.FFixedRightColumns?e.Row=this.GetRowCount()-1-(rtl.length(this.FCellArray[t.Col])-1-t.Row):t.Row>=this.GetFixedRows()?e.Row=t.Row+this.FRStart-this.GetFixedRows():e.Row=t.Row),e},this.GetCellObject=function(t){var e=null;return e=null,t.Col>=0&&t.Col<=rtl.length(this.FCellArray)-1&&t.Row>=0&&t.Row<=rtl.length(this.FCellArray[t.Col])-1&&(e=this.FCellArray[t.Col][t.Row]),e},this.GetCellByObject=function(t){var e=pas["WEBLib.TMSFNCGridData"].TTMSFNCGridCellRec.$new(),i=0,s=0;e.Col=-1,e.Row=-1;for(var o=0,n=rtl.length(this.FCellArray)-1;o<=n;o++){i=o;for(var r=0,a=rtl.length(this.FCellArray[i])-1;r<=a;r++)if(s=r,this.FCellArray[i][s]===t)return e.Col=i,e.Row=s,e.$assign(this.GetRealCell(pas["WEBLib.TMSFNCGridData"].TTMSFNCGridCellRec.$clone(e))),e}return e},this.GetTotalColumnWidth=function(){var t=0,e=0;t=(this.GetColumnCount()-Math.min(this.GetColumnCount(),this.FColumnW.GetCount()))*this.FDefaultColumnWidth;for(var i=0,s=Math.min(this.GetColumnCount()-1,this.FColumnW.GetCount()-1);i<=s;i++)e=i,t+=this.FColumnW.GetItem$1(e).FValue;return t},this.GetTotalRowHeight=function(){var t=0,e=0;t=(this.GetRowCount()-Math.min(this.GetRowCount(),this.FRowH.GetCount()))*this.FDefaultRowHeight;for(var i=0,s=Math.min(this.GetRowCount()-1,this.FRowH.GetCount()-1);i<=s;i++)e=i,t+=this.FRowH.GetItem$1(e).FValue;return t},this.GetTotalContentWidth=function(){return pas["WEBLib.TMSFNCCustomScrollControl"].TTMSFNCCustomScrollControl.GetTotalContentWidth.call(this),this.FContainerWidth},this.GetTotalContentHeight=function(){return pas["WEBLib.TMSFNCCustomScrollControl"].TTMSFNCCustomScrollControl.GetTotalContentHeight.call(this),this.FContainerHeight},this.EndUpdate=function(){pas["WEBLib.TMSFNCCustomScrollControl"].TTMSFNCCustomScrollControl.EndUpdate.call(this),null!=this.FDragTimer&&this.FDragTimer.SetInterval(this.FOptions.FMouse.FAutoScrollingInterval),null!=this.FScrollTimer&&this.FScrollTimer.SetInterval(this.FOptions.FMouse.FAutoScrollingInterval)},this.RemoveAllCells=function(){for(var t=0,e=0,i=0,s=rtl.length(this.FCellArray)-1;i<=s;i++){t=i;for(var o=0,n=rtl.length(this.FCellArray[t])-1;o<=n;o++)e=o,null!=this.FCellArray[t][e]&&(rtl.free(this.FCellArray[t],e),this.FCellArray[t][e]=null)}this.FCellArray=rtl.arraySetLength(this.FCellArray,[],0)},this.ExportNotification=function(t,e){pas["WEBLib.TMSFNCGridData"].TTMSFNCGridData.ExportNotification.apply(this,arguments),null!=this.FAdapter&&this.FAdapter.ExportNotification(t,e)},this.ApplyCellState=function(t,e,i){var s=null,o=null,n=0;if(pas["WEBLib.TMSFNCGridCell"].TTMSFNCGridCell.isPrototypeOf(i)&&null!=(s=rtl.as(i,pas["WEBLib.TMSFNCGridCell"].TTMSFNCGridCell))){if(0!==this.FOptions.FSelection.FMode&&this.GetFocusedCell().Row===e&&this.GetFocusedCell().Col===t&&this.IsFocused()?s.AssignLayout(this.GetCellAppearance(1,t,e)):this.IsFixed(t,e)?0!==this.FOptions.FSelection.FMode&&this.FOptions.FSelection.FShowSelectionInFixedCells&&this.DoIsFixedCellSelected(t,e)&&!this.IsNormalFixed(t,e)?s.AssignLayout(this.GetCellAppearance(3,t,e)):s.AssignLayout(this.GetCellAppearance(2,t,e)):0!==this.FOptions.FSelection.FMode&&this.DoIsCellSelected(t,e)?s.AssignLayout(this.GetCellAppearance(4,t,e)):s.AssignLayout(this.GetCellAppearance(0,t,e)),this.IsFixed(t,e)){var r=this.FOptions.FBorders.FFixedCellBorders;0===r?s.FLayout.SetSides({}):2===r?s.FLayout.SetSides(rtl.diffSet(s.FLayout.FSides,rtl.createSet(1,3))):3===r&&s.FLayout.SetSides(rtl.diffSet(s.FLayout.FSides,rtl.createSet(0,2)))}else{var a=this.FOptions.FBorders.FCellBorders;0===a?s.FLayout.SetSides({}):2===a?s.FLayout.SetSides(rtl.diffSet(s.FLayout.FSides,rtl.createSet(1,3))):3===a&&s.FLayout.SetSides(rtl.diffSet(s.FLayout.FSides,rtl.createSet(0,2)))}if(pas["WEBLib.TMSFNCGridCell"].TTMSFNCFixedGridCell.isPrototypeOf(s)&&e===this.FOptions.FSorting.FRow){(o=rtl.as(s,pas["WEBLib.TMSFNCGridCell"].TTMSFNCFixedGridCell)).FSortIndex=-1,o.FSortKind=0;var l=this.FOptions.FSorting.FMode;if(0===l)o.FSortKind=0;else if(1===l){if(t===this.FSortColumn){var h=this.FSortDirection;0===h?o.FSortKind=1:1===h&&(o.FSortKind=2)}}else 2===l&&-1!==(n=this.FSortIndexes.FindIndex(t))&&(o.FSortIndex=n+1,this.FSortIndexes.GetSortDirections(n)?o.FSortKind=1:o.FSortKind=2)}}},this.GetCellState=function(t,e){return 0!==this.FOptions.FSelection.FMode&&this.GetFocusedCell().Row===e&&this.GetFocusedCell().Col===t?1:this.IsFixed(t,e)?0!==this.FOptions.FSelection.FMode&&this.FOptions.FSelection.FShowSelectionInFixedCells&&this.DoIsFixedCellSelected(t,e)?3:2:0!==this.FOptions.FSelection.FMode&&this.DoIsCellSelected(t,e)?4:0},this.XYToCell=function(t,e){var i=pas["WEBLib.TMSFNCGridData"].TTMSFNCGridCellRec.$new(),s=0,o=0,n=pas["WEBLib.TMSFNCTypes"].TRectF.$new();if(i.Row=-1,i.Col=-1,0===this.GetRowCount()||0===this.GetColumnCount())return i;if(n.$assign(this.GetContentRect()),!pas["WEBLib.TMSFNCTypes"].PtInRectEx(n,pas["WEBLib.TMSFNCTypes"].PointF(t,e)))return i;if(e<this.GetFixedHeight()){o=0;for(var r=0,a=this.GetFixedRows();r<=a;r++)if(s=r,(o+=this.GetRowHeights(s))>=e){i.Row=s;break}}else if(e>n.Bottom-n.Top-this.GetFixedFooterHeight()){o=n.Bottom-n.Top;for(var l=this.GetRowCount()-1,h=this.GetRowCount()-1-this.FFixedFooterRows;l>=h;l--)if(s=l,(o-=this.GetRowHeights(s))<=e){i.Row=s;break}}else{o=this.GetCellContainerPosY();for(var F=0,p=this.FRStop;F<=p;F++)if(s=F,(o+=this.GetRowHeights(s))>=e){i.Row=s;break}}if(t<this.GetFixedWidth()){o=0;for(var c=0,u=this.GetFixedCols();c<=u;c++)if(s=c,(o+=this.GetColWidths(s))>=t){i.Col=s;break}}else if(t>n.Right-n.Left-this.GetFixedRightWidth()){o=n.Right-n.Left;for(var C=this.GetColumnCount()-1,T=this.GetColumnCount()-1-this.FFixedRightColumns;C>=T;C--)if(s=C,(o-=this.GetColWidths(s))<=t){i.Col=s;break}}else{o=this.GetCellContainerPosX();for(var S=0,d=this.FCStop;S<=d;S++)if(s=S,(o+=this.GetColWidths(s))>=t){i.Col=s;break}}return i},this.GetFixedCols=function(){return this.FFixedColumns+this.FFreezeColumns},this.GetFixedRows=function(){return this.FFixedRows+this.FFreezeRows},this.GetFixedWidth=function(){var t=0,e=0;t=0;for(var i=0,s=this.FFixedColumns+this.FFreezeColumns-1;i<=s;i++)e=i,t+=this.GetColWidths(e);return t},this.GetFixedHeight=function(){var t=0,e=0;t=0;for(var i=0,s=this.FFixedRows+this.FFreezeRows-1;i<=s;i++)e=i,t+=this.GetRowHeights(e);return t},this.GetFixedRightWidth=function(){var t=0,e=0;t=0;for(var i=this.GetColumnCount()-1,s=this.GetColumnCount()-this.FFixedRightColumns;i>=s;i--)e=i,t+=this.GetColWidths(e);return t},this.GetFixedFooterHeight=function(){var t=0,e=0;t=0;for(var i=this.GetRowCount()-1,s=this.GetRowCount()-this.FFixedFooterRows;i>=s;i--)e=i,t+=this.GetRowHeights(e);return t},this.GetCellContainerPosX=function(){return this.FCellPosX},this.GetCellContainerPosY=function(){return this.FCellPosY},this.ColumnStretchingActive=function(){return this.FOptions.FColumnSize.FStretch&&this.FOptions.FColumnSize.FStretchAll},this.DrawContent=function(t,e){var i=0,s=0,o=0,n=0;pas["WEBLib.TMSFNCCustomScrollControl"].TTMSFNCCustomScrollControl.DrawContent.apply(this,arguments),t.FBitmapContainer=this.GetBitmapContainer(),i=this.GetFixedCols(),s=this.GetFixedRows(),o=this.FFixedRightColumns,n=this.FFixedFooterRows,this.GetColumnCount()>this.FFixedColumns&&this.GetRowCount()>this.FFixedRows&&this.PaintCells(t,this.FCStart,this.FCStop,this.FRStart,this.FRStop,i,s,s),this.GetRowCount()>this.FFixedRows&&this.PaintCells(t,0,i-1,this.FRStart,this.FRStop,0,s,s),this.GetColumnCount()>this.FFixedColumns&&this.PaintCells(t,this.FCStart,this.FCStop,0,s-1,i,0,0),this.PaintCells(t,0,i-1,0,s-1,0,0,0),this.GetColumnCount()>this.FFixedColumns+this.FFixedRightColumns&&this.GetRowCount()>this.FFixedRows&&(this.PaintCells(t,this.GetColumnCount()-o,this.GetColumnCount()-1,this.FRStart,this.FRStop,this.FCStop-this.FCStart+i+1,s,s),this.PaintCells(t,this.GetColumnCount()-o,this.GetColumnCount()-1,0,s-1,this.FCStop-this.FCStart+i+1,0,0)),this.GetColumnCount()>this.FFixedColumns&&this.GetRowCount()>this.FFixedRows+this.FFixedFooterRows&&this.PaintCells(t,this.FCStart,this.FCStop,this.GetRowCount()-n,this.GetRowCount()-1,i,this.FRStop-this.FRStart+s+1,this.FRStop-this.FRStart+s+1),this.GetColumnCount()>this.FFixedColumns+this.FFixedRightColumns&&this.GetRowCount()>this.FFixedRows+this.FFixedFooterRows&&this.PaintCells(t,this.GetColumnCount()-o,this.GetColumnCount()-1,this.GetRowCount()-n,this.GetRowCount()-1,this.FCStop-this.FCStart+i+1,this.FRStop-this.FRStart+s+1,this.FRStop-this.FRStart+s+1),this.GetRowCount()>this.FFixedRows&&this.PaintCells(t,0,i-1,this.GetRowCount()-n,this.GetRowCount()-1,0,this.FRStop-this.FRStart+s+1,this.FRStop-this.FRStart+s+1)},this.Assign=function(e){t.TTMSFNCCustomGrid.isPrototypeOf(e)&&(this.FAppearance.Assign(rtl.as(e,t.TTMSFNCCustomGrid).FAppearance),this.FOptions.Assign(rtl.as(e,t.TTMSFNCCustomGrid).FOptions),this.SetColumnCount(rtl.as(e,t.TTMSFNCCustomGrid).GetColumnCount()),this.SetRowCount(rtl.as(e,t.TTMSFNCCustomGrid).GetRowCount()),this.SetFixedColumns(rtl.as(e,t.TTMSFNCCustomGrid).FFixedColumns),this.SetFixedRows(rtl.as(e,t.TTMSFNCCustomGrid).FFixedRows),this.SetFixedRightColumns(rtl.as(e,t.TTMSFNCCustomGrid).FFixedRightColumns),this.SetFixedFooterRows(rtl.as(e,t.TTMSFNCCustomGrid).FFixedFooterRows),this.SetFreezeColumns(rtl.as(e,t.TTMSFNCCustomGrid).FFreezeColumns),this.SetFreezeRows(rtl.as(e,t.TTMSFNCCustomGrid).FFreezeRows),this.SetBitmapContainer(rtl.as(e,t.TTMSFNCCustomGrid).GetBitmapContainer()),this.SetEnabled(rtl.as(e,t.TTMSFNCCustomGrid).FEnabled),this.SetDefaultColumnWidth(rtl.as(e,t.TTMSFNCCustomGrid).FDefaultColumnWidth),this.SetDefaultRowHeight(rtl.as(e,t.TTMSFNCCustomGrid).FDefaultRowHeight),this.SetLeftCol(rtl.as(e,t.TTMSFNCCustomGrid).GetLeftCol()),this.SetTopRow(rtl.as(e,t.TTMSFNCCustomGrid).GetTopRow()))},this.EditCell=function(e,i,s,o,n){function r(t,e){var i=pas.Types.TPoint.$new();return i.x=t,i.y=e,i}var a=null,l="",h=null,F=pas["WEBLib.TMSFNCGridData"].TTMSFNCGridCellRec.$new(),p=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),c=!1,u=0,C=0,T=!1,S="",d=null,m=null,f=0,g=rtl.createIntfRefs();try{if(!this.FOptions.FEditing.FEnabled||this.IsFixed(e.Col,e.Row))return;if(this.Navigate(pas["WEBLib.TMSFNCGridData"].TTMSFNCGridCellRec.$clone(e),!1),c=!1,this.DoGetCellReadOnly(e.Col,e.Row,{get:function(){return c},set:function(t){c=t}}),T=this.DoGetCellIsDataCheckBox(e.Col,e.Row),c||T)return;if(null!=this.FAdapter&&this.FAdapter.CellBeforeEdit(e.Col,e.Row),F.$assign(this.GetDisplayCell(pas["WEBLib.TMSFNCGridData"].TTMSFNCGridCellRec.$clone(e))),h=null,F.Col>=0&&F.Col<=rtl.length(this.FCellArray)-1&&F.Row>=0&&F.Row<=rtl.length(this.FCellArray[F.Col])-1&&(h=this.FCellArray[F.Col][F.Row]),null!=h&&pas["WEBLib.TMSFNCGridCell"].TTMSFNCGridCell.isPrototypeOf(h)){if(u=0,this.FEditControl=this.GetCellEdit(),a=t.TTMSFNCGridEdit,this.DoGetCellEditorType(e.Col,e.Row,{get:function(){return u},set:function(t){u=t}}),18===u)this.DoGetCellEditorCustomClassType(e.Col,e.Row,{get:function(){return a},set:function(t){a=t}}),null!==a&&(this.FEditControl=a.$create("Create$1",[this]),this.FEditControl.SetShowFocus(!1),this.FEditControl.FOnKeyDown=rtl.createCallback(this,"CellControlKeyDown"),this.FEditControl.FOnExit=rtl.createCallback(this,"CellExit"));else{var y=u;17===y?this.FEditControl=this.GetCellMemo():13===y?this.FEditControl=this.GetCellSpinBox():15===y?this.FEditControl=this.GetCellColorPicker():12===y?this.FEditControl=this.GetCellComboBox():14===y?this.FEditControl=this.GetCellDatePicker():16===y?this.FEditControl=this.GetCellTrackBar():0===y?this.GetCellEdit().SetEditType$1(0):1===y?this.GetCellEdit().SetEditType$1(1):2===y?this.GetCellEdit().SetEditType$1(2):3===y?this.GetCellEdit().SetEditType$1(3):4===y?this.GetCellEdit().SetEditType$1(4):5===y?this.GetCellEdit().SetEditType$1(5):6===y?this.GetCellEdit().SetEditType$1(6):7===y?this.GetCellEdit().SetEditType$1(7):8===y?this.GetCellEdit().SetEditType$1(8):9===y?this.GetCellEdit().SetEditType$1(9):10===y?this.GetCellEdit().SetEditType$1(10):11===y&&this.GetCellEdit().SetEditType$1(11),u in rtl.createSet(0)&&0!==this.FOptions.FEditing.FAutoComplete&&(this.GetCellEdit().FLookup.FDisplayList.Assign(this.FOptions.FEditing.FAutoCompleteItems),this.GetCellEdit().FAutoComplete=1===this.FOptions.FEditing.FAutoComplete,this.GetCellEdit().FLookup.FEnabled=1!==this.FOptions.FEditing.FAutoComplete)}if(null!=this.FEditControl){if(pas["WEBLib.StdCtrls"].TComboBox.isPrototypeOf(this.FEditControl)&&rtl.as(this.FEditControl,pas["WEBLib.StdCtrls"].TComboBox).SetParent(this),this.DoGetCellEditorProperties(e.Col,e.Row,this.FEditControl),pas["WEBLib.StdCtrls"].TComboBox.isPrototypeOf(this.FEditControl)&&rtl.as(this.FEditControl,pas["WEBLib.StdCtrls"].TComboBox).SetParent(null),l=this.GetCells(e.Col,e.Row),!this.FOptions.FEditing.FEditWithTags&&pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.IsHTML(l)&&(l=pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.HTMLStrip(l)),C=this.GetColors(e.Col,e.Row),t.TTMSFNCGridColorPicker.isPrototypeOf(this.FEditControl)?this.DoCellEditGetColor(e.Col,e.Row,this.FEditControl,{get:function(){return C},set:function(t){C=t}}):this.DoCellEditGetData(e.Col,e.Row,this.FEditControl,{get:function(){return l},set:function(t){l=t}}),pas.SysUtils.Supports$1(g.ref(1,rtl.queryIntfT(this.FEditControl,pas.System.IUnknown)),rtl.getIntfGUIDR(pas["WEBLib.TMSFNCTypes"].ITMSFNCCustomEditor),{get:function(){return m},set:function(t){m=t}})&&s&&m.SetText(o),t.TTMSFNCGridEdit.isPrototypeOf(this.FEditControl)||t.TTMSFNCGridMemo.isPrototypeOf(this.FEditControl)?s?(t.TTMSFNCGridMemo.isPrototypeOf(this.FEditControl)&&rtl.as(this.FEditControl,t.TTMSFNCGridMemo).SetText(""),t.TTMSFNCGridEdit.isPrototypeOf(this.FEditControl)&&rtl.as(this.FEditControl,t.TTMSFNCGridEdit).SetT(""),t.TTMSFNCGridEdit.isPrototypeOf(this.FEditControl)&&u in rtl.createSet(8,3,4,1)&&(this.FEditControl.SetParent(this),this.FEditControl.SelectAll(),this.FEditControl.SetParent(null)),S=o,t.TTMSFNCGridMemo.isPrototypeOf(this.FEditControl)&&rtl.as(this.FEditControl,t.TTMSFNCGridMemo).SetText(S),t.TTMSFNCGridEdit.isPrototypeOf(this.FEditControl)&&rtl.as(this.FEditControl,t.TTMSFNCGridEdit).SetT(S)):(t.TTMSFNCGridMemo.isPrototypeOf(this.FEditControl)&&rtl.as(this.FEditControl,t.TTMSFNCGridMemo).SetText(l),t.TTMSFNCGridEdit.isPrototypeOf(this.FEditControl)&&rtl.as(this.FEditControl,t.TTMSFNCGridEdit).SetT(l)):t.TTMSFNCGridTrackBar.isPrototypeOf(this.FEditControl)?""!==l?rtl.as(this.FEditControl,t.TTMSFNCGridTrackBar).SetPosition(pas.SysUtils.StrToInt(l)):rtl.as(this.FEditControl,t.TTMSFNCGridTrackBar).SetPosition(0):t.TTMSFNCGridColorPicker.isPrototypeOf(this.FEditControl)?rtl.as(this.FEditControl,t.TTMSFNCGridColorPicker).SetSelectedColor(C):t.TTMSFNCGridSpinBox.isPrototypeOf(this.FEditControl)?rtl.as(this.FEditControl,t.TTMSFNCGridSpinBox).SetText(l):t.TTMSFNCGridDatePicker.isPrototypeOf(this.FEditControl)?(rtl.as(this.FEditControl,t.TTMSFNCGridDatePicker).SetParent(this),""===l?(rtl.as(this.FEditControl,t.TTMSFNCGridDatePicker).SetDate(pas.System.Int(pas.SysUtils.Now())),rtl.as(this.FEditControl,t.TTMSFNCGridDatePicker).SetText(pas.SysUtils.DateToStr(pas.SysUtils.Now()))):(rtl.as(this.FEditControl,t.TTMSFNCGridDatePicker).SetDate(pas["WEBLib.TMSFNCTypes"].VarToDateTime(l)),rtl.as(this.FEditControl,t.TTMSFNCGridDatePicker).SetText(l)),rtl.as(this.FEditControl,t.TTMSFNCGridDatePicker).SetParent(null)):t.TTMSFNCGridComboBox.isPrototypeOf(this.FEditControl)&&(rtl.as(this.FEditControl,t.TTMSFNCGridComboBox).SetParent(this),rtl.as(this.FEditControl,t.TTMSFNCGridComboBox).SetItemIndex(rtl.as(this.FEditControl,t.TTMSFNCGridComboBox).FItems.IndexOf(l)),rtl.as(this.FEditControl,t.TTMSFNCGridComboBox).SetParent(null)),d=this.FEditControl,t.TTMSFNCGridEdit.isPrototypeOf(d)){f=rtl.as(d,t.TTMSFNCGridEdit).FFont.FColor,rtl.as(d,t.TTMSFNCGridEdit).FFont.Assign(h.FLayout.FFont),rtl.as(d,t.TTMSFNCGridEdit).FFont.SetColor(f);var M=h.FLayout.FTextAlign;0===M?rtl.as(d,t.TTMSFNCGridEdit).SetAlignment(2):1===M?rtl.as(d,t.TTMSFNCGridEdit).SetAlignment(0):2===M&&rtl.as(d,t.TTMSFNCGridEdit).SetAlignment(1),p.$assign(h.GetTextRect(!1))}else p.$assign(h.GetTextRect(!1));if(d.SetBounds(Math.round(h.FLeft+p.Left),Math.round(h.FTop+p.Top),Math.round(p.Right-p.Left),Math.round(p.Bottom-p.Top)),d.SetBounds(Math.round(d.GetLeft()+(p.Right-p.Left-d.GetWidth())/2),Math.round(d.GetTop()+(p.Bottom-p.Top-d.GetHeight())/2),d.GetWidth(),d.GetHeight()),(pas["WEBLib.StdCtrls"].TCustomEdit.isPrototypeOf(d)||pas["WEBLib.StdCtrls"].TCustomMemo.isPrototypeOf(d))&&!t.TTMSFNCGridSpinBox.isPrototypeOf(d)&&d.GetHeight()>p.Bottom-p.Top&&(d.SetTop(d.GetTop()+4),d.SetHeight(d.GetHeight()-8)),this.FEditControl.SetParent(this),this.FEditControl.SetVisible(!0),this.FEditControl.BringToFront(),pas.SysUtils.Supports$1(g.ref(2,rtl.queryIntfT(this.FEditControl,pas.System.IUnknown)),rtl.getIntfGUIDR(pas["WEBLib.TMSFNCTypes"].ITMSFNCCustomEditor),{get:function(){return m},set:function(t){m=t}}))if(s)m.SetSelStart(m.GetTextLength()),m.SetSelLength(0);else{var b=i;0===b?(m.SetSelStart(0),m.SetSelLength(m.GetTextLength())):1===b?(m.SetSelStart(0),m.SetSelLength(0)):2===b&&(m.SetSelStart(m.GetTextLength()),m.SetSelLength(0))}if(t.TTMSFNCGridEdit.isPrototypeOf(this.FEditControl))try{if(s)rtl.as(this.FEditControl,t.TTMSFNCGridEdit).SetSelStart(rtl.as(this.FEditControl,t.TTMSFNCGridEdit).GetT().length),rtl.as(this.FEditControl,t.TTMSFNCGridEdit).SetSelLength(0);else{var N=i;0===N?(rtl.as(this.FEditControl,t.TTMSFNCGridEdit).SetSelStart(0),rtl.as(this.FEditControl,t.TTMSFNCGridEdit).SetSelLength(rtl.as(this.FEditControl,t.TTMSFNCGridEdit).GetT().length)):1===N?(rtl.as(this.FEditControl,t.TTMSFNCGridEdit).SetSelStart(0),rtl.as(this.FEditControl,t.TTMSFNCGridEdit).SetSelLength(0)):2===N&&(rtl.as(this.FEditControl,t.TTMSFNCGridEdit).SetSelStart(rtl.as(this.FEditControl,t.TTMSFNCGridEdit).GetT().length),rtl.as(this.FEditControl,t.TTMSFNCGridEdit).SetSelLength(0))}}finally{}if(t.TTMSFNCGridMemo.isPrototypeOf(this.FEditControl))if(s)rtl.as(this.FEditControl,t.TTMSFNCGridMemo).FLines.GetCount()>0?rtl.as(this.FEditControl,t.TTMSFNCGridMemo).FCaretPosition.$assign(r(rtl.as(this.FEditControl,t.TTMSFNCGridMemo).FLines.GetCount()-1,rtl.as(this.FEditControl,t.TTMSFNCGridMemo).FLines.Get(rtl.as(this.FEditControl,t.TTMSFNCGridMemo).FLines.GetCount()-1).length)):rtl.as(this.FEditControl,t.TTMSFNCGridMemo).FCaretPosition.$assign(r(0,0)),rtl.as(this.FEditControl,t.TTMSFNCGridMemo).SetSelLength(0);else{var B=i;0===B?(rtl.as(this.FEditControl,t.TTMSFNCGridMemo).FCaretPosition.$assign(r(0,0)),rtl.as(this.FEditControl,t.TTMSFNCGridMemo).SetSelLength(rtl.as(this.FEditControl,t.TTMSFNCGridMemo).FLines.GetCount()-1)):1===B?(rtl.as(this.FEditControl,t.TTMSFNCGridMemo).FCaretPosition.$assign(r(0,0)),rtl.as(this.FEditControl,t.TTMSFNCGridMemo).SetSelLength(0)):2===B&&(rtl.as(this.FEditControl,t.TTMSFNCGridMemo).FLines.GetCount()>0?rtl.as(this.FEditControl,t.TTMSFNCGridMemo).FCaretPosition.$assign(r(rtl.as(this.FEditControl,t.TTMSFNCGridMemo).FLines.GetCount()-1,rtl.as(this.FEditControl,t.TTMSFNCGridMemo).FLines.Get(rtl.as(this.FEditControl,t.TTMSFNCGridMemo).FLines.GetCount()-1).length)):rtl.as(this.FEditControl,t.TTMSFNCGridMemo).FCaretPosition.$assign(r(0,0)),rtl.as(this.FEditControl,t.TTMSFNCGridMemo).SetSelLength(0))}this.FOptions.FEditing.FDirectComboDrop&&(t.TTMSFNCGridComboBox.isPrototypeOf(this.FEditControl)&&t.TTMSFNCGridComboBox.isPrototypeOf(this.FEditControl)&&rtl.as(this.FEditControl,t.TTMSFNCGridComboBox).SetDroppedDown(!0),t.TTMSFNCGridDatePicker.isPrototypeOf(this.FEditControl)),this.FEditControl.CanFocus()&&this.FEditControl.SetFocus(),this.FEditCell.$assign(e),this.FEditing=!0}}this.Invalidate()}finally{g.free(),rtl._Release(m)}},this.CancelEdit=function(){var t=0;this.FBlockHide||(this.FBlockHide=!0,t=0,this.DoGetCellEditorType(this.FEditCell.Col,this.FEditCell.Row,{get:function(){return t},set:function(e){t=e}}),18!==t?(null!=this.FEditControl&&this.FEditControl.SetParent(null),this.FEditControl=null):this.FFreeEditControlTimer.SetEnabled(!0),this.FEditing=!1,this.DoCellEditCancel(this.FEditCell.Col,this.FEditCell.Row),this.CanFocus()&&this.SetFocus(),this.FBlockHide=!1)},this.StopEdit=function(){this.HideEdit(!1,!1)},this.Navigate=function(t,e){var i,s,o=0,n=0,r=0,a=0,l=0,h=0,F=0,p=0,c=0,u=0,C=0,T=0,S=pas["WEBLib.TMSFNCGridData"].TTMSFNCGridCellRec.$new(),d=pas["WEBLib.TMSFNCTypes"].TRectF.$new();if(!this.FBlockUpdate){if(d.$assign(this.GetContentRect()),r=n=this.GetVerticalScrollPosition(),a=o=this.GetHorizontalScrollPosition(),1===this.FScrollMode&&(r=-this.GetCellContainerPosY(),a=-this.GetCellContainerPosX()),h=0,l=0,t.$assign(this.BaseCell(t.Col,t.Row)),F=this.ColSpan(t.Col,t.Row),p=this.RowSpan(t.Col,t.Row),F>0)for(var m=t.Col,f=t.Col+F-1;m<=f;m++)c=m,h+=this.GetColWidths(c);else h=this.GetColWidths(t.Col);if(p>0)for(var g=t.Row,y=t.Row+p-1;g<=y;g++)u=g,l+=this.GetRowHeights(u);else l=this.GetRowHeights(t.Row);if(s=this.GetVerticalPos(0,t.Row),e){var M=this.FScrollMode;0===M?n=s-this.GetFixedHeight():1===M&&(n=t.Row-this.FFixedRows-this.FFreezeRows)}else if(s<r+this.GetFixedHeight()){var b=this.FScrollMode;0===b?n=s-this.GetFixedHeight():1===b&&(n=t.Row-this.FFixedRows-this.FFreezeRows)}else{var N=this.FScrollMode;if(0===N)s+l>r+(d.Bottom-d.Top)-this.GetFixedFooterHeight()&&(n=s+l-(d.Bottom-d.Top)+this.GetFixedFooterHeight());else if(1===N)for(;s+l>r+(d.Bottom-d.Top)-this.GetFixedFooterHeight();){if(C=0,n+=1,S.$assign(this.BaseCell(t.Col,Math.round(n))),(p=this.RowSpan(S.Col,S.Row))>0)for(var B=S.Row,E=S.Row+p-1;B<=E;B++)u=B,C+=this.GetRowHeights(u);else p=1,C=this.GetRowHeights(S.Row);n=n+p-1,r+=C}}if(i=this.GetHorizontalPos(0,t.Col),e){var D=this.FScrollMode;0===D?o=i-this.GetFixedWidth():1===D&&(o=t.Col-this.FFixedColumns-this.FFreezeColumns)}else if(i<a+this.GetFixedWidth()){var L=this.FScrollMode;0===L?o=i-this.GetFixedWidth():1===L&&(o=t.Col-this.FFixedColumns-this.FFreezeColumns)}else{var G=this.FScrollMode;if(0===G)i+h>a+(d.Right-d.Left)-this.GetFixedRightWidth()&&(o=i+h-(d.Right-d.Left)+this.GetFixedRightWidth());else if(1===G)for(;i+h>a+(d.Right-d.Left)-this.GetFixedRightWidth();){if(T=0,o+=1,S.$assign(this.BaseCell(Math.round(o),t.Row)),(F=this.ColSpan(S.Col,S.Row))>0)for(var A=S.Col,I=S.Col+F-1;A<=I;A++)c=A,T+=this.GetColWidths(c);else F=1,T=this.GetColWidths(S.Col);o=o+F-1,a+=T}}this.Scroll(o,n)}},this.UpdateControlAfterResize=function(){var t=!1;pas["WEBLib.TMSFNCCustomScrollControl"].TTMSFNCCustomScrollControl.UpdateControlAfterResize.call(this),t=!0,null!=this.FAdapter&&(this.FAdapter.UpdateBounds(),t=this.FAdapter.CanCancelEdit()),this.FEditing&&t&&this.CancelEdit()},this.AutoSizeColumn=function(t,e,i){this.AutoSizeColumnInt(t,e,i),this.UpdateControl(!0,!0)},this.AutoSizeRow=function(t,e){this.AutoSizeRowInt(t,e),this.UpdateControl(!0,!0)},this.StretchColumn=function(t,e){var i,s=0,o=0,n=0,r=0,a=pas["WEBLib.TMSFNCTypes"].TRectF.$new();if(a.$assign(this.GetContentRect()),n=-1===e?a.Right-a.Left-1:e,i=this.GetColumnCount(),-1===t&&(t=i-1),0!==i&&this.FOptions.FColumnSize.FStretch){if(t>=i)throw pas.SysUtils.Exception.$create("Create$1",["Stretch column index out of range"]);if(1!==i)if(o=0,this.FOptions.FColumnSize.FStretchAll){if(i-this.FFixedColumns-this.FFixedRightColumns>0){r=n;for(var l=1,h=this.FFixedColumns;l<=h;l++)s=l,r-=this.GetColWidths(s-1);for(var F=1,p=this.FFixedRightColumns;F<=p;F++)s=F,r-=this.GetColWidths(i-s);o=r/(i-this.FFixedColumns-this.FFixedRightColumns);for(var c=this.FFixedColumns,u=i-this.FFixedRightColumns-1;c<=u;c++)s=c,this.SetColWidths(s,o)}}else{for(var C=0,T=i-1;C<=T;C++)(s=C)!==t&&(o+=this.GetColWidths(s));o<this.GetWidth()&&this.SetColWidths(t,n-o)}else this.SetColWidths(0,a.Right-a.Left-1)}},this.SelectCell=function(t,e,i){var s=pas["WEBLib.TMSFNCGridData"].TTMSFNCGridCellRec.$new(),o=pas["WEBLib.TMSFNCGridData"].TTMSFNCGridCellRec.$new(),n=0,r=0,a=0,l=0,h=pas["WEBLib.TMSFNCGridData"].TTMSFNCGridCellRec.$new(),F=0,p=0,c=0,u=0,C=0,T=0,S=!1,d=!1,m=0,f="",g=0,y=0,M=0;if(pas["WEBLib.TMSFNCGridData"].TTMSFNCGridData.SelectCell.apply(this,arguments),this.FPrevSelection.$assign(this.GetSelection()),t.Row<this.FFixedRows&&t.Col<this.FFixedColumns&&0 in this.FOptions.FMouse.FFixedCellSelection)return f="",m=65,this.HandleKeyPress({get:function(){return f},set:function(t){f=t}}),void this.HandleKeyDown({get:function(){return m},set:function(t){m=t}},rtl.createSet(2));if(t.Row=Math.max(this.FFixedRows,Math.min(t.Row,this.GetRowCount()-1-this.FFixedFooterRows)),t.Col=Math.max(this.FFixedColumns,Math.min(t.Col,this.GetColumnCount()-1-this.FFixedRightColumns)),d=!0,null==this.FOnSelectCell||this.FBlockSelectEventHandler||this.FOnSelectCell(this,t.Col,t.Row,{get:function(){return d},set:function(t){d=t}}),d){this.FPrevSelectedCell.$assign(this.GetFocusedCell()),this.FRealCell.$assign(t),t.$assign(this.BaseCell(t.Col,t.Row)),this.SetFocusCell(t.Col,t.Row);var b=this.FOptions.FSelection.FMode;if(1===b)this.SetStartCell(this.GetFocusedCell().Col,this.GetFocusedCell().Row),this.SetStopCell(this.GetFocusedCell().Col,this.GetFocusedCell().Row);else if(2===b)this.SetStartCell(this.FFixedColumns,this.GetFocusedCell().Row),this.SetStopCell(this.GetColumnCount()-1-this.FFixedRightColumns,this.GetFocusedCell().Row);else if(3===b)this.SetStartCell(this.GetFocusedCell().Col,this.FFixedRows),this.SetStopCell(this.GetFocusedCell().Col,this.GetRowCount()-1-this.FFixedFooterRows);else if(4===b||5===b||6===b||7===b||8===b||9===b){if(S=!0,i&&-1!==this.FFirstCell.Row&&-1!==this.FFirstCell.Col||0 in e||2 in e)if(!(0 in e)||-1!==this.FSaveCell.Row&&-1!==this.FSaveCell.Col){if(2 in e&&(7===this.FOptions.FSelection.FMode||8===this.FOptions.FSelection.FMode||9===this.FOptions.FSelection.FMode)){var N=this.FOptions.FSelection.FMode;7===N?this.GetFocusedCell().Row<this.FStartCell.Row?(this.SetStartCell(this.FRealCell.Col,this.GetFocusedCell().Row),this.FFirstCell.$assign(this.FStopCell),this.FSaveCell.$assign(this.FStopCell)):this.GetFocusedCell().Row>this.FStopCell.Row?(this.SetStopCell(this.GetFocusedCell().Col,this.GetFocusedCell().Row),this.FFirstCell.$assign(this.FStartCell),this.FSaveCell.$assign(this.FStartCell)):S=!1:8===N?this.GetFocusedCell().Col<this.FStartCell.Col?(this.SetStartCell(this.GetFocusedCell().Col,this.FRealCell.Row),this.FFirstCell.$assign(this.FStopCell),this.FSaveCell.$assign(this.FStopCell)):this.GetFocusedCell().Col>this.FStopCell.Col?(this.SetStopCell(this.GetFocusedCell().Col,this.GetFocusedCell().Row),this.FFirstCell.$assign(this.FStartCell),this.FSaveCell.$assign(this.FStartCell)):S=!1:9===N&&(S=!1,this.GetFocusedCell().Col<this.FStartCell.Col?this.GetFocusedCell().Row<this.FStartCell.Row?this.SetStartCell(this.GetFocusedCell().Col,this.GetFocusedCell().Row):this.GetFocusedCell().Row>this.FStopCell.Row?this.SetStopCell(this.GetFocusedCell().Col,this.GetFocusedCell().Row):(this.GetFocusedCell().Row>=this.FStartCell.Row||this.GetFocusedCell().Row<=this.FStopCell.Row)&&this.SetStartCell(this.GetFocusedCell().Col,this.FStartCell.Row):this.GetFocusedCell().Col>this.FStopCell.Col?this.GetFocusedCell().Row<this.FStartCell.Row?this.SetStartCell(this.GetFocusedCell().Col,this.GetFocusedCell().Row):this.GetFocusedCell().Row>this.FStopCell.Row?this.SetStopCell(this.GetFocusedCell().Col,this.GetFocusedCell().Row):(this.GetFocusedCell().Row>=this.FStartCell.Row||this.GetFocusedCell().Row>=this.FStopCell.Row)&&this.SetStopCell(this.GetFocusedCell().Col,this.FStopCell.Row):this.GetFocusedCell().Col>=this.FStartCell.Col&&this.GetFocusedCell().Col<=this.FStopCell.Col&&(this.GetFocusedCell().Row<this.FStartCell.Row?this.SetStartCell(this.FStartCell.Col,this.GetFocusedCell().Row):this.GetFocusedCell().Row>this.FStopCell.Row&&this.SetStopCell(this.FStopCell.Col,this.GetFocusedCell().Row)))}}else this.SetStartCell(this.GetFocusedCell().Col,this.GetFocusedCell().Row),this.SetStopCell(this.GetFocusedCell().Col,this.GetFocusedCell().Row),this.FSaveCell.$assign(this.FStartCell);else this.SetStartCell(this.FRealCell.Col,this.GetFocusedCell().Row),this.SetStopCell(this.GetFocusedCell().Col,this.GetFocusedCell().Row),this.FFirstCell.$assign(this.FStartCell),this.FSaveCell.$assign(this.FStartCell);0 in e&&this.FFirstCell.$assign(this.FSaveCell),S&&(this.GetFocusedCell().Col<this.FFirstCell.Col?(this.SetStartCell(this.GetFocusedCell().Col,this.FStartCell.Row),this.SetStopCell(this.FFirstCell.Col,this.FStopCell.Row)):(this.SetStopCell(this.GetFocusedCell().Col,this.FStopCell.Row),this.SetStartCell(this.FFirstCell.Col,this.FStartCell.Row)),this.GetFocusedCell().Row<this.FFirstCell.Row?(this.SetStartCell(this.FStartCell.Col,this.GetFocusedCell().Row),this.SetStopCell(this.FStopCell.Col,this.FFirstCell.Row)):(this.SetStopCell(this.FStopCell.Col,this.GetFocusedCell().Row),this.SetStartCell(this.FStartCell.Col,this.FFirstCell.Row)));var B=this.FOptions.FSelection.FMode;7!==B&&8!==B&&9!==B||2 in e||0 in e||(this.SetStartCell(this.GetFocusedCell().Col,this.GetFocusedCell().Row),this.SetStopCell(this.GetFocusedCell().Col,this.GetFocusedCell().Row),this.FSaveCell.$assign(this.GetFocusedCell()));var E=this.FOptions.FSelection.FMode;5===E||7===E?(this.SetStartCell(this.FFixedColumns,this.FStartCell.Row),this.SetStopCell(this.GetColumnCount()-1-this.FFixedRightColumns,this.FStopCell.Row)):6!==E&&8!==E||(this.SetStartCell(this.FStartCell.Col,this.FFixedRows),this.SetStopCell(this.FStopCell.Col,this.GetRowCount()-1-this.FFixedFooterRows))}o.$assign(this.FStopCell),s.$assign(this.FStartCell),this.FStopCell.Col<this.FStartCell.Col&&(this.SetStopCell(s.Col,this.FStopCell.Row),this.SetStartCell(o.Col,this.FStartCell.Row)),this.FStopCell.Row<this.FStartCell.Row&&(this.SetStopCell(this.FStopCell.Col,s.Row),this.SetStartCell(this.FStartCell.Col,o.Row)),this.Navigate(pas["WEBLib.TMSFNCGridData"].TTMSFNCGridCellRec.$clone(this.GetFocusedCell()),!1),r=this.FStopCell.Col,l=this.FStartCell.Col,n=this.FStopCell.Row,a=this.FStartCell.Row;for(var D=Math.max(this.FCStart,l),L=Math.min(this.FCStop,r);D<=L;D++){c=D;for(var G=Math.max(this.FRStart,a),A=Math.min(this.FRStop,n);G<=A;G++)u=G,h.$assign(this.BaseCell(c,u)),F=this.ColSpan(h.Col,h.Row),h.Col+F-1>r&&(r=h.Col+F-1),h.Col<l&&(l=h.Col),p=this.RowSpan(h.Col,h.Row),h.Row+p-1>n&&(n=h.Row+p-1),h.Row<a&&(a=h.Row)}this.SetStopCell(r,n),this.SetStartCell(l,a);var I=this.FOptions.FSelection.FMode;if(7===I){if(this.FBlockUpdate=!0,2 in e||this.ClearRowSelect(),0 in e)for(var P=this.FStartCell.Row,w=this.FStopCell.Row;P<=w;P++)C=P,this.SetRowSelect(C,!this.GetRowSelect(C));else this.SetRowSelect(this.GetFocusedCell().Row,!this.GetRowSelect(this.GetFocusedCell().Row)),g=this.GetSelectedRowCount(),this.GetRowSelect(this.GetFocusedCell().Row)||0!==g||this.SetRowSelect(this.GetFocusedCell().Row,!0);if(!this.GetRowSelect(this.GetFocusedCell().Row))for(var $=this.FStartCell.Row,R=this.FStopCell.Row;$<=R;$++)(C=$)!==this.GetFocusedCell().Row&&this.GetRowSelect(C)&&this.SetFocusCell(this.GetFocusedCell().Col,C);this.FBlockUpdate=!1}else if(8===I){if(this.FBlockUpdate=!0,2 in e||this.ClearColumnSelect(),0 in e)for(var v=this.FStartCell.Col,W=this.FStopCell.Col;v<=W;v++)C=v,this.SetColumnSelect(C,!this.GetColumnSelect(C));else this.SetColumnSelect(this.GetFocusedCell().Col,!this.GetColumnSelect(this.GetFocusedCell().Col)),y=this.GetSelectedColumnCount(),this.GetColumnSelect(this.GetFocusedCell().Col)||0!==y||this.SetColumnSelect(this.GetFocusedCell().Col,!0);if(!this.GetColumnSelect(this.GetFocusedCell().Col))for(var O=this.FStartCell.Col,x=this.FStopCell.Col;O<=x;O++)(C=O)!==this.GetFocusedCell().Col&&this.GetColumnSelect(C)&&this.SetFocusCell(C,this.GetFocusedCell().Row);this.FBlockUpdate=!1}else if(9===I){if(this.FBlockUpdate=!0,2 in e||this.ClearCellSelect(),0 in e)for(var k=this.FStartCell.Col,V=this.FStartCell.Row;k<=V;k++){C=k;for(var H=this.FStartCell.Row,U=this.FStopCell.Row;H<=U;H++)T=H,this.SetCellSelect(C,T,!this.GetCellSelect(C,T))}else this.SetCellSelect(this.GetFocusedCell().Col,this.GetFocusedCell().Row,!this.GetCellSelect(this.GetFocusedCell().Col,this.GetFocusedCell().Row)),M=this.GetSelectedCellCount(),this.GetCellSelect(this.GetFocusedCell().Col,this.GetFocusedCell().Row)||0!==M||this.SetCellSelect(this.GetFocusedCell().Col,this.GetFocusedCell().Row,!0);if(!this.GetCellSelect(this.GetFocusedCell().Col,this.GetFocusedCell().Row))for(var z=this.FStartCell.Col,K=this.FStartCell.Row;z<=K;z++){C=z;for(var j=this.FStartCell.Row,Y=this.FStopCell.Row;j<=Y;j++)T=j,C!==this.GetFocusedCell().Col&&T!==this.GetFocusedCell().Row&&this.GetCellSelect(C,T)&&this.SetFocusCell(C,T)}this.FBlockUpdate=!1}this.Navigate(pas["WEBLib.TMSFNCGridData"].TTMSFNCGridCellRec.$clone(this.GetFocusedCell()),!1),d&&null!=this.FAdapter&&this.FAdapter.SelectCell(pas["WEBLib.TMSFNCGridData"].TTMSFNCGridCellRec.$clone(this.GetFocusedCell())),d&&null!=this.FOnSelectedCell&&!this.FBlockSelectEventHandler&&this.FOnSelectedCell(this,this.GetFocusedCell().Col,this.GetFocusedCell().Row)}},this.UpdateGridCells=function(t){var e,i,s=0,o=0,n=0,r=0,a=0,l=0,h=0,F=0,p=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),c=0,u=0,C=0,T=0,S=0,d=0,m=0,f=0,g=0,y=0,M=0,b=0,N=0,B=0,E=0;if(!(this.FUpdateCount$1>0||this.FBlockUpdate||3 in this.FComponentState)){if(this.FBlockUpdate=!0,s=this.GetVerticalScrollPosition(),o=this.GetHorizontalScrollPosition(),B=this.GetHorizontalScrollMax(),E=this.GetVerticalScrollMax(),C=0,T=0,1===this.FScrollMode){B=this.GetTotalContentWidth(),E=this.GetTotalContentHeight();for(var D=this.FFixedRows+this.FFreezeRows,L=Math.round(s)-1+this.FFixedRows+this.FFreezeRows;D<=L;D++)S=D,C+=this.GetRowHeights(S);for(var G=this.FFixedColumns+this.FFreezeColumns,A=Math.round(o)-1+this.FFixedColumns+this.FFreezeColumns;G<=A;G++)S=G,T+=this.GetColWidths(S);s=C,o=T}if(this.FCellPosX=Math.round(-o),this.FCellPosY=Math.round(-s),i=this.GetTotalContentWidth(),e=this.GetTotalContentHeight(),i>0&&e>0){if(y=this.GetFixedCols(),M=this.GetFixedRows(),b=this.FFixedRightColumns,N=this.FFixedFooterRows,this.FOldTopRow=this.FRStart,this.FCStart=y,this.FRStart=M,p.$assign(this.GetContentRect()),p.$assign(pas["WEBLib.TMSFNCTypes"].RectF(p.Left,p.Top,p.Right-1,p.Bottom-1)),d=this.GetFixedWidth(),m=this.GetFixedHeight(),f=this.GetFixedRightWidth(),g=this.GetFixedFooterHeight(),c=0,u=0,o>B/2&&0===this.FColumnW.GetCount()){this.FCStop=this.GetColumnCount()-1-b,a=i-f;do{a-(n=this.GetColWidths(this.FCStop))>o+(p.Right-p.Left)-f&&(a-=n,this.FCStop-=1)}while(!(a-n<=o+(p.Right-p.Left)-f))}else{a=d;do{a+(n=this.GetColWidths(this.FCStart))<=o+d&&(a+=n,this.FCStart+=1)}while(!(a+n>o+d));c=a}if(s>E/2&&0===this.FRowH.GetCount()){this.FRStop=this.GetRowCount()-1-N,l=e-g;do{l-(r=this.GetRowHeights(this.FRStop))>s+(p.Bottom-p.Top)-g&&(l-=r,this.FRStop-=1)}while(!(l-r<=s+(p.Bottom-p.Top)-g))}else{l=m;do{l+(r=this.GetRowHeights(this.FRStart))<=s+m&&(l+=r,this.FRStart+=1)}while(!(l+r>s+m));u=l}if(o>B/2&&0===this.FColumnW.GetCount()){for(this.FCStart=this.FCStop;this.FCStart>0&&a>o+d&&(a-=this.GetColWidths(this.FCStart),this.FCStart>0&&a>o+d);)this.FCStart-=1;c=a}else for(this.FCStop=this.FCStart;this.FCStop<this.GetColumnCount()-1&&a<o+(p.Right-p.Left)-f&&(a+=this.GetColWidths(this.FCStop),this.FCStop<this.GetColumnCount()-1&&a<o+(p.Right-p.Left)-f);)this.FCStop+=1;if(s>E/2&&0===this.FRowH.GetCount()){for(this.FRStart=this.FRStop;this.FRStart>0&&l>s+m&&(l-=this.GetRowHeights(this.FRStart),this.FRStart>0&&l>s+m);)this.FRStart-=1;u=l}else for(this.FRStop=this.FRStart;this.FRStop<this.GetRowCount()-1&&l<s+(p.Bottom-p.Top)-g&&(l+=this.GetRowHeights(this.FRStop),this.FRStop<this.GetRowCount()-1&&l<s+(p.Bottom-p.Top)-g);)this.FRStop+=1;this.FRStart=Math.max(this.FFixedRows,Math.min(this.GetRowCount()-1-this.FFixedFooterRows,this.FRStart)),this.FCStart=Math.max(this.FFixedColumns,Math.min(this.GetColumnCount()-1-this.FFixedRightColumns,this.FCStart)),this.FRStop=Math.max(this.FFixedRows,Math.min(this.GetRowCount()-1-this.FFixedFooterRows,this.FRStop)),this.FCStop=Math.max(this.FFixedColumns,Math.min(this.GetColumnCount()-1-this.FFixedRightColumns,this.FCStop)),null!=this.FAdapter&&0===this.FBlockUpdateAdapter&&(this.FBlockUpdateAdapter+=1,this.FAdapter.ScrollGrid(this.GetTopRow()-this.FOldTopRow,!0,t),this.FBlockUpdateAdapter-=1),a=c-o,l=u-s,h=0,F=0,this.GetColumnCount()>this.GetFixedCols()&&this.GetRowCount()>this.GetFixedRows()&&this.DisplayCells(a,l,a,l,this.FCStart,this.FCStop,this.FRStart,this.FRStop,y,M,M,!1),this.GetRowCount()>this.GetFixedRows()&&this.DisplayCells(h,l,h,l,0,y-1,this.FRStart,this.FRStop,0,M,M,!0),this.GetColumnCount()>this.GetFixedCols()&&this.DisplayCells(a,F,a,F,this.FCStart,this.FCStop,0,M-1,y,0,0,!0),this.DisplayCells(h,F,h,F,0,y-1,0,M-1,0,0,0,!0),this.GetColumnCount()>this.GetFixedCols()+this.FFixedRightColumns&&this.GetRowCount()>this.GetFixedRows()&&(this.DisplayCells(h+(p.Right-p.Left)-f,l,h+(p.Right-p.Left)-f,l,this.GetColumnCount()-b,this.GetColumnCount()-1,this.FRStart,this.FRStop,this.FCStop-this.FCStart+y+1,M,M,!0),this.DisplayCells(h+(p.Right-p.Left)-f,F,h+(p.Right-p.Left)-f,F,this.GetColumnCount()-b,this.GetColumnCount()-1,0,M-1,this.FCStop-this.FCStart+y+1,0,0,!0)),this.GetColumnCount()>this.GetFixedCols()&&this.GetRowCount()>this.GetFixedRows()+this.FFixedFooterRows&&this.DisplayCells(a,F+(p.Bottom-p.Top)-g,h,F+(p.Bottom-p.Top)-g,this.FCStart,this.FCStop,this.GetRowCount()-N,this.GetRowCount()-1,y,this.FRStop-this.FRStart+M+1,this.FRStop-this.FRStart+M+1,!0),this.GetColumnCount()>this.GetFixedCols()+this.FFixedRightColumns&&this.GetRowCount()>this.GetFixedRows()+this.FFixedFooterRows&&this.DisplayCells(h+(p.Right-p.Left)-f,F+(p.Bottom-p.Top)-g,h+(p.Right-p.Left)-f,F+(p.Bottom-p.Top)-g,this.GetColumnCount()-b,this.GetColumnCount()-1,this.GetRowCount()-N,this.GetRowCount()-1,this.FCStop-this.FCStart+y+1,this.FRStop-this.FRStart+M+1,this.FRStop-this.FRStart+M+1,!0),this.GetRowCount()>this.GetFixedRows()&&this.DisplayCells(h,F+(p.Bottom-p.Top)-g,h,F+(p.Bottom-p.Top)-g,0,y-1,this.GetRowCount()-N,this.GetRowCount()-1,0,this.FRStop-this.FRStart+M+1,this.FRStop-this.FRStart+M+1,!0)}else this.RemoveAllCells();null!=this.FEditControl&&this.FEditing&&!this.FFreeEditControlTimer.FEnabled&&(this.FEditControl.BringToFront(),this.FEditControl.SetVisible(!0),this.FEditControl.CanFocus()&&this.FEditControl.SetFocus()),this.FTopr===this.GetTopRow()&&this.FLeftC===this.GetLeftCol()||null!=this.FOnTopLeftChanged&&this.FOnTopLeftChanged(this,this.GetTopRow(),this.GetLeftCol()),this.FTopr=this.GetTopRow(),this.FLeftC=this.GetLeftCol(),this.FBlockUpdate=!1,null!=this.FAdapter&&0===this.FBlockUpdateAdapter&&(this.FBlockUpdateAdapter+=1,this.FAdapter.ScrollGrid(this.GetTopRow()-this.FOldTopRow,!1,t),this.FBlockUpdateAdapter-=1),this.Invalidate()}},this.UpdateControlScroll=function(t,e,i,s){pas["WEBLib.TMSFNCCustomScrollControl"].TTMSFNCCustomScrollControl.UpdateControlScroll.apply(this,arguments),t!==i||e!==s?this.UpdateGridCells(!1):this.UpdateGridCellDisplay()},this.UpdateGridCellDisplay=function(){var t=pas["WEBLib.TMSFNCGridData"].TTMSFNCGridCellRecRange.$new();this.FUpdateCount$1>0||this.FBlockUpdate||3 in this.FComponentState||(this.FBlockUpdate=!0,t.StartCol=this.FPrevSelection.StartCol,t.EndCol=this.FPrevSelection.EndCol,t.StartRow=0,t.EndRow=this.FFixedRows-1,this.DoUpdateGridCellDisplay(pas["WEBLib.TMSFNCGridData"].TTMSFNCGridCellRecRange.$clone(t)),t.StartCol=0,t.EndCol=this.FFixedColumns-1,t.StartRow=this.FPrevSelection.StartRow,t.EndRow=this.FPrevSelection.EndRow,this.DoUpdateGridCellDisplay(pas["WEBLib.TMSFNCGridData"].TTMSFNCGridCellRecRange.$clone(t)),t.StartCol=this.FPrevSelection.StartCol,t.EndCol=this.FPrevSelection.EndCol,t.StartRow=this.GetRowCount()-this.FFixedFooterRows,t.EndRow=this.GetRowCount()-1,this.DoUpdateGridCellDisplay(pas["WEBLib.TMSFNCGridData"].TTMSFNCGridCellRecRange.$clone(t)),t.StartCol=this.GetColumnCount()-this.FFixedRightColumns,t.EndCol=this.GetColumnCount()-1,t.StartRow=this.FPrevSelection.StartRow,t.EndRow=this.FPrevSelection.EndRow,this.DoUpdateGridCellDisplay(pas["WEBLib.TMSFNCGridData"].TTMSFNCGridCellRecRange.$clone(t)),this.DoUpdateGridCellDisplay(pas["WEBLib.TMSFNCGridData"].TTMSFNCGridCellRecRange.$clone(this.FPrevSelection)),t.StartCol=this.GetSelection().StartCol,t.EndCol=this.GetSelection().EndCol,t.StartRow=0,t.EndRow=this.FFixedRows-1,this.DoUpdateGridCellDisplay(pas["WEBLib.TMSFNCGridData"].TTMSFNCGridCellRecRange.$clone(t)),t.StartCol=0,t.EndCol=this.FFixedColumns-1,t.StartRow=this.GetSelection().StartRow,t.EndRow=this.GetSelection().EndRow,this.DoUpdateGridCellDisplay(pas["WEBLib.TMSFNCGridData"].TTMSFNCGridCellRecRange.$clone(t)),t.StartCol=this.GetSelection().StartCol,t.EndCol=this.GetSelection().EndCol,t.StartRow=this.GetRowCount()-this.FFixedFooterRows,t.EndRow=this.GetRowCount()-1,this.DoUpdateGridCellDisplay(pas["WEBLib.TMSFNCGridData"].TTMSFNCGridCellRecRange.$clone(t)),t.StartCol=this.GetColumnCount()-this.FFixedRightColumns,t.EndCol=this.GetColumnCount()-1,t.StartRow=this.GetSelection().StartRow,t.EndRow=this.GetSelection().EndRow,this.DoUpdateGridCellDisplay(pas["WEBLib.TMSFNCGridData"].TTMSFNCGridCellRecRange.$clone(t)),this.DoUpdateGridCellDisplay(pas["WEBLib.TMSFNCGridData"].TTMSFNCGridCellRecRange.$clone(this.GetSelection())),this.FBlockUpdate=!1,this.Invalidate())},this.DoUpdateGridCellDisplay=function(t){var e,i,s,o,n=0,r=0,a=0,l=0,h=null,F=0,p=0,c=0,u=0,C=0,T=0,S=!1,d=!1,m=pas["WEBLib.TMSFNCGridData"].TTMSFNCGridCellRec.$new(),f=pas["WEBLib.TMSFNCGridData"].TTMSFNCGridCellRec.$new(),g=null;g=pas["WEBLib.TMSFNCGridCell"].TTMSFNCGridCellLayout.$create("Create$1"),C=0,this.FSaveTopCell=null,d=!1,e=t.StartCol,i=t.EndCol,s=t.StartRow,o=t.EndRow,m.Col=e,f.Col=i,m.Row=s,f.Row=o,m.$assign(this.GetDisplayCell(pas["WEBLib.TMSFNCGridData"].TTMSFNCGridCellRec.$clone(m))),f.$assign(this.GetDisplayCell(pas["WEBLib.TMSFNCGridData"].TTMSFNCGridCellRec.$clone(f)));for(var y=m.Col,M=f.Col;y<=M;y++)if((n=y)>=0&&n<=rtl.length(this.FCellArray)-1){d&&(C+=1),T=0,S=!1;for(var b=m.Row,N=f.Row;b<=N;b++)(r=b)>=0&&r<=rtl.length(this.FCellArray[n])-1&&(S&&(T+=1),null!=(h=this.FCellArray[n][r])&&pas["WEBLib.TMSFNCGridCell"].TTMSFNCGridCell.isPrototypeOf(h)&&((F=n+this.FCStart-this.GetFixedCols())>this.FCStop?(F=this.GetColumnCount()-this.FFixedRightColumns+C,d=!0):F<this.FCStart&&(F=n),(p=r+this.FRStart-this.GetFixedRows())>this.FRStop?(p=this.GetRowCount()-this.FFixedFooterRows+T,S=!0):p<this.FRStart&&(p=r),c=0,u=0,this.DoGetCellMergeInfo(F,p,{get:function(){return F},set:function(t){F=t}},{get:function(){return p},set:function(t){p=t}},{get:function(){return c},set:function(t){c=t}},{get:function(){return u},set:function(t){u=t}}),a=F,l=p,a=Math.max(0,Math.min(a,this.GetColumnCount()-1)),l=Math.max(0,Math.min(l,this.GetRowCount()-1)),a===this.GetFocusedCell().Col&&l===this.GetFocusedCell().Row&&(this.FSaveTopCell=h),this.ApplyCellState(a,l,h),pas["WEBLib.TMSFNCGridCell"].TTMSFNCGridCell.isPrototypeOf(h)&&(g.Assign(rtl.as(h,pas["WEBLib.TMSFNCGridCell"].TTMSFNCGridCell).FLayout),this.DoGetCellLayout(a,l,g,this.GetCellState(a,l)),rtl.as(h,pas["WEBLib.TMSFNCGridCell"].TTMSFNCGridCell).AssignLayout(g)),this.DoGetCellProperties(a,l,h)))}g=rtl.freeLoc(g)},this.PaintCells=function(t,e,i,s,o,n,r,a){for(var l=0,h=0,F=null,p=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),c=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),u=!1,C=!1,T=pas["WEBLib.TMSFNCGridData"].TTMSFNCGridCellRec.$new(),S=e,d=i;S<=d;S++){l=S;for(var m=s,f=o;m<=f;m++)h=m,rtl.length(this.FCellArray)>n&&rtl.length(this.FCellArray[n])>r&&(C=!0,u=this.GetFocusedCell().Col===l&&this.GetFocusedCell().Row===h,this.IsMerged(l,h)&&(T.$assign(this.BaseCell(l,h)),u=u||T.Col===this.GetFocusedCell().Col&&T.Row===this.GetFocusedCell().Row),this.FEditing&&u&&(C=!1),null!=(F=this.FCellArray[n][r])&&(p.$assign(pas["WEBLib.TMSFNCTypes"].RectF(F.FLeft,F.FTop,F.FLeft+F.FWidth,F.FTop+F.FHeight)),p.Bottom-p.Top>1&&p.Right-p.Left>1&&(pas["WEBLib.TMSFNCGridCell"].TTMSFNCCheckGridCell.isPrototypeOf(F)&&rtl.as(F,pas["WEBLib.TMSFNCGridCell"].TTMSFNCCheckGridCell).SetControlBitmap(this.GetCheckBoxBitmap(rtl.as(F,pas["WEBLib.TMSFNCGridCell"].TTMSFNCCheckGridCell).FChecked,!1,!0)),pas["WEBLib.TMSFNCGridCell"].TTMSFNCRadioGridCell.isPrototypeOf(F)&&rtl.as(F,pas["WEBLib.TMSFNCGridCell"].TTMSFNCRadioGridCell).SetControlBitmap(this.GetRadioButtonBitmap(rtl.as(F,pas["WEBLib.TMSFNCGridCell"].TTMSFNCRadioGridCell).FChecked,!1,!0)),pas["WEBLib.TMSFNCGridCell"].TTMSFNCNodeGridCell.isPrototypeOf(F)&&rtl.as(F,pas["WEBLib.TMSFNCGridCell"].TTMSFNCNodeGridCell).SetControlBitmap(this.GetNodeBitmap(rtl.as(F,pas["WEBLib.TMSFNCGridCell"].TTMSFNCNodeGridCell).FState)),pas["WEBLib.TMSFNCGridCell"].TTMSFNCButtonGridCell.isPrototypeOf(F)&&rtl.as(F,pas["WEBLib.TMSFNCGridCell"].TTMSFNCButtonGridCell).SetControlBitmap(this.GetDummyButtonBitmap(rtl.as(F,pas["WEBLib.TMSFNCGridCell"].TTMSFNCButtonGridCell))),C||(F.FLayout.FFill.Assign(this.FAppearance.FNormalLayout.FFill),F.FLayout.FStroke.Assign(this.FAppearance.FNormalLayout.FStroke)),c.$assign(F.GetTextRect(!1)),pas["WEBLib.TMSFNCTypes"].InflateRectEx(c,-2,-2),F.Draw(t,C,C,!0),this.GetFocusedCell().Col===l&&this.GetFocusedCell().Row===h&&!this.FEditing&&this.IsFocused()&&C&&this.FAppearance.FShowFocus&&t.DrawFocusRectangle$3(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(p.Left+1,p.Top+1,p.Right-1,p.Bottom-1)),0,2)))),r+=1;n+=1,r=a}},this.DisplayCells=function(t,e,i,s,o,n,r,a,l,h,F,p){null!=this.FAdapter&&this.FAdapter.AlternateDisplayBuildUp()?this.DisplayCellsAlternate(t,e,i,s,o,n,r,a,l,h,F,p):this.DisplayCellsNormal(t,e,i,s,o,n,r,a,l,h,F,p)},this.InitSample=function(){var t=0;this.BeginUpdate(),this.FUseColumns=!1,this.ResetToDefaultStyle(),this.SetDefaultRowHeight(this.ScalePaintValue(40)),this.SetFixedColumns(0),this.FOptions.FBands.SetEnabled(!0);for(var e=0,i=this.FColumns.GetCount()-1;e<=i;e++)t=e,this.FColumns.GetItem$1(t).SetWidth(this.ScalePaintValue(90)),this.FColumns.GetItem$1(t).FFixedFont.SetColor(4539717),this.FColumns.GetItem$1(t).FFont.SetColor(8026746);this.FColumns.GetItem$1(0).SetWidth(this.ScalePaintValue(70)),this.FColumns.GetItem$1(1).SetWidth(this.ScalePaintValue(250)),this.FColumns.GetItem$1(2).SetWidth(this.ScalePaintValue(100)),this.FColumns.GetItem$1(3).SetWidth(this.ScalePaintValue(100)),this.LoadSampleData(),this.SetColumnCount(4),this.SetWidth(this.ScalePaintValue(520)),this.EndUpdate()},this.LoadSampleData=function(){var t=0,e=0,i="",s="",o=0;this.BeginUpdate();for(var n=0,r=this.FFixedRows-1;n<=r;n++){s=(t=n)>0?"Sub ":"";for(var a=this.FFixedColumns,l=this.GetColumnCount()-1;a<=l;a++){e=a;i=0===e?s+"ID":1===e?s+"Name":2===e?s+"Joined":3===e?s+"Status":s+"Number",this.SetCells(e,t,i)}}for(var h=this.FFixedRows,F=this.GetRowCount()-1;h<=F;h++){t=h;for(var p=this.FFixedColumns,c=this.GetColumnCount()-1;p<=c;p++){i="";var u=e=p;if(0===u)i="00"+pas.SysUtils.TIntegerHelper.ToString$1.call({get:function(){return t},set:function(e){t=e}});else if(1===u){var C=pas.System.Random(120)%5;i=0===C?"David":1===C?"Laura":2===C?"Isaac":3===C?"Marie":"Leon";var T=pas.System.Random(120)%5;i+=0===T?" Kleermakers":1===T?" Tailor":2===T?" Terzi":3===T?" Sastre":" Schneider"}else if(2===u)o=Math.round(pas.SysUtils.Now())-pas.System.Random(5475),i=pas.SysUtils.DateToStr(o);else if(3===u){var S=pas.System.Random(120)%5;i=0===S?"Flight":1===S?"On Leave":2===S?"Abroad":"Office"}else i=pas.SysUtils.TIntegerHelper.ToString$1.call({a:pas.System.Random(100),get:function(){return this.a},set:function(t){this.a=t}});this.SetCells(e,t,i)}}this.EndUpdate()},rtl.addIntf(this,pas["WEBLib.TMSFNCBitmapContainer"].ITMSFNCBitmapContainer),rtl.addIntf(this,pas["WEBLib.TMSFNCGraphicsTypes"].ITMSFNCAppearanceGlobalFont),rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas["WEBLib.TMSFNCTypes"].ITMSFNCProductInfo),rtl.addIntf(this,pas.System.IUnknown)})),this.TMSFNCGRIDCELLNODEOPEN="data:image/PNG;base64,iVBORw0KGgoAAAANSUhEUgAAAA8AAAAPCAYAAAA71pVKAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAARJJREFUeNpi/P//P0NcX2oCAwNDJhCbMRAGp4B4+qKi2QsYY3tT6hTFVRrdTQIYZETkCep88uYhw84zGxjuv7xTzwSyMdo5mUFRQpGBlYWJIAapA6kH6WMBEhIifAIMpAB2VrB6CSYIhwkrLqzrxSkHAiCbGViZmXDagk8OrJnhPx434pEDa/77DyGQUdmJoiC1HMGf0V6OqfnPH4TAlGaEgpzaThQ+sjq45p+//+F0Gj45sObvP3/jVIBPDqz587cfWCXLczNwysE0P3329rk0Nwcf0Ynk649PIOops767Eefrjy+dBLllGP79YwT68Q9e/OHrR4ZD1zYxfP7xvosRmqvqoLlKggiLX0BzVRNAgAEAJkJ1yu0zs+kAAAAASUVORK5CYII=",this.TMSFNCGRIDCELLNODECLOSED="data:image/PNG;base64,iVBORw0KGgoAAAANSUhEUgAAAA8AAAAPCAYAAAA71pVKAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAOxJREFUeNpi/P//P0NcX2oCAwNDJhCbMRAGp4B4+qKi2QsYY3tT6hTFVRrdTQIYZETkCep88uYhw84zGxjuv7xTzwSyMdo5mUFRQpGBlYWJIAapA6kH6WMBEhIifAIMpAB2VrB6CRYIh4mBHADWzMpMgWaG/wzka/77DyGQUdmJU/GM9nJMzX/+IASmNJfj1IysDq755+9/5Dv7+8/f5Gv+/O0H2ZqfPnv7XJqbg49oTV9/fAJRT5n13Y04X3986STILcPw7x8j0P9/8OIPXz8yHLq2ieHzj/ddjNBcVQfNVRJEWPwCmquaAAIMAGYuZD5GuUOeAAAAAElFTkSuQmCC",t.$resourcestrings={sTMSFNCGridFilterAll:{org:"(All)"}},t.$implcode=function(){e.GetTickCountX=function(){var t=0,e=0,i=0,s=0;return pas.SysUtils.DecodeTime(pas.SysUtils.Now(),{get:function(){return t},set:function(e){t=e}},{get:function(){return e},set:function(t){e=t}},{get:function(){return i},set:function(t){i=t}},{get:function(){return s},set:function(t){s=t}}),s+1e3*i+60*e*1e3+60*t*60*1e3},e.AnimateDouble=function(t,e,i,s){var o=!1;return o=!0,t.get()>e.get()-s&&t.get()<e.get()+s?(t.set(e.get()),o=!1):(i=Math.max(s,i),t.get()<e.get()?t.set(t.get()+i):t.set(t.get()-i)),o}},t.$init=function(){pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.CreateFromResource(t.TMSFNCGRIDCELLNODEOPEN),pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.CreateFromResource(t.TMSFNCGRIDCELLNODECLOSED)}}),["WEBLib.TMSFNCCustomScrollControl","WEBLib.TMSFNCUtils","SysUtils","WEBLib.TMSFNCColorSelector","Math","WEBLib.Graphics","WEBLib.Forms","WEBLib.TMSFNCStyles","WEBLib.Dialogs"]),rtl.module("WEBLib.TMSFNCGrid",["System","Classes","WEBLib.TMSFNCCustomGrid","WEBLib.TMSFNCGridData"],(function(){"use strict";var t=this;rtl.createClass(this,"TTMSFNCGrid",pas["WEBLib.TMSFNCCustomGrid"].TTMSFNCCustomGrid,(function(){this.RegisterRuntimeClasses=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.RegisterRuntimeClasses.call(this),pas.Classes.RegisterClasses([t.TTMSFNCGrid,pas["WEBLib.TMSFNCGridData"].TTMSFNCGridColumn])},rtl.addIntf(this,pas["WEBLib.TMSFNCBitmapContainer"].ITMSFNCBitmapContainer),rtl.addIntf(this,pas["WEBLib.TMSFNCGraphicsTypes"].ITMSFNCAppearanceGlobalFont),rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas["WEBLib.TMSFNCTypes"].ITMSFNCProductInfo),rtl.addIntf(this,pas.System.IUnknown);var e=this.$rtti;e.addProperty("Adapter",2,pas["WEBLib.TMSFNCCustomGrid"].$rtti.TTMSFNCGridAdapter,"FAdapter","SetAdapter"),e.addProperty("HorizontalScrollBarVisible",2,rtl.boolean,"FHorizontalScrollBarVisible","SetHorizontalScrollBarVisible",{Default:!0}),e.addProperty("VerticalScrollBarVisible",2,rtl.boolean,"FVerticalScrollBarVisible","SetVerticalScrollBarVisible",{Default:!0}),e.addProperty("Columns",2,pas["WEBLib.TMSFNCGridData"].$rtti.TTMSFNCGridColumns,"FColumns","SetColumns"),e.addProperty("ToolBarPopup",0,pas["WEBLib.TMSFNCCustomGrid"].$rtti.TTMSFNCGridCustomToolBarPopup,"FToolBarPopup","FToolBarPopup"),e.addProperty("ToolBarPopupMode",0,pas["WEBLib.TMSFNCCustomGrid"].$rtti.TTMSFNCGridCustomToolBarPopupMode,"FToolBarPopupMode","FToolBarPopupMode",{Default:pas["WEBLib.TMSFNCCustomGrid"].TTMSFNCGridCustomToolBarPopupMode.tpmActiveCell}),e.addProperty("Version",1,rtl.string,"GetVersion",""),e.addProperty("Fill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FFill","SetFill"),e.addProperty("DefaultFont",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFont,"FDefaultFont","SetDefaultFont"),e.addProperty("Stroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FStroke","SetStroke"),e.addProperty("TopRow",3,rtl.longint,"GetTopRow","SetTopRow"),e.addProperty("Appearance",2,pas["WEBLib.TMSFNCCustomGrid"].$rtti.TTMSFNCGridAppearance,"FAppearance","SetAppearance"),e.addProperty("LeftCol",3,rtl.longint,"GetLeftCol","SetLeftCol"),e.addProperty("ScrollMode",2,pas["WEBLib.TMSFNCCustomScrollControl"].$rtti.TTMSFNCCustomScrollControlMode,"FScrollMode","SetScrollMode",{Default:pas["WEBLib.TMSFNCCustomScrollControl"].TTMSFNCCustomScrollControlMode.scmPixelScrolling}),e.addProperty("ScrollUpdate",2,pas["WEBLib.TMSFNCCustomScrollControl"].$rtti.TTMSFNCCustomScrollControlUpdate,"FScrollUpdate","SetScrollUpdate",{Default:pas["WEBLib.TMSFNCCustomScrollControl"].TTMSFNCCustomScrollControlUpdate.scuContinuous}),e.addProperty("CustomScrollBars",2,rtl.boolean,"FCustomScrollBars","SetCustomScrollBars",{Default:!1}),e.addProperty("FreezeColumns",2,rtl.longint,"FFreezeColumns","SetFreezeColumns",{Default:0}),e.addProperty("FreezeRows",2,rtl.longint,"FFreezeRows","SetFreezeRows",{Default:0}),e.addProperty("GlobalFont",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCAppearanceGlobalFont,"FGlobalFont","SetGlobalFont"),e.addProperty("DesignTimeSampleData",2,rtl.boolean,"FDesignTimeSampleData","SetDesignTimeSampleData"),e.addProperty("OnTopLeftChanged",0,pas["WEBLib.TMSFNCCustomGrid"].$rtti.TTMSFNCGridTopLeftChanged,"FOnTopLeftChanged","FOnTopLeftChanged"),e.addProperty("OnGetCellClass",0,pas["WEBLib.TMSFNCCustomGrid"].$rtti.TTMSFNCGridOnGetCellClass,"FOnGetCellClass","FOnGetCellClass"),e.addProperty("OnGetCellData",0,pas["WEBLib.TMSFNCCustomGrid"].$rtti.TTMSFNCGridOnGetCellData,"FOnGetCellData","FOnGetCellData"),e.addProperty("OnGetCellRotation",0,pas["WEBLib.TMSFNCCustomGrid"].$rtti.TTMSFNCGridOnGetCellRotation,"FOnGetCellRotation","FOnGetCellRotation"),e.addProperty("OnGetCellProperties",0,pas["WEBLib.TMSFNCCustomGrid"].$rtti.TTMSFNCGridOnGetCellProperties,"FOnGetCellProperties","FOnGetCellProperties"),e.addProperty("OnGetCellLayout",0,pas["WEBLib.TMSFNCCustomGrid"].$rtti.TTMSFNCGridOnGetCellLayout,"FOnGetCellLayout","FOnGetCellLayout"),e.addProperty("OnGetCellMergeInfo",0,pas["WEBLib.TMSFNCCustomGrid"].$rtti.TTMSFNCGridOnGetCellMergeInfo,"FOnGetCellMergeInfo","FOnGetCellMergeInfo"),e.addProperty("OnGetCellReadOnly",0,pas["WEBLib.TMSFNCCustomGrid"].$rtti.TTMSFNCGridOnGetCellReadOnly,"FOnGetCellReadOnly","FOnGetCellReadOnly"),e.addProperty("OnGetRowIsBand",0,pas["WEBLib.TMSFNCCustomGrid"].$rtti.TTMSFNCGridOnGetRowIsBand,"FOnGetRowIsBand","FOnGetRowIsBand"),e.addProperty("OnCanInsertRow",0,pas["WEBLib.TMSFNCCustomGrid"].$rtti.TTMSFNCGridOnCanInsertRow,"FOnCanInsertRow","FOnCanInsertRow"),e.addProperty("OnCanAppendRow",0,pas["WEBLib.TMSFNCCustomGrid"].$rtti.TTMSFNCGridOnCanAppendRow,"FOnCanAppendRow","FOnCanAppendRow"),e.addProperty("OnCanAppendColumn",0,pas["WEBLib.TMSFNCCustomGrid"].$rtti.TTMSFNCGridOnCanAppendColumn,"FOnCanAppendColumn","FOnCanAppendColumn"),e.addProperty("OnCanDeleteRow",0,pas["WEBLib.TMSFNCCustomGrid"].$rtti.TTMSFNCGridOnCanDeleteRow,"FOnCanDeleteRow","FOnCanDeleteRow"),e.addProperty("OnInsertRow",0,pas["WEBLib.TMSFNCCustomGrid"].$rtti.TTMSFNCGridOnInsertRow,"FOnInsertRow","FOnInsertRow"),e.addProperty("OnAppendRow",0,pas["WEBLib.TMSFNCCustomGrid"].$rtti.TTMSFNCGridOnAppendRow,"FOnAppendRow","FOnAppendRow"),e.addProperty("OnAppendColumn",0,pas["WEBLib.TMSFNCCustomGrid"].$rtti.TTMSFNCGridOnAppendColumn,"FOnAppendColumn","FOnAppendColumn"),e.addProperty("OnDeleteRow",0,pas["WEBLib.TMSFNCCustomGrid"].$rtti.TTMSFNCGridOnDeleteRow,"FOnDeleteRow","FOnDeleteRow"),e.addProperty("OnCellAnchorClick",0,pas["WEBLib.TMSFNCCustomGrid"].$rtti.TTMSFNCGridOnCellAnchorClick,"FOnCellAnchorClick","FOnCellAnchorClick"),e.addProperty("OnGetCellEditorCustomClassType",0,pas["WEBLib.TMSFNCCustomGrid"].$rtti.TTMSFNCGridOnGetCellEditorCustomClassType,"FOnGetCellEditorCustomClassType","FOnGetCellEditorCustomClassType"),e.addProperty("OnGetCellEditorType",0,pas["WEBLib.TMSFNCCustomGrid"].$rtti.TTMSFNCGridOnGetCellEditorType,"FOnGetCellEditorType","FOnGetCellEditorType"),e.addProperty("OnCellEditGetData",0,pas["WEBLib.TMSFNCCustomGrid"].$rtti.TTMSFNCGridOnCellEditGetData,"FOnCellEditGetData","FOnCellEditGetData"),e.addProperty("OnCellEditValidateData",0,pas["WEBLib.TMSFNCCustomGrid"].$rtti.TTMSFNCGridOnCellEditValidateData,"FOnCellEditValidateData","FOnCellEditValidateData"),e.addProperty("OnCellEditSetData",0,pas["WEBLib.TMSFNCCustomGrid"].$rtti.TTMSFNCGridOnCellEditSetData,"FOnCellEditSetData","FOnCellEditSetData"),e.addProperty("OnCellEditGetColor",0,pas["WEBLib.TMSFNCCustomGrid"].$rtti.TTMSFNCGridOnCellEditGetColor,"FOnCellEditGetColor","FOnCellEditGetColor"),e.addProperty("OnCellEditValidateColor",0,pas["WEBLib.TMSFNCCustomGrid"].$rtti.TTMSFNCGridOnCellEditValidateColor,"FOnCellEditValidateColor","FOnCellEditValidateColor"),e.addProperty("OnCellEditSetColor",0,pas["WEBLib.TMSFNCCustomGrid"].$rtti.TTMSFNCGridOnCellEditSetColor,"FOnCellEditSetColor","FOnCellEditSetColor"),e.addProperty("OnCellEditDone",0,pas["WEBLib.TMSFNCCustomGrid"].$rtti.TTMSFNCGridOnCellEditDone,"FOnCellEditDone","FOnCellEditDone"),e.addProperty("OnCellEditCancel",0,pas["WEBLib.TMSFNCCustomGrid"].$rtti.TTMSFNCGridOnCellEditCancel,"FOnCellEditCancel","FOnCellEditCancel"),e.addProperty("OnGetCellEditorProperties",0,pas["WEBLib.TMSFNCCustomGrid"].$rtti.TTMSFNCGridOnGetCellEditorProperties,"FOnGetCellEditorProperties","FOnGetCellEditorProperties"),e.addProperty("OnGetCellIsFixed",0,pas["WEBLib.TMSFNCCustomGrid"].$rtti.TTMSFNCGridOnGetCellIsFixed,"FOnGetCellIsFixed","FOnGetCellIsFixed"),e.addProperty("OnFixedCellDropDownButtonClick",0,pas["WEBLib.TMSFNCCustomGrid"].$rtti.TTMSFNCGridCellControlEvent,"FOnFixedCellDropDownButtonClick","FOnFixedCellDropDownButtonClick"),e.addProperty("OnCellComboCloseUp",0,pas["WEBLib.TMSFNCCustomGrid"].$rtti.TTMSFNCGridOnCellComboCloseUp,"FOnCellComboCloseUp","FOnCellComboCloseUp"),e.addProperty("OnCellBeforeDraw",0,pas["WEBLib.TMSFNCCustomGrid"].$rtti.TTMSFNCGridCellBeforeDraw,"FOnCellBeforeDraw","FOnCellBeforeDraw"),e.addProperty("OnCellAfterDraw",0,pas["WEBLib.TMSFNCCustomGrid"].$rtti.TTMSFNCGridCellAfterDraw,"FOnCellAfterDraw","FOnCellAfterDraw"),e.addProperty("OnCellBitmapClick",0,pas["WEBLib.TMSFNCCustomGrid"].$rtti.TTMSFNCGridCellControlEvent,"FOnCellBitmapClick","FOnCellBitmapClick"),e.addProperty("OnCellRadioButtonClick",0,pas["WEBLib.TMSFNCCustomGrid"].$rtti.TTMSFNCGridCellControlEvent,"FOnCellRadioButtonClick","FOnCellRadioButtonClick"),e.addProperty("OnCellCheckBoxClick",0,pas["WEBLib.TMSFNCCustomGrid"].$rtti.TTMSFNCGridCellControlEvent,"FOnCellCheckBoxClick","FOnCellCheckBoxClick"),e.addProperty("OnCellButtonClick",0,pas["WEBLib.TMSFNCCustomGrid"].$rtti.TTMSFNCGridCellControlEvent,"FOnCellButtonClick","FOnCellButtonClick"),e.addProperty("OnCellCommentClick",0,pas["WEBLib.TMSFNCCustomGrid"].$rtti.TTMSFNCGridCellControlEvent,"FOnCellCommentClick","FOnCellCommentClick"),e.addProperty("OnCellSortClick",0,pas["WEBLib.TMSFNCCustomGrid"].$rtti.TTMSFNCGridCellControlEvent,"FOnCellSortClick","FOnCellSortClick"),e.addProperty("OnCellNodeClick",0,pas["WEBLib.TMSFNCCustomGrid"].$rtti.TTMSFNCGridCellControlEvent,"FOnCellNodeClick","FOnCellNodeClick"),e.addProperty("OnCanSizeColumn",0,pas["WEBLib.TMSFNCCustomGrid"].$rtti.TTMSFNCGridOnCanSizeColumn,"FOnCanSizeColumn","FOnCanSizeColumn"),e.addProperty("OnCanSizeRow",0,pas["WEBLib.TMSFNCCustomGrid"].$rtti.TTMSFNCGridOnCanSizeRow,"FOnCanSizeRow","FOnCanSizeRow"),e.addProperty("OnColumnSize",0,pas["WEBLib.TMSFNCCustomGrid"].$rtti.TTMSFNCGridOnColumnSize,"FOnColumnSize","FOnColumnSize"),e.addProperty("OnRowSize",0,pas["WEBLib.TMSFNCCustomGrid"].$rtti.TTMSFNCGridOnRowSize,"FOnRowSize","FOnRowSize"),e.addProperty("OnColumnSized",0,pas["WEBLib.TMSFNCCustomGrid"].$rtti.TTMSFNCGridOnColumnSized,"FOnColumnSized","FOnColumnSized"),e.addProperty("OnRowSized",0,pas["WEBLib.TMSFNCCustomGrid"].$rtti.TTMSFNCGridOnRowSized,"FOnRowSized","FOnRowSized"),e.addProperty("OnCanDragColumn",0,pas["WEBLib.TMSFNCCustomGrid"].$rtti.TTMSFNCGridOnCanSizeColumn,"FOnCanDragColumn","FOnCanDragColumn"),e.addProperty("OnCanDragRow",0,pas["WEBLib.TMSFNCCustomGrid"].$rtti.TTMSFNCGridOnCanSizeRow,"FOnCanDragRow","FOnCanDragRow"),e.addProperty("OnColumnDragged",0,pas["WEBLib.TMSFNCCustomGrid"].$rtti.TTMSFNCGridOnColumnDragged,"FOnColumnDragged","FOnColumnDragged"),e.addProperty("OnRowDragged",0,pas["WEBLib.TMSFNCCustomGrid"].$rtti.TTMSFNCGridOnRowDragged,"FOnRowDragged","FOnRowDragged"),e.addProperty("OnBeforeColumnDrop",0,pas["WEBLib.TMSFNCCustomGrid"].$rtti.TTMSFNCGridOnBeforeColumnDrop,"FOnBeforeColumnDrop","FOnBeforeColumnDrop"),e.addProperty("OnBeforeCellEditExit",0,pas["WEBLib.TMSFNCCustomGrid"].$rtti.TTMSFNCGridCellEditBeforeExit,"FOnBeforeCellEditExit","FOnBeforeCellEditExit"),e.addProperty("OnBeforeRowDrop",0,pas["WEBLib.TMSFNCCustomGrid"].$rtti.TTMSFNCGridOnBeforeRowDrop,"FOnBeforeRowDrop","FOnBeforeRowDrop"),e.addProperty("OnColumnSorted",0,pas["WEBLib.TMSFNCCustomGrid"].$rtti.TTMSFNCGridOnColumnSorted,"FOnColumnSorted","FOnColumnSorted"),e.addProperty("OnCanSortColumn",0,pas["WEBLib.TMSFNCCustomGrid"].$rtti.TTMSFNCGridOnCanSortColumn,"FOnCanSortColumn","FOnCanSortColumn"),e.addProperty("OnCellRightClick",0,pas["WEBLib.TMSFNCCustomGrid"].$rtti.TTMSFNCGridOnCellClick,"FOnCellRightClick","FOnCellRightClick"),e.addProperty("OnFixedCellRightClick",0,pas["WEBLib.TMSFNCCustomGrid"].$rtti.TTMSFNCGridOnCellClick,"FOnFixedCellRightClick","FOnFixedCellRightClick"),e.addProperty("OnCellClick",0,pas["WEBLib.TMSFNCCustomGrid"].$rtti.TTMSFNCGridOnCellClick,"FOnCellClick","FOnCellClick"),e.addProperty("OnFixedCellClick",0,pas["WEBLib.TMSFNCCustomGrid"].$rtti.TTMSFNCGridOnCellClick,"FOnFixedCellClick","FOnFixedCellClick"),e.addProperty("OnCellDblClick",0,pas["WEBLib.TMSFNCCustomGrid"].$rtti.TTMSFNCGridOnCellClick,"FOnCellDblClick","FOnCellDblClick"),e.addProperty("OnFixedCellDblClick",0,pas["WEBLib.TMSFNCCustomGrid"].$rtti.TTMSFNCGridOnCellClick,"FOnFixedCellDblClick","FOnFixedCellDblClick"),e.addProperty("OnSelectCell",0,pas["WEBLib.TMSFNCGridData"].$rtti.TTMSFNCGridOnSelectCell,"FOnSelectCell","FOnSelectCell"),e.addProperty("OnSelectedCell",0,pas["WEBLib.TMSFNCGridData"].$rtti.TTMSFNCGridOnSelectedCell,"FOnSelectedCell","FOnSelectedCell"),e.attr=[pas.Classes.ComponentPlatformsAttribute,"Create$1",[1]]}))})),rtl.module("WEBLib.TMSFNCGridDatabaseAdapter",["System","Classes","WEBLib.TMSFNCCustomGrid","WEBLib.TMSFNCGridCell","WEBLib.TMSFNCGridData","WEBLib.TMSFNCTypes","WEBLib.Graphics","WEBLib.ExtCtrls","DB"],(function(){"use strict";var t=this,e=t.$impl;this.MAJ_VER=1,this.MIN_VER=0,this.REL_VER=0,this.BLD_VER=15,this.$rtti.$Class("TTMSFNCGridDatabaseAdapter"),rtl.createClass(this,"TTMSFNCGridDatabaseAdapterItemDataLink",pas.DB.TDataLink,(function(){this.$init=function(){pas.DB.TDataLink.$init.call(this),this.FModified=!1,this.FAdapter=null},this.$final=function(){this.FAdapter=void 0,pas.DB.TDataLink.$final.call(this)},this.ActiveChanged=function(){if(this.FActive&&null!=this.FDataSource&&null!=this.FDataSource.FDataSet&&this.FDataSource.FDataSet.FIsUniDirectional)throw pas.SysUtils.Exception.$create("Create$1",[rtl.getResStr(t,"sTMSFNCGridDatabaseAdapterUnidirectionalDataSet")]);this.FAdapter.ActiveChange(),this.FModified=!1},this.DataSetChanged=function(){this.FAdapter.DataSetChanged(),this.FModified=!1},this.DataSetScrolled=function(t){this.FAdapter.Scroll(t)},this.RecordChanged=function(t){this.FAdapter.RecordChanged(t)},this.UpdateData=function(){this.FModified&&this.FAdapter.UpdateData(),this.FModified=!1},this.Create$2=function(t){return this.FAdapter=t,this.FVisualControl=!0,this},this.Destroy=function(){pas.DB.TDataLink.Destroy.call(this)},this.Modified=function(){this.FModified=!0}})),rtl.createClass(this,"TTMSFNCGridDatabaseAdapterColumn",pas.Classes.TCollectionItem,(function(){this.$init=function(){pas.Classes.TCollectionItem.$init.call(this),this.FAdapter=null,this.FField=null,this.FFieldName="",this.FAutoCreated=!1,this.FHeader="",this.FCheckBoxField=!1,this.FPictureField=!1,this.FProgressField=!1,this.FCheckTrue="",this.FCheckFalse="",this.FUseLookupEditor=!1,this.FHTMLTemplate="",this.FUseColumnEditor=!1},this.$final=function(){this.FAdapter=void 0,this.FField=void 0,pas.Classes.TCollectionItem.$final.call(this)},this.SetFieldName=function(t){var e=null,i=null;e=null,null!=(i=this.Adapter())&&null!=i.FDataLink.GetDataset()&&!(0 in i.FComponentState)&&t.length>0&&(e=i.FDataLink.GetDataset().FindField(t)),this.FFieldName=t,""!==t&&this.SetField(e),null!=this.FAdapter&&this.FAdapter.UpdateGrid()},this.SetField=function(t){var e;this.FField!==t&&(null!=t&&3 in t.FComponentState&&(t=null),e=this.Adapter(),null!=this.FField&&null!=e&&this.FField.RemoveFreeNotification(e),this.FField=t,null!=t&&(null!=e&&this.FField.FreeNotification(e),this.FFieldName=t.FFieldName),null!=this.FAdapter&&this.FAdapter.UpdateGrid())},this.SetHeader=function(t){var e=null;this.FHeader=t,null!=(e=this.Adapter())&&null!=e.FGrid&&e.FGrid.SetCells(this.GetIndex()+e.FGrid.FFixedColumns,0,this.FHeader)},this.SetCheckBoxField=function(e){if(e&&(this.FPictureField||this.FProgressField))throw pas.SysUtils.Exception.$create("Create$1",[rtl.getResStr(t,"sTMSFNCGridDatabaseAdapterPictureField")]);this.FCheckBoxField!==e&&(this.FCheckBoxField=e,null!=this.FAdapter&&this.FAdapter.UpdateGrid())},this.SetPictureField=function(e){if(e&&(this.FCheckBoxField||this.FProgressField))throw pas.SysUtils.Exception.$create("Create$1",[rtl.getResStr(t,"sTMSFNCGridDatabaseAdapterCheckBoxField")]);this.FPictureField!==e&&(this.FPictureField=e,null!=this.FAdapter&&this.FAdapter.UpdateGrid())},this.SetProgressField=function(e){if(e&&(this.FCheckBoxField||this.FPictureField))throw pas.SysUtils.Exception.$create("Create$1",[rtl.getResStr(t,"sTMSFNCGridDatabaseAdapterCheckPictureField")]);this.FProgressField!==e&&(this.FProgressField=e,null!=this.FAdapter&&this.FAdapter.UpdateGrid())},this.SetHTMLTemplate=function(t){this.FHTMLTemplate=t,null!=this.FAdapter&&this.FAdapter.UpdateGrid()},this.Create$1=function(e){return pas.Classes.TCollectionItem.Create$1.apply(this,arguments),this.FUseLookupEditor=!0,this.FCheckTrue="True",this.FCheckFalse="False",this.FCheckBoxField=!1,this.FProgressField=!1,this.FPictureField=!1,this.FAdapter=null,null!=this.FCollection&&t.TTMSFNCGridDatabaseAdapterColumns.isPrototypeOf(this.FCollection)&&(this.FAdapter=rtl.as(this.FCollection,t.TTMSFNCGridDatabaseAdapterColumns).Adapter()),this},this.Assign=function(e){t.TTMSFNCGridDatabaseAdapterColumn.isPrototypeOf(e)},this.Adapter=function(){return this.FAdapter};var e=this.$rtti;e.addProperty("FieldName",2,rtl.string,"FFieldName","SetFieldName"),e.addProperty("Header",2,rtl.string,"FHeader","SetHeader"),e.addProperty("CheckBoxField",2,rtl.boolean,"FCheckBoxField","SetCheckBoxField",{Default:!1}),e.addProperty("ProgressField",2,rtl.boolean,"FProgressField","SetProgressField",{Default:!1}),e.addProperty("PictureField",2,rtl.boolean,"FPictureField","SetPictureField",{Default:!1}),e.addProperty("CheckFalse",0,rtl.string,"FCheckFalse","FCheckFalse"),e.addProperty("UseLookupEditor",0,rtl.boolean,"FUseLookupEditor","FUseLookupEditor",{Default:!0}),e.addProperty("UseColumnEditor",0,rtl.boolean,"FUseColumnEditor","FUseColumnEditor",{Default:!1}),e.addProperty("CheckTrue",0,rtl.string,"FCheckTrue","FCheckTrue"),e.addProperty("HTMLTemplate",2,rtl.string,"FHTMLTemplate","SetHTMLTemplate")})),rtl.createClass(this,"TTMSFNCGridDatabaseAdapterColumns",pas["WEBLib.TMSFNCTypes"].TTMSFNCOwnedCollection,(function(){this.$init=function(){pas["WEBLib.TMSFNCTypes"].TTMSFNCOwnedCollection.$init.call(this),this.FAdapter=null},this.$final=function(){this.FAdapter=void 0,pas["WEBLib.TMSFNCTypes"].TTMSFNCOwnedCollection.$final.call(this)},this.GetItem$1=function(t){return pas.Classes.TCollection.GetItem.call(this,t)},this.Create$3=function(e){return pas.Classes.TOwnedCollection.Create$2.call(this,e,t.TTMSFNCGridDatabaseAdapterColumn),this.FAdapter=e,this},this.HasFieldsDefined=function(){var t=!1,e=0;t=!1;for(var i=0,s=this.GetCount()-1;i<=s;i++)if(e=i,""!==this.GetItem$1(e).FFieldName&&!this.GetItem$1(e).FAutoCreated){t=!0;break}return t},this.Add$1=function(){return pas.Classes.TCollection.Add.call(this)},this.Adapter=function(){return this.FAdapter}})),this.TTMSFNCGridDatabaseAdapterDataSetType={0:"adsSequenced",adsSequenced:0,1:"adsNonSequenced",adsNonSequenced:1},this.$rtti.$Enum("TTMSFNCGridDatabaseAdapterDataSetType",{minvalue:0,maxvalue:1,ordtype:1,enumtype:this.TTMSFNCGridDatabaseAdapterDataSetType}),this.TTMSFNCGridDatabaseAdapterPostMode={0:"apmNone",apmNone:0,1:"apmCell",apmCell:1,2:"apmRow",apmRow:2},this.$rtti.$Enum("TTMSFNCGridDatabaseAdapterPostMode",{minvalue:0,maxvalue:2,ordtype:1,enumtype:this.TTMSFNCGridDatabaseAdapterPostMode}),this.$rtti.$MethodVar("TTMSFNCGridDatabaseAdapterGetRecordCountEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ARecordCount",rtl.longint,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCGridDatabaseAdapterGetHTMLTemplateDataEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ACol",rtl.longint],["ARow",rtl.longint],["AFieldname",rtl.string],["AData",rtl.string,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCGridDatabaseAdapterGetHTMLTemplateEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ACol",rtl.longint],["ARow",rtl.longint],["AHTMLTemplate",rtl.string,1],["AFields",pas.DB.$rtti.TFields]]),methodkind:0}),rtl.createClass(this,"TTMSFNCGridDatabaseAdapterLookupItem",pas.System.TObject,(function(){this.$init=function(){pas.System.TObject.$init.call(this),this.FIndex=0},this.Create$1=function(t){return this.FIndex=t,this}})),rtl.createClass(this,"TTMSFNCGridDatabaseAdapter",pas["WEBLib.TMSFNCCustomGrid"].TTMSFNCGridAdapter,(function(){this.$init=function(){pas["WEBLib.TMSFNCCustomGrid"].TTMSFNCGridAdapter.$init.call(this),this.FSkipRetrieveData=!1,this.FCellToSelect=pas["WEBLib.TMSFNCGridData"].TTMSFNCGridCellRec.$new(),this.FSelectTimer=null,this.FDoNotCountRow=!1,this.FMustEnableControls=0,this.FExportStartRow=0,this.FOldPosition=pas.DB.TBookmark.$new(),this.FSelExport=!1,this.FExportRow=0,this.FOldIsBOF=!1,this.FOldAR=0,this.FOldTopRow=0,this.FOldIsEOF=!1,this.FExporting=!1,this.FEditText="",this.FLookupKeys=null,this.FPrevRecNo=0,this.FRecordChanged=!1,this.FOffset=0,this.FOldDatasetType=0,this.FInternalCall=0,this.FOldState=0,this.FEmptyDataSet=!1,this.FShowDefinedFields=!1,this.FNewAppendRecord=!1,this.FVisibleFieldCount=0,this.FPreviousCell=pas["WEBLib.TMSFNCGridData"].TTMSFNCGridCellRec.$new(),this.FDataLink=null,this.FColumns=null,this.FAutoRemoveColumns=!1,this.FAutoCreateColumns=!1,this.FOnGetRecordCount=null,this.FDataSetType=0,this.FDataSetTypeAuto=!1,this.FShowPictureFields=!1,this.FShowBooleanFields=!1,this.FPostMode=0,this.FShowMemoFields=!1,this.FOnGetHTMLTemplateData=null,this.FOnGetHTMLTemplate=null},this.$final=function(){this.FCellToSelect=void 0,this.FSelectTimer=void 0,this.FOldPosition=void 0,this.FLookupKeys=void 0,this.FPreviousCell=void 0,this.FDataLink=void 0,this.FColumns=void 0,this.FOnGetRecordCount=void 0,this.FOnGetHTMLTemplateData=void 0,this.FOnGetHTMLTemplate=void 0,pas["WEBLib.TMSFNCCustomGrid"].TTMSFNCGridAdapter.$final.call(this)},this.GetDataSource=function(){return null!=this.FDataLink?this.FDataLink.FDataSource:null},this.SetDataSource=function(t){t!==this.FDataLink.FDataSource&&(this.FDataLink.SetDataSource(t),null==this.FDataLink.FDataSource&&(this.FGrid.BeginUpdate(),this.FGrid.Clear(),this.FGrid.SetRowCount(this.FGrid.FFixedRows+1),this.FAutoRemoveColumns&&this.FGrid.SetColumnCount(0),this.FGrid.EndUpdate()),null!==t&&t.FreeNotification(this))},this.SetColumns=function(t){this.FColumns.Assign(t)},this.GetFieldAtColumn=function(t){var e=null,i=0;return e=null,t>=this.FColumns.GetCount()||!this.CheckDataSet()||""!==this.FColumns.GetItem$1(t).FHTMLTemplate||(this.FShowDefinedFields?""!==this.FColumns.GetItem$1(t).FFieldName&&(e=this.FDataLink.GetDataset().FieldByName(this.FColumns.GetItem$1(t).FFieldName)):e=""!==this.FColumns.GetItem$1(t).FFieldName?this.FDataLink.GetDataset().FieldByName(this.FColumns.GetItem$1(t).FFieldName):-1!==(i=this.GetFieldIndexAtColumn(t))?this.FDataLink.GetDataset().FFieldList.GetField(i):null),e},this.GetFieldIndexAtColumn=function(t){var e=0,i=0,s=0,o=0,n=null;if(e=-1,!this.CheckDataSet()||t>=this.FColumns.GetCount())return e;if(""!==this.FColumns.GetItem$1(t).FHTMLTemplate)return e;if(this.FShowDefinedFields)""!==this.FColumns.GetItem$1(t).FFieldName&&null!=(n=this.FDataLink.GetDataset().FieldByName(this.FColumns.GetItem$1(t).FFieldName))&&(e=n.GetIndex());else if(""!==this.FColumns.GetItem$1(t).FFieldName)null!=(n=this.FDataLink.GetDataset().FieldByName(this.FColumns.GetItem$1(t).FFieldName))&&(e=n.GetIndex());else{o=0,i=0;for(var r=0,a=this.FDataLink.GetDataset().GetfieldCount()-1;r<=a;r++)if(s=r,this.FDataLink.GetDataset().FFieldList.GetField(s).FVisible){if(o>=t-i){e=s;break}o+=1}}return e},this.SetDataSetType=function(t){t!==this.FDataSetType&&(this.FDataSetType=t,this.CheckDataSet()&&(this.FDataLink.GetDataset().SetActive(!1),this.FDataLink.GetDataset().SetActive(!0)))},this.GetDocURL=function(){return pas["WEBLib.TMSFNCTypes"].TTMSFNCBaseDocURL+"tmsfncuipack/components/ttmsfncgrid/#databinding"},this.ClearOldPosition=function(){this.FOldPosition.Data=null,this.FOldPosition.Flag=0},this.RegisterRuntimeClasses=function(){pas["WEBLib.TMSFNCCustomComponent"].TTMSFNCCustomComponent.RegisterRuntimeClasses.call(this),pas.Classes.RegisterClasses([t.TTMSFNCGridDatabaseAdapter,t.TTMSFNCGridDatabaseAdapterColumn])},this.Notification=function(t,e){pas["WEBLib.TMSFNCCustomGrid"].TTMSFNCGridAdapter.Notification.apply(this,arguments),1===e&&t===this.GetDataSource()&&(this.SetDataSource(null),this.SetGrid(null),this.Initialize())},this.RecordChanged=function(t){this.FRecordChanged=!0,this.UpdateGrid()},this.UpdateData=function(){var t,e,i=null,s=0,o=0;t=this.FGrid.GetFocusedCell().Col-this.FGrid.FFixedColumns,i=this.GetFieldAtColumn(t),e=this.FGrid.GetCellComboBox().GetItemIndex(),null!=i&&this.FDataLink.GetDataset().FState in rtl.createSet(2,3)&&(i.$class.IsBlob()?i.SetAsString(this.FEditText):2===i.FFieldKind?e>=0&&(s=this.FGrid.GetCellComboBox().FItems.GetObject(e).FIndex,this.FDataLink.GetDataset().FieldByName(i.FKeyFields).SetAsString(this.GetLookupKey(s))):(o=0,this.GetCellEditorType(this.FGrid.GetFocusedCell().Col,this.FGrid.GetFocusedCell().Row,{get:function(){return o},set:function(t){o=t}}),12===o&&e>=0&&i.FDataType in rtl.createSet(2,3)?i.SetEditText(this.FGrid.GetCellComboBox().FItems.Get(e)):i.FDataType in rtl.createSet(2,5,3)?i.SetEditText(function(t){var e="",i=0;e="";for(var s=1,o=t.length;s<=o;s++)i=s,t.charAt(i-1)===pas.SysUtils.FormatSettings.DecimalSeparator?e+=pas.SysUtils.FormatSettings.DecimalSeparator:t.charAt(i-1)!==pas.SysUtils.FormatSettings.ThousandSeparator&&(e+=t.charAt(i-1));return e}(this.FEditText)):i.SetEditText(this.FEditText)))},this.ActiveChange=function(){var e=0,i=null,s=0,o=null,n=0;if(!(this.FInternalCall>0)){if(this.FInternalCall+=1,null==this.FGrid&&this.FActive&&!(4 in this.FComponentState))throw pas.SysUtils.Exception.$create("Create$1",[rtl.getResStr(t,"sTMSFNCGridDatabaseAdapterNoGridAssigned")]);if(null!=this.FDataLink&&null!=this.FGrid)if(null!=this.FDataLink.GetDataset())if(this.FDataLink.GetDataset().GetActive()||(this.FShowDefinedFields=!1),this.FDataLink.GetDataset().GetActive()&&this.FActive){this.FShowDefinedFields=!1;for(var r=0,a=this.FColumns.GetCount()-1;r<=a;r++)if(e=r,""!==this.FColumns.GetItem$1(e).FFieldName){this.FShowDefinedFields=!0;break}if(this.FShowDefinedFields&&this.FAutoRemoveColumns){e=0,i=pas.Classes.TStringList.$create("Create$1");try{for(this.GetDataSource().FDataSet.GetFieldNames(i);e<=this.FColumns.GetCount()-1;)""!==this.FColumns.GetItem$1(e).FFieldName&&i.IndexOf(this.FColumns.GetItem$1(e).FFieldName)<0&&(this.FColumns.GetItem$1(e).SetFieldName(""),this.FColumns.GetItem$1(e).SetHeader(""),this.FColumns.Delete(e),this.FShowDefinedFields=!1,e=-1),e+=1}finally{i=rtl.freeLoc(i)}}this.FVisibleFieldCount=0;for(var l=0,h=this.FDataLink.GetDataset().GetfieldCount()-1;l<=h;l++)e=l,this.FDataLink.GetDataset().FFieldList.GetField(e).FVisible&&(this.FVisibleFieldCount+=1);if(!this.FShowDefinedFields&&this.FAutoCreateColumns&&(s=this.FVisibleFieldCount-this.FGrid.GetHiddenColCount())>=0)for(var F=0,p=s-1;F<=p;F++)e=F,this.FColumns.Add$1();for(var c=0,u=this.FColumns.GetCount()-1;c<=u;c++)e=c,o=null,""!==this.FColumns.GetItem$1(e).FFieldName?o=this.FDataLink.GetDataset().FieldByName(this.FColumns.GetItem$1(e).FFieldName):this.FShowDefinedFields||(o=this.GetFieldAtColumn(e)),null!=o&&""===this.FColumns.GetItem$1(e).FFieldName&&this.FAutoCreateColumns&&(this.FColumns.GetItem$1(e).SetFieldName(o.FFieldName),this.FColumns.GetItem$1(e).FAutoCreated=!0);this.CheckDatasetType(),this.FDataLink.SetBufferCount(this.GetBufferCount()),n=this.GetRecordCount(),this.FGrid.BeginUpdate(),this.FGrid.SetColumnCount(this.FColumns.GetCount()+this.FGrid.FFixedColumns+this.FGrid.FFixedRightColumns),this.FGrid.SetRowCount(n+this.FGrid.FFixedRows),this.FGrid.SetFocusedCell(pas["WEBLib.TMSFNCGridData"].MakeCell(0,this.FDataLink.GetActiveRecord()+this.FGrid.FFixedRows)),this.FPreviousCell.$assign(this.FGrid.GetFocusedCell()),this.FOffset=0,this.FGrid.EndUpdate()}else this.FGrid.BeginUpdate(),this.FGrid.Clear(),this.FGrid.SetRowCount(this.FGrid.FFixedRows),this.DoAutoRemoveColumns(!1),this.FGrid.EndUpdate();else this.FGrid.BeginUpdate(),this.DoAutoRemoveColumns(!0),this.FGrid.EndUpdate();this.FInternalCall-=1}},this.DataSetChanged=function(){var t=0,e=0,i=0;if(this.CheckDataSet()&&!(this.FInternalCall>0))if(this.CheckDatasetType())this.Initialize();else{if(this.FInternalCall+=1,null!=this.FGrid&&(this.FGrid.BeginUpdate(),this.UpdateVisibleFields(),this.UpdateRowCount(),this.FOldState=this.FDataLink.GetDataset().FState,this.FGrid.EndUpdate(),3!==this.FOldState)){var s=this.FDataSetType;0===s?(i=(e=(t=this.GetRecordNo())-1+this.FGrid.FFixedRows)-this.FDataLink.GetActiveRecord(),this.FGrid.SetTopRow(i),this.FGrid.SelectCell(pas["WEBLib.TMSFNCGridData"].TTMSFNCGridCellRec.$clone(pas["WEBLib.TMSFNCGridData"].MakeCell(this.FGrid.GetFocusedCell().Col,e)),{},!1),this.FPrevRecNo=this.FDataLink.GetDataset().GetRecNo()):1===s&&(t=this.FDataLink.GetActiveRecord(),this.FGrid.SelectCell(pas["WEBLib.TMSFNCGridData"].TTMSFNCGridCellRec.$clone(pas["WEBLib.TMSFNCGridData"].MakeCell(this.FGrid.GetFocusedCell().Col,t+this.FGrid.GetTopRow())),{},!1),this.FPreviousCell.Row=t+this.FGrid.GetTopRow(),this.FDataLink.GetActiveRecord()>this.FGrid.GetBottomRow()-this.FGrid.GetTopRow()?this.FOffset=this.FDataLink.GetActiveRecord()-(this.FGrid.GetBottomRow()-this.FGrid.GetTopRow()):this.FOffset=0)}this.FInternalCall-=1}},this.UpdateVisibleFields=function(){var t=0,e=0,i=0,s=0,o=null;i=0;for(var n=0,r=this.FDataLink.GetDataset().GetfieldCount()-1;n<=r;n++)t=n,this.FDataLink.GetDataset().FFieldList.GetField(t).FVisible&&(i+=1);if(i!==this.FVisibleFieldCount){if(this.FVisibleFieldCount=i,!this.FShowDefinedFields&&(s=this.FVisibleFieldCount-this.FGrid.GetHiddenColCount())>=0)for(var a=0,l=s-1;a<=l;a++)t=a,this.FColumns.Add$1();if(!this.FShowDefinedFields)for(var h=0,F=this.FColumns.GetCount()-1;h<=F;h++)t=h,this.FColumns.GetItem$1(t).SetFieldName("");for(var p=0,c=this.FColumns.GetCount()-1;p<=c;p++)t=p,o=null,""!==this.FColumns.GetItem$1(t).FFieldName?o=this.FDataLink.GetDataset().FindField(this.FColumns.GetItem$1(t).FFieldName):this.FShowDefinedFields||(o=-1!==(e=this.GetFieldIndexAtColumn(t))?this.FDataLink.GetDataset().FFieldList.GetField(e):null),null!=o&&(this.FShowDefinedFields||""!==this.FColumns.GetItem$1(t).FFieldName||this.FColumns.GetItem$1(t).SetFieldName(o.FFieldName));this.FGrid.BeginUpdate(),this.FGrid.SetColumnCount(this.FColumns.GetCount()+this.FGrid.FFixedColumns+this.FGrid.FFixedRightColumns),this.FGrid.EndUpdate()}},this.UpdateGrid=function(){null!=this.FGrid&&(this.FGrid.BeginUpdate(),this.FGrid.EndUpdate())},this.Scroll=function(t){var e=0;if(this.CheckDataSet()&&!(this.FInternalCall>0)){if(this.FInternalCall+=1,null!=this.FGrid){var i=this.FDataSetType;0===i?(e=this.FDataLink.GetDataset().GetRecNo(),this.FPrevRecNo=e,this.FGrid.SelectCell(pas["WEBLib.TMSFNCGridData"].TTMSFNCGridCellRec.$clone(pas["WEBLib.TMSFNCGridData"].MakeCell(this.FGrid.GetFocusedCell().Col,e-1+this.FGrid.FFixedRows)),{},!1)):1===i&&(e=this.FDataLink.GetActiveRecord(),this.FGrid.SelectCell(pas["WEBLib.TMSFNCGridData"].TTMSFNCGridCellRec.$clone(pas["WEBLib.TMSFNCGridData"].MakeCell(this.FGrid.GetFocusedCell().Col,e+this.FGrid.GetTopRow())),{},!1),this.FPreviousCell.Row=e+this.FGrid.GetTopRow(),this.FDataLink.GetActiveRecord()>this.FGrid.GetBottomRow()-this.FGrid.GetTopRow()?this.FOffset=this.FDataLink.GetActiveRecord()-(this.FGrid.GetBottomRow()-this.FGrid.GetTopRow()):this.FDataLink.GetActiveRecord()<this.FGrid.GetBottomRow()-this.FGrid.GetTopRow()?this.FOffset=Math.max(this.FOffset+t,0):this.FOffset=0),this.UpdateGrid()}this.FInternalCall-=1}},this.UpdateRowCount=function(){var t=0,e=!1;if(null!=this.FGrid){if(e=!1,this.FGrid.BeginUpdate(),this.FGrid.GetRowCount()<=this.FGrid.FFixedRows&&this.FGrid.SetRowCount(this.FGrid.FFixedRows),this.FDataLink.FActive)if(3===this.FDataLink.GetDataset().FState&&3!==this.FOldState){if(this.FEmptyDataSet){if(this.FGrid.InsertRows(this.FGrid.FFixedRows,1),this.FDataLink.GetDataset().FEOF){this.FPrevRecNo=this.FGrid.GetRowCount()-1;var i=this.FDataSetType;0===i?this.FGrid.SelectCell(pas["WEBLib.TMSFNCGridData"].TTMSFNCGridCellRec.$clone(pas["WEBLib.TMSFNCGridData"].MakeCell(this.FGrid.FFixedColumns,this.FGrid.GetRowCount()-1)),{},!1):1===i&&this.FGrid.SelectCell(pas["WEBLib.TMSFNCGridData"].TTMSFNCGridCellRec.$clone(pas["WEBLib.TMSFNCGridData"].MakeCell(this.FGrid.FFixedColumns,Math.min(this.FGrid.VisibleRowCount()+1,this.FGrid.GetRowCount()-1))),{},!1)}}else if(this.FGrid.InsertRows(this.FGrid.FFixedRows,1),this.FDataLink.GetDataset().FEOF){this.FPrevRecNo=this.FGrid.GetRowCount()-1;var s=this.FDataSetType;0===s?this.FGrid.SelectCell(pas["WEBLib.TMSFNCGridData"].TTMSFNCGridCellRec.$clone(pas["WEBLib.TMSFNCGridData"].MakeCell(this.FGrid.GetFocusedCell().Col,this.FGrid.GetRowCount()-1)),{},!1):1===s&&this.FGrid.SelectCell(pas["WEBLib.TMSFNCGridData"].TTMSFNCGridCellRec.$clone(pas["WEBLib.TMSFNCGridData"].MakeCell(this.FGrid.GetFocusedCell().Col,Math.min(this.FGrid.VisibleRowCount()+1,this.FGrid.GetRowCount()-1))),{},!1)}}else 1===this.FDataLink.GetDataset().FState&&(3===this.FOldState&&this.FRecordChanged&&this.FEmptyDataSet&&((t=this.GetRecordCount())<this.FGrid.FFixedRows?this.FGrid.SetRowCount(this.FGrid.FFixedRows):this.FGrid.SetRowCount(t+this.FGrid.FFixedRows),e=!0),3!==this.FOldState||(this.FRecordChanged||1!==this.FPostMode)&&2!==this.FPostMode?1===this.FOldState&&1===this.FDataLink.GetDataset().FState&&((t=this.GetRecordCount())<this.FGrid.FFixedRows?this.FGrid.SetRowCount(this.FGrid.FFixedRows):this.FGrid.SetRowCount(t+this.FGrid.FFixedRows),e=!0):this.FGrid.GetRowCount()>this.FGrid.FFixedRows+1&&(1===this.FPostMode&&this.FGrid.DeleteRow(this.FGrid.GetRowCount()-1),(t=this.GetRecordCount())<this.FGrid.FFixedRows?this.FGrid.SetRowCount(this.FGrid.FFixedRows):this.FGrid.SetRowCount(t+this.FGrid.FFixedRows),e=!0),3===this.FOldState&&2===this.FPostMode&&this.FEmptyDataSet&&((t=this.GetRecordCount())<this.FGrid.FFixedRows?this.FGrid.SetRowCount(this.FGrid.FFixedRows):this.FGrid.SetRowCount(t+this.FGrid.FFixedRows),e=!0),!e&&3===this.FOldState&&this.FRecordChanged&&1===this.FPostMode&&((t=this.GetRecordCount())<this.FGrid.FFixedRows?this.FGrid.SetRowCount(this.FGrid.FFixedRows):this.FGrid.SetRowCount(t+this.FGrid.FFixedRows)));else this.FGrid.SetRowCount(this.FGrid.FFixedRows+1);this.FRecordChanged=!1,this.FDataLink.SetBufferCount(this.GetBufferCount()),this.FGrid.EndUpdate()}},this.DoSelectTimer=function(t){null!=this.FGrid&&-1!==this.FCellToSelect.Row&&-1!==this.FCellToSelect.Col&&(this.FGrid.SelectCell(pas["WEBLib.TMSFNCGridData"].TTMSFNCGridCellRec.$clone(this.FCellToSelect),{},!1),this.FSelectTimer.SetEnabled(!1))},this.BitmapChanged=function(t){this.FGrid.Invalidate()},this.UpdateBounds=function(){pas["WEBLib.TMSFNCCustomGrid"].TTMSFNCGridAdapter.UpdateBounds.call(this),this.CheckDataSet()&&(this.FDataLink.SetBufferCount(this.GetBufferCount()),this.UpdateGrid())},this.Initialize=function(){pas["WEBLib.TMSFNCCustomGrid"].TTMSFNCGridAdapter.Initialize.call(this),this.ActiveChange()},this.ScrollGrid=function(t,e,i){var s=0,o=0,n=0;if(pas["WEBLib.TMSFNCCustomGrid"].TTMSFNCGridAdapter.ScrollGrid.apply(this,arguments),!(this.FInternalCall>0)){if(this.FInternalCall+=1,null!=this.FGrid&&this.CheckDataSet()&&0!==t){var r=this.FDataSetType;0===r?e&&(t>0?this.FDataLink.GetDataset().SetRecNo(this.FGrid.GetTopRow()):this.FDataLink.GetDataset().SetRecNo(this.FGrid.GetBottomRow()),s=this.FDataLink.GetDataset().GetRecNo(),o=0,t>0?o=this.FGrid.GetBottomRow()-(s-1+this.FGrid.FFixedRows):t<0&&(o=this.FGrid.GetTopRow()-(s-1+this.FGrid.FFixedRows)),this.FDataLink.MoveBy(o),this.FPrevRecNo=this.FDataLink.GetDataset().GetRecNo()):1===r&&e&&(s=this.FPreviousCell.Row,o=0,t>0?o=this.FGrid.GetBottomRow()-s:t<0&&(o=this.FGrid.GetTopRow()-s),this.FDataLink.MoveBy(o),this.FDataLink.GetActiveRecord()>this.FGrid.GetBottomRow()-this.FGrid.GetTopRow()?this.FOffset=this.FDataLink.GetActiveRecord()-(this.FGrid.GetBottomRow()-this.FGrid.GetTopRow()):this.FDataLink.GetActiveRecord()<this.FGrid.GetBottomRow()-this.FGrid.GetTopRow()?this.FOffset=Math.max(this.FOffset+t,0):this.FOffset=0,this.FPreviousCell.Row=this.FPreviousCell.Row+o)}this.FInternalCall-=1,this.CheckDataSet()&&null!=this.FDataLink.GetDataset()&&1===this.FDataLink.GetDataset().FState&&i&&(n=(s=this.GetRecordNo())-1+this.FGrid.FFixedRows,this.FGrid.SaveScrollPosition(),this.FGrid.SelectCell(pas["WEBLib.TMSFNCGridData"].TTMSFNCGridCellRec.$clone(pas["WEBLib.TMSFNCGridData"].MakeCell(this.FGrid.GetFocusedCell().Col,n)),{},!1),this.FGrid.RestoreScrollPosition())}},this.SelectCell=function(t){var e=0,i=!1;if(pas["WEBLib.TMSFNCCustomGrid"].TTMSFNCGridAdapter.SelectCell.apply(this,arguments),this.CheckDataSet()&&!(this.FInternalCall>0)){i=!1;var s=this.FPostMode;if(1===s?i=t.Row!==this.FGrid.GetPrevFocusedCell().Row||t.Col!==this.FGrid.GetPrevFocusedCell().Col:2===s&&(i=t.Row!==this.FGrid.GetPrevFocusedCell().Row),i)if(3===this.FDataLink.GetDataset().FState)this.FDataLink.GetDataset().Post(),this.FCellToSelect.$assign(t),this.FSelectTimer.SetEnabled(!0);else{this.FInternalCall+=1;var o=this.FDataSetType;0===o?(e=this.FDataLink.GetDataset().GetRecNo(),this.FDataLink.MoveBy(t.Row-(e-1+this.FGrid.FFixedRows)),this.FPrevRecNo=this.FDataLink.GetDataset().GetRecNo()):1===o&&(e=this.FPreviousCell.Row,this.FDataLink.MoveBy(t.Row-e),this.FPreviousCell.$assign(t)),this.FInternalCall-=1}}},this.DoAutoRemoveColumns=function(t){var e=!1,i=!1,s=0;if(this.FAutoRemoveColumns){e=!0,i=!this.FColumns.HasFieldsDefined()||t,4 in this.FComponentState&&this.FComponentState,0 in this.FComponentState&&(e=!1);for(var o=0,n=this.FColumns.GetCount()-1;o<=n;o++)s=o,this.FColumns.GetItem$1(s).FField=null;i&&e&&(this.FColumns.Clear(),this.FGrid.SetColumnCount(0))}},this.CellEditGetData=function(t,e,i,s){var o=0,n=null,r=0,a=0,l=0;if(pas["WEBLib.TMSFNCCustomGrid"].TTMSFNCGridAdapter.CellEditGetData.apply(this,arguments),this.CheckDataSet()&&(r=t-this.FGrid.FFixedColumns,!((a=e)<=this.FGrid.FFixedRows-1)&&this.FColumns.GetCount()>r)){if(n=this.GetFieldAtColumn(r),this.FShowBooleanFields&&null!==n&&4===n.FDataType||this.FColumns.GetItem$1(r).FPictureField||this.FColumns.GetItem$1(r).FCheckBoxField)return;if(l=this.FDataLink.GetActiveRecord(),this.SetActiveRecord(a),this.FDataLink.GetActiveRecord()<0||this.FDataLink.GetActiveRecord()>=this.FDataLink.GetBufferCount()&&(this.FDataLink.GetActiveRecord()!==this.FDataLink.GetBufferCount()||1!==this.FDataSetType))return void this.FDataLink.SetActiveRecord(l);try{""!==this.FColumns.GetItem$1(r).FFieldName?(n=this.FDataLink.GetDataset().FieldByName(this.FColumns.GetItem$1(r).FFieldName)).$class.IsBlob()?s.set(n.GetAsString()):s.set(n.GetEditText()):this.FShowDefinedFields||null!=(n=-1!==(o=this.GetFieldIndexAtColumn(r))?this.FDataLink.GetDataset().FFieldList.GetField(o):null)&&(n.$class.IsBlob()?s.set(n.GetAsString()):s.set(n.GetEditText()))}finally{this.FDataLink.SetActiveRecord(l)}}},this.CellEditValidateData=function(t,e,i,s,o){var n,r,a=0,l=0,h=null,F=0;if(this.CheckDataSet()&&(n=t-this.FGrid.FFixedColumns,!((r=e)<=this.FGrid.FFixedRows-1)&&null!=this.FColumns&&this.FColumns.GetCount()>n)){if(!(this.GetDataSource().FDataSet.FState in rtl.createSet(3,2))&&1===this.FPostMode)return;if(h=this.GetFieldAtColumn(n),this.FShowBooleanFields&&null!==h&&4===h.FDataType||this.FColumns.GetItem$1(n).FPictureField||this.FColumns.GetItem$1(n).FCheckBoxField)return;if(F=this.FDataLink.GetActiveRecord(),this.SetActiveRecord(r),this.FDataLink.GetActiveRecord()<0||this.FDataLink.GetActiveRecord()>=this.FDataLink.GetBufferCount()&&(this.FDataLink.GetActiveRecord()!==this.FDataLink.GetBufferCount()||1!==this.FDataSetType))return void this.FDataLink.SetActiveRecord(F);try{if(o.get())if(1===this.FPostMode){try{""!==this.FColumns.GetItem$1(n).FFieldName?2===(h=this.FDataLink.GetDataset().FieldByName(this.FColumns.GetItem$1(n).FFieldName)).FFieldKind?this.FGrid.GetCellComboBox().GetItemIndex()>=0&&(a=this.FGrid.GetCellComboBox().FItems.GetObject(this.FGrid.GetCellComboBox().GetItemIndex()).FIndex,this.FDataLink.GetDataset().FieldByName(h.FKeyFields).SetAsString(this.GetLookupKey(a))):h.$class.IsBlob()&&!this.FShowMemoFields?h.SetAsString("(MEMO)"):null!=h.FOnSetText?h.FOnSetText(h,s.get()):h.SetAsString(s.get()):(this.FShowDefinedFields||null!=(h=-1!==(l=this.GetFieldIndexAtColumn(n))?this.FDataLink.GetDataset().FFieldList.GetField(l):null)&&(2===h.FFieldKind?(a=this.FGrid.GetCellComboBox().FItems.GetObject(this.FGrid.GetCellComboBox().GetItemIndex()).FIndex,this.FDataLink.GetDataset().FieldByName(h.FKeyFields).SetAsString(this.GetLookupKey(a))):h.$class.IsBlob()&&!this.FShowMemoFields?h.SetAsString("(MEMO)"):h.SetAsString(s.get())),this.FShowDefinedFields&&""===this.FColumns.GetItem$1(n).FFieldName&&s.set(""))}catch(t){o.set(!1)}try{this.FDataLink.GetDataset().Post()}catch(t){if(!pas.SysUtils.Exception.isPrototypeOf(t))throw t;this.FRecordChanged=!1,this.FDataLink.GetDataset().Cancel()}}else this.CheckDataSet()&&(this.FEditText!==s.get()&&2!==h.FFieldKind&&(this.FEditText=s.get()),h.GetEditText()!==s.get()&&!this.FDataLink.FModified&&this.FDataLink.GetDataset().FState in rtl.createSet(2,3)&&this.FDataLink.Modified(),this.FDataLink.UpdateData())}finally{this.FDataLink.SetActiveRecord(F)}}},this.CellEditSetData=function(t,e,i,s){pas["WEBLib.TMSFNCCustomGrid"].TTMSFNCGridAdapter.CellEditSetData.apply(this,arguments)},this.CellEditDone=function(t,e,i){pas["WEBLib.TMSFNCCustomGrid"].TTMSFNCGridAdapter.CellEditDone.apply(this,arguments),this.CheckDataSet()},this.GetCellReadOnly=function(t,e,i){var s=0,o=0,n=0;pas["WEBLib.TMSFNCCustomGrid"].TTMSFNCGridAdapter.GetCellReadOnly.apply(this,arguments),n=t-this.FGrid.FFixedColumns,null!=this.FDataLink&&this.FDataLink.FActive&&null!=this.FDataLink.GetDataset()&&this.FDataLink.GetDataset().GetActive()&&!this.FDataLink.GetDataset().GetCanModify()&&n<this.FColumns.GetCount()&&""!==this.FColumns.GetItem$1(n).FFieldName?i.set(!0):n>=this.FColumns.GetCount()?i.set(!1):(o=n,""===this.FColumns.GetItem$1(o).FHTMLTemplate?!i.get()&&this.CheckDataSet()&&(""!==this.FColumns.GetItem$1(o).FFieldName?i.set(this.FDataLink.GetDataset().FieldByName(this.FColumns.GetItem$1(n).FFieldName).FReadOnly):this.FShowDefinedFields||-1!==(s=this.GetFieldIndexAtColumn(o))&&i.set(this.FDataLink.GetDataset().FFieldList.GetField(s).FReadOnly)):i.set(!0))},this.GetCellData=function(t,e,i){var s=0,o=0,n=0,r=0,a=null,l="";if(pas["WEBLib.TMSFNCCustomGrid"].TTMSFNCGridAdapter.GetCellData.apply(this,arguments),null!=this.FGrid&&this.CheckDataSet()&&(n=e,(o=t-this.FGrid.FFixedColumns)>=0&&o<=this.FColumns.GetCount()-1))if(this.FDataLink.GetDataset().GetActive())if(n===this.FGrid.FFixedRows-1)""!==this.FColumns.GetItem$1(o).FHeader?i.set(this.FColumns.GetItem$1(o).FHeader):""===this.FGrid.GetCells(o,n)||this.FSkipRetrieveData?""!==this.FColumns.GetItem$1(o).FFieldName?null!=(a=this.FDataLink.GetDataset().FieldByName(this.FColumns.GetItem$1(o).FFieldName))&&""!==a.GetDisplayName()?i.set(a.GetDisplayName()):i.set(this.FColumns.GetItem$1(o).FFieldName):this.FAutoCreateColumns&&-1!==(r=this.GetFieldIndexAtColumn(o))&&(this.FDataLink.GetDataset().FFieldList.GetField(r).GetDisplayName(),i.set(this.FDataLink.GetDataset().FFieldList.GetField(r).GetDisplayName())):i.set(this.FGrid.GetCells(o,n));else{if(n<=this.FGrid.FFixedRows-1)return;if(a=this.GetFieldAtColumn(o),this.FShowBooleanFields&&null!==a&&4===a.FDataType||this.FColumns.GetItem$1(o).FPictureField||this.FColumns.GetItem$1(o).FCheckBoxField)return;if(s=this.FDataLink.GetActiveRecord(),this.SetActiveRecord(n),this.FDataLink.GetActiveRecord()<0||this.FDataLink.GetActiveRecord()>=this.FDataLink.GetBufferCount()&&(this.FDataLink.GetActiveRecord()!==this.FDataLink.GetBufferCount()||1!==this.FDataSetType))return 1===this.FDataSetType&&i.set(""),void this.FDataLink.SetActiveRecord(s);try{""!==this.FColumns.GetItem$1(o).FHTMLTemplate&&e>=this.FGrid.FFixedRows&&t>=this.FGrid.FFixedColumns?(l=this.FColumns.GetItem$1(o).FHTMLTemplate,null!=this.FOnGetHTMLTemplate&&this.FOnGetHTMLTemplate(this,o,n,{get:function(){return l},set:function(t){l=t}},this.FDataLink.GetDataset().FFieldList),i.set(this.HTMLDBReplace(l,this.FDataLink.GetDataset(),o,n))):null!=(a=this.GetFieldAtColumn(o))&&(a.GetIsNull()?i.set(""):a.$class.IsBlob()?null!=a.FOnGetText?i.set(a.GetDisplayText()):i.set(a.GetAsString()):i.set(a.GetDisplayText()))}finally{this.FDataLink.SetActiveRecord(s)}}else n===this.FGrid.FFixedRows-1&&(""!==this.FColumns.GetItem$1(o).FHeader?i.set(this.FColumns.GetItem$1(o).FHeader):""!==this.FColumns.GetItem$1(o).FFieldName&&i.set(this.FColumns.GetItem$1(o).FFieldName))},this.GetCellProperties=function(t,e,i){var s=null,o=0,n=0,r=null;if(pas["WEBLib.TMSFNCCustomGrid"].TTMSFNCGridAdapter.GetCellProperties.apply(this,arguments),null!=this.FGrid&&this.CheckDataSet()){if(pas["WEBLib.TMSFNCGridCell"].TTMSFNCCheckGridCell.isPrototypeOf(i)){if(o=this.FDataLink.GetActiveRecord(),this.SetActiveRecord(e),this.FDataLink.GetActiveRecord()<0||this.FDataLink.GetActiveRecord()>=this.FDataLink.GetBufferCount()&&(this.FDataLink.GetActiveRecord()!==this.FDataLink.GetBufferCount()||1!==this.FDataSetType))return void this.FDataLink.SetActiveRecord(o);try{n=t-this.FGrid.FFixedColumns,s=this.GetFieldAtColumn(n),this.FShowBooleanFields&&t>=this.FGrid.FFixedColumns&&e>=this.FGrid.FFixedRows&&null!=s&&4===s.FDataType&&(r=rtl.as(i,pas["WEBLib.TMSFNCGridCell"].TTMSFNCCheckGridCell).FOnCheckChanged,rtl.as(i,pas["WEBLib.TMSFNCGridCell"].TTMSFNCCheckGridCell).FOnCheckChanged=null,rtl.as(i,pas["WEBLib.TMSFNCGridCell"].TTMSFNCCheckGridCell).SetChecked(s.GetAsBoolean()),rtl.as(i,pas["WEBLib.TMSFNCGridCell"].TTMSFNCCheckGridCell).FOnCheckChanged=r),e>=this.FGrid.FFixedRows&&t>=this.FGrid.FFixedColumns&&this.FColumns.GetItem$1(n).FCheckBoxField&&(r=rtl.as(i,pas["WEBLib.TMSFNCGridCell"].TTMSFNCCheckGridCell).FOnCheckChanged,rtl.as(i,pas["WEBLib.TMSFNCGridCell"].TTMSFNCCheckGridCell).FOnCheckChanged=null,rtl.as(i,pas["WEBLib.TMSFNCGridCell"].TTMSFNCCheckGridCell).SetChecked(pas.SysUtils.UpperCase(s.GetDisplayText())===pas.SysUtils.UpperCase(this.FColumns.GetItem$1(n).FCheckTrue)),rtl.as(i,pas["WEBLib.TMSFNCGridCell"].TTMSFNCCheckGridCell).FOnCheckChanged=r),i.SetText("")}finally{this.FDataLink.SetActiveRecord(o)}}if(pas["WEBLib.TMSFNCGridCell"].TTMSFNCBitmapGridCell.isPrototypeOf(i)){if(o=this.FDataLink.GetActiveRecord(),this.SetActiveRecord(e),this.FDataLink.GetActiveRecord()<0||this.FDataLink.GetActiveRecord()>=this.FDataLink.GetBufferCount()&&(this.FDataLink.GetActiveRecord()!==this.FDataLink.GetBufferCount()||1!==this.FDataSetType))return void this.FDataLink.SetActiveRecord(o);try{n=t-this.FGrid.FFixedColumns,s=this.GetFieldAtColumn(n),e>=this.FGrid.FFixedRows&&t>=this.FGrid.FFixedColumns&&this.FColumns.GetItem$1(n).FPictureField&&(rtl.as(i,pas["WEBLib.TMSFNCGridCell"].TTMSFNCBitmapGridCell).FBitmap.LoadFromURL(s.GetAsString(),null),rtl.as(i,pas["WEBLib.TMSFNCGridCell"].TTMSFNCBitmapGridCell).FBitmap.Empty()?rtl.as(i,pas["WEBLib.TMSFNCGridCell"].TTMSFNCBitmapGridCell).FBitmap.FOnChange=rtl.createCallback(this,"BitmapChanged"):rtl.as(i,pas["WEBLib.TMSFNCGridCell"].TTMSFNCBitmapGridCell).FBitmap.FOnChange=null),i.SetText("")}finally{this.FDataLink.SetActiveRecord(o)}}i.FControlStretched=!0}else null!=this.FGrid&&((pas["WEBLib.TMSFNCGridCell"].TTMSFNCCheckGridCell.isPrototypeOf(i)||pas["WEBLib.TMSFNCGridCell"].TTMSFNCBitmapGridCell.isPrototypeOf(i))&&i.SetText(""),i.FControlStretched=!0)},this.GetCellEditorProperties=function(t,e,i){var s=0,o=0,n=!1,r=null,a=null;if(pas["WEBLib.TMSFNCCustomGrid"].TTMSFNCGridAdapter.GetCellEditorProperties.apply(this,arguments),this.CheckDataSet()&&(n=!1,o=t-this.FGrid.FFixedColumns,this.FColumns.GetCount()>o&&t>=this.FGrid.FFixedColumns&&e>=this.FGrid.FFixedRows))if(this.FShowDefinedFields&&""===this.FColumns.GetItem$1(o).FFieldName);else{r=null,a=pas.Classes.TStringList.$create("Create$1");try{""!==this.FColumns.GetItem$1(o).FFieldName?(n=2===(r=this.FDataLink.GetDataset().FieldByName(this.FColumns.GetItem$1(o).FFieldName)).FFieldKind&&this.FColumns.GetItem$1(o).FUseLookupEditor)&&this.LoadLookupList(r,a):this.FShowDefinedFields||null!=(r=-1!==(s=this.GetFieldIndexAtColumn(o))?this.FDataLink.GetDataset().FFieldList.GetField(s):null)&&(n=2===r.FFieldKind&&this.FColumns.GetItem$1(o).FUseLookupEditor)&&this.LoadLookupList(r,a),null!=r&&(r.FDataType in rtl.createSet(1)?this.FGrid.GetCellEdit().SetMaxLength(r.FSize):this.FGrid.GetCellEdit().SetMaxLength(0)),n&&(this.FGrid.GetCellComboBox().SetParent(this.FGrid),this.FGrid.GetCellComboBox().FItems.Assign(a),this.FGrid.GetCellComboBox().SetParent(null))}finally{a=rtl.freeLoc(a)}}},this.GetCellClass=function(t,e,i){var s=null,o=0;pas["WEBLib.TMSFNCCustomGrid"].TTMSFNCGridAdapter.GetCellClass.apply(this,arguments),null!=this.FGrid&&this.CheckDataSet()&&(o=t-this.FGrid.FFixedColumns,this.FColumns.GetCount()>o&&(this.FShowBooleanFields&&t>=this.FGrid.FFixedColumns&&e>=this.FGrid.FFixedRows&&null!=(s=this.GetFieldAtColumn(o))&&4===s.FDataType&&i.set(pas["WEBLib.TMSFNCGridCell"].TTMSFNCCheckGridCell),t>=this.FGrid.FFixedColumns&&e>=this.FGrid.FFixedRows&&this.FColumns.GetItem$1(o).FCheckBoxField&&i.set(pas["WEBLib.TMSFNCGridCell"].TTMSFNCCheckGridCell),t>=this.FGrid.FFixedColumns&&e>=this.FGrid.FFixedRows&&this.FColumns.GetItem$1(o).FPictureField&&i.set(pas["WEBLib.TMSFNCGridCell"].TTMSFNCBitmapGridCell)))},this.GetCellEditorType=function(t,e,i){var s=0,o=!1,n=null,r=0;if(pas["WEBLib.TMSFNCCustomGrid"].TTMSFNCGridAdapter.GetCellEditorType.apply(this,arguments),o=!1,this.CheckDataSet()&&(r=t-this.FGrid.FFixedColumns)>=0&&r<=this.FColumns.GetCount()-1){if(this.FColumns.GetItem$1(r).FUseColumnEditor)return;if(this.FShowDefinedFields&&""===this.FColumns.GetItem$1(r).FFieldName)i.set(this.FGrid.FColumns.GetItem$1(t).FEditor);else{if(n=null,""!==this.FColumns.GetItem$1(r).FFieldName?o=2===(n=this.FDataLink.GetDataset().FieldByName(this.FColumns.GetItem$1(r).FFieldName)).FFieldKind&&this.FColumns.GetItem$1(r).FUseLookupEditor:this.FShowDefinedFields||null!=(n=-1!==(s=this.GetFieldIndexAtColumn(r))?this.FDataLink.GetDataset().FFieldList.GetField(s):null)&&(o=2===n.FFieldKind&&this.FColumns.GetItem$1(r).FUseLookupEditor),null!=n){var a=n.FDataType;2===a||3===a?i.set(1):5===a?i.set(3):6===a||7===a||8===a?i.set(14):i.set(0)}o&&i.set(12)}}},this.CellCheckBoxClick=function(t,e,i){var s=0,o=null,n=!1;pas["WEBLib.TMSFNCCustomGrid"].TTMSFNCGridAdapter.CellCheckBoxClick.apply(this,arguments),this.CheckDataSet()&&(s=t-this.FGrid.FFixedColumns,this.FGrid.GetFocusedCell().Row!==e&&this.FGrid.SelectCell(pas["WEBLib.TMSFNCGridData"].TTMSFNCGridCellRec.$clone(pas["WEBLib.TMSFNCGridData"].MakeCell(this.FGrid.GetFocusedCell().Col,e)),{},!1),s>=this.FColumns.GetCount()||this.CheckDataSet()&&(n=this.GetDataSource().FAutoEdit||2===this.FDataLink.GetDataset().FState,this.FDataLink.GetDataset().GetCanModify()&&n&&(this.FDataLink.GetDataset().Edit(),null!=(o=this.GetFieldAtColumn(s))&&(4===o.FDataType?o.SetAsBoolean(!o.GetAsBoolean()):this.FColumns.GetItem$1(s).FCheckBoxField&&(pas.SysUtils.UpperCase(this.FColumns.GetItem$1(s).FCheckTrue)===pas.SysUtils.UpperCase(o.GetAsString())?o.SetAsString(this.FColumns.GetItem$1(s).FCheckFalse):o.SetAsString(this.FColumns.GetItem$1(s).FCheckTrue)),1===this.FPostMode&&this.FDataLink.GetDataset().Post()))))},this.ExportNotification=function(t,e){var i=0,s=!1;if(pas["WEBLib.TMSFNCCustomGrid"].TTMSFNCGridAdapter.ExportNotification.apply(this,arguments),this.CheckDataSet()){var o=t;0===o?(this.FExporting=!0,this.FSelExport=!1,this.FOldIsEOF=this.FDataLink.GetDataset().FEOF,this.FOldIsBOF=this.FDataLink.GetDataset().FBOF,this.FDataLink.GetDataset().DisableControls(),this.FMustEnableControls+=1,this.FOldAR=this.FDataLink.GetActiveRecord(),this.FOldPosition.$assign(this.FDataLink.GetDataset().GetBookmark()),this.FOldTopRow=this.FGrid.GetTopRow(),e>=0&&1===this.FDataSetType&&(this.FExportStartRow=e,this.FDataLink.GetDataset().First(),e-this.FGrid.FFixedRows>0&&this.FDataLink.GetDataset().MoveBy(e-this.FGrid.FFixedRows))):1===o||3===o||6===o?0===this.FDataSetType||6===t?this.FGrid.SetTopRow(e):(3===t&&(this.FSelExport=!0),this.FExportRow=e,this.FSelExport?(this.FDataLink.GetDataset().BookmarkValid(pas.DB.TBookmark.$clone(this.FOldPosition))&&this.FDataLink.GetDataset().GotoBookmark(this.FOldPosition),e-this.FGrid.GetTopRow()>0&&this.FDataLink.GetDataset().MoveBy(e-this.FGrid.GetTopRow())):(this.FDataLink.GetDataset().First(),e-this.FGrid.FFixedRows>0&&this.FDataLink.GetDataset().MoveBy(e-this.FGrid.FFixedRows))):5===o?0===this.FDataSetType?this.FGrid.SetTopRow(e):(this.FExportRow=e,e!==this.FExportStartRow&&e-this.FGrid.FFixedRows>0&&this.FDataLink.GetDataset().MoveBy(1)):2===o?(this.FExporting=!1,this.FExportRow=-1,this.FSelExport=!1,this.FExportStartRow=-1,pas.System.Assigned(this.FOldPosition)&&(this.FOldTopRow>-1&&this.FGrid.SetTopRow(this.FOldTopRow),this.FDataLink.GetDataset().BookmarkValid(pas.DB.TBookmark.$clone(this.FOldPosition))&&(this.FDataLink.GetDataset().GotoBookmark(this.FOldPosition),this.FDataLink.GetDataset().FreeBookmark(pas.DB.TBookmark.$clone(this.FOldPosition))),this.ClearOldPosition(),this.FOldAR!==this.FDataLink.GetActiveRecord()&&(this.FOldAR<this.FDataLink.GetActiveRecord()?(i=this.FDataLink.GetBufferCount()-this.FDataLink.GetActiveRecord()+this.FDataLink.GetActiveRecord()-this.FOldAR,i=this.FDataLink.GetDataset().MoveBy(i),this.FDataLink.GetDataset().MoveBy(-i)):(i=this.FDataLink.GetActiveRecord()+(this.FOldAR-this.FDataLink.GetActiveRecord()),i=this.FDataLink.GetDataset().MoveBy(-i),this.FDataLink.GetDataset().MoveBy(Math.abs(i)))),this.FOldIsEOF&&this.FDataLink.GetDataset().Next(),this.FOldIsBOF&&this.FDataLink.GetDataset().Prior(),s=this.FDoNotCountRow,this.FDoNotCountRow=!0,this.FMustEnableControls-=1,this.FDataLink.GetDataset().EnableControls(),this.FDoNotCountRow=s),this.FMustEnableControls>0&&this.FDataLink.GetDataset().ControlsDisabled()&&this.FDataLink.GetDataset().EnableControls()):4===o&&(this.FExporting=!1,this.FExportRow=-1,this.FSelExport=!1,this.FExportStartRow=-1,pas.System.Assigned(this.FOldPosition)&&(this.FDataLink.GetDataset().FreeBookmark(pas.DB.TBookmark.$clone(this.FOldPosition)),this.ClearOldPosition(),this.FDataLink.GetDataset().EnableControls()))}},this.LoadLookupList=function(e,i){var s="",o="",n=0,r=null,a=null;if(this.CheckDataSet()&&null!=e&&null!=e.FLookupDataSet){e.FLookupDataSet.DisableControls(),e.FLookupDataSet.First();for(var l=0,h=this.FLookupKeys.GetCount()-1;l<=h;l++)n=l,null!=(r=this.FLookupKeys.GetObject(n))&&(r=rtl.freeLoc(r));for(n=1,this.FLookupKeys.Clear(),i.Clear();!e.FLookupDataSet.FEOF;)s=e.FLookupDataSet.FieldByName(e.FLookupresultField).GetAsString(),o=e.FLookupDataSet.FieldByName(e.FLookupKeyfields).GetAsString(),a=t.TTMSFNCGridDatabaseAdapterLookupItem.$create("Create$1",[n]),this.FLookupKeys.AddObject(o,a),i.AddObject(s,a),n+=1,e.FLookupDataSet.Next();e.FLookupDataSet.EnableControls()}},this.CellBeforeEdit=function(t,e){pas["WEBLib.TMSFNCCustomGrid"].TTMSFNCGridAdapter.CellBeforeEdit.apply(this,arguments),this.CheckDataSet()&&this.FDataLink.GetDataset().Edit()},this.CellBeforeEditExit=function(t,e,i,s){pas["WEBLib.TMSFNCCustomGrid"].TTMSFNCGridAdapter.CellBeforeEditExit.apply(this,arguments),s.set(!1)},this.CellEditCancel=function(t,e){pas["WEBLib.TMSFNCCustomGrid"].TTMSFNCGridAdapter.CellEditCancel.apply(this,arguments),this.CheckDataSet()&&this.FDataLink.GetDataset().Cancel()},this.GetVersion=function(){return this.$class.GetVersionNumber(1,0,0,15)},this.CanCancelEdit=function(){return!1,!1},this.AlternateDisplayBuildUp=function(){return!1,!1},this.CheckDatasetType=function(){var t;return this.FDataSetTypeAuto&&(this.FDataLink.GetDataset().IsSequenced()?this.FDataSetType=0:this.FDataSetType=1),t=this.FOldDatasetType!==this.FDataSetType&&1===this.FDataLink.GetDataset().FState,this.FOldDatasetType=this.FDataSetType,t},this.GetBufferCount=function(){var t=0;return t=0,null!=this.FGrid&&(t=this.FGrid.VisibleRowCount()+1)<rtl.trunc(Math.round(this.FGrid.GetHeight())/Math.round(this.FGrid.FDefaultRowHeight))-this.FGrid.FFixedRows+1&&(t=rtl.trunc(Math.round(this.FGrid.GetHeight())/Math.round(this.FGrid.FDefaultRowHeight))-this.FGrid.FFixedRows+1),t},this.GetRecordCount=function(){var t=this,e=0;return e=0,null!=this.FDataLink&&null!=this.FDataLink.GetDataset()&&this.FDataLink.GetDataset().GetActive()&&(this.FDataLink.GetDataset().DisableControls(),null!=this.FOnGetRecordCount?this.FOnGetRecordCount(t,{get:function(){return e},set:function(t){e=t}}):-1===(e=function(){var e,i,s=0,o=pas.DB.TBookmark.$new();if(s=-1,!t.CheckDataSet())return s;if(e=t.FDataLink.GetDataset().FEOF,(i=t.FDataLink.GetDataset().FBOF)&&e)s=0;else{var n=t.FDataLink.GetDataset();o.$assign(n.GetBookmark()),n.BookmarkValid(pas.DB.TBookmark.$clone(o))&&(n.First(),s=4 in n.FComponentState?n.MoveBy(100):n.MoveBy(2147483647)+1,n.GotoBookmark(o)),n.FreeBookmark(pas.DB.TBookmark.$clone(o))}return e&&t.FDataLink.GetDataset().Next(),i&&t.FDataLink.GetDataset().Prior(),3===t.FDataLink.GetDataset().FState&&(s+=1),s}())&&(e=this.FDataLink.GetRecordCount()),this.FEmptyDataSet=0===e,this.FDataLink.GetDataset().EnableControls()),e},this.GetRecordNo=function(){return 3===this.FDataLink.GetDataset().FState?this.FPrevRecNo:this.FDataLink.GetDataset().GetRecNo()},this.GetLookupKey=function(t){var e="",i=0;e="";for(var s=0,o=this.FLookupKeys.GetCount()-1;s<=o;s++)if(i=s,this.FLookupKeys.GetObject(i).FIndex===t){e=this.FLookupKeys.Get(i);break}return e},this.HTMLDBReplace=function(t,e,i,s){var o="",n="",r="",a="",l=0,h=0,F=null;for(o="";pas.System.Pos("<#",t)>0;)l=pas.System.Pos("<#",t),o+=pas.System.Copy(t,1,l-1),n=pas.System.Copy(t,l,t.length),h=pas.System.Pos(">",n),r=pas.System.Copy(n,1,h-1),pas.System.Delete({get:function(){return r},set:function(t){r=t}},1,2),pas.System.Delete({get:function(){return t},set:function(e){t=e}},1,l+h-1),a="",null!=e&&e.GetActive()?(null!=(F=e.FindField(r))&&(a=F.$class.IsBlob()?this.FShowMemoFields?null!=F.FOnGetText?F.GetDisplayText():F.GetAsString():"(MEMO)":F.GetDisplayText()),null!=this.FOnGetHTMLTemplateData&&this.FOnGetHTMLTemplateData(this,i,s,r,{get:function(){return a},set:function(t){a=t}})):a="("+r+")",o+=a;return o+t},this.Assign=function(e){t.TTMSFNCGridDatabaseAdapter.isPrototypeOf(e)&&(this.FColumns.Assign(rtl.as(e,t.TTMSFNCGridDatabaseAdapter).FColumns),this.FAutoRemoveColumns=rtl.as(e,t.TTMSFNCGridDatabaseAdapter).FAutoRemoveColumns,this.FAutoCreateColumns=rtl.as(e,t.TTMSFNCGridDatabaseAdapter).FAutoCreateColumns,this.FDataSetType=rtl.as(e,t.TTMSFNCGridDatabaseAdapter).FDataSetType,this.FDataSetTypeAuto=rtl.as(e,t.TTMSFNCGridDatabaseAdapter).FDataSetTypeAuto,this.FShowBooleanFields=rtl.as(e,t.TTMSFNCGridDatabaseAdapter).FShowBooleanFields,this.FShowPictureFields=rtl.as(e,t.TTMSFNCGridDatabaseAdapter).FShowPictureFields,this.FShowMemoFields=rtl.as(e,t.TTMSFNCGridDatabaseAdapter).FShowMemoFields,this.FPostMode=rtl.as(e,t.TTMSFNCGridDatabaseAdapter).FPostMode)},this.Create$1=function(e){return pas["WEBLib.TMSFNCCustomGrid"].TTMSFNCGridAdapter.Create$1.apply(this,arguments),this.FPrevRecNo=1,this.FSelectTimer=pas["WEBLib.ExtCtrls"].TTimer.$create("Create$1",[this]),this.FSelectTimer.SetEnabled(!1),this.FSelectTimer.FOnTimer=rtl.createCallback(this,"DoSelectTimer"),this.FSelectTimer.SetInterval(1),this.FEditText="",this.FOldAR=-1,this.FExportRow=-1,this.FExportStartRow=-1,this.ClearOldPosition(),this.FOldTopRow=-1,this.FLookupKeys=pas.Classes.TStringList.$create("Create$1"),this.FDataSetTypeAuto=!0,this.FEmptyDataSet=!1,this.FDataSetType=0,this.FDataLink=t.TTMSFNCGridDatabaseAdapterItemDataLink.$create("Create$2",[this]),this.FColumns=t.TTMSFNCGridDatabaseAdapterColumns.$create("Create$3",[this]),this.FAutoRemoveColumns=!0,this.FAutoCreateColumns=!0,this.FShowPictureFields=!0,this.FShowBooleanFields=!0,this.FShowDefinedFields=!1,this.FPostMode=2,this},this.Destroy=function(){var t=0,e=null;pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FSelectTimer},set:function(t){this.p.FSelectTimer=t}});for(var i=0,s=this.FLookupKeys.GetCount()-1;i<=s;i++)t=i,null!=(e=this.FLookupKeys.GetObject(t))&&(e=rtl.freeLoc(e));pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FLookupKeys},set:function(t){this.p.FLookupKeys=t}}),pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FColumns},set:function(t){this.p.FColumns=t}}),pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FDataLink},set:function(t){this.p.FDataLink=t}}),pas["WEBLib.Controls"].TCustomControl.Destroy.call(this)},this.CheckDataSet=function(){return this.FActive&&null!=this.FDataLink&&null!=this.FDataLink.GetDataset()&&this.FDataLink.GetDataset().GetActive()},this.SetActiveRecord=function(t){var e=0,i=0,s=0,o=this.FDataSetType;0===o?(e=this.GetRecordNo(),i=this.FDataLink.GetActiveRecord()+this.FGrid.GetTopRow()-this.FGrid.FFixedRows-(e-1),s=t-this.FGrid.GetTopRow()+i,this.FDataLink.SetActiveRecord(s)):1===o&&(s=t-this.FGrid.GetTopRow()+this.FOffset,this.FNewAppendRecord,this.FDataLink.SetActiveRecord(s))},rtl.addIntf(this,pas["WEBLib.TMSFNCTypes"].ITMSFNCProductInfo),rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas.System.IUnknown);var e=this.$rtti;e.addProperty("Version",1,rtl.string,"GetVersion",""),e.addProperty("DataSource",3,pas.DB.$rtti.TDataSource,"GetDataSource","SetDataSource"),e.addProperty("Columns",2,t.$rtti.TTMSFNCGridDatabaseAdapterColumns,"FColumns","SetColumns"),e.addProperty("AutoCreateColumns",0,rtl.boolean,"FAutoCreateColumns","FAutoCreateColumns",{Default:!0}),e.addProperty("AutoRemoveColumns",0,rtl.boolean,"FAutoRemoveColumns","FAutoRemoveColumns",{Default:!0}),e.addProperty("OnGetRecordCount",0,t.$rtti.TTMSFNCGridDatabaseAdapterGetRecordCountEvent,"FOnGetRecordCount","FOnGetRecordCount"),e.addProperty("OnGetHTMLTemplateData",0,t.$rtti.TTMSFNCGridDatabaseAdapterGetHTMLTemplateDataEvent,"FOnGetHTMLTemplateData","FOnGetHTMLTemplateData"),e.addProperty("OnGetHTMLTemplate",0,t.$rtti.TTMSFNCGridDatabaseAdapterGetHTMLTemplateEvent,"FOnGetHTMLTemplate","FOnGetHTMLTemplate"),e.addProperty("DataSetType",2,t.$rtti.TTMSFNCGridDatabaseAdapterDataSetType,"FDataSetType","SetDataSetType",{Default:t.TTMSFNCGridDatabaseAdapterDataSetType.adsSequenced}),e.addProperty("DataSetTypeAuto",0,rtl.boolean,"FDataSetTypeAuto","FDataSetTypeAuto",{Default:!0}),e.addProperty("ShowBooleanFields",0,rtl.boolean,"FShowBooleanFields","FShowBooleanFields",{Default:!0}),e.addProperty("ShowPictureFields",0,rtl.boolean,"FShowPictureFields","FShowPictureFields",{Default:!0}),e.addProperty("ShowMemoFields",0,rtl.boolean,"FShowMemoFields","FShowMemoFields",{Default:!1}),e.addProperty("PostMode",0,t.$rtti.TTMSFNCGridDatabaseAdapterPostMode,"FPostMode","FPostMode",{Default:t.TTMSFNCGridDatabaseAdapterPostMode.apmRow}),e.attr=[pas.Classes.ComponentPlatformsAttribute,"Create$1",[0]]})),t.$resourcestrings={sTMSFNCGridDatabaseAdapterUnidirectionalDataSet:{org:"Unidirectional DataSet."},sTMSFNCGridDatabaseAdapterNoGridAssigned:{org:"No grid assigned."},sTMSFNCGridDatabaseAdapterCheckBoxField:{org:"Cannot assign true when CheckBoxField or ProgressField is also true."},sTMSFNCGridDatabaseAdapterPictureField:{org:"Cannot assign true when PictureField or ProgressField is also true."},sTMSFNCGridDatabaseAdapterCheckPictureField:{org:"Cannot assign true when CheckBoxField or PictureField is also true."}},t.$implcode=function(){rtl.createClass(e,"TTMSFNCCustomGridOpen",pas["WEBLib.TMSFNCCustomGrid"].TTMSFNCCustomGrid,(function(){rtl.addIntf(this,pas["WEBLib.TMSFNCBitmapContainer"].ITMSFNCBitmapContainer),rtl.addIntf(this,pas["WEBLib.TMSFNCGraphicsTypes"].ITMSFNCAppearanceGlobalFont),rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas["WEBLib.TMSFNCTypes"].ITMSFNCProductInfo),rtl.addIntf(this,pas.System.IUnknown)}))}}),["WEBLib.TMSFNCUtils","SysUtils","Math"]),rtl.module("WebLib.SERTTK.CVTypes",["System","Classes","Generics.Collections","SysUtils","DB","WEBLib.TMSFNCTreeViewData","WEBLib.TMSFNCPageControl","WEBLib.TMSFNCToolBar","WEBLib.TMSFNCStatusBar","WEBLib.TMSFNCGraphicsTypes","WEBLib.TMSFNCGrid","WEBLib.TMSFNCGridCell","WEBLib.TMSFNCGridData","WEBLib.TMSFNCGridDatabaseAdapter","WebLib.SERTTK.Repository","WebLib.SERTTK.Session","WebLib.SEFNC.Layout","WEBLib.Menus","WEBLib.Controls","WEBLib.StdCtrls"],(function(){"use strict";var t=this;this.TSESPMOption={0:"pmoShowPath",pmoShowPath:0,1:"pmoGoToActive",pmoGoToActive:1,2:"pmoRefreshRoot",pmoRefreshRoot:2},this.PMOptionDisplay=["ShowPath","Go To Active","Refresh"],rtl.createClass(this,"TSEFNCPopupMenu",pas["WEBLib.Menus"].TWebPopupMenu,(function(){rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"ESECvBaseException",pas.SysUtils.Exception,(function(){})),rtl.createClass(this,"ECVToolInstanceCreateException",this.ESECvBaseException,(function(){})),rtl.createClass(this,"ECVToolInitUIException",this.ESECvBaseException,(function(){})),rtl.createClass(this,"ECVToolPageLayoutCreateException",this.ESECvBaseException,(function(){})),rtl.createClass(this,"TSECVToolArea",pas["WebLib.SEFNC.Layout"].TSEFNCLayout,(function(){this.$init=function(){pas["WebLib.SEFNC.Layout"].TSEFNCLayout.$init.call(this),this.FToolBar=null,this.FHelpButton=null,this.FOwner$1=null,this.FButtons=null},this.$final=function(){this.FToolBar=void 0,this.FHelpButton=void 0,this.FOwner$1=void 0,this.FButtons=void 0,pas["WebLib.SEFNC.Layout"].TSEFNCLayout.$final.call(this)},this.HelpLinkClick=function(t){pas["WEBLib.TMSFNCToolBar"].TTMSFNCToolBarButton.isPrototypeOf(t)&&pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.OpenURL(t.FDataString)},this.AddButton=function(t){var e=null;return(e=this.FToolBar.AddButton(80,-1,"","",t,-1)).SetBitmapVisible(!1),e.SetTextVisible(!0),this.FButtons.Add(t,e),e},this.HelpLinkSet=function(t){this.FHelpButton=pas["WEBLib.TMSFNCToolBar"].TTMSFNCToolBarButton.$create("Create$1",[this.FOwner$1]),this.FHelpButton.SetParent(this),this.FHelpButton.SetAlign(pas["WebLib.SEFNC.Layout"].TSEFNCAlign.GetAlign(4)),this.FHelpButton.FOnClick=rtl.createCallback(this,"HelpLinkClick"),this.FHelpButton.FDataString=t,this.FHelpButton.SetText("Help")},this.Create$4=function(t){var e=rtl.createIntfRefs();try{this.FOwner$1=t.FOwner,pas["WEBLib.Controls"].TControl.Create$1.call(this,this.FOwner$1),this.SetHeight(Math.round(32*pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.GetDPIScale(this,-1))),this.SetParent(t),this.SetAlign(pas["WebLib.SEFNC.Layout"].TSEFNCAlign.GetAlign(1)),this.BeginUpdate(),e.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("Layout created",this),this.FButtons=pas["Generics.Collections"].TDictionary$G15.$create("Create$1",[0]),this.FToolBar=pas["WEBLib.TMSFNCToolBar"].TTMSFNCToolBar.$create("Create$1",[this]),this.FToolBar.SetParent(this),e.ref(2,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("TB Parent created",this),this.FToolBar.SetAlign(pas["WebLib.SEFNC.Layout"].TSEFNCAlign.GetAlign(5)),e.ref(3,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("TB Align created",this),this.FToolBar.FOptionsMenu.SetShowButton(!1),e.ref(4,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("TB Button created",this),this.EndUpdate()}finally{e.free()}return this},this.Destroy=function(){rtl.free(this,"FButtons"),pas["WEBLib.ExtCtrls"].TCustomPanel.Destroy.call(this)},this.ButtonByName=function(t){var e=null;return this.FButtons.TryGetValue(t,{get:function(){return e},set:function(t){e=t}}),e},this.NewButton=function(t){this.AddButton(t)},this.NewButton$1=function(t,e){this.AddButton(t).FOnClick=e},this.AddCustomControl=function(t,e){t.SetParent(this),t.SetAlign(pas["WebLib.SEFNC.Layout"].TSEFNCAlign.GetAlign(3))},this.ColorSet=function(t){this.FToolBar.FAppearance.FFill.SetColor(t),this.FToolBar.FAppearance.FFill.SetKind(1)},rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TSECVRepositoryBase",pas.System.TObject,(function(){this.$init=function(){pas.System.TObject.$init.call(this),this.FSession=null,this.FSupportRepository=null},this.$final=function(){this.FSession=void 0,this.FSupportRepository=void 0,pas.System.TObject.$final.call(this)},this.OnLineGet=function(){return null!=this.FSupportRepository},this.RepositoryGet=function(){return this.FSupportRepository},this.RepositorySet=function(t){var e=rtl.createIntfRefs();try{try{this.FSupportRepository=t,this.SessionSet(this.FSupportRepository.FSession),this.OnRepositorySet(this.FSupportRepository),e.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("Repo set successfully for CV",this)}catch(t){if(pas.SysUtils.Exception.isPrototypeOf(t)){var i=t;e.ref(2,pas["WebLib.SEFNC.Logger"].Logger()).Error$2("Repository set failed",i,this)}else e.ref(3,pas["WebLib.SEFNC.Logger"].Logger()).Error$1("Repository set failed - else",this)}}finally{e.free()}},this.OnRepositorySet=function(t){},this.SessionSet=function(t){this.FSession=t}})),rtl.createClass(this,"TSECVOwnedDisplay",this.TSECVRepositoryBase,(function(){this.$init=function(){t.TSECVRepositoryBase.$init.call(this),this.FOwner=null},this.$final=function(){this.FOwner=void 0,t.TSECVRepositoryBase.$final.call(this)},this.Create$1=function(t){return this.FOwner=t,pas.System.TObject.Create.call(this),this}})),rtl.createClass(this,"TSECVDisplayBase",this.TSECVOwnedDisplay,(function(){this.$init=function(){t.TSECVOwnedDisplay.$init.call(this),this.FLayout=null},this.$final=function(){this.FLayout=void 0,t.TSECVOwnedDisplay.$final.call(this)},this.Create$2=function(e,i){return t.TSECVOwnedDisplay.Create$1.call(this,i),this.FLayout=e,this}})),rtl.createClass(this,"TSECVToolPage",this.TSECVOwnedDisplay,(function(){this.$init=function(){t.TSECVOwnedDisplay.$init.call(this),this.FToolPage=null},this.$final=function(){this.FToolPage=void 0,t.TSECVOwnedDisplay.$final.call(this)},this.Create$2=function(e){return this.FToolPage=e,t.TSECVOwnedDisplay.Create$1.call(this,this.FToolPage.FContainer.FOwner),this}})),rtl.createClass(this,"TSECVLogToolBase",pas.System.TObject,(function(){this.$init=function(){pas.System.TObject.$init.call(this),this.FPageContainer=null,this.FPage=null,this.FOwner=null,this.FInitialized=!1},this.$final=function(){this.FPageContainer=void 0,this.FPage=void 0,this.FOwner=void 0,pas.System.TObject.$final.call(this)},this.DoInitialize=function(){var t=!1,e=rtl.createIntfRefs();try{t=!1;try{e.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("Begin Initialize Log Tool for "+this.$classname,this),this.Initialize(),e.ref(2,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("End Initialize Log Tool for "+this.$classname,this),t=!0}catch(t){if(!pas.SysUtils.Exception.isPrototypeOf(t))throw t;var i=t;e.ref(3,pas["WebLib.SEFNC.Logger"].Logger()).Warn$2("Failed Log Tool Initialize",i,this)}}finally{e.free()}return t},this.Activate=function(){var t=rtl.createIntfRefs();try{this.FInitialized||(this.FInitialized=this.DoInitialize()),t.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("Activate Log Tool for "+this.$classname,this)}finally{t.free()}},this.DeActivate=function(){var t=rtl.createIntfRefs();try{t.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("Deactivate Log Tool for "+this.$classname,this)}finally{t.free()}},this.Create$1=function(t,e){return this.FPage=t,this.FPageContainer=this.FPage.FContainer,this.FOwner=e,this.FInitialized=!1,this}})),rtl.createClass(this,"TSECVDataGrid",pas.System.TObject,(function(){this.datagrid_font_name="Consolas",this.datagrid_font_size=12,this.$init=function(){pas.System.TObject.$init.call(this),this.FDataGrid=null,this.FGridAdapter=null,this.FDataSource=null,this.FStatusMessage=null},this.$final=function(){this.FDataGrid=void 0,this.FGridAdapter=void 0,this.FDataSource=void 0,this.FStatusMessage=void 0,pas.System.TObject.$final.call(this)},this.GetCellLayout=function(t,e,i,s,o){s.FFont.SetName(this.datagrid_font_name),s.FFont.SetSize(12)},this.CreateGrid=function(t){this.FDataGrid=pas["WEBLib.TMSFNCGrid"].TTMSFNCGrid.$create("Create$1",[t]),this.FDataGrid.SetParent(t),this.FDataGrid.SetAlign(pas["WebLib.SEFNC.Layout"].TSEFNCAlign.GetAlign(5)),this.FDataGrid.FOptions.FMouse.FColumnSizing=!0,this.FDataGrid.FOptions.FColumnSize.SetSyncWithGrid(!0),this.FDataGrid.FOnGetCellLayout=rtl.createCallback(this,"GetCellLayout"),this.FGridAdapter=pas["WEBLib.TMSFNCGridDatabaseAdapter"].TTMSFNCGridDatabaseAdapter.$create("Create$1",[t]),this.FGridAdapter.SetParent(t),this.FGridAdapter.SetGrid(this.FDataGrid),this.FGridAdapter.SetVisible(!1),this.FDataSource=pas.DB.TDataSource.$create("Create$1",[t]),this.FDataSource.SetEnabled(!1),this.FGridAdapter.SetDataSource(this.FDataSource)},this.StatusMessage=function(t){null!=this.FStatusMessage&&this.FStatusMessage(t)},this.AssignGrid=function(t){this.FDataGrid.BeginUpdate(),this.FDataSource.SetDataSet(t),this.FDataSource.SetEnabled(!0),this.FGridAdapter.SetActive(!0),this.FDataGrid.EndUpdate(),this.StatusMessage("Grid Connected")},this.Create$1=function(t,e){var i=rtl.createIntfRefs();try{try{this.FStatusMessage=e,this.CreateGrid(t)}catch(t){if(!pas.SysUtils.Exception.isPrototypeOf(t))throw t;var s=t;i.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Debug("Error creating grid "+s.FMessage)}}finally{i.free()}return this}}))}),["WEBLib.TMSFNCUtils","WEBLib.Graphics","WebLib.SEFNC.Logger"]),rtl.module("WebLib.SERTTK.PluginTypes",["System","Generics.Collections","Classes","WebLib.SERTTK.Repository","WebLib.SERTTK.MarshalTypes","WEBLib.TMSFNCPageControl"],(function(){"use strict";var t=this,e=t.$impl;rtl.createClass(this,"TSERTTKPluginInspectorCVInfo",pas["WebLib.SERTTK.MarshalTypes"].TSERTTKInspectorCVInfo,(function(){})),rtl.createClass(this,"TSERTTKPluginTransform",pas["WebLib.SERTTK.Repository"].TSESTransformBase,(function(){})),rtl.createClass(this,"TSERTTKPluginToolInstance",pas["WebLib.SERTTK.MarshalTypes"].TSECVToolInstance,(function(){})),rtl.createClass(this,"TSERTTKPluginInspectTool",pas["WebLib.SERTTK.Repository"].TSESInspectToolBase,(function(){this.InitToolUI=function(t){var e=null,i=rtl.createIntfRefs();try{e=null,i.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("Init tool not correctly implmented with override",this)}finally{i.free()}return e},this.TryInitToolUI=function(t){var e=null,i=rtl.createIntfRefs();try{try{e=this.InitToolUI(t)}catch(t){if(pas.SysUtils.Exception.isPrototypeOf(t)){var s=t;throw i.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Trace$2("Failure InitToolUI",s,this),pas["WebLib.SERTTK.CVTypes"].ECVToolInitUIException.$create("Create$1",["Failure in InitToolUI"])}throw i.ref(2,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("Failure InitToolUI",this),pas["WebLib.SERTTK.CVTypes"].ECVToolInitUIException.$create("Create$1",["Failure in InitToolUI"])}}finally{i.free()}return e}})),rtl.createInterface(this,"IMarshalPlugins","{E78B7040-59B8-4DF1-8788-63A917BEE3FF}",["AddTransform","Transforms"],pas.System.IUnknown),this.MarshalPlugins=function(){var t=null,i=!1;try{t=rtl.setIntfL(t,e.TMarshalPluginFactory.FPlugins),i=!0}finally{i||rtl._Release(t)}return t},t.$implcode=function(){rtl.createClass(e,"TMarshalPluginFactory",pas.System.TObject,(function(){this.FPlugins=null})),rtl.createClass(e,"TMarshalPlugins",pas.System.TInterfacedObject,(function(){this.$init=function(){pas.System.TInterfacedObject.$init.call(this),this.FTransforms=null},this.$final=function(){this.FTransforms=void 0,pas.System.TInterfacedObject.$final.call(this)},this.Create$1=function(){return this.FTransforms=pas["Generics.Collections"].TObjectList$G11.$create("Create$4",[!0]),this},this.Destroy=function(){rtl.free(this,"FTransforms"),pas.System.TObject.Destroy.call(this)},this.AddTransform=function(t){this.FTransforms.Add(t)},this.Transforms=function(){return this.FTransforms},rtl.addIntf(this,t.IMarshalPlugins),rtl.addIntf(this,pas.System.IUnknown)}))},t.$init=function(){rtl.setIntfP(e.TMarshalPluginFactory,"FPlugins",rtl.queryIntfT(e.TMarshalPlugins.$create("Create$1"),t.IMarshalPlugins),!0)}}),["SysUtils","WebLib.SEFNC.Logger","WebLib.SERTTK.CVTypes"]),rtl.module("WEBLib.TMSFNCAnalogTimeSelector",["System","Types","Classes","WEBLib.Controls","WEBLib.TMSFNCCustomControl","WEBLib.TMSFNCGraphics","WEBLib.TMSFNCGraphicsTypes","WEBLib.TMSFNCTypes","WEBLib.ExtCtrls","WEBLib.TMSFNCStyles","WEBLib.Graphics","WEBLib.TMSFNCUtils"],(function(){"use strict";var t=this;this.MAJ_VER=1,this.MIN_VER=0,this.REL_VER=2,this.BLD_VER=0,this.TTMSFNCAnalogTimeSelectorShape={0:"wsCircle",wsCircle:0,1:"wsRect",wsRect:1,2:"wsRoundRect",wsRoundRect:2},this.$rtti.$Enum("TTMSFNCAnalogTimeSelectorShape",{minvalue:0,maxvalue:2,ordtype:1,enumtype:this.TTMSFNCAnalogTimeSelectorShape}),this.TTMSFNCAnalogTimeSelectorTickMark={0:"tmAll",tmAll:0,1:"tmHours",tmHours:1,2:"tmNone",tmNone:2,3:"tmQuartHours",tmQuartHours:3},this.$rtti.$Enum("TTMSFNCAnalogTimeSelectorTickMark",{minvalue:0,maxvalue:3,ordtype:1,enumtype:this.TTMSFNCAnalogTimeSelectorTickMark}),this.TTMSFNCAnalogTimeSelectorHourMarkStyle={0:"hmsLine",hmsLine:0,1:"hmsQuartDblLine",hmsQuartDblLine:1},this.$rtti.$Enum("TTMSFNCAnalogTimeSelectorHourMarkStyle",{minvalue:0,maxvalue:1,ordtype:1,enumtype:this.TTMSFNCAnalogTimeSelectorHourMarkStyle}),this.TTMSFNCAnalogTimeSelectorPointerStyle={0:"psLine",psLine:0,1:"psShortLine",psShortLine:1,2:"psPointer",psPointer:2,3:"psLineArrow",psLineArrow:3},this.$rtti.$Enum("TTMSFNCAnalogTimeSelectorPointerStyle",{minvalue:0,maxvalue:3,ordtype:1,enumtype:this.TTMSFNCAnalogTimeSelectorPointerStyle}),this.TTMSFNCAnalogTimeSelectorStyle={0:"wsClassic",wsClassic:0,1:"wsFluorescent",wsFluorescent:1,2:"wsEmerald",wsEmerald:2,3:"wsTower",wsTower:3,4:"wsFuchsia",wsFuchsia:4,5:"wsBlack",wsBlack:5,6:"wsBlackWhite",wsBlackWhite:6,7:"wsSuperNova",wsSuperNova:7,8:"wsSports",wsSports:8,9:"wsSmooth",wsSmooth:9,10:"wsCustom",wsCustom:10},this.$rtti.$Enum("TTMSFNCAnalogTimeSelectorStyle",{minvalue:0,maxvalue:10,ordtype:1,enumtype:this.TTMSFNCAnalogTimeSelectorStyle}),rtl.createClass(this,"TTMSFNCAnalogTimeSelectorAppearance",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FFill=null,this.FStroke=null,this.FShape=0,this.FHourMark=null,this.FTickMark=0,this.FMinuteMark=null,this.FHourMarkLength=0,this.FMinuteMarkLength=0,this.FHourFont=null,this.FAMPMFill=null,this.FAMPMStroke=null,this.FAMPMFont=null,this.FShowAMPM=!1,this.FPointerStyle=0,this.FMinutePointerShadow=null,this.FHourPointerShadow=null,this.FSecondPointer=null,this.FMinutePointer=null,this.FHourPointer=null,this.FCenterPointSize=0,this.FCenterPointFill=null,this.FCenterPointStroke=null,this.FShowSecondPointer=!1,this.FShowNumbers=!1,this.FOnChange=null,this.FHourMarkStyle=0,this.FCenterPointOuterColor=0},this.$final=function(){this.FFill=void 0,this.FStroke=void 0,this.FHourMark=void 0,this.FMinuteMark=void 0,this.FHourFont=void 0,this.FAMPMFill=void 0,this.FAMPMStroke=void 0,this.FAMPMFont=void 0,this.FMinutePointerShadow=void 0,this.FHourPointerShadow=void 0,this.FSecondPointer=void 0,this.FMinutePointer=void 0,this.FHourPointer=void 0,this.FCenterPointFill=void 0,this.FCenterPointStroke=void 0,this.FOnChange=void 0,pas.Classes.TPersistent.$final.call(this)},this.SetFill=function(t){this.FFill!==t&&this.FFill.Assign(t)},this.SetStroke=function(t){this.FStroke!==t&&this.FStroke.Assign(t)},this.SetShape=function(t){this.FShape!==t&&(this.FShape=t,this.Changed())},this.SetHourMark=function(t){this.FHourMark!==t&&this.FHourMark.Assign(t)},this.SetMinuteMark=function(t){this.FMinuteMark!==t&&(this.FMinuteMark=t)},this.SetTickMark=function(t){this.FTickMark!==t&&(this.FTickMark=t,this.Changed())},this.SetHourMarkLength=function(t){this.FHourMarkLength!==t&&(this.FHourMarkLength=t,this.Changed())},this.SetMinuteMarkLength=function(t){this.FMinuteMarkLength!==t&&(this.FMinuteMarkLength=t,this.Changed())},this.SetHourFont=function(t){this.FHourFont.AssignSource(t)},this.SetAMPMFill=function(t){this.FAMPMFill!==t&&this.FAMPMFill.Assign(t)},this.SetAMPMFont=function(t){this.FAMPMFont.AssignSource(t)},this.SetAMPMStroke=function(t){this.FAMPMStroke!==t&&this.FAMPMStroke.Assign(t)},this.SetShowAMPM=function(t){this.FShowAMPM!==t&&(this.FShowAMPM=t,this.Changed())},this.SetPointerStyle=function(t){this.FPointerStyle!==t&&(this.FPointerStyle=t,this.Changed())},this.SetHourPointerShadow=function(t){this.FHourPointerShadow!==t&&this.FHourPointerShadow.Assign(t)},this.SetMinutePointerShadow=function(t){this.FMinutePointerShadow!==t&&this.FMinutePointerShadow.Assign(t)},this.SetHourPointer=function(t){this.FHourPointer!==t&&this.FHourPointer.Assign(t)},this.SetMinutePointer=function(t){this.FMinutePointer!==t&&this.FMinutePointer.Assign(t)},this.SetSecondPointer=function(t){this.FSecondPointer!==t&&this.FSecondPointer.Assign(t)},this.SetCenterPointFill=function(t){this.FCenterPointFill!==t&&this.FCenterPointFill.Assign(t)},this.SetCenterPointSize=function(t){this.FCenterPointSize!==t&&(this.FCenterPointSize=t,this.Changed())},this.SetCenterPointStroke=function(t){this.FCenterPointStroke!==t&&this.FCenterPointStroke.Assign(t)},this.SetShowSecondPointer=function(t){this.FShowSecondPointer!==t&&(this.FShowSecondPointer=t,this.Changed())},this.SetShowNumbers=function(t){this.FShowNumbers!==t&&(this.FShowNumbers=t,this.Changed())},this.SetHourMarkStyle=function(t){this.FHourMarkStyle!==t&&(this.FHourMarkStyle=t,this.Changed())},this.SetCenterPointOuterColor=function(t){this.FCenterPointOuterColor!==t&&(this.FCenterPointOuterColor=t,this.Changed())},this.IsHourMarkLengthStored=function(){return 0!==this.FHourMarkLength},this.IsMinuteMarkLengthStored=function(){return 0!==this.FMinuteMarkLength},this.IsCenterPointSizeStored=function(){return 4!==this.FCenterPointSize},this.Changed=function(){null!=this.FOnChange&&this.FOnChange(this)},this.FillChanged=function(t){this.Changed()},this.FontChanged=function(t){this.Changed()},this.StrokeChanged=function(t){this.Changed()},this.Create$1=function(){return this.FFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[1,16777215,8421504,-1,-1]),this.FStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,12632256]),this.FHourMark=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,12632256]),this.FMinuteMark=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,12632256]),this.FHourFont=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFont.$create("Create$2"),this.FAMPMFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[1,16777215,8421504,-1,-1]),this.FAMPMStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,12632256]),this.FAMPMFont=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFont.$create("Create$2"),this.FHourPointerShadow=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,12632256]),this.FMinutePointerShadow=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,12632256]),this.FHourPointer=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,12632256]),this.FMinutePointer=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,12632256]),this.FSecondPointer=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,12632256]),this.FCenterPointFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[1,16777215,8421504,-1,-1]),this.FCenterPointStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,12632256]),this.InitializeDefault(),this.FFill.FOnChanged=rtl.createCallback(this,"FillChanged"),this.FAMPMFill.FOnChanged=rtl.createCallback(this,"FillChanged"),this.FCenterPointFill.FOnChanged=rtl.createCallback(this,"FillChanged"),this.FStroke.FOnChanged=rtl.createCallback(this,"StrokeChanged"),this.FHourMark.FOnChanged=rtl.createCallback(this,"StrokeChanged"),this.FMinuteMark.FOnChanged=rtl.createCallback(this,"StrokeChanged"),this.FAMPMStroke.FOnChanged=rtl.createCallback(this,"StrokeChanged"),this.FHourPointerShadow.FOnChanged=rtl.createCallback(this,"StrokeChanged"),this.FMinutePointerShadow.FOnChanged=rtl.createCallback(this,"StrokeChanged"),this.FHourPointer.FOnChanged=rtl.createCallback(this,"StrokeChanged"),this.FMinutePointer.FOnChanged=rtl.createCallback(this,"StrokeChanged"),this.FSecondPointer.FOnChanged=rtl.createCallback(this,"StrokeChanged"),this.FCenterPointStroke.FOnChanged=rtl.createCallback(this,"StrokeChanged"),this.FHourFont.FOnChanged=rtl.createCallback(this,"FontChanged"),this.FAMPMFont.FOnChanged=rtl.createCallback(this,"FontChanged"),this},this.Destroy=function(){rtl.free(this,"FFill"),rtl.free(this,"FStroke"),rtl.free(this,"FHourMark"),rtl.free(this,"FMinuteMark"),rtl.free(this,"FHourFont"),rtl.free(this,"FAMPMFill"),rtl.free(this,"FAMPMStroke"),rtl.free(this,"FAMPMFont"),rtl.free(this,"FHourPointerShadow"),rtl.free(this,"FMinutePointerShadow"),rtl.free(this,"FHourPointer"),rtl.free(this,"FMinutePointer"),rtl.free(this,"FSecondPointer"),rtl.free(this,"FCenterPointFill"),rtl.free(this,"FCenterPointStroke"),pas.System.TObject.Destroy.call(this)},this.Assign=function(e){t.TTMSFNCAnalogTimeSelectorAppearance.isPrototypeOf(e)?(this.FStroke.Assign(rtl.as(e,t.TTMSFNCAnalogTimeSelectorAppearance).FStroke),this.FFill.Assign(rtl.as(e,t.TTMSFNCAnalogTimeSelectorAppearance).FFill),this.FHourMark.Assign(rtl.as(e,t.TTMSFNCAnalogTimeSelectorAppearance).FHourMark),this.FMinuteMark.Assign(rtl.as(e,t.TTMSFNCAnalogTimeSelectorAppearance).FMinuteMark),this.FHourFont.AssignSource(rtl.as(e,t.TTMSFNCAnalogTimeSelectorAppearance).FHourFont),this.FAMPMFill.Assign(rtl.as(e,t.TTMSFNCAnalogTimeSelectorAppearance).FAMPMFill),this.FAMPMStroke.Assign(rtl.as(e,t.TTMSFNCAnalogTimeSelectorAppearance).FAMPMStroke),this.FAMPMFont.Assign(rtl.as(e,t.TTMSFNCAnalogTimeSelectorAppearance).FAMPMFont),this.FShowAMPM=rtl.as(e,t.TTMSFNCAnalogTimeSelectorAppearance).FShowAMPM,this.FHourPointerShadow.Assign(rtl.as(e,t.TTMSFNCAnalogTimeSelectorAppearance).FHourPointerShadow),this.FMinutePointerShadow.Assign(rtl.as(e,t.TTMSFNCAnalogTimeSelectorAppearance).FMinutePointerShadow),this.FHourPointer.Assign(rtl.as(e,t.TTMSFNCAnalogTimeSelectorAppearance).FHourPointer),this.FMinutePointer.Assign(rtl.as(e,t.TTMSFNCAnalogTimeSelectorAppearance).FMinutePointer),this.FSecondPointer.Assign(rtl.as(e,t.TTMSFNCAnalogTimeSelectorAppearance).FSecondPointer),this.FShape=rtl.as(e,t.TTMSFNCAnalogTimeSelectorAppearance).FShape,this.FTickMark=rtl.as(e,t.TTMSFNCAnalogTimeSelectorAppearance).FTickMark,this.FHourMarkLength=rtl.as(e,t.TTMSFNCAnalogTimeSelectorAppearance).FHourMarkLength,this.FMinuteMarkLength=rtl.as(e,t.TTMSFNCAnalogTimeSelectorAppearance).FMinuteMarkLength,this.FCenterPointSize=rtl.as(e,t.TTMSFNCAnalogTimeSelectorAppearance).FCenterPointSize,this.FCenterPointFill.Assign(rtl.as(e,t.TTMSFNCAnalogTimeSelectorAppearance).FCenterPointFill),this.FCenterPointStroke.Assign(rtl.as(e,t.TTMSFNCAnalogTimeSelectorAppearance).FCenterPointStroke),this.FCenterPointOuterColor=rtl.as(e,t.TTMSFNCAnalogTimeSelectorAppearance).FCenterPointOuterColor,this.FPointerStyle=rtl.as(e,t.TTMSFNCAnalogTimeSelectorAppearance).FPointerStyle,this.FShowSecondPointer=rtl.as(e,t.TTMSFNCAnalogTimeSelectorAppearance).FShowSecondPointer,this.FShowNumbers=rtl.as(e,t.TTMSFNCAnalogTimeSelectorAppearance).FShowNumbers):pas.Classes.TPersistent.Assign.apply(this,arguments)},this.InitializeDefault=function(){this.FAMPMFont.SetName("Tahoma"),this.FAMPMFont.SetSize(8),this.FAMPMFont.SetColor(0),this.FAMPMFont.SetStyle({}),this.FAMPMFill.SetKind(1),this.FAMPMFill.SetColor(16777215),this.FAMPMStroke.SetKind(1),this.FAMPMStroke.SetColor(0),this.FAMPMStroke.SetWidth(1),this.FCenterPointFill.SetColor(0),this.FCenterPointFill.SetKind(1),this.FCenterPointSize=4,this.FCenterPointStroke.SetColor(0),this.FCenterPointStroke.SetKind(1),this.FCenterPointStroke.SetWidth(1),this.FCenterPointOuterColor=-1,this.FFill.SetColor(16777215),this.FFill.SetKind(1),this.FHourFont.SetName("Tahoma"),this.FHourFont.SetSize(8),this.FHourFont.SetColor(0),this.FHourFont.SetStyle({}),this.FHourMark.SetColor(0),this.FHourMark.SetKind(1),this.FHourMark.SetWidth(1),this.FHourMarkLength=0,this.FHourPointer.SetColor(0),this.FHourPointer.SetKind(1),this.FHourPointer.SetWidth(4),this.FHourPointerShadow.SetColor(10789024),this.FHourPointerShadow.SetKind(1),this.FHourPointerShadow.SetWidth(4),this.FHourMarkStyle=0,this.FMinuteMark.SetColor(0),this.FMinuteMark.SetKind(1),this.FMinuteMark.SetWidth(1),this.FMinuteMarkLength=0,this.FMinutePointer.SetColor(0),this.FMinutePointer.SetKind(1),this.FMinutePointer.SetWidth(3),this.FMinutePointerShadow.SetColor(10789024),this.FMinutePointerShadow.SetKind(1),this.FMinutePointerShadow.SetWidth(3),this.FPointerStyle=0,this.FSecondPointer.SetColor(255),this.FSecondPointer.SetKind(1),this.FSecondPointer.SetWidth(1),this.FShape=0,this.FShowAMPM=!0,this.FShowNumbers=!0,this.FShowSecondPointer=!1,this.FStroke.SetKind(1),this.FStroke.SetColor(0),this.FStroke.SetWidth(4),this.FTickMark=0};var e=this.$rtti;e.addProperty("Fill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FFill","SetFill"),e.addProperty("Stroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FStroke","SetStroke"),e.addProperty("HourMark",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FHourMark","SetHourMark"),e.addProperty("HourFont",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFont,"FHourFont","SetHourFont"),e.addProperty("MinuteMark",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FMinuteMark","SetMinuteMark"),e.addProperty("AMPMFill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FAMPMFill","SetAMPMFill"),e.addProperty("AMPMStroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FAMPMStroke","SetAMPMStroke"),e.addProperty("AMPMFont",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFont,"FAMPMFont","SetAMPMFont"),e.addProperty("ShowAMPM",2,rtl.boolean,"FShowAMPM","SetShowAMPM",{Default:!0}),e.addProperty("Shape",2,t.$rtti.TTMSFNCAnalogTimeSelectorShape,"FShape","SetShape",{Default:t.TTMSFNCAnalogTimeSelectorShape.wsCircle}),e.addProperty("HourMarkStyle",2,t.$rtti.TTMSFNCAnalogTimeSelectorHourMarkStyle,"FHourMarkStyle","SetHourMarkStyle",{Default:t.TTMSFNCAnalogTimeSelectorHourMarkStyle.hmsLine}),e.addProperty("HourMarkLength",14,rtl.double,"FHourMarkLength","SetHourMarkLength",{stored:"IsHourMarkLengthStored"}),e.addProperty("MinuteMarkLength",14,rtl.double,"FMinuteMarkLength","SetMinuteMarkLength",{stored:"IsMinuteMarkLengthStored"}),e.addProperty("HourPointer",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FHourPointer","SetHourPointer"),e.addProperty("MinutePointer",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FMinutePointer","SetMinutePointer"),e.addProperty("SecondPointer",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FSecondPointer","SetSecondPointer"),e.addProperty("HourPointerShadow",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FHourPointerShadow","SetHourPointerShadow"),e.addProperty("MinutePointerShadow",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FMinutePointerShadow","SetMinutePointerShadow"),e.addProperty("CenterPointFill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FCenterPointFill","SetCenterPointFill"),e.addProperty("CenterPointStroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FCenterPointStroke","SetCenterPointStroke"),e.addProperty("CenterPointOuterColor",2,pas["WEBLib.Graphics"].$rtti.TColor,"FCenterPointOuterColor","SetCenterPointOuterColor",{Default:-1}),e.addProperty("CenterPointSize",14,rtl.double,"FCenterPointSize","SetCenterPointSize",{stored:"IsCenterPointSizeStored"}),e.addProperty("PointerStyle",2,t.$rtti.TTMSFNCAnalogTimeSelectorPointerStyle,"FPointerStyle","SetPointerStyle",{Default:t.TTMSFNCAnalogTimeSelectorPointerStyle.psLine}),e.addProperty("TickMarks",2,t.$rtti.TTMSFNCAnalogTimeSelectorTickMark,"FTickMark","SetTickMark",{Default:t.TTMSFNCAnalogTimeSelectorTickMark.tmAll}),e.addProperty("ShowSecondPointer",2,rtl.boolean,"FShowSecondPointer","SetShowSecondPointer",{Default:!1}),e.addProperty("ShowNumbers",2,rtl.boolean,"FShowNumbers","SetShowNumbers",{Default:!0})})),rtl.createClass(this,"TTMSFNCAnalogTimeSelectorSettings",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FAuto=!1,this.FTimeOffset=0,this.FReadOnly=!1,this.FOnChange=null},this.$final=function(){this.FOnChange=void 0,pas.Classes.TPersistent.$final.call(this)},this.SetAuto=function(t){this.FAuto!==t&&(this.FAuto=t,this.Changed())},this.SetReadOnly=function(t){this.FReadOnly!==t&&(this.FReadOnly=t,this.Changed())},this.SetTimeOffset=function(t){this.FTimeOffset!==t&&(this.FTimeOffset=t,this.Changed())},this.Changed=function(){null!=this.FOnChange&&this.FOnChange(this)},this.Create$1=function(){return this.FAuto=!1,this.FReadOnly=!1,this.FTimeOffset=0,this},this.Assign=function(e){t.TTMSFNCAnalogTimeSelectorSettings.isPrototypeOf(e)?(this.FAuto=rtl.as(e,t.TTMSFNCAnalogTimeSelectorSettings).FAuto,this.FReadOnly=rtl.as(e,t.TTMSFNCAnalogTimeSelectorSettings).FReadOnly,this.FTimeOffset=rtl.as(e,t.TTMSFNCAnalogTimeSelectorSettings).FTimeOffset):pas.Classes.TPersistent.Assign.apply(this,arguments)};var e=this.$rtti;e.addProperty("Auto",2,rtl.boolean,"FAuto","SetAuto",{Default:!1}),e.addProperty("TimeOffset",2,rtl.longint,"FTimeOffset","SetTimeOffset",{Default:0}),e.addProperty("ReadOnly",2,rtl.boolean,"FReadOnly","SetReadOnly",{Default:!1})})),this.$rtti.$MethodVar("TTMSFNCAnalogTimeSelectorBeforeDrawWatchBackgroundEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARectF",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["AShape",this.$rtti.TTMSFNCAnalogTimeSelectorShape],["AAllow",rtl.boolean,1],["ADefaultDraw",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCAnalogTimeSelectorAfterDrawWatchBackgroundEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARectF",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["AShape",this.$rtti.TTMSFNCAnalogTimeSelectorShape]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCAnalogTimeSelectorBeforeDrawTickMarkEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARectF",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["ATickMarks",this.$rtti.TTMSFNCAnalogTimeSelectorTickMark],["AHourMarkLength",rtl.double],["AMinuteMarkLength",rtl.double],["AAllow",rtl.boolean,1],["ADefaultDraw",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCAnalogTimeSelectorAfterDrawTickMarkEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARectF",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["ATickMarks",this.$rtti.TTMSFNCAnalogTimeSelectorTickMark],["AHourMarkLength",rtl.double],["AMinuteMarkLength",rtl.double]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCAnalogTimeSelectorBeforeDrawNumberEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARectF",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["ANumber",rtl.longint],["AAllow",rtl.boolean,1],["ADefaultDraw",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCAnalogTimeSelectorAfterDrawNumberEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARectF",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["ANumber",rtl.longint]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCAnalogTimeSelectorBeforeDrawAMPMEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARectF",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["AAM",rtl.boolean],["AAllow",rtl.boolean,1],["ADefaultDraw",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCAnalogTimeSelectorAfterDrawAMPMEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARectF",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["AAM",rtl.boolean]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCAnalogTimeSelectorBeforeDrawHourPointerEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ACenterPoint",pas["WEBLib.TMSFNCTypes"].$rtti.TPointF],["AAllow",rtl.boolean,1],["ADefaultDraw",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCAnalogTimeSelectorAfterDrawHourPointerEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ACenterPoint",pas["WEBLib.TMSFNCTypes"].$rtti.TPointF]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCAnalogTimeSelectorBeforeDrawMinutePointerEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ACenterPoint",pas["WEBLib.TMSFNCTypes"].$rtti.TPointF],["AAllow",rtl.boolean,1],["ADefaultDraw",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCAnalogTimeSelectorAfterDrawMinutePointerEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ACenterPoint",pas["WEBLib.TMSFNCTypes"].$rtti.TPointF]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCAnalogTimeSelectorBeforeDrawSecondPointerEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ACenterPoint",pas["WEBLib.TMSFNCTypes"].$rtti.TPointF],["AAllow",rtl.boolean,1],["ADefaultDraw",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCAnalogTimeSelectorAfterDrawSecondPonterEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ACenterPoint",pas["WEBLib.TMSFNCTypes"].$rtti.TPointF]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCAnalogTimeSelectorBeforeDrawCenterPointEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARectF",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["ACenterPointSize",rtl.double],["AAllow",rtl.boolean,1],["ADefaultDraw",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCAnalogTimeSelectorAfterDrawCenterPointEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARectF",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["ACenterPointSize",rtl.double]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCAnalogTimeSelectorSecondChangedEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ATime",pas.System.$rtti.TTime]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCAnalogTimeSelectorMinuteChangedEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ATime",pas.System.$rtti.TTime]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCAnalogTimeSelectorHourChangedEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ATime",pas.System.$rtti.TTime]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCAnalogTimeSelectorTimeChangedEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ATime",pas.System.$rtti.TTime]]),methodkind:0}),rtl.createClass(this,"TTMSFNCCustomAnalogTimeSelector",pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl,(function(){this.$init=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.$init.call(this),this.FTime=0,this.FWatchTimer=null,this.FMouseHourDown=!1,this.FMouseMinuteDown=!1,this.FAM=!1,this.FPrevHour=0,this.FPrevMin=0,this.FPrevSec=0,this.FAMRect=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),this.FAppearance=null,this.FSettings=null,this.FOnChanged=null,this.FOnBeforeDrawBackground=null,this.FOnAfterDrawBackground=null,this.FOnBeforeDrawTickMark=null,this.FOnAfterDrawTickMark=null,this.FOnBeforeDrawNumber=null,this.FOnAfterDrawNumber=null,this.FOnBeforeDrawAMPM=null,this.FOnAfterDrawAMPM=null,this.FOnAfterDrawHourPointer=null,this.FOnBeforeDrawHourPointer=null,this.FOnAfterDrawMinutePointer=null,this.FOnBeforeDrawMinutePointer=null,this.FOnBeforeDrawSecondPointer=null,this.FOnAfterDrawSecondPointer=null,this.FOnAfterDrawCenterPoint=null,this.FOnBeforeDrawCenterPoint=null,this.FOnMinuteChanged=null,this.FOnHourChanged=null,this.FOnSecondChanged=null,this.FOnTimeChanged=null,this.FStyle=0,this.FFollowMouse=!1,this.FGlobalFont=null},this.$final=function(){this.FWatchTimer=void 0,this.FAMRect=void 0,this.FAppearance=void 0,this.FSettings=void 0,this.FOnChanged=void 0,this.FOnBeforeDrawBackground=void 0,this.FOnAfterDrawBackground=void 0,this.FOnBeforeDrawTickMark=void 0,this.FOnAfterDrawTickMark=void 0,this.FOnBeforeDrawNumber=void 0,this.FOnAfterDrawNumber=void 0,this.FOnBeforeDrawAMPM=void 0,this.FOnAfterDrawAMPM=void 0,this.FOnAfterDrawHourPointer=void 0,this.FOnBeforeDrawHourPointer=void 0,this.FOnAfterDrawMinutePointer=void 0,this.FOnBeforeDrawMinutePointer=void 0,this.FOnBeforeDrawSecondPointer=void 0,this.FOnAfterDrawSecondPointer=void 0,this.FOnAfterDrawCenterPoint=void 0,this.FOnBeforeDrawCenterPoint=void 0,this.FOnMinuteChanged=void 0,this.FOnHourChanged=void 0,this.FOnSecondChanged=void 0,this.FOnTimeChanged=void 0,this.FGlobalFont=void 0,pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.$final.call(this)},this.SetTime=function(t){var e=0,i=0,s=0,o=0;this.FTime!==t&&(this.FTime=t,pas.SysUtils.DecodeTime(t,{get:function(){return e},set:function(t){e=t}},{get:function(){return i},set:function(t){i=t}},{get:function(){return s},set:function(t){s=t}},{get:function(){return o},set:function(t){o=t}}),e<12?this.SetAM(!0):this.SetAM(!1),this.Invalidate())},this.SetAM=function(t){this.FAM!==t&&(this.FAM=t,this.Invalidate())},this.SetAppearance=function(t){this.FAppearance.Assign(t)},this.SetSettings=function(t){this.FSettings.Assign(t)},this.SetStyle=function(t){if(this.FStyle!==t){this.FStyle=t;var e=this.FStyle;if(0===e){var i=this.FAppearance;i.InitializeDefault(),i.FAMPMFont.SetName("MS Sans Serif"),i.FAMPMFont.SetStyle({}),i.FAMPMFont.SetColor(0),i.FHourFont.SetName("Comic Sans MS"),i.FHourFont.SetSize(10),i.FHourFont.SetStyle(rtl.createSet(0)),i.FHourFont.SetColor(0),i.SetHourMarkLength(8),i.FHourPointer.SetColor(0),i.FHourPointer.SetWidth(5),i.FHourPointerShadow.SetColor(10789024),i.FMinutePointerShadow.SetColor(10789024),i.SetMinuteMarkLength(4),i.SetShowAMPM(!0),i.SetShowNumbers(!0),i.SetShowSecondPointer(!0)}else if(1===e){var s=this.FAppearance;s.InitializeDefault(),s.FAMPMFont.SetColor(0),s.FAMPMFont.SetSize(10),s.FAMPMFont.SetName("MS Sans Serif"),s.FAMPMFont.SetStyle({}),s.FStroke.SetColor(16727614),s.FFill.SetColor(0),s.FFill.SetColorTo(0),s.FCenterPointFill.SetColor(16727614),s.FCenterPointStroke.SetColor(0),s.SetCenterPointSize(20),s.FCenterPointStroke.SetWidth(4),s.FHourFont.SetColor(0),s.FHourFont.SetSize(8),s.FHourFont.SetName("MS Sans Serif"),s.FHourFont.SetStyle({}),s.FHourMark.SetColor(16727614),s.SetHourMarkLength(10),s.FHourPointer.SetColor(16727614),s.FHourPointer.SetWidth(2),s.FHourPointerShadow.SetColor(-1),s.FMinuteMark.SetColor(16727614),s.FMinutePointer.SetColor(16727614),s.FMinutePointer.SetWidth(2),s.FMinutePointerShadow.SetColor(-1),s.SetShape(2),s.FHourMark.SetWidth(2),s.SetHourMarkStyle(1),s.SetTickMark(1),s.SetShowAMPM(!1),s.SetShowNumbers(!1),s.SetShowSecondPointer(!0)}else if(2===e){var o=this.FAppearance;o.InitializeDefault(),o.FAMPMFont.SetColor(10485760),o.FAMPMFont.SetName("MS Sans Serif"),o.FAMPMFont.SetStyle({}),o.FStroke.SetColor(3860480),o.FFill.SetColor(3860480),o.FFill.SetColorTo(0),o.FFill.SetKind(2),o.FFill.SetOrientation(1),o.FCenterPointStroke.SetColor(4259584),o.FCenterPointStroke.SetWidth(3),o.FCenterPointFill.SetColor(3727616),o.SetCenterPointOuterColor(0),o.SetCenterPointSize(16),o.FHourFont.SetColor(0),o.FHourFont.SetName("MS Sans Serif"),o.FHourFont.SetStyle({}),o.FHourPointer.SetColor(4259584),o.FHourPointer.SetColor(4259584),o.FHourPointerShadow.SetColor(25600),o.FHourPointer.SetWidth(5),o.FMinutePointer.SetColor(4259584),o.FMinutePointerShadow.SetColor(25600),o.SetShape(1),o.SetPointerStyle(2),o.FAMPMFill.SetColor(-1),o.FHourFont.SetColor(this.FAppearance.FFill.FColor),o.SetHourMarkStyle(1),o.FHourMark.SetColor(this.FAppearance.FFill.FColor),o.FSecondPointer.SetColor(65535),o.SetTickMark(1),o.SetShowNumbers(!1),o.SetShowAMPM(!1),o.SetShowSecondPointer(!0)}else if(3===e){var n=this.FAppearance;n.InitializeDefault(),n.FAMPMFont.SetName("MS Sans Serif"),n.FAMPMFont.SetStyle({}),n.FAMPMFont.SetColor(0),n.FStroke.SetWidth(1),n.FFill.SetColor(11661566),n.FFill.SetColorTo(6016232),n.FFill.SetKind(2),n.FFill.SetOrientation(1),n.FCenterPointFill.SetColor(11221),n.SetCenterPointSize(6),n.FCenterPointStroke.SetColor(11221),n.FHourFont.SetColor(0),n.FHourFont.SetName("Century"),n.FHourFont.SetStyle(rtl.createSet(0)),n.FHourPointer.SetColor(0),n.FHourPointerShadow.SetColor(1262987),n.FHourPointer.SetWidth(5),n.FMinutePointerShadow.SetColor(1262987),n.FSecondPointer.SetColor(11221),n.SetShape(1),n.SetPointerStyle(2),n.FAMPMFill.SetColor(this.FAppearance.FFill.FColor),n.SetShowNumbers(!1),n.SetTickMark(1),n.SetShowSecondPointer(!0)}else if(4===e){var r=this.FAppearance;r.InitializeDefault(),r.FAMPMFont.SetColor(0),r.FAMPMFont.SetSize(10),r.FAMPMFont.SetName("MS Sans Serif"),r.FAMPMFont.SetStyle({}),r.FStroke.SetColor(16765183),r.FFill.SetColor(0),r.FFill.SetColorTo(0),r.FCenterPointStroke.SetColor(14510301),r.FCenterPointStroke.SetWidth(4),r.SetCenterPointSize(18),r.SetCenterPointOuterColor(0),r.FHourFont.SetColor(0),r.FHourFont.SetSize(8),r.FHourFont.SetName("MS Sans Serif"),r.FHourFont.SetStyle({}),r.FHourMark.SetColor(16765183),r.SetHourMarkLength(10),r.FHourPointer.SetColor(16765183),r.FHourPointerShadow.SetColor(-1),r.FHourPointer.SetWidth(2),r.FMinuteMark.SetColor(16765183),r.FMinutePointer.SetColor(16765183),r.FMinutePointerShadow.SetColor(-1),r.FMinutePointer.SetWidth(2),r.SetShape(1),r.FHourMark.SetWidth(2),r.SetHourMarkStyle(1),r.FSecondPointer.SetColor(14510301),r.SetTickMark(3),r.SetShowAMPM(!1),r.SetShowNumbers(!1),r.SetShowSecondPointer(!0)}else if(5===e){var a=this.FAppearance;a.InitializeDefault(),a.FAMPMFont.SetName("MS Sans Serif"),a.FAMPMFont.SetStyle({}),a.FFill.SetColor(2105376),a.FFill.SetColorTo(-1),a.FStroke.SetColor(0),a.FCenterPointStroke.SetColor(16777215),a.FCenterPointFill.SetColor(16777215),a.FHourMark.SetColor(5789784),a.FHourFont.SetColor(16777215),a.FHourFont.SetName("Century Gothic"),a.FHourFont.SetSize(11),a.FHourPointer.SetColor(16777215),a.FHourPointerShadow.SetColor(-1),a.FHourPointer.SetWidth(5),a.FMinuteMark.SetColor(5789784),a.FMinutePointer.SetColor(16777215),a.FMinutePointerShadow.SetColor(-1),a.SetMinuteMarkLength(4),a.SetShowAMPM(!1),a.SetShowNumbers(!0),a.SetShowSecondPointer(!0)}else if(6===e){var l=this.FAppearance;l.InitializeDefault(),l.FFill.SetColor(16777215),l.FFill.SetColorTo(-1),l.FStroke.SetColor(0),l.FStroke.SetWidth(8),l.FCenterPointStroke.SetColor(0),l.FCenterPointFill.SetColor(0),l.SetCenterPointSize(8),l.FHourMark.SetColor(5789784),l.FHourFont.SetColor(0),l.FHourFont.SetName("Century Gothic"),l.FHourFont.SetSize(14),l.FHourFont.SetStyle(rtl.createSet(0)),l.FHourPointer.SetColor(0),l.FHourPointerShadow.SetColor(10789024),l.FHourPointer.SetWidth(5),l.FMinutePointer.SetColor(0),l.FMinutePointerShadow.SetColor(10789024),l.SetMinuteMarkLength(4),l.FSecondPointer.SetColor(128),l.SetPointerStyle(2),l.SetTickMark(3),l.SetShowAMPM(!1),l.SetShowNumbers(!0),l.SetShowSecondPointer(!0)}else if(7===e){var h=this.FAppearance;h.InitializeDefault(),h.FFill.SetColorTo(13751251),h.FFill.SetKind(2),h.FFill.SetOrientation(1),h.FStroke.SetColor(h.FFill.FColor),h.FStroke.SetWidth(4),h.FCenterPointStroke.SetColor(0),h.SetCenterPointSize(10),h.SetHourMarkLength(Math.round(Math.min(this.GetHeight(),this.GetWidth())/4.5)),h.FHourPointer.SetColor(0),h.FHourPointerShadow.SetColor(10789024),h.FMinuteMark.SetColor(8421504),h.SetMinuteMarkLength(Math.min(this.GetHeight(),this.GetWidth())/3),h.FMinutePointer.SetColor(0),h.SetShowAMPM(!1),h.SetShowNumbers(!1),h.SetShowSecondPointer(!0)}else if(8===e){var F=this.FAppearance;F.InitializeDefault(),F.FFill.SetColor(0),F.FStroke.SetColor(0),F.FStroke.SetWidth(1),F.FCenterPointStroke.SetColor(16711680),F.SetCenterPointOuterColor(0),F.FCenterPointFill.SetColor(1644825),F.FCenterPointStroke.SetWidth(8),F.SetCenterPointSize(Math.round(Math.min(this.GetHeight(),this.GetWidth())/4)),F.FHourMark.SetColor(11251889),F.FHourFont.SetColor(7960953),F.FHourFont.SetName("Times New Roman"),F.FHourFont.SetSize(9),F.FHourPointer.SetColor(255),F.FHourPointerShadow.SetColor(-1),F.FHourPointer.SetWidth(2),F.FMinuteMark.SetColor(8421504),F.FMinutePointer.SetColor(65535),F.FMinutePointer.SetWidth(2),F.FMinutePointerShadow.SetColor(-1),F.SetMinuteMarkLength(1),F.FSecondPointer.SetColor(1608702),F.SetTickMark(3),F.SetShowAMPM(!1),F.SetShowNumbers(!0),F.SetShowSecondPointer(!0)}else if(9===e){var p=this.FAppearance;p.InitializeDefault(),p.FFill.SetColor(16777215),p.FFill.SetColorTo(11251889),p.FFill.SetKind(2),p.FFill.SetOrientation(1),p.FStroke.SetColor(5789784),p.FStroke.SetWidth(1),p.FCenterPointStroke.SetColor(0),p.FCenterPointStroke.SetWidth(1),p.FCenterPointFill.SetColor(16777215),p.SetCenterPointOuterColor(0),p.SetCenterPointSize(6),p.FHourMark.SetColor(11251889),p.FHourFont.SetColor(7960953),p.FHourFont.SetName("Times New Roman"),p.FHourFont.SetSize(9),p.FHourPointer.SetColor(4868682),p.FHourPointerShadow.SetColor(11711154),p.FHourPointer.SetWidth(2),p.FMinuteMark.SetColor(8421504),p.FMinutePointer.SetColor(4868682),p.FMinutePointer.SetWidth(2),p.FMinutePointerShadow.SetColor(11711154),p.SetMinuteMarkLength(1),p.FSecondPointer.SetColor(4868682),p.SetTickMark(3),p.SetShowAMPM(!1),p.SetShowNumbers(!0),p.SetShowSecondPointer(!0)}}},this.SetFollowMouse=function(t){this.FFollowMouse!==t&&(this.FFollowMouse=t)},this.PtInCircle=function(t,e,i){return pas.System.Sqr$1(t.X-e.X)+pas.System.Sqr$1(t.Y-e.Y)<=pas.System.Sqr$1(i)},this.SetGlobalFont=function(t){this.FGlobalFont.Assign(t)},this.Changed=function(){null!=this.FOnChanged&&this.FOnChanged(this),this.Invalidate()},this.AppearanceChanged=function(t){this.Changed()},this.SettingsChanged=function(t){this.FWatchTimer.SetEnabled(this.FSettings.FAuto),this.Changed()},this.OnWatchTimer=function(t){this.Invalidate()},this.Draw=function(t,e){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Draw.apply(this,arguments),this.DrawWatchBackground(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e)),this.DrawTickMarks(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e)),this.DrawNumbers(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e)),this.DrawAMPM(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e)),this.DrawNeedles(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e))},this.DrawWatchBackground=function(t,e){var i=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),s=!1,o=!1;if(pas["WEBLib.TMSFNCTypes"].OffsetRectEx$1(e,.5,.5),i.$assign(e),t.FFill.Assign(this.FAppearance.FFill),t.FStroke.Assign(this.FAppearance.FStroke),s=!0,o=!0,this.DoBeforeDrawWatchBackground(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),this.FAppearance.FShape,{get:function(){return s},set:function(t){s=t}},{get:function(){return o},set:function(t){o=t}}),s){if(o){var n=this.FAppearance.FShape;0===n?(i.$assign(this.GetWatchRect(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e))),t.DrawEllipse$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),0)):1===n?t.DrawRectangle$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),2):2===n&&t.DrawRoundRectangle$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),10,rtl.createSet(0,1,2,3),2)}this.DoAfterDrawWatchBackground(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),this.FAppearance.FShape)}},this.DrawTickMarks=function(t,e){var i,s=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),o=pas["WEBLib.TMSFNCTypes"].TPointF.$new(),n=pas["WEBLib.TMSFNCTypes"].TPointF.$new(),r=pas["WEBLib.TMSFNCTypes"].TPointF.$new(),a=pas["WEBLib.TMSFNCTypes"].TPointF.$new(),l=pas["WEBLib.TMSFNCTypes"].TPointF.$new(),h=0,F=0,p=!1,c=!1;s.$assign(this.GetWatchRect(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e))),o.$assign(this.GetCenterPoint(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(s))),i=this.GetRadius(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(s))-this.FAppearance.FStroke.FWidth/2,p=!0,c=!0;var u=this.FAppearance;for(h=.9*i,u.FHourMarkLength>0&&(h=i-u.FHourMarkLength),t.FStroke.Assign(u.FHourMark),F=0;F<=3;F++)if(1===u.FHourMarkStyle){var C=F;0===C||2===C?(a.$assign(pas["WEBLib.TMSFNCTypes"].PointF(Math.cos(90*F*Math.PI/180)*h+o.X,Math.sin(90*F*Math.PI/180)*h+o.Y-2)),l.$assign(pas["WEBLib.TMSFNCTypes"].PointF(Math.cos(90*F*Math.PI/180)*i+o.X,Math.sin(90*F*Math.PI/180)*i+o.Y-2)),n.$assign(pas["WEBLib.TMSFNCTypes"].PointF(Math.cos(90*F*Math.PI/180)*h+o.X,Math.sin(90*F*Math.PI/180)*h+o.Y+2)),r.$assign(pas["WEBLib.TMSFNCTypes"].PointF(Math.cos(90*F*Math.PI/180)*i+o.X,Math.sin(90*F*Math.PI/180)*i+o.Y+2)),this.DoBeforeDrawTickMark(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(s),u.FTickMark,u.FHourMarkLength,u.FMinuteMarkLength,{get:function(){return p},set:function(t){p=t}},{get:function(){return c},set:function(t){c=t}}),p&&(c&&(t.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(a),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(l),0,0),t.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(n),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(r),0,0)),this.DoAfterDrawTickMark(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(s),u.FTickMark,u.FHourMarkLength,u.FMinuteMarkLength))):1!==C&&3!==C||(a.$assign(pas["WEBLib.TMSFNCTypes"].PointF(Math.cos(90*F*Math.PI/180)*h+o.X-2,Math.sin(90*F*Math.PI/180)*h+o.Y)),l.$assign(pas["WEBLib.TMSFNCTypes"].PointF(Math.cos(90*F*Math.PI/180)*i+o.X-2,Math.sin(90*F*Math.PI/180)*i+o.Y)),n.$assign(pas["WEBLib.TMSFNCTypes"].PointF(Math.cos(90*F*Math.PI/180)*h+o.X+2,Math.sin(90*F*Math.PI/180)*h+o.Y)),r.$assign(pas["WEBLib.TMSFNCTypes"].PointF(Math.cos(90*F*Math.PI/180)*i+o.X+2,Math.sin(90*F*Math.PI/180)*i+o.Y)),this.DoBeforeDrawTickMark(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(s),u.FTickMark,u.FHourMarkLength,u.FMinuteMarkLength,{get:function(){return p},set:function(t){p=t}},{get:function(){return c},set:function(t){c=t}}),p&&(c&&(t.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(a),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(l),0,0),t.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(n),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(r),0,0)),this.DoAfterDrawTickMark(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(s),u.FTickMark,u.FHourMarkLength,u.FMinuteMarkLength)))}else n.$assign(pas["WEBLib.TMSFNCTypes"].PointF(Math.cos(90*F*Math.PI/180)*h+o.X,Math.sin(90*F*Math.PI/180)*h+o.Y)),r.$assign(pas["WEBLib.TMSFNCTypes"].PointF(Math.cos(90*F*Math.PI/180)*i+o.X,Math.sin(90*F*Math.PI/180)*i+o.Y)),this.DoBeforeDrawTickMark(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(s),u.FTickMark,u.FHourMarkLength,u.FMinuteMarkLength,{get:function(){return p},set:function(t){p=t}},{get:function(){return c},set:function(t){c=t}}),p&&(c&&t.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(n),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(r),0,0),this.DoAfterDrawTickMark(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(s),u.FTickMark,u.FHourMarkLength,u.FMinuteMarkLength));if(p=!0,c=!0,u.FTickMark in rtl.createSet(0,1))for(t.FStroke.Assign(u.FHourMark),F=0;F<=11;F++)F%3!=0&&(n.$assign(pas["WEBLib.TMSFNCTypes"].PointF(Math.cos(30*F*Math.PI/180)*h+o.X,Math.sin(30*F*Math.PI/180)*h+o.Y)),r.$assign(pas["WEBLib.TMSFNCTypes"].PointF(Math.cos(30*F*Math.PI/180)*i+o.X,Math.sin(30*F*Math.PI/180)*i+o.Y)),this.DoBeforeDrawTickMark(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(s),u.FTickMark,u.FHourMarkLength,u.FMinuteMarkLength,{get:function(){return p},set:function(t){p=t}},{get:function(){return c},set:function(t){c=t}}),p&&(c&&t.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(n),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(r),0,0),this.DoAfterDrawTickMark(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(s),u.FTickMark,u.FHourMarkLength,u.FMinuteMarkLength)));if(h=.95*i,u.FMinuteMarkLength>0&&(h=i-u.FMinuteMarkLength),p=!0,c=!0,0===u.FTickMark)for(F=0;F<=59;F++)F%5!=0&&(t.FStroke.Assign(u.FMinuteMark),n.$assign(pas["WEBLib.TMSFNCTypes"].PointF(Math.cos(6*F*Math.PI/180)*h+o.X,Math.sin(6*F*Math.PI/180)*h+o.Y)),r.$assign(pas["WEBLib.TMSFNCTypes"].PointF(Math.cos(6*F*Math.PI/180)*i+o.X,Math.sin(6*F*Math.PI/180)*i+o.Y)),this.DoBeforeDrawTickMark(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(s),u.FTickMark,u.FHourMarkLength,u.FMinuteMarkLength,{get:function(){return p},set:function(t){p=t}},{get:function(){return c},set:function(t){c=t}}),p&&(c&&t.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(n),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(r),0,0),this.DoAfterDrawTickMark(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(s),u.FTickMark,u.FHourMarkLength,u.FMinuteMarkLength)))},this.DrawNumbers=function(t,e){var i,s,o=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),n=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),r=pas["WEBLib.TMSFNCTypes"].TSizeF.$new(),a=pas["WEBLib.TMSFNCTypes"].TPointF.$new(),l=0,h=0,F=0,p=0,c=0,u=0,C="",T=!1,S=!1;if(this.FAppearance.FShowNumbers){o.$assign(this.GetWatchRect(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e))),a.$assign(this.GetCenterPoint(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(o))),i=this.GetRadius(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(o))-this.FAppearance.FStroke.FWidth/2,p=this.FAppearance.FHourMarkLength>0?this.FAppearance.FHourMarkLength:Math.round(i-.9*i)+2,t.FFont.Assign(this.FAppearance.FHourFont),T=!0,S=!0;var d=this.FAppearance;for(s=i-(p+3)-p,c=1;c<=12;c++)(0===d.FTickMark||3===d.FTickMark&&c%3==0)&&(l=Math.PI/3e3*rtl.trunc(100*c*30/6),C=pas.SysUtils.IntToStr(c),r.$assign(t.CalculateTextSize(C,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(o),!1,!0)),u=-1,10===c?u+=Math.round(.2*r.cy):11===c&&(u+=Math.round(.15*r.cy)),h=a.X+1+(s-u+p/2)*Math.sin(l),F=a.Y+2-(s-u+p/2)*Math.cos(l),n.$assign(pas["WEBLib.TMSFNCTypes"].RectF(h-p/2,F-p/2,h+p/2,F+p/2)),h=n.Right-(n.Right-n.Left)/2-r.cx/2-1,F=n.Bottom-(n.Bottom-n.Top)/2-r.cy/2-1,this.DoBeforeDrawNumber(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(n),c,{get:function(){return T},set:function(t){T=t}},{get:function(){return S},set:function(t){S=t}}),T&&(S&&t.DrawText(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(h,F)),C,0,!0,!1,-1,-1),this.DoAfterDrawNumber(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(n),c)))}},this.DrawAMPM=function(t,e){var i="",s=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),o=!1,n=!1;if(this.FAppearance.FShowAMPM){i=this.FAM?"AM":"PM",s.$assign(this.GetWatchRect(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e))),s.$assign(this.GetAMPMRect(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(s))),o=!0,n=!0;var r=this.FAppearance;t.FFill.Assign(r.FAMPMFill),t.FStroke.Assign(r.FAMPMStroke),t.FFont.Assign(r.FAMPMFont),this.DoBeforeDrawAMPM(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(s),this.FAM,{get:function(){return o},set:function(t){o=t}},{get:function(){return n},set:function(t){n=t}}),o&&(n&&(t.DrawRectangle$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(s),2),t.DrawText$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(s),i,!1,0,0,0,0,-1,-1,!0,!1,-1,-1)),this.DoAfterDrawAMPM(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(s),this.FAM))}},this.DrawNeedles=function(t,e){var i,s=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),o=pas["WEBLib.TMSFNCTypes"].TPointF.$new(),n=pas["WEBLib.TMSFNCTypes"].TPointF.$new(),r=pas["WEBLib.TMSFNCTypes"].TPointF.$new(),a=pas["WEBLib.TMSFNCTypes"].TPointF.$new(),l=pas["WEBLib.TMSFNCTypes"].TPointF.$new(),h=0,F=0,p=0,c=0,u=0,C=0,T=0,S=null,d=!1,m=!1;s.$assign(this.GetWatchRect(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e))),o.$assign(this.GetCenterPoint(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(s))),i=this.GetRadius(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(s)),this.FSettings.FAuto?(p=pas.SysUtils.Now(),p+=this.FSettings.FTimeOffset/1440,this.FTime=p):p=this.FTime,pas.SysUtils.DecodeTime(p,{get:function(){return c},set:function(t){c=t}},{get:function(){return u},set:function(t){u=t}},{get:function(){return C},set:function(t){C=t}},{get:function(){return T},set:function(t){T=t}}),this.SetAM(c<12),this.FSettings.FAuto&&C!==this.FPrevSec&&(this.FPrevSec=C,this.DoSecondChanged(this.FTime),u!==this.FPrevMin&&(this.FPrevMin=u,this.DoMinuteChanged(this.FTime),c!==this.FPrevHour&&(this.FPrevHour=c,this.DoHourChanged(this.FTime))),this.DoTimeChanged(this.FTime));var f=this.FAppearance,g=f.FPointerStyle;if(0===g||1===g||3===g){if(h=1===f.FPointerStyle?0:.1,t.FStroke.Assign(f.FHourPointerShadow),n.$assign(pas["WEBLib.TMSFNCTypes"].PointF(Math.round(o.X-1-Math.sin((30*c+u/12*6)*Math.PI/180)*i*h),o.Y+3- -Math.cos((30*c+u/12*6)*Math.PI/180)*i*h)),r.$assign(pas["WEBLib.TMSFNCTypes"].PointF(Math.round(Math.sin((30*c+u/12*6)*Math.PI/180)*i*.46+o.X-1),-Math.cos((30*c+u/12*6)*Math.PI/180)*i*.46+o.Y+3)),t.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(n),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(r),0,0),t.FStroke.Assign(f.FMinutePointerShadow),n.$assign(pas["WEBLib.TMSFNCTypes"].PointF(Math.round(o.X-Math.sin(6*u*Math.PI/180)*i*h),o.Y+3- -Math.cos(6*u*Math.PI/180)*i*h)),r.$assign(pas["WEBLib.TMSFNCTypes"].PointF(Math.round(Math.sin(6*u*Math.PI/180)*i*.65+o.X),-Math.cos(6*u*Math.PI/180)*i*.65+o.Y+3)),t.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(n),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(r),0,0),t.FStroke.Assign(f.FHourPointer),n.$assign(pas["WEBLib.TMSFNCTypes"].PointF(Math.round(o.X-Math.sin((30*c+u/12*6)*Math.PI/180)*i*h),o.Y- -Math.cos((30*c+u/12*6)*Math.PI/180)*i*h)),r.$assign(pas["WEBLib.TMSFNCTypes"].PointF(Math.round(Math.sin((30*c+u/12*6)*Math.PI/180)*i*.5+o.X),-Math.cos((30*c+u/12*6)*Math.PI/180)*i*.5+o.Y)),d=!0,m=!0,this.DoBeforeDrawHourPointer(t,pas["WEBLib.TMSFNCTypes"].TPointF.$clone(o),{get:function(){return d},set:function(t){d=t}},{get:function(){return m},set:function(t){m=t}}),d){if(m&&(t.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(n),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(r),2,2),3===f.FPointerStyle)){n.$assign(pas["WEBLib.TMSFNCTypes"].PointF(Math.sin((30*c+u/12*6+10)*Math.PI/180)*i*.4+o.X,-Math.cos((30*c+u/12*6+10)*Math.PI/180)*i*.4+o.Y)),a.$assign(pas["WEBLib.TMSFNCTypes"].PointF(Math.sin((30*c+u/12*6-10)*Math.PI/180)*i*.4+o.X,-Math.cos((30*c+u/12*6-10)*Math.PI/180)*i*.4+o.Y)),S=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsPath.$create("Create$1");try{S.MoveTo(n),S.LineTo(r),S.LineTo(a),t.FFill.SetColor(-1),t.DrawPath(S,1)}finally{S=rtl.freeLoc(S)}}this.DoAfterDrawHourPointer(t,pas["WEBLib.TMSFNCTypes"].TPointF.$clone(o))}if(t.FStroke.Assign(f.FMinutePointer),n.$assign(pas["WEBLib.TMSFNCTypes"].PointF(Math.round(o.X-Math.sin(6*u*Math.PI/180)*i*h),o.Y- -Math.cos(6*u*Math.PI/180)*i*h)),r.$assign(pas["WEBLib.TMSFNCTypes"].PointF(Math.round(Math.sin(6*u*Math.PI/180)*i*.7+o.X),-Math.cos(6*u*Math.PI/180)*i*.7+o.Y)),d=!0,m=!0,this.DoBeforeDrawMinutePointer(t,pas["WEBLib.TMSFNCTypes"].TPointF.$clone(o),{get:function(){return d},set:function(t){d=t}},{get:function(){return m},set:function(t){m=t}}),d){if(m&&(t.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(n),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(r),2,2),3===f.FPointerStyle)){n.$assign(pas["WEBLib.TMSFNCTypes"].PointF(Math.sin((6*u+7)*Math.PI/180)*i*.6+o.X,-Math.cos((6*u+7)*Math.PI/180)*i*.6+o.Y)),a.$assign(pas["WEBLib.TMSFNCTypes"].PointF(Math.sin((6*u-7)*Math.PI/180)*i*.6+o.X,-Math.cos((6*u-7)*Math.PI/180)*i*.6+o.Y)),S=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsPath.$create("Create$1");try{S.MoveTo(n),S.LineTo(r),S.LineTo(a),t.FFill.SetColor(-1),t.DrawPath(S,1)}finally{S=rtl.freeLoc(S)}}this.DoAfterDrawMinutePointer(t,pas["WEBLib.TMSFNCTypes"].TPointF.$clone(o))}}else if(2===g){t.FFill.SetColor(f.FHourPointerShadow.FColor),t.FStroke.Assign(f.FHourPointerShadow),t.FStroke.SetWidth(1),S=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsPath.$create("Create$1");try{n.$assign(pas["WEBLib.TMSFNCTypes"].PointF(o.X+1-Math.sin((30*c+u/12*6)*Math.PI/180)*i*.1,o.Y+3- -Math.cos((30*c+u/12*6)*Math.PI/180)*i*.1)),a.$assign(pas["WEBLib.TMSFNCTypes"].PointF(o.X+1-Math.sin((30*c+u/12*6+90)*Math.PI/180)*i*.05,o.Y+3- -Math.cos((30*c+u/12*6+90)*Math.PI/180)*i*.05)),l.$assign(pas["WEBLib.TMSFNCTypes"].PointF(Math.sin((30*c+u/12*6)*Math.PI/180)*i*.5+o.X+1,-Math.cos((30*c+u/12*6)*Math.PI/180)*i*.5+o.Y+3)),r.$assign(pas["WEBLib.TMSFNCTypes"].PointF(o.X+1-Math.sin((30*c+u/12*6-90)*Math.PI/180)*i*.05,o.Y+3- -Math.cos((30*c+u/12*6-90)*Math.PI/180)*i*.05)),S.MoveTo(n),S.LineTo(a),S.LineTo(l),S.LineTo(r),S.ClosePath(),t.DrawPath(S,0)}finally{S=rtl.freeLoc(S)}t.FFill.SetColor(f.FMinutePointerShadow.FColor),t.FStroke.Assign(f.FMinutePointerShadow),t.FStroke.SetWidth(1),S=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsPath.$create("Create$1");try{n.$assign(pas["WEBLib.TMSFNCTypes"].PointF(o.X+1-Math.sin(6*u*Math.PI/180)*i*.1,o.Y+3- -Math.cos(6*u*Math.PI/180)*i*.1)),a.$assign(pas["WEBLib.TMSFNCTypes"].PointF(o.X+1-Math.sin((6*u+90)*Math.PI/180)*i*.05,o.Y+3- -Math.cos((6*u+90)*Math.PI/180)*i*.05)),l.$assign(pas["WEBLib.TMSFNCTypes"].PointF(Math.sin(6*u*Math.PI/180)*i*.7+o.X+1,-Math.cos(6*u*Math.PI/180)*i*.7+o.Y+3)),r.$assign(pas["WEBLib.TMSFNCTypes"].PointF(o.X+1-Math.sin((6*u-90)*Math.PI/180)*i*.05,o.Y+3- -Math.cos((6*u-90)*Math.PI/180)*i*.05)),S.MoveTo(n),S.LineTo(a),S.LineTo(l),S.LineTo(r),S.ClosePath(),t.DrawPath(S,0)}finally{S=rtl.freeLoc(S)}t.FFill.SetColor(f.FHourPointer.FColor),t.FFill.SetColorTo(f.FHourPointer.FColor),t.FStroke.Assign(f.FHourPointer),t.FStroke.SetWidth(1),d=!0,m=!0,S=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsPath.$create("Create$1");try{n.$assign(pas["WEBLib.TMSFNCTypes"].PointF(o.X-Math.sin((30*c+u/12*6)*Math.PI/180)*i*.1,o.Y- -Math.cos((30*c+u/12*6)*Math.PI/180)*i*.1)),a.$assign(pas["WEBLib.TMSFNCTypes"].PointF(o.X-Math.sin((30*c+u/12*6+90)*Math.PI/180)*i*.05,o.Y- -Math.cos((30*c+u/12*6+90)*Math.PI/180)*i*.05)),l.$assign(pas["WEBLib.TMSFNCTypes"].PointF(Math.sin((30*c+u/12*6)*Math.PI/180)*i*.5+o.X,-Math.cos((30*c+u/12*6)*Math.PI/180)*i*.5+o.Y)),r.$assign(pas["WEBLib.TMSFNCTypes"].PointF(o.X-Math.sin((30*c+u/12*6-90)*Math.PI/180)*i*.05,o.Y- -Math.cos((30*c+u/12*6-90)*Math.PI/180)*i*.05)),S.MoveTo(n),S.LineTo(a),S.LineTo(l),S.LineTo(r),S.ClosePath(),this.DoBeforeDrawHourPointer(t,pas["WEBLib.TMSFNCTypes"].TPointF.$clone(o),{get:function(){return d},set:function(t){d=t}},{get:function(){return m},set:function(t){m=t}}),d&&(m&&t.DrawPath(S,0),this.DoAfterDrawHourPointer(t,pas["WEBLib.TMSFNCTypes"].TPointF.$clone(o)))}finally{S=rtl.freeLoc(S)}t.FFill.SetColor(f.FMinutePointer.FColor),t.FFill.SetColorTo(f.FMinutePointer.FColor),t.FStroke.Assign(f.FMinutePointer),t.FStroke.SetWidth(1),d=!0,m=!0,S=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsPath.$create("Create$1");try{n.$assign(pas["WEBLib.TMSFNCTypes"].PointF(o.X-Math.sin(6*u*Math.PI/180)*i*.1,o.Y- -Math.cos(6*u*Math.PI/180)*i*.1)),a.$assign(pas["WEBLib.TMSFNCTypes"].PointF(o.X-Math.sin((6*u+90)*Math.PI/180)*i*.05,o.Y- -Math.cos((6*u+90)*Math.PI/180)*i*.05)),l.$assign(pas["WEBLib.TMSFNCTypes"].PointF(Math.sin(6*u*Math.PI/180)*i*.7+o.X,-Math.cos(6*u*Math.PI/180)*i*.7+o.Y)),r.$assign(pas["WEBLib.TMSFNCTypes"].PointF(o.X-Math.sin((6*u-90)*Math.PI/180)*i*.05,o.Y- -Math.cos((6*u-90)*Math.PI/180)*i*.05)),S.MoveTo(n),S.LineTo(a),S.LineTo(l),S.LineTo(r),S.ClosePath(),this.DoBeforeDrawMinutePointer(t,pas["WEBLib.TMSFNCTypes"].TPointF.$clone(o),{get:function(){return d},set:function(t){d=t}},{get:function(){return m},set:function(t){m=t}}),d&&(m&&t.DrawPath(S,0),this.DoAfterDrawMinutePointer(t,pas["WEBLib.TMSFNCTypes"].TPointF.$clone(o)))}finally{S=rtl.freeLoc(S)}}d=!0,m=!0,f.FShowSecondPointer&&(n.$assign(pas["WEBLib.TMSFNCTypes"].PointF(o.X-Math.sin(6*C*Math.PI/180)*i*.2,o.Y- -Math.cos(6*C*Math.PI/180)*i*.2)),r.$assign(pas["WEBLib.TMSFNCTypes"].PointF(Math.sin(6*C*Math.PI/180)*i*.9+o.X,-Math.cos(6*C*Math.PI/180)*i*.9+o.Y)),t.FStroke.Assign(f.FSecondPointer),this.DoBeforeDrawSecondPointer(t,pas["WEBLib.TMSFNCTypes"].TPointF.$clone(o),{get:function(){return d},set:function(t){d=t}},{get:function(){return m},set:function(t){m=t}}),d&&(m&&t.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(n),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(r),0,0),this.DoAfterDrawSecondPonter(t,pas["WEBLib.TMSFNCTypes"].TPointF.$clone(o)))),d=!0,m=!0,f.FCenterPointSize>0&&(F=f.FCenterPointSize/2,s.$assign(pas["WEBLib.TMSFNCTypes"].RectF(o.X-F,o.Y-F,o.X+F,o.Y+F)),t.FFill.Assign(f.FCenterPointFill),t.FStroke.Assign(f.FCenterPointStroke),this.DoBeforeDrawCenterPoint(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(s),f.FCenterPointSize,{get:function(){return d},set:function(t){d=t}},{get:function(){return m},set:function(t){m=t}}),d&&(m&&(t.DrawEllipse$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(s),0),pas["WEBLib.TMSFNCTypes"].InflateRectEx(s,f.FCenterPointStroke.FWidth/2,f.FCenterPointStroke.FWidth/2),t.FFill.SetColor(-1),t.FStroke.SetColor(f.FCenterPointOuterColor),t.FStroke.SetWidth(.8*f.FCenterPointStroke.FWidth),t.DrawEllipse$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(s),0)),this.DoAfterDrawCenterPoint(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(s),f.FCenterPointSize)))},this.DoBeforeDrawWatchBackground=function(t,e,i,s,o){null!=this.FOnBeforeDrawBackground&&this.FOnBeforeDrawBackground(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i,s,o)},this.DoAfterDrawWatchBackground=function(t,e,i){null!=this.FOnAfterDrawBackground&&this.FOnAfterDrawBackground(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i)},this.DoBeforeDrawTickMark=function(t,e,i,s,o,n,r){null!=this.FOnBeforeDrawTickMark&&this.FOnBeforeDrawTickMark(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i,s,o,n,r)},this.DoAfterDrawTickMark=function(t,e,i,s,o){null!=this.FOnAfterDrawTickMark&&this.FOnAfterDrawTickMark(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i,s,o)},this.DoBeforeDrawNumber=function(t,e,i,s,o){null!=this.FOnBeforeDrawNumber&&this.FOnBeforeDrawNumber(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i,s,o)},this.DoAfterDrawNumber=function(t,e,i){null!=this.FOnAfterDrawNumber&&this.FOnAfterDrawNumber(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i)},this.DoBeforeDrawAMPM=function(t,e,i,s,o){null!=this.FOnBeforeDrawAMPM&&this.FOnBeforeDrawAMPM(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i,s,o)},this.DoAfterDrawAMPM=function(t,e,i){null!=this.FOnAfterDrawAMPM&&this.FOnAfterDrawAMPM(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i)},this.DoBeforeDrawHourPointer=function(t,e,i,s){null!=this.FOnBeforeDrawHourPointer&&this.FOnBeforeDrawHourPointer(this,t,pas["WEBLib.TMSFNCTypes"].TPointF.$clone(e),i,s)},this.DoAfterDrawHourPointer=function(t,e){null!=this.FOnAfterDrawHourPointer&&this.FOnAfterDrawHourPointer(this,t,pas["WEBLib.TMSFNCTypes"].TPointF.$clone(e))},this.DoBeforeDrawMinutePointer=function(t,e,i,s){null!=this.FOnBeforeDrawMinutePointer&&this.FOnBeforeDrawMinutePointer(this,t,pas["WEBLib.TMSFNCTypes"].TPointF.$clone(e),i,s)},this.DoAfterDrawMinutePointer=function(t,e){null!=this.FOnAfterDrawMinutePointer&&this.FOnAfterDrawMinutePointer(this,t,pas["WEBLib.TMSFNCTypes"].TPointF.$clone(e))},this.DoBeforeDrawSecondPointer=function(t,e,i,s){null!=this.FOnBeforeDrawSecondPointer&&this.FOnBeforeDrawSecondPointer(this,t,pas["WEBLib.TMSFNCTypes"].TPointF.$clone(e),i,s)},this.DoAfterDrawSecondPonter=function(t,e){null!=this.FOnAfterDrawSecondPointer&&this.FOnAfterDrawSecondPointer(this,t,pas["WEBLib.TMSFNCTypes"].TPointF.$clone(e))},this.DoBeforeDrawCenterPoint=function(t,e,i,s,o){null!=this.FOnBeforeDrawCenterPoint&&this.FOnBeforeDrawCenterPoint(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i,s,o)},this.DoAfterDrawCenterPoint=function(t,e,i){null!=this.FOnAfterDrawCenterPoint&&this.FOnAfterDrawCenterPoint(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i)},this.DoSecondChanged=function(t){null!=this.FOnSecondChanged&&this.FOnSecondChanged(this,t)},this.DoMinuteChanged=function(t){null!=this.FOnMinuteChanged&&this.FOnMinuteChanged(this,t)},this.DoHourChanged=function(t){null!=this.FOnHourChanged&&this.FOnHourChanged(this,t)},this.DoTimeChanged=function(t){null!=this.FOnTimeChanged&&this.FOnTimeChanged(this,t)},this.HandleMouseDown=function(t,e,i,s){var o=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),n=pas["WEBLib.TMSFNCTypes"].TPointF.$new(),r=pas["WEBLib.TMSFNCTypes"].TPointF.$new(),a=0;pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleMouseDown.apply(this,arguments),this.CanFocus()&&this.SetFocus(),o.$assign(this.GetWatchRect(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(this.GetControlRect()))),n.$assign(this.GetCenterPoint(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(o))),a=this.GetRadius(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(o)),r.$assign(pas["WEBLib.TMSFNCTypes"].PointF(i,s)),this.FSettings.FAuto&&this.FSettings.FReadOnly||(this.PtInCircle(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(r),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(n),a)&&!pas["WEBLib.TMSFNCTypes"].PtInRectEx(this.FAMRect,r)?this.FMouseHourDown=!0:pas["WEBLib.TMSFNCTypes"].PtInRectEx(this.FAMRect,r)||(this.FMouseMinuteDown=!0))},this.HandleMouseUp=function(t,e,i,s){var o=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),n=pas["WEBLib.TMSFNCTypes"].TPointF.$new(),r=pas["WEBLib.TMSFNCTypes"].TPointF.$new(),a=0,l=0,h=0,F=0,p=0,c=0;pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleMouseUp.apply(this,arguments),this.FMouseHourDown=!1,this.FMouseMinuteDown=!1,this.FSettings.FReadOnly||this.FSettings.FAuto||(o.$assign(this.GetWatchRect(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(this.GetControlRect()))),n.$assign(this.GetCenterPoint(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(o))),l=this.GetRadius(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(o)),r.$assign(pas["WEBLib.TMSFNCTypes"].PointF(i,s)),pas.SysUtils.DecodeTime(this.FTime,{get:function(){return h},set:function(t){h=t}},{get:function(){return F},set:function(t){F=t}},{get:function(){return p},set:function(t){p=t}},{get:function(){return c},set:function(t){c=t}}),this.PtInCircle(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(r),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(n),l)?pas["WEBLib.TMSFNCTypes"].PtInRectEx(this.FAMRect,r)?(h<12?this.SetTime(pas.DateUtils.IncHour(this.FTime,12)):this.SetTime(pas.DateUtils.IncHour(this.FTime,-12)),this.DoHourChanged(this.FTime),this.DoTimeChanged(this.FTime)):(a=this.XYToHour(i,s),this.SetTime(pas.SysUtils.EncodeTime(a,F,p,c)),this.DoHourChanged(this.FTime),this.DoTimeChanged(this.FTime)):(a=this.XYToMinute(i,s),this.SetTime(pas.SysUtils.EncodeTime(h,a,p,c)),this.DoMinuteChanged(this.FTime),this.DoTimeChanged(this.FTime)))},this.HandleMouseMove=function(t,e,i){var s=0,o=0,n=0,r=0,a=0;pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleMouseMove.apply(this,arguments),this.FSettings.FAuto||this.FSettings.FReadOnly||(pas["WEBLib.TMSFNCTypes"].PtInRectEx(this.FAMRect,pas["WEBLib.TMSFNCTypes"].PointF(e,i))&&this.FAppearance.FShowAMPM&&!this.FMouseHourDown&&!this.FMouseMinuteDown?this.SetControlCursor(21):this.SetControlCursor(0),this.FFollowMouse&&this.FMouseHourDown?(pas.SysUtils.DecodeTime(this.FTime,{get:function(){return s},set:function(t){s=t}},{get:function(){return o},set:function(t){o=t}},{get:function(){return n},set:function(t){n=t}},{get:function(){return r},set:function(t){r=t}}),a=this.XYToHour(e,i),this.SetTime(pas.SysUtils.EncodeTime(a,o,n,r)),this.DoHourChanged(this.FTime),this.DoTimeChanged(this.FTime)):this.FFollowMouse&&this.FMouseMinuteDown&&(pas.SysUtils.DecodeTime(this.FTime,{get:function(){return s},set:function(t){s=t}},{get:function(){return o},set:function(t){o=t}},{get:function(){return n},set:function(t){n=t}},{get:function(){return r},set:function(t){r=t}}),a=this.XYToMinute(e,i),this.SetTime(pas.SysUtils.EncodeTime(s,a,n,r)),this.DoMinuteChanged(this.FTime),this.DoTimeChanged(this.FTime)))},this.HandleKeyDown=function(t,e){var i=0,s=0,o=0,n=0;if(pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleKeyDown.apply(this,arguments),!this.FSettings.FReadOnly)if(rtl.eqSet(rtl.createSet(0),e)){var r=t.get();38===r?(this.SetTime(pas.DateUtils.IncHour(this.FTime,1)),this.DoHourChanged(this.FTime),this.DoTimeChanged(this.FTime)):40===r&&(this.SetTime(pas.DateUtils.IncHour(this.FTime,-1)),this.DoHourChanged(this.FTime),this.DoTimeChanged(this.FTime))}else{var a=t.get();38===a||39===a?(this.SetTime(pas.DateUtils.IncMinute(this.FTime,1)),this.DoMinuteChanged(this.FTime),this.DoTimeChanged(this.FTime)):40===a||37===a?(this.SetTime(pas.DateUtils.IncMinute(this.FTime,-1)),this.DoMinuteChanged(this.FTime),this.DoTimeChanged(this.FTime)):36===a?(this.SetTime(pas.SysUtils.Now()),pas.SysUtils.DecodeTime(this.FTime,{get:function(){return i},set:function(t){i=t}},{get:function(){return s},set:function(t){s=t}},{get:function(){return o},set:function(t){o=t}},{get:function(){return n},set:function(t){n=t}}),this.FPrevSec!==o&&this.DoSecondChanged(this.FTime),this.FPrevMin!==s&&this.DoMinuteChanged(this.FTime),this.FPrevHour!==i&&this.DoHourChanged(this.FTime),this.DoTimeChanged(this.FTime)):35===a?(this.SetTime(pas.SysUtils.EncodeTime(12,0,0,0)),0!==this.FPrevSec&&this.DoSecondChanged(this.FTime),0!==this.FPrevMin&&this.DoMinuteChanged(this.FTime),12!==this.FPrevHour&&this.DoHourChanged(this.FTime),this.DoTimeChanged(this.FTime)):34===a?(this.SetTime(pas.DateUtils.IncHour(this.FTime,1)),this.DoHourChanged(this.FTime),this.DoTimeChanged(this.FTime)):33===a&&(this.SetTime(pas.DateUtils.IncHour(this.FTime,-1)),this.DoHourChanged(this.FTime),this.DoTimeChanged(this.FTime))}},this.ApplyStyle=function(){var t=0;pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.ApplyStyle.call(this),t=-1,pas["WEBLib.TMSFNCStyles"].TTMSFNCStyles.GetStyleBackgroundFillColor({get:function(){return t},set:function(e){t=e}})&&(this.FAppearance.FFill.SetKind(1),this.FAppearance.FFill.SetColor(t),this.FAppearance.FAMPMFill.SetKind(1),this.FAppearance.FAMPMFill.SetColor(t)),t=-1,pas["WEBLib.TMSFNCStyles"].TTMSFNCStyles.GetStyleSelectionFillColorTo({get:function(){return t},set:function(e){t=e}})&&(this.FAppearance.FSecondPointer.SetKind(1),this.FAppearance.FSecondPointer.SetColor(t)),t=-1,pas["WEBLib.TMSFNCStyles"].TTMSFNCStyles.GetStyleSelectionFillColor({get:function(){return t},set:function(e){t=e}})&&(this.FAppearance.FStroke.SetKind(1),this.FAppearance.FStroke.SetColor(t),this.FAppearance.FHourPointer.SetKind(1),this.FAppearance.FHourPointer.SetColor(t),this.FAppearance.FMinutePointer.SetKind(1),this.FAppearance.FMinutePointer.SetColor(t),this.FAppearance.FCenterPointFill.SetKind(1),this.FAppearance.FCenterPointFill.SetColor(t),this.FAppearance.FCenterPointStroke.SetKind(1),this.FAppearance.FCenterPointStroke.SetColor(t),this.FAppearance.FHourFont.SetColor(t),this.FAppearance.FHourMark.SetKind(1),this.FAppearance.FHourMark.SetColor(t),this.FAppearance.FMinuteMark.SetKind(1),this.FAppearance.FMinuteMark.SetColor(t),this.FAppearance.FAMPMFont.SetColor(t),this.FAppearance.FAMPMStroke.SetKind(1),this.FAppearance.FAMPMStroke.SetColor(t),this.FAppearance.FHourPointerShadow.SetColor(-1),this.FAppearance.FMinutePointerShadow.SetColor(-1))},this.ResetToDefaultStyle=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.ResetToDefaultStyle.call(this),this.FAppearance.FFill.SetKind(1),this.FAppearance.FFill.SetColor(16777215),this.FAppearance.FAMPMFill.SetKind(1),this.FAppearance.FAMPMFill.SetColor(16777215),this.FAppearance.FSecondPointer.SetKind(1),this.FAppearance.FSecondPointer.SetColor(255),this.FAppearance.FStroke.SetKind(1),this.FAppearance.FStroke.SetColor(0),this.FAppearance.FHourPointer.SetKind(1),this.FAppearance.FHourPointer.SetColor(0),this.FAppearance.FMinutePointer.SetKind(1),this.FAppearance.FMinutePointer.SetColor(0),this.FAppearance.FCenterPointFill.SetKind(1),this.FAppearance.FCenterPointFill.SetColor(0),this.FAppearance.FCenterPointStroke.SetKind(1),this.FAppearance.FCenterPointStroke.SetColor(0),this.FAppearance.FHourFont.SetColor(0),this.FAppearance.FHourMark.SetKind(1),this.FAppearance.FHourMark.SetColor(0),this.FAppearance.FMinuteMark.SetKind(1),this.FAppearance.FMinuteMark.SetColor(0),this.FAppearance.FAMPMFont.SetColor(0),this.FAppearance.FAMPMStroke.SetKind(1),this.FAppearance.FAMPMStroke.SetColor(0),this.FAppearance.FHourPointerShadow.SetColor(10789024),this.FAppearance.FMinutePointerShadow.SetColor(10789024)},this.GetVersion=function(){return this.$class.GetVersionNumber(1,0,2,0)},this.GetWatchRect=function(t){var e,i,s=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),o=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),n=0;return o.$assign(t),20,(n=e=o.Bottom-o.Top)>e&&(n=e),n>(i=o.Right-o.Left)&&(n=i),n-=20,s.$assign(pas["WEBLib.TMSFNCTypes"].RectF(o.Left+(i-n)/2,o.Top+(e-n)/2,o.Left+(i-n)/2+n,o.Top+(e-n)/2+n)),s},this.GetCenterPoint=function(t){var e=pas["WEBLib.TMSFNCTypes"].TPointF.$new();return e.$assign(pas["WEBLib.TMSFNCTypes"].PointF(t.Left+(t.Right-t.Left)/2,t.Top+(t.Bottom-t.Top)/2)),e},this.GetRadius=function(t){return(t.Right-t.Left)/2},this.GetAMPMRect=function(t,e){var i,s=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),o=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),n=pas["WEBLib.TMSFNCTypes"].TPointF.$new();return o.$assign(pas["WEBLib.TMSFNCTypes"].RectF(-1,-1,-1,-1)),s.$assign(o),this.FAppearance.FShowAMPM?(t.FFont.AssignSource(this.FAppearance.FAMPMFont),o.$assign(pas["WEBLib.TMSFNCTypes"].RectF(0,0,200,200)),o.$assign(t.CalculateText("AM",pas["WEBLib.TMSFNCTypes"].TRectF.$clone(o),!1,!0)),n.$assign(this.GetCenterPoint(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e))),i=this.GetRadius(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e)),o.Right=o.Right+8,o.Bottom=o.Bottom+0,s.Left=n.X-o.Right/2,s.Top=n.Y+Math.round((i-o.Bottom)/3),s.Right=s.Left+o.Right,s.Bottom=s.Top+o.Bottom,this.FAMRect.$assign(s),s):s},this.SetFonts=function(t){this.BeginUpdate(),this.FGlobalFont.ApplyChange(this.FAppearance.FHourFont,t),this.FGlobalFont.ApplyChange(this.FAppearance.FAMPMFont,t),this.EndUpdate()},this.Create$1=function(e){return pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Create$1.apply(this,arguments),this.SetHeight(180),this.SetWidth(180),this.FFill.SetColor(-1),this.FStroke.SetColor(-1),this.FAM=!0,this.FMouseHourDown=!1,this.FMouseMinuteDown=!1,this.SetFollowMouse(!0),this.FAppearance=t.TTMSFNCAnalogTimeSelectorAppearance.$create("Create$1"),this.FSettings=t.TTMSFNCAnalogTimeSelectorSettings.$create("Create$1"),this.FAppearance.FOnChange=rtl.createCallback(this,"AppearanceChanged"),this.FSettings.FOnChange=rtl.createCallback(this,"SettingsChanged"),this.FWatchTimer=pas["WEBLib.ExtCtrls"].TTimer.$create("Create$1",[this]),this.FWatchTimer.SetEnabled(this.FSettings.FAuto),this.FWatchTimer.SetInterval(100),this.FWatchTimer.FOnTimer=rtl.createCallback(this,"OnWatchTimer"),this.FGlobalFont=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCAppearanceGlobalFont.$create("Create$1",[this]),this},this.Destroy=function(){rtl.free(this,"FGlobalFont"),rtl.free(this,"FAppearance"),rtl.free(this,"FSettings"),rtl.free(this,"FWatchTimer"),pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Destroy.call(this)},this.Assign=function(e){t.TTMSFNCCustomAnalogTimeSelector.isPrototypeOf(e)?(this.FSettings.Assign(rtl.as(e,t.TTMSFNCAnalogTimeSelector).FSettings),this.FAppearance.Assign(rtl.as(e,t.TTMSFNCCustomAnalogTimeSelector).FAppearance),this.FTime=rtl.as(e,t.TTMSFNCCustomAnalogTimeSelector).FTime,this.FAM=rtl.as(e,t.TTMSFNCCustomAnalogTimeSelector).FAM):pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Assign.apply(this,arguments)},this.Initialize=function(){this.FMouseHourDown=!1,this.FMouseMinuteDown=!1},this.XYToHour=function(t,e){var i=0;return(i=Math.round(this.XYToMinute(t,e)/5))<=0?i=this.FAM?0:12:(this.FAM||(i+=12),24===i&&(i=0)),i},this.XYToMinute=function(t,e){var i=0,s=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),o=pas["WEBLib.TMSFNCTypes"].TPointF.$new(),n=0,r=0,a=0;return s.$assign(this.GetWatchRect(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(this.GetControlRect()))),o.$assign(this.GetCenterPoint(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(s))),0===(n=Math.abs(o.Y-e))&&(n=1),0===(r=Math.abs(o.X-t))&&(r=1),a=180*Math.atan(n/r)/Math.PI,a/=6,i=Math.round(a),t>=o.X&&e>=o.Y?i+=15:t<=o.X&&e>=o.Y?(i=15-i,i+=30):t<=o.X&&e<=o.Y?i+=45:t>=o.X&&e<=o.Y&&(i=15-i),(i<0||i>=60)&&(i=0),i},rtl.addIntf(this,pas["WEBLib.TMSFNCGraphicsTypes"].ITMSFNCAppearanceGlobalFont),rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas["WEBLib.TMSFNCTypes"].ITMSFNCProductInfo),rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TTMSFNCAnalogTimeSelector",this.TTMSFNCCustomAnalogTimeSelector,(function(){rtl.addIntf(this,pas["WEBLib.TMSFNCGraphicsTypes"].ITMSFNCAppearanceGlobalFont),rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas["WEBLib.TMSFNCTypes"].ITMSFNCProductInfo),rtl.addIntf(this,pas.System.IUnknown);var e=this.$rtti;e.addProperty("Fill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FFill","SetFill"),e.addProperty("Stroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FStroke","SetStroke"),e.addProperty("Appearance",2,t.$rtti.TTMSFNCAnalogTimeSelectorAppearance,"FAppearance","SetAppearance"),e.addProperty("FollowMouse",2,rtl.boolean,"FFollowMouse","SetFollowMouse",{Default:!0}),e.addProperty("Settings",2,t.$rtti.TTMSFNCAnalogTimeSelectorSettings,"FSettings","SetSettings"),e.addProperty("Time",2,pas.System.$rtti.TTime,"FTime","SetTime"),e.addProperty("Style",2,t.$rtti.TTMSFNCAnalogTimeSelectorStyle,"FStyle","SetStyle",{Default:t.TTMSFNCAnalogTimeSelectorStyle.wsClassic}),e.addProperty("GlobalFont",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCAppearanceGlobalFont,"FGlobalFont","SetGlobalFont"),e.addProperty("OnChanged",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnChanged","FOnChanged"),e.addProperty("OnSecondChanged",0,t.$rtti.TTMSFNCAnalogTimeSelectorSecondChangedEvent,"FOnSecondChanged","FOnSecondChanged"),e.addProperty("OnMinuteChanged",0,t.$rtti.TTMSFNCAnalogTimeSelectorMinuteChangedEvent,"FOnMinuteChanged","FOnMinuteChanged"),e.addProperty("OnHourChanged",0,t.$rtti.TTMSFNCAnalogTimeSelectorHourChangedEvent,"FOnHourChanged","FOnHourChanged"),e.addProperty("OnTimeChanged",0,t.$rtti.TTMSFNCAnalogTimeSelectorTimeChangedEvent,"FOnTimeChanged","FOnTimeChanged"),e.addProperty("OnBeforeDrawBackground",0,t.$rtti.TTMSFNCAnalogTimeSelectorBeforeDrawWatchBackgroundEvent,"FOnBeforeDrawBackground","FOnBeforeDrawBackground"),e.addProperty("OnAfterDrawBackground",0,t.$rtti.TTMSFNCAnalogTimeSelectorAfterDrawWatchBackgroundEvent,"FOnAfterDrawBackground","FOnAfterDrawBackground"),e.addProperty("OnBeforeDrawTickMark",0,t.$rtti.TTMSFNCAnalogTimeSelectorBeforeDrawTickMarkEvent,"FOnBeforeDrawTickMark","FOnBeforeDrawTickMark"),e.addProperty("OnAfterDrawTickMark",0,t.$rtti.TTMSFNCAnalogTimeSelectorAfterDrawTickMarkEvent,"FOnAfterDrawTickMark","FOnAfterDrawTickMark"),e.addProperty("OnBeforeDrawNumber",0,t.$rtti.TTMSFNCAnalogTimeSelectorBeforeDrawNumberEvent,"FOnBeforeDrawNumber","FOnBeforeDrawNumber"),e.addProperty("OnAfterDrawNumber",0,t.$rtti.TTMSFNCAnalogTimeSelectorAfterDrawNumberEvent,"FOnAfterDrawNumber","FOnAfterDrawNumber"),e.addProperty("OnBeforeDrawAMPM",0,t.$rtti.TTMSFNCAnalogTimeSelectorBeforeDrawAMPMEvent,"FOnBeforeDrawAMPM","FOnBeforeDrawAMPM"),e.addProperty("OnAfterDrawAMPM",0,t.$rtti.TTMSFNCAnalogTimeSelectorAfterDrawAMPMEvent,"FOnAfterDrawAMPM","FOnAfterDrawAMPM"),e.addProperty("OnBeforeDrawHourPointer",0,t.$rtti.TTMSFNCAnalogTimeSelectorBeforeDrawHourPointerEvent,"FOnBeforeDrawHourPointer","FOnBeforeDrawHourPointer"),e.addProperty("OnAfterDrawHourPointer",0,t.$rtti.TTMSFNCAnalogTimeSelectorAfterDrawHourPointerEvent,"FOnAfterDrawHourPointer","FOnAfterDrawHourPointer"),e.addProperty("OnBeforeDrawMinutePointer",0,t.$rtti.TTMSFNCAnalogTimeSelectorBeforeDrawMinutePointerEvent,"FOnBeforeDrawMinutePointer","FOnBeforeDrawMinutePointer"),e.addProperty("OnAfterDrawMinutePointer",0,t.$rtti.TTMSFNCAnalogTimeSelectorAfterDrawMinutePointerEvent,"FOnAfterDrawMinutePointer","FOnAfterDrawMinutePointer"),e.addProperty("OnBeforeDrawSecondPointer",0,t.$rtti.TTMSFNCAnalogTimeSelectorBeforeDrawSecondPointerEvent,"FOnBeforeDrawSecondPointer","FOnBeforeDrawSecondPointer"),e.addProperty("OnAfterDrawSecondPointer",0,t.$rtti.TTMSFNCAnalogTimeSelectorAfterDrawSecondPonterEvent,"FOnAfterDrawSecondPointer","FOnAfterDrawSecondPointer"),e.addProperty("OnBeforeDrawCenterPoint",0,t.$rtti.TTMSFNCAnalogTimeSelectorBeforeDrawCenterPointEvent,"FOnBeforeDrawCenterPoint","FOnBeforeDrawCenterPoint"),e.addProperty("OnAfterDrawCenterPoint",0,t.$rtti.TTMSFNCAnalogTimeSelectorAfterDrawCenterPointEvent,"FOnAfterDrawCenterPoint","FOnAfterDrawCenterPoint"),e.attr=[pas.Classes.ComponentPlatformsAttribute,"Create$1",[0]]}))}),["Math","DateUtils","SysUtils"]),rtl.module("WEBLib.TMSFNCAnalogTimePicker",["System","Classes","WEBLib.TMSFNCCustomPicker","WEBLib.TMSFNCCustomSelector","WEBLib.TMSFNCGraphics","WEBLib.Controls","WEBLib.TMSFNCAnalogTimeSelector","WEBLib.TMSFNCTypes","WEBLib.StdCtrls","SysUtils","WEBLib.TMSFNCUtils","WEBLib.TMSFNCGraphicsTypes","Types"],(function(){"use strict";var t=this;this.MAJ_VER=1,this.MIN_VER=0,this.REL_VER=2,this.BLD_VER=0,this.TTMSFNCTimePickerMode={0:"tpmAnalog",tpmAnalog:0,1:"tpmDigital",tpmDigital:1},this.$rtti.$Enum("TTMSFNCTimePickerMode",{minvalue:0,maxvalue:1,ordtype:1,enumtype:this.TTMSFNCTimePickerMode}),this.$rtti.$MethodVar("TTMSFNCCustomAnalogTimePickerTimeSelectedEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ATime",pas.System.$rtti.TTime]]),methodkind:0}),rtl.createClass(this,"TTMSFNCCustomAnalogTimePicker",pas["WEBLib.TMSFNCCustomPicker"].TTMSFNCDefaultPicker,(function(){this.$init=function(){pas["WEBLib.TMSFNCCustomPicker"].TTMSFNCDefaultPicker.$init.call(this),this.FPrevSelTime=0,this.FWrapper=null,this.FTimeSelector=null,this.FCloseOnSelection=!1,this.FOnTimeSelected=null,this.FMode=0,this.FTimeFormat="",this.FAllowNumericNullValue=!1,this.FFont$2=null},this.$final=function(){this.FWrapper=void 0,this.FTimeSelector=void 0,this.FOnTimeSelected=void 0,this.FFont$2=void 0,pas["WEBLib.TMSFNCCustomPicker"].TTMSFNCDefaultPicker.$final.call(this)},this.SetSelectedTime=function(t){this.FAllowNumericNullValue&&0===pas.System.Frac(t)?this.SetContent(""):this.SetContent(pas.SysUtils.FormatDateTime(this.FTimeFormat,t)),this.FPrevSelTime=t,this.Invalidate()},this.SetAnalogTimeSelectorAppearance=function(t){this.FTimeSelector.FAppearance.Assign(t)},this.SetMode=function(t){this.FMode!==t&&(this.FMode=t)},this.SetTimeFormat=function(t){this.FTimeFormat!==t&&(this.FTimeFormat=t,this.SetContent(pas.SysUtils.FormatDateTime(this.FTimeFormat,this.GetSelectedTime())),this.Invalidate())},this.SetAllowNumericNullValue=function(t){this.FAllowNumericNullValue!==t&&(this.FAllowNumericNullValue=t,this.FAllowNumericNullValue&&0===pas.System.Frac(this.GetSelectedTime())?this.SetContent(""):this.SetContent(pas.SysUtils.FormatDateTime(this.FTimeFormat,this.GetSelectedTime())),this.Invalidate())},this.GetSelectedTime=function(){return this.FTimeSelector.FTime},this.GetAnalogTimeSelectorAppearance=function(){return this.FTimeSelector.FAppearance},this.IsTimeFormatStored=function(){return"hh:nn:ss"!==this.FTimeFormat},this.SetFnt$1=function(t){this.FFont$2.AssignSource(t)},this.FontChange=function(t){this.Invalidate()},this.SetEditable=function(t){pas["WEBLib.TMSFNCCustomPicker"].TTMSFNCCustomPicker.SetEditable.apply(this,arguments),this.FAllowNumericNullValue&&0===pas.System.Frac(this.FPrevSelTime)?this.SetContent(""):this.SetContent(pas.SysUtils.FormatDateTime(this.FTimeFormat,this.FPrevSelTime)),this.Invalidate()},this.UpdateEditText=function(t){var e=0;pas["WEBLib.TMSFNCCustomPicker"].TTMSFNCCustomPicker.UpdateEditText.apply(this,arguments),""===t?0!==this.FPrevSelTime&&(this.FTimeSelector.SetTime(0),this.DoSelectTime()):pas.SysUtils.TryStrToTime(t,{get:function(){return e},set:function(t){e=t}})&&pas.System.Frac(e)!==this.GetSelectedTime()&&(this.FTimeSelector.SetTime(pas.System.Frac(e)),this.DoSelectTime())},this.Loaded=function(){pas["WEBLib.Controls"].TCustomControl.Loaded.call(this),this.FTimeSelector.SetWidth(Math.round(this.FDropDownWidth)),this.FTimeSelector.SetHeight(Math.round(this.FDropDownHeight))},this.SetGraphicColors=function(){pas["WEBLib.TMSFNCCustomPicker"].TTMSFNCCustomPicker.SetGraphicColors.call(this),pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.DefaultPopupFillColor=this.GetAnalogTimeSelectorAppearance().FFill.FColor,pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.DefaultPopupStrokeColor=this.GetAnalogTimeSelectorAppearance().FStroke.FColor,pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.DefaultButtonFillColor=this.GetAnalogTimeSelectorAppearance().FFill.FColor,pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.DefaultButtonStrokeColor=this.GetAnalogTimeSelectorAppearance().FStroke.FColor,pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.DefaultButtonFillColorFocused=pas["WEBLib.TMSFNCGraphicsTypes"].Lighter(this.GetAnalogTimeSelectorAppearance().FFill.FColor,20),pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.DefaultButtonStrokeColorFocused=pas["WEBLib.TMSFNCGraphicsTypes"].Lighter(this.GetAnalogTimeSelectorAppearance().FStroke.FColor,20),pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.DefaultButtonStrokeColorDisabled=11119017,pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.DefaultButtonFillColorDisabled=13882323,pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.DefaultTextFontColor=this.FFont$2.FColor},this.SetAdaptToStyle=function(t){pas["WEBLib.TMSFNCCustomPicker"].TTMSFNCCustomPicker.SetAdaptToStyle.apply(this,arguments),null!=this.FWrapper&&this.FWrapper.SetAdaptToStyle(this.GetAdaptToStyle()),null!=this.FTimeSelector&&this.FTimeSelector.SetAdaptToStyle(this.GetAdaptToStyle())},this.InitializePopup=function(){var t=0;pas["WEBLib.TMSFNCCustomPicker"].TTMSFNCCustomPicker.InitializePopup.call(this),this.FEditable&&null!=this.FEdit.FParent&&this.FEdit.FVisible&&(t=this.GetSelectedTime(),pas.SysUtils.TryStrToTime(this.FEdit.GetText(),{get:function(){return t},set:function(e){t=e}})&&this.SetSelectedTime(t)),this.FTimeSelector.Initialize(),this.FTimeSelector.SetWidth(Math.round(this.FDropDownWidth)),this.FTimeSelector.SetHeight(Math.round(this.FDropDownHeight)),this.FTimeSelector.FFill.Assign(this.GetAnalogTimeSelectorAppearance().FFill)},this.DrawContent=function(t,e){var i=pas["WEBLib.TMSFNCTypes"].TRectF.$new();pas["WEBLib.TMSFNCCustomPicker"].TTMSFNCCustomPicker.DrawContent.apply(this,arguments),this.FEditable||(t.FFont.AssignSource(this.FFont$2),this.FEnabled||t.FFont.SetColor(12632256),i.$assign(e),pas["WEBLib.TMSFNCTypes"].InflateRectEx(i,-3,-3),t.DrawText$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),this.GetContent(),!1,1,0,0,0,-1,-1,!0,!1,-1,-1))},this.SelectFirstValue=function(){var t=0,e=0,i=0,s=0;pas["WEBLib.TMSFNCCustomPicker"].TTMSFNCCustomPicker.SelectFirstValue.call(this),pas.SysUtils.DecodeTime(this.GetSelectedTime(),{get:function(){return t},set:function(e){t=e}},{get:function(){return e},set:function(t){e=t}},{get:function(){return i},set:function(t){i=t}},{get:function(){return s},set:function(t){s=t}}),this.FTimeSelector.SetTime(pas.SysUtils.EncodeTime(t,0,0,0)),this.DoSelectTime()},this.SelectLastValue=function(){var t=0,e=0,i=0,s=0;pas["WEBLib.TMSFNCCustomPicker"].TTMSFNCCustomPicker.SelectLastValue.call(this),pas.SysUtils.DecodeTime(this.GetSelectedTime(),{get:function(){return t},set:function(e){t=e}},{get:function(){return e},set:function(t){e=t}},{get:function(){return i},set:function(t){i=t}},{get:function(){return s},set:function(t){s=t}}),this.FTimeSelector.SetTime(pas.SysUtils.EncodeTime(t,59,0,0)),this.DoSelectTime()},this.SelectNextValue=function(){pas["WEBLib.TMSFNCCustomPicker"].TTMSFNCCustomPicker.SelectNextValue.call(this),this.FTimeSelector.SetTime(pas.DateUtils.IncMinute(this.GetSelectedTime(),1)),this.DoSelectTime()},this.SelectPreviousValue=function(){pas["WEBLib.TMSFNCCustomPicker"].TTMSFNCCustomPicker.SelectPreviousValue.call(this),this.FTimeSelector.SetTime(pas.DateUtils.IncMinute(this.GetSelectedTime(),-1)),this.DoSelectTime()},this.EditUp=function(){pas["WEBLib.TMSFNCCustomPicker"].TTMSFNCCustomPicker.EditUp.call(this),this.GetPopup().FIsOpen&&this.DropDown()},this.EditDown=function(){pas["WEBLib.TMSFNCCustomPicker"].TTMSFNCCustomPicker.EditDown.call(this),this.GetPopup().FIsOpen||this.DropDown()},this.DoSelectTime=function(){null!=this.FOnTimeSelected&&this.FOnTimeSelected(this,this.GetSelectedTime()),this.Invalidate()},this.TimeSelected=function(t,e){this.FEditable&&this.FEdit.IsFocused()&&(this.FPreventDropDown=!0),this.FCloseOnSelection&&this.DropDown(),null!=this.FOnTimeSelected&&this.FOnTimeSelected(this,e),this.SetSelectedTime(e),this.Invalidate()},this.GetVersion=function(){return this.$class.GetVersionNumber(1,0,2,0)},this.CreateSelector=function(){return this.FWrapper=pas["WEBLib.TMSFNCCustomSelector"].TTMSFNCCustomSelector.$create("Create$1",[this]),this.FTimeSelector=pas["WEBLib.TMSFNCAnalogTimeSelector"].TTMSFNCAnalogTimeSelector.$create("Create$1",[this.FWrapper]),this.FTimeSelector.SetParent(this.FWrapper),this.FTimeSelector.FOnTimeChanged=rtl.createCallback(this,"TimeSelected"),this.FWrapper},this.GetFocusedControl=function(){return this.FTimeSelector},this.Create$1=function(t){return pas["WEBLib.TMSFNCCustomPicker"].TTMSFNCCustomPicker.Create$1.apply(this,arguments),this.FTimeFormat="hh:nn:ss",this.FCloseOnSelection=!1,this.FAllowNumericNullValue=!0,this.SetWidth(90),this.FFont$2=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFont.$create("Create$2"),this.FFont$2.FOnChanged=rtl.createCallback(this,"FontChange"),this.SetDropDownHeight(180),this.SetDropDownWidth(180),this},this.Destroy=function(){rtl.free(this,"FFont$2"),pas["WEBLib.TMSFNCCustomPicker"].TTMSFNCCustomPicker.Destroy.call(this)},rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas["WEBLib.TMSFNCTypes"].ITMSFNCProductInfo),rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TTMSFNCAnalogTimePicker",this.TTMSFNCCustomAnalogTimePicker,(function(){this.RegisterRuntimeClasses=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.RegisterRuntimeClasses.call(this),pas.Classes.RegisterClass(t.TTMSFNCAnalogTimePicker)},rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas["WEBLib.TMSFNCTypes"].ITMSFNCProductInfo),rtl.addIntf(this,pas.System.IUnknown);var e=this.$rtti;e.addProperty("AllowNumericNullValue",2,rtl.boolean,"FAllowNumericNullValue","SetAllowNumericNullValue",{Default:!0}),e.addProperty("Editable",2,rtl.boolean,"FEditable","SetEditable",{Default:!1}),e.addProperty("DropDownWidth",14,rtl.double,"FDropDownWidth","SetDropDownWidth",{stored:"IsDropDownWidthStored"}),e.addProperty("DropDownHeight",14,rtl.double,"FDropDownHeight","SetDropDownHeight",{stored:"IsDropDownHeightStored"}),e.addProperty("Font",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFont,"FFont$2","SetFnt$1"),e.addProperty("CloseOnSelection",0,rtl.boolean,"FCloseOnSelection","FCloseOnSelection",{Default:!1}),e.addProperty("SelectorAppearance",3,pas["WEBLib.TMSFNCAnalogTimeSelector"].$rtti.TTMSFNCAnalogTimeSelectorAppearance,"GetAnalogTimeSelectorAppearance","SetAnalogTimeSelectorAppearance"),e.addProperty("SelectedTime",3,pas.System.$rtti.TTime,"GetSelectedTime","SetSelectedTime"),e.addProperty("TimeFormat",14,rtl.string,"FTimeFormat","SetTimeFormat",{stored:"IsTimeFormatStored"}),e.addProperty("Mode",2,t.$rtti.TTMSFNCTimePickerMode,"FMode","SetMode",{Default:t.TTMSFNCTimePickerMode.tpmAnalog}),e.addProperty("OnTimeSelected",0,t.$rtti.TTMSFNCCustomAnalogTimePickerTimeSelectedEvent,"FOnTimeSelected","FOnTimeSelected"),e.attr=[pas.Classes.ComponentPlatformsAttribute,"Create$1",[0]]}))}),["DateUtils"]),rtl.module("WEBLib.TMSFNCCalendar",["System","Classes","Types","TypInfo","WEBLib.Controls","WEBLib.Graphics","WEBLib.TMSFNCCustomControl","WEBLib.TMSFNCGraphics","WEBLib.TMSFNCGraphicsTypes","WEBLib.TMSFNCTypes","WEBLib.TMSFNCUtils","WEBLib.TMSFNCBitmapContainer","SysUtils","WEBLib.TMSFNCStyles"],(function(){"use strict";var t=this,e=t.$impl;this.MAJ_VER=1,this.MIN_VER=0,this.REL_VER=3,this.BLD_VER=1,this.TTMSFNCCalendarArrowLayoutValue={0:"alvLeft",alvLeft:0,1:"alvRight",alvRight:1},this.$rtti.$Enum("TTMSFNCCalendarArrowLayoutValue",{minvalue:0,maxvalue:1,ordtype:1,enumtype:this.TTMSFNCCalendarArrowLayoutValue}),this.$rtti.$Set("TTMSFNCCalendarArrowLayout",{comptype:this.$rtti.TTMSFNCCalendarArrowLayoutValue}),this.TTMSFNCCalendarArrowType={0:"atTriangle",atTriangle:0,1:"atArrow",atArrow:1,2:"atBitmap",atBitmap:2,3:"atCustom",atCustom:3},this.$rtti.$Enum("TTMSFNCCalendarArrowType",{minvalue:0,maxvalue:3,ordtype:1,enumtype:this.TTMSFNCCalendarArrowType}),rtl.createClass(this,"TTMSFNCCalendarArrow",pas["WEBLib.TMSFNCTypes"].TTMSFNCPersistent,(function(){this.$init=function(){pas["WEBLib.TMSFNCTypes"].TTMSFNCPersistent.$init.call(this),this.FOwner=null,this.FColor=0,this.FVisibility={},this.FSize=0,this.FOnChange=null,this.FArrowLeftType=0,this.FArrowLeftBitmap=null,this.FArrowRightBitmap=null,this.FArrowRightBitmapSize=0,this.FArrowRightType=0,this.FArrowLeftBitmapSize=0},this.$final=function(){this.FOwner=void 0,this.FVisibility=void 0,this.FOnChange=void 0,this.FArrowLeftBitmap=void 0,this.FArrowRightBitmap=void 0,pas["WEBLib.TMSFNCTypes"].TTMSFNCPersistent.$final.call(this)},this.SetColor=function(t){this.FColor!==t&&(this.FColor=t,this.Changed())},this.SetVisibility=function(t){rtl.neSet(this.FVisibility,t)&&(this.FVisibility=rtl.refSet(t),this.Changed())},this.SetArrowLeftBitmap=function(t){this.FArrowLeftBitmap.Assign(t)},this.SetArrowRightBitmap=function(t){this.FArrowRightBitmap.Assign(t)},this.SetArrowLeftBitmapSize=function(t){this.FArrowLeftBitmapSize!==t&&(this.FArrowLeftBitmapSize=t,this.Changed())},this.SetArrowLeftType=function(t){this.FArrowLeftType!==t&&(this.FArrowLeftType=t,this.Changed())},this.SetArrowRightBitmapSize=function(t){this.FArrowRightBitmapSize!==t&&(this.FArrowRightBitmapSize=t,this.Changed())},this.SetArrowRightType=function(t){this.FArrowRightType!==t&&(this.FArrowRightType=t,this.Changed())},this.IsArrowLeftBitmapSizeStored=function(){return 15!==this.FArrowLeftBitmapSize},this.IsArrowRightBitmapSizeStore=function(){return 15!==this.FArrowRightBitmapSize},this.Changed=function(){null!=this.FOnChange&&this.FOnChange(this)},this.GetOwner=function(){return this.FOwner},this.Create$1=function(t){return this.FOwner=t,this.FArrowLeftBitmap=pas["WEBLib.TMSFNCTypes"].TTMSFNCScaledBitmaps.$create("Create$3",[this]),this.FArrowRightBitmap=pas["WEBLib.TMSFNCTypes"].TTMSFNCScaledBitmaps.$create("Create$3",[this]),this.FColor=6908265,this.FVisibility=rtl.createSet(0,1),this.FArrowLeftType=1,this.FArrowRightType=1,this.FArrowLeftBitmapSize=15,this.FArrowRightBitmapSize=15,this.FSize=15,this},this.Destroy=function(){rtl.free(this,"FArrowLeftBitmap"),rtl.free(this,"FArrowRightBitmap"),pas.System.TObject.Destroy.call(this)},this.Assign=function(e){t.TTMSFNCCalendarArrow.isPrototypeOf(e)?(this.FColor=rtl.as(e,t.TTMSFNCCalendarArrow).FColor,this.FVisibility=rtl.refSet(rtl.as(e,t.TTMSFNCCalendarArrow).FVisibility),this.FSize=rtl.as(e,t.TTMSFNCCalendarArrow).FSize,this.FArrowLeftType=rtl.as(e,t.TTMSFNCCalendarArrow).FArrowLeftType,this.FArrowLeftBitmapSize=rtl.as(e,t.TTMSFNCCalendarArrow).FArrowLeftBitmapSize,this.FArrowLeftBitmap.Assign(rtl.as(e,t.TTMSFNCCalendarArrow).FArrowLeftBitmap),this.FArrowRightType=rtl.as(e,t.TTMSFNCCalendarArrow).FArrowRightType,this.FArrowRightBitmapSize=rtl.as(e,t.TTMSFNCCalendarArrow).FArrowRightBitmapSize,this.FArrowRightBitmap.Assign(rtl.as(e,t.TTMSFNCCalendarArrow).FArrowRightBitmap)):pas.Classes.TPersistent.Assign.apply(this,arguments)};var e=this.$rtti;e.addProperty("ArrowLeftBitmap",2,pas["WEBLib.TMSFNCTypes"].$rtti.TTMSFNCScaledBitmaps,"FArrowLeftBitmap","SetArrowLeftBitmap"),e.addProperty("ArrowLeftType",2,t.$rtti.TTMSFNCCalendarArrowType,"FArrowLeftType","SetArrowLeftType",{Default:t.TTMSFNCCalendarArrowType.atArrow}),e.addProperty("ArrowLeftBitmapSize",14,rtl.double,"FArrowLeftBitmapSize","SetArrowLeftBitmapSize",{stored:"IsArrowLeftBitmapSizeStored"}),e.addProperty("ArrowRightBitmap",2,pas["WEBLib.TMSFNCTypes"].$rtti.TTMSFNCScaledBitmaps,"FArrowRightBitmap","SetArrowRightBitmap"),e.addProperty("ArrowRightType",2,t.$rtti.TTMSFNCCalendarArrowType,"FArrowRightType","SetArrowRightType",{Default:t.TTMSFNCCalendarArrowType.atArrow}),e.addProperty("ArrowRightBitmapSize",14,rtl.double,"FArrowRightBitmapSize","SetArrowRightBitmapSize",{stored:"IsArrowRightBitmapSizeStore"}),e.addProperty("Color",2,pas["WEBLib.Graphics"].$rtti.TColor,"FColor","SetColor",{Default:6908265}),e.addProperty("Visibility",2,t.$rtti.TTMSFNCCalendarArrowLayout,"FVisibility","SetVisibility",{Default:rtl.createSet(0,1)})})),rtl.createClass(this,"TTMSFNCCalendarHeader",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FFill=null,this.FFont=null,this.FStroke=null,this.FVerticalTextAlign=0,this.FHorizontalTextAlign=0,this.FArrow=null,this.FVisible=!1,this.FOnChange=null,this.FHeight=0},this.$final=function(){this.FFill=void 0,this.FFont=void 0,this.FStroke=void 0,this.FArrow=void 0,this.FOnChange=void 0,pas.Classes.TPersistent.$final.call(this)},this.SetFill=function(t){this.FFill!==t&&this.FFill.Assign(t)},this.SetFont=function(t){this.FFont.AssignSource(t)},this.SetHorizontalTextAlign=function(t){this.FHorizontalTextAlign!==t&&(this.FHorizontalTextAlign=t,this.Changed())},this.SetVerticalTextAlign=function(t){this.FVerticalTextAlign!==t&&(this.FVerticalTextAlign=t,this.Changed())},this.SetStroke=function(t){this.FStroke!==t&&this.FStroke.Assign(t)},this.SetArrow=function(t){this.FArrow!==t&&this.FArrow.Assign(t)},this.SetVisible=function(t){this.FVisible!==t&&(this.FVisible=t,this.Changed())},this.SetHeight=function(t){this.FHeight!==t&&(this.FHeight=t,this.Changed())},this.Changed=function(){null!=this.FOnChange&&this.FOnChange(this)},this.FillChanged=function(t){this.Changed()},this.FontChanged=function(t){this.Changed()},this.StrokeChanged=function(t){this.Changed()},this.Create$1=function(e){return this.FFont=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFont.$create("Create$2"),this.FHorizontalTextAlign=0,this.FVerticalTextAlign=0,this.FStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,12632256]),this.FFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[1,pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(228,228,228),8421504,-1,-1]),this.FArrow=t.TTMSFNCCalendarArrow.$create("Create$1",[e]),this.FVisible=!0,this.FHeight=25,this.FFill.FOnChanged=rtl.createCallback(this,"FillChanged"),this.FFont.FOnChanged=rtl.createCallback(this,"FontChanged"),this.FStroke.FOnChanged=rtl.createCallback(this,"StrokeChanged"),this},this.Destroy=function(){rtl.free(this,"FFont"),rtl.free(this,"FFill"),rtl.free(this,"FStroke"),rtl.free(this,"FArrow"),pas.System.TObject.Destroy.call(this)},this.Assign=function(e){t.TTMSFNCCalendarHeader.isPrototypeOf(e)?(this.FFont.AssignSource(rtl.as(e,t.TTMSFNCCalendarHeader).FFont),this.FHorizontalTextAlign=rtl.as(e,t.TTMSFNCCalendarHeader).FHorizontalTextAlign,this.FVerticalTextAlign=rtl.as(e,t.TTMSFNCCalendarHeader).FVerticalTextAlign,this.FStroke.Assign(rtl.as(e,t.TTMSFNCCalendarHeader).FStroke),this.FFill.Assign(rtl.as(e,t.TTMSFNCCalendarHeader).FFill),this.FArrow.Assign(rtl.as(e,t.TTMSFNCCalendarHeader).FArrow),this.FVisible=rtl.as(e,t.TTMSFNCCalendarHeader).FVisible,this.FHeight=rtl.as(e,t.TTMSFNCCalendarHeader).FHeight):pas.Classes.TPersistent.Assign.apply(this,arguments)};var e=this.$rtti;e.addProperty("Arrow",2,t.$rtti.TTMSFNCCalendarArrow,"FArrow","SetArrow"),e.addProperty("Height",2,rtl.longint,"FHeight","SetHeight",{Default:25}),e.addProperty("Fill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FFill","SetFill"),e.addProperty("Font",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFont,"FFont","SetFont"),e.addProperty("Stroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FStroke","SetStroke"),e.addProperty("Visible",2,rtl.boolean,"FVisible","SetVisible",{Default:!0}),e.addProperty("VerticalTextAlign",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsTextAlign,"FVerticalTextAlign","SetVerticalTextAlign",{Default:pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsTextAlign.gtaCenter}),e.addProperty("HorizontalTextAlign",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsTextAlign,"FHorizontalTextAlign","SetHorizontalTextAlign",{Default:pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsTextAlign.gtaCenter})})),this.TTMSFNCCalendarFooterDate={0:"fdNone",fdNone:0,1:"fdSelected",fdSelected:1,2:"fdToday",fdToday:2},this.$rtti.$Enum("TTMSFNCCalendarFooterDate",{minvalue:0,maxvalue:2,ordtype:1,enumtype:this.TTMSFNCCalendarFooterDate}),rtl.createClass(this,"TTMSFNCCalendarFooter",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FFill=null,this.FFont=null,this.FStroke=null,this.FVerticalTextAlign=0,this.FHorizontalTextAlign=0,this.FCaption="",this.FVisible=!1,this.FDateCaption=0,this.FOnChange=null,this.FHeight=0,this.FCaptionRect=pas["WEBLib.TMSFNCTypes"].TRectF.$new()},this.$final=function(){this.FFill=void 0,this.FFont=void 0,this.FStroke=void 0,this.FOnChange=void 0,this.FCaptionRect=void 0,pas.Classes.TPersistent.$final.call(this)},this.SetFill=function(t){this.FFill!==t&&this.FFill.Assign(t)},this.SetFont=function(t){this.FFont.AssignSource(t)},this.SetHorizontalTextAlign=function(t){this.FHorizontalTextAlign!==t&&(this.FHorizontalTextAlign=t,this.Changed())},this.SetVerticalTextAlign=function(t){this.FVerticalTextAlign!==t&&(this.FVerticalTextAlign=t,this.Changed())},this.SetStroke=function(t){this.FStroke!==t&&this.FStroke.Assign(t)},this.SetCaption=function(t){this.FCaption!==t&&(this.FCaption=t,this.Changed())},this.SetVisible=function(t){this.FVisible!==t&&(this.FVisible=t,this.Changed())},this.SetHeight=function(t){this.FHeight!==t&&(this.FHeight=t,this.Changed())},this.SetDateCaption=function(t){this.FDateCaption!==t&&(this.FDateCaption=t,this.Changed())},this.SetCaptionRect=function(t){this.FCaptionRect.$assign(t)},this.IsCaptionStored=function(){return""!==this.FCaption},this.Changed=function(){null!=this.FOnChange&&this.FOnChange(this)},this.FillChanged=function(t){this.Changed()},this.FontChanged=function(t){this.Changed()},this.StrokeChanged=function(t){this.Changed()},this.Create$1=function(){return this.FFont=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFont.$create("Create$2"),this.FHorizontalTextAlign=0,this.FVerticalTextAlign=0,this.FStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,12632256]),this.FFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[1,pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(228,228,228),8421504,-1,-1]),this.FVisible=!0,this.FHeight=25,this.FDateCaption=2,this.FFill.FOnChanged=rtl.createCallback(this,"FillChanged"),this.FFont.FOnChanged=rtl.createCallback(this,"FontChanged"),this.FStroke.FOnChanged=rtl.createCallback(this,"StrokeChanged"),this},this.Destroy=function(){rtl.free(this,"FFont"),rtl.free(this,"FStroke"),rtl.free(this,"FFill"),pas.System.TObject.Destroy.call(this)},this.Assign=function(e){t.TTMSFNCCalendarFooter.isPrototypeOf(e)?(this.FFill.Assign(rtl.as(e,t.TTMSFNCCalendarFooter).FFill),this.FStroke.Assign(rtl.as(e,t.TTMSFNCCalendarFooter).FStroke),this.FFont.AssignSource(rtl.as(e,t.TTMSFNCCalendarFooter).FFont),this.FVerticalTextAlign=rtl.as(e,t.TTMSFNCCalendarFooter).FVerticalTextAlign,this.FHorizontalTextAlign=rtl.as(e,t.TTMSFNCCalendarFooter).FHorizontalTextAlign,this.FVisible=rtl.as(e,t.TTMSFNCCalendarFooter).FVisible,this.FDateCaption=rtl.as(e,t.TTMSFNCCalendarFooter).FDateCaption,this.FCaptionRect.$assign(rtl.as(e,t.TTMSFNCCalendarFooter).FCaptionRect),this.FCaption=rtl.as(e,t.TTMSFNCCalendarFooter).FCaption,this.FHeight=rtl.as(e,t.TTMSFNCCalendarFooter).FHeight):pas.Classes.TPersistent.Assign.apply(this,arguments)};var e=this.$rtti;e.addProperty("Caption",14,rtl.string,"FCaption","SetCaption",{stored:"IsCaptionStored"}),e.addProperty("DateCaption",2,t.$rtti.TTMSFNCCalendarFooterDate,"FDateCaption","SetDateCaption",{Default:t.TTMSFNCCalendarFooterDate.fdToday}),e.addProperty("Height",2,rtl.longint,"FHeight","SetHeight",{Default:25}),e.addProperty("Fill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FFill","SetFill"),e.addProperty("Font",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFont,"FFont","SetFont"),e.addProperty("Stroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FStroke","SetStroke"),e.addProperty("Visible",2,rtl.boolean,"FVisible","SetVisible",{Default:!0}),e.addProperty("VerticalTextAlign",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsTextAlign,"FVerticalTextAlign","SetVerticalTextAlign",{Default:pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsTextAlign.gtaCenter}),e.addProperty("HorizontalTextAlign",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsTextAlign,"FHorizontalTextAlign","SetHorizontalTextAlign",{Default:pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsTextAlign.gtaCenter})})),rtl.createClass(this,"TTMSFNCCalendarDayNameAppearance",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FFill=null,this.FFont=null,this.FStroke=null,this.FVerticalTextAlign=0,this.FHorizontalTextAlign=0,this.FOnChange=null,this.FHeight=0},this.$final=function(){this.FFill=void 0,this.FFont=void 0,this.FStroke=void 0,this.FOnChange=void 0,pas.Classes.TPersistent.$final.call(this)},this.SetFill=function(t){this.FFill!==t&&this.FFill.Assign(t)},this.SetFont=function(t){this.FFont.AssignSource(t)},this.SetHorizontalTextAlign=function(t){this.FHorizontalTextAlign!==t&&(this.FHorizontalTextAlign=t)},this.SetStroke=function(t){this.FStroke!==t&&this.FStroke.Assign(t)},this.SetVerticalTextAlign=function(t){this.FVerticalTextAlign!==t&&(this.FVerticalTextAlign=t)},this.SetHeight=function(t){this.FHeight!==t&&(this.FHeight=t)},this.Create$1=function(){return this.FHeight=15,this.FFont=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFont.$create("Create$2"),this.FFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[1,-1,8421504,-1,-1]),this.FStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,-1]),this.FHorizontalTextAlign=0,this.FVerticalTextAlign=0,this},this.Destroy=function(){rtl.free(this,"FFill"),rtl.free(this,"FStroke"),rtl.free(this,"FFont"),pas.System.TObject.Destroy.call(this)},this.Assign=function(e){t.TTMSFNCCalendarDayNameAppearance.isPrototypeOf(e)?(this.FHeight=rtl.as(e,t.TTMSFNCCalendarDayNameAppearance).FHeight,this.FFill.Assign(rtl.as(e,t.TTMSFNCCalendarDayNameAppearance).FFill),this.FStroke.Assign(rtl.as(e,t.TTMSFNCCalendarDayNameAppearance).FStroke),this.FFont.AssignSource(rtl.as(e,t.TTMSFNCCalendarDayNameAppearance).FFont),this.FVerticalTextAlign=rtl.as(e,t.TTMSFNCCalendarDayNameAppearance).FVerticalTextAlign,this.FHorizontalTextAlign=rtl.as(e,t.TTMSFNCCalendarDayNameAppearance).FHorizontalTextAlign):pas.Classes.TPersistent.Assign.apply(this,arguments)};var e=this.$rtti;e.addProperty("Height",2,rtl.longint,"FHeight","SetHeight",{Default:15}),e.addProperty("Fill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FFill","SetFill"),e.addProperty("Font",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFont,"FFont","SetFont"),e.addProperty("Stroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FStroke","SetStroke"),e.addProperty("VerticalTextAlign",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsTextAlign,"FVerticalTextAlign","SetVerticalTextAlign",{Default:pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsTextAlign.gtaCenter}),e.addProperty("HorizontalTextAlign",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsTextAlign,"FHorizontalTextAlign","SetHorizontalTextAlign",{Default:pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsTextAlign.gtaCenter})})),rtl.createClass(this,"TTMSFNCCalendarDateAppearance",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FFill=null,this.FFont=null,this.FStroke=null,this.FVerticalTextAlign=0,this.FHorizontalTextAlign=0,this.FSelectedFill=null,this.FSelectedFont=null,this.FSelectedStroke=null,this.FSelectedVerticalTextAlign=0,this.FSelectedHorizontalTextAlign=0,this.FDisabledFill=null,this.FDisabledFont=null,this.FDisabledStroke=null,this.FDateBeforeFill=null,this.FDateBeforeFont=null,this.FDateBeforeStroke=null,this.FDateAfterFont=null,this.FDateAfterFill=null,this.FDateAfterStroke=null,this.FShowDaysBefore=!1,this.FShowDaysAfter=!1,this.FOnChange=null,this.FTodayFill=null,this.FBadgeFont=null,this.FTodayStroke=null,this.FBadgeFill=null,this.FBadgeStroke=null,this.FTodayFont=null,this.FShowFocus=!1},this.$final=function(){this.FFill=void 0,this.FFont=void 0,this.FStroke=void 0,this.FSelectedFill=void 0,this.FSelectedFont=void 0,this.FSelectedStroke=void 0,this.FDisabledFill=void 0,this.FDisabledFont=void 0,this.FDisabledStroke=void 0,this.FDateBeforeFill=void 0,this.FDateBeforeFont=void 0,this.FDateBeforeStroke=void 0,this.FDateAfterFont=void 0,this.FDateAfterFill=void 0,this.FDateAfterStroke=void 0,this.FOnChange=void 0,this.FTodayFill=void 0,this.FBadgeFont=void 0,this.FTodayStroke=void 0,this.FBadgeFill=void 0,this.FBadgeStroke=void 0,this.FTodayFont=void 0,pas.Classes.TPersistent.$final.call(this)},this.SetFill=function(t){this.FFill!==t&&this.FFill.Assign(t)},this.SetFont=function(t){this.FFont.AssignSource(t)},this.SetHorizontalTextAlign=function(t){this.FHorizontalTextAlign!==t&&(this.FHorizontalTextAlign=t)},this.SetStroke=function(t){this.FStroke!==t&&this.FStroke.Assign(t)},this.SetVerticalTextAlign=function(t){this.FVerticalTextAlign!==t&&(this.FVerticalTextAlign=t)},this.SetSelectedFill=function(t){this.FSelectedFill!==t&&this.FSelectedFill.Assign(t)},this.SetSelectedFont=function(t){this.FSelectedFont.AssignSource(t)},this.SetSelectedHorizontalTextAlign=function(t){this.FSelectedHorizontalTextAlign!==t&&(this.FSelectedHorizontalTextAlign=t)},this.SetSelectedStroke=function(t){this.FSelectedStroke!==t&&this.FSelectedStroke.Assign(t)},this.SetSelectedVerticalTextAlign=function(t){this.FSelectedVerticalTextAlign!==t&&(this.FSelectedVerticalTextAlign=t)},this.SetDisabledFill=function(t){this.FDisabledFill!==t&&this.FDisabledFill.Assign(t)},this.SetDisabledFont=function(t){this.FDisabledFont.AssignSource(t)},this.SetDisabledStroke=function(t){this.FDisabledStroke!==t&&this.FDisabledStroke.Assign(t)},this.SetDateAfterFill=function(t){this.FDateAfterFill!==t&&this.FDateAfterFill.Assign(t)},this.SetDateAfterFont=function(t){this.FDateAfterFont.AssignSource(t)},this.SetDateBeforeFill=function(t){this.FDateBeforeFill!==t&&this.FDateBeforeFill.Assign(t)},this.SetDateBeforeFont=function(t){this.FDateBeforeFont.AssignSource(t)},this.SetShowDaysAfter=function(t){this.FShowDaysAfter!==t&&(this.FShowDaysAfter=t,this.Changed())},this.SetShowDaysBefore=function(t){this.FShowDaysBefore!==t&&(this.FShowDaysBefore=t,this.Changed())},this.SetDateAfterStroke=function(t){this.FDateAfterStroke!==t&&this.FDateAfterStroke.Assign(t)},this.SetDateBeforeStroke=function(t){this.FDateBeforeStroke!==t&&this.FDateBeforeStroke.Assign(t)},this.SetBadgeFill=function(t){this.FBadgeFill!==t&&this.FBadgeFill.Assign(t)},this.SetBadgeFont=function(t){this.FBadgeFont.AssignSource(t)},this.SetBadgeStroke=function(t){this.FBadgeStroke!==t&&this.FBadgeStroke.Assign(t)},this.SetTodayFill=function(t){this.FTodayFill!==t&&this.FTodayFill.Assign(t)},this.SetTodayFont=function(t){this.FTodayFont.AssignSource(t)},this.SetTodayStroke=function(t){this.FTodayStroke!==t&&this.FTodayStroke.Assign(t)},this.SetShowFocus=function(t){this.FShowFocus!==t&&(this.FShowFocus=t,this.Changed())},this.Changed=function(){null!=this.FOnChange&&this.FOnChange(this)},this.FillChanged=function(t){this.Changed()},this.FontChanged=function(t){this.Changed()},this.StrokeChanged=function(t){this.Changed()},this.Create$1=function(){return this.FFont=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFont.$create("Create$2"),this.FFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[1,-1,8421504,-1,-1]),this.FStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,-1]),this.FHorizontalTextAlign=0,this.FVerticalTextAlign=0,this.FSelectedFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[1,16748574,8421504,-1,-1]),this.FSelectedStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,16748574]),this.FSelectedFont=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFont.$create("Create$2"),this.FSelectedFont.SetColor(16777215),this.FSelectedHorizontalTextAlign=0,this.FSelectedVerticalTextAlign=0,this.FDisabledFont=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFont.$create("Create$2"),this.FDisabledFont.SetColor(13882323),this.FDisabledFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[1,-1,8421504,-1,-1]),this.FDisabledStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,-1]),this.FDateBeforeFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[1,-1,8421504,-1,-1]),this.FDateBeforeFont=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFont.$create("Create$2"),this.FDateBeforeStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,-1]),this.FDateBeforeFont.SetColor(10789024),this.FDateAfterFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[1,-1,8421504,-1,-1]),this.FDateAfterFont=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFont.$create("Create$2"),this.FDateAfterFont.SetColor(10789024),this.FDateAfterStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,-1]),this.FTodayFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[1,-1,8421504,-1,-1]),this.FTodayFont=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFont.$create("Create$2"),this.FTodayFont.SetColor(255),this.FTodayStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,-1]),this.FBadgeFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[1,255,8421504,-1,-1]),this.FBadgeFont=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFont.$create("Create$2"),this.FBadgeFont.SetColor(16777215),this.FShowFocus=!0,this.FBadgeFont.SetSize(7),this.FBadgeStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,255]),this.FShowDaysBefore=!1,this.FShowDaysAfter=!1,this.FFont.FOnChanged=rtl.createCallback(this,"FontChanged"),this.FSelectedFont.FOnChanged=rtl.createCallback(this,"FontChanged"),this.FDisabledFont.FOnChanged=rtl.createCallback(this,"FontChanged"),this.FDateBeforeFont.FOnChanged=rtl.createCallback(this,"FontChanged"),this.FDateAfterFont.FOnChanged=rtl.createCallback(this,"FontChanged"),this.FTodayFont.FOnChanged=rtl.createCallback(this,"FontChanged"),this.FBadgeFont.FOnChanged=rtl.createCallback(this,"FontChanged"),this.FFill.FOnChanged=rtl.createCallback(this,"FillChanged"),this.FSelectedFill.FOnChanged=rtl.createCallback(this,"FillChanged"),this.FDisabledFill.FOnChanged=rtl.createCallback(this,"FillChanged"),this.FDateBeforeFill.FOnChanged=rtl.createCallback(this,"FillChanged"),this.FDateAfterFill.FOnChanged=rtl.createCallback(this,"FillChanged"),this.FTodayFill.FOnChanged=rtl.createCallback(this,"FillChanged"),this.FBadgeFill.FOnChanged=rtl.createCallback(this,"FillChanged"),this.FStroke.FOnChanged=rtl.createCallback(this,"StrokeChanged"),this.FSelectedStroke.FOnChanged=rtl.createCallback(this,"StrokeChanged"),this.FDisabledStroke.FOnChanged=rtl.createCallback(this,"StrokeChanged"),this.FDateBeforeStroke.FOnChanged=rtl.createCallback(this,"StrokeChanged"),this.FDateAfterStroke.FOnChanged=rtl.createCallback(this,"StrokeChanged"),this.FTodayStroke.FOnChanged=rtl.createCallback(this,"StrokeChanged"),this.FBadgeStroke.FOnChanged=rtl.createCallback(this,"StrokeChanged"),this},this.Destroy=function(){rtl.free(this,"FFill"),rtl.free(this,"FStroke"),rtl.free(this,"FFont"),rtl.free(this,"FSelectedFill"),rtl.free(this,"FSelectedStroke"),rtl.free(this,"FSelectedFont"),rtl.free(this,"FDisabledFill"),rtl.free(this,"FDisabledStroke"),rtl.free(this,"FDisabledFont"),rtl.free(this,"FDateBeforeFill"),rtl.free(this,"FDateBeforeFont"),rtl.free(this,"FDateBeforeStroke"),rtl.free(this,"FDateAfterFill"),rtl.free(this,"FDateAfterFont"),rtl.free(this,"FDateAfterStroke"),rtl.free(this,"FTodayFill"),rtl.free(this,"FTodayFont"),rtl.free(this,"FTodayStroke"),rtl.free(this,"FBadgeFill"),rtl.free(this,"FBadgeFont"),rtl.free(this,"FBadgeStroke"),pas.System.TObject.Destroy.call(this)},this.Assign=function(e){t.TTMSFNCCalendarDateAppearance.isPrototypeOf(e)?(this.FFill.Assign(rtl.as(e,t.TTMSFNCCalendarDateAppearance).FFill),this.FStroke.Assign(rtl.as(e,t.TTMSFNCCalendarDateAppearance).FStroke),this.FFont.AssignSource(rtl.as(e,t.TTMSFNCCalendarDateAppearance).FFont),this.FVerticalTextAlign=rtl.as(e,t.TTMSFNCCalendarDateAppearance).FVerticalTextAlign,this.FHorizontalTextAlign=rtl.as(e,t.TTMSFNCCalendarDateAppearance).FHorizontalTextAlign,this.FSelectedFill.Assign(rtl.as(e,t.TTMSFNCCalendarDateAppearance).FSelectedFill),this.FSelectedStroke.Assign(rtl.as(e,t.TTMSFNCCalendarDateAppearance).FSelectedStroke),this.FSelectedFont.AssignSource(rtl.as(e,t.TTMSFNCCalendarDateAppearance).FSelectedFont),this.FSelectedVerticalTextAlign=rtl.as(e,t.TTMSFNCCalendarDateAppearance).FSelectedVerticalTextAlign,this.FSelectedHorizontalTextAlign=rtl.as(e,t.TTMSFNCCalendarDateAppearance).FSelectedHorizontalTextAlign,this.FDisabledFill.Assign(rtl.as(e,t.TTMSFNCCalendarDateAppearance).FDisabledFill),this.FDisabledStroke.Assign(rtl.as(e,t.TTMSFNCCalendarDateAppearance).FDisabledStroke),this.FDisabledFont.AssignSource(rtl.as(e,t.TTMSFNCCalendarDateAppearance).FDisabledFont),this.FDateBeforeFill.Assign(rtl.as(e,t.TTMSFNCCalendarDateAppearance).FDateBeforeFill),this.FDateBeforeFont.AssignSource(rtl.as(e,t.TTMSFNCCalendarDateAppearance).FDateBeforeFont),this.FDateBeforeStroke.Assign(rtl.as(e,t.TTMSFNCCalendarDateAppearance).FDateBeforeStroke),this.FDateAfterFill.Assign(rtl.as(e,t.TTMSFNCCalendarDateAppearance).FDateAfterFill),this.FDateAfterFont.AssignSource(rtl.as(e,t.TTMSFNCCalendarDateAppearance).FDateAfterFont),this.FDateAfterStroke.Assign(rtl.as(e,t.TTMSFNCCalendarDateAppearance).FDateAfterStroke),this.FTodayFill.Assign(rtl.as(e,t.TTMSFNCCalendarDateAppearance).FTodayFill),this.FTodayFont.AssignSource(rtl.as(e,t.TTMSFNCCalendarDateAppearance).FTodayFont),this.FTodayStroke.Assign(rtl.as(e,t.TTMSFNCCalendarDateAppearance).FTodayStroke),this.FBadgeFill.Assign(rtl.as(e,t.TTMSFNCCalendarDateAppearance).FBadgeFill),this.FBadgeFont.AssignSource(rtl.as(e,t.TTMSFNCCalendarDateAppearance).FBadgeFont),this.FBadgeStroke.Assign(rtl.as(e,t.TTMSFNCCalendarDateAppearance).FBadgeStroke),this.FShowDaysBefore=rtl.as(e,t.TTMSFNCCalendarDateAppearance).FShowDaysBefore,this.FShowDaysAfter=rtl.as(e,t.TTMSFNCCalendarDateAppearance).FShowDaysAfter,this.FShowFocus=rtl.as(e,t.TTMSFNCCalendarDateAppearance).FShowFocus):pas.Classes.TPersistent.Assign.apply(this,arguments)};var e=this.$rtti;e.addProperty("Fill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FFill","SetFill"),e.addProperty("Font",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFont,"FFont","SetFont"),e.addProperty("Stroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FStroke","SetStroke"),e.addProperty("VerticalTextAlign",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsTextAlign,"FVerticalTextAlign","SetVerticalTextAlign",{Default:pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsTextAlign.gtaCenter}),e.addProperty("HorizontalTextAlign",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsTextAlign,"FHorizontalTextAlign","SetHorizontalTextAlign",{Default:pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsTextAlign.gtaCenter}),e.addProperty("SelectedFill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FSelectedFill","SetSelectedFill"),e.addProperty("SelectedFont",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFont,"FSelectedFont","SetSelectedFont"),e.addProperty("SelectedStroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FSelectedStroke","SetSelectedStroke"),e.addProperty("SelectedVerticalTextAlign",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsTextAlign,"FSelectedVerticalTextAlign","SetSelectedVerticalTextAlign",{Default:pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsTextAlign.gtaCenter}),e.addProperty("SelectedHorizontalTextAlign",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsTextAlign,"FSelectedHorizontalTextAlign","SetSelectedHorizontalTextAlign",{Default:pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsTextAlign.gtaCenter}),e.addProperty("DisabledFill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FDisabledFill","SetDisabledFill"),e.addProperty("DisabledFont",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFont,"FDisabledFont","SetDisabledFont"),e.addProperty("DisabledStroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FDisabledStroke","SetDisabledStroke"),e.addProperty("ShowDaysBefore",2,rtl.boolean,"FShowDaysBefore","SetShowDaysBefore",{Default:!1}),e.addProperty("ShowDaysAfter",2,rtl.boolean,"FShowDaysAfter","SetShowDaysAfter",{Default:!1}),e.addProperty("DateBeforeFill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FDateBeforeFill","SetDateBeforeFill"),e.addProperty("DateBeforeFont",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFont,"FDateBeforeFont","SetDateBeforeFont"),e.addProperty("DateBeforeStroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FDateBeforeStroke","SetDateBeforeStroke"),e.addProperty("DateAfterFill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FDateAfterFill","SetDateAfterFill"),e.addProperty("DateAfterFont",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFont,"FDateAfterFont","SetDateAfterFont"),e.addProperty("DateAfterStroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FDateAfterStroke","SetDateAfterStroke"),e.addProperty("TodayFill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FTodayFill","SetTodayFill"),e.addProperty("TodayFont",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFont,"FTodayFont","SetTodayFont"),e.addProperty("TodayStroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FTodayStroke","SetTodayStroke"),e.addProperty("BadgeFill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FBadgeFill","SetBadgeFill"),e.addProperty("BadgeFont",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFont,"FBadgeFont","SetBadgeFont"),e.addProperty("BadgeStroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FBadgeStroke","SetBadgeStroke"),e.addProperty("ShowFocus",2,rtl.boolean,"FShowFocus","SetShowFocus",{Default:!0})})),rtl.createClass(this,"TTMSFNCCalendarLineAppearance",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FStroke=null,this.FOnChange=null},this.$final=function(){this.FStroke=void 0,this.FOnChange=void 0,pas.Classes.TPersistent.$final.call(this)},this.SetStroke=function(t){this.FStroke!==t&&this.FStroke.Assign(t)},this.Changed=function(){null!=this.FOnChange&&this.FOnChange(this)},this.StrokeChanged=function(t){this.Changed()},this.Create$1=function(){return this.FStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,12632256]),this.FStroke.FOnChanged=rtl.createCallback(this,"StrokeChanged"),this},this.Destroy=function(){rtl.free(this,"FStroke"),pas.System.TObject.Destroy.call(this)},this.Assign=function(e){t.TTMSFNCCalendarLineAppearance.isPrototypeOf(e)?this.FStroke.Assign(rtl.as(e,t.TTMSFNCCalendarLineAppearance).FStroke):pas.Classes.TPersistent.Assign.apply(this,arguments)},this.$rtti.addProperty("Stroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FStroke","SetStroke")})),rtl.createClass(this,"TTMSFNCCalendarWeekNumberAppearance",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FOnChange=null,this.FVisible=!1,this.FFont=null,this.FFill=null,this.FStroke=null,this.FVerticalTextAlign=0,this.FHorizontalTextAlign=0},this.$final=function(){this.FOnChange=void 0,this.FFont=void 0,this.FFill=void 0,this.FStroke=void 0,pas.Classes.TPersistent.$final.call(this)},this.SetFill=function(t){this.FFill!==t&&this.FFill.Assign(t)},this.SetFont=function(t){this.FFont.AssignSource(t)},this.SetStroke=function(t){this.FStroke!==t&&this.FStroke.Assign(t)},this.SetVisible=function(t){this.FVisible!==t&&(this.FVisible=t,this.Changed())},this.SetHorizontalTextAlign=function(t){this.FHorizontalTextAlign!==t&&(this.FHorizontalTextAlign=t,this.Changed())},this.SetVerticalTextAlign=function(t){this.FVerticalTextAlign!==t&&(this.FVerticalTextAlign=t,this.Changed())},this.Changed=function(){null!=this.FOnChange&&this.FOnChange(this)},this.FillChanged=function(t){this.Changed()},this.FontChanged=function(t){this.Changed()},this.StrokeChanged=function(t){this.Changed()},this.Create$1=function(){return this.FVisible=!1,this.FFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[1,-1,8421504,-1,-1]),this.FFont=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFont.$create("Create$2"),this.FStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,-1]),this.FHorizontalTextAlign=0,this.FVerticalTextAlign=0,this.FFill.FOnChanged=rtl.createCallback(this,"FillChanged"),this.FFont.FOnChanged=rtl.createCallback(this,"FontChanged"),this.FStroke.FOnChanged=rtl.createCallback(this,"StrokeChanged"),this},this.Destroy=function(){rtl.free(this,"FFill"),rtl.free(this,"FFont"),rtl.free(this,"FStroke"),pas.System.TObject.Destroy.call(this)},this.Assign=function(e){t.TTMSFNCCalendarWeekNumberAppearance.isPrototypeOf(e)?(this.FVisible=rtl.as(e,t.TTMSFNCCalendarWeekNumberAppearance).FVisible,this.FFill.Assign(rtl.as(e,t.TTMSFNCCalendarWeekNumberAppearance).FFill),this.FStroke.Assign(rtl.as(e,t.TTMSFNCCalendarWeekNumberAppearance).FStroke),this.FFont.AssignSource(rtl.as(e,t.TTMSFNCCalendarWeekNumberAppearance).FFont),this.FHorizontalTextAlign=rtl.as(e,t.TTMSFNCCalendarWeekNumberAppearance).FHorizontalTextAlign,this.FVerticalTextAlign=rtl.as(e,t.TTMSFNCCalendarWeekNumberAppearance).FVerticalTextAlign):pas.Classes.TPersistent.Assign.apply(this,arguments)};var e=this.$rtti;e.addProperty("Visible",2,rtl.boolean,"FVisible","SetVisible",{Default:!1}),e.addProperty("Font",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFont,"FFont","SetFont"),e.addProperty("Fill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FFill","SetFill"),e.addProperty("Stroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FStroke","SetStroke"),e.addProperty("VerticalTextAlign",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsTextAlign,"FVerticalTextAlign","SetVerticalTextAlign",{Default:pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsTextAlign.gtaCenter}),e.addProperty("HorizontalTextAlign",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsTextAlign,"FHorizontalTextAlign","SetHorizontalTextAlign",{Default:pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsTextAlign.gtaCenter})})),this.TTMSFNCCalendarNavigationMode={0:"nmMonth",nmMonth:0,1:"nmYear",nmYear:1,2:"nmFocusedDate",nmFocusedDate:2,3:"nmCustom",nmCustom:3},this.$rtti.$Enum("TTMSFNCCalendarNavigationMode",{minvalue:0,maxvalue:3,ordtype:1,enumtype:this.TTMSFNCCalendarNavigationMode}),rtl.createClass(this,"TTMSFNCCalendarCustomInteraction",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FMultiSelect=!1,this.FKeyboardSupport=!1,this.FReadOnlyMode=!1,this.FNavigationMode=0,this.FSwipeOnHeader=!1},this.SetKeyboardSupport=function(t){this.FKeyboardSupport!==t&&(this.FKeyboardSupport=t)},this.SetMultiSelect=function(t){this.FMultiSelect!==t&&(this.FMultiSelect=t)},this.SetReadOnlyMode=function(t){this.FReadOnlyMode!==t&&(this.FReadOnlyMode=t)},this.SetNavigationMode=function(t){this.FNavigationMode!==t&&(this.FNavigationMode=t)},this.SetSwipeOnHeader=function(t){this.FSwipeOnHeader!==t&&(this.FSwipeOnHeader=t)},this.Create$1=function(){return pas.System.TObject.Create.call(this),this.FKeyboardSupport=!0,this.FMultiSelect=!1,this.FReadOnlyMode=!1,this.FNavigationMode=0,this.FSwipeOnHeader=!1,this},this.Assign=function(e){t.TTMSFNCCalendarCustomInteraction.isPrototypeOf(e)?(this.FKeyboardSupport=rtl.as(e,t.TTMSFNCCalendarCustomInteraction).FKeyboardSupport,this.FMultiSelect=rtl.as(e,t.TTMSFNCCalendarCustomInteraction).FMultiSelect,this.FReadOnlyMode=rtl.as(e,t.TTMSFNCCalendarCustomInteraction).FReadOnlyMode,this.FNavigationMode=rtl.as(e,t.TTMSFNCCalendarCustomInteraction).FNavigationMode,this.FSwipeOnHeader=rtl.as(e,t.TTMSFNCCalendarCustomInteraction).FSwipeOnHeader):pas.Classes.TPersistent.Assign.apply(this,arguments)}})),rtl.createClass(this,"TTMSFNCCalendarInteraction",this.TTMSFNCCalendarCustomInteraction,(function(){var e=this.$rtti;e.addProperty("MultiSelect",2,rtl.boolean,"FMultiSelect","SetMultiSelect",{Default:!1}),e.addProperty("KeyboardSupport",2,rtl.boolean,"FKeyboardSupport","SetKeyboardSupport",{Default:!0}),e.addProperty("ReadOnlyMode",2,rtl.boolean,"FReadOnlyMode","SetReadOnlyMode",{Default:!1}),e.addProperty("SwipeOnHeader",2,rtl.boolean,"FSwipeOnHeader","SetSwipeOnHeader",{Default:!1}),e.addProperty("NavigationMode",2,t.$rtti.TTMSFNCCalendarNavigationMode,"FNavigationMode","SetNavigationMode",{Default:t.TTMSFNCCalendarNavigationMode.nmMonth})})),rtl.createClass(this,"TTMSFNCCalendarDateItem",pas.Classes.TCollectionItem,(function(){this.$init=function(){pas.Classes.TCollectionItem.$init.call(this),this.FDate=0},this.SetDate=function(t){this.FDate!==t&&(this.FDate=t,this.Update())},this.Update=function(){this.FCollection.Update(this)},this.Assign=function(e){t.TTMSFNCCalendarDateItem.isPrototypeOf(e)?this.FDate=rtl.as(e,t.TTMSFNCCalendarDateItem).FDate:pas.Classes.TPersistent.Assign.apply(this,arguments)},this.$rtti.addProperty("Date",2,pas.System.$rtti.TDate,"FDate","SetDate")})),rtl.createClass(this,"TTMSFNCCalendarDates",pas.Classes.TCollection,(function(){this.$init=function(){pas.Classes.TCollection.$init.call(this),this.FOnChange=null},this.$final=function(){this.FOnChange=void 0,pas.Classes.TCollection.$final.call(this)},this.GetItem$1=function(t){return this.GetItem(t)},this.DoChange=function(){null!=this.FOnChange&&this.FOnChange(this)},this.Update=function(t){pas.Classes.TCollection.Update.apply(this,arguments),this.DoChange()},this.SelectDate=function(t){this.Add$1().SetDate(t)},this.SelectDateInterval=function(t,e){var i=0;if(this.SelectDate(t),i=t,-1===pas.DateUtils.CompareDate(t,e))for(var s=0,o=pas.DateUtils.DaysBetween(t,e)-1;s<=o;s++)s,i=pas.DateUtils.IncDay(i,1),this.SelectDate(i);if(-1===pas.DateUtils.CompareDate(e,t))for(var n=0,r=pas.DateUtils.DaysBetween(e,t)-1;n<=r;n++)n,i=pas.DateUtils.IncDay(i,-1),this.SelectDate(i)},this.UnselectDate=function(t){for(var e=0,i=0,s=this.GetCount()-1;i<=s;i++)if(e=i,this.GetItem$1(e).FDate===t)return void this.Delete(e)},this.UnselectAll=function(){this.Clear()},this.Add$1=function(){return pas.Classes.TCollection.Add.call(this)},this.InCollection=function(t){var e=!1,i=0;e=!1;for(var s=0,o=this.GetCount()-1;s<=o;s++)if(i=s,0===pas.DateUtils.CompareDate(this.GetItem$1(i).FDate,t)){e=!0;break}return e}})),rtl.createClass(this,"TTMSFNCCalendarEventItem",this.TTMSFNCCalendarDateItem,(function(){this.$init=function(){t.TTMSFNCCalendarDateItem.$init.call(this),this.FHint="",this.FBadgeValue=0,this.FBadgeColor=0,this.FShowBadge=!1,this.FBadgeFontColor=0},this.SetBadgeColor=function(t){this.FBadgeColor!==t&&(this.FBadgeColor=t,this.Update$1())},this.SetBadgeFontColor=function(t){this.FBadgeFontColor!==t&&(this.FBadgeFontColor=t,this.Update$1())},this.SetBadgeValue=function(t){this.FBadgeValue!==t&&(this.FBadgeValue=t,this.Update$1())},this.SetHint=function(t){this.FHint!==t&&(this.FHint=t,this.Update$1())},this.SetShowBadge=function(t){this.FShowBadge!==t&&(this.FShowBadge=t,this.Update$1())},this.IsHintStored=function(){return""!==this.FHint},this.Update$1=function(){this.FCollection.Update(this)},this.Assign=function(e){t.TTMSFNCCalendarEventItem.isPrototypeOf(e)?(this.FBadgeColor=rtl.as(e,t.TTMSFNCCalendarEventItem).FBadgeColor,this.FBadgeFontColor=rtl.as(e,t.TTMSFNCCalendarEventItem).FBadgeFontColor,this.FBadgeValue=rtl.as(e,t.TTMSFNCCalendarEventItem).FBadgeValue,this.FHint=rtl.as(e,t.TTMSFNCCalendarEventItem).FHint,this.FShowBadge=rtl.as(e,t.TTMSFNCCalendarEventItem).FShowBadge,this.FDate=rtl.as(e,t.TTMSFNCCalendarEventItem).FDate):t.TTMSFNCCalendarDateItem.Assign.apply(this,arguments)},this.Create$1=function(t){return pas.Classes.TCollectionItem.Create$1.apply(this,arguments),this.FShowBadge=!0,this.FBadgeColor=-1,this.FBadgeFontColor=-1,this.SetDate(pas.SysUtils.Now()),this};var e=this.$rtti;e.addProperty("BadgeValue",2,rtl.longint,"FBadgeValue","SetBadgeValue",{Default:0}),e.addProperty("ShowBadge",2,rtl.boolean,"FShowBadge","SetShowBadge",{Default:!0}),e.addProperty("BadgeFontColor",2,pas["WEBLib.Graphics"].$rtti.TColor,"FBadgeFontColor","SetBadgeFontColor",{Default:-1}),e.addProperty("BadgeColor",2,pas["WEBLib.Graphics"].$rtti.TColor,"FBadgeColor","SetBadgeColor",{Default:-1}),e.addProperty("Hint",14,rtl.string,"FHint","SetHint",{stored:"IsHintStored"})})),rtl.createClass(this,"TTMSFNCCalendarEvents",this.TTMSFNCCalendarDates,(function(){this.GetItem$2=function(t){return this.GetItem$1(t)}})),this.$rtti.$MethodVar("TTMSFNCCalendarBeforeDrawHeaderEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["AAllow",rtl.boolean,1],["ADefaultDraw",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCCalendarAfterDrawHeaderEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCCalendarBeforeDrawHeaderTextEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["AText",rtl.string],["AHorizontalTextAlign",pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsTextAlign],["AVerticalTextAlign",pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsTextAlign],["AAllow",rtl.boolean,1],["ADefaultDraw",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCCalendarAfterDrawHeaderTextEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["AText",rtl.string],["AHorizontalTextAlign",pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsTextAlign],["AVerticalTextAlign",pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsTextAlign]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCCalendarBeforeDrawFooterEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARectF",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["AAllow",rtl.boolean,1],["ADefaultDraw",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCCalendarAfterDrawFooterEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARectF",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCCalendarBeforeDrawFooterTextEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["AText",rtl.string],["AHorizontalTextAlign",pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsTextAlign],["AVerticalTextAlign",pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsTextAlign],["AAllow",rtl.boolean,1],["ADefaultDraw",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCCalendarAfterDrawFooterTextEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["AText",rtl.string],["AHorizontalTextAlign",pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsTextAlign],["AVerticalTextAlign",pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsTextAlign]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCCalendarBeforeDrawDayNamesEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["AAllow",rtl.boolean,1],["ADefaultDraw",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCCalendarAfterDrawDayNamesEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCCalendarBeforeDrawDayNamesTextEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["AText",rtl.string],["AHorizontalTextAlign",pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsTextAlign],["AVerticalTextAlign",pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsTextAlign],["AAllow",rtl.boolean,1],["ADefaultDraw",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCCalendarAfterDrawDayNamesTextEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["AText",rtl.string],["AHorizontalTextAlign",pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsTextAlign],["AVerticalTextAlign",pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsTextAlign]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCCalendarBeforeDrawDayNumbersEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["ADate",pas.System.$rtti.TDate],["AAllow",rtl.boolean,1],["ADefaultDraw",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCCalendarAfterDrawDayNumbersEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["ADate",pas.System.$rtti.TDate]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCCalendarBeforeDrawDayNumbersTextEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["AText",rtl.string],["AHorizontalTextAlign",pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsTextAlign],["AVerticalTextAlign",pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsTextAlign],["AAllow",rtl.boolean,1],["ADefaultDraw",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCCalendarAfterDrawDayNumbersTextEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["AText",rtl.string],["AHorizontalTextAlign",pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsTextAlign],["AVerticalTextAlign",pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsTextAlign]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCCalendarBeforeDrawLinesEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["AAllow",rtl.boolean,1],["ADefaultDraw",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCCalendarAfterDrawLinesEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCCalendarBeforeDrawWeekNumbersEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["AAllow",rtl.boolean,1],["ADefaultDraw",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCCalendarAfterDrawWeekNumbersEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCCalendarBeforeDrawWeekNumbersTextEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["AText",rtl.string],["AHorizontalTextAlign",pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsTextAlign],["AVerticalTextAlign",pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsTextAlign],["AAllow",rtl.boolean,1],["ADefaultDraw",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCCalendarAfterDrawWeekNumbersTextEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["AText",rtl.string],["AHorizontalTextAlign",pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsTextAlign],["AVerticalTextAlign",pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsTextAlign]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCCalendarBeforeDrawBadgeEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["ABadge",this.$rtti.TTMSFNCCalendarEventItem],["AAllow",rtl.boolean,1],["ADefaultDraw",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCCalendarAfterDrawBadgeEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["ABadge",this.$rtti.TTMSFNCCalendarEventItem]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCCalendarBeforeDrawArrowLeftEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["AArrowRect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["AAllow",rtl.boolean,1],["ADefaultDraw",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCCalendarAfterDrawArrowLeftEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["AArrowRect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCCalendarBeforeDrawArrowRightEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["AArrowRect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["AAllow",rtl.boolean,1],["ADefaultDraw",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCCalendarAfterDrawArrowRightEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["AArrowRect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCCalendarBeforeSelectDateEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ADate",pas.System.$rtti.TDate]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCCalendarSelectedDateEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ADate",pas.System.$rtti.TDate]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCCalendarSelectedMultiDateEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AStartDate",pas.System.$rtti.TDate],["AEndDate",pas.System.$rtti.TDate]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCCalendarYearChangedEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AYear",rtl.longint]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCCalendarMonthChangedEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AMonth",rtl.longint]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCCalendarCustomNavigationEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ADate",pas.System.$rtti.TDate],["AFocusedDate",pas.System.$rtti.TDate],["ADirection",rtl.boolean]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCCalendarCustomArrowDrawEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["ADirection",rtl.boolean]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCCalendarCustomNavigateEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AMonth",rtl.longint],["AYear",rtl.longint]]),methodkind:0}),rtl.createClass(this,"TTMSFNCCustomCalendar",pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl,(function(){this.$init=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.$init.call(this),this.FDay=0,this.FMonth=0,this.FYear=0,this.FBitmapContainer=null,this.FNumOfWeeksDrawn=0,this.FWeekNumberAppearance=null,this.FFirstDay=0,this.FHeader=null,this.FFooter=null,this.FDayNameAppearance=null,this.FDateAppearance=null,this.FLineAppearance=null,this.FXOffset=0,this.FYOffset=0,this.FDateAreaHeight=0,this.FMx=0,this.FMy=0,this.FTick=0,this.FSelectedDates=null,this.FEvents=null,this.FBadgeSize=0,this.FMouseDown=!1,this.FShiftPressed=!1,this.FSelectedAll=!1,this.FDate=0,this.FMaxDate=0,this.FMinDate=0,this.FClickedDate=0,this.FMouseAtDate=0,this.FFocusedDate=0,this.FHoverDate=0,this.FOnChange=null,this.FOnBeforeDrawHeader=null,this.FOnAfterDrawDayNames=null,this.FOnAfterDrawHeader=null,this.FOnBeforeDrawDayNames=null,this.FOnAfterDrawHeaderText=null,this.FOnBeforeDrawHeaderText=null,this.FOnAfterDrawDayNamesText=null,this.FOnBeforeDrawDayNamesText=null,this.FOnAfterDrawWeekNumbersText=null,this.FOnBeforeDrawDayNumbersText=null,this.FOnBeforeDrawLines=null,this.FOnAfterDrawWeekNumbers=null,this.FOnBeforeDrawDayNumbers=null,this.FOnAfterDrawDayNumbersText=null,this.FOnBeforeDrawWeekNumbersText=null,this.FOnAfterDrawLines=null,this.FOnAfterDrawDayNumbers=null,this.FOnBeforeDrawWeekNumbers=null,this.FInteraction=null,this.FOnYearChanged=null,this.FOnSelectDate=null,this.FOnMonthChanged=null,this.FOnSelectMultiDate=null,this.FOnBeforeSelectDate=null,this.FOnBeforeDrawFooterText=null,this.FOnBeforeDrawFooter=null,this.FOnAfterDrawFooterText=null,this.FOnAfterDrawFooter=null,this.FOnCustomNavigation=null,this.FOnAfterDrawBadge=null,this.FOnBeforeDrawBadge=null,this.FOnCustomArrowDraw=null,this.FOnAfterDrawArrowRight=null,this.FOnBeforeDrawArrowLeft=null,this.FOnBeforeDrawArrowRight=null,this.FOnAfterDrawArrowLeft=null,this.FOnNavigateBack=null,this.FOnNavigateForward=null,this.FOnNavigateFooter=null,this.FGlobalFont=null},this.$final=function(){this.FBitmapContainer=void 0,this.FWeekNumberAppearance=void 0,this.FHeader=void 0,this.FFooter=void 0,this.FDayNameAppearance=void 0,this.FDateAppearance=void 0,this.FLineAppearance=void 0,this.FSelectedDates=void 0,this.FEvents=void 0,this.FOnChange=void 0,this.FOnBeforeDrawHeader=void 0,this.FOnAfterDrawDayNames=void 0,this.FOnAfterDrawHeader=void 0,this.FOnBeforeDrawDayNames=void 0,this.FOnAfterDrawHeaderText=void 0,this.FOnBeforeDrawHeaderText=void 0,this.FOnAfterDrawDayNamesText=void 0,this.FOnBeforeDrawDayNamesText=void 0,this.FOnAfterDrawWeekNumbersText=void 0,this.FOnBeforeDrawDayNumbersText=void 0,this.FOnBeforeDrawLines=void 0,this.FOnAfterDrawWeekNumbers=void 0,this.FOnBeforeDrawDayNumbers=void 0,this.FOnAfterDrawDayNumbersText=void 0,this.FOnBeforeDrawWeekNumbersText=void 0,this.FOnAfterDrawLines=void 0,this.FOnAfterDrawDayNumbers=void 0,this.FOnBeforeDrawWeekNumbers=void 0,this.FInteraction=void 0,this.FOnYearChanged=void 0,this.FOnSelectDate=void 0,this.FOnMonthChanged=void 0,this.FOnSelectMultiDate=void 0,this.FOnBeforeSelectDate=void 0,this.FOnBeforeDrawFooterText=void 0,this.FOnBeforeDrawFooter=void 0,this.FOnAfterDrawFooterText=void 0,this.FOnAfterDrawFooter=void 0,this.FOnCustomNavigation=void 0,this.FOnAfterDrawBadge=void 0,this.FOnBeforeDrawBadge=void 0,this.FOnCustomArrowDraw=void 0,this.FOnAfterDrawArrowRight=void 0,this.FOnBeforeDrawArrowLeft=void 0,this.FOnBeforeDrawArrowRight=void 0,this.FOnAfterDrawArrowLeft=void 0,this.FOnNavigateBack=void 0,this.FOnNavigateForward=void 0,this.FOnNavigateFooter=void 0,this.FGlobalFont=void 0,pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.$final.call(this)},this.SetDay=function(t){this.FDay!==t&&(this.FDay=t,this.FDate=pas.SysUtils.EncodeDate(pas.DateUtils.YearOf(this.FDate),pas.DateUtils.MonthOf(this.FDate),this.FDay),this.Invalidate())},this.SetMonth=function(t){this.FMonth!==t&&(this.FMonth=t,this.FDate=pas.SysUtils.EncodeDate(pas.DateUtils.YearOf(this.FDate),this.FMonth,pas.DateUtils.DayOf(this.FDate)),this.Invalidate())},this.SetYear=function(t){this.FYear!==t&&(this.FYear=t,this.FDate=pas.SysUtils.EncodeDate(this.FYear,pas.DateUtils.MonthOf(this.FDate),pas.DateUtils.DayOf(this.FDate)),this.Invalidate())},this.SetFirstDay=function(t){this.FFirstDay!==t&&(this.FFirstDay=t,this.Invalidate())},this.SetHeader=function(t){this.FHeader.Assign(t)},this.IncrementCell=function(t,e){t.set(t.get()+e)},this.ShiftCellH=function(t,e){this.IncrementCell({p:t,get:function(){return this.p.Left},set:function(t){this.p.Left=t}},e),this.IncrementCell({p:t,get:function(){return this.p.Right},set:function(t){this.p.Right=t}},e)},this.ShiftCellV=function(t,e){this.IncrementCell({p:t,get:function(){return this.p.Top},set:function(t){this.p.Top=t}},e),this.IncrementCell({p:t,get:function(){return this.p.Bottom},set:function(t){this.p.Bottom=t}},e)},this.IncrementWeekDay=function(t){t.set((t.get()+1)%7),0===t.get()&&t.set(7)},this.SetDateForward=function(t,e){t.set(pas.DateUtils.IncDay(t.get(),e)),pas.DateUtils.YearOf(t.get())>this.FYear?(this.DoChangeYear(this.FYear),this.DoChangeMonth(this.FMonth)):pas.DateUtils.MonthOf(t.get())>this.FMonth&&this.DoChangeMonth(this.FMonth),this.SetDate(t.get())},this.SetDateBackward=function(t,e){t.set(pas.DateUtils.IncDay(t.get(),e)),pas.DateUtils.YearOf(t.get())<this.FYear?(this.DoChangeYear(this.FYear),this.DoChangeMonth(this.FMonth)):pas.DateUtils.MonthOf(t.get())<this.FMonth&&this.DoChangeMonth(this.FMonth),this.SetDate(t.get())},this.SetDayNameAppearance=function(t){this.FDayNameAppearance.Assign(t)},this.SetDateAppearance=function(t){this.FDateAppearance.Assign(t)},this.SetLineAppearance=function(t){this.FLineAppearance.Assign(t)},this.SetWeekNumberAppearance=function(t){this.FWeekNumberAppearance.Assign(t),this.Invalidate()},this.SetArrowLeftRect=function(t,e,i){var s=this.FHeader.FArrow.FArrowLeftType;0===s||1===s||3===s?(e.Top=i-this.FHeader.FArrow.FSize/2,e.Bottom=i+this.FHeader.FArrow.FSize/2,e.Right=t.Left+this.FHeader.FArrow.FSize+8):2===s&&(e.Top=i-this.FHeader.FArrow.FArrowLeftBitmapSize/2,e.Bottom=i+this.FHeader.FArrow.FArrowLeftBitmapSize/2,e.Right=t.Left+this.FHeader.FArrow.FArrowLeftBitmapSize+8),e.Left=t.Left+8},this.SetArrowRightRect=function(t,e,i){var s=this.FHeader.FArrow.FArrowRightType;0===s||1===s||3===s?(e.Top=i-this.FHeader.FArrow.FSize/2,e.Bottom=i+this.FHeader.FArrow.FSize/2,e.Left=t.Right-8-this.FHeader.FArrow.FSize):2===s&&(e.Top=i-this.FHeader.FArrow.FArrowRightBitmapSize/2,e.Bottom=i+this.FHeader.FArrow.FArrowRightBitmapSize/2,e.Left=t.Right-8-this.FHeader.FArrow.FArrowRightBitmapSize),e.Right=t.Right-8},this.SetFocusedDate=function(t){this.FFocusedDate!==t&&(this.FFocusedDate=t)},this.SetDate=function(t){this.FDate!==t&&(this.FDate=t,this.FDay=pas.DateUtils.DayOf(this.FDate),this.FMonth=pas.DateUtils.MonthOf(this.FDate),this.FYear=pas.DateUtils.YearOf(this.FDate))},this.SetInteraction=function(t){this.FInteraction.Assign(t)},this.SetMaxDate=function(t){this.FMaxDate!==t&&(this.FMaxDate=t,this.Changed())},this.SetMinDate=function(t){this.FMinDate!==t&&(this.FMinDate=t,this.Changed())},this.SetFooter=function(t){this.FFooter.Assign(t)},this.SetBitmapContainer=function(t){this.FBitmapContainer=t,this.Invalidate()},this.SetBadgeSize=function(t){this.FBadgeSize!==t&&(this.FBadgeSize=t)},this.SetEvents=function(t){this.FEvents.Assign(t)},this.ColCount=function(t){return t?8:7},this.CalcRowCount=function(t,e){return pas.Math.Ceil((e+t)/7)},this.CalcDateAreaHeight=function(t,e,i){var s=0;return s=t,e&&(s-=this.FHeader.FHeight),i&&(s-=this.FFooter.FHeight),s-=this.FDayNameAppearance.FHeight},this.GetArrowRect=function(t){var e,i=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),s=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),o=0;if(e=this.FHeader.FHeight,o=0,t){var n=this.FHeader.FArrow.FArrowLeftType;0===n||1===n||3===n?o=this.FHeader.FArrow.FSize:2===n&&(o=this.FHeader.FArrow.FArrowLeftBitmapSize),s.Top=e/2-o/2,s.Bottom=e/2+o/2,s.Left=8,s.Right=8+o}else{var r=this.FHeader.FArrow.FArrowRightType;0===r||1===r||3===r?o=this.FHeader.FArrow.FSize:2===r&&(o=this.FHeader.FArrow.FArrowRightBitmapSize),s.Top=e/2-o/2,s.Bottom=e/2+o/2,s.Left=this.GetWidth()-8-o,s.Right=this.GetWidth()-8}return i.$assign(s),i},this.GetFooterTextRect=function(){var t,e,i,s,o=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),n=0,r=0;n=0,r=0,i=this.FFooter.FCaptionRect.Bottom,s=this.FFooter.FCaptionRect.Right;var a=this.FFooter.FHorizontalTextAlign;0===a?n=this.GetWidth()/2-s/2:1===a?n=this.FFooter.FCaptionRect.Left:2===a&&(n=this.GetWidth()-s);var l=this.FFooter.FVerticalTextAlign;return 0===l?r=this.GetHeight()-this.FFooter.FHeight/2-i/2:1===l?r=this.FFooter.FCaptionRect.Top:2===l&&(r=this.GetHeight()-i),e=r+i,t=n+s,o.$assign(pas["WEBLib.TMSFNCTypes"].RectF(n,r,t,e)),o},this.PointInRect=function(t,e){return t.Left<=e.X&&t.Right>=e.X&&t.Top<=e.Y&&t.Bottom>=e.Y},this.IsMaxDateStored=function(){return 0!==this.FMaxDate},this.IsMinDateStored=function(){return 0!==this.FMinDate},this.GetCurrentDate=function(){return pas.SysUtils.Now()},this.GetBitmapContainer=function(){return this.FBitmapContainer},this.SetGlobalFont=function(t){this.FGlobalFont.Assign(t)},this.ApplyStyle=function(){var t=0;pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.ApplyStyle.call(this),t=-1,pas["WEBLib.TMSFNCStyles"].TTMSFNCStyles.GetStyleBackgroundFillColor({get:function(){return t},set:function(e){t=e}})&&(this.FFill.SetColor(t),this.FDateAppearance.FFill.SetColor(t),this.FDateAppearance.FStroke.SetKind(0),this.FDateAppearance.FDateAfterFill.SetColor(t),this.FDateAppearance.FDateAfterStroke.SetKind(0),this.FDateAppearance.FDateBeforeFill.SetColor(t),this.FDateAppearance.FDateBeforeStroke.SetKind(0),this.FDateAppearance.FDisabledFill.SetColor(t),this.FDateAppearance.FDisabledStroke.SetKind(0),this.FDateAppearance.FTodayFill.SetColor(t),this.FDateAppearance.FTodayStroke.SetKind(0),this.FWeekNumberAppearance.FFill.SetColor(t),this.FWeekNumberAppearance.FStroke.SetKind(0),this.FDayNameAppearance.FStroke.SetKind(0),this.FDayNameAppearance.FFill.SetColor(t)),t=-1,pas["WEBLib.TMSFNCStyles"].TTMSFNCStyles.GetStyleSelectionFillColor({get:function(){return t},set:function(e){t=e}})&&(this.FDateAppearance.FSelectedFill.SetColor(t),this.FDateAppearance.FSelectedStroke.SetColor(t)),t=-1,pas["WEBLib.TMSFNCStyles"].TTMSFNCStyles.GetStyleLineFillColor({get:function(){return t},set:function(e){t=e}})&&(this.FStroke.SetColor(t),this.FHeader.FStroke.SetColor(t),this.FFooter.FStroke.SetColor(t),this.FLineAppearance.FStroke.SetColor(t),this.FHeader.FArrow.SetColor(t)),t=-1,pas["WEBLib.TMSFNCStyles"].TTMSFNCStyles.GetStyleHeaderFillColor({get:function(){return t},set:function(e){t=e}})&&(this.FHeader.FFill.SetColor(t),this.FFooter.FFill.SetColor(t)),t=-1,pas["WEBLib.TMSFNCStyles"].TTMSFNCStyles.GetStyleHeaderFillColorTo({get:function(){return t},set:function(e){t=e}})&&(this.FHeader.FFill.SetKind(2),this.FHeader.FFill.SetColorTo(t),this.FFooter.FFill.SetKind(2),this.FFooter.FFill.SetColorTo(t)),t=-1,pas["WEBLib.TMSFNCStyles"].TTMSFNCStyles.GetStyleSelectionFillColorTo({get:function(){return t},set:function(e){t=e}})&&this.FDateAppearance.FTodayFont.SetColor(t),t=-1,pas["WEBLib.TMSFNCStyles"].TTMSFNCStyles.GetStyleTextFontColor({get:function(){return t},set:function(e){t=e}})&&(0===t?(this.FDateAppearance.FDateAfterFont.SetColor(pas["WEBLib.TMSFNCGraphicsTypes"].Lighter(t,50)),this.FDateAppearance.FDateBeforeFont.SetColor(pas["WEBLib.TMSFNCGraphicsTypes"].Lighter(t,50)),this.FDateAppearance.FDisabledFont.SetColor(pas["WEBLib.TMSFNCGraphicsTypes"].Lighter(t,75))):(this.FDateAppearance.FDateAfterFont.SetColor(pas["WEBLib.TMSFNCGraphicsTypes"].Blend(t,this.FFill.FColor,50)),this.FDateAppearance.FDateBeforeFont.SetColor(pas["WEBLib.TMSFNCGraphicsTypes"].Blend(t,this.FFill.FColor,50)),this.FDateAppearance.FDisabledFont.SetColor(pas["WEBLib.TMSFNCGraphicsTypes"].Blend(t,this.FFill.FColor,25))),this.FDateAppearance.FSelectedFont.SetColor(t),this.FDateAppearance.FFont.SetColor(t),this.FHeader.FFont.SetColor(t),this.FFooter.FFont.SetColor(t),this.FDayNameAppearance.FFont.SetColor(t),this.FWeekNumberAppearance.FFont.SetColor(t))},this.ResetToDefaultStyle=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.ResetToDefaultStyle.call(this),this.FFill.SetKind(1),this.FStroke.SetKind(1),this.FFill.SetColor(16777215),this.FStroke.SetColor(12632256),this.FHeader.FFill.SetKind(2),this.FHeader.FFill.SetColor(16578806),this.FHeader.FFill.SetColorTo(16380654),this.FHeader.FFont.SetColor(4539717),this.FHeader.FStroke.SetKind(1),this.FHeader.FStroke.SetColor(12632256),this.FHeader.FArrow.SetColor(6908265),pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.SetFontSize(this.FHeader.FFont,14,1),this.FFooter.FFill.Assign(this.FHeader.FFill),this.FFooter.FStroke.Assign(this.FHeader.FStroke),this.FFooter.FFont.Assign(this.FHeader.FFont),this.FFooter.FFont.SetStyle({}),this.FLineAppearance.FStroke.SetKind(1),this.FLineAppearance.FStroke.SetColor(11119017),this.FDayNameAppearance.FFill.SetKind(1),this.FDayNameAppearance.FStroke.SetKind(1),this.FDayNameAppearance.FFill.SetColor(-1),this.FDayNameAppearance.FStroke.SetColor(-1),this.FDayNameAppearance.FFont.SetColor(8026746),this.FWeekNumberAppearance.FFill.SetKind(1),this.FWeekNumberAppearance.FStroke.SetKind(1),this.FWeekNumberAppearance.FFill.SetColor(-1),this.FWeekNumberAppearance.FStroke.SetColor(-1),this.FWeekNumberAppearance.FFont.SetColor(this.FDayNameAppearance.FFont.FColor),this.FDateAppearance.FDateAfterFill.SetKind(1),this.FDateAppearance.FDateAfterStroke.SetKind(1),this.FDateAppearance.FDateBeforeFill.SetKind(1),this.FDateAppearance.FDateBeforeStroke.SetKind(1),this.FDateAppearance.FDisabledFill.SetKind(1),this.FDateAppearance.FDisabledStroke.SetKind(1),this.FDateAppearance.FFill.SetKind(1),this.FDateAppearance.FStroke.SetKind(1),this.FDateAppearance.FSelectedFill.SetKind(1),this.FDateAppearance.FSelectedStroke.SetKind(1),this.FDateAppearance.FTodayFill.SetKind(1),this.FDateAppearance.FTodayStroke.SetKind(1),this.FDateAppearance.FFont.SetColor(8026746),this.FDateAppearance.FTodayFont.SetColor(15702829),this.FDateAppearance.FDateBeforeFont.SetColor(12303291),this.FDateAppearance.FDateAfterFill.SetColor(-1),this.FDateAppearance.FDateAfterStroke.SetColor(-1),this.FDateAppearance.FDateAfterFont.SetColor(this.FDateAppearance.FDateBeforeFont.FColor),this.FDateAppearance.FDateBeforeFill.SetColor(-1),this.FDateAppearance.FDateBeforeStroke.SetColor(-1),this.FDateAppearance.FDisabledFill.SetColor(-1),this.FDateAppearance.FDisabledStroke.SetColor(-1),this.FDateAppearance.FDisabledFont.SetColor(13882323),this.FDateAppearance.FFill.SetColor(-1),this.FDateAppearance.FStroke.SetColor(-1),this.FDateAppearance.FSelectedFill.SetColor(this.FHeader.FFill.FColorTo),this.FDateAppearance.FSelectedStroke.SetColor(this.FDateAppearance.FTodayFont.FColor),this.FDateAppearance.FTodayFill.SetColor(-1),this.FDateAppearance.FTodayStroke.SetColor(-1),this.FDateAppearance.FTodayFont.SetStyle(rtl.createSet(0)),this.FDateAppearance.SetShowFocus(!1),this.FHeader.FFont.SetStyle(rtl.createSet(0)),this.FDateAppearance.FSelectedFont.Assign(this.FHeader.FFont)},this.Changed=function(){null!=this.FOnChange&&this.FOnChange(this),this.Invalidate()},this.CalculateXOffset=function(){this.FXOffset=(this.GetWidth()-2)/this.ColCount(this.FWeekNumberAppearance.FVisible)},this.Notification=function(t,e){pas["WEBLib.Menus"].TWebCustomControl.Notification.apply(this,arguments),1===e&&t===this.FBitmapContainer&&(this.FBitmapContainer=null)},this.Draw=function(t,e){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Draw.apply(this,arguments),this.FDateAreaHeight=this.CalcDateAreaHeight(this.GetHeight(),this.FHeader.FVisible,this.FFooter.FVisible),t.FBitmapContainer=this.GetBitmapContainer(),this.DrawDayNames(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e)),this.FDateAreaHeight>0&&(this.DrawDays(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e)),this.FWeekNumberAppearance.FVisible&&this.DrawWeekNumbers(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e))),this.FFooter.FVisible&&this.DrawFooter(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e)),this.DrawLines(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e)),this.FHeader.FVisible&&this.DrawHeader(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e)),this.DrawBadges(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e))},this.DrawHeader=function(t,e){var i,s=!1,o=!1,n=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),r=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),a=0;i=pas.SysUtils.FormatSettings.ShortMonthNames[this.FMonth-1]+" "+pas.SysUtils.IntToStr(this.FYear),n.$assign(pas["WEBLib.TMSFNCTypes"].RectF(e.Left,e.Top,e.Right,this.FHeader.FHeight)),t.FFill.Assign(this.FHeader.FFill),t.FStroke.Assign(this.FHeader.FStroke),s=!0,o=!0,this.DoBeforeDrawHeader(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(n),{get:function(){return s},set:function(t){s=t}},{get:function(){return o},set:function(t){o=t}}),s&&(o&&t.DrawRectangle$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(n),2),this.DoAfterDrawHeader(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(n))),t.FFont.AssignSource(this.FHeader.FFont),s=!0,o=!0,this.DoBeforeDrawHeaderText(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(n),i,this.FHeader.FHorizontalTextAlign,this.FHeader.FVerticalTextAlign,{get:function(){return s},set:function(t){s=t}},{get:function(){return o},set:function(t){o=t}}),s&&(o&&t.DrawText$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(n),i,!1,this.FHeader.FHorizontalTextAlign,this.FHeader.FVerticalTextAlign,0,0,-1,-1,!0,!1,-1,-1),this.DoAfterDrawHeaderText(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(n),i,this.FHeader.FHorizontalTextAlign,this.FHeader.FVerticalTextAlign)),rtl.eqSet(this.FHeader.FArrow.FVisibility,{})||(r.$assign(n),a=(n.Bottom-n.Top)/2,0 in this.FHeader.FArrow.FVisibility&&(this.SetArrowLeftRect(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(n),r,a),this.DrawArrows(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(r),0)),1 in this.FHeader.FArrow.FVisibility&&(this.SetArrowRightRect(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(n),r,a),this.DrawArrows(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(r),1)))},this.DrawFooter=function(t,e){var i=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),s="",o=!1,n=!1;i.$assign(pas["WEBLib.TMSFNCTypes"].RectF(e.Left,e.Bottom-this.FFooter.FHeight,e.Right,e.Bottom)),t.FFill.Assign(this.FFooter.FFill),t.FStroke.Assign(this.FFooter.FStroke),o=!0,n=!0,this.DoBeforeDrawFooter(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),{get:function(){return o},set:function(t){o=t}},{get:function(){return n},set:function(t){n=t}}),o&&(n&&t.DrawRectangle$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),2),this.DoAfterDrawFooter(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i))),s=1===this.FFooter.FDateCaption?this.FFooter.FCaption+" "+pas.SysUtils.DateToStr(this.SelectedDate()):2===this.FFooter.FDateCaption?this.FFooter.FCaption+" "+pas.SysUtils.DateToStr(this.GetCurrentDate()):this.FFooter.FCaption,t.FFont.AssignSource(this.FFooter.FFont),this.FFooter.SetCaptionRect(t.CalculateText(s,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),!1,!0)),o=!0,n=!0,this.DoBeforeDrawFooterText(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),s,this.FFooter.FHorizontalTextAlign,this.FFooter.FVerticalTextAlign,{get:function(){return o},set:function(t){o=t}},{get:function(){return n},set:function(t){n=t}}),o&&(n&&t.DrawText$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),s,!1,this.FFooter.FHorizontalTextAlign,this.FFooter.FVerticalTextAlign,0,0,-1,-1,!0,!1,-1,-1),this.DoAfterDrawFooterText(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),s,this.FFooter.FHorizontalTextAlign,this.FFooter.FVerticalTextAlign))},this.DrawArrows=function(t,e,i){var s,o=null,n=pas["WEBLib.TMSFNCTypes"].TPointF.$new(),r=0,a=0,l=!1,h=!1;if(s=e.Bottom-e.Top,pas["WEBLib.TMSFNCTypes"].InflateRectEx(e,-1,-1),t.FFill.SetColor(this.FHeader.FArrow.FColor),t.FStroke.SetColor(this.FHeader.FArrow.FColor),0===i){l=!0,h=!0;var F=this.FHeader.FArrow.FArrowLeftType;if(0===F){o=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsPath.$create("Create$1");try{n.$assign(pas["WEBLib.TMSFNCTypes"].PointF(e.Left,e.Top+s/2)),o.MoveTo(n),o.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(e.Right,e.Top)),o.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(e.Right,e.Bottom)),o.ClosePath(),t.FStroke.SetWidth(1),this.DoBeforeDrawArrowLeft(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),{get:function(){return l},set:function(t){l=t}},{get:function(){return h},set:function(t){h=t}}),l&&(h&&t.DrawPath(o,0),this.DoAfterDrawArrowLeft(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e)))}finally{o=rtl.freeLoc(o)}}else 1===F?(n.$assign(pas["WEBLib.TMSFNCTypes"].PointF(e.Left,e.Top+s/2)),r=e.Left+(e.Right-e.Left)/2,t.FStroke.SetWidth(2),this.DoBeforeDrawArrowLeft(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),{get:function(){return l},set:function(t){l=t}},{get:function(){return h},set:function(t){h=t}}),l&&(h&&(t.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(r,e.Top)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(n),2,2),t.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(n),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(r,e.Bottom)),2,2)),this.DoAfterDrawArrowLeft(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e)))):2===F?(this.DoBeforeDrawArrowLeft(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),{get:function(){return l},set:function(t){l=t}},{get:function(){return h},set:function(t){h=t}}),l&&(h&&t.DrawScaledBitmap(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),this.FHeader.FArrow.FArrowLeftBitmap,0,!0,!1,!0,!1),this.DoAfterDrawArrowLeft(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e)))):3===F&&(this.DoBeforeDrawArrowLeft(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),{get:function(){return l},set:function(t){l=t}},{get:function(){return h},set:function(t){h=t}}),l&&(h&&this.DoCustomArrowDraw(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),!0),this.DoAfterDrawArrowLeft(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e))))}else if(1===i){l=!0,h=!0;var p=this.FHeader.FArrow.FArrowRightType;if(0===p){o=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsPath.$create("Create$1");try{n.$assign(pas["WEBLib.TMSFNCTypes"].PointF(e.Right,e.Top+s/2)),o.MoveTo(n),o.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(e.Left,e.Bottom)),o.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(e.Left,e.Top)),o.ClosePath(),t.FStroke.SetWidth(1),this.DoBeforeDrawArrowLeft(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),{get:function(){return l},set:function(t){l=t}},{get:function(){return h},set:function(t){h=t}}),l&&(h&&t.DrawPath(o,0),this.DoAfterDrawArrowLeft(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e)))}finally{o=rtl.freeLoc(o)}}else 1===p?(n.$assign(pas["WEBLib.TMSFNCTypes"].PointF(e.Right,e.Top+s/2)),a=e.Left+(e.Right-e.Left)/2,t.FStroke.SetWidth(2),this.DoBeforeDrawArrowLeft(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),{get:function(){return l},set:function(t){l=t}},{get:function(){return h},set:function(t){h=t}}),l&&(h&&(t.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(a,e.Top)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(n),2,2),t.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(a,e.Bottom)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(n),2,2)),this.DoAfterDrawArrowLeft(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e)))):2===p?(this.DoBeforeDrawArrowLeft(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),{get:function(){return l},set:function(t){l=t}},{get:function(){return h},set:function(t){h=t}}),l&&(h&&t.DrawScaledBitmap(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),this.FHeader.FArrow.FArrowRightBitmap,0,!0,!1,!0,!1),this.DoAfterDrawArrowLeft(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e)))):3===p&&(this.DoBeforeDrawArrowLeft(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),{get:function(){return l},set:function(t){l=t}},{get:function(){return h},set:function(t){h=t}}),l&&(h&&this.DoCustomArrowDraw(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),!1),this.DoAfterDrawArrowLeft(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e))))}},this.DrawDayNames=function(t,e){var i=0,s=0,o=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),n=!1,r=!1;i=this.ColCount(this.FWeekNumberAppearance.FVisible),this.FHeader.FVisible?o.$assign(pas["WEBLib.TMSFNCTypes"].RectF(e.Left,this.FHeader.FHeight-1,this.FXOffset,this.FHeader.FHeight+this.FDayNameAppearance.FHeight)):o.$assign(pas["WEBLib.TMSFNCTypes"].RectF(e.Left,e.Top+1,this.FXOffset,this.FDayNameAppearance.FHeight)),s=this.FFirstDay,this.ShiftCellH(o,1),this.FWeekNumberAppearance.FVisible&&(this.ShiftCellH(o,this.FXOffset),i-=1),t.FFill.Assign(this.FDayNameAppearance.FFill),t.FStroke.Assign(this.FDayNameAppearance.FStroke),t.FFont.AssignSource(this.FDayNameAppearance.FFont);for(var a=0,l=i-1;a<=l;a++)a,n=!0,r=!0,this.DoBeforeDrawDayNames(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(o),{get:function(){return n},set:function(t){n=t}},{get:function(){return r},set:function(t){r=t}}),n&&(r&&t.DrawRectangle$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(o),0),this.DoAfterDrawDayNames(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(o))),n=!0,r=!0,this.DoBeforeDrawDayNamesText(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(o),pas.SysUtils.FormatSettings.ShortDayNames[s-1],this.FDayNameAppearance.FHorizontalTextAlign,this.FDayNameAppearance.FVerticalTextAlign,{get:function(){return n},set:function(t){n=t}},{get:function(){return r},set:function(t){r=t}}),n&&(r&&t.DrawText$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(o),pas.SysUtils.FormatSettings.ShortDayNames[s-1],!1,this.FDayNameAppearance.FHorizontalTextAlign,this.FDayNameAppearance.FVerticalTextAlign,0,0,-1,-1,!0,!1,-1,-1),this.DoAfterDrawDayNamesText(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(o),pas.SysUtils.FormatSettings.ShortDayNames[s-1],this.FDayNameAppearance.FHorizontalTextAlign,this.FDayNameAppearance.FVerticalTextAlign)),this.IncrementWeekDay({get:function(){return s},set:function(t){s=t}}),this.ShiftCellH(o,this.FXOffset)},this.DrawDays=function(t,e){var i,s,o,n=0,r=0,a=0,l=0,h=0,F=pas["WEBLib.TMSFNCTypes"].TRectF.$new();if(r=1,o=pas.SysUtils.EncodeDate(this.FYear,this.FMonth,1),(a=pas.SysUtils.DayOfWeek(o)-this.FFirstDay)<0&&(a+=7),s=pas.DateUtils.DaysInMonth(o),0!==(i=this.CalcRowCount(a,s))&&(this.FYOffset=this.FDateAreaHeight/i),F.$assign(pas["WEBLib.TMSFNCTypes"].RectF(e.Left,e.Top,e.Left+this.FXOffset,e.Top+this.FYOffset)),this.ShiftCellH(F,1),this.FDateAppearance.FShowDaysBefore&&(l=a)>0){h=pas.DateUtils.DaysInMonth(pas.SysUtils.IncMonth(o,-1));for(var p=l-1;p>=0;p--)n=p,l-=1,this.DrawDayNumbers(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(F),l,r,this.PreviousMonth(),h),h-=1}for(var c=1,u=s;c<=u;c++)n=c,this.DrawDayNumbers(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(F),a,r,this.FMonth,n),(a+=1)>6&&(a=0,r+=1);if(this.FDateAppearance.FShowDaysAfter)for(h=1;r<=i;)this.DrawDayNumbers(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(F),a,r,this.NextMonth(),h),(a+=1)>6&&(a=0,r+=1),h+=1;this.FNumOfWeeksDrawn=i},this.DrawDayNumbers=function(t,e,i,s,o,n){var r=0,a=0,l=0,h=!1,F=!1;this.FWeekNumberAppearance.FVisible&&(i+=1),this.FHeader.FVisible?this.ShiftCellV(e,this.FHeader.FHeight+this.FDayNameAppearance.FHeight+(s-1)*this.FYOffset):this.ShiftCellV(e,this.FDayNameAppearance.FHeight+(s-1)*this.FYOffset),this.ShiftCellH(e,i*this.FXOffset),r=pas.SysUtils.EncodeDate(this.FYear,o,n),a=this.FMinDate,l=this.FMaxDate,0===this.FMinDate&&(a=r),0===this.FMaxDate&&(l=r),this.FSelectedDates.InCollection(r)?(t.FFill.Assign(this.FDateAppearance.FSelectedFill),t.FStroke.Assign(this.FDateAppearance.FSelectedStroke),t.FFont.AssignSource(this.FDateAppearance.FSelectedFont)):pas.System.Int(r)<pas.System.Int(a)||pas.System.Int(r)>pas.System.Int(l)?(t.FFill.Assign(this.FDateAppearance.FDisabledFill),t.FStroke.Assign(this.FDateAppearance.FDisabledStroke),t.FFont.AssignSource(this.FDateAppearance.FDisabledFont)):this.FDateAppearance.FShowDaysBefore&&20<n&&1===s?(r=pas.SysUtils.IncMonth(r,-1),t.FFill.Assign(this.FDateAppearance.FDateBeforeFill),t.FFont.AssignSource(this.FDateAppearance.FDateBeforeFont),t.FStroke.Assign(this.FDateAppearance.FDateBeforeStroke)):this.FDateAppearance.FShowDaysAfter&&15>n&&s>=5?(r=pas.SysUtils.IncMonth(r,1),t.FFill.Assign(this.FDateAppearance.FDateAfterFill),t.FFont.AssignSource(this.FDateAppearance.FDateAfterFont),t.FStroke.Assign(this.FDateAppearance.FDateAfterStroke)):0===pas.DateUtils.CompareDate(r,this.GetCurrentDate())?(t.FFill.Assign(this.FDateAppearance.FTodayFill),t.FStroke.Assign(this.FDateAppearance.FTodayStroke),t.FFont.AssignSource(this.FDateAppearance.FTodayFont)):(t.FFill.Assign(this.FDateAppearance.FFill),t.FStroke.Assign(this.FDateAppearance.FStroke),t.FFont.AssignSource(this.FDateAppearance.FFont)),h=!0,F=!0,this.DoBeforeDrawDayNumbers(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),r,{get:function(){return h},set:function(t){h=t}},{get:function(){return F},set:function(t){F=t}}),h&&(F&&t.DrawRectangle$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),0),this.DoAfterDrawDayNumbers(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),r)),h=!0,this.DoBeforeDrawDayNumbersText(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),pas.SysUtils.IntToStr(n),this.FDateAppearance.FHorizontalTextAlign,this.FDateAppearance.FVerticalTextAlign,{get:function(){return h},set:function(t){h=t}},{get:function(){return F},set:function(t){F=t}}),h&&(F&&t.DrawText$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),pas.SysUtils.IntToStr(n),!1,this.FDateAppearance.FHorizontalTextAlign,this.FDateAppearance.FVerticalTextAlign,0,0,-1,-1,!0,!1,-1,-1),this.DoAfterDrawDayNumbersText(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),pas.SysUtils.IntToStr(n),this.FDateAppearance.FHorizontalTextAlign,this.FDateAppearance.FVerticalTextAlign)),0===pas.DateUtils.CompareDate(r,this.FFocusedDate)&&this.FDateAppearance.FShowFocus&&t.DrawFocusRectangle$3(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),0,2)},this.DrawWeekNumbers=function(t,e){var i=0,s=0,o=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),n=!1,r=!1;s=pas.SysUtils.EncodeDate(this.FYear,this.FMonth,1),i=pas.DateUtils.WeekOf(s),o.$assign(pas["WEBLib.TMSFNCTypes"].RectF(e.Left,e.Top,e.Left+this.FXOffset,e.Top+this.FYOffset)),this.ShiftCellH(o,1),this.FHeader.FVisible?this.ShiftCellV(o,this.FHeader.FHeight+this.FDayNameAppearance.FHeight):this.ShiftCellV(o,this.FDayNameAppearance.FHeight),t.FFill.Assign(this.FWeekNumberAppearance.FFill),t.FStroke.Assign(this.FWeekNumberAppearance.FStroke),t.FFont.AssignSource(this.FWeekNumberAppearance.FFont);for(var a=0,l=this.FNumOfWeeksDrawn-1;a<=l;a++)a,n=!0,r=!0,this.DoBeforeDrawWeekNumbers(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(o),{get:function(){return n},set:function(t){n=t}},{get:function(){return r},set:function(t){r=t}}),n&&(r&&t.DrawRectangle$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(o),0),this.DoAfterDrawWeekNumbers(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(o))),n=!0,r=!0,this.DoBeforeDrawWeekNumbersText(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(o),pas.SysUtils.IntToStr(i),this.FWeekNumberAppearance.FHorizontalTextAlign,this.FWeekNumberAppearance.FVerticalTextAlign,{get:function(){return n},set:function(t){n=t}},{get:function(){return r},set:function(t){r=t}}),n&&(r&&t.DrawText$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(o),pas.SysUtils.IntToStr(i),!1,this.FWeekNumberAppearance.FHorizontalTextAlign,this.FWeekNumberAppearance.FVerticalTextAlign,0,0,-1,-1,!0,!1,-1,-1),this.DoAfterDrawWeekNumbersText(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(o),pas.SysUtils.IntToStr(i),this.FWeekNumberAppearance.FHorizontalTextAlign,this.FWeekNumberAppearance.FVerticalTextAlign)),this.ShiftCellV(o,this.FYOffset),s=pas.DateUtils.IncDay(s,7),i=pas.DateUtils.WeekOf(s)},this.DrawLines=function(t,e){var i=0,s=0,o=0,n=0,r=!1,a=!1;t.FStroke.Assign(this.FLineAppearance.FStroke),i=e.Left+1,o=e.Right-1,n=s=this.FHeader.FVisible?this.FHeader.FHeight+this.FDayNameAppearance.FHeight-1:this.FDayNameAppearance.FHeight-1,r=!0,a=!0,this.DoBeforeDrawLines(t,{get:function(){return r},set:function(t){r=t}},{get:function(){return a},set:function(t){a=t}}),r&&(a&&t.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(i,s)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(o,n)),2,2),this.DoAfterDrawLines(t)),this.FWeekNumberAppearance.FVisible&&(o=i=e.Left+this.FXOffset,s=this.FHeader.FVisible?this.FHeader.FHeight-1:0,n=this.FFooter.FVisible?e.Bottom-this.FFooter.FHeight:e.Bottom,this.DoBeforeDrawLines(t,{get:function(){return r},set:function(t){r=t}},{get:function(){return a},set:function(t){a=t}}),r&&(a&&t.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(i,s)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(o,n)),2,2),this.DoAfterDrawLines(t)))},this.DrawBadges=function(t,e){var i=0,s=0,o=0,n=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),r=null;n.$assign(pas["WEBLib.TMSFNCTypes"].RectF(e.Left,e.Top,e.Left+this.FBadgeSize,e.Top+this.FBadgeSize)),this.ShiftCellH(n,1),this.FHeader.FVisible?this.ShiftCellV(n,this.FHeader.FHeight+this.FDayNameAppearance.FHeight):this.ShiftCellV(n,this.FDayNameAppearance.FHeight);for(var a=0,l=this.FEvents.GetCount()-1;a<=l;a++)o=a,r=this.FEvents.GetItem$2(o),this.FYear===pas.DateUtils.YearOf(r.FDate)&&this.FMonth===pas.DateUtils.MonthOf(r.FDate)&&r.FShowBadge&&(s=this.DateToRow(r.FDate),i=this.DateToCol(r.FDate),this.DrawBadge(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(n),r,i,s))},this.DrawBadge=function(t,e,i,s,o){var n=!1,r=!1;-1!==i.FBadgeColor?(t.FFill.SetColor(i.FBadgeColor),t.FStroke.SetColor(i.FBadgeColor)):(t.FFill.Assign(this.FDateAppearance.FBadgeFill),t.FStroke.Assign(this.FDateAppearance.FBadgeStroke)),-1!==i.FBadgeFontColor?(t.FFont.SetSize(7),t.FFont.SetColor(i.FBadgeFontColor)):t.FFont.AssignSource(this.FDateAppearance.FBadgeFont),this.ShiftCellH(e,(s+1)*this.FXOffset-this.FBadgeSize),this.ShiftCellV(e,o*this.FYOffset),n=!0,r=!0,this.DoBeforeDrawBadge(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i,{get:function(){return n},set:function(t){n=t}},{get:function(){return r},set:function(t){r=t}}),n&&(r&&(t.DrawEllipse$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),2),0!==i.FBadgeValue&&t.DrawText$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),pas.SysUtils.IntToStr(i.FBadgeValue),!1,0,0,0,0,-1,-1,!0,!1,-1,-1)),this.DoAfterDrawBadge(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i))},this.EventsChanged=function(t){this.Changed()},this.WeekNumbersChanged=function(t){this.CalculateXOffset(),this.Changed()},this.ArrowsChanged=function(t){this.Changed()},this.HeaderChanged=function(t){this.Changed()},this.FooterChanged=function(t){this.Changed()},this.DayNameAppearanceChanged=function(t){this.Changed()},this.LineAppearanceChanged=function(t){this.Changed()},this.ShowBeforeAndAfterChanged=function(t){this.Changed()},this.HandleMouseDown=function(t,i,s,o){var n=0,r=0,a=0;if(pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleMouseDown.apply(this,arguments),!this.FInteraction.FReadOnlyMode){if(this.SetFocus(),this.FMouseDown=!0,this.CaptureEx(),this.FHeader.FVisible&&o<=this.FHeader.FHeight)return 0 in this.FHeader.FArrow.FVisibility&&this.PointInRect(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(this.GetArrowRect(!0)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(s,o)))?this.PreviousDate():1 in this.FHeader.FArrow.FVisibility&&this.PointInRect(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(this.GetArrowRect(!1)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(s,o)))&&this.NextDate(),this.FInteraction.FSwipeOnHeader&&(this.FTick=e.GetTickCountX(),this.FMx=s,this.FMy=o),void this.Invalidate();if(this.FFooter.FVisible&&o>=this.GetHeight()-this.FFooter.FHeight)return this.PointInRect(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(this.GetFooterTextRect()),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(s,o)))&&2===this.FFooter.FDateCaption&&(pas.DateUtils.MonthOf(this.FDate)===pas.DateUtils.MonthOf(pas.SysUtils.Now())&&pas.DateUtils.YearOf(this.FDate)===pas.DateUtils.YearOf(pas.SysUtils.Now())||null!=this.FOnNavigateFooter&&this.FOnNavigateFooter(this),this.SetDate(pas.SysUtils.Now())),void this.Invalidate();n=this.XYToDate(s,o),r=this.FMinDate,a=this.FMaxDate,0===this.FMinDate&&(r=n),0===this.FMaxDate&&(a=n),-693594===pas.System.Int(n)||pas.System.Int(n)<pas.System.Int(r)||pas.System.Int(n)>pas.System.Int(a)||(this.FClickedDate=n,this.FFocusedDate=this.FClickedDate,this.FMouseAtDate=n,this.FInteraction.FMultiSelect?2 in i?(this.DoBeforeSelectDate(n),this.SelectDate(n),this.DoSelectDate(n)):0 in i?this.FSelectedDates.GetCount()>0&&(this.SelectMultiDates(this.FSelectedDates.GetItem$1(this.FSelectedDates.GetCount()-1).FDate,n),this.DoSelectMultiDate(this.FSelectedDates.GetItem$1(this.FSelectedDates.GetCount()-1).FDate,n)):(this.FSelectedDates.UnselectAll(),this.FSelectedDates.InCollection(n)?this.FSelectedDates.UnselectDate(n):(this.DoBeforeSelectDate(n),this.SelectDate(n),this.SetDate(n),this.DoSelectDate(n))):(this.FSelectedDates.UnselectAll(),this.FSelectedDates.InCollection(n)?this.FSelectedDates.UnselectDate(n):(this.DoBeforeSelectDate(n),this.SetDate(n),this.SelectDate(n),this.DoSelectDate(n),this.ReleaseCaptureEx())))}},this.HandleMouseUp=function(t,i,s,o){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleMouseUp.apply(this,arguments),this.FInteraction.FSwipeOnHeader&&(Math.abs(o-this.FMy)<10&&Math.abs(s-this.FMx)>20&&this.FMouseDown&&e.GetTickCountX()-this.FTick<1e3&&(s<this.FMx?this.NextDate():this.PreviousDate()),this.Invalidate()),this.FMouseDown=!1,this.ReleaseCaptureEx()},this.HandleMouseMove=function(t,e,i){var s=0;if(pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleMouseMove.apply(this,arguments),0!==this.FYOffset&&0!==this.FXOffset&&(s=this.XYToDate(e,i),this.FHoverDate!==s&&(this.FHoverDate=s,this.CancelHint(),this.Invalidate()),!this.FInteraction.FReadOnlyMode)){if(this.FHeader.FVisible){if(i<=this.FHeader.FHeight)return void(0 in this.FHeader.FArrow.FVisibility&&this.PointInRect(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(this.GetArrowRect(!0)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(e,i)))||1 in this.FHeader.FArrow.FVisibility&&this.PointInRect(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(this.GetArrowRect(!1)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(e,i)))?this.SetControlCursor(21):this.SetControlCursor(0));this.SetControlCursor(0)}if(this.FFooter.FVisible){if(i>this.GetHeight()-this.FFooter.FHeight)return void(this.PointInRect(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(this.GetFooterTextRect()),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(e,i)))&&2===this.FFooter.FDateCaption?this.SetControlCursor(21):this.SetControlCursor(0));this.SetControlCursor(0)}if(this.FInteraction.FMultiSelect&&this.FMouseDown){if(e>this.GetWidth())return;if(-693594===s)return void(this.FMouseAtDate=s);if(this.FMouseAtDate===s)return;-693594!==s&&(this.FMouseAtDate=s,this.SelectMultiDates(this.FClickedDate,this.FMouseAtDate),this.DoSelectMultiDate(this.FClickedDate,this.FMouseAtDate),this.Invalidate())}}},this.HandleKeyDown=function(t,e){var i=0,s=0;if(pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleKeyDown.apply(this,arguments),!this.FInteraction.FReadOnlyMode&&this.FInteraction.FKeyboardSupport){if(rtl.eqSet(rtl.createSet(2),e)&&this.FInteraction.FMultiSelect){var o=t.get();65!==o&&97!==o||(this.FSelectedAll?(this.FSelectedDates.UnselectAll(),this.DoBeforeSelectDate(this.FFocusedDate),this.SelectDate(this.FFocusedDate),this.DoSelectDate(this.FFocusedDate),this.FSelectedAll=!1):(i=pas.SysUtils.EncodeDate(this.FYear,this.FMonth,1),s=pas.SysUtils.EncodeDate(this.FYear,this.FMonth,pas.DateUtils.DaysInAMonth(this.FYear,this.FMonth)),0!==this.FMinDate&&this.FMinDate>=i&&this.FMinDate<=s&&(i=this.FMinDate),0!==this.FMaxDate&&this.FMaxDate<=s&&this.FMaxDate>=i&&(s=this.FMaxDate),this.SelectMultiDates(i,s),this.DoSelectMultiDate(i,s),this.FSelectedAll=!0))}else if(rtl.eqSet(rtl.createSet(0),e)&&this.FInteraction.FMultiSelect){var n=t.get();return void(37!==n&&39!==n&&38!==n&&40!==n||(this.FShiftPressed||(this.FClickedDate=this.FFocusedDate,this.DoBeforeSelectDate(this.FClickedDate),this.SelectDate(this.FClickedDate),this.DoSelectDate(this.FClickedDate),this.FShiftPressed=!0),37===t.get()?(this.SetDateBackward({p:this,get:function(){return this.p.FFocusedDate},set:function(t){this.p.FFocusedDate=t}},-1),this.SelectMultiDates(this.FClickedDate,this.FFocusedDate),this.DoSelectMultiDate(this.FClickedDate,this.FFocusedDate)):39===t.get()?(this.SetDateForward({p:this,get:function(){return this.p.FFocusedDate},set:function(t){this.p.FFocusedDate=t}},1),this.SelectMultiDates(this.FClickedDate,this.FFocusedDate),this.DoSelectMultiDate(this.FClickedDate,this.FFocusedDate)):38===t.get()?(this.SetDateBackward({p:this,get:function(){return this.p.FFocusedDate},set:function(t){this.p.FFocusedDate=t}},-7),this.SelectMultiDates(this.FClickedDate,this.FFocusedDate),this.DoSelectMultiDate(this.FClickedDate,this.FFocusedDate)):40===t.get()&&(this.SetDateForward({p:this,get:function(){return this.p.FFocusedDate},set:function(t){this.p.FFocusedDate=t}},7),this.SelectMultiDates(this.FClickedDate,this.FFocusedDate),this.DoSelectMultiDate(this.FClickedDate,this.FFocusedDate))))}var r=t.get();37===r?this.SetDateBackward({p:this,get:function(){return this.p.FFocusedDate},set:function(t){this.p.FFocusedDate=t}},-1):39===r?this.SetDateForward({p:this,get:function(){return this.p.FFocusedDate},set:function(t){this.p.FFocusedDate=t}},1):38===r?this.SetDateBackward({p:this,get:function(){return this.p.FFocusedDate},set:function(t){this.p.FFocusedDate=t}},-7):40===r?this.SetDateForward({p:this,get:function(){return this.p.FFocusedDate},set:function(t){this.p.FFocusedDate=t}},7):36===r?this.FFocusedDate=pas.SysUtils.EncodeDate(this.FYear,this.FMonth,1):35===r&&(this.FFocusedDate=pas.SysUtils.EncodeDate(this.FYear,this.FMonth,pas.DateUtils.DaysInAMonth(this.FYear,this.FMonth))),this.Invalidate()}},this.HandleKeyUp=function(t,e){if(pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleKeyUp.apply(this,arguments),!this.FInteraction.FReadOnlyMode&&this.FInteraction.FKeyboardSupport){var i=t.get();16===i?this.FShiftPressed=!1:32!==i&&13!==i||(this.DoBeforeSelectDate(this.FFocusedDate),this.FInteraction.FMultiSelect&&2 in e?this.SelectDate(this.FFocusedDate):this.SelectDateIfAvailable(this.FFocusedDate),this.DoSelectDate(this.FFocusedDate)),this.Invalidate()}},this.DoBeforeDrawHeader=function(t,e,i,s){null!=this.FOnBeforeDrawHeader&&this.FOnBeforeDrawHeader(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i,s)},this.DoAfterDrawHeader=function(t,e){null!=this.FOnAfterDrawHeader&&this.FOnAfterDrawHeader(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e))},this.DoBeforeDrawHeaderText=function(t,e,i,s,o,n,r){null!=this.FOnBeforeDrawHeaderText&&this.FOnBeforeDrawHeaderText(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i,s,o,n,r)},this.DoAfterDrawHeaderText=function(t,e,i,s,o){null!=this.FOnAfterDrawHeaderText&&this.FOnAfterDrawHeaderText(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i,s,o)},this.DoBeforeDrawFooter=function(t,e,i,s){null!=this.FOnBeforeDrawFooter&&this.FOnBeforeDrawFooter(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i,s)},this.DoAfterDrawFooter=function(t,e){null!=this.FOnAfterDrawFooter&&this.FOnAfterDrawFooter(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e))},this.DoBeforeDrawFooterText=function(t,e,i,s,o,n,r){null!=this.FOnBeforeDrawFooterText&&this.FOnBeforeDrawFooterText(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i,s,o,n,r)},this.DoAfterDrawFooterText=function(t,e,i,s,o){null!=this.FOnAfterDrawFooterText&&this.FOnAfterDrawFooterText(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i,s,o)},this.DoBeforeDrawDayNames=function(t,e,i,s){null!=this.FOnBeforeDrawDayNames&&this.FOnBeforeDrawDayNames(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i,s)},this.DoAfterDrawDayNames=function(t,e){null!=this.FOnAfterDrawDayNames&&this.FOnAfterDrawDayNames(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e))},this.DoBeforeDrawDayNamesText=function(t,e,i,s,o,n,r){null!=this.FOnBeforeDrawDayNamesText&&this.FOnBeforeDrawDayNamesText(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i,s,o,n,r)},this.DoAfterDrawDayNamesText=function(t,e,i,s,o){null!=this.FOnAfterDrawDayNamesText&&this.FOnAfterDrawDayNamesText(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i,s,o)},this.DoBeforeDrawDayNumbers=function(t,e,i,s,o){null!=this.FOnBeforeDrawDayNumbers&&this.FOnBeforeDrawDayNumbers(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i,s,o)},this.DoAfterDrawDayNumbers=function(t,e,i){null!=this.FOnAfterDrawDayNumbers&&this.FOnAfterDrawDayNumbers(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i)},this.DoBeforeDrawDayNumbersText=function(t,e,i,s,o,n,r){null!=this.FOnBeforeDrawDayNumbersText&&this.FOnBeforeDrawDayNumbersText(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i,s,o,n,r)},this.DoAfterDrawDayNumbersText=function(t,e,i,s,o){null!=this.FOnAfterDrawDayNumbersText&&this.FOnAfterDrawDayNumbersText(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i,s,o)},this.DoBeforeDrawLines=function(t,e,i){null!=this.FOnBeforeDrawLines&&this.FOnBeforeDrawLines(this,t,e,i)},this.DoAfterDrawLines=function(t){null!=this.FOnAfterDrawLines&&this.FOnAfterDrawLines(this,t)},this.DoBeforeDrawWeekNumbers=function(t,e,i,s){null!=this.FOnBeforeDrawWeekNumbers&&this.FOnBeforeDrawWeekNumbers(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i,s)},this.DoAfterDrawWeekNumbers=function(t,e){null!=this.FOnAfterDrawWeekNumbers&&this.FOnAfterDrawWeekNumbers(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e))},this.DoBeforeDrawWeekNumbersText=function(t,e,i,s,o,n,r){null!=this.FOnBeforeDrawWeekNumbersText&&this.FOnBeforeDrawWeekNumbersText(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i,s,o,n,r)},this.DoAfterDrawWeekNumbersText=function(t,e,i,s,o){null!=this.FOnAfterDrawWeekNumbersText&&this.FOnAfterDrawWeekNumbersText(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i,s,o)},this.DoBeforeDrawBadge=function(t,e,i,s,o){null!=this.FOnBeforeDrawBadge&&this.FOnBeforeDrawBadge(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i,s,o)},this.DoAfterDrawBadge=function(t,e,i){null!=this.FOnAfterDrawBadge&&this.FOnAfterDrawBadge(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i)},this.DoBeforeDrawArrowLeft=function(t,e,i,s){null!=this.FOnBeforeDrawArrowLeft&&this.FOnBeforeDrawArrowLeft(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i,s)},this.DoAfterDrawArrowLeft=function(t,e){null!=this.FOnAfterDrawArrowLeft&&this.FOnAfterDrawArrowLeft(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e))},this.DoBeforeSelectDate=function(t){null!=this.FOnBeforeSelectDate&&this.FOnBeforeSelectDate(this,t)},this.DoSelectDate=function(t){null!=this.FOnSelectDate&&this.FOnSelectDate(this,t)},this.DoSelectMultiDate=function(t,e){null!=this.FOnSelectMultiDate&&this.FOnSelectMultiDate(this,t,e)},this.DoChangeYear=function(t){null!=this.FOnYearChanged&&this.FOnYearChanged(this,t)},this.DoChangeMonth=function(t){null!=this.FOnMonthChanged&&this.FOnMonthChanged(this,t)},this.DoCustomNavigation=function(t,e,i){null!=this.FOnCustomNavigation&&this.FOnCustomNavigation(this,t,e,i)},this.DoCustomArrowDraw=function(t,e,i){null!=this.FOnCustomArrowDraw&&this.FOnCustomArrowDraw(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i)},this.IsAppearanceProperty=function(t,e,i){return pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.IsAppearanceProperty.call(this,t,e,i)||"Header"===e||"Footer"===e},this.GetVersion=function(){return this.$class.GetVersionNumber(1,0,3,1)},this.GetDocURL=function(){return pas["WEBLib.TMSFNCTypes"].TTMSFNCBaseDocURL+"tmsfncuipack/components/"+pas.SysUtils.LowerCase(this.$classname)},this.SetFonts=function(t){this.BeginUpdate(),this.FGlobalFont.ApplyChange(this.FDayNameAppearance.FFont,t),this.FGlobalFont.ApplyChange(this.FWeekNumberAppearance.FFont,t),this.FGlobalFont.ApplyChange(this.FDateAppearance.FFont,t),this.FGlobalFont.ApplyChange(this.FDateAppearance.FSelectedFont,t),1!==t&&this.FGlobalFont.ApplyChange(this.FDateAppearance.FDisabledFont,t),this.FGlobalFont.ApplyChange(this.FDateAppearance.FDateBeforeFont,t),this.FGlobalFont.ApplyChange(this.FDateAppearance.FDateAfterFont,t),this.FGlobalFont.ApplyChange(this.FDateAppearance.FBadgeFont,t),this.FGlobalFont.ApplyChange(this.FDateAppearance.FTodayFont,t),this.FGlobalFont.ApplyChange(this.FFooter.FFont,t),this.FGlobalFont.ApplyChange(this.FHeader.FFont,t),this.EndUpdate()},this.Create$1=function(e){return pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Create$1.apply(this,arguments),this.SetWidth(235),this.SetHeight(235),this.SetDate(pas.System.Int(pas.SysUtils.Now())),this.FHoverDate=-693594,this.FSelectedAll=!1,this.FBadgeSize=14,this.FFocusedDate=this.FDate,this.SetFirstDay(1),this.FHeader=t.TTMSFNCCalendarHeader.$create("Create$1",[this]),this.FFooter=t.TTMSFNCCalendarFooter.$create("Create$1"),this.FDayNameAppearance=t.TTMSFNCCalendarDayNameAppearance.$create("Create$1"),this.FDateAppearance=t.TTMSFNCCalendarDateAppearance.$create("Create$1"),this.FLineAppearance=t.TTMSFNCCalendarLineAppearance.$create("Create$1"),this.FWeekNumberAppearance=t.TTMSFNCCalendarWeekNumberAppearance.$create("Create$1"),this.FInteraction=t.TTMSFNCCalendarInteraction.$create("Create$1"),this.FSelectedDates=t.TTMSFNCCalendarDates.$create("Create$1",[t.TTMSFNCCalendarDateItem]),this.FEvents=t.TTMSFNCCalendarEvents.$create("Create$1",[t.TTMSFNCCalendarEventItem]),this.SelectDate(this.FFocusedDate),this.CalculateXOffset(),this.FEvents.FOnChange=rtl.createCallback(this,"EventsChanged"),this.FWeekNumberAppearance.FOnChange=rtl.createCallback(this,"WeekNumbersChanged"),this.FDateAppearance.FOnChange=rtl.createCallback(this,"ShowBeforeAndAfterChanged"),this.FHeader.FOnChange=rtl.createCallback(this,"HeaderChanged"),this.FHeader.FArrow.FOnChange=rtl.createCallback(this,"ArrowsChanged"),this.FFooter.FOnChange=rtl.createCallback(this,"FooterChanged"),this.FDayNameAppearance.FOnChange=rtl.createCallback(this,"DayNameAppearanceChanged"),this.FLineAppearance.FOnChange=rtl.createCallback(this,"LineAppearanceChanged"),this.FGlobalFont=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCAppearanceGlobalFont.$create("Create$1",[this]),this.IsDesignTime()&&this.InitSample(),this},this.Destroy=function(){rtl.free(this,"FGlobalFont"),rtl.free(this,"FHeader"),rtl.free(this,"FFooter"),rtl.free(this,"FDayNameAppearance"),rtl.free(this,"FDateAppearance"),rtl.free(this,"FLineAppearance"),rtl.free(this,"FWeekNumberAppearance"),rtl.free(this,"FSelectedDates"),rtl.free(this,"FEvents"),rtl.free(this,"FInteraction"),pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Destroy.call(this)},this.Assign=function(e){t.TTMSFNCCustomCalendar.isPrototypeOf(e)?(this.FDate=rtl.as(e,t.TTMSFNCCustomCalendar).FDate,this.FYear=rtl.as(e,t.TTMSFNCCustomCalendar).FYear,this.FMonth=rtl.as(e,t.TTMSFNCCustomCalendar).FMonth,this.FDay=rtl.as(e,t.TTMSFNCCustomCalendar).FDay,this.FMinDate=rtl.as(e,t.TTMSFNCCustomCalendar).FMinDate,this.FMaxDate=rtl.as(e,t.TTMSFNCCustomCalendar).FMaxDate,this.FFill.Assign(rtl.as(e,t.TTMSFNCCustomCalendar).FFill),this.FStroke.Assign(rtl.as(e,t.TTMSFNCCustomCalendar).FStroke),this.FSelectedAll=rtl.as(e,t.TTMSFNCCustomCalendar).FSelectedAll,this.FFirstDay=rtl.as(e,t.TTMSFNCCustomCalendar).FFirstDay,this.FBadgeSize=rtl.as(e,t.TTMSFNCCustomCalendar).FBadgeSize,this.FFocusedDate=rtl.as(e,t.TTMSFNCCustomCalendar).FFocusedDate,this.FXOffset=rtl.as(e,t.TTMSFNCCustomCalendar).FXOffset,this.FYOffset=rtl.as(e,t.TTMSFNCCustomCalendar).FYOffset,this.FHeader.Assign(rtl.as(e,t.TTMSFNCCustomCalendar).FHeader),this.FFooter.Assign(rtl.as(e,t.TTMSFNCCustomCalendar).FFooter),this.FDayNameAppearance.Assign(rtl.as(e,t.TTMSFNCCustomCalendar).FDayNameAppearance),this.FDateAppearance.Assign(rtl.as(e,t.TTMSFNCCustomCalendar).FDateAppearance),this.FLineAppearance.Assign(rtl.as(e,t.TTMSFNCCustomCalendar).FLineAppearance),this.FWeekNumberAppearance.Assign(rtl.as(e,t.TTMSFNCCustomCalendar).FWeekNumberAppearance),this.FInteraction.Assign(rtl.as(e,t.TTMSFNCCustomCalendar).FInteraction),this.FSelectedDates.Assign(rtl.as(e,t.TTMSFNCCustomCalendar).FSelectedDates),this.FEvents.Assign(rtl.as(e,t.TTMSFNCCustomCalendar).FEvents)):pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Assign.apply(this,arguments)},this.SelectDate=function(t){var e=0,i=0;e=this.FMinDate,i=this.FMaxDate,0===this.FMinDate&&(e=t),0===this.FMaxDate&&(i=t),pas.System.Int(t)>=pas.System.Int(e)&&pas.System.Int(t)<=pas.System.Int(i)&&(this.FSelectedDates.SelectDate(t),this.FClickedDate=t),this.Invalidate()},this.SelectMultiDates=function(t,e){var i=0,s=0;i=this.FMinDate,s=this.FMaxDate,-1===pas.DateUtils.CompareDate(t,e)?(0===this.FMinDate&&(i=t),0===this.FMaxDate&&(s=e),pas.System.Int(t)>=pas.System.Int(i)&&pas.System.Int(e)<=pas.System.Int(s)&&(this.FSelectedDates.UnselectAll(),this.FSelectedDates.SelectDateInterval(t,e))):(0===this.FMinDate&&(i=e),0===this.FMaxDate&&(s=t),pas.System.Int(e)>=pas.System.Int(i)&&pas.System.Int(t)<=pas.System.Int(s)&&(this.FSelectedDates.UnselectAll(),this.FSelectedDates.SelectDateInterval(t,e))),this.Invalidate()},this.PreviousDate=function(){var t=0,e=0,i=0,s=this.FInteraction.FNavigationMode;0===s?(this.FMonth-1<=0?(this.SetDate(pas.SysUtils.EncodeDate(this.PreviousYear(),this.PreviousMonth(),1)),this.DoChangeYear(this.FYear)):this.SetDate(pas.SysUtils.EncodeDate(this.FYear,this.PreviousMonth(),1)),this.DoChangeMonth(this.FMonth)):1===s?(this.SetDate(pas.DateUtils.IncYear(this.FDate,-1)),this.DoChangeYear(this.FYear)):2===s?(t=this.FMonth,e=this.FYear,this.SetFocusedDate(pas.DateUtils.IncDay(this.FFocusedDate,-1)),t!==pas.DateUtils.MonthOf(this.FFocusedDate)&&(this.SetDate(this.FFocusedDate),this.DoChangeMonth(this.FMonth),e!==pas.DateUtils.MonthOf(this.FFocusedDate)&&this.DoChangeYear(this.FYear))):3===s&&(i=this.FDate,this.DoCustomNavigation(this.FDate,this.FFocusedDate,!0),pas.DateUtils.MonthOf(i)!==pas.DateUtils.MonthOf(this.FDate)&&this.DoChangeMonth(this.FMonth),pas.DateUtils.YearOf(i)!==pas.DateUtils.YearOf(this.FDate)&&this.DoChangeYear(this.FYear)),null!=this.FOnNavigateBack&&this.FOnNavigateBack(this,this.FMonth,this.FYear)},this.NextDate=function(){var t=0,e=0,i=0,s=this.FInteraction.FNavigationMode;0===s?(this.FMonth+1>12?(this.SetDate(pas.SysUtils.EncodeDate(this.NextYear(),this.NextMonth(),1)),this.DoChangeYear(this.FYear)):this.SetDate(pas.SysUtils.EncodeDate(this.FYear,this.NextMonth(),1)),this.DoChangeMonth(this.FMonth)):1===s?(this.SetDate(pas.DateUtils.IncYear$1(this.FDate)),this.DoChangeYear(this.FYear)):2===s?(t=this.FMonth,e=this.FYear,this.SetFocusedDate(pas.DateUtils.IncDay$1(this.FFocusedDate)),t!==pas.DateUtils.MonthOf(this.FFocusedDate)&&(this.SetDate(this.FFocusedDate),this.DoChangeMonth(this.FMonth),e!==pas.DateUtils.YearOf(this.FFocusedDate)&&this.DoChangeYear(this.FYear))):3===s&&(i=this.FDate,this.DoCustomNavigation(this.FDate,this.FFocusedDate,!1),pas.DateUtils.MonthOf(i)!==pas.DateUtils.MonthOf(this.FDate)&&this.DoChangeMonth(this.FMonth),pas.DateUtils.YearOf(i)!==pas.DateUtils.YearOf(this.FDate)&&this.DoChangeYear(this.FYear)),null!=this.FOnNavigateForward&&this.FOnNavigateForward(this,this.FMonth,this.FYear)},this.UpdateControlAfterResize=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.UpdateControlAfterResize.call(this),null!=this.FWeekNumberAppearance&&this.CalculateXOffset()},this.SelectADate=function(t){this.FSelectedDates.UnselectAll(),this.FSelectedDates.SelectDate(t),this.SetDate(t),this.FFocusedDate=t,this.Invalidate()},this.SelectDateIfAvailable=function(t){var e=0,i=0;e=this.FMinDate,i=this.FMaxDate,0===this.FMinDate&&(e=t),0===this.FMaxDate&&(i=t),pas.System.Int(t)>=pas.System.Int(e)&&pas.System.Int(t)<=pas.System.Int(i)&&(this.FSelectedDates.UnselectAll(),this.FSelectedDates.SelectDate(t),this.SetDate(t),this.FFocusedDate=t,this.FClickedDate=t),this.Invalidate()},this.InitSample=function(){this.BeginUpdate(),this.ResetToDefaultStyle(),this.EndUpdate()},this.ColAtX=function(t){return this.FWeekNumberAppearance.FVisible?t>this.FXOffset&&t<this.GetWidth()-2&&0!==this.FXOffset?pas.System.Trunc(t/this.FXOffset):-1:t>0&&t<this.GetWidth()-2&&0!==this.FXOffset?pas.System.Trunc(t/this.FXOffset)+1:-1},this.RowAtY=function(t){var e=0,i=0;return e=this.FHeader.FVisible?this.FHeader.FHeight+this.FDayNameAppearance.FHeight:this.FDayNameAppearance.FHeight,i=this.FFooter.FVisible?this.GetHeight()-this.FFooter.FHeight:this.GetHeight(),t>e&&t<i&&0!==this.FYOffset?this.FHeader.FVisible?pas.System.Trunc((t-this.FHeader.FHeight-this.FDayNameAppearance.FHeight)/this.FYOffset)+1:pas.System.Trunc((t-this.FDayNameAppearance.FHeight)/this.FYOffset)+1:-1},this.DateToRow=function(t){var e=0;return(e=pas.SysUtils.DayOfWeek(pas.SysUtils.EncodeDate(this.FYear,this.FMonth,1))-this.FFirstDay)<0&&(e+=7),rtl.trunc((e-1+pas.DateUtils.DayOf(t))/7)},this.DateToCol=function(t){var e=0;return(e=pas.SysUtils.DayOfWeek(pas.SysUtils.EncodeDate(this.FYear,this.FMonth,1))-this.FFirstDay)<0&&(e+=7),this.FWeekNumberAppearance.FVisible?(e+pas.DateUtils.DayOf(t)+this.DateToRow(t))%8:(e+pas.DateUtils.DayOf(t)-1)%7},this.XYToDate=function(t,e){var i,s,o,n=0,r=0,a=0;return s=this.RowAtY(e),i=this.ColAtX(t),-1===s||-1===i?-693594:(a=pas.SysUtils.EncodeDate(this.FYear,this.FMonth,1),1,(n=pas.SysUtils.DayOfWeek(a)-this.FFirstDay)<0&&(n+=7),r=i-(n+=1)+1,1!==s||this.FDateAppearance.FShowDaysBefore?1===s&&this.FDateAppearance.FShowDaysBefore&&r<1?pas.DateUtils.IncDay(a,i-n):(r=7*(s-1-1)+i+(7-n+1),o=pas.DateUtils.DaysInAMonth(this.FYear,this.FMonth),a=pas.SysUtils.EncodeDate(this.FYear,this.FMonth,o),r>o&&!this.FDateAppearance.FShowDaysAfter?-693594:r>o&&this.FDateAppearance.FShowDaysAfter?pas.DateUtils.IncDay(a,r-o):pas.SysUtils.EncodeDate(this.FYear,this.FMonth,r)):r<1?-693594:pas.SysUtils.EncodeDate(this.FYear,this.FMonth,r))},this.PreviousMonth=function(){var t=0;return 0===(t=this.FMonth-1)&&(t=12),t},this.PreviousYear=function(){return this.FYear-1},this.NextMonth=function(){var t=0;return 13===(t=this.FMonth+1)&&(t=1),t},this.NextYear=function(){return this.FYear+1},this.SelectedDate=function(){return this.FSelectedDates.GetCount()>0?this.FSelectedDates.GetItem$1(this.FSelectedDates.GetCount()-1).FDate:-693594},rtl.addIntf(this,pas["WEBLib.TMSFNCGraphicsTypes"].ITMSFNCAppearanceGlobalFont),rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas["WEBLib.TMSFNCTypes"].ITMSFNCProductInfo),rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TTMSFNCCalendar",this.TTMSFNCCustomCalendar,(function(){rtl.addIntf(this,pas["WEBLib.TMSFNCGraphicsTypes"].ITMSFNCAppearanceGlobalFont),rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas["WEBLib.TMSFNCTypes"].ITMSFNCProductInfo),rtl.addIntf(this,pas.System.IUnknown);var e=this.$rtti;e.addProperty("BitmapContainer",3,pas["WEBLib.TMSFNCBitmapContainer"].$rtti.TTMSFNCBitmapContainer,"GetBitmapContainer","SetBitmapContainer"),e.addProperty("BadgeSize",2,rtl.longint,"FBadgeSize","SetBadgeSize",{Default:14}),e.addProperty("Header",2,t.$rtti.TTMSFNCCalendarHeader,"FHeader","SetHeader"),e.addProperty("Footer",2,t.$rtti.TTMSFNCCalendarFooter,"FFooter","SetFooter"),e.addProperty("Fill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FFill","SetFill"),e.addProperty("Stroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FStroke","SetStroke"),e.addProperty("Day",2,rtl.longint,"FDay","SetDay"),e.addProperty("Month",2,rtl.longint,"FMonth","SetMonth"),e.addProperty("Year",2,rtl.longint,"FYear","SetYear"),e.addProperty("Date",2,pas.System.$rtti.TDate,"FDate","SetDate"),e.addProperty("MaxDate",14,pas.System.$rtti.TDate,"FMaxDate","SetMaxDate",{stored:"IsMaxDateStored"}),e.addProperty("MinDate",14,pas.System.$rtti.TDate,"FMinDate","SetMinDate",{stored:"IsMinDateStored"}),e.addProperty("FirstDay",2,rtl.longint,"FFirstDay","SetFirstDay",{Default:1}),e.addProperty("Events",2,t.$rtti.TTMSFNCCalendarEvents,"FEvents","SetEvents"),e.addProperty("WeekNumberAppearance",2,t.$rtti.TTMSFNCCalendarWeekNumberAppearance,"FWeekNumberAppearance","SetWeekNumberAppearance"),e.addProperty("DayNameAppearance",2,t.$rtti.TTMSFNCCalendarDayNameAppearance,"FDayNameAppearance","SetDayNameAppearance"),e.addProperty("DateAppearance",2,t.$rtti.TTMSFNCCalendarDateAppearance,"FDateAppearance","SetDateAppearance"),e.addProperty("LineAppearance",2,t.$rtti.TTMSFNCCalendarLineAppearance,"FLineAppearance","SetLineAppearance"),e.addProperty("Interaction",2,t.$rtti.TTMSFNCCalendarInteraction,"FInteraction","SetInteraction"),e.addProperty("GlobalFont",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCAppearanceGlobalFont,"FGlobalFont","SetGlobalFont"),e.addProperty("OnBeforeDrawHeader",0,t.$rtti.TTMSFNCCalendarBeforeDrawHeaderEvent,"FOnBeforeDrawHeader","FOnBeforeDrawHeader"),e.addProperty("OnAfterDrawHeader",0,t.$rtti.TTMSFNCCalendarAfterDrawHeaderEvent,"FOnAfterDrawHeader","FOnAfterDrawHeader"),e.addProperty("OnBeforeDrawFooter",0,t.$rtti.TTMSFNCCalendarBeforeDrawFooterEvent,"FOnBeforeDrawFooter","FOnBeforeDrawFooter"),e.addProperty("OnAfterDrawFooter",0,t.$rtti.TTMSFNCCalendarAfterDrawFooterEvent,"FOnAfterDrawFooter","FOnAfterDrawFooter"),e.addProperty("OnBeforeDrawDayNames",0,t.$rtti.TTMSFNCCalendarBeforeDrawDayNamesEvent,"FOnBeforeDrawDayNames","FOnBeforeDrawDayNames"),e.addProperty("OnAfterDrawDayNames",0,t.$rtti.TTMSFNCCalendarAfterDrawDayNamesEvent,"FOnAfterDrawDayNames","FOnAfterDrawDayNames"),e.addProperty("OnBeforeDrawDayNumbers",0,t.$rtti.TTMSFNCCalendarBeforeDrawDayNumbersEvent,"FOnBeforeDrawDayNumbers","FOnBeforeDrawDayNumbers"),e.addProperty("OnAfterDrawDayNumbers",0,t.$rtti.TTMSFNCCalendarAfterDrawDayNumbersEvent,"FOnAfterDrawDayNumbers","FOnAfterDrawDayNumbers"),e.addProperty("OnBeforeDrawLines",0,t.$rtti.TTMSFNCCalendarBeforeDrawLinesEvent,"FOnBeforeDrawLines","FOnBeforeDrawLines"),e.addProperty("OnAfterDrawLines",0,t.$rtti.TTMSFNCCalendarAfterDrawLinesEvent,"FOnAfterDrawLines","FOnAfterDrawLines"),e.addProperty("OnBeforeDrawWeekNumbers",0,t.$rtti.TTMSFNCCalendarBeforeDrawWeekNumbersEvent,"FOnBeforeDrawWeekNumbers","FOnBeforeDrawWeekNumbers"),e.addProperty("OnAfterDrawWeekNumbers",0,t.$rtti.TTMSFNCCalendarAfterDrawWeekNumbersEvent,"FOnAfterDrawWeekNumbers","FOnAfterDrawWeekNumbers"),e.addProperty("OnBeforeDrawArrowLeft",0,t.$rtti.TTMSFNCCalendarBeforeDrawArrowLeftEvent,"FOnBeforeDrawArrowLeft","FOnBeforeDrawArrowLeft"),e.addProperty("OnAfterDrawArrowLeft",0,t.$rtti.TTMSFNCCalendarAfterDrawArrowLeftEvent,"FOnAfterDrawArrowLeft","FOnAfterDrawArrowLeft"),e.addProperty("OnBeforeDrawArrowRight",0,t.$rtti.TTMSFNCCalendarBeforeDrawArrowRightEvent,"FOnBeforeDrawArrowRight","FOnBeforeDrawArrowRight"),e.addProperty("OnAfterDrawArrowRight",0,t.$rtti.TTMSFNCCalendarAfterDrawArrowRightEvent,"FOnAfterDrawArrowRight","FOnAfterDrawArrowRight"),e.addProperty("OnBeforeDrawBadge",0,t.$rtti.TTMSFNCCalendarBeforeDrawBadgeEvent,"FOnBeforeDrawBadge","FOnBeforeDrawBadge"),e.addProperty("OnAfterDrawBadge",0,t.$rtti.TTMSFNCCalendarAfterDrawBadgeEvent,"FOnAfterDrawBadge","FOnAfterDrawBadge"),e.addProperty("OnBeforeDrawHeaderText",0,t.$rtti.TTMSFNCCalendarBeforeDrawHeaderTextEvent,"FOnBeforeDrawHeaderText","FOnBeforeDrawHeaderText"),e.addProperty("OnAfterDrawHeaderText",0,t.$rtti.TTMSFNCCalendarAfterDrawHeaderTextEvent,"FOnAfterDrawHeaderText","FOnAfterDrawHeaderText"),e.addProperty("OnBeforeDrawFooterText",0,t.$rtti.TTMSFNCCalendarBeforeDrawFooterTextEvent,"FOnBeforeDrawFooterText","FOnBeforeDrawFooterText"),e.addProperty("OnAfterDrawFooterText",0,t.$rtti.TTMSFNCCalendarAfterDrawFooterTextEvent,"FOnAfterDrawFooterText","FOnAfterDrawFooterText"),e.addProperty("OnBeforeDrawDayNamesText",0,t.$rtti.TTMSFNCCalendarBeforeDrawDayNamesTextEvent,"FOnBeforeDrawDayNamesText","FOnBeforeDrawDayNamesText"),e.addProperty("OnAfterDrawDayNamesText",0,t.$rtti.TTMSFNCCalendarAfterDrawDayNamesTextEvent,"FOnAfterDrawDayNamesText","FOnAfterDrawDayNamesText"),e.addProperty("OnBeforeDrawDayNumbersText",0,t.$rtti.TTMSFNCCalendarBeforeDrawDayNumbersTextEvent,"FOnBeforeDrawDayNumbersText","FOnBeforeDrawDayNumbersText"),e.addProperty("OnAfterDrawDayNumbersText",0,t.$rtti.TTMSFNCCalendarAfterDrawDayNumbersTextEvent,"FOnAfterDrawDayNumbersText","FOnAfterDrawDayNumbersText"),e.addProperty("OnBeforeDrawWeekNumbersText",0,t.$rtti.TTMSFNCCalendarBeforeDrawWeekNumbersTextEvent,"FOnBeforeDrawWeekNumbersText","FOnBeforeDrawWeekNumbersText"),e.addProperty("OnAfterDrawWeekNumbersText",0,t.$rtti.TTMSFNCCalendarAfterDrawWeekNumbersTextEvent,"FOnAfterDrawWeekNumbersText","FOnAfterDrawWeekNumbersText"),e.addProperty("OnBeforeSelectDate",0,t.$rtti.TTMSFNCCalendarBeforeSelectDateEvent,"FOnBeforeSelectDate","FOnBeforeSelectDate"),e.addProperty("OnSelectDate",0,t.$rtti.TTMSFNCCalendarSelectedDateEvent,"FOnSelectDate","FOnSelectDate"),e.addProperty("OnSelectMultiDate",0,t.$rtti.TTMSFNCCalendarSelectedMultiDateEvent,"FOnSelectMultiDate","FOnSelectMultiDate"),e.addProperty("OnYearChanged",0,t.$rtti.TTMSFNCCalendarYearChangedEvent,"FOnYearChanged","FOnYearChanged"),e.addProperty("OnMonthChanged",0,t.$rtti.TTMSFNCCalendarMonthChangedEvent,"FOnMonthChanged","FOnMonthChanged"),e.addProperty("OnCustomNavigation",0,t.$rtti.TTMSFNCCalendarCustomNavigationEvent,"FOnCustomNavigation","FOnCustomNavigation"),e.addProperty("OnCustomArrowDraw",0,t.$rtti.TTMSFNCCalendarCustomArrowDrawEvent,"FOnCustomArrowDraw","FOnCustomArrowDraw"),e.addProperty("OnNavigateBack",0,t.$rtti.TTMSFNCCalendarCustomNavigateEvent,"FOnNavigateBack","FOnNavigateBack"),e.addProperty("OnNavigateForward",0,t.$rtti.TTMSFNCCalendarCustomNavigateEvent,"FOnNavigateForward","FOnNavigateForward"),e.addProperty("OnNavigateFooter",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnNavigateFooter","FOnNavigateFooter"),e.attr=[pas.Classes.ComponentPlatformsAttribute,"Create$1",[0]]})),t.$implcode=function(){e.CALMINDATE=-693594,e.ARRPOS=8,e.GetTickCountX=function(){var t=0,e=0,i=0,s=0;return pas.SysUtils.DecodeTime(pas.SysUtils.Now(),{get:function(){return t},set:function(e){t=e}},{get:function(){return e},set:function(t){e=t}},{get:function(){return i},set:function(t){i=t}},{get:function(){return s},set:function(t){s=t}}),s+1e3*i+60*e*1e3+60*t*60*1e3}}}),["Math","DateUtils","WEBLib.TMSFNCPersistence"]),rtl.module("WEBLib.TMSFNCDatePicker",["System","Classes","WEBLib.TMSFNCCustomPicker","WEBLib.Controls","WEBLib.TMSFNCCustomSelector","WEBLib.TMSFNCGraphics","WEBLib.TMSFNCTypes","WEBLib.StdCtrls","WEBLib.TMSFNCGraphicsTypes","WEBLib.TMSFNCCalendar","WEBLib.TMSFNCBitmapContainer","WEBLib.TMSFNCStyles","WEBLib.TMSFNCUtils","Types","TypInfo"],(function(){"use strict";var t=this,e=t.$impl;this.MAJ_VER=1,this.MIN_VER=0,this.REL_VER=2,this.BLD_VER=1,this.$rtti.$MethodVar("TTMSFNCCustomDatePickerDateSelected",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ADate",pas.System.$rtti.TDate]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCCustomDatePickerValidateEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AEditText",rtl.string],["ADate",pas.System.$rtti.TDateTime,1],["ADefault",rtl.boolean,1]]),methodkind:0}),rtl.createClass(this,"TTMSFNCDatePickerInteraction",pas["WEBLib.TMSFNCCalendar"].TTMSFNCCalendarCustomInteraction,(function(){var t=this.$rtti;t.addProperty("ReadOnlyMode",2,rtl.boolean,"FReadOnlyMode","SetReadOnlyMode",{Default:!1}),t.addProperty("SwipeOnHeader",2,rtl.boolean,"FSwipeOnHeader","SetSwipeOnHeader",{Default:!1}),t.addProperty("KeyboardSupport",2,rtl.boolean,"FKeyboardSupport","SetKeyboardSupport",{Default:!0}),t.addProperty("NavigationMode",2,pas["WEBLib.TMSFNCCalendar"].$rtti.TTMSFNCCalendarNavigationMode,"FNavigationMode","SetNavigationMode",{Default:pas["WEBLib.TMSFNCCalendar"].TTMSFNCCalendarNavigationMode.nmMonth})})),rtl.createClass(this,"TTMSFNCCustomDatePicker",pas["WEBLib.TMSFNCCustomPicker"].TTMSFNCDefaultPicker,(function(){this.$init=function(){pas["WEBLib.TMSFNCCustomPicker"].TTMSFNCDefaultPicker.$init.call(this),this.FPrevSelDate=0,this.FWrapper=null,this.FDateSelector=null,this.FOnDateSelected=null,this.FCloseOnSelection=!1,this.FOnCustomize=null,this.FHeader=null,this.FInteraction=null,this.FOnAfterDrawBadge=null,this.FOnAfterDrawArrowRight=null,this.FOnAfterDrawDayNamesText=null,this.FOnAfterDrawWeekNumbersText=null,this.FOnBeforeDrawHeader=null,this.FOnBeforeDrawDayNumbersText=null,this.FOnBeforeDrawFooterText=null,this.FOnBeforeDrawLines=null,this.FOnAfterDrawDayNames=null,this.FOnAfterDrawWeekNumbers=null,this.FOnAfterDrawHeaderText=null,this.FOnBeforeDrawArrowLeft=null,this.FOnBeforeDrawDayNumbers=null,this.FOnBeforeDrawFooter=null,this.FOnBeforeDrawBadge=null,this.FOnAfterDrawHeader=null,this.FOnBeforeDrawArrowRight=null,this.FOnAfterDrawDayNumbersText=null,this.FOnBeforeDrawDayNamesText=null,this.FOnBeforeDrawWeekNumbersText=null,this.FOnAfterDrawFooterText=null,this.FOnAfterDrawLines=null,this.FOnAfterDrawArrowLeft=null,this.FOnAfterDrawDayNumbers=null,this.FOnBeforeDrawDayNames=null,this.FOnBeforeDrawWeekNumbers=null,this.FOnAfterDrawFooter=null,this.FOnBeforeDrawHeaderText=null,this.FOnYearChanged=null,this.FOnCustomArrowDraw=null,this.FOnMonthChanged=null,this.FOnSelectMultiDate=null,this.FOnBeforeSelectDate=null,this.FOnCustomNavigation=null,this.FAllowNumericNullValue=!1,this.FFont$2=null,this.FOnValidate=null},this.$final=function(){this.FWrapper=void 0,this.FDateSelector=void 0,this.FOnDateSelected=void 0,this.FOnCustomize=void 0,this.FHeader=void 0,this.FInteraction=void 0,this.FOnAfterDrawBadge=void 0,this.FOnAfterDrawArrowRight=void 0,this.FOnAfterDrawDayNamesText=void 0,this.FOnAfterDrawWeekNumbersText=void 0,this.FOnBeforeDrawHeader=void 0,this.FOnBeforeDrawDayNumbersText=void 0,this.FOnBeforeDrawFooterText=void 0,this.FOnBeforeDrawLines=void 0,this.FOnAfterDrawDayNames=void 0,this.FOnAfterDrawWeekNumbers=void 0,this.FOnAfterDrawHeaderText=void 0,this.FOnBeforeDrawArrowLeft=void 0,this.FOnBeforeDrawDayNumbers=void 0,this.FOnBeforeDrawFooter=void 0,this.FOnBeforeDrawBadge=void 0,this.FOnAfterDrawHeader=void 0,this.FOnBeforeDrawArrowRight=void 0,this.FOnAfterDrawDayNumbersText=void 0,this.FOnBeforeDrawDayNamesText=void 0,this.FOnBeforeDrawWeekNumbersText=void 0,this.FOnAfterDrawFooterText=void 0,this.FOnAfterDrawLines=void 0,this.FOnAfterDrawArrowLeft=void 0,this.FOnAfterDrawDayNumbers=void 0,this.FOnBeforeDrawDayNames=void 0,this.FOnBeforeDrawWeekNumbers=void 0,this.FOnAfterDrawFooter=void 0,this.FOnBeforeDrawHeaderText=void 0,this.FOnYearChanged=void 0,this.FOnCustomArrowDraw=void 0,this.FOnMonthChanged=void 0,this.FOnSelectMultiDate=void 0,this.FOnBeforeSelectDate=void 0,this.FOnCustomNavigation=void 0,this.FFont$2=void 0,this.FOnValidate=void 0,pas["WEBLib.TMSFNCCustomPicker"].TTMSFNCDefaultPicker.$final.call(this)},this.SetSelectedDate=function(t){this.FAllowNumericNullValue&&0===pas.System.Int(t)?this.SetContent(""):this.SetContent(pas.SysUtils.DateToStr(t)),this.FPrevSelDate=t,this.Invalidate()},this.SetEvents=function(t){this.FDateSelector.FEvents.Assign(t)},this.SetWeekNumberAppearance=function(t){this.FDateSelector.FWeekNumberAppearance.Assign(t)},this.SetDateAppearance=function(t){this.FDateSelector.FDateAppearance.Assign(t)},this.SetDayNameAppearance=function(t){this.FDateSelector.FDayNameAppearance.Assign(t)},this.SetLineAppearance=function(t){this.FDateSelector.FLineAppearance.Assign(t)},this.SetInteraction=function(t){this.FInteraction.Assign(t)},this.SetMaxDate=function(t){this.FDateSelector.SetMaxDate(t),1===pas.DateUtils.CompareDate(this.GetSelectedDate(),t)&&this.SetSelectedDate(t)},this.SetMinDate=function(t){this.FDateSelector.SetMinDate(t),-1===pas.DateUtils.CompareDate(this.GetSelectedDate(),t)&&this.SetSelectedDate(t)},this.SetFirstDay=function(t){this.FDateSelector.SetFirstDay(t)},this.SetHeader=function(t){this.FHeader.Assign(t)},this.SetFooter=function(t){this.FDateSelector.FFooter.Assign(t)},this.SetCalendarFill=function(t){this.FDateSelector.FFill.Assign(t)},this.SetCalendarStroke=function(t){this.FDateSelector.FStroke.Assign(t)},this.SetBitmapContainer=function(t){this.FDateSelector.SetBitmapContainer(t)},this.SetBadgeSize=function(t){this.FDateSelector.SetBadgeSize(t)},this.SetAllowNumericNullValue=function(t){this.FAllowNumericNullValue!==t&&(this.FAllowNumericNullValue=t,this.FAllowNumericNullValue&&0===pas.System.Int(this.GetSelectedDate())?this.SetContent(""):this.SetContent(pas.SysUtils.DateToStr(this.GetSelectedDate()))),this.Invalidate()},this.GetSelectedDate=function(){var t=0;return t=0,this.FDateSelector.FSelectedDates.GetCount()>0&&(t=this.FDateSelector.SelectedDate()),t},this.GetEvents=function(){return this.FDateSelector.FEvents},this.GetWeekNumberAppearance=function(){return this.FDateSelector.FWeekNumberAppearance},this.GetDateAppearance=function(){return this.FDateSelector.FDateAppearance},this.GetDayNameAppearance=function(){return this.FDateSelector.FDayNameAppearance},this.GetLineAppearance=function(){return this.FDateSelector.FLineAppearance},this.GetMaxDate=function(){return this.FDateSelector.FMaxDate},this.GetMinDate=function(){return this.FDateSelector.FMinDate},this.GetFirstDay=function(){return this.FDateSelector.FFirstDay},this.GetFooter=function(){return this.FDateSelector.FFooter},this.GetCalendarFill=function(){return this.FDateSelector.FFill},this.GetCalendarStroke=function(){return this.FDateSelector.FStroke},this.GetBitmapContainer=function(){return this.FDateSelector.GetBitmapContainer()},this.GetBadgeSize=function(){return this.FDateSelector.FBadgeSize},this.SetFnt$1=function(t){this.FFont$2.AssignSource(t)},this.DoDateSelected=function(){0 in this.FComponentState||(null!=this.FOnDateSelected&&this.FOnDateSelected(this,this.GetSelectedDate()),this.Invalidate())},this.DoValidate=function(){var t=0,e=!1;e=!0,t=this.GetSelectedDate(),null!=this.FOnValidate&&this.FOnValidate(this,this.FEdit.GetText(),{get:function(){return t},set:function(e){t=e}},{get:function(){return e},set:function(t){e=t}}),e?pas.SysUtils.TryStrToDate(this.FEdit.GetText(),{get:function(){return t},set:function(e){t=e}})?this.SetSelectedDate(pas.System.Int(t)):this.SetSelectedDate(pas.System.Int(pas.SysUtils.Now())):this.SetSelectedDate(pas.System.Int(t))},this.DoEditExit=function(t){this.DoValidate(),pas["WEBLib.TMSFNCCustomPicker"].TTMSFNCCustomPicker.DoEditExit.apply(this,arguments)},this.Loaded=function(){pas["WEBLib.Controls"].TCustomControl.Loaded.call(this),null!=this.FDateSelector&&(this.FDateSelector.SetWidth(Math.round(this.FDropDownWidth)),this.FDateSelector.SetHeight(Math.round(this.FDropDownHeight)),this.FDateSelector.UpdateControlAfterResize())},this.FontChange=function(t){this.Invalidate()},this.InitializePopup=function(){pas["WEBLib.TMSFNCCustomPicker"].TTMSFNCCustomPicker.InitializePopup.call(this),this.FAllowNumericNullValue&&0===pas.System.Int(this.GetSelectedDate())?this.FDateSelector.SetDate(pas.System.Int(pas.SysUtils.Now())):this.FEditable&&null!=this.FEdit.FParent&&this.FEdit.FVisible&&this.DoValidate(),this.FWrapper.FFill.Assign(this.FDateSelector.FFill),this.FWrapper.FStroke.Assign(this.FDateSelector.FStroke),this.FDateSelector.SetWidth(Math.round(this.FDropDownWidth)),this.FDateSelector.SetHeight(Math.round(this.FDropDownHeight)),this.FDateSelector.FHeader.Assign(this.FHeader),this.FDateSelector.FInteraction.Assign(this.FInteraction),this.FDateSelector.Invalidate()},this.ApplyStyle=function(){var t=0;pas["WEBLib.TMSFNCCustomPicker"].TTMSFNCCustomPicker.ApplyStyle.call(this),t=-1,pas["WEBLib.TMSFNCStyles"].TTMSFNCStyles.GetStyleHeaderFillColor({get:function(){return t},set:function(e){t=e}})&&this.FHeader.FFill.SetColor(t),t=-1,pas["WEBLib.TMSFNCStyles"].TTMSFNCStyles.GetStyleHeaderFillColorTo({get:function(){return t},set:function(e){t=e}})&&(this.FHeader.FFill.SetKind(2),this.FHeader.FFill.SetColorTo(t)),t=-1,pas["WEBLib.TMSFNCStyles"].TTMSFNCStyles.GetStyleLineFillColor({get:function(){return t},set:function(e){t=e}})&&(this.FHeader.FStroke.SetColor(t),this.FHeader.FArrow.SetColor(t))},this.ResetToDefaultStyle=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.ResetToDefaultStyle.call(this),this.FHeader.FFill.SetKind(1),this.FHeader.FStroke.SetKind(1),this.FHeader.FFill.SetColor(pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(228,228,228)),this.FHeader.FStroke.SetColor(12632256),this.FHeader.FFont.SetColor(0),this.FHeader.FArrow.SetColor(6908265)},this.SetAdaptToStyle=function(t){pas["WEBLib.TMSFNCCustomPicker"].TTMSFNCCustomPicker.SetAdaptToStyle.apply(this,arguments),null!=this.FWrapper&&this.FWrapper.SetAdaptToStyle(this.GetAdaptToStyle()),null!=this.FDateSelector&&this.FDateSelector.SetAdaptToStyle(this.GetAdaptToStyle())},this.DrawContent=function(t,e){var i=pas["WEBLib.TMSFNCTypes"].TRectF.$new();pas["WEBLib.TMSFNCCustomPicker"].TTMSFNCCustomPicker.DrawContent.apply(this,arguments),this.FEditable||(t.FFont.AssignSource(this.FFont$2),this.FEnabled||t.FFont.SetColor(12632256),i.$assign(e),pas["WEBLib.TMSFNCTypes"].InflateRectEx(i,-3,-3),t.DrawText$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),this.GetContent(),!1,1,0,0,0,-1,-1,!0,!1,-1,-1))},this.SelectFirstValue=function(){var t;pas["WEBLib.TMSFNCCustomPicker"].TTMSFNCCustomPicker.SelectFirstValue.call(this),t=pas.SysUtils.EncodeDate(this.FDateSelector.FYear,this.FDateSelector.FMonth,1),pas.System.Int(this.GetMinDate())<pas.System.Int(t)&&0!==pas.DateUtils.CompareDate(this.GetSelectedDate(),t)?(this.SetSelectedDate(t),this.DoDateSelected()):0!==pas.DateUtils.CompareDate(this.GetSelectedDate(),this.GetMinDate())&&0!==pas.DateUtils.CompareDate(this.GetSelectedDate(),t)&&(this.SetSelectedDate(this.GetMinDate()),this.DoDateSelected())},this.SelectLastValue=function(){var t,e;pas["WEBLib.TMSFNCCustomPicker"].TTMSFNCCustomPicker.SelectLastValue.call(this),e=pas.DateUtils.DaysInAMonth(this.FDateSelector.FYear,this.FDateSelector.FMonth),t=pas.SysUtils.EncodeDate(this.FDateSelector.FYear,this.FDateSelector.FMonth,e),0!==this.GetMaxDate()&&pas.System.Int(this.GetMaxDate())>pas.System.Int(t)||0===this.GetMaxDate()?0!==pas.DateUtils.CompareDate(this.GetSelectedDate(),t)&&(this.SetSelectedDate(t),this.DoDateSelected()):0!==pas.DateUtils.CompareDate(this.GetSelectedDate(),this.GetMaxDate())&&0!==pas.DateUtils.CompareDate(this.GetSelectedDate(),t)&&(this.SetSelectedDate(this.GetMaxDate()),this.DoDateSelected())},this.SelectNextValue=function(){var t;pas["WEBLib.TMSFNCCustomPicker"].TTMSFNCCustomPicker.SelectNextValue.call(this),t=pas.DateUtils.IncDay(this.FDateSelector.FDate,1),pas.System.Int(this.GetMaxDate()+1)!==pas.System.Int(t)&&(this.SetSelectedDate(pas.DateUtils.IncDay(this.FDateSelector.FDate,1)),this.DoDateSelected())},this.SelectPreviousValue=function(){var t;pas["WEBLib.TMSFNCCustomPicker"].TTMSFNCCustomPicker.SelectPreviousValue.call(this),t=pas.DateUtils.IncDay(this.FDateSelector.FDate,-1),pas.System.Int(this.GetMinDate())-1!==pas.System.Int(t)&&(this.SetSelectedDate(t),this.DoDateSelected())},this.EditUp=function(){pas["WEBLib.TMSFNCCustomPicker"].TTMSFNCCustomPicker.EditUp.call(this),this.GetPopup().FIsOpen&&this.DropDown()},this.EditDown=function(){pas["WEBLib.TMSFNCCustomPicker"].TTMSFNCCustomPicker.EditDown.call(this),this.GetPopup().FIsOpen||this.DropDown()},this.HandleKeyDown=function(t,e){pas["WEBLib.TMSFNCCustomPicker"].TTMSFNCCustomPicker.HandleKeyDown.apply(this,arguments);var i=t.get();33===i?1!==this.FDateSelector.FMonth?this.SetSelectedDate(pas.SysUtils.EncodeDate(this.FDateSelector.FYear,this.FDateSelector.PreviousMonth(),1)):this.SetSelectedDate(pas.SysUtils.EncodeDate(this.FDateSelector.PreviousYear(),this.FDateSelector.PreviousMonth(),1)):34===i&&(12!==this.FDateSelector.FMonth?this.SetSelectedDate(pas.SysUtils.EncodeDate(this.FDateSelector.FYear,this.FDateSelector.NextMonth(),1)):this.SetSelectedDate(pas.SysUtils.EncodeDate(this.FDateSelector.NextYear(),this.FDateSelector.NextMonth(),1)))},this.SetEditable=function(t){pas["WEBLib.TMSFNCCustomPicker"].TTMSFNCCustomPicker.SetEditable.apply(this,arguments),this.FAllowNumericNullValue&&0===pas.System.Int(this.FPrevSelDate)?this.SetContent(""):this.SetContent(pas.SysUtils.DateToStr(this.FPrevSelDate)),this.Invalidate()},this.UpdateEditText=function(t){var e=0;pas["WEBLib.TMSFNCCustomPicker"].TTMSFNCCustomPicker.UpdateEditText.apply(this,arguments),""===t?0===pas.System.Int(this.FPrevSelDate)&&(this.FDateSelector.SelectADate(0),this.DoDateSelected()):pas.SysUtils.TryStrToDate(t,{get:function(){return e},set:function(t){e=t}})&&pas.System.Int(e)!==pas.System.Int(this.GetSelectedDate())&&pas.System.Int(e)>=pas.System.Int(this.GetMinDate())&&(pas.System.Int(e)<=pas.System.Int(this.GetMaxDate())&&0!==this.GetMaxDate()||0===this.GetMaxDate())&&(this.FDateSelector.SelectADate(pas.System.Int(e)),this.DoDateSelected())},this.DateSelected=function(t,e){this.FEditable&&this.FEdit.IsFocused()&&(this.FPreventDropDown=!0),this.FCloseOnSelection&&this.DropDown(),this.SetSelectedDate(this.FDateSelector.SelectedDate()),this.DoDateSelected()},this.DoBeforeDrawHeader=function(t,e,i,s,o){null!=this.FOnBeforeDrawHeader&&this.FOnBeforeDrawHeader(this,e,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),s,o)},this.DoAfterDrawHeader=function(t,e,i){null!=this.FOnAfterDrawHeader&&this.FOnAfterDrawHeader(this,e,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i))},this.DoBeforeDrawHeaderText=function(t,e,i,s,o,n,r,a){null!=this.FOnBeforeDrawHeaderText&&this.FOnBeforeDrawHeaderText(this,e,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),s,o,n,r,a)},this.DoAfterDrawHeaderText=function(t,e,i,s,o,n){null!=this.FOnAfterDrawHeaderText&&this.FOnAfterDrawHeaderText(this,e,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),s,o,n)},this.DoBeforeDrawFooter=function(t,e,i,s,o){null!=this.FOnBeforeDrawFooter&&this.FOnBeforeDrawFooter(this,e,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),s,o)},this.DoAfterDrawFooter=function(t,e,i){null!=this.FOnAfterDrawFooter&&this.FOnAfterDrawFooter(this,e,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i))},this.DoBeforeDrawFooterText=function(t,e,i,s,o,n,r,a){null!=this.FOnBeforeDrawFooterText&&this.FOnBeforeDrawFooterText(this,e,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),s,o,n,r,a)},this.DoAfterDrawFooterText=function(t,e,i,s,o,n){null!=this.FOnAfterDrawFooterText&&this.FOnAfterDrawFooterText(this,e,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),s,o,n)},this.DoBeforeDrawDayNames=function(t,e,i,s,o){null!=this.FOnBeforeDrawDayNames&&this.FOnBeforeDrawDayNames(this,e,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),s,o)},this.DoAfterDrawDayNames=function(t,e,i){null!=this.FOnAfterDrawDayNames&&this.FOnAfterDrawDayNames(this,e,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i))},this.DoBeforeDrawDayNamesText=function(t,e,i,s,o,n,r,a){null!=this.FOnBeforeDrawDayNamesText&&this.FOnBeforeDrawDayNamesText(this,e,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),s,o,n,r,a)},this.DoAfterDrawDayNamesText=function(t,e,i,s,o,n){null!=this.FOnAfterDrawDayNamesText&&this.FOnAfterDrawDayNamesText(this,e,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),s,o,n)},this.DoBeforeDrawDayNumbers=function(t,e,i,s,o,n){null!=this.FOnBeforeDrawDayNumbers&&this.FOnBeforeDrawDayNumbers(this,e,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),s,o,n)},this.DoAfterDrawDayNumbers=function(t,e,i,s){null!=this.FOnAfterDrawDayNumbers&&this.FOnAfterDrawDayNumbers(this,e,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),s)},this.DoBeforeDrawDayNumbersText=function(t,e,i,s,o,n,r,a){null!=this.FOnBeforeDrawDayNumbersText&&this.FOnBeforeDrawDayNumbersText(this,e,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),s,o,n,r,a)},this.DoAfterDrawDayNumbersText=function(t,e,i,s,o,n){null!=this.FOnAfterDrawDayNumbersText&&this.FOnAfterDrawDayNumbersText(this,e,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),s,o,n)},this.DoBeforeDrawLines=function(t,e,i,s){null!=this.FOnBeforeDrawLines&&this.FOnBeforeDrawLines(this,e,i,s)},this.DoAfterDrawLines=function(t,e){null!=this.FOnAfterDrawLines&&this.FOnAfterDrawLines(this,e)},this.DoBeforeDrawWeekNumbers=function(t,e,i,s,o){null!=this.FOnBeforeDrawWeekNumbers&&this.FOnBeforeDrawWeekNumbers(this,e,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),s,o)},this.DoAfterDrawWeekNumbers=function(t,e,i){null!=this.FOnAfterDrawWeekNumbers&&this.FOnAfterDrawWeekNumbers(this,e,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i))},this.DoBeforeDrawWeekNumbersText=function(t,e,i,s,o,n,r,a){null!=this.FOnBeforeDrawWeekNumbersText&&this.FOnBeforeDrawWeekNumbersText(this,e,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),s,o,n,r,a)},this.DoAfterDrawWeekNumbersText=function(t,e,i,s,o,n){null!=this.FOnAfterDrawWeekNumbersText&&this.FOnAfterDrawWeekNumbersText(this,e,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),s,o,n)},this.DoBeforeDrawBadge=function(t,e,i,s,o,n){null!=this.FOnBeforeDrawBadge&&this.FOnBeforeDrawBadge(this,e,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),s,o,n)},this.DoAfterDrawBadge=function(t,e,i,s){null!=this.FOnAfterDrawBadge&&this.FOnAfterDrawBadge(this,e,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),s)},this.DoBeforeDrawArrowLeft=function(t,e,i,s,o){null!=this.FOnBeforeDrawArrowLeft&&this.FOnBeforeDrawArrowLeft(this,e,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),s,o)},this.DoAfterDrawArrowLeft=function(t,e,i){null!=this.FOnAfterDrawArrowLeft&&this.FOnAfterDrawArrowLeft(this,e,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i))},this.DoBeforeDrawArrowRight=function(t,e,i,s,o){null!=this.FOnBeforeDrawArrowRight&&this.FOnBeforeDrawArrowRight(this,e,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),s,o)},this.DoAfterDrawArrowRight=function(t,e,i){null!=this.FOnAfterDrawArrowRight&&this.FOnAfterDrawArrowRight(this,e,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i))},this.DoBeforeSelectDate=function(t,e){null!=this.FOnBeforeSelectDate&&this.FOnBeforeSelectDate(this,e)},this.DoSelectMultiDate=function(t,e,i){null!=this.FOnSelectMultiDate&&this.FOnSelectMultiDate(this,e,i)},this.DoChangeYear=function(t,e){null!=this.FOnYearChanged&&this.FOnYearChanged(this,e)},this.DoChangeMonth=function(t,e){null!=this.FOnMonthChanged&&this.FOnMonthChanged(this,e)},this.DoCustomNavigation=function(t,e,i,s){null!=this.FOnCustomNavigation&&this.FOnCustomNavigation(this,e,i,s)},this.DoCustomArrowDraw=function(t,e,i,s){null!=this.FOnCustomArrowDraw&&this.FOnCustomArrowDraw(this,e,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),s)},this.IsAppearanceProperty=function(t,e,i){return pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.IsAppearanceProperty.call(this,t,e,i)||"Header"===e||"Footer"===e},this.GetVersion=function(){return this.$class.GetVersionNumber(1,0,2,1)},this.CreateSelector=function(){return this.FWrapper=pas["WEBLib.TMSFNCCustomSelector"].TTMSFNCCustomSelector.$create("Create$1",[this]),this.FDateSelector=pas["WEBLib.TMSFNCCalendar"].TTMSFNCCalendar.$create("Create$1",[this.FWrapper]),this.FDateSelector.SetParent(this.FWrapper),this.FDateSelector.FOnSelectDate=rtl.createCallback(this,"DateSelected"),this.FDateSelector.FOnBeforeDrawHeader=rtl.createCallback(this,"DoBeforeDrawHeader"),this.FDateSelector.FOnAfterDrawHeader=rtl.createCallback(this,"DoAfterDrawHeader"),this.FDateSelector.FOnBeforeDrawFooter=rtl.createCallback(this,"DoBeforeDrawFooter"),this.FDateSelector.FOnAfterDrawFooter=rtl.createCallback(this,"DoAfterDrawFooter"),this.FDateSelector.FOnBeforeDrawDayNames=rtl.createCallback(this,"DoBeforeDrawDayNames"),this.FDateSelector.FOnAfterDrawDayNames=rtl.createCallback(this,"DoAfterDrawDayNames"),this.FDateSelector.FOnBeforeDrawDayNumbers=rtl.createCallback(this,"DoBeforeDrawDayNumbers"),this.FDateSelector.FOnAfterDrawDayNumbers=rtl.createCallback(this,"DoAfterDrawDayNumbers"),this.FDateSelector.FOnBeforeDrawLines=rtl.createCallback(this,"DoBeforeDrawLines"),this.FDateSelector.FOnAfterDrawLines=rtl.createCallback(this,"DoAfterDrawLines"),this.FDateSelector.FOnBeforeDrawWeekNumbers=rtl.createCallback(this,"DoBeforeDrawWeekNumbers"),this.FDateSelector.FOnAfterDrawWeekNumbers=rtl.createCallback(this,"DoAfterDrawWeekNumbers"),this.FDateSelector.FOnBeforeDrawArrowLeft=rtl.createCallback(this,"DoBeforeDrawArrowLeft"),this.FDateSelector.FOnAfterDrawArrowLeft=rtl.createCallback(this,"DoAfterDrawArrowLeft"),this.FDateSelector.FOnBeforeDrawArrowRight=rtl.createCallback(this,"DoBeforeDrawArrowRight"),this.FDateSelector.FOnAfterDrawArrowRight=rtl.createCallback(this,"DoAfterDrawArrowRight"),this.FDateSelector.FOnBeforeDrawBadge=rtl.createCallback(this,"DoBeforeDrawBadge"),this.FDateSelector.FOnAfterDrawBadge=rtl.createCallback(this,"DoAfterDrawBadge"),this.FDateSelector.FOnBeforeDrawHeaderText=rtl.createCallback(this,"DoBeforeDrawHeaderText"),this.FDateSelector.FOnAfterDrawHeaderText=rtl.createCallback(this,"DoAfterDrawHeaderText"),this.FDateSelector.FOnBeforeDrawFooterText=rtl.createCallback(this,"DoBeforeDrawFooterText"),this.FDateSelector.FOnAfterDrawFooterText=rtl.createCallback(this,"DoAfterDrawFooterText"),this.FDateSelector.FOnBeforeDrawDayNamesText=rtl.createCallback(this,"DoBeforeDrawDayNamesText"),this.FDateSelector.FOnAfterDrawDayNamesText=rtl.createCallback(this,"DoAfterDrawDayNamesText"),this.FDateSelector.FOnBeforeDrawDayNumbersText=rtl.createCallback(this,"DoBeforeDrawDayNumbersText"),this.FDateSelector.FOnAfterDrawDayNumbersText=rtl.createCallback(this,"DoAfterDrawDayNumbersText"),this.FDateSelector.FOnBeforeDrawWeekNumbersText=rtl.createCallback(this,"DoBeforeDrawWeekNumbersText"),this.FDateSelector.FOnAfterDrawWeekNumbersText=rtl.createCallback(this,"DoAfterDrawWeekNumbersText"),this.FDateSelector.FOnBeforeSelectDate=rtl.createCallback(this,"DoBeforeSelectDate"),this.FDateSelector.FOnSelectMultiDate=rtl.createCallback(this,"DoSelectMultiDate"),this.FDateSelector.FOnYearChanged=rtl.createCallback(this,"DoChangeYear"),this.FDateSelector.FOnMonthChanged=rtl.createCallback(this,"DoChangeMonth"),this.FDateSelector.FOnCustomNavigation=rtl.createCallback(this,"DoCustomNavigation"),this.FDateSelector.FOnCustomArrowDraw=rtl.createCallback(this,"DoCustomArrowDraw"),this.FWrapper},this.GetFocusedControl=function(){return this.FDateSelector},this.Create$1=function(e){return pas["WEBLib.TMSFNCCustomPicker"].TTMSFNCCustomPicker.Create$1.apply(this,arguments),this.SetSelectedDate(pas.System.Int(pas.SysUtils.Now())),this.FHeader=pas["WEBLib.TMSFNCCalendar"].TTMSFNCCalendarHeader.$create("Create$1",[this]),this.FInteraction=t.TTMSFNCDatePickerInteraction.$create("Create$1"),this.FCloseOnSelection=!0,this.FAllowNumericNullValue=!0,this.FFont$2=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFont.$create("Create$2"),this.FFont$2.FOnChanged=rtl.createCallback(this,"FontChange"),this.SetWidth(90),this.SetDropDownWidth(200),this.SetDropDownHeight(180),this},this.Destroy=function(){rtl.free(this,"FFont$2"),rtl.free(this,"FHeader"),rtl.free(this,"FInteraction"),pas["WEBLib.TMSFNCCustomPicker"].TTMSFNCCustomPicker.Destroy.call(this)},rtl.addIntf(this,pas["WEBLib.TMSFNCBitmapContainer"].ITMSFNCBitmapContainer),rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas["WEBLib.TMSFNCTypes"].ITMSFNCProductInfo),rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TTMSFNCDatePicker",this.TTMSFNCCustomDatePicker,(function(){this.RegisterRuntimeClasses=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.RegisterRuntimeClasses.call(this),pas.Classes.RegisterClass(t.TTMSFNCDatePicker)},rtl.addIntf(this,pas["WEBLib.TMSFNCBitmapContainer"].ITMSFNCBitmapContainer),rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas["WEBLib.TMSFNCTypes"].ITMSFNCProductInfo),rtl.addIntf(this,pas.System.IUnknown);var e=this.$rtti;e.addProperty("AllowNumericNullValue",2,rtl.boolean,"FAllowNumericNullValue","SetAllowNumericNullValue",{Default:!0}),e.addProperty("BitmapContainer",3,pas["WEBLib.TMSFNCBitmapContainer"].$rtti.TTMSFNCBitmapContainer,"GetBitmapContainer","SetBitmapContainer"),e.addProperty("Editable",2,rtl.boolean,"FEditable","SetEditable",{Default:!1}),e.addProperty("FirstDay",3,rtl.longint,"GetFirstDay","SetFirstDay"),e.addProperty("MaxDate",3,pas.System.$rtti.TDate,"GetMaxDate","SetMaxDate"),e.addProperty("MinDate",3,pas.System.$rtti.TDate,"GetMinDate","SetMinDate"),e.addProperty("Events",3,pas["WEBLib.TMSFNCCalendar"].$rtti.TTMSFNCCalendarEvents,"GetEvents","SetEvents"),e.addProperty("BadgeSize",3,rtl.longint,"GetBadgeSize","SetBadgeSize"),e.addProperty("Header",2,pas["WEBLib.TMSFNCCalendar"].$rtti.TTMSFNCCalendarHeader,"FHeader","SetHeader"),e.addProperty("Footer",3,pas["WEBLib.TMSFNCCalendar"].$rtti.TTMSFNCCalendarFooter,"GetFooter","SetFooter"),e.addProperty("Font",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFont,"FFont$2","SetFnt$1"),e.addProperty("Interaction",2,t.$rtti.TTMSFNCDatePickerInteraction,"FInteraction","SetInteraction"),e.addProperty("DropDownWidth",14,rtl.double,"FDropDownWidth","SetDropDownWidth",{stored:"IsDropDownWidthStored"}),e.addProperty("DropDownHeight",14,rtl.double,"FDropDownHeight","SetDropDownHeight",{stored:"IsDropDownHeightStored"}),e.addProperty("CloseOnSelection",0,rtl.boolean,"FCloseOnSelection","FCloseOnSelection",{Default:!0}),e.addProperty("OnDateSelected",0,t.$rtti.TTMSFNCCustomDatePickerDateSelected,"FOnDateSelected","FOnDateSelected"),e.addProperty("SelectedDate",3,pas.System.$rtti.TDate,"GetSelectedDate","SetSelectedDate"),e.addProperty("WeekNumberAppearance",3,pas["WEBLib.TMSFNCCalendar"].$rtti.TTMSFNCCalendarWeekNumberAppearance,"GetWeekNumberAppearance","SetWeekNumberAppearance"),e.addProperty("DateAppearance",3,pas["WEBLib.TMSFNCCalendar"].$rtti.TTMSFNCCalendarDateAppearance,"GetDateAppearance","SetDateAppearance"),e.addProperty("DayNameAppearance",3,pas["WEBLib.TMSFNCCalendar"].$rtti.TTMSFNCCalendarDayNameAppearance,"GetDayNameAppearance","SetDayNameAppearance"),e.addProperty("LineAppearance",3,pas["WEBLib.TMSFNCCalendar"].$rtti.TTMSFNCCalendarLineAppearance,"GetLineAppearance","SetLineAppearance"),e.addProperty("CalendarFill",3,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"GetCalendarFill","SetCalendarFill"),e.addProperty("CalendarStroke",3,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"GetCalendarStroke","SetCalendarStroke"),e.addProperty("OnCustomize",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnCustomize","FOnCustomize"),e.addProperty("OnBeforeDrawHeader",0,pas["WEBLib.TMSFNCCalendar"].$rtti.TTMSFNCCalendarBeforeDrawHeaderEvent,"FOnBeforeDrawHeader","FOnBeforeDrawHeader"),e.addProperty("OnAfterDrawHeader",0,pas["WEBLib.TMSFNCCalendar"].$rtti.TTMSFNCCalendarAfterDrawHeaderEvent,"FOnAfterDrawHeader","FOnAfterDrawHeader"),e.addProperty("OnBeforeDrawFooter",0,pas["WEBLib.TMSFNCCalendar"].$rtti.TTMSFNCCalendarBeforeDrawFooterEvent,"FOnBeforeDrawFooter","FOnBeforeDrawFooter"),e.addProperty("OnAfterDrawFooter",0,pas["WEBLib.TMSFNCCalendar"].$rtti.TTMSFNCCalendarAfterDrawFooterEvent,"FOnAfterDrawFooter","FOnAfterDrawFooter"),e.addProperty("OnBeforeDrawDayNames",0,pas["WEBLib.TMSFNCCalendar"].$rtti.TTMSFNCCalendarBeforeDrawDayNamesEvent,"FOnBeforeDrawDayNames","FOnBeforeDrawDayNames"),e.addProperty("OnAfterDrawDayNames",0,pas["WEBLib.TMSFNCCalendar"].$rtti.TTMSFNCCalendarAfterDrawDayNamesEvent,"FOnAfterDrawDayNames","FOnAfterDrawDayNames"),e.addProperty("OnBeforeDrawDayNumbers",0,pas["WEBLib.TMSFNCCalendar"].$rtti.TTMSFNCCalendarBeforeDrawDayNumbersEvent,"FOnBeforeDrawDayNumbers","FOnBeforeDrawDayNumbers"),e.addProperty("OnAfterDrawDayNumbers",0,pas["WEBLib.TMSFNCCalendar"].$rtti.TTMSFNCCalendarAfterDrawDayNumbersEvent,"FOnAfterDrawDayNumbers","FOnAfterDrawDayNumbers"),e.addProperty("OnBeforeDrawLines",0,pas["WEBLib.TMSFNCCalendar"].$rtti.TTMSFNCCalendarBeforeDrawLinesEvent,"FOnBeforeDrawLines","FOnBeforeDrawLines"),e.addProperty("OnAfterDrawLines",0,pas["WEBLib.TMSFNCCalendar"].$rtti.TTMSFNCCalendarAfterDrawLinesEvent,"FOnAfterDrawLines","FOnAfterDrawLines"),e.addProperty("OnBeforeDrawWeekNumbers",0,pas["WEBLib.TMSFNCCalendar"].$rtti.TTMSFNCCalendarBeforeDrawWeekNumbersEvent,"FOnBeforeDrawWeekNumbers","FOnBeforeDrawWeekNumbers"),e.addProperty("OnAfterDrawWeekNumbers",0,pas["WEBLib.TMSFNCCalendar"].$rtti.TTMSFNCCalendarAfterDrawWeekNumbersEvent,"FOnAfterDrawWeekNumbers","FOnAfterDrawWeekNumbers"),e.addProperty("OnBeforeDrawArrowLeft",0,pas["WEBLib.TMSFNCCalendar"].$rtti.TTMSFNCCalendarBeforeDrawArrowLeftEvent,"FOnBeforeDrawArrowLeft","FOnBeforeDrawArrowLeft"),e.addProperty("OnAfterDrawArrowLeft",0,pas["WEBLib.TMSFNCCalendar"].$rtti.TTMSFNCCalendarAfterDrawArrowLeftEvent,"FOnAfterDrawArrowLeft","FOnAfterDrawArrowLeft"),e.addProperty("OnBeforeDrawArrowRight",0,pas["WEBLib.TMSFNCCalendar"].$rtti.TTMSFNCCalendarBeforeDrawArrowRightEvent,"FOnBeforeDrawArrowRight","FOnBeforeDrawArrowRight"),e.addProperty("OnAfterDrawArrowRight",0,pas["WEBLib.TMSFNCCalendar"].$rtti.TTMSFNCCalendarAfterDrawArrowRightEvent,"FOnAfterDrawArrowRight","FOnAfterDrawArrowRight"),e.addProperty("OnBeforeDrawBadge",0,pas["WEBLib.TMSFNCCalendar"].$rtti.TTMSFNCCalendarBeforeDrawBadgeEvent,"FOnBeforeDrawBadge","FOnBeforeDrawBadge"),e.addProperty("OnAfterDrawBadge",0,pas["WEBLib.TMSFNCCalendar"].$rtti.TTMSFNCCalendarAfterDrawBadgeEvent,"FOnAfterDrawBadge","FOnAfterDrawBadge"),e.addProperty("OnBeforeDrawHeaderText",0,pas["WEBLib.TMSFNCCalendar"].$rtti.TTMSFNCCalendarBeforeDrawHeaderTextEvent,"FOnBeforeDrawHeaderText","FOnBeforeDrawHeaderText"),e.addProperty("OnAfterDrawHeaderText",0,pas["WEBLib.TMSFNCCalendar"].$rtti.TTMSFNCCalendarAfterDrawHeaderTextEvent,"FOnAfterDrawHeaderText","FOnAfterDrawHeaderText"),e.addProperty("OnBeforeDrawFooterText",0,pas["WEBLib.TMSFNCCalendar"].$rtti.TTMSFNCCalendarBeforeDrawFooterTextEvent,"FOnBeforeDrawFooterText","FOnBeforeDrawFooterText"),e.addProperty("OnAfterDrawFooterText",0,pas["WEBLib.TMSFNCCalendar"].$rtti.TTMSFNCCalendarAfterDrawFooterTextEvent,"FOnAfterDrawFooterText","FOnAfterDrawFooterText"),e.addProperty("OnBeforeDrawDayNamesText",0,pas["WEBLib.TMSFNCCalendar"].$rtti.TTMSFNCCalendarBeforeDrawDayNamesTextEvent,"FOnBeforeDrawDayNamesText","FOnBeforeDrawDayNamesText"),e.addProperty("OnAfterDrawDayNamesText",0,pas["WEBLib.TMSFNCCalendar"].$rtti.TTMSFNCCalendarAfterDrawDayNamesTextEvent,"FOnAfterDrawDayNamesText","FOnAfterDrawDayNamesText"),e.addProperty("OnBeforeDrawDayNumbersText",0,pas["WEBLib.TMSFNCCalendar"].$rtti.TTMSFNCCalendarBeforeDrawDayNumbersTextEvent,"FOnBeforeDrawDayNumbersText","FOnBeforeDrawDayNumbersText"),e.addProperty("OnAfterDrawDayNumbersText",0,pas["WEBLib.TMSFNCCalendar"].$rtti.TTMSFNCCalendarAfterDrawDayNumbersTextEvent,"FOnAfterDrawDayNumbersText","FOnAfterDrawDayNumbersText"),e.addProperty("OnBeforeDrawWeekNumbersText",0,pas["WEBLib.TMSFNCCalendar"].$rtti.TTMSFNCCalendarBeforeDrawWeekNumbersTextEvent,"FOnBeforeDrawWeekNumbersText","FOnBeforeDrawWeekNumbersText"),e.addProperty("OnAfterDrawWeekNumbersText",0,pas["WEBLib.TMSFNCCalendar"].$rtti.TTMSFNCCalendarAfterDrawWeekNumbersTextEvent,"FOnAfterDrawWeekNumbersText","FOnAfterDrawWeekNumbersText"),e.addProperty("OnBeforeSelectDate",0,pas["WEBLib.TMSFNCCalendar"].$rtti.TTMSFNCCalendarBeforeSelectDateEvent,"FOnBeforeSelectDate","FOnBeforeSelectDate"),e.addProperty("OnSelectMultiDate",0,pas["WEBLib.TMSFNCCalendar"].$rtti.TTMSFNCCalendarSelectedMultiDateEvent,"FOnSelectMultiDate","FOnSelectMultiDate"),e.addProperty("OnYearChanged",0,pas["WEBLib.TMSFNCCalendar"].$rtti.TTMSFNCCalendarYearChangedEvent,"FOnYearChanged","FOnYearChanged"),e.addProperty("OnMonthChanged",0,pas["WEBLib.TMSFNCCalendar"].$rtti.TTMSFNCCalendarMonthChangedEvent,"FOnMonthChanged","FOnMonthChanged"),e.addProperty("OnCustomNavigation",0,pas["WEBLib.TMSFNCCalendar"].$rtti.TTMSFNCCalendarCustomNavigationEvent,"FOnCustomNavigation","FOnCustomNavigation"),e.addProperty("OnCustomArrowDraw",0,pas["WEBLib.TMSFNCCalendar"].$rtti.TTMSFNCCalendarCustomArrowDrawEvent,"FOnCustomArrowDraw","FOnCustomArrowDraw"),e.addProperty("OnValidate",0,t.$rtti.TTMSFNCCustomDatePickerValidateEvent,"FOnValidate","FOnValidate"),e.attr=[pas.Classes.ComponentPlatformsAttribute,"Create$1",[0]]})),t.$implcode=function(){rtl.createClass(e,"TTMSFNCCustomSelectorOpen",pas["WEBLib.TMSFNCCustomSelector"].TTMSFNCCustomSelector,(function(){rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas["WEBLib.TMSFNCTypes"].ITMSFNCProductInfo),rtl.addIntf(this,pas.System.IUnknown)}))}}),["DateUtils","SysUtils"]),rtl.module("WEBLib.TMSFNCStrokeKindSelector",["System","Classes","WEBLib.TMSFNCCustomSelector","WEBLib.TMSFNCGraphics","WEBLib.TMSFNCGraphicsTypes","WEBLib.TMSFNCTypes","Types"],(function(){"use strict";var t=this;this.MAJ_VER=1,this.MIN_VER=0,this.REL_VER=0,this.BLD_VER=1,rtl.createClass(this,"TTMSFNCStrokeKindSelectorItem",pas["WEBLib.TMSFNCCustomSelector"].TTMSFNCCustomSelectorItem,(function(){this.$init=function(){pas["WEBLib.TMSFNCCustomSelector"].TTMSFNCCustomSelectorItem.$init.call(this),this.FOwner$1=null,this.FKind=0},this.$final=function(){this.FOwner$1=void 0,pas["WEBLib.TMSFNCCustomSelector"].TTMSFNCCustomSelectorItem.$final.call(this)},this.SetKind=function(t){this.FKind!==t&&(this.FKind=t)},this.Create$1=function(e){return pas["WEBLib.TMSFNCCustomSelector"].TTMSFNCCustomSelectorItem.Create$1.apply(this,arguments),null!=e&&(this.FOwner$1=rtl.as(e,t.TTMSFNCStrokeKindSelectorItems).FOwner$2),this},this.Assign=function(e){pas["WEBLib.TMSFNCCustomSelector"].TTMSFNCCustomSelectorItem.Assign.apply(this,arguments),t.TTMSFNCStrokeKindSelectorItem.isPrototypeOf(e)&&(this.FKind=rtl.as(e,t.TTMSFNCStrokeKindSelectorItem).FKind)},this.$rtti.addProperty("Kind",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStrokeKind,"FKind","SetKind",{Default:pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStrokeKind.gskNone})})),rtl.createClass(this,"TTMSFNCStrokeKindSelectorItems",pas["WEBLib.TMSFNCCustomSelector"].TTMSFNCCustomSelectorItems,(function(){this.$init=function(){pas["WEBLib.TMSFNCCustomSelector"].TTMSFNCCustomSelectorItems.$init.call(this),this.FOwner$2=null},this.$final=function(){this.FOwner$2=void 0,pas["WEBLib.TMSFNCCustomSelector"].TTMSFNCCustomSelectorItems.$final.call(this)},this.GetItem$2=function(t){return this.GetItem$1(t)},this.CreateItemClass=function(){return t.TTMSFNCStrokeKindSelectorItem},this.Create$3=function(e){return pas["WEBLib.TMSFNCCustomSelector"].TTMSFNCCustomSelectorItems.Create$3.apply(this,arguments),this.FOwner$2=rtl.as(e,t.TTMSFNCCustomStrokeKindSelector),this},this.Add$2=function(){return pas["WEBLib.TMSFNCCustomSelector"].TTMSFNCCustomSelectorItems.Add$1.call(this)}})),this.$rtti.$MethodVar("TTMSFNCCustomStrokeKindSelectorStrokeKindSelected",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AStrokeKind",pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStrokeKind]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCCustomStrokeKindSelectorStrokeKindDeselected",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AStrokeKind",pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStrokeKind]]),methodkind:0}),rtl.createClass(this,"TTMSFNCCustomStrokeKindSelector",pas["WEBLib.TMSFNCCustomSelector"].TTMSFNCDefaultSelector,(function(){this.$init=function(){pas["WEBLib.TMSFNCCustomSelector"].TTMSFNCDefaultSelector.$init.call(this),this.FOnStrokeKindSelected=null,this.FOnStrokeKindDeselected=null},this.$final=function(){this.FOnStrokeKindSelected=void 0,this.FOnStrokeKindDeselected=void 0,pas["WEBLib.TMSFNCCustomSelector"].TTMSFNCDefaultSelector.$final.call(this)},this.GetItems=function(){return this.FItems},this.GetSelectedStrokeKind=function(){return this.FindStrokeKindByItem(this.FSelectedItemIndex)},this.SetItems$1=function(t){this.GetItems().Assign(t)},this.SetSelectedStrokeKind=function(t){this.SetSelectedItemIndex(this.FindItemByStrokeKind(t))},this.DoItemSelected=function(t){pas["WEBLib.TMSFNCCustomSelector"].TTMSFNCCustomSelector.DoItemSelected.apply(this,arguments),null!=this.FOnStrokeKindSelected&&this.FOnStrokeKindSelected(this,this.FindStrokeKindByItem(t))},this.DoItemDeselected=function(t){pas["WEBLib.TMSFNCCustomSelector"].TTMSFNCCustomSelector.DoItemDeselected.apply(this,arguments),null!=this.FOnStrokeKindDeselected&&this.FOnStrokeKindDeselected(this,this.FindStrokeKindByItem(t))},this.DrawItemContent=function(e,i){var s=null,o=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),n=0;pas["WEBLib.TMSFNCCustomSelector"].TTMSFNCCustomSelector.DrawItemContent.apply(this,arguments),null!=(s=i.Item)&&t.TTMSFNCStrokeKindSelectorItem.isPrototypeOf(s)&&(o.$assign(i.Rect),pas["WEBLib.TMSFNCTypes"].InflateRectEx(o,this.ScalePaintValue(-5),this.ScalePaintValue(-5)),n=o.Bottom-(o.Bottom-o.Top)/2,e.FStroke.SetKind(rtl.as(s,t.TTMSFNCStrokeKindSelectorItem).FKind),e.FStroke.SetColor(0),e.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(o.Left,n)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(o.Right,n)),2,2))},this.AddStrokeKinds=function(){var t=0;for(this.BeginUpdate(),this.GetItems().Clear(),this.SetColumns(1),this.SetRows(6),t=0;t<=5;t++)this.GetItems().Add$2().SetKind(t);this.EndUpdate()},this.GetVersion=function(){return this.$class.GetVersionNumber(1,0,0,1)},this.CreateItemsCollection=function(){return t.TTMSFNCStrokeKindSelectorItems.$create("Create$3",[this])},this.Create$1=function(t){return pas["WEBLib.TMSFNCCustomSelector"].TTMSFNCCustomSelector.Create$1.apply(this,arguments),this.SetWidth(130),this.SetHeight(135),this},this.InitializeDefault=function(){pas["WEBLib.TMSFNCCustomSelector"].TTMSFNCCustomSelector.InitializeDefault.call(this),this.AddStrokeKinds()},this.FindItemByStrokeKind=function(e){var i=0,s=0,o=null;i=-1;for(var n=0,r=this.GetItems().GetCount()-1;n<=r;n++)if(s=n,(o=rtl.as(this.GetItems().GetItem$2(s),t.TTMSFNCStrokeKindSelectorItem)).FKind===e&&o.FCanSelect){i=o.GetIndex();break}return i},this.FindStrokeKindByItem=function(e){var i=0,s=0,o=null;i=0;for(var n=0,r=this.GetItems().GetCount()-1;n<=r;n++)if(s=n,(o=rtl.as(this.GetItems().GetItem$2(s),t.TTMSFNCStrokeKindSelectorItem)).GetIndex()===e){i=o.FKind;break}return i},rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas["WEBLib.TMSFNCTypes"].ITMSFNCProductInfo),rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TTMSFNCStrokeKindSelector",this.TTMSFNCCustomStrokeKindSelector,(function(){this.RegisterRuntimeClasses=function(){pas["WEBLib.TMSFNCCustomSelector"].TTMSFNCCustomSelector.RegisterRuntimeClasses.call(this),pas.Classes.RegisterClasses([t.TTMSFNCStrokeKindSelector,t.TTMSFNCStrokeKindSelectorItem])},rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas["WEBLib.TMSFNCTypes"].ITMSFNCProductInfo),rtl.addIntf(this,pas.System.IUnknown);var e=this.$rtti;e.addProperty("Appearance",2,pas["WEBLib.TMSFNCCustomSelector"].$rtti.TTMSFNCCustomSelectorAppearance,"FAppearance","SetAppearance"),e.addProperty("Columns",2,rtl.longint,"FColumns","SetColumns",{Default:4}),e.addProperty("Rows",2,rtl.longint,"FRows","SetRows",{Default:4}),e.addProperty("Items",3,t.$rtti.TTMSFNCStrokeKindSelectorItems,"GetItems","SetItems$1"),e.addProperty("OnStrokeKindSelected",0,t.$rtti.TTMSFNCCustomStrokeKindSelectorStrokeKindSelected,"FOnStrokeKindSelected","FOnStrokeKindSelected"),e.addProperty("OnStrokeKindDeselected",0,t.$rtti.TTMSFNCCustomStrokeKindSelectorStrokeKindDeselected,"FOnStrokeKindDeselected","FOnStrokeKindDeselected"),e.addProperty("OnItemSelected",0,pas["WEBLib.TMSFNCCustomSelector"].$rtti.TTMSFNCCustomSelectorItemSelected,"FOnItemSelected","FOnItemSelected"),e.addProperty("OnItemDeselected",0,pas["WEBLib.TMSFNCCustomSelector"].$rtti.TTMSFNCCustomSelectorItemDeselected,"FOnItemDeselected","FOnItemDeselected"),e.addProperty("OnItemClick",0,pas["WEBLib.TMSFNCCustomSelector"].$rtti.TTMSFNCCustomSelectorItemClick,"FOnItemClick","FOnItemClick"),e.addProperty("SelectedItemIndex",2,rtl.longint,"FSelectedItemIndex","SetSelectedItemIndex",{Default:-1}),e.addProperty("OnItemBeforeDrawBackground",0,pas["WEBLib.TMSFNCCustomSelector"].$rtti.TTMSFNCCustomSelectorItemBeforeDrawBackground,"FOnItemBeforeDrawBackground","FOnItemBeforeDrawBackground"),e.addProperty("OnItemAfterDrawBackground",0,pas["WEBLib.TMSFNCCustomSelector"].$rtti.TTMSFNCCustomSelectorItemAfterDrawBackground,"FOnItemAfterDrawBackground","FOnItemAfterDrawBackground"),e.addProperty("OnItemBeforeDrawContent",0,pas["WEBLib.TMSFNCCustomSelector"].$rtti.TTMSFNCCustomSelectorItemBeforeDrawContent,"FOnItemBeforeDrawContent","FOnItemBeforeDrawContent"),e.addProperty("OnItemAfterDrawContent",0,pas["WEBLib.TMSFNCCustomSelector"].$rtti.TTMSFNCCustomSelectorItemAfterDrawContent,"FOnItemAfterDrawContent","FOnItemAfterDrawContent"),e.addProperty("OnBeforeDraw",0,pas["WEBLib.TMSFNCCustomSelector"].$rtti.TTMSFNCCustomSelectorBeforeDraw,"FOnBeforeDraw$1","FOnBeforeDraw$1"),e.addProperty("OnAfterDraw",0,pas["WEBLib.TMSFNCCustomSelector"].$rtti.TTMSFNCCustomSelectorAfterDraw,"FOnAfterDraw$1","FOnAfterDraw$1"),e.addProperty("OnItemBeforeDrawText",0,pas["WEBLib.TMSFNCCustomSelector"].$rtti.TTMSFNCCustomSelectorItemBeforeDrawText,"FOnItemBeforeDrawText","FOnItemBeforeDrawText"),e.addProperty("OnItemAfterDrawText",0,pas["WEBLib.TMSFNCCustomSelector"].$rtti.TTMSFNCCustomSelectorItemAfterDrawText,"FOnItemAfterDrawText","FOnItemAfterDrawText"),e.attr=[pas.Classes.ComponentPlatformsAttribute,"Create$1",[0]]}))}),["WEBLib.TMSFNCUtils"]),rtl.module("WEBLib.TMSFNCStrokeKindPicker",["System","Classes","WEBLib.TMSFNCCustomPicker","WEBLib.TMSFNCStrokeKindSelector","WEBLib.TMSFNCGraphicsTypes","WEBLib.TMSFNCCustomSelector","WEBLib.TMSFNCGraphics","WEBLib.TMSFNCTypes","Types"],(function(){"use strict";var t=this;this.MAJ_VER=1,this.MIN_VER=0,this.REL_VER=1,this.BLD_VER=0,rtl.createClass(this,"TTMSFNCCustomStrokeKindPicker",pas["WEBLib.TMSFNCCustomPicker"].TTMSFNCDefaultPicker,(function(){this.$init=function(){pas["WEBLib.TMSFNCCustomPicker"].TTMSFNCDefaultPicker.$init.call(this),this.FStrokeKindSelector=null,this.FCloseOnSelection=!1,this.FOnStrokeKindSelected=null,this.FOnStrokeKindDeselected=null},this.$final=function(){this.FStrokeKindSelector=void 0,this.FOnStrokeKindSelected=void 0,this.FOnStrokeKindDeselected=void 0,pas["WEBLib.TMSFNCCustomPicker"].TTMSFNCDefaultPicker.$final.call(this)},this.SetItems$1=function(t){this.FStrokeKindSelector.GetItems().Assign(t)},this.SetSelectedStrokeKind=function(t){this.FStrokeKindSelector.SetSelectedStrokeKind(t),this.Invalidate()},this.GetItems$1=function(){return this.FStrokeKindSelector.GetItems()},this.GetSelectedStrokeKind=function(){return this.FStrokeKindSelector.GetSelectedStrokeKind()},this.DoStrokeKindSelected=function(){null!=this.FOnStrokeKindSelected&&this.FOnStrokeKindSelected(this,this.GetSelectedStrokeKind()),this.Invalidate()},this.StrokeKindSelected=function(t,e){this.FCloseOnSelection&&this.DropDown(),null!=this.FOnStrokeKindSelected&&this.FOnStrokeKindSelected(this,e),this.Invalidate()},this.StrokeKindDeselected=function(t,e){null!=this.FOnStrokeKindDeselected&&this.FOnStrokeKindDeselected(this,e),this.Invalidate()},this.DrawContent=function(t,e){var i=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),s=0;pas["WEBLib.TMSFNCCustomPicker"].TTMSFNCCustomPicker.DrawContent.apply(this,arguments),i.$assign(e),pas["WEBLib.TMSFNCTypes"].InflateRectEx(i,this.ScalePaintValue(-5),this.ScalePaintValue(-5)),s=i.Bottom-(i.Bottom-i.Top)/2,t.FStroke.SetKind(this.GetSelectedStrokeKind()),this.FEnabled?t.FStroke.SetColor(0):t.FStroke.SetColor(12632256),t.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(i.Left,s)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(i.Right,s)),2,2)},this.SelectFirstValue=function(){pas["WEBLib.TMSFNCCustomPicker"].TTMSFNCCustomPicker.SelectFirstValue.call(this),this.FStrokeKindSelector.GetItems().GetCount()>0&&(this.FStrokeKindSelector.SetSelectedItemIndex(0),this.DoStrokeKindSelected())},this.SelectLastValue=function(){pas["WEBLib.TMSFNCCustomPicker"].TTMSFNCCustomPicker.SelectLastValue.call(this),this.FStrokeKindSelector.GetItems().GetCount()>0&&(this.FStrokeKindSelector.SetSelectedItemIndex(this.FStrokeKindSelector.GetItems().GetCount()-1),this.DoStrokeKindSelected())},this.SelectNextValue=function(){pas["WEBLib.TMSFNCCustomPicker"].TTMSFNCCustomPicker.SelectNextValue.call(this),this.FStrokeKindSelector.GetItems().GetCount()>0&&(-1===this.FStrokeKindSelector.FSelectedItemIndex?this.FStrokeKindSelector.SetSelectedItemIndex(0):this.FStrokeKindSelector.SetSelectedItemIndex(Math.min(this.FStrokeKindSelector.GetItems().GetCount()-1,this.FStrokeKindSelector.FSelectedItemIndex+1)),this.DoStrokeKindSelected())},this.SelectPreviousValue=function(){pas["WEBLib.TMSFNCCustomPicker"].TTMSFNCCustomPicker.SelectPreviousValue.call(this),this.FStrokeKindSelector.GetItems().GetCount()>0&&(-1===this.FStrokeKindSelector.FSelectedItemIndex?this.FStrokeKindSelector.SetSelectedItemIndex(0):this.FStrokeKindSelector.SetSelectedItemIndex(Math.max(0,this.FStrokeKindSelector.FSelectedItemIndex-1)),this.DoStrokeKindSelected())},this.GetVersion=function(){return this.$class.GetVersionNumber(1,0,1,0)},this.CreateSelector=function(){return this.FStrokeKindSelector=pas["WEBLib.TMSFNCStrokeKindSelector"].TTMSFNCStrokeKindSelector.$create("Create$1",[this]),this.FStrokeKindSelector.FOnStrokeKindSelected=rtl.createCallback(this,"StrokeKindSelected"),this.FStrokeKindSelector.FOnStrokeKindDeselected=rtl.createCallback(this,"StrokeKindDeselected"),this.FStrokeKindSelector.InitializeDefault(),this.FStrokeKindSelector},this.Create$1=function(t){return pas["WEBLib.TMSFNCCustomPicker"].TTMSFNCCustomPicker.Create$1.apply(this,arguments),this.SetWidth(70),this.SetDropDownWidth(130),this.FCloseOnSelection=!0,this.SetSelectedStrokeKind(1),this},rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas["WEBLib.TMSFNCTypes"].ITMSFNCProductInfo),rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TTMSFNCStrokeKindPicker",this.TTMSFNCCustomStrokeKindPicker,(function(){this.RegisterRuntimeClasses=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.RegisterRuntimeClasses.call(this),pas.Classes.RegisterClass(t.TTMSFNCStrokeKindPicker)},rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas["WEBLib.TMSFNCTypes"].ITMSFNCProductInfo),rtl.addIntf(this,pas.System.IUnknown);var e=this.$rtti;e.addProperty("DropDownWidth",14,rtl.double,"FDropDownWidth","SetDropDownWidth",{stored:"IsDropDownWidthStored"}),e.addProperty("DropDownHeight",14,rtl.double,"FDropDownHeight","SetDropDownHeight",{stored:"IsDropDownHeightStored"}),e.addProperty("Appearance",3,pas["WEBLib.TMSFNCCustomSelector"].$rtti.TTMSFNCCustomSelectorAppearance,"GetAppearance","SetAppearance"),e.addProperty("Rows",3,rtl.longint,"GetRows","SetRows",{Default:4}),e.addProperty("Columns",3,rtl.longint,"GetColumns","SetColumns",{Default:4}),e.addProperty("Items",3,pas["WEBLib.TMSFNCStrokeKindSelector"].$rtti.TTMSFNCStrokeKindSelectorItems,"GetItems$1","SetItems$1"),e.addProperty("CloseOnSelection",0,rtl.boolean,"FCloseOnSelection","FCloseOnSelection",{Default:!0}),e.addProperty("SelectedStrokeKind",3,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStrokeKind,"GetSelectedStrokeKind","SetSelectedStrokeKind",{Default:pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStrokeKind.gskSolid}),e.addProperty("OnStrokeKindSelected",0,pas["WEBLib.TMSFNCStrokeKindSelector"].$rtti.TTMSFNCCustomStrokeKindSelectorStrokeKindSelected,"FOnStrokeKindSelected","FOnStrokeKindSelected"),e.addProperty("OnStrokeKindDeselected",0,pas["WEBLib.TMSFNCStrokeKindSelector"].$rtti.TTMSFNCCustomStrokeKindSelectorStrokeKindDeselected,"FOnStrokeKindDeselected","FOnStrokeKindDeselected"),e.addProperty("OnItemSelected",0,pas["WEBLib.TMSFNCCustomSelector"].$rtti.TTMSFNCCustomSelectorItemSelected,"FOnItemSelected","FOnItemSelected"),e.addProperty("OnItemDeselected",0,pas["WEBLib.TMSFNCCustomSelector"].$rtti.TTMSFNCCustomSelectorItemDeselected,"FOnItemDeselected","FOnItemDeselected"),e.addProperty("OnItemClick",0,pas["WEBLib.TMSFNCCustomSelector"].$rtti.TTMSFNCCustomSelectorItemClick,"FOnItemClick","FOnItemClick"),e.addProperty("SelectedItemIndex",3,rtl.longint,"GetSelectedItemIndex","SetSelectedItemIndex",{Default:-1}),e.addProperty("OnPickerBeforeDraw",0,pas["WEBLib.TMSFNCCustomPicker"].$rtti.TTMSFNCCustomPickerBeforeDraw,"FOnPickerBeforeDraw","FOnPickerBeforeDraw"),e.addProperty("OnPickerAfterDraw",0,pas["WEBLib.TMSFNCCustomPicker"].$rtti.TTMSFNCCustomPickerAfterDraw,"FOnPickerAfterDraw","FOnPickerAfterDraw"),e.addProperty("OnItemBeforeDrawBackground",0,pas["WEBLib.TMSFNCCustomSelector"].$rtti.TTMSFNCCustomSelectorItemBeforeDrawBackground,"FOnItemBeforeDrawBackground","FOnItemBeforeDrawBackground"),e.addProperty("OnItemAfterDrawBackground",0,pas["WEBLib.TMSFNCCustomSelector"].$rtti.TTMSFNCCustomSelectorItemAfterDrawBackground,"FOnItemAfterDrawBackground","FOnItemAfterDrawBackground"),e.addProperty("OnItemBeforeDrawContent",0,pas["WEBLib.TMSFNCCustomSelector"].$rtti.TTMSFNCCustomSelectorItemBeforeDrawContent,"FOnItemBeforeDrawContent","FOnItemBeforeDrawContent"),e.addProperty("OnItemAfterDrawContent",0,pas["WEBLib.TMSFNCCustomSelector"].$rtti.TTMSFNCCustomSelectorItemAfterDrawContent,"FOnItemAfterDrawContent","FOnItemAfterDrawContent"),e.addProperty("OnBeforeDraw",0,pas["WEBLib.TMSFNCCustomSelector"].$rtti.TTMSFNCCustomSelectorBeforeDraw,"FOnBeforeDraw$1","FOnBeforeDraw$1"),e.addProperty("OnAfterDraw",0,pas["WEBLib.TMSFNCCustomSelector"].$rtti.TTMSFNCCustomSelectorAfterDraw,"FOnAfterDraw$1","FOnAfterDraw$1"),e.addProperty("OnItemBeforeDrawText",0,pas["WEBLib.TMSFNCCustomSelector"].$rtti.TTMSFNCCustomSelectorItemBeforeDrawText,"FOnItemBeforeDrawText","FOnItemBeforeDrawText"),e.addProperty("OnItemAfterDrawText",0,pas["WEBLib.TMSFNCCustomSelector"].$rtti.TTMSFNCCustomSelectorItemAfterDrawText,"FOnItemAfterDrawText","FOnItemAfterDrawText"),e.attr=[pas.Classes.ComponentPlatformsAttribute,"Create$1",[0]]}))}),["Math","WEBLib.TMSFNCUtils"]),rtl.module("WEBLib.TMSFNCFillKindSelector",["System","Classes","WEBLib.TMSFNCCustomSelector","WEBLib.TMSFNCGraphics","WEBLib.TMSFNCGraphicsTypes","WEBLib.TMSFNCTypes","Types"],(function(){"use strict";var t=this;this.MAJ_VER=1,this.MIN_VER=0,this.REL_VER=1,this.BLD_VER=0,rtl.createClass(this,"TTMSFNCFillKindSelectorItem",pas["WEBLib.TMSFNCCustomSelector"].TTMSFNCCustomSelectorItem,(function(){this.$init=function(){pas["WEBLib.TMSFNCCustomSelector"].TTMSFNCCustomSelectorItem.$init.call(this),this.FOwner$1=null,this.FName="",this.FKind=0},this.$final=function(){this.FOwner$1=void 0,pas["WEBLib.TMSFNCCustomSelector"].TTMSFNCCustomSelectorItem.$final.call(this)},this.SetKind=function(t){this.FKind!==t&&(this.FKind=t)},this.SetName=function(t){this.FName!==t&&(this.FName=t)},this.IsNameStored=function(){return""!==this.FName},this.Create$1=function(e){return pas["WEBLib.TMSFNCCustomSelector"].TTMSFNCCustomSelectorItem.Create$1.apply(this,arguments),null!=e&&(this.FOwner$1=rtl.as(e,t.TTMSFNCFillKindSelectorItems).FOwner$2),this},this.Assign=function(e){pas["WEBLib.TMSFNCCustomSelector"].TTMSFNCCustomSelectorItem.Assign.apply(this,arguments),t.TTMSFNCFillKindSelectorItem.isPrototypeOf(e)&&(this.FKind=rtl.as(e,t.TTMSFNCFillKindSelectorItem).FKind,this.FName=rtl.as(e,t.TTMSFNCFillKindSelectorItem).FName)};var e=this.$rtti;e.addProperty("Kind",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFillKind,"FKind","SetKind",{Default:pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFillKind.gfkNone}),e.addProperty("Name",14,rtl.string,"FName","SetName",{stored:"IsNameStored"})})),rtl.createClass(this,"TTMSFNCFillKindSelectorItems",pas["WEBLib.TMSFNCCustomSelector"].TTMSFNCCustomSelectorItems,(function(){this.$init=function(){pas["WEBLib.TMSFNCCustomSelector"].TTMSFNCCustomSelectorItems.$init.call(this),this.FOwner$2=null},this.$final=function(){this.FOwner$2=void 0,pas["WEBLib.TMSFNCCustomSelector"].TTMSFNCCustomSelectorItems.$final.call(this)},this.GetItem$2=function(t){return this.GetItem$1(t)},this.CreateItemClass=function(){return t.TTMSFNCFillKindSelectorItem},this.Create$3=function(e){return pas["WEBLib.TMSFNCCustomSelector"].TTMSFNCCustomSelectorItems.Create$3.apply(this,arguments),this.FOwner$2=rtl.as(e,t.TTMSFNCCustomFillKindSelector),this},this.Add$2=function(){return pas["WEBLib.TMSFNCCustomSelector"].TTMSFNCCustomSelectorItems.Add$1.call(this)}})),this.$rtti.$MethodVar("TTMSFNCCustomFillKindSelectorFillKindSelected",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AFillKind",pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFillKind]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCCustomFillKindSelectorFillKindDeselected",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AFillKind",pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFillKind]]),methodkind:0}),rtl.createClass(this,"TTMSFNCCustomFillKindSelector",pas["WEBLib.TMSFNCCustomSelector"].TTMSFNCDefaultSelector,(function(){this.$init=function(){pas["WEBLib.TMSFNCCustomSelector"].TTMSFNCDefaultSelector.$init.call(this),this.FOnFillKindSelected=null,this.FOnFillKindDeselected=null},this.$final=function(){this.FOnFillKindSelected=void 0,this.FOnFillKindDeselected=void 0,pas["WEBLib.TMSFNCCustomSelector"].TTMSFNCDefaultSelector.$final.call(this)},this.SetItems$1=function(t){this.GetItems().Assign(t)},this.SetSelectedFillKind=function(t){this.SetSelectedItemIndex(this.FindItemByFillKind(t))},this.GetItems=function(){return this.FItems},this.GetSelectedFillKind=function(){return this.FindFillKindByItem(this.FSelectedItemIndex)},this.DoItemSelected=function(t){pas["WEBLib.TMSFNCCustomSelector"].TTMSFNCCustomSelector.DoItemSelected.apply(this,arguments),null!=this.FOnFillKindSelected&&this.FOnFillKindSelected(this,this.FindFillKindByItem(t))},this.DoItemDeselected=function(t){pas["WEBLib.TMSFNCCustomSelector"].TTMSFNCCustomSelector.DoItemDeselected.apply(this,arguments),null!=this.FOnFillKindDeselected&&this.FOnFillKindDeselected(this,this.FindFillKindByItem(t))},this.DrawItemContent=function(e,i){var s,o=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),n=null;if(null!=(s=i.Item)&&t.TTMSFNCFillKindSelectorItem.isPrototypeOf(s)){o.$assign(i.Rect),pas["WEBLib.TMSFNCTypes"].InflateRectEx(o,-4,-4),o.Left=o.Right-this.ScalePaintValue(21),e.FFill.SetKind(rtl.as(s,t.TTMSFNCFillKindSelectorItem).FKind);var r=e.FFill.FKind;if(0===r)e.FStroke.SetKind(1),e.DrawRectangle$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(o),2);else if(1===r)e.FFill.SetColor(16436871),e.FStroke.SetKind(1),e.FStroke.SetColor(16436871),e.DrawRectangle$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(o),2);else if(2===r)e.FFill.SetColor(16436871),e.FFill.SetColorTo(14772545),e.FStroke.SetKind(0),e.DrawRectangle$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(o),2);else if(3===r){n=pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.CreateFromResource$1(t.TTMSFNCFILLKINDSELECTORTEXTURE,pas["WEBLib.TMSFNCTypes"].HInstance());try{pas["WEBLib.TMSFNCTypes"].InflateRectEx(o,this.ScalePaintValue(2),this.ScalePaintValue(2)),pas["WEBLib.TMSFNCTypes"].OffsetRectEx$1(o,0,-1),e.DrawBitmap$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(Math.round(o.Left),Math.round(o.Top),Math.round(o.Right),Math.round(o.Bottom))),n,!0,!0,!0,!1)}finally{n=rtl.freeLoc(n)}}}},this.DrawItemText=function(e,i){var s=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),o="",n=null,r=!1;null!=(n=i.Item)&&t.TTMSFNCFillKindSelectorItem.isPrototypeOf(n)&&(s.$assign(i.Rect),pas["WEBLib.TMSFNCTypes"].InflateRectEx(s,-5,-5),o=rtl.as(n,t.TTMSFNCFillKindSelectorItem).FName,e.FFont.AssignSource(this.FAppearance.FFont),r=!0,this.DoItemBeforeDrawText(e,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i.Rect),n.GetIndex(),{get:function(){return o},set:function(t){o=t}},{get:function(){return r},set:function(t){r=t}}),r&&(e.DrawText$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(s),o,!1,1,0,0,0,-1,-1,!0,!1,-1,-1),this.DoItemAfterDrawText(e,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i.Rect),n.GetIndex(),o)))},this.AddFillKinds=function(){var t=0;for(this.BeginUpdate(),this.GetItems().Clear(),this.SetColumns(1),this.SetRows(4),t=0;t<=3;t++)this.GetItems().Add$2().SetKind(t);this.GetItems().GetItem$2(0).SetName("None"),this.GetItems().GetItem$2(1).SetName("Solid"),this.GetItems().GetItem$2(2).SetName("Gradient"),this.GetItems().GetItem$2(3).SetName("Texture"),this.EndUpdate()},this.GetVersion=function(){return this.$class.GetVersionNumber(1,0,1,0)},this.CreateItemsCollection=function(){return t.TTMSFNCFillKindSelectorItems.$create("Create$3",[this])},this.Create$1=function(t){return pas["WEBLib.TMSFNCCustomSelector"].TTMSFNCCustomSelector.Create$1.apply(this,arguments),this.SetWidth(121),this.SetHeight(121),this},this.InitializeDefault=function(){pas["WEBLib.TMSFNCCustomSelector"].TTMSFNCCustomSelector.InitializeDefault.call(this),this.AddFillKinds()},this.FindItemByFillKind=function(e){var i=0,s=0,o=null;i=-1;for(var n=0,r=this.GetItems().GetCount()-1;n<=r;n++)if(s=n,(o=rtl.as(this.GetItems().GetItem$2(s),t.TTMSFNCFillKindSelectorItem)).FKind===e&&o.FCanSelect){i=o.GetIndex();break}return i},this.FindFillKindByItem=function(e){var i=0,s=0,o=null;i=0;for(var n=0,r=this.GetItems().GetCount()-1;n<=r;n++)if(s=n,(o=rtl.as(this.GetItems().GetItem$2(s),t.TTMSFNCFillKindSelectorItem)).GetIndex()===e){i=o.FKind;break}return i},rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas["WEBLib.TMSFNCTypes"].ITMSFNCProductInfo),rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TTMSFNCFillKindSelector",this.TTMSFNCCustomFillKindSelector,(function(){this.RegisterRuntimeClasses=function(){pas["WEBLib.TMSFNCCustomSelector"].TTMSFNCCustomSelector.RegisterRuntimeClasses.call(this),pas.Classes.RegisterClasses([t.TTMSFNCFillKindSelector,t.TTMSFNCFillKindSelectorItem])},rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas["WEBLib.TMSFNCTypes"].ITMSFNCProductInfo),rtl.addIntf(this,pas.System.IUnknown);var e=this.$rtti;e.addProperty("Appearance",2,pas["WEBLib.TMSFNCCustomSelector"].$rtti.TTMSFNCCustomSelectorAppearance,"FAppearance","SetAppearance"),e.addProperty("Rows",2,rtl.longint,"FRows","SetRows",{Default:4}),e.addProperty("Columns",2,rtl.longint,"FColumns","SetColumns",{Default:4}),e.addProperty("Items",3,t.$rtti.TTMSFNCFillKindSelectorItems,"GetItems","SetItems$1"),e.addProperty("SelectedItemIndex",2,rtl.longint,"FSelectedItemIndex","SetSelectedItemIndex",{Default:-1}),e.addProperty("OnFillKindSelected",0,t.$rtti.TTMSFNCCustomFillKindSelectorFillKindSelected,"FOnFillKindSelected","FOnFillKindSelected"),e.addProperty("OnFillKindDeselected",0,t.$rtti.TTMSFNCCustomFillKindSelectorFillKindDeselected,"FOnFillKindDeselected","FOnFillKindDeselected"),e.addProperty("OnItemClick",0,pas["WEBLib.TMSFNCCustomSelector"].$rtti.TTMSFNCCustomSelectorItemClick,"FOnItemClick","FOnItemClick"),e.addProperty("OnItemSelected",0,pas["WEBLib.TMSFNCCustomSelector"].$rtti.TTMSFNCCustomSelectorItemSelected,"FOnItemSelected","FOnItemSelected"),e.addProperty("OnItemDeselected",0,pas["WEBLib.TMSFNCCustomSelector"].$rtti.TTMSFNCCustomSelectorItemDeselected,"FOnItemDeselected","FOnItemDeselected"),e.addProperty("OnItemBeforeDrawBackground",0,pas["WEBLib.TMSFNCCustomSelector"].$rtti.TTMSFNCCustomSelectorItemBeforeDrawBackground,"FOnItemBeforeDrawBackground","FOnItemBeforeDrawBackground"),e.addProperty("OnItemAfterDrawBackground",0,pas["WEBLib.TMSFNCCustomSelector"].$rtti.TTMSFNCCustomSelectorItemAfterDrawBackground,"FOnItemAfterDrawBackground","FOnItemAfterDrawBackground"),e.addProperty("OnItemBeforeDrawContent",0,pas["WEBLib.TMSFNCCustomSelector"].$rtti.TTMSFNCCustomSelectorItemBeforeDrawContent,"FOnItemBeforeDrawContent","FOnItemBeforeDrawContent"),e.addProperty("OnItemAfterDrawContent",0,pas["WEBLib.TMSFNCCustomSelector"].$rtti.TTMSFNCCustomSelectorItemAfterDrawContent,"FOnItemAfterDrawContent","FOnItemAfterDrawContent"),e.addProperty("OnBeforeDraw",0,pas["WEBLib.TMSFNCCustomSelector"].$rtti.TTMSFNCCustomSelectorBeforeDraw,"FOnBeforeDraw$1","FOnBeforeDraw$1"),e.addProperty("OnAfterDraw",0,pas["WEBLib.TMSFNCCustomSelector"].$rtti.TTMSFNCCustomSelectorAfterDraw,"FOnAfterDraw$1","FOnAfterDraw$1"),e.addProperty("OnItemBeforeDrawText",0,pas["WEBLib.TMSFNCCustomSelector"].$rtti.TTMSFNCCustomSelectorItemBeforeDrawText,"FOnItemBeforeDrawText","FOnItemBeforeDrawText"),e.addProperty("OnItemAfterDrawText",0,pas["WEBLib.TMSFNCCustomSelector"].$rtti.TTMSFNCCustomSelectorItemAfterDrawText,"FOnItemAfterDrawText","FOnItemAfterDrawText"),e.attr=[pas.Classes.ComponentPlatformsAttribute,"Create$1",[0]]})),this.TTMSFNCFILLKINDSELECTORTEXTURE="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAACXBIWXMAAA7DAAAOwwHHb6hkAAABq0lEQVRIie2UTSgEYRjHfzZFONjSHBw2a/NR4yO0PpIcOJCDHDjIwWk3JQ5KOXHi5rSnPTlIUkoKSbZY8rGtQls+DkstsmRt2GYonHYYs+tj27j4nd555un/e97edwb++WsSACwWy0u8g+12ewJAYriwo6uNW3jp84qyTozUUGc2UpYjcOgLsLTtJSQ9xSzTCPrbK2itMSnPLdUmOkcWELMFSnIFnLs+Ti9uYxOI2YIqHEA06BkbaEQ06AHobS6i27bClueMjoYCyvMEfFcPuI/9LLu80QUZ+lSaKo0RpwiHh7F1fzivfGitMeGpz2dwbAPO3l7pwouF4WbN9D9FNOjpaytV1XRRemPCHwxQaExX1SLeop9yL0vM76wz63JSbMz9vuBeljjxnwOQJWSSlpSsmXh0bhLf9aVS2/UekfqVwB8MMLXpYPNwX6mlJCVTX2SmraoOAIfHzcz2Kjd3wU93pxI4PG4m15YIyZKmMSRLzLqcrB3sIT3KEXs+FdgWp1UTR+OriT+i3KLvhMeCsoPxnqG4hVqtVq3A3DURN8H7T00RvP/F/vOrvAIm+obDWiBLpwAAAABJRU5ErkJggg==",t.$init=function(){pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.CreateFromResource(t.TTMSFNCFILLKINDSELECTORTEXTURE)}}),["WEBLib.TMSFNCUtils"]),rtl.module("WEBLib.TMSFNCFillKindPicker",["System","Classes","WEBLib.TMSFNCCustomPicker","WEBLib.TMSFNCFillKindSelector","WEBLib.TMSFNCGraphics","WEBLib.TMSFNCCustomSelector","WEBLib.TMSFNCGraphicsTypes","WEBLib.TMSFNCTypes","Types"],(function(){"use strict";var t=this;this.MAJ_VER=1,this.MIN_VER=0,this.REL_VER=1,this.BLD_VER=0,rtl.createClass(this,"TTMSFNCCustomFillKindPicker",pas["WEBLib.TMSFNCCustomPicker"].TTMSFNCDefaultPicker,(function(){this.$init=function(){pas["WEBLib.TMSFNCCustomPicker"].TTMSFNCDefaultPicker.$init.call(this),this.FFillKindSelector=null,this.FOnFillKindSelected=null,this.FOnFillKindDeselected=null,this.FCloseOnSelection=!1},this.$final=function(){this.FFillKindSelector=void 0,this.FOnFillKindSelected=void 0,this.FOnFillKindDeselected=void 0,pas["WEBLib.TMSFNCCustomPicker"].TTMSFNCDefaultPicker.$final.call(this)},this.SetItems$1=function(t){this.FFillKindSelector.GetItems().Assign(t)},this.SetSelectedFillKind=function(t){this.FFillKindSelector.SetSelectedFillKind(t),this.Invalidate()},this.GetItems$1=function(){return this.FFillKindSelector.GetItems()},this.GetSelectedFillKind=function(){return this.FFillKindSelector.GetSelectedFillKind()},this.DrawContent=function(e,i){var s=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),o=null;pas["WEBLib.TMSFNCCustomPicker"].TTMSFNCCustomPicker.DrawContent.apply(this,arguments),s.$assign(i),pas["WEBLib.TMSFNCTypes"].InflateRectEx(s,this.ScalePaintValue(-4),this.ScalePaintValue(-4)),e.FFill.SetKind(this.GetSelectedFillKind());var n=this.GetSelectedFillKind();if(0===n)e.DrawText$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(s),"None",!1,1,0,0,0,-1,-1,!0,!1,-1,-1),pas["WEBLib.TMSFNCTypes"].InflateRectEx(s,this.ScalePaintValue(-28),0),pas["WEBLib.TMSFNCTypes"].OffsetRectEx$1(s,this.ScalePaintValue(28),0),e.FStroke.SetKind(1),e.FStroke.SetColor(12632256),e.DrawRectangle$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(s),2);else if(1===n)e.DrawText$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(s),"Solid",!1,1,0,0,0,-1,-1,!0,!1,-1,-1),pas["WEBLib.TMSFNCTypes"].InflateRectEx(s,this.ScalePaintValue(-28),0),pas["WEBLib.TMSFNCTypes"].OffsetRectEx$1(s,this.ScalePaintValue(28),0),e.FFill.SetColor(16436871),e.FStroke.SetKind(1),e.FStroke.SetColor(16436871),e.DrawRectangle$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(s),2);else if(2===n)e.DrawText$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(s),"Gradient",!1,1,0,0,0,-1,-1,!0,!1,-1,-1),pas["WEBLib.TMSFNCTypes"].InflateRectEx(s,this.ScalePaintValue(-28),0),pas["WEBLib.TMSFNCTypes"].OffsetRectEx$1(s,this.ScalePaintValue(28),0),e.FFill.SetColor(16436871),e.FFill.SetColorTo(14772545),e.FStroke.SetKind(0),e.DrawRectangle$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(s),2);else if(3===n){e.DrawText$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(s),"Texture",!1,1,0,0,0,-1,-1,!0,!1,-1,-1),pas["WEBLib.TMSFNCTypes"].InflateRectEx(s,this.ScalePaintValue(-24),this.ScalePaintValue(4)),pas["WEBLib.TMSFNCTypes"].OffsetRectEx$1(s,this.ScalePaintValue(29),0),pas["WEBLib.TMSFNCTypes"].OffsetRectEx$1(s,-1,-1),o=pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.CreateFromResource$1(t.TTMSFNCFILLKINDSELECTORTEXTURE,pas["WEBLib.TMSFNCTypes"].HInstance());try{e.DrawBitmap$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(Math.round(s.Left),Math.round(s.Top),Math.round(s.Right),Math.round(s.Bottom))),o,!0,!0,!0,!1)}finally{o=rtl.freeLoc(o)}}},this.DoFillKindSelected=function(){null!=this.FOnFillKindSelected&&this.FOnFillKindSelected(this,this.GetSelectedFillKind()),this.Invalidate()},this.FillKindSelected=function(t,e){this.FCloseOnSelection&&this.DropDown(),null!=this.FOnFillKindSelected&&this.FOnFillKindSelected(this,e),this.Invalidate()},this.FillKindDeselected=function(t,e){null!=this.FOnFillKindDeselected&&this.FOnFillKindDeselected(this,e),this.Invalidate()},this.SelectFirstValue=function(){pas["WEBLib.TMSFNCCustomPicker"].TTMSFNCCustomPicker.SelectFirstValue.call(this),this.FFillKindSelector.GetItems().GetCount()>0&&(this.FFillKindSelector.SetSelectedItemIndex(0),this.DoFillKindSelected())},this.SelectLastValue=function(){pas["WEBLib.TMSFNCCustomPicker"].TTMSFNCCustomPicker.SelectLastValue.call(this),this.FFillKindSelector.GetItems().GetCount()>0&&(this.FFillKindSelector.SetSelectedItemIndex(this.FFillKindSelector.GetItems().GetCount()-1),this.DoFillKindSelected())},this.SelectNextValue=function(){pas["WEBLib.TMSFNCCustomPicker"].TTMSFNCCustomPicker.SelectNextValue.call(this),this.FFillKindSelector.GetItems().GetCount()>0&&(-1===this.FFillKindSelector.FSelectedItemIndex?this.FFillKindSelector.SetSelectedItemIndex(0):this.FFillKindSelector.SetSelectedItemIndex(Math.min(this.FFillKindSelector.GetItems().GetCount()-1,this.FFillKindSelector.FSelectedItemIndex+1)),this.DoFillKindSelected())},this.SelectPreviousValue=function(){pas["WEBLib.TMSFNCCustomPicker"].TTMSFNCCustomPicker.SelectPreviousValue.call(this),this.FFillKindSelector.GetItems().GetCount()>0&&(-1===this.FFillKindSelector.FSelectedItemIndex?this.FFillKindSelector.SetSelectedItemIndex(0):this.FFillKindSelector.SetSelectedItemIndex(Math.max(0,this.FFillKindSelector.FSelectedItemIndex-1)),this.DoFillKindSelected())},this.GetVersion=function(){return this.$class.GetVersionNumber(1,0,1,0)},this.CreateSelector=function(){return this.FFillKindSelector=pas["WEBLib.TMSFNCFillKindSelector"].TTMSFNCFillKindSelector.$create("Create$1",[this]),this.FFillKindSelector.FOnFillKindSelected=rtl.createCallback(this,"FillKindSelected"),this.FFillKindSelector.FOnFillKindDeselected=rtl.createCallback(this,"FillKindDeselected"),this.FFillKindSelector.InitializeDefault(),this.FFillKindSelector},this.Create$1=function(t){return pas["WEBLib.TMSFNCCustomPicker"].TTMSFNCCustomPicker.Create$1.apply(this,arguments),this.FCloseOnSelection=!0,this.SetHeight(25),this.SetWidth(100),this.SetDropDownHeight(121),this.SetDropDownWidth(121),this},rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas["WEBLib.TMSFNCTypes"].ITMSFNCProductInfo),rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TTMSFNCFillKindPicker",this.TTMSFNCCustomFillKindPicker,(function(){this.RegisterRuntimeClasses=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.RegisterRuntimeClasses.call(this),pas.Classes.RegisterClass(t.TTMSFNCFillKindPicker)},rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas["WEBLib.TMSFNCTypes"].ITMSFNCProductInfo),rtl.addIntf(this,pas.System.IUnknown);var e=this.$rtti;e.addProperty("DropDownWidth",14,rtl.double,"FDropDownWidth","SetDropDownWidth",{stored:"IsDropDownWidthStored"}),e.addProperty("DropDownHeight",14,rtl.double,"FDropDownHeight","SetDropDownHeight",{stored:"IsDropDownHeightStored"}),e.addProperty("Appearance",3,pas["WEBLib.TMSFNCCustomSelector"].$rtti.TTMSFNCCustomSelectorAppearance,"GetAppearance","SetAppearance"),e.addProperty("Rows",3,rtl.longint,"GetRows","SetRows",{Default:4}),e.addProperty("Columns",3,rtl.longint,"GetColumns","SetColumns",{Default:4}),e.addProperty("Items",3,pas["WEBLib.TMSFNCFillKindSelector"].$rtti.TTMSFNCFillKindSelectorItems,"GetItems$1","SetItems$1"),e.addProperty("CloseOnSelection",0,rtl.boolean,"FCloseOnSelection","FCloseOnSelection",{Default:!0}),e.addProperty("OnFillKindSelected",0,pas["WEBLib.TMSFNCFillKindSelector"].$rtti.TTMSFNCCustomFillKindSelectorFillKindSelected,"FOnFillKindSelected","FOnFillKindSelected"),e.addProperty("OnFillKindDeselected",0,pas["WEBLib.TMSFNCFillKindSelector"].$rtti.TTMSFNCCustomFillKindSelectorFillKindDeselected,"FOnFillKindDeselected","FOnFillKindDeselected"),e.addProperty("SelectedFillKind",3,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFillKind,"GetSelectedFillKind","SetSelectedFillKind",{Default:pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFillKind.gfkNone}),e.addProperty("OnItemSelected",0,pas["WEBLib.TMSFNCCustomSelector"].$rtti.TTMSFNCCustomSelectorItemSelected,"FOnItemSelected","FOnItemSelected"),e.addProperty("OnItemDeselected",0,pas["WEBLib.TMSFNCCustomSelector"].$rtti.TTMSFNCCustomSelectorItemDeselected,"FOnItemDeselected","FOnItemDeselected"),e.addProperty("OnItemClick",0,pas["WEBLib.TMSFNCCustomSelector"].$rtti.TTMSFNCCustomSelectorItemClick,"FOnItemClick","FOnItemClick"),e.addProperty("SelectedItemIndex",3,rtl.longint,"GetSelectedItemIndex","SetSelectedItemIndex",{Default:-1}),e.addProperty("OnPickerBeforeDraw",0,pas["WEBLib.TMSFNCCustomPicker"].$rtti.TTMSFNCCustomPickerBeforeDraw,"FOnPickerBeforeDraw","FOnPickerBeforeDraw"),e.addProperty("OnPickerAfterDraw",0,pas["WEBLib.TMSFNCCustomPicker"].$rtti.TTMSFNCCustomPickerAfterDraw,"FOnPickerAfterDraw","FOnPickerAfterDraw"),e.addProperty("OnItemBeforeDrawBackground",0,pas["WEBLib.TMSFNCCustomSelector"].$rtti.TTMSFNCCustomSelectorItemBeforeDrawBackground,"FOnItemBeforeDrawBackground","FOnItemBeforeDrawBackground"),e.addProperty("OnItemAfterDrawBackground",0,pas["WEBLib.TMSFNCCustomSelector"].$rtti.TTMSFNCCustomSelectorItemAfterDrawBackground,"FOnItemAfterDrawBackground","FOnItemAfterDrawBackground"),e.addProperty("OnItemBeforeDrawContent",0,pas["WEBLib.TMSFNCCustomSelector"].$rtti.TTMSFNCCustomSelectorItemBeforeDrawContent,"FOnItemBeforeDrawContent","FOnItemBeforeDrawContent"),e.addProperty("OnItemAfterDrawContent",0,pas["WEBLib.TMSFNCCustomSelector"].$rtti.TTMSFNCCustomSelectorItemAfterDrawContent,"FOnItemAfterDrawContent","FOnItemAfterDrawContent"),e.addProperty("OnBeforeDraw",0,pas["WEBLib.TMSFNCCustomSelector"].$rtti.TTMSFNCCustomSelectorBeforeDraw,"FOnBeforeDraw$1","FOnBeforeDraw$1"),e.addProperty("OnAfterDraw",0,pas["WEBLib.TMSFNCCustomSelector"].$rtti.TTMSFNCCustomSelectorAfterDraw,"FOnAfterDraw$1","FOnAfterDraw$1"),e.addProperty("OnItemBeforeDrawText",0,pas["WEBLib.TMSFNCCustomSelector"].$rtti.TTMSFNCCustomSelectorItemBeforeDrawText,"FOnItemBeforeDrawText","FOnItemBeforeDrawText"),e.addProperty("OnItemAfterDrawText",0,pas["WEBLib.TMSFNCCustomSelector"].$rtti.TTMSFNCCustomSelectorItemAfterDrawText,"FOnItemAfterDrawText","FOnItemAfterDrawText"),e.attr=[pas.Classes.ComponentPlatformsAttribute,"Create$1",[0]]})),this.TTMSFNCFILLKINDSELECTORTEXTURE="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAACXBIWXMAAA7DAAAOwwHHb6hkAAABq0lEQVRIie2UTSgEYRjHfzZFONjSHBw2a/NR4yO0PpIcOJCDHDjIwWk3JQ5KOXHi5rSnPTlIUkoKSbZY8rGtQls+DkstsmRt2GYonHYYs+tj27j4nd555un/e97edwb++WsSACwWy0u8g+12ewJAYriwo6uNW3jp84qyTozUUGc2UpYjcOgLsLTtJSQ9xSzTCPrbK2itMSnPLdUmOkcWELMFSnIFnLs+Ti9uYxOI2YIqHEA06BkbaEQ06AHobS6i27bClueMjoYCyvMEfFcPuI/9LLu80QUZ+lSaKo0RpwiHh7F1fzivfGitMeGpz2dwbAPO3l7pwouF4WbN9D9FNOjpaytV1XRRemPCHwxQaExX1SLeop9yL0vM76wz63JSbMz9vuBeljjxnwOQJWSSlpSsmXh0bhLf9aVS2/UekfqVwB8MMLXpYPNwX6mlJCVTX2SmraoOAIfHzcz2Kjd3wU93pxI4PG4m15YIyZKmMSRLzLqcrB3sIT3KEXs+FdgWp1UTR+OriT+i3KLvhMeCsoPxnqG4hVqtVq3A3DURN8H7T00RvP/F/vOrvAIm+obDWiBLpwAAAABJRU5ErkJggg==",t.$init=function(){pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.CreateFromResource(t.TTMSFNCFILLKINDSELECTORTEXTURE)}}),["Math","WEBLib.TMSFNCUtils"]),rtl.module("WEBLib.TMSFNCCustomGroup",["System","Classes","SysUtils","TypInfo","WEBLib.TMSFNCCustomControl","WEBLib.TMSFNCGraphics","WEBLib.Controls","WEBLib.TMSFNCTypes","WEBLib.TMSFNCBitmapContainer","WEBLib.TMSFNCUtils","WEBLib.TMSFNCGraphicsTypes"],(function(){"use strict";var t=this;rtl.createClass(this,"TTMSFNCCustomGroupList",pas.Classes.TList,(function(){this.GetItem=function(t){return rtl.getObject(this.Get(t))}})),rtl.createClass(this,"TTMSFNCGroupTitle",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FText="",this.FOnChange=null,this.FFont=null,this.FAlignment=0},this.$final=function(){this.FOnChange=void 0,this.FFont=void 0,pas.Classes.TPersistent.$final.call(this)},this.SetText=function(t){this.FText!==t&&(this.FText=t,this.Changed())},this.SetFont=function(t){this.FFont.Assign(t)},this.SetAlignment=function(t){this.FAlignment!==t&&(this.FAlignment=t,this.Changed())},this.FontChanged=function(t){null!=this.FOnChange&&this.FOnChange(this)},this.Changed=function(){null!=this.FOnChange&&this.FOnChange(this)},this.Create$1=function(){return this.FFont=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFont.$create("Create$2"),this.FFont.FOnChanged=rtl.createCallback(this,"FontChanged"),this.FAlignment=1,this},this.Destroy=function(){rtl.free(this,"FFont"),pas.System.TObject.Destroy.call(this)},this.Assign=function(e){t.TTMSFNCGroupTitle.isPrototypeOf(e)&&(this.FFont.Assign(rtl.as(e,t.TTMSFNCGroupTitle).FFont),this.FText=rtl.as(e,t.TTMSFNCGroupTitle).FText,this.FAlignment=rtl.as(e,t.TTMSFNCGroupTitle).FAlignment)};var e=this.$rtti;e.addProperty("Text",2,rtl.string,"FText","SetText"),e.addProperty("Font",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFont,"FFont","SetFont"),e.addProperty("Alignment",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsTextAlign,"FAlignment","SetAlignment",{Default:pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsTextAlign.gtaLeading})})),rtl.createClass(this,"TTMSFNCCustomGroup",pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl,(function(){this.$init=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.$init.call(this),this.FUpdateCount$1=0,this.FBitmapContainer=null,this.FControls$1=null,this.FItems=null,this.FColumns=0,this.FIsReadingControl=!1,this.FIsUpdatingControl=!1,this.FFont$1=null,this.FTitle=null,this.FOnSetControlProperties=null,this.FOnGetControlClass=null,this.FOnUpdateControlProperties=null,this.FOnSetControlText=null,this.FOnItemsChanged=null,this.FOnSetControlBounds=null,this.FOnSetControlName=null},this.$final=function(){this.FBitmapContainer=void 0,this.FControls$1=void 0,this.FItems=void 0,this.FFont$1=void 0,this.FTitle=void 0,this.FOnSetControlProperties=void 0,this.FOnGetControlClass=void 0,this.FOnUpdateControlProperties=void 0,this.FOnSetControlText=void 0,this.FOnItemsChanged=void 0,this.FOnSetControlBounds=void 0,this.FOnSetControlName=void 0,pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.$final.call(this)},this.GetControl=function(t){var e=null;return e=null,t>=0&&t<=this.FControls$1.GetCount()-1&&(e=this.FControls$1.GetItem(t)),e},this.SetControlCount=function(t){var e=null;if(!(3 in this.FComponentState)){for(;this.FControls$1.GetCount()<t;)(e=this.GetControlClass(this.FControls$1.GetCount()).$create("Create$1",[this])).SetParent(this),this.SetControlProperties(e,this.FControls$1.GetCount()),this.FControls$1.Add(e);for(;this.FControls$1.GetCount()>t;)e=rtl.getObject(this.FControls$1.Last()),this.FControls$1.Remove(e),e=rtl.freeLoc(e)}},this.SetColumns=function(t){t=Math.max(1,Math.min(t,16)),this.FColumns!==t&&(this.FColumns=t,this.ArrangeControls(),this.Invalidate())},this.SetItems=function(t){this.FItems.Assign(t)},this.SetFnt=function(t){this.FFont$1.Assign(t)},this.GetBitmapContainer=function(){return this.FBitmapContainer},this.SetBitmapContainer=function(t){this.FBitmapContainer=t,this.UpdateAllControlProperties(),this.ArrangeControls(),this.Invalidate()},this.GetDocURL=function(){return pas["WEBLib.TMSFNCTypes"].TTMSFNCBaseDocURL+"tmsfncuipack/components/"+pas.SysUtils.LowerCase(this.$classname)},this.ApplyStyle=function(){var t=0;pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.ApplyStyle.call(this),t=-1,pas["WEBLib.TMSFNCStyles"].TTMSFNCStyles.GetStyleTextFontColor({get:function(){return t},set:function(e){t=e}})&&this.FFont$1.SetColor(t)},this.ResetToDefaultStyle=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.ResetToDefaultStyle.call(this),this.FFont$1.SetColor(0)},this.CreateAdditionalControls=function(){},this.InitializeProperties=function(){},this.ArrangeControls=function(){var t=0,e=0,i=0,s=0,o=0,n=null,r=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),a=0,l=0,h=0,F=0;if(!(this.FUpdateCount$1>0||null==this.FControls$1||0===this.FControls$1.GetCount()||this.FIsReadingControl)){r.$assign(this.GetTitleRect()),t=rtl.trunc((this.FControls$1.GetCount()+this.FColumns-1)/this.FColumns),i=(this.GetWidth()-this.ScalePaintValue(10))/this.FColumns,e=Math.round(this.GetHeight()-(r.Bottom-r.Top))-this.ScalePaintValue(12),s=rtl.trunc(e/t),o=r.Bottom-r.Top+this.ScalePaintValue(6)+rtl.trunc(e%t/2);for(var p=0,c=this.FControls$1.GetCount()-1;p<=c;p++)e=p,n=this.FControls$1.GetItem(e),this.SetControlName(n,e),this.SetControlEnabled(n,e),a=rtl.trunc(e/t)*i+this.ScalePaintValue(8),l=e%t*s+o,h=i,F=s,n.SetEnabled(this.FEnabled),n.SetBounds(Math.round(a),Math.round(l),Math.round(Math.max(0,h)),Math.round(Math.max(0,F))),this.SetControlBounds(n,e,a,l,h,F)}},this.ItemsChange=function(t){this.FIsReadingControl||(this.ItemsChanged(),this.UpdateControls())},this.FntChanged=function(t){var e=0;if(!this.FIsReadingControl)for(var i=0,s=this.FControls$1.GetCount()-1;i<=s;i++)e=i,this.UpdateControlProperties(this.FControls$1.GetItem(e),e)},this.UpdateControls=function(){var t=0;if(!(this.FUpdateCount$1>0)){this.SetControlCount(this.FItems.GetCount());for(var e=0,i=this.FControls$1.GetCount()-1;e<=i;e++)t=e,this.SetControlText(this.FControls$1.GetItem(t),t,this.FItems.Get(t)),this.UpdateControlProperties(this.FControls$1.GetItem(t),t);this.FIsUpdatingControl=!0,this.UpdateItemIndexControl(),this.FIsUpdatingControl=!1,this.ArrangeControls(),this.Invalidate()}},this.SetEnabled=function(t){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.SetEnabled.apply(this,arguments),this.ArrangeControls()},this.UpdateAllControlProperties=function(){var t=0;if(!(this.FUpdateCount$1>0))for(var e=0,i=this.FControls$1.GetCount()-1;e<=i;e++)t=e,this.UpdateControlProperties(this.FControls$1.GetItem(t),t)},this.TitleChanged=function(t){this.ArrangeControls(),this.Invalidate()},this.ItemsChanged=function(){this.DoItemsChanged()},this.UpdateItemIndexControl=function(){},this.SetName=function(t){pas["WEBLib.Controls"].TCustomControl.SetName.apply(this,arguments),this.ArrangeControls()},this.Notification=function(t,e){pas["WEBLib.Menus"].TWebCustomControl.Notification.apply(this,arguments),1===e&&t===this.FBitmapContainer&&(this.FBitmapContainer=null)},this.SetControlName=function(t,e){this.DoSetControlName(t,e)},this.SetControlEnabled=function(t,e){},this.SetControlBounds=function(t,e,i,s,o,n){this.DoSetControlBounds(t,e,i,s,o,n)},this.SetControlText=function(t,e,i){this.DoSetControlText(t,e,i)},this.SetControlProperties=function(t,e){this.DoSetControlProperties(t,e)},this.UpdateControlProperties=function(t,e){this.DoUpdateControlProperties(t,e)},this.Loaded=function(){pas["WEBLib.Controls"].TCustomControl.Loaded.call(this),this.ArrangeControls()},this.DoSetControlProperties=function(t,e){null!=this.FOnSetControlProperties&&this.FOnSetControlProperties(this,t,e)},this.DoSetControlName=function(t,e){null!=this.FOnSetControlName&&this.FOnSetControlName(this,t,e)},this.DoSetControlText=function(t,e,i){null!=this.FOnSetControlText&&this.FOnSetControlText(this,t,e,i)},this.DoSetControlBounds=function(t,e,i,s,o,n){null!=this.FOnSetControlBounds&&this.FOnSetControlBounds(this,t,e,i,s,o,n)},this.DoUpdateControlProperties=function(t,e){null!=this.FOnUpdateControlProperties&&this.FOnUpdateControlProperties(this,t,e)},this.DoItemsChanged=function(){null!=this.FOnItemsChanged&&this.FOnItemsChanged(this)},this.DoGetControlClass=function(t,e){null!=this.FOnGetControlClass&&this.FOnGetControlClass(this,t,e)},this.CanDrawTitle=function(){return""!==this.FTitle.FText},this.GetControlClass=function(t){var e=null;return e=pas["WEBLib.Controls"].TControl,this.DoGetControlClass(t,{get:function(){return e},set:function(t){e=t}}),e},this.GetTitleRect=function(){var t=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),e=null;if(t.$assign(pas["WEBLib.TMSFNCTypes"].RectF(0,0,0,0)),""!==this.FTitle.FText){(e=pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.$create("CreateBitmapCanvas",[1,1,!1,!0])).BeginScene();try{e.FOptimizedHTMLDrawing=this.FOptimizedHTMLDrawing,e.FBitmapContainer=this.GetBitmapContainer(),e.FFont.Assign(this.FTitle.FFont),t.$assign(e.CalculateText(this.FTitle.FText,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(this.GetLocalRect()),!1,!0)),t.Right=t.Right+6}finally{e.EndScene(),e=rtl.freeLoc(e)}}return t},this.GetTitleDrawRect=function(t){var e=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),i=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),s=pas["WEBLib.TMSFNCTypes"].TRectF.$new();s.$assign(this.GetTitleRect());var o=this.FTitle.FAlignment;return 0===o?i.$assign(pas["WEBLib.TMSFNCTypes"].RectF(t.Left+(t.Right-t.Left-(s.Right-s.Left))/2,t.Top+this.ScalePaintValue(2),t.Left+(t.Right-t.Left-(s.Right-s.Left))/2+(s.Right-s.Left),t.Top+this.ScalePaintValue(2)+(s.Bottom-s.Top))):1===o?i.$assign(pas["WEBLib.TMSFNCTypes"].RectF(t.Left+this.ScalePaintValue(4),t.Top+this.ScalePaintValue(2),t.Left+this.ScalePaintValue(4)+(s.Right-s.Left),t.Top+this.ScalePaintValue(2)+(s.Bottom-s.Top))):2===o&&i.$assign(pas["WEBLib.TMSFNCTypes"].RectF(t.Right-this.ScalePaintValue(4)-(s.Right-s.Left),t.Top+this.ScalePaintValue(2),t.Right-this.ScalePaintValue(4),t.Top+this.ScalePaintValue(2)+(s.Bottom-s.Top))),e.$assign(i),e},this.CreateGroupTitle=function(){return t.TTMSFNCGroupTitle.$create("Create$1")},this.IsAppearanceProperty=function(t,e,i){return pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.IsAppearanceProperty.call(this,t,e,i)||"Title"===e},this.Create$1=function(e){return pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Create$1.call(this,e),this.DisableFill(),this.SetParentColor(!0),this.FControls$1=t.TTMSFNCCustomGroupList.$create("Create$1"),this.FItems=pas.Classes.TStringList.$create("Create$1"),this.FTitle=this.CreateGroupTitle(),this.FTitle.FOnChange=rtl.createCallback(this,"TitleChanged"),this.FItems.FOnChange=rtl.createCallback(this,"ItemsChange"),this.FColumns=1,this.FFont$1=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFont.$create("Create$2"),this.FFont$1.FOnChanged=rtl.createCallback(this,"FntChanged"),this.CreateAdditionalControls(),this.InitializeProperties(),this.IsDesignTime()&&this.InitSample(),this.SetWidth(155),this.SetHeight(105),this},this.Destroy=function(){this.SetControlCount(0),rtl.free(this,"FTitle"),rtl.free(this,"FItems"),rtl.free(this,"FControls$1"),rtl.free(this,"FFont$1"),pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Destroy.call(this)},this.UpdateControlAfterResize=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.UpdateControlAfterResize.call(this),this.ArrangeControls()},this.Assign=function(e){t.TTMSFNCCustomGroup.isPrototypeOf(e)&&(this.FItems.Assign(rtl.as(e,t.TTMSFNCCustomGroup).FItems),this.FFont$1.Assign(rtl.as(e,t.TTMSFNCCustomGroup).FFont$1),this.FColumns=rtl.as(e,t.TTMSFNCCustomGroup).FColumns,this.FTitle.Assign(rtl.as(e,t.TTMSFNCCustomGroup).FTitle))},this.InitSample=function(){this.BeginUpdate(),this.FItems.Clear(),this.FItems.Add("Analysts"),this.FItems.Add("Assistants"),this.FItems.Add("Managers"),this.FItems.Add("Specialists"),this.EndUpdate()},this.Reinitialize=function(){var t=null;if(!(this.FUpdateCount$1>0)){for(;this.FControls$1.GetCount()>0;)t=rtl.getObject(this.FControls$1.Last()),this.FControls$1.Remove(t),t=rtl.freeLoc(t);this.UpdateControls()}},this.BeginUpdate=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBase.BeginUpdate.call(this),this.FUpdateCount$1+=1},this.EndUpdate=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBase.EndUpdate.call(this),this.FUpdateCount$1-=1,0===this.FUpdateCount$1&&this.Reinitialize()},this.Draw=function(t,e){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Draw.apply(this,arguments),this.DrawText(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e))},this.DrawBackground=function(t,e){var i=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),s=pas["WEBLib.TMSFNCTypes"].TRectF.$new();if(this.CanDrawTitle()){i.$assign(e),s.$assign(this.GetTitleRect()),i.Top=i.Top+4+(s.Bottom-s.Top)/2,t.FFill.Assign(this.FFill),t.FFill.SetColor(this.FColor),t.FStroke.SetKind(0),t.DrawRectangle$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),2),t.FStroke.Assign(this.FStroke),t.DrawRectangle$3(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),rtl.createSet(0,3,2),2);var o=this.FTitle.FAlignment;0===o?(t.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(i.Left,i.Top)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(i.Left+(i.Right-i.Left-(s.Right-s.Left))/2,i.Top)),2,2),t.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(i.Left+(i.Right-i.Left-(s.Right-s.Left))/2+(s.Right-s.Left),i.Top)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(i.Right,i.Top)),2,2)):1===o?(t.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(i.Left,i.Top)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(i.Left+this.ScalePaintValue(4),i.Top)),2,2),t.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(Math.min(i.Left+this.ScalePaintValue(4)+(s.Right-s.Left),i.Right),i.Top)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(i.Right,i.Top)),2,2)):2===o&&(t.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(i.Right-this.ScalePaintValue(4),i.Top)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(i.Right,i.Top)),2,2),t.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(i.Left,i.Top)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(i.Right-this.ScalePaintValue(4)-(s.Right-s.Left),i.Top)),2,2))}else pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.DrawBackground.apply(this,arguments)},this.DrawText=function(t,e){var i=pas["WEBLib.TMSFNCTypes"].TRectF.$new();""!==this.FTitle.FText&&(t.FBitmapContainer=this.GetBitmapContainer(),t.FFont.Assign(this.FTitle.FFont),i.$assign(this.GetTitleDrawRect(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e))),t.DrawText$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),this.FTitle.FText,!1,0,0,0,0,-1,-1,!0,!1,-1,-1))},rtl.addIntf(this,pas["WEBLib.TMSFNCBitmapContainer"].ITMSFNCBitmapContainer),rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas["WEBLib.TMSFNCTypes"].ITMSFNCProductInfo),rtl.addIntf(this,pas.System.IUnknown)}))}),["Math","WEBLib.TMSFNCStyles","WEBLib.Graphics"]),rtl.module("WEBLib.TMSFNCCheckGroup",["System","Classes","WEBLib.TMSFNCCustomControl","WEBLib.TMSFNCCustomGroup","WEBLib.TMSFNCGraphicsTypes","WEBLib.TMSFNCTypes","WEBLib.StdCtrls","WEBLib.Controls","WEBLib.TMSFNCHTMLText","Types"],(function(){"use strict";var t=this;this.MAJ_VER=1,this.MIN_VER=0,this.REL_VER=2,this.BLD_VER=1,rtl.createClass(this,"TTMSFNCCheckHTMLText",pas["WEBLib.TMSFNCHTMLText"].TTMSFNCHTMLText,(function(){this.RegisterRuntimeClasses=function(){pas["WEBLib.TMSFNCHTMLText"].TTMSFNCHTMLText.RegisterRuntimeClasses.call(this),pas.Classes.RegisterClass(t.TTMSFNCCheckHTMLText)},this.CanDrawDesignTime=function(){return!1,!1},rtl.addIntf(this,pas["WEBLib.TMSFNCBitmapContainer"].ITMSFNCBitmapContainer),rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas["WEBLib.TMSFNCTypes"].ITMSFNCProductInfo),rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TTMSFNCCheckContainer",pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl,(function(){this.$init=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.$init.call(this),this.FCheckBox=null,this.FHTMLText=null},this.$final=function(){this.FCheckBox=void 0,this.FHTMLText=void 0,pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.$final.call(this)},this.RegisterRuntimeClasses=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.RegisterRuntimeClasses.call(this),pas.Classes.RegisterClass(t.TTMSFNCCheckContainer)},this.Create$1=function(e){return pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Create$1.apply(this,arguments),this.SetTabStop(!1),this.DisableBackground(),this.FCheckBox=pas["WEBLib.StdCtrls"].TCheckBox.$create("Create$1",[this]),this.FCheckBox.SetParent(this),this.FCheckBox.SetWidth(this.FCheckBox.GetHeight()),this.SetHeight(this.FCheckBox.GetHeight()),this.FHTMLText=t.TTMSFNCCheckHTMLText.$create("Create$1",[this]),this.FHTMLText.SetAllowFocus(!1),this.FHTMLText.SetParent(this),this.FHTMLText.DisableBackground(),this.FHTMLText.SetHorizontalTextAlign(1),this.SetParentColor(!0),this.FHTMLText.SetParentColor(!0),this.FHTMLText.SetAlign(5),this.FCheckBox.SetAlign(3),this},this.Destroy=function(){null!=this.FCheckBox&&rtl.free(this,"FCheckBox"),null!=this.FHTMLText&&rtl.free(this,"FHTMLText"),pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Destroy.call(this)},rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas["WEBLib.TMSFNCTypes"].ITMSFNCProductInfo),rtl.addIntf(this,pas.System.IUnknown)})),this.TTMSFNCCheckGroupTitleCheckBoxMode={0:"cgtcmNone",cgtcmNone:0,1:"cgtcmCheckAll",cgtcmCheckAll:1,2:"cgtcmToggleEnabled",cgtcmToggleEnabled:2},this.$rtti.$Enum("TTMSFNCCheckGroupTitleCheckBoxMode",{minvalue:0,maxvalue:2,ordtype:1,enumtype:this.TTMSFNCCheckGroupTitleCheckBoxMode}),this.$rtti.$MethodVar("TTMSFNCCheckGroupClickEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AItemIndex",rtl.longint],["AValue",rtl.nativeint]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCCheckGroupTitleAnchorClickEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AAnchor",rtl.string]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCCheckGroupItemAnchorClickEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AItemIndex",rtl.longint],["AAnchor",rtl.string]]),methodkind:0}),rtl.createClass(this,"TTMSFNCCheckGroupTitle",pas["WEBLib.TMSFNCCustomGroup"].TTMSFNCGroupTitle,(function(){this.$init=function(){pas["WEBLib.TMSFNCCustomGroup"].TTMSFNCGroupTitle.$init.call(this),this.FCheckBoxMode=0,this.FShowCheckBox=!1,this.FOnGetCheckState=null,this.FOnSetCheckState=null},this.$final=function(){this.FOnGetCheckState=void 0,this.FOnSetCheckState=void 0,pas["WEBLib.TMSFNCCustomGroup"].TTMSFNCGroupTitle.$final.call(this)},this.SetCheckBoxMode=function(t){this.FCheckBoxMode!==t&&(this.FCheckBoxMode=t,this.Changed())},this.SetShowCheckBox=function(t){this.FShowCheckBox!==t&&(this.FShowCheckBox=t,this.Changed())},this.GetChecked=function(){var t=!1;return t=!1,null!=this.FOnGetCheckState&&this.FOnGetCheckState(this,{get:function(){return t},set:function(e){t=e}}),t},this.SetChecked=function(t){null!=this.FOnSetCheckState&&this.FOnSetCheckState(this,t)},this.Create$1=function(){return pas["WEBLib.TMSFNCCustomGroup"].TTMSFNCGroupTitle.Create$1.call(this),this.FShowCheckBox=!1,this.FCheckBoxMode=1,this},this.Assign=function(e){pas["WEBLib.TMSFNCCustomGroup"].TTMSFNCGroupTitle.Assign.apply(this,arguments),t.TTMSFNCCheckGroupTitle.isPrototypeOf(e)&&(this.FCheckBoxMode=rtl.as(e,t.TTMSFNCCheckGroupTitle).FCheckBoxMode,this.FShowCheckBox=rtl.as(e,t.TTMSFNCCheckGroupTitle).FShowCheckBox,this.SetChecked(rtl.as(e,t.TTMSFNCCheckGroupTitle).GetChecked()))};var e=this.$rtti;e.addProperty("ShowCheckBox",2,rtl.boolean,"FShowCheckBox","SetShowCheckBox",{Default:!1}),e.addProperty("Checked",3,rtl.boolean,"GetChecked","SetChecked",{Default:!0}),e.addProperty("CheckBoxMode",2,t.$rtti.TTMSFNCCheckGroupTitleCheckBoxMode,"FCheckBoxMode","SetCheckBoxMode",{Default:t.TTMSFNCCheckGroupTitleCheckBoxMode.cgtcmCheckAll})})),rtl.createClass(this,"TTMSFNCCheckGroup",pas["WEBLib.TMSFNCCustomGroup"].TTMSFNCCustomGroup,(function(){this.$init=function(){pas["WEBLib.TMSFNCCustomGroup"].TTMSFNCCustomGroup.$init.call(this),this.FTitleCheckBox=null,this.FOnTitleCheckBoxClick=null,this.FOnCheckBoxClick=null,this.FOnTitleAnchorClick=null,this.FOnCheckboxAnchorClick=null,this.FOnCheckBoxDblClick=null},this.$final=function(){this.FTitleCheckBox=void 0,this.FOnTitleCheckBoxClick=void 0,this.FOnCheckBoxClick=void 0,this.FOnTitleAnchorClick=void 0,this.FOnCheckboxAnchorClick=void 0,this.FOnCheckBoxDblClick=void 0,pas["WEBLib.TMSFNCCustomGroup"].TTMSFNCCustomGroup.$final.call(this)},this.GetCheckBox=function(e){var i,s=null;return s=null,null!=(i=this.GetControl(e))&&t.TTMSFNCCheckContainer.isPrototypeOf(i)&&(s=rtl.as(i,t.TTMSFNCCheckContainer).FCheckBox),s},this.AlternativeClick=function(e){var i=null;null!=(i=pas["WEBLib.StdCtrls"].TCheckBox.isPrototypeOf(e)||t.TTMSFNCCheckHTMLText.isPrototypeOf(e)?rtl.as(rtl.as(e,pas["WEBLib.Controls"].TControl).FParent,pas["WEBLib.Controls"].TControl):rtl.as(e,pas["WEBLib.Controls"].TControl))&&this.SetControlCheckState(i,!this.GetControlCheckState(i)),this.ControlClick(e)},this.AlternativeDblClick=function(t){this.ControlDblClick(t)},this.AnchorClick=function(e,i){var s=0;s=pas["WEBLib.StdCtrls"].TCheckBox.isPrototypeOf(e)||t.TTMSFNCCheckHTMLText.isPrototypeOf(e)?this.FControls$1.IndexOf(rtl.as(rtl.as(e,pas["WEBLib.Controls"].TControl).FParent,pas["WEBLib.Controls"].TControl)):this.FControls$1.IndexOf(rtl.as(e,pas["WEBLib.Controls"].TControl)),this.DoCheckBoxAnchorClick(s,i)},this.GetChecked=function(t){var e=!1,i=null;return e=!1,null!=(i=this.GetCheckBox(t))&&(e=i.GetChecked()),e},this.SetChecked=function(t,e){var i=null,s=!1;null!=(i=this.GetCheckBox(t))&&(s=!1,i.HandleAllocated()||(s=!0,i.SetParent(pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.GetOwnerForm(this))),i.SetChecked(e),s&&i.SetParent(null))},this.SetValue=function(t){var e=0,i=0;i=1;for(var s=0,o=Math.min(this.FControls$1.GetCount(),64)-1;s<=o;s++)e=s,this.SetControlCheckState(this.FControls$1.GetItem(e),rtl.and(t,i)>0),i*=2},this.GetCheckContainer=function(e){var i,s=null;return s=null,null!=(i=this.GetControl(e))&&t.TTMSFNCCheckContainer.isPrototypeOf(i)&&(s=rtl.as(i,t.TTMSFNCCheckContainer)),s},this.GetTitle=function(){return this.FTitle},this.GetValue=function(){var t=0,e=0,i=0;t=0,i=1;for(var s=0,o=this.FControls$1.GetCount()-1;s<=o;s++)e=s,this.GetControlCheckState(this.GetControl(e))&&(t=rtl.or(t,i)),i*=2;return t},this.SetTitle$1=function(t){this.GetTitle().Assign(t)},this.RegisterRuntimeClasses=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.RegisterRuntimeClasses.call(this),pas.Classes.RegisterClass(t.TTMSFNCCheckGroup)},this.ControlClick=function(e){var i=0;this.FIsUpdatingControl||(i=pas["WEBLib.StdCtrls"].TCheckBox.isPrototypeOf(e)||t.TTMSFNCCheckHTMLText.isPrototypeOf(e)?this.FControls$1.IndexOf(rtl.as(rtl.as(e,pas["WEBLib.Controls"].TControl).FParent,pas["WEBLib.Controls"].TControl)):this.FControls$1.IndexOf(rtl.as(e,pas["WEBLib.Controls"].TControl)),null!=this.GetCheckContainer(i)&&this.GetCheckContainer(i).FCheckBox.SetFocus(),null!=this.FOnCheckBoxClick&&this.FOnCheckBoxClick(this,i,this.GetValue())),this.Click()},this.ControlEnter=function(t){this.DoEnter()},this.ControlExit=function(t){this.DoExit()},this.ControlDblClick=function(e){var i=0;this.FIsUpdatingControl||(i=pas["WEBLib.StdCtrls"].TCheckBox.isPrototypeOf(e)||t.TTMSFNCCheckHTMLText.isPrototypeOf(e)?this.FControls$1.IndexOf(rtl.as(rtl.as(e,pas["WEBLib.Controls"].TControl).FParent,pas["WEBLib.Controls"].TControl)):this.FControls$1.IndexOf(rtl.as(e,pas["WEBLib.Controls"].TControl)),null!=this.GetCheckContainer(i)&&this.GetCheckContainer(i).FCheckBox.SetFocus(),null!=this.FOnCheckBoxDblClick&&this.FOnCheckBoxDblClick(this,i,this.GetValue())),this.DblClick()},this.ArrangeControls=function(){var t=pas["WEBLib.TMSFNCTypes"].TRectF.$new();pas["WEBLib.TMSFNCCustomGroup"].TTMSFNCCustomGroup.ArrangeControls.call(this),null!=this.FTitleCheckBox&&(this.FTitleCheckBox.SetVisible(this.GetTitle().FShowCheckBox),this.FTitleCheckBox.FVisible?(this.FTitleCheckBox.SetParent(this),t.$assign(this.GetTitleDrawRect(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(this.GetLocalRect()))),this.FTitleCheckBox.SetLeft(Math.round(t.Left-this.FTitleCheckBox.GetWidth())),this.FTitleCheckBox.SetTop(Math.round(t.Top+(t.Bottom-t.Top-this.FTitleCheckBox.GetHeight())/2))):this.FTitleCheckBox.SetParent(null))},this.SetControlText=function(e,i,s){pas["WEBLib.TMSFNCCustomGroup"].TTMSFNCCustomGroup.SetControlText.apply(this,arguments),null!=e&&t.TTMSFNCCheckContainer.isPrototypeOf(e)&&rtl.as(e,t.TTMSFNCCheckContainer).FHTMLText.SetText(s)},this.SetControlCheckState=function(e,i){var s=null;null!=e&&t.TTMSFNCCheckContainer.isPrototypeOf(e)&&(s=rtl.as(e,t.TTMSFNCCheckContainer).FCheckBox.FOnClick,rtl.as(e,t.TTMSFNCCheckContainer).FCheckBox.FOnClick=null,rtl.as(e,t.TTMSFNCCheckContainer).FCheckBox.SetChecked(i),rtl.as(e,t.TTMSFNCCheckContainer).FCheckBox.FOnClick=s)},this.SetControlProperties=function(e,i){pas["WEBLib.TMSFNCCustomGroup"].TTMSFNCCustomGroup.SetControlProperties.apply(this,arguments),null!=e&&t.TTMSFNCCheckContainer.isPrototypeOf(e)&&(rtl.as(e,t.TTMSFNCCheckContainer).FCheckBox.FOnEnter=rtl.createCallback(this,"ControlEnter"),rtl.as(e,t.TTMSFNCCheckContainer).FCheckBox.FOnExit=rtl.createCallback(this,"ControlExit"),rtl.as(e,t.TTMSFNCCheckContainer).FCheckBox.FOnClick=rtl.createCallback(this,"ControlClick"),rtl.as(e,t.TTMSFNCCheckContainer).FHTMLText.FOnClick=rtl.createCallback(this,"AlternativeClick"),rtl.as(e,t.TTMSFNCCheckContainer).FHTMLText.FOnDblClick=rtl.createCallback(this,"AlternativeDblClick"),rtl.as(e,t.TTMSFNCCheckContainer).FHTMLText.FOnAnchorClick=rtl.createCallback(this,"AnchorClick"),rtl.as(e,t.TTMSFNCCheckContainer).FHTMLText.FOnEnter=rtl.createCallback(this,"ControlEnter"),rtl.as(e,t.TTMSFNCCheckContainer).FHTMLText.FOnExit=rtl.createCallback(this,"ControlExit"),rtl.as(e,t.TTMSFNCCheckContainer).FOnClick=rtl.createCallback(this,"AlternativeClick"),rtl.as(e,t.TTMSFNCCheckContainer).FOnDblClick=rtl.createCallback(this,"AlternativeDblClick"),rtl.as(e,t.TTMSFNCCheckContainer).FOnEnter=rtl.createCallback(this,"ControlEnter"),rtl.as(e,t.TTMSFNCCheckContainer).FOnExit=rtl.createCallback(this,"ControlExit"),rtl.as(e,t.TTMSFNCCheckContainer).FHTMLText.FFont$1.Assign(this.FFont$1))},this.UpdateControlProperties=function(e,i){pas["WEBLib.TMSFNCCustomGroup"].TTMSFNCCustomGroup.UpdateControlProperties.apply(this,arguments),null!=e&&t.TTMSFNCCheckContainer.isPrototypeOf(e)&&(rtl.as(e,t.TTMSFNCCheckContainer).FHTMLText.FFont$1.Assign(this.FFont$1),rtl.as(e,t.TTMSFNCCheckContainer).FHTMLText.SetBitmapContainer(this.GetBitmapContainer()))},this.TitleCheckBoxChange=function(t){var e=0,i=null;if(this.GetTitle().FShowCheckBox){var s=this.GetTitle().FCheckBoxMode;if(1===s)for(var o=0,n=this.FControls$1.GetCount()-1;o<=n;o++)e=o,null!=(i=this.GetControl(e))&&this.SetControlCheckState(i,this.GetTitle().GetChecked());else 2===s&&(this.ArrangeControls(),this.Invalidate());null!=this.FOnTitleCheckBoxClick&&this.FOnTitleCheckBoxClick(this)}},this.CreateAdditionalControls=function(){pas["WEBLib.TMSFNCCustomGroup"].TTMSFNCCustomGroup.CreateAdditionalControls.call(this),this.FTitleCheckBox=pas["WEBLib.StdCtrls"].TCheckBox.$create("Create$1",[this]),this.FTitleCheckBox.SetVisible(!1),this.FTitleCheckBox.SetWidth(this.FTitleCheckBox.GetHeight()),this.FTitleCheckBox.SetCaption(""),this.FTitleCheckBox.SetChecked(!0),this.FTitleCheckBox.FOnClick=rtl.createCallback(this,"TitleCheckBoxChange")},this.SetControlEnabled=function(e,i){pas["WEBLib.TMSFNCCustomGroup"].TTMSFNCCustomGroup.SetControlEnabled.apply(this,arguments),t.TTMSFNCCheckContainer.isPrototypeOf(e)&&(rtl.as(e,t.TTMSFNCCheckContainer).FHTMLText.SetEnabled(this.FEnabled),rtl.as(e,t.TTMSFNCCheckContainer).FCheckBox.SetEnabled(this.FEnabled)),null!=e&&this.GetTitle().FShowCheckBox&&2===this.GetTitle().FCheckBoxMode&&e.SetEnabled(this.GetTitle().GetChecked())},this.DoSetTitleCheckState=function(t,e){var i=null;null!=this.FTitleCheckBox&&(i=this.FTitleCheckBox.FOnClick,this.FTitleCheckBox.FOnClick=null,this.FTitleCheckBox.SetChecked(e),this.FTitleCheckBox.FOnClick=i)},this.DoGetTitleCheckState=function(t,e){null!=this.FTitleCheckBox&&e.set(this.FTitleCheckBox.GetChecked())},this.CanDrawTitle=function(){return pas["WEBLib.TMSFNCCustomGroup"].TTMSFNCCustomGroup.CanDrawTitle.call(this)||this.GetTitle().FShowCheckBox},this.GetVersion=function(){return this.$class.GetVersionNumber(1,0,2,1)},this.CreateGroupTitle=function(){var e;return e=t.TTMSFNCCheckGroupTitle.$create("Create$1"),rtl.as(e,t.TTMSFNCCheckGroupTitle).FOnSetCheckState=rtl.createCallback(this,"DoSetTitleCheckState"),rtl.as(e,t.TTMSFNCCheckGroupTitle).FOnGetCheckState=rtl.createCallback(this,"DoGetTitleCheckState"),e},this.GetTitleRect=function(){var t=pas["WEBLib.TMSFNCTypes"].TRectF.$new();return t.$assign(pas["WEBLib.TMSFNCCustomGroup"].TTMSFNCCustomGroup.GetTitleRect.call(this)),this.GetTitle().FShowCheckBox?(t.Right=t.Right+this.FTitleCheckBox.GetWidth(),this.FTitleCheckBox.GetHeight()+this.ScalePaintValue(4)>t.Bottom-t.Top&&(t.Bottom=t.Top+this.FTitleCheckBox.GetHeight()+this.ScalePaintValue(4)),t):t},this.GetTitleDrawRect=function(t){var e=pas["WEBLib.TMSFNCTypes"].TRectF.$new();return e.$assign(pas["WEBLib.TMSFNCCustomGroup"].TTMSFNCCustomGroup.GetTitleDrawRect.call(this,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(t))),this.GetTitle().FShowCheckBox?(e.Left=e.Left+this.FTitleCheckBox.GetWidth()+this.ScalePaintValue(4),e):e},this.GetControlClass=function(e){return t.TTMSFNCCheckContainer},this.GetControlCheckState=function(e){var i=!1;return i=!1,null!=e&&t.TTMSFNCCheckContainer.isPrototypeOf(e)&&(i=rtl.as(e,t.TTMSFNCCheckContainer).FCheckBox.GetChecked()),i},this.HandleMouseUp=function(t,e,i,s){var o="";pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleMouseUp.apply(this,arguments),""!==(o=this.XYtoTitleAnchor(i,s))&&this.DoTitleAnchorClick(o)},this.HandleMouseMove=function(t,e,i){""!==this.XYtoTitleAnchor(e,i)?this.SetControlCursor(21):this.SetControlCursor(0),pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleMouseMove.apply(this,arguments)},this.XYtoTitleAnchor=function(t,e){var i="",s=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),o=null;i="",s.$assign(this.GetTitleDrawRect(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(this.GetTitleRect()))),(o=pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.$create("CreateBitmapCanvas",[1,1,!1,!0])).BeginScene(),o.FBitmapContainer=this.GetBitmapContainer();try{o.FFont.Assign(this.GetTitle().FFont),i=o.DrawText$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(s),this.GetTitle().FText,!1,0,0,0,0,-1,-1,!0,!0,t,e)}finally{o.EndScene(),o=rtl.freeLoc(o)}return i},this.DoTitleAnchorClick=function(t){null!=this.FOnTitleAnchorClick?this.FOnTitleAnchorClick(this,t):pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.OpenURL(t)},this.DoCheckBoxAnchorClick=function(t,e){null!=this.FOnCheckboxAnchorClick?this.FOnCheckboxAnchorClick(this,t,e):pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.OpenURL(e)},this.Loaded=function(){pas["WEBLib.TMSFNCCustomGroup"].TTMSFNCCustomGroup.Loaded.call(this)},this.Destroy=function(){null!=this.FTitleCheckBox&&rtl.free(this,"FTitleCheckBox"),pas["WEBLib.TMSFNCCustomGroup"].TTMSFNCCustomGroup.Destroy.call(this)},rtl.addIntf(this,pas["WEBLib.TMSFNCBitmapContainer"].ITMSFNCBitmapContainer),rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas["WEBLib.TMSFNCTypes"].ITMSFNCProductInfo),rtl.addIntf(this,pas.System.IUnknown);var e=this.$rtti;e.addProperty("BitmapContainer",3,pas["WEBLib.TMSFNCBitmapContainer"].$rtti.TTMSFNCBitmapContainer,"GetBitmapContainer","SetBitmapContainer"),e.addProperty("Version",1,rtl.string,"GetVersion",""),e.addProperty("Items",2,pas.Classes.$rtti.TStrings,"FItems","SetItems"),e.addProperty("Font",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFont,"FFont$1","SetFnt"),e.addProperty("Columns",2,rtl.longint,"FColumns","SetColumns",{Default:1}),e.addProperty("Title",3,t.$rtti.TTMSFNCCheckGroupTitle,"GetTitle","SetTitle$1"),e.addProperty("Fill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FFill","SetFill"),e.addProperty("Stroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FStroke","SetStroke"),e.addProperty("OnTitleCheckBoxClick",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnTitleCheckBoxClick","FOnTitleCheckBoxClick"),e.addProperty("OnCheckBoxClick",0,t.$rtti.TTMSFNCCheckGroupClickEvent,"FOnCheckBoxClick","FOnCheckBoxClick"),e.addProperty("OnCheckBoxDblClick",0,t.$rtti.TTMSFNCCheckGroupClickEvent,"FOnCheckBoxDblClick","FOnCheckBoxDblClick"),e.addProperty("OnTitleAnchorClick",0,t.$rtti.TTMSFNCCheckGroupTitleAnchorClickEvent,"FOnTitleAnchorClick","FOnTitleAnchorClick"),e.addProperty("OnCheckboxAnchorClick",0,t.$rtti.TTMSFNCCheckGroupItemAnchorClickEvent,"FOnCheckboxAnchorClick","FOnCheckboxAnchorClick"),e.attr=[pas.Classes.ComponentPlatformsAttribute,"Create$1",[0]]}))}),["Math","WEBLib.TMSFNCUtils","WEBLib.TMSFNCGraphics"]),rtl.module("WEBLib.TMSFNCCheckGroupPicker",["System","Classes","WEBLib.TMSFNCCustomPicker","WEBLib.Controls","WEBLib.TMSFNCCustomSelector","WEBLib.TMSFNCGraphicsTypes","WEBLib.TMSFNCGraphics","WEBLib.TMSFNCTypes","WEBLib.TMSFNCCheckGroup","WEBLib.TMSFNCBitmapContainer","Types"],(function(){"use strict";var t=this;this.MAJ_VER=1,this.MIN_VER=0,this.REL_VER=1,this.BLD_VER=0,rtl.createClass(this,"TTMSFNCCustomCheckGroupPicker",pas["WEBLib.TMSFNCCustomPicker"].TTMSFNCDefaultPicker,(function(){this.$init=function(){pas["WEBLib.TMSFNCCustomPicker"].TTMSFNCDefaultPicker.$init.call(this),this.FBitmapContainer=null,this.FValue=0,this.FItems=null,this.FWrapper=null,this.FCheckGroupSelector=null,this.FKeyBoardUsed=!1,this.FCloseOnSelection=!1,this.FOnCustomize=null,this.FOnTitleCheckBoxClick=null,this.FTitle=null,this.FFont$2=null,this.FColumns=0,this.FOnCheckBoxClick=null,this.FSeparator=""},this.$final=function(){this.FBitmapContainer=void 0,this.FItems=void 0,this.FWrapper=void 0,this.FCheckGroupSelector=void 0,this.FOnCustomize=void 0,this.FOnTitleCheckBoxClick=void 0,this.FTitle=void 0,this.FFont$2=void 0,this.FOnCheckBoxClick=void 0,pas["WEBLib.TMSFNCCustomPicker"].TTMSFNCDefaultPicker.$final.call(this)},this.GetSelectedItems=function(){var t="",e=0,i=0,s=0,o=null;t="",(o=pas.Classes.TStringList.$create("Create$1")).SetDelimiter(this.FSeparator);try{i=Math.min(this.FItems.GetCount(),64),s=1;for(var n=0,r=i-1;n<=r;n++)e=n,rtl.and(this.FValue,s)>0&&o.Add(pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.HTMLStrip(this.FItems.Get(e))),s*=2;t=o.GetDelimitedText()}finally{o=rtl.freeLoc(o)}return t},this.SetSelectedItems=function(t){var e=null,i=0,s=0;e=pas.Classes.TStringList.$create("Create$1");try{pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.Split(this.FSeparator,t,e,!1),this.FValue=0,s=1;for(var o=0,n=this.FItems.GetCount()-1;o<=n;o++)i=o,e.IndexOf(pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.HTMLStrip(this.FItems.Get(i)))>-1&&(this.FValue=rtl.or(this.FValue,s)),s*=2;this.Invalidate()}finally{e=rtl.freeLoc(e)}},this.SetItems$1=function(t){this.FItems.Assign(t)},this.SetValue=function(t){this.FValue!==t&&(this.FValue=t,this.Invalidate())},this.GetBitmapContainer=function(){return this.FBitmapContainer},this.SetBitmapContainer=function(t){this.FBitmapContainer=t,this.Invalidate()},this.SetColumns$1=function(t){this.FColumns!==t&&(this.FColumns=t)},this.SetFnt$1=function(t){this.FFont$2.Assign(t)},this.GetVersion=function(){return this.$class.GetVersionNumber(1,0,1,0)},this.ItemsChanged=function(t){this.FUpdateCount$1>0||null!=this.FCheckGroupSelector&&(this.FCheckGroupSelector.FItems.Clear(),this.FCheckGroupSelector.FItems.Assign(this.FItems))},this.ResetToDefaultStyle=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.ResetToDefaultStyle.call(this),this.FFont$2.SetColor(0)},this.ApplyStyle=function(){var t=0;pas["WEBLib.TMSFNCCustomPicker"].TTMSFNCCustomPicker.ApplyStyle.call(this),t=-1,pas["WEBLib.TMSFNCStyles"].TTMSFNCStyles.GetStyleTextFontColor({get:function(){return t},set:function(e){t=e}})&&this.FFont$2.SetColor(t)},this.SetAdaptToStyle=function(t){pas["WEBLib.TMSFNCCustomPicker"].TTMSFNCCustomPicker.SetAdaptToStyle.apply(this,arguments),null!=this.FWrapper&&this.FWrapper.SetAdaptToStyle(this.GetAdaptToStyle()),null!=this.FCheckGroupSelector&&this.FCheckGroupSelector.SetAdaptToStyle(this.GetAdaptToStyle())},this.CheckGroupKeyUp=function(t,e,i){13!==e.get()&&32!==e.get()||(this.FCloseOnSelection&&this.GetPopup().FIsOpen&&this.DropDown(),this.FValue=this.FCheckGroupSelector.GetValue(),this.DoCheckBoxClick(this,-1,this.FValue),this.Invalidate()),this.FKeyBoardUsed=!1},this.CheckGroupKeyDown=function(t,e,i){this.FKeyBoardUsed=!0},this.Notification=function(t,e){pas["WEBLib.Menus"].TWebCustomControl.Notification.apply(this,arguments),1===e&&t===this.FBitmapContainer&&(this.FBitmapContainer=null)},this.InitializePopup=function(){this.FCheckGroupSelector.FItems.Clear(),this.FCheckGroupSelector.FItems.Assign(this.FItems),this.FCheckGroupSelector.SetColumns(this.FColumns),this.FCheckGroupSelector.SetBitmapContainer(this.GetBitmapContainer()),this.FCheckGroupSelector.FFont$1.Assign(this.FFont$2),this.FCheckGroupSelector.GetTitle().Assign(this.FTitle),this.FCheckGroupSelector.FFill.Assign(this.GetFill()),this.FCheckGroupSelector.SetValue(this.FValue)},this.DoTitleCheckBoxClick=function(t){null!=this.FOnTitleCheckBoxClick&&this.FOnTitleCheckBoxClick(this)},this.DoCheckBoxClick=function(t,e,i){this.FCloseOnSelection&&this.GetPopup().FIsOpen&&this.DropDown(),this.FValue=this.FCheckGroupSelector.GetValue(),null!=this.FOnCheckBoxClick&&this.FOnCheckBoxClick(this,e,i),this.Invalidate()},this.DrawContent=function(t,e){var i=pas["WEBLib.TMSFNCTypes"].TRectF.$new();pas["WEBLib.TMSFNCCustomPicker"].TTMSFNCCustomPicker.DrawContent.apply(this,arguments),t.FBitmapContainer=this.GetBitmapContainer(),t.FFont.Assign(this.FFont$2),i.$assign(e),pas["WEBLib.TMSFNCTypes"].InflateRectEx(i,-3,-3),t.DrawText$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),this.GetHTMLSelectedItems(),!1,1,0,0,0,-1,-1,!0,!1,-1,-1)},this.GetHTMLSelectedItems=function(){var t="",e=0,i=0;t="",i=1;for(var s=0,o=Math.min(this.FItems.GetCount(),64)-1;s<=o;s++)e=s,rtl.and(this.FValue,i)>0&&(t=t+this.FItems.Get(e)+this.FSeparator),i*=2;return t.length>0&&t.charAt(t.length-1)===this.FSeparator&&(t=pas.System.Copy(t,0,t.length-1)),t},this.CreateSelector=function(){return this.FWrapper=pas["WEBLib.TMSFNCCustomSelector"].TTMSFNCCustomSelector.$create("Create$1",[this]),this.FCheckGroupSelector=pas["WEBLib.TMSFNCCheckGroup"].TTMSFNCCheckGroup.$create("Create$1",[this.FWrapper]),this.FCheckGroupSelector.SetWidth(200),this.FCheckGroupSelector.SetHeight(150),this.FCheckGroupSelector.SetParent(this.FWrapper),this.FCheckGroupSelector.SetAlign(5),this.FCheckGroupSelector.FOnKeyUp=rtl.createCallback(this,"CheckGroupKeyUp"),this.FCheckGroupSelector.FOnKeyDown=rtl.createCallback(this,"CheckGroupKeyDown"),this.FCheckGroupSelector.FOnTitleCheckBoxClick=rtl.createCallback(this,"DoTitleCheckBoxClick"),this.FCheckGroupSelector.FOnCheckBoxClick=rtl.createCallback(this,"DoCheckBoxClick"),this.FWrapper},this.GetFocusedControl=function(){return this.FCheckGroupSelector},this.Create$1=function(t){return pas["WEBLib.TMSFNCCustomPicker"].TTMSFNCCustomPicker.Create$1.apply(this,arguments),this.FValue=0,this.FColumns=1,this.FSeparator=",",this.FTitle=pas["WEBLib.TMSFNCCheckGroup"].TTMSFNCCheckGroupTitle.$create("Create$1"),this.FFont$2=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFont.$create("Create$2"),this.FCloseOnSelection=!1,this.SetDropDownWidth(200),this.FItems=pas.Classes.TStringList.$create("Create$1"),this.FItems.FOnChange=rtl.createCallback(this,"ItemsChanged"),this.IsDesignTime()&&this.InitSample(),this},this.Destroy=function(){rtl.free(this,"FTitle"),rtl.free(this,"FFont$2"),rtl.free(this,"FItems"),pas["WEBLib.TMSFNCCustomPicker"].TTMSFNCCustomPicker.Destroy.call(this)},this.InitSample=function(){this.FItems.Clear(),this.FItems.Add("BMW"),this.FItems.Add("Mercedes"),this.FItems.Add("Audi"),this.FItems.Add("Bugatti")},rtl.addIntf(this,pas["WEBLib.TMSFNCBitmapContainer"].ITMSFNCBitmapContainer),rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas["WEBLib.TMSFNCTypes"].ITMSFNCProductInfo),rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TTMSFNCCheckGroupPicker",this.TTMSFNCCustomCheckGroupPicker,(function(){this.RegisterRuntimeClasses=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.RegisterRuntimeClasses.call(this),pas.Classes.RegisterClass(t.TTMSFNCCheckGroupPicker)},rtl.addIntf(this,pas["WEBLib.TMSFNCBitmapContainer"].ITMSFNCBitmapContainer),rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas["WEBLib.TMSFNCTypes"].ITMSFNCProductInfo),rtl.addIntf(this,pas.System.IUnknown);var e=this.$rtti;e.addProperty("Items",2,pas.Classes.$rtti.TStringList,"FItems","SetItems$1"),e.addProperty("BitmapContainer",3,pas["WEBLib.TMSFNCBitmapContainer"].$rtti.TTMSFNCBitmapContainer,"GetBitmapContainer","SetBitmapContainer"),e.addProperty("DropDownWidth",14,rtl.double,"FDropDownWidth","SetDropDownWidth",{stored:"IsDropDownWidthStored"}),e.addProperty("DropDownHeight",14,rtl.double,"FDropDownHeight","SetDropDownHeight",{stored:"IsDropDownHeightStored"}),e.addProperty("CloseOnSelection",0,rtl.boolean,"FCloseOnSelection","FCloseOnSelection",{Default:!1}),e.addProperty("SelectedItems",3,rtl.string,"GetSelectedItems","SetSelectedItems"),e.addProperty("OnCustomize",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnCustomize","FOnCustomize"),e.addProperty("Font",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFont,"FFont$2","SetFnt$1"),e.addProperty("Columns",2,rtl.longint,"FColumns","SetColumns$1",{Default:1}),e.addProperty("Fill",3,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"GetFill","SetFill$1"),e.addProperty("Stroke",3,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"GetStroke","SetStroke$1"),e.addProperty("OnTitleCheckBoxClick",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnTitleCheckBoxClick","FOnTitleCheckBoxClick"),e.addProperty("OnCheckBoxClick",0,pas["WEBLib.TMSFNCCheckGroup"].$rtti.TTMSFNCCheckGroupClickEvent,"FOnCheckBoxClick","FOnCheckBoxClick"),e.addProperty("Separator",0,rtl.char,"FSeparator","FSeparator"),e.attr=[pas.Classes.ComponentPlatformsAttribute,"Create$1",[0]]}))}),["WEBLib.TMSFNCUtils","WEBLib.Forms","Math","WEBLib.TMSFNCStyles","WEBLib.Graphics"]),rtl.module("WEBLib.TMSFNCObjectInspector",["System","contnrs","Classes","WEBLib.TMSFNCCustomControl","WEBLib.TMSFNCImage","WEBLib.TMSFNCCustomTreeView","WEBLib.TMSFNCTreeViewData","WEBLib.TMSFNCBitmapContainer","Types","WEBLib.TMSFNCTypes","WEBLib.TMSFNCTreeView","WEBLib.TMSFNCGraphics","WEBLib.TMSFNCGraphicsTypes","TypInfo","WEBLib.ExtCtrls","WEBLib.StdCtrls","WEBLib.TMSFNCCustomComponent","WEBLib.Controls","WEBLib.Forms","DB"],(function(){"use strict";var t=this,e=t.$impl;this.TTMSFNCObjectInspectorColorSelected=15790320,this.$rtti.$Class("TTMSFNCObjectInspector"),this.$rtti.$MethodVar("TTMSFNCObjectInspectorReadDBField",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AField",pas.DB.$rtti.TField],["ACanRead",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCObjectInspectorReadDBFieldValue",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AField",pas.DB.$rtti.TField],["AFieldValue",rtl.string,1],["ACanRead",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCObjectInspectorWriteDBFieldValue",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AField",pas.DB.$rtti.TField],["AFieldValue",rtl.string,1],["ACanWrite",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCObjectInspectorFieldValueChanged",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AField",pas.DB.$rtti.TField],["APropertyValue",rtl.string]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCObjectInspectorReadProperty",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AObject",pas.System.$rtti.TObject],["APropertyInfo",pas.TypInfo.$rtti.TTypeMemberProperty],["APropertyName",rtl.string],["APropertyType",pas.System.$rtti.TTypeKind],["ACanRead",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCObjectInspectorReadPropertyValue",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AObject",pas.System.$rtti.TObject],["APropertyInfo",pas.TypInfo.$rtti.TTypeMemberProperty],["APropertyName",rtl.string],["APropertyType",pas.System.$rtti.TTypeKind],["APropertyValue",rtl.string,1],["ACanRead",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCObjectInspectorWritePropertyValue",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AObject",pas.System.$rtti.TObject],["APropertyInfo",pas.TypInfo.$rtti.TTypeMemberProperty],["APropertyName",rtl.string],["APropertyType",pas.System.$rtti.TTypeKind],["APropertyValue",rtl.string,1],["ACanWrite",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCObjectInspectorPropertyValueChanged",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AObject",pas.System.$rtti.TObject],["APropertyInfo",pas.TypInfo.$rtti.TTypeMemberProperty],["APropertyName",rtl.string],["APropertyType",pas.System.$rtti.TTypeKind],["APropertyValue",rtl.string]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCObjectInspectorBeforeOpenObjectEditor",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AObject",pas.System.$rtti.TObject],["APropertyInfo",pas.TypInfo.$rtti.TTypeMemberProperty],["APropertyName",rtl.string],["APropertyType",pas.System.$rtti.TTypeKind],["APropertyValueObject",pas.System.$rtti.TObject],["ACanOpen",rtl.boolean,1]]),methodkind:0}),this.$rtti.$Class("TTMSFNCObjectInspectorEditor"),this.$rtti.$MethodVar("TTMSFNCObjectInspectorCustomizeObjectEditor",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AObject",pas.System.$rtti.TObject],["APropertyInfo",pas.TypInfo.$rtti.TTypeMemberProperty],["APropertyName",rtl.string],["APropertyType",pas.System.$rtti.TTypeKind],["APropertyValueObject",pas.System.$rtti.TObject],["AEditor",this.$rtti.TTMSFNCObjectInspectorEditor],["AEditorForm",pas["WEBLib.TMSFNCCustomControl"].$rtti.TTMSFNCCustomDesignerForm],["AEditorObjectInspector",this.$rtti.TTMSFNCObjectInspector]]),methodkind:0}),rtl.createClass(this,"TTMSFNCObjectInspectorEditor",pas["WEBLib.TMSFNCCustomComponent"].TTMSFNCCustomComponent,(function(){this.$init=function(){pas["WEBLib.TMSFNCCustomComponent"].TTMSFNCCustomComponent.$init.call(this),this.FEditor=null,this.FBlockUpdate=0,this.FPanel=null,this.FTopPanel=null,this.FButtonOk=null,this.FButtonCancel=null,this.FButtonSelectImage=null,this.FButtonClearImage=null,this.FButtonAdd=null,this.FButtonDelete=null,this.FComboBoxBitmapContainer=null,this.FListBox=null,this.FObjectInspector=null,this.FMemo=null,this.FImage=null,this.FBitmapContainer=null,this.FObject=null},this.$final=function(){this.FEditor=void 0,this.FPanel=void 0,this.FTopPanel=void 0,this.FButtonOk=void 0,this.FButtonCancel=void 0,this.FButtonSelectImage=void 0,this.FButtonClearImage=void 0,this.FButtonAdd=void 0,this.FButtonDelete=void 0,this.FComboBoxBitmapContainer=void 0,this.FListBox=void 0,this.FObjectInspector=void 0,this.FMemo=void 0,this.FImage=void 0,this.FBitmapContainer=void 0,this.FObject=void 0,pas["WEBLib.TMSFNCCustomComponent"].TTMSFNCCustomComponent.$final.call(this)},this.GetBitmapContainer=function(){return this.FBitmapContainer},this.SetBitmapContainer=function(t){this.FBitmapContainer=t,null!=this.FObjectInspector&&this.FObjectInspector.SetBitmapContainer(this.FBitmapContainer)},this.SetObject=function(t){this.FObject=t},this.RegisterRuntimeClasses=function(){pas["WEBLib.TMSFNCCustomComponent"].TTMSFNCCustomComponent.RegisterRuntimeClasses.call(this),pas.Classes.RegisterClass(t.TTMSFNCObjectInspectorEditor)},this.Notification=function(t,e){pas.Classes.TComponent.Notification.apply(this,arguments),1===e&&t===this.FBitmapContainer&&(this.FBitmapContainer=null)},this.BuildEditor=function(e){null!=e&&(this.FTopPanel=pas["WEBLib.ExtCtrls"].TPanel.$create("Create$1",[e]),this.FTopPanel.SetAlign(1),this.FTopPanel.SetTop(0),this.FTopPanel.SetVisible(!1),this.FTopPanel.SetParent(e),this.FButtonDelete=pas["WEBLib.StdCtrls"].TButton.$create("Create$1",[this.FTopPanel]),this.FButtonDelete.SetParent(this.FTopPanel),this.FButtonDelete.SetAlign(4),this.FButtonDelete.SetCaption(pas["WEBLib.TMSFNCTreeViewData"].TranslateTextEx(rtl.getResStr(t,"sTMSFNCObjectInspectorEditorDelete"))),this.FButtonDelete.SetAlignWithMargins(!0),this.FButtonDelete.FMargins.SetRight(5),this.FButtonDelete.FMargins.SetTop(5),this.FButtonDelete.FMargins.SetBottom(5),this.FButtonDelete.FMargins.SetLeft(5),this.FButtonDelete.FOnClick=rtl.createCallback(this,"DoDeleteItem"),this.FButtonAdd=pas["WEBLib.StdCtrls"].TButton.$create("Create$1",[this.FTopPanel]),this.FButtonAdd.SetParent(this.FTopPanel),this.FButtonAdd.SetAlign(4),this.FButtonAdd.SetCaption(pas["WEBLib.TMSFNCTreeViewData"].TranslateTextEx(rtl.getResStr(t,"sTMSFNCObjectInspectorEditorAdd"))),this.FButtonAdd.SetAlignWithMargins(!0),this.FButtonAdd.FMargins.SetRight(0),this.FButtonAdd.FMargins.SetTop(5),this.FButtonAdd.FMargins.SetBottom(5),this.FButtonAdd.FMargins.SetLeft(5),this.FButtonAdd.FOnClick=rtl.createCallback(this,"DoAddItem"),this.FButtonSelectImage=pas["WEBLib.StdCtrls"].TButton.$create("Create$1",[this.FTopPanel]),this.FButtonSelectImage.SetParent(this.FTopPanel),this.FButtonSelectImage.SetAlign(4),this.FButtonSelectImage.SetCaption(pas["WEBLib.TMSFNCTreeViewData"].TranslateTextEx(rtl.getResStr(t,"sTMSFNCObjectInspectorEditorSelectImage"))),this.FButtonSelectImage.SetAlignWithMargins(!0),this.FButtonSelectImage.FMargins.SetRight(5),this.FButtonSelectImage.FMargins.SetTop(5),this.FButtonSelectImage.FMargins.SetBottom(5),this.FButtonSelectImage.FMargins.SetLeft(5),this.FButtonSelectImage.FOnClick=rtl.createCallback(this,"DoSelectImageItem"),this.FButtonSelectImage.SetVisible(!1),this.FButtonClearImage=pas["WEBLib.StdCtrls"].TButton.$create("Create$1",[this.FTopPanel]),this.FButtonClearImage.SetParent(this.FTopPanel),this.FButtonClearImage.SetAlign(4),this.FButtonClearImage.SetCaption(pas["WEBLib.TMSFNCTreeViewData"].TranslateTextEx(rtl.getResStr(t,"sTMSFNCObjectInspectorEditorClearImage"))),this.FButtonClearImage.SetAlignWithMargins(!0),this.FButtonClearImage.FMargins.SetRight(5),this.FButtonClearImage.FMargins.SetTop(5),this.FButtonClearImage.FMargins.SetBottom(5),this.FButtonClearImage.FMargins.SetLeft(5),this.FButtonClearImage.FOnClick=rtl.createCallback(this,"DoClearImageItem"),this.FButtonClearImage.SetVisible(!1),this.FComboBoxBitmapContainer=pas["WEBLib.StdCtrls"].TComboBox.$create("Create$1",[this.FTopPanel]),this.FComboBoxBitmapContainer.SetParent(this.FTopPanel),this.FComboBoxBitmapContainer.SetAlign(4),this.FComboBoxBitmapContainer.SetAlignWithMargins(!0),this.FComboBoxBitmapContainer.FMargins.SetRight(5),this.FComboBoxBitmapContainer.FMargins.SetTop(5),this.FComboBoxBitmapContainer.FMargins.SetBottom(5),this.FComboBoxBitmapContainer.FMargins.SetLeft(5),this.FComboBoxBitmapContainer.FOnChange=rtl.createCallback(this,"DoImageSelected"),this.FComboBoxBitmapContainer.SetVisible(!1),this.FTopPanel.SetHeight(37),this.FListBox=pas["WEBLib.StdCtrls"].TListBox.$create("Create$1",[e]),this.FListBox.SetAlign(4),this.FListBox.SetVisible(!1),this.FListBox.SetParent(e),this.FListBox.FOnClick=rtl.createCallback(this,"DoItemChanged"),this.FMemo=pas["WEBLib.StdCtrls"].TMemo.$create("Create$1",[e]),this.FMemo.SetAlign(5),this.FMemo.SetVisible(!1),this.FMemo.SetParent(e),this.FMemo.FOnChange=rtl.createCallback(this,"DoMemoChanged"),this.FImage=pas["WEBLib.TMSFNCImage"].TTMSFNCImage.$create("Create$1",[e]),this.FImage.SetAlign(5),this.FImage.SetVisible(!1),this.FImage.SetParent(e),this.FImage.SetControlMargins(5,5,5,5),this.FObjectInspector=t.TTMSFNCObjectInspector.$create("Create$1",[e]),this.FObjectInspector.Initialize(),this.FObjectInspector.SetAlign(5),this.FObjectInspector.SetVisible(!1),this.FObjectInspector.SetParent(e),this.FPanel=pas["WEBLib.ExtCtrls"].TPanel.$create("Create$1",[e]),this.FPanel.SetAlign(2),this.FPanel.SetHeight(37),this.FPanel.SetParent(e),this.FButtonCancel=pas["WEBLib.StdCtrls"].TButton.$create("Create$1",[this.FPanel]),this.FButtonCancel.FModalResult=2,this.FButtonCancel.SetParent(this.FPanel),this.FButtonCancel.SetAlign(4),this.FButtonCancel.SetCaption(pas["WEBLib.TMSFNCTreeViewData"].TranslateTextEx(rtl.getResStr(t,"sTMSFNCObjectInspectorEditorCancel"))),this.FButtonCancel.SetAlignWithMargins(!0),this.FButtonCancel.FMargins.SetRight(5),this.FButtonCancel.FMargins.SetTop(5),this.FButtonCancel.FMargins.SetBottom(5),this.FButtonCancel.FMargins.SetLeft(5),this.FButtonCancel.SetVisible(!1),this.FButtonCancel.FOnClick=rtl.createCallback(this,"DoButtonCancelClick"),this.FButtonOk=pas["WEBLib.StdCtrls"].TButton.$create("Create$1",[this.FPanel]),this.FButtonOk.FModalResult=1,this.FButtonOk.SetParent(this.FPanel),this.FButtonOk.SetAlign(4),this.FButtonOk.SetCaption(pas["WEBLib.TMSFNCTreeViewData"].TranslateTextEx(rtl.getResStr(t,"sTMSFNCObjectInspectorEditorOK"))),this.FButtonOk.SetAlignWithMargins(!0),this.FButtonOk.FMargins.SetRight(5),this.FButtonOk.FMargins.SetTop(5),this.FButtonOk.FMargins.SetBottom(5),this.FButtonOk.FMargins.SetLeft(5),this.FButtonOk.FOnClick=rtl.createCallback(this,"DoButtonOKClick"),this.UpdateControls())},this.UpdateControls=function(){var e=null,i=0,s=null;if(null!=this.FObject&&null!=this.FObjectInspector&&null!=this.FListBox)if(t.TTMSFNCObjectInspector.IsCollection(this.FObject.$class.ClassType())){if(e=this.FObject,this.FTopPanel.SetVisible(!0),this.FObjectInspector.SetVisible(!0),this.FListBox.SetVisible(!0),this.FListBox.FItems.Clear(),this.FObjectInspector.SetObject(null),e.GetCount()>0){for(var o=0,n=e.GetCount()-1;o<=n;o++)i=o,this.FListBox.FItems.AddObject("Item "+pas.SysUtils.IntToStr(i),e.GetItem(i));this.FObjectInspector.SetObject(e.GetItem(0)),this.FListBox.SetItemIndex(0)}}else if(t.TTMSFNCObjectInspector.IsBitmap(this.FObject.$class.ClassType())){if(this.FComboBoxBitmapContainer.SetVisible(null!=this.FBitmapContainer),this.FComboBoxBitmapContainer.FItems.Clear(),null!=this.FBitmapContainer)for(var r=0,a=this.FBitmapContainer.GetItems().GetCount()-1;r<=a;r++)i=r,this.FComboBoxBitmapContainer.FItems.Add(this.FBitmapContainer.GetItems().GetItemEx(i).FName);this.FButtonAdd.SetVisible(!1),this.FButtonDelete.SetVisible(!1),this.FButtonClearImage.SetVisible(!0),this.FTopPanel.SetVisible(!0),this.FImage.SetVisible(!0),this.FImage.FBitmap.Assign(this.FObject)}else if(t.TTMSFNCObjectInspector.IsStrings(this.FObject.$class.ClassType())){if(s=this.FObject,this.FTopPanel.SetVisible(!0),this.FMemo.SetVisible(!0),this.FListBox.SetVisible(!0),this.FListBox.FItems.Clear(),this.FObjectInspector.SetObject(null),s.GetCount()>0){for(var l=0,h=s.GetCount()-1;l<=h;l++)i=l,this.FListBox.FItems.Add(s.Get(i));this.FBlockUpdate+=1,this.FMemo.SetText(s.Get(0)),this.FBlockUpdate-=1,this.FListBox.SetItemIndex(0)}}else this.FObjectInspector.SetVisible(!0),this.FObjectInspector.SetObject(this.FObject)},this.DoDeleteItem=function(e){var i=null,s=null,o=0;null!=this.FObject&&null!=this.FListBox&&-1!==this.FListBox.GetItemIndex()&&(t.TTMSFNCObjectInspector.IsCollection(this.FObject.$class.ClassType())?(o=this.FListBox.GetItemIndex(),s=this.FObject,this.FListBox.GetItemIndex()>=0&&this.FListBox.GetItemIndex()<=s.GetCount()-1&&s.Delete(this.FListBox.GetItemIndex()),this.FListBox.GetItemIndex()>=0&&this.FListBox.GetItemIndex()<=this.FListBox.FItems.GetCount()-1&&this.FListBox.FItems.Delete(this.FListBox.GetItemIndex()),this.FListBox.SetItemIndex(Math.max(0,Math.min(this.FListBox.FItems.GetCount()-1,o))),s.GetCount()>0?this.FObjectInspector.SetObject(s.GetItem(s.GetCount()-1)):this.FObjectInspector.SetObject(null)):t.TTMSFNCObjectInspector.IsStrings(this.FObject.$class.ClassType())&&(o=this.FListBox.GetItemIndex(),i=this.FObject,this.FListBox.GetItemIndex()>=0&&this.FListBox.GetItemIndex()<=i.GetCount()-1&&i.Delete(this.FListBox.GetItemIndex()),this.FListBox.GetItemIndex()>=0&&this.FListBox.GetItemIndex()<=this.FListBox.FItems.GetCount()-1&&this.FListBox.FItems.Delete(this.FListBox.GetItemIndex()),this.FListBox.SetItemIndex(Math.max(0,Math.min(this.FListBox.FItems.GetCount()-1,o))),this.FBlockUpdate+=1,i.GetCount()>0?this.FMemo.SetText(i.Get(i.GetCount()-1)):this.FMemo.SetText(""),this.FBlockUpdate-=1))},this.DoAddItem=function(e){var i=null,s=null,o=null,n="";null!=this.FObject&&(t.TTMSFNCObjectInspector.IsCollection(this.FObject.$class.ClassType())?(o=(i=this.FObject).Add(),this.FListBox.FItems.AddObject("Item "+pas.SysUtils.IntToStr(i.GetCount()-1),o),this.FObjectInspector.SetObject(o),this.FListBox.SetItemIndex(this.FListBox.FItems.GetCount()-1)):t.TTMSFNCObjectInspector.IsStrings(this.FObject.$class.ClassType())&&(s=this.FObject,n="Item "+pas.SysUtils.IntToStr(s.GetCount()),s.Add(n),this.FListBox.FItems.Add(n),this.FBlockUpdate+=1,this.FMemo.SetText(n),this.FBlockUpdate-=1,this.FListBox.SetItemIndex(this.FListBox.FItems.GetCount()-1)))},this.DoImageSelected=function(e){var i="",s=null;null!=this.FObject&&t.TTMSFNCObjectInspector.IsBitmap(this.FObject.$class.ClassType())&&null!=this.FBitmapContainer&&(i="",this.FComboBoxBitmapContainer.GetItemIndex()>=0&&this.FComboBoxBitmapContainer.GetItemIndex()<=this.FComboBoxBitmapContainer.FItems.GetCount()-1&&(i=this.FComboBoxBitmapContainer.FItems.Get(this.FComboBoxBitmapContainer.GetItemIndex())),s=this.FBitmapContainer.FindBitmap$1(i),this.FImage.FBitmap.Assign(s),this.FObject.Assign(s))},this.DoSelectImageItem=function(e){var i="";null!=this.FObject&&t.TTMSFNCObjectInspector.IsBitmap(this.FObject.$class.ClassType())&&(i="",pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.SelectFile({get:function(){return i},set:function(t){i=t}},"","All (*.gif;*.png;*.jpg;*.jpeg;*.bmp;*.tif;*.tiff;*.ico;*.emf;*.wmf;*.svg)|*.gif;*.png;*.jpg;*.jpeg;*.bmp;*.tif;*.tiff;*.ico;*.emf;*.wmf|GIF Image (*.gif)|*.gif|Portable Network Graphics (*.png)|*.png|JPEG Image File (*.jpg)|*.jpg|JPEG Image File (*.jpeg)|*.jpeg|Bitmaps (*.bmp)|*.bmp|TIFF Images (*.tif)|*.tif|TIFF Images(*.tiff)|*.tiff|Icons (*.ico)|*.ico|Enhanced Metafiles (*.emf)|*.emf|Metafiles (*.wmf)|*.wmf|Scalable Vector Graphics (*.svg)|*.svg",null),this.FImage.FBitmap.LoadFromFile(i,null),this.FObject.LoadFromFile(i,null))},this.DoClearImageItem=function(e){null!=this.FObject&&t.TTMSFNCObjectInspector.IsBitmap(this.FObject.$class.ClassType())&&(this.FImage.FBitmap.Assign(null),this.FObject.Assign(null))},this.DoItemChanged=function(e){var i=null,s=null;null!=this.FObject&&null!=this.FListBox&&-1!==this.FListBox.GetItemIndex()&&(t.TTMSFNCObjectInspector.IsCollection(this.FObject.$class.ClassType())?(i=this.FObject,this.FListBox.GetItemIndex()>=0&&this.FListBox.GetItemIndex()<=i.GetCount()-1&&this.FObjectInspector.SetObject(i.GetItem(this.FListBox.GetItemIndex()))):t.TTMSFNCObjectInspector.IsStrings(this.FObject.$class.ClassType())&&(s=this.FObject,this.FListBox.GetItemIndex()>=0&&this.FListBox.GetItemIndex()<=s.GetCount()-1&&(this.FBlockUpdate+=1,this.FMemo.SetText(s.Get(this.FListBox.GetItemIndex())),this.FBlockUpdate-=1)))},this.DoMemoChanged=function(e){var i=null;this.FBlockUpdate>0||null!=this.FObject&&null!=this.FListBox&&-1!==this.FListBox.GetItemIndex()&&t.TTMSFNCObjectInspector.IsStrings(this.FObject.$class.ClassType())&&(i=this.FObject,this.FListBox.GetItemIndex()>=0&&this.FListBox.GetItemIndex()<=i.GetCount()-1&&(i.Put(this.FListBox.GetItemIndex(),this.FMemo.GetText()),this.FListBox.FItems.Put(this.FListBox.GetItemIndex(),this.FMemo.GetText())))},this.DoButtonCancelClick=function(t){null!=this.FEditor&&this.FEditor.Close()},this.DoButtonOKClick=function(t){null!=this.FEditor&&this.FEditor.Close()},this.Execute=function(){return null!=this.FEditor&&(rtl.free(this,"FEditor"),this.FEditor=null),this.FEditor=pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomDesignerForm.$create("CreateNew",[pas["WEBLib.Forms"].Application,0]),this.FEditor.SetCaption("Property Editor"),this.FEditor.SetWidth(600),this.FEditor.SetHeight(500),this.FEditor.SetPosition(4),this.FEditor.FFont.SetHeight(-11),this.FEditor.FPopup=!0,this.BuildEditor(this.FEditor),this.FListBox.FVisible&&this.FEditor.SetActiveControl(this.FListBox),this.FEditor.Show$1(),1,1},this.Assign=function(e){t.TTMSFNCObjectInspectorEditor.isPrototypeOf(e)},rtl.addIntf(this,pas["WEBLib.TMSFNCBitmapContainer"].ITMSFNCBitmapContainer),rtl.addIntf(this,pas["WEBLib.TMSFNCTypes"].ITMSFNCProductInfo),rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas.System.IUnknown);var e=this.$rtti;e.addProperty("BitmapContainer",2,pas["WEBLib.TMSFNCBitmapContainer"].$rtti.TTMSFNCBitmapContainer,"FBitmapContainer","SetBitmapContainer"),e.attr=[pas.Classes.ComponentPlatformsAttribute,"Create$1",[0]]})),rtl.createClass(this,"TTMSFNCObjectInspectorDataLink",pas.DB.TDataLink,(function(){this.$init=function(){pas.DB.TDataLink.$init.call(this),this.FModified=!1,this.FObjectInspector=null},this.$final=function(){this.FObjectInspector=void 0,pas.DB.TDataLink.$final.call(this)},this.ActiveChanged=function(){if(this.FActive&&null!=this.FDataSource&&null!=this.FDataSource.FDataSet&&this.FDataSource.FDataSet.FIsUniDirectional)throw pas.SysUtils.Exception.$create("Create$1",[rtl.getResStr(t,"sTMSFNCObjectInspectorUnidirectionalDataSet")]);this.FObjectInspector.LoadFields(),this.FModified=!1},this.DataSetChanged=function(){this.FModified=!1},this.DataSetScrolled=function(t){this.FObjectInspector.UpdateFields()},this.RecordChanged=function(t){this.FObjectInspector.UpdateFields()},this.UpdateData=function(){this.FModified=!1},this.Create$2=function(t){return this.FObjectInspector=t,this.FVisualControl=!0,this},this.Destroy=function(){pas.DB.TDataLink.Destroy.call(this)}})),this.TTMSFNCObjectInspectorMode={0:"oimAll",oimAll:0,1:"oimProperties",oimProperties:1,2:"oimEvents",oimEvents:2},rtl.createClass(this,"TTMSFNCObjectInspector",pas["WEBLib.TMSFNCTreeView"].TTMSFNCTreeView,(function(){this.$init=function(){pas["WEBLib.TMSFNCTreeView"].TTMSFNCTreeView.$init.call(this),this.FInternalCall=0,this.FDataLink=null,this.FInplaceEditorTimer=null,this.FBitmapContainer$1=null,this.FEditor=null,this.FObject=null,this.FOnReadProperty=null,this.FOnWritePropertyValue=null,this.FOnReadPropertyValue=null,this.FOnPropertyValueChanged=null,this.FDataSource=null,this.FOnReadDBField=null,this.FOnWriteDBFieldValue=null,this.FOnFieldValueChanged=null,this.FOnReadDBFieldValue=null,this.FDesigner=null,this.FMode=0,this.FOnBeforeOpenObjectEditor=null,this.FOnCustomizeObjectEditor=null},this.$final=function(){this.FDataLink=void 0,this.FInplaceEditorTimer=void 0,this.FBitmapContainer$1=void 0,this.FEditor=void 0,this.FObject=void 0,this.FOnReadProperty=void 0,this.FOnWritePropertyValue=void 0,this.FOnReadPropertyValue=void 0,this.FOnPropertyValueChanged=void 0,this.FDataSource=void 0,this.FOnReadDBField=void 0,this.FOnWriteDBFieldValue=void 0,this.FOnFieldValueChanged=void 0,this.FOnReadDBFieldValue=void 0,this.FDesigner=void 0,this.FOnBeforeOpenObjectEditor=void 0,this.FOnCustomizeObjectEditor=void 0,pas["WEBLib.TMSFNCTreeView"].TTMSFNCTreeView.$final.call(this)},this.SetObject=function(t){this.FObject=t,this.RebuildList()},this.SetDataSource=function(t){this.FDataSource=t,null!=this.FDataLink&&this.FDataLink.SetDataSource(this.FDataSource),this.RebuildList()},this.SetMode=function(t){this.FMode=t,this.RebuildList()},this.GetDocURL=function(){return pas["WEBLib.TMSFNCTypes"].TTMSFNCBaseDocURL+"tmsfncuipack/components/"+pas.SysUtils.LowerCase(this.$classname)},this.UpdateFields=function(){this.FInternalCall>0||this.InternalRebuildList(!0)},this.LoadFields=function(){this.FInternalCall>0||this.InternalRebuildList(!1)},this.InternalRebuildList=function(t){t||this.ClearNodes(),this.BeginUpdate(),null!=this.FDataSource?this.ReadDB(t):null!=this.FObject&&this.Read(this.FObject),this.StopInternalEditing(),this.EndUpdate()},this.Notification=function(t,e){pas["WEBLib.TMSFNCCustomTreeView"].TTMSFNCCustomTreeView.Notification.apply(this,arguments),1===e&&t===this.FBitmapContainer$1&&(this.FBitmapContainer$1=null),1===e&&t===this.FDesigner&&(this.FDesigner=null),1===e&&t===this.FObject&&(this.FObject=null)},this.StopInternalEditing=function(){this.FInplaceEditorTimer.SetEnabled(!0)},this.DoInplaceEditorTimer=function(t){this.StopEditing(),this.FInplaceEditorTimer.SetEnabled(!1)},this.DoColorSelected=function(t,e){var i=null;null!=(i=rtl.as(t,pas["WEBLib.TMSFNCColorPicker"].TTMSFNCColorPicker)).GetSelector()&&pas["WEBLib.TMSFNCColorSelector"].TTMSFNCColorSelector.isPrototypeOf(i.GetSelector())&&(rtl.as(i.GetSelector(),pas["WEBLib.TMSFNCColorSelector"].TTMSFNCColorSelector).ColorWheelActive()||(i.GetSelector().FClosedRemotely=!0,this.StopInternalEditing()))},this.DoDateSelected=function(t,e){this.StopInternalEditing()},this.DoTimeSelected=function(t,e){this.StopInternalEditing()},this.DoFillKindSelected=function(t,e){this.StopInternalEditing()},this.DoStrokeKindSelected=function(t,e){this.StopInternalEditing()},this.DoComboChange=function(t){this.StopInternalEditing()},this.DoBeforeUpdateNode=function(t,i,s,o){var n=null,r=null,a=0,l="",h=null,F=null,p=null,c=null,u=null,C=null;if(null!=t&&null!=t.FNode&&null!=(n=t.FNode.FDataObject))if(null!=this.FDataSource){var T=rtl.as(n,pas.DB.TField).FDataType;6===T||8===T?(p=rtl.as(this.GetInplaceEditor(),pas["WEBLib.TMSFNCDatePicker"].TTMSFNCDatePicker),s.set(pas.SysUtils.DateToStr(p.GetSelectedDate()))):7===T&&(F=rtl.as(this.GetInplaceEditor(),pas["WEBLib.TMSFNCAnalogTimePicker"].TTMSFNCAnalogTimePicker),s.set(pas.SysUtils.TimeToStr(F.GetSelectedTime())))}else if(null!=this.FObject&&(r=t.FNode.FDataPointer,null!=n&&null!=r)){a=this.$class.GetPropInfoType(r),l=this.$class.GetPropInfoTypeName(r);var S=a;1===S?this.$class.IsColor(l)&&(h=rtl.as(this.GetInplaceEditor(),pas["WEBLib.TMSFNCColorPicker"].TTMSFNCColorPicker),s.set(pas.SysUtils.IntToStr(h.GetSelectedColor()))):4===S?this.$class.IsFillKind(l)?(c=rtl.as(this.GetInplaceEditor(),pas["WEBLib.TMSFNCFillKindPicker"].TTMSFNCFillKindPicker),s.set(e.GetEnumNameEx(e.GetTypeInfoEx(r),c.GetSelectedFillKind()))):this.$class.IsStrokeKind(l)&&(u=rtl.as(this.GetInplaceEditor(),pas["WEBLib.TMSFNCStrokeKindPicker"].TTMSFNCStrokeKindPicker),s.set(e.GetEnumNameEx(e.GetTypeInfoEx(r),u.GetSelectedStrokeKind()))):S===pas.System.TTypeKind.tkDouble?this.$class.IsDate(l)?(p=rtl.as(this.GetInplaceEditor(),pas["WEBLib.TMSFNCDatePicker"].TTMSFNCDatePicker),s.set(pas.SysUtils.DateToStr(p.GetSelectedDate()))):this.$class.IsTime(l)&&(F=rtl.as(this.GetInplaceEditor(),pas["WEBLib.TMSFNCAnalogTimePicker"].TTMSFNCAnalogTimePicker),s.set(pas.SysUtils.TimeToStr(F.GetSelectedTime()))):5===S&&(C=rtl.as(this.GetInplaceEditor(),pas["WEBLib.TMSFNCCheckGroupPicker"].TTMSFNCCheckGroupPicker),s.set(C.GetSelectedItems()))}pas["WEBLib.TMSFNCCustomTreeView"].TTMSFNCCustomTreeView.DoBeforeUpdateNode.apply(this,arguments)},this.DoGetInplaceEditor=function(t,e,i){var s=null,o=null,n=0,r="";if(i.set(null),null!=t&&null!=t.FNode&&null!=(s=t.FNode.FDataObject))if(null!=this.FDataSource){var a=rtl.as(s,pas.DB.TField).FDataType;6===a||8===a?i.set(pas["WEBLib.TMSFNCDatePicker"].TTMSFNCDatePicker):7===a?i.set(pas["WEBLib.TMSFNCAnalogTimePicker"].TTMSFNCAnalogTimePicker):4===a?i.set(pas["WEBLib.TMSFNCCustomTreeView"].TTMSFNCTreeViewComboBox):i.set(pas["WEBLib.TMSFNCCustomTreeView"].TTMSFNCTreeViewEdit)}else if(null!=this.FObject&&null!=(o=t.FNode.FDataPointer)){n=this.$class.GetPropInfoType(o),r=this.$class.GetPropInfoTypeName(o);var l=n;13===l?this.$class.IsAssignableProperty(s,o)&&i.set(pas["WEBLib.TMSFNCCustomTreeView"].TTMSFNCTreeViewComboBox):1===l?this.$class.IsColor(r)?i.set(pas["WEBLib.TMSFNCColorPicker"].TTMSFNCColorPicker):i.set(pas["WEBLib.TMSFNCCustomTreeView"].TTMSFNCTreeViewEdit):l===pas.System.TTypeKind.tkDouble?this.$class.IsDate(r)?i.set(pas["WEBLib.TMSFNCDatePicker"].TTMSFNCDatePicker):this.$class.IsTime(r)?i.set(pas["WEBLib.TMSFNCAnalogTimePicker"].TTMSFNCAnalogTimePicker):i.set(pas["WEBLib.TMSFNCCustomTreeView"].TTMSFNCTreeViewEdit):2===l||3===l||9===l?i.set(pas["WEBLib.TMSFNCCustomTreeView"].TTMSFNCTreeViewEdit):4===l?this.$class.IsFillKind(r)?i.set(pas["WEBLib.TMSFNCFillKindPicker"].TTMSFNCFillKindPicker):this.$class.IsStrokeKind(r)?i.set(pas["WEBLib.TMSFNCStrokeKindPicker"].TTMSFNCStrokeKindPicker):i.set(pas["WEBLib.TMSFNCCustomTreeView"].TTMSFNCTreeViewComboBox):7===l?i.set(pas["WEBLib.TMSFNCCustomTreeView"].TTMSFNCTreeViewComboBox):5===l&&i.set(pas["WEBLib.TMSFNCCheckGroupPicker"].TTMSFNCCheckGroupPicker)}pas["WEBLib.TMSFNCCustomTreeView"].TTMSFNCCustomTreeView.DoGetInplaceEditor.apply(this,arguments)},this.DoCustomizeInplaceEditor=function(t,e,i){var s=null,o=null,n=0,r="",a=null,l=null,h=null,F=null,p=null,c=null,u=null;if(null!=t&&null!=t.FNode&&null!=(s=t.FNode.FDataObject))if(null!=this.FDataSource){var C=rtl.as(s,pas.DB.TField).FDataType;6===C||8===C?((F=rtl.as(i,pas["WEBLib.TMSFNCDatePicker"].TTMSFNCDatePicker)).SetEditable(!0),F.SetSelectedDate(pas.System.Int(rtl.as(s,pas.DB.TField).GetAsDateTime())),F.FOnDateSelected=rtl.createCallback(this,"DoDateSelected")):7===C?((h=rtl.as(i,pas["WEBLib.TMSFNCAnalogTimePicker"].TTMSFNCAnalogTimePicker)).SetEditable(!0),h.SetSelectedTime(pas.System.Frac(rtl.as(s,pas.DB.TField).GetAsDateTime())),h.FOnTimeSelected=rtl.createCallback(this,"DoTimeSelected")):4===C&&((a=rtl.as(i,pas["WEBLib.TMSFNCCustomTreeView"].TTMSFNCTreeViewComboBox)).FItems.Clear(),a.FItems.Add("True"),a.FItems.Add("False"),a.FOnChange=rtl.createCallback(this,"DoComboChange"))}else if(null!=this.FObject&&null!=(o=t.FNode.FDataPointer)){n=this.$class.GetPropInfoType(o),r=this.$class.GetPropInfoTypeName(o);var T=n;13===T?this.$class.IsAssignableProperty(s,o)&&((a=rtl.as(i,pas["WEBLib.TMSFNCCustomTreeView"].TTMSFNCTreeViewComboBox)).FItems.Clear(),a.FItems.Add(""),this.$class.GetDescendingComponents(a.FItems,this.FDesigner,s,r),a.FOnChange=rtl.createCallback(this,"DoComboChange")):1===T?this.$class.IsColor(r)&&((l=rtl.as(i,pas["WEBLib.TMSFNCColorPicker"].TTMSFNCColorPicker)).SetMode(2),l.SetSelectedColor(pas.TypInfo.GetOrdProp$1(s,o)),l.FOnColorSelected=rtl.createCallback(this,"DoColorSelected")):T===pas.System.TTypeKind.tkDouble?this.$class.IsDate(r)?((F=rtl.as(i,pas["WEBLib.TMSFNCDatePicker"].TTMSFNCDatePicker)).SetEditable(!0),F.SetSelectedDate(pas.TypInfo.GetFloatProp$1(s,o)),F.FOnDateSelected=rtl.createCallback(this,"DoDateSelected")):this.$class.IsTime(r)&&((h=rtl.as(i,pas["WEBLib.TMSFNCAnalogTimePicker"].TTMSFNCAnalogTimePicker)).SetEditable(!0),h.SetSelectedTime(pas.TypInfo.GetFloatProp$1(s,o)),h.FOnTimeSelected=rtl.createCallback(this,"DoTimeSelected")):4===T?this.$class.IsFillKind(r)?((p=rtl.as(i,pas["WEBLib.TMSFNCFillKindPicker"].TTMSFNCFillKindPicker)).SetSelectedFillKind(pas.TypInfo.GetOrdProp$1(s,o)),p.FOnFillKindSelected=rtl.createCallback(this,"DoFillKindSelected")):this.$class.IsStrokeKind(r)?((c=rtl.as(i,pas["WEBLib.TMSFNCStrokeKindPicker"].TTMSFNCStrokeKindPicker)).SetSelectedStrokeKind(pas.TypInfo.GetOrdProp$1(s,o)),c.FOnStrokeKindSelected=rtl.createCallback(this,"DoStrokeKindSelected")):((a=rtl.as(i,pas["WEBLib.TMSFNCCustomTreeView"].TTMSFNCTreeViewComboBox)).FItems.Clear(),this.$class.GetEnumValues(a.FItems,o),a.FOnChange=rtl.createCallback(this,"DoComboChange")):7===T?((a=rtl.as(i,pas["WEBLib.TMSFNCCustomTreeView"].TTMSFNCTreeViewComboBox)).FItems.Clear(),a.FItems.Add("True"),a.FItems.Add("False"),a.FOnChange=rtl.createCallback(this,"DoComboChange")):5===T&&((u=rtl.as(i,pas["WEBLib.TMSFNCCheckGroupPicker"].TTMSFNCCheckGroupPicker)).BeginUpdate(),u.FItems.Clear(),this.$class.GetEnumValues(u.FItems,o),u.SetDropDownHeight(27*u.FItems.GetCount()),u.SetValue(pas.TypInfo.GetOrdProp$1(s,o)),u.EndUpdate())}pas["WEBLib.TMSFNCCustomTreeView"].TTMSFNCCustomTreeView.DoCustomizeInplaceEditor.apply(this,arguments)},this.DoNodeChanged=function(t){var i=null,s=null,o=null,n=0,r="",a="",l=null,h=null,F=0,p=0,c=0,u="",C=null,T=!1;if(null!=t&&null!=t.FNode&&null!=(i=t.FNode.FDataObject))if(r=t.FNode.GetText(1),null!=this.FDataSource)T=!0,this.DoWriteDBFieldValue(rtl.as(i,pas.DB.TField),{get:function(){return r},set:function(t){r=t}},{get:function(){return T},set:function(t){T=t}}),T&&(this.FDataSource.FDataSet.Edit(),rtl.as(i,pas.DB.TField).SetAsString(r),this.FDataSource.FDataSet.Post());else if(null!=this.FObject&&null!=(o=t.FNode.FDataPointer)){n=this.$class.GetPropInfoType(o),u=this.$class.GetPropInfoTypeName(o);var S=n;if(13===S){if(this.$class.IsAssignableProperty(i,o)){h=pas.Classes.TStringList.$create("Create$1");try{s=null,this.$class.GetDescendingComponents(h,this.FDesigner,i,u);for(var d=0,m=h.GetCount()-1;d<=m;d++)if(F=d,pas.Classes.TComponent.isPrototypeOf(h.GetObject(F))&&(C=rtl.as(h.GetObject(F),pas.Classes.TComponent)).FName===r){s=C;break}this.WritePropInfoValue(i,o,"",s,t.FNode)}finally{h=rtl.freeLoc(h)}}}else if(1===S||S===pas.System.TTypeKind.tkDouble||2===S||3===S||9===S||7===S)this.WritePropInfoValue(i,o,r,null,t.FNode);else if(4===S)this.WritePropInfoValue(i,o,pas.SysUtils.IntToStr(e.GetEnumValueEx(e.GetTypeInfoEx(o),r)),null,t.FNode);else if(5===S){l=pas.Classes.TStringList.$create("Create$1"),h=pas.Classes.TStringList.$create("Create$1");try{this.$class.GetEnumValues(h,o),l.SetDelimiter(","),l.SetDelimitedText(r),c=1,p=0;for(var f=0,g=h.GetCount()-1;f<=g;f++)F=f,-1!==l.IndexOf(h.Get(F))&&(p=rtl.or(p,c)),c*=2;a=pas.SysUtils.IntToStr(p),this.WritePropInfoValue(i,o,a,null,t.FNode)}finally{h=rtl.freeLoc(h),l=rtl.freeLoc(l)}}}pas["WEBLib.TMSFNCCustomTreeView"].TTMSFNCCustomTreeView.DoNodeChanged.apply(this,arguments)},this.DoBeforeDrawNodeText=function(t,e,i,s,o,n){var r=null,a="",l=0,h=pas["WEBLib.TMSFNCTypes"].TRectF.$new();if(null!=s&&null!=s.FNode&&1===i&&null!=s.FNode.FDataObject)if(null!=this.FDataSource);else if(null!=this.FObject&&null!=(r=s.FNode.FDataPointer)){var F=this.$class.GetPropInfoType(r);1===F&&(a=this.$class.GetPropInfoTypeName(r),this.$class.IsColor(a)&&(n.set(!1),l=-1,pas.SysUtils.TryStrToInt64(o,{get:function(){return l},set:function(t){l=t}})&&(t.FFill.SetColor(l),t.FStroke.SetKind(1),t.FStroke.SetColor(0)),h.$assign(pas["WEBLib.TMSFNCTypes"].RectF(e.Left+5,e.Top+2,e.Left+45,e.Bottom-2)),t.DrawRectangle$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(h),0),t.DrawText$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(h.Right+2,e.Top,e.Right,e.Bottom)),o,!1,0,0,0,0,-1,-1,!0,!1,-1,-1)))}pas["WEBLib.TMSFNCCustomTreeView"].TTMSFNCCustomTreeView.DoBeforeDrawNodeText.apply(this,arguments)},this.DoBeforeOpenInplaceEditor=function(t,e,i){var s=null,o=null;if(i.set(!1),null!=t&&null!=t.FNode&&null!=(s=t.FNode.FDataObject))if(null!=this.FDataSource)i.set(!rtl.as(s,pas.DB.TField).FReadOnly&&!(rtl.as(s,pas.DB.TField).FDataType in rtl.createSet(10)));else if(null!=this.FObject&&null!=(o=t.FNode.FDataPointer)&&!this.$class.IsReadOnly(o)){var n=this.$class.GetPropInfoType(o);13===n?i.set(this.$class.IsAssignableProperty(s,o)):5!==n&&4!==n&&n!==pas.System.TTypeKind.tkDouble&&1!==n&&2!==n&&3!==n&&9!==n&&7!==n||i.set(!0)}pas["WEBLib.TMSFNCCustomTreeView"].TTMSFNCCustomTreeView.DoBeforeOpenInplaceEditor.apply(this,arguments)},this.DoAfterOpenInplaceEditor=function(t,e,i,s){null!=i&&(pas["WEBLib.StdCtrls"].TCustomComboBox.isPrototypeOf(i)?rtl.as(i,pas["WEBLib.StdCtrls"].TCustomComboBox).SetDroppedDown(!0):pas["WEBLib.TMSFNCCustomPicker"].TTMSFNCCustomPicker.isPrototypeOf(i)&&rtl.as(i,pas["WEBLib.TMSFNCCustomPicker"].TTMSFNCCustomPicker).DropDown()),pas["WEBLib.TMSFNCCustomTreeView"].TTMSFNCCustomTreeView.DoAfterOpenInplaceEditor.apply(this,arguments)},this.DoNodeClick=function(e){var i=null,s=null,o=null,n="",r=0,a=null,l=!1;try{null!=e&&null!=e.FNode&&null!=(i=e.FNode.FDataObject)&&(null!=this.FDataSource||null!=this.FObject&&null!=(o=e.FNode.FDataPointer)&&(n=this.$class.GetPropInfoName(o),(r=this.$class.GetPropInfoType(o))in rtl.createSet(13)&&null!=(s=pas.TypInfo.GetObjectProp(i,n))&&(l=!0,this.DoBeforeOpenObjectEditor(i,o,n,r,s,{get:function(){return l},set:function(t){l=t}}),l&&(null==this.FEditor&&(this.FEditor=t.TTMSFNCObjectInspectorEditor.$create("Create$1",[this])),pas.SysUtils.Supports$3(this.FObject,pas["WEBLib.TMSFNCBitmapContainer"].ITMSFNCBitmapContainer.$guid,{get:function(){return a},set:function(t){a=t}})&&this.FEditor.SetBitmapContainer(a.GetBitmapContainer()),this.FEditor.SetObject(s),this.FEditor.Execute(),this.DoCustomizeObjectEditor(e,o,n,r,s,this.FEditor,this.FEditor.FEditor,this.FEditor.FObjectInspector))))),pas["WEBLib.TMSFNCCustomTreeView"].TTMSFNCCustomTreeView.DoNodeClick.apply(this,arguments)}finally{rtl._Release(a)}},this.DoBeforeOpenObjectEditor=function(t,e,i,s,o,n){null!=this.FOnBeforeOpenObjectEditor&&this.FOnBeforeOpenObjectEditor(this,t,e,i,s,o,n)},this.DoCustomizeObjectEditor=function(t,e,i,s,o,n,r,a){null!=this.FOnCustomizeObjectEditor&&this.FOnCustomizeObjectEditor(this,t,e,i,s,o,n,r,a)},this.DoReadDBField=function(t,e){null!=this.FOnReadDBField&&this.FOnReadDBField(this,t,e)},this.DoReadDBFieldValue=function(t,e,i){null!=this.FOnReadDBFieldValue&&this.FOnReadDBFieldValue(this,t,e,i)},this.DoWriteDBFieldValue=function(t,e,i){null!=this.FOnWriteDBFieldValue&&this.FOnWriteDBFieldValue(this,t,e,i)},this.DoGetNodeTextColor=function(t,e,i){var s=null,o=null;null!=t&&null!=t.FNode&&0===e&&null!=(s=t.FNode.FDataObject)&&(null!=this.FDataSource||null!=this.FObject&&null!=(o=t.FNode.FDataPointer)&&this.$class.IsAssignableProperty(s,o)&&i.set(255)),pas["WEBLib.TMSFNCCustomTreeView"].TTMSFNCCustomTreeView.DoGetNodeTextColor.apply(this,arguments)},this.DoReadProperty=function(t,e,i,s,o){null!=this.FOnReadProperty&&this.FOnReadProperty(this,t,e,i,s,o)},this.DoReadPropertyValue=function(t,e,i,s,o,n,r){null!=this.FOnReadPropertyValue&&this.FOnReadPropertyValue(this,t,e,i,s,o,r)},this.DoWritePropertyValue=function(t,e,i,s,o,n,r){null!=this.FOnWritePropertyValue&&this.FOnWritePropertyValue(this,t,e,i,s,o,r)},this.DoPropertyValueChanged=function(t,e,i,s,o,n){null!=this.FOnPropertyValueChanged&&this.FOnPropertyValueChanged(this,t,e,i,s,o)},this.ReadObject=function(t,e){null!=t&&this.ReadSingleObject(t,e)},this.ReadProperties=function(t,e){var i=null,s=[],o=0;if(null!=t){i=t.$rtti;try{s=pas.TypInfo.GetPropList(i,pas.System.tkAny,!0);for(var n=0,r=rtl.length(s)-1;n<=r;n++)o=n,this.ReadProperty(t,s[o],e,null)}finally{}}},this.ReadProperty=function(t,e,i,s){var o,n,r=null,a="",l=null,h=!1;if(null!=e&&!this.$class.IsWriteOnly(e)&&(o=this.$class.GetPropInfoName(e),n=this.$class.GetPropInfoType(e),h=!0,this.DoReadProperty(t,e,o,n,{get:function(){return h},set:function(t){h=t}}),h&&(1===this.FMode&&9!==n||2===this.FMode&&9===n)&&0!==n))if((r=null!=s?s:this.AddNode(i)).SetText(0,o),r.FDataPointer=e,r.FDataObject=t,n in rtl.createSet(13)){if(h=!0,l=pas.TypInfo.GetObjectProp(t,o),a="",this.DoReadPropertyValue(t,e,o,n,{get:function(){return a},set:function(t){a=t}},{get:function(){return l},set:function(t){l=t}},{get:function(){return h},set:function(t){h=t}}),!h)return;null!=l&&(this.$class.IsAssignableProperty(t,e)?this.$class.IsDescendingClass(l.$class.ClassType(),["TComponent"])&&r.SetText(1,rtl.as(l,pas.Classes.TComponent).FName):(r.SetText(1,"("+l.$classname+")"),this.ReadObject(l,r)))}else{if(h=!0,a=this.ReadPropInfoValue(t,e),l=null,this.DoReadPropertyValue(t,e,o,n,{get:function(){return a},set:function(t){a=t}},{get:function(){return l},set:function(t){l=t}},{get:function(){return h},set:function(t){h=t}}),!h)return;""!==a&&r.SetText(1,a)}},this.ReadSingleObject=function(t,e){this.ReadProperties(t,e)},this.Read=function(t){this.ReadObject(t,null)},this.ReadDB=function(t){var e=null,i=null,s=null,o=0,n=null,r=!1,a=!1,l="";if(!(this.FInternalCall>0)){if(this.FInternalCall+=1,null!=this.FDataLink&&null!=this.FDataLink.GetDataset()&&this.FDataLink.GetDataset().GetActive()){e=this.FDataLink.GetDataset(),s=pas.Classes.TStringList.$create("Create$1");try{e.GetFieldNames(s);for(var h=0,F=s.GetCount()-1;h<=F;h++)o=h,n=e.FieldByName(s.Get(o)),r=!0,this.DoReadDBField(n,{get:function(){return r},set:function(t){r=t}}),r&&null!=(i=t?this.FindNodeByDBKey(s.Get(o)):this.AddNode(null))&&(i.SetText(0,s.Get(o)),i.FDataObject=n,a=!0,l=n.GetAsString(),this.DoReadDBFieldValue(n,{get:function(){return l},set:function(t){l=t}},{get:function(){return a},set:function(t){a=t}}),a&&i.SetText(1,n.GetAsString()),i.FDBKey=s.Get(o))}finally{s=rtl.freeLoc(s)}}this.FInternalCall-=1}},this.WritePropInfoValue=function(t,e,i,s,o){var n,r,a,l,h=0,F=!1,p=0,c="",u=0,C=!1;if(l=e,!this.$class.IsReadOnly(l)&&(r=this.$class.GetPropInfoType(l),n=this.$class.GetPropInfoName(l),a=t,C=!0,this.DoWritePropertyValue(a,l,n,r,{get:function(){return i},set:function(t){i=t}},{get:function(){return s},set:function(t){s=t}},{get:function(){return C},set:function(t){C=t}}),C)){var T=r;13===T?this.$class.IsAssignableProperty(a,l)&&(pas.TypInfo.SetObjectProp$1(a,l,s),o.RemoveChildren()):5===T||1===T||4===T?(h=0,pas.SysUtils.TryStrToInt64(i,{get:function(){return h},set:function(t){h=t}})&&pas.TypInfo.SetOrdProp$1(a,l,h)):7===T?(F=!1,pas.SysUtils.TryStrToBool(i,{get:function(){return F},set:function(t){F=t}})&&pas.TypInfo.SetOrdProp$1(a,l,F?1:0)):2===T||3===T?pas.TypInfo.SetStrProp$1(a,l,i):T===pas.System.TTypeKind.tkDouble&&(c=this.$class.GetPropInfoTypeName(l),this.$class.IsDate(c)?(u=pas.System.Int(pas.SysUtils.Now()),pas.SysUtils.TryStrToDate(i,{get:function(){return u},set:function(t){u=t}})&&pas.TypInfo.SetFloatProp$1(a,l,u)):this.$class.IsTime(c)?(u=pas.System.Frac(pas.SysUtils.Now()),pas.SysUtils.TryStrToTime(i,{get:function(){return u},set:function(t){u=t}})&&pas.TypInfo.SetFloatProp$1(a,l,u)):this.$class.IsDateTime(c)?(u=pas.SysUtils.Now(),pas.SysUtils.TryStrToDateTime(i,{get:function(){return u},set:function(t){u=t}})&&pas.TypInfo.SetFloatProp$1(a,l,u)):(p=0,pas.SysUtils.TryStrToFloat(i,{get:function(){return p},set:function(t){p=t}})&&pas.TypInfo.SetFloatProp$1(a,l,p))),this.ReadProperty(a,l,null,o),this.DoPropertyValueChanged(a,l,n,r,i,s)}},this.DrawBorders=function(t){},this.GetEnumValues=function(t,i){var s=null,o=null,n=0;if(null!=(s=e.GetTypeInfoEx(i))&&rtl.isExt(s,rtl.tTypeInfoSet)&&(s=s.comptype),null!=s&&rtl.isExt(s,rtl.tTypeInfoInteger))for(var r=(o=s).minvalue,a=o.maxvalue;r<=a;r++)n=r,t.Add(e.GetEnumNameEx(s,n))},this.GetPropInfoType=function(t){return null!=t.typeinfo?t.typeinfo.kind:0},this.GetPropInfoName=function(t){return t.name},this.GetPropInfoTypeName=function(t){var e="";return e="",null!=t.typeinfo&&(e=t.typeinfo.name),e},this.IsWriteOnly=function(t){return""===t.getter},this.IsReadOnly=function(t){return""===t.setter},this.IsAssignableProperty=function(t,e){var i=!1,s=null,o="";return i=!1,this.GetPropInfoType(e)in rtl.createSet(13)&&(o=this.GetPropInfoName(e),i=null!=(s=pas.TypInfo.GetObjectProp(t,o))&&this.IsComponent(s.$class.ClassType())||!(null!=s)),i},this.ReadPropInfoValue=function(t,i){var s,o,n,r="",a="",l=0,h=null,F=null,p=0,c=0,u=0;o=t,n=i,s=this.$class.GetPropInfoType(n),this.$class.GetPropInfoName(n),r="";var C=s;if(1===C)r=pas.SysUtils.IntToStr(pas.TypInfo.GetOrdProp$1(o,n));else if(2===C||3===C)r=pas.TypInfo.GetStrProp$1(o,n);else if(7===C)r=pas.SysUtils.BoolToStr(0!=pas.TypInfo.GetOrdProp$1(o,n),!0);else if(4===C)r=e.GetEnumNameEx(e.GetTypeInfoEx(n),pas.TypInfo.GetOrdProp$1(o,n));else if(C===pas.System.TTypeKind.tkDouble)l=pas.TypInfo.GetFloatProp$1(o,n),a=this.$class.GetPropInfoTypeName(n),r=this.$class.IsDate(a)?pas.SysUtils.DateToStr(l):this.$class.IsTime(a)?pas.SysUtils.TimeToStr(l):this.$class.IsDateTime(a)?pas.SysUtils.DateTimeToStr(l,!1):pas.SysUtils.FloatToStr(l);else if(5===C){u=pas.TypInfo.GetOrdProp$1(o,n),h=pas.Classes.TStringList.$create("Create$1"),F=pas.Classes.TStringList.$create("Create$1");try{F.SetDelimiter(","),this.$class.GetEnumValues(h,n),c=1;for(var T=0,S=h.GetCount()-1;T<=S;T++)p=T,(u&c)>0&&F.Add(h.Get(p)),c*=2;r=F.GetDelimitedText()}finally{F=rtl.freeLoc(F),h=rtl.freeLoc(h)}}else e.GetEnumNameEx(pas.System.$rtti.TTypeKind,s);return r},this.Create$1=function(e){return pas["WEBLib.TMSFNCCustomTreeView"].TTMSFNCCustomTreeView.Create$1.apply(this,arguments),this.FMode=1,this.FDataLink=t.TTMSFNCObjectInspectorDataLink.$create("Create$2",[this]),this.FInplaceEditorTimer=pas["WEBLib.ExtCtrls"].TTimer.$create("Create$1",[this]),this.FInplaceEditorTimer.SetInterval(1),this.FInplaceEditorTimer.FOnTimer=rtl.createCallback(this,"DoInplaceEditorTimer"),this.FInplaceEditorTimer.SetEnabled(!1),this.IsDesignTime()&&this.Initialize(),this.SetHeight(400),this.SetWidth(300),this},this.Destroy=function(){rtl.free(this,"FDataLink"),rtl.free(this,"FInplaceEditorTimer"),pas["WEBLib.TMSFNCCustomTreeView"].TTMSFNCCustomTreeView.Destroy.call(this)},this.RebuildList=function(){this.InternalRebuildList(!1)},this.Initialize=function(){var e=null;this.FColumns.Clear(),this.FInteraction.SetMouseEditMode(1),this.FNodesAppearance.FSelectedFill.SetColor(15790320),this.FNodesAppearance.FSelectedStroke.SetColor(15790320),this.FNodesAppearance.SetSelectedFontColor(0),(e=this.FColumns.Add$1()).SetText(rtl.getResStr(t,"sTMSFNCObjectInspectorName")),e.SetWidth(150),(e=this.FColumns.Add$1()).SetText(rtl.getResStr(t,"sTMSFNCObjectInspectorValue")),e.FCustomEditor=!0,e.SetWidth(150),this.ClearNodes(),this.FColumnsAppearance.SetStretch(!0),this.FColumnsAppearance.SetStretchColumn(1),this.FColumnsAppearance.SetStretchAll(!1),this.FInteraction.SetColumnSizing(!0),this.FInteraction.SetColumnAutoSizeOnDblClick(!0)},this.GetDescendingComponents=function(t,e,i,s){var o=null,n=null,r=0,a=null;if(n=null,null!=e?n=e:pas.Classes.TComponent.isPrototypeOf(i)&&(o=rtl.as(i,pas.Classes.TComponent),n=pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.GetOwnerForm(o)),null!=n)for(var l=0,h=n.GetComponentCount()-1;l<=h;l++)r=l,a=n.GetComponent(r),this.IsDescendingClass(a.$class.ClassType(),[s])&&t.AddObject(a.FName,a)},this.IsColor=function(t){return"TAlphaColor"===t||"TColor"===t||"TGraphicsColor"===t},this.IsStrokeKind=function(t){return"TTMSFNCGraphicsStrokeKind"===t},this.IsFillKind=function(t){return"TTMSFNCGraphicsFillKind"===t},this.IsDate=function(t){return"TDate"===t},this.IsDateTime=function(t){return"TDateTime"===t},this.IsTime=function(t){return"TTime"===t},this.IsCollection=function(t){return this.IsDescendingClass(t,["TCollection"])},this.IsComponent=function(t){return this.IsDescendingClass(t,["TComponent","TTMSFNCCustomComponent"])},this.IsDescendingClass=function(t,e){var i="";if(null==t)return!1;do{i=t.$classname;for(var s=0,o=rtl.length(e)-1;s<=o;s++)if(i===e[s])return!0;t=t.$ancestor}while(null!=t);return!1,!1},this.IsBitmap=function(t){return this.IsDescendingClass(t,["TBitmap","TPicture","TTMSFNCBitmap"])},this.IsStrings=function(t){return this.IsDescendingClass(t,["TStrings"])},rtl.addIntf(this,pas["WEBLib.TMSFNCControlPicker"].ITMSFNCControlPickerFull),rtl.addIntf(this,pas["WEBLib.TMSFNCGraphicsTypes"].ITMSFNCAppearanceGlobalFont),rtl.addIntf(this,pas["WEBLib.TMSFNCBitmapContainer"].ITMSFNCBitmapContainer),rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas["WEBLib.TMSFNCTypes"].ITMSFNCProductInfo),rtl.addIntf(this,pas.System.IUnknown);var i=this.$rtti;i.addProperty("Designer",0,pas.Classes.$rtti.TComponent,"FDesigner","FDesigner"),i.addProperty("DataSource",2,pas.DB.$rtti.TDataSource,"FDataSource","SetDataSource"),i.addProperty("OnReadProperty",0,t.$rtti.TTMSFNCObjectInspectorReadProperty,"FOnReadProperty","FOnReadProperty"),i.addProperty("OnReadPropertyValue",0,t.$rtti.TTMSFNCObjectInspectorReadPropertyValue,"FOnReadPropertyValue","FOnReadPropertyValue"),i.addProperty("OnWritePropertyValue",0,t.$rtti.TTMSFNCObjectInspectorWritePropertyValue,"FOnWritePropertyValue","FOnWritePropertyValue"),i.addProperty("OnPropertyValueChanged",0,t.$rtti.TTMSFNCObjectInspectorPropertyValueChanged,"FOnPropertyValueChanged","FOnPropertyValueChanged"),i.addProperty("OnReadDBField",0,t.$rtti.TTMSFNCObjectInspectorReadDBField,"FOnReadDBField","FOnReadDBField"),i.addProperty("OnReadDBFieldValue",0,t.$rtti.TTMSFNCObjectInspectorReadDBFieldValue,"FOnReadDBFieldValue","FOnReadDBFieldValue"),i.addProperty("OnWriteDBFieldValue",0,t.$rtti.TTMSFNCObjectInspectorWriteDBFieldValue,"FOnWriteDBFieldValue","FOnWriteDBFieldValue"),i.addProperty("OnFieldValueChanged",0,t.$rtti.TTMSFNCObjectInspectorFieldValueChanged,"FOnFieldValueChanged","FOnFieldValueChanged"),i.addProperty("OnBeforeOpenObjectEditor",0,t.$rtti.TTMSFNCObjectInspectorBeforeOpenObjectEditor,"FOnBeforeOpenObjectEditor","FOnBeforeOpenObjectEditor"),i.addProperty("OnCustomizeObjectEditor",0,t.$rtti.TTMSFNCObjectInspectorCustomizeObjectEditor,"FOnCustomizeObjectEditor","FOnCustomizeObjectEditor"),i.attr=[pas.Classes.ComponentPlatformsAttribute,"Create$1",[0]]})),t.$resourcestrings={sTMSFNCObjectInspectorUnidirectionalDataSet:{org:"Unidirectional DataSet."},sTMSFNCObjectInspectorName:{org:"Name"},sTMSFNCObjectInspectorValue:{org:"Value"},sTMSFNCObjectInspectorEditorOK:{org:"OK"},sTMSFNCObjectInspectorEditorCancel:{org:"Cancel"},sTMSFNCObjectInspectorEditorDelete:{org:"Delete"},sTMSFNCObjectInspectorEditorAdd:{org:"Add"},sTMSFNCObjectInspectorEditorSelectImage:{org:"Select Image"},sTMSFNCObjectInspectorEditorClearImage:{org:"Clear Image"}},t.$implcode=function(){e.GetTypeInfoEx=function(t){return t.typeinfo},e.GetEnumValueEx=function(t,e){return t.enumtype[e]},e.GetEnumNameEx=function(t,e){return t.enumtype[e]}}}),["Math","SysUtils","StrUtils","WEBLib.TMSFNCUtils","WEBLib.TMSFNCColorPicker","WEBLib.TMSFNCColorSelector","WEBLib.TMSFNCCustomPicker","WEBLib.TMSFNCAnalogTimePicker","WEBLib.TMSFNCAnalogTimeSelector","WEBLib.TMSFNCDatePicker","WEBLib.TMSFNCStrokeKindPicker","WEBLib.TMSFNCFillKindPicker","WEBLib.TMSFNCCheckGroupPicker"]),rtl.module("WebLib.SERTTK.PI.ObjectPlus",["System","Types","Classes","Generics.Collections","SysUtils","WebLib.SERTTK.PluginTypes","WEBLib.TMSFNCTreeView","WEBLib.TMSFNCTreeViewData","WEBLib.TMSFNCObjectInspector","WEBLib.TMSFNCPageControl","WebLib.SERTTK.MarshalTypes","WebLib.SERTTK.Session","WebLib.SERTTK.CVTypes","WebLib.SEFNC.Layout","WebLib.SERTTK.Repository","TypInfo"],(function(){"use strict";var t=this;rtl.createClass(this,"TSERTTKTxTObject",pas["WebLib.SERTTK.PluginTypes"].TSERTTKPluginTransform,(function(){this.ExecTransform=function(){var e=rtl.createIntfRefs();try{pas["WebLib.SERTTK.Repository"].TSESTransformBase.ExecTransform.call(this);try{this.FRepoItem.ToolAdd(t.TSERTTKInspTObject.$create("Create$1",[this.FRepoItem])),e.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("Object Inspector assigned for "+this.FRepoItem.RefObjName(),this)}catch(t){if(!pas.SysUtils.Exception.isPrototypeOf(t))throw t;var i=t;e.ref(2,pas["WebLib.SEFNC.Logger"].Logger()).Debug$2("failed transform assign OI: ",i,this)}}finally{e.free()}},this.Create$2=function(){return pas["WebLib.SERTTK.Repository"].TSESTransformBase.Create$1.call(this,pas.System.TObject),this}})),rtl.createClass(this,"TSERTTKInspTObject",pas["WebLib.SERTTK.PluginTypes"].TSERTTKPluginInspectTool,(function(){this.InitToolUI=function(e){return t.TSERTTKToolInstTObjectInspector.$create("Create$4",[this,e])}})),rtl.createClass(this,"TSERTTKPlusInfo",pas["WEBLib.TMSFNCTreeView"].TTMSFNCTreeView,(function(){this.$init=function(){pas["WEBLib.TMSFNCTreeView"].TTMSFNCTreeView.$init.call(this),this.FPage=null,this.FObject=null},this.$final=function(){this.FPage=void 0,this.FObject=void 0,pas["WEBLib.TMSFNCTreeView"].TTMSFNCTreeView.$final.call(this)},this.PlusTreeInit=function(){var t=null,e=null;this.SetParent(this.FPage.FContainer),this.SetAlign(pas["WebLib.SEFNC.Layout"].TSEFNCAlign.GetAlign(5)),(t=this.FColumns.Add$1()).SetText("Item"),t.SetWidth(220),(t=this.FColumns.Add$1()).SetText("Detail"),this.FInteraction.SetColumnSizing(!0),(e=this.AddNode(null)).SetText(0,"itemname"),e.SetText(1,"detaildetail")},this.PlusTreeReload=function(){var t=rtl.createIntfRefs();try{this.ClearNodes(),this.BeginUpdate();try{try{this.LoadTagData(),t.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("Plus Tree Tag data loaded",this),this.LoadScaleInfo(),t.ref(2,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("Plus Tree Scale Info loaded",this),this.LoadObjectData(),t.ref(3,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("Plus Tree Object data loaded",this),this.LoadComponentData(),t.ref(4,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("Plus Tree Component data loaded",this),this.LoadDescends(),t.ref(5,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("Plus Tree Descends loaded",this)}catch(i){if(!pas.SysUtils.Exception.isPrototypeOf(i))throw i;var e=i;t.ref(6,pas["WebLib.SEFNC.Logger"].Logger()).Warn$1("Plus Tree reload failed"+e.FMessage,this)}}finally{this.EndUpdate()}}finally{t.free()}},this.LoadTagData=function(){var t=null,e=null;pas.Classes.TComponent.isPrototypeOf(this.FObject)&&(t=this.FObject,(e=this.AddNode(null)).SetText(0,"Tag Data"),e.SetExtended(!0),e.SetExpanded(!0),this.AddChildNode(e,"Tag",pas.SysUtils.TNativeIntHelper.ToString$1.call({p:t,get:function(){return this.p.FTag},set:function(t){this.p.FTag=t}})))},this.LoadDescends=function(){var t=null,e=null,i=rtl.createIntfRefs();try{try{t=this.FObject.$class.ClassType(),(e=this.AddNode(null)).SetText(0,this.FObject.$classname+" descends from "),e.SetExtended(!0);do{t=t.$ancestor,this.AddChildNode(e,t.$classname,"")}while(t!==pas.System.TObject);e.Expand(!1)}catch(t){if(!pas.SysUtils.Exception.isPrototypeOf(t))throw t;var s=t;i.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Warn$1("Error on Load Descends"+s.FMessage,this)}}finally{i.free()}},this.LoadScaleInfo=function(){},this.LoadComponentData=function(){var t=this,e=null,i=null,s=null,o=null,n=null,r="";var a=rtl.createIntfRefs();try{try{null!==this.FObject&&pas.Classes.TComponent.isPrototypeOf(this.FObject)&&(s=this.FObject,(e=this.AddNode(null)).SetText(0,"Component Data"),e.SetExtended(!0),e.SetExpanded(!0),function(){var o=0;i=t.AddChildNode(e,"Component Count",pas.SysUtils.TIntegerHelper.ToString$1.call({p:s.GetComponentCount(),get:function(){return this.p},set:function(t){this.p=t}}));for(var n=0,a=s.GetComponentCount()-1;n<=a;n++)o=n,r=s.GetComponent(o).FName,r=pas.SysUtils.TStringHelper.GetLength.call({get:function(){return r},set:function(t){r=t}})>0?r+" ("+s.GetComponent(o).$classname+")":s.GetComponent(o).$classname+"["+pas.SysUtils.TIntegerHelper.ToString$1.call({get:function(){return o},set:function(t){o=t}})+"]",t.AddChildNode(i,r,"-").FDataObject=s.GetComponent(o);i.SetExpanded(s.GetComponentCount()>0)}(),pas["WEBLib.Controls"].TWinControl.isPrototypeOf(s)&&function(){var o=null,n=0,a=0;a=(o=s).GetControlsCount(),i=t.AddChildNode(e,"Controls Count",pas.SysUtils.TIntegerHelper.ToString$1.call({get:function(){return a},set:function(t){a=t}}));for(var l=0,h=a-1;l<=h;l++)n=l,r=o.GetControls(n).FName,r=pas.SysUtils.TStringHelper.GetLength.call({get:function(){return r},set:function(t){r=t}})>0?r+" ("+o.GetControls(n).$classname+")":o.GetControls(n).$classname+"["+pas.SysUtils.TIntegerHelper.ToString$1.call({get:function(){return n},set:function(t){n=t}})+"]",t.AddChildNode(i,r,"-").FDataObject=o.GetControls(n);i.SetExpanded(a>0)}(),this.AddChildNode(e,"Component Index",pas.SysUtils.TIntegerHelper.ToString$1.call({p:s.GetComponentIndex(),get:function(){return this.p},set:function(t){this.p=t}})),null!==(n=s.GetParentComponent())?this.AddChildNode(e,"Parent = ",n.FName):this.AddChildNode(e,"Parent = nil","nil"),null!==(o=s.FOwner)?(this.AddChildNode(e,"Owner Name",o.FName),this.AddChildNode(e,"Owner ClassName",o.$classname),s.HasParent()&&o.Equals(n)?this.AddChildNode(e,"Owner = Parent",""):this.AddChildNode(e,"Owner <> Parent","")):this.AddChildNode(e,"Owner = unowned","UNOWNED!!"),this.LoadComponentState(e),this.LoadComponentStyle(e))}catch(e){if(!pas.SysUtils.Exception.isPrototypeOf(e))throw e;var l=e;a.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Error$1("Error in component data"+l.FMessage,t)}}finally{a.free()}},this.LoadObjectData=function(){var t=null;(t=this.AddNode(null)).SetText(0,"TObject Data"),t.SetExtended(!0),t.SetExpanded(!0),this.AddChildNode(t,"Class Name",this.FObject.$classname),this.AddChildNode(t,"Unit Name",this.FObject.$module.$name),this.AddChildNode(t,"Qualified Class Name",this.FObject.$class.QualifiedClassName())},this.LoadComponentState=function(t){var e=null,i={},s=rtl.createIntfRefs();try{(e=this.AddNode(t)).SetText(0,"Component State");try{e.SetExtended(!0),e.SetExpanded(!0),0 in(i=rtl.refSet(this.FObject.FComponentState))&&this.AddChildNode(e,"Loading","csLoading"),1 in i&&this.AddChildNode(e,"Reading","csReading"),2 in i&&this.AddChildNode(e,"Writing","csWriting"),3 in i&&this.AddChildNode(e,"Destroying","csDestroying"),4 in i&&this.AddChildNode(e,"Designing","csDesign"),5 in i&&this.AddChildNode(e,"Ancestor","csAncestor"),6 in i&&this.AddChildNode(e,"Updating","csUpdating"),7 in i&&this.AddChildNode(e,"Fixups","csFixups"),8 in i&&this.AddChildNode(e,"FreeNotification","csFreeNotification"),9 in i&&this.AddChildNode(e,"Inline","csInline"),10 in i&&this.AddChildNode(e,"DesignInstance","csDesignInstance"),e.Expand(!1)}catch(t){if(!pas.SysUtils.Exception.isPrototypeOf(t))throw t;var o=t;s.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Error$1("Failed load component state "+o.FMessage,this)}}finally{s.free()}},this.LoadComponentStyle=function(t){var e=null,i={},s=rtl.createIntfRefs();try{(e=this.AddNode(t)).SetText(0,"Component Style");try{e.SetExtended(!0),e.SetExpanded(!0),0 in(i=rtl.refSet(this.FObject.FComponentStyle))&&this.AddChildNode(e,"Inheritable","csInheritable"),1 in i&&this.AddChildNode(e,"CheckPropAvail","csCheckPropAvail"),2 in i&&this.AddChildNode(e,"SubComponent","csSubComponent"),3 in i&&this.AddChildNode(e,"Transient","csTransient"),e.Expand(!1)}catch(t){if(!pas.SysUtils.Exception.isPrototypeOf(t))throw t;var o=t;s.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Error$1("Failed load component style "+o.FMessage,this)}}finally{s.free()}},this.AddChildNode=function(t,e,i){var s=null;return(s=this.AddNode(t)).SetText(0,e),s.SetText(1,i),s},this.Create$10=function(t){return pas["WEBLib.TMSFNCCustomTreeView"].TTMSFNCCustomTreeView.Create$1.call(this,t.FContainer),this.FPage=t,this.PlusTreeInit(),this},this.AssignObject=function(t){var e=rtl.createIntfRefs();try{null===t?e.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Error$1("Null Object assigned to Plus Info",this):(this.FObject=t,this.PlusTreeReload())}finally{e.free()}},rtl.addIntf(this,pas["WEBLib.TMSFNCControlPicker"].ITMSFNCControlPickerFull),rtl.addIntf(this,pas["WEBLib.TMSFNCGraphicsTypes"].ITMSFNCAppearanceGlobalFont),rtl.addIntf(this,pas["WEBLib.TMSFNCBitmapContainer"].ITMSFNCBitmapContainer),rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas["WEBLib.TMSFNCTypes"].ITMSFNCProductInfo),rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TSERTTKTypInfo",pas["WEBLib.TMSFNCTreeView"].TTMSFNCTreeView,(function(){this.$init=function(){pas["WEBLib.TMSFNCTreeView"].TTMSFNCTreeView.$init.call(this),this.FPgTypInfo=null,this.FObject=null,this.FPropOI=null,this.FTypInfoNode=null,this.FDict=null},this.$final=function(){this.FPgTypInfo=void 0,this.FObject=void 0,this.FPropOI=void 0,this.FTypInfoNode=void 0,this.FDict=void 0,pas["WEBLib.TMSFNCTreeView"].TTMSFNCTreeView.$final.call(this)},this.TypInfoTreeCreate=function(){var t=null;this.SetParent(this.FPgTypInfo.FContainer),this.SetAlign(pas["WebLib.SEFNC.Layout"].TSEFNCAlign.GetAlign(5)),this.FColumns.Add$1().SetText("Property"),this.FColumns.Add$1().SetText("Classname"),this.FColumns.Add$1().SetText("HashCode"),(t=this.AddNode(null)).SetText(0,"itemname"),t.SetText(1,"detaildetail")},this.TypInfoTreeReload=function(){var t=rtl.createIntfRefs();try{t.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("Begin TypInfo reload",this),this.ClearNodes(),null!=this.FDict&&rtl.free(this,"FDict"),this.FDict=pas["Generics.Collections"].TDictionary$G20.$create("Create$1",[0]),this.BeginUpdate(),this.FTypInfoNode=this.AddNode(null),pas.Classes.TComponent.isPrototypeOf(this.FObject)?this.FTypInfoNode.SetText(0,this.FObject.FName):this.FTypInfoNode.SetText(0,"??"),this.FTypInfoNode.SetText(1,this.FObject.$classname),this.FTypInfoNode.SetText(2,"-"),this.FTypInfoNode.FDBKey="ROOT",this.TypInfoTreeLoadProperties(this.FObject,this.FTypInfoNode),this.FTypInfoNode.SetExpanded(!0),this.EndUpdate(),t.ref(2,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("End TypInfo reload",this)}finally{t.free()}},this.TypInfoTreeLoadProperties=function(t,e){var i,s,o=0;if(!t.Equals(this.FObject)||"ROOT"===e.FDBKey){i=t.$rtti,s=pas.TypInfo.GetPropList(i,pas.System.tkAny,!0);for(var n=0,r=rtl.length(s)-1;n<=r;n++)o=n,this.TypInfoTreePropertyAdd(t,s[o],e)}},this.TypInfoTreePropertyAdd=function(t,e,i){var s,o,n=null,r=null;s=this.FPropOI.FNCGetPropInfoName(e),o=this.FPropOI.FNCGetPropInfoType(e),(n=this.AddNode(i)).SetText(0,s),n.FDataPointer=e,n.FDataObject=t;var a=o;if(0===a)n.SetText(1,"Unknown");else if(1===a)n.SetText(1,"Integer");else if(2===a)n.SetText(1,"Char");else if(4===a)n.SetText(1,"Enum");else if(a===pas.System.TTypeKind.tkDouble)n.SetText(1,"Float");else if(3===a)n.SetText(1,"String");else if(5===a)n.SetText(1,"Set");else if(13===a){if(null==(r=pas.TypInfo.GetObjectProp(t,s)))return n.SetText(1,"nil"),void n.SetText(2,"-");n.SetText(1,r.$classname),n.SetText(2,"-"),this.TypInfoTreeLoadProperties(r,n)}else 9===a?n.SetText(1,"Method"):10===a?n.SetText(1,"Array"):12===a?n.SetText(1,"Record"):18===a?n.SetText(1,"Interface"):11===a?n.SetText(1,"DynArray"):14===a?n.SetText(1,"Class Ref"):15===a?n.SetText(1,"Pointer"):a===pas.System.TTypeKind.tkProcVar&&n.SetText(1,"Procedure")};this.PropPath=function(t){var e="",i=null,s=null;if(this.FDict.TryGetValue(t,{get:function(){return i},set:function(t){i=t}}))if(null===i)e="??";else if(i===this.FTypInfoNode)e="";else for(e=i.GetText(0)+" \\ ",s=i.GetParent();s!==this.FTypInfoNode;)e=s.GetText(0)+" \\ "+e,s=s.GetParent();return e},this.Create$10=function(t){return pas["WEBLib.TMSFNCCustomTreeView"].TTMSFNCCustomTreeView.Create$1.call(this,t.FContainer),this.FPgTypInfo=t,this.TypInfoTreeCreate(),this},this.Destroy=function(){rtl.free(this,"FDict"),pas["WEBLib.TMSFNCCustomTreeView"].TTMSFNCCustomTreeView.Destroy.call(this)},this.AssignObject=function(t,e){var i=rtl.createIntfRefs();try{i.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("Begin TypInfo reload",this),this.FPropOI=e,this.FObject=t,this.TypInfoTreeReload(),i.ref(2,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("End TypInfo reload",this)}finally{i.free()}},rtl.addIntf(this,pas["WEBLib.TMSFNCControlPicker"].ITMSFNCControlPickerFull),rtl.addIntf(this,pas["WEBLib.TMSFNCGraphicsTypes"].ITMSFNCAppearanceGlobalFont),rtl.addIntf(this,pas["WEBLib.TMSFNCBitmapContainer"].ITMSFNCBitmapContainer),rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas["WEBLib.TMSFNCTypes"].ITMSFNCProductInfo),rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TSERTTKOI",pas["WEBLib.TMSFNCObjectInspector"].TTMSFNCObjectInspector,(function(){this.$init=function(){pas["WEBLib.TMSFNCObjectInspector"].TTMSFNCObjectInspector.$init.call(this),this.FPage=null,this.FNodeCurrent=null},this.$final=function(){this.FPage=void 0,this.FNodeCurrent=void 0,pas["WEBLib.TMSFNCObjectInspector"].TTMSFNCObjectInspector.$final.call(this)},this.NodeMouseEnter=function(t,e){this.FNodeCurrent=e.FNode},this.FNCGetPropInfoType=function(t){return this.$class.GetPropInfoType(t)},this.FNCGetPropInfoName=function(t){return this.$class.GetPropInfoName(t)},this.AssignObject=function(t){this.SetObject(t),this.FOnNodeMouseEnter=rtl.createCallback(this,"NodeMouseEnter")},this.Create$11=function(t){var e=rtl.createIntfRefs();try{e.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("Begin create FNC Object Inspector",this),this.FPage=t,this.FPage.FContainer.BeginUpdate(),pas["WEBLib.TMSFNCObjectInspector"].TTMSFNCObjectInspector.Create$1.call(this,this.FPage.FContainer),this.SetParent(this.FPage.FContainer),this.SetAlign(pas["WebLib.SEFNC.Layout"].TSEFNCAlign.GetAlign(5)),this.BeginUpdate(),this.Initialize(),this.FGlobalFont.SetSize(10),this.EndUpdate(),this.FPage.FContainer.EndUpdate(),e.ref(2,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("End create FNC Object Inspector",this)}finally{e.free()}return this},rtl.addIntf(this,pas["WEBLib.TMSFNCControlPicker"].ITMSFNCControlPickerFull),rtl.addIntf(this,pas["WEBLib.TMSFNCGraphicsTypes"].ITMSFNCAppearanceGlobalFont),rtl.addIntf(this,pas["WEBLib.TMSFNCBitmapContainer"].ITMSFNCBitmapContainer),rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas["WEBLib.TMSFNCTypes"].ITMSFNCProductInfo),rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TSERTTKOIProperties",this.TSERTTKOI,(function(){this.$init=function(){t.TSERTTKOI.$init.call(this),this.FStep=null,this.FTypInfo=null,this.FMarshalProxy=null,this.FSession=null,this.FToolInfo=null,this.FSupportRepository=null},this.$final=function(){this.FStep=void 0,this.FTypInfo=void 0,this.FMarshalProxy=void 0,this.FSession=void 0,this.FToolInfo=void 0,this.FSupportRepository=void 0,t.TSERTTKOI.$final.call(this)},this.ResetStep=function(){var t=null;this.FStep=pas["WebLib.SERTTK.Session"].TSESSessionStepInspector.$create("Create$3",["Object Plus Modification",!0]),t=pas.Classes.TStringList.$create("Create$1");try{this.FSupportRepository.ScreenList({get:function(){return t},set:function(e){t=e}}),this.FStep.ScreensInit(t)}finally{t=rtl.freeLoc(t)}},this.ValueFormatted=function(t,e,i,s){var o="",n=null;try{if(4===e){n=pas.Classes.TStringList.$create("Create$1");try{this.$class.GetEnumValues(n,s),o=n.Get(pas.SysUtils.TStringHelper.ToInteger$1.call({get:function(){return t},set:function(e){t=e}}))}finally{n=rtl.freeLoc(n)}}else o=t}catch(e){if(!pas.SysUtils.Exception.isPrototypeOf(e))throw e;o=t}return o},this.DoBeforeOpenObjectEditor=function(t,e,i,s,o,n){pas["WEBLib.TMSFNCObjectInspector"].TTMSFNCObjectInspector.DoBeforeOpenObjectEditor.apply(this,arguments),13===s&&(this.FMarshalProxy.ObjectInTree(o)?(this.FMarshalProxy.SwitchToObject(o),n.set(!1)):null!=this.FNodeCurrent&&this.FNodeCurrent.GetChildCount()>0?(this.FNodeCurrent.Expand(!0),n.set(!1)):n.set(!0))},this.DoBeforeUpdateNode=function(t,e,i,s){s.set(pas.SysUtils.TStringHelper.Trim.call({p:t.FNode.GetText(e),get:function(){return this.p},set:function(t){this.p=t}})!==pas.SysUtils.TStringHelper.Trim.call(i)),s.get()&&(this.ResetStep(),t.FNode.FDataString=t.FNode.GetText(e)+" --\x3e "+i.get(),this.FStep.FPreviousValue=t.FNode.GetText(e)),pas["WEBLib.TMSFNCObjectInspector"].TTMSFNCObjectInspector.DoBeforeUpdateNode.apply(this,arguments)},this.DoPropertyValueChanged=function(t,e,i,s,o,n){var r=rtl.createIntfRefs();try{pas["WEBLib.TMSFNCObjectInspector"].TTMSFNCObjectInspector.DoPropertyValueChanged.apply(this,arguments),r.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Info$1("Value changed to "+o,this),this.FSession.StepAdd(this.FStep)}finally{r.free()}},this.DoWritePropertyValue=function(t,e,i,s,o,n,r){pas["WEBLib.TMSFNCObjectInspector"].TTMSFNCObjectInspector.DoWritePropertyValue.apply(this,arguments),this.FStep.FPropertyName=this.FTypInfo.PropPath(t)+i,this.FStep.FPropertyValue=this.ValueFormatted(o.get(),s,t,e),this.FStep.FCompPath=this.FToolInfo.FRepoItem.RefObjPath()},this.AssignProxy=function(t){this.FMarshalProxy=t},this.AssignSession=function(t){this.FSession=t},this.AssignToolInfo=function(t){this.FToolInfo=t},this.AssignTypInfo=function(t){this.FTypInfo=t},this.Create$11=function(e){return t.TSERTTKOI.Create$11.call(this,e),this.SetMode(1),this},rtl.addIntf(this,pas["WEBLib.TMSFNCControlPicker"].ITMSFNCControlPickerFull),rtl.addIntf(this,pas["WEBLib.TMSFNCGraphicsTypes"].ITMSFNCAppearanceGlobalFont),rtl.addIntf(this,pas["WEBLib.TMSFNCBitmapContainer"].ITMSFNCBitmapContainer),rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas["WEBLib.TMSFNCTypes"].ITMSFNCProductInfo),rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TSERTTKOIEvents",this.TSERTTKOI,(function(){this.ReadProcedureValue=function(t){var e="",i=pas.System.TMethod.$new(),s=null;try{if(i.$assign(pas.TypInfo.GetMethodProp$1(this.FObject,t)),null===i.Data)return"-";e=(s=i.Data).$classname+".",null!==i.Code?e+=s.$class.MethodName(i.Code):e+="-"}catch(t){if(!pas.SysUtils.Exception.isPrototypeOf(t))throw t;e="RTTI Failed"}return e},this.DoReadPropertyValue=function(t,e,i,s,o,n,r){pas["WEBLib.TMSFNCObjectInspector"].TTMSFNCObjectInspector.DoReadPropertyValue.apply(this,arguments);var a=s;a===pas.System.TTypeKind.tkProcVar?o.set("Procedure"):9===a&&o.set(this.ReadProcedureValue(i))},this.Create$11=function(e){return t.TSERTTKOI.Create$11.call(this,e),this.SetMode(2),this},rtl.addIntf(this,pas["WEBLib.TMSFNCControlPicker"].ITMSFNCControlPickerFull),rtl.addIntf(this,pas["WEBLib.TMSFNCGraphicsTypes"].ITMSFNCAppearanceGlobalFont),rtl.addIntf(this,pas["WEBLib.TMSFNCBitmapContainer"].ITMSFNCBitmapContainer),rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas["WEBLib.TMSFNCTypes"].ITMSFNCProductInfo),rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TSERTTKObjectPlus",pas.System.TObject,(function(){this.txt_help_link="https://swiftexpat.com/marshal/inspectors/object-plus.html",this.$init=function(){pas.System.TObject.$init.call(this),this.FPC=null,this.FPgProperties=null,this.FPgEvents=null,this.FPgPlus=null,this.FPgTypInfo=null,this.FToolPage=null,this.FToolBarArea=null,this.FLytPage=null,this.FObject=null,this.FOIProperties=null,this.FOIEvents=null,this.FTypInfo=null,this.FPlusInfo=null,this.FMarshalProxy=null,this.FSession=null,this.FToolInfo=null,this.FSupportRepository=null},this.$final=function(){this.FPC=void 0,this.FPgProperties=void 0,this.FPgEvents=void 0,this.FPgPlus=void 0,this.FPgTypInfo=void 0,this.FToolPage=void 0,this.FToolBarArea=void 0,this.FLytPage=void 0,this.FObject=void 0,this.FOIProperties=void 0,this.FOIEvents=void 0,this.FTypInfo=void 0,this.FPlusInfo=void 0,this.FMarshalProxy=void 0,this.FSession=void 0,this.FToolInfo=void 0,this.FSupportRepository=void 0,pas.System.TObject.$final.call(this)},this.CreatePages=function(){var t=rtl.createIntfRefs();try{this.FLytPage=pas["WebLib.SEFNC.Layout"].TSEFNCLayout.$create("Create$1",[this.FToolPage.FContainer]),this.FLytPage.SetParent(this.FToolPage.FContainer),this.FLytPage.SetAlign(pas["WebLib.SEFNC.Layout"].TSEFNCAlign.GetAlign(5)),this.FToolBarArea=pas["WebLib.SERTTK.CVTypes"].TSECVToolArea.$create("Create$4",[this.FLytPage]),this.FPC=pas["WEBLib.TMSFNCPageControl"].TTMSFNCPageControl.$create("Create$1",[this.FToolPage.FContainer]),this.FPC.SetParent(this.FLytPage),this.FPC.SetAlign(pas["WebLib.SEFNC.Layout"].TSEFNCAlign.GetAlign(5)),this.FPC.FInteraction.FSelectTabOnScroll=!1,this.FPC.BeginUpdate(),this.FPgProperties=this.FPC.AddPage("Properties"),this.FPgEvents=this.FPC.AddPage("Events"),this.FPgPlus=this.FPC.AddPage("Plus"),this.FPgTypInfo=this.FPC.AddPage("TypInfo"),this.FPC.EndUpdate(),this.FPC.FOnBeforeChangePage=rtl.createCallback(this,"BeforeChangePage"),this.FToolBarArea.HelpLinkSet(this.txt_help_link),this.FToolBarArea.NewButton$1("Reload",rtl.createCallback(this,"BtnReloadObjectClick")),t.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Info$1("Pages Created",this)}finally{t.free()}},this.BeforeChangePage=function(t,e,i,s){this.FPgProperties.GetIndex()===i?this.InitPageProperties():this.FPgEvents.GetIndex()===i?this.InitPageEvents():this.FPgPlus.GetIndex()===i?this.InitPagePlusInfo():this.FPgTypInfo.GetIndex()===i&&this.InitPageTypInfo()},this.InitPageProperties=function(){null===this.FOIProperties&&(this.FOIProperties=t.TSERTTKOIProperties.$create("Create$11",[this.FPgProperties]),this.FOIProperties.AssignObject(this.FObject),this.FOIProperties.AssignProxy(this.FMarshalProxy),this.FOIProperties.AssignSession(this.FSession),this.FOIProperties.AssignToolInfo(this.FToolInfo),this.FOIProperties.FSupportRepository=this.FSupportRepository,this.FTypInfo=t.TSERTTKTypInfo.$create("Create$10",[this.FPgTypInfo]),this.FTypInfo.AssignObject(this.FObject,this.FOIProperties),this.InitPageTypInfo(),this.FOIProperties.AssignTypInfo(this.FTypInfo))},this.InitPageEvents=function(){null===this.FOIEvents&&(this.FOIEvents=t.TSERTTKOIEvents.$create("Create$11",[this.FPgEvents]),this.FOIEvents.AssignObject(this.FObject))},this.InitPagePlusInfo=function(){null===this.FPlusInfo&&(this.FPlusInfo=t.TSERTTKPlusInfo.$create("Create$10",[this.FPgPlus]),this.FPlusInfo.AssignObject(this.FObject))},this.InitPageTypInfo=function(){null===this.FTypInfo&&(this.FTypInfo=t.TSERTTKTypInfo.$create("Create$10",[this.FPgTypInfo]),this.InitPageProperties(),this.FTypInfo.AssignObject(this.FObject,this.FOIProperties))},this.BtnExportObjectClick=function(t){var e=null,i=null,s=null;e=pas.Classes.TMemoryStream.$create("Create");try{i=pas.Classes.TStringStream.$create("Create$2",[""]);try{e.WriteComponent(this.FObject),e.Seek(0,0),pas.Classes.ObjectBinaryToText(e,i),i.Seek(0,0),(s=pas["WebLib.SERTTK.Session"].TSESSessionCompExport.$create("Create$2",["Component "+this.FToolInfo.FRepoItem.GetCompDisplayName()+" exported to text",!0])).FCompExport=i.GetDataString(),this.FSupportRepository.FSession.StepAdd(s)}finally{i=rtl.freeLoc(i)}}finally{e=rtl.freeLoc(e)}},this.BtnReloadObjectClick=function(t){null!==this.FOIProperties&&this.FOIProperties.AssignObject(this.FObject),null!==this.FOIEvents&&this.FOIEvents.AssignObject(this.FObject),null!==this.FPlusInfo&&this.FPlusInfo.AssignObject(this.FObject),null!==this.FTypInfo&&this.FTypInfo.AssignObject(this.FObject,this.FOIProperties)},this.ActivatePage=function(){this.FPgProperties===this.FPC.GetActivePage()&&null===this.FOIProperties?this.InitPageProperties():this.FPgEvents===this.FPC.GetActivePage()?this.InitPageEvents():this.FPgPlus===this.FPC.GetActivePage()?this.InitPagePlusInfo():this.FPgTypInfo===this.FPC.GetActivePage()&&this.InitPageTypInfo()},this.AssignObject=function(t,e){this.FObject=t,this.FToolInfo=e,pas.Classes.TComponent.isPrototypeOf(this.FObject)&&this.FToolBarArea.NewButton$1("Export",rtl.createCallback(this,"BtnExportObjectClick"))},this.AssignProxy=function(t){this.FMarshalProxy=t},this.AssignSession=function(t){this.FSession=t},this.Create$1=function(t){return this.FToolPage=t,this.CreatePages(),this}})),rtl.createClass(this,"TSERTTKToolInstTObjectInspector",pas["WebLib.SERTTK.PluginTypes"].TSERTTKPluginToolInstance,(function(){this.txt_inspector_name="Object Plus",this.$init=function(){pas["WebLib.SERTTK.PluginTypes"].TSERTTKPluginToolInstance.$init.call(this),this.FObjectPlus=null},this.$final=function(){this.FObjectPlus=void 0,pas["WebLib.SERTTK.PluginTypes"].TSERTTKPluginToolInstance.$final.call(this)},this.AssignInspector=function(t){if(null!==t)try{this.FObjectPlus.AssignObject(t,this.FToolInfo),this.StatusMessage("Inspecting "+this.FToolInfo.FRepoItem.GetCompDisplayPath())}catch(t){if(pas.SysUtils.Exception.isPrototypeOf(t)){var e=t;throw this.StatusMessage("Failed Initilization "+e.FMessage),pas.SysUtils.Exception.$create("Create$1",["Object Plus failed"])}throw t}else this.StatusMessage("Failed Initilization, Component not Assigned ")},this.InitToolInstance=function(){this.FObjectPlus=t.TSERTTKObjectPlus.$create("Create$1",[this.FToolPage]),this.FObjectPlus.AssignProxy(this.FInspectorCVInfo$1.FMarshalProxy),this.FObjectPlus.AssignSession(this.RepositoryGet().FSession),this.FObjectPlus.FSupportRepository=this.RepositoryGet(),this.AssignInspector(this.FToolInfo.FRepoItem.FRefObject)},this.ToolActivate=function(){this.FObjectPlus.ActivatePage()},this.ToolDeactivate=function(){},this.DisplayName=function(){return this.txt_inspector_name},this.Destroy=function(){rtl.free(this,"FObjectPlus"),pas.System.TObject.Destroy.call(this)}})),t.$init=function(){var e=rtl.createIntfRefs();try{e.ref(1,pas["WebLib.SERTTK.PluginTypes"].MarshalPlugins()).AddTransform(t.TSERTTKTxTObject.$create("Create$2"))}finally{e.free()}}}),["IOUtils","WEBLib.TMSFNCCustomTreeView","WEBLib.TMSFNCTypes","WEBLib.TMSFNCGraphicsTypes","WEBLib.TMSFNCUtils","WEBLib.Forms","WebLib.SEFNC.Logger","WEBLib.Controls"]),rtl.module("WebLib.SERTTK.PI.Application",["System","Types","Classes","WebLib.SERTTK.PluginTypes","WEBLib.Forms","WEBLib.TMSFNCTreeView","WEBLib.TMSFNCTreeViewData"],(function(){"use strict";var t=this;this.txt_null="-",rtl.createClass(this,"TSERTTKTxTApplication",pas["WebLib.SERTTK.PluginTypes"].TSERTTKPluginTransform,(function(){this.ExecTransform=function(){var e=this,i=0;function s(t){var s=rtl.createIntfRefs();try{i-1>=0?(s.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("Exchange item "+pas.SysUtils.TIntegerHelper.ToString$1.call({get:function(){return i},set:function(t){i=t}})+" with item "+pas.SysUtils.TIntegerHelper.ToString$1.call({a:i-1,get:function(){return this.a},set:function(t){rtl.raiseE("EPropReadOnly")}}),e),e.FRepoItem.FToolInfos.Exchange(i,i-1)):s.ref(2,pas["WebLib.SEFNC.Logger"].Logger()).Warn$1("Invalid destination index",e)}finally{s.free()}}var o=rtl.createIntfRefs();try{try{i=this.FRepoItem.ToolAdd(t.TSERTTKInspInfoList.$create("Create$1",[this.FRepoItem])),s(),o.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("App Transform : Added AppInfo",e)}catch(t){if(!pas.SysUtils.Exception.isPrototypeOf(t))throw t;var n=t;o.ref(2,pas["WebLib.SEFNC.Logger"].Logger()).Warn$1("App Transform : failed add Info list"+n.FMessage,e)}try{i=this.FRepoItem.ToolAdd(t.TSERTTKInspAppCompList.$create("Create$1",[this.FRepoItem])),s(),o.ref(3,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("App Transform : Added Tool CompList",e)}catch(t){if(!pas.SysUtils.Exception.isPrototypeOf(t))throw t;n=t;o.ref(4,pas["WebLib.SEFNC.Logger"].Logger()).Warn$1("App Transform : failed add comp list"+n.FMessage,e)}try{i=this.FRepoItem.ToolAdd(t.TSERTTKInspScreenInfo.$create("Create$1",[this.FRepoItem])),s(),o.ref(5,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("App Transform : Added Screen info CompList",e)}catch(t){if(!pas.SysUtils.Exception.isPrototypeOf(t))throw t;n=t;o.ref(6,pas["WebLib.SEFNC.Logger"].Logger()).Warn$1("App Transform : failed add screen list"+n.FMessage,e)}}finally{o.free()}},this.Create$2=function(){return pas["WebLib.SERTTK.Repository"].TSESTransformBase.Create$1.call(this,pas["WEBLib.Forms"].TApplication),this}})),rtl.createClass(this,"TSERTTKInspAppCompList",pas["WebLib.SERTTK.PluginTypes"].TSERTTKPluginInspectTool,(function(){this.InitToolUI=function(e){return t.TSERTTKToolInstAppCompList.$create("Create$4",[this,e])}})),rtl.createClass(this,"TSERTTKToolInstAppCompList",pas["WebLib.SERTTK.PluginTypes"].TSERTTKPluginToolInstance,(function(){this.$init=function(){pas["WebLib.SERTTK.PluginTypes"].TSERTTKPluginToolInstance.$init.call(this),this.FAppObj=null,this.FTV=null,this.FAppNode=null},this.$final=function(){this.FAppObj=void 0,this.FTV=void 0,this.FAppNode=void 0,pas["WebLib.SERTTK.PluginTypes"].TSERTTKPluginToolInstance.$final.call(this)},this.AddColumn=function(t){var e=null;return(e=this.FTV.FColumns.Add$1()).SetText(t),e.FFiltering.SetEnabled(!0),e.FFiltering.FMultiColumn=!0,e},this.AddTreeNode=function(e,i){var s=null,o=null;if(null===e)return null;o=e,s=this.FTV.AddNode(i);try{s.SetText(0,o.FName),0===pas.SysUtils.TStringHelper.GetLength.call({p:s.GetText(0),get:function(){return this.p},set:function(t){this.p=t}})&&s.SetText(0,t.txt_null),s.SetText(1,o.$classname),s.SetText(2,t.txt_null);try{o.HasParent()&&(null===o.GetParentComponent()?s.SetText(3,t.txt_null):s.SetText(3,"(A)- "+t.txt_null))}catch(t){if(!pas.SysUtils.Exception.isPrototypeOf(t))throw t;var n=t;s.SetText(3,n.FMessage)}null!==o.FOwner?s.SetText(4,"(A)- "+t.txt_null):s.SetText(4,t.txt_null)}catch(t){if(!pas.SysUtils.Exception.isPrototypeOf(t))throw t;n=t;s.SetText(0,n.FMessage)}return s},this.LoadCompChildren=function(t,e){var i=null,s=0,o=null,n=rtl.createIntfRefs();try{for(var r=0,a=t.GetComponentCount()-1;r<=a;r++)s=r,3 in t.FComponentState?n.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Trace("Comp Destroying"):(o=t.GetComponent(s),i=this.AddTreeNode(o,e),o.GetComponentCount()>0&&this.LoadCompChildren(o,i))}finally{n.free()}},this.LoadTreeRoots=function(){var t=null,e=null,i=null,s=null;t=pas["WebLib.SERTTK.Repository"].TSESProvider.$create("Create");try{e=t.ListRootComps(),this.FTV.BeginUpdate();var o=e.GetEnumerator$1();try{for(;o.MoveNext();)i=o.DoGetCurrent(),s=this.AddTreeNode(i,this.FAppNode),this.LoadCompChildren(i,s),s.SetExpanded(!0)}finally{o=rtl.freeLoc(o)}e=rtl.freeLoc(e)}finally{t=rtl.freeLoc(t),this.FTV.EndUpdate()}},this.AssignAppObject=function(){var t=rtl.createIntfRefs();try{try{this.FAppObj=this.FToolInfo.GetAppComponent(),this.FAppNode=this.AddTreeNode(this.FAppObj,null),this.LoadTreeRoots(),this.FAppNode.Expand(!0)}catch(i){if(pas.SysUtils.Exception.isPrototypeOf(i)){var e=i;throw t.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Debug$2("Failure loading app comps",e,this),pas.SysUtils.Exception.$create("Create$1",["Failed Loading App components"])}throw i}}finally{t.free()}},this.ReloadTree=function(t){this.FTV.ClearNodes(),this.AssignAppObject()},this.InitToolInstance=function(){this.FToolBarArea.NewButton$1("Reload",rtl.createCallback(this,"ReloadTree")),this.FTV=pas["WEBLib.TMSFNCTreeView"].TTMSFNCTreeView.$create("Create$1",[this.FOwner]),this.FTV.SetParent(this.FlytToolClient),this.FTV.SetAlign(pas["WebLib.SEFNC.Layout"].TSEFNCAlign.GetAlign(5)),this.FTV.ClearColumns(),this.FTV.ClearNodes(),this.AddColumn("Component name"),this.AddColumn("Class Name"),this.AddColumn("Hash Code"),this.AddColumn("Parent Hash Code"),this.AddColumn("Owner Hash Code"),this.AssignAppObject(),this.FTV.FInteraction.SetColumnSizing(!0),this.FTV.FInteraction.SetColumnAutoSizeOnDblClick(!0),this.FTV.FColumnsAppearance.SetStretchColumn(0)},this.DisplayName=function(){return"App Comps","App Comps"}})),rtl.createClass(this,"TSERTTKInspInfoList",pas["WebLib.SERTTK.PluginTypes"].TSERTTKPluginInspectTool,(function(){this.InitToolUI=function(e){return t.TSERTTKToolInstAppInfoList.$create("Create$4",[this,e])}})),rtl.createClass(this,"TSERTTKToolInstAppInfoList",pas["WebLib.SERTTK.PluginTypes"].TSERTTKPluginToolInstance,(function(){this.txt_inspector_name="App Info",this.txt_help_link="https://swiftexpat.com/marshal/inspectors/application-info.html",this.$init=function(){pas["WebLib.SERTTK.PluginTypes"].TSERTTKPluginToolInstance.$init.call(this),this.FTV=null},this.$final=function(){this.FTV=void 0,pas["WebLib.SERTTK.PluginTypes"].TSERTTKPluginToolInstance.$final.call(this)},this.AddTreeNode=function(t,e,i){var s=null;return(s=this.FTV.AddNode(t)).SetText(0,e),s.SetText(1,i),s},this.LoadTree=function(){this.FTV.BeginUpdate(),this.LoadAppInfo(),this.LoadBuildInfo(),this.LoadBrowserInfo(),this.FTV.EndUpdate()},this.LoadBrowserInfo=function(){var t=null;(t=this.FTV.AddNode(null)).SetExtended(!0),t.SetText(0,"Browser Information"),this.AddTreeNode(t,"User Agent",window.navigator.userAgent),this.AddTreeNode(t,"Language",window.navigator.language),this.AddTreeNode(t,"Platform",window.navigator.platform),window.navigator.cookieEnabled?this.AddTreeNode(t,"Cookies","Enabled"):this.AddTreeNode(t,"Cookies","Dis-abled"),window.navigator.onLine?this.AddTreeNode(t,"Online Status","Online"):this.AddTreeNode(t,"Online Status","Offline"),t.SetExpanded(!0)},this.LoadBuildInfo=function(){var t=null,e=null,i="",s=null;s=pas.Classes.TStringList.$create("Create$1");try{(t=this.FTV.AddNode(null)).SetExtended(!0),t.SetText(0,"Build Information"),t.SetExpanded(!0),this.AddTreeNode(t,"WebCore Version",pas["WEBLib.Forms"].WEBCOREVERSION),(e=this.FTV.AddNode(t)).SetText(0,"Compile Defines"),e.SetExtended(!0),e.SetExpanded(!0);var o=s.GetEnumerator();try{for(;o.MoveNext();)i=o.GetCurrent(),this.FTV.AddNode(e).SetText(0,i)}finally{o=rtl.freeLoc(o)}e.Expand(!1),(e=this.FTV.AddNode(t)).SetText(0,"Compile Options"),e.SetExtended(!0),e.SetExpanded(!0),e.Expand(!1),(e=this.FTV.AddNode(t)).SetText(0,"System Defines"),e.SetExtended(!0),e.SetExpanded(!0),this.AddTreeNode(e,"RELEASE",""),e.Expand(!1)}finally{s=rtl.freeLoc(s)}},this.LoadAppInfo=function(){var t=null,e=null;(e=this.FTV.AddNode(null)).SetExtended(!0),e.SetText(0,"Process Image Info"),e.SetExpanded(!0),this.AddTreeNode(e,"Application Name",this.FSession.ApplicationNameGet()),this.OnLineGet()&&((t=this.FTV.AddNode(e)).SetText(0,"Main Form"),null!=pas["WEBLib.Forms"].Application.FMainForm?t.SetText(1,pas["WEBLib.Forms"].Application.FMainForm.FName+" : "+pas["WEBLib.Forms"].Application.FMainForm.$classname):t.SetText(1,"Not Assigned !")),this.AddTreeNode(e,"Working Directory",this.RepositoryGet().FPlatformProvider.WorkingDirectory()),this.AddTreeNode(e,"Executable name",this.RepositoryGet().FPlatformProvider.ExecutablePath())},this.InitToolInstance=function(){var t=null;this.FTV=pas["WEBLib.TMSFNCTreeView"].TTMSFNCTreeView.$create("Create$1",[this.FOwner]),this.FTV.SetParent(this.FlytToolClient),this.FTV.SetAlign(pas["WebLib.SEFNC.Layout"].TSEFNCAlign.GetAlign(5)),this.FTV.ClearColumns(),this.FTV.ClearNodes(),(t=this.FTV.FColumns.Add$1()).SetText("Property"),t.SetWidth(240),(t=this.FTV.FColumns.Add$1()).SetText("Value"),this.FTV.FInteraction.FClipboardMode=1,this.FTV.FInteraction.SetColumnSizing(!0),this.FToolBarArea.HelpLinkSet(this.txt_help_link),this.LoadTree()},this.ExportToSession=function(){var t=null,e=rtl.createIntfRefs();try{pas["WebLib.SERTTK.MarshalTypes"].TSECVToolInstance.ExportToSession.call(this);try{t=pas["WebLib.SERTTK.Session"].TSESSessionStepInfoTree.$create("Create$4",["Application Information Report"]),this.FTV.FOnCanSaveProperty=rtl.createCallback(t,"CanSaveProperty"),t.SaveFNCTree(e.ref(1,rtl.queryIntfT(this.FTV,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence))),this.RepositoryGet().FSession.StepAdd(t),e.ref(2,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("Tool exported to session",this)}catch(t){e.ref(3,pas["WebLib.SEFNC.Logger"].Logger()).Warn$1("Failed export app info list to session",this)}}finally{e.free()}},this.DisplayName=function(){return this.txt_inspector_name}})),rtl.createClass(this,"TSERTTKInspScreenInfo",pas["WebLib.SERTTK.PluginTypes"].TSERTTKPluginInspectTool,(function(){this.InitToolUI=function(e){return t.TSERTTKToolInstAppScreenList.$create("Create$4",[this,e])}})),rtl.createClass(this,"TSERTTKToolInstAppScreenList",pas["WebLib.SERTTK.PluginTypes"].TSERTTKPluginToolInstance,(function(){this.$init=function(){pas["WebLib.SERTTK.PluginTypes"].TSERTTKPluginToolInstance.$init.call(this),this.FTV=null},this.$final=function(){this.FTV=void 0,pas["WebLib.SERTTK.PluginTypes"].TSERTTKPluginToolInstance.$final.call(this)},this.AddDetailNode=function(t,e,i){var s=null;return(s=this.FTV.AddNode(t)).SetText(0,e),s.SetText(1,i),s},this.LoadTree=function(){var t,e,i,s=this,o=null,n=null,r=null,a=null,l=null;o=pas["WebLib.SERTTK.Repository"].TSESScreenInfo.$create("Create$1");try{this.FTV.ClearNodes(),this.FTV.BeginUpdate(),(r=this.FTV.AddNode(null)).SetText(0,"Forms"),r.SetExtended(!0);var h=o.FFormInfo.GetEnumerator$1();try{for(;h.MoveNext();)n=h.DoGetCurrent(),t=r,e=n,i=void 0,i=null,(i=s.FTV.AddNode(t)).SetText(0,"Form = "+e.FormNameGet()),s.AddDetailNode(i,"DPI Scale",pas.SysUtils.TDoubleHelper.ToString$3.call({a:pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.GetDPIScale(e.FForm,-1),get:function(){return this.a},set:function(t){this.a=t}})),s.AddDetailNode(i,"High DPI Scale",pas.SysUtils.BoolToStr(pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.IsHighDPIScale(e.FForm,-1),!0)),s.AddDetailNode(i,"Bounds","").SetExtended(!0),l=i,(a=this.FTV.AddNode(l)).SetText(0,"Display Info"),a.SetExtended(!0)}finally{h=rtl.freeLoc(h)}r.SetExpanded(!0)}finally{this.FTV.EndUpdate(),o=rtl.freeLoc(o)}},this.ReloadTree=function(t){this.LoadTree()},this.ExportTree=function(t){var e=null,i=rtl.createIntfRefs();try{try{e=pas["WebLib.SERTTK.Session"].TSESSessionStepInfoTree.$create("Create$4",["Export Display / Screen Info"]),this.FTV.FOnCanSaveProperty=rtl.createCallback(e,"CanSaveProperty"),e.SaveFNCTree(i.ref(1,rtl.queryIntfT(this.FTV,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence))),this.FSession.StepAdd(e)}catch(t){if(!pas.SysUtils.Exception.isPrototypeOf(t))throw t;i.ref(2,pas["WebLib.SEFNC.Logger"].Logger()).Error$1("Failed to export tree for screen list",this)}}finally{i.free()}},this.InitToolInstance=function(){var t=rtl.createIntfRefs();try{this.FToolBarArea.NewButton$1("Reload",rtl.createCallback(this,"ReloadTree")),this.FToolBarArea.NewButton$1("Export",rtl.createCallback(this,"ExportTree"));try{this.FTV=pas["WEBLib.TMSFNCTreeView"].TTMSFNCTreeView.$create("Create$1",[this.FOwner]),this.FTV.SetParent(this.FlytToolClient),this.FTV.SetAlign(pas["WebLib.SEFNC.Layout"].TSEFNCAlign.GetAlign(5)),this.FTV.ClearColumns(),this.FTV.ClearNodes(),this.FTV.FColumns.Add$1().SetText("Property"),this.FTV.FColumns.Add$1().SetText("Value"),this.FTV.FInteraction.FClipboardMode=1,this.FTV.AddNode(null),this.LoadTree()}catch(i){if(pas.SysUtils.Exception.isPrototypeOf(i)){var e=i;throw t.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Debug$2("App screen list error",e,this),pas.SysUtils.Exception.$create("Create$1",["Error in display"])}throw i}}finally{t.free()}},this.DisplayName=function(){return"Screen Info","Screen Info"}})),t.$init=function(){var e=rtl.createIntfRefs();try{e.ref(1,pas["WebLib.SERTTK.PluginTypes"].MarshalPlugins()).AddTransform(t.TSERTTKTxTApplication.$create("Create$2"))}finally{e.free()}}}),["SysUtils","IOUtils","Generics.Collections","WEBLib.TMSFNCCustomTreeView","WEBLib.TMSFNCTypes","WEBLib.TMSFNCUtils","WebLib.SERTTK.Repository","WebLib.SERTTK.Session","WebLib.SEFNC.Layout","WebLib.SEFNC.Logger","Web","JS"]),rtl.module("WebLib.SERTTK.PI.FNCControl",["System","Types","Classes","WebLib.SERTTK.PluginTypes","WEBLib.Forms","WEBLib.TMSFNCCustomControl","WEBLib.TMSFNCTreeView","WEBLib.TMSFNCTreeViewData"],(function(){"use strict";var t=this;rtl.createClass(this,"TSERTTKTxTTMSFNCCustomControl",pas["WebLib.SERTTK.PluginTypes"].TSERTTKPluginTransform,(function(){this.ExecTransform=function(){this.FRepoItem.ToolAdd(t.TSERTTKInspTMSFNCCustomControl.$create("Create$1",[this.FRepoItem]))},this.Create$2=function(){return pas["WebLib.SERTTK.Repository"].TSESTransformBase.Create$1.call(this,pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl),this}})),rtl.createClass(this,"TSERTTKInspTMSFNCCustomControl",pas["WebLib.SERTTK.PluginTypes"].TSERTTKPluginInspectTool,(function(){this.InitToolUI=function(e){return t.TSERTTKToolInstTMSFNCCustomControl.$create("Create$4",[this,e])}})),this.TSERTTKFncPersistOperation={0:"optRttkFNCPersistSave",optRttkFNCPersistSave:0,1:"optRttkFNCPersistLoad",optRttkFNCPersistLoad:1},rtl.createClass(this,"TSERTTKFncPersistOption",pas.System.TObject,(function(){this.$init=function(){pas.System.TObject.$init.call(this),this.FControl=null,this.FOperation=0,this.AppearanceNode=null},this.$final=function(){this.FControl=void 0,this.AppearanceNode=void 0,pas.System.TObject.$final.call(this)},this.ExportPath=function(){return pas.IOUtils.TPath.Combine(pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.GetTempPath(),this.FControl.$classname)+".json"},this.Create$1=function(t,e){return this.FControl=t,this.FOperation=e,this}})),rtl.createClass(this,"TSERTTKToolInstTMSFNCCustomControl",pas["WebLib.SERTTK.PluginTypes"].TSERTTKPluginToolInstance,(function(){this.$init=function(){pas["WebLib.SERTTK.PluginTypes"].TSERTTKPluginToolInstance.$init.call(this),this.FPersistSave=null,this.FPersistLoad=null,this.FControl=null,this.FTV=null},this.$final=function(){this.FPersistSave=void 0,this.FPersistLoad=void 0,this.FControl=void 0,this.FTV=void 0,pas["WebLib.SERTTK.PluginTypes"].TSERTTKPluginToolInstance.$final.call(this)},this.DoAfterCheckNode=function(e,i,s){var o=null;1===s&&null!=i.FNode.FDataObject&&t.TSERTTKFncPersistOption.isPrototypeOf(i.FNode.FDataObject)&&(0===(o=i.FNode.FDataObject).FOperation&&(this.StatusMessage("Export component"),o.ExportPath(),i.FNode.SetText(1,"export Failed"),i.FNode.SetChecked(1,!1)),1===o.FOperation&&(this.StatusMessage("Load component"),i.FNode.SetText(1,"export Failed"),i.FNode.SetChecked(1,!1)))},this.TreeAddNode=function(t,e,i){var s=null;return(s=this.FTV.AddNode(t)).SetText(0,e),s.SetText(1,i),s},this.LoadTree=function(){this.FTV.FOnAfterCheckNode=null,this.FTV.ClearNodes(),this.FTV.BeginUpdate(),this.TreeDataProperties(),this.TreePersistenceOptions(),this.TreeUndoOptions(),this.TreeProductInfo(),this.FTV.EndUpdate(),this.FTV.FOnAfterCheckNode=rtl.createCallback(this,"DoAfterCheckNode")};this.TreeDataProperties=function(){var t=null;(t=this.FTV.AddNode(null)).SetText(0,"Data Properties"),t.SetExtended(!0);try{this.TreeAddNode(t,"DataString",this.FControl.FDataString),this.TreeAddNode(t,"DataInteger",pas.SysUtils.TNativeIntHelper.ToString$1.call({p:this.FControl,get:function(){return this.p.FDataInteger},set:function(t){this.p.FDataInteger=t}})),this.TreeAddNode(t,"DataBoolean",pas.SysUtils.BoolToStr(this.FControl.FDataBoolean,!0)),this.TreeAddNode(t,"DataPointer",pas.SysUtils.BoolToStr(null!=this.FControl.FDataPointer,!0)),null!=this.FControl.FDataObject?this.TreeAddNode(t,"DataObject",this.FControl.FDataObject.$classname):this.TreeAddNode(t,"DataObject","Not Assigned"),t.SetExpanded(!0),this.FTV.ExpandNode(t,!1)}catch(t){this.StatusMessage("Data Property error")}};this.TreeProductInfo=function(){var t=null,e=null;try{(t=this.FTV.AddNode(null)).SetText(0,"Product Info"),t.SetExtended(!0);try{e=rtl.setIntfL(e,rtl.queryIntfT(this.FControl,pas["WEBLib.TMSFNCTypes"].ITMSFNCProductInfo),!0),this.TreeAddNode(t,"Version",e.GetVersion()),this.TreeAddNode(t,"Doc URL",e.GetDocURL()),this.TreeAddNode(t,"Tips URL",e.GetTipsURL()),t.Expand(!1)}catch(e){if(!pas.SysUtils.Exception.isPrototypeOf(e))throw e;t.SetText(0,"Does not support Product Info Interface")}}finally{rtl._Release(e)}};this.TreePersistenceOptions=function(){var t=null,e=null,i=null;try{(t=this.FTV.AddNode(null)).SetText(0,"Persistence Options"),t.SetExtended(!0);try{i=rtl.setIntfL(i,rtl.queryIntfT(this.FControl,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),!0),(e=this.TreeAddNode(t,"Save Settings to file","<-- Check to Export")).SetChecked(1,!1),e.SetCheckType(1,1),e.FDataObject=this.FPersistSave,this.FPersistSave.AppearanceNode=this.FTV.AddNode(e),this.FPersistSave.AppearanceNode.SetText(0,"Appearance Only"),this.FPersistSave.AppearanceNode.SetChecked(0,!1),this.FPersistSave.AppearanceNode.SetCheckType(0,1),(e=this.TreeAddNode(t,"Load Settings from file","<-- Check to Import")).SetChecked(1,!1),e.SetCheckType(1,1),e.FDataObject=this.FPersistLoad,this.FPersistLoad.AppearanceNode=this.FTV.AddNode(e),this.FPersistLoad.AppearanceNode.SetText(0,"Appearance Only"),this.FPersistLoad.AppearanceNode.SetChecked(0,!1),this.FPersistLoad.AppearanceNode.SetCheckType(0,1),t.SetExpanded(!0),this.FTV.ExpandNode(t,!0)}catch(e){if(!pas.SysUtils.Exception.isPrototypeOf(e))throw e;t.SetText(0,"Does not support Persistence Info Interface")}}finally{rtl._Release(i)}};this.TreeUndoOptions=function(){var t=null,e=null,i=null,s=0;if((t=this.FTV.AddNode(null)).SetText(0,"Undo Manager"),t.SetExtended(!0),null!=this.FControl.GetUndoManager()){if(t.SetText(0,"Undo Manager - Assigned"),i=this.FControl.GetUndoManager(),this.TreeAddNode(t,"Can Undo",pas.SysUtils.BoolToStr(i.CanUndo(),!0)),i.CanUndo()&&this.TreeAddNode(t,"Next Undo Action",i.NextUndoAction()),this.TreeAddNode(t,"Can Redo",pas.SysUtils.BoolToStr(i.CanRedo(),!0)),i.CanRedo()&&this.TreeAddNode(t,"Next Redo Action",i.NextRedoAction()),e=this.FTV.AddNode(t),i.GetCount()>0){e.SetText(0,"State Count ="+pas.SysUtils.TIntegerHelper.ToString$1.call({p:i.GetCount(),get:function(){return this.p},set:function(t){this.p=t}}));for(var o=0,n=i.GetCount()-1;o<=n;o++)s=o,this.TreeAddNode(e,pas.SysUtils.TIntegerHelper.ToString$1.call({get:function(){return s},set:function(t){s=t}}),i.GetStackItem(s).FActionName);e.SetExpanded(!0)}else e.SetText(0,"State Count ="+pas.SysUtils.TIntegerHelper.ToString$1.call({p:i.GetCount(),get:function(){return this.p},set:function(t){this.p=t}}));t.SetExpanded(!0)}else t.SetText(0,"Undo Manager - NIL")},this.AssignComponent=function(e){this.FControl=e,this.FPersistSave=t.TSERTTKFncPersistOption.$create("Create$1",[this.FControl,0]),this.FPersistLoad=t.TSERTTKFncPersistOption.$create("Create$1",[this.FControl,1]),this.LoadTree()},this.ReloadTree=function(t){this.LoadTree()},this.ExportTree=function(t){var e=null,i=rtl.createIntfRefs();try{try{e=pas["WebLib.SERTTK.Session"].TSESSessionStepInfoTree.$create("Create$4",["Export FNC Comp Info"]),pas["WEBLib.TMSFNCTypes"].TTMSFNCObjectHelper.SaveToJSONStream.call(this.FTV,e.FInfoStream.FStream),this.FSession.StepAdd(e)}catch(t){if(!pas.SysUtils.Exception.isPrototypeOf(t))throw t;var s=t;i.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Warn$2("Failed export of Json Tree",s,this)}}finally{i.free()}},this.InitToolInstance=function(){var t=null;this.FToolBarArea.NewButton$1("Reload",rtl.createCallback(this,"ReloadTree")),this.FToolBarArea.NewButton$1("Export",rtl.createCallback(this,"ExportTree")),this.FTV=pas["WEBLib.TMSFNCTreeView"].TTMSFNCTreeView.$create("Create$1",[this.FOwner]),this.FTV.SetParent(this.FlytToolClient),this.FTV.SetAlign(pas["WebLib.SEFNC.Layout"].TSEFNCAlign.GetAlign(5)),this.FTV.ClearColumns(),this.FTV.ClearNodes(),this.FTV.FInteraction.FClipboardMode=1,this.FTV.FNodesAppearance.SetSelectionArea(3),(t=this.FTV.FColumns.Add$1()).SetText("Property"),t.SetWidth(250),(t=this.FTV.FColumns.Add$1()).SetText("Value"),this.FTV.FInteraction.SetColumnSizing(!0),null!==this.FToolInfo.GetAppComponent()&&pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.isPrototypeOf(this.FToolInfo.GetAppComponent())?this.AssignComponent(this.FToolInfo.GetAppComponent()):this.StatusMessage("Failed Check")},this.DisplayName=function(){return"FNC Control","FNC Control"},this.Destroy=function(){pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FPersistSave},set:function(t){this.p.FPersistSave=t}}),pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FPersistLoad},set:function(t){this.p.FPersistLoad=t}}),pas.System.TObject.Destroy.call(this)}})),t.$init=function(){var e=rtl.createIntfRefs();try{e.ref(1,pas["WebLib.SERTTK.PluginTypes"].MarshalPlugins()).AddTransform(t.TSERTTKTxTTMSFNCCustomControl.$create("Create$2"))}finally{e.free()}}}),["SysUtils","IOUtils","Generics.Collections","WEBLib.TMSFNCCustomTreeView","WEBLib.TMSFNCTypes","WEBLib.TMSFNCUtils","WEBLib.TMSFNCPersistence","WEBLib.TMSFNCUndo","WebLib.SERTTK.Session","WebLib.SEFNC.Layout","WebLib.SEFNC.Logger"]),rtl.module("WEBLib.DBCtrls",["System","Classes","DB","SysUtils","WEBLib.Controls","WEBLib.StdCtrls","WEBLib.ExtCtrls","WEBLib.Buttons","Web","WEBLib.REST"],(function(){"use strict";var t=this;this.TNavigateBtn={0:"nbFirst",nbFirst:0,1:"nbPrior",nbPrior:1,2:"nbNext",nbNext:2,3:"nbLast",nbLast:3,4:"nbInsert",nbInsert:4,5:"nbDelete",nbDelete:5,6:"nbEdit",nbEdit:6,7:"nbPost",nbPost:7,8:"nbCancel",nbCancel:8},this.$rtti.$Enum("TNavigateBtn",{minvalue:0,maxvalue:8,ordtype:1,enumtype:this.TNavigateBtn}),this.$rtti.$Set("TNavButtonSet",{comptype:this.$rtti.TNavigateBtn}),rtl.createClass(this,"TFieldDataLink",pas.DB.TDataLink,(function(){this.$init=function(){pas.DB.TDataLink.$init.call(this),this.FOnDataChange=null,this.FOnUpdateData=null,this.FOnActiveChange=null,this.FField=null,this.FFieldName="",this.FModified=!1},this.$final=function(){this.FOnDataChange=void 0,this.FOnUpdateData=void 0,this.FOnActiveChange=void 0,this.FField=void 0,pas.DB.TDataLink.$final.call(this)},this.UpdateField=function(){if(this.FField=null,null!=this.FDataSource&&null!=this.FDataSource.FDataSet&&""!==this.FFieldName&&this.FDataSource.FDataSet.GetActive())try{this.FField=this.FDataSource.FDataSet.FieldByName(this.FFieldName)}catch(t){this.FField=null}},this.ActiveChanged=function(){this.FActive?this.UpdateField():this.FField=null,null!=this.FOnActiveChange&&this.FOnActiveChange(this)},this.RecordChanged=function(t){null!==t&&t!==this.FField||null!=this.FOnDataChange&&this.FOnDataChange(this)},this.UpdateData=function(){this.FModified&&(null!==this.FField&&null!=this.FOnUpdateData&&this.FOnUpdateData(this),this.FModified=!1)};var t=this.$rtti;t.addProperty("FieldName",0,rtl.string,"FFieldName","FFieldName"),t.addProperty("OnDataChange",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnDataChange","FOnDataChange"),t.addProperty("OnUpdateData",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnUpdateData","FOnUpdateData"),t.addProperty("OnActiveChange",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnActiveChange","FOnActiveChange")})),rtl.createClass(this,"TDBNavigator",pas["WEBLib.Buttons"].TToolBar,(function(){this.$init=function(){pas["WEBLib.Buttons"].TToolBar.$init.call(this),this.FDataLink=null,this.FFirstBtn=null,this.FPriorBtn=null,this.FNextBtn=null,this.FLastBtn=null,this.FEditBtn=null,this.FPostBtn=null,this.FInsertBtn=null,this.FDeleteBtn=null,this.FCancelBtn=null,this.FVisibleButtons={},this.FHints=null,this.FImages=null,this.FBtnID=""},this.$final=function(){this.FDataLink=void 0,this.FFirstBtn=void 0,this.FPriorBtn=void 0,this.FNextBtn=void 0,this.FLastBtn=void 0,this.FEditBtn=void 0,this.FPostBtn=void 0,this.FInsertBtn=void 0,this.FDeleteBtn=void 0,this.FCancelBtn=void 0,this.FVisibleButtons=void 0,this.FHints=void 0,this.FImages=void 0,pas["WEBLib.Buttons"].TToolBar.$final.call(this)},this.SetVisibleButtons=function(t){this.FVisibleButtons=rtl.refSet(t),this.UpdateButtons()},this.SetHints=function(t){this.FHints.Assign(t),this.UpdateButtons()},this.SetImages=function(t){this.FImages.Assign(t),this.UpdateButtons()},this.UpdateButtons=function(){null!=this.FDataLink&&null!=this.FDataLink.FDataSource&&null!=this.FDataLink.FDataSource.FDataSet&&pas.System.Assigned(this.FDataLink.FDataSource.FDataSet.GetActive())?(this.FFirstBtn.SetEnabled(this.FEnabled&&this.FDataLink.GetDataset().GetActive()&&!this.FDataLink.GetDataset().FBOF),this.FPriorBtn.SetEnabled(this.FEnabled&&this.FDataLink.GetDataset().GetActive()&&!this.FDataLink.GetDataset().FBOF),this.FNextBtn.SetEnabled(this.FEnabled&&this.FDataLink.GetDataset().GetActive()&&!this.FDataLink.GetDataset().FEOF),this.FLastBtn.SetEnabled(this.FEnabled&&this.FDataLink.GetDataset().GetActive()&&!this.FDataLink.GetDataset().FEOF),this.FPostBtn.SetEnabled(this.FEnabled&&this.FDataLink.GetDataset().GetActive()&&this.FDataLink.GetDataset().FState in rtl.createSet(2,3)),this.FEditBtn.SetEnabled(this.FEnabled&&this.FDataLink.GetDataset().GetActive()&&1===this.FDataLink.GetDataset().FState&&!this.FDataLink.GetDataset().IsEmpty()),this.FInsertBtn.SetEnabled(this.FEnabled&&this.FDataLink.GetDataset().GetActive()&&!(3===this.FDataLink.GetDataset().FState)),this.FDeleteBtn.SetEnabled(this.FEnabled&&this.FDataLink.GetDataset().GetActive()&&!this.FDataLink.GetDataset().IsEmpty()),this.FCancelBtn.SetEnabled(this.FEnabled&&this.FDataLink.GetDataset().GetActive()&&this.FDataLink.GetDataset().FState in rtl.createSet(3,2))):(this.FFirstBtn.SetEnabled(!1),this.FPriorBtn.SetEnabled(!1),this.FNextBtn.SetEnabled(!1),this.FLastBtn.SetEnabled(!1),this.FEditBtn.SetEnabled(!1),this.FPostBtn.SetEnabled(!1),this.FInsertBtn.SetEnabled(!1),this.FDeleteBtn.SetEnabled(!1),this.FCancelBtn.SetEnabled(!1)),this.FFirstBtn.SetVisible(0 in this.FVisibleButtons),this.FPriorBtn.SetVisible(1 in this.FVisibleButtons),this.FNextBtn.SetVisible(2 in this.FVisibleButtons),this.FLastBtn.SetVisible(3 in this.FVisibleButtons),this.FEditBtn.SetVisible(6 in this.FVisibleButtons),this.FPostBtn.SetVisible(7 in this.FVisibleButtons),this.FInsertBtn.SetVisible(4 in this.FVisibleButtons),this.FDeleteBtn.SetVisible(5 in this.FVisibleButtons),this.FCancelBtn.SetVisible(8 in this.FVisibleButtons);for(;this.FHints.GetCount()<9;)this.FHints.Add("");this.FFirstBtn.SetHint(this.FHints.Get(0)),this.FPriorBtn.SetHint(this.FHints.Get(1)),this.FNextBtn.SetHint(this.FHints.Get(2)),this.FLastBtn.SetHint(this.FHints.Get(3)),this.FEditBtn.SetHint(this.FHints.Get(4)),this.FPostBtn.SetHint(this.FHints.Get(5)),this.FInsertBtn.SetHint(this.FHints.Get(6)),this.FDeleteBtn.SetHint(this.FHints.Get(7)),this.FCancelBtn.SetHint(this.FHints.Get(8)),this.UpdateImage(this.FFirstBtn,"&#xE5DC;",0),this.UpdateImage(this.FPriorBtn,"&#xE5CB;",1),this.UpdateImage(this.FNextBtn,"&#xE5CC;",2),this.UpdateImage(this.FLastBtn,"&#xE5DD;",3),this.UpdateImage(this.FEditBtn,"&#xE5C7;",4),this.UpdateImage(this.FPostBtn,"&#xE5CA;",5),this.UpdateImage(this.FInsertBtn,"&#xE145;",6),this.UpdateImage(this.FDeleteBtn,"&#xE15B;",7),this.UpdateImage(this.FCancelBtn,"&#xE14C;",8)},this.DataChange=function(t){this.UpdateButtons()},this.ActiveChange=function(t){this.UpdateButtons()},this.SetDataSource=function(t){this.FDataLink.SetDataSource(t)},this.GetDataSource=function(){return this.FDataLink.FDataSource},this.CreateButton=function(t,e,i,s){t.set(pas["WEBLib.Buttons"].TSpeedButton.$create("Create$2",[e])),t.get().SetFlat(!0),t.get().SetParent(this),this.FImages.GetCount()>s&&""!==this.FImages.Get(s)?t.get().SetGlyphURL(this.FImages.Get(s)):t.get().SetMaterialGlyph(i),t.get().SetWidth(32),t.get().SetHeight(24),t.get().SetAlign(3),this.FHints.GetCount()>s&&t.get().SetHint(this.FHints.Get(s)),t.get().SetShowHint(this.FHints.GetCount()>s&&""!==t.get().FHint),t.get().FOnClick=rtl.createCallback(this,"HandleSpeedButtonClick"),t.get().FOnMouseDown=rtl.createCallback(this,"HandleSpeedButtonMouseDown")},this.UpdateImage=function(t,e,i){this.FImages.GetCount()>i&&""!==this.FImages.Get(i)?(t.SetMaterialGlyph(""),t.SetGlyphURL(this.FImages.Get(i))):(t.SetMaterialGlyph(e),t.SetGlyphURL(""))},this.HandleSpeedButtonClick=function(t){var e="";null!=this.GetDataSource()&&null!=this.GetDataSource().FDataSet&&((e=t.GetID())===this.FBtnID+"_first"&&this.FDataLink.GetDataset().First(),e===this.FBtnID+"_prior"&&this.FDataLink.GetDataset().Prior(),e===this.FBtnID+"_next"&&this.FDataLink.GetDataset().Next(),e===this.FBtnID+"_last"&&this.FDataLink.GetDataset().Last(),e===this.FBtnID+"_edit"&&this.FDataLink.GetDataset().Edit(),e===this.FBtnID+"_insert"&&this.FDataLink.GetDataset().Insert$1(),e===this.FBtnID+"_delete"&&this.FDataLink.GetDataset().Delete(),e===this.FBtnID+"_post"&&this.FDataLink.GetDataset().Post(),e===this.FBtnID+"_cancel"&&this.FDataLink.GetDataset().Cancel())},this.HandleSpeedButtonMouseDown=function(t,e,i,s,o){this.SetFocus()},this.UpdateElement=function(){pas["WEBLib.Controls"].TControl.UpdateElement.call(this),this.IsUpdating()||this.AddControlLink("googlematerial","https://fonts.googleapis.com/icon?family=Material+Icons")},this.Loaded=function(){pas["WEBLib.Controls"].TCustomControl.Loaded.call(this),this.UpdateButtons()},this.GetChildren=function(t,e){},this.SetEnabled=function(t){pas["WEBLib.Controls"].TControl.SetEnabled.apply(this,arguments),this.UpdateButtons()},this.CreateInitialize=function(){pas["WEBLib.Buttons"].TCustomToolBar.CreateInitialize.call(this),this.FControlStyle=rtl.diffSet(this.FControlStyle,rtl.createSet(0)),this.AddControlStyle(".material-icons.md-18 { font-size: 18px; }.material-icons.md-24 { font-size: 24px; }.material-icons.md-36 { font-size: 36px; }.material-icons.md-48 { font-size: 48px; }.material-icons.md-dark { color: rgba(0, 0, 0, 0.54); }.material-icons.md-dark.md-inactive { color: rgba(255, 0, 0, 1); }.material-icons.md-light { color: rgba(255, 255, 255, 1); }.material-icons.md-light.md-inactive { color: rgba(128, 128, 128, 1); }"),this.SetWidth(288),this.FImages=pas.Classes.TStringList.$create("Create$1"),this.FHints=pas.Classes.TStringList.$create("Create$1"),this.FHints.Add("First"),this.FHints.Add("Prior"),this.FHints.Add("Next"),this.FHints.Add("Last"),this.FHints.Add("Edit"),this.FHints.Add("Post"),this.FHints.Add("Insert"),this.FHints.Add("Delete"),this.FHints.Add("Cancel"),this.FDataLink=t.TFieldDataLink.$create("Create$1"),this.FDataLink.FOnDataChange=rtl.createCallback(this,"DataChange"),this.FDataLink.FOnActiveChange=rtl.createCallback(this,"ActiveChange"),this.FBtnID=pas["WEBLib.Controls"].FindUniqueName("DBNavBtn"),this.CreateButton({p:this,get:function(){return this.p.FFirstBtn},set:function(t){this.p.FFirstBtn=t}},this.FBtnID+"_first","&#xE5DC;",0),this.CreateButton({p:this,get:function(){return this.p.FPriorBtn},set:function(t){this.p.FPriorBtn=t}},this.FBtnID+"_prior","&#xE5CB;",1),this.CreateButton({p:this,get:function(){return this.p.FNextBtn},set:function(t){this.p.FNextBtn=t}},this.FBtnID+"_next","&#xE5CC;",2),this.CreateButton({p:this,get:function(){return this.p.FLastBtn},set:function(t){this.p.FLastBtn=t}},this.FBtnID+"_last","&#xE5DD;",3),this.CreateButton({p:this,get:function(){return this.p.FEditBtn},set:function(t){this.p.FEditBtn=t}},this.FBtnID+"_edit","&#xE5C7;",4),this.CreateButton({p:this,get:function(){return this.p.FPostBtn},set:function(t){this.p.FPostBtn=t}},this.FBtnID+"_post","&#xE5CA;",5),this.CreateButton({p:this,get:function(){return this.p.FInsertBtn},set:function(t){this.p.FInsertBtn=t}},this.FBtnID+"_insert","&#xE145;",6),this.CreateButton({p:this,get:function(){return this.p.FDeleteBtn},set:function(t){this.p.FDeleteBtn=t}},this.FBtnID+"_delete","&#xE15B;",7),this.CreateButton({p:this,get:function(){return this.p.FCancelBtn},set:function(t){this.p.FCancelBtn=t}},this.FBtnID+"_cancel","&#xE14C;",8),this.FVisibleButtons=rtl.createSet(0,1,2,3,4,5,6,7,8),this.UpdateButtons()},this.Destroy=function(){rtl.free(this,"FDataLink"),rtl.free(this,"FHints"),rtl.free(this,"FImages"),pas["WEBLib.Controls"].TCustomControl.Destroy.call(this)},rtl.addIntf(this,pas.System.IUnknown);var e=this.$rtti;e.addProperty("Enabled",2,rtl.boolean,"FEnabled","SetEnabled",{Default:!0}),e.addProperty("Hints",2,pas.Classes.$rtti.TStringList,"FHints","SetHints"),e.addProperty("Images",2,pas.Classes.$rtti.TStringList,"FImages","SetImages"),e.addProperty("DataSource",3,pas.DB.$rtti.TDataSource,"GetDataSource","SetDataSource"),e.addProperty("VisibleButtons",2,t.$rtti.TNavButtonSet,"FVisibleButtons","SetVisibleButtons")})),rtl.createClass(this,"TWebDBNavigator",this.TDBNavigator,(function(){rtl.addIntf(this,pas.System.IUnknown)}))}),["WEBLib.WebTools","Math"]),rtl.module("WebLib.SERTTK.PI.TDataSet",["System","Types","Classes","Generics.Collections","SysUtils","WEBLib.DBCtrls","WebLib.SERTTK.PluginTypes","WebLib.SERTTK.CVTypes","WebLib.SEFNC.Layout","DB"],(function(){"use strict";var t=this,e=t.$impl;rtl.createClass(this,"TSERTTKTxTDataSet",pas["WebLib.SERTTK.PluginTypes"].TSERTTKPluginTransform,(function(){this.$init=function(){pas["WebLib.SERTTK.PluginTypes"].TSERTTKPluginTransform.$init.call(this),this.FDS=null},this.$final=function(){this.FDS=void 0,pas["WebLib.SERTTK.PluginTypes"].TSERTTKPluginTransform.$final.call(this)},this.TransformFields=function(){var t=null,e=0,i=0,s=[],o=null,n=null,r=rtl.createIntfRefs();try{if(0===this.FDS.FFieldList.GetCount())return;s=rtl.arraySetLength(s,null,this.FDS.FFieldList.GetCount()),t=this.AddLevel("Fields("+pas.SysUtils.TIntegerHelper.ToString$1.call({p:this.FDS.FFieldList.GetCount(),get:function(){return this.p},set:function(t){this.p=t}})+")");for(var a=0,l=this.FDS.FFieldList.GetCount()-1;a<=l;a++)e=a,n=this.FDS.FFieldList.GetField(e),r.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("Field "+n.FFieldName+" FieldIndex = "+pas.SysUtils.TIntegerHelper.ToString$1.call({p:n.GetIndex(),get:function(){return this.p},set:function(t){this.p=t}}),this),this.FRepoRoot.FRefApplication.LookupObject(n,{get:function(){return o},set:function(t){o=t}})?this.FRepoRoot.FRefApplication.ChildUpdateParent(o,t):o=t.AddChild(n),o.ToolAdd(pas["WebLib.SERTTK.PI.ObjectPlus"].TSERTTKInspTObject.$create("Create$1",[o])),s[n.GetIndex()]=o;for(var h=0,F=rtl.length(s)-1;h<=F;h++)o=s[e=h],(i=t.FChildren.IndexOf(o))!==e&&t.FChildren.Move(i,e);r.ref(2,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("Field count = "+pas.SysUtils.TNativeIntHelper.ToString$1.call({p:t.FChildren,get:function(){return this.p.FLength},set:function(t){this.p.FLength=t}}),this)}finally{r.free()}},this.ExecTransform=function(){var e=rtl.createIntfRefs();try{pas["WebLib.SERTTK.Repository"].TSESTransformBase.ExecTransform.call(this);try{if(!pas.DB.TDataSet.isPrototypeOf(this.FRepoItem.FRefObject))return;this.FDS=this.FRepoItem.FRefObject,e.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("TDataset found, adding grid to inspector",this),this.FRepoItem.ToolAdd(t.TSERTTKInspTDataSetGrid.$create("Create$1",[this.FRepoItem])),e.ref(2,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("Object Inspector assigned for "+this.FRepoItem.RefObjName(),this),this.TransformFields(),e.ref(3,pas["WebLib.SEFNC.Logger"].Logger()).Trace("Fields Transformed")}catch(t){if(!pas.SysUtils.Exception.isPrototypeOf(t))throw t;var i=t;e.ref(4,pas["WebLib.SEFNC.Logger"].Logger()).Debug$2("Failure exec transfrom: ",i,this)}}finally{e.free()}},this.Create$2=function(){return pas["WebLib.SERTTK.Repository"].TSESTransformBase.Create$1.call(this,pas.DB.TDataSet),this}})),rtl.createClass(this,"TSERTTKInspTDataSetGrid",pas["WebLib.SERTTK.PluginTypes"].TSERTTKPluginInspectTool,(function(){this.InitToolUI=function(e){return t.TSERTTKToolInstTDataSetGrid.$create("Create$4",[this,e])}})),rtl.createClass(this,"TSERTTKToolInstTDataSetGrid",pas["WebLib.SERTTK.PluginTypes"].TSERTTKPluginToolInstance,(function(){this.tool_display_name="DataSet Grid",this.txt_help_link="https://swiftexpat.com/marshal/inspectors/dataset-grid.html",this.$init=function(){pas["WebLib.SERTTK.PluginTypes"].TSERTTKPluginToolInstance.$init.call(this),this.FDG=null,this.FNavigator=null,this.FBindSource=null},this.$final=function(){this.FDG=void 0,this.FNavigator=void 0,this.FBindSource=void 0,pas["WebLib.SERTTK.PluginTypes"].TSERTTKPluginToolInstance.$final.call(this)},this.AssignDataset=function(t){this.FDG.AssignGrid(t),this.FBindSource.SetDataSet(t),this.FNavigator.SetDataSource(this.FBindSource),this.FDG.FDataSource.FOnStateChange=rtl.createCallback(this,"DataSourceStateChange"),this.StatusMessage(e.DatasetStates[this.FDG.FDataSource.FState])},this.OpenDataset=function(t){this.FToolInfo.GetAppComponent().SetActive(!0)},this.DataSourceStateChange=function(t){this.StatusMessage(e.DatasetStates[this.FDG.FDataSource.FState])},this.InitToolInstance=function(){this.FToolBarArea.HelpLinkSet(this.txt_help_link),this.FToolBarArea.NewButton$1("Open DS",rtl.createCallback(this,"OpenDataset")),this.FNavigator=pas["WEBLib.DBCtrls"].TWebDBNavigator.$create("Create$1",[this.FOwner]),this.FToolBarArea.AddCustomControl(this.FNavigator,1),this.FDG=pas["WebLib.SERTTK.CVTypes"].TSECVDataGrid.$create("Create$1",[this.FlytToolClient,rtl.createCallback(this,"StatusMessage")]),this.FBindSource=pas.DB.TDataSource.$create("Create$1",[this.FOwner]),this.AssignDataset(this.FToolInfo.GetAppComponent())},this.DisplayName=function(){return this.tool_display_name},this.Destroy=function(){rtl.free(this,"FDG"),pas.System.TObject.Destroy.call(this)}})),t.$implcode=function(){e.DatasetStates=["Not active","Browsing","Editing","Inserting","Set Key","Calc Fields","Filter","New Value","Old Value","Curr Value","Block Read","Internal Calc","Opening",""]},t.$init=function(){var e=rtl.createIntfRefs();try{e.ref(1,pas["WebLib.SERTTK.PluginTypes"].MarshalPlugins()).AddTransform(t.TSERTTKTxTDataSet.$create("Create$2"))}finally{e.free()}}}),["IOUtils","WEBLib.TMSFNCTypes","WEBLib.TMSFNCUtils","WEBLib.TMSFNCSplitter","WebLib.SERTTK.Session","WebLib.SERTTK.Repository","WebLib.SEFNC.Logger","WebLib.SERTTK.PI.ObjectPlus","TypInfo"]),rtl.module("WebLib.SERTTK.Repository",["System","Generics.Collections","Classes","WEBLib.Forms","WEBLib.Modules","WEBLib.Forms","WEBLib.TMSFNCTypes","WebLib.SERTTK.Session","SysUtils"],(function(){"use strict";var t=this;this.SupFormName="SEConstableForm",rtl.createClass(this,"ESERTTKBaseException",pas.SysUtils.Exception,(function(){})),rtl.createClass(this,"ESERTTKTransformException",this.ESERTTKBaseException,(function(){})),rtl.createClass(this,"TSESInspectToolBase",pas.System.TObject,(function(){this.$init=function(){pas.System.TObject.$init.call(this),this.FRepoItem=null},this.$final=function(){this.FRepoItem=void 0,pas.System.TObject.$final.call(this)},this.GetAppComponent=function(){return pas.Classes.TComponent.isPrototypeOf(this.FRepoItem.FRefObject)?this.FRepoItem.FRefObject:null},this.Create$1=function(t){return this.FRepoItem=t,this}})),rtl.createClass(this,"TSERTTKRepoItem",pas.System.TObject,(function(){this.txt_path_delim="|",this.$init=function(){pas.System.TObject.$init.call(this),this.FLabels=null,this.FChildren=null,this.FRepoParent=null,this.FRepoRoot=null,this.FRefObject=null,this.FToolInfos=null,this.FText1=""},this.$final=function(){this.FLabels=void 0,this.FChildren=void 0,this.FRepoParent=void 0,this.FRepoRoot=void 0,this.FRefObject=void 0,this.FToolInfos=void 0,pas.System.TObject.$final.call(this)},this.RootLookupObject=function(t,e){return this.FRepoRoot.FRefApplication.LookupObject(t,e)},this.GetText1=function(){return this.RefObjName()},this.GetCompDisplayName=function(){var t="";return t=this.RefObjName(),pas.SysUtils.TStringHelper.Contains.call({get:function(){return t},set:function(e){t=e}},"}")&&pas.SysUtils.TStringHelper.Contains.call({get:function(){return t},set:function(e){t=e}},"{")&&(t=pas.SysUtils.TStringHelper.Replace$2.call({get:function(){return t},set:function(e){t=e}},"}",'<FONT color="#800000">'),t=pas.SysUtils.TStringHelper.Replace$2.call({get:function(){return t},set:function(e){t=e}},"{","</FONT>")),t},this.GetCompDisplayPath=function(){var t="";return t=pas.SysUtils.TStringHelper.Replace$2.call({a:this.RefObjPath(),get:function(){return this.a},set:function(t){this.a=t}},"|",' <FONT color="#FF0000">\\</FONT> '),pas.SysUtils.TStringHelper.Contains.call({get:function(){return t},set:function(e){t=e}},"}")&&pas.SysUtils.TStringHelper.Contains.call({get:function(){return t},set:function(e){t=e}},"{")&&(t=pas.SysUtils.TStringHelper.Replace$2.call({get:function(){return t},set:function(e){t=e}},"}",'<FONT color="#800000">'),t=pas.SysUtils.TStringHelper.Replace$2.call({get:function(){return t},set:function(e){t=e}},"{","</FONT>")),t},this.GetCompRestorePath=function(){var t="";return t=pas.SysUtils.TStringHelper.Replace.call({a:this.RefObjPath(),get:function(){return this.a},set:function(t){this.a=t}},"|","\\"),pas.SysUtils.TStringHelper.Contains.call({get:function(){return t},set:function(e){t=e}},"}")&&pas.SysUtils.TStringHelper.Contains.call({get:function(){return t},set:function(e){t=e}},"{")&&(t=pas.SysUtils.TStringHelper.Replace$2.call({get:function(){return t},set:function(e){t=e}},"}",""),t=pas.SysUtils.TStringHelper.Replace$2.call({get:function(){return t},set:function(e){t=e}},"{","")),t},this.RepoParentSet=function(t){this.FRepoParent=t},this.VerifyParent=function(){var t=null,e=null,i=null,s=rtl.createIntfRefs();try{pas.Classes.TComponent.isPrototypeOf(this.FRefObject)&&((t=this.FRefObject).HasParent()?(e=t.GetParentComponent(),s.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Debug$1(this.RefObjName()+" Parent is "+e.FName,this),this.FRepoParent.FRefObject.Equals(e)?s.ref(2,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1(this.RefObjName()+" Parent is correct",this):(s.ref(3,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1(this.RefObjName()+" UPDATE Parent needed",this),this.RootLookupObject(e,{get:function(){return i},set:function(t){i=t}})?this.FRepoRoot.FRefApplication.ChildUpdateParent(this,i):s.ref(4,pas["WebLib.SEFNC.Logger"].Logger()).Debug$1("!!Parent not found to sanitize",this))):s.ref(5,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1(this.RefObjName()+" has no parent",this))}finally{s.free()}},this.DiscoverChildren=function(){var t=0,e=0,i=0,s=null,o=null,n=null,r=null,a=rtl.createIntfRefs();try{try{if(pas["WEBLib.Controls"].TControl.isPrototypeOf(this.FRefObject)){a.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1(this.RefObjName()+" R_I:Discover Children - Step Loading Controls ",this),n=this.FRefObject;for(var l=0,h=n.GetControlsCount()-1;l<=h;l++)if(e=l,3 in(r=n.GetControls(e)).FComponentState)a.ref(2,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("Repo Item:Discover Children - Control destroying, aborting",this);else if(this.RootLookupObject(r,{get:function(){return o},set:function(t){o=t}})?(a.ref(3,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1(this.RefObjName()+" R_I:Discover Children - Comp in the root list",this),this.FChildren.Contains(o)?a.ref(4,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1(this.RefObjName()+" R_I:Discover Children - Child has correct parent",this):(a.ref(5,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1(this.RefObjName()+" R_I:Discover Children - missing from child list",this),this.FRepoRoot.FRefApplication.ChildUpdateParent(o,this))):(a.ref(6,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1(this.RefObjName()+" R_I:Discover Children - not found in the root list",this),o=this.AddChild(r)),pas["WEBLib.Controls"].TWinControl.isPrototypeOf(o.FRefObject)?o.FRefObject.GetControlsCount()>0&&(a.ref(7,pas["WebLib.SEFNC.Logger"].Logger()).Debug$1(this.RefObjName()+" R_I:Discover Children - Recursion Discover children for "+o.RefObjName(),this),o.DiscoverChildren()):a.ref(8,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1(o.RefObjName()+" Not WinControl",this),pas["WEBLib.Forms"].TFrame.isPrototypeOf(r)){for(var F=0,p=r.GetComponentCount()-1;F<=p;F++)i=F,3 in(s=r.GetComponent(i)).FComponentState||o.AddChild(s);o.DiscoverChildren()}}a.ref(9,pas["WebLib.SEFNC.Logger"].Logger()).Debug$1(this.RefObjName()+" R_I:Discover children recursion done,Child count = "+pas.SysUtils.TNativeIntHelper.ToString$1.call({p:this.FChildren,get:function(){return this.p.FLength},set:function(t){this.p.FLength=t}}),this);for(var c=this.FChildren.FLength-1;c>=0;c--)t=c,this.FChildren.GetItem(t).VerifyParent();a.ref(10,pas["WebLib.SEFNC.Logger"].Logger()).Debug$1(this.RefObjName()+" R_I:Discover children verify parent done,Child count = "+pas.SysUtils.TNativeIntHelper.ToString$1.call({p:this.FChildren,get:function(){return this.p.FLength},set:function(t){this.p.FLength=t}}),this)}catch(t){if(!pas.SysUtils.Exception.isPrototypeOf(t))throw t;var u=t;a.ref(11,pas["WebLib.SEFNC.Logger"].Logger()).Warn$1(this.RefObjName()+" R_I:Discover children ex="+u.FMessage,this)}}finally{a.free()}},this.AddChild=function(e){var i=null,s=rtl.createIntfRefs();try{if(null===e)throw pas.SysUtils.Exception.$create("Create$1",["Cannot add nil child reference"]);this.FRepoRoot.FRefApplication.LookupObject(e,{get:function(){return i},set:function(t){i=t}})?s.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("Object "+i.RefObjName()+"found in lookup parent = "+i.FRepoParent.RefObjName(),this):(i=t.TSERTTKRepoItem.$create("Create$1",[e,this,this.FRepoRoot]),this.FRepoRoot.FRefApplication.AddRefObject(i),s.ref(2,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("Object not in lookup, creating object for "+i.RefObjName(),this)),this.FRepoRoot.FRefApplication.ChildUpdateParent(i,this),s.ref(3,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("Success adding "+i.RefObjName()+" to parent "+this.RefObjName(),this)}finally{s.free()}return i},this.AddLabel=function(e){var i=null,s=rtl.createIntfRefs();try{var o=this.FLabels.GetEnumerator$1();try{for(;o.MoveNext();)if((i=o.DoGetCurrent()).GetText1()===e)return i}finally{o=rtl.freeLoc(o)}i=t.TSERTTKRepoLabel.$create("Create$2",[e,this.FRefObject,this,this.FRepoRoot]),this.FLabels.Add(i),s.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("Label Added: "+e+" to component "+this.RefObjName(),this)}finally{s.free()}return i},this.ToolAdd=function(t){return this.FToolInfos.Add(t)},this.RefObjName=function(){var t="";return pas.Classes.TComponent.isPrototypeOf(this.FRefObject)&&(t=pas.SysUtils.Format("%s",pas.System.VarRecs(18,this.FRefObject.FName)),pas.SysUtils.TStringHelper.GetLength.call({a:pas.SysUtils.TStringHelper.Trim.call({get:function(){return t},set:function(e){t=e}}),get:function(){return this.a},set:function(t){this.a=t}})>0)?t:t="}"+this.FRefObject.$classname+"{"},this.RefObjPath=function(){var t="";return t=this.RefObjName(),null!==this.FRepoParent&&(t=this.FRepoParent.RefObjPath()+this.txt_path_delim+t),t},this.Create$1=function(t,e,i){return this.FToolInfos=pas["Generics.Collections"].TObjectList$G9.$create("Create$4",[!0]),this.FLabels=pas["Generics.Collections"].TObjectList$G8.$create("Create$4",[!0]),this.FChildren=pas["Generics.Collections"].TList$G15.$create("Create$1"),this.FRefObject=t,this.FRepoRoot=i,this.FRepoParent=e,this},this.Destroy=function(){pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FToolInfos},set:function(t){this.p.FToolInfos=t}}),pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FLabels},set:function(t){this.p.FLabels=t}}),pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FChildren},set:function(t){this.p.FChildren=t}}),pas.System.TObject.Destroy.call(this)}})),rtl.createClass(this,"TSERTTKRepoLabel",this.TSERTTKRepoItem,(function(){this.GetText1=function(){return this.FText1},this.Create$2=function(e,i,s,o){return t.TSERTTKRepoItem.Create$1.call(this,i,s,o),this.FText1=e,this}})),rtl.createClass(this,"TSESRepoRoot",this.TSERTTKRepoItem,(function(){this.$init=function(){t.TSERTTKRepoItem.$init.call(this),this.FRefApplication=null,this.FRootComponent=null},this.$final=function(){this.FRefApplication=void 0,this.FRootComponent=void 0,t.TSERTTKRepoItem.$final.call(this)},this.Create$2=function(e,i){var s=rtl.createIntfRefs();try{t.TSERTTKRepoItem.Create$1.call(this,e,i,this),this.FRefApplication=i,this.FRootComponent=e,s.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Debug$1("RepoRoot::Create: starting to Tree the components",this)}finally{s.free()}return this},this.DiscoverChildren=function(){var t=0,e=null,i=rtl.createIntfRefs();try{this.FChildren.Clear(),i.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("Root children cleared count = "+pas.SysUtils.TNativeIntHelper.ToString$1.call({p:this.FChildren,get:function(){return this.p.FLength},set:function(t){this.p.FLength=t}}),this);for(var s=0,o=this.FRootComponent.GetComponentCount()-1;s<=o;s++)t=s,3 in this.FRootComponent.GetComponent(t).FComponentState?i.ref(2,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("Control destroying, aborting",this):this.AddChild(this.FRootComponent.GetComponent(t));for(var n=this.FChildren.FLength-1;n>=0;n--)t=n,(e=this.FChildren.GetItem(t)).VerifyParent(),e.DiscoverChildren();i.ref(3,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("Root discover components complete, child count = "+pas.SysUtils.TNativeIntHelper.ToString$1.call({p:this.FChildren,get:function(){return this.p.FLength},set:function(t){this.p.FLength=t}}),this)}finally{i.free()}}})),rtl.createClass(this,"TSESRepoRootComp",this.TSESRepoRoot,(function(){this.GetDisplayName=function(){var t="";return null!=this.FRootComponent&&(t=this.FRootComponent.FName),t},this.LoadRootControls=function(){var t=rtl.createIntfRefs();try{try{t.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("Load root controls - Begin for item "+this.RefObjName(),this),this.DiscoverChildren(),t.ref(2,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("Load root controls - End for item "+this.RefObjName(),this)}catch(e){if(!pas.SysUtils.Exception.isPrototypeOf(e))throw e;t.ref(3,pas["WebLib.SEFNC.Logger"].Logger()).Warn$1("failed loading controls for root "+this.GetDisplayName(),this)}}finally{t.free()}}})),rtl.createClass(this,"TSESRepoForm",this.TSESRepoRootComp,(function(){this.ActiveControl=function(){if(!this.HasActive())throw pas.SysUtils.Exception.$create("Create$1",["No active control"]);return this.FRootComponent.GetActiveControl()},this.HasActive=function(){return null!==this.FRootComponent.GetActiveControl()}})),rtl.createClass(this,"TSESRepoDataModule",this.TSESRepoRootComp,(function(){})),rtl.createClass(this,"TSESAppReference",this.TSERTTKRepoItem,(function(){this.$init=function(){t.TSERTTKRepoItem.$init.call(this),this.FAppName="",this.FRoots=null,this.FObjectDict=null,this.FChildMap=null,this.FApplication=null},this.$final=function(){this.FRoots=void 0,this.FObjectDict=void 0,this.FChildMap=void 0,this.FApplication=void 0,t.TSERTTKRepoItem.$final.call(this)},this.ClearRoots=function(){null!=this.FRoots&&rtl.free(this,"FRoots"),this.FRoots=pas["Generics.Collections"].TList$G17.$create("Create$1")},this.ChildUpdateParent=function(t,e){var i=this,s=null,o=null;function n(){-1===s.FRepoParent.FChildren.IndexOf(s)&&s.FRepoParent.FChildren.Add(s)}function r(t){var e=rtl.createIntfRefs();try{e.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1(s.FRepoParent.RefObjName()+t+pas.SysUtils.TNativeIntHelper.ToString$1.call({p:s.FRepoParent.FChildren,get:function(){return this.p.FLength},set:function(t){this.p.FLength=t}}),i)}finally{e.free()}}var a=rtl.createIntfRefs();try{try{s=t,o=e,this.FChildMap.AddOrSetValue(s,o),null===s.FRepoParent?(s.RepoParentSet(o),n(),a.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("Parent was nil for "+s.RefObjName()+", changed to new parent ="+o.RefObjName(),i)):s.FRepoParent.Equals(e)?(n(),a.ref(2,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("Parent is correctly assigned for "+s.RefObjName(),i)):(a.ref(3,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1(s.RefObjName()+" Change Parent "+s.FRepoParent.RefObjName()+" to "+o.RefObjName(),i),r(" child count before extract "),s.FRepoParent.FChildren.Extract(s),r(" child count after extract "),s.RepoParentSet(o),a.ref(4,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("Parent now "+s.FRepoParent.RefObjName(),i),r(" child count before add "),n(),r(" child count after add "))}catch(t){if(!pas.SysUtils.Exception.isPrototypeOf(t))throw t;var l=t;a.ref(5,pas["WebLib.SEFNC.Logger"].Logger()).Debug$1("Exception on change parent :"+l.FMessage,i)}}finally{a.free()}},this.AddRefObject=function(t){this.FObjectDict.AddOrSetValue(t.FRefObject,t)},this.AddRoot=function(t){var e=rtl.createIntfRefs();try{-1===this.FRoots.IndexOf(t)&&this.FRoots.Add(t),this.AddRefObject(t),e.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("Root added "+t.RefObjName(),this)}finally{e.free()}},this.RefreshRoot=function(e){var i=!1,s=null,o=rtl.createIntfRefs();try{try{o.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Info$1("Refresh Root, = "+e.RefObjName(),this),t.TSESRepoRootComp.isPrototypeOf(e)?(s=e,o.ref(2,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("Discover begin for loop item "+s.RefObjName(),this),s.LoadRootControls(),o.ref(3,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("Discover end for loop item "+s.RefObjName(),this),i=!0):i=!1}catch(t){if(pas.SysUtils.Exception.isPrototypeOf(t)){throw pas.SysUtils.Exception.$create("Create$1",["Unknown repo root on reload"])}throw t}}finally{o.free()}return i},this.LookupObject=function(t,e){return this.FObjectDict.TryGetValue(t,e)},this.Create$2=function(e){return t.TSERTTKRepoItem.Create$1.call(this,e,null,null),this.FApplication=e,this.ClearRoots(),this.FObjectDict=pas["Generics.Collections"].TObjectDictionary$G7.$create("Create$5",[rtl.createSet(1)]),this.FChildMap=pas["Generics.Collections"].TDictionary$G11.$create("Create$1",[0]),this},this.Destroy=function(){rtl.free(this,"FChildMap"),rtl.free(this,"FRoots"),rtl.free(this,"FObjectDict"),t.TSERTTKRepoItem.Destroy.call(this)}})),rtl.createClass(this,"TSEMonitor",pas.System.TObject,(function(){})),rtl.createClass(this,"TSESDisplayInfo",pas.System.TObject,(function(){this.$init=function(){pas.System.TObject.$init.call(this),this.FMonitor=null},this.$final=function(){this.FMonitor=void 0,pas.System.TObject.$final.call(this)},this.Create$1=function(t){return this.FMonitor=t,this}})),rtl.createClass(this,"TSESFormInfo",pas.System.TObject,(function(){this.$init=function(){pas.System.TObject.$init.call(this),this.FForm=null,this.FDisplayInfo=null},this.$final=function(){this.FForm=void 0,this.FDisplayInfo=void 0,pas.System.TObject.$final.call(this)},this.FormNameGet=function(){return this.FForm.FName+":"+this.FForm.$classname},this.Create$1=function(t){return this.FForm=t,this},this.Destroy=function(){rtl.free(this,"FDisplayInfo"),pas.System.TObject.Destroy.call(this)},this.AssignMonitor=function(e){this.FDisplayInfo=t.TSESDisplayInfo.$create("Create$1",[e])}})),rtl.createClass(this,"TSESScreenInfo",pas.System.TObject,(function(){this.$init=function(){pas.System.TObject.$init.call(this),this.FDisplayInfo=null,this.FFormInfo=null},this.$final=function(){this.FDisplayInfo=void 0,this.FFormInfo=void 0,pas.System.TObject.$final.call(this)},this.LoadFormInfo=function(){var e,i=null;i=t.TSESFormInfo.$create("Create$1",[pas["WEBLib.Forms"].Application.FMainForm]),e=t.TSEMonitor.$create("Create"),i.AssignMonitor(e),this.FFormInfo.Add(i)},this.LoadDisplayInfo=function(){this.FDisplayInfo.Add(0,null)},this.Create$1=function(){return this.FDisplayInfo=pas["Generics.Collections"].TObjectDictionary$G8.$create("Create$5",[rtl.createSet(1)]),this.FFormInfo=pas["Generics.Collections"].TObjectList$G10.$create("Create$4",[!0]),this.LoadInfo(),this},this.Destroy=function(){rtl.free(this,"FDisplayInfo"),rtl.free(this,"FFormInfo"),pas.System.TObject.Destroy.call(this)},this.LoadInfo=function(){this.LoadDisplayInfo(),this.LoadFormInfo()}})),rtl.createClass(this,"TSESProvider",pas.System.TObject,(function(){this.$init=function(){pas.System.TObject.$init.call(this),this.FAppReference=null},this.$final=function(){this.FAppReference=void 0,pas.System.TObject.$final.call(this)},this.FilterForm=function(t){return t===pas["WebLib.SERTTK.MarshalTypes"].TSERTTKMarshalForm.$classname},this.AppComp=function(){return pas["WEBLib.Forms"].Application},this.ApplicationName=function(){var t="";return t=location.pathname,0===pas.SysUtils.TStringHelper.GetLength.call({get:function(){return t},set:function(e){t=e}})?"WebApp":pas.SysUtils.TStringHelper.StartsWith.call({get:function(){return t},set:function(e){t=e}},"/")?pas.SysUtils.TStringHelper.Substring$1.call({get:function(){return t},set:function(e){t=e}},1,pas.SysUtils.TStringHelper.IndexOf$2.call({get:function(){return t},set:function(e){t=e}},"/",2)-1):t},this.WorkingDirectory=function(){var t="";return t=location.pathname,0===pas.SysUtils.TStringHelper.GetLength.call({get:function(){return t},set:function(e){t=e}})?"WebServer":t},this.ExecutablePath=function(){var t="";return t=location.href,0===pas.SysUtils.TStringHelper.GetLength.call({get:function(){return t},set:function(e){t=e}})?"WebServer":t},this.ListRootComps=function(){var t=null,e=0,i=rtl.createIntfRefs();try{t=pas["Generics.Collections"].TList$G19.$create("Create$1"),null!=pas["WEBLib.Forms"].Application.FMainForm&&(i.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Debug("Root Comp - main form "+pas["WEBLib.Forms"].Application.FMainForm.FName+"::"+pas["WEBLib.Forms"].Application.FMainForm.$module.$name),t.Add(pas["WEBLib.Forms"].Application.FMainForm));for(var s=0,o=pas["WEBLib.Forms"].Application.GetComponentCount()-1;s<=o;s++)e=s,pas["WEBLib.Modules"].TDataModule.isPrototypeOf(pas["WEBLib.Forms"].Application.GetComponent(e))&&t.Add(pas["WEBLib.Forms"].Application.GetComponent(e));for(var n=0,r=pas["WEBLib.Forms"].Application.GetComponentCount()-1;n<=r;n++)e=n,pas["WEBLib.Forms"].TForm.isPrototypeOf(pas["WEBLib.Forms"].Application.GetComponent(e))&&(this.$class.FilterForm(pas["WEBLib.Forms"].Application.GetComponent(e).FName)?i.ref(2,pas["WebLib.SEFNC.Logger"].Logger()).Debug("Form filtered ="+pas["WEBLib.Forms"].Application.GetComponent(e).FName):t.Add(pas["WEBLib.Forms"].Application.GetComponent(e)))}finally{i.free()}return t},this.DiscoverForms=function(){var e=0,i=null,s=null,o=rtl.createIntfRefs();try{o.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Info$1("Discover Forms: Begin Discover root count ="+pas.SysUtils.TNativeIntHelper.ToString$1.call({p:this.FAppReference.FRoots,get:function(){return this.p.FLength},set:function(t){this.p.FLength=t}}),this),null!=pas["WEBLib.Forms"].Application.FMainForm?(o.ref(2,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("Discover Forms: main form assigned",this),i=t.TSESRepoForm.$create("Create$2",[pas["WEBLib.Forms"].Application.FMainForm,this.FAppReference]),this.FAppReference.AddRoot(i),o.ref(3,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("Discover Forms: Begin load root controls "+i.RefObjName(),this),i.LoadRootControls(),o.ref(4,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("Discover Forms: End load root controls "+i.RefObjName(),this)):o.ref(5,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("main form nil",this),o.ref(6,pas["WebLib.SEFNC.Logger"].Logger()).Info$1("Discover Forms: App component count = "+pas.SysUtils.TIntegerHelper.ToString$1.call({p:pas["WEBLib.Forms"].Application.GetComponentCount(),get:function(){return this.p},set:function(t){this.p=t}}),this);for(var n=0,r=pas["WEBLib.Forms"].Application.GetComponentCount()-1;n<=r;n++)if(e=n,pas["WEBLib.Forms"].TCustomForm.isPrototypeOf(pas["WEBLib.Forms"].Application.GetComponent(e)))if(this.$class.FilterForm(pas["WEBLib.Forms"].Application.GetComponent(e).$classname))o.ref(7,pas["WebLib.SEFNC.Logger"].Logger()).Info$1("Discover Forms:Form filtered ="+pas["WEBLib.Forms"].Application.GetComponent(e).FName,this);else{if(o.ref(8,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("Discover Forms:Evaluating form ="+pas["WEBLib.Forms"].Application.GetComponent(e).FName,this),this.FAppReference.LookupObject(pas["WEBLib.Forms"].Application.GetComponent(e),{get:function(){return s},set:function(t){s=t}})){if(t.TSESRepoForm.isPrototypeOf(s)){o.ref(9,pas["WebLib.SEFNC.Logger"].Logger()).Debug$1("Discover Forms:Root exists, "+s.RefObjName(),this);continue}throw pas.SysUtils.Exception.$create("Create$1",["Object found not form"])}i=t.TSESRepoForm.$create("Create$2",[pas["WEBLib.Forms"].Application.GetComponent(e),this.FAppReference]),this.FAppReference.AddRoot(i),o.ref(10,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("Discover Forms:Discover begin for loop item "+i.RefObjName(),this),i.LoadRootControls(),o.ref(11,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("Discover Forms:Discover end for loop item "+i.RefObjName(),this)}o.ref(12,pas["WebLib.SEFNC.Logger"].Logger()).Debug$1("Discover Forms:Forms Loaded",this)}finally{o.free()}},this.DiscoverDataModules=function(){var e=0,i=null,s=null,o=rtl.createIntfRefs();try{o.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Info$1("Discover DataModules: Creating DataModule list",this);for(var n=0,r=pas["WEBLib.Forms"].Application.GetComponentCount()-1;n<=r;n++)if(e=n,pas["WEBLib.Modules"].TDataModule.isPrototypeOf(pas["WEBLib.Forms"].Application.GetComponent(e))){if(this.FAppReference.LookupObject(pas["WEBLib.Forms"].Application.GetComponent(e),{get:function(){return s},set:function(t){s=t}})){if(t.TSESRepoDataModule.isPrototypeOf(s))return void o.ref(2,pas["WebLib.SEFNC.Logger"].Logger()).Debug$1("Root exists, "+s.RefObjName(),this);throw pas.SysUtils.Exception.$create("Create$1",["Object found not datamodule"])}i=t.TSESRepoDataModule.$create("Create$2",[pas["WEBLib.Forms"].Application.GetComponent(e),this.FAppReference]),this.FAppReference.AddRoot(i),o.ref(3,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("Discover begin for loop item "+i.RefObjName(),this),i.LoadRootControls(),o.ref(4,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("Discover end for loop item "+i.RefObjName(),this)}o.ref(5,pas["WebLib.SEFNC.Logger"].Logger()).Info$1("DataModules loaded",this)}finally{o.free()}}})),rtl.createClass(this,"ETransformException",pas.SysUtils.Exception,(function(){})),rtl.createClass(this,"ETransformIndividualFailed",this.ETransformException,(function(){})),rtl.createClass(this,"TSESTransformBase",pas.System.TObject,(function(){this.$init=function(){pas.System.TObject.$init.call(this),this.FRepoItem=null,this.FRepoRoot=null,this.FTransformClass=null},this.$final=function(){this.FRepoItem=void 0,this.FRepoRoot=void 0,this.FTransformClass=void 0,pas.System.TObject.$final.call(this)},this.AddLevel=function(t){return this.FRepoItem.AddLabel(t)},this.ExecTransform=function(){var t=rtl.createIntfRefs();try{if(null===this.FRepoItem||null===this.FRepoItem.FRefObject)return void t.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("Transform not executed on nil reference",this)}finally{t.free()}},this.Transform=function(e,i){var s=rtl.createIntfRefs();try{this.FRepoItem=e,this.FRepoRoot=i;try{if(!this.FTransformClass.isPrototypeOf(this.FRepoItem.FRefObject))return;this.ExecTransform()}catch(e){if(pas.SysUtils.Exception.isPrototypeOf(e)){throw t.ETransformIndividualFailed.$create("Create$1",["Could not execute transform for "+this.TransClassName()])}throw s.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Debug$1("Transform failed for ",this),t.ETransformIndividualFailed.$create("Create$1",["Could not execute transform for "+this.TransClassName()])}}finally{s.free()}},this.TransClassName=function(){return this.FTransformClass.$classname},this.Create$1=function(t){return this.FTransformClass=t,this}})),rtl.createClass(this,"TSERTTKClassTransforms",pas["Generics.Collections"].TList$G20,(function(){})),rtl.createClass(this,"TSERTTKTransformRegistry",pas.System.TObject,(function(){this.$init=function(){pas.System.TObject.$init.call(this),this.FRegistry=null},this.$final=function(){this.FRegistry=void 0,pas.System.TObject.$final.call(this)},this.Create$1=function(){return this.FRegistry=pas["Generics.Collections"].TObjectDictionary$G9.$create("Create$5",[rtl.createSet(1)]),this},this.Destroy=function(){rtl.free(this,"FRegistry"),pas.System.TObject.Destroy.call(this)},this.AddTransform=function(t){var e,i=null;e=t.FTransformClass,this.FRegistry.TryGetValue(e,{get:function(){return i},set:function(t){i=t}})?i.Add(t):((i=pas["Generics.Collections"].TObjectList$G11.$create("Create$4",[!0])).Add(t),this.FRegistry.Add(e,i))},this.GetTransforms=function(e,i){var s,o=null,n=null;if(s=this.FRegistry.TryGetValue(e,{get:function(){return o},set:function(t){o=t}})){null==i.get()&&i.set(t.TSERTTKClassTransforms.$create("Create$1"));var r=o.GetEnumerator$1();try{for(;r.MoveNext();)n=r.DoGetCurrent(),i.get().Add(n)}finally{r=rtl.freeLoc(r)}}return s},this.TransformCount=function(){return this.FRegistry.GetCount()}})),rtl.createClass(this,"TSERTTKTransformClasses",pas.System.TObject,(function(){this.$init=function(){pas.System.TObject.$init.call(this),this.FCache=null,this.FRegistry=null},this.$final=function(){this.FCache=void 0,this.FRegistry=void 0,pas.System.TObject.$final.call(this)},this.TransformClass=function(t,e){var i=!1,s=null,o=null,n=0;i=!1,s=pas.contnrs.TClassList.$create("Create$1");try{o=t,s.Add$1(t);do{o=o.$ancestor,s.Insert$1(0,o)}while(o!==pas.System.TObject);for(var r=0,a=s.GetCount()-1;r<=a;r++)n=r,o=s.GetItems(n),this.FRegistry.GetTransforms(o,e)&&(i=!0)}finally{s=rtl.freeLoc(s)}return i},this.CompilerIncludePlugins=function(){pas["WebLib.SERTTK.PI.ObjectPlus"].TSERTTKTxTObject.$classname,pas["WebLib.SERTTK.PI.Application"].TSERTTKTxTApplication.$classname,pas["WebLib.SERTTK.PI.FNCControl"].TSERTTKTxTTMSFNCCustomControl.$classname,pas["WebLib.SERTTK.PI.TDataSet"].TSERTTKTxTDataSet.$classname},this.DiscoverRegistryTransforms=function(){var t=null,e=null,i=0,s=rtl.createIntfRefs();try{s.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Debug$1("Plugin Registry transform count = "+pas.SysUtils.TNativeIntHelper.ToString$1.call({p:s.ref(2,pas["WebLib.SERTTK.PluginTypes"].MarshalPlugins()).Transforms(),get:function(){return this.p.FLength},set:function(t){this.p.FLength=t}}),this);for(var o=s.ref(3,pas["WebLib.SERTTK.PluginTypes"].MarshalPlugins()).Transforms().FLength-1;o>=0;o--)i=o,t=s.ref(4,pas["WebLib.SERTTK.PluginTypes"].MarshalPlugins()).Transforms().GetItem(i),e=s.ref(5,pas["WebLib.SERTTK.PluginTypes"].MarshalPlugins()).Transforms().Extract(t),this.FRegistry.AddTransform(e),s.ref(6,pas["WebLib.SEFNC.Logger"].Logger()).Debug$1("Plugin transform count = "+pas.SysUtils.TNativeIntHelper.ToString$1.call({p:s.ref(7,pas["WebLib.SERTTK.PluginTypes"].MarshalPlugins()).Transforms(),get:function(){return this.p.FLength},set:function(t){this.p.FLength=t}}),this),s.ref(8,pas["WebLib.SEFNC.Logger"].Logger()).Debug$1("Registry transform count = "+pas.SysUtils.TIntegerHelper.ToString$1.call({a:this.FRegistry.TransformCount(),get:function(){return this.a},set:function(t){this.a=t}}),this)}finally{s.free()}},this.DiscoverTransforms=function(){var e=rtl.createIntfRefs();try{try{e.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Debug$1("Discover Transforms::Repo Registry transform count = "+pas.SysUtils.TIntegerHelper.ToString$1.call({a:this.FRegistry.TransformCount(),get:function(){return this.a},set:function(t){this.a=t}}),this),this.DiscoverRegistryTransforms(),e.ref(2,pas["WebLib.SEFNC.Logger"].Logger()).Debug$1("Discover Transforms::Repo Registry transform count = "+pas.SysUtils.TIntegerHelper.ToString$1.call({a:this.FRegistry.TransformCount(),get:function(){return this.a},set:function(t){this.a=t}}),this)}catch(e){if(pas.SysUtils.Exception.isPrototypeOf(e)){throw t.ESERTTKTransformException.$create("Create$1",["Failed to Discover Transforms"])}throw e}}finally{e.free()}},this.GetTransforms=function(t,e){return this.FCache.TryGetValue(t.$class.ClassType(),e)||(this.TransformClass(t.$class.ClassType(),e)?this.FCache.Add(t.$class.ClassType(),e.get()):this.FCache.Add(t.$class.ClassType(),null)),!0},this.Create$1=function(){return this.FCache=pas["Generics.Collections"].TObjectDictionary$G10.$create("Create$5",[rtl.createSet(1)]),this.FRegistry=t.TSERTTKTransformRegistry.$create("Create$1"),this.CompilerIncludePlugins(),this.DiscoverTransforms(),this},this.Destroy=function(){rtl.free(this,"FCache"),rtl.free(this,"FRegistry"),pas.System.TObject.Destroy.call(this)}})),rtl.createClass(this,"TSESRepository",pas.System.TObject,(function(){this.$init=function(){pas.System.TObject.$init.call(this),this.FPlatformProvider=null,this.FTransformClasses=null,this.FAppRef=null,this.FSession=null},this.$final=function(){this.FPlatformProvider=void 0,this.FTransformClasses=void 0,this.FAppRef=void 0,this.FSession=void 0,pas.System.TObject.$final.call(this)},this.ExecTransform=function(t,e){var i=!1,s=null,o=null,n=rtl.createIntfRefs();try{if(this.FTransformClasses.GetTransforms(t.FRefObject,{get:function(){return o},set:function(t){o=t}})&&null!=o&&o.FLength>0){var r=o.GetEnumerator$1();try{for(;r.MoveNext();){s=r.DoGetCurrent();try{s.Transform(t,e)}catch(t){if(!pas.SysUtils.Exception.isPrototypeOf(t))throw t;var a=t;n.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Debug$2("Transform for "+s.TransClassName()+" Failed",a,this)}}}finally{r=rtl.freeLoc(r)}}i=!0}finally{n.free()}return i},this.ReloadModel=function(){var t=rtl.createIntfRefs();try{try{this.FAppRef.ClearRoots(),t.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Info$1("ReloadModel, Dictionary ready ",this),this.FPlatformProvider.DiscoverForms(),t.ref(2,pas["WebLib.SEFNC.Logger"].Logger()).Info$1("Form Discovery complete",this),this.FPlatformProvider.DiscoverDataModules(),t.ref(3,pas["WebLib.SEFNC.Logger"].Logger()).Debug$1("Repo::ReloadModel: Ready for transform ",this),this.TransformRepo(),t.ref(4,pas["WebLib.SEFNC.Logger"].Logger()).Info$1("Repository Loaded and Transformed",this),this.TakeScreenShots("Session Started")}catch(i){if(pas.SysUtils.Exception.isPrototypeOf(i)){var e=i;t.ref(5,pas["WebLib.SEFNC.Logger"].Logger()).Trace$2("Reload Model failed",e,this)}else t.ref(6,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("Reload Model failed",this)}}finally{t.free()}},this.TransformRepo=function(){var t=null,e=rtl.createIntfRefs();try{try{this.TransformRepoItem(this.FAppRef,null);var i=this.FAppRef.FRoots.GetEnumerator$1();try{for(;i.MoveNext();)t=i.DoGetCurrent(),this.TransformRootItem(t)}finally{i=rtl.freeLoc(i)}}catch(t){if(!pas.SysUtils.Exception.isPrototypeOf(t))throw t;e.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Warn$1("Transform Repo Failed",this)}}finally{e.free()}},this.TransformRootItem=function(t){this.TransformRepoItem(t,t)},this.TransformRepoItem=function(e,i){var s=null,o=rtl.createIntfRefs();try{try{o.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("Tranform Repo Item "+e.RefObjName(),this),this.ExecTransform(e,i)}catch(e){if(!t.ETransformIndividualFailed.isPrototypeOf(e)){if(pas.SysUtils.Exception.isPrototypeOf(e)){n=e;throw o.ref(3,pas["WebLib.SEFNC.Logger"].Logger()).Warn$2("Transform Failed : general Exception",n,this),pas.SysUtils.Exception.$create("Create$1",["Transform Failed for Item"])}throw o.ref(4,pas["WebLib.SEFNC.Logger"].Logger()).Warn$1("Transform Failed : general Exception",this),pas.SysUtils.Exception.$create("Create$1",["Transform Failed for Item"])}var n=e;o.ref(2,pas["WebLib.SEFNC.Logger"].Logger()).Debug$2("Individual trans failed, moving to children",n,this)}try{var r=e.FChildren.GetEnumerator$1();try{for(;r.MoveNext();)s=r.DoGetCurrent(),this.TransformRepoItem(s,i)}finally{r=rtl.freeLoc(r)}}catch(t){if(pas.SysUtils.Exception.isPrototypeOf(t)){n=t;throw pas.SysUtils.Exception.$create("Create$1",["Failed transform in  Recurse Children"])}throw t}}finally{o.free()}},this.TakeScreenShots=function(e){var i=null,s=rtl.createIntfRefs();try{var o=this.FAppRef.FRoots.GetEnumerator$1();try{for(;o.MoveNext();)i=o.DoGetCurrent(),t.TSESRepoForm.isPrototypeOf(i)&&s.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("Screenshot not available in web",this)}finally{o=rtl.freeLoc(o)}}finally{s.free()}},this.ReloadRepoRoot=function(t){var e=rtl.createIntfRefs();try{return this.FAppRef.RefreshRoot(t)?(this.TransformRootItem(t),!0):(e.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Warn$1("Failed refresh repo root "+t.RefObjName(),this),!1)}finally{e.free()}return!1},this.ScreenList=function(e){var i=null,s=this.FAppRef.FRoots.GetEnumerator$1();try{for(;s.MoveNext();)i=s.DoGetCurrent(),t.TSESRepoForm.isPrototypeOf(i)&&e.get().Add(i.GetCompDisplayName())}finally{s=rtl.freeLoc(s)}return e.get().GetCount()},this.ReloadRepository=function(){var t=rtl.createIntfRefs();try{this.ReloadModel(),t.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Info$1("Repository loaded successfully",this)}finally{t.free()}},this.Create$1=function(e){var i=rtl.createIntfRefs();try{try{this.FPlatformProvider=t.TSESProvider.$create("Create"),i.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Info$1("Provider Created successfully",this),this.FAppRef=t.TSESAppReference.$create("Create$2",[this.FPlatformProvider.AppComp()]),this.FPlatformProvider.FAppReference=this.FAppRef,this.FTransformClasses=t.TSERTTKTransformClasses.$create("Create$1"),i.ref(2,pas["WebLib.SEFNC.Logger"].Logger()).Info$1("Transforms Created successfully",this),this.FSession=pas["WebLib.SERTTK.Session"].TSESSession.$create("Create$1",[this.FPlatformProvider.ApplicationName(),e,!0]),this.FAppRef.FAppName=this.FPlatformProvider.ApplicationName(),i.ref(3,pas["WebLib.SEFNC.Logger"].Logger()).Debug$1("Application Name set to "+this.FSession.ApplicationNameGet(),this)}catch(t){if(pas.SysUtils.Exception.isPrototypeOf(t)){var s=t;throw i.ref(4,pas["WebLib.SEFNC.Logger"].Logger()).Debug$1("Repository failed: "+s.FMessage,this),pas.SysUtils.Exception.$create("Create$1",["Could not create repository"])}throw t}}finally{i.free()}return this},this.Destroy=function(){rtl.free(this,"FSession"),rtl.free(this,"FAppRef"),rtl.free(this,"FTransformClasses"),rtl.free(this,"FPlatformProvider"),pas.System.TObject.Destroy.call(this)}}))}),["IOUtils","contnrs","WebLib.SERTTK.PluginTypes","WebLib.SEFNC.Logger","WebLib.SERTTK.MarshalTypes","WebLib.SERTTK.PI.ObjectPlus","WebLib.SERTTK.PI.Application","WebLib.SERTTK.PI.FNCControl","WebLib.SERTTK.PI.TDataSet","WEBLib.Controls","WEBLib.Graphics"]),rtl.module("WEBLib.TMSFNCProgressBar",["System","Classes","SysUtils","Types","WEBLib.ExtCtrls","TypInfo","WEBLib.Controls","WEBLib.TMSFNCCustomControl","WEBLib.TMSFNCGraphics","WEBLib.TMSFNCGraphicsTypes","WEBLib.TMSFNCTypes","WEBLib.TMSFNCStyles","WEBLib.TMSFNCUtils"],(function(){"use strict";var t=this;this.KEY_LEFT=37,this.KEY_RIGHT=39,this.KEY_UP=38,this.KEY_DOWN=40,this.TTMSFNCProgressBarShape={0:"psHorizontalLine",psHorizontalLine:0,1:"psVerticalLine",psVerticalLine:1},this.$rtti.$Enum("TTMSFNCProgressBarShape",{minvalue:0,maxvalue:1,ordtype:1,enumtype:this.TTMSFNCProgressBarShape}),this.TTMSFNCProgressBarValueType={0:"pvtValue",pvtValue:0,1:"pvtPercentage",pvtPercentage:1},this.$rtti.$Enum("TTMSFNCProgressBarValueType",{minvalue:0,maxvalue:1,ordtype:1,enumtype:this.TTMSFNCProgressBarValueType}),this.TTMSFNCProgressBarTextOrientation={0:"ptoHorizontal",ptoHorizontal:0,1:"ptoLeft",ptoLeft:1,2:"ptoRight",ptoRight:2,3:"ptoUpsideDown",ptoUpsideDown:3},this.$rtti.$Enum("TTMSFNCProgressBarTextOrientation",{minvalue:0,maxvalue:3,ordtype:1,enumtype:this.TTMSFNCProgressBarTextOrientation}),this.TTMSFNCProgressBarTextPosition={0:"ptpStart",ptpStart:0,1:"ptpCenter",ptpCenter:1,2:"ptpEnd",ptpEnd:2,3:"ptpProgressEnd",ptpProgressEnd:3,4:"ptpFollowCenter",ptpFollowCenter:4,5:"ptpFollowEnd",ptpFollowEnd:5,6:"ptpProgressCenter",ptpProgressCenter:6},this.$rtti.$Enum("TTMSFNCProgressBarTextPosition",{minvalue:0,maxvalue:6,ordtype:1,enumtype:this.TTMSFNCProgressBarTextPosition}),this.TTMSFNCProgressBarBlockType={0:"pbtFirst",pbtFirst:0,1:"pbtLast",pbtLast:1,2:"pbtFirstLast",pbtFirstLast:2,3:"pbtMiddle",pbtMiddle:3},rtl.createClass(this,"TTMSFNCProgressInteraction",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FReadOnlyMode=!1,this.FSnapToValue=!1,this.FSlideToValue=!1,this.FKeyboardSupport=!1},this.SetReadOnlyMode=function(t){this.FReadOnlyMode!==t&&(this.FReadOnlyMode=t)},this.SetSnapToValue=function(t){this.FSnapToValue!==t&&(this.FSnapToValue=t)},this.SetSlideToValue=function(t){this.FSlideToValue!==t&&(this.FSlideToValue=t)},this.SetKeyboardSupport=function(t){this.FKeyboardSupport!==t&&(this.FKeyboardSupport=t)},this.Create$1=function(){return this.FReadOnlyMode=!1,this.FSnapToValue=!1,this.FSlideToValue=!0,this.FKeyboardSupport=!1,this},this.Assign=function(e){t.TTMSFNCProgressInteraction.isPrototypeOf(e)?(this.FReadOnlyMode=rtl.as(e,t.TTMSFNCProgressInteraction).FReadOnlyMode,this.FSnapToValue=rtl.as(e,t.TTMSFNCProgressInteraction).FSnapToValue,this.FSlideToValue=rtl.as(e,t.TTMSFNCProgressInteraction).FSlideToValue,this.FKeyboardSupport=rtl.as(e,t.TTMSFNCProgressInteraction).FKeyboardSupport):pas.Classes.TPersistent.Assign.apply(this,arguments)};var e=this.$rtti;e.addProperty("ReadOnlyMode",2,rtl.boolean,"FReadOnlyMode","SetReadOnlyMode",{Default:!1}),e.addProperty("SnapToValue",2,rtl.boolean,"FSnapToValue","SetSnapToValue",{Default:!1}),e.addProperty("SlideToValue",2,rtl.boolean,"FSlideToValue","SetSlideToValue",{Default:!0}),e.addProperty("KeyboardSupport",2,rtl.boolean,"FKeyboardSupport","SetKeyboardSupport",{Default:!1})})),rtl.createClass(this,"TTMSFNCCustomProgressBarLevel",pas.Classes.TCollectionItem,(function(){this.$init=function(){pas.Classes.TCollectionItem.$init.call(this),this.FActiveFont=null,this.FFill=null,this.FLevelPosition=0,this.FStroke=null},this.$final=function(){this.FActiveFont=void 0,this.FFill=void 0,this.FStroke=void 0,pas.Classes.TCollectionItem.$final.call(this)},this.SetActiveFont=function(e){this.FActiveFont.Assign(e),rtl.as(this.FCollection,t.TTMSFNCCustomProgressBarLevelCollection).FOnChanged(this)},this.SetFill=function(e){this.FFill.Assign(e),rtl.as(this.FCollection,t.TTMSFNCCustomProgressBarLevelCollection).FOnChanged(this)},this.SetLevelPosition=function(e){this.FLevelPosition!==e&&(this.FLevelPosition=e,rtl.as(this.FCollection,t.TTMSFNCCustomProgressBarLevelCollection).FSorted=!1,rtl.as(this.FCollection,t.TTMSFNCCustomProgressBarLevelCollection).FOnChanged(this))},this.SetStroke=function(e){this.FStroke.Assign(e),rtl.as(this.FCollection,t.TTMSFNCCustomProgressBarLevelCollection).FOnChanged(this)},this.Changed$1=function(e){null!=this.FCollection&&t.TTMSFNCCustomProgressBarLevelCollection.isPrototypeOf(this.FCollection)&&rtl.as(this.FCollection,t.TTMSFNCCustomProgressBarLevelCollection).FOnChanged(this)},this.FillChanged=function(t){this.Changed$1(this)},this.FontChanged=function(t){this.Changed$1(this)},this.StrokeChanged=function(t){this.Changed$1(this)},this.Create$1=function(e){return pas.Classes.TCollectionItem.Create$1.call(this,e),this.FFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[1,pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.HTMLToColor("#1BADF8"),8421504,-1,-1]),this.FStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[0,16777215]),this.FActiveFont=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFont.$create("Create$2"),null==rtl.as(e,t.TTMSFNCCustomProgressBarLevelCollection).FOwner$1||null==rtl.as(e,t.TTMSFNCCustomProgressBarLevelCollection).FOwner$1.FAppearance||0 in rtl.as(e,t.TTMSFNCCustomProgressBarLevelCollection).FOwner$1.FComponentState||(this.FActiveFont.Assign(rtl.as(e,t.TTMSFNCCustomProgressBarLevelCollection).FOwner$1.FAppearance.FDefaultLevelFont),this.FFill.Assign(rtl.as(e,t.TTMSFNCCustomProgressBarLevelCollection).FOwner$1.FAppearance.FDefaultLevelFill),this.FStroke.Assign(rtl.as(e,t.TTMSFNCCustomProgressBarLevelCollection).FOwner$1.FAppearance.FDefaultLevelStroke)),this.FFill.FOnChanged=rtl.createCallback(this,"FillChanged"),this.FStroke.FOnChanged=rtl.createCallback(this,"StrokeChanged"),this.FActiveFont.FOnChanged=rtl.createCallback(this,"FontChanged"),this.FLevelPosition=0,rtl.as(e,t.TTMSFNCCustomProgressBarLevelCollection).FSorted=!1,this},this.Destroy=function(){rtl.free(this,"FActiveFont"),rtl.free(this,"FFill"),rtl.free(this,"FStroke"),pas.Classes.TCollectionItem.Destroy.call(this)},this.Assign=function(e){t.TTMSFNCCustomProgressBarLevel.isPrototypeOf(e)?(this.FFill=rtl.as(e,t.TTMSFNCCustomProgressBarLevel).FFill,this.FStroke=rtl.as(e,t.TTMSFNCCustomProgressBarLevel).FStroke,this.FLevelPosition=rtl.as(e,t.TTMSFNCCustomProgressBarLevel).FLevelPosition):pas.Classes.TPersistent.Assign.apply(this,arguments)};var e=this.$rtti;e.addProperty("ActiveFont",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFont,"FActiveFont","SetActiveFont"),e.addProperty("Fill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FFill","SetFill"),e.addProperty("LevelPosition",2,rtl.double,"FLevelPosition","SetLevelPosition"),e.addProperty("Stroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FStroke","SetStroke")})),rtl.createClass(this,"TTMSFNCCustomProgressBarLevelCollection",pas.Classes.TOwnedCollection,(function(){this.$init=function(){pas.Classes.TOwnedCollection.$init.call(this),this.FOwner$1=null,this.FSorted=!1,this.FOnChanged=null},this.$final=function(){this.FOwner$1=void 0,this.FOnChanged=void 0,pas.Classes.TOwnedCollection.$final.call(this)},this.GetItem$1=function(t){return this.GetItem(t)},this.Sort$1=function(){for(var t=0,e=0,i=0,s=1,o=this.GetCount()-1;s<=o;s++)for(e=t=s,i=this.GetItem$1(t).FLevelPosition;e>0&&this.GetItem$1(e-1).FLevelPosition>i;)this.GetItem$1(e).SetIndex(e-1),e-=1;this.FSorted=!0},this.Create$3=function(e){return pas.Classes.TOwnedCollection.Create$2.call(this,e,t.TTMSFNCCustomProgressBarLevel),this.FOwner$1=e,this.FSorted=!1,this},this.EndUpdate=function(){pas.Classes.TCollection.EndUpdate.call(this),this.FOwner$1.Invalidate()}})),rtl.createClass(this,"TTMSFNCCustomProgressBarAppearance",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FActiveBitmap=null,this.FOwner=null,this.FFill=null,this.FStroke=null,this.FFont=null,this.FInActiveBitmap=null,this.FStacked=!1,this.FOnChange=null,this.FDefaultLevelFill=null,this.FDefaultLevelFont=null,this.FDefaultLevelStroke=null,this.FShowActiveBitmaps=!1,this.FShowInActiveBitmaps=!1},this.$final=function(){this.FActiveBitmap=void 0,this.FOwner=void 0,this.FFill=void 0,this.FStroke=void 0,this.FFont=void 0,this.FInActiveBitmap=void 0,this.FOnChange=void 0,this.FDefaultLevelFill=void 0,this.FDefaultLevelFont=void 0,this.FDefaultLevelStroke=void 0,pas.Classes.TPersistent.$final.call(this)},this.SetActiveBitmap=function(t){this.FActiveBitmap.Assign(t)},this.SetFill=function(t){this.FFill.Assign(t)},this.SetFont=function(t){this.FFont.Assign(t),this.FontChanged(this)},this.SetInActiveBitmap=function(t){this.FInActiveBitmap.Assign(t)},this.SetStacked=function(t){this.FStacked!==t&&(this.FStacked=t,this.Changed(this))},this.SetStroke=function(t){this.FStroke.Assign(t)},this.SetDefaultLevelFill=function(t){this.FDefaultLevelFill.Assign(t)},this.SetDefaultLevelFont=function(t){this.FDefaultLevelFont.Assign(t)},this.SetDefaultLevelStroke=function(t){this.FDefaultLevelStroke.Assign(t)},this.SetShowActiveBitmaps=function(t){this.FShowActiveBitmaps!==t&&(this.FShowActiveBitmaps=t,this.Changed(this))},this.SetShowInActiveBitmaps=function(t){this.FShowInActiveBitmaps!==t&&(this.FShowInActiveBitmaps=t,this.Changed(this))},this.BitmapChanged=function(t){this.Changed(t)},this.Changed=function(t){null!=this.FOnChange&&this.FOnChange(t)},this.FillChanged=function(t){this.Changed(t)},this.FontChanged=function(t){this.Changed(t)},this.StrokeChanged=function(t){this.Changed(t)},this.Create$1=function(e){var i="",s="";return this.FOwner=e,this.FStacked=!1,this.FFont=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFont.$create("Create$2"),this.FFont.FOnChanged=rtl.createCallback(this,"FontChanged"),this.FFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[1,16777215,8421504,-1,-1]),this.FFill.FOnChanged=rtl.createCallback(this,"FillChanged"),this.FStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,11119017]),this.FStroke.FOnChanged=rtl.createCallback(this,"StrokeChanged"),this.FDefaultLevelFont=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFont.$create("Create$2"),this.FDefaultLevelFont.FOnChanged=rtl.createCallback(this,"FontChanged"),this.FDefaultLevelFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[1,pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.HTMLToColor("#1BADF8"),8421504,-1,-1]),this.FDefaultLevelFill.FOnChanged=rtl.createCallback(this,"FillChanged"),this.FDefaultLevelStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[0,16777215]),this.FDefaultLevelStroke.FOnChanged=rtl.createCallback(this,"StrokeChanged"),t.TTMSFNCRatingAppearance.isPrototypeOf(this)?(this.FShowActiveBitmaps=!0,this.FShowInActiveBitmaps=!0,i="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAAAilBMVEUAAAD//wD//4D/qlX/v0D/zDP/1VXyyVHyzE3zzknz0Ub0007szE3uzUvvzkrwzkvvzkvvz0rwz0vuzknuz0vvzknwzkruzknuzUnvzkvvz0rwzUrvzkrvzUrvzkrwzkruz0rvzkrvzkrvzkrvzkrvzkrvzkrwzkrvzUrvzkvvzkrvzkrvzkr////E8IF1AAAALHRSTlMAAQIDBAUGExQVFhcoPT5ETk9VaWpzh4iLjJSVnJ+ipqm6wMHK0NLX8vP0/CVDS/sAAAABYktHRC3N2kE9AAAAc0lEQVQYGVXBiRaBQACG0S9DoWghIlt29b//8+k0c5xxL04c829X8Wf6aef4ttIGT/SW2hlWmGRlo15TZkkIVSdPV2FO8lwmYI76OY/pBbWcw4hBJCfCWspZYK3lrLBq6Vmkd2mPdXsVAZA+rli5YWBy4AvRFRJoiJTqGwAAAABJRU5ErkJggg==",s="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABmJLR0QA/wD/AP+gvaeTAAABE0lEQVQ4jZ3TTyuEURQG8N+LmNQwsTALTMn/lKw0Gx+A8jVsfANfw0ZDimJvYasUXwCFscECZadkFFm8d8bbq3kZT51u9znPOfecc+8lG3PB/o2tYE3RnuEr4xMP6MJdq6dvIxeCN1utYB4RTvGBEjpwnxZG6MEYRsNaRB4reAu6HDbwgkdUcYNqhBMc4hjXePqltQGMYwGLUMAOBn8JTKKIXfTXiV7sYeQPwcPYR1/akQ+VlDKCS0GTrxPJW3jHM2Zw1iTBEo7EQwRtKcE0zjMquMBUkkgnmMBVYl8OVsclJrMSdKKGWVR8f6ZK4GpB00CUSnAgfm23WMdr4LuxKh7iEJZ/NCce6Jr4XTRDIWgaw/8CfjUtAsV1Ru8AAAAASUVORK5CYII=",this.FActiveBitmap=pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.CreateFromResource$1(i,pas["WEBLib.TMSFNCTypes"].HInstance()),this.FInActiveBitmap=pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.CreateFromResource$1(s,pas["WEBLib.TMSFNCTypes"].HInstance())):(this.FShowActiveBitmaps=!1,this.FShowInActiveBitmaps=!1,this.FActiveBitmap=pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.$create("Create$3"),this.FInActiveBitmap=pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.$create("Create$3")),this.FActiveBitmap.FOnChange=rtl.createCallback(this,"BitmapChanged"),this.FInActiveBitmap.FOnChange=rtl.createCallback(this,"BitmapChanged"),this},this.Destroy=function(){rtl.free(this,"FFill"),rtl.free(this,"FStroke"),rtl.free(this,"FFont"),rtl.free(this,"FDefaultLevelFill"),rtl.free(this,"FDefaultLevelStroke"),rtl.free(this,"FDefaultLevelFont"),rtl.free(this,"FActiveBitmap"),rtl.free(this,"FInActiveBitmap"),pas.System.TObject.Destroy.call(this)},this.Assign=function(e){t.TTMSFNCCustomProgressBarAppearance.isPrototypeOf(e)?(this.FActiveBitmap.Assign(rtl.as(e,t.TTMSFNCCustomProgressBarAppearance).FActiveBitmap),this.FFill.Assign(rtl.as(e,t.TTMSFNCCustomProgressBarAppearance).FFill),this.FFont.Assign(rtl.as(e,t.TTMSFNCCustomProgressBarAppearance).FFont),this.FInActiveBitmap.Assign(rtl.as(e,t.TTMSFNCCustomProgressBarAppearance).FInActiveBitmap),this.FStroke.Assign(rtl.as(e,t.TTMSFNCCustomProgressBarAppearance).FStroke),this.FDefaultLevelFill.Assign(rtl.as(e,t.TTMSFNCCustomProgressBarAppearance).FDefaultLevelFill),this.FDefaultLevelFont.Assign(rtl.as(e,t.TTMSFNCCustomProgressBarAppearance).FDefaultLevelFont),this.FDefaultLevelStroke.Assign(rtl.as(e,t.TTMSFNCCustomProgressBarAppearance).FDefaultLevelStroke),this.FStacked=rtl.as(e,t.TTMSFNCCustomProgressBarAppearance).FStacked,this.FShowActiveBitmaps=rtl.as(e,t.TTMSFNCCustomProgressBarAppearance).FShowActiveBitmaps,this.FShowInActiveBitmaps=rtl.as(e,t.TTMSFNCCustomProgressBarAppearance).FShowInActiveBitmaps):pas.Classes.TPersistent.Assign.apply(this,arguments)}})),rtl.createClass(this,"TTMSFNCProgressBarAppearance",this.TTMSFNCCustomProgressBarAppearance,(function(){var t=this.$rtti;t.addProperty("DefaultLevelFill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FDefaultLevelFill","SetDefaultLevelFill"),t.addProperty("DefaultLevelFont",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFont,"FDefaultLevelFont","SetDefaultLevelFont"),t.addProperty("DefaultLevelStroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FDefaultLevelStroke","SetDefaultLevelStroke"),t.addProperty("Fill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FFill","SetFill"),t.addProperty("Font",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFont,"FFont","SetFont"),t.addProperty("Stacked",2,rtl.boolean,"FStacked","SetStacked",{Default:!1}),t.addProperty("Stroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FStroke","SetStroke")})),rtl.createClass(this,"TTMSFNCRatingAppearance",this.TTMSFNCCustomProgressBarAppearance,(function(){var t=this.$rtti;t.addProperty("ActiveBitmap",2,pas["WEBLib.TMSFNCTypes"].$rtti.TTMSFNCBitmap,"FActiveBitmap","SetActiveBitmap"),t.addProperty("DefaultLevelFill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FDefaultLevelFill","SetDefaultLevelFill"),t.addProperty("DefaultLevelFont",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFont,"FDefaultLevelFont","SetDefaultLevelFont"),t.addProperty("DefaultLevelStroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FDefaultLevelStroke","SetDefaultLevelStroke"),t.addProperty("Fill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FFill","SetFill"),t.addProperty("Font",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFont,"FFont","SetFont"),t.addProperty("InActiveBitmap",2,pas["WEBLib.TMSFNCTypes"].$rtti.TTMSFNCBitmap,"FInActiveBitmap","SetInActiveBitmap"),t.addProperty("Stroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FStroke","SetStroke"),t.addProperty("ShowActiveBitmaps",2,rtl.boolean,"FShowActiveBitmaps","SetShowActiveBitmaps"),t.addProperty("ShowInActiveBitmaps",2,rtl.boolean,"FShowInActiveBitmaps","SetShowInActiveBitmaps")})),rtl.createClass(this,"TTMSFNCCustomProgressBarLayout",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FBlocks=0,this.FBottomMargin=0,this.FDecimals=0,this.FInterval=0,this.FLeftMargin=0,this.FMaximumBitmap=null,this.FMinimumBitmap=null,this.FOwner=null,this.FPrefix="",this.FRightMargin=0,this.FRounding=0,this.FShape=0,this.FShowValue=!1,this.FSpacing=0,this.FSuffix="",this.FTextOrientation=0,this.FTextPosition=0,this.FTopMargin=0,this.FValueType=0,this.FOnChange=null,this.FTextFormat=0,this.FRoundProgressEnd=!1},this.$final=function(){this.FMaximumBitmap=void 0,this.FMinimumBitmap=void 0,this.FOwner=void 0,this.FOnChange=void 0,pas.Classes.TPersistent.$final.call(this)},this.BitmapChanged=function(t){this.Changed()},this.SetBlocks=function(t){this.FBlocks!==t&&(this.FBlocks=Math.max(1,t),this.Changed())},this.SetBottomMargin=function(t){this.FBottomMargin!==t&&(this.FBottomMargin=t,this.Changed())},this.SetDecimals=function(t){this.FDecimals!==t&&(this.FDecimals=Math.max(0,t),this.Changed())},this.SetInterval=function(t){t>0&&this.FInterval!==t&&(this.FInterval=t,this.FOwner.SetProgressValue(Math.round(this.FOwner.FProgressValue/this.FInterval)*this.FInterval))},this.SetLeftMargin=function(t){this.FLeftMargin!==t&&(this.FLeftMargin=t,this.Changed())},this.SetMaximumBitmap=function(t){this.FMaximumBitmap.Assign(t),this.Changed()},this.SetMinimumBitmap=function(t){this.FMinimumBitmap.Assign(t),this.Changed()},this.SetPrefix=function(t){this.FPrefix!==t&&(this.FPrefix=t,this.Changed())},this.SetRightMargin=function(t){this.FRightMargin!==t&&(this.FRightMargin=t,this.Changed())},this.SetRounding=function(t){t>=0&&this.FRounding!==t&&(this.FRounding=t,this.Changed())},this.SetShape=function(t){this.FShape!==t&&(this.FShape=t,this.Changed())},this.SetShowValue=function(t){this.FShowValue!==t&&(this.FShowValue=t,this.Changed())},this.SetSpacing=function(t){this.FSpacing!==t&&(this.FSpacing=t,this.Changed())},this.SetSuffix=function(t){this.FSuffix!==t&&(this.FSuffix=t,this.Changed())},this.SetTextOrientation=function(t){this.FTextOrientation!==t&&(this.FTextOrientation=t,this.Changed())},this.SetTextPosition=function(t){this.FTextPosition!==t&&(this.FTextPosition=t,this.Changed())},this.SetTopMargin=function(t){this.FTopMargin!==t&&(this.FTopMargin=t,this.Changed())},this.SetValueType=function(t){this.FValueType!==t&&(this.FValueType=t,this.Changed())},this.SetRoundProgressEnd=function(t){this.FRoundProgressEnd!==t&&(this.FRoundProgressEnd=t,this.Changed())},this.Changed=function(){null!=this.FOnChange&&this.FOnChange(this)},this.Create$1=function(t){return this.FOwner=t,this.FBlocks=1,this.FSpacing=2,this.FRounding=0,this.FRoundProgressEnd=!0,this.FShape=0,this.FValueType=1,this.FTextFormat=0,this.FTextOrientation=0,this.FTextPosition=1,this.FShowValue=!0,this.FPrefix="",this.FSuffix="",this.FDecimals=2,this.FInterval=1,this.FMaximumBitmap=pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.$create("Create$3"),this.FMaximumBitmap.FOnChange=rtl.createCallback(this,"BitmapChanged"),this.FMinimumBitmap=pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.$create("Create$3"),this.FMinimumBitmap.FOnChange=rtl.createCallback(this,"BitmapChanged"),this.FBottomMargin=0,this.FLeftMargin=0,this.FRightMargin=0,this.FTopMargin=0,this},this.Destroy=function(){rtl.free(this,"FMinimumBitmap"),rtl.free(this,"FMaximumBitmap"),pas.System.TObject.Destroy.call(this)},this.Assign=function(e){t.TTMSFNCCustomProgressBarLayout.isPrototypeOf(e)?(this.FBottomMargin=rtl.as(e,t.TTMSFNCCustomProgressBarLayout).FBottomMargin,this.FLeftMargin=rtl.as(e,t.TTMSFNCCustomProgressBarLayout).FLeftMargin,this.FRightMargin=rtl.as(e,t.TTMSFNCCustomProgressBarLayout).FRightMargin,this.FTopMargin=rtl.as(e,t.TTMSFNCCustomProgressBarLayout).FTopMargin,this.FBlocks=rtl.as(e,t.TTMSFNCCustomProgressBarLayout).FBlocks,this.FDecimals=rtl.as(e,t.TTMSFNCCustomProgressBarLayout).FDecimals,this.FOwner=rtl.as(e,t.TTMSFNCCustomProgressBarLayout).FOwner,this.FPrefix=rtl.as(e,t.TTMSFNCCustomProgressBarLayout).FPrefix,this.FRounding=rtl.as(e,t.TTMSFNCCustomProgressBarLayout).FRounding,this.FShape=rtl.as(e,t.TTMSFNCCustomProgressBarLayout).FShape,this.FShowValue=rtl.as(e,t.TTMSFNCCustomProgressBarLayout).FShowValue,this.FSpacing=rtl.as(e,t.TTMSFNCCustomProgressBarLayout).FSpacing,this.FSuffix=rtl.as(e,t.TTMSFNCCustomProgressBarLayout).FSuffix,this.FTextOrientation=rtl.as(e,t.TTMSFNCCustomProgressBarLayout).FTextOrientation,this.FTextPosition=rtl.as(e,t.TTMSFNCCustomProgressBarLayout).FTextPosition,this.FValueType=rtl.as(e,t.TTMSFNCCustomProgressBarLayout).FValueType,this.FInterval=rtl.as(e,t.TTMSFNCCustomProgressBarLayout).FInterval,this.FMaximumBitmap=rtl.as(e,t.TTMSFNCCustomProgressBarLayout).FMaximumBitmap,this.FMinimumBitmap=rtl.as(e,t.TTMSFNCCustomProgressBarLayout).FMinimumBitmap):pas.Classes.TPersistent.Assign.apply(this,arguments)}})),rtl.createClass(this,"TTMSFNCProgressBarLayout",this.TTMSFNCCustomProgressBarLayout,(function(){var e=this.$rtti;e.addProperty("Blocks",2,rtl.longint,"FBlocks","SetBlocks",{Default:1}),e.addProperty("BottomMargin",2,rtl.longint,"FBottomMargin","SetBottomMargin",{Default:0}),e.addProperty("Decimals",2,rtl.longint,"FDecimals","SetDecimals",{Default:2}),e.addProperty("LeftMargin",2,rtl.longint,"FLeftMargin","SetLeftMargin",{Default:0}),e.addProperty("MaximumBitmap",2,pas["WEBLib.TMSFNCTypes"].$rtti.TTMSFNCBitmap,"FMaximumBitmap","SetMaximumBitmap"),e.addProperty("MinimumBitmap",2,pas["WEBLib.TMSFNCTypes"].$rtti.TTMSFNCBitmap,"FMinimumBitmap","SetMinimumBitmap"),e.addProperty("Prefix",2,rtl.string,"FPrefix","SetPrefix"),e.addProperty("RightMargin",2,rtl.longint,"FRightMargin","SetRightMargin",{Default:0}),e.addProperty("Rounding",2,rtl.double,"FRounding","SetRounding"),e.addProperty("RoundProgressEnd",2,rtl.boolean,"FRoundProgressEnd","SetRoundProgressEnd",{Default:!0}),e.addProperty("Shape",2,t.$rtti.TTMSFNCProgressBarShape,"FShape","SetShape",{Default:t.TTMSFNCProgressBarShape.psHorizontalLine}),e.addProperty("ShowValue",2,rtl.boolean,"FShowValue","SetShowValue"),e.addProperty("Spacing",2,rtl.longint,"FSpacing","SetSpacing",{Default:2}),e.addProperty("Suffix",2,rtl.string,"FSuffix","SetSuffix"),e.addProperty("TextOrientation",2,t.$rtti.TTMSFNCProgressBarTextOrientation,"FTextOrientation","SetTextOrientation",{Default:t.TTMSFNCProgressBarTextOrientation.ptoHorizontal}),e.addProperty("TextPosition",2,t.$rtti.TTMSFNCProgressBarTextPosition,"FTextPosition","SetTextPosition",{Default:t.TTMSFNCProgressBarTextPosition.ptpCenter}),e.addProperty("TopMargin",2,rtl.longint,"FTopMargin","SetTopMargin",{Default:0}),e.addProperty("ValueType",2,t.$rtti.TTMSFNCProgressBarValueType,"FValueType","SetValueType",{Default:t.TTMSFNCProgressBarValueType.pvtPercentage})})),this.$rtti.$MethodVar("TTMSFNCProgressBarAfterDrawValueEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["AText",rtl.string],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["APosition",this.$rtti.TTMSFNCProgressBarTextPosition],["AOrientation",this.$rtti.TTMSFNCProgressBarTextOrientation]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCProgressBarBeforeDrawValueEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["AText",rtl.string],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["APosition",this.$rtti.TTMSFNCProgressBarTextPosition],["AOrientation",this.$rtti.TTMSFNCProgressBarTextOrientation],["AAllow",rtl.boolean,1],["ADefaultDraw",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCProgressBarAfterDrawBlockEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["ACorners",pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsCorners]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCProgressBarBeforeDrawBlockEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["ACorners",pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsCorners],["AAllow",rtl.boolean,1],["ADefaultDraw",rtl.boolean,1]]),methodkind:0}),rtl.createClass(this,"TTMSFNCCustomProgressBar",pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl,(function(){this.$init=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.$init.call(this),this.FAppearance=null,this.FCount=0,this.FDrawActive=!1,this.FDrawBlocks=0,this.FInteraction=null,this.FLayout=null,this.FLevels=null,this.FMaximum=0,this.FMinimum=0,this.FMouseDown=!1,this.FMouseHover=!1,this.FMouseSlide=!1,this.FPercentage=0,this.FProgressValue=0,this.FOnAfterDrawBlock=null,this.FOnAfterDrawValue=null,this.FOnAppearanceChanged=null,this.FOnBeforeDrawBlock=null,this.FOnBeforeDrawValue=null,this.FOnChanged=null,this.FOnLayoutChanged=null,this.FOnKeyboardValueChange=null,this.FOnSlideValueChange=null,this.FOnSnapValueChange=null,this.FOnKeyboardValueChanged=null,this.FOnSlideValueChanged=null,this.FOnSnapValueChanged=null,this.FOnValueChange=null,this.FOnValueChanged=null,this.FOnLevelsChanged=null,this.FGlobalFont=null},this.$final=function(){this.FAppearance=void 0,this.FInteraction=void 0,this.FLayout=void 0,this.FLevels=void 0,this.FOnAfterDrawBlock=void 0,this.FOnAfterDrawValue=void 0,this.FOnAppearanceChanged=void 0,this.FOnBeforeDrawBlock=void 0,this.FOnBeforeDrawValue=void 0,this.FOnChanged=void 0,this.FOnLayoutChanged=void 0,this.FOnKeyboardValueChange=void 0,this.FOnSlideValueChange=void 0,this.FOnSnapValueChange=void 0,this.FOnKeyboardValueChanged=void 0,this.FOnSlideValueChanged=void 0,this.FOnSnapValueChanged=void 0,this.FOnValueChange=void 0,this.FOnValueChanged=void 0,this.FOnLevelsChanged=void 0,this.FGlobalFont=void 0,pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.$final.call(this)},this.AppearanceChanged=function(t){this.Invalidate(),this.DoAppearanceChanged(t)},this.CalculatePercentage=function(t){var e=0;return(e=this.FMaximum<this.FMinimum?(t-this.FMaximum)/(this.FMinimum-this.FMaximum)*100:this.FMaximum===this.FMinimum?100:(t-this.FMinimum)/(this.FMaximum-this.FMinimum)*100)<0&&(e*=-1),e},this.DrawBlocksValueNotZero=function(){this.FDrawBlocks<1&&(this.FDrawBlocks=1)},this.DrawInactiveBitmaps=function(t,e){var i=0;this.FCount=pas.System.Trunc(this.FProgressValue),this.DrawBlocksValueNotZero(),1===this.FLayout.FShape?(i=(e.Bottom-e.Top-this.FLayout.FSpacing*(this.FDrawBlocks-1))/this.FDrawBlocks*this.FCount+this.FLayout.FSpacing*(this.FCount-1),this.FMaximum>=this.FMinimum&&(i=e.Bottom-i)):(i=(e.Right-e.Left-this.FLayout.FSpacing*(this.FDrawBlocks-1))/this.FDrawBlocks*this.FCount+this.FLayout.FSpacing*(this.FCount-1),this.FMaximum<this.FMinimum&&(i=e.Right-i)),this.FDrawActive=!1,this.DrawProgressBlock(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),101,3,i),this.FCount=0,this.FDrawActive=!0},this.DrawLowHighBitmaps=function(t,e){pas["WEBLib.TMSFNCTypes"].IsBitmapEmpty(this.FLayout.FMinimumBitmap)||t.DrawBitmap$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(this.GetLowBitmapRect()),this.FLayout.FMinimumBitmap,!0,!1,!0,!1),pas["WEBLib.TMSFNCTypes"].IsBitmapEmpty(this.FLayout.FMaximumBitmap)||t.DrawBitmap$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(this.GetHighBitmapRect()),this.FLayout.FMaximumBitmap,!0,!1,!0,!1)},this.DrawProgress=function(t,e){var i,s=0,o=pas["WEBLib.TMSFNCTypes"].TRectF.$new();this.FCount=0,!pas["WEBLib.TMSFNCTypes"].IsBitmapEmpty(this.FAppearance.FActiveBitmap)&&this.FAppearance.FShowActiveBitmaps?(this.FDrawBlocks=Math.abs(Math.round(this.FMaximum-this.FMinimum)),!pas["WEBLib.TMSFNCTypes"].IsBitmapEmpty(this.FAppearance.FInActiveBitmap)&&this.FAppearance.FShowInActiveBitmaps&&this.DrawInactiveBitmaps(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e))):this.FDrawBlocks=this.FLayout.FBlocks,this.FDrawActive=!0,i=t.SaveState(!1),o.$assign(e);try{!pas["WEBLib.TMSFNCTypes"].IsBitmapEmpty(this.FAppearance.FActiveBitmap)&&this.FAppearance.FShowActiveBitmaps&&0!==pas.System.Frac(this.FLayout.FInterval)&&(1===this.FLayout.FShape?this.FMaximum<this.FMinimum?o.Bottom=o.Top+(e.Bottom-e.Top)*this.FPercentage/100:o.Top=o.Bottom-(e.Bottom-e.Top)*this.FPercentage/100:this.FMaximum<this.FMinimum?o.Left=o.Right-(e.Right-e.Left)*this.FPercentage/100:o.Right=o.Left+(e.Right-e.Left)*this.FPercentage/100,t.ClipRect(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(o))),this.FLevels.GetCount()>1?(this.FLevels.FSorted||this.FLevels.Sort$1(),this.FAppearance.FStacked?this.DrawStackedProgress(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e)):(s=this.GetActiveLevel(this.FProgressValue),t.FFill.Assign(this.FLevels.GetItem$1(s).FFill),t.FStroke.Assign(this.FLevels.GetItem$1(s).FStroke),t.FFont.Assign(this.FLevels.GetItem$1(s).FActiveFont),this.DrawProgressBlock(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),this.FPercentage,2,0))):(0===this.FLevels.GetCount()?(t.FFill.Assign(this.FAppearance.FDefaultLevelFill),t.FStroke.Assign(this.FAppearance.FDefaultLevelStroke),t.FFont.Assign(this.FAppearance.FDefaultLevelFont)):(t.FFill.Assign(this.FLevels.GetItem$1(0).FFill),t.FStroke.Assign(this.FLevels.GetItem$1(0).FStroke),t.FFont.Assign(this.FLevels.GetItem$1(0).FActiveFont)),this.DrawProgressBlock(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),this.FPercentage,2,0))}finally{t.RestoreState(i,!1)}},this.DrawProgressBlock=function(t,e,i,s,o){var n=0,r=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),a=0,l=0,h=0,F={},p=0,c=!1,u=!1,C=!1,T=!1,S=0;C=!1,T=this.FLayout.FRoundProgressEnd,n=0,0===t.FStroke.FKind||!pas["WEBLib.TMSFNCTypes"].IsBitmapEmpty(this.FAppearance.FActiveBitmap)&&this.FAppearance.FShowActiveBitmaps||(n=t.FStroke.FWidth),this.DrawBlocksValueNotZero(),l=1===this.FLayout.FShape?(e.Bottom-e.Top-this.FLayout.FSpacing*(this.FDrawBlocks-1))/this.FDrawBlocks:(e.Right-e.Left-this.FLayout.FSpacing*(this.FDrawBlocks-1))/this.FDrawBlocks,h=Math.min(this.FLayout.FRounding,Math.min((e.Bottom-e.Top)/2,(e.Right-e.Left)/2)),S=this.FMaximum<this.FMinimum?this.FMaximum:this.FMinimum;for(var d=this.FCount,m=this.FDrawBlocks-1;d<=m;d++){if(p=d,F={},1===this.FLayout.FShape){if(a=pas["WEBLib.TMSFNCTypes"].IsBitmapEmpty(this.FAppearance.FInActiveBitmap)?Math.min(this.GetHeight(),(e.Bottom-e.Top)*i/100):(e.Bottom-e.Top)*i/100,this.GetWorkingRect().Bottom-this.GetWorkingRect().Top-a+1<h&&(T=!0),this.FMaximum<this.FMinimum){if(this.FDrawBlocks>1)if(0===o?(o=e.Top,F=rtl.createSet(0,1)):o+=this.FLayout.FSpacing,a>l*(p+1)+this.FLayout.FSpacing*p&&i!==this.FPercentage||a>l*(p+1)+this.FLayout.FSpacing*(p+1)+h/2&&i===this.FPercentage)a=o+l;else{if(i!==this.FPercentage)return o-this.FLayout.FSpacing;T&&(F=rtl.unionSet(F,rtl.createSet(2,3))),C=!0}else 0===o?o=e.Top:o-=1,s in rtl.createSet(0,2)&&(F=rtl.createSet(0,1)),s in rtl.createSet(1,2)&&T&&(F=rtl.unionSet(F,rtl.createSet(2,3)));r.$assign(pas["WEBLib.TMSFNCTypes"].RectF(e.Left+n,o+n,e.Right-n,e.Top+a+n)),!pas["WEBLib.TMSFNCTypes"].IsBitmapEmpty(this.FAppearance.FActiveBitmap)&&this.FAppearance.FShowActiveBitmaps&&C&&(r.Bottom=r.Top+l),o=r.Bottom}else{if(this.FDrawBlocks>1)if(0===o?(o=e.Bottom,F=rtl.createSet(2,3)):o-=this.FLayout.FSpacing,a>l*(p+1)+this.FLayout.FSpacing*p&&i!==this.FPercentage||a>l*(p+1)+this.FLayout.FSpacing*(p+1)+h/2&&i===this.FPercentage)a=e.Bottom-(o-l);else{if(i!==this.FPercentage)return o+this.FLayout.FSpacing;T&&(F=rtl.unionSet(F,rtl.createSet(0,1))),C=!0}else 0===o?o=e.Bottom:o+=1,s in rtl.createSet(0,2)&&(F=rtl.createSet(2,3)),s in rtl.createSet(1,2)&&T&&(F=rtl.unionSet(F,rtl.createSet(0,1)));r.$assign(pas["WEBLib.TMSFNCTypes"].RectF(e.Left+n,e.Bottom-a-n,e.Right-n,o-n)),!pas["WEBLib.TMSFNCTypes"].IsBitmapEmpty(this.FAppearance.FActiveBitmap)&&this.FAppearance.FShowActiveBitmaps&&C&&(r.Top=r.Bottom-l),o=r.Top}a<h&&(pas["WEBLib.TMSFNCTypes"].IsBitmapEmpty(this.FAppearance.FActiveBitmap)||!this.FAppearance.FShowActiveBitmaps)?(r.Left=r.Left+(h-(r.Bottom-r.Top))+this.ScalePaintValue(1),r.Right=r.Right-(h-(r.Bottom-r.Top))-this.ScalePaintValue(1),h=(r.Bottom-r.Top)/2+1):r.Bottom-r.Top<pas.System.Trunc(h/2)&&this.FDrawBlocks>1&&(F={})}else{if(a=pas["WEBLib.TMSFNCTypes"].IsBitmapEmpty(this.FAppearance.FInActiveBitmap)||!this.FAppearance.FShowActiveBitmaps?Math.min(this.GetWidth(),(e.Right-e.Left)*Math.round(i)/100):(e.Right-e.Left)*Math.round(i)/100,this.GetWorkingRect().Right-this.GetWorkingRect().Left-a+1<h&&(T=!0),this.FMaximum<this.FMinimum){if(this.FDrawBlocks>1)if(0===o?(o=e.Right,F=rtl.createSet(1,3)):o-=this.FLayout.FSpacing,a>l*(p+1)+this.FLayout.FSpacing*p&&i!==this.FPercentage||a>l*(p+1)+this.FLayout.FSpacing*(p+1)+h/2&&i===this.FPercentage)a=e.Right-(o-l);else{if(i!==this.FPercentage)return o+this.FLayout.FSpacing;T&&(F=rtl.unionSet(F,rtl.createSet(0,2))),C=!0}else 0===o?o=e.Right:o+=1,s in rtl.createSet(0,2)&&(F=rtl.createSet(1,3)),s in rtl.createSet(1,2)&&T&&(F=rtl.unionSet(F,rtl.createSet(0,2)));r.$assign(pas["WEBLib.TMSFNCTypes"].RectF(e.Right-a-n,e.Top+n,o-n,e.Bottom-n)),!pas["WEBLib.TMSFNCTypes"].IsBitmapEmpty(this.FAppearance.FActiveBitmap)&&this.FAppearance.FShowActiveBitmaps&&C&&(r.Left=r.Right-l),o=r.Left}else{if(this.FDrawBlocks>1)if(0===o?(o=e.Left,F=rtl.createSet(0,2)):o+=this.FLayout.FSpacing,a>l*(p+1)+this.FLayout.FSpacing*p&&i!==this.FPercentage||a>l*(p+1)+this.FLayout.FSpacing*(p+1)+h/2&&i===this.FPercentage)a=o+l;else{if(i!==this.FPercentage)return o-this.FLayout.FSpacing;T&&(F=rtl.unionSet(F,rtl.createSet(1,3))),C=!0}else 0===o?o=e.Left:o-=1,s in rtl.createSet(0,2)&&(F=rtl.createSet(0,2)),s in rtl.createSet(1,2)&&T&&(F=rtl.unionSet(F,rtl.createSet(1,3)));r.$assign(pas["WEBLib.TMSFNCTypes"].RectF(o+n,e.Top+n,e.Left+a-n,e.Bottom-n)),!pas["WEBLib.TMSFNCTypes"].IsBitmapEmpty(this.FAppearance.FActiveBitmap)&&this.FAppearance.FShowActiveBitmaps&&C&&(r.Right=r.Left+l),o=r.Right}a<h?(r.Top=r.Top+(h-(r.Right-r.Left))*this.ScalePaintValue(1),r.Bottom=r.Bottom-(h-(r.Right-r.Left))*this.ScalePaintValue(1),h=(r.Right-r.Left)/2+1):r.Right-r.Left<pas.System.Trunc(h/2)&&this.FDrawBlocks>1&&(F={})}if(c=!0,u=!0,(pas["WEBLib.TMSFNCTypes"].IsBitmapEmpty(this.FAppearance.FActiveBitmap)||!this.FAppearance.FShowActiveBitmaps)&&a>0?(this.DoBeforeDrawBlock(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(r),rtl.refSet(F),{get:function(){return c},set:function(t){c=t}},{get:function(){return u},set:function(t){u=t}}),c&&(u&&t.DrawRoundRectangle$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(r),h,rtl.refSet(F),2),this.DoAfterDrawBlock(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(r),rtl.refSet(F))),this.DrawValue(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(r))):c&&u&&(this.FDrawActive&&this.FProgressValue>S?t.DrawBitmap$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(r),this.FAppearance.FActiveBitmap,!0,!1,!0,!1):this.FDrawActive||t.DrawBitmap$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(r),this.FAppearance.FInActiveBitmap,!0,!1,!0,!1)),this.FDrawBlocks>1&&(this.FCount+=1),C)break}return o},this.DrawStackedProgress=function(t,e){var i=0,s=0,o=!1,n=0;o=!0,s=0;for(var r=1,a=this.FLevels.GetCount()-1;r<=a;r++){if(i=r,t.FFill.Assign(this.FLevels.GetItem$1(i-1).FFill),t.FStroke.Assign(this.FLevels.GetItem$1(i-1).FStroke),t.FFont.Assign(this.FLevels.GetItem$1(i-1).FActiveFont),n=3,!(this.FProgressValue>this.FLevels.GetItem$1(i).FLevelPosition)){this.FDrawBlocks>1||(n=o?2:1),this.DrawProgressBlock(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),this.FPercentage,n,s);break}o&&(n=0,o=!1),s=this.DrawProgressBlock(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),this.FLevels.GetItem$1(i).FLevelPosition,n,s),this.FProgressValue>this.FLevels.GetItem$1(i).FLevelPosition&&i===this.FLevels.GetCount()-1&&(t.FFill.Assign(this.FLevels.GetItem$1(i).FFill),t.FStroke.Assign(this.FLevels.GetItem$1(i).FStroke),t.FFont.Assign(this.FLevels.GetItem$1(i).FActiveFont),this.DrawProgressBlock(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),this.FPercentage,1,s))}},this.DrawValue=function(t,e){var i="",s=0,o=0,n=0,r=0,a=0,l=0,h=0,F=pas["WEBLib.TMSFNCTypes"].TPointF.$new(),p=!1,c=!1,u=0,C=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),T=null,S=0,d=0,m=0,f=0;if(this.FLayout.FShowValue){if(this.FMaximum>=this.FMinimum?(m=this.FMaximum,f=this.FMinimum):(m=this.FMinimum,f=this.FMaximum),d=Math.max(Math.min(this.FProgressValue,m),f),S=this.CalculatePercentage(d),u=this.FLayout.FTextPosition,i=0===this.FLayout.FValueType?this.FLayout.FPrefix+pas.SysUtils.FloatToStrF(d,this.FLayout.FTextFormat,8+this.FLayout.FDecimals,this.FLayout.FDecimals)+this.FLayout.FSuffix:pas.SysUtils.FloatToStrF(S,this.FLayout.FTextFormat,2+this.FLayout.FDecimals,this.FLayout.FDecimals)+"%",this.FLayout.FTextOrientation in rtl.createSet(1,2)?(n=2===this.FLayout.FTextOrientation?90:-90,h=this.ScalePaintValue(5),l=this.ScalePaintValue(2),s=t.CalculateTextWidth$1(i),o=t.CalculateTextHeight$1(i)):(n=3===this.FLayout.FTextOrientation?180:0,l=this.ScalePaintValue(5),h=this.ScalePaintValue(2),s=t.CalculateTextHeight$1(i),o=t.CalculateTextWidth$1(i)),r=0,a=0,this.FMaximum<this.FMinimum){var g=u;0===g?u=2:2===g&&(u=0),1===this.FLayout.FShape?(pas["WEBLib.TMSFNCTypes"].IsBitmapEmpty(this.FLayout.FMinimumBitmap)||(a=this.FLayout.FMinimumBitmap.GetHeight()+1),pas["WEBLib.TMSFNCTypes"].IsBitmapEmpty(this.FLayout.FMaximumBitmap)||(r=this.FLayout.FMaximumBitmap.GetHeight()+1)):(pas["WEBLib.TMSFNCTypes"].IsBitmapEmpty(this.FLayout.FMinimumBitmap)||(a=this.FLayout.FMinimumBitmap.GetWidth()+1),pas["WEBLib.TMSFNCTypes"].IsBitmapEmpty(this.FLayout.FMaximumBitmap)||(r=this.FLayout.FMaximumBitmap.GetWidth()+1))}else 1===this.FLayout.FShape?(pas["WEBLib.TMSFNCTypes"].IsBitmapEmpty(this.FLayout.FMinimumBitmap)||(r=this.FLayout.FMinimumBitmap.GetHeight()+1),pas["WEBLib.TMSFNCTypes"].IsBitmapEmpty(this.FLayout.FMaximumBitmap)||(a=this.FLayout.FMaximumBitmap.GetHeight()+1)):(pas["WEBLib.TMSFNCTypes"].IsBitmapEmpty(this.FLayout.FMinimumBitmap)||(r=this.FLayout.FMinimumBitmap.GetWidth()+1),pas["WEBLib.TMSFNCTypes"].IsBitmapEmpty(this.FLayout.FMaximumBitmap)||(a=this.FLayout.FMaximumBitmap.GetWidth()+1));var y=u;if(0===y?1===this.FLayout.FShape?F.$assign(pas["WEBLib.TMSFNCTypes"].PointF((this.GetWidth()-o)/2-1,this.GetHeight()-this.FLayout.FBottomMargin-s-h-r)):F.$assign(pas["WEBLib.TMSFNCTypes"].PointF(this.FLayout.FLeftMargin+l+r,(this.GetHeight()-s)/2-1)):1===y?F.$assign(pas["WEBLib.TMSFNCTypes"].PointF((this.GetWidth()-o)/2-1,(this.GetHeight()-s)/2-1)):2===y?1===this.FLayout.FShape?F.$assign(pas["WEBLib.TMSFNCTypes"].PointF((this.GetWidth()-o)/2-1,this.FLayout.FTopMargin+h+a)):F.$assign(pas["WEBLib.TMSFNCTypes"].PointF(this.GetWidth()-o-this.FLayout.FRightMargin-l-a,(this.GetHeight()-s)/2-1)):5===y?1===this.FLayout.FShape?this.FMaximum<this.FMinimum?F.$assign(pas["WEBLib.TMSFNCTypes"].PointF((this.GetWidth()-o)/2-1,Math.max(this.FLayout.FTopMargin+h+a,Math.min(this.GetHeight()-s-this.FLayout.FBottomMargin-h-r,this.FPercentage/100*this.GetHeight()+h)))):F.$assign(pas["WEBLib.TMSFNCTypes"].PointF((this.GetWidth()-o)/2-1,Math.min(this.GetHeight()-s-this.FLayout.FBottomMargin-h-r,Math.max(this.FLayout.FTopMargin+h+a,this.GetHeight()-this.FPercentage/100*this.GetHeight()-s-h)))):this.FMaximum<this.FMinimum?F.$assign(pas["WEBLib.TMSFNCTypes"].PointF(Math.max(this.FLayout.FTopMargin+h+r,Math.min(this.GetWidth()-o-this.FLayout.FRightMargin-l-a,this.GetWidth()-this.FPercentage/100*this.GetWidth()-l-o)),(this.GetHeight()-s)/2-1)):F.$assign(pas["WEBLib.TMSFNCTypes"].PointF(Math.max(this.FLayout.FTopMargin+h+r,Math.min(this.GetWidth()-o-this.FLayout.FRightMargin-l-a,this.FPercentage/100*this.GetWidth())),(this.GetHeight()-s)/2-1)):4===y?1===this.FLayout.FShape?this.FMaximum<this.FMinimum?F.$assign(pas["WEBLib.TMSFNCTypes"].PointF((this.GetWidth()-o)/2-1,Math.min(Math.max(this.FLayout.FTopMargin+h+a,this.FPercentage/100*this.GetHeight()-s/2),this.GetHeight()-this.FLayout.FBottomMargin-s-h-r))):F.$assign(pas["WEBLib.TMSFNCTypes"].PointF((this.GetWidth()-o)/2-1,Math.max(Math.min(this.GetHeight()-s-this.FLayout.FBottomMargin-h-r,this.GetHeight()-this.FPercentage/100*this.GetHeight()-s/2),this.FLayout.FTopMargin+h+a))):this.FMaximum<this.FMinimum?F.$assign(pas["WEBLib.TMSFNCTypes"].PointF(Math.max(Math.min(this.GetWidth()-o-this.FLayout.FRightMargin-l-a,this.GetWidth()-this.FPercentage/100*this.GetWidth()-o/2),this.FLayout.FLeftMargin+l+r),(this.GetHeight()-s)/2-1)):F.$assign(pas["WEBLib.TMSFNCTypes"].PointF(Math.max(Math.min(this.GetWidth()-o-this.FLayout.FRightMargin-l-a,this.FPercentage/100*this.GetWidth()-o/2),this.FLayout.FLeftMargin+l+r),(this.GetHeight()-s)/2-1)):3===y?1===this.FLayout.FShape?this.FMaximum<this.FMinimum?F.$assign(pas["WEBLib.TMSFNCTypes"].PointF((this.GetWidth()-o)/2-1,Math.min(this.GetHeight()-s-this.FLayout.FBottomMargin-h-r,Math.max(this.FLayout.FTopMargin+h+a,this.FPercentage/100*this.GetHeight()-s-h)))):F.$assign(pas["WEBLib.TMSFNCTypes"].PointF((this.GetWidth()-o)/2-1,Math.max(this.FLayout.FTopMargin+h+a,Math.min(this.GetHeight()-s-this.FLayout.FBottomMargin-h-r,this.GetHeight()-this.FPercentage/100*this.GetHeight()+h)))):this.FMaximum<this.FMinimum?F.$assign(pas["WEBLib.TMSFNCTypes"].PointF(Math.max(this.FLayout.FLeftMargin+l+r,Math.min(this.GetWidth()-o-this.FLayout.FRightMargin-l-a,this.GetWidth()-this.FPercentage/100*this.GetWidth()+l)),(this.GetHeight()-s)/2-1)):F.$assign(pas["WEBLib.TMSFNCTypes"].PointF(Math.min(this.GetWidth()-o-this.FLayout.FRightMargin-l-a,Math.max(this.FLayout.FLeftMargin+l+r,this.FPercentage/100*this.GetWidth()-o-l)),(this.GetHeight()-s)/2-1)):6===y&&(1===this.FLayout.FShape?this.FMaximum<this.FMinimum?F.$assign(pas["WEBLib.TMSFNCTypes"].PointF((this.GetWidth()-o)/2-1,Math.max(this.FLayout.FTopMargin+h+a,(this.FPercentage/100*this.GetHeight()-s)/2))):F.$assign(pas["WEBLib.TMSFNCTypes"].PointF((this.GetWidth()-o)/2-1,Math.min(this.GetHeight()-s-this.FLayout.FBottomMargin-h-r,this.GetHeight()-(this.FPercentage/100*this.GetHeight()+s)/2))):this.FMaximum<this.FMinimum?F.$assign(pas["WEBLib.TMSFNCTypes"].PointF(Math.min(this.GetWidth()-o-this.FLayout.FRightMargin-l-a,this.GetWidth()-(this.FPercentage/100*this.GetWidth()+o)/2),(this.GetHeight()-s)/2-1)):F.$assign(pas["WEBLib.TMSFNCTypes"].PointF(Math.max(this.FLayout.FLeftMargin+l+r,(this.FPercentage/100*this.GetWidth()-o)/2),(this.GetHeight()-s)/2-1))),p=F.X<e.Right&&F.X+o>e.Left){c=!0,T=t.SaveState(!1);try{t.ClipRect(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e)),C.$assign(pas["WEBLib.TMSFNCTypes"].RectF(F.X,F.Y,F.X+o,F.Y+s)),this.DoBeforeDrawValue(t,i,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(C),this.FLayout.FTextPosition,this.FLayout.FTextOrientation,{get:function(){return p},set:function(t){p=t}},{get:function(){return c},set:function(t){c=t}}),p&&(c&&t.DrawText$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(C),i,!1,0,0,0,n,-1,-1,!0,!1,-1,-1),this.DoAfterDrawValue(t,i,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(C),this.FLayout.FTextPosition,this.FLayout.FTextOrientation))}finally{t.RestoreState(T,!1)}}}},this.GetActiveLevel=function(t){var e=0,i=0;e=0;for(var s=0,o=this.FLevels.GetCount()-1;s<=o&&(i=s,!(this.FLevels.GetItem$1(i).FLevelPosition>t));s++)e=i;return e},this.GetAppearance=function(){return this.FAppearance},this.GetLayout=function(){return this.FLayout},this.GetLowBitmapRect=function(){var t=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),e=pas["WEBLib.TMSFNCTypes"].TRectF.$new();return e.$assign(this.GetWorkingRect()),1===this.FLayout.FShape?this.FMaximum<this.FMinimum?t.$assign(pas["WEBLib.TMSFNCTypes"].RectF(e.Left,e.Top+1,e.Right,e.Top+this.FLayout.FMinimumBitmap.GetWidth()+1)):t.$assign(pas["WEBLib.TMSFNCTypes"].RectF(e.Left,e.Bottom-this.FLayout.FMinimumBitmap.GetWidth()-1,e.Right,e.Bottom-1)):this.FMaximum<this.FMinimum?t.$assign(pas["WEBLib.TMSFNCTypes"].RectF(e.Right-this.FLayout.FMinimumBitmap.GetWidth()-1,e.Top,e.Right-1,e.Bottom)):t.$assign(pas["WEBLib.TMSFNCTypes"].RectF(e.Left+1,e.Top,e.Left+this.FLayout.FMinimumBitmap.GetWidth()+1,e.Bottom)),t},this.GetHighBitmapRect=function(){var t=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),e=pas["WEBLib.TMSFNCTypes"].TRectF.$new();return e.$assign(this.GetWorkingRect()),1===this.FLayout.FShape?this.FMaximum<this.FMinimum?t.$assign(pas["WEBLib.TMSFNCTypes"].RectF(e.Left,e.Bottom-this.FLayout.FMaximumBitmap.GetWidth()-1,e.Right,e.Bottom-1)):t.$assign(pas["WEBLib.TMSFNCTypes"].RectF(e.Left,e.Top+1,e.Right,e.Top+this.FLayout.FMaximumBitmap.GetWidth()+1)):this.FMaximum<this.FMinimum?t.$assign(pas["WEBLib.TMSFNCTypes"].RectF(e.Left+1,e.Top,e.Left+this.FLayout.FMaximumBitmap.GetWidth()+1,e.Bottom)):t.$assign(pas["WEBLib.TMSFNCTypes"].RectF(e.Right-this.FLayout.FMaximumBitmap.GetWidth()-1,e.Top,e.Right-1,e.Bottom)),t},this.GetWorkingRect=function(){var t=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),e=0;return e=0!==this.FAppearance.FStroke.FKind?Math.round(this.FAppearance.FStroke.FWidth)%2==0?this.FAppearance.FStroke.FWidth/2:(this.FAppearance.FStroke.FWidth-1)/2:0,t.$assign(pas["WEBLib.TMSFNCTypes"].RectF(this.FLayout.FLeftMargin+e,this.FLayout.FTopMargin+e,this.GetWidth()-this.FLayout.FRightMargin-e,this.GetHeight()-this.FLayout.FBottomMargin-e)),t},this.LayoutChanged=function(t){this.Invalidate(),this.DoLayoutChanged(this)},this.LevelsChanged=function(t){this.Invalidate(),this.DoLevelsChanged(this)},this.MouseOnProgressValue=function(t,e){var i,s=!1,o=0;return s=!1,i=this.ScalePaintValue$1(Math.max(1,this.CalculatePercentage(this.FLayout.FInterval))),1===this.FLayout.FShape?(o=this.FMaximum<this.FMinimum?this.GetHeight()-this.GetHeight()*this.FPercentage/100:this.GetHeight()*this.FPercentage/100,e<this.GetHeight()-(o-2*i)&&e>this.GetHeight()-(o+2*i)&&(s=!0)):t>(o=this.FMaximum<this.FMinimum?this.GetWidth()-this.GetWidth()*this.FPercentage/100:this.GetWidth()*this.FPercentage/100)-2*i&&t<o+2*i&&(s=!0),s},this.SetApperance=function(t){this.FAppearance.Assign(t)},this.SetLayout=function(t){this.FLayout.Assign(t)},this.SetLevels=function(t){this.FLevels.Assign(t)},this.SetMaximum=function(t){this.FMaximum!==t&&(this.FMaximum=t,this.FPercentage=this.CalculatePercentage(this.FProgressValue),this.DoChanged(this))},this.SetMinimum=function(t){this.FMinimum!==t&&(this.FMinimum=t,this.FPercentage=this.CalculatePercentage(this.FProgressValue),this.DoChanged(this))},this.SetMouseValue=function(t,e){var i=0;return i=1===this.FLayout.FShape?(this.FMaximum-this.FMinimum)*(this.GetHeight()-e)/this.GetHeight()+this.FMinimum:(this.FMaximum-this.FMinimum)*t/this.GetWidth()+this.FMinimum,this.FLayout.FInterval<=0&&this.FLayout.SetInterval(1),!pas["WEBLib.TMSFNCTypes"].IsBitmapEmpty(this.FAppearance.FActiveBitmap)&&this.FAppearance.FShowActiveBitmaps?this.FMaximum<this.FMinimum?i<this.FLayout.FInterval/2?this.FMaximum:Math.max(this.FMaximum,Math.min(this.FMinimum,pas.System.Trunc(i/this.FLayout.FInterval)*this.FLayout.FInterval+this.FLayout.FInterval)):i<this.FLayout.FInterval/2?this.FMinimum:Math.max(this.FMinimum,Math.min(this.FMaximum,pas.System.Trunc(i/this.FLayout.FInterval)*this.FLayout.FInterval+this.FLayout.FInterval)):this.FMaximum<this.FMinimum?Math.max(this.FMaximum,Math.min(this.FMinimum,Math.round(i/this.FLayout.FInterval)*this.FLayout.FInterval)):Math.max(this.FMinimum,Math.min(this.FMaximum,Math.round(i/this.FLayout.FInterval)*this.FLayout.FInterval))},this.SetProgressValue=function(t){this.FProgressValue!==t&&(this.FProgressValue=t,this.FPercentage=this.CalculatePercentage(this.FProgressValue),this.DoChanged(this))},this.SetGlobalFont=function(t){this.FGlobalFont.Assign(t)},this.CreateAppearance=function(){return t.TTMSFNCProgressBarAppearance.$create("Create$1",[this])},this.CreateLayout=function(){return t.TTMSFNCProgressBarLayout.$create("Create$1",[this])},this.DoAfterDrawBlock=function(t,e,i){null!=this.FOnAfterDrawBlock&&this.FOnAfterDrawBlock(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),rtl.refSet(i))},this.DoAfterDrawValue=function(t,e,i,s,o){null!=this.FOnAfterDrawValue&&this.FOnAfterDrawValue(this,t,e,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),s,o)},this.DoAppearanceChanged=function(t){null!=this.FOnAppearanceChanged&&this.FOnAppearanceChanged(this)},this.DoBeforeDrawBlock=function(t,e,i,s,o){null!=this.FOnBeforeDrawBlock&&this.FOnBeforeDrawBlock(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),rtl.refSet(i),s,o)},this.DoBeforeDrawValue=function(t,e,i,s,o,n,r){null!=this.FOnBeforeDrawValue&&this.FOnBeforeDrawValue(this,t,e,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),s,o,n,r)},this.DoChanged=function(t){this.Invalidate(),null!=this.FOnChanged&&this.FOnChanged(this)},this.DoLayoutChanged=function(t){null!=this.FOnLayoutChanged&&this.FOnLayoutChanged(this)},this.DoLevelsChanged=function(t){null!=this.FOnLevelsChanged&&this.FOnLevelsChanged(this)},this.DoSlideValueChange=function(t,e){null!=this.FOnSlideValueChange&&this.FOnSlideValueChange(this,t,e),null!=this.FOnValueChange&&this.FOnValueChange(this,t,e)},this.DoSlideValueChanged=function(t){null!=this.FOnSlideValueChanged&&this.FOnSlideValueChanged(this,t),null!=this.FOnValueChanged&&this.FOnValueChanged(this,t)},this.DoSnapValueChange=function(t,e){null!=this.FOnSnapValueChange&&this.FOnSnapValueChange(this,t,e),null!=this.FOnValueChange&&this.FOnValueChange(this,t,e)},this.DoSnapValueChanged=function(t){null!=this.FOnSnapValueChanged&&this.FOnSnapValueChanged(this,t),null!=this.FOnValueChanged&&this.FOnValueChanged(this,t)},this.DoKeyboardValueChange=function(t,e){null!=this.FOnKeyboardValueChange&&this.FOnKeyboardValueChange(this,t,e),null!=this.FOnValueChange&&this.FOnValueChange(this,t,e)},this.DoKeyboardValueChanged=function(t){null!=this.FOnKeyboardValueChanged&&this.FOnKeyboardValueChanged(this,t),null!=this.FOnValueChanged&&this.FOnValueChanged(this,t)},this.DrawBackground=function(t,e){t.FFill.Assign(this.FAppearance.FFill),t.FStroke.Assign(this.FAppearance.FStroke),t.DrawRoundRectangle$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),Math.min(this.FLayout.FRounding,Math.min((e.Bottom-e.Top)/2,(e.Right-e.Left)/2)),rtl.createSet(0,1,2,3),2)},this.HandleKeyDown=function(t,e){var i=0,s=!1;pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleKeyDown.apply(this,arguments),!this.FInteraction.FReadOnlyMode&&this.FInteraction.FKeyboardSupport&&(i=37===t.get()||40===t.get()?this.FMinimum>this.FMaximum?Math.max(this.FMaximum,Math.min(this.FMinimum,this.FProgressValue+this.FLayout.FInterval)):Math.max(this.FMinimum,Math.min(this.FMaximum,this.FProgressValue-this.FLayout.FInterval)):39===t.get()||38===t.get()?this.FMinimum>this.FMaximum?Math.max(this.FMaximum,Math.min(this.FMinimum,this.FProgressValue-this.FLayout.FInterval)):Math.max(this.FMinimum,Math.min(this.FMaximum,this.FProgressValue+this.FLayout.FInterval)):this.FProgressValue)!==this.FProgressValue&&(s=!0,this.DoKeyboardValueChange(i,{get:function(){return s},set:function(t){s=t}}),s&&(this.SetProgressValue(i),this.DoKeyboardValueChanged(this.FProgressValue)))},this.HandleKeyUp=function(t,e){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleKeyUp.apply(this,arguments)},this.HandleMouseDown=function(t,e,i,s){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleMouseDown.apply(this,arguments),this.SetFocus(),this.FInteraction.FReadOnlyMode||(this.FInteraction.FSlideToValue&&this.MouseOnProgressValue(i,s)&&(this.FMouseSlide=!0),this.FMouseDown=!0,this.CaptureEx())},this.HandleMouseEnter=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleMouseEnter.call(this),this.FInteraction.FReadOnlyMode||(this.FMouseHover=!0)},this.HandleMouseLeave=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleMouseLeave.call(this),this.FInteraction.FReadOnlyMode||(this.FMouseDown=!1,this.FMouseHover=!1,this.FMouseSlide=!1)},this.HandleMouseMove=function(t,e,i){var s=0,o=!1;pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleMouseMove.apply(this,arguments),this.FInteraction.FReadOnlyMode||(this.FInteraction.FSlideToValue&&(this.MouseOnProgressValue(e,i)||this.FMouseSlide)?(0===this.FLayout.FShape?this.SetControlCursor(14):this.SetControlCursor(15),this.FMouseDown&&(s=this.SetMouseValue(e,i),this.FProgressValue!==s&&(o=!0,this.DoSlideValueChange(s,{get:function(){return o},set:function(t){o=t}}),o&&(this.SetProgressValue(s),this.DoSlideValueChanged(this.FProgressValue))))):this.FInteraction.FSnapToValue?this.SetControlCursor(21):this.FMouseDown||this.SetControlCursor(0))},this.HandleMouseUp=function(t,e,i,s){var o=0,n=!1;pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleMouseUp.apply(this,arguments),this.FInteraction.FReadOnlyMode||(this.FInteraction.FSnapToValue&&this.FMouseDown&&(o=this.SetMouseValue(i,s),this.FProgressValue!==o&&(n=!0,this.DoSnapValueChange(o,{get:function(){return n},set:function(t){n=t}}),n&&(this.SetProgressValue(o),this.DoSnapValueChanged(this.FProgressValue)))),this.FMouseSlide=!1,this.FMouseDown=!1),this.ReleaseCaptureEx()},this.SetFonts=function(t){var e=0;this.BeginUpdate(),this.FGlobalFont.ApplyChange(this.GetAppearance().FFont,t),this.FGlobalFont.ApplyChange(this.GetAppearance().FDefaultLevelFont,t);for(var i=0,s=this.FLevels.GetCount()-1;i<=s;i++)e=i,this.FGlobalFont.ApplyChange(this.FLevels.GetItem$1(e).FActiveFont,t);this.EndUpdate()},this.Create$1=function(e){return pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Create$1.apply(this,arguments),this.FTransparent=!0,this.FMouseDown=!1,this.FMouseHover=!1,this.FMouseSlide=!1,this.FDrawActive=!0,this.FCount=0,this.FAppearance=this.CreateAppearance(),this.FAppearance.FOnChange=rtl.createCallback(this,"AppearanceChanged"),this.FLayout=this.CreateLayout(),this.FLayout.FOnChange=rtl.createCallback(this,"LayoutChanged"),this.FLevels=t.TTMSFNCCustomProgressBarLevelCollection.$create("Create$3",[this]),this.FLevels.FOnChanged=rtl.createCallback(this,"LevelsChanged"),this.FInteraction=t.TTMSFNCProgressInteraction.$create("Create$1"),this.FGlobalFont=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCAppearanceGlobalFont.$create("Create$1",[this]),this.FMinimum=0,this.FMaximum=100,this.SetProgressValue(50),this.SetWidth(200),this.SetHeight(20),this},this.Destroy=function(){rtl.free(this,"FGlobalFont"),rtl.free(this,"FAppearance"),rtl.free(this,"FLayout"),rtl.free(this,"FLevels"),rtl.free(this,"FInteraction"),pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Destroy.call(this)},this.Assign=function(e){t.TTMSFNCCustomProgressBar.isPrototypeOf(e)?(this.FAppearance.Assign(rtl.as(e,t.TTMSFNCCustomProgressBar).FAppearance),this.FLayout.Assign(rtl.as(e,t.TTMSFNCCustomProgressBar).FLayout),this.FLevels.Assign(rtl.as(e,t.TTMSFNCCustomProgressBar).FLevels),this.FMaximum=rtl.as(e,t.TTMSFNCCustomProgressBar).FMaximum,this.FMinimum=rtl.as(e,t.TTMSFNCCustomProgressBar).FMinimum,this.SetProgressValue(rtl.as(e,t.TTMSFNCCustomProgressBar).FProgressValue),this.FInteraction.Assign(rtl.as(e,t.TTMSFNCCustomProgressBar).FInteraction)):pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Assign.apply(this,arguments)},this.Draw=function(t,e){this.DrawBackground(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e)),t.FFont.Assign(this.FAppearance.FFont),this.DrawValue(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(this.GetWorkingRect())),(this.FProgressValue>Math.min(this.FMaximum,this.FMinimum)||!pas["WEBLib.TMSFNCTypes"].IsBitmapEmpty(this.FAppearance.FInActiveBitmap)&&this.FAppearance.FShowInActiveBitmaps)&&this.DrawProgress(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(this.GetWorkingRect())),this.DrawLowHighBitmaps(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(this.GetWorkingRect()))},rtl.addIntf(this,pas["WEBLib.TMSFNCGraphicsTypes"].ITMSFNCAppearanceGlobalFont),rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas["WEBLib.TMSFNCTypes"].ITMSFNCProductInfo),rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TTMSFNCProgressBar",this.TTMSFNCCustomProgressBar,(function(){this.Create$1=function(e){return t.TTMSFNCCustomProgressBar.Create$1.apply(this,arguments),this.FInteraction.FReadOnlyMode=!0,this},this.Destroy=function(){t.TTMSFNCCustomProgressBar.Destroy.call(this)},rtl.addIntf(this,pas["WEBLib.TMSFNCGraphicsTypes"].ITMSFNCAppearanceGlobalFont),rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas["WEBLib.TMSFNCTypes"].ITMSFNCProductInfo),rtl.addIntf(this,pas.System.IUnknown);var e=this.$rtti;e.addProperty("Appearance",3,t.$rtti.TTMSFNCProgressBarAppearance,"GetAppearance","SetApperance"),e.addProperty("Layout",3,t.$rtti.TTMSFNCProgressBarLayout,"GetLayout","SetLayout"),e.addProperty("Levels",2,t.$rtti.TTMSFNCCustomProgressBarLevelCollection,"FLevels","SetLevels"),e.addProperty("Maximum",2,rtl.double,"FMaximum","SetMaximum"),e.addProperty("Minimum",2,rtl.double,"FMinimum","SetMinimum"),e.addProperty("Value",2,rtl.double,"FProgressValue","SetProgressValue"),e.addProperty("GlobalFont",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCAppearanceGlobalFont,"FGlobalFont","SetGlobalFont"),e.addProperty("OnAfterDrawBlock",0,t.$rtti.TTMSFNCProgressBarAfterDrawBlockEvent,"FOnAfterDrawBlock","FOnAfterDrawBlock"),e.addProperty("OnAfterDrawValue",0,t.$rtti.TTMSFNCProgressBarAfterDrawValueEvent,"FOnAfterDrawValue","FOnAfterDrawValue"),e.addProperty("OnAppearanceChanged",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnAppearanceChanged","FOnAppearanceChanged"),e.addProperty("OnBeforeDrawBlock",0,t.$rtti.TTMSFNCProgressBarBeforeDrawBlockEvent,"FOnBeforeDrawBlock","FOnBeforeDrawBlock"),e.addProperty("OnBeforeDrawValue",0,t.$rtti.TTMSFNCProgressBarBeforeDrawValueEvent,"FOnBeforeDrawValue","FOnBeforeDrawValue"),e.addProperty("OnChanged",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnChanged","FOnChanged"),e.addProperty("OnLayoutChanged",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnLayoutChanged","FOnLayoutChanged"),e.addProperty("OnLevelsChanged",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnLevelsChanged","FOnLevelsChanged"),e.attr=[pas.Classes.ComponentPlatformsAttribute,"Create$1",[0]]}))}),["Math","WEBLib.Forms"]),rtl.module("WEBLib.TMSFNCCheckedTreeView",["System","Classes","WEBLib.TMSFNCTreeView","WEBLib.TMSFNCTreeViewData","WEBLib.TMSFNCTypes"],(function(){"use strict";var t=this;this.MAJ_VER=1,this.MIN_VER=0,this.REL_VER=0,this.BLD_VER=1,rtl.createClass(this,"TTMSFNCCheckedTreeViewNodeValue",pas["WEBLib.TMSFNCTreeViewData"].TTMSFNCTreeViewNodeValue,(function(){this.Create$1=function(t){var e=null;return pas["WEBLib.TMSFNCTreeViewData"].TTMSFNCTreeViewNodeValue.Create$1.apply(this,arguments),null!=(e=this.TreeView())&&e.IsDesignTime()&&this.SetCheckType(1),this}})),rtl.createClass(this,"TTMSFNCCheckedTreeViewNodeValues",pas["WEBLib.TMSFNCTreeViewData"].TTMSFNCTreeViewNodeValues,(function(){this.GetItemClass=function(){return t.TTMSFNCCheckedTreeViewNodeValue}})),rtl.createClass(this,"TTMSFNCCheckedTreeViewNode",pas["WEBLib.TMSFNCTreeViewData"].TTMSFNCTreeViewNode,(function(){this.CreateNodeValues=function(){return t.TTMSFNCCheckedTreeViewNodeValues.$create("Create$3",[this.TreeView(),this])},this.CreateNodes=function(){return t.TTMSFNCCheckedTreeViewNodes.$create("Create$3",[this.TreeView(),this])}})),rtl.createClass(this,"TTMSFNCCheckedTreeViewNodes",pas["WEBLib.TMSFNCTreeViewData"].TTMSFNCTreeViewNodes,(function(){this.GetItemClass=function(){return t.TTMSFNCCheckedTreeViewNode}})),rtl.createClass(this,"TTMSFNCCheckedTreeView",pas["WEBLib.TMSFNCTreeView"].TTMSFNCTreeView,(function(){this.CreateNodes=function(){return t.TTMSFNCCheckedTreeViewNodes.$create("Create$3",[this,null])},this.GetVersion=function(){return this.$class.GetVersionNumber(1,0,0,1)},this.InitSample=function(){var t=null,e=null,i=null,s=null,o=null,n=0,r="";for(this.BeginUpdate(),this.SetWidth(this.ScalePaintValue(350)),this.ClearNodeList(),this.FColumns.Clear(),this.FNodes.Clear(),this.ResetToDefaultStyle(),(o=this.FColumns.Add$1()).SetText("Name"),o.SetHorizontalTextAlign(1),(o=this.FColumns.Add$1()).SetText("Unit"),o.SetHorizontalTextAlign(2),o.SetWidth(this.ScalePaintValue(90)),(o=this.FColumns.Add$1()).SetText("Status"),o.SetHorizontalTextAlign(0),o.SetWidth(this.ScalePaintValue(80)),(t=this.AddNode(null)).SetText(0,"Managers"),t.SetCheckType(0,1),(e=this.AddNode(null)).SetText(0,"Specialists"),e.SetCheckType(0,1),(i=this.AddNode(null)).SetText(0,"Assistants"),i.SetCheckType(0,1),n=0;n<=7;n++){(s=n<3?this.AddNode(t):n<5?this.AddNode(e):this.AddNode(i)).SetCheckType(0,1),s.SetCheckType(1,0),s.SetCheckType(2,0);var a=pas.System.Random(125)%7;r=0===a?"Liam":1===a?"Fatma":2===a?"Yusuf":3===a?"Marie":4===a?"Isabella":5===a?"Omar":"Arthur";var l=pas.System.Random(125)%7;r+=0===l?" Andersson":1===l?" Wang":2===l?" Smith":3===l?" Peeters":4===l?" Gonzales":5===l?" Moyo":" Ali",s.SetText(0,r);var h=pas.System.Random(120)%7;1===h?s.SetText(1,"Research"):2===h?s.SetText(1,"Finance"):3===h?s.SetText(1,"Development"):4===h?s.SetText(1,"Sales"):5===h?s.SetText(1,"HR"):6===h?s.SetText(1,"Marketing"):s.SetText(1,"Customers");var F=pas.System.Random(120)%5;0===F?s.SetText(2,"Flight"):1===F?s.SetText(2,"On Leave"):2===F?s.SetText(2,"Abroad"):s.SetText(2,"Office")}t.SetExpanded(!0),e.SetExpanded(!0),this.FGlobalFont.SetName("Segoe UI"),this.FColumnsAppearance.SetStretchAll(!1),this.FColumnsAppearance.SetStretch(!0),this.FColumnsAppearance.SetStretchColumn(0),this.EndUpdate()},rtl.addIntf(this,pas["WEBLib.TMSFNCControlPicker"].ITMSFNCControlPickerFull),rtl.addIntf(this,pas["WEBLib.TMSFNCGraphicsTypes"].ITMSFNCAppearanceGlobalFont),rtl.addIntf(this,pas["WEBLib.TMSFNCBitmapContainer"].ITMSFNCBitmapContainer),rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas["WEBLib.TMSFNCTypes"].ITMSFNCProductInfo),rtl.addIntf(this,pas.System.IUnknown),this.$rtti.attr=[pas.Classes.ComponentPlatformsAttribute,"Create$1",[0]]}))}),["WEBLib.TMSFNCUtils","WEBLib.TMSFNCGraphicsTypes"]),rtl.module("WebLib.SEFNC.RunLevelTypes",["System","Classes","SysUtils","Generics.Collections","WEBLib.ExtCtrls","WEBLib.Controls","WEBLib.TMSFNCProgressBar","WEBLib.TMSFNCCheckedTreeView","WEBLib.TMSFNCHTMLText","WEBLib.TMSFNCStatusBar","WebLib.SEFNC.Layout"],(function(){"use strict";var t=this;this.TSEFNCRunLevelStatus={0:"serlPending",serlPending:0,1:"serlExecuting",serlExecuting:1,2:"serlFailed",serlFailed:2,3:"serlSuccess",serlSuccess:3,4:"serlSkipped",serlSkipped:4},this.RunLevelStatus=["Pending","Executing","Failed","Success","Skipped"],rtl.createClass(this,"TSEFNCRunLevel",pas.System.TObject,(function(){this.$init=function(){pas.System.TObject.$init.call(this),this.FID=pas.System.TGuid.$new(),this.FRunProc=null,this.FRunLevelName="",this.FStartTime=0,this.FEndTime=0,this.FEnabled=!1,this.FStatus=0,this.FExceptionMsg=""},this.$final=function(){this.FID=void 0,this.FRunProc=void 0,pas.System.TObject.$final.call(this)},this.IDGet=function(){return pas.SysUtils.TGuidHelper.ToString.call(this.FID,!1)},this.ExecLevel=function(){var t;try{this.FStatus=1,this.FStartTime=pas.SysUtils.Now(),this.FEndTime=pas.SysUtils.Now();try{null!=this.FRunProc?(this.FRunProc(),this.FStatus=3):this.FStatus=4}catch(t){if(pas.SysUtils.Exception.isPrototypeOf(t)){var e=t;this.FExceptionMsg=e.FMessage,this.FStatus=2}else this.FExceptionMsg="Exception unhandled",this.FStatus=2}}finally{this.FEndTime=pas.SysUtils.Now(),t=3===this.FStatus}return t},this.Create$1=function(t,e){return this.FRunProc=e,this.FRunLevelName=t,this.FStatus=0,this.FEnabled=!0,this.FID.$assign(pas.SysUtils.TGuidHelper.NewGuid()),this},this.ElapsedMS=function(){return pas.DateUtils.MilliSecondsBetween(this.FStartTime,this.FEndTime)},this.StatusText=function(){return t.RunLevelStatus[this.FStatus]}})),rtl.createClass(this,"TSEFNCRunLevelManager",pas.Classes.TComponent,(function(){this.$init=function(){pas.Classes.TComponent.$init.call(this),this.FLvlCurr=0,this.FLevelExecuting=null,this.FRunLevels=null,this.FRunning=!1,this.FTimer=null,this.FTimerItemStatus=null,this.FPnlBorder=null,this.pbRunLevels=null,this.txtHeader=null,this.tvRunLevel=null,this.FItemStatusBar=null,this.FItemStatusNumber=null,this.FItemStatusProgress=null,this.FItemStatusElapsed=null},this.$final=function(){this.FLevelExecuting=void 0,this.FRunLevels=void 0,this.FTimer=void 0,this.FTimerItemStatus=void 0,this.FPnlBorder=void 0,this.pbRunLevels=void 0,this.txtHeader=void 0,this.tvRunLevel=void 0,this.FItemStatusBar=void 0,this.FItemStatusNumber=void 0,this.FItemStatusProgress=void 0,this.FItemStatusElapsed=void 0,pas.Classes.TComponent.$final.call(this)},this.DoManagerMessage=function(t){this.RunManagerMessage(t)},this.ExecNextLevel=function(t){var e=rtl.createIntfRefs();try{if(this.InitDone())return;this.FTimer.SetEnabled(!1),this.FLevelExecuting=this.FRunLevels.GetItem(this.FLvlCurr),this.ItemStatusReset(this.LevelCountString(),-1);try{try{e.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("Begin run level "+this.FLevelExecuting.FRunLevelName,this),this.RunLevelMessage(this.FLevelExecuting),this.FLevelExecuting.ExecLevel(),this.RunLevelMessage(this.FLevelExecuting)}catch(t){if(!pas.SysUtils.Exception.isPrototypeOf(t))throw t;var i=t;this.DoManagerMessage("Exception evaluating run level "+this.FLevelExecuting.FRunLevelName+"::"+i.FMessage)}}finally{e.ref(2,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("End run level "+this.FLevelExecuting.FRunLevelName+" elapedms "+pas.SysUtils.TIntegerHelper.ToString$1.call({a:this.FLevelExecuting.ElapsedMS(),get:function(){return this.a},set:function(t){this.a=t}}),this),this.FLvlCurr+=1,this.FTimer.SetEnabled(!0)}}finally{e.free()}},this.InitDone=function(){var t;return(t=this.FLvlCurr>=this.FRunLevels.FLength)&&(this.FTimer.SetEnabled(!1),this.FRunning=!1,this.DoManagerMessage("Finished Initialization @ "+pas.SysUtils.FormatDateTime("hh:nn:ss zzz",pas.SysUtils.Now())),this.FPnlBorder.SetVisible(!1),this.FTimerItemStatus.SetEnabled(!1)),t},this.LevelCountString=function(){return pas.SysUtils.TIntegerHelper.ToString$1.call({a:this.FLvlCurr+1,get:function(){return this.a},set:function(t){rtl.raiseE("EPropReadOnly")}})+" of "+pas.SysUtils.TNativeIntHelper.ToString$1.call({p:this.FRunLevels,get:function(){return this.p.FLength},set:function(t){this.p.FLength=t}})},this.PercentExecuted=function(){return 0===this.FRunLevels.FLength?0:Math.round((this.FLvlCurr+1)/this.FRunLevels.FLength*100)},this.AddRunLevelTreeItem=function(t){var e=null;(e=this.tvRunLevel.AddNode(null)).SetText(0,t.FRunLevelName),e.FDBKey=t.IDGet(),e.SetCheckType(0,1)},this.InitTree=function(){var t=null;this.tvRunLevel.ClearColumns(),this.tvRunLevel.ClearNodes(),(t=this.tvRunLevel.FColumns.Add$1()).SetText("Description"),(t=this.tvRunLevel.FColumns.Add$1()).SetText("Elapsed ms"),t.SetWidth(90),this.tvRunLevel.FInteraction.SetColumnSizing(!0),this.tvRunLevel.FInteraction.SetColumnAutoSizeOnDblClick(!0),this.tvRunLevel.FColumnsAppearance.SetStretchColumn(0),this.tvRunLevel.FInteraction.FClipboardMode=1,this.tvRunLevel.FInteraction.FAnimationFactor=1.1,this.tvRunLevel.FNodesAppearance.SetShowLines(!1),this.tvRunLevel.SetStretchScrollBars(!1)},this.InitViewer=function(){this.FPnlBorder=pas["WebLib.SEFNC.Layout"].TSEFNCLayout.$create("Create$1",[this.FOwner]),this.FPnlBorder.SetParent(this.FOwner),this.FPnlBorder.SetWidth(400),this.FPnlBorder.SetHeight(300),pas["WebLib.SEFNC.Layout"].TSEFNCAlign.CenterControl(this.FPnlBorder),this.txtHeader=pas["WEBLib.TMSFNCHTMLText"].TTMSFNCHTMLText.$create("Create$1",[this.FOwner]),this.txtHeader.SetParent(this.FPnlBorder),this.txtHeader.SetAlign(pas["WebLib.SEFNC.Layout"].TSEFNCAlign.GetAlign(1)),this.txtHeader.SetHeight(32),this.pbRunLevels=pas["WEBLib.TMSFNCProgressBar"].TTMSFNCProgressBar.$create("Create$1",[this.FOwner]),this.pbRunLevels.SetParent(this.FPnlBorder),this.pbRunLevels.SetAlign(pas["WebLib.SEFNC.Layout"].TSEFNCAlign.GetAlign(1)),this.pbRunLevels.SetProgressValue(0),this.FItemStatusBar=pas["WEBLib.TMSFNCStatusBar"].TTMSFNCStatusBar.$create("Create$1",[this.FOwner]),this.FItemStatusBar.SetParent(this.FPnlBorder),this.FItemStatusBar.SetAlign(pas["WebLib.SEFNC.Layout"].TSEFNCAlign.GetAlign(1)),this.FItemStatusNumber=this.FItemStatusBar.FPanels.Add$1(),this.FItemStatusProgress=this.FItemStatusBar.FPanels.Add$1(),this.FItemStatusProgress.SetStyle(5),this.FItemStatusProgress.SetAlignment(2),this.FItemStatusProgress.SetWidth(250),this.FItemStatusElapsed=this.FItemStatusBar.FPanels.Add$1(),this.FItemStatusElapsed.SetAlignment(1),this.ItemStatusReset("init",-1),this.tvRunLevel=pas["WEBLib.TMSFNCCheckedTreeView"].TTMSFNCCheckedTreeView.$create("Create$1",[this.FOwner]),this.tvRunLevel.SetParent(this.FPnlBorder),this.tvRunLevel.SetAlign(pas["WebLib.SEFNC.Layout"].TSEFNCAlign.GetAlign(5)),this.FPnlBorder.FPadding.SetLeft(4),this.FPnlBorder.FPadding.SetRight(4),this.FPnlBorder.FPadding.SetTop(4),this.FPnlBorder.FPadding.SetBottom(4),this.InitTree()},this.ItemStatusReset=function(t,e){this.FItemStatusNumber.SetText(t),this.ItemStatusUpdate(e)},this.ItemStatusUpdate=function(t){var e=rtl.createIntfRefs();try{-1===t?(this.FItemStatusProgress.FProgress.SetPosition(1),this.FItemStatusElapsed.SetText("### ms")):(this.FItemStatusProgress.FProgress.SetPosition(Math.round(.1*t)),this.FItemStatusElapsed.SetText(pas.SysUtils.TIntegerHelper.ToString$1.call({get:function(){return t},set:function(t){rtl.raiseE("EPropReadOnly")}})+" ms"),e.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("Display updated to "+this.FItemStatusElapsed.FText,this))}finally{e.free()}},this.ItemStatusTick=function(t){this.ItemStatusUpdate(pas.DateUtils.MilliSecondsBetween(this.FLevelExecuting.FStartTime,pas.SysUtils.Now()))},this.RunLevelMessage=function(t){var e,i=null,s=null;if(null!==(e=this.tvRunLevel.FindVirtualNodeByDBKey(t.IDGet()))){i=e.FNode;var o=t.FStatus;0===o?i.SetChecked(0,!1):1===o?i.SetText(1,". . ."):2===o?(i.SetText(1,pas.SysUtils.TIntegerHelper.ToString$1.call({a:t.ElapsedMS(),get:function(){return this.a},set:function(t){this.a=t}})),i.SetChecked(0,!1),(s=this.tvRunLevel.AddNode(i)).SetText(0,t.FExceptionMsg),s.SetExtended(!0),i.SetExpanded(!0)):3===o?(i.SetText(1,pas.SysUtils.TIntegerHelper.ToString$1.call({a:t.ElapsedMS(),get:function(){return this.a},set:function(t){this.a=t}})),i.SetChecked(0,!0)):4===o&&(i.SetCheckType(0,2),i.SetChecked(0,!1),i.SetText(1,t.StatusText()))}else this.AddRunLevelTreeItem(t);this.pbRunLevels.SetProgressValue(this.PercentExecuted())},this.RunManagerMessage=function(t){var e=null;(e=this.tvRunLevel.AddNode(null)).SetText(0,t),e.SetExtended(!0)},this.HeaderTextSet=function(t){this.txtHeader.SetText(t)},this.HeaderTextGet=function(){return this.txtHeader.FText},this.Create$2=function(t){return pas.Classes.TComponent.Create$1.call(this,t),this.FRunLevels=pas["Generics.Collections"].TObjectList$G12.$create("Create$4",[!0]),this.FLvlCurr=0,this.InitViewer(),this.FTimer=pas["WEBLib.ExtCtrls"].TTimer.$create("Create$1",[this.FOwner]),this.FTimer.SetEnabled(!1),this.FTimer.SetInterval(5),this.FTimerItemStatus=pas["WEBLib.ExtCtrls"].TTimer.$create("Create$1",[this.FOwner]),this.FTimerItemStatus.SetEnabled(!1),this.FTimerItemStatus.SetInterval(100),this.FTimerItemStatus.FOnTimer=rtl.createCallback(this,"ItemStatusTick"),this},this.Destroy=function(){rtl.free(this,"FRunLevels"),pas.Classes.TComponent.Destroy.call(this)},this.AddLevel=function(e,i){var s;if(this.FRunning)throw pas.SysUtils.Exception.$create("Create$1",["Do Not add while running"]);s=t.TSEFNCRunLevel.$create("Create$1",[e,i]),this.FRunLevels.Add(s),this.AddRunLevelTreeItem(s)},this.InitStart=function(){this.FRunning?this.DoManagerMessage("Start called while running, ignoring request"):(this.DoManagerMessage("Begin Initialization @ "+pas.SysUtils.FormatDateTime("hh:nn:ss zzz",pas.SysUtils.Now())),this.FRunning=!0,this.FTimer.FOnTimer=rtl.createCallback(this,"ExecNextLevel"),this.FTimerItemStatus.SetEnabled(!0),this.FTimer.SetEnabled(!0))},rtl.addIntf(this,pas.System.IUnknown),this.$rtti.addProperty("HeaderText",3,rtl.string,"HeaderTextGet","HeaderTextSet")}))}),["DateUtils","WEBLib.TMSFNCTreeViewData","WEBLib.TMSFNCCustomTreeView","WebLib.SEFNC.Logger"]),rtl.module("WEBLib.TMSFNCSwitch",["System","Classes","Types","WEBLib.ExtCtrls","WEBLib.Controls","WEBLib.TMSFNCCustomControl","WEBLib.TMSFNCGraphics","WEBLib.TMSFNCGraphicsTypes","WEBLib.TMSFNCTypes"],(function(){"use strict";var t=this,e=t.$impl;this.MAJ_VER=1,this.MIN_VER=0,this.REL_VER=3,this.BLD_VER=0,this.TTMSFNCCustomSwitchOrientation={0:"soHorizontal",soHorizontal:0,1:"soVertical",soVertical:1},this.$rtti.$Enum("TTMSFNCCustomSwitchOrientation",{minvalue:0,maxvalue:1,ordtype:1,enumtype:this.TTMSFNCCustomSwitchOrientation}),this.TTMSFNCCustomSwitchState={0:"ssOff",ssOff:0,1:"ssOn",ssOn:1},this.$rtti.$Enum("TTMSFNCCustomSwitchState",{minvalue:0,maxvalue:1,ordtype:1,enumtype:this.TTMSFNCCustomSwitchState}),this.TTMSFNCCustomSwitchLayout={0:"sloSimple",sloSimple:0,1:"sloExtended",sloExtended:1},this.$rtti.$Enum("TTMSFNCCustomSwitchLayout",{minvalue:0,maxvalue:1,ordtype:1,enumtype:this.TTMSFNCCustomSwitchLayout}),rtl.createClass(this,"TTMSFNCCustomSwitchAppearanceOff",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FOnChange=null,this.FFill=null,this.FStroke=null,this.FText="",this.FFont=null},this.$final=function(){this.FOnChange=void 0,this.FFill=void 0,this.FStroke=void 0,this.FFont=void 0,pas.Classes.TPersistent.$final.call(this)},this.SetFill=function(t){this.FFill.Assign(t)},this.SetStroke=function(t){this.FStroke.Assign(t)},this.SetText=function(t){this.FText!==t&&(this.FText=t,this.Changed())},this.IsTextStored=function(){return"Off"!==this.FText},this.SetFont=function(t){this.FFont.AssignSource(t)},this.Changed=function(){null!=this.FOnChange&&this.FOnChange(this)},this.FillChanged=function(t){this.Changed()},this.StrokeChanged=function(t){this.Changed()},this.FontChanged=function(t){this.Changed()},this.Create$1=function(){return this.FFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[1,16777215,8421504,-1,-1]),this.FFill.FOnChanged=rtl.createCallback(this,"FillChanged"),this.FStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,12632256]),this.FStroke.FOnChanged=rtl.createCallback(this,"StrokeChanged"),this.FFont=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFont.$create("Create$2"),this.FFont.FOnChanged=rtl.createCallback(this,"FontChanged"),this.FText="Off",this},this.Destroy=function(){rtl.free(this,"FFill"),rtl.free(this,"FStroke"),rtl.free(this,"FFont"),pas.System.TObject.Destroy.call(this)},this.Assign=function(e){t.TTMSFNCCustomSwitchAppearanceOff.isPrototypeOf(e)?(this.FFill.Assign(rtl.as(e,t.TTMSFNCCustomSwitchAppearanceOff).FFill),this.FStroke.Assign(rtl.as(e,t.TTMSFNCCustomSwitchAppearanceOff).FStroke),this.FFont.AssignSource(rtl.as(e,t.TTMSFNCCustomSwitchAppearanceOff).FFont),this.FText=rtl.as(e,t.TTMSFNCCustomSwitchAppearanceOff).FText):pas.Classes.TPersistent.Assign.apply(this,arguments)};var e=this.$rtti;e.addProperty("Fill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FFill","SetFill"),e.addProperty("Stroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FStroke","SetStroke"),e.addProperty("Font",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFont,"FFont","SetFont"),e.addProperty("Text",14,rtl.string,"FText","SetText",{stored:"IsTextStored"}),e.addProperty("OnChange",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnChange","FOnChange")})),rtl.createClass(this,"TTMSFNCCustomSwitchAppearanceOn",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FOnChange=null,this.FFill=null,this.FStroke=null,this.FText="",this.FFont=null},this.$final=function(){this.FOnChange=void 0,this.FFill=void 0,this.FStroke=void 0,this.FFont=void 0,pas.Classes.TPersistent.$final.call(this)},this.SetFill=function(t){this.FFill.Assign(t)},this.SetStroke=function(t){this.FStroke.Assign(t)},this.SetText=function(t){this.FText!==t&&(this.FText=t,this.Changed())},this.IsTextStored=function(){return"On"!==this.FText},this.SetFont=function(t){this.FFont.AssignSource(t)},this.Changed=function(){null!=this.FOnChange&&this.FOnChange(this)},this.FillChanged=function(t){this.Changed()},this.StrokeChanged=function(t){this.Changed()},this.FontChanged=function(t){this.Changed()},this.Create$1=function(){return this.FFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[1,16748574,8421504,-1,-1]),this.FFill.FOnChanged=rtl.createCallback(this,"FillChanged"),this.FStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,12632256]),this.FStroke.FOnChanged=rtl.createCallback(this,"StrokeChanged"),this.FFont=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFont.$create("Create$2"),this.FFont.FOnChanged=rtl.createCallback(this,"FontChanged"),this.FText="On",this},this.Destroy=function(){rtl.free(this,"FFill"),rtl.free(this,"FStroke"),rtl.free(this,"FFont"),pas.System.TObject.Destroy.call(this)},this.Assign=function(e){t.TTMSFNCCustomSwitchAppearanceOn.isPrototypeOf(e)?(this.FFill.Assign(rtl.as(e,t.TTMSFNCCustomSwitchAppearanceOn).FFill),this.FStroke.Assign(rtl.as(e,t.TTMSFNCCustomSwitchAppearanceOn).FStroke),this.FFont.AssignSource(rtl.as(e,t.TTMSFNCCustomSwitchAppearanceOn).FFont),this.FText=rtl.as(e,t.TTMSFNCCustomSwitchAppearanceOn).FText):pas.Classes.TPersistent.Assign.apply(this,arguments)};var e=this.$rtti;e.addProperty("Fill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FFill","SetFill"),e.addProperty("Stroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FStroke","SetStroke"),e.addProperty("Font",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFont,"FFont","SetFont"),e.addProperty("Text",14,rtl.string,"FText","SetText",{stored:"IsTextStored"}),e.addProperty("OnChange",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnChange","FOnChange")})),rtl.createClass(this,"TTMSFNCCustomSwitchButtonAppearance",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FOnChange=null,this.FFill=null,this.FStroke=null,this.FMargin=0,this.FOffFill=null,this.FOffStroke=null},this.$final=function(){this.FOnChange=void 0,this.FFill=void 0,this.FStroke=void 0,this.FOffFill=void 0,this.FOffStroke=void 0,pas.Classes.TPersistent.$final.call(this)},this.SetFill=function(t){this.FFill.Assign(t)},this.SetStroke=function(t){this.FStroke.Assign(t)},this.SetMargin=function(t){this.FMargin!==t&&(this.FMargin=t,this.Changed())},this.IsMarginStored=function(){return 3!==this.FMargin},this.SetOffFill=function(t){this.FOffFill.Assign(t)},this.SetOffStroke=function(t){this.FOffStroke.Assign(t)},this.Changed=function(){null!=this.FOnChange&&this.FOnChange(this)},this.FillChanged=function(t){this.Changed()},this.StrokeChanged=function(t){this.Changed()},this.Create$1=function(){return this.FMargin=3,this.FFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[1,16777215,8421504,-1,-1]),this.FFill.FOnChanged=rtl.createCallback(this,"FillChanged"),this.FOffFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[1,16777215,8421504,-1,-1]),this.FOffFill.FOnChanged=rtl.createCallback(this,"FillChanged"),this.FStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,12632256]),this.FStroke.FOnChanged=rtl.createCallback(this,"StrokeChanged"),this.FOffStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,12632256]),this.FOffStroke.FOnChanged=rtl.createCallback(this,"StrokeChanged"),this},this.Destroy=function(){rtl.free(this,"FFill"),rtl.free(this,"FStroke"),rtl.free(this,"FOffFill"),rtl.free(this,"FOffStroke"),pas.System.TObject.Destroy.call(this)},this.Assign=function(e){t.TTMSFNCCustomSwitchButtonAppearance.isPrototypeOf(e)?(this.FFill.Assign(rtl.as(e,t.TTMSFNCCustomSwitchButtonAppearance).FFill),this.FOffFill.Assign(rtl.as(e,t.TTMSFNCCustomSwitchButtonAppearance).FOffFill),this.FStroke.Assign(rtl.as(e,t.TTMSFNCCustomSwitchButtonAppearance).FStroke),this.FOffStroke.Assign(rtl.as(e,t.TTMSFNCCustomSwitchButtonAppearance).FOffStroke),this.FMargin=rtl.as(e,t.TTMSFNCCustomSwitchButtonAppearance).FMargin):pas.Classes.TPersistent.Assign.apply(this,arguments)};var e=this.$rtti;e.addProperty("Margin",14,rtl.double,"FMargin","SetMargin",{stored:"IsMarginStored"}),e.addProperty("OffFill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FOffFill","SetOffFill"),e.addProperty("OffStroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FOffStroke","SetOffStroke"),e.addProperty("Fill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FFill","SetFill"),e.addProperty("Stroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FStroke","SetStroke"),e.addProperty("OnChange",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnChange","FOnChange")})),this.$rtti.$MethodVar("TTMSFNCCustomSwitchBeforeDrawSwitchEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["ASwitchState",this.$rtti.TTMSFNCCustomSwitchState],["AAllow",rtl.boolean,1],["ADefaultDraw",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCCustomSwitchAfterDrawSwitchEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["ASwitchState",this.$rtti.TTMSFNCCustomSwitchState]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCCustomSwitchBeforeDrawSwitchButtonEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["ASwitchState",this.$rtti.TTMSFNCCustomSwitchState],["AAllow",rtl.boolean,1],["ADefaultDraw",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCCustomSwitchAfterDrawSwitchButtonEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["ASwitchState",this.$rtti.TTMSFNCCustomSwitchState]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCCustomSwitchStateChangeEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ASwitchState",this.$rtti.TTMSFNCCustomSwitchState]]),methodkind:0}),rtl.createClass(this,"TTMSFNCCustomSwitch",pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl,(function(){this.$init=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.$init.call(this),this.FButtonPos=0,this.FPosTo=0,this.FMouseDown=!1,this.FMouseDownButton=!1,this.FOrientation=0,this.FAppearanceOff=null,this.FAppearanceOn=null,this.FButtonAppearance=null,this.FRounded=!1,this.FLayout=0,this.FSwitchState=0,this.FSwitchTimer=null,this.FAnimationFactor=0,this.FDoAnimation=!1,this.FOnAfterDrawSwitch=null,this.FOnAfterDrawSwitchButton=null,this.FOnBeforeDrawSwitch=null,this.FOnBeforeDrawSwitchButton=null,this.FOnStateChange=null,this.FOnChange=null,this.FGlobalFont=null},this.$final=function(){this.FAppearanceOff=void 0,this.FAppearanceOn=void 0,this.FButtonAppearance=void 0,this.FSwitchTimer=void 0,this.FOnAfterDrawSwitch=void 0,this.FOnAfterDrawSwitchButton=void 0,this.FOnBeforeDrawSwitch=void 0,this.FOnBeforeDrawSwitchButton=void 0,this.FOnStateChange=void 0,this.FOnChange=void 0,this.FGlobalFont=void 0,pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.$final.call(this)},this.SetOrientation=function(t){this.FOrientation!==t&&(this.FOrientation=t,rtl.eqSet(rtl.intersectSet(this.FComponentState,rtl.createSet(0,6)),{})&&this.SetBounds(this.GetLeft(),this.GetTop(),this.GetHeight(),this.GetWidth()),this.Changed())},this.SetAppearanceOff=function(t){this.FAppearanceOff.Assign(t)},this.SetAppearanceOn=function(t){this.FAppearanceOn.Assign(t)},this.SetButtonAppearance=function(t){this.FButtonAppearance.Assign(t)},this.SetRounded=function(t){this.FRounded!==t&&(this.FRounded=t,this.Changed())},this.SetLayout=function(t){this.FLayout!==t&&(this.FLayout=t,this.Changed())},this.SetSwitchState=function(t){if(this.FSwitchState!==t){this.FSwitchState=t;var e=t;1===e?(this.FPosTo=this.GetButtonOnPos(),this.FButtonPos=this.GetButtonOnPos()):0===e&&(this.FPosTo=this.GetButtonOffPos(),this.FButtonPos=this.GetButtonOffPos()),this.DoStateChange(t),this.Changed()}},this.SetAnimationFactor=function(t){this.FAnimationFactor!==t&&(this.FAnimationFactor=t,this.Changed())},this.SetGlobalFont=function(t){this.FGlobalFont.Assign(t)},this.ApplyStyle=function(){var t=0;pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.ApplyStyle.call(this),t=-1,pas["WEBLib.TMSFNCStyles"].TTMSFNCStyles.GetStyleBackgroundFillColor({get:function(){return t},set:function(e){t=e}})&&(this.FAppearanceOff.FFill.SetKind(1),this.FAppearanceOff.FFill.SetColor(t),this.FButtonAppearance.FFill.SetKind(1),this.FButtonAppearance.FFill.SetColor(t)),t=-1,pas["WEBLib.TMSFNCStyles"].TTMSFNCStyles.GetStyleSelectionFillColorTo({get:function(){return t},set:function(e){t=e}})&&(this.FAppearanceOn.FFill.SetKind(1),this.FAppearanceOn.FFill.SetColor(t)),t=-1,pas["WEBLib.TMSFNCStyles"].TTMSFNCStyles.GetStyleTextFontColor({get:function(){return t},set:function(e){t=e}})&&(this.FAppearanceOn.FFont.SetColor(t),this.FAppearanceOff.FFont.SetColor(t)),t=-1,pas["WEBLib.TMSFNCStyles"].TTMSFNCStyles.GetStyleLineFillColor({get:function(){return t},set:function(e){t=e}})&&(this.FAppearanceOff.FStroke.SetKind(1),this.FAppearanceOff.FStroke.SetColor(t),this.FAppearanceOn.FStroke.SetKind(1),this.FAppearanceOn.FStroke.SetColor(t),this.FButtonAppearance.FStroke.SetKind(1),this.FButtonAppearance.FStroke.SetColor(t)),t=-1,pas["WEBLib.TMSFNCStyles"].TTMSFNCStyles.GetStyleDefaultButtonFillColor({get:function(){return t},set:function(e){t=e}})&&(this.FButtonAppearance.FOffFill.SetKind(1),this.FButtonAppearance.FOffFill.SetColor(t)),t=-1,pas["WEBLib.TMSFNCStyles"].TTMSFNCStyles.GetStyleDefaultButtonStrokeColor({get:function(){return t},set:function(e){t=e}})&&(this.FButtonAppearance.FOffStroke.SetKind(1),this.FButtonAppearance.FOffStroke.SetColor(t))},this.ResetToDefaultStyle=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.ResetToDefaultStyle.call(this),this.FAppearanceOff.FFill.SetColor(16777215),this.FAppearanceOn.FFill.SetColor(16748574),this.FAppearanceOn.FFont.SetColor(0),this.FAppearanceOff.FFont.SetColor(0),this.FAppearanceOff.FStroke.SetColor(12632256),this.FAppearanceOn.FStroke.SetColor(12632256),this.FButtonAppearance.FFill.SetColor(16777215),this.FButtonAppearance.FStroke.SetColor(12632256)},this.GetVersion=function(){return this.$class.GetVersionNumber(1,0,3,0)},this.Draw=function(t,e){this.DrawSwitchBackground(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e)),this.DrawSwitchButton(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e))},this.DrawSwitchBackground=function(t,e){var i=0,s=0,o=0,n=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),r=!1,a=!1,l=0;o=0;var h=this.FOrientation;if(0===h?o=e.Right-e.Left:1===h&&(o=e.Bottom-e.Top),s=0,1===this.FOrientation&&(s=-90),this.FRounded){i=0;var F=this.FOrientation;0===F?i=(e.Bottom-e.Top)/2:1===F&&(i=(e.Right-e.Left)/2)}else i=1;this.FButtonPos<o/2?(t.FFill.Assign(this.FAppearanceOff.FFill),t.FStroke.Assign(this.FAppearanceOff.FStroke)):(t.FFill.Assign(this.FAppearanceOn.FFill),t.FStroke.Assign(this.FAppearanceOn.FStroke)),r=!0,a=!0,this.DoBeforeDrawSwitch(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),this.FSwitchState,{get:function(){return r},set:function(t){r=t}},{get:function(){return a},set:function(t){a=t}}),r&&(a&&(t.DrawRoundRectangle$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i-1,rtl.createSet(0,1,2,3),2),1===this.FLayout&&(l=this.GetButtonOnPos(),this.FButtonPos!==l&&(n.$assign(this.GetOffTextRect()),t.FFont.AssignSource(this.FAppearanceOff.FFont),t.DrawText$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(n),this.FAppearanceOff.FText,!1,0,0,0,s,-1,-1,!0,!1,-1,-1)),l=this.GetButtonOffPos(),this.FButtonPos!==l&&(n.$assign(this.GetOnTextRect()),t.FFont.AssignSource(this.FAppearanceOn.FFont),t.DrawText$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(n),this.FAppearanceOn.FText,!1,0,0,0,s,-1,-1,!0,!1,-1,-1)))),this.DoAfterDrawSwitch(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),this.FSwitchState))},this.DrawSwitchButton=function(t,e){var i=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),s=0,o=0,n=!1,r=!1;o=0;var a=this.FOrientation;if(0===a?o=e.Right-e.Left:1===a&&(o=e.Bottom-e.Top),this.FButtonPos<o/2?(t.FFill.Assign(this.FButtonAppearance.FOffFill),t.FStroke.Assign(this.FButtonAppearance.FOffStroke)):(t.FFill.Assign(this.FButtonAppearance.FFill),t.FStroke.Assign(this.FButtonAppearance.FStroke)),i.$assign(this.GetSwitchButtonRect()),s=this.FButtonAppearance.FMargin+1,this.FRounded){var l=this.FOrientation;0===l?s=(e.Bottom-e.Top)/2:1===l&&(s=(e.Right-e.Left)/2)}n=!0,r=!0,this.DoBeforeDrawSwtichButton(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),this.FSwitchState,{get:function(){return n},set:function(t){n=t}},{get:function(){return r},set:function(t){r=t}}),n&&(r&&t.DrawRoundRectangle$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),s-this.FButtonAppearance.FMargin-1,rtl.createSet(0,1,2,3),0),this.DoAfterDrawSwitchButton(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),this.FSwitchState))},this.HandleMouseDown=function(t,e,i,s){var o=pas["WEBLib.TMSFNCTypes"].TRectF.$new();pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleMouseDown.apply(this,arguments),o.$assign(this.GetSwitchButtonRect()),pas["WEBLib.TMSFNCTypes"].PtInRectEx(o,pas["WEBLib.TMSFNCTypes"].PointF(i,s))?(this.FMouseDown=!0,this.CaptureEx()):this.FMouseDownButton=!0},this.HandleMouseUp=function(t,e,i,s){if(pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleMouseUp.apply(this,arguments),this.FMouseDown){var o=this.FOrientation;0===o?i>this.GetWidth()/2?(this.FPosTo=this.GetButtonOnPos(),this.FSwitchState=1,this.DoStateChange(1)):(this.FPosTo=this.GetButtonOffPos(),this.FSwitchState=0,this.DoStateChange(0)):1===o&&(s<this.GetHeight()/2?(this.FPosTo=this.GetButtonOnPos(),this.FSwitchState=1,this.DoStateChange(1)):(this.FPosTo=this.GetButtonOffPos(),this.FSwitchState=0,this.DoStateChange(0))),this.FDoAnimation=!0,this.FMouseDown=!1,this.ReleaseCaptureEx(),this.Changed()}else if(this.FMouseDownButton){var n=this.FSwitchState;0===n?(this.FSwitchState=1,this.FPosTo=this.GetButtonOnPos(),this.DoStateChange(1)):1===n&&(this.FSwitchState=0,this.FPosTo=this.GetButtonOffPos(),this.DoStateChange(0)),this.FDoAnimation=!0,this.FMouseDownButton=!1,this.Changed()}},this.HandleMouseMove=function(t,e,i){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleMouseMove.apply(this,arguments),this.FMouseDown&&1===this.FLayout&&(this.FButtonPos=this.CalculateButtonPosition(e,i),this.Invalidate())},this.DoBeforeDrawSwitch=function(t,e,i,s,o){null!=this.FOnBeforeDrawSwitch&&this.FOnBeforeDrawSwitch(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i,s,o)},this.DoAfterDrawSwitch=function(t,e,i){null!=this.FOnAfterDrawSwitch&&this.FOnAfterDrawSwitch(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i)},this.DoBeforeDrawSwtichButton=function(t,e,i,s,o){null!=this.FOnBeforeDrawSwitchButton&&this.FOnBeforeDrawSwitchButton(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i,s,o)},this.DoAfterDrawSwitchButton=function(t,e,i){null!=this.FOnAfterDrawSwitchButton&&this.FOnAfterDrawSwitchButton(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i)},this.DoStateChange=function(t){null!=this.FOnStateChange&&this.FOnStateChange(this,t)},this.DoSwitchTimer=function(t){var i=0,s=0;this.FMouseDown||this.FDoAnimation&&(s=Math.abs(this.FButtonPos-this.FPosTo)/this.FAnimationFactor,i=this.FButtonPos,e.AnimateDouble({get:function(){return i},set:function(t){i=t}},{p:this,get:function(){return this.p.FPosTo},set:function(t){this.p.FPosTo=t}},s,.01)?(this.FButtonPos=i,this.Invalidate()):this.FDoAnimation=!1)},this.UpdateControlAfterResize=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.UpdateControlAfterResize.call(this),this.FButtonPos=this.GetButtonPos(),this.FPosTo=this.GetButtonOffPos()},this.AppearanceChanged=function(t){this.Changed()},this.Changed=function(){null!=this.FOnChange&&this.FOnChange(this),this.Invalidate()},this.GetSwitchButtonRect=function(){var t,e,i=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),s=0;s=0;var o=this.FOrientation;0===o?s=this.GetControlRect().Bottom-this.GetContentRect().Top:1===o&&(s=this.GetContentRect().Right-this.GetContentRect().Left),t=s/2,e=this.FButtonAppearance.FMargin+this.FButtonAppearance.FStroke.FWidth/2;var n=this.FOrientation;return 0===n?i.$assign(pas["WEBLib.TMSFNCTypes"].RectF(this.FButtonPos-t,this.GetContentRect().Top,this.FButtonPos+t,this.GetControlRect().Bottom)):1===n&&i.$assign(pas["WEBLib.TMSFNCTypes"].RectF(this.GetContentRect().Left,this.FButtonPos-t,this.GetContentRect().Right,this.FButtonPos+t)),pas["WEBLib.TMSFNCTypes"].InflateRectEx(i,-e,-e),i},this.CalculateButtonPosition=function(t,e){var i,s=0,o=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),n=pas["WEBLib.TMSFNCTypes"].TRectF.$new();s=-1,n.$assign(this.GetSwitchButtonRect()),i=this.FButtonAppearance.FMargin+this.FButtonAppearance.FStroke.FWidth/2+(n.Right-n.Left)/2,o.$assign(this.GetControlRect());var r=this.FOrientation;return 0===r?s=o.Left+i>=t?o.Left+i:o.Right-i<=t?o.Right-i:t:1===r&&(s=o.Top+i>=e?o.Top+i:o.Bottom-i<=e?o.Bottom-i:e),s},this.GetButtonPos=function(){var t=0;t=0;var e=this.FSwitchState;return 0===e?t=this.GetButtonOffPos():1===e&&(t=this.GetButtonOnPos()),t},this.GetButtonOffPos=function(){var t,e=0,i=pas["WEBLib.TMSFNCTypes"].TRectF.$new();e=0,i.$assign(this.GetSwitchButtonRect()),t=this.FButtonAppearance.FMargin+this.FButtonAppearance.FStroke.FWidth/2+(i.Right-i.Left)/2;var s=this.FOrientation;return 0===s?e=this.GetControlRect().Left+t:1===s&&(e=this.GetControlRect().Bottom-t),e},this.GetButtonOnPos=function(){var t,e=0,i=pas["WEBLib.TMSFNCTypes"].TRectF.$new();e=0,i.$assign(this.GetSwitchButtonRect()),t=this.FButtonAppearance.FMargin+this.FButtonAppearance.FStroke.FWidth/2+(i.Right-i.Left)/2;var s=this.FOrientation;return 0===s?e=this.GetControlRect().Right-t:1===s&&(e=this.GetControlRect().Top+t),e},this.GetOffTextRect=function(){var t=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),e=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),i=0;t.$assign(pas["WEBLib.TMSFNCTypes"].RectF(0,0,0,0)),e.$assign(this.GetSwitchButtonRect());var s=this.FOrientation;return 0===s?(i=e.Right-e.Left,t.$assign(pas["WEBLib.TMSFNCTypes"].RectF(e.Right,this.GetControlRect().Top,e.Right+(this.GetControlRect().Right-i),this.GetControlRect().Bottom))):1===s&&(i=this.GetControlRect().Bottom-this.GetControlRect().Top-(e.Bottom-e.Top),t.$assign(pas["WEBLib.TMSFNCTypes"].RectF(this.GetControlRect().Left,e.Top-i,this.GetControlRect().Right,e.Top))),t},this.GetOnTextRect=function(){var t=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),e=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),i=0;t.$assign(pas["WEBLib.TMSFNCTypes"].RectF(0,0,0,0)),e.$assign(this.GetSwitchButtonRect());var s=this.FOrientation;return 0===s?(i=this.GetControlRect().Right-this.GetControlRect().Left-(e.Right-e.Left),t.$assign(pas["WEBLib.TMSFNCTypes"].RectF(e.Left-i,this.GetControlRect().Top,e.Left,this.GetControlRect().Bottom))):1===s&&(i=this.GetControlRect().Bottom-this.GetControlRect().Top-(e.Bottom-e.Top),t.$assign(pas["WEBLib.TMSFNCTypes"].RectF(this.GetControlRect().Left,e.Bottom,this.GetControlRect().Right,e.Bottom+i))),t},this.SetFonts=function(t){this.BeginUpdate(),this.FGlobalFont.ApplyChange(this.FAppearanceOff.FFont,t),this.FGlobalFont.ApplyChange(this.FAppearanceOn.FFont,t),this.EndUpdate()},this.Create$1=function(e){return pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Create$1.apply(this,arguments),this.FMouseDown=!1,this.FSwitchState=0,this.FAnimationFactor=8,this.FMouseDownButton=!1,this.FAppearanceOff=t.TTMSFNCCustomSwitchAppearanceOff.$create("Create$1"),this.FAppearanceOff.FOnChange=rtl.createCallback(this,"AppearanceChanged"),this.FAppearanceOn=t.TTMSFNCCustomSwitchAppearanceOn.$create("Create$1"),this.FAppearanceOn.FOnChange=rtl.createCallback(this,"AppearanceChanged"),this.FButtonAppearance=t.TTMSFNCCustomSwitchButtonAppearance.$create("Create$1"),this.FButtonAppearance.FOnChange=rtl.createCallback(this,"AppearanceChanged"),this.FButtonPos=this.GetButtonOffPos(),this.FPosTo=this.GetButtonOffPos(),this.SetWidth(75),this.SetHeight(25),this.FFill.SetColor(-1),this.FStroke.SetColor(-1),this.FDoAnimation=!1,this.FGlobalFont=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCAppearanceGlobalFont.$create("Create$1",[this]),this.FSwitchTimer=pas["WEBLib.ExtCtrls"].TTimer.$create("Create$1",[this]),this.FSwitchTimer.SetInterval(10),this.FSwitchTimer.FOnTimer=rtl.createCallback(this,"DoSwitchTimer"),this.FSwitchTimer.SetEnabled(!0),this},this.Destroy=function(){rtl.free(this,"FGlobalFont"),rtl.free(this,"FAppearanceOff"),rtl.free(this,"FAppearanceOn"),rtl.free(this,"FButtonAppearance"),pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Destroy.call(this)},rtl.addIntf(this,pas["WEBLib.TMSFNCGraphicsTypes"].ITMSFNCAppearanceGlobalFont),rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas["WEBLib.TMSFNCTypes"].ITMSFNCProductInfo),rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TTMSFNCSwitch",this.TTMSFNCCustomSwitch,(function(){rtl.addIntf(this,pas["WEBLib.TMSFNCGraphicsTypes"].ITMSFNCAppearanceGlobalFont),rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas["WEBLib.TMSFNCTypes"].ITMSFNCProductInfo),rtl.addIntf(this,pas.System.IUnknown);var e=this.$rtti;e.addProperty("AppearanceOff",2,t.$rtti.TTMSFNCCustomSwitchAppearanceOff,"FAppearanceOff","SetAppearanceOff"),e.addProperty("AppearanceOn",2,t.$rtti.TTMSFNCCustomSwitchAppearanceOn,"FAppearanceOn","SetAppearanceOn"),e.addProperty("ButtonAppearance",2,t.$rtti.TTMSFNCCustomSwitchButtonAppearance,"FButtonAppearance","SetButtonAppearance"),e.addProperty("AnimationFactor",2,rtl.longint,"FAnimationFactor","SetAnimationFactor",{Default:15}),e.addProperty("State",2,t.$rtti.TTMSFNCCustomSwitchState,"FSwitchState","SetSwitchState",{Default:t.TTMSFNCCustomSwitchState.ssOff}),e.addProperty("Layout",2,t.$rtti.TTMSFNCCustomSwitchLayout,"FLayout","SetLayout",{Default:t.TTMSFNCCustomSwitchLayout.sloSimple}),e.addProperty("Orientation",2,t.$rtti.TTMSFNCCustomSwitchOrientation,"FOrientation","SetOrientation",{Default:t.TTMSFNCCustomSwitchOrientation.soHorizontal}),e.addProperty("Rounded",2,rtl.boolean,"FRounded","SetRounded",{Default:!1}),e.addProperty("GlobalFont",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCAppearanceGlobalFont,"FGlobalFont","SetGlobalFont"),e.addProperty("OnBeforeDrawSwitch",0,t.$rtti.TTMSFNCCustomSwitchBeforeDrawSwitchEvent,"FOnBeforeDrawSwitch","FOnBeforeDrawSwitch"),e.addProperty("OnAfterDrawSwitch",0,t.$rtti.TTMSFNCCustomSwitchAfterDrawSwitchEvent,"FOnAfterDrawSwitch","FOnAfterDrawSwitch"),e.addProperty("OnBeforeDrawSwitchButton",0,t.$rtti.TTMSFNCCustomSwitchBeforeDrawSwitchButtonEvent,"FOnBeforeDrawSwitchButton","FOnBeforeDrawSwitchButton"),e.addProperty("OnAfterDrawSwitchButton",0,t.$rtti.TTMSFNCCustomSwitchAfterDrawSwitchButtonEvent,"FOnAfterDrawSwitchButton","FOnAfterDrawSwitchButton"),e.addProperty("OnStateChange",0,t.$rtti.TTMSFNCCustomSwitchStateChangeEvent,"FOnStateChange","FOnStateChange"),e.addProperty("OnChange",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnChange","FOnChange"),e.attr=[pas.Classes.ComponentPlatformsAttribute,"Create$1",[0]]})),t.$implcode=function(){e.AnimateDouble=function(t,e,i,s){var o=!1;return o=!0,t.get()>e.get()-s&&t.get()<e.get()+s?(t.set(e.get()),o=!1):(i=Math.max(s,i),t.get()<e.get()?t.set(t.get()+i):t.set(t.get()-i)),o}}}),["Math","WEBLib.TMSFNCStyles","WEBLib.TMSFNCUtils"]),rtl.module("WebLib.SEFNC.CVLoggerViewer",["System","Classes","SysUtils","Generics.Collections","WEBLib.TMSFNCTreeView","WEBLib.TMSFNCTreeViewData","WEBLib.TMSFNCSwitch","WEBLib.TMSFNCToolBar","WEBLib.TMSFNCPageControl","WEBLib.TMSFNCCheckGroup","WEBLib.ExtCtrls","WEBLib.Controls","WebLib.SEFNC.Layout","WebLib.SEFNC.Logger"],(function(){"use strict";rtl.createClass(this,"TSEFNCLoggerViewer",pas.System.TObject,(function(){this.$init=function(){pas.System.TObject.$init.call(this),this.FOwner=null,this.FHistoryCounter=0,this.FTreeView=null,this.FViewerContainer=null,this.FToolPanel=null,this.FSwitchEnable=null,this.FToolBar=null,this.FPage=null,this.FCgLevelsActive=null,this.FTimer=null},this.$final=function(){this.FOwner=void 0,this.FTreeView=void 0,this.FViewerContainer=void 0,this.FToolPanel=void 0,this.FSwitchEnable=void 0,this.FToolBar=void 0,this.FPage=void 0,this.FCgLevelsActive=void 0,this.FTimer=void 0,pas.System.TObject.$final.call(this)},this.InitTree=function(){var t=this,e=null;function i(i){(e=t.FTreeView.FColumns.Add$1()).SetText(i),e.FFiltering.SetEnabled(!0),e.FFiltering.FMultiColumn=!0,e.FFiltering.FDropDownWidth=200,e.FFiltering.SetButtonSize(Math.round(20*pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.GetDPIScale(t.FTreeView,-1)))}this.FTreeView.ClearColumns(),this.FTreeView.ClearNodes(),(e=this.FTreeView.FColumns.Add$1()).SetText("DTS"),i("Level"),(e=this.FTreeView.FColumns.Add$1()).SetText("Message"),i("Class"),e.SetWidth(150),i("Unit"),this.FTreeView.FInteraction.FAnimationFactor=1.1,this.FTreeView.FInteraction.SetColumnSizing(!0),this.FTreeView.FInteraction.SetColumnAutoSizeOnDblClick(!0),this.FTreeView.FColumnsAppearance.SetStretch(!0),this.FTreeView.FColumnsAppearance.SetStretchColumn(2),this.FTreeView.FColumnsAppearance.FTopStroke.SetKind(1),this.FTreeView.FNodesAppearance.FExtendedFill.SetColor(14804223),this.FTreeView.SetStretchScrollBars(!1)},this.InitViewer=function(){var t=null,e=0,i=0,s=rtl.createIntfRefs();try{for(this.FToolPanel=pas["WebLib.SEFNC.Layout"].TSEFNCLayout.$create("Create$1",[this.FOwner]),this.FToolPanel.SetParent(this.FViewerContainer),this.FToolPanel.SetAlign(pas["WebLib.SEFNC.Layout"].TSEFNCAlign.GetAlign(1)),this.FToolPanel.SetHeight(Math.round(48*pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.GetDPIScale(this.FOwner,-1))),this.FSwitchEnable=pas["WEBLib.TMSFNCSwitch"].TTMSFNCSwitch.$create("Create$1",[this.FOwner]),this.FSwitchEnable.SetParent(this.FToolPanel),this.FSwitchEnable.SetAlign(pas["WebLib.SEFNC.Layout"].TSEFNCAlign.GetAlign(3)),this.FSwitchEnable.SetLayout(1),this.FToolBar=pas["WEBLib.TMSFNCToolBar"].TTMSFNCToolBar.$create("Create$1",[this.FOwner]),this.FToolBar.SetParent(this.FToolPanel),this.FToolBar.SetAlign(pas["WebLib.SEFNC.Layout"].TSEFNCAlign.GetAlign(5)),this.FToolBar.FOptionsMenu.SetShowButton(!1),(t=this.FToolBar.AddButton(-1,-1,"","","",-1)).SetLayout(2),t.SetText("Clear"),t.FOnClick=rtl.createCallback(this,"OnClearClick"),t.SetWidth(t.GetWidth()+16),this.FCgLevelsActive=pas["WEBLib.TMSFNCCheckGroup"].TTMSFNCCheckGroup.$create("Create$1",[this.FOwner]),this.FCgLevelsActive.SetParent(this.FToolPanel),this.FCgLevelsActive.FOnCheckBoxClick=null,this.FCgLevelsActive.FItems.Clear(),i=0;i<=5;i++)e=this.FCgLevelsActive.FItems.Add(pas["WebLib.SEFNC.Logger"].SEFNCLogLevels[i]),i in s.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).LoggerLevelGet()&&this.FCgLevelsActive.SetChecked(e,!0);this.FCgLevelsActive.FOnCheckBoxClick=rtl.createCallback(this,"OnCgLevelsActiveCheckBoxClick"),(t=this.FToolBar.AddButton(-1,-1,"","","",-1)).SetLayout(2),t.SetText("Log Levels"),t.SetWidth(t.GetWidth()+32),t.SetDropDownControl(this.FCgLevelsActive),t.SetDropDownKind(1),this.FTreeView=pas["WEBLib.TMSFNCTreeView"].TTMSFNCTreeView.$create("Create$1",[this.FOwner]),this.FTreeView.SetParent(this.FViewerContainer),this.FTreeView.SetAlign(pas["WebLib.SEFNC.Layout"].TSEFNCAlign.GetAlign(5)),this.InitTree(),this.FTimer=pas["WEBLib.ExtCtrls"].TWebTimer.$create("Create$1",[this.FOwner]),this.FTimer.SetEnabled(!1),this.FTimer.FOnTimer=rtl.createCallback(this,"OnTimer"),this.FHistoryCounter=0,this.FSwitchEnable.FOnChange=rtl.createCallback(this,"OnSwitchEnabledChange")}finally{s.free()}},this.QueueToTree=function(t){var e=null,i=0,s=null,o=null;try{this.FTreeView.BeginUpdate();for(var n=0,r=t.FLength-1;n<=r;n++)i=n,e=t.GetItem(i),(s=this.FTreeView.AddNode(null)).SetText(0,e.DispDTS(!1)),s.SetText(1,e.DispLogLevel()),s.SetText(2,e.Msg),s.SetText(3,e.FSrcClassName),s.SetText(4,e.FSrcUnitName),s.SetIndex(0),e.IsException()&&((o=this.FTreeView.AddNode(s)).SetText(0,"Ex Message :"+e.FExceptionMsg),o.SetExtended(!0),s.SetExpanded(!0))}finally{this.FTreeView.EndUpdate()}},this.OnTimer=function(t){var e=null,i=null,s=rtl.createIntfRefs();try{this.FTimer.SetEnabled(!1),e=pas.Classes.TStringList.$create("Create$1"),i=pas["Generics.Collections"].TList$G10.$create("Create$1");try{s.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).LogQueueList(this.FHistoryCounter,{get:function(){return i},set:function(t){i=t}})&&(this.QueueToTree(i),this.FHistoryCounter=this.FHistoryCounter+i.FLength)}finally{e=rtl.freeLoc(e),this.FTimer.SetEnabled(!0),i=rtl.freeLoc(i)}}finally{s.free()}},this.OnSwitchEnabledChange=function(t){var e=this.FSwitchEnable.FSwitchState;0===e?this.FTimer.SetEnabled(!1):1===e&&this.FTimer.SetEnabled(!0)},this.OnClearClick=function(t){this.FTreeView.ClearNodes()},this.OnCgLevelsActiveCheckBoxClick=function(t,e,i){var s=rtl.createIntfRefs();try{var o=e;0===o?this.FCgLevelsActive.GetChecked(e)?s.ref(2,pas["WebLib.SEFNC.Logger"].Logger()).LoggerLevelSet(rtl.unionSet(s.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).LoggerLevelGet(),rtl.createSet(0))):s.ref(4,pas["WebLib.SEFNC.Logger"].Logger()).LoggerLevelSet(rtl.diffSet(s.ref(3,pas["WebLib.SEFNC.Logger"].Logger()).LoggerLevelGet(),rtl.createSet(0))):1===o?this.FCgLevelsActive.GetChecked(e)?s.ref(6,pas["WebLib.SEFNC.Logger"].Logger()).LoggerLevelSet(rtl.unionSet(s.ref(5,pas["WebLib.SEFNC.Logger"].Logger()).LoggerLevelGet(),rtl.createSet(1))):s.ref(8,pas["WebLib.SEFNC.Logger"].Logger()).LoggerLevelSet(rtl.diffSet(s.ref(7,pas["WebLib.SEFNC.Logger"].Logger()).LoggerLevelGet(),rtl.createSet(1))):2===o?this.FCgLevelsActive.GetChecked(e)?s.ref(10,pas["WebLib.SEFNC.Logger"].Logger()).LoggerLevelSet(rtl.unionSet(s.ref(9,pas["WebLib.SEFNC.Logger"].Logger()).LoggerLevelGet(),rtl.createSet(2))):s.ref(12,pas["WebLib.SEFNC.Logger"].Logger()).LoggerLevelSet(rtl.diffSet(s.ref(11,pas["WebLib.SEFNC.Logger"].Logger()).LoggerLevelGet(),rtl.createSet(2))):3===o?this.FCgLevelsActive.GetChecked(e)?s.ref(14,pas["WebLib.SEFNC.Logger"].Logger()).LoggerLevelSet(rtl.unionSet(s.ref(13,pas["WebLib.SEFNC.Logger"].Logger()).LoggerLevelGet(),rtl.createSet(3))):s.ref(16,pas["WebLib.SEFNC.Logger"].Logger()).LoggerLevelSet(rtl.diffSet(s.ref(15,pas["WebLib.SEFNC.Logger"].Logger()).LoggerLevelGet(),rtl.createSet(3))):4===o&&(this.FCgLevelsActive.GetChecked(e)?s.ref(18,pas["WebLib.SEFNC.Logger"].Logger()).LoggerLevelSet(rtl.unionSet(s.ref(17,pas["WebLib.SEFNC.Logger"].Logger()).LoggerLevelGet(),rtl.createSet(4))):s.ref(20,pas["WebLib.SEFNC.Logger"].Logger()).LoggerLevelSet(rtl.diffSet(s.ref(19,pas["WebLib.SEFNC.Logger"].Logger()).LoggerLevelGet(),rtl.createSet(4))))}finally{s.free()}},this.ActiveSet=function(t){t?this.FSwitchEnable.SetSwitchState(1):this.FSwitchEnable.SetSwitchState(0)},this.Create$1=function(t){return this.FOwner=t.FContainer.FOwner,this.FPage=t,this.FViewerContainer=pas["WebLib.SEFNC.Layout"].TSEFNCLayout.$create("Create$1",[this.FOwner]),this.FViewerContainer.SetParent(this.FPage.FContainer),this.FViewerContainer.SetAlign(pas["WebLib.SEFNC.Layout"].TSEFNCAlign.GetAlign(5)),this.InitViewer(),this}}))}),["WEBLib.TMSFNCGraphicsTypes","WEBLib.TMSFNCUtils"]),rtl.module("WEBLib.TMSFNCTableView",["System","Classes","WEBLib.TMSFNCTreeViewBase","WEBLib.TMSFNCTreeView","WEBLib.TMSFNCPersistence","WEBLib.TMSFNCStyles","WEBLib.TMSFNCTreeViewData","WEBLib.TMSFNCCustomControl","WEBLib.TMSFNCTypes","WEBLib.TMSFNCGraphics","WEBLib.TMSFNCCustomTreeView","WEBLib.TMSFNCBitmapContainer","WEBLib.TMSFNCGraphicsTypes","WEBLib.TMSFNCEdit","WEBLib.TMSFNCToolBar","WEBLib.Controls","WEBLib.ExtCtrls","WEBLib.TMSFNCControlPicker","contnrs","TypInfo"],(function(){"use strict";var t=this,e=t.$impl;this.CLP_FMT="#TableView#",this.SWIPEOFFSET=30,this.TTMSFNCTableViewItemAccessory={0:"tviaNone",tviaNone:0,1:"tviaDetail",tviaDetail:1,2:"tviaProgress",tviaProgress:2,3:"tviaButton",tviaButton:3,4:"tviaBadge",tviaBadge:4,5:"tviaCustom",tviaCustom:5},this.$rtti.$Enum("TTMSFNCTableViewItemAccessory",{minvalue:0,maxvalue:5,ordtype:1,enumtype:this.TTMSFNCTableViewItemAccessory}),this.$rtti.$Set("TTMSFNCTableViewItemAccessories",{comptype:this.$rtti.TTMSFNCTableViewItemAccessory}),this.ClickAccessories=rtl.createSet(3,5),this.$rtti.$Class("TTMSFNCTableViewInteraction"),this.$rtti.$Class("TTMSFNCTableViewCategory"),this.TTMSFNCTableViewItemCheckType={0:"tvictNone",tvictNone:0,1:"tvictCheckBox",tvictCheckBox:1,2:"tvictRadioButton",tvictRadioButton:2},this.$rtti.$Enum("TTMSFNCTableViewItemCheckType",{minvalue:0,maxvalue:2,ordtype:1,enumtype:this.TTMSFNCTableViewItemCheckType}),rtl.createClass(this,"TTMSFNCTableViewItem",pas.Classes.TCollectionItem,(function(){this.$init=function(){pas.Classes.TCollectionItem.$init.call(this),this.FRow=0,this.FTag=0,this.FDataString="",this.FDataObject=null,this.FDataInteger=0,this.FTableView=null,this.FText="",this.FDBKey="",this.FChecked=!1,this.FDataBoolean=!1,this.FWordWrapping=!1,this.FTrimming=0,this.FHorizontalTextAlign=0,this.FSelectedTextColor=0,this.FTextColor=0,this.FDisabledTextColor=0,this.FEnabled=!1,this.FBitmapName="",this.FBitmap=null,this.FHeight=0,this.FDataPointer=null,this.FHTMLTemplateItems=null,this.FVisible=!1,this.FCategoryID=0,this.FDetailControl=null,this.FAccessory=0,this.FAccessoryWidth=0,this.FAccessoryProgress=0,this.FAccessoryHeight=0,this.FAccessoryText="",this.FCheckType=0,this.FAccessoryFontColor=0,this.FAccessoryBorderColor=0,this.FAccessoryColor=0,this.FVerticalTextAlign=0,this.FEnableMoreOptions=!1,this.FTitleTrimming=0,this.FTitleHorizontalTextAlign=0,this.FTitle="",this.FDisabledTitleColor=0,this.FTitleWordWrapping=!1,this.FSelectedTitleColor=0,this.FTitleColor=0,this.FTitleVerticalTextAlign=0,this.FTitleExpanded=!1},this.$final=function(){this.FDataObject=void 0,this.FTableView=void 0,this.FBitmap=void 0,this.FHTMLTemplateItems=void 0,this.FDetailControl=void 0,pas.Classes.TCollectionItem.$final.call(this)},this.SetText=function(t){this.FText!==t&&(this.FText=t,this.UpdateItem())},this.SetHeight=function(t){this.FHeight!==t&&(this.FHeight=t,this.UpdateItem())},this.SetTrimming=function(t){this.FTrimming!==t&&(this.FTrimming=t,this.UpdateItem())},this.SetWordWrapping=function(t){this.FWordWrapping!==t&&(this.FWordWrapping=t,this.UpdateItem())},this.SetHorizontalTextAlign=function(t){this.FHorizontalTextAlign!==t&&(this.FHorizontalTextAlign=t,this.UpdateItem())},this.SetSelectedTextColor=function(t){this.FSelectedTextColor!==t&&(this.FSelectedTextColor=t,this.UpdateItem())},this.SetTextColor=function(t){this.FTextColor!==t&&(this.FTextColor=t,this.UpdateItem())},this.SetDisabledTextColor=function(t){this.FDisabledTextColor!==t&&(this.FDisabledTextColor=t,this.UpdateItem())},this.SetEnabled=function(t){this.FEnabled!==t&&(this.FEnabled=t,this.UpdateItem())},this.SetBitmapName=function(t){this.FBitmapName!==t&&(this.FBitmapName=t,this.UpdateItem())},this.SetBitmap=function(t){this.FBitmap!==t&&(this.FBitmap.Assign(t),this.UpdateItem())},this.SetChecked=function(t){var e=null,i=null;this.FChecked!==t&&(this.FChecked=t,null!=(e=this.GetTableView())&&null!=(i=e.GetNodeForItemIndex(this.GetIndex()))&&i.FCheckStates[0]!==this.FChecked&&(this.FChecked?e.FTreeView.CheckVirtualNode(i,0,!1):e.FTreeView.UnCheckVirtualNode(i,0,!1)))},this.GetStrippedHTMLText=function(){return pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.HTMLStrip(this.GetText())},this.IsHeightStored=function(){return-1!==this.FHeight},this.SetHTMLTemplateItems=function(t){this.FHTMLTemplateItems!==t&&(this.FHTMLTemplateItems.Assign(t),this.UpdateItem())},this.SetVisible=function(t){this.FVisible!==t&&(this.FVisible=t,this.UpdateItem())},this.SetCategoryID=function(t){this.FCategoryID!==t&&(this.FCategoryID=t,this.UpdateItem())},this.SetDetailControl=function(t){null===t&&null!=this.FDetailControl&&this.FDetailControl.SetVisible(!0),this.FDetailControl=t,null!=this.FDetailControl&&this.FDetailControl.SetVisible(!1)},this.SetAccessory=function(t){if(this.FAccessory!==t){this.FAccessory=t;var e=this.FAccessory;1===e?(this.SetAccessoryWidth(32),this.SetAccessoryHeight(24)):2===e||3===e?(this.SetAccessoryWidth(75),this.SetAccessoryHeight(20)):4===e&&(this.SetAccessoryWidth(32),this.SetAccessoryHeight(24)),this.UpdateItem()}},this.IsAccessoryWidthStored=function(){return 24!==this.FAccessoryWidth},this.SetAccessoryWidth=function(t){this.FAccessoryWidth!==t&&(this.FAccessoryWidth=t,this.UpdateItem())},this.IsAccessoryProgressStored=function(){return 0!==this.FAccessoryProgress},this.SetAccessoryProgress=function(t){this.FAccessoryProgress!==t&&(this.FAccessoryProgress=t,this.UpdateItem())},this.IsAccessoryHeightStored=function(){return 24!==this.FAccessoryHeight},this.SetAccessoryHeight=function(t){this.FAccessoryHeight!==t&&(this.FAccessoryHeight=t,this.UpdateItem())},this.SetAccessoryText=function(t){this.FAccessoryText!==t&&(this.FAccessoryText=t,this.UpdateItem())},this.SetCheckType=function(t){this.FCheckType!==t&&(this.FCheckType=t,this.UpdateItem())},this.SetAccessoryBorderColor=function(t){this.FAccessoryBorderColor!==t&&(this.FAccessoryBorderColor=t,this.UpdateItem())},this.SetAccessoryColor=function(t){this.FAccessoryColor!==t&&(this.FAccessoryColor=t,this.UpdateItem())},this.SetAccessoryFontColor=function(t){this.FAccessoryFontColor!==t&&(this.FAccessoryFontColor=t,this.UpdateItem())},this.SetVerticalTextAlign=function(t){this.FVerticalTextAlign!==t&&(this.FVerticalTextAlign=t,this.UpdateItem())},this.SetSelectedTitleColor=function(t){this.FSelectedTitleColor!==t&&(this.FSelectedTitleColor=t,this.UpdateItem())},this.SetTitleColor=function(t){this.FTitleColor!==t&&(this.FTitleColor=t,this.UpdateItem())},this.UpdateItem=function(){var t=null;null!=(t=this.GetTableView())&&t.UpdateTableView(!1)},this.BitmapChanged=function(t){this.UpdateItem()},this.TemplateItemsChanged=function(t){this.UpdateItem()},this.GetTableView=function(){return this.FTableView},this.GetText=function(){var t="",e="";return e="",null!=this.FTableView&&(t=this.FTableView.FItemAppearance.FHTMLTemplate,this.FTableView.DoGetHTMLTemplate(this,{get:function(){return t},set:function(e){t=e}}),e=""===t?this.FText:this.FTableView.HTMLReplace(t,this)),e},this.GetTitle=function(){return this.FTitle},this.Create$1=function(e){return pas.Classes.TCollectionItem.Create$1.apply(this,arguments),null!=this.FCollection&&(this.FTableView=rtl.as(this.FCollection,t.TTMSFNCTableViewItems).TableView()),this.FTextColor=0,this.FEnableMoreOptions=!0,this.FTitleExpanded=!0,this.FChecked=!1,this.FCheckType=0,this.FCategoryID=-1,this.FAccessoryFontColor=-1,this.FAccessoryColor=-1,this.FAccessoryBorderColor=-1,this.FHeight=-1,this.FEnabled=!0,this.FAccessory=0,this.FAccessoryWidth=24,this.FAccessoryHeight=24,this.FAccessoryProgress=0,null!=this.FTableView&&this.FTableView.IsDesignTime()&&(this.FAccessoryText="Button"),this.FVisible=!0,this.FHTMLTemplateItems=pas.Classes.TStringList.$create("Create$1"),this.FHTMLTemplateItems.FOnChange=rtl.createCallback(this,"TemplateItemsChanged"),this.FTitleColor=0,this.FSelectedTextColor=0,this.FDisabledTextColor=12632256,this.FWordWrapping=!0,this.FHorizontalTextAlign=1,this.FVerticalTextAlign=0,this.FTrimming=0,this.FSelectedTitleColor=0,this.FDisabledTitleColor=12632256,this.FTitleWordWrapping=!0,this.FTitleHorizontalTextAlign=1,this.FTitleVerticalTextAlign=0,this.FTitleTrimming=0,this.FBitmap=pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.$create("Create$3"),this.FBitmap.FOnChange=rtl.createCallback(this,"BitmapChanged"),null!=this.FTableView&&this.Assign(this.FTableView.FDefaultItem),this.UpdateItem(),this},this.Destroy=function(){rtl.free(this,"FBitmap"),rtl.free(this,"FHTMLTemplateItems"),pas.Classes.TCollectionItem.Destroy.call(this),this.UpdateItem()},this.SaveToString=function(t){var e="";return null==this.FTableView||(e="",e+=this.FText,t||(e+="{0}"),t||(e=(e=(e=e+pas.SysUtils.BoolToStr(this.FChecked,!1)+";")+this.FBitmapName+";")+pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.SaveBitmapToHexStr(this.FBitmap)+";",e+=""),t||(e+="{0}",e+=pas.SysUtils.BoolToStr(this.FEnabled,!1))),e},this.LoadFromString=function(t){var e=0,i=null,s=null,o=0,n="",r=0,a="";i=pas.Classes.TStringList.$create("Create$1");try{for(n=t;""!==n;){if(0===(r=pas.System.Pos("{0}",n))){i.Add(n);break}a=pas.System.Copy(n,1,r-1),i.Add(a),pas.System.Delete({get:function(){return n},set:function(t){n=t}},1,r-1+"{0}".length)}for(var l=0,h=i.GetCount()-1;l<=h;l++)if(e=l,""!==i.Get(e))if(0===e)this.SetText(i.Get(e));else if(1===e){s=pas.Classes.TStringList.$create("Create$1");try{pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.Split(";",i.Get(e),s,!1);for(var F=0,p=s.GetCount()-1;F<=p;F++)o=F,""!==s.Get(o)&&(0===o?this.SetChecked(pas.SysUtils.StrToBool(s.Get(o))):1===o?this.SetBitmapName(s.Get(o)):2===o&&pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.LoadBitmapFromHexStr(s.Get(o),this.FBitmap))}finally{s=rtl.freeLoc(s)}}else 2===e&&this.SetEnabled(pas.SysUtils.StrToBool(i.Get(e)))}finally{i=rtl.freeLoc(i)}},this.Assign=function(e){t.TTMSFNCTableViewItem.isPrototypeOf(e)&&(this.FTag=rtl.as(e,t.TTMSFNCTableViewItem).FTag,this.FHTMLTemplateItems.Assign(rtl.as(e,t.TTMSFNCTableViewItem).FHTMLTemplateItems),this.FText=rtl.as(e,t.TTMSFNCTableViewItem).FText,this.FTrimming=rtl.as(e,t.TTMSFNCTableViewItem).FTrimming,this.FWordWrapping=rtl.as(e,t.TTMSFNCTableViewItem).FWordWrapping,this.FHorizontalTextAlign=rtl.as(e,t.TTMSFNCTableViewItem).FHorizontalTextAlign,this.FVerticalTextAlign=rtl.as(e,t.TTMSFNCTableViewItem).FVerticalTextAlign,this.FTextColor=rtl.as(e,t.TTMSFNCTableViewItem).FTextColor,this.FSelectedTextColor=rtl.as(e,t.TTMSFNCTableViewItem).FSelectedTextColor,this.FDisabledTextColor=rtl.as(e,t.TTMSFNCTableViewItem).FDisabledTextColor,this.FTitle=rtl.as(e,t.TTMSFNCTableViewItem).FTitle,this.FTitleTrimming=rtl.as(e,t.TTMSFNCTableViewItem).FTitleTrimming,this.FTitleWordWrapping=rtl.as(e,t.TTMSFNCTableViewItem).FTitleWordWrapping,this.FTitleHorizontalTextAlign=rtl.as(e,t.TTMSFNCTableViewItem).FTitleHorizontalTextAlign,this.FTitleVerticalTextAlign=rtl.as(e,t.TTMSFNCTableViewItem).FTitleVerticalTextAlign,this.FTitleColor=rtl.as(e,t.TTMSFNCTableViewItem).FTitleColor,this.FSelectedTitleColor=rtl.as(e,t.TTMSFNCTableViewItem).FSelectedTitleColor,this.FDisabledTitleColor=rtl.as(e,t.TTMSFNCTableViewItem).FDisabledTitleColor,this.FEnabled=rtl.as(e,t.TTMSFNCTableViewItem).FEnabled,this.FAccessory=rtl.as(e,t.TTMSFNCTableViewItem).FAccessory,this.FVisible=rtl.as(e,t.TTMSFNCTableViewItem).FVisible,this.FBitmapName=rtl.as(e,t.TTMSFNCTableViewItem).FBitmapName,this.FBitmap.Assign(rtl.as(e,t.TTMSFNCTableViewItem).FBitmap),this.FHeight=rtl.as(e,t.TTMSFNCTableViewItem).FHeight,this.FCategoryID=rtl.as(e,t.TTMSFNCTableViewItem).FCategoryID,this.FAccessoryWidth=rtl.as(e,t.TTMSFNCTableViewItem).FAccessoryWidth,this.FAccessoryHeight=rtl.as(e,t.TTMSFNCTableViewItem).FAccessoryHeight,this.FAccessoryProgress=rtl.as(e,t.TTMSFNCTableViewItem).FAccessoryProgress,this.FAccessoryText=rtl.as(e,t.TTMSFNCTableViewItem).FAccessoryText,this.FChecked=rtl.as(e,t.TTMSFNCTableViewItem).FChecked,this.FCheckType=rtl.as(e,t.TTMSFNCTableViewItem).FCheckType,this.FAccessoryFontColor=rtl.as(e,t.TTMSFNCTableViewItem).FAccessoryFontColor,this.FAccessoryBorderColor=rtl.as(e,t.TTMSFNCTableViewItem).FAccessoryBorderColor,this.FAccessoryColor=rtl.as(e,t.TTMSFNCTableViewItem).FAccessoryColor,this.FEnableMoreOptions=rtl.as(e,t.TTMSFNCTableViewItem).FEnableMoreOptions,this.AssignData(e))},this.AssignData=function(e){t.TTMSFNCTableViewItem.isPrototypeOf(e)&&(this.FDataString=rtl.as(e,t.TTMSFNCTableViewItem).FDataString,this.FDataBoolean=rtl.as(e,t.TTMSFNCTableViewItem).FDataBoolean,this.FDataObject=rtl.as(e,t.TTMSFNCTableViewItem).FDataObject,this.FDataInteger=rtl.as(e,t.TTMSFNCTableViewItem).FDataInteger,this.FDataPointer=rtl.as(e,t.TTMSFNCTableViewItem).FDataPointer,this.FDBKey=rtl.as(e,t.TTMSFNCTableViewItem).FDBKey)},this.ShowDetailControl=function(){null!=this.FTableView&&this.FTableView.ShowDetailControl(this.GetIndex())};var e=this.$rtti;e.addProperty("Checked",2,rtl.boolean,"FChecked","SetChecked",{Default:!1}),e.addProperty("DetailControl",2,pas["WEBLib.Controls"].$rtti.TControl,"FDetailControl","SetDetailControl"),e.addProperty("Text",2,rtl.string,"FText","SetText"),e.addProperty("HTMLTemplateItems",2,pas.Classes.$rtti.TStringList,"FHTMLTemplateItems","SetHTMLTemplateItems"),e.addProperty("Bitmap",2,pas["WEBLib.TMSFNCTypes"].$rtti.TTMSFNCBitmap,"FBitmap","SetBitmap"),e.addProperty("BitmapName",2,rtl.string,"FBitmapName","SetBitmapName"),e.addProperty("WordWrapping",2,rtl.boolean,"FWordWrapping","SetWordWrapping",{Default:!0}),e.addProperty("Trimming",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsTextTrimming,"FTrimming","SetTrimming",{Default:pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsTextTrimming.gttNone}),e.addProperty("HorizontalTextAlign",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsTextAlign,"FHorizontalTextAlign","SetHorizontalTextAlign",{Default:pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsTextAlign.gtaLeading}),e.addProperty("VerticalTextAlign",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsTextAlign,"FVerticalTextAlign","SetVerticalTextAlign",{Default:pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsTextAlign.gtaLeading}),e.addProperty("TextColor",2,pas["WEBLib.Graphics"].$rtti.TColor,"FTextColor","SetTextColor",{Default:0}),e.addProperty("SelectedTextColor",2,pas["WEBLib.Graphics"].$rtti.TColor,"FSelectedTextColor","SetSelectedTextColor",{Default:16777215}),e.addProperty("DisabledTextColor",2,pas["WEBLib.Graphics"].$rtti.TColor,"FDisabledTextColor","SetDisabledTextColor",{Default:12632256}),e.addProperty("Enabled",2,rtl.boolean,"FEnabled","SetEnabled",{Default:!0}),e.addProperty("Height",14,rtl.double,"FHeight","SetHeight",{stored:"IsHeightStored"}),e.addProperty("Visible",2,rtl.boolean,"FVisible","SetVisible",{Default:!0}),e.addProperty("CategoryID",2,rtl.longint,"FCategoryID","SetCategoryID",{Default:-1}),e.addProperty("Tag",0,rtl.nativeint,"FTag","FTag",{Default:0}),e.addProperty("AccessoryWidth",14,rtl.double,"FAccessoryWidth","SetAccessoryWidth",{stored:"IsAccessoryWidthStored"}),e.addProperty("AccessoryHeight",14,rtl.double,"FAccessoryHeight","SetAccessoryHeight",{stored:"IsAccessoryHeightStored"}),e.addProperty("Accessory",2,t.$rtti.TTMSFNCTableViewItemAccessory,"FAccessory","SetAccessory",{Default:t.TTMSFNCTableViewItemAccessory.tviaNone}),e.addProperty("AccessoryProgress",14,rtl.double,"FAccessoryProgress","SetAccessoryProgress",{stored:"IsAccessoryProgressStored"}),e.addProperty("AccessoryText",2,rtl.string,"FAccessoryText","SetAccessoryText"),e.addProperty("AccessoryColor",2,pas["WEBLib.Graphics"].$rtti.TColor,"FAccessoryColor","SetAccessoryColor",{Default:-1}),e.addProperty("AccessoryBorderColor",2,pas["WEBLib.Graphics"].$rtti.TColor,"FAccessoryBorderColor","SetAccessoryBorderColor",{Default:-1}),e.addProperty("AccessoryFontColor",2,pas["WEBLib.Graphics"].$rtti.TColor,"FAccessoryFontColor","SetAccessoryFontColor",{Default:-1}),e.addProperty("CheckType",2,t.$rtti.TTMSFNCTableViewItemCheckType,"FCheckType","SetCheckType",{Default:t.TTMSFNCTableViewItemCheckType.tvictNone}),e.addProperty("EnableMoreOptions",0,rtl.boolean,"FEnableMoreOptions","FEnableMoreOptions",{Default:!0})})),this.TTMSFNCTableViewItemsSortMode={0:"tvismAscending",tvismAscending:0,1:"tvismDescending",tvismDescending:1},this.TTMSFNCTableViewItemsSortKind={0:"tviskNone",tviskNone:0,1:"tviskAscending",tviskAscending:1,2:"tviskDescending",tviskDescending:2},rtl.createClass(this,"TTMSFNCTableViewItems",pas["WEBLib.TMSFNCTypes"].TTMSFNCOwnedCollection,(function(){this.$init=function(){pas["WEBLib.TMSFNCTypes"].TTMSFNCOwnedCollection.$init.call(this),this.FTableView=null},this.$final=function(){this.FTableView=void 0,pas["WEBLib.TMSFNCTypes"].TTMSFNCOwnedCollection.$final.call(this)},this.GetItem$1=function(t){return this.GetItem(t)},this.GetItemClass=function(){return t.TTMSFNCTableViewItem},this.Compare=function(t,e,i,s){var o=0,n=0,r=0,a="",l="",h=null;if(o=0,null!=(h=this.FTableView)){var F=h.FCategoryType;0===F||1===F||2===F||3===F?o=i?pas.SysUtils.AnsiCompareStr(t.GetStrippedHTMLText(),e.GetStrippedHTMLText()):pas.SysUtils.AnsiCompareStr(pas.SysUtils.UpperCase(t.GetStrippedHTMLText()),pas.SysUtils.UpperCase(e.GetStrippedHTMLText())):4===F&&((n=h.FCategories.ItemIndexById(t.FCategoryID))<(r=h.FCategories.ItemIndexById(e.FCategoryID))?o=-1:n>r?o=1:(a=t.GetStrippedHTMLText(),l=e.GetStrippedHTMLText(),i||(a=pas.SysUtils.UpperCase(a),l=pas.SysUtils.UpperCase(l)),o=a<l?-1:a>l?1:0)),1===s&&(o*=-1),h.DoItemCompare(t,e,{get:function(){return o},set:function(t){o=t}})}return o},this.QuickSort=function(t,e,i,s){var o,n,r,a=0,l=0,h=0,F=null;F=this.FItems;do{a=t,l=e,h=t+e>>>1;do{for(;this.Compare(this.GetItem$1(a),this.GetItem$1(h),i,s)<0;)a+=1;for(;this.Compare(this.GetItem$1(l),this.GetItem$1(h),i,s)>0;)l-=1;a<=l&&(o=a,n=l,r=void 0,r=F.Get(o),F.Put(o,F.Get(n)),F.Put(n,r),h===a?h=l:h===l&&(h=a),a+=1,l-=1)}while(!(a>l));t<l&&this.QuickSort(t,l,i,s),t=a}while(!(a>=e))},this.TableView=function(){return this.FTableView},this.Create$3=function(t){return pas.Classes.TOwnedCollection.Create$2.call(this,t,this.GetItemClass()),this.FTableView=t,this},this.Add$1=function(){return pas.Classes.TCollection.Add.call(this)},this.Clear$1=function(){var t=null;null!=(t=this.TableView())&&t.BeginUpdate(),pas.Classes.TCollection.Clear.call(this),null!=t&&t.EndUpdate()},this.Sort$1=function(t,e){var i=null;null!=(i=this.TableView())&&(i.BeginUpdate(),this.BeginUpdate(),this.GetCount()>1&&this.QuickSort(0,this.GetCount()-1,t,e),this.EndUpdate(),i.EndUpdate())}})),rtl.createClass(this,"TTMSFNCTableViewLookup",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FOwner=null},this.$final=function(){this.FOwner=void 0,pas.Classes.TPersistent.$final.call(this)},this.GetAutoSelect=function(){var t=!1;return t=!1,null!=this.FOwner&&null!=this.FOwner.FTableView&&null!=this.FOwner.FTableView.FTreeView&&(t=this.FOwner.FTableView.FTreeView.FInteraction.FLookup.FAutoSelect),t},this.GetCaseSensitive=function(){var t=!1;return t=!1,null!=this.FOwner&&null!=this.FOwner.FTableView&&null!=this.FOwner.FTableView.FTreeView&&(t=this.FOwner.FTableView.FTreeView.FInteraction.FLookup.FCaseSensitive),t},this.GetEnabled=function(){var t=!1;return t=!1,null!=this.FOwner&&null!=this.FOwner.FTableView&&null!=this.FOwner.FTableView.FTreeView&&(t=this.FOwner.FTableView.FTreeView.FInteraction.FLookup.FEnabled),t},this.GetIncremental=function(){var t=!1;return t=!1,null!=this.FOwner&&null!=this.FOwner.FTableView&&null!=this.FOwner.FTableView.FTreeView&&(t=this.FOwner.FTableView.FTreeView.FInteraction.FLookup.FIncremental),t},this.SetAutoSelect=function(t){null!=this.FOwner&&null!=this.FOwner.FTableView&&null!=this.FOwner.FTableView.FTreeView&&(this.FOwner.FTableView.FTreeView.FInteraction.FLookup.FAutoSelect=t)},this.SetCaseSensitive=function(t){null!=this.FOwner&&null!=this.FOwner.FTableView&&null!=this.FOwner.FTableView.FTreeView&&(this.FOwner.FTableView.FTreeView.FInteraction.FLookup.FCaseSensitive=t)},this.SetEnabled=function(t){null!=this.FOwner&&null!=this.FOwner.FTableView&&null!=this.FOwner.FTableView.FTreeView&&(this.FOwner.FTableView.FTreeView.FInteraction.FLookup.FEnabled=t)},this.SetIncremental=function(t){null!=this.FOwner&&null!=this.FOwner.FTableView&&null!=this.FOwner.FTableView.FTreeView&&(this.FOwner.FTableView.FTreeView.FInteraction.FLookup.FIncremental=t)},this.Create$1=function(t){return this.FOwner=t,this},this.Assign=function(e){t.TTMSFNCTableViewLookup.isPrototypeOf(e)&&(this.SetCaseSensitive(rtl.as(e,t.TTMSFNCTableViewLookup).GetCaseSensitive()),this.SetEnabled(rtl.as(e,t.TTMSFNCTableViewLookup).GetEnabled()),this.SetIncremental(rtl.as(e,t.TTMSFNCTableViewLookup).GetIncremental()),this.SetAutoSelect(rtl.as(e,t.TTMSFNCTableViewLookup).GetAutoSelect()))};var e=this.$rtti;e.addProperty("CaseSensitive",3,rtl.boolean,"GetCaseSensitive","SetCaseSensitive",{Default:!1}),e.addProperty("Enabled",3,rtl.boolean,"GetEnabled","SetEnabled",{Default:!0}),e.addProperty("Incremental",3,rtl.boolean,"GetIncremental","SetIncremental",{Default:!0}),e.addProperty("AutoSelect",3,rtl.boolean,"GetAutoSelect","SetAutoSelect",{Default:!0})})),rtl.createClass(this,"TTMSFNCTableViewFiltering",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FOwner=null},this.$final=function(){this.FOwner=void 0,pas.Classes.TPersistent.$final.call(this)},this.GetDropDownHeight=function(){var t=0;return t=120,null!=this.FOwner&&null!=this.FOwner.FTableView&&null!=this.FOwner.FTableView.FTreeView&&this.FOwner.FTableView.FTreeView.FColumns.GetCount()>0&&(t=this.FOwner.FTableView.FTreeView.FColumns.GetItem$1(0).FFiltering.FDropDownHeight),t},this.GetDropDownWidth=function(){var t=0;return t=100,null!=this.FOwner&&null!=this.FOwner.FTableView&&null!=this.FOwner.FTableView.FTreeView&&this.FOwner.FTableView.FTreeView.FColumns.GetCount()>0&&(t=this.FOwner.FTableView.FTreeView.FColumns.GetItem$1(0).FFiltering.FDropDownWidth),t},this.GetEnabled=function(){var t=!1;return t=!1,null!=this.FOwner&&null!=this.FOwner.FTableView&&null!=this.FOwner.FTableView.FTreeView&&this.FOwner.FTableView.FTreeView.FColumns.GetCount()>0&&(t=this.FOwner.FTableView.FTreeView.FColumns.GetItem$1(0).FFiltering.FEnabled),t},this.SetDropDownHeight=function(t){null!=this.FOwner&&null!=this.FOwner.FTableView&&null!=this.FOwner.FTableView.FTreeView&&this.FOwner.FTableView.FTreeView.FColumns.GetCount()>0&&(this.FOwner.FTableView.FTreeView.FColumns.GetItem$1(0).FFiltering.FDropDownHeight=t)},this.SetDropDownWidth=function(t){null!=this.FOwner&&null!=this.FOwner.FTableView&&null!=this.FOwner.FTableView.FTreeView&&this.FOwner.FTableView.FTreeView.FColumns.GetCount()>0&&(this.FOwner.FTableView.FTreeView.FColumns.GetItem$1(0).FFiltering.FDropDownWidth=t)},this.SetEnabled=function(t){null!=this.FOwner&&null!=this.FOwner.FTableView&&null!=this.FOwner.FTableView.FTreeView&&this.FOwner.FTableView.FTreeView.FColumns.GetCount()>0&&this.FOwner.FTableView.FTreeView.FColumns.GetItem$1(0).FFiltering.SetEnabled(t)},this.Create$1=function(t){return this.FOwner=t,this},this.Assign=function(e){t.TTMSFNCTableViewFiltering.isPrototypeOf(e)&&(this.SetEnabled(rtl.as(e,t.TTMSFNCTableViewFiltering).GetEnabled()),this.SetDropDownWidth(rtl.as(e,t.TTMSFNCTableViewFiltering).GetDropDownWidth()),this.SetDropDownHeight(rtl.as(e,t.TTMSFNCTableViewFiltering).GetDropDownHeight()))};var e=this.$rtti;e.addProperty("Enabled",3,rtl.boolean,"GetEnabled","SetEnabled",{Default:!1}),e.addProperty("DropDownWidth",3,rtl.longint,"GetDropDownWidth","SetDropDownWidth",{Default:100}),e.addProperty("DropDownHeight",3,rtl.longint,"GetDropDownHeight","SetDropDownHeight",{Default:120})})),this.TTMSFNCTableViewClipboardMode={0:"tvcmNone",tvcmNone:0,1:"tvcmTextOnly",tvcmTextOnly:1,2:"tvcmFull",tvcmFull:2},this.TTMSFNCTableViewDragDropMode={0:"tvdmNone",tvdmNone:0,1:"tvdmMove",tvdmMove:1,2:"tvdmCopy",tvdmCopy:2},this.TTMSFNCTableViewSorting={0:"tvcsNone",tvcsNone:0,1:"tvcsNormal",tvcsNormal:1,2:"tvcsNormalCaseSensitive",tvcsNormalCaseSensitive:2},this.TTMSFNCTableViewShowDetailMode={0:"tvdtNone",tvdtNone:0,1:"tvdtAfterSelectItem",tvdtAfterSelectItem:1},this.$rtti.$Enum("TTMSFNCTableViewShowDetailMode",{minvalue:0,maxvalue:1,ordtype:1,enumtype:this.TTMSFNCTableViewShowDetailMode}),this.TTMSFNCTableViewKeyboardEscapeMode={0:"tvkeNone",tvkeNone:0,1:"tvkeClearEdit",tvkeClearEdit:1,2:"tvkeStopFilter",tvkeStopFilter:2},this.$rtti.$Enum("TTMSFNCTableViewKeyboardEscapeMode",{minvalue:0,maxvalue:2,ordtype:1,enumtype:this.TTMSFNCTableViewKeyboardEscapeMode}),rtl.createClass(this,"TTMSFNCTableViewInteraction",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FTableView=null,this.FLookup=null,this.FFiltering=null,this.FShowDetailMode=0,this.FShowEditButton=!1,this.FShowFilterButton=!1,this.FAccessoryClickDetection={},this.FLongPressToEdit=!1,this.FSwipeToShowMoreOptions=!1,this.FSwipeBounceGesture=!1,this.FKeyboardEscapeMode=0},this.$final=function(){this.FTableView=void 0,this.FLookup=void 0,this.FFiltering=void 0,this.FAccessoryClickDetection=void 0,pas.Classes.TPersistent.$final.call(this)},this.GetMultiSelect=function(){var t=!1;return t=!1,null!=this.FTableView&&null!=this.FTableView.FTreeView&&(t=this.FTableView.FTreeView.FInteraction.FMultiSelect),t},this.SetMultiSelect=function(t){null!=this.FTableView&&null!=this.FTableView.FTreeView&&this.FTableView.FTreeView.FInteraction.SetMultiSelect(t)},this.GetClipboardMode=function(){var t=0;return t=0,null!=this.FTableView&&null!=this.FTableView.FTreeView&&(t=this.FTableView.FTreeView.FInteraction.FClipboardMode),t},this.GetDragDropMode=function(){var t=0;return t=0,null!=this.FTableView&&null!=this.FTableView.FTreeView&&(t=this.FTableView.FTreeView.FInteraction.FDragDropMode),t},this.GetReorder=function(){var t=!1;return t=!1,null!=this.FTableView&&null!=this.FTableView.FTreeView&&(t=this.FTableView.FTreeView.FInteraction.FReorder),t},this.GetTouchScrolling=function(){var t=!1;return t=!0,null!=this.FTableView&&null!=this.FTableView.FTreeView&&(t=this.FTableView.FTreeView.FInteraction.FTouchScrolling),t},this.SetDragDropMode=function(t){var e=0;null!=this.FTableView&&null!=this.FTableView.FTreeView&&(e=t,this.FTableView.FTreeView.FInteraction.SetDragDropMode(e))},this.SetReorder=function(t){null!=this.FTableView&&null!=this.FTableView.FTreeView&&this.FTableView.FTreeView.FInteraction.SetReorder(t)},this.SetTouchScrolling=function(t){null!=this.FTableView&&null!=this.FTableView.FTreeView&&this.FTableView.FTreeView.FInteraction.SetTouchScrolling(t)},this.SetClipboardMode=function(t){var e=0;null!=this.FTableView&&null!=this.FTableView.FTreeView&&(e=t,this.FTableView.FTreeView.FInteraction.FClipboardMode=e)},this.GetSorting=function(){var t=0;if(t=0,null!=this.FTableView&&null!=this.FTableView.FTreeView&&this.FTableView.FTreeView.FColumns.GetCount()>0){var e=this.FTableView.FTreeView.FColumns.GetItem$1(0).FSorting;0===e?t=0:1===e?t=1:3===e&&(t=2)}return t},this.SetSorting=function(t){if(null!=this.FTableView&&null!=this.FTableView.FTreeView&&this.FTableView.FTreeView.FColumns.GetCount()>0){var e=t;0===e?this.FTableView.FTreeView.FColumns.GetItem$1(0).SetSorting(0):1===e?this.FTableView.FTreeView.FColumns.GetItem$1(0).SetSorting(1):2===e&&this.FTableView.FTreeView.FColumns.GetItem$1(0).SetSorting(3)}},this.SetShowDetailMode=function(t){this.FShowDetailMode!==t&&(this.FShowDetailMode=t)},this.SetShowEditButton=function(t){this.FShowEditButton!==t&&(this.FShowEditButton=t,null!=this.FTableView&&this.FTableView.UpdateTableView(!1))},this.SetShowFilterButton=function(t){this.FShowFilterButton!==t&&(this.FShowFilterButton=t,null!=this.FTableView&&this.FTableView.UpdateTableView(!1))},this.SetAccessoryClickDetection=function(t){this.FAccessoryClickDetection=rtl.refSet(t)},this.GetAutoOpenURL=function(){var t=!1;return t=!0,null!=this.FTableView&&null!=this.FTableView.FTreeView&&(t=this.FTableView.FTreeView.FInteraction.FAutoOpenURL),t},this.SetAutoOpenURL=function(t){null!=this.FTableView&&null!=this.FTableView.FTreeView&&(this.FTableView.FTreeView.FInteraction.FAutoOpenURL=t)},this.GetAnimationFactor=function(){var t=0;return t=2.5,null!=this.FTableView&&null!=this.FTableView.FTreeView&&(t=this.FTableView.FTreeView.FInteraction.FAnimationFactor),t},this.SetAnimationFactor=function(t){null!=this.FTableView&&null!=this.FTableView.FTreeView&&(this.FTableView.FTreeView.FInteraction.FAnimationFactor=t)},this.Create$1=function(e){return this.FTableView=e,this.FLongPressToEdit=!0,this.FSwipeToShowMoreOptions=!0,this.FAccessoryClickDetection=rtl.refSet(t.ClickAccessories),this.FLookup=t.TTMSFNCTableViewLookup.$create("Create$1",[this]),this.FFiltering=t.TTMSFNCTableViewFiltering.$create("Create$1",[this]),this.FShowDetailMode=1,this.FShowEditButton=!1,this.FShowFilterButton=!1,this.FSwipeBounceGesture=!0,this.FKeyboardEscapeMode=2,this},this.Destroy=function(){rtl.free(this,"FLookup"),rtl.free(this,"FFiltering"),pas.System.TObject.Destroy.call(this)},this.Assign=function(e){t.TTMSFNCTableViewInteraction.isPrototypeOf(e)&&(this.FLookup.Assign(rtl.as(e,t.TTMSFNCTableViewInteraction).FLookup),this.FFiltering.Assign(rtl.as(e,t.TTMSFNCTableViewInteraction).FFiltering),this.SetSorting(rtl.as(e,t.TTMSFNCTableViewInteraction).GetSorting()),this.FShowDetailMode=rtl.as(e,t.TTMSFNCTableViewInteraction).FShowDetailMode,this.SetDragDropMode(rtl.as(e,t.TTMSFNCTableViewInteraction).GetDragDropMode()),this.SetMultiSelect(rtl.as(e,t.TTMSFNCTableViewInteraction).GetMultiSelect()),this.SetTouchScrolling(rtl.as(e,t.TTMSFNCTableViewInteraction).GetTouchScrolling()),this.SetClipboardMode(rtl.as(e,t.TTMSFNCTableViewInteraction).GetClipboardMode()),this.SetReorder(rtl.as(e,t.TTMSFNCTableViewInteraction).GetReorder()),this.FShowEditButton=rtl.as(e,t.TTMSFNCTableViewInteraction).FShowEditButton,this.FShowFilterButton=rtl.as(e,t.TTMSFNCTableViewInteraction).FShowFilterButton,this.FAccessoryClickDetection=rtl.refSet(rtl.as(e,t.TTMSFNCTableViewInteraction).FAccessoryClickDetection),this.FLongPressToEdit=rtl.as(e,t.TTMSFNCTableViewInteraction).FLongPressToEdit,this.FSwipeToShowMoreOptions=rtl.as(e,t.TTMSFNCTableViewInteraction).FSwipeToShowMoreOptions,this.FSwipeBounceGesture=rtl.as(e,t.TTMSFNCTableViewInteraction).FSwipeBounceGesture)};var e=this.$rtti;e.addProperty("AnimationFactor",3,rtl.double,"GetAnimationFactor","SetAnimationFactor"),e.addProperty("AutoOpenURL",3,rtl.boolean,"GetAutoOpenURL","SetAutoOpenURL",{Default:!0}),e.addProperty("MultiSelect",3,rtl.boolean,"GetMultiSelect","SetMultiSelect",{Default:!1}),e.addProperty("TouchScrolling",3,rtl.boolean,"GetTouchScrolling","SetTouchScrolling",{Default:!0}),e.addProperty("ShowDetailMode",2,t.$rtti.TTMSFNCTableViewShowDetailMode,"FShowDetailMode","SetShowDetailMode",{Default:t.TTMSFNCTableViewShowDetailMode.tvdtAfterSelectItem}),e.addProperty("ShowEditButton",2,rtl.boolean,"FShowEditButton","SetShowEditButton",{Default:!1}),e.addProperty("ShowFilterButton",2,rtl.boolean,"FShowFilterButton","SetShowFilterButton",{Default:!1}),e.addProperty("SwipeBounceGesture",0,rtl.boolean,"FSwipeBounceGesture","FSwipeBounceGesture",{Default:!0}),e.addProperty("AccessoryClickDetection",2,t.$rtti.TTMSFNCTableViewItemAccessories,"FAccessoryClickDetection","SetAccessoryClickDetection",{Default:t.ClickAccessories}),e.addProperty("SwipeToShowMoreOptions",0,rtl.boolean,"FSwipeToShowMoreOptions","FSwipeToShowMoreOptions",{Default:!0}),e.addProperty("LongPressToEdit",0,rtl.boolean,"FLongPressToEdit","FLongPressToEdit",{Default:!0}),e.addProperty("KeyboardEscapeMode",0,t.$rtti.TTMSFNCTableViewKeyboardEscapeMode,"FKeyboardEscapeMode","FKeyboardEscapeMode",{Default:t.TTMSFNCTableViewKeyboardEscapeMode.tvkeStopFilter})})),this.TTMSFNCTableViewItemHeightMode={0:"tvhmFixed",tvhmFixed:0,1:"tvhmVariable",tvhmVariable:1},this.$rtti.$Enum("TTMSFNCTableViewItemHeightMode",{minvalue:0,maxvalue:1,ordtype:1,enumtype:this.TTMSFNCTableViewItemHeightMode}),rtl.createClass(this,"TTMSFNCTableViewItemAppearance",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FTableView=null,this.FHTMLTemplate="",this.FAccessoryDetailBitmaps=null,this.FAccessoryFont=null,this.FAccessoryStroke=null,this.FAccessoryFill=null,this.FHeight=0},this.$final=function(){this.FTableView=void 0,this.FAccessoryDetailBitmaps=void 0,this.FAccessoryFont=void 0,this.FAccessoryStroke=void 0,this.FAccessoryFill=void 0,pas.Classes.TPersistent.$final.call(this)},this.GetFont=function(){var t=null;return t=null,null!=this.FTableView&&null!=this.FTableView.FTreeView&&(t=this.FTableView.FTreeView.FNodesAppearance.FFont),t},this.GetSelectedFill=function(){var t=null;return t=null,null!=this.FTableView&&null!=this.FTableView.FTreeView&&(t=this.FTableView.FTreeView.FNodesAppearance.FSelectedFill),t},this.SetFont=function(t){null!=this.FTableView&&null!=this.FTableView.FTreeView&&this.FTableView.FTreeView.FNodesAppearance.FFont.Assign(t)},this.SetSelectedFill=function(t){null!=this.FTableView&&null!=this.FTableView.FTreeView&&this.FTableView.FTreeView.FNodesAppearance.FSelectedFill.Assign(t)},this.GetSelectedStroke=function(){var t=null;return t=null,null!=this.FTableView&&null!=this.FTableView.FTreeView&&(t=this.FTableView.FTreeView.FNodesAppearance.FSelectedStroke),t},this.SetSelectedStroke=function(t){null!=this.FTableView&&null!=this.FTableView.FTreeView&&this.FTableView.FTreeView.FNodesAppearance.FSelectedStroke.Assign(t)},this.GetDisabledFill=function(){var t=null;return t=null,null!=this.FTableView&&null!=this.FTableView.FTreeView&&(t=this.FTableView.FTreeView.FNodesAppearance.FDisabledFill),t},this.GetDisabledStroke=function(){var t=null;return t=null,null!=this.FTableView&&null!=this.FTableView.FTreeView&&(t=this.FTableView.FTreeView.FNodesAppearance.FDisabledStroke),t},this.GetFill=function(){var t=null;return t=null,null!=this.FTableView&&null!=this.FTableView.FTreeView&&(t=this.FTableView.FTreeView.FNodesAppearance.FFill),t},this.GetStroke=function(){var t=null;return t=null,null!=this.FTableView&&null!=this.FTableView.FTreeView&&(t=this.FTableView.FTreeView.FNodesAppearance.FStroke),t},this.SetDisabledFill=function(t){null!=this.FTableView&&null!=this.FTableView.FTreeView&&this.FTableView.FTreeView.FNodesAppearance.FDisabledFill.Assign(t)},this.SetDisabledStroke=function(t){null!=this.FTableView&&null!=this.FTableView.FTreeView&&this.FTableView.FTreeView.FNodesAppearance.FDisabledStroke.Assign(t)},this.SetFill=function(t){null!=this.FTableView&&null!=this.FTableView.FTreeView&&this.FTableView.FTreeView.FNodesAppearance.FFill.Assign(t)},this.SetStroke=function(t){null!=this.FTableView&&null!=this.FTableView.FTreeView&&this.FTableView.FTreeView.FNodesAppearance.FStroke.Assign(t)},this.GetHeightMode=function(){var t=0;return t=1,null!=this.FTableView&&null!=this.FTableView.FTreeView&&(t=this.FTableView.FTreeView.FNodesAppearance.FHeightMode),t},this.SetHeightMode=function(t){var e=0;null!=this.FTableView&&null!=this.FTableView.FTreeView&&(e=t,this.FTableView.FTreeView.FNodesAppearance.SetHeightMode(e))},this.GetFixedHeight=function(){var t=0;return t=0,null!=this.FTableView&&null!=this.FTableView.FTreeView&&(t=this.FTableView.FTreeView.FNodesAppearance.FFixedHeight),t},this.SetFixedHeight=function(t){null!=this.FTableView&&null!=this.FTableView.FTreeView&&this.FTableView.FTreeView.FNodesAppearance.SetFixedHeight(t)},this.SetHTMLTemplate=function(t){this.FHTMLTemplate!==t&&(this.FHTMLTemplate=t,null!=this.FTableView&&this.FTableView.UpdateTableView(!1))},this.SetAccessoryDetailBitmaps=function(t){this.FAccessoryDetailBitmaps.Assign(t)},this.SetAccessoryFont=function(t){this.FAccessoryFont.Assign(t)},this.SetAccessoryFill=function(t){this.FAccessoryFill.Assign(t)},this.SetAccessoryStroke=function(t){this.FAccessoryStroke.Assign(t)},this.IsHeightStored=function(){return-1!==this.FHeight},this.SetHeight=function(t){this.FHeight!==t&&(this.FHeight=t,null!=this.FTableView&&this.FTableView.UpdateTableView(!1))},this.GetShowFocus=function(){var t=!1;return t=!0,null!=this.FTableView&&null!=this.FTableView.FTreeView&&(t=this.FTableView.FTreeView.FNodesAppearance.FShowFocus),t},this.SetShowFocus=function(t){null!=this.FTableView&&null!=this.FTableView.FTreeView&&this.FTableView.FTreeView.FNodesAppearance.SetShowFocus(t)},this.DoAccessoryDetailBitmapsChanged=function(t){null!=this.FTableView&&this.FTableView.UpdateTableView(!1)},this.FontChanged=function(t){null!=this.FTableView&&this.FTableView.UpdateTableView(!1)},this.FillChanged=function(t){null!=this.FTableView&&this.FTableView.UpdateTableView(!1)},this.StrokeChanged=function(t){null!=this.FTableView&&this.FTableView.UpdateTableView(!1)},this.GetOwner=function(){return this.FTableView},this.Assign=function(e){t.TTMSFNCTableViewItemAppearance.isPrototypeOf(e)&&(this.GetFont().Assign(rtl.as(e,t.TTMSFNCTableViewItemAppearance).GetFont()),this.GetFill().Assign(rtl.as(e,t.TTMSFNCTableViewItemAppearance).GetFill()),this.GetStroke().Assign(rtl.as(e,t.TTMSFNCTableViewItemAppearance).GetStroke()),this.GetSelectedFill().Assign(rtl.as(e,t.TTMSFNCTableViewItemAppearance).GetSelectedFill()),this.GetSelectedStroke().Assign(rtl.as(e,t.TTMSFNCTableViewItemAppearance).GetSelectedStroke()),this.GetDisabledFill().Assign(rtl.as(e,t.TTMSFNCTableViewItemAppearance).GetDisabledFill()),this.GetDisabledStroke().Assign(rtl.as(e,t.TTMSFNCTableViewItemAppearance).GetDisabledStroke()),this.SetHeightMode(rtl.as(e,t.TTMSFNCTableViewItemAppearance).GetHeightMode()),this.SetFixedHeight(rtl.as(e,t.TTMSFNCTableViewItemAppearance).GetFixedHeight()),this.FHTMLTemplate=rtl.as(e,t.TTMSFNCTableViewItemAppearance).FHTMLTemplate,this.FAccessoryDetailBitmaps.Assign(rtl.as(e,t.TTMSFNCTableViewItemAppearance).FAccessoryDetailBitmaps),this.FAccessoryFont.Assign(rtl.as(e,t.TTMSFNCTableViewItemAppearance).FAccessoryFont),this.FAccessoryStroke.Assign(rtl.as(e,t.TTMSFNCTableViewItemAppearance).FAccessoryStroke),this.FAccessoryFill.Assign(rtl.as(e,t.TTMSFNCTableViewItemAppearance).FAccessoryFill))},this.Create$1=function(t){return this.FTableView=t,this.FAccessoryFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[1,3329434,8421504,-1,-1]),this.FAccessoryFill.FOnChanged=rtl.createCallback(this,"FillChanged"),this.FAccessoryStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,0]),this.FAccessoryStroke.FOnChanged=rtl.createCallback(this,"StrokeChanged"),this.FAccessoryFont=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFont.$create("Create$2"),null!=this.FTableView&&this.FTableView.IsDesignTime()&&(this.FAccessoryFont.SetColor(139),this.FAccessoryFont.SetStyle(rtl.createSet(0))),this.FAccessoryFont.FOnChanged=rtl.createCallback(this,"FontChanged"),this.FAccessoryDetailBitmaps=pas["WEBLib.TMSFNCTypes"].TTMSFNCScaledBitmaps.$create("Create$3",[this]),this.FAccessoryDetailBitmaps.FOnChange=rtl.createCallback(this,"DoAccessoryDetailBitmapsChanged"),null!=this.FTableView&&null!=this.FTableView.FTreeView&&this.FTableView.IsDesignTime()&&(this.FTableView.FTreeView.FNodesAppearance.FDisabledFill.SetKind(0),this.FTableView.FTreeView.FNodesAppearance.FDisabledStroke.SetKind(0),this.FTableView.FTreeView.FNodesAppearance.FSelectedStroke.Assign(this.FTableView.FTreeView.FNodesAppearance.FSelectedFill)),this.SetHeightMode(1),this.FHeight=-1,this},this.Destroy=function(){rtl.free(this,"FAccessoryFill"),rtl.free(this,"FAccessoryStroke"),rtl.free(this,"FAccessoryFont"),rtl.free(this,"FAccessoryDetailBitmaps"),pas.System.TObject.Destroy.call(this)};var e=this.$rtti;e.addProperty("Font",3,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFont,"GetFont","SetFont"),e.addProperty("Fill",3,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"GetFill","SetFill"),e.addProperty("Stroke",3,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"GetStroke","SetStroke"),e.addProperty("SelectedFill",3,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"GetSelectedFill","SetSelectedFill"),e.addProperty("SelectedStroke",3,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"GetSelectedStroke","SetSelectedStroke"),e.addProperty("DisabledFill",3,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"GetDisabledFill","SetDisabledFill"),e.addProperty("DisabledStroke",3,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"GetDisabledStroke","SetDisabledStroke"),e.addProperty("HeightMode",3,t.$rtti.TTMSFNCTableViewItemHeightMode,"GetHeightMode","SetHeightMode",{Default:t.TTMSFNCTableViewItemHeightMode.tvhmVariable}),e.addProperty("FixedHeight",3,rtl.double,"GetFixedHeight","SetFixedHeight"),e.addProperty("Height",14,rtl.double,"FHeight","SetHeight",{stored:"IsHeightStored"}),e.addProperty("HTMLTemplate",2,rtl.string,"FHTMLTemplate","SetHTMLTemplate"),e.addProperty("AccessoryDetailBitmaps",2,pas["WEBLib.TMSFNCTypes"].$rtti.TTMSFNCScaledBitmaps,"FAccessoryDetailBitmaps","SetAccessoryDetailBitmaps"),e.addProperty("AccessoryFont",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFont,"FAccessoryFont","SetAccessoryFont"),e.addProperty("AccessoryStroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FAccessoryStroke","SetAccessoryStroke"),e.addProperty("AccessoryFill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FAccessoryFill","SetAccessoryFill"),e.addProperty("ShowFocus",3,rtl.boolean,"GetShowFocus","SetShowFocus",{Default:!0})})),rtl.createClass(this,"TTMSFNCTableViewCategoryAppearance",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FTableView=null,this.FHeight=0},this.$final=function(){this.FTableView=void 0,pas.Classes.TPersistent.$final.call(this)},this.GetFont=function(){var t=null;return t=null,null!=this.FTableView&&null!=this.FTableView.FTreeView&&(t=this.FTableView.FTreeView.FNodesAppearance.FExtendedFont),t},this.SetFont=function(t){null!=this.FTableView&&null!=this.FTableView.FTreeView&&this.FTableView.FTreeView.FNodesAppearance.FExtendedFont.Assign(t)},this.GetFill=function(){var t=null;return t=null,null!=this.FTableView&&null!=this.FTableView.FTreeView&&(t=this.FTableView.FTreeView.FNodesAppearance.FExtendedFill),t},this.GetStroke=function(){var t=null;return t=null,null!=this.FTableView&&null!=this.FTableView.FTreeView&&(t=this.FTableView.FTreeView.FNodesAppearance.FExtendedStroke),t},this.SetFill=function(t){null!=this.FTableView&&null!=this.FTableView.FTreeView&&this.FTableView.FTreeView.FNodesAppearance.FExtendedFill.Assign(t)},this.SetStroke=function(t){null!=this.FTableView&&null!=this.FTableView.FTreeView&&this.FTableView.FTreeView.FNodesAppearance.FExtendedStroke.Assign(t)},this.IsHeightStored=function(){return-1!==this.FHeight},this.SetHeight=function(t){this.FHeight!==t&&(this.FHeight=t,null!=this.FTableView&&this.FTableView.UpdateTableView(!1))},this.Assign=function(e){t.TTMSFNCTableViewCategoryAppearance.isPrototypeOf(e)&&(this.GetFont().Assign(rtl.as(e,t.TTMSFNCTableViewCategoryAppearance).GetFont()),this.GetFill().Assign(rtl.as(e,t.TTMSFNCTableViewCategoryAppearance).GetFill()),this.GetStroke().Assign(rtl.as(e,t.TTMSFNCTableViewCategoryAppearance).GetStroke()),this.FHeight=rtl.as(e,t.TTMSFNCTableViewCategoryAppearance).FHeight)},this.Create$1=function(t){return this.FTableView=t,this.FHeight=-1,this},this.Destroy=function(){pas.System.TObject.Destroy.call(this)};var e=this.$rtti;e.addProperty("Font",3,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFont,"GetFont","SetFont"),e.addProperty("Fill",3,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"GetFill","SetFill"),e.addProperty("Stroke",3,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"GetStroke","SetStroke"),e.addProperty("Height",14,rtl.double,"FHeight","SetHeight",{stored:"IsHeightStored"})})),rtl.createClass(this,"TTMSFNCTableViewMoreOptionAppearance",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FTableView=null,this.FFill=null,this.FStroke=null,this.FFont=null},this.$final=function(){this.FTableView=void 0,this.FFill=void 0,this.FStroke=void 0,this.FFont=void 0,pas.Classes.TPersistent.$final.call(this)},this.SetFont=function(t){this.FFont.Assign(t)},this.SetFill=function(t){this.FFill.Assign(t)},this.SetStroke=function(t){this.FStroke.Assign(t)},this.FontChanged=function(t){null!=this.FTableView&&this.FTableView.Invalidate()},this.StrokeChanged=function(t){null!=this.FTableView&&this.FTableView.Invalidate()},this.FillChanged=function(t){null!=this.FTableView&&this.FTableView.Invalidate()},this.Assign=function(e){t.TTMSFNCTableViewMoreOptionAppearance.isPrototypeOf(e)&&(this.FFont.Assign(rtl.as(e,t.TTMSFNCTableViewMoreOptionAppearance).FFont),this.FFill.Assign(rtl.as(e,t.TTMSFNCTableViewMoreOptionAppearance).FFill),this.FStroke.Assign(rtl.as(e,t.TTMSFNCTableViewMoreOptionAppearance).FStroke))},this.Create$1=function(t){return this.FTableView=t,this.FFont=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFont.$create("Create$2"),null!=this.FTableView&&this.FTableView.IsDesignTime()&&this.FFont.SetColor(16777215),this.FFont.FOnChanged=rtl.createCallback(this,"FontChanged"),this.FFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[1,11829830,8421504,-1,-1]),this.FFill.FOnChanged=rtl.createCallback(this,"FillChanged"),this.FStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,11829830]),this.FStroke.FOnChanged=rtl.createCallback(this,"StrokeChanged"),this},this.Destroy=function(){rtl.free(this,"FFont"),rtl.free(this,"FFill"),rtl.free(this,"FStroke"),pas.System.TObject.Destroy.call(this)};var e=this.$rtti;e.addProperty("Font",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFont,"FFont","SetFont"),e.addProperty("Fill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FFill","SetFill"),e.addProperty("Stroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FStroke","SetStroke")})),rtl.createClass(this,"TTMSFNCTableViewHeaderFooter",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FTableView=null,this.FText="",this.FWordWrapping=!1,this.FVerticalTextAlign=0,this.FTrimming=0,this.FHorizontalTextAlign=0},this.$final=function(){this.FTableView=void 0,pas.Classes.TPersistent.$final.call(this)},this.GetVisible=function(){var e=!1;return e=!1,null!=this.FTableView&&null!=this.FTableView.FTreeView&&(e=t.TTMSFNCTableViewHeader.isPrototypeOf(this)?0 in this.FTableView.FTreeView.FColumnsAppearance.FLayouts:1 in this.FTableView.FTreeView.FColumnsAppearance.FLayouts),e},this.SetVisible=function(e){null!=this.FTableView&&null!=this.FTableView.FTreeView&&(t.TTMSFNCTableViewHeader.isPrototypeOf(this)?e?this.FTableView.FTreeView.FColumnsAppearance.SetLayouts(rtl.unionSet(this.FTableView.FTreeView.FColumnsAppearance.FLayouts,rtl.createSet(0))):this.FTableView.FTreeView.FColumnsAppearance.SetLayouts(rtl.diffSet(this.FTableView.FTreeView.FColumnsAppearance.FLayouts,rtl.createSet(0))):e?this.FTableView.FTreeView.FColumnsAppearance.SetLayouts(rtl.unionSet(this.FTableView.FTreeView.FColumnsAppearance.FLayouts,rtl.createSet(1))):this.FTableView.FTreeView.FColumnsAppearance.SetLayouts(rtl.diffSet(this.FTableView.FTreeView.FColumnsAppearance.FLayouts,rtl.createSet(1))),this.FTableView.UpdateTableView(!1))},this.SetText=function(t){this.FText!==t&&(this.FText=t,null!=this.FTableView&&null!=this.FTableView.FTreeView&&this.FTableView.FTreeView.Invalidate())},this.GetFill=function(){var e=null;return e=null,null!=this.FTableView&&null!=this.FTableView.FTreeView&&(e=t.TTMSFNCTableViewHeader.isPrototypeOf(this)?this.FTableView.FTreeView.FColumnsAppearance.FTopFill:this.FTableView.FTreeView.FColumnsAppearance.FBottomFill),e},this.GetHeight=function(){var e=0;return e=30,null!=this.FTableView&&null!=this.FTableView.FTreeView&&(e=t.TTMSFNCTableViewHeader.isPrototypeOf(this)?this.FTableView.FTreeView.FColumnsAppearance.FTopSize:this.FTableView.FTreeView.FColumnsAppearance.FBottomSize),e},this.GetStroke=function(){var e=null;return e=null,null!=this.FTableView&&null!=this.FTableView.FTreeView&&(e=t.TTMSFNCTableViewHeader.isPrototypeOf(this)?this.FTableView.FTreeView.FColumnsAppearance.FTopStroke:this.FTableView.FTreeView.FColumnsAppearance.FBottomStroke),e},this.SetFill=function(e){null!=this.FTableView&&null!=this.FTableView.FTreeView&&(t.TTMSFNCTableViewHeader.isPrototypeOf(this)?this.FTableView.FTreeView.FColumnsAppearance.FTopFill.Assign(e):this.FTableView.FTreeView.FColumnsAppearance.FBottomFill.Assign(e))},this.SetHorizontalTextAlign=function(t){this.FHorizontalTextAlign!==t&&(this.FHorizontalTextAlign=t,null!=this.FTableView&&null!=this.FTableView.FTreeView&&this.FTableView.FTreeView.Invalidate())},this.SetHeight=function(e){null!=this.FTableView&&null!=this.FTableView.FTreeView&&(t.TTMSFNCTableViewHeader.isPrototypeOf(this)?this.FTableView.FTreeView.FColumnsAppearance.SetTopSize(e):this.FTableView.FTreeView.FColumnsAppearance.SetBottomSize(e))},this.SetStroke=function(t){null!=this.FTableView&&null!=this.FTableView.FTreeView&&this.FTableView.FTreeView.FColumnsAppearance.FTopStroke.Assign(t)},this.SetVerticalTextAlign=function(t){this.FVerticalTextAlign!==t&&(this.FVerticalTextAlign=t,null!=this.FTableView&&null!=this.FTableView.FTreeView&&this.FTableView.FTreeView.Invalidate())},this.GetFont=function(){var e=null;return e=null,null!=this.FTableView&&null!=this.FTableView.FTreeView&&(e=t.TTMSFNCTableViewHeader.isPrototypeOf(this)?this.FTableView.FTreeView.FColumnsAppearance.FTopFont:this.FTableView.FTreeView.FColumnsAppearance.FBottomFont),e},this.SetFont=function(e){null!=this.FTableView&&null!=this.FTableView.FTreeView&&(t.TTMSFNCTableViewHeader.isPrototypeOf(this)?this.FTableView.FTreeView.FColumnsAppearance.FTopFill.Assign(e):this.FTableView.FTreeView.FColumnsAppearance.FBottomFill.Assign(e))},this.SetTrimming=function(t){this.FTrimming!==t&&(this.FTrimming=t,null!=this.FTableView&&null!=this.FTableView.FTreeView&&this.FTableView.FTreeView.Invalidate())},this.SetWordWrapping=function(t){this.FWordWrapping!==t&&(this.FWordWrapping=t,null!=this.FTableView&&null!=this.FTableView.FTreeView&&this.FTableView.FTreeView.Invalidate())},this.GetSortIndicatorColor=function(){var t=0;return t=16297243,null!=this.FTableView&&null!=this.FTableView.FTreeView&&(t=this.FTableView.FTreeView.FColumnsAppearance.FSortIndicatorColor),t},this.SetSortIndicatorColor=function(t){null!=this.FTableView&&null!=this.FTableView.FTreeView&&this.FTableView.FTreeView.FColumnsAppearance.SetSortIndicatorColor(t)},this.Assign=function(e){t.TTMSFNCTableViewHeaderFooter.isPrototypeOf(e)&&(this.SetVisible(rtl.as(e,t.TTMSFNCTableViewHeaderFooter).GetVisible()),this.SetText(rtl.as(e,t.TTMSFNCTableViewHeaderFooter).FText),this.GetFill().Assign(rtl.as(e,t.TTMSFNCTableViewHeaderFooter).GetFill()),this.GetFont().Assign(rtl.as(e,t.TTMSFNCTableViewHeaderFooter).GetFont()),this.GetStroke().Assign(rtl.as(e,t.TTMSFNCTableViewHeaderFooter).GetStroke()),this.SetHorizontalTextAlign(rtl.as(e,t.TTMSFNCTableViewHeaderFooter).FHorizontalTextAlign),this.SetVerticalTextAlign(rtl.as(e,t.TTMSFNCTableViewHeaderFooter).FVerticalTextAlign),this.SetWordWrapping(rtl.as(e,t.TTMSFNCTableViewHeaderFooter).FWordWrapping),this.SetTrimming(rtl.as(e,t.TTMSFNCTableViewHeaderFooter).FTrimming),this.SetHeight(rtl.as(e,t.TTMSFNCTableViewHeaderFooter).GetHeight()),this.SetSortIndicatorColor(rtl.as(e,t.TTMSFNCTableViewHeaderFooter).GetSortIndicatorColor()))},this.Create$1=function(e){return this.FTableView=e,null!=this.FTableView&&this.FTableView.IsDesignTime()&&(t.TTMSFNCTableViewHeader.isPrototypeOf(this)?this.FText="Header":this.FText="Footer",this.GetFill().SetColor(pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(249,249,249)),this.GetFill().SetKind(1),this.GetStroke().SetColor(pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(178,178,178)),this.GetStroke().SetKind(1)),this}})),rtl.createClass(this,"TTMSFNCTableViewHeader",this.TTMSFNCTableViewHeaderFooter,(function(){var t=this.$rtti;t.addProperty("Visible",3,rtl.boolean,"GetVisible","SetVisible",{Default:!0}),t.addProperty("Text",2,rtl.string,"FText","SetText"),t.addProperty("Fill",3,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"GetFill","SetFill"),t.addProperty("Font",3,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFont,"GetFont","SetFont"),t.addProperty("Stroke",3,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"GetStroke","SetStroke"),t.addProperty("HorizontalTextAlign",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsTextAlign,"FHorizontalTextAlign","SetHorizontalTextAlign",{Default:pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsTextAlign.gtaCenter}),t.addProperty("VerticalTextAlign",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsTextAlign,"FVerticalTextAlign","SetVerticalTextAlign",{Default:pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsTextAlign.gtaCenter}),t.addProperty("WordWrapping",2,rtl.boolean,"FWordWrapping","SetWordWrapping",{Default:!1}),t.addProperty("Trimming",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsTextTrimming,"FTrimming","SetTrimming",{Default:pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsTextTrimming.gttNone}),t.addProperty("Height",3,rtl.double,"GetHeight","SetHeight")})),rtl.createClass(this,"TTMSFNCTableViewFooter",this.TTMSFNCTableViewHeaderFooter,(function(){var t=this.$rtti;t.addProperty("Visible",3,rtl.boolean,"GetVisible","SetVisible",{Default:!0}),t.addProperty("Text",2,rtl.string,"FText","SetText"),t.addProperty("Fill",3,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"GetFill","SetFill"),t.addProperty("Font",3,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFont,"GetFont","SetFont"),t.addProperty("Stroke",3,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"GetStroke","SetStroke"),t.addProperty("HorizontalTextAlign",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsTextAlign,"FHorizontalTextAlign","SetHorizontalTextAlign",{Default:pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsTextAlign.gtaCenter}),t.addProperty("VerticalTextAlign",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsTextAlign,"FVerticalTextAlign","SetVerticalTextAlign",{Default:pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsTextAlign.gtaCenter}),t.addProperty("WordWrapping",2,rtl.boolean,"FWordWrapping","SetWordWrapping",{Default:!1}),t.addProperty("Trimming",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsTextTrimming,"FTrimming","SetTrimming",{Default:pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsTextTrimming.gttNone}),t.addProperty("Height",3,rtl.double,"GetHeight","SetHeight")})),rtl.createClass(this,"TTMSFNCTableViewCopyItems",this.TTMSFNCTableViewItems,(function(){})),this.$rtti.$MethodVar("TTMSFNCTableViewItemAnchorClickEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AItem",this.$rtti.TTMSFNCTableViewItem],["AAnchor",rtl.string]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTableViewBeforeDrawItemTextEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["AItem",this.$rtti.TTMSFNCTableViewItem],["AText",rtl.string],["AAllow",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTableViewAfterDrawItemTextEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["AItem",this.$rtti.TTMSFNCTableViewItem],["AText",rtl.string]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTableViewItemSelectedEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AItem",this.$rtti.TTMSFNCTableViewItem]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTableViewItemUnSelectedEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AItem",this.$rtti.TTMSFNCTableViewItem]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTableViewItemClickEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AItem",this.$rtti.TTMSFNCTableViewItem]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTableViewItemMouseEnterEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AItem",this.$rtti.TTMSFNCTableViewItem]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTableViewItemMouseLeaveEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AItem",this.$rtti.TTMSFNCTableViewItem]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTableViewItemCheckChangedEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AItem",this.$rtti.TTMSFNCTableViewItem]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTableViewScrollEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["APosition",rtl.double]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTableViewBeforeDrawItemIconEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["AItem",this.$rtti.TTMSFNCTableViewItem],["AIcon",pas["WEBLib.TMSFNCTypes"].$rtti.TTMSFNCBitmap],["AAllow",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTableViewAfterDrawItemIconEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["AItem",this.$rtti.TTMSFNCTableViewItem],["AIcon",pas["WEBLib.TMSFNCTypes"].$rtti.TTMSFNCBitmap]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTableViewBeforeDrawItemCheckEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["AItem",this.$rtti.TTMSFNCTableViewItem],["ACheck",pas["WEBLib.TMSFNCTypes"].$rtti.TTMSFNCBitmap],["AAllow",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTableViewAfterDrawItemCheckEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["AItem",this.$rtti.TTMSFNCTableViewItem],["ACheck",pas["WEBLib.TMSFNCTypes"].$rtti.TTMSFNCBitmap]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTableViewBeforeDrawItemEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["AItem",this.$rtti.TTMSFNCTableViewItem],["AAllow",rtl.boolean,1],["ADefaultDraw",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTableViewAfterDrawItemEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["AItem",this.$rtti.TTMSFNCTableViewItem]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTableViewItemCompareEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["Item1",this.$rtti.TTMSFNCTableViewItem],["Item2",this.$rtti.TTMSFNCTableViewItem],["ACompareResult",rtl.longint,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTableViewCategoryCompareEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["Category1",this.$rtti.TTMSFNCTableViewCategory],["Category2",this.$rtti.TTMSFNCTableViewCategory],["ACompareResult",rtl.longint,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTableViewGetHTMLTemplateValueEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AItem",this.$rtti.TTMSFNCTableViewItem],["AName",rtl.string],["AValue",rtl.string,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTableViewGetHTMLTemplateEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AItem",this.$rtti.TTMSFNCTableViewItem],["AHTMLTemplate",rtl.string,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTableViewAnchorHeaderFooterClick",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AAnchor",rtl.string]]),methodkind:0}),this.TTMSFNCTableViewFilterOperation={0:"tvfoSHORT",tvfoSHORT:0,1:"tvfoNONE",tvfoNONE:1,2:"tvfoAND",tvfoAND:2,3:"tvfoXOR",tvfoXOR:3,4:"tvfoOR",tvfoOR:4},this.$rtti.$Enum("TTMSFNCTableViewFilterOperation",{minvalue:0,maxvalue:4,ordtype:1,enumtype:this.TTMSFNCTableViewFilterOperation}),rtl.createClass(this,"TTMSFNCTableViewFilterData",pas.Classes.TCollectionItem,(function(){this.$init=function(){pas.Classes.TCollectionItem.$init.call(this),this.FCondition="",this.FCaseSensitive=!1,this.FSuffix="",this.FPrefix="",this.FOperation=0},this.Create$1=function(t){return pas.Classes.TCollectionItem.Create$1.apply(this,arguments),this.FCaseSensitive=!0,this},this.Assign=function(e){var i;null!=(i=rtl.as(e,t.TTMSFNCTableViewFilterData))&&(this.FCondition=i.FCondition,this.FCaseSensitive=i.FCaseSensitive,this.FPrefix=i.FPrefix,this.FSuffix=i.FSuffix,this.FOperation=i.FOperation)};var e=this.$rtti;e.addProperty("Condition",0,rtl.string,"FCondition","FCondition"),e.addProperty("CaseSensitive",0,rtl.boolean,"FCaseSensitive","FCaseSensitive",{Default:!0}),e.addProperty("Prefix",0,rtl.string,"FPrefix","FPrefix"),e.addProperty("Suffix",0,rtl.string,"FSuffix","FSuffix"),e.addProperty("Operation",0,t.$rtti.TTMSFNCTableViewFilterOperation,"FOperation","FOperation")})),rtl.createClass(this,"TTMSFNCTableViewFilter",pas["WEBLib.TMSFNCTypes"].TTMSFNCOwnedCollection,(function(){this.$init=function(){pas["WEBLib.TMSFNCTypes"].TTMSFNCOwnedCollection.$init.call(this),this.FOwner$1=null},this.$final=function(){this.FOwner$1=void 0,pas["WEBLib.TMSFNCTypes"].TTMSFNCOwnedCollection.$final.call(this)},this.GetItem$1=function(t){return pas.Classes.TCollection.GetItem.call(this,t)},this.Create$3=function(e){return pas.Classes.TOwnedCollection.Create$2.call(this,e,t.TTMSFNCTableViewFilterData),this.FOwner$1=e,this},this.Add$1=function(){var t=null;return t=pas.Classes.TCollection.Add.call(this),1===this.GetCount()?t.FOperation=1:t.FOperation=2,t}})),this.$rtti.$MethodVar("TTMSFNCTableViewBeforeApplyFilterEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AFilter",this.$rtti.TTMSFNCTableViewFilterData],["AAllow",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTableViewAfterApplyFilterEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AFilter",this.$rtti.TTMSFNCTableViewFilterData]]),methodkind:0}),rtl.createClass(this,"TTMSFNCTreeViewTableViewFloatingNodes",pas.contnrs.TObjectList,(function(){this.GetItem$1=function(t){return this.GetItem(t)}})),this.$rtti.$Class("TTMSFNCTableViewMoreOption"),rtl.createClass(this,"TTMSFNCTreeViewTableView",pas["WEBLib.TMSFNCTreeView"].TTMSFNCTreeView,(function(){this.$init=function(){pas["WEBLib.TMSFNCTreeView"].TTMSFNCTreeView.$init.call(this),this.FDownMoreOption=null,this.FMoreOffset=0,this.FMoreOffsetTo=0,this.FMoreOffsetItem=null,this.FDownAction=!1,this.FDownCount=0,this.FDownTimer=!1,this.FDownX$1=0,this.FDownY$1=0,this.FAnimTimer=null,this.FAnimateMoreOptions=!1,this.FAnimateMoreOptionsClose=!1,this.FMouseDownOnAccessory=!1,this.FAnimMarqueeSwitch=!1,this.FAnimMarqueeStartAngle=0,this.FAnimMarqueeSweepAngle=0,this.FAnimShiftAngle=0,this.FManualProgressSweepAngle=0,this.FManualProgressStartAngle=0,this.FReloadActive=!1,this.FMouseDownOnLookupBar=!1,this.FTableView=null,this.FFloatingNodes=null,this.FOnFooterAnchorClick=null,this.FOnHeaderAnchorClick=null},this.$final=function(){this.FDownMoreOption=void 0,this.FMoreOffsetItem=void 0,this.FAnimTimer=void 0,this.FTableView=void 0,this.FFloatingNodes=void 0,this.FOnFooterAnchorClick=void 0,this.FOnHeaderAnchorClick=void 0,pas["WEBLib.TMSFNCTreeView"].TTMSFNCTreeView.$final.call(this)},this.AnimateTimerChanged=function(t){var i=0,s=0,o=!1;this.FAnimateMoreOptions||this.FAnimateMoreOptionsClose?(s=this.FMoreOffset,this.FInteraction.FAnimationFactor>0?(i=Math.abs(this.FMoreOffsetTo-s)/this.FInteraction.FAnimationFactor,o=e.AnimateDouble({get:function(){return s},set:function(t){s=t}},{p:this,get:function(){return this.p.FMoreOffsetTo},set:function(t){this.p.FMoreOffsetTo=t}},i,.01)):o=!1,o?this.FMoreOffset=s:(this.FMoreOffset=this.FMoreOffsetTo,this.FAnimTimer.SetEnabled(!1),this.FAnimateMoreOptionsClose&&(this.FMoreOffsetItem=null,this.FAnimateMoreOptionsClose=!1)),null!=this.FTableView&&this.FTableView.UpdateTableView(!0)):this.FDownTimer?(this.FDownCount+=1,150===this.FDownCount&&(this.FDownAction=!0,this.FAnimTimer.SetEnabled(!1),null!=this.FTableView&&this.FTableView.ToggleEditMode())):(this.FAnimShiftAngle=this.FAnimShiftAngle+5,360===this.FAnimShiftAngle&&(this.FAnimShiftAngle=0),this.FAnimMarqueeSwitch?(this.FAnimMarqueeStartAngle=this.FAnimMarqueeStartAngle+10,this.FAnimMarqueeSweepAngle=this.FAnimMarqueeSweepAngle-10):this.FAnimMarqueeSweepAngle=this.FAnimMarqueeSweepAngle+10,360===this.FAnimMarqueeSweepAngle&&0===this.FAnimMarqueeStartAngle?this.FAnimMarqueeSwitch=!0:360===this.FAnimMarqueeStartAngle&&0===this.FAnimMarqueeSweepAngle&&(this.FAnimMarqueeSwitch=!1,this.FAnimMarqueeStartAngle=0),this.Invalidate())},this.OffsetNodeRects=function(t,e,i,s){null!=this.FFloatingNodes?this.FFloatingNodes.IndexOf$1(t)>-1?pas["WEBLib.TMSFNCCustomTreeView"].TTMSFNCCustomTreeView.OffsetNodeRects.call(this,t,e,Math.max(0,i),s):this.FMoreOffsetItem===this.FTableView.GetItemForNode(t)?pas["WEBLib.TMSFNCCustomTreeView"].TTMSFNCCustomTreeView.OffsetNodeRects.call(this,t,e-this.FMoreOffset,i,s):pas["WEBLib.TMSFNCCustomTreeView"].TTMSFNCCustomTreeView.OffsetNodeRects.apply(this,arguments):pas["WEBLib.TMSFNCCustomTreeView"].TTMSFNCCustomTreeView.OffsetNodeRects.apply(this,arguments)},this.CustomizeNodeCache=function(t,e){var i=null,s=0,o=0;pas["WEBLib.TMSFNCCustomTreeView"].TTMSFNCCustomTreeView.CustomizeNodeCache.apply(this,arguments),null!=this.FTableView&&0===this.FTableView.FUpdateCount$1&&0!==this.FTableView.FCategoryType&&(o=this.FTableView.GetDisplayCategoryIndex(this.StartRow()))>-1&&(this.FFloatingNodes.Clear(),(i=pas["WEBLib.TMSFNCTreeViewData"].TTMSFNCTreeViewVirtualNode.$create("Create$1",[this])).CopyFrom(this.GetNodeForRow(o)),s=0,this.ConfigureNode(t,0,i,{get:function(){return s},set:function(t){s=t}}),this.FFloatingNodes.Add$1(i))},this.CustomizeScrollPosition=function(t,e,i){pas["WEBLib.TMSFNCTreeViewData"].TTMSFNCTreeViewData.CustomizeScrollPosition.apply(this,arguments),this.FFloatingNodes.GetCount()>0&&!t.FExtended&&(e.set(e.get()-this.FFloatingNodes.GetItem$1(0).FHeight),i.set(i.get()-this.FFloatingNodes.GetItem$1(0).FHeight))},this.DrawLookupBar=function(e,i){var s=0,o=t.TTMSFNCTableViewLookupBarDisplayItem.$new(),n=pas["WEBLib.TMSFNCTypes"].TRectF.$new();if(null!=this.FTableView&&this.FTableView.FLookupBar.FVisible&&0!==this.FTableView.FCategoryType){n.$assign(this.GetLookupBarRect()),this.FMouseDownOnLookupBar?(e.FFill.Assign(this.FTableView.FLookupBar.FDownFill),e.FStroke.Assign(this.FTableView.FLookupBar.FDownStroke)):(e.FFill.Assign(this.FTableView.FLookupBar.FFill),e.FStroke.Assign(this.FTableView.FLookupBar.FStroke)),e.DrawRectangle$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(n),2);for(var r=0,a=this.FTableView.FLookupBarDisplayList.GetCount()-1;r<=a;r++)s=r,o.$assign(this.FTableView.FLookupBarDisplayList.GetItem(s)),o.Active?e.FFont.Assign(this.FTableView.FLookupBar.FFont):e.FFont.Assign(this.FTableView.FLookupBar.FInActiveFont),e.DrawText$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(o.Rect),o.Text,!1,0,0,0,0,-1,-1,!0,!1,-1,-1)}},this.DrawReload=function(t,e){var i=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),s=0;if(null!=this.FTableView&&this.FTableView.FReload.FEnabled&&this.FReloadActive){i.$assign(this.GetNodesRect()),s=this.FTableView.FReload.FSize,i.$assign(pas["WEBLib.TMSFNCTypes"].RectF(i.Left+(i.Right-i.Left-s)/2,i.Top+(this.FTableView.FReload.FOffset-s)/2,i.Left+(i.Right-i.Left-s)/2+s,i.Top+(this.FTableView.FReload.FOffset-s)/2+s)),t.FStroke.Assign(this.FTableView.FReload.FStroke);var o=this.FTableView.FReload.FProgressMode;0===o?t.DrawArc(pas["WEBLib.TMSFNCTypes"].CenterPointEx(i),pas["WEBLib.TMSFNCTypes"].PointF((i.Right-i.Left)/2,(i.Bottom-i.Top)/2),this.FAnimMarqueeStartAngle,this.FAnimMarqueeSweepAngle):1===o?t.DrawArc(pas["WEBLib.TMSFNCTypes"].CenterPointEx(i),pas["WEBLib.TMSFNCTypes"].PointF((i.Right-i.Left)/2,(i.Bottom-i.Top)/2),this.FAnimShiftAngle+this.FAnimMarqueeStartAngle,this.FAnimMarqueeSweepAngle):2===o&&t.DrawArc(pas["WEBLib.TMSFNCTypes"].CenterPointEx(i),pas["WEBLib.TMSFNCTypes"].PointF((i.Right-i.Left)/2,(i.Bottom-i.Top)/2),this.FManualProgressStartAngle,this.FManualProgressSweepAngle)}},this.HandleMouseUp=function(t,e,i,s){var o=!1,n=null,r="";return null!=this.FDownMoreOption&&(n=this.FDownMoreOption,this.FDownMoreOption=null,this.Invalidate(),this.FAnimateMoreOptions)?(this.FAnimateMoreOptions=!1,this.FAnimateMoreOptionsClose=!0,this.FMoreOffsetTo=0,this.FAnimTimer.SetEnabled(!0),pas["WEBLib.TMSFNCCustomTreeView"].TTMSFNCCustomTreeView.HandleMouseUp.apply(this,arguments),this.FBlockMouseClick=!1,void(null!=this.FTableView&&null!=this.FMoreOffsetItem&&null!=n&&this.FTableView.DoItemMoreOptionClick(this.FMoreOffsetItem,n))):this.FDownTimer&&!this.FAnimateMoreOptions&&!this.FAnimateMoreOptionsClose&&(this.FDownCount=0,this.FDownTimer=!1,this.FAnimTimer.SetEnabled(!1),this.FDownAction)?(this.FDownAction=!1,this.FBlockUserInput=!0,pas["WEBLib.TMSFNCCustomTreeView"].TTMSFNCCustomTreeView.HandleMouseUp.apply(this,arguments),this.FIsMouseDown=!1,void(this.FBlockUserInput=!1)):(pas["WEBLib.TMSFNCCustomTreeView"].TTMSFNCCustomTreeView.HandleMouseUp.apply(this,arguments),o=!1,this.FMouseDownOnLookupBar&&(this.ReleaseCaptureEx(),this.ProcessLookup(i,s,!1),o=!0),this.FMouseDownOnAccessory&&(this.ReleaseCaptureEx(),null!=this.FTableView&&(null!=this.FTableView.FActiveAccessoryItem&&this.FTableView.DoItemAccessoryClick(this.FTableView.FActiveAccessoryItem),this.FTableView.FActiveAccessoryItem=null),o=!0),o&&(this.FMouseDownOnAccessory=!1,this.FMouseDownOnLookupBar=!1,this.FBlockUserInput=!1),""!==(r=this.XYToFooterAnchor(i,s))?this.DoFooterAnchorClick(r):""!==(r=this.XYToHeaderAnchor(i,s))&&this.DoHeaderAnchorClick(r),void this.Invalidate())},this.HandleMouseDown=function(t,e,i,s){var o=null;return null!=this.FTableView&&(this.FDownMoreOption=this.FTableView.XYToMoreOption(i,s),null!=this.FDownMoreOption)?(this.FBlockUserInput=!0,pas["WEBLib.TMSFNCCustomTreeView"].TTMSFNCCustomTreeView.HandleMouseDown.apply(this,arguments),this.FBlockUserInput=!1,void this.Invalidate()):this.FAnimateMoreOptions?(this.FAnimateMoreOptions=!1,this.FAnimateMoreOptionsClose=!0,this.FMoreOffsetTo=0,this.FAnimTimer.SetEnabled(!0),pas["WEBLib.TMSFNCCustomTreeView"].TTMSFNCCustomTreeView.HandleMouseDown.apply(this,arguments),void(this.FBlockMouseClick=!1)):void(this.FBlockUserInput?pas["WEBLib.TMSFNCCustomTreeView"].TTMSFNCCustomTreeView.HandleMouseDown.apply(this,arguments):(o=null,this.FMouseDownOnLookupBar=pas["WEBLib.TMSFNCTypes"].PtInRectEx(this.GetLookupBarRect(),pas["WEBLib.TMSFNCTypes"].PointF(i,s)),this.FMouseDownOnLookupBar||null==this.FTableView||this.IsAnimating()||(o=this.FTableView.XYToAccessoryItem(i,s),this.FMouseDownOnAccessory=null!=o),this.FBlockUserInput=this.FMouseDownOnLookupBar||this.FMouseDownOnAccessory,pas["WEBLib.TMSFNCCustomTreeView"].TTMSFNCCustomTreeView.HandleMouseDown.apply(this,arguments),this.FMouseDownOnLookupBar&&(this.CaptureEx(),this.StopAnimationTimer(),this.ProcessLookup(i,s,!0),this.Invalidate()),this.FMouseDownOnAccessory&&(this.CaptureEx(),this.StopAnimationTimer(),null!=this.FTableView&&(this.FTableView.FActiveAccessoryItem=o),this.Invalidate()),this.FDownX$1=i,this.FDownY$1=s,this.FMouseDownOnAccessory||this.FMouseDownOnLookupBar||null==this.FTableView||!this.FTableView.FInteraction.FLongPressToEdit||(this.FDownAction=!1,this.FDownTimer=!0,this.FDownCount=0,this.FAnimTimer.SetEnabled(!0))))},this.HandleMouseMove=function(t,e,i){var s=0;pas["WEBLib.TMSFNCCustomTreeView"].TTMSFNCCustomTreeView.HandleMouseMove.apply(this,arguments),s=this.FCursor,!this.FDownTimer||this.FAnimateMoreOptions||this.FAnimateMoreOptionsClose||(Math.abs(e-this.FDownX$1)>5||Math.abs(i-this.FDownY$1)>5)&&(this.FDownAction=!1,this.FDownCount=0,this.FDownTimer=!1,this.FAnimTimer.SetEnabled(!1)),null!=this.FTableView&&this.FTableView.FMoreOptions.GetCount()>0&&this.FTableView.FInteraction.FSwipeToShowMoreOptions&&null==this.FMoreOffsetItem&&this.FIsMouseDown&&!this.FBlockUserInput&&!this.FBlockMouseClick&&Math.abs(e-this.FDownX$1)>30&&Math.abs(i-this.FDownY$1)<=5&&(this.FMoreOffsetItem=this.FTableView.XYToItem(e,i),null!=this.FMoreOffsetItem&&this.FMoreOffsetItem.FEnableMoreOptions&&(this.FMoreOffsetTo=this.FTableView.GetMoreOptionsSize(),this.FBlockMouseClick=!0,this.FAnimateMoreOptions=!0,this.FAnimTimer.SetEnabled(!0))),(""!==this.XYToHeaderAnchor(e,i)||""!==this.XYToFooterAnchor(e,i))&&(s=21),s!==this.FCursor&&this.SetControlCursor(s),this.FMouseDownOnLookupBar&&this.ProcessLookup(e,i,!0)},this.HandleKeyDown=function(t,e){if(pas["WEBLib.TMSFNCCustomTreeView"].TTMSFNCCustomTreeView.HandleKeyDown.apply(this,arguments),!this.FBlockUserInput&&null!=this.FTableView&&t.get()in rtl.createSet(27)&&this.FTableView.FFilterActive){var i=this.FTableView.FInteraction.FKeyboardEscapeMode;0===i||(1===i?(this.FTableView.FFilterActive=!1,this.FTableView.StartFiltering()):2===i&&this.FTableView.StopFiltering())}},this.ProcessLookup=function(t,e,i){var s=0,o="",n=0,r=0;if(null!=this.FTableView){var a=this.FTableView.FCategoryType;if(4===a)(s=this.GetCategoryAtXY(t,e))>-1&&s<this.FTableView.FCategories.GetCount()&&(n=this.FTableView.FCategories.GetItem$1(s).FID$1,this.FTableView.FCustomChar.IsIDActive(n)&&(i?this.FTableView.LookupCustomCategory(n):null!=this.FTableView.FOnCategoryClick&&this.FTableView.FOnCategoryClick(this,"",n)));else if(1===a||2===a||3===a){s=0;for(var l=0,h=this.FTableView.FLookupBarDisplayList.GetCount()-1;l<=h;l++)if(r=l,pas["WEBLib.TMSFNCTypes"].PtInRectEx(this.FTableView.FLookupBarDisplayList.GetItem(r).Rect,pas["WEBLib.TMSFNCTypes"].PointF(t,e))){s=r+1;break}s>=1&&s<=this.FTableView.GetCharacterCount()&&null!=this.FTableView&&""!==(o=this.FTableView.GetCharacter(s))&&(i?this.FTableView.LookupCategory(o):null!=this.FTableView.FOnCategoryClick&&this.FTableView.FOnCategoryClick(this,o,-1))}}},this.StartReload=function(){pas["WEBLib.TMSFNCCustomTreeView"].TTMSFNCCustomTreeView.StartReload.call(this),this.FReloadActive=!0,this.FBlockUserInput=!0,null!=this.FTableView&&(this.FManualProgressSweepAngle=0,this.FManualProgressStartAngle=0,this.FAnimTimer.SetEnabled(2!==this.FTableView.FReload.FProgressMode),this.FTableView.DoStartReload())},this.UpdateCheckState=function(e,i,s){var o=t.TTMSFNCTableViewDisplayItem.$new();if(pas["WEBLib.TMSFNCTreeViewData"].TTMSFNCTreeViewData.UpdateCheckState.apply(this,arguments),null!=this.FTableView&&e.FRow>=0&&e.FRow<=this.FTableView.FDisplayList.GetCount()-1){o.$assign(this.FTableView.FDisplayList.GetItem(e.FRow));var n=o.Kind;1===n&&(null!=o.Item&&(o.Item.FChecked=s),this.FTableView.SelectAllCheckedItems())}},this.ScrollLimitation=function(){return!0,!0},this.NeedsReload=function(t){var e=!1;return e=pas["WEBLib.TMSFNCCustomTreeView"].TTMSFNCCustomTreeView.NeedsReload.call(this,t),null==this.FTableView||!this.FTableView.FReload.FEnabled||null!=this.FTableView.FActiveDetailControl||this.FTableView.FEditMode||this.FTableView.FFilterActive||(e=t>=this.FTableView.FReload.FOffset),e},this.GetReloadOffset=function(){var t=0;return t=pas["WEBLib.TMSFNCCustomTreeView"].TTMSFNCCustomTreeView.GetReloadOffset.call(this),null!=this.FTableView&&this.FTableView.FReload.FEnabled&&(t+=this.FTableView.FReload.FOffset),t},this.GetNodesRect=function(){var t=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),e=0;if(t.$assign(pas["WEBLib.TMSFNCCustomTreeView"].TTMSFNCCustomTreeView.GetNodesRect.call(this)),null!=this.FTableView){if(e=t.Right-t.Left-this.FTableView.FDetailControlOffset,this.FTableView.FLookupBar.FVisible&&0!==this.FTableView.FCategoryType){var i=this.FTableView.FLookupBar.FPosition;0===i?(t.Left=t.Left+this.FTableView.FLookupBar.FWidth-1,t.Right=t.Right-this.FTableView.FLookupBar.FWidth-1):1===i&&(t.Right=t.Right-this.FTableView.FLookupBar.FWidth)}t.Left=t.Left-e,t.Right=t.Right-e}return t},this.GetContentRect=function(){var t=pas["WEBLib.TMSFNCTypes"].TRectF.$new();return t.$assign(pas["WEBLib.TMSFNCCustomTreeView"].TTMSFNCCustomTreeView.GetContentRect.call(this)),null!=this.FTableView&&this.FTableView.FFilterActive&&(t.Top=t.Top+this.FTableView.FEdit.GetHeight()),t},this.GetCategoryAtXY=function(t,e){var i=0,s=0,o=0,n=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),r="",a=0,l=null,h=pas["WEBLib.TMSFNCTypes"].TRectF.$new();if(i=-1,null==this.FTableView)return i;(l=pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.$create("CreateBitmapCanvas",[1,1,!1,!0])).BeginScene();try{l.FFont.Assign(this.FTableView.FLookupBar.FFont),o=this.FTableView.FCategories.GetCount()-1,h.$assign(this.GetLookupBarRect()),a=h.Top+3;for(var F=0,p=o;F<=p;F++)if(s=F,r=this.FTableView.FCategories.GetItem$1(s).FLookupText,n.Left=h.Left,n.Right=h.Right,n.Top=a,n.Bottom=n.Top+l.CalculateTextHeight$1(r),a=a+(n.Bottom-n.Top)+3,pas["WEBLib.TMSFNCTypes"].PtInRectEx(n,pas["WEBLib.TMSFNCTypes"].PointF(t,e))){i=s;break}}finally{l.EndScene(),l=rtl.freeLoc(l)}return i},this.GetLookupBarRect=function(){var t=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),e=0,i=0;if(t.$assign(pas["WEBLib.TMSFNCTypes"].EmptyRect()),null!=this.FTableView&&this.FTableView.FLookupBar.FVisible&&0!==this.FTableView.FCategoryType){e=this.FTableView.FLookupBar.FWidth,t.$assign(this.GetContentRect()),i=t.Right-t.Left-this.FTableView.FDetailControlOffset;var s=this.FTableView.FLookupBar.FPosition;0===s?(t.Right=t.Left+e,t.Left=t.Left+1,t.Top=t.Top+1,t.Bottom=t.Bottom-1):1===s&&(t.Left=t.Right-e,t.Top=t.Top+1,t.Bottom=t.Bottom-1,t.Right=t.Right-1),t.Left=t.Left-i,t.Right=t.Right-i}return t},this.GetContentClipRect=function(){var t=pas["WEBLib.TMSFNCTypes"].TRectF.$new();return t.$assign(pas["WEBLib.TMSFNCCustomTreeView"].TTMSFNCCustomTreeView.GetContentRect.call(this)),t.Left=t.Left+1,t.Right=t.Right-1,t},this.CanApplyVerticalOffset=function(){var t=!1;return t=!1,null!=this.FTableView&&null!=this.FTableView.FInteraction&&(t=this.FTableView.FInteraction.FSwipeBounceGesture),t},this.XYToHeaderAnchor=function(t,e){var i="",s=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),o=null;i="",s.$assign(pas["WEBLib.TMSFNCTypes"].RectF(0,0,this.GetWidth(),this.FTableView.FHeader.GetHeight())),(o=pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.$create("CreateBitmapCanvas",[1,1,!1,!0])).BeginScene(),o.FBitmapContainer=this.GetBitmapContainer(),o.FFont.Assign(this.FTableView.FHeader.GetFont());try{i=o.DrawText$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(s),this.FTableView.FHeader.FText,this.FTableView.FHeader.FWordWrapping,this.FTableView.FHeader.FHorizontalTextAlign,this.FTableView.FHeader.FVerticalTextAlign,this.FTableView.FHeader.FTrimming,0,-1,-1,!0,!0,t,e)}finally{o.EndScene(),o=rtl.freeLoc(o)}return i},this.XYToFooterAnchor=function(t,e){var i="",s=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),o=null;i="",s.$assign(pas["WEBLib.TMSFNCTypes"].RectF(0,this.GetHeight()-this.FTableView.FFooter.GetHeight(),this.GetWidth(),this.GetHeight())),(o=pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.$create("CreateBitmapCanvas",[1,1,!1,!0])).BeginScene(),o.FBitmapContainer=this.GetBitmapContainer(),o.FFont.Assign(this.FTableView.FFooter.GetFont());try{i=o.DrawText$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(s),this.FTableView.FFooter.FText,this.FTableView.FFooter.FWordWrapping,this.FTableView.FFooter.FHorizontalTextAlign,this.FTableView.FFooter.FVerticalTextAlign,this.FTableView.FFooter.FTrimming,0,-1,-1,!0,!0,t,e)}finally{o.EndScene(),o=rtl.freeLoc(o)}return i},this.DoHeaderAnchorClick=function(t){null!=this.FOnHeaderAnchorClick?this.FOnHeaderAnchorClick(this,t):this.FInteraction.FAutoOpenURL&&pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.OpenURL(t)},this.DoFooterAnchorClick=function(t){null!=this.FOnFooterAnchorClick?this.FOnFooterAnchorClick(this,t):this.FInteraction.FAutoOpenURL&&pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.OpenURL(t)},this.Create$1=function(e){return pas["WEBLib.TMSFNCCustomTreeView"].TTMSFNCCustomTreeView.Create$1.apply(this,arguments),this.FAnimMarqueeStartAngle=0,this.FManualProgressSweepAngle=0,this.FManualProgressStartAngle=0,this.FAnimMarqueeSweepAngle=0,this.FMoreOffset=0,this.FMoreOffsetTo=0,this.FAnimMarqueeSwitch=!1,this.FFloatingNodes=t.TTMSFNCTreeViewTableViewFloatingNodes.$create("Create$2"),this.FAnimTimer=pas["WEBLib.ExtCtrls"].TTimer.$create("Create$1",[this]),this.FAnimTimer.SetEnabled(!1),this.FAnimTimer.SetInterval(1),this.FAnimTimer.FOnTimer=rtl.createCallback(this,"AnimateTimerChanged"),this},this.Destroy=function(){rtl.free(this,"FAnimTimer"),rtl.free(this,"FFloatingNodes"),pas["WEBLib.TMSFNCCustomTreeView"].TTMSFNCCustomTreeView.Destroy.call(this)},this.Draw=function(t,e){pas["WEBLib.TMSFNCCustomTreeView"].TTMSFNCCustomTreeView.Draw.apply(this,arguments),this.DrawLookupBar(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e)),this.DrawReload(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e))},this.GetTotalColumnNodeWidth=function(){var t=0;return t=pas["WEBLib.TMSFNCTreeViewBase"].TTMSFNCTreeViewBase.GetTotalColumnNodeWidth.call(this),null!=this.FTableView&&this.FTableView.FLookupBar.FVisible&&0!==this.FTableView.FCategoryType&&(t-=this.FTableView.FLookupBar.FWidth),t},this.GetColumnWidth=function(t){var e=0;return e=pas["WEBLib.TMSFNCTreeViewBase"].TTMSFNCTreeViewBase.GetColumnWidth.call(this,t),null!=this.FTableView&&this.FTableView.FLookupBar.FVisible&&0!==this.FTableView.FCategoryType&&(e-=this.FTableView.FLookupBar.FWidth),e},rtl.addIntf(this,pas["WEBLib.TMSFNCControlPicker"].ITMSFNCControlPickerFull),rtl.addIntf(this,pas["WEBLib.TMSFNCGraphicsTypes"].ITMSFNCAppearanceGlobalFont),rtl.addIntf(this,pas["WEBLib.TMSFNCBitmapContainer"].ITMSFNCBitmapContainer),rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas["WEBLib.TMSFNCTypes"].ITMSFNCProductInfo),rtl.addIntf(this,pas.System.IUnknown)})),this.TTMSFNCTableViewDisplayItemKind={0:"tvikNone",tvikNone:0,1:"tvikItem",tvikItem:1,2:"tvikCategory",tvikCategory:2},rtl.recNewT(this,"TTMSFNCTableViewDisplayItem",(function(){this.Kind=0,this.Item=null,this.CategoryID=0,this.Row=0,this.Text="",this.$eq=function(t){return this.Kind===t.Kind&&this.Item===t.Item&&this.CategoryID===t.CategoryID&&this.Row===t.Row&&this.Text===t.Text},this.$assign=function(t){return this.Kind=t.Kind,this.Item=t.Item,this.CategoryID=t.CategoryID,this.Row=t.Row,this.Text=t.Text,this}})),rtl.createClass(this,"TTMSFNCTableViewDisplayList",pas.Classes.TList,(function(){this.GetItem=function(e){var i=t.TTMSFNCTableViewDisplayItem.$new();return i.$assign(rtl.getObject(this.Get(e))),i}})),rtl.recNewT(this,"TTMSFNCTableViewLookupBarDisplayItem",(function(){this.Text="",this.Active=!1,this.$new=function(){var t=Object.create(this);return t.Rect=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),t},this.$eq=function(t){return this.Rect.$eq(t.Rect)&&this.Text===t.Text&&this.Active===t.Active},this.$assign=function(t){return this.Rect.$assign(t.Rect),this.Text=t.Text,this.Active=t.Active,this}})),rtl.createClass(this,"TTMSFNCTableViewLookupBarDisplayList",pas.Classes.TList,(function(){this.GetItem=function(e){var i=t.TTMSFNCTableViewLookupBarDisplayItem.$new();return i.$assign(rtl.getObject(this.Get(e))),i}})),this.TTMSFNCTableViewLookupBarPosition={0:"tvlbpLeft",tvlbpLeft:0,1:"tvlbpRight",tvlbpRight:1},this.$rtti.$Enum("TTMSFNCTableViewLookupBarPosition",{minvalue:0,maxvalue:1,ordtype:1,enumtype:this.TTMSFNCTableViewLookupBarPosition}),rtl.createClass(this,"TTMSFNCTableViewLookupBar",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FTableView=null,this.FVisible=!1,this.FFont=null,this.FAutoLookup=!1,this.FFill=null,this.FStroke=null,this.FWidth=0,this.FPosition=0,this.FDownFill=null,this.FDownStroke=null,this.FInActiveFont=null},this.$final=function(){this.FTableView=void 0,this.FFont=void 0,this.FFill=void 0,this.FStroke=void 0,this.FDownFill=void 0,this.FDownStroke=void 0,this.FInActiveFont=void 0,pas.Classes.TPersistent.$final.call(this)},this.SetVisible=function(t){this.FVisible!==t&&(this.FVisible=t,null!=this.FTableView&&this.FTableView.UpdateTableView(!1))},this.SetFont=function(t){this.FFont.Assign(t)},this.SetAutoLookup=function(t){this.FAutoLookup=t},this.SetFill=function(t){this.FFill.Assign(t)},this.SetStroke=function(t){this.FStroke.Assign(t)},this.IsWidthStored=function(){return 25!==this.FWidth},this.SetPosition=function(t){this.FPosition!==t&&(this.FPosition=t,null!=this.FTableView&&this.FTableView.UpdateTableView(!1))},this.SetWidth=function(t){this.FWidth!==t&&(this.FWidth=t,null!=this.FTableView&&this.FTableView.UpdateTableView(!1))},this.SetDownFill=function(t){this.FDownFill.Assign(t)},this.SetDownStroke=function(t){this.FDownStroke.Assign(t)},this.SetInActiveFont=function(t){this.FInActiveFont.Assign(t)},this.FontChanged=function(t){null!=this.FTableView&&this.FTableView.UpdateTableView(!1)},this.StrokeChanged=function(t){null!=this.FTableView&&this.FTableView.UpdateTableView(!1)},this.FillChanged=function(t){null!=this.FTableView&&this.FTableView.UpdateTableView(!1)},this.Create$1=function(t){return this.FTableView=t,this.FWidth=25,this.FVisible=!0,this.FPosition=1,this.FAutoLookup=!0,this.FFont=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFont.$create("Create$2"),this.FFont.FOnChanged=rtl.createCallback(this,"FontChanged"),this.FInActiveFont=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFont.$create("Create$2"),null!=this.FTableView&&this.FTableView.IsDesignTime()&&this.FInActiveFont.SetColor(12632256),this.FInActiveFont.FOnChanged=rtl.createCallback(this,"FontChanged"),this.FFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[1,16777215,8421504,-1,-1]),this.FFill.FOnChanged=rtl.createCallback(this,"FillChanged"),this.FStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,16777215]),this.FStroke.FOnChanged=rtl.createCallback(this,"StrokeChanged"),this.FDownFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[1,pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(249,249,249),8421504,-1,-1]),this.FDownFill.FOnChanged=rtl.createCallback(this,"FillChanged"),this.FDownStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(249,249,249)]),this.FDownStroke.FOnChanged=rtl.createCallback(this,"StrokeChanged"),this},this.Destroy=function(){rtl.free(this,"FFont"),rtl.free(this,"FInActiveFont"),rtl.free(this,"FFill"),rtl.free(this,"FStroke"),rtl.free(this,"FDownFill"),rtl.free(this,"FDownStroke"),pas.System.TObject.Destroy.call(this)},this.Assign=function(e){t.TTMSFNCTableViewLookupBar.isPrototypeOf(e)&&(this.FVisible=rtl.as(e,t.TTMSFNCTableViewLookupBar).FVisible,this.FFont.Assign(rtl.as(e,t.TTMSFNCTableViewLookupBar).FFont),this.FInActiveFont.Assign(rtl.as(e,t.TTMSFNCTableViewLookupBar).FInActiveFont),this.FStroke.Assign(rtl.as(e,t.TTMSFNCTableViewLookupBar).FStroke),this.FFill.Assign(rtl.as(e,t.TTMSFNCTableViewLookupBar).FFill),this.FAutoLookup=rtl.as(e,t.TTMSFNCTableViewLookupBar).FAutoLookup,this.FWidth=rtl.as(e,t.TTMSFNCTableViewLookupBar).FWidth,this.FPosition=rtl.as(e,t.TTMSFNCTableViewLookupBar).FPosition,this.FDownFill.Assign(rtl.as(e,t.TTMSFNCTableViewLookupBar).FDownFill),this.FDownStroke.Assign(rtl.as(e,t.TTMSFNCTableViewLookupBar).FDownStroke))};var e=this.$rtti;e.addProperty("Width",14,rtl.double,"FWidth","SetWidth",{stored:"IsWidthStored"}),e.addProperty("Position",2,t.$rtti.TTMSFNCTableViewLookupBarPosition,"FPosition","SetPosition",{Default:t.TTMSFNCTableViewLookupBarPosition.tvlbpRight}),e.addProperty("Visible",2,rtl.boolean,"FVisible","SetVisible",{Default:!0}),e.addProperty("Font",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFont,"FFont","SetFont"),e.addProperty("InActiveFont",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFont,"FInActiveFont","SetInActiveFont"),e.addProperty("AutoLookup",2,rtl.boolean,"FAutoLookup","SetAutoLookup",{Default:!0}),e.addProperty("Fill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FFill","SetFill"),e.addProperty("Stroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FStroke","SetStroke"),e.addProperty("DownFill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FDownFill","SetDownFill"),e.addProperty("DownStroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FDownStroke","SetDownStroke")})),this.TTMSFNCTableViewReloadProgressMode={0:"tvrpmMarquee",tvrpmMarquee:0,1:"tvrpmMarqueeAlternate",tvrpmMarqueeAlternate:1,2:"tvrpmManual",tvrpmManual:2},this.$rtti.$Enum("TTMSFNCTableViewReloadProgressMode",{minvalue:0,maxvalue:2,ordtype:1,enumtype:this.TTMSFNCTableViewReloadProgressMode}),rtl.createClass(this,"TTMSFNCTableViewReload",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FTableView=null,this.FOffset=0,this.FEnabled=!1,this.FStroke=null,this.FSize=0,this.FProgressMode=0},this.$final=function(){this.FTableView=void 0,this.FStroke=void 0,pas.Classes.TPersistent.$final.call(this)},this.IsOffsetStored=function(){return 40!==this.FOffset},this.SetOffset=function(t){this.FOffset!==t&&(this.FOffset=t)},this.SetEnabled=function(t){this.FEnabled!==t&&(this.FEnabled=t)},this.SetStroke=function(t){this.FStroke.Assign(t)},this.IsSizeStored=function(){return 20!==this.FSize},this.SetSize=function(t){this.FSize!==t&&(this.FSize=t)},this.SetProgressMode=function(t){this.FProgressMode!==t&&(this.FProgressMode=t)},this.Create$1=function(t){return this.FTableView=t,this.FOffset=40,this.FSize=20,this.FEnabled=!1,this.FProgressMode=0,this.FStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,11119017]),null!=this.FTableView&&this.FTableView.IsDesignTime()&&this.FStroke.SetWidth(2),this},this.Destroy=function(){rtl.free(this,"FStroke"),pas.System.TObject.Destroy.call(this)},this.Assign=function(e){t.TTMSFNCTableViewReload.isPrototypeOf(e)&&(this.FOffset=rtl.as(e,t.TTMSFNCTableViewReload).FOffset,this.FSize=rtl.as(e,t.TTMSFNCTableViewReload).FSize,this.FEnabled=rtl.as(e,t.TTMSFNCTableViewReload).FEnabled,this.FStroke.Assign(rtl.as(e,t.TTMSFNCTableViewReload).FStroke),this.FProgressMode=rtl.as(e,t.TTMSFNCTableViewReload).FProgressMode)};var e=this.$rtti;e.addProperty("Offset",14,rtl.double,"FOffset","SetOffset",{stored:"IsOffsetStored"}),e.addProperty("Enabled",2,rtl.boolean,"FEnabled","SetEnabled",{Default:!1}),e.addProperty("Stroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FStroke","SetStroke"),e.addProperty("Size",14,rtl.double,"FSize","SetSize",{stored:"IsSizeStored"}),e.addProperty("ProgressMode",2,t.$rtti.TTMSFNCTableViewReloadProgressMode,"FProgressMode","SetProgressMode",{Default:t.TTMSFNCTableViewReloadProgressMode.tvrpmMarquee})})),rtl.createClass(this,"TTMSFNCTableViewCategory",pas.Classes.TCollectionItem,(function(){this.$init=function(){pas.Classes.TCollectionItem.$init.call(this),this.FTableView=null,this.FText="",this.FID$1=0,this.FLookupText=""},this.$final=function(){this.FTableView=void 0,pas.Classes.TCollectionItem.$final.call(this)},this.SetText=function(t){this.FText!==t&&(this.FText=t,this.Changed$1())},this.SetId=function(t){this.FID$1!==t&&(this.FID$1=t,this.Changed$1())},this.SetLookupText=function(t){this.FLookupText!==t&&(this.FLookupText=t,this.Changed$1())},this.Changed$1=function(){null!=this.FTableView&&this.FTableView.UpdateTableView(!1)},this.Create$1=function(e){return pas.Classes.TCollectionItem.Create$1.apply(this,arguments),this.FTableView=rtl.as(this.FCollection,t.TTMSFNCTableViewCategories).FTableView,this.FID$1=rtl.as(this.FCollection,t.TTMSFNCTableViewCategories).GetCount()-1,null!=this.FTableView&&this.FTableView.UpdateTableView(!1),this},this.Destroy=function(){pas.Classes.TCollectionItem.Destroy.call(this),null!=this.FTableView&&this.FTableView.UpdateTableView(!1)},this.Assign=function(e){t.TTMSFNCTableViewCategory.isPrototypeOf(e)&&(this.FText=rtl.as(e,t.TTMSFNCTableViewCategory).FText,this.FLookupText=rtl.as(e,t.TTMSFNCTableViewCategory).FLookupText,this.FID$1=rtl.as(e,t.TTMSFNCTableViewCategory).FID$1,this.Changed$1())};var e=this.$rtti;e.addProperty("Text",2,rtl.string,"FText","SetText"),e.addProperty("LookupText",2,rtl.string,"FLookupText","SetLookupText"),e.addProperty("ID",2,rtl.longint,"FID$1","SetId")})),rtl.createClass(this,"TTMSFNCTableViewCategories",pas["WEBLib.TMSFNCTypes"].TTMSFNCOwnedCollection,(function(){this.$init=function(){pas["WEBLib.TMSFNCTypes"].TTMSFNCOwnedCollection.$init.call(this),this.FTableView=null},this.$final=function(){this.FTableView=void 0,pas["WEBLib.TMSFNCTypes"].TTMSFNCOwnedCollection.$final.call(this)},this.GetItem$1=function(t){return this.GetItem(t)},this.Create$3=function(e){return pas.Classes.TOwnedCollection.Create$2.call(this,e,t.TTMSFNCTableViewCategory),this.FTableView=e,this},this.ItemById=function(t){var e=null,i=0;e=null;for(var s=0,o=this.GetCount()-1;s<=o;s++)if(i=s,this.GetItem$1(i).FID$1===t){e=this.GetItem$1(i);break}return e},this.ItemIndexById=function(t){var e=null;return null!=(e=this.ItemById(t))?e.GetIndex():-1}})),rtl.createClass(this,"TTMSFNCTableViewMoreOption",pas.Classes.TCollectionItem,(function(){this.$init=function(){pas.Classes.TCollectionItem.$init.call(this),this.FTableView=null,this.FText="",this.FWidth=0,this.FColor=0,this.FFontColor=0,this.FBorderColor=0},this.$final=function(){this.FTableView=void 0,pas.Classes.TCollectionItem.$final.call(this)},this.SetText=function(t){this.FText!==t&&(this.FText=t,this.Changed$1())},this.IsWidthStored=function(){return 60!==this.FWidth},this.SetWidth=function(t){this.FWidth!==t&&(this.FWidth=t,this.Changed$1())},this.SetColor=function(t){this.FColor!==t&&(this.FColor=t,this.Changed$1())},this.SetFontColor=function(t){this.FFontColor!==t&&(this.FFontColor=t,this.Changed$1())},this.SetBorderColor=function(t){this.FBorderColor!==t&&(this.FBorderColor=t,this.Changed$1())},this.Changed$1=function(){null!=this.FTableView&&this.FTableView.UpdateTableView(!1)},this.Create$1=function(e){return pas.Classes.TCollectionItem.Create$1.apply(this,arguments),this.FTableView=rtl.as(this.FCollection,t.TTMSFNCTableViewMoreOptions).FTableView,this.FWidth=60,this.FColor=-1,this.FBorderColor=-1,this.FFontColor=-1,null!=this.FTableView&&this.FTableView.UpdateTableView(!1),this},this.Destroy=function(){pas.Classes.TCollectionItem.Destroy.call(this),null!=this.FTableView&&this.FTableView.UpdateTableView(!1)},this.Assign=function(e){t.TTMSFNCTableViewMoreOption.isPrototypeOf(e)&&(this.FText=rtl.as(e,t.TTMSFNCTableViewMoreOption).FText,this.FWidth=rtl.as(e,t.TTMSFNCTableViewMoreOption).FWidth,this.FColor=rtl.as(e,t.TTMSFNCTableViewMoreOption).FColor,this.FBorderColor=rtl.as(e,t.TTMSFNCTableViewMoreOption).FBorderColor,this.FFontColor=rtl.as(e,t.TTMSFNCTableViewMoreOption).FFontColor)};var e=this.$rtti;e.addProperty("Text",2,rtl.string,"FText","SetText"),e.addProperty("Width",14,rtl.double,"FWidth","SetWidth",{stored:"IsWidthStored"}),e.addProperty("Color",2,pas["WEBLib.Graphics"].$rtti.TColor,"FColor","SetColor",{Default:-1}),e.addProperty("BorderColor",2,pas["WEBLib.Graphics"].$rtti.TColor,"FBorderColor","SetBorderColor",{Default:-1}),e.addProperty("FontColor",2,pas["WEBLib.Graphics"].$rtti.TColor,"FFontColor","SetFontColor",{Default:-1})})),rtl.createClass(this,"TTMSFNCTableViewMoreOptions",pas["WEBLib.TMSFNCTypes"].TTMSFNCOwnedCollection,(function(){this.$init=function(){pas["WEBLib.TMSFNCTypes"].TTMSFNCOwnedCollection.$init.call(this),this.FTableView=null},this.$final=function(){this.FTableView=void 0,pas["WEBLib.TMSFNCTypes"].TTMSFNCOwnedCollection.$final.call(this)},this.GetItem$1=function(t){return this.GetItem(t)},this.Create$3=function(e){return pas.Classes.TOwnedCollection.Create$2.call(this,e,t.TTMSFNCTableViewMoreOption),this.FTableView=e,this}})),this.TTMSFNCTableViewCategoryType={0:"tvctNone",tvctNone:0,1:"tvctAlphaBetic",tvctAlphaBetic:1,2:"tvctAlphaNumericFirst",tvctAlphaNumericFirst:2,3:"tvctAlphaNumericLast",tvctAlphaNumericLast:3,4:"tvctCustom",tvctCustom:4},this.$rtti.$Enum("TTMSFNCTableViewCategoryType",{minvalue:0,maxvalue:4,ordtype:1,enumtype:this.TTMSFNCTableViewCategoryType}),this.$rtti.$MethodVar("TTMSFNCTableViewLookupCategoryEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ACharacter",rtl.string],["ACharacterID",rtl.longint]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTableViewDrawItemCustomAccessoryEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["AItem",this.$rtti.TTMSFNCTableViewItem]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTableViewItemMoreOptionClickEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AItem",this.$rtti.TTMSFNCTableViewItem],["AMoreOption",this.$rtti.TTMSFNCTableViewMoreOption]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTableViewBeforeItemShowDetailControl",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AItem",this.$rtti.TTMSFNCTableViewItem],["ADetailControl",pas["WEBLib.Controls"].$rtti.TControl],["AAllow",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTableViewBeforeItemHideDetailControl",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AItem",this.$rtti.TTMSFNCTableViewItem],["ADetailControl",pas["WEBLib.Controls"].$rtti.TControl],["AAllow",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTableViewItemShowDetailControl",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AItem",this.$rtti.TTMSFNCTableViewItem],["ADetailControl",pas["WEBLib.Controls"].$rtti.TControl]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTableViewItemHideDetailControl",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AItem",this.$rtti.TTMSFNCTableViewItem],["ADetailControl",pas["WEBLib.Controls"].$rtti.TControl]]),methodkind:0}),rtl.createClass(this,"TTMSFNCTableViewCustomChar",pas.System.TObject,(function(){this.$init=function(){pas.System.TObject.$init.call(this),this.FID=0,this.FActive=!1},this.Create$1=function(t,e){return this.FID=t,this.FActive=e,this}})),rtl.createClass(this,"TTMSFNCTableViewCustomCharList",pas.contnrs.TObjectList,(function(){this.GetItem$1=function(t){return this.GetItem(t)},this.ActivateID=function(t){for(var e=0,i=0,s=this.GetCount()-1;i<=s;i++)if(e=i,this.GetItem$1(e).FID===t){this.GetItem$1(e).FActive=!0;break}},this.IsIDActive=function(t){var e=!1,i=0;e=!1;for(var s=0,o=this.GetCount()-1;s<=o;s++)if(i=s,this.GetItem$1(i).FID===t){e=this.GetItem$1(i).FActive;break}return e}})),rtl.createClass(this,"TTMSFNCTableViewEdit",pas["WEBLib.TMSFNCEdit"].TTMSFNCEdit,(function(){this.$init=function(){pas["WEBLib.TMSFNCEdit"].TTMSFNCEdit.$init.call(this),this.FTableView=null},this.$final=function(){this.FTableView=void 0,pas["WEBLib.TMSFNCEdit"].TTMSFNCEdit.$final.call(this)},this.KeyDown=function(t,e){if(pas["WEBLib.TMSFNCEdit"].TTMSFNCEdit.KeyDown.apply(this,arguments),null!=this.FTableView&&t.get()in rtl.createSet(27)&&this.FTableView.FFilterActive){var i=this.FTableView.FInteraction.FKeyboardEscapeMode;0===i||(1===i?(this.FTableView.FFilterActive=!1,this.FTableView.StartFiltering()):2===i&&this.FTableView.StopFiltering())}},rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TTMSFNCCustomTableView",pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl,(function(){this.$init=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.$init.call(this),this.FFirstLoad=!1,this.FFilterActive=!1,this.FEditMode=!1,this.FDoneButton=null,this.FEditButton=null,this.FBackButton=null,this.FFilterButton=null,this.FEdit=null,this.FActiveAccessoryItem=null,this.FDetailControlTimer=null,this.FDetailControlOffset=0,this.FShowDetailControl=!1,this.FActiveDetailControl=null,this.FActiveDetailItem=null,this.FCustomChar=null,this.FLookupBarDisplayList=null,this.FFilterApplied=!1,this.FUpdateCount$1=0,this.FDisplayList=null,this.FCategoryList=null,this.FSaveSelectedItem=0,this.FSaveSelectedItems=[],this.FCopyItems=null,this.FAccepted=!1,this.FItems=null,this.FTreeView=null,this.FColumn=null,this.FDefaultItem=null,this.FItemAppearance=null,this.FOnItemSelected=null,this.FInteraction=null,this.FHeader=null,this.FFooter=null,this.FOnItemAnchorClick=null,this.FOnAfterCutToClipboard=null,this.FOnBeforePasteFromClipboard=null,this.FOnAfterReorderItem=null,this.FOnBeforeDropItem=null,this.FOnBeforeDrawItemText=null,this.FOnVScroll=null,this.FOnBeforeCopyToClipboard=null,this.FOnItemDblClick=null,this.FOnBeforeDrawItemCheck=null,this.FOnAfterDrawItemIcon=null,this.FOnBeforeDrawItem=null,this.FOnAfterPasteFromClipboard=null,this.FOnItemClick=null,this.FOnAfterDropItem=null,this.FOnAfterDrawItemText=null,this.FOnItemCompare=null,this.FOnBeforeCutToClipboard=null,this.FOnBeforeReorderItem=null,this.FOnNeedFilterDropDownData=null,this.FOnAfterCopyToClipboard=null,this.FOnFilterSelect=null,this.FOnAfterDrawItemCheck=null,this.FOnAfterDrawItem=null,this.FOnBeforeDrawItemIcon=null,this.FFilter=null,this.FOnBeforeDrawSortIndicator=null,this.FOnAfterDrawSortIndicator=null,this.FOnGetHTMLTemplateValue=null,this.FOnGetHTMLTemplate=null,this.FCategoryType=0,this.FCategories=null,this.FOnCategoryCompare=null,this.FLookupBar=null,this.FOnManualLookupCategory=null,this.FOnCategoryClick=null,this.FReload=null,this.FOnStopReload=null,this.FOnStartReload=null,this.FOnDrawItemCustomAccessory=null,this.FOnItemAccessoryClick=null,this.FCategoryAppearance=null,this.FOnItemCheckChanged=null,this.FOnAfterApplyFilter=null,this.FOnBeforeApplyFilter=null,this.FMoreOptions=null,this.FMoreOptionAppearance=null,this.FOnItemMoreOptionClick=null,this.FOnAfterDrawItemMoreOption=null,this.FOnBeforeDrawItemMoreOption=null,this.FOnItemShowDetailControl=null,this.FOnItemHideDetailControl=null,this.FOnBeforeItemShowDetailControl=null,this.FOnBeforeItemHideDetailControl=null,this.FOnItemSelectionChanged=null,this.FOnItemUnSelected=null,this.FOnAfterDrawItemTitle=null,this.FOnBeforeDrawItemTitle=null,this.FOnItemMouseLeave=null,this.FOnItemMouseEnter=null,this.FOnFooterAnchorClick=null,this.FOnHeaderAnchorClick=null,this.FOnItemTitleAnchorClick=null,this.FGlobalFont=null},this.$final=function(){this.FDoneButton=void 0,this.FEditButton=void 0,this.FBackButton=void 0,this.FFilterButton=void 0,this.FEdit=void 0,this.FActiveAccessoryItem=void 0,this.FDetailControlTimer=void 0,this.FActiveDetailControl=void 0,this.FActiveDetailItem=void 0,this.FCustomChar=void 0,this.FLookupBarDisplayList=void 0,this.FDisplayList=void 0,this.FCategoryList=void 0,this.FSaveSelectedItems=void 0,this.FCopyItems=void 0,this.FItems=void 0,this.FTreeView=void 0,this.FColumn=void 0,this.FDefaultItem=void 0,this.FItemAppearance=void 0,this.FOnItemSelected=void 0,this.FInteraction=void 0,this.FHeader=void 0,this.FFooter=void 0,this.FOnItemAnchorClick=void 0,this.FOnAfterCutToClipboard=void 0,this.FOnBeforePasteFromClipboard=void 0,this.FOnAfterReorderItem=void 0,this.FOnBeforeDropItem=void 0,this.FOnBeforeDrawItemText=void 0,this.FOnVScroll=void 0,this.FOnBeforeCopyToClipboard=void 0,this.FOnItemDblClick=void 0,this.FOnBeforeDrawItemCheck=void 0,this.FOnAfterDrawItemIcon=void 0,this.FOnBeforeDrawItem=void 0,this.FOnAfterPasteFromClipboard=void 0,this.FOnItemClick=void 0,this.FOnAfterDropItem=void 0,this.FOnAfterDrawItemText=void 0,this.FOnItemCompare=void 0,this.FOnBeforeCutToClipboard=void 0,this.FOnBeforeReorderItem=void 0,this.FOnNeedFilterDropDownData=void 0,this.FOnAfterCopyToClipboard=void 0,this.FOnFilterSelect=void 0,this.FOnAfterDrawItemCheck=void 0,this.FOnAfterDrawItem=void 0,this.FOnBeforeDrawItemIcon=void 0,this.FFilter=void 0,this.FOnBeforeDrawSortIndicator=void 0,this.FOnAfterDrawSortIndicator=void 0,this.FOnGetHTMLTemplateValue=void 0,this.FOnGetHTMLTemplate=void 0,this.FCategories=void 0,this.FOnCategoryCompare=void 0,this.FLookupBar=void 0,this.FOnManualLookupCategory=void 0,this.FOnCategoryClick=void 0,this.FReload=void 0,this.FOnStopReload=void 0,this.FOnStartReload=void 0,this.FOnDrawItemCustomAccessory=void 0,this.FOnItemAccessoryClick=void 0,this.FCategoryAppearance=void 0,this.FOnItemCheckChanged=void 0,this.FOnAfterApplyFilter=void 0,this.FOnBeforeApplyFilter=void 0,this.FMoreOptions=void 0,this.FMoreOptionAppearance=void 0,this.FOnItemMoreOptionClick=void 0,this.FOnAfterDrawItemMoreOption=void 0,this.FOnBeforeDrawItemMoreOption=void 0,this.FOnItemShowDetailControl=void 0,this.FOnItemHideDetailControl=void 0,this.FOnBeforeItemShowDetailControl=void 0,this.FOnBeforeItemHideDetailControl=void 0,this.FOnItemSelectionChanged=void 0,this.FOnItemUnSelected=void 0,this.FOnAfterDrawItemTitle=void 0,this.FOnBeforeDrawItemTitle=void 0,this.FOnItemMouseLeave=void 0,this.FOnItemMouseEnter=void 0,this.FOnFooterAnchorClick=void 0,this.FOnHeaderAnchorClick=void 0,this.FOnItemTitleAnchorClick=void 0,this.FGlobalFont=void 0,pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.$final.call(this)},this.SetItems=function(t){this.FItems.Assign(t)},this.SetDefaultItem=function(t){this.FDefaultItem.Assign(t)},this.SetItemAppearance=function(t){this.FItemAppearance.Assign(t)},this.GetItemIndex=function(){var t=0,e=null;return t=-1,null!=this.FTreeView&&this.FTreeView.SelectedVirtualNodeCount()>0&&null!=this.FTreeView.GetSelVirtualNode(0)&&(null!=(e=this.GetItemForNode(this.FTreeView.GetFocusedVirtualNode()))?t=e.GetIndex():-1!==this.FSaveSelectedItem&&(t=this.FSaveSelectedItem)),t},this.SetItemIndex=function(t){this.SelectItem(t)},this.SetInteraction=function(t){this.FInteraction.Assign(t)},this.GetBitmapContainer=function(){var t=null;return t=null,null!=this.FTreeView&&(t=this.FTreeView.GetBitmapContainer()),t},this.SetBitmapContainer=function(t){this.FTreeView.SetBitmapContainer(t)},this.SetHeader=function(t){this.FHeader.Assign(t)},this.SetFooter=function(t){this.FFooter.Assign(t)},this.GetSelectedItem=function(){var t=null;return t=null,this.GetItemIndex()>=0&&this.GetItemIndex()<=this.FItems.GetCount()-1&&(t=this.FItems.GetItem$1(this.GetItemIndex())),t},this.SetSelectedItem=function(t){null!=t&&this.SetItemIndex(t.GetIndex())},this.GetSelItem=function(t){var e=null;return e=null,null!=this.FTreeView&&(e=this.GetItemForNode(this.FTreeView.GetSelVirtualNode(t))),e},this.GetVerticalScrollBarVisible=function(){var t=!1;return t=!1,null!=this.FTreeView&&(t=this.FTreeView.FVerticalScrollBarVisible),t},this.SetVerticalScrollBarVisible=function(t){null!=this.FTreeView&&this.FTreeView.SetVerticalScrollBarVisible(t)},this.GetFill=function(){var t=null;return t=null,null!=this.FTreeView&&(t=this.FTreeView.FFill),t},this.GetStroke=function(){var t=null;return t=null,null!=this.FTreeView&&(t=this.FTreeView.FStroke),t},this.SetFill$1=function(t){null!=this.FTreeView&&this.FTreeView.FFill.Assign(t)},this.SetStroke$1=function(t){null!=this.FTreeView&&this.FTreeView.FStroke.Assign(t)},this.SetCategoryType=function(t){this.FCategoryType!==t&&(this.FCategoryType=t,this.UpdateTableView(!1))},this.SetCategories=function(t){this.FCategories.Assign(t)},this.SetLookupBar=function(t){this.FLookupBar.Assign(t)},this.SetReload=function(t){this.FReload.Assign(t)},this.SetCategoryAppearance=function(t){this.FCategoryAppearance.Assign(t)},this.SetMoreOptions=function(t){this.FMoreOptions.Assign(t)},this.SetMoreOptionAppearance=function(t){this.FMoreOptionAppearance.Assign(t)},this.SetGlobalFont=function(t){this.FGlobalFont.Assign(t)},this.GetDocURL=function(){return pas["WEBLib.TMSFNCTypes"].TTMSFNCBaseDocURL+"tmsfncuipack/components/"+pas.SysUtils.LowerCase(this.$classname)},this.GetVersion=function(){return this.$class.GetVersionNumber(1,0,1,0)},this.GetItemsRect=function(){var t=pas["WEBLib.TMSFNCTypes"].TRectF.$new();return t.$assign(pas["WEBLib.TMSFNCTypes"].EmptyRect()),null!=this.FTreeView&&t.$assign(this.FTreeView.GetNodesRect()),t},this.CreateTreeView=function(){return t.TTMSFNCTreeViewTableView.$create("Create$1",[this])},this.CreateItems=function(){return t.TTMSFNCTableViewItems.$create("Create$3",[this])},this.GetRowForItemIndex=function(e){var i=0,s=0,o=t.TTMSFNCTableViewDisplayItem.$new();i=-1;for(var n=0,r=this.FDisplayList.GetCount()-1;n<=r;n++)if(s=n,o.$assign(this.FDisplayList.GetItem(s)),null!=o.Item&&null!=o.Item.FCollection&&o.Item.GetIndex()===e&&1===o.Kind){i=o.Item.FRow;break}return i},this.GetDisplayCategoryIndex=function(t){var e=0,i=0;e=-1;for(var s=this.FDisplayList.GetCount()-1;s>=0;s--)if(i=s,2===this.FDisplayList.GetItem(i).Kind&&i<=t){e=i;break}return e},this.GetItemIndexForNode=function(t){var e=0,i=0;if(e=-1,null!=t)for(var s=0,o=this.FDisplayList.GetCount()-1;s<=o;s++)if(i=s,this.FDisplayList.GetItem(i).Row===t.FRow&&null!=this.FDisplayList.GetItem(i).Item&&null!=this.FDisplayList.GetItem(i).Item.FCollection){e=this.FDisplayList.GetItem(i).Item.GetIndex();break}return e},this.GetItemForNode=function(t){var e,i=null;return i=null,(e=this.GetItemIndexForNode(t))>=0&&e<=this.FItems.GetCount()-1&&(i=this.FItems.GetItem$1(e)),i},this.GetNodeForItemIndex=function(t){var e=null;return e=null,null!=this.FTreeView&&(e=this.FTreeView.GetNodeForRow(this.GetRowForItemIndex(t))),e},this.HTMLReplace=function(t,e){var i="",s="",o="",n="",r="",a=0,l=0;if(i="",null==e)return i;for(s="";pas.System.Pos("<#",t)>0&&pas.System.Pos(">",t)>0;)a=pas.System.Pos("<#",t),s+=pas.System.Copy(t,1,a-1),o=pas.System.Copy(t,a,t.length),l=pas.System.Pos(">",o),n=pas.System.Copy(o,1,l-1),pas.System.Delete({get:function(){return n},set:function(t){n=t}},1,2),pas.System.Delete({get:function(){return t},set:function(e){t=e}},1,a+l-1),r=e.FHTMLTemplateItems.GetValue(n),this.DoGetHTMLTemplateValue(e,n,{get:function(){return r},set:function(t){r=t}}),s+=r;return i=s+t},this.ItemFromDifferentCategory=function(t,e){var i=!1,s="",o="";if(i=!1,null===t||null===e)i=!0;else{var n=this.FCategoryType;1===n||2===n||3===n?(s=t.GetStrippedHTMLText(),o=e.GetStrippedHTMLText(),i=s.length>0&&o.length>0?s.charAt(0)!==o.charAt(0):0!==s.length||0!==o.length):4===n&&(i=t.FCategoryID>-1&&e.FCategoryID>-1?t.FCategoryID!==e.FCategoryID:!(-1===t.FCategoryID&&-1===e.FCategoryID))}return i},this.MatchFilter=function(t){var e=!1,i=0,s="",o=!1;e=!0;for(var n=1,r=this.FFilter.GetCount();n<=r;n++){i=n;var a=this.FFilter.GetItem$1(i-1);s=t.GetStrippedHTMLText(),s=pas.SysUtils.Trim(s),""!==a.FPrefix&&1===pas.System.Pos(a.FPrefix,s)&&pas.System.Delete({get:function(){return s},set:function(t){s=t}},1,this.FFilter.GetItem$1(i-1).FPrefix.length),""!==a.FSuffix&&pas.System.Pos(a.FSuffix,s)===1+s.length-a.FSuffix.length&&pas.System.Delete({get:function(){return s},set:function(t){s=t}},1+s.length-a.FSuffix.length,s.length),o=!0;try{""!==this.FFilter.GetItem$1(i-1).FCondition&&(o=pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.MatchStrEx(a.FCondition,s,a.FCaseSensitive))}catch(t){o=!1}var l=this.FFilter.GetItem$1(i-1).FOperation;if(0===l){if(!(e=o))break}else 1===l?e=o:2===l?e=e&&o:4===l?e=e||o:3===l&&(e^=o)}return e},this.GetCharacterForItem=function(t){var e="",i="",s=0;e="";var o=this.FCategoryType;return 2===o||3===o||1===o?e=(i=t.GetStrippedHTMLText()).length>0?i.charAt(0):"":4===o&&(s=this.FCategories.ItemIndexById(t.FCategoryID))>=0&&s<=this.FCategories.GetCount()-1&&(e=this.FCategories.GetItem$1(s).FText),e},this.GetCharacter=function(t){return"",3===this.FCategoryType||1===this.FCategoryType?t<27?String.fromCharCode(t-1+65):String.fromCharCode(t-27+48):t<11?String.fromCharCode(t-1+48):String.fromCharCode(t-11+65)},this.GetCharacterCount=function(){var t=0;return t=26,2!==this.FCategoryType&&3!==this.FCategoryType||(t=36),t},this.FindCategoryWithCharacter=function(e){var i=t.TTMSFNCTableViewDisplayItem.$new(),s=0,o=t.TTMSFNCTableViewDisplayItem.$new();i.Kind=0,i.Item=null,i.CategoryID=-1,i.Text="";for(var n=0,r=this.FCategoryList.GetCount()-1;n<=r;n++)if(s=n,o.$assign(this.FCategoryList.GetItem(s)),o.Text===e){i.$assign(o);break}return i},this.FindCategoryWithCharacterID=function(e){var i=t.TTMSFNCTableViewDisplayItem.$new(),s=0,o=t.TTMSFNCTableViewDisplayItem.$new();i.Kind=0,i.Item=null,i.CategoryID=-1,i.Text="";for(var n=0,r=this.FCategoryList.GetCount()-1;n<=r;n++)if(s=n,o.$assign(this.FCategoryList.GetItem(s)),o.CategoryID===e){i.$assign(o);break}return i},this.FindFirstItemWithCategory=function(t){var e=null,i=0;e=null;for(var s=0,o=this.FItems.GetCount()-1;s<=o;s++)if(i=s,this.GetCharacterForItem(this.FItems.GetItem$1(i))===t){e=this.FItems.GetItem$1(i);break}return e},this.FindFirstItemWithCategoryID=function(t){var e=null,i=0;e=null;for(var s=0,o=this.FItems.GetCount()-1;s<=o;s++)if(i=s,this.FItems.GetItem$1(i).FCategoryID===t){e=this.FItems.GetItem$1(i);break}return e},this.GetMoreOptionsSize=function(){var t=0,e=0;t=0;for(var i=0,s=this.FMoreOptions.GetCount()-1;i<=s;i++)e=i,t+=this.FMoreOptions.GetItem$1(e).FWidth;return t},this.IsAppearanceProperty=function(t,e,i){return pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.IsAppearanceProperty.call(this,t,e,i)||"Header"===e||"Footer"===e},this.DoEnter=function(){pas["WEBLib.Controls"].TControl.DoEnter.call(this),null!=this.FTreeView&&this.FTreeView.GetAllowFocus()&&this.FTreeView.SetFocus()},this.Loaded=function(){pas["WEBLib.Controls"].TCustomControl.Loaded.call(this)},this.DoItemMoreOptionClick=function(t,e){null!=this.FOnItemMoreOptionClick&&this.FOnItemMoreOptionClick(this,t,e)},this.DoFilterButtonClicked=function(t){this.StartFiltering()},this.DoEditButtonClicked=function(t){this.StartEditMode()},this.DoEditChange=function(t){var e=null;this.RemoveFilters(),(e=this.FFilter.Add$1()).FCaseSensitive=!1,e.FCondition="*"+this.FEdit.GetT()+"*",this.DoBeforeApplyFilter(e,!0),this.ApplyFilter(),this.DoAfterApplyFilter(e)},this.DoBeforeApplyFilter=function(t,e){null!=this.FOnBeforeApplyFilter&&this.FOnBeforeApplyFilter(this,t,{get:function(){return e},set:function(t){e=t}})},this.DoAfterApplyFilter=function(t){null!=this.FOnAfterApplyFilter&&this.FOnAfterApplyFilter(this,t)},this.DoDoneButtonClicked=function(t){this.StopEditMode(),this.StopFiltering()},this.DoBackButtonClicked=function(t){this.HideDetailControl()},this.DoItemAccessoryClick=function(t){null!=this.FOnItemAccessoryClick&&this.FOnItemAccessoryClick(this,t)},this.DoDetailControlTimer=function(t){var i=0,s=0,o=!1,n=pas["WEBLib.TMSFNCTypes"].TRectF.$new();null!=this.FActiveDetailControl&&null!=this.FTreeView?(this.FShowDetailControl?(n.$assign(this.FTreeView.GetContentRect()),s=n.Right-n.Left):s=0,this.FTreeView.FInteraction.FAnimationFactor>0?(i=Math.abs(this.FDetailControlOffset-s)/this.FTreeView.FInteraction.FAnimationFactor,o=e.AnimateDouble({p:this,get:function(){return this.p.FDetailControlOffset},set:function(t){this.p.FDetailControlOffset=t}},{get:function(){return s},set:function(t){s=t}},i,.01)):o=!1,o||(this.FDetailControlOffset=s,this.FShowDetailControl=!this.FShowDetailControl,this.FShowDetailControl?this.DoItemShowDetailControl(this.FActiveDetailItem,this.FActiveDetailControl):(this.DoItemHideDetailControl(this.FActiveDetailItem,this.FActiveDetailControl),this.FActiveDetailControl.SetVisible(!1),this.FActiveDetailControl.SetParent(null),this.FActiveDetailControl=null,this.FActiveDetailItem=null),this.FDetailControlTimer.SetEnabled(!1)),this.UpdateTableView(!0),this.UpdateActiveDetailControl()):this.FDetailControlTimer.SetEnabled(!1)},this.DoItemShowDetailControl=function(t,e){null!=this.FOnItemShowDetailControl&&this.FOnItemShowDetailControl(this,t,e)},this.DoItemHideDetailControl=function(t,e){null!=this.FOnItemHideDetailControl&&this.FOnItemHideDetailControl(this,t,e)},this.DoBeforeItemShowDetailControl=function(t,e,i){null!=this.FOnBeforeItemShowDetailControl&&this.FOnBeforeItemShowDetailControl(this,t,e,i)},this.DoBeforeItemHideDetailControl=function(t,e,i){null!=this.FOnBeforeItemHideDetailControl&&this.FOnBeforeItemHideDetailControl(this,t,e,i)},this.Notification=function(t,e){var i=0;if(pas["WEBLib.Menus"].TWebCustomControl.Notification.apply(this,arguments),!(3 in this.FComponentState)&&1===e){for(var s=0,o=this.FItems.GetCount()-1;s<=o;s++)i=s,t===this.FItems.GetItem$1(i).FDetailControl&&(this.FItems.GetItem$1(i).FDetailControl=null);null!=this.FDefaultItem&&t===this.FDefaultItem.FDetailControl&&(this.FDefaultItem.FDetailControl=null)}},this.DoStartReload=function(){null!=this.FOnStartReload&&this.FOnStartReload(this)},this.ScrollToCategoryId=function(e){var i=t.TTMSFNCTableViewDisplayItem.$new(),s=null;null!=this.FTreeView&&(i.$assign(this.FindCategoryWithCharacterID(e)),i.Row>=0&&i.Row<=this.FDisplayList.GetCount()-1&&(s=this.FTreeView).ScrollToVirtualNode(s.GetNodeForRow(i.Row),!0,0,!0))},this.ScrollToCategoryCharacter=function(e){var i=t.TTMSFNCTableViewDisplayItem.$new(),s=null;null!=this.FTreeView&&(i.$assign(this.FindCategoryWithCharacter(e)),i.Row>=0&&i.Row<=this.FDisplayList.GetCount()-1&&(s=this.FTreeView).ScrollToVirtualNode(s.GetNodeForRow(i.Row),!0,0,!0))},this.RegisterRuntimeClasses=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.RegisterRuntimeClasses.call(this),pas.Classes.RegisterClass(t.TTMSFNCCustomTableView)},this.ApplyStyle=function(){var t=0,e=0;if(pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.ApplyStyle.call(this),e=-1,pas["WEBLib.TMSFNCStyles"].TTMSFNCStyles.GetStyleTextFontColor({get:function(){return e},set:function(t){e=t}}))for(var i=0,s=this.FItems.GetCount()-1;i<=s;i++)t=i,this.FItems.GetItem$1(t).SetTextColor(e),this.FItems.GetItem$1(t).SetTitleColor(e)},this.UpdateControlAfterResize=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.UpdateControlAfterResize.call(this),null!=this.FTreeView&&this.FTreeView.SetBounds(0,0,this.GetWidth(),this.GetHeight()),this.UpdateTableView(!1),this.UpdateActiveDetailControl()},this.ResetToDefaultStyle=function(){var t=0;pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.ResetToDefaultStyle.call(this),this.BeginUpdate(),this.GetStroke().SetColor(pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(178,178,178)),this.FHeader.GetFill().SetKind(1),this.FFooter.GetFill().SetKind(1),this.FHeader.GetStroke().SetColor(this.GetStroke().FColor),this.FFooter.GetStroke().SetColor(this.GetStroke().FColor),pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.SetFontSize(this.FHeader.GetFont(),16,1),pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.SetFontSize(this.FFooter.GetFont(),16,1),pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.SetFontSize(this.FHeader.GetFont(),14,1),this.FHeader.GetFont().SetStyle(rtl.createSet(0)),pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.SetFontSize(this.FFooter.GetFont(),14,1),this.FItemAppearance.GetStroke().SetKind(0),this.FHeader.GetFill().SetColor(16380654),this.FHeader.GetFont().SetColor(4539717),this.FFooter.GetFill().SetColor(16380654),this.FFooter.GetFont().SetColor(4539717),this.FItemAppearance.GetSelectedFill().SetColor(16578806),this.FItemAppearance.GetSelectedStroke().SetColor(15702829),this.FItemAppearance.GetFont().SetColor(8026746),this.FItemAppearance.GetSelectedStroke().SetColor(15702829),this.FItemAppearance.SetShowFocus(!1),this.FHeader.SetHeight(this.ScalePaintValue(36));for(var e=0,i=this.FItems.GetCount()-1;e<=i;e++)t=e,this.FItems.GetItem$1(t).SetSelectedTitleColor(this.FHeader.GetFont().FColor),this.FItems.GetItem$1(t).SetTitleColor(this.FHeader.GetFont().FColor),this.FItems.GetItem$1(t).SetSelectedTextColor(this.FHeader.GetFont().FColor),this.FItems.GetItem$1(t).SetTextColor(this.FItemAppearance.GetFont().FColor);this.EndUpdate()},this.SetAdaptToStyle=function(t){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.SetAdaptToStyle.apply(this,arguments),null!=this.FTreeView&&this.FTreeView.SetAdaptToStyle(this.GetAdaptToStyle())},this.UpdateTableView=function(t){var e=null,i=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),s=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),o=0,n=0,r=!1,a=[],l=[],h=0;if(!(this.FUpdateCount$1>0||this.IsDestroying())&&null!=this.FTreeView){t||this.CalculateItems(),e=this.GetSelectedItem(),a=this.GetSelectedItems(),l=rtl.arraySetLength(l,0,rtl.length(a));for(var F=0,p=rtl.length(a)-1;F<=p;F++)null!=a[h=F]&&(l[h]=a[h].GetIndex());if(this.FDetailControlTimer.FEnabled||(this.FShowDetailControl?this.FDetailControlOffset=0:(i.$assign(this.FTreeView.GetContentRect()),this.FDetailControlOffset=i.Right-i.Left)),t?this.FTreeView.UpdateTreeViewDisplay():(this.FTreeView.BeginUpdate(),this.FTreeView.ClearNodeList(),this.FTreeView.EndUpdate()),this.CalculateLookupBar(),this.SetSelectedItem(e),this.SelectItems(rtl.arrayRef(l)),s.$assign(this.FTreeView.GetColumnsTopRect()),r=!1,null!=this.FColumn&&(r=this.FColumn.FExpanded),!this.IsDesignTime()&&this.FFilterActive&&r?this.FEdit.SetParent(this):this.FEdit.SetParent(null),this.FDoneButton.SetVisible(this.FEditMode||this.FFilterActive&&!(null!=this.FActiveDetailControl)&&r),!this.IsDesignTime()&&this.FHeader.GetHeight()>0&&this.FHeader.GetVisible()?this.FDoneButton.SetParent(this):this.FDoneButton.SetParent(null),this.FDoneButton.Invalidate(),this.FBackButton.SetVisible(null!=this.FActiveDetailControl&&(this.FShowDetailControl&&!this.FDetailControlTimer.FEnabled||!this.FShowDetailControl)&&r),!this.IsDesignTime()&&this.FHeader.GetHeight()>0&&this.FHeader.GetVisible()?this.FBackButton.SetParent(this):this.FBackButton.SetParent(null),this.FBackButton.Invalidate(),this.FEditButton.SetVisible(!this.FEditMode&&!this.FFilterActive&&this.FInteraction.FShowEditButton&&!(null!=this.FActiveDetailControl)&&r),!this.IsDesignTime()&&this.FHeader.GetHeight()>0&&this.FHeader.GetVisible()?this.FEditButton.SetParent(this):this.FEditButton.SetParent(null),this.FEditButton.Invalidate(),this.FFilterButton.SetVisible(this.FInteraction.FShowFilterButton&&!this.FFilterActive&&!(null!=this.FActiveDetailControl)&&r),!this.IsDesignTime()&&this.FHeader.GetHeight()>0&&this.FHeader.GetVisible()?this.FFilterButton.SetParent(this):this.FFilterButton.SetParent(null),this.FFilterButton.Invalidate(),n=s.Bottom-s.Top,this.FBackButton.SetHeight(Math.round(n-this.ScalePaintValue(4))),this.FDoneButton.SetHeight(Math.round(n-this.ScalePaintValue(4))),this.FEditButton.SetHeight(Math.round(n-this.ScalePaintValue(4))),this.FFilterButton.SetHeight(Math.round(n-this.ScalePaintValue(4))),this.CustomizeButtons(),o=0,null!=this.FColumn&&(this.FColumn.FFiltering.FEnabled&&(o=o+this.FColumn.FFiltering.FButtonSize+this.ScalePaintValue(4)),this.FColumn.FExpandable&&(o=o+this.FColumn.FExpandingButtonSize+this.ScalePaintValue(6)),0!==this.FColumn.FSortKind&&(o=o+this.ScalePaintValue(8)+this.ScalePaintValue(6))),this.FBackButton.SetBounds(Math.round(s.Left+this.ScalePaintValue(3)),Math.round(s.Top+(s.Bottom-s.Top-this.FBackButton.GetHeight())/2),this.FBackButton.GetWidth(),this.FBackButton.GetHeight()),this.FFilterButton.FVisible?(this.FFilterButton.SetBounds(Math.round(s.Right-this.ScalePaintValue(3)-this.FFilterButton.GetWidth()-o),Math.round(s.Top+(s.Bottom-s.Top-this.FFilterButton.GetHeight())/2),this.FFilterButton.GetWidth(),this.FFilterButton.GetHeight()),this.FDoneButton.SetBounds(Math.round(s.Right-this.ScalePaintValue(6)-this.FDoneButton.GetWidth()-this.FFilterButton.GetWidth()-o),Math.round(s.Top+Math.round((s.Bottom-s.Top-this.FDoneButton.GetHeight())/2)),this.FDoneButton.GetWidth(),this.FDoneButton.GetHeight()),this.FEditButton.SetBounds(Math.round(s.Right-this.ScalePaintValue(6)-this.FEditButton.GetWidth()-this.FFilterButton.GetWidth()-o),Math.round(s.Top+Math.round((s.Bottom-s.Top-this.FEditButton.GetHeight())/2)),this.FEditButton.GetWidth(),this.FEditButton.GetHeight())):(this.FDoneButton.SetBounds(Math.round(s.Right-this.ScalePaintValue(3)-this.FDoneButton.GetWidth()-o),Math.round(s.Top+(s.Bottom-s.Top-this.FDoneButton.GetHeight())/2),this.FDoneButton.GetWidth(),this.FDoneButton.GetHeight()),this.FEditButton.SetBounds(Math.round(s.Right-this.ScalePaintValue(3)-this.FEditButton.GetWidth()-o),Math.round(s.Top+(s.Bottom-s.Top-this.FEditButton.GetHeight())/2),this.FEditButton.GetWidth(),this.FEditButton.GetHeight())),this.FLookupBar.FVisible&&0!==this.FCategoryType){var c=this.FLookupBar.FPosition;0===c?this.FEdit.SetBounds(Math.round(s.Left+1+this.FLookupBar.FWidth),Math.round(s.Bottom),Math.round(s.Right-s.Left-this.FLookupBar.FWidth-2),this.FEdit.GetHeight()):1===c&&this.FEdit.SetBounds(Math.round(s.Left+1),Math.round(s.Bottom+1),Math.round(s.Right-s.Left-this.FLookupBar.FWidth-2),this.FEdit.GetHeight())}else this.FEdit.SetBounds(Math.round(s.Left+1),Math.round(s.Bottom),Math.round(s.Right-s.Left-2),this.FEdit.GetHeight());this.FTreeView.Invalidate()}},this.CustomizeButtons=function(){},this.SelectAllCheckedItems=function(){var t=0,e=[];e=rtl.arraySetLength(e,0,0);for(var i=0,s=this.FItems.GetCount()-1;i<=s;i++)t=i,this.FItems.GetItem$1(t).FChecked&&((e=rtl.arraySetLength(e,0,rtl.length(e)+1))[rtl.length(e)-1]=t);this.SelectItems(rtl.arrayRef(e))},this.UnSelectAllItems=function(){null!=this.FTreeView&&this.FTreeView.UnSelectAllNodes()},this.CalculateItems=function(){var t=0,e=0,i=!1,s=null;if(!(this.FUpdateCount$1>0||this.IsDestroying())){this.FDisplayList.Clear(),this.FCategoryList.Clear(),e=0;for(var o=0,n=this.FItems.GetCount()-1;o<=n;o++)t=o,i=(s=this.FItems.GetItem$1(t)).FVisible,this.FFilterApplied&&(i=i&&this.MatchFilter(s)),0!==this.FCategoryType?0===this.FDisplayList.GetCount()||this.ItemFromDifferentCategory(s,this.FItems.GetItem$1(e-1))?(i&&(this.AddDisplayCategory(s),this.AddDisplayItem(s)),e+=1):(i&&this.AddDisplayItem(s),e+=1):i&&this.AddDisplayItem(s)}},this.CalculateLookupBar=function(){var e=0,i=0,s="",o=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),n=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),r=t.TTMSFNCTableViewLookupBarDisplayItem.$new(),a=0,l=null,h=0;if(!(this.FUpdateCount$1>0||this.IsDestroying()||null==this.FTreeView)&&(this.FLookupBarDisplayList.Clear(),this.FLookupBar.FVisible&&0!==this.FCategoryType)){n.$assign(this.FTreeView.GetLookupBarRect());var F=this.FCategoryType;if(1===F||2===F||3===F)for(var p=1,c=e=this.GetCharacterCount();p<=c;p++)i=p,s=this.GetCharacter(i),o.Left=n.Left,o.Right=n.Right,o.Top=n.Top+(i-1)*((n.Bottom-n.Top)/e),o.Bottom=o.Top+(n.Bottom-n.Top)/e,r.Rect.$assign(o),r.Text=s,r.Active=null!=this.FindFirstItemWithCategory(s),this.FLookupBarDisplayList.Add(t.TTMSFNCTableViewLookupBarDisplayItem.$clone(r));else if(4===F){this.FCustomChar.Clear();for(var u=0,C=this.FCategories.GetCount()-1;u<=C;u++)i=u,this.FCustomChar.Add$1(t.TTMSFNCTableViewCustomChar.$create("Create$1",[this.FCategories.GetItem$1(i).FID$1,!1]));for(var T=0,S=this.FItems.GetCount()-1;T<=S;T++)i=T,""!==(s=this.FItems.GetItem$1(i).GetStrippedHTMLText())&&(h=this.FItems.GetItem$1(i).FCategoryID,this.FCustomChar.ActivateID(h));l=pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.$create("CreateBitmapCanvas",[1,1,!1,!0]);try{l.FFont.Assign(this.FLookupBar.FFont),e=this.FCategories.GetCount()-1,a=n.Top+3;for(var d=0,m=e;d<=m;d++)i=d,s=this.FCategories.GetItem$1(i).FLookupText,o.Left=n.Left,o.Right=n.Right,o.Top=a,o.Bottom=o.Top+l.CalculateTextHeight$1(s),a=a+(o.Bottom-o.Top)+3,r.Rect.$assign(o),r.Text=s,r.Active=null!=this.FindFirstItemWithCategoryID(this.FCategories.GetItem$1(i).FID$1),this.FLookupBarDisplayList.Add(t.TTMSFNCTableViewLookupBarDisplayItem.$clone(r))}finally{l=rtl.freeLoc(l)}}}},this.AddDisplayCategory=function(e){var i=t.TTMSFNCTableViewDisplayItem.$new();e.FVisible&&(i.Item=null,i.Kind=2,i.Text=this.GetCharacterForItem(e),i.CategoryID=e.FCategoryID,i.Row=this.FDisplayList.GetCount(),null!=e&&(e.FRow=i.Row),this.FDisplayList.Add(t.TTMSFNCTableViewDisplayItem.$clone(i)),this.FCategoryList.Add(t.TTMSFNCTableViewDisplayItem.$clone(i)))},this.AddDisplayItem=function(e){var i=t.TTMSFNCTableViewDisplayItem.$new();i.CategoryID=-1,i.Item=e,i.Kind=1,i.Text="",i.Row=this.FDisplayList.GetCount(),null!=e&&(e.FRow=i.Row),this.FDisplayList.Add(t.TTMSFNCTableViewDisplayItem.$clone(i))},this.DoClick=function(t){null!=this.FOnClick&&this.FOnClick(this)},this.DoGetNodeHeight=function(e,i,s,o){var n=t.TTMSFNCTableViewDisplayItem.$new();if(i.FRow>=0&&i.FRow<=this.FDisplayList.GetCount()-1){n.$assign(this.FDisplayList.GetItem(i.FRow));var r=n.Kind;1===r?(this.FItemAppearance.FHeight>-1&&o.set(this.FItemAppearance.FHeight),null!=n.Item&&n.Item.FHeight>-1&&o.set(n.Item.FHeight)):2===r&&this.FCategoryAppearance.FHeight>-1&&o.set(this.FCategoryAppearance.FHeight)}},this.DoGetNodeIcon=function(e,i,s,o,n){var r=t.TTMSFNCTableViewDisplayItem.$new();if(i.FRow>=0&&i.FRow<=this.FDisplayList.GetCount()-1){r.$assign(this.FDisplayList.GetItem(i.FRow));var a=r.Kind;1===a&&null!=r.Item&&(null!=this.GetBitmapContainer()&&""!==r.Item.FBitmapName&&n.set(this.GetBitmapContainer().FindBitmap$1(r.Item.FBitmapName)),null==n.get()&&n.set(r.Item.FBitmap))}},this.DoGetNodeSides=function(e,i,s){var o=t.TTMSFNCTableViewDisplayItem.$new(),n=null;null!=this.FTreeView&&i.FRow>=0&&i.FRow<=this.FDisplayList.GetCount()-1&&(o.$assign(this.FDisplayList.GetItem(i.FRow)),this.FTreeView.IsVirtualNodeSelected(i)||2===o.Kind||(this.FTreeView.GetLastVirtualNode()===i?s.set({}):null!=(n=this.FTreeView.GetNextVirtualNode(i))&&n.FRow>=0&&n.FRow<=this.FDisplayList.GetCount()-1&&(o.$assign(this.FDisplayList.GetItem(n.FRow)),1===o.Kind?s.set(rtl.createSet(3)):s.set({}))))},this.DoGetColumnText=function(t,e,i,s){var o=i;1===o?s.set(this.FHeader.FText):2===o&&s.set(this.FFooter.FText)},this.DoGetColumnTrimming=function(t,e,i,s){var o=i;1===o?s.set(this.FHeader.FTrimming):2===o&&s.set(this.FFooter.FTrimming)},this.DoGetColumnWordWrapping=function(t,e,i,s){var o=i;1===o?s.set(this.FHeader.FWordWrapping):2===o&&s.set(this.FFooter.FWordWrapping)},this.DoGetColumnHorizontalTextAlign=function(t,e,i,s){var o=i;1===o?s.set(this.FHeader.FHorizontalTextAlign):2===o&&s.set(this.FFooter.FHorizontalTextAlign)},this.DoGetColumnVerticalTextAlign=function(t,e,i,s){var o=i;1===o?s.set(this.FHeader.FVerticalTextAlign):2===o&&s.set(this.FFooter.FVerticalTextAlign)},this.DoIsNodeChecked=function(e,i,s,o){var n=t.TTMSFNCTableViewDisplayItem.$new();if(i.FRow>=0&&i.FRow<=this.FDisplayList.GetCount()-1){n.$assign(this.FDisplayList.GetItem(i.FRow));var r=n.Kind;1===r&&null!=n.Item&&o.set(n.Item.FChecked)}},this.DoGetNodeCheckType=function(e,i,s,o){var n=t.TTMSFNCTableViewDisplayItem.$new(),r=0;if(this.FEditMode&&i.FRow>=0&&i.FRow<=this.FDisplayList.GetCount()-1){n.$assign(this.FDisplayList.GetItem(i.FRow));var a=n.Kind;1===a&&null!=n.Item&&(r=n.Item.FCheckType,o.set(r))}},this.DoAfterCheckNode=function(e,i,s){var o=t.TTMSFNCTableViewDisplayItem.$new();if(i.FRow>=0&&i.FRow<=this.FDisplayList.GetCount()-1){o.$assign(this.FDisplayList.GetItem(i.FRow));var n=o.Kind;1===n&&null!=o.Item&&(o.Item.SetChecked(!0),null!=this.FTreeView&&this.FTreeView.DoAfterSelectNode(i),this.DoItemCheckChanged(o.Item))}},this.DoAfterUnCheckNode=function(e,i,s){var o=t.TTMSFNCTableViewDisplayItem.$new();if(i.FRow>=0&&i.FRow<=this.FDisplayList.GetCount()-1){o.$assign(this.FDisplayList.GetItem(i.FRow));var n=o.Kind;1===n&&null!=o.Item&&(o.Item.SetChecked(!1),null!=this.FTreeView&&this.FTreeView.DoAfterUnSelectNode(i),this.DoItemCheckChanged(o.Item))}},this.DoItemCheckChanged=function(t){null!=this.FOnItemCheckChanged&&this.FOnItemCheckChanged(this,t)},this.DoGetNumberOfNodes=function(t,e,i){-1===e.FLevel&&i.set(this.FDisplayList.GetCount())},this.DoGetHTMLTemplateValue=function(t,e,i){null!=this.FOnGetHTMLTemplateValue&&this.FOnGetHTMLTemplateValue(this,t,e,i)},this.DoGetHTMLTemplate=function(t,e){null!=this.FOnGetHTMLTemplate&&this.FOnGetHTMLTemplate(this,t,e)},this.DoIsNodeExtended=function(e,i,s){var o=t.TTMSFNCTableViewDisplayItem.$new();i.FRow>=0&&i.FRow<=this.FDisplayList.GetCount()-1&&(o.$assign(this.FDisplayList.GetItem(i.FRow)),2===o.Kind&&s.set(!0))},this.DoGetNodeText=function(e,i,s,o,n){var r=t.TTMSFNCTableViewDisplayItem.$new();if(i.FRow>=0&&i.FRow<=this.FDisplayList.GetCount()-1){r.$assign(this.FDisplayList.GetItem(i.FRow));var a=r.Kind;1===a?null!=r.Item&&n.set(r.Item.GetText()):2===a&&n.set(r.Text)}},this.DoGetNodeTitle=function(e,i,s,o,n){var r=t.TTMSFNCTableViewDisplayItem.$new();i.FRow>=0&&i.FRow<=this.FDisplayList.GetCount()-1&&(r.$assign(this.FDisplayList.GetItem(i.FRow)),1===r.Kind&&null!=r.Item&&n.set(r.Item.GetTitle()))},this.DoGetNodeTitleExpanded=function(e,i,s,o){var n=t.TTMSFNCTableViewDisplayItem.$new();i.FRow>=0&&i.FRow<=this.FDisplayList.GetCount()-1&&(n.$assign(this.FDisplayList.GetItem(i.FRow)),1===n.Kind&&null!=n.Item&&o.set(n.Item.FTitleExpanded))},this.DoGetNodeTrimming=function(e,i,s,o){var n=t.TTMSFNCTableViewDisplayItem.$new();if(i.FRow>=0&&i.FRow<=this.FDisplayList.GetCount()-1){n.$assign(this.FDisplayList.GetItem(i.FRow));var r=n.Kind;1===r&&null!=n.Item&&o.set(n.Item.FTrimming)}},this.DoGetNodeTitleTrimming=function(e,i,s,o){var n=t.TTMSFNCTableViewDisplayItem.$new();if(i.FRow>=0&&i.FRow<=this.FDisplayList.GetCount()-1){n.$assign(this.FDisplayList.GetItem(i.FRow));var r=n.Kind;1===r&&null!=n.Item&&o.set(n.Item.FTitleTrimming)}},this.DrawBadge=function(t,e,i){var s,o,n=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),r=pas["WEBLib.TMSFNCTypes"].TSizeF.$new(),a=null;if(""!==i.FAccessoryText){t.FFont.Assign(this.FItemAppearance.FAccessoryFont),t.FStroke.Assign(this.FItemAppearance.FAccessoryStroke),t.FFill.Assign(this.FItemAppearance.FAccessoryFill),-1!==i.FAccessoryFontColor&&t.FFont.SetColor(i.FAccessoryFontColor),-1!==i.FAccessoryBorderColor&&t.FStroke.SetColor(i.FAccessoryBorderColor),-1!==i.FAccessoryColor&&t.FFill.SetColor(i.FAccessoryColor),s=i.FAccessoryText,r.$assign(t.CalculateTextSize$1(s)),r.cy=r.cy+4,r.cx=Math.max(r.cy,r.cx+6),n.$assign(e),n.$assign(pas["WEBLib.TMSFNCTypes"].RectF(n.Left+(n.Right-n.Left-r.cx)/2,n.Top+(n.Bottom-n.Top-r.cy)/2,n.Left+(n.Right-n.Left-r.cx)/2+r.cx,n.Top+(n.Bottom-n.Top-r.cy)/2+r.cy)),o=(n.Bottom-n.Top)/2,a=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsPath.$create("Create$1");try{a.AddArc(pas["WEBLib.TMSFNCTypes"].PointF(n.Left+o,n.Top+o),pas["WEBLib.TMSFNCTypes"].PointF(o,o),180,90),a.AddArc(pas["WEBLib.TMSFNCTypes"].PointF(n.Right-o,n.Top+o),pas["WEBLib.TMSFNCTypes"].PointF(o,o),-90,90),a.AddArc(pas["WEBLib.TMSFNCTypes"].PointF(n.Right-o,n.Bottom-o),pas["WEBLib.TMSFNCTypes"].PointF(o,o),0,90),a.AddArc(pas["WEBLib.TMSFNCTypes"].PointF(n.Left+o,n.Bottom-o),pas["WEBLib.TMSFNCTypes"].PointF(o,o),-270,90),a.ClosePath(),t.DrawPath(a,0)}finally{a=rtl.freeLoc(a)}t.DrawText$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(n),s,!1,0,0,0,0,-1,-1,!0,!1,-1,-1)}},this.DoDrawNodeExtra=function(e,i,s,o,n){var r=t.TTMSFNCTableViewDisplayItem.$new(),a=null,l=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),h=0,F=0,p=null,c=0,u=!1,C=0,T=0;if(null!=this.FTreeView&&n.FRow>=0&&n.FRow<=this.FDisplayList.GetCount()-1){r.$assign(this.FDisplayList.GetItem(n.FRow));var S=r.Kind;if(1===S&&null!=r.Item){if(this.FTreeView.FMoreOffsetItem===r.Item&&this.FMoreOptions.GetCount()>0){i.FFont.Assign(this.FMoreOptionAppearance.FFont),i.FFill.Assign(this.FMoreOptionAppearance.FFill),i.FStroke.Assign(this.FMoreOptionAppearance.FStroke),c=this.FTreeView.FMoreOffset/this.FMoreOptions.GetCount();for(var d=0,m=this.FMoreOptions.GetCount()-1;d<=m;d++)F=d,-1!==(p=this.FMoreOptions.GetItem$1(F)).FColor&&i.FFill.SetColor(p.FColor),-1!==p.FBorderColor&&i.FStroke.SetColor(p.FBorderColor),-1!==p.FFontColor&&i.FFont.SetColor(p.FFontColor),l.$assign(pas["WEBLib.TMSFNCTypes"].RectF(s.Right-1+c*F,s.Top,s.Right-1+c*(F+1),s.Bottom)),u=!0,this.DoBeforeDrawItemMoreOption(i,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(l),r.Item,p,{get:function(){return u},set:function(t){u=t}}),u&&(this.FTreeView.FDownMoreOption===p&&(i.FFill.SetColor(pas["WEBLib.TMSFNCGraphicsTypes"].Lighter(i.FFill.FColor,20)),i.FStroke.SetColor(pas["WEBLib.TMSFNCGraphicsTypes"].Lighter(i.FStroke.FColor,20))),i.DrawRectangle$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(l),0),pas["WEBLib.TMSFNCTypes"].InflateRectEx(l,-2,-2),i.DrawText$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(l),p.FText,!1,0,0,0,0,-1,-1,!0,!1,-1,-1),this.DoAfterDrawItemMoreOption(i,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(l),r.Item,p))}if(r.Item.FAccessoryWidth>0&&r.Item.FAccessoryHeight>0&&0!==r.Item.FAccessory){l.$assign(s),r.Item===this.FTreeView.FMoreOffsetItem&&(l.Left=l.Left+this.FTreeView.FMoreOffset),pas["WEBLib.TMSFNCTypes"].InflateRectEx(l,-4,-4),h=r.Item.FAccessoryHeight,l.$assign(pas["WEBLib.TMSFNCTypes"].RectF(l.Left,l.Top+(l.Bottom-l.Top-h)/2,l.Right,l.Top+(l.Bottom-l.Top-h)/2+h)),i.FFont.Assign(this.FItemAppearance.FAccessoryFont),-1!==r.Item.FAccessoryFontColor&&i.FFont.SetColor(r.Item.FAccessoryFontColor);var f=r.Item.FAccessory;1===f?null==(a=pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.GetScaledBitmap(this.FItemAppearance.FAccessoryDetailBitmaps,0,this.GetBitmapContainer()))||pas["WEBLib.TMSFNCTypes"].IsBitmapEmpty(a)||i.DrawBitmap$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(l),a,!0,!1,!0,!1):2===f?(C=this.FItemAppearance.FAccessoryFill.FColor,-1!==r.Item.FAccessoryColor&&(C=r.Item.FAccessoryColor),T=this.FItemAppearance.FAccessoryFont.FColor,-1!==r.Item.FAccessoryFontColor&&(T=r.Item.FAccessoryFontColor),i.DrawProgressBar(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(l),r.Item.FAccessoryProgress,"%.0f%%",100,C,T,!0,!0,1)):4===f?this.DrawBadge(i,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(l),r.Item):3===f?(i.DrawButton(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(l),r.Item===this.FActiveAccessoryItem,!1,!0,!0,1),i.DrawText$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(l),r.Item.FAccessoryText,!1,0,0,0,0,-1,-1,!0,!1,-1,-1)):5===f&&this.DoDrawItemCustomAccessory(i,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(l),r.Item)}}}},this.DoDrawItemCustomAccessory=function(t,e,i){null!=this.FOnDrawItemCustomAccessory&&this.FOnDrawItemCustomAccessory(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i)},this.DoBeforeDrawItemMoreOption=function(t,e,i,s,o){null!=this.FOnBeforeDrawItemMoreOption&&this.FOnBeforeDrawItemMoreOption(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i,s,o)},this.DoAfterDrawItemMoreOption=function(t,e,i,s){null!=this.FOnAfterDrawItemMoreOption&&this.FOnAfterDrawItemMoreOption(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i,s)},this.DoGetNodeWordWrapping=function(e,i,s,o){var n=t.TTMSFNCTableViewDisplayItem.$new();if(i.FRow>=0&&i.FRow<=this.FDisplayList.GetCount()-1){n.$assign(this.FDisplayList.GetItem(i.FRow));var r=n.Kind;1===r&&null!=n.Item&&o.set(n.Item.FWordWrapping)}},this.DoGetNodeTitleWordWrapping=function(e,i,s,o){var n=t.TTMSFNCTableViewDisplayItem.$new();if(i.FRow>=0&&i.FRow<=this.FDisplayList.GetCount()-1){n.$assign(this.FDisplayList.GetItem(i.FRow));var r=n.Kind;1===r&&null!=n.Item&&o.set(n.Item.FTitleWordWrapping)}},this.DoGetNodeExtraSize=function(e,i,s,o){var n=t.TTMSFNCTableViewDisplayItem.$new();if(null!=this.FTreeView&&i.FRow>=0&&i.FRow<=this.FDisplayList.GetCount()-1){n.$assign(this.FDisplayList.GetItem(i.FRow));var r=n.Kind;1===r&&(null!=n.Item&&n.Item.FAccessoryWidth>0&&0!==n.Item.FAccessory&&o.set(n.Item.FAccessoryWidth+8),n.Item===this.FTreeView.FMoreOffsetItem&&o.set(o.get()+this.FTreeView.FMoreOffset))}},this.DoGetNodeTitleHorizontalTextAlign=function(e,i,s,o){var n=t.TTMSFNCTableViewDisplayItem.$new();if(i.FRow>=0&&i.FRow<=this.FDisplayList.GetCount()-1){n.$assign(this.FDisplayList.GetItem(i.FRow));var r=n.Kind;1===r&&null!=n.Item&&o.set(n.Item.FTitleHorizontalTextAlign)}},this.DoGetNodeTitleVerticalTextAlign=function(e,i,s,o){var n=t.TTMSFNCTableViewDisplayItem.$new();if(i.FRow>=0&&i.FRow<=this.FDisplayList.GetCount()-1){n.$assign(this.FDisplayList.GetItem(i.FRow));var r=n.Kind;1===r&&null!=n.Item&&o.set(n.Item.FTitleVerticalTextAlign)}},this.DoGetNodeHorizontalTextAlign=function(e,i,s,o){var n=t.TTMSFNCTableViewDisplayItem.$new();if(i.FRow>=0&&i.FRow<=this.FDisplayList.GetCount()-1){n.$assign(this.FDisplayList.GetItem(i.FRow));var r=n.Kind;1===r&&null!=n.Item&&o.set(n.Item.FHorizontalTextAlign)}},this.DoGetNodeVerticalTextAlign=function(e,i,s,o){var n=t.TTMSFNCTableViewDisplayItem.$new();if(i.FRow>=0&&i.FRow<=this.FDisplayList.GetCount()-1){n.$assign(this.FDisplayList.GetItem(i.FRow));var r=n.Kind;1===r&&null!=n.Item&&o.set(n.Item.FVerticalTextAlign)}},this.DoGetNodeTextColor=function(e,i,s,o){var n=t.TTMSFNCTableViewDisplayItem.$new();if(i.FRow>=0&&i.FRow<=this.FDisplayList.GetCount()-1){n.$assign(this.FDisplayList.GetItem(i.FRow));var r=n.Kind;1===r?null!=n.Item&&o.set(n.Item.FTextColor):2===r&&o.set(this.FCategoryAppearance.GetFont().FColor)}},this.DoGetNodeSelectedTextColor=function(e,i,s,o){var n=t.TTMSFNCTableViewDisplayItem.$new();if(i.FRow>=0&&i.FRow<=this.FDisplayList.GetCount()-1){n.$assign(this.FDisplayList.GetItem(i.FRow));var r=n.Kind;1===r&&null!=n.Item&&o.set(n.Item.FSelectedTextColor)}},this.DoGetNodeDisabledTextColor=function(e,i,s,o){var n=t.TTMSFNCTableViewDisplayItem.$new();if(i.FRow>=0&&i.FRow<=this.FDisplayList.GetCount()-1){n.$assign(this.FDisplayList.GetItem(i.FRow));var r=n.Kind;1===r&&null!=n.Item&&o.set(n.Item.FDisabledTextColor)}},this.DoGetNodeTitleColor=function(e,i,s,o){var n=t.TTMSFNCTableViewDisplayItem.$new();i.FRow>=0&&i.FRow<=this.FDisplayList.GetCount()-1&&(n.$assign(this.FDisplayList.GetItem(i.FRow)),1===n.Kind&&null!=n.Item&&o.set(n.Item.FTitleColor))},this.DoGetNodeSelectedTitleColor=function(e,i,s,o){var n=t.TTMSFNCTableViewDisplayItem.$new();if(i.FRow>=0&&i.FRow<=this.FDisplayList.GetCount()-1){n.$assign(this.FDisplayList.GetItem(i.FRow));var r=n.Kind;1===r&&null!=n.Item&&o.set(n.Item.FSelectedTitleColor)}},this.DoGetNodeDisabledTitleColor=function(e,i,s,o){var n=t.TTMSFNCTableViewDisplayItem.$new();if(i.FRow>=0&&i.FRow<=this.FDisplayList.GetCount()-1){n.$assign(this.FDisplayList.GetItem(i.FRow));var r=n.Kind;1===r&&null!=n.Item&&o.set(n.Item.FDisabledTitleColor)}},this.DoIsNodeEnabled=function(e,i,s){var o=t.TTMSFNCTableViewDisplayItem.$new();if(i.FRow>=0&&i.FRow<=this.FDisplayList.GetCount()-1){o.$assign(this.FDisplayList.GetItem(i.FRow));var n=o.Kind;1===n&&null!=o.Item&&s.set(o.Item.FEnabled)}},this.DoAfterSelectNode=function(t,e){null!=this.FOnItemSelected&&this.FOnItemSelected(this,this.GetItemForNode(e)),null!=this.FOnItemSelectionChanged&&this.FOnItemSelectionChanged(this)},this.DoAfterUnSelectNode=function(t,e){null!=this.FOnItemUnSelected&&this.FOnItemUnSelected(this,this.GetItemForNode(e)),null!=this.FOnItemSelectionChanged&&this.FOnItemSelectionChanged(this)},this.DoNeedFilterDropDownData=function(t,e,i){null!=this.FOnNeedFilterDropDownData&&this.FOnNeedFilterDropDownData(this,i)},this.DoFilterSelect=function(t,e,i){null!=this.FOnFilterSelect&&this.FOnFilterSelect(this,i)},this.DoBeforeDrawSortIndicator=function(t,e,i,s,o,n,r){var a=0;null!=this.FOnBeforeDrawSortIndicator&&(a=n,this.FOnBeforeDrawSortIndicator(this,e,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),o,a,r))},this.DoAfterDrawSortIndicator=function(t,e,i,s,o,n){var r=0;null!=this.FOnAfterDrawSortIndicator&&(r=n,this.FOnAfterDrawSortIndicator(this,e,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),o,r))},this.DoBeforeDrawNode=function(t,e,i,s,o,n){null!=this.FOnBeforeDrawItem&&this.FOnBeforeDrawItem(this,e,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),this.GetItemForNode(s),o,n)},this.DoAfterDrawNode=function(t,e,i,s){null!=this.FOnAfterDrawItem&&this.FOnAfterDrawItem(this,e,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),this.GetItemForNode(s))},this.DoItemCompare=function(t,e,i){null!=this.FOnItemCompare&&this.FOnItemCompare(this,t,e,i)},this.DoBeforeDrawNodeText=function(t,e,i,s,o,n,r){null!=this.FOnBeforeDrawItemText&&this.FOnBeforeDrawItemText(this,e,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),this.GetItemForNode(o),n,r)},this.DoAfterDrawNodeText=function(t,e,i,s,o,n){null!=this.FOnAfterDrawItemText&&this.FOnAfterDrawItemText(this,e,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),this.GetItemForNode(o),n)},this.DoBeforeDrawNodeTitle=function(t,e,i,s,o,n,r){null!=this.FOnBeforeDrawItemTitle&&this.FOnBeforeDrawItemTitle(this,e,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),this.GetItemForNode(o),n,r)},this.DoAfterDrawNodeTitle=function(t,e,i,s,o,n){null!=this.FOnAfterDrawItemTitle&&this.FOnAfterDrawItemTitle(this,e,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),this.GetItemForNode(o),n)},this.DoBeforeDrawNodeIcon=function(t,e,i,s,o,n,r){null!=this.FOnBeforeDrawItemIcon&&this.FOnBeforeDrawItemIcon(this,e,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),this.GetItemForNode(o),n,r)},this.DoAfterDrawNodeIcon=function(t,e,i,s,o,n){null!=this.FOnAfterDrawItemIcon&&this.FOnAfterDrawItemIcon(this,e,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),this.GetItemForNode(o),n)},this.DoBeforeDrawNodeCheck=function(t,e,i,s,o,n,r){null!=this.FOnBeforeDrawItemCheck&&this.FOnBeforeDrawItemCheck(this,e,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),this.GetItemForNode(o),n,r)},this.DoAfterDrawNodeCheck=function(t,e,i,s,o,n){null!=this.FOnAfterDrawItemCheck&&this.FOnAfterDrawItemCheck(this,e,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),this.GetItemForNode(o),n)},this.DoNodeAnchorClick=function(t,e,i,s){null!=this.FOnItemAnchorClick?this.FOnItemAnchorClick(this,this.GetItemForNode(e),s):this.FInteraction.GetAutoOpenURL()&&pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.OpenURL(s)},this.DoNodeTitleAnchorClick=function(t,e,i,s){null!=this.FOnItemTitleAnchorClick?this.FOnItemTitleAnchorClick(this,this.GetItemForNode(e),s):this.FInteraction.GetAutoOpenURL()&&pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.OpenURL(s)},this.DoNodeClick=function(t,e){var i=null;null==(i=this.GetItemForNode(e))||1!==this.FInteraction.FShowDetailMode||this.FEditMode||i.ShowDetailControl(),null!=i&&this.FEditMode&&(i.FChecked?(i.SetChecked(!1),this.FTreeView.DoAfterUnSelectNode(e)):(i.SetChecked(!0),this.FTreeView.DoAfterSelectNode(e)),this.SelectAllCheckedItems()),null!=this.FOnItemClick&&this.FOnItemClick(this,this.GetItemForNode(e)),null!=this.FParent&&pas["WEBLib.TMSFNCCustomSelector"].TTMSFNCCustomSelector.isPrototypeOf(this.FParent)&&null!=this.FParent.FOwner&&pas["WEBLib.TMSFNCControlPicker"].TTMSFNCControlPicker.isPrototypeOf(this.FParent.FOwner)&&(null!=i?rtl.as(this.FParent.FOwner,pas["WEBLib.TMSFNCControlPicker"].TTMSFNCControlPicker).CallItemClicked(i.GetIndex()):rtl.as(this.FParent.FOwner,pas["WEBLib.TMSFNCControlPicker"].TTMSFNCControlPicker).UpdateDropDown())},this.DoNodeMouseLeave=function(t,e){null!=this.FOnItemMouseLeave&&this.FOnItemMouseLeave(this,this.GetItemForNode(e))},this.DoNodeMouseEnter=function(t,e){null!=this.FOnItemMouseEnter&&this.FOnItemMouseEnter(this,this.GetItemForNode(e))},this.DoNodeDblClick=function(t,e){null!=this.FOnItemDblClick&&this.FOnItemDblClick(this,this.GetItemForNode(e))},this.DoVScroll=function(t,e){null!=this.FOnVScroll&&this.FOnVScroll(this,e)},this.DoBeforeCutToClipboard=function(t,e){null!=this.FOnBeforeCutToClipboard&&this.FOnBeforeCutToClipboard(this,e)},this.DoBeforeCopyToClipboard=function(t,e){null!=this.FOnBeforeCopyToClipboard&&this.FOnBeforeCopyToClipboard(this,e)},this.DoBeforePasteFromClipboard=function(t,e){null!=this.FOnBeforePasteFromClipboard&&this.FOnBeforePasteFromClipboard(this,e)},this.DoAfterCutToClipboard=function(t){null!=this.FOnAfterCutToClipboard&&this.FOnAfterCutToClipboard(this)},this.DoAfterCopyToClipboard=function(t){null!=this.FOnAfterCopyToClipboard&&this.FOnAfterCopyToClipboard(this)},this.DoAfterPasteFromClipboard=function(t){null!=this.FOnAfterPasteFromClipboard&&this.FOnAfterPasteFromClipboard(this)},this.DoBeforeReorderItem=function(t,e,i){null!=this.FOnBeforeReorderItem&&this.FOnBeforeReorderItem(this,t,e,i)},this.DoAfterReorderItem=function(t,e){null!=this.FOnAfterReorderItem&&this.FOnAfterReorderItem(this,t,e)},this.DoBeforeDropItem=function(t,e,i){null!=this.FOnBeforeDropItem&&this.FOnBeforeDropItem(this,t,e,i)},this.DoAfterDropItem=function(t,e){null!=this.FOnAfterDropItem&&this.FOnAfterDropItem(this,t,e)},this.CustomizeTreeView=function(t){},this.DoCustomDragOver=function(t,e,i,s){s.set(0!==this.FInteraction.GetDragDropMode()&&pas["WEBLib.TMSFNCCustomTreeView"].TTMSFNCCustomTreeView.isPrototypeOf(e)&&null!=rtl.as(e,pas["WEBLib.TMSFNCCustomTreeView"].TTMSFNCCustomTreeView).FDragNode),s.set(s.get()&&pas["WEBLib.TMSFNCTypes"].PtInRectEx(this.GetItemsRect(),i)),this.FAccepted=s.get()},this.DoCustomDragDrop=function(e,i,s){var o=null,n=null,r=null,a=null,l=null,h=null,F=!1,p=null;if(this.FAccepted&&null!=i&&pas["WEBLib.TMSFNCCustomTreeView"].TTMSFNCCustomTreeView.isPrototypeOf(i)&&t.TTMSFNCCustomTableView.isPrototypeOf(rtl.as(i,pas["WEBLib.TMSFNCCustomTreeView"].TTMSFNCCustomTreeView).FParent)&&0!==i.FInteraction.FDragDropMode&&null!=(h=rtl.as(i,pas["WEBLib.TMSFNCCustomTreeView"].TTMSFNCCustomTreeView).FDragNode)&&(n=rtl.as(i,pas["WEBLib.TMSFNCCustomTreeView"].TTMSFNCCustomTreeView).FParent.GetItemForNode(h),(o=this.XYToItem(s.X,s.Y))!==n&&null!=n&&pas["WEBLib.TMSFNCTypes"].PtInRectEx(this.GetItemsRect(),s)&&(F=!0,null!=o?this.DoBeforeDropItem(n,o,{get:function(){return F},set:function(t){F=t}}):(this.FUpdateCount$1+=1,l=this.FItems.Add$1(),this.FUpdateCount$1-=1,this.DoBeforeDropItem(n,l,{get:function(){return F},set:function(t){F=t}}),l=rtl.freeLoc(l)),F))){if(a=null,this.BeginUpdate(),(p=rtl.as(i,pas["WEBLib.TMSFNCCustomTreeView"].TTMSFNCCustomTreeView).FParent).BeginUpdate(),null!=o){var c=p.FInteraction.GetDragDropMode();1===c?rtl.as(i,pas["WEBLib.TMSFNCCustomTreeView"].TTMSFNCCustomTreeView).FParent===this?(this.DragItemMove(n,o),n.SetIndex(o.GetIndex()),a=o):(r=this.FItems.Add$1(),this.DragItemAdd(r,n,o),p.DragItemDelete(n),r.Assign(n),r.SetIndex(o.GetIndex()),p.FItems.Delete(n.GetIndex()),p.SetItemIndex(p.GetItemIndex()),a=r,n=null):2===c&&(r=this.FItems.Add$1(),this.DragItemAdd(r,n,o),r.Assign(n),r.SetIndex(o.GetIndex()),a=r)}else{r=this.FItems.Add$1(),this.DragItemAdd(r,n,null),r.Assign(n),1===p.FInteraction.GetDragDropMode()&&(p.DragItemDelete(n),p.FTreeView.RemoveNodeFromSelection(p.GetNodeForItemIndex(n.GetIndex())),p.FItems.Delete(n.GetIndex()),p.SetItemIndex(p.GetItemIndex()),n=null),a=r}rtl.as(i,pas["WEBLib.TMSFNCCustomTreeView"].TTMSFNCCustomTreeView).FDragNode=null,null!=a&&(this.FSaveSelectedItem=a.GetIndex(),this.FSaveSelectedItems=rtl.arraySetLength(this.FSaveSelectedItems,0,1),this.FSaveSelectedItems[0]=a.GetIndex()),p.EndUpdate(),this.EndUpdate(),this.DoAfterDropItem(n,a)}},this.DragItemMove=function(t,e){},this.DragItemAdd=function(t,e,i){},this.DragItemDelete=function(t){},this.DoCustomReorder=function(t,e,i){var s=null,o=null,n=!1;null!=e&&null!=i&&(n=!0,s=this.GetItemForNode(e),o=this.GetItemForNode(i),this.DoBeforeReorderItem(s,o,{get:function(){return n},set:function(t){n=t}}),n&&(this.BeginUpdate(),s.SetIndex(o.GetIndex()),this.EndUpdate(),this.DoAfterReorderItem(s,o)))},this.DoCopyToClipboard=function(t){this.CopyToClipboard(1===this.FInteraction.GetClipboardMode())},this.DoCutToClipboard=function(t){this.CutToClipboard(1===this.FInteraction.GetClipboardMode())},this.DoPasteFromClipboard=function(t){this.PasteFromClipboard()},this.DoColumnSort=function(t,e,i){var s;s=i,this.FItems.Sort$1(this.FInteraction.GetSorting()in rtl.createSet(2),s)},this.DoLookup=function(t,e){this.LookupItem(e,this.FInteraction.FLookup.GetCaseSensitive(),this.FInteraction.FLookup.GetAutoSelect())},this.UpdateActiveDetailControl=function(){var t=pas["WEBLib.TMSFNCTypes"].TRectF.$new();null!=this.FActiveDetailControl&&null!=this.FTreeView&&(t.$assign(this.FTreeView.GetContentRect()),pas["WEBLib.TMSFNCTypes"].InflateRectEx(t,-1,-1),t.$assign(pas["WEBLib.TMSFNCTypes"].RectF(t.Left+this.FDetailControlOffset,t.Top,t.Right+this.FDetailControlOffset,t.Bottom)),this.FActiveDetailControl.SetBounds(Math.round(t.Left),Math.round(t.Top),Math.round(t.Right-t.Left),Math.round(t.Bottom-t.Top)))},this.DoFooterAnchorClick=function(t,e){null!=this.FOnFooterAnchorClick?this.FOnFooterAnchorClick(this,e):this.FInteraction.GetAutoOpenURL()&&pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.OpenURL(e)},this.DoHeaderAnchorClick=function(t,e){null!=this.FOnHeaderAnchorClick?this.FOnHeaderAnchorClick(this,e):this.FInteraction.GetAutoOpenURL()&&pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.OpenURL(e)},this.PickerGetContent=function(){var t="";return t="",this.GetItemIndex()>=0&&(t=this.FItems.GetItem$1(this.GetItemIndex()).FText),t},this.PickerSelectItem=function(t){t>=0&&t<=this.FItems.GetCount()-1&&this.SetItemIndex(t)},this.PickerGetSelectedItem=function(){return this.GetItemIndex()},this.PickerGetVisibleItemCount=function(){return null!=this.FTreeView?this.FTreeView.FVisibleNodes.GetCount():0},this.PickerGetItemCount=function(){return this.FItems.GetCount()},this.PickerGetItemHeight=function(){return this.FItemAppearance.GetFixedHeight()},this.PickerSetItemHeight=function(t){this.FItemAppearance.SetFixedHeight(t)},this.PickerGetItemWidth=function(){return this.GetWidth()},this.PickerSetItemWidth=function(t){},this.PickerGetNextSelectableItem=function(t){return t<this.FItems.GetCount()-1?t+1:t},this.PickerGetPreviousSelectableItem=function(t){return t>0?t-1:t},this.PickerGetFirstSelectableItem=function(){return this.FItems.GetCount()>0?0:-1},this.PickerGetLastSelectableItem=function(){return this.FItems.GetCount()>0?this.FItems.GetCount()-1:-1},this.PickerResetFilter=function(){this.RemoveFilters()},this.PickerApplyFilter=function(t,e){this.ApplyFilter()},this.PickerLookupItem=function(t,e){var i=pas["WEBLib.TMSFNCControlPicker"].TTMSFNCControlPickerFilterItem.$new(),s=null;return s=this.LookupItem(t,e,!1),i.ItemIndex=s.GetIndex(),i.ItemText=s.FText,i},this.SetFonts=function(t){var e=0;if(this.BeginUpdate(),this.FGlobalFont.ApplyChange(this.FFooter.GetFont(),t),this.FGlobalFont.ApplyChange(this.FHeader.GetFont(),t),this.FGlobalFont.ApplyChange(this.FItemAppearance.GetFont(),t),this.FGlobalFont.ApplyChange(this.FItemAppearance.FAccessoryFont,t),this.FGlobalFont.ApplyChange(this.FLookupBar.FFont,t),this.FGlobalFont.ApplyChange(this.FLookupBar.FInActiveFont,t),1===t)for(var i=0,s=this.FItems.GetCount()-1;i<=s;i++)e=i,this.FItems.GetItem$1(e).SetTextColor(this.FGlobalFont.FColor),this.FItems.GetItem$1(e).SetAccessoryFontColor(this.FGlobalFont.FColor),this.FItems.GetItem$1(e).SetSelectedTextColor(this.FGlobalFont.FColor),this.FItems.GetItem$1(e).FSelectedTitleColor=this.FGlobalFont.FColor;this.EndUpdate()},this.Create$1=function(e){return pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Create$1.apply(this,arguments),this.FFirstLoad=!1,this.FEdit=t.TTMSFNCTableViewEdit.$create("Create$1",[this]),this.FEdit.FTableView=this,this.FEdit.FOnChange=rtl.createCallback(this,"DoEditChange"),this.FEditButton=pas["WEBLib.TMSFNCToolBar"].TTMSFNCToolBarButton.$create("Create$1",[this]),this.FEditButton.FOnClick=rtl.createCallback(this,"DoEditButtonClicked"),this.FEditButton.FStored=!1,this.FEditButton.SetWidth(50),this.FEditButton.FAppearance.SetFlatStyle(!0),this.FDoneButton=pas["WEBLib.TMSFNCToolBar"].TTMSFNCToolBarButton.$create("Create$1",[this]),this.FDoneButton.FOnClick=rtl.createCallback(this,"DoDoneButtonClicked"),this.FDoneButton.FStored=!1,this.FDoneButton.SetWidth(50),this.FDoneButton.FAppearance.SetFlatStyle(!0),this.FFilterButton=pas["WEBLib.TMSFNCToolBar"].TTMSFNCToolBarButton.$create("Create$1",[this]),this.FFilterButton.FOnClick=rtl.createCallback(this,"DoFilterButtonClicked"),this.FFilterButton.FStored=!1,this.FFilterButton.SetWidth(30),this.FFilterButton.FAppearance.SetFlatStyle(!0),this.FFilterButton.FBitmaps.AddBitmapFromResource$1(t.TMSFNCTABLEVIEWSEARCH,pas["WEBLib.TMSFNCTypes"].HInstance(),1),this.FFilterButton.SetBitmapVisible(!0),this.FBackButton=pas["WEBLib.TMSFNCToolBar"].TTMSFNCToolBarButton.$create("Create$1",[this]),this.FBackButton.FOnClick=rtl.createCallback(this,"DoBackButtonClicked"),this.FBackButton.FStored=!1,this.FBackButton.SetWidth(50),this.FBackButton.FAppearance.SetFlatStyle(!0),this.FEditButton.SetText("Edit"),this.FDoneButton.SetText("Done"),this.FBackButton.SetText("Back"),this.FDetailControlTimer=pas["WEBLib.ExtCtrls"].TTimer.$create("Create$1",[this]),this.FDetailControlTimer.FOnTimer=rtl.createCallback(this,"DoDetailControlTimer"),this.FDetailControlTimer.SetEnabled(!1),this.FDetailControlTimer.SetInterval(1),this.FDisplayList=t.TTMSFNCTableViewDisplayList.$create("Create$1"),this.FCategoryList=t.TTMSFNCTableViewDisplayList.$create("Create$1"),this.FLookupBarDisplayList=t.TTMSFNCTableViewLookupBarDisplayList.$create("Create$1"),this.FItems=this.CreateItems(),this.FLookupBar=t.TTMSFNCTableViewLookupBar.$create("Create$1",[this]),this.FReload=t.TTMSFNCTableViewReload.$create("Create$1",[this]),this.FCategories=t.TTMSFNCTableViewCategories.$create("Create$3",[this]),this.FMoreOptions=t.TTMSFNCTableViewMoreOptions.$create("Create$3",[this]),this.FCategoryType=0,this.FCustomChar=t.TTMSFNCTableViewCustomCharList.$create("Create$2"),this.FTreeView=this.CreateTreeView(),this.FTreeView.FAllowTouch=!1,this.FTreeView.FOnClick=rtl.createCallback(this,"DoClick"),this.FTreeView.SetOptimizedHTMLDrawing(!0),this.FTreeView.FTableView=this,this.FTreeView.FStored=!1,this.FTreeView.SetParent(this),this.FTreeView.FColumns.Clear(),this.FColumn=this.FTreeView.FColumns.Add$1(),this.FTreeView.ClearNodes(),this.FTreeView.FColumnsAppearance.SetLayouts(rtl.createSet(0,1)),this.FTreeView.FColumnsAppearance.SetTopSize(30),this.FTreeView.FColumnsAppearance.SetBottomSize(30),this.FTreeView.SetStretchScrollBars(!0),this.FTreeView.SetVerticalScrollBarVisible(!1),this.FTreeView.FNodesAppearance.FStroke.SetKind(1),this.FTreeView.FNodesAppearance.SetExpandColumn(-1),this.FTreeView.FNodesAppearance.SetLevelIndent(0),this.FTreeView.FNodesAppearance.SetShowLines(!1),this.FTreeView.FNodesAppearance.SetExpandWidth(0),this.FTreeView.FNodesAppearance.SetExpandHeight(0),this.FTreeView.FNodesAppearance.SetSelectionArea(0),this.FTreeView.FNodesAppearance.SetShowFocus(!0),this.FTreeView.FNodesAppearance.FSelectedFill.SetColor(pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(217,217,217)),this.FTreeView.FNodesAppearance.FSelectedStroke.SetColor(pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(217,217,217)),this.FTreeView.FNodesAppearance.FStroke.SetColor(pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(200,199,204)),this.FFilter=t.TTMSFNCTableViewFilter.$create("Create$3",[this]),this.FHeader=t.TTMSFNCTableViewHeader.$create("Create$1",[this]),this.FFooter=t.TTMSFNCTableViewFooter.$create("Create$1",[this]),this.FItemAppearance=t.TTMSFNCTableViewItemAppearance.$create("Create$1",[this]),this.FCategoryAppearance=t.TTMSFNCTableViewCategoryAppearance.$create("Create$1",[this]),this.FMoreOptionAppearance=t.TTMSFNCTableViewMoreOptionAppearance.$create("Create$1",[this]),this.FDefaultItem=t.TTMSFNCTableViewItem.$create("Create$1",[null]),this.FInteraction=t.TTMSFNCTableViewInteraction.$create("Create$1",[this]),this.FCopyItems=t.TTMSFNCTableViewCopyItems.$create("Create$3",[null]),this.FGlobalFont=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCAppearanceGlobalFont.$create("Create$1",[this]),this.FTreeView.FOnGetNodeSides=rtl.createCallback(this,"DoGetNodeSides"),this.FTreeView.FOnGetColumnText=rtl.createCallback(this,"DoGetColumnText"),this.FTreeView.FOnGetColumnWordWrapping=rtl.createCallback(this,"DoGetColumnWordWrapping"),this.FTreeView.FOnGetColumnHorizontalTextAlign=rtl.createCallback(this,"DoGetColumnHorizontalTextAlign"),this.FTreeView.FOnGetColumnVerticalTextAlign=rtl.createCallback(this,"DoGetColumnVerticalTextAlign"),this.FTreeView.FOnGetColumnTrimming=rtl.createCallback(this,"DoGetColumnTrimming"),this.FTreeView.FOnGetNumberOfNodes=rtl.createCallback(this,"DoGetNumberOfNodes"),this.FTreeView.FOnIsNodeChecked=rtl.createCallback(this,"DoIsNodeChecked"),this.FTreeView.FOnGetNodeCheckType=rtl.createCallback(this,"DoGetNodeCheckType"),this.FTreeView.FOnAfterUnCheckNode=rtl.createCallback(this,"DoAfterUnCheckNode"),this.FTreeView.FOnAfterCheckNode=rtl.createCallback(this,"DoAfterCheckNode"),this.FTreeView.FOnGetNodeHeight=rtl.createCallback(this,"DoGetNodeHeight"),this.FTreeView.FOnGetNodeIcon=rtl.createCallback(this,"DoGetNodeIcon"),this.FTreeView.FOnGetNodeTrimming=rtl.createCallback(this,"DoGetNodeTrimming"),this.FTreeView.FOnGetNodeWordWrapping=rtl.createCallback(this,"DoGetNodeWordWrapping"),this.FTreeView.FOnGetNodeTitleTrimming=rtl.createCallback(this,"DoGetNodeTitleTrimming"),this.FTreeView.FOnGetNodeTitleWordWrapping=rtl.createCallback(this,"DoGetNodeTitleWordWrapping"),this.FTreeView.FOnDrawNodeExtra=rtl.createCallback(this,"DoDrawNodeExtra"),this.FTreeView.FOnGetNodeExtraSize=rtl.createCallback(this,"DoGetNodeExtraSize"),this.FTreeView.FOnGetNodeTextColor=rtl.createCallback(this,"DoGetNodeTextColor"),this.FTreeView.FOnGetNodeTitleColor=rtl.createCallback(this,"DoGetNodeTitleColor"),this.FTreeView.FOnIsNodeExtended=rtl.createCallback(this,"DoIsNodeExtended"),this.FTreeView.FOnGetNodeSelectedTextColor=rtl.createCallback(this,"DoGetNodeSelectedTextColor"),this.FTreeView.FOnGetNodeDisabledTextColor=rtl.createCallback(this,"DoGetNodeDisabledTextColor"),this.FTreeView.FOnGetNodeSelectedTitleColor=rtl.createCallback(this,"DoGetNodeSelectedTitleColor"),this.FTreeView.FOnGetNodeDisabledTitleColor=rtl.createCallback(this,"DoGetNodeDisabledTitleColor"),this.FTreeView.FOnGetNodeText=rtl.createCallback(this,"DoGetNodeText"),this.FTreeView.FOnGetNodeTitle=rtl.createCallback(this,"DoGetNodeTitle"),this.FTreeView.FOnGetNodeExpanded=rtl.createCallback(this,"DoGetNodeTitleExpanded"),this.FTreeView.FOnGetNodeHorizontalTextAlign=rtl.createCallback(this,"DoGetNodeHorizontalTextAlign"),this.FTreeView.FOnGetNodeVerticalTextAlign=rtl.createCallback(this,"DoGetNodeVerticalTextAlign"),this.FTreeView.FOnGetNodeTitleHorizontalTextAlign=rtl.createCallback(this,"DoGetNodeTitleHorizontalTextAlign"),this.FTreeView.FOnGetNodeTitleVerticalTextAlign=rtl.createCallback(this,"DoGetNodeTitleVerticalTextAlign"),this.FTreeView.FOnIsNodeEnabled=rtl.createCallback(this,"DoIsNodeEnabled"),this.FTreeView.FOnAfterSelectNode=rtl.createCallback(this,"DoAfterSelectNode"),this.FTreeView.FOnAfterUnSelectNode=rtl.createCallback(this,"DoAfterUnSelectNode"),this.FTreeView.FOnNeedFilterDropDownData=rtl.createCallback(this,"DoNeedFilterDropDownData"),this.FTreeView.FOnFilterSelect=rtl.createCallback(this,"DoFilterSelect"),this.FTreeView.FOnBeforeDrawNode=rtl.createCallback(this,"DoBeforeDrawNode"),this.FTreeView.FOnAfterDrawNode=rtl.createCallback(this,"DoAfterDrawNode"),this.FTreeView.FOnAfterDrawNodeIcon=rtl.createCallback(this,"DoAfterDrawNodeIcon"),this.FTreeView.FOnBeforeDrawNodeIcon=rtl.createCallback(this,"DoBeforeDrawNodeIcon"),this.FTreeView.FOnAfterDrawNodeCheck=rtl.createCallback(this,"DoAfterDrawNodeCheck"),this.FTreeView.FOnBeforeDrawNodeCheck=rtl.createCallback(this,"DoBeforeDrawNodeCheck"),this.FTreeView.FOnBeforeDrawNodeText=rtl.createCallback(this,"DoBeforeDrawNodeText"),this.FTreeView.FOnAfterDrawNodeText=rtl.createCallback(this,"DoAfterDrawNodeText"),this.FTreeView.FOnBeforeDrawNodeTitle=rtl.createCallback(this,"DoBeforeDrawNodeTitle"),this.FTreeView.FOnAfterDrawNodeTitle=rtl.createCallback(this,"DoAfterDrawNodeTitle"),this.FTreeView.FOnNodeAnchorClick=rtl.createCallback(this,"DoNodeAnchorClick"),this.FTreeView.FOnNodeTitleAnchorClick=rtl.createCallback(this,"DoNodeTitleAnchorClick"),this.FTreeView.FOnBeforeDrawSortIndicator=rtl.createCallback(this,"DoBeforeDrawSortIndicator"),this.FTreeView.FOnAfterDrawSortIndicator=rtl.createCallback(this,"DoAfterDrawSortIndicator"),this.FTreeView.FOnNodeClick=rtl.createCallback(this,"DoNodeClick"),this.FTreeView.FOnNodeMouseLeave=rtl.createCallback(this,"DoNodeMouseLeave"),this.FTreeView.FOnNodeMouseEnter=rtl.createCallback(this,"DoNodeMouseEnter"),this.FTreeView.FOnNodeDblClick=rtl.createCallback(this,"DoNodeDblClick"),this.FTreeView.FOnVScroll=rtl.createCallback(this,"DoVScroll"),this.FTreeView.FOnBeforeCutToClipboard=rtl.createCallback(this,"DoBeforeCutToClipboard"),this.FTreeView.FOnBeforeCopyToClipboard=rtl.createCallback(this,"DoBeforeCopyToClipboard"),this.FTreeView.FOnBeforePasteFromClipboard=rtl.createCallback(this,"DoBeforePasteFromClipboard"),this.FTreeView.FOnAfterCutToClipboard=rtl.createCallback(this,"DoAfterCutToClipboard"),this.FTreeView.FOnAfterCopyToClipboard=rtl.createCallback(this,"DoAfterCopyToClipboard"),this.FTreeView.FOnAfterPasteFromClipboard=rtl.createCallback(this,"DoAfterPasteFromClipboard"),this.FTreeView.FOnHeaderAnchorClick=rtl.createCallback(this,"DoHeaderAnchorClick"),this.FTreeView.FOnFooterAnchorClick=rtl.createCallback(this,"DoFooterAnchorClick"),this.FTreeView.FOnCustomReorder=rtl.createCallback(this,"DoCustomReorder"),this.FTreeView.FOnCustomDragOver=rtl.createCallback(this,"DoCustomDragOver"),this.FTreeView.FOnCustomDragDrop=rtl.createCallback(this,"DoCustomDragDrop"),this.FTreeView.FOnCustomCopyToClipboard=rtl.createCallback(this,"DoCopyToClipboard"),this.FTreeView.FOnCustomCutToClipboard=rtl.createCallback(this,"DoCutToClipboard"),this.FTreeView.FOnCustomPasteFromClipboard=rtl.createCallback(this,"DoPasteFromClipboard"),this.FTreeView.FOnCustomColumnSort=rtl.createCallback(this,"DoColumnSort"),this.FTreeView.FOnCustomLookup=rtl.createCallback(this,"DoLookup"),this.CustomizeTreeView(this.FTreeView),this.SetWidth(250),this.SetHeight(350),this.IsDesignTime()&&(this.GetStroke().SetColor(pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(200,199,204)),this.InitSample()),this},this.Destroy=function(){rtl.free(this,"FGlobalFont"),rtl.free(this,"FEditButton"),rtl.free(this,"FFilterButton"),rtl.free(this,"FEdit"),rtl.free(this,"FBackButton"),rtl.free(this,"FDoneButton"),rtl.free(this,"FDetailControlTimer"),rtl.free(this,"FMoreOptions"),rtl.free(this,"FCategories"),rtl.free(this,"FReload"),rtl.free(this,"FLookupBar"),rtl.free(this,"FCustomChar"),rtl.free(this,"FDisplayList"),rtl.free(this,"FCategoryList"),rtl.free(this,"FLookupBarDisplayList"),rtl.free(this,"FFilter"),rtl.free(this,"FCopyItems"),rtl.free(this,"FHeader"),rtl.free(this,"FFooter"),rtl.free(this,"FDefaultItem"),rtl.free(this,"FInteraction"),rtl.free(this,"FItems"),rtl.free(this,"FTreeView"),rtl.free(this,"FItemAppearance"),rtl.free(this,"FCategoryAppearance"),rtl.free(this,"FMoreOptionAppearance"),pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Destroy.call(this)},this.Draw=function(t,e){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Draw.apply(this,arguments),this.FFirstLoad||(this.FFirstLoad=!0,this.UpdateControlAfterResize())},this.Assign=function(e){t.TTMSFNCCustomTableView.isPrototypeOf(e)&&(this.FTreeView.Assign(rtl.as(e,t.TTMSFNCCustomTableView).FTreeView),this.FItems.Assign(rtl.as(e,t.TTMSFNCCustomTableView).FItems),this.FItemAppearance.Assign(rtl.as(e,t.TTMSFNCCustomTableView).FItemAppearance),this.FCategoryAppearance.Assign(rtl.as(e,t.TTMSFNCCustomTableView).FCategoryAppearance),this.FCategoryType=rtl.as(e,t.TTMSFNCCustomTableView).FCategoryType,this.FFilter.Assign(rtl.as(e,t.TTMSFNCCustomTableView).FFilter),this.FHeader.Assign(rtl.as(e,t.TTMSFNCCustomTableView).FHeader),this.FFooter.Assign(rtl.as(e,t.TTMSFNCCustomTableView).FFooter),this.FDefaultItem.Assign(rtl.as(e,t.TTMSFNCCustomTableView).FDefaultItem),this.FInteraction.Assign(rtl.as(e,t.TTMSFNCCustomTableView).FInteraction),this.FReload.Assign(rtl.as(e,t.TTMSFNCCustomTableView).FReload),this.FLookupBar.Assign(rtl.as(e,t.TTMSFNCCustomTableView).FLookupBar))},this.AddItem=function(t){var e=null;return(e=this.FItems.Add$1()).SetText(t),e},this.XYToAccessoryItem=function(t,e){var i=null,s=null,o=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),n=null,r=0;return i=null,null!=this.FTreeView&&null!=(s=this.FTreeView.XYToNode(t,e,0))&&s.FRow>=0&&s.FRow<=this.FItems.GetCount()-1&&null!=(n=this.GetItemForNode(s))&&n.FAccessory in this.FInteraction.FAccessoryClickDetection&&(o.$assign(s.FExtraRects[0]),pas["WEBLib.TMSFNCTypes"].InflateRectEx(o,0,-4),r=n.FAccessoryHeight,o.$assign(pas["WEBLib.TMSFNCTypes"].RectF(o.Left,o.Top+(o.Bottom-o.Top-r)/2,o.Right,o.Top+(o.Bottom-o.Top-r)/2+r)),pas["WEBLib.TMSFNCTypes"].PtInRectEx(o,pas["WEBLib.TMSFNCTypes"].PointF(t,e))&&(i=n)),i},this.XYToItem=function(t,e){var i=null,s=null;return i=null,null!=this.FTreeView&&null!=(s=this.FTreeView.XYToNode(t,e,0))&&s.FRow>=0&&s.FRow<=this.FDisplayList.GetCount()-1&&(i=this.GetItemForNode(s)),i},this.XYToMoreOption=function(t,e){var i,s=null,o=0,n=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),r=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),a=0,l=null;if(s=null,null==this.FTreeView)return s;if(null==(i=this.FTreeView.XYToNode(t,e,this.FTreeView.FMoreOffset))||this.GetItemForNode(i)!==this.FTreeView.FMoreOffsetItem)return s;if(this.FMoreOptions.GetCount()>0){r.$assign(i.FExtraRects[0]),o=this.FTreeView.FMoreOffset/this.FMoreOptions.GetCount();for(var h=0,F=this.FMoreOptions.GetCount()-1;h<=F;h++)if(a=h,l=this.FMoreOptions.GetItem$1(a),n.$assign(pas["WEBLib.TMSFNCTypes"].RectF(r.Right+o*a,r.Top,r.Right+o*(a+1),r.Bottom)),pas["WEBLib.TMSFNCTypes"].PtInRectEx(n,pas["WEBLib.TMSFNCTypes"].PointF(t,e))){s=l;break}}return s},this.SelectedItemCount=function(){var t=0;return t=0,null!=this.FTreeView&&(t=this.FTreeView.SelectedVirtualNodeCount()),t},this.LookupItem=function(t,e,i){var s=null,o="",n=null,r=0,a="";s=null,o=t,e||(o=pas.SysUtils.UpperCase(o));for(var l=0,h=this.FItems.GetCount()-1;l<=h;l++)if(r=l,a=(n=this.FItems.GetItem$1(r)).GetStrippedHTMLText(),e||(a=pas.SysUtils.UpperCase(a)),1===pas.System.Pos(o,a)){s=n;break}return null!=s&&this.IsItemSelectable(s)&&i&&(this.SelectItem(s.GetIndex()),this.ScrollToItem(s.GetIndex())),s},this.IsItemSelectable=function(t){var e=!1;return e=!0,null!=t&&(e=t.FEnabled,this.FTreeView.FVisibleNodes.IndexOf(this.GetNodeForItemIndex(t.GetIndex()))>-1||(e=!1)),e},this.GetSelectedItems=function(){var e=[],i=0,s=null;e=[];for(var o=0,n=this.SelectedItemCount()-1;o<=n;o++)i=o,s=rtl.as(this.GetSelItem(i),t.TTMSFNCTableViewItem),(e=rtl.arraySetLength(e,null,rtl.length(e)+1))[rtl.length(e)-1]=s;return e},this.LookupCustomCategory=function(t){this.FLookupBar.FAutoLookup?this.ScrollToCategoryId(t):null!=this.FOnManualLookupCategory&&this.FOnManualLookupCategory(this,"",t)},this.LookupCategory=function(t){this.FLookupBar.FAutoLookup?this.ScrollToCategoryCharacter(t):null!=this.FOnManualLookupCategory&&this.FOnManualLookupCategory(this,t,-1)},this.RemoveItem=function(t){null!=t&&this.FItems.Delete(t.GetIndex())},this.BeginUpdate=function(){var t=[],e=0;if(pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBase.BeginUpdate.call(this),this.FUpdateCount$1+=1,null!=this.FTreeView){null!=this.GetSelectedItem()?this.FSaveSelectedItem=this.GetSelectedItem().GetIndex():this.FSaveSelectedItem=-1,t=this.GetSelectedItems(),this.FSaveSelectedItems=rtl.arraySetLength(this.FSaveSelectedItems,0,rtl.length(t));for(var i=0,s=rtl.length(t)-1;i<=s;i++)null!=t[e=i]&&(this.FSaveSelectedItems[e]=t[e].GetIndex());this.FTreeView.BeginUpdate(),this.FTreeView.ClearNodeList()}},this.EndUpdate=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBase.EndUpdate.call(this),this.FUpdateCount$1-=1,0===this.FUpdateCount$1&&this.UpdateTableView(!1),null!=this.FTreeView&&this.FTreeView.EndUpdate(),this.SelectItem(this.FSaveSelectedItem),this.SelectItems(rtl.arrayRef(this.FSaveSelectedItems))},this.InitSample=function(){this.BeginUpdate(),this.FItems.Clear$1(),this.AddItem("Bugfix 376"),this.AddItem("Bugfix 378"),this.AddItem("Customer Update"),this.AddItem("Install New server"),this.AddItem("Meeting: Next Phase"),this.AddItem("Release Planning"),this.ResetToDefaultStyle(),this.FGlobalFont.SetName("Segoe UI"),this.EndUpdate()},this.ScrollToItem=function(t){var e=null;null!=this.FTreeView&&t>=0&&t<=this.FItems.GetCount()-1&&(e=this.FTreeView).ScrollToVirtualNode(e.GetNodeForRow(this.GetRowForItemIndex(t)),!0,0,!0)},this.UnCheckAllItems=function(){var t=0;this.BeginUpdate();for(var e=0,i=this.FItems.GetCount()-1;e<=i;e++)t=e,this.FItems.GetItem$1(t).SetChecked(!1);this.EndUpdate()},this.StartFiltering=function(){null!=this.FTreeView&&(this.FTreeView.FReloadActive||this.FFilterActive)||null==this.FTreeView||(this.FFilterActive=!0,this.RemoveFilters(),this.UpdateTableView(!1),this.FEdit.SetT(""),this.FEdit.SetFocus())},this.StopFiltering=function(){null!=this.FTreeView&&this.FTreeView.FReloadActive||null==this.FTreeView||(this.FFilterActive=!1,this.RemoveFilters(),this.UpdateTableView(!1))},this.StartEditMode=function(){null!=this.FTreeView&&this.FTreeView.FReloadActive||null==this.FTreeView||(this.FEditMode=!0,this.UpdateTableView(!1),this.SelectAllCheckedItems())},this.StopEditMode=function(){null!=this.FTreeView&&this.FTreeView.FReloadActive||null==this.FTreeView||(this.FEditMode=!1,this.UpdateTableView(!1),this.UnSelectAllItems(),this.UnCheckAllItems())},this.ToggleEditMode=function(){this.FEditMode?this.StopEditMode():this.StartEditMode()},this.SelectItem=function(t){var e=null,i=0;null!=this.FTreeView&&-1!==t&&(i=Math.max(0,Math.min(t,this.FItems.GetCount()-1)))>=0&&i<=this.FItems.GetCount()-1&&(e=this.FTreeView).SelectVirtualNode(e.GetNodeForRow(this.GetRowForItemIndex(i)))},this.SelectItems=function(t){var e=null,i=0,s=[];if(null!=this.FTreeView){e=this.FTreeView,s=rtl.arraySetLength(s,null,rtl.length(t));for(var o=0,n=rtl.length(t)-1;o<=n;o++)s[i=o]=e.GetNodeForRow(this.GetRowForItemIndex(t[i]));e.SelectVirtualNodes(rtl.arrayRef(s))}},this.CutToClipboard=function(t){var e=0;this.BeginUpdate(),this.CopyToClipboard(t);for(var i=this.SelectedItemCount()-1;i>=0;i--)e=i,this.RemoveItem(this.GetSelItem(e));this.EndUpdate()},this.CopyToClipboard=function(e){var i="",s=0,o=null,n=null;n=pas["WEBLib.TMSFNCTreeViewData"].TTMSFNCTreeViewIntegerList.$create("Create$1");try{i="";for(var r=0,a=this.SelectedItemCount()-1;r<=a;r++)s=r,null!=(o=this.GetSelItem(s))&&-1===n.IndexOf(o.GetIndex())&&(i=i+o.SaveToString(e)+pas["WEBLib.TMSFNCCustomTreeView"].ENDOFLINE,n.Add(o.GetIndex()));""!==i&&pas["WEBLib.TMSFNCUtils"].TTMSFNCClipBoard.SetText(t.CLP_FMT+i)}finally{n=rtl.freeLoc(n)}},this.PasteFromClipboard=function(){var e="",i=null,s=0,o="";if(pas["WEBLib.TMSFNCUtils"].TTMSFNCClipBoard.HasFormat(0)&&(e=pas["WEBLib.TMSFNCUtils"].TTMSFNCClipBoard.GetText(),pas.System.Pos(t.CLP_FMT,e)>0)){i=pas.Classes.TStringList.$create("Create$1");try{e=pas.SysUtils.StringReplace(e,t.CLP_FMT,"",rtl.createSet(0)),i.SetTextStr(e);try{for(var n=0,r=i.GetCount()-1;n<=r;n++)s=n,o=i.Get(s),this.AddItem("").LoadFromString(o)}finally{}}finally{i=rtl.freeLoc(i)}}},this.ApplyFilter=function(){this.FFilterApplied=!0,this.UpdateTableView(!1)},this.RemoveFilters=function(){this.FFilterApplied=!1,this.FFilter.Clear(),this.UpdateTableView(!1)},this.ShowDetailControl=function(t){var e=!1,i=pas["WEBLib.TMSFNCTypes"].TRectF.$new();null!=this.FTreeView&&this.FTreeView.FReloadActive||null==this.FTreeView||(this.FTreeView.StopAnimationTimer(),this.HideDetailControl(),t>=0&&t<=this.FItems.GetCount()-1&&(this.FActiveDetailControl=this.FItems.GetItem$1(t).FDetailControl,this.FActiveDetailItem=this.FItems.GetItem$1(t)),null==this.FActiveDetailControl&&(this.FActiveDetailControl=this.FDefaultItem.FDetailControl),e=!0,this.DoBeforeItemShowDetailControl(this.FActiveDetailItem,this.FActiveDetailControl,{get:function(){return e},set:function(t){e=t}}),null!=this.FActiveDetailControl&&null!=this.FTreeView&&e?(this.FShowDetailControl=!1,this.FActiveDetailControl.SetParent(this),i.$assign(this.FTreeView.GetContentRect()),this.FDetailControlOffset=i.Right-i.Left,this.UpdateActiveDetailControl(),this.FActiveDetailControl.SetVisible(!0),this.FDetailControlTimer.SetEnabled(!0)):(this.FActiveDetailControl=null,this.FActiveDetailItem=null))},this.HideDetailControl=function(){var t=!1;null!=this.FTreeView&&this.FTreeView.FReloadActive||null==this.FTreeView||!this.FShowDetailControl||(this.FTreeView.StopAnimationTimer(),t=!0,this.DoBeforeItemHideDetailControl(this.FActiveDetailItem,this.FActiveDetailControl,{get:function(){return t},set:function(e){t=e}}),null!=this.FActiveDetailControl&&null!=this.FTreeView&&t&&(this.FShowDetailControl=!0,this.UpdateActiveDetailControl(),this.FDetailControlTimer.SetEnabled(!0)))},rtl.addIntf(this,pas["WEBLib.TMSFNCBitmapContainer"].ITMSFNCBitmapContainer),rtl.addIntf(this,pas["WEBLib.TMSFNCControlPicker"].ITMSFNCControlPickerFull),rtl.addIntf(this,pas["WEBLib.TMSFNCGraphicsTypes"].ITMSFNCAppearanceGlobalFont),rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas["WEBLib.TMSFNCTypes"].ITMSFNCProductInfo),rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TTMSFNCTableView",this.TTMSFNCCustomTableView,(function(){this.RegisterRuntimeClasses=function(){t.TTMSFNCCustomTableView.RegisterRuntimeClasses.call(this),pas.Classes.RegisterClasses([t.TTMSFNCTableView,t.TTMSFNCTableViewItem])},rtl.addIntf(this,pas["WEBLib.TMSFNCBitmapContainer"].ITMSFNCBitmapContainer),rtl.addIntf(this,pas["WEBLib.TMSFNCControlPicker"].ITMSFNCControlPickerFull),rtl.addIntf(this,pas["WEBLib.TMSFNCGraphicsTypes"].ITMSFNCAppearanceGlobalFont),rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas["WEBLib.TMSFNCTypes"].ITMSFNCProductInfo),rtl.addIntf(this,pas.System.IUnknown);var e=this.$rtti;e.addProperty("Fill",3,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"GetFill","SetFill$1"),e.addProperty("Stroke",3,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"GetStroke","SetStroke$1"),e.addProperty("BitmapContainer",3,pas["WEBLib.TMSFNCBitmapContainer"].$rtti.TTMSFNCBitmapContainer,"GetBitmapContainer","SetBitmapContainer"),e.addProperty("ItemAppearance",2,t.$rtti.TTMSFNCTableViewItemAppearance,"FItemAppearance","SetItemAppearance"),e.addProperty("DefaultItem",2,t.$rtti.TTMSFNCTableViewItem,"FDefaultItem","SetDefaultItem"),e.addProperty("Items",2,t.$rtti.TTMSFNCTableViewItems,"FItems","SetItems"),e.addProperty("Header",2,t.$rtti.TTMSFNCTableViewHeader,"FHeader","SetHeader"),e.addProperty("Footer",2,t.$rtti.TTMSFNCTableViewFooter,"FFooter","SetFooter"),e.addProperty("ItemIndex",3,rtl.longint,"GetItemIndex","SetItemIndex",{Default:-1}),e.addProperty("Interaction",2,t.$rtti.TTMSFNCTableViewInteraction,"FInteraction","SetInteraction"),e.addProperty("LookupBar",2,t.$rtti.TTMSFNCTableViewLookupBar,"FLookupBar","SetLookupBar"),e.addProperty("Reload",2,t.$rtti.TTMSFNCTableViewReload,"FReload","SetReload"),e.addProperty("Categories",2,t.$rtti.TTMSFNCTableViewCategories,"FCategories","SetCategories"),e.addProperty("MoreOptions",2,t.$rtti.TTMSFNCTableViewMoreOptions,"FMoreOptions","SetMoreOptions"),e.addProperty("MoreOptionAppearance",2,t.$rtti.TTMSFNCTableViewMoreOptionAppearance,"FMoreOptionAppearance","SetMoreOptionAppearance"),e.addProperty("CategoryAppearance",2,t.$rtti.TTMSFNCTableViewCategoryAppearance,"FCategoryAppearance","SetCategoryAppearance"),e.addProperty("CategoryType",2,t.$rtti.TTMSFNCTableViewCategoryType,"FCategoryType","SetCategoryType",{Default:t.TTMSFNCTableViewCategoryType.tvctNone}),e.addProperty("OnItemSelected",0,t.$rtti.TTMSFNCTableViewItemSelectedEvent,"FOnItemSelected","FOnItemSelected"),e.addProperty("OnItemUnSelected",0,t.$rtti.TTMSFNCTableViewItemUnSelectedEvent,"FOnItemUnSelected","FOnItemUnSelected"),e.addProperty("OnItemSelectionChanged",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnItemSelectionChanged","FOnItemSelectionChanged"),e.addProperty("Version",1,rtl.string,"GetVersion",""),e.addProperty("VerticalScrollBarVisible",3,rtl.boolean,"GetVerticalScrollBarVisible","SetVerticalScrollBarVisible",{Default:!1}),e.addProperty("GlobalFont",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCAppearanceGlobalFont,"FGlobalFont","SetGlobalFont"),e.addProperty("OnBeforeDrawItem",0,t.$rtti.TTMSFNCTableViewBeforeDrawItemEvent,"FOnBeforeDrawItem","FOnBeforeDrawItem"),e.addProperty("OnAfterDrawItem",0,t.$rtti.TTMSFNCTableViewAfterDrawItemEvent,"FOnAfterDrawItem","FOnAfterDrawItem"),e.addProperty("OnItemCompare",0,t.$rtti.TTMSFNCTableViewItemCompareEvent,"FOnItemCompare","FOnItemCompare"),e.addProperty("OnCategoryCompare",0,t.$rtti.TTMSFNCTableViewCategoryCompareEvent,"FOnCategoryCompare","FOnCategoryCompare"),e.addProperty("OnCategoryClick",0,t.$rtti.TTMSFNCTableViewLookupCategoryEvent,"FOnCategoryClick","FOnCategoryClick"),e.addProperty("OnManualLookupCategory",0,t.$rtti.TTMSFNCTableViewLookupCategoryEvent,"FOnManualLookupCategory","FOnManualLookupCategory"),e.addProperty("OnAfterDrawItemIcon",0,t.$rtti.TTMSFNCTableViewAfterDrawItemIconEvent,"FOnAfterDrawItemIcon","FOnAfterDrawItemIcon"),e.addProperty("OnBeforeDrawItemIcon",0,t.$rtti.TTMSFNCTableViewBeforeDrawItemIconEvent,"FOnBeforeDrawItemIcon","FOnBeforeDrawItemIcon"),e.addProperty("OnBeforeDrawItemText",0,t.$rtti.TTMSFNCTableViewBeforeDrawItemTextEvent,"FOnBeforeDrawItemText","FOnBeforeDrawItemText"),e.addProperty("OnAfterDrawItemText",0,t.$rtti.TTMSFNCTableViewAfterDrawItemTextEvent,"FOnAfterDrawItemText","FOnAfterDrawItemText"),e.addProperty("OnItemAnchorClick",0,t.$rtti.TTMSFNCTableViewItemAnchorClickEvent,"FOnItemAnchorClick","FOnItemAnchorClick"),e.addProperty("OnItemClick",0,t.$rtti.TTMSFNCTableViewItemClickEvent,"FOnItemClick","FOnItemClick"),e.addProperty("OnItemMouseLeave",0,t.$rtti.TTMSFNCTableViewItemMouseLeaveEvent,"FOnItemMouseLeave","FOnItemMouseLeave"),e.addProperty("OnItemMouseEnter",0,t.$rtti.TTMSFNCTableViewItemMouseEnterEvent,"FOnItemMouseEnter","FOnItemMouseEnter"),e.addProperty("OnItemDblClick",0,t.$rtti.TTMSFNCTableViewItemClickEvent,"FOnItemDblClick","FOnItemDblClick"),e.addProperty("OnVScroll",0,t.$rtti.TTMSFNCTableViewScrollEvent,"FOnVScroll","FOnVScroll"),e.addProperty("OnStartReload",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnStartReload","FOnStartReload"),e.addProperty("OnStopReload",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnStopReload","FOnStopReload"),e.addProperty("OnDrawItemCustomAccessory",0,t.$rtti.TTMSFNCTableViewDrawItemCustomAccessoryEvent,"FOnDrawItemCustomAccessory","FOnDrawItemCustomAccessory"),e.addProperty("OnItemAccessoryClick",0,t.$rtti.TTMSFNCTableViewItemClickEvent,"FOnItemAccessoryClick","FOnItemAccessoryClick"),e.addProperty("OnItemCheckChanged",0,t.$rtti.TTMSFNCTableViewItemCheckChangedEvent,"FOnItemCheckChanged","FOnItemCheckChanged"),e.addProperty("OnAfterDrawItemCheck",0,t.$rtti.TTMSFNCTableViewAfterDrawItemCheckEvent,"FOnAfterDrawItemCheck","FOnAfterDrawItemCheck"),e.addProperty("OnBeforeDrawItemCheck",0,t.$rtti.TTMSFNCTableViewBeforeDrawItemCheckEvent,"FOnBeforeDrawItemCheck","FOnBeforeDrawItemCheck"),e.addProperty("OnBeforeApplyFilter",0,t.$rtti.TTMSFNCTableViewBeforeApplyFilterEvent,"FOnBeforeApplyFilter","FOnBeforeApplyFilter"),e.addProperty("OnAfterApplyFilter",0,t.$rtti.TTMSFNCTableViewAfterApplyFilterEvent,"FOnAfterApplyFilter","FOnAfterApplyFilter"),e.addProperty("OnItemMoreOptionClick",0,t.$rtti.TTMSFNCTableViewItemMoreOptionClickEvent,"FOnItemMoreOptionClick","FOnItemMoreOptionClick"),e.addProperty("OnBeforeItemShowDetailControl",0,t.$rtti.TTMSFNCTableViewBeforeItemShowDetailControl,"FOnBeforeItemShowDetailControl","FOnBeforeItemShowDetailControl"),e.addProperty("OnBeforeItemHideDetailControl",0,t.$rtti.TTMSFNCTableViewBeforeItemHideDetailControl,"FOnBeforeItemHideDetailControl","FOnBeforeItemHideDetailControl"),e.addProperty("OnItemShowDetailControl",0,t.$rtti.TTMSFNCTableViewItemShowDetailControl,"FOnItemShowDetailControl","FOnItemShowDetailControl"),e.addProperty("OnItemHideDetailControl",0,t.$rtti.TTMSFNCTableViewItemHideDetailControl,"FOnItemHideDetailControl","FOnItemHideDetailControl"),e.addProperty("OnHeaderAnchorClick",0,t.$rtti.TTMSFNCTableViewAnchorHeaderFooterClick,"FOnHeaderAnchorClick","FOnHeaderAnchorClick"),e.addProperty("OnFooterAnchorClick",0,t.$rtti.TTMSFNCTableViewAnchorHeaderFooterClick,"FOnFooterAnchorClick","FOnFooterAnchorClick"),e.addProperty("OnGetHTMLTemplateValue",0,t.$rtti.TTMSFNCTableViewGetHTMLTemplateValueEvent,"FOnGetHTMLTemplateValue","FOnGetHTMLTemplateValue"),e.addProperty("OnGetHTMLTemplate",0,t.$rtti.TTMSFNCTableViewGetHTMLTemplateEvent,"FOnGetHTMLTemplate","FOnGetHTMLTemplate"),e.attr=[pas.Classes.ComponentPlatformsAttribute,"Create$1",[0]]})),this.TMSFNCTABLEVIEWSEARCH="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABXElEQVQ4jY2TP0/CUBTFf1VJGhmoEzCQIIkDG4y4gNGJ5cnoiKMTfACCpoubDk5OfAPoUpcm4sRYEkzcsEkHJNGIRgwJiwPUtKVFz3Tzzj3n3PdPYg3KDS0NlID0cqmrq6Lr7pFChArQBGoBtAVUHaMwAxPIReUIR/kUhWyS8fs3Rt9m8PzqtFV0VXRWDMoN7RxoZhIxLk/3icoRD2+YNldtE2AC7G76DfaKJ+2oHJFvzoorYoBMMoYEDKw3GRhv+NJLgFLIJgLFDg7zKacUG0ENcWU7VOznAw2+ZvO1BlMX7zFwrsYwbU+TH1pv6JQPQRNcT2dzbu8eA8XDlw86C4MJ0NoKCgBqhmkzHH0iChniO4s9955G7vS6rgrL8w7KDS0H3ANK6PyL5Lquiha4XqJPPAEOltSxS2wBHV0VE2dBChPrquivmeIXziG6x678V+w2uFgmV/3f9S/8AOOWdCNEGLMkAAAAAElFTkSuQmCC",t.$implcode=function(){rtl.createClass(e,"TTMSFNCTreeViewOpen",t.TTMSFNCTreeViewTableView,(function(){rtl.addIntf(this,pas["WEBLib.TMSFNCControlPicker"].ITMSFNCControlPickerFull),rtl.addIntf(this,pas["WEBLib.TMSFNCGraphicsTypes"].ITMSFNCAppearanceGlobalFont),rtl.addIntf(this,pas["WEBLib.TMSFNCBitmapContainer"].ITMSFNCBitmapContainer),rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas["WEBLib.TMSFNCTypes"].ITMSFNCProductInfo),rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(e,"TTMSFNCCustomTreeViewOpen",pas["WEBLib.TMSFNCCustomTreeView"].TTMSFNCCustomTreeView,(function(){rtl.addIntf(this,pas["WEBLib.TMSFNCGraphicsTypes"].ITMSFNCAppearanceGlobalFont),rtl.addIntf(this,pas["WEBLib.TMSFNCBitmapContainer"].ITMSFNCBitmapContainer),rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas["WEBLib.TMSFNCTypes"].ITMSFNCProductInfo),rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(e,"TTMSFNCCustomTableViewOpen",t.TTMSFNCCustomTableView,(function(){rtl.addIntf(this,pas["WEBLib.TMSFNCBitmapContainer"].ITMSFNCBitmapContainer),rtl.addIntf(this,pas["WEBLib.TMSFNCControlPicker"].ITMSFNCControlPickerFull),rtl.addIntf(this,pas["WEBLib.TMSFNCGraphicsTypes"].ITMSFNCAppearanceGlobalFont),rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas["WEBLib.TMSFNCTypes"].ITMSFNCProductInfo),rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(e,"TTMSFNCTreeViewColumnOpen",pas["WEBLib.TMSFNCTreeViewData"].TTMSFNCTreeViewColumn,(function(){})),e.AnimateDouble=function(t,e,i,s){var o=!1;return o=!0,t.get()>e.get()-s&&t.get()<e.get()+s?(t.set(e.get()),o=!1):(i=Math.max(s,i),t.get()<e.get()?t.set(t.get()+i):t.set(t.get()-i)),o}}}),["Math","WEBLib.TMSFNCUtils","SysUtils","WEBLib.Graphics","WEBLib.TMSFNCCustomSelector"]),rtl.module("WEBLib.TMSFNCComboBox",["System","Classes","Types","WEBLib.Controls","WEBLib.TMSFNCCustomPicker","WEBLib.TMSFNCCustomSelector","WEBLib.TMSFNCGraphics","WEBLib.TMSFNCTreeView","WEBLib.TMSFNCTreeViewData","WEBLib.TMSFNCGraphicsTypes","WEBLib.TMSFNCTypes","WEBLib.TMSFNCBitmapContainer","WEBLib.TMSFNCCustomTreeView"],(function(){"use strict";var t=this,e=t.$impl;rtl.createClass(this,"TTMSFNCTreeViewOpen",pas["WEBLib.TMSFNCTreeView"].TTMSFNCTreeView,(function(){rtl.addIntf(this,pas["WEBLib.TMSFNCControlPicker"].ITMSFNCControlPickerFull),rtl.addIntf(this,pas["WEBLib.TMSFNCGraphicsTypes"].ITMSFNCAppearanceGlobalFont),rtl.addIntf(this,pas["WEBLib.TMSFNCBitmapContainer"].ITMSFNCBitmapContainer),rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas["WEBLib.TMSFNCTypes"].ITMSFNCProductInfo),rtl.addIntf(this,pas.System.IUnknown)})),this.TTMSFNCCustomComboBoxStyle={0:"csDropDown",csDropDown:0,1:"csDropDownList",csDropDownList:1},this.$rtti.$Enum("TTMSFNCCustomComboBoxStyle",{minvalue:0,maxvalue:1,ordtype:1,enumtype:this.TTMSFNCCustomComboBoxStyle}),this.$rtti.$MethodVar("TTMSFNCCustomComboBoxItemSelectedEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AText",rtl.string],["AItemIndex",rtl.longint]]),methodkind:0}),rtl.createClass(this,"TTMSFNCCustomComboBox",pas["WEBLib.TMSFNCCustomPicker"].TTMSFNCDefaultPicker,(function(){this.$init=function(){pas["WEBLib.TMSFNCCustomPicker"].TTMSFNCDefaultPicker.$init.call(this),this.FWrapper=null,this.FTreeView=null,this.FItems=null,this.FStyle=0,this.FAutoCloseUp=!1,this.FAutoDropDown=!1,this.FAutoComplete=!1,this.FDropDownCount=0,this.FPrevString="",this.FCaseSensitive=!1,this.FAutoCompleteNumChar=0,this.FAutoCompleteDelay=0,this.FTick=0,this.FKeyDown$1=0,this.FOnItemSelected$1=null,this.FFont$2=null,this.FBitmapContainer=null,this.FAutoFilter=!1},this.$final=function(){this.FWrapper=void 0,this.FTreeView=void 0,this.FItems=void 0,this.FOnItemSelected$1=void 0,this.FFont$2=void 0,this.FBitmapContainer=void 0,pas["WEBLib.TMSFNCCustomPicker"].TTMSFNCDefaultPicker.$final.call(this)},this.SetItemIndex=function(t){var e=null;null!=this.FTreeView&&(e=this.FTreeView,t>=0&&t<=this.FItems.GetCount()-1?(e.SelectVirtualNode(e.GetNodeForRow(t)),null!=e.GetFocusedNode()?this.SetText(e.GetFocusedNode().GetText(0)):this.SetText("")):(e.SelectVirtualNode(null),this.SetText("")))},this.SetItems$1=function(t){this.FItems.Assign(t)},this.SetStyle=function(t){if(this.FStyle!==t){this.FStyle=t;var e=this.FStyle;0===e?(this.SetEditable(!0),this.GetPopup().FFocusedControl=this.FEdit,this.GetPopup().FStaysOpen=!0):1===e&&(this.SetEditable(!1),this.GetPopup().FFocusedControl=this.FTreeView,this.GetPopup().FStaysOpen=!1)}},this.SetAutoCloseUp=function(t){this.FAutoCloseUp=t},this.SetAutoDropDown=function(t){this.FAutoDropDown=t},this.SetAutoComplete=function(t){this.FAutoComplete=t},this.SetDropDownCount=function(t){this.FDropDownCount!==t&&(this.FDropDownCount=t,this.AdjustDropDownHeight())},this.SetItemHeight=function(t){null!=this.FTreeView&&(this.FTreeView.FNodesAppearance.SetFixedHeight(t),this.AdjustDropDownHeight())},this.SetText=function(t){this.SetContent(t)},this.SetCaseSensitive=function(t){this.FCaseSensitive=t},this.SetAutoCompleteNumChar=function(t){this.FAutoCompleteNumChar=t>0?t:1},this.SetAutoCompleteDelay=function(t){this.FAutoCompleteDelay=t},this.GetItemIndex=function(){var t=0;return t=-1,null!=this.FTreeView&&this.FTreeView.SelectedVirtualNodeCount()>0&&null!=this.FTreeView.GetSelVirtualNode(0)&&(t=this.FTreeView.GetSelVirtualNode(0).FRow),t},this.GetItemHeight=function(){var t=0;return t=0,null!=this.FTreeView&&(t=this.FTreeView.FNodesAppearance.FFixedHeight),t},this.GetText=function(){return this.GetContent()},this.SetFnt$1=function(t){this.FFont$2.AssignSource(t),this.FEdit.FFont.Assign(t)},this.GetBitmapContainer=function(){return this.FBitmapContainer},this.SetBitmapContainer=function(t){this.FBitmapContainer=t,null!=this.FTreeView&&this.FTreeView.SetBitmapContainer(t),this.Invalidate()},this.SetAutoFilter=function(t){this.FAutoFilter=t},this.GetItemAppearance=function(){return this.FTreeView.FNodesAppearance},this.SetItemAppearance=function(t){this.FTreeView.FNodesAppearance.Assign(t)},this.Notification=function(t,e){pas["WEBLib.Menus"].TWebCustomControl.Notification.apply(this,arguments),1===e&&t===this.FBitmapContainer&&(this.FBitmapContainer=null,null!=this.FTreeView&&this.FTreeView.SetBitmapContainer(null))},this.FontChange=function(t){this.Invalidate(),this.FEdit.FFont.Assign(this.FFont$2)},this.Loaded=function(){pas["WEBLib.Controls"].TCustomControl.Loaded.call(this),this.AdjustDropDownHeight()},this.DoComboBoxItemSelected=function(t,e){null!=this.FOnItemSelected$1&&this.FOnItemSelected$1(this,t,e)},this.DrawContent=function(t,e){var i=pas["WEBLib.TMSFNCTypes"].TRectF.$new();pas["WEBLib.TMSFNCCustomPicker"].TTMSFNCCustomPicker.DrawContent.apply(this,arguments),this.FEditable&&!this.IsExporting()||(this.FEnabled?t.FFont.AssignSource(this.FFont$2):t.FFont.SetColor(12632256),i.$assign(e),pas["WEBLib.TMSFNCTypes"].InflateRectEx(i,-3,-3),t.DrawText$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),this.GetContent(),!1,1,0,0,0,-1,-1,!0,!1,-1,-1))},this.InitializePopup=function(){pas["WEBLib.TMSFNCCustomPicker"].TTMSFNCCustomPicker.InitializePopup.call(this),null!=this.FTreeView&&(this.FTreeView.FFill.Assign(this.GetFill()),this.FTreeView.FStroke.Assign(this.GetStroke()),this.FTreeView.SetHeight(Math.round(this.FDropDownHeight)),this.FTreeView.SetVerticalScrollBarVisible(this.FItems.GetCount()>this.FDropDownCount),null!=this.FTreeView.GetNodeForRow(this.GetItemIndex())&&this.FTreeView.ScrollToVirtualNode(this.FTreeView.GetNodeForRow(this.GetItemIndex()),!1,0,!1))},this.SelectFirstValue=function(){var t=null;pas["WEBLib.TMSFNCCustomPicker"].TTMSFNCCustomPicker.SelectFirstValue.call(this),null!=this.FTreeView&&null!=(t=this.FTreeView.GetFirstVisibleVirtualNode())&&null!=t.FNode&&(this.FTreeView.SelectNode(t.FNode),this.SetContent(t.FNode.GetText(0)),this.DoComboBoxItemSelected(t.FNode.GetText(0),t.FNode.GetIndex()),this.Invalidate())},this.SelectLastValue=function(){var t=null;pas["WEBLib.TMSFNCCustomPicker"].TTMSFNCCustomPicker.SelectLastValue.call(this),null!=this.FTreeView&&null!=(t=this.FTreeView.GetLastVisibleVirtualNode())&&null!=t.FNode&&(this.FTreeView.SelectNode(t.FNode),this.SetContent(t.FNode.GetText(0)),this.DoComboBoxItemSelected(t.FNode.GetText(0),t.FNode.GetIndex()),this.Invalidate())},this.SelectNextValue=function(){var t=null;pas["WEBLib.TMSFNCCustomPicker"].TTMSFNCCustomPicker.SelectNextValue.call(this),null!=this.FTreeView&&null!=(t=this.FTreeView.GetNextFocusableNode(this.FTreeView.GetFocusedVirtualNode()))&&null!=t.FNode&&(this.FTreeView.SelectNode(t.FNode),this.SetContent(t.FNode.GetText(0)),this.DoComboBoxItemSelected(t.FNode.GetText(0),t.FNode.GetIndex()),this.Invalidate())},this.SelectPreviousValue=function(){var t=null;pas["WEBLib.TMSFNCCustomPicker"].TTMSFNCCustomPicker.SelectPreviousValue.call(this),null!=this.FTreeView&&null!=(t=this.FTreeView.GetPreviousFocusableNode(this.FTreeView.GetFocusedVirtualNode()))&&null!=t.FNode&&(this.FTreeView.SelectNode(t.FNode),this.SetContent(t.FNode.GetText(0)),this.DoComboBoxItemSelected(t.FNode.GetText(0),t.FNode.GetIndex()),this.Invalidate())},this.ItemsChanged=function(t){var e=0;if(null!=this.FTreeView){this.FTreeView.BeginUpdate(),this.FTreeView.ClearNodes();for(var i=0,s=this.FItems.GetCount()-1;i<=s;i++)e=i,this.FTreeView.FNodes.Add$1().SetText(0,this.FItems.Get(e));this.FTreeView.EndUpdate(),this.AdjustDropDownHeight()}},this.SetAdaptToStyle=function(t){pas["WEBLib.TMSFNCCustomPicker"].TTMSFNCCustomPicker.SetAdaptToStyle.apply(this,arguments),null!=this.FWrapper&&this.FWrapper.SetAdaptToStyle(this.GetAdaptToStyle()),null!=this.FTreeView&&this.FTreeView.SetAdaptToStyle(this.GetAdaptToStyle())},this.ComboBoxNodeTextAlign=function(t,e,i,s){s.set(1)},this.ComboBoxItemClicked=function(t,e){var i=null;null!=e&&null!=e.FNode&&(this.SetContent(e.FNode.GetText(0)),this.DoComboBoxItemSelected(e.FNode.GetText(0),e.FNode.GetIndex()),i=e.FNode,this.FTreeView.RemoveFilters(),this.FTreeView.SelectNode(i)),this.DropDown(),this.Invalidate()},this.AdjustDropDownHeight=function(){var t=0,e=0;null!=this.FTreeView&&(e=this.GetVisibleItemCount(),t=Math.min(this.FDropDownCount,e)*this.FTreeView.FNodesAppearance.FFixedHeight+1,this.SetDropDownHeight(t))},this.UpdateListBoxLookup=function(t){var e,i=null;this.FAutoFilter&&(this.FTreeView.FFilter.Clear(),(i=this.FTreeView.FFilter.Add$1()).FCondition=t+"*",i.FCaseSensitive=this.FCaseSensitive,this.FTreeView.ApplyFilter()),e=this.GetVisibleItemCount(),this.FAutoDropDown&&t.length>=this.FAutoCompleteNumChar&&!this.GetPopup().FIsOpen&&e>0&&this.DropDown()},this.DeleteFromEdit=function(){this.FPrevString=this.FEdit.GetText(),0===this.FEdit.GetSelLength()?pas.System.Delete({p:this,get:function(){return this.p.FPrevString},set:function(t){this.p.FPrevString=t}},this.FEdit.GetSelStart(),1):pas.System.Delete({p:this,get:function(){return this.p.FPrevString},set:function(t){this.p.FPrevString=t}},Math.max(1,this.FEdit.GetSelStart()+1),this.FEdit.GetSelLength()),this.UpdateListBoxLookup(this.FPrevString),this.FPrevString.length<this.FAutoCompleteNumChar&&this.GetPopup().FIsOpen&&(this.DropDown(),this.FTreeView.RemoveFilters())},this.EditKeyDown$1=function(t,e,i){if(this.FKeyDown$1=e.get(),115!==this.FKeyDown$1){if(1 in i){var s=this.FKeyDown$1;if(40===s||38===s)return void this.DropDown()}rtl.neSet(i,rtl.createSet(1))&&this.FKeyDown$1 in rtl.createSet(38,40)&&(38===this.FKeyDown$1&&this.SelectPreviousValue(),40===this.FKeyDown$1&&this.SelectNextValue(),e.set(0)),8===this.FKeyDown$1&&this.DeleteFromEdit()}else this.DropDown()},this.EditKeyPress$1=function(t,e){var i,s=null,o=0,n=0;if(null!=this.FTreeView){if(i=e.get(),27===this.FKeyDown$1)return this.FAutoCloseUp&&this.GetPopup().FIsOpen,void this.DropDown();if(13===this.FKeyDown$1)return this.GetPopup().FIsOpen&&(this.FEdit.SetSelStart(this.FEdit.GetText().length),this.FEdit.SetSelLength(0),this.FTreeView.RemoveFilters()),void this.DropDown();if(this.FAutoComplete){if("\0"===i)return;if(this.FEdit.GetSelLength()===this.FEdit.GetText().length&&(this.FPrevString=""),this.FPrevString=this.FPrevString+i,this.FPrevString.length<this.FAutoCompleteNumChar)return;this.UpdateListBoxLookup(this.FPrevString),null!=(s=this.FTreeView.LookupNode(this.FPrevString,!1,-1,this.FCaseSensitive,!1,!1))&&null!=s.FNode&&(this.FTreeView.SelectNode(s.FNode),o=this.FPrevString.length,this.SetContent(s.FNode.GetText(0)),this.FEdit.SetSelStart(o),n=this.FEdit.GetText().length-o,this.FEdit.SetSelLength(n),e.set("\0"),this.FAutoCloseUp&&0===n&&this.GetPopup().FIsOpen&&(this.DoComboBoxItemSelected(s.FNode.GetText(0),s.FNode.GetIndex()),this.DropDown()))}}},this.KeyPress=function(t){var i=null,s="",o=0;if(pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBase.KeyPress.apply(this,arguments),null!=this.FTreeView){if(s=t.get(),27===this.FKeyDown$1)return this.GetPopup().FIsOpen,void this.DropDown();if(this.FAutoComplete){if(8===this.FKeyDown$1)return pas.System.Delete({p:this,get:function(){return this.p.FPrevString},set:function(t){this.p.FPrevString=t}},this.FPrevString.length,1),void(1===this.FPrevString.length&&this.GetPopup().FIsOpen&&(this.DropDown(),this.FTreeView.RemoveFilters()));if("\0"===s)return;this.FAutoDropDown&&!this.GetPopup().FIsOpen&&this.DropDown(),o=this.FAutoCompleteDelay,e.GetTickCountX()-this.FTick<o?this.FPrevString=this.FPrevString+s:(this.FTick=e.GetTickCountX(),this.FPrevString=s)}else{if("\0"===s)return;this.FPrevString=s}null!=(i=this.FTreeView.LookupNode(this.FPrevString,!1,-1,this.FCaseSensitive,!1,!1))&&null!=i.FNode&&(this.FTreeView.SelectNode(i.FNode),this.SetContent(i.FNode.GetText(0)),this.DoComboBoxItemSelected(i.FNode.GetText(0),i.FNode.GetIndex()),this.Invalidate(),this.FAutoComplete&&this.GetContent()===this.FPrevString&&this.FAutoCloseUp&&this.GetPopup().FIsOpen&&this.DropDown())}},this.KeyDown=function(t,e){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBase.KeyDown.apply(this,arguments),this.FKeyDown$1=t.get()},this.TreeviewKeyUp=function(t,e,i){var s=null;if(this.FKeyDown$1=e.get(),13===this.FKeyDown$1)return s=this.FTreeView,this.SetContent(s.GetFocusedNode().GetText(0)),this.DropDown(),void this.Invalidate()},this.TreeViewMouseDown=function(t,e,i,s,o){this.FEditable&&(this.FPreventDropDown=!0)},this.TreeViewVScroll=function(t,e){},this.CreateSelector=function(){var t=null;return this.FWrapper=pas["WEBLib.TMSFNCCustomSelector"].TTMSFNCCustomSelector.$create("Create$1",[this]),this.FTreeView=pas["WEBLib.TMSFNCTreeView"].TTMSFNCTreeView.$create("Create$1",[this.FWrapper]),this.FTreeView.SetParent(this.FWrapper),this.FTreeView.SetControlAlignment(5),this.FTreeView.SetVerticalScrollBarVisible(!1),this.FTreeView.FOnMouseDown=rtl.createCallback(this,"TreeViewMouseDown"),this.FTreeView.FOnNodeClick=rtl.createCallback(this,"ComboBoxItemClicked"),this.FTreeView.FOnKeyUp=rtl.createCallback(this,"TreeviewKeyUp"),this.FTreeView.FOnGetNodeHorizontalTextAlign=rtl.createCallback(this,"ComboBoxNodeTextAlign"),this.FTreeView.FOnVScroll=rtl.createCallback(this,"TreeViewVScroll"),this.FTreeView.FNodesAppearance.SetFixedHeight(16),this.FTreeView.FColumns.Clear(),(t=this.FTreeView.FColumns.Add$1()).SetText("Header"),t.SetHorizontalTextAlign(0),this.FTreeView.ClearNodes(),this.FTreeView.FColumnsAppearance.SetLayouts({}),this.FTreeView.SetStretchScrollBars(!0),this.FTreeView.FNodesAppearance.SetExpandColumn(-1),this.FTreeView.FNodesAppearance.SetLevelIndent(0),this.FTreeView.FNodesAppearance.SetShowLines(!1),this.FTreeView.FNodesAppearance.SetExpandWidth(0),this.FTreeView.FNodesAppearance.SetExpandHeight(0),this.FTreeView.FNodesAppearance.SetSelectionArea(1),this.FTreeView.FNodesAppearance.SetShowFocus(!1),this.FWrapper},this.GetVisibleItemCount=function(){var t=0;return t=0,null!=this.FTreeView&&(t=this.FTreeView.FVisibleNodes.GetCount()),t},this.Create$1=function(t){return pas["WEBLib.TMSFNCCustomPicker"].TTMSFNCCustomPicker.Create$1.apply(this,arguments),this.SetWidth(150),this.SetDropDownWidth(this.GetWidth()),this.SetDropDownCount(8),this.FItems=pas.Classes.TStringList.$create("Create$1"),this.FItems.FOnChange=rtl.createCallback(this,"ItemsChanged"),this.SetEditable(!0),this.FPrevString="",this.FAutoFilter=!0,this.FAutoComplete=!0,this.FAutoCloseUp=!1,this.FAutoDropDown=!1,this.FCaseSensitive=!1,this.FAutoCompleteNumChar=2,this.FAutoCompleteDelay=500,this.FFont$2=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFont.$create("Create$2"),this.FFont$2.FOnChanged=rtl.createCallback(this,"FontChange"),this.FEdit.FOnKeyDown=rtl.createCallback(this,"EditKeyDown$1"),this.FEdit.FOnKeyPress=rtl.createCallback(this,"EditKeyPress$1"),this.GetPopup().FFocusedControl=this.FEdit,this.GetPopup().FStaysOpen=!0,this.IsDesignTime()&&this.SetText("TTMSFNCComboBox"),this},this.Destroy=function(){rtl.free(this,"FFont$2"),rtl.free(this,"FItems"),pas["WEBLib.TMSFNCCustomPicker"].TTMSFNCCustomPicker.Destroy.call(this)},this.AddItem=function(t){this.FItems.Add(t)},rtl.addIntf(this,pas["WEBLib.TMSFNCBitmapContainer"].ITMSFNCBitmapContainer),rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas["WEBLib.TMSFNCTypes"].ITMSFNCProductInfo),rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TTMSFNCComboBox",this.TTMSFNCCustomComboBox,(function(){this.RegisterRuntimeClasses=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.RegisterRuntimeClasses.call(this),pas.Classes.RegisterClass(t.TTMSFNCComboBox)},rtl.addIntf(this,pas["WEBLib.TMSFNCBitmapContainer"].ITMSFNCBitmapContainer),rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas["WEBLib.TMSFNCTypes"].ITMSFNCProductInfo),rtl.addIntf(this,pas.System.IUnknown);var e=this.$rtti;e.addProperty("AutoCloseUp",2,rtl.boolean,"FAutoCloseUp","SetAutoCloseUp",{Default:!1}),e.addProperty("AutoDropDown",2,rtl.boolean,"FAutoDropDown","SetAutoDropDown",{Default:!1}),e.addProperty("AutoComplete",2,rtl.boolean,"FAutoComplete","SetAutoComplete",{Default:!0}),e.addProperty("AutoCompleteDelay",2,rtl.longint,"FAutoCompleteDelay","SetAutoCompleteDelay",{Default:500}),e.addProperty("AutoCompleteNumChar",2,rtl.longint,"FAutoCompleteNumChar","SetAutoCompleteNumChar",{Default:2}),e.addProperty("AutoFilter",2,rtl.boolean,"FAutoFilter","SetAutoFilter",{Default:!0}),e.addProperty("BitmapContainer",3,pas["WEBLib.TMSFNCBitmapContainer"].$rtti.TTMSFNCBitmapContainer,"GetBitmapContainer","SetBitmapContainer"),e.addProperty("CaseSensitive",2,rtl.boolean,"FCaseSensitive","SetCaseSensitive",{Default:!1}),e.addProperty("DropDownCount",2,rtl.longint,"FDropDownCount","SetDropDownCount",{Default:8}),e.addProperty("DropDownWidth",14,rtl.double,"FDropDownWidth","SetDropDownWidth",{stored:"IsDropDownWidthStored"}),e.addProperty("Font",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFont,"FFont$2","SetFnt$1"),e.addProperty("Items",2,pas.Classes.$rtti.TStringList,"FItems","SetItems$1"),e.addProperty("ItemIndex",3,rtl.longint,"GetItemIndex","SetItemIndex",{Default:-1}),e.addProperty("ItemHeight",3,rtl.double,"GetItemHeight","SetItemHeight"),e.addProperty("ShowFocus",2,rtl.boolean,"FShowFocus$1","SetShowFocus$1",{Default:!0}),e.addProperty("Style",2,t.$rtti.TTMSFNCCustomComboBoxStyle,"FStyle","SetStyle",{Default:t.TTMSFNCCustomComboBoxStyle.csDropDown}),e.addProperty("Text",3,rtl.string,"GetText","SetText"),e.addProperty("ItemAppearance",3,pas["WEBLib.TMSFNCCustomTreeView"].$rtti.TTMSFNCTreeViewNodesAppearance,"GetItemAppearance","SetItemAppearance"),e.addProperty("Appearance",3,pas["WEBLib.TMSFNCCustomSelector"].$rtti.TTMSFNCCustomSelectorAppearance,"GetAppearance","SetAppearance"),e.addProperty("OnItemSelected",0,t.$rtti.TTMSFNCCustomComboBoxItemSelectedEvent,"FOnItemSelected$1","FOnItemSelected$1"),e.attr=[pas.Classes.ComponentPlatformsAttribute,"Create$1",[0]]})),t.$implcode=function(){e.GetTickCountX=function(){var t=0,e=0,i=0,s=0;return pas.SysUtils.DecodeTime(pas.SysUtils.Now(),{get:function(){return t},set:function(e){t=e}},{get:function(){return e},set:function(t){e=t}},{get:function(){return i},set:function(t){i=t}},{get:function(){return s},set:function(t){s=t}}),s+1e3*i+60*e*1e3+60*t*60*1e3}}}),["Math","SysUtils","WEBLib.TMSFNCUtils","WEBLib.TMSFNCCustomControl","WEBLib.StdCtrls"]),rtl.module("WEBLib.TMSFNCHTMLImageContainer",["System","Classes","Types","WEBLib.Controls","WEBLib.TMSFNCCustomControl","WEBLib.TMSFNCBitmapContainer","WEBLib.TMSFNCTypes","WEBLib.TMSFNCGraphics","WEBLib.TMSFNCGraphicsTypes","WEBLib.TMSFNCUtils","WEBLib.TMSFNCStyles"],(function(){"use strict";var t=this,e=t.$impl;this.TTMSFNCHTMLImageContainerWidgetPosition={0:"hwpLeft",hwpLeft:0,1:"hwpRight",hwpRight:1},this.$rtti.$Enum("TTMSFNCHTMLImageContainerWidgetPosition",{minvalue:0,maxvalue:1,ordtype:1,enumtype:this.TTMSFNCHTMLImageContainerWidgetPosition}),this.$rtti.$MethodVar("TTMSFNCHTMLImageContainerBeforeDrawWidgetEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["AWidgetPosition",this.$rtti.TTMSFNCHTMLImageContainerWidgetPosition],["AAllow",rtl.boolean,1],["ADefaultDraw",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCHTMLImageContainerAfterDrawWidgetEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["AWidgetPosition",this.$rtti.TTMSFNCHTMLImageContainerWidgetPosition]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCHTMLImageContainerBeforeDrawTextEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["AText",rtl.string],["AAllow",rtl.boolean,1],["ADefaultDraw",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCHTMLImageContainerAfterDrawTextEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["AText",rtl.string]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCHTMLImageContainerAnchorClickEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AAnchor",rtl.string]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCHTMLImageContainerCheckedStateChangedEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AChecked",rtl.boolean]]),methodkind:0}),rtl.createClass(this,"TTMSFNCHTMLImageContainer",pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl,(function(){this.$init=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.$init.call(this),this.FBitmapContainer=null,this.FChecked=!1,this.FText="",this.FWordWrapping=!1,this.FTrimming=0,this.FVerticalTextAlign=0,this.FHorizontalTextAlign=0,this.FOnChange=null,this.FWidgetPosition=0,this.FOnAfterDrawText=null,this.FOnAfterDrawWidget=null,this.FOnBeforeDrawText=null,this.FOnBeforeDrawWidget=null,this.FBitmapName="",this.FWidgetImage=null,this.FOnAnchorClick=null,this.FOnCheckedStateChanged=null,this.FFont$1=null,this.AnchorText=""},this.$final=function(){this.FBitmapContainer=void 0,this.FOnChange=void 0,this.FOnAfterDrawText=void 0,this.FOnAfterDrawWidget=void 0,this.FOnBeforeDrawText=void 0,this.FOnBeforeDrawWidget=void 0,this.FWidgetImage=void 0,this.FOnAnchorClick=void 0,this.FOnCheckedStateChanged=void 0,this.FFont$1=void 0,pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.$final.call(this)},this.SetBitmapContainer=function(t){this.FBitmapContainer=t,this.Invalidate()},this.SetText=function(t){this.FText!==t&&(this.FText=t,this.DoChange())},this.SetTrimming=function(t){this.FTrimming!==t&&(this.FTrimming=t,this.DoChange())},this.SetWordWrapping=function(t){this.FWordWrapping!==t&&(this.FWordWrapping=t,this.DoChange())},this.SetHorizontalTextAlign=function(t){this.FHorizontalTextAlign!==t&&(this.FHorizontalTextAlign=t,this.DoChange())},this.SetVerticalTextAlign=function(t){this.FVerticalTextAlign!==t&&(this.FVerticalTextAlign=t,this.DoChange())},this.SetWidgetPosition=function(t){this.FWidgetPosition!==t&&(this.FWidgetPosition=t,this.DoChange())},this.SetBitmapName=function(t){this.FBitmapName!==t&&(this.FBitmapName=t,this.DoChange())},this.SetFnt=function(t){this.FFont$1.AssignSource(t)},this.GetBitmapContainer=function(){return this.FBitmapContainer},this.IsTextStored=function(){return""!==this.FText},this.Notification=function(t,e){pas["WEBLib.Menus"].TWebCustomControl.Notification.apply(this,arguments),1===e&&t===this.FBitmapContainer&&(this.FBitmapContainer=null)},this.Draw=function(t,e){var i=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),s=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),o=!1,n=!1;pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Draw.apply(this,arguments),o=!0,n=!0,t.FBitmapContainer=this.GetBitmapContainer(),i.$assign(this.GetWidgetAreaRect()),s.$assign(this.GetTextRect()),this.DoBeforeDrawWidget(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),this.FWidgetPosition,{get:function(){return o},set:function(t){o=t}},{get:function(){return n},set:function(t){n=t}}),o&&(n&&this.DoDrawWidget(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i)),this.DoAfterDrawWidget(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),this.FWidgetPosition)),this.DoDrawText(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(s))},this.HandleMouseMove=function(t,e,i){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleMouseMove.apply(this,arguments),this.AnchorText=this.XYToAnchor(e,i),""!==this.AnchorText?this.SetControlCursor(21):this.SetControlCursor(0)},this.HandleMouseUp=function(t,e,i,s){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleMouseUp.apply(this,arguments),this.SetFocus(),this.AnchorText=this.XYToAnchor(i,s),""!==this.AnchorText&&this.DoAnchorClick(this.AnchorText)},this.DoDrawWidget=function(t,e){null!=this.FWidgetImage&&t.DrawBitmap$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),this.FWidgetImage,!0,!1,!0,!1)},this.DoDrawText=function(t,e){var i=!1,s=!1;t.FFont.Assign(this.FFont$1),this.FEnabled||t.FFont.SetColor(10789024),i=!0,s=!0,this.DoBeforeDrawText(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),this.FText,{get:function(){return i},set:function(t){i=t}},{get:function(){return s},set:function(t){s=t}}),i&&(s&&t.DrawText$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),this.FText,this.FWordWrapping,this.FHorizontalTextAlign,this.FVerticalTextAlign,this.FTrimming,0,-1,-1,!0,!1,-1,-1),this.DoAfterDrawText(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),this.FText))},this.DoExit=function(){pas["WEBLib.Controls"].TControl.DoExit.call(this),this.Invalidate()},this.DoEnter=function(){pas["WEBLib.Controls"].TControl.DoEnter.call(this),this.Invalidate()},this.ApplyStyle=function(){var t=0;pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.ApplyStyle.call(this),this.FFill.SetKind(0),t=-1,pas["WEBLib.TMSFNCStyles"].TTMSFNCStyles.GetStyleTextFontColor({get:function(){return t},set:function(e){t=e}})&&this.FFont$1.SetColor(t)},this.ResetToDefaultStyle=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.ResetToDefaultStyle.call(this),this.FFill.SetColor(-1),this.FFill.SetKind(0),this.FFont$1.SetColor(0)},this.DoChange=function(){null!=this.FOnChange&&this.FOnChange(this),this.Invalidate()},this.DoBeforeDrawWidget=function(t,e,i,s,o){null!=this.FOnBeforeDrawWidget&&this.FOnBeforeDrawWidget(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i,s,o)},this.DoAfterDrawWidget=function(t,e,i){null!=this.FOnAfterDrawWidget&&this.FOnAfterDrawWidget(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i)},this.DoBeforeDrawText=function(t,e,i,s,o){null!=this.FOnBeforeDrawText&&this.FOnBeforeDrawText(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i,s,o)},this.DoAfterDrawText=function(t,e,i){null!=this.FOnAfterDrawText&&this.FOnAfterDrawText(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i)},this.DoAnchorClick=function(t){null!=this.FOnAnchorClick?this.FOnAnchorClick(this,t):pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.OpenURL(t)},this.DoCheckedStateChanged=function(t){null!=this.FOnCheckedStateChanged&&this.FOnCheckedStateChanged(this,t)},this.SetChecked=function(t){this.FChecked!==t&&(this.FChecked=t,this.DoCheckedStateChanged(this.FChecked),this.DoChange())},this.SetEnabled=function(t){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.SetEnabled.apply(this,arguments),this.Invalidate()},this.XYToAnchor=function(t,e){var i="",s=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),o=null;i="",s.$assign(this.GetTextRect()),(o=pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.$create("CreateBitmapCanvas",[1,1,!1,!0])).BeginScene(),o.FBitmapContainer=this.GetBitmapContainer();try{o.FFont.Assign(this.FFont$1),i=o.DrawText$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(s),this.FText,this.FWordWrapping,this.FHorizontalTextAlign,this.FVerticalTextAlign,this.FTrimming,0,-1,-1,!0,!0,t,e)}finally{o.EndScene(),o=rtl.freeLoc(o)}return i},this.GetWidgetImage=function(t){var e=null,i=0;if(e=null,null==this.GetBitmapContainer())return e;for(var s=0,o=this.GetBitmapContainer().ItemCount()-1;s<=o;s++)if(i=s,this.GetBitmapContainer().GetBitmapName(i)===this.FBitmapName){e=this.GetBitmapContainer().GetBitmap(i);break}return e},this.GetTextRect=function(){var t=pas["WEBLib.TMSFNCTypes"].TRectF.$new();return null!=this.FWidgetImage?0===this.FWidgetPosition?t.$assign(pas["WEBLib.TMSFNCTypes"].RectF(this.FWidgetImage.GetWidth()+0,0,this.GetWidth(),this.GetHeight())):t.$assign(pas["WEBLib.TMSFNCTypes"].RectF(0,0,this.GetWidth()-this.FWidgetImage.GetWidth()-0,this.GetHeight())):0===this.FWidgetPosition?t.$assign(pas["WEBLib.TMSFNCTypes"].RectF(this.ScalePaintValue(25)+this.ScalePaintValue(0),0,this.GetWidth(),this.GetHeight())):t.$assign(pas["WEBLib.TMSFNCTypes"].RectF(0,0,this.GetWidth()-this.ScalePaintValue(25)-this.ScalePaintValue(0),this.GetHeight())),t},this.GetWidgetAreaRect=function(){var t=pas["WEBLib.TMSFNCTypes"].TRectF.$new();return this.FWidgetImage=this.GetWidgetImage(this.FBitmapName),null!=this.FWidgetImage?0===this.FWidgetPosition?t.$assign(pas["WEBLib.TMSFNCTypes"].RectF(0,0,this.FWidgetImage.GetWidth(),this.GetHeight())):t.$assign(pas["WEBLib.TMSFNCTypes"].RectF(this.GetWidth()-this.FWidgetImage.GetWidth(),0,this.GetWidth(),this.GetHeight())):0===this.FWidgetPosition?t.$assign(pas["WEBLib.TMSFNCTypes"].RectF(0,0,this.ScalePaintValue(25),this.GetHeight())):t.$assign(pas["WEBLib.TMSFNCTypes"].RectF(this.GetWidth()-this.ScalePaintValue(25),0,this.GetWidth(),this.GetHeight())),t},this.GetWidgetRectangle=function(t){var e,i,s=pas["WEBLib.TMSFNCTypes"].TRectF.$new();return e=(t.Right-t.Left-16)/2,i=(t.Bottom-t.Top-16)/2,s.$assign(pas["WEBLib.TMSFNCTypes"].RectF(t.Left+e,t.Top+i,t.Left+e+16,t.Top+i+16)),s},this.Create$1=function(t){return pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Create$1.apply(this,arguments),this.FChecked=!1,this.FWordWrapping=!1,this.FTrimming=0,this.FHorizontalTextAlign=1,this.FVerticalTextAlign=0,this.FBitmapName="",this.FWidgetImage=null,this.FWidgetPosition=0,this.SetHeight(22),this.SetWidth(150),this.FStroke.SetKind(0),this.FStroke.SetColor(-1),this.FFill.SetColor(-1),this.FFont$1=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFont.$create("Create$2"),this.FTransparent=!0,this},this.Destroy=function(){rtl.free(this,"FFont$1"),pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Destroy.call(this)},this.Assign=function(e){t.TTMSFNCHTMLImageContainer.isPrototypeOf(e)?(this.FChecked=rtl.as(e,t.TTMSFNCHTMLImageContainer).FChecked,this.FText=rtl.as(e,t.TTMSFNCHTMLImageContainer).FText,this.FWordWrapping=rtl.as(e,t.TTMSFNCHTMLImageContainer).FWordWrapping,this.FTrimming=rtl.as(e,t.TTMSFNCHTMLImageContainer).FTrimming,this.FHorizontalTextAlign=rtl.as(e,t.TTMSFNCHTMLImageContainer).FHorizontalTextAlign,this.FVerticalTextAlign=rtl.as(e,t.TTMSFNCHTMLImageContainer).FVerticalTextAlign,this.FBitmapName=rtl.as(e,t.TTMSFNCHTMLImageContainer).FBitmapName,this.SetHeight(rtl.as(e,t.TTMSFNCHTMLImageContainer).GetHeight()),this.SetWidth(rtl.as(e,t.TTMSFNCHTMLImageContainer).GetWidth()),this.FFont$1.AssignSource(rtl.as(e,t.TTMSFNCHTMLImageContainer).FFont$1),this.FWidgetPosition=rtl.as(e,t.TTMSFNCHTMLImageContainer).FWidgetPosition):pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Assign.apply(this,arguments)},rtl.addIntf(this,pas["WEBLib.TMSFNCBitmapContainer"].ITMSFNCBitmapContainer),rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas["WEBLib.TMSFNCTypes"].ITMSFNCProductInfo),rtl.addIntf(this,pas.System.IUnknown)})),t.$implcode=function(){e.WIDGETWIDTH=25,e.TXTMARGIN=0}}),[]),rtl.module("WEBLib.TMSFNCCheckBox",["System","Classes","Types","WEBLib.Controls","WEBLib.TMSFNCHTMLImageContainer","WEBLib.TMSFNCTypes","WEBLib.TMSFNCGraphics","WEBLib.TMSFNCUtils"],(function(){"use strict";this.MAJ_VER=1,this.MIN_VER=0,this.REL_VER=0,this.BLD_VER=1,rtl.createClass(this,"TTMSFNCCustomCheckBox",pas["WEBLib.TMSFNCHTMLImageContainer"].TTMSFNCHTMLImageContainer,(function(){this.$init=function(){pas["WEBLib.TMSFNCHTMLImageContainer"].TTMSFNCHTMLImageContainer.$init.call(this),this.FStartSize=0,this.FMouseHover=!1},this.DoDrawWidget=function(t,e){var i=!1,s=pas["WEBLib.TMSFNCTypes"].TRectF.$new();pas["WEBLib.TMSFNCHTMLImageContainer"].TTMSFNCHTMLImageContainer.DoDrawWidget.apply(this,arguments),null==this.FWidgetImage&&(i=this.IsFocused()||this.FMouseHover,s.$assign(this.GetWidgetRectangle(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e))),t.DrawCheckBox(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(s),this.FChecked,i,this.FEnabled,1))},this.HandleMouseUp=function(t,e,i,s){pas["WEBLib.TMSFNCHTMLImageContainer"].TTMSFNCHTMLImageContainer.HandleMouseUp.apply(this,arguments),this.FEnabled&&""===this.AnchorText&&this.SetChecked(!this.FChecked)},this.HandleMouseLeave=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleMouseLeave.call(this),this.FEnabled&&(this.FMouseHover=!1,this.Invalidate())},this.HandleMouseEnter=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleMouseEnter.call(this),this.FEnabled&&(this.FMouseHover=!0,this.Invalidate())},this.HandleKeyDown=function(t,e){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleKeyDown.apply(this,arguments),32!==t.get()&&13!==t.get()||this.SetChecked(!this.FChecked)},this.GetVersion=function(){return this.$class.GetVersionNumber(1,0,0,1)},this.Create$1=function(t){var e=0;return pas["WEBLib.TMSFNCHTMLImageContainer"].TTMSFNCHTMLImageContainer.Create$1.apply(this,arguments),this.FMouseHover=!1,this.SetText("TMSFNCCheckBox"),e=pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.GetDPIScale(this,96),this.FStartSize=1===e?15:13,this},rtl.addIntf(this,pas["WEBLib.TMSFNCBitmapContainer"].ITMSFNCBitmapContainer),rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas["WEBLib.TMSFNCTypes"].ITMSFNCProductInfo),rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TTMSFNCCheckBox",this.TTMSFNCCustomCheckBox,(function(){rtl.addIntf(this,pas["WEBLib.TMSFNCBitmapContainer"].ITMSFNCBitmapContainer),rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas["WEBLib.TMSFNCTypes"].ITMSFNCProductInfo),rtl.addIntf(this,pas.System.IUnknown);var t=this.$rtti;t.addProperty("BitmapContainer",3,pas["WEBLib.TMSFNCBitmapContainer"].$rtti.TTMSFNCBitmapContainer,"GetBitmapContainer","SetBitmapContainer"),t.addProperty("BitmapName",2,rtl.string,"FBitmapName","SetBitmapName"),t.addProperty("Checked",2,rtl.boolean,"FChecked","SetChecked",{Default:!1}),t.addProperty("WidgetPosition",2,pas["WEBLib.TMSFNCHTMLImageContainer"].$rtti.TTMSFNCHTMLImageContainerWidgetPosition,"FWidgetPosition","SetWidgetPosition",{Default:pas["WEBLib.TMSFNCHTMLImageContainer"].TTMSFNCHTMLImageContainerWidgetPosition.hwpLeft}),t.addProperty("WordWrapping",2,rtl.boolean,"FWordWrapping","SetWordWrapping",{Default:!1}),t.addProperty("Trimming",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsTextTrimming,"FTrimming","SetTrimming",{Default:pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsTextTrimming.gttNone}),t.addProperty("Text",14,rtl.string,"FText","SetText",{stored:"IsTextStored"}),t.addProperty("Font",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFont,"FFont$1","SetFnt"),t.addProperty("HorizontalTextAlign",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsTextAlign,"FHorizontalTextAlign","SetHorizontalTextAlign",{Default:pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsTextAlign.gtaLeading}),t.addProperty("VerticalTextAlign",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsTextAlign,"FVerticalTextAlign","SetVerticalTextAlign",{Default:pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsTextAlign.gtaCenter}),t.addProperty("OnChange",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnChange","FOnChange"),t.addProperty("OnCheckedStateChanged",0,pas["WEBLib.TMSFNCHTMLImageContainer"].$rtti.TTMSFNCHTMLImageContainerCheckedStateChangedEvent,"FOnCheckedStateChanged","FOnCheckedStateChanged"),t.addProperty("OnAnchorClick",0,pas["WEBLib.TMSFNCHTMLImageContainer"].$rtti.TTMSFNCHTMLImageContainerAnchorClickEvent,"FOnAnchorClick","FOnAnchorClick"),t.addProperty("OnBeforeDrawWidget",0,pas["WEBLib.TMSFNCHTMLImageContainer"].$rtti.TTMSFNCHTMLImageContainerBeforeDrawWidgetEvent,"FOnBeforeDrawWidget","FOnBeforeDrawWidget"),t.addProperty("OnAfterDrawWidget",0,pas["WEBLib.TMSFNCHTMLImageContainer"].$rtti.TTMSFNCHTMLImageContainerAfterDrawWidgetEvent,"FOnAfterDrawWidget","FOnAfterDrawWidget"),t.addProperty("OnBeforeDrawText",0,pas["WEBLib.TMSFNCHTMLImageContainer"].$rtti.TTMSFNCHTMLImageContainerBeforeDrawTextEvent,"FOnBeforeDrawText","FOnBeforeDrawText"),t.addProperty("OnAfterDrawText",0,pas["WEBLib.TMSFNCHTMLImageContainer"].$rtti.TTMSFNCHTMLImageContainerAfterDrawTextEvent,"FOnAfterDrawText","FOnAfterDrawText"),t.attr=[pas.Classes.ComponentPlatformsAttribute,"Create$1",[0]]}))})),rtl.module("WebLib.SERTTK.CVSessionViewer",["System","Generics.Collections","Classes","Types","WEBLib.TMSFNCTreeView","WEBLib.TMSFNCPageControl","WEBLib.TMSFNCHTMLText","WEBLib.TMSFNCTableView","WEBLib.TMSFNCImage","WEBLib.ExtCtrls","WEBLib.TMSFNCComboBox","WEBLib.TMSFNCCheckBox","WEBLib.TMSFNCSplitter","WEBLib.TMSFNCGraphicsTypes","WEBLib.TMSFNCEdit","WebLib.SEFNC.Layout","WEBLib.StdCtrls","WEBLib.TMSFNCTypes","WEBLib.Controls","WebLib.SERTTK.CVTypes","WebLib.SERTTK.Session"],(function(){"use strict";var t=this;rtl.createClass(this,"TSECVInspectStepDetail",pas["WebLib.SEFNC.Layout"].TSEFNCLayout,(function(){this.$init=function(){pas["WebLib.SEFNC.Layout"].TSEFNCLayout.$init.call(this),this.FPageContainer=null,this.FOwner$1=null,this.FDetailText=null,this.FLeftText=null,this.FRightText=null,this.FImageBefore=null,this.FImageAfter=null,this.FDetailSplit=null,this.FCBScreens=null,this.FInspectorStep=null,this.FSession=null,this.FImagePopMenu=null,this.FDiffAnalysis=null,this.FDiffAnalyzed=!1,this.FlytDetailClient=null,this.FlytLeftDetail=null,this.FlytRightDetail=null,this.FImageBeforeDrawDiffs=null,this.FImageAfterDrawDiffs=null,this.FImageBeforeNoiseLevel=null,this.FImageAfterNoiseLevel=null},this.$final=function(){this.FPageContainer=void 0,this.FOwner$1=void 0,this.FDetailText=void 0,this.FLeftText=void 0,this.FRightText=void 0,this.FImageBefore=void 0,this.FImageAfter=void 0,this.FDetailSplit=void 0,this.FCBScreens=void 0,this.FInspectorStep=void 0,this.FSession=void 0,this.FImagePopMenu=void 0,this.FDiffAnalysis=void 0,this.FlytDetailClient=void 0,this.FlytLeftDetail=void 0,this.FlytRightDetail=void 0,this.FImageBeforeDrawDiffs=void 0,this.FImageAfterDrawDiffs=void 0,this.FImageBeforeNoiseLevel=void 0,this.FImageAfterNoiseLevel=void 0,pas["WebLib.SEFNC.Layout"].TSEFNCLayout.$final.call(this)},this.BuildDetailView=function(){var t=null;(t=pas["WebLib.SEFNC.Layout"].TSEFNCLayout.$create("Create$1",[this.FOwner$1])).SetParent(this),t.SetAlignment$1(1),t.SetHeight(32),this.FlytDetailClient=pas["WebLib.SEFNC.Layout"].TSEFNCLayout.$create("Create$1",[this.FOwner$1]),this.FlytDetailClient.SetParent(this),this.FlytDetailClient.SetAlignment$1(5),this.FDetailText=pas["WEBLib.TMSFNCHTMLText"].TTMSFNCHTMLText.$create("Create$1",[this.FOwner$1]),this.FDetailText.SetParent(t),this.FDetailText.SetAlign(pas["WebLib.SEFNC.Layout"].TSEFNCAlign.GetAlign(5)),this.FCBScreens=pas["WEBLib.TMSFNCComboBox"].TTMSFNCComboBox.$create("Create$1",[this.FOwner$1]),this.FCBScreens.SetParent(t),this.FCBScreens.SetAlign(pas["WebLib.SEFNC.Layout"].TSEFNCAlign.GetAlign(4)),this.FCBScreens.SetStyle(1),this.FCBScreens.FOnItemSelected$1=rtl.createCallback(this,"CBScreensItemSelected"),this.FlytLeftDetail=pas["WebLib.SEFNC.Layout"].TSEFNCLayout.$create("Create$1",[this.FOwner$1]),this.FlytLeftDetail.SetParent(this.FlytDetailClient),this.FlytLeftDetail.SetAlignment$1(3),this.FlytLeftDetail.SetWidth(300),this.FLeftText=pas["WEBLib.TMSFNCHTMLText"].TTMSFNCHTMLText.$create("Create$1",[this.FOwner$1]),this.FLeftText.SetParent(this.FlytLeftDetail),this.FLeftText.SetAlign(pas["WebLib.SEFNC.Layout"].TSEFNCAlign.GetAlign(1)),this.FLeftText.SetText("Before Image "),this.FLeftText.SetHeight(32),this.FLeftText.SetHorizontalTextAlign(2),this.FLeftText.FMargins.SetRight(4),this.FImageBeforeDrawDiffs=pas["WEBLib.TMSFNCCheckBox"].TTMSFNCCheckBox.$create("Create$1",[this.FOwner$1]),this.FImageBeforeDrawDiffs.SetParent(this.FLeftText),this.FImageBeforeDrawDiffs.SetAlign(pas["WebLib.SEFNC.Layout"].TSEFNCAlign.GetAlign(3)),this.FImageBeforeDrawDiffs.SetText("Diffs?"),this.FImageBeforeDrawDiffs.FOnCheckedStateChanged=rtl.createCallback(this,"ImgDiffDrawBeforeCheckedStateChanged"),this.FImageBeforeDrawDiffs.SetWidth(60),this.FImageBeforeNoiseLevel=pas["WEBLib.TMSFNCEdit"].TTMSFNCEdit.$create("Create$1",[this.FOwner$1]),this.FImageBeforeNoiseLevel.SetParent(this.FLeftText),this.FImageBeforeNoiseLevel.SetAlign(pas["WebLib.SEFNC.Layout"].TSEFNCAlign.GetAlign(3)),this.FImageBeforeNoiseLevel.SetT("8"),this.FImageBeforeNoiseLevel.SetEditType$1(1),this.FImageBeforeNoiseLevel.SetWidth(32),this.FImageBeforeNoiseLevel.FOnChange=rtl.createCallback(this,"ImgNoiseLevelBeforeChange"),this.FImageBefore=pas["WEBLib.TMSFNCImage"].TTMSFNCImage.$create("Create$1",[this.FOwner$1]),this.FImageBefore.SetParent(this.FlytLeftDetail),this.FImageBefore.SetAlign(pas["WebLib.SEFNC.Layout"].TSEFNCAlign.GetAlign(5)),this.FImagePopMenu=this.CreateImageMenu(),this.FImageBefore.FPopupMenu=this.FImagePopMenu,this.FDetailSplit=pas["WEBLib.TMSFNCSplitter"].TTMSFNCSplitter.$create("Create$1",[this.FOwner$1]),this.FDetailSplit.SetParent(this.FlytDetailClient),this.FlytRightDetail=pas["WebLib.SEFNC.Layout"].TSEFNCLayout.$create("Create$1",[this.FOwner$1]),this.FlytRightDetail.SetParent(this.FlytDetailClient),this.FlytRightDetail.SetAlignment$1(5),this.FRightText=pas["WEBLib.TMSFNCHTMLText"].TTMSFNCHTMLText.$create("Create$1",[this.FOwner$1]),this.FRightText.SetParent(this.FlytRightDetail),this.FRightText.SetAlign(pas["WebLib.SEFNC.Layout"].TSEFNCAlign.GetAlign(1)),this.FRightText.SetText("After Image "),this.FRightText.SetHeight(32),this.FRightText.SetHorizontalTextAlign(2),this.FRightText.FMargins.SetRight(4),this.FImageAfterDrawDiffs=pas["WEBLib.TMSFNCCheckBox"].TTMSFNCCheckBox.$create("Create$1",[this.FOwner$1]),this.FImageAfterDrawDiffs.SetParent(this.FRightText),this.FImageAfterDrawDiffs.SetAlign(pas["WebLib.SEFNC.Layout"].TSEFNCAlign.GetAlign(3)),this.FImageAfterDrawDiffs.SetText("Diffs?"),this.FImageAfterDrawDiffs.SetWidth(60),this.FImageAfterDrawDiffs.FOnCheckedStateChanged=rtl.createCallback(this,"ImgDiffDrawAfterCheckedStateChanged"),this.FImageAfterNoiseLevel=pas["WEBLib.TMSFNCEdit"].TTMSFNCEdit.$create("Create$1",[this.FOwner$1]),this.FImageAfterNoiseLevel.SetParent(this.FRightText),this.FImageAfterNoiseLevel.SetAlign(pas["WebLib.SEFNC.Layout"].TSEFNCAlign.GetAlign(3)),this.FImageAfterNoiseLevel.SetT("8"),this.FImageAfterNoiseLevel.SetEditType$1(1),this.FImageAfterNoiseLevel.SetWidth(32),this.FImageAfterNoiseLevel.FOnChange=rtl.createCallback(this,"ImgNoiseLevelAfterChange"),this.FImageAfter=pas["WEBLib.TMSFNCImage"].TTMSFNCImage.$create("Create$1",[this.FOwner$1]),this.FImageAfter.SetParent(this.FlytRightDetail),this.FImageAfter.SetAlign(pas["WebLib.SEFNC.Layout"].TSEFNCAlign.GetAlign(5)),this.DiffToolsShow(!1),this.FImageAfter.FPopupMenu=this.CreateImageMenu(),this.SetVisible(!1)},this.CreateImageMenu=function(){return pas["WebLib.SERTTK.CVTypes"].TSEFNCPopupMenu.$create("Create$1",[this.FOwner$1])},this.ImagesUpdateFill=function(t){},this.CBScreensItemSelected=function(t,e,i){var s,o=null,n=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),r=null,a=null;if(s=this.FInspectorStep.FScreenDiffs.GetItem(i),this.FSession.BitmapByGuid(s.FBeforeGuid,{get:function(){return r},set:function(t){r=t}})&&(this.FImageBefore.SetBitmap(r),this.FSession.BitmapByGuid(s.FAfterGuid,{get:function(){return a},set:function(t){a=t}})&&(this.FImageAfter.SetBitmap(a),this.FDiffAnalyzed&&this.FDiffAnalysis.ScreenDiffInfo(s.FScreenName,{get:function(){return o},set:function(t){o=t}}))))if(1===o.Score)this.ImagesUpdateFill(!1);else{this.ImagesUpdateFill(!0);var l=o.Diffs.GetEnumerator$1();try{for(;l.MoveNext();)n=l.DoGetCurrent(),this.AddDiffRect(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(n))}finally{l=rtl.freeLoc(l)}}},this.AddDiffRect=function(t){},this.DiffToolsShow=function(t){this.FImageBeforeNoiseLevel.SetVisible(t),this.FImageAfterDrawDiffs.SetVisible(t),this.FImageBeforeDrawDiffs.SetVisible(t),this.FImageAfterNoiseLevel.SetVisible(t)},this.ImgDiffDrawBeforeCheckedStateChanged=function(t,e){var i,s=null,o=(pas["WEBLib.TMSFNCTypes"].TRectF.$new(),null);if(i=this.FInspectorStep.FScreenDiffs.GetItem(this.FCBScreens.GetItemIndex()),this.FSession.BitmapByGuid(i.FBeforeGuid,{get:function(){return o},set:function(t){o=t}})&&(this.FImageBefore.SetBitmap(o),this.FDiffAnalyzed&&e&&this.FDiffAnalysis.ScreenDiffInfo(i.FScreenName,{get:function(){return s},set:function(t){s=t}})))if(1===s.Score)this.ImagesUpdateFill(!1);else{this.ImagesUpdateFill(!0);var n=s.Diffs.GetEnumerator$1();try{for(;n.MoveNext();)n.DoGetCurrent()}finally{n=rtl.freeLoc(n)}}},this.ImgDiffDrawAfterCheckedStateChanged=function(t,e){var i,s=null,o=(pas["WEBLib.TMSFNCTypes"].TRectF.$new(),null);if(i=this.FInspectorStep.FScreenDiffs.GetItem(this.FCBScreens.GetItemIndex()),this.FSession.BitmapByGuid(i.FAfterGuid,{get:function(){return o},set:function(t){o=t}})&&(this.FImageAfter.SetBitmap(o),this.FDiffAnalyzed&&e&&this.FDiffAnalysis.ScreenDiffInfo(i.FScreenName,{get:function(){return s},set:function(t){s=t}})))if(1===s.Score)this.ImagesUpdateFill(!1);else{this.ImagesUpdateFill(!0);var n=s.Diffs.GetEnumerator$1();try{for(;n.MoveNext();)n.DoGetCurrent()}finally{n=rtl.freeLoc(n)}}},this.ImgNoiseLevelBeforeChange=function(t){},this.ImgNoiseLevelAfterChange=function(t){},this.AssignSession=function(t){this.FSession=t},this.LoadDetail=function(t){var e=0,i=0,s=null;this.FInspectorStep=t,this.FDiffAnalyzed=this.FSession.StepDiffAnalysis(this.FInspectorStep.FID,{p:this,get:function(){return this.p.FDiffAnalysis},set:function(t){this.p.FDiffAnalysis=t}}),this.FDetailText.SetText(this.FInspectorStep.DispPropertyName()+" :: "+this.FInspectorStep.DispPropertyPreviousValue()+" --\x3e "+this.FInspectorStep.DispPropertyValue()),this.FCBScreens.FItems.Clear();for(var o=0,n=this.FInspectorStep.FScreenDiffs.FLength-1;o<=n;o++)e=o,s=this.FInspectorStep.FScreenDiffs.GetItem(e),this.FCBScreens.AddItem(s.FScreenName);i=0;for(var r=0,a=this.FCBScreens.FItems.GetCount()-1;r<=a;r++)e=r,pas.SysUtils.TStringHelper.StartsWith.call({p:t.GetCompDisplayPath(),get:function(){return this.p},set:function(t){this.p=t}},this.FCBScreens.FItems.Get(e))&&(i=e);this.FCBScreens.SetItemIndex(i),this.CBScreensItemSelected(this,"",i)},this.Create$4=function(t,e){return pas["WEBLib.Controls"].TControl.Create$1.call(this,e),this.FPageContainer=t,this.SetParent(this.FPageContainer),this.FOwner$1=e,this.BuildDetailView(),this},rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TSERTTKCVSessionViewer",pas.System.TObject,(function(){this.$init=function(){pas.System.TObject.$init.call(this),this.FPageContainer=null,this.FPage=null,this.FOwner=null,this.FDetailTree=null,this.FLastStep=0,this.FSession=null,this.FTimer=null,this.FTableView=null,this.FTextDetail=null,this.FDetailMemo=null,this.FDetailImage=null,this.FInspectDetail=null,this.FToolArea=null,this.FLytPage=null},this.$final=function(){this.FPageContainer=void 0,this.FPage=void 0,this.FOwner=void 0,this.FDetailTree=void 0,this.FSession=void 0,this.FTimer=void 0,this.FTableView=void 0,this.FTextDetail=void 0,this.FDetailMemo=void 0,this.FDetailImage=void 0,this.FInspectDetail=void 0,this.FToolArea=void 0,this.FLytPage=void 0,pas.System.TObject.$final.call(this)},this.LoadInfoTree=function(t){var e=!1,i=rtl.createIntfRefs();try{try{(e=t.FInfoStream.DataLoaded())?i.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("Stream step data is loaded",this):(i.ref(2,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("Stream not loaded, attemping Load Stream step data Before viewing",this),(e=this.FSession.InfoStreamByStep(t))?i.ref(3,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("stream is loaded from session",this):i.ref(4,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("stream failed to load from session",this)),e&&pas["WEBLib.TMSFNCTypes"].TTMSFNCObjectHelper.LoadFromJSONStream.call(this.FDetailTree,t.FInfoStream.FStream)}catch(s){if(!pas.SysUtils.Exception.isPrototypeOf(s))throw s;e=!1,i.ref(5,pas["WebLib.SEFNC.Logger"].Logger()).Debug$1("Failed to load info tree from store"+t.FInfoStream.InfoStreamFileName(),this),this.FTableView.FFooter.SetText("Failed to load tree")}}finally{i.free()}return e},this.DoExportSessionClick=function(t){var e=rtl.createIntfRefs();try{null!==this.FSession&&(e.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("Exporting Session via click",this),this.FSession.SessionJSONSaveToFile(this.FSession.SessionJsonFileName()))}finally{e.free()}},this.PullEntries=function(t){if(this.FLastStep<this.FSession.EventsGet().GetCount()){for(;this.FLastStep<this.FSession.EventsGet().GetCount();)this.TableItemAdd(this.FSession.EventsGet().Get(this.FLastStep)),this.FLastStep+=1;this.FTableView.ScrollToItem(this.FTableView.FItems.GetCount()-1),this.FTableView.SelectItem(this.FTableView.FItems.GetCount()-1)}},this.TableItemAdd=function(t){var e=null,i=null,s=rtl.createIntfRefs();try{this.FSession.SessionStepsGet().TryGetValue(t,{get:function(){return i},set:function(t){i=t}})?((e=this.FTableView.AddItem(i.GetDisplayString())).FDataObject=i,e.FDBKey=t,pas["WebLib.SERTTK.Session"].TSESSessionScreenShot.isPrototypeOf(i)?e.SetDetailControl(this.FDetailImage):pas["WebLib.SERTTK.Session"].TSESSessionCompExport.isPrototypeOf(i)?e.SetDetailControl(this.FDetailMemo):pas["WebLib.SERTTK.Session"].TSESSessionStepInfoTree.isPrototypeOf(i)?e.SetDetailControl(this.FDetailTree):pas["WebLib.SERTTK.Session"].TSESSessionStepInspector.isPrototypeOf(i)?e.SetDetailControl(this.FInspectDetail):(pas["WebLib.SERTTK.Session"].TSESSessionBookmark.isPrototypeOf(i)||pas["WebLib.SERTTK.Session"].TSESSessionStepLog.isPrototypeOf(i))&&e.SetDetailControl(this.FTextDetail)):s.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Warn("Step not found for event ID")}finally{s.free()}},this.BeforeItemShowDetailControl=function(t,e,i,s){var o=null;pas["WebLib.SERTTK.Session"].TSESSessionCompExport.isPrototypeOf(e.FDataObject)?(this.FTableView.FFooter.SetText(e.FText),this.FDetailMemo.SetText(e.FDataObject.FCompExport)):pas["WebLib.SERTTK.Session"].TSESSessionStepInfoTree.isPrototypeOf(e.FDataObject)?(this.FTableView.FFooter.SetText(e.FText),s.set(this.LoadInfoTree(e.FDataObject))):pas["WebLib.SERTTK.Session"].TSESSessionStepInspector.isPrototypeOf(e.FDataObject)?(i.LoadDetail(e.FDataObject),this.FTableView.FFooter.SetText(e.FDataObject.GetDisplayDTS()+" Path="+e.FDataObject.GetCompDisplayPath()),s.set(!1)):pas["WebLib.SERTTK.Session"].TSESSessionScreenShot.isPrototypeOf(e.FDataObject)?this.FSession.BitmapByGuid(e.FDataObject.FBitmapGuid,{get:function(){return o},set:function(t){o=t}})?(i.SetBitmap(o),this.FTableView.FFooter.SetText(e.FText)):s.set(!1):pas["WebLib.SERTTK.Session"].TSESSessionBookmark.isPrototypeOf(e.FDataObject)?s.set(!1):pas["WebLib.SERTTK.Session"].TSESSessionStepLog.isPrototypeOf(e.FDataObject)&&(this.FTextDetail.SetText(e.FText),pas.SysUtils.TStringHelper.GetLength.call({p:e,get:function(){return this.p.FText},set:function(t){this.p.FText=t}})<100&&s.set(!1))},this.BeforeItemHideDetailControl=function(t,e,i,s){this.FTableView.FFooter.SetText(""),this.FDetailImage.SetVisible(!1)},this.CreateImageMenu=function(){return pas["WebLib.SERTTK.CVTypes"].TSEFNCPopupMenu.$create("Create$1",[this.FOwner])},this.Initialize=function(e){this.FLytPage=pas["WebLib.SEFNC.Layout"].TSEFNCLayout.$create("Create$1",[this.FOwner]),this.FLytPage.SetParent(this.FPageContainer),this.FLytPage.SetAlignment$1(5),e&&(this.FToolArea=pas["WebLib.SERTTK.CVTypes"].TSECVToolArea.$create("Create$4",[this.FLytPage]),this.FToolArea.HelpLinkSet("Help"),this.FToolArea.NewButton$1("Export Session",rtl.createCallback(this,"DoExportSessionClick"))),this.FTableView=pas["WEBLib.TMSFNCTableView"].TTMSFNCTableView.$create("Create$1",[this.FOwner]),this.FTableView.SetParent(this.FLytPage),this.FTableView.SetAlign(pas["WebLib.SEFNC.Layout"].TSEFNCAlign.GetAlign(5)),this.FTableView.FHeader.SetText("Session"),this.FTableView.FInteraction.SetShowFilterButton(!0),this.FTableView.SetVerticalScrollBarVisible(!0),this.FTableView.FInteraction.SetAnimationFactor(1),this.FTextDetail=pas["WEBLib.TMSFNCHTMLText"].TTMSFNCHTMLText.$create("Create$1",[this.FOwner]),this.FTextDetail.SetParent(this.FTableView),this.FTextDetail.SetVisible(!1),this.FDetailMemo=pas["WEBLib.StdCtrls"].TMemo.$create("Create$1",[this.FOwner]),this.FDetailMemo.SetParent(this.FTableView),this.FDetailMemo.SetVisible(!1),this.FDetailTree=pas["WEBLib.TMSFNCTreeView"].TTMSFNCTreeView.$create("Create$1",[this.FOwner]),this.FDetailTree.SetParent(this.FTableView),this.FDetailTree.SetVisible(!1),this.FDetailImage=pas["WEBLib.TMSFNCImage"].TTMSFNCImage.$create("Create$1",[this.FOwner]),this.FDetailImage.SetParent(this.FTableView),this.FDetailImage.SetCenter(!0),this.FDetailImage.SetAS(!0),this.FDetailImage.FPopupMenu=this.CreateImageMenu(),this.FDetailImage.SetVisible(!1),this.FInspectDetail=t.TSECVInspectStepDetail.$create("Create$4",[this.FPageContainer,this.FOwner]),this.FInspectDetail.AssignSession(this.FSession),this.PullEntries(this.FTableView),this.FTimer=pas["WEBLib.ExtCtrls"].TTimer.$create("Create$1",[this.FPageContainer.FOwner]),this.FTimer.SetEnabled(!1),this.FTimer.FOnTimer=rtl.createCallback(this,"PullEntries"),this.FTimer.SetInterval(500),this.FTableView.FOnBeforeItemShowDetailControl=rtl.createCallback(this,"BeforeItemShowDetailControl"),this.FTableView.FOnBeforeItemHideDetailControl=rtl.createCallback(this,"BeforeItemHideDetailControl")},this.Activate=function(){null!==this.FSession&&this.FTimer.SetEnabled(!0)},this.DeActivate=function(){this.FTimer.SetEnabled(!1)},this.AssignSession=function(t){this.FSession=t},this.Create$1=function(t,e){return this.FPage=t,this.FOwner=e,this.FPageContainer=this.FPage.FContainer,this.FLastStep=0,this},this.Destroy=function(){rtl.free(this,"FInspectDetail"),pas.System.TObject.Destroy.call(this)}}))}),["SysUtils","WEBLib.TMSFNCTreeViewData","WEBLib.TMSFNCGraphics","WEBLib.TMSFNCUtils","WebLib.SEFNC.Logger","WEBLib.TMSFNCPersistence"]),rtl.module("WebLib.SERTTK.MarshalTypes",["System","Classes","Generics.Collections","WEBLib.TMSFNCTreeView","WEBLib.TMSFNCTreeViewData","WEBLib.TMSFNCToolBar","WEBLib.TMSFNCHTMLText","WEBLib.TMSFNCStatusBar","WEBLib.Forms","WEBLib.Menus","WEBLib.Menus","WEBLib.Storage","WEBLib.TMSFNCPageControl","WEBLib.Controls","WEBLib.StdCtrls","WEBLib.TMSFNCSplitter","WEBLib.TMSFNCTaskDialog","WebLib.SERTTK.Repository","WebLib.SERTTK.Session","WebLib.SERTTK.CVTypes","WebLib.SEFNC.RunLevelTypes","WebLib.SEFNC.Layout","WebLib.SEFNC.CVLoggerViewer","WebLib.SERTTK.CVSessionViewer","SysUtils"],(function(){"use strict";var t=this;rtl.createClass(this,"TSERTTKMarshalOptions",pas.System.TObject,(function(){this.$init=function(){pas.System.TObject.$init.call(this),this.FFormWidth=0,this.FFormHeight=0,this.FReOpenInspectors=!1,this.FPersistentStore=!1,this.FOpenInspectors=null},this.$final=function(){this.FOpenInspectors=void 0,pas.System.TObject.$final.call(this)},this.Create$1=function(t){return this.FReOpenInspectors=t,this.FFormWidth=960,this.FFormHeight=960,this.FPersistentStore=!1,this.FOpenInspectors=pas.Classes.TStringList.$create("Create$1"),this.FOpenInspectors.FDuplicates=0,this.FOpenInspectors.SetSorted(!0),this.FOpenInspectors.SetCaseSensitive(!1),this.FOpenInspectors.SetDelimiter(";"),this.FOpenInspectors.SetQuoteChar('"'),this.FOpenInspectors.FStrictDelimiter=!0,this},this.Destroy=function(){rtl.free(this,"FOpenInspectors"),pas.System.TObject.Destroy.call(this)}})),this.def_form_height=960,this.def_form_width=960,this.txt_form_prefix="Marshal by SwiftExpat - ",this.txt_form_version=" - 2023.03.28",rtl.createClass(this,"TSERTTKInspectorCVInfo",pas.System.TObject,(function(){this.$init=function(){pas.System.TObject.$init.call(this),this.FMarshalProxy=null,this.ToolPage=null,this.Repository=null},this.$final=function(){this.FMarshalProxy=void 0,this.ToolPage=void 0,this.Repository=void 0,pas.System.TObject.$final.call(this)},this.Create$1=function(t){return this.FMarshalProxy=t,this}})),rtl.createClass(this,"TSECVLogToolDebug",pas["WebLib.SERTTK.CVTypes"].TSECVLogToolBase,(function(){this.$init=function(){pas["WebLib.SERTTK.CVTypes"].TSECVLogToolBase.$init.call(this),this.FLogViewer=null},this.$final=function(){this.FLogViewer=void 0,pas["WebLib.SERTTK.CVTypes"].TSECVLogToolBase.$final.call(this)},this.Initialize=function(){this.FLogViewer=pas["WebLib.SEFNC.CVLoggerViewer"].TSEFNCLoggerViewer.$create("Create$1",[this.FPage])},this.Activate=function(){pas["WebLib.SERTTK.CVTypes"].TSECVLogToolBase.Activate.call(this),this.FLogViewer.ActiveSet(!0)},this.DeActivate=function(){this.FLogViewer.ActiveSet(!1),pas["WebLib.SERTTK.CVTypes"].TSECVLogToolBase.DeActivate.call(this)},this.Create$2=function(t,e){return pas["WebLib.SERTTK.CVTypes"].TSECVLogToolBase.Create$1.call(this,t,e),this},this.Destroy=function(){rtl.free(this,"FLogViewer"),pas.System.TObject.Destroy.call(this)}})),rtl.createClass(this,"TSECVLogToolSessionViewer",pas["WebLib.SERTTK.CVTypes"].TSECVLogToolBase,(function(){this.$init=function(){pas["WebLib.SERTTK.CVTypes"].TSECVLogToolBase.$init.call(this),this.FSessionViewer=null,this.FSession=null},this.$final=function(){this.FSessionViewer=void 0,this.FSession=void 0,pas["WebLib.SERTTK.CVTypes"].TSECVLogToolBase.$final.call(this)},this.Initialize=function(){this.FSessionViewer.Initialize(!0)},this.AssignSession=function(t){this.FSession=t,null!=this.FSessionViewer&&this.FSessionViewer.AssignSession(this.FSession)},this.Activate=function(){pas["WebLib.SERTTK.CVTypes"].TSECVLogToolBase.Activate.call(this),this.FSessionViewer.Activate()},this.DeActivate=function(){this.FSessionViewer.DeActivate(),pas["WebLib.SERTTK.CVTypes"].TSECVLogToolBase.DeActivate.call(this)},this.Create$2=function(t,e){return this.FSessionViewer=pas["WebLib.SERTTK.CVSessionViewer"].TSERTTKCVSessionViewer.$create("Create$1",[t,e]),pas["WebLib.SERTTK.CVTypes"].TSECVLogToolBase.Create$1.call(this,t,e),this},this.Destroy=function(){rtl.free(this,"FSessionViewer"),pas.System.TObject.Destroy.call(this)}})),rtl.createClass(this,"TSECVLogPanel",pas["WebLib.SERTTK.CVTypes"].TSECVDisplayBase,(function(){this.$init=function(){pas["WebLib.SERTTK.CVTypes"].TSECVDisplayBase.$init.call(this),this.FpnlLog=null,this.FPageControl=null,this.FLogViewer=null,this.FSessionViewer=null,this.FPgSession=null,this.FPgLogViewer=null},this.$final=function(){this.FpnlLog=void 0,this.FPageControl=void 0,this.FLogViewer=void 0,this.FSessionViewer=void 0,this.FPgSession=void 0,this.FPgLogViewer=void 0,pas["WebLib.SERTTK.CVTypes"].TSECVDisplayBase.$final.call(this)},this.ToolActivate=function(t){var e=rtl.createIntfRefs();try{if(null!==t.FDataObject&&pas["WebLib.SERTTK.CVTypes"].TSECVLogToolBase.isPrototypeOf(t.FDataObject))try{t.FDataObject.Activate()}catch(t){if(pas.SysUtils.Exception.isPrototypeOf(t)){var i=t;e.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Trace$2("Activation failed, exception ",i,this)}else e.ref(2,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("Activation failed, exception else",this)}else e.ref(3,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("Activation failed, page DataObject not valid ",this)}finally{e.free()}},this.ToolDeactivate=function(t){var e=rtl.createIntfRefs();try{if(null!==t.FDataObject&&pas["WebLib.SERTTK.CVTypes"].TSECVLogToolBase.isPrototypeOf(t.FDataObject))try{t.FDataObject.DeActivate()}catch(t){if(pas.SysUtils.Exception.isPrototypeOf(t)){var i=t;e.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Trace$2("De-Activation failed, exception ",i,this)}else e.ref(2,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("De-Activation failed, exception else",this)}else e.ref(3,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("De-Activation failed, page DataObject not valid ",this)}finally{e.free()}},this.PanelCreate=function(){var t=rtl.createIntfRefs();try{t.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("Begin create Log Panels",this),this.FpnlLog=pas["WebLib.SEFNC.Layout"].TSEFNCLayout.$create("Create$1",[this.FOwner]),this.FpnlLog.SetParent(this.FLayout),this.FpnlLog.SetAlign(pas["WebLib.SEFNC.Layout"].TSEFNCAlign.GetAlign(5)),this.FpnlLog.SetVisible(!1),t.ref(2,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("Panel created Log Panels",this),this.FPageControl=pas["WEBLib.TMSFNCPageControl"].TTMSFNCPageControl.$create("Create$1",[this.FOwner]),this.FPageControl.SetParent(this.FpnlLog),this.FPageControl.SetAlign(pas["WebLib.SEFNC.Layout"].TSEFNCAlign.GetAlign(5)),this.FPageControl.SetName("SessionToolPages"),t.ref(3,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("Page control created Log Panels",this),this.CreateLogTabs(),this.FPageControl.SetActivePage(this.FPgSession),this.FPageControl.FOnChangePage=rtl.createCallback(this,"ChangePage"),t.ref(4,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("End create Log Panels",this)}finally{t.free()}},this.CreateLogTabs=function(){this.FPageControl.BeginUpdate();try{this.FPgSession=this.FPageControl.AddPage("Session Viewer"),this.FSessionViewer=t.TSECVLogToolSessionViewer.$create("Create$2",[this.FPgSession,this.FOwner]),this.FPgSession.FDataObject=this.FSessionViewer,this.FPgLogViewer=this.FPageControl.AddPage("Marshal Debug Log"),this.FLogViewer=t.TSECVLogToolDebug.$create("Create$2",[this.FPgLogViewer,this.FOwner]),this.FPgLogViewer.FDataObject=this.FLogViewer}finally{this.FPageControl.EndUpdate()}},this.ChangePage=function(t,e,i){var s=rtl.createIntfRefs();try{s.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("log page changed previous = "+pas.SysUtils.TIntegerHelper.ToString$1.call({get:function(){return e},set:function(t){e=t}})+" current is "+pas.SysUtils.TIntegerHelper.ToString$1.call({get:function(){return i},set:function(t){i=t}}),this),this.ToolDeactivate(this.FPageControl.GetPages().GetTab(e)),this.ToolActivate(this.FPageControl.GetPages().GetTab(i))}finally{s.free()}},this.OnRepositorySet=function(t){null!=this.FSessionViewer&&this.FSessionViewer.AssignSession(this.RepositoryGet().FSession)},this.LogPanelShow=function(t){this.FpnlLog.FVisible?(t.SetText("Show Session"),this.FpnlLog.SetVisible(!1),this.ToolDeactivate(this.FPageControl.GetActivePage())):(t.SetText("Hide Session"),this.FpnlLog.SetVisible(!0),this.ToolActivate(this.FPageControl.GetActivePage()))},this.Create$3=function(t,e){return pas["WebLib.SERTTK.CVTypes"].TSECVDisplayBase.Create$2.call(this,t,e),this.PanelCreate(),this},this.Destroy=function(){rtl.free(this,"FLogViewer"),rtl.free(this,"FSessionViewer"),pas.System.TObject.Destroy.call(this)}})),rtl.createClass(this,"TSECVToolPageLayout",pas["WebLib.SERTTK.CVTypes"].TSECVToolPage,(function(){this.$init=function(){pas["WebLib.SERTTK.CVTypes"].TSECVToolPage.$init.call(this),this.FlytToolPage=null,this.FlytToolClient=null,this.FToolStatusBar=null,this.FSBTextMessage=null,this.FToolBarArea=null,this.FInspectorCVInfo=null},this.$final=function(){this.FlytToolPage=void 0,this.FlytToolClient=void 0,this.FToolStatusBar=void 0,this.FSBTextMessage=void 0,this.FToolBarArea=void 0,this.FInspectorCVInfo=void 0,pas["WebLib.SERTTK.CVTypes"].TSECVToolPage.$final.call(this)},this.CreateToolPageLayout=function(){this.FlytToolPage=pas["WebLib.SEFNC.Layout"].TSEFNCLayout.$create("Create$1",[this.FOwner]),this.FlytToolPage.SetParent(this.FToolPage.FContainer),this.FlytToolPage.SetAlign(pas["WebLib.SEFNC.Layout"].TSEFNCAlign.GetAlign(5)),this.MarginsSet(this.FlytToolPage),this.FToolBarArea=pas["WebLib.SERTTK.CVTypes"].TSECVToolArea.$create("Create$4",[this.FlytToolPage]),this.FToolBarArea.ColorSet(14150650),this.FlytToolClient=pas["WebLib.SEFNC.Layout"].TSEFNCLayout.$create("Create$1",[this.FOwner]),this.FlytToolClient.SetParent(this.FlytToolPage),this.FlytToolClient.SetAlign(pas["WebLib.SEFNC.Layout"].TSEFNCAlign.GetAlign(5)),this.MarginsSet(this.FlytToolClient),this.FToolStatusBar=pas["WEBLib.TMSFNCStatusBar"].TTMSFNCStatusBar.$create("Create$1",[this.FOwner]),this.FToolStatusBar.SetParent(this.FlytToolPage),this.FSBTextMessage=this.FToolStatusBar.FPanels.Add$1()},this.MarginsSet=function(t){t.FMargins.SetLeft(2),t.FMargins.SetRight(2),t.FMargins.SetTop(2),t.FMargins.SetBottom(2)},this.StatusMessage=function(t){this.FSBTextMessage.SetText(t)},this.Create$3=function(t){var e=rtl.createIntfRefs();try{try{this.FInspectorCVInfo=t,pas["WebLib.SERTTK.CVTypes"].TSECVToolPage.Create$2.call(this,this.FInspectorCVInfo.ToolPage),this.RepositorySet(this.FInspectorCVInfo.Repository),this.CreateToolPageLayout()}catch(t){if(pas.SysUtils.Exception.isPrototypeOf(t)){var i=t;throw e.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Warn$2("Failed to create tool page",i,this),pas["WebLib.SERTTK.CVTypes"].ECVToolPageLayoutCreateException.$create("Create$1",["Error Creating tool page layout"])}throw e.ref(2,pas["WebLib.SEFNC.Logger"].Logger()).Warn$1("Failed to create tool page",this),pas["WebLib.SERTTK.CVTypes"].ECVToolPageLayoutCreateException.$create("Create$1",["Error Creating tool page layout"])}}finally{e.free()}return this}})),rtl.createClass(this,"TSECVToolInstance",this.TSECVToolPageLayout,(function(){this.$init=function(){t.TSECVToolPageLayout.$init.call(this),this.FToolInfo=null,this.FInspectorCVInfo$1=null,this.FInitialized=!1},this.$final=function(){this.FToolInfo=void 0,this.FInspectorCVInfo$1=void 0,t.TSECVToolPageLayout.$final.call(this)},this.DoInitToolInstance=function(){var t=rtl.createIntfRefs();try{try{t.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("Begin Initialize Tool instance",this),this.InitToolInstance(),t.ref(2,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("End Initialize Tool instance",this),this.FInitialized=!0}catch(i){if(pas.SysUtils.Exception.isPrototypeOf(i)){var e=i;throw t.ref(3,pas["WebLib.SEFNC.Logger"].Logger()).Trace$2("Failure create tool instance "+this.DisplayName(),e,this),pas["WebLib.SERTTK.CVTypes"].ECVToolInstanceCreateException.$create("Create$1",["Error in Tool Initilization = "+this.DisplayName()])}throw t.ref(4,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("Failure create tool instance "+this.DisplayName(),this),pas["WebLib.SERTTK.CVTypes"].ECVToolInstanceCreateException.$create("Create$1",["Error in Tool Initilization = "+this.DisplayName()])}}finally{t.free()}},this.ToolActivate=function(){var t=rtl.createIntfRefs();try{t.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("Activate tool, base class",this)}finally{t.free()}},this.ToolDeactivate=function(){var t=rtl.createIntfRefs();try{t.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("De-activate tool, base class",this)}finally{t.free()}},this.DoToolActivate=function(){var t=rtl.createIntfRefs();try{try{this.FInitialized||this.DoInitToolInstance(),t.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("Begin activate tool",this),this.ToolActivate(),t.ref(2,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("End activate tool",this)}catch(i){if(pas.SysUtils.Exception.isPrototypeOf(i)){var e=i;t.ref(3,pas["WebLib.SEFNC.Logger"].Logger()).Trace$2("Failed tool activation",e,this)}else t.ref(4,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("Failed tool activation",this)}}finally{t.free()}},this.DoToolDeactivate=function(){var t=rtl.createIntfRefs();try{try{t.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("Begin activate tool",this),this.ToolDeactivate(),t.ref(2,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("End activate tool",this)}catch(i){if(pas.SysUtils.Exception.isPrototypeOf(i)){var e=i;t.ref(3,pas["WebLib.SEFNC.Logger"].Logger()).Trace$2("Failed tool activation",e,this)}else t.ref(4,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("Failed tool activation",this)}}finally{t.free()}},this.ExportToSession=function(){var t=rtl.createIntfRefs();try{t.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("Begin Export Tool Instance to session",this)}finally{t.free()}},this.DisplayName=function(){return"init","init"},this.Create$4=function(e,i){var s=rtl.createIntfRefs();try{this.FToolInfo=e,this.FInspectorCVInfo$1=i;try{s.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("Creating Tool instance",this),t.TSECVToolPageLayout.Create$3.call(this,this.FInspectorCVInfo$1)}catch(t){if(pas.SysUtils.Exception.isPrototypeOf(t)){var o=t;throw s.ref(2,pas["WebLib.SEFNC.Logger"].Logger()).Trace$2("Failure create tool instance "+this.DisplayName(),o,this),pas["WebLib.SERTTK.CVTypes"].ECVToolInstanceCreateException.$create("Create$1",["Error in Tool Initilization = "+this.DisplayName()])}throw s.ref(3,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("Failure create tool instance "+this.DisplayName(),this),pas["WebLib.SERTTK.CVTypes"].ECVToolInstanceCreateException.$create("Create$1",["Error in Tool Initilization = "+this.DisplayName()])}}finally{s.free()}return this}})),rtl.createClass(this,"TSERTTKRepoItemBinder",pas.System.TObject,(function(){this.$init=function(){pas.System.TObject.$init.call(this),this.FRepoItem=null,this.FTabControl=null,this.FTools=null,this.FInspectorTabs=null,this.FMarshalProxy=null,this.TreeNode=null,this.TabItem=null},this.$final=function(){this.FRepoItem=void 0,this.FTabControl=void 0,this.FTools=void 0,this.FInspectorTabs=void 0,this.FMarshalProxy=void 0,this.TreeNode=void 0,this.TabItem=void 0,pas.System.TObject.$final.call(this)},this.RepoItemGet=function(){return this.FRepoItem},this.BeforeChangePage=function(e,i,s,o){var n=null;null!==(n=this.FTabControl.GetPages().GetTab(i))&&null!==n.FDataObject&&t.TSECVToolInstance.isPrototypeOf(n.FDataObject)&&n.FDataObject.DoToolDeactivate(),null!==(n=this.FTabControl.GetPages().GetTab(s))&&null!==n.FDataObject&&t.TSECVToolInstance.isPrototypeOf(n.FDataObject)&&n.FDataObject.DoToolActivate()},this.TabControlSet=function(t){this.FTabControl=t,this.FTabControl.FOnBeforeChangePage=rtl.createCallback(this,"BeforeChangePage")},this.AddInspectorCVInfo=function(){var e;return e=t.TSERTTKInspectorCVInfo.$create("Create$1",[this.FMarshalProxy]),this.FInspectorTabs.Add(e),e},this.ActivateTab=function(){var e;null!==(e=this.FTabControl.GetActivePage())&&null!==e.FDataObject&&t.TSECVToolInstance.isPrototypeOf(e.FDataObject)&&e.FDataObject.DoToolActivate()},this.TabDisplayName=function(){return this.RepoItemGet().GetCompDisplayName()},this.Create$1=function(t,e){return this.FRepoItem=t,this.FMarshalProxy=e,this.FTools=pas["Generics.Collections"].TObjectDictionary$G11.$create("Create$5",[rtl.createSet(1)]),this.FInspectorTabs=pas["Generics.Collections"].TObjectList$G13.$create("Create$4",[!0]),this},this.Destroy=function(){rtl.free(this,"FTools"),rtl.free(this,"FInspectorTabs"),pas.System.TObject.Destroy.call(this)}})),rtl.createClass(this,"TSECVDetailPane",pas["WebLib.SERTTK.CVTypes"].TSECVDisplayBase,(function(){this.$init=function(){pas["WebLib.SERTTK.CVTypes"].TSECVDisplayBase.$init.call(this),this.FPC=null,this.FDefaultPage=0,this.FPageHistory=null,this.FDetailPageChange=null,this.FAppBinder=null,this.FRestoringInspectors=!1},this.$final=function(){this.FPC=void 0,this.FPageHistory=void 0,this.FDetailPageChange=void 0,this.FAppBinder=void 0,pas["WebLib.SERTTK.CVTypes"].TSECVDisplayBase.$final.call(this)},this.HistoryPreviousPage=function(){var t=0;return 0===this.FPageHistory.GetCount()?0:(t=this.FPageHistory.Pop(),this.FPC.GetPages().GetTab(t).FVisible||(t=this.HistoryPreviousPage()),t)},this.SetPageControlOptions=function(){this.FPC.FOptions.SetCloseMode(1),this.FPC.FOptions.FCloseAction=2,this.FPC.FOptions.SetTabListButton(!0),this.FPC.FInteraction.FSelectTabOnScroll=!1,this.FPC.FInteraction.FInsertTabWithKeyboard=!1,this.SetPageControlEvents()},this.SetPageControlEvents=function(){this.FPC.FOnClosePage=rtl.createCallback(this,"PCClosePage"),this.FPC.FOnChangePage=rtl.createCallback(this,"PCChangePage"),this.FPC.FOnBeforeClosePage=rtl.createCallback(this,"PCBeforeClosePage")},this.PCClosePage=function(t,e,i){var s=rtl.createIntfRefs();try{if(s.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Debug$1("Detail close page #"+pas.SysUtils.TIntegerHelper.ToString$1.call({get:function(){return e},set:function(t){e=t}}),this),null===this.FPC.GetPages().GetTab(e).FDataObject)return;this.OpenInspectorRemove(this.FPC.GetPages().GetTab(e).FDataObject)}finally{s.free()}},this.PCChangePage=function(e,i,s){s>-1?this.FPageHistory.Push(s):s=this.HistoryPreviousPage(),null!==this.FPC.GetPages().GetTab(s).FDataObject&&null!=this.FDetailPageChange&&s>-1&&t.TSERTTKRepoItemBinder.isPrototypeOf(this.FPC.GetPages().GetTab(s).FDataObject)&&this.FDetailPageChange(e,this.FPC.GetPages().GetTab(s).FDataObject)},this.PCBeforeClosePage=function(t,e,i){e===this.FDefaultPage&&i.set(0)},this.ActivatePage=function(e){var i=null,s=rtl.createIntfRefs();try{if(null===e)return void s.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Warn$1("Attempt to activate page with nil parameter",this);e.SetVisible(!0),e.SetVisible(!0),this.FPC.SetActivePage(e),null!==e.FDataObject&&t.TSERTTKRepoItemBinder.isPrototypeOf(e.FDataObject)&&(null===(i=e.FDataObject).FTabControl?(i.TabControlSet(pas["WEBLib.TMSFNCPageControl"].TTMSFNCPageControl.$create("Create$1",[this.FOwner])),i.FTabControl.SetParent(i.TabItem.FContainer),i.FTabControl.SetAlign(pas["WebLib.SEFNC.Layout"].TSEFNCAlign.GetAlign(5)),this.AddInstanceInspectors(i),i.ActivateTab()):s.ref(2,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("Instance pages already created",this))}finally{s.free()}},this.AddInstanceInspectors=function(t){var e=null,i=null,s=null,o=0,n=null,r=null,a=rtl.createIntfRefs();try{s=t.RepoItemGet().FToolInfos;for(var l=0,h=s.FLength-1;l<=h;l++)if(o=l,pas["WebLib.SERTTK.PluginTypes"].TSERTTKPluginInspectTool.isPrototypeOf(s.GetItem(o))){a.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("Begin add tool instance",this),r=s.GetItem(o),e=t.FTabControl.AddPage("");try{(n=t.AddInspectorCVInfo()).ToolPage=e,n.Repository=this.RepositoryGet(),i=r.TryInitToolUI(n),t.FTools.Add(n.ToolPage,i),n.ToolPage.SetText(i.DisplayName()),e.FDataObject=i,a.ref(2,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("End add tool instance = "+i.DisplayName(),this)}catch(i){if(pas["WebLib.SERTTK.CVTypes"].ECVToolPageLayoutCreateException.isPrototypeOf(i)){var F=i;t.FTabControl.RemovePage(e.GetIndex()),a.ref(3,pas["WebLib.SEFNC.Logger"].Logger()).Debug$2("Error Creating Layout for tool page : ",F,this)}else if(pas["WebLib.SERTTK.CVTypes"].ECVToolInstanceCreateException.isPrototypeOf(i)){F=i;t.FTabControl.RemovePage(e.GetIndex()),a.ref(4,pas["WebLib.SEFNC.Logger"].Logger()).Debug$2("Error Creating Tool instance : ",F,this)}else if(pas["WebLib.SERTTK.CVTypes"].ECVToolInitUIException.isPrototypeOf(i)){F=i;t.FTabControl.RemovePage(e.GetIndex()),a.ref(5,pas["WebLib.SEFNC.Logger"].Logger()).Debug$2("Error Init Tool instance : ",F,this)}else if(pas.SysUtils.Exception.isPrototypeOf(i)){F=i;t.FTabControl.RemovePage(e.GetIndex()),a.ref(6,pas["WebLib.SEFNC.Logger"].Logger()).Debug$2("Error adding page : ",F,this)}else t.FTabControl.RemovePage(e.GetIndex()),a.ref(7,pas["WebLib.SEFNC.Logger"].Logger()).Debug$1("Error adding page : ",this)}}else a.ref(8,pas["WebLib.SEFNC.Logger"].Logger()).Debug("Inspect Tool type check failed for "+s.GetItem(o).$classname)}finally{a.free()}},this.AddInstancePage=function(t){var e=rtl.createIntfRefs();try{if(0===t.RepoItemGet().FToolInfos.FLength)return void e.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Debug("No tools found to create tab");t.TabItem=this.FPC.AddPage(t.TabDisplayName()),t.TabItem.FDataObject=t,this.FRestoringInspectors||(this.OpenInspectorAdd(t),this.ActivatePage(t.TabItem))}finally{e.free()}},this.PageIsValid=function(t){var e=!1,i=rtl.createIntfRefs();try{e=!1,null!==t?(i.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("Tab Item Assigned, begin validate page control",this),null!==t.PageControl()?(i.ref(2,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("Page control is assigned",this),this.FPC.Equals(t.PageControl())?(i.ref(3,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("Page control is valid",this),e=!0):i.ref(4,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("Page control is not equal to control ",this)):i.ref(5,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("Page control is not assigned",this)):i.ref(6,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("Tab item is not assigned",this)}finally{i.free()}return e},this.OpenInspectorAdd=function(e){var i=rtl.createIntfRefs();try{if(!i.ref(1,t.MarshalMV()).MarshalOptions().FReOpenInspectors)return;if(null!==this.FAppBinder&&this.FAppBinder.Equals(e))return;i.ref(2,t.MarshalMV()).MarshalOptions().FOpenInspectors.Add(e.RepoItemGet().GetCompRestorePath()),i.ref(3,t.MarshalMV()).OpenInspectorsSave()}finally{i.free()}},this.OpenInspectorRemove=function(e){var i=0,s=rtl.createIntfRefs();try{if(!s.ref(1,t.MarshalMV()).MarshalOptions().FReOpenInspectors)return;s.ref(2,t.MarshalMV()).MarshalOptions().FOpenInspectors.Find(e.RepoItemGet().GetCompRestorePath(),{get:function(){return i},set:function(t){i=t}})&&(s.ref(3,t.MarshalMV()).MarshalOptions().FOpenInspectors.Delete(i),s.ref(4,t.MarshalMV()).OpenInspectorsSave())}finally{s.free()}},this.BeginRestoreInspectors=function(){this.FPC.FOnClosePage=null,this.FPC.FOnChangePage=null,this.FPC.FOnBeforeClosePage=null,this.FRestoringInspectors=!0},this.EndRestoreInspectors=function(){this.SetPageControlEvents(),this.FRestoringInspectors=!1},this.ActivateItem=function(t){var e=null,i=rtl.createIntfRefs();try{e=t.RepoItemGet(),this.PageIsValid(t.TabItem)?(this.ActivatePage(t.TabItem),i.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("Active item page change for "+e.GetCompDisplayName(),this)):0===e.FToolInfos.FLength?i.ref(2,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("No tools for component"+e.GetCompDisplayPath(),this):(i.ref(3,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("Begin page add for "+e.GetCompDisplayPath()+", Tool count"+pas.SysUtils.TNativeIntHelper.ToString$1.call({p:e.FToolInfos,get:function(){return this.p.FLength},set:function(t){this.p.FLength=t}}),this),this.AddInstancePage(t),i.ref(4,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("Inspector page added for "+e.GetCompDisplayPath()+", Tool count"+pas.SysUtils.TNativeIntHelper.ToString$1.call({p:e.FToolInfos,get:function(){return this.p.FLength},set:function(t){this.p.FLength=t}}),this))}finally{i.free()}},this.DelSupPage=function(t){var e=rtl.createIntfRefs();try{if(t===this.FAppBinder)return;null===t.TabItem?e.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Warn$1("Trying to Delete a page, but the binder has lost the map",this):(this.OpenInspectorRemove(t),this.FPC.RemovePage(t.TabItem.GetIndex()))}finally{e.free()}},this.SetApplicationPage=function(t){var e=rtl.createIntfRefs();try{this.FAppBinder=t,this.FRestoringInspectors=!0,this.AddInstancePage(this.FAppBinder),this.ActivateItem(this.FAppBinder),this.FRestoringInspectors=!1,this.FDefaultPage=t.TabItem.GetIndex(),t.TabItem.SetCloseButton(!1),e.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("Application page set complete",this)}finally{e.free()}},this.Create$3=function(t,e){var i=rtl.createIntfRefs();try{pas["WebLib.SERTTK.CVTypes"].TSECVDisplayBase.Create$2.call(this,t,e),this.FPC=pas["WEBLib.TMSFNCPageControl"].TTMSFNCPageControl.$create("Create$1",[this.FOwner]),this.FPC.SetParent(this.FLayout),this.FPC.SetAlign(pas["WebLib.SEFNC.Layout"].TSEFNCAlign.GetAlign(5)),this.FPC.SetName("ObjectInstancesPageCtrl"),this.FPageHistory=pas["Generics.Collections"].TStack$G2.$create("Create"),this.SetPageControlOptions(),i.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("Gui Component Insepctor page control created",this)}finally{i.free()}return this},this.Destroy=function(){rtl.free(this,"FPageHistory"),pas.System.TObject.Destroy.call(this)}})),rtl.createClass(this,"TSECVNavTree",pas["WebLib.SERTTK.CVTypes"].TSECVDisplayBase,(function(){this.$init=function(){pas["WebLib.SERTTK.CVTypes"].TSECVDisplayBase.$init.call(this),this.FMouseOverNode=null,this.FPM=null,this.FPopOptions=null,this.FAppNode=null,this.FAppBinder=null,this.FTV=null,this.FOnNodeSelected=null,this.FMarshalProxy=null,this.FOnNodeReloaded=null},this.$final=function(){this.FMouseOverNode=void 0,this.FPM=void 0,this.FPopOptions=void 0,this.FAppNode=void 0,this.FAppBinder=void 0,this.FTV=void 0,this.FOnNodeSelected=void 0,this.FMarshalProxy=void 0,this.FOnNodeReloaded=void 0,pas["WebLib.SERTTK.CVTypes"].TSECVDisplayBase.$final.call(this)},this.RefreshRootNode=function(t,e){try{this.FTV.RemoveNode(t),this.LoadRoot(e),null!=this.FOnNodeReloaded&&this.FOnNodeReloaded(this.FTV)}finally{this.FTV.EndUpdate()}},this.AddNavNode=function(e,i){var s=null,o=null,n=rtl.createIntfRefs();try{o=this.FTV.AddNode(e),s=n.ref(1,t.MarshalMV()).AddNavNode(i,o,this.FMarshalProxy),o.SetText(0,i.GetCompDisplayName()),o.SetText(1,i.GetCompRestorePath()),o.FDataObject=s}finally{n.free()}return s},this.NodeMouseEnter=function(e,i){var s=null,o=null,n=rtl.createIntfRefs();try{this.FMouseOverNode=i.FNode,this.FPopOptions.TryGetValue(pas["WebLib.SERTTK.CVTypes"].PMOptionDisplay[1],{get:function(){return s},set:function(t){s=t}})?null!==this.FMouseOverNode.FDataObject&&t.TSERTTKRepoItemBinder.isPrototypeOf(this.FMouseOverNode.FDataObject)&&null!==(o=this.FMouseOverNode.FDataObject).RepoItemGet()?s.FVisible=pas["WebLib.SERTTK.Repository"].TSESRepoForm.isPrototypeOf(o.RepoItemGet()):s.FVisible=!1:n.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Error$1("Menu option GOTO Active not in list??",this)}finally{n.free()}},this.LoadRoot=function(t){var e=null,i=rtl.createIntfRefs();try{try{i.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("Loading root to tree "+t.GetDisplayName(),this),(e=this.AddNavNode(this.FAppNode,t)).TreeNode.SetExpanded(!1),this.LoadLabels(t,e.TreeNode),this.LoadRepoItem(t,e.TreeNode)}catch(e){if(!pas.SysUtils.Exception.isPrototypeOf(e))throw e;i.ref(2,pas["WebLib.SEFNC.Logger"].Logger()).Debug$1("Loading Tree Root failed for :"+t.GetDisplayName(),this)}}finally{i.free()}},this.LoadAppInfo=function(){var e=rtl.createIntfRefs();try{this.FAppBinder=e.ref(1,t.MarshalMV()).AddNavNode(this.RepositoryGet().FAppRef,null,this.FMarshalProxy),this.FAppBinder.TreeNode=this.FTV.AddNode(null),this.FAppNode=this.FAppBinder.TreeNode,this.FAppNode.SetText(0,this.RepositoryGet().FAppRef.FAppName),this.FAppBinder.TreeNode.FDataObject=this.FAppBinder}finally{e.free()}},this.LoadLabels=function(t,e){var i=null,s=null,o=rtl.createIntfRefs();try{try{var n=t.FLabels.GetEnumerator$1();try{for(;n.MoveNext();)null!==(s=n.DoGetCurrent())&&((i=this.FTV.AddNode(e)).SetText(0,s.GetText1()),s.FChildren.FLength>0&&this.LoadRepoItem(s,i))}finally{n=rtl.freeLoc(n)}}catch(t){if(!pas.SysUtils.Exception.isPrototypeOf(t))throw t;var r=t;o.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Debug("error loading labels:"+e.GetText(0)+" error="+r.FMessage)}}finally{o.free()}},this.LoadRepoItem=function(t,e){var i=null,s=null,o=rtl.createIntfRefs();try{try{var n=t.FChildren.GetEnumerator$1();try{for(;n.MoveNext();)null===(i=n.DoGetCurrent())?o.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Debug$1(e.GetText(0)+" path="+e.GetText(1)+" null object on add sub comp",this):(s=this.AddNavNode(e,i),this.LoadLabels(i,s.TreeNode),i.FChildren.FLength>0&&this.LoadRepoItem(i,s.TreeNode))}finally{n=rtl.freeLoc(n)}}catch(t){if(!pas.SysUtils.Exception.isPrototypeOf(t))throw t;o.ref(2,pas["WebLib.SEFNC.Logger"].Logger()).Debug$1("Loading Tree Items failed for :"+e.GetText(0),this)}}finally{o.free()}},this.FilterSelect=function(t,e,i){this.FTV.ExpandAll()},this.Popup=function(e){var i=null,s=null,o=rtl.createIntfRefs();try{null!==this.FMouseOverNode.FDataObject&&t.TSERTTKRepoItemBinder.isPrototypeOf(this.FMouseOverNode.FDataObject)?(s=this.FMouseOverNode.FDataObject,pas["WebLib.SERTTK.Repository"].TSESRepoForm.isPrototypeOf(s.RepoItemGet())&&this.FPopOptions.TryGetValue(pas["WebLib.SERTTK.CVTypes"].PMOptionDisplay[1],{get:function(){return i},set:function(t){i=t}})?s.RepoItemGet().HasActive()&&(this.FocusedInTree(s.RepoItemGet().FRefObject)?i.SetEnabled(!0):(i.SetEnabled(!1),i.FHint="Needs refresh")):o.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Warn$1("Go To is not showing",this)):o.ref(2,pas["WebLib.SEFNC.Logger"].Logger()).Warn$1("Tree node without data object mapped",this)}finally{o.free()}},this.PopupOnClick=function(e){var i=null,s=null,o=null,n=rtl.createIntfRefs();try{if(n.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Debug$1("Nav tree Pop Menu Item clicked",this),null===this.FMouseOverNode.FDataObject||!t.TSERTTKRepoItemBinder.isPrototypeOf(this.FMouseOverNode.FDataObject))return void n.ref(2,pas["WebLib.SEFNC.Logger"].Logger()).Warn$1("Tree item not bound to binder",this);o=this.FMouseOverNode.FDataObject.RepoItemGet();var r=e.FTag;0===r?n.ref(3,pas["WebLib.SEFNC.Logger"].Logger()).Debug$1("path for object = "+o.RefObjPath(),this):1===r?(n.ref(4,pas["WebLib.SEFNC.Logger"].Logger()).Debug$1("Go To Active",this),pas["WebLib.SERTTK.Repository"].TSESRepoForm.isPrototypeOf(o)&&(i=o).HasActive()&&this.NodeByObject(i.ActiveControl(),{get:function(){return s},set:function(t){s=t}})&&(null!=s.TreeNode?(this.ExpandToNode(s.TreeNode,!0,!0),null!=this.FOnNodeSelected&&this.FOnNodeSelected(this.FTV,s.TreeNode)):n.ref(5,pas["WebLib.SEFNC.Logger"].Logger()).Debug$1("Active not not in tree, rediscover",this))):2===r&&(pas["WebLib.SERTTK.Repository"].TSESAppReference.isPrototypeOf(o)?n.ref(6,pas["WebLib.SEFNC.Logger"].Logger()).Warn$1("App Refresh Not supported",this):pas["WebLib.SERTTK.Repository"].TSESRepoRoot.isPrototypeOf(o)?this.RefreshRepoRoot(this.FMouseOverNode):n.ref(7,pas["WebLib.SEFNC.Logger"].Logger()).Debug$1("Refresh called for unknown type",this))}finally{n.free()}},this.LoadPopupOptions=function(){var t=0,e=null,i=rtl.createIntfRefs();try{for(t=0;t<=2;t++)e=pas["WEBLib.Menus"].TMenuItem.$create("Create$1",[this.FPM]),this.FPM.FItems.Add(e),e.SetCaption(pas["WebLib.SERTTK.CVTypes"].PMOptionDisplay[t]),e.FTag=t,this.FPopOptions.Add(pas["WebLib.SERTTK.CVTypes"].PMOptionDisplay[t],e),e.FOnClick=rtl.createCallback(this,"PopupOnClick"),i.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("Pop option loaded ="+pas["WebLib.SERTTK.CVTypes"].PMOptionDisplay[t],this);i.ref(2,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("Pop options loaded complete",this)}finally{i.free()}},this.FocusedInTree=function(t){var e=!1,i=null;return(e=this.NodeByObject(t,{get:function(){return i},set:function(t){i=t}}))&&(e=null!=i.TreeNode),e},this.RefreshRepoRoot=function(t){var e=null,i=rtl.createIntfRefs();try{if(!pas["WebLib.SERTTK.Repository"].TSESRepoRoot.isPrototypeOf(t.FDataObject.RepoItemGet()))throw pas.SysUtils.Exception.$create("Create$1",["Incorrect type for refresh"]);e=t.FDataObject.RepoItemGet(),i.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("Begin Root refresh child count = "+pas.SysUtils.TNativeIntHelper.ToString$1.call({p:e.FChildren,get:function(){return this.p.FLength},set:function(t){this.p.FLength=t}}),this),this.RepositoryGet().ReloadRepoRoot(e)?this.RefreshRootNode(t,e):i.ref(2,pas["WebLib.SEFNC.Logger"].Logger()).Warn$1("Failed to refresh root node "+t.GetText(0),this),i.ref(3,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("End Root refresh child count = "+pas.SysUtils.TNativeIntHelper.ToString$1.call({p:e.FChildren,get:function(){return this.p.FLength},set:function(t){this.p.FLength=t}}),this)}finally{i.free()}},this.AssignMarshalProxy=function(t){this.FMarshalProxy=t},this.DetailTabChanged=function(t,e){var i=rtl.createIntfRefs();try{if(null===e)return;null===e.TreeNode?i.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Warn$1("Tab has lost node association",this):this.ExpandToNode(e.TreeNode,!0,!0)}finally{i.free()}},this.ExpandToNode=function(t,e,i){var s=null;for(this.FTV.RemoveFilters(),s=t.GetParent();null!=s;)s.Expand(!1),s=s.GetParent();e&&this.FTV.ScrollToNode(t,!0,2,!0),i&&this.FTV.SelectNode(t)},this.LoadTreeFromModel=function(){var t=null;this.FTV.BeginUpdate();try{this.LoadAppInfo();var e=this.RepositoryGet().FAppRef.FRoots.GetEnumerator$1();try{for(;e.MoveNext();)t=e.DoGetCurrent(),this.LoadRoot(t)}finally{e=rtl.freeLoc(e)}this.FAppNode.SetExpanded(!0),this.FTV.FColumns.GetItem$1(0).Sort(!0,!1,0)}finally{this.FTV.EndUpdate()}},this.NodeByObject=function(e,i){var s=!1,o=rtl.createIntfRefs();try{s=o.ref(1,t.MarshalMV()).NavNodeByObject(e,i)}finally{o.free()}return s},this.NodeByPath=function(t,e){var i=!1,s=rtl.createIntfRefs();try{i=!1;try{e.set(this.FTV.FindNodeByTextAndColumn(t,1,!0,!1)),i=null!==e.get()}catch(e){if(!pas.SysUtils.Exception.isPrototypeOf(e))throw e;var o=e;s.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Error$2("failure finding node "+t+" by path ",o,this)}}finally{s.free()}return i},this.Create$3=function(t,e){return pas["WebLib.SERTTK.CVTypes"].TSECVDisplayBase.Create$2.call(this,t,e),this.FPopOptions=pas["Generics.Collections"].TDictionary$G17.$create("Create$1",[0]),this.FTV=pas["WEBLib.TMSFNCTreeView"].TTMSFNCTreeView.$create("Create$1",[this.FOwner]),this.FTV.SetParent(this.FLayout),this.FTV.SetAlign(pas["WebLib.SEFNC.Layout"].TSEFNCAlign.GetAlign(5)),this.FTV.SetName("NavTree"),this.FTV.FGlobalFont.SetSize(10),this.FPM=pas["WEBLib.Menus"].TWebPopupMenu.$create("Create$1",[this.FOwner]),this.FPM.SetParent(this.FOwner),this.FPM.FOnPopup=rtl.createCallback(this,"Popup"),this.LoadPopupOptions(),this.FTV.BeginUpdate(),this.FTV.ClearNodeList(),this.FTV.FColumns.Clear(),this.FTV.FNodes.Clear(),this.FTV.FColumns.Add$1(),this.FTV.FColumns.GetItem$1(0).SetText("Structure View"),this.FTV.FColumns.GetItem$1(0).FFiltering.SetEnabled(!0),this.FTV.FColumns.Add$1(),this.FTV.FColumns.GetItem$1(1).SetText("Component path"),this.FTV.FColumns.GetItem$1(1).SetVisible(!1),this.FTV.FOnNodeMouseEnter=rtl.createCallback(this,"NodeMouseEnter"),this.FTV.FPopupMenu=this.FPM,this.FTV.EndUpdate(),this.FTV.FOnFilterSelect=rtl.createCallback(this,"FilterSelect"),this.FTV.FColumns.GetItem$1(0).FFiltering.FDropDownWidth=220,this.FTV.SetShowHint(!0),this},this.Destroy=function(){pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FPopOptions},set:function(t){this.p.FPopOptions=t}}),pas.System.TObject.Destroy.call(this)}})),rtl.createClass(this,"TSERTTKMarshalForm",pas["WEBLib.Forms"].TForm,(function(){this.$init=function(){pas["WEBLib.Forms"].TForm.$init.call(this),this.FOwner$1=null,this.FRunLevelManager=null,this.pnlMarshal=null,this.FlytLeft=null,this.FsplitR=null,this.FlytClient=null,this.FlytMain=null,this.FlytStatus=null,this.FSBSETools=null,this.FSBTextMessage=null,this.FToolBar=null,this.FTreeDisp=null,this.FPageDisp=null,this.FLogPanel=null,this.FAppBinder=null,this.FMarshalProxy=null,this.FBookmarkDialog=null},this.$final=function(){this.FOwner$1=void 0,this.FRunLevelManager=void 0,this.pnlMarshal=void 0,this.FlytLeft=void 0,this.FsplitR=void 0,this.FlytClient=void 0,this.FlytMain=void 0,this.FlytStatus=void 0,this.FSBSETools=void 0,this.FSBTextMessage=void 0,this.FToolBar=void 0,this.FTreeDisp=void 0,this.FPageDisp=void 0,this.FLogPanel=void 0,this.FAppBinder=void 0,this.FMarshalProxy=void 0,this.FBookmarkDialog=void 0,pas["WEBLib.Forms"].TForm.$final.call(this)},this.SupFormCaption=function(){return t.txt_form_prefix+"WEB"+t.txt_form_version},this.SizeForm=function(){var e=rtl.createIntfRefs();try{null!=e.ref(1,t.MarshalMV()).MarshalOptions()?(this.SetWidth(e.ref(2,t.MarshalMV()).MarshalOptions().FFormWidth),this.SetHeight(e.ref(3,t.MarshalMV()).MarshalOptions().FFormHeight)):(this.SetWidth(960),this.SetHeight(960))}finally{e.free()}},this.CreateRunLevels=function(){this.FRunLevelManager=pas["WebLib.SEFNC.RunLevelTypes"].TSEFNCRunLevelManager.$create("Create$2",[this]),this.FRunLevelManager.HeaderTextSet("Marshal Initialization"),this.FRunLevelManager.AddLevel("Create Layouts",rtl.createCallback(this,"RLCreateLayouts")),this.FRunLevelManager.AddLevel("Create Status Bar",rtl.createCallback(this,"RLCreateStatusBar")),this.FRunLevelManager.AddLevel("Create LogPanel",rtl.createCallback(this,"RLCreateLogPanel")),this.FRunLevelManager.AddLevel("Create Tree Control",rtl.createCallback(this,"RLCreateTreeDisp")),this.FRunLevelManager.AddLevel("Create Page control",rtl.createCallback(this,"RLCreatePageDisp")),this.FRunLevelManager.AddLevel("Assign Marshal Proxy",rtl.createCallback(this,"RLAssignProxy")),this.FRunLevelManager.AddLevel("Bind Repository",rtl.createCallback(this,"RLBindRepository")),this.FRunLevelManager.AddLevel("Restore Inspectors",rtl.createCallback(this,"RLRestoreInspectors")),this.FRunLevelManager.AddLevel("Show Marshal Panel",rtl.createCallback(this,"RLShowMarshal")),this.FRunLevelManager.InitStart()},this.RLAssignProxy=function(){this.FMarshalProxy=t.TSERTTKMarshalProxy.$create("Create$1",[this]),this.FTreeDisp.AssignMarshalProxy(this.FMarshalProxy)},this.RLBindRepository=function(){var t=rtl.createIntfRefs();try{this.BindRepository()?(t.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Info$1("Repo Bind Complete",this),this.InitializeAppTools(),this.StatusTextSet("Support Tools Ready")):this.StatusTextSet("Failed in Repository")}finally{t.free()}},this.RLCreateLayouts=function(){this.pnlMarshal=pas["WebLib.SEFNC.Layout"].TSEFNCLayout.$create("Create$1",[this]),this.pnlMarshal.SetParent(this),this.pnlMarshal.SetAlignment$1(5),this.pnlMarshal.SetName("MarshalContainerPanel"),this.pnlMarshal.SetVisible(!1),this.FToolBar=pas["WebLib.SERTTK.CVTypes"].TSECVToolArea.$create("Create$4",[this.pnlMarshal]),this.FToolBar.NewButton("Show Session"),this.FToolBar.NewButton$1("Bookmark",rtl.createCallback(this,"ShowAddBookmark")),this.FToolBar.HelpLinkSet("Constable"),this.FlytStatus=pas["WebLib.SEFNC.Layout"].TSEFNCLayout.$create("Create$1",[this.FOwner$1]),this.FlytStatus.SetParent(this.pnlMarshal),this.FlytStatus.SetAlignment$1(2),this.FlytStatus.SetHeight(24),this.FlytStatus.SetName("LytStatus"),this.FlytMain=pas["WebLib.SEFNC.Layout"].TSEFNCLayout.$create("Create$1",[this.FOwner$1]),this.FlytMain.SetParent(this.pnlMarshal),this.FlytMain.SetAlignment$1(5),this.FlytMain.SetName("LytMain"),this.FlytLeft=pas["WebLib.SEFNC.Layout"].TSEFNCLayout.$create("Create$1",[this.FOwner$1]),this.FlytLeft.SetParent(this.FlytMain),this.FlytLeft.SetAlignment$1(3),this.FlytLeft.SetWidth(200),this.FlytLeft.SetName("LytLeft"),this.FsplitR=pas["WEBLib.TMSFNCSplitter"].TTMSFNCSplitter.$create("Create$1",[this.FOwner$1]),this.FsplitR.SetParent(this.FlytMain),this.FsplitR.SetWidth(6),this.FlytClient=pas["WebLib.SEFNC.Layout"].TSEFNCLayout.$create("Create$1",[this.FOwner$1]),this.FlytClient.SetParent(this.FlytMain),this.FlytClient.SetAlignment$1(5),this.FlytClient.SetName("LytClient")},this.RLCreateLogPanel=function(){this.FLogPanel=t.TSECVLogPanel.$create("Create$3",[this.pnlMarshal,this.FOwner$1]),this.FToolBar.ButtonByName("Show Session").FOnClick=rtl.createCallback(this.FLogPanel,"LogPanelShow")},this.RLCreatePageDisp=function(){this.FPageDisp=t.TSECVDetailPane.$create("Create$3",[this.FlytClient,this.FOwner$1])},this.RLCreateStatusBar=function(){this.FSBSETools=pas["WEBLib.TMSFNCStatusBar"].TTMSFNCStatusBar.$create("Create$1",[this.FOwner$1]),this.FSBSETools.SetParent(this.FlytStatus),this.FSBSETools.SetAlign(pas["WebLib.SEFNC.Layout"].TSEFNCAlign.GetAlign(5)),this.FSBTextMessage=this.FSBSETools.FPanels.Add$1(),this.FSBTextMessage.SetText("status bar text")},this.RLCreateTreeDisp=function(){this.FTreeDisp=t.TSECVNavTree.$create("Create$3",[this.FlytLeft,this.FOwner$1])},this.RLRestoreInspectors=function(){this.TryReOpenInspectors()},this.RLShowMarshal=function(){this.FTreeDisp.FTV.FOnNodeClick=rtl.createCallback(this,"tvNodeClick"),this.FTreeDisp.FOnNodeSelected=rtl.createSafeCallback(this,"tvNodeSelected"),this.FPageDisp.FDetailPageChange=rtl.createSafeCallback(this,"DetailTabChanged"),this.pnlMarshal.SetVisible(!0)},this.MarshalOptions=function(){var e=null,i=rtl.createIntfRefs();try{e=i.ref(1,t.MarshalMV()).MarshalOptions()}finally{i.free()}return e},this.ShowAppNode=function(){var e=rtl.createIntfRefs();try{if(this.FPageDisp.ActivateItem(this.FPageDisp.FAppBinder),!e.ref(1,t.MarshalMV()).AppInfoSaved()){var i=this.FPageDisp.FAppBinder.FTools.GetValues().GetEnumerator$1();try{for(;i.MoveNext$1();)i.GetCurrent().ExportToSession()}finally{i=rtl.freeLoc(i)}e.ref(2,t.MarshalMV()).AppInfoSavedSet()}}finally{e.free()}},this.StatusTextSet=function(t){this.FSBTextMessage.SetText(t)},this.BindRepository=function(){var e=!1,i=rtl.createIntfRefs();try{e=!1;try{i.ref(1,t.MarshalMV()).ClearNavNodes(),i.ref(2,pas["WebLib.SEFNC.Logger"].Logger()).Debug$1("Repository created Succesfully",this),this.StatusTextSet("Repository created Succesfully"),this.FTreeDisp.RepositorySet(i.ref(3,t.MarshalMV()).Repository()),this.FPageDisp.RepositorySet(i.ref(4,t.MarshalMV()).Repository()),this.FLogPanel.RepositorySet(i.ref(5,t.MarshalMV()).Repository()),i.ref(6,pas["WebLib.SEFNC.Logger"].Logger()).Debug$1("Control Views assigned to repository",this),this.StatusTextSet("Control Views assigned to repository"),this.FTreeDisp.LoadTreeFromModel(),this.FTreeDisp.FOnNodeReloaded=rtl.createSafeCallback(this,"ValidateToolTabs"),this.StatusTextSet("Repository Loaded"),i.ref(7,pas["WebLib.SEFNC.Logger"].Logger()).Debug$1("Repository loaded",this),e=!0}catch(t){if(pas.SysUtils.Exception.isPrototypeOf(t)){var s=t;i.ref(8,pas["WebLib.SEFNC.Logger"].Logger()).Error$1("Failure binding repo to tree "+s.FMessage,this)}else i.ref(9,pas["WebLib.SEFNC.Logger"].Logger()).Error$1("Failure binding Repo to Tree",this)}}finally{i.free()}return e},this.InitializeAppTools=function(){var t=rtl.createIntfRefs();try{try{null===this.FTreeDisp.FAppBinder?t.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Error$1("App binder invalid, abort",this):(this.FAppBinder=this.FTreeDisp.FAppBinder,t.ref(2,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("App binder valid, showing page",this),this.FPageDisp.SetApplicationPage(this.FAppBinder),this.ShowAppNode())}catch(i){if(pas.SysUtils.Exception.isPrototypeOf(i)){var e=i;t.ref(3,pas["WebLib.SEFNC.Logger"].Logger()).Warn$1("Failed app tool init : "+e.FMessage,this)}else t.ref(4,pas["WebLib.SEFNC.Logger"].Logger()).Warn$1("Failed app tool init",this)}}finally{t.free()}},this.NodeClickActions=function(e){var i=null,s=null,o=rtl.createIntfRefs();try{try{null!==e?null!==e.FDataObject&&t.TSERTTKRepoItemBinder.isPrototypeOf(e.FDataObject)?null===(i=e.FDataObject).RepoItemGet()?o.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("Repo Item nil for node click, aborting",this):(s=i.RepoItemGet(),pas["WebLib.SERTTK.Repository"].TSESAppReference.isPrototypeOf(s)?this.StatusTextSet(s.FAppName):this.StatusTextSet(s.GetCompDisplayPath()),this.FPageDisp.ActivateItem(i)):o.ref(2,pas["WebLib.SEFNC.Logger"].Logger()).Debug$1("Data object not Item Binder "+e.GetText(0),this):o.ref(3,pas["WebLib.SEFNC.Logger"].Logger()).Debug$1("Tree node not assigned for click actions",this)}catch(t){if(pas.SysUtils.Exception.isPrototypeOf(t)){var n=t;o.ref(4,pas["WebLib.SEFNC.Logger"].Logger()).Trace$2("Node out of state, not in repo",n,this)}else o.ref(5,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("Node out of state, not in repo",this)}}finally{o.free()}},this.tvNodeSelected=function(t,e){var i=rtl.createIntfRefs();try{null!==e.FDataObject?this.NodeClickActions(e):i.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Warn$1("Node Selected - Dataobject nil for "+e.GetText(0),this)}finally{i.free()}},this.tvNodeClick=function(t,e){var i=rtl.createIntfRefs();try{null!==e.FNode.FDataObject?this.NodeClickActions(e.FNode):i.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Warn$1("Node Clicked - Dataobject nil for "+e.FNode.GetText(0),this)}finally{i.free()}},this.DetailTabChanged=function(t,e){var i=rtl.createIntfRefs();try{if(null===e)return;this.FTreeDisp.DetailTabChanged(t,e),null!==this.FTreeDisp.FTV.GetFocusedNode()?null!==e.TreeNode&&this.FTreeDisp.FTV.GetFocusedNode()===e.TreeNode?this.NodeClickActions(this.FTreeDisp.FTV.GetFocusedNode()):i.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Debug$1("Selected node does not match tab, aborting actions",this):i.ref(2,pas["WebLib.SEFNC.Logger"].Logger()).Debug$1("Tab changed, but no node selected",this)}finally{i.free()}},this.ValidateToolTabs=function(e){var i=null,s=null,o=rtl.createIntfRefs();try{s=pas["Generics.Collections"].TList$G23.$create("Create$1");try{if(o.ref(1,t.MarshalMV()).InvalidPages({get:function(){return s},set:function(t){s=t}})){var n=s.GetEnumerator$1();try{for(;n.MoveNext();)i=n.DoGetCurrent(),this.FPageDisp.DelSupPage(i)}finally{n=rtl.freeLoc(n)}}}finally{s=rtl.freeLoc(s)}}finally{o.free()}},this.TryReOpenInspectors=function(){var e=rtl.createIntfRefs();try{this.MarshalOptions().FReOpenInspectors?(this.StatusTextSet("Reopening inspectors"),e.ref(1,t.MarshalMV()).OpenInspectorsLoad()&&(this.FPageDisp.BeginRestoreInspectors(),this.OpenInspectorsRestorePages(),this.FPageDisp.EndRestoreInspectors())):this.StatusTextSet("Inspectors Closed")}finally{e.free()}},this.OpenInspectorsRestorePages=function(){var e="",i=null,s=null,o=0,n=rtl.createIntfRefs();try{s=pas.Classes.TStringList.$create("Create$1");try{try{var r=this.MarshalOptions().FOpenInspectors.GetEnumerator();try{for(;r.MoveNext();)e=r.GetCurrent(),this.FTreeDisp.NodeByPath(e,{get:function(){return i},set:function(t){i=t}})?(n.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Debug$1(pas.SysUtils.Format("Restoring %s Inspector node = %s : %s",pas.System.VarRecs(18,e,18,i.GetText(0),18,i.GetText(1))),this),this.FTreeDisp.ExpandToNode(i,!0,!0),this.NodeClickActions(i)):(n.ref(2,pas["WebLib.SEFNC.Logger"].Logger()).Debug$1("Restore failed "+e+" Inspector",this),s.Add(e))}finally{r=rtl.freeLoc(r)}var a=s.GetEnumerator();try{for(;a.MoveNext();)e=a.GetCurrent(),n.ref(3,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("Removing inspector for restore "+e,this),this.MarshalOptions().FOpenInspectors.Find(e,{get:function(){return o},set:function(t){o=t}})?this.MarshalOptions().FOpenInspectors.Delete(o):n.ref(4,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("Remove failed for restore inspector "+e,this)}finally{a=rtl.freeLoc(a)}n.ref(5,t.MarshalMV()).OpenInspectorsSave()}catch(t){if(!pas.SysUtils.Exception.isPrototypeOf(t))throw t;var l=t;n.ref(6,pas["WebLib.SEFNC.Logger"].Logger()).Debug$2("Failed restore inspectors ",l,this)}}finally{s=rtl.freeLoc(s)}}finally{n.free()}},this.BookmarkDialogResult=function(e){var i=null,s=rtl.createIntfRefs();try{try{this.FBookmarkDialog.FTag$1=e,1===this.FBookmarkDialog.FTag$1&&(i=pas["WebLib.SERTTK.Session"].TSESSessionBookmark.$create("Create$3",[this.FBookmarkDialog.FInputText]),s.ref(1,t.MarshalMV()).Repository().FSession.AddBookmark(i))}catch(t){if(!pas.SysUtils.Exception.isPrototypeOf(t))throw t;s.ref(2,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("Error adding bookmark",this)}}finally{s.free()}},this.ShowAddBookmark=function(t){null===this.FBookmarkDialog&&(this.FBookmarkDialog=pas["WEBLib.TMSFNCTaskDialog"].TTMSFNCTaskDialog.$create("Create$1",[this.FOwner$1])),this.FBookmarkDialog.SetInputType(0),this.FBookmarkDialog.SetInstruction("Enter bookmark description here"),this.FBookmarkDialog.SetCommonButtons(rtl.createSet(0,3)),this.FBookmarkDialog.SetTitle("Add Session Bookmark"),this.FBookmarkDialog.Execute(rtl.createCallback(this,"BookmarkDialogResult"))},this.DoComponentActivate=function(t){var e=null;this.FTreeDisp.NodeByObject(t,{get:function(){return e},set:function(t){e=t}})&&(this.FTreeDisp.ExpandToNode(e.TreeNode,!0,!0),this.NodeClickActions(e.TreeNode))},this.WebFormCreate=function(t){window.console.log("Web Form Create called"),this.CreateRunLevels()},this.Create$7=function(t){return this.FOnCreate=rtl.createCallback(this,"WebFormCreate"),pas["WEBLib.Forms"].TCustomForm.CreateNew.call(this,t,0),this.FOwner$1=this,this.SizeForm(),this.FOnDestroy=rtl.createCallback(this,"formDestroy"),this.SetCaption(this.SupFormCaption()),this.SetName(pas["WebLib.SERTTK.Repository"].SupFormName),this.FFont.SetName("Tahoma"),this.FFont.SetSize(10),this.FPopup=!0,this.SetBorder(4),this},this.formDestroy=function(t){rtl.free(this,"FToolBar"),rtl.free(this,"FLogPanel"),rtl.free(this,"FTreeDisp"),rtl.free(this,"FPageDisp"),rtl.free(this,"FMarshalProxy")},rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TSERTTKMarshalProxy",pas.System.TObject,(function(){this.$init=function(){pas.System.TObject.$init.call(this),this.FMarshalForm=null},this.$final=function(){this.FMarshalForm=void 0,pas.System.TObject.$final.call(this)},this.Create$1=function(t){return this.FMarshalForm=t,this},this.ObjectInTree=function(t){var e=null;return this.FMarshalForm.FTreeDisp.NodeByObject(t,{get:function(){return e},set:function(t){e=t}})},this.SwitchToObject=function(t){this.FMarshalForm.DoComponentActivate(t)}})),rtl.createInterface(this,"ISERTTKMarshalMV","{D29A96B7-71DE-45FF-8D79-32177DAF463C}",["NavNodeByObject","AddNavNode","InvalidPages","Repository","MarshalOptions","ClearNavNodes","OpenInspectorsSave","OpenInspectorsLoad","AppInfoSaved","AppInfoSavedSet"],pas.System.IUnknown),this.MarshalMV=function(){var e=null,i=!1;try{e=rtl.setIntfL(e,t.TSERTTKMarshalMVFactory.FMarshalMV),i=!0}finally{i||rtl._Release(e)}return e},rtl.createClass(this,"TSERTTKMarshalMVFactory",pas.System.TObject,(function(){this.FMarshalMV=null})),rtl.createClass(this,"TSERTTKMarshalMV",pas.System.TInterfacedObject,(function(){this.$init=function(){pas.System.TInterfacedObject.$init.call(this),this.FRepoItemDetailTabs=null,this.FObjectNavNodes=null,this.FRepository=null,this.FAppInfoSaved=!1,this.FMarshalOptions=null,this.FWebLocalStorage=null},this.$final=function(){this.FRepoItemDetailTabs=void 0,this.FObjectNavNodes=void 0,this.FRepository=void 0,this.FMarshalOptions=void 0,this.FWebLocalStorage=void 0,pas.System.TInterfacedObject.$final.call(this)},this.OpenInspectorsFilename=function(){return null===this.FRepository?"noRepo":"Marshal_open_inspectors_"+this.FRepository.FSession.ApplicationNameGet()},this.Create$1=function(){var e=rtl.createIntfRefs();try{this.ClearNavNodes(),this.FMarshalOptions=t.TSERTTKMarshalOptions.$create("Create$1",[!0]),e.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Debug$1("Model view Created",this),this.FWebLocalStorage=pas["WEBLib.Storage"].TWebLocalStorage.$create("Create$1",[null])}finally{e.free()}return this},this.Destroy=function(){rtl.free(this,"FRepoItemDetailTabs"),rtl.free(this,"FObjectNavNodes"),rtl.free(this,"FMarshalOptions"),rtl.free(this,"FWebLocalStorage"),pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FRepository},set:function(t){this.p.FRepository=t}}),pas.System.TObject.Destroy.call(this)},this.Repository=function(){return null===this.FRepository&&(this.FRepository=pas["WebLib.SERTTK.Repository"].TSESRepository.$create("Create$1",[this.FMarshalOptions.FPersistentStore]),this.FRepository.ReloadRepository()),this.FRepository},this.NavNodeByObject=function(t,e){var i=!1,s=rtl.createIntfRefs();try{(i=this.FObjectNavNodes.TryGetValue(t,e))?s.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("NavNodebyObject : Found Nav Node Object",this):s.ref(2,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("NavNodebyObject : Missing Nav Node Object, Object in tree without binder"+t.$classname,this)}finally{s.free()}return i},this.NavNodeByRepoItem=function(t,e){var i=!1,s=rtl.createIntfRefs();try{(i=this.FObjectNavNodes.TryGetValue(t.FRefObject,e))?s.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("NavNodeByRepoItem : Found Nav Node Object",this):s.ref(2,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("NavNodeByRepoItem : Missing Nav Node Object",this)}finally{s.free()}return i},this.AddNavNode=function(e,i,s){var o=null,n=rtl.createIntfRefs();try{this.FObjectNavNodes.TryGetValue(e.FRefObject,{get:function(){return o},set:function(t){o=t}})?n.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("Node retreived",this):(o=t.TSERTTKRepoItemBinder.$create("Create$1",[e,s]),this.FRepoItemDetailTabs.Add(e,o),this.FObjectNavNodes.Add(e.FRefObject,o)),o.TreeNode=i}finally{n.free()}return o},this.InvalidPages=function(t){var e=!1,i=null,s=null,o=null,n=rtl.createIntfRefs();try{var r=this.FRepoItemDetailTabs.GetKeys().GetEnumerator$1();try{for(;r.MoveNext$1();)o=r.GetCurrent(),n.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Debug$1("Checking tool tab ",this),this.FRepoItemDetailTabs.TryGetValue(o,{get:function(){return i},set:function(t){i=t}})&&(this.NavNodeByRepoItem(i.RepoItemGet(),{get:function(){return s},set:function(t){s=t}})?null===i.TreeNode&&(i.TreeNode=s.TreeNode):(n.ref(2,pas["WebLib.SEFNC.Logger"].Logger()).Debug$1("Node not found for component",this),t.get().Add(i),this.FRepoItemDetailTabs.Remove(o)))}finally{r=rtl.freeLoc(r)}e=t.get().FLength>0}finally{n.free()}return e},this.MarshalOptions=function(){return this.FMarshalOptions},this.ClearNavNodes=function(){null!==this.FObjectNavNodes&&rtl.free(this,"FObjectNavNodes"),this.FObjectNavNodes=pas["Generics.Collections"].TDictionary$G19.$create("Create$1",[0]),null!==this.FRepoItemDetailTabs&&rtl.free(this,"FRepoItemDetailTabs"),this.FRepoItemDetailTabs=pas["Generics.Collections"].TObjectDictionary$G12.$create("Create$5",[rtl.createSet(1)])},this.OpenInspectorsSave=function(){var t=rtl.createIntfRefs();try{if(this.MarshalOptions().FReOpenInspectors)try{this.FWebLocalStorage.$class.SetValue(this.OpenInspectorsFilename(),this.FMarshalOptions.FOpenInspectors.GetDelimitedText())}catch(i){if(!pas.SysUtils.Exception.isPrototypeOf(i))throw i;var e=i;t.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Warn$2("Failure saving inspectors to "+this.OpenInspectorsFilename(),e,this)}}finally{t.free()}},this.OpenInspectorsLoad=function(){var t=!1,e=rtl.createIntfRefs();try{if(t=!1,this.MarshalOptions().FReOpenInspectors)try{this.FMarshalOptions.FOpenInspectors.SetDelimitedText(this.FWebLocalStorage.$class.GetValue(this.OpenInspectorsFilename())),t=!0}catch(t){if(!pas.SysUtils.Exception.isPrototypeOf(t))throw t;var i=t;e.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Warn$2("Failure opening inspectors from "+this.OpenInspectorsFilename(),i,this)}}finally{e.free()}return t},this.AppInfoSaved=function(){return this.FAppInfoSaved},this.AppInfoSavedSet=function(){this.FAppInfoSaved=!0},rtl.addIntf(this,t.ISERTTKMarshalMV),rtl.addIntf(this,pas.System.IUnknown)})),t.$init=function(){!function(){var e=rtl.createIntfRefs();try{rtl.setIntfP(t.TSERTTKMarshalMVFactory,"FMarshalMV",rtl.queryIntfT(t.TSERTTKMarshalMV.$create("Create$1"),t.ISERTTKMarshalMV),!0),e.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Debug("Model view Factory called create")}finally{e.free()}}()}}),["Types","IOUtils","WEBLib.TMSFNCTabSet","WEBLib.TMSFNCGraphicsTypes","WEBLib.Graphics","WebLib.SERTTK.PluginTypes","WEBLib.TMSFNCUtils","WebLib.SEFNC.Logger","Web","JS"]),rtl.module("WebLib.SERTTK.Marshal",["System","Classes","WebLib.SEFNC.Layout","WebLib.SERTTK.MarshalTypes","Web","WEBLib.Dialogs","JS"],(function(){"use strict";rtl.createClass(this,"TSERTTKMarshalAPI",pas.System.TObject,(function(){this.TryShowMarshal=async function(){var t=null,e=rtl.createIntfRefs();try{t=pas["WebLib.SERTTK.MarshalTypes"].TSERTTKMarshalForm.$create("Create$7",[pas["WEBLib.Forms"].Application]),e.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Trace("Marshal Show - FormCreated");try{window.location.hash="subform",await t.Load(),e.ref(2,pas["WebLib.SEFNC.Logger"].Logger()).Trace("Marshal Show - Form Loaded"),await t.Execute(),e.ref(3,pas["WebLib.SEFNC.Logger"].Logger()).Trace("Marshal Api done try show")}finally{t=rtl.freeLoc(t)}}finally{e.free()}},this.ShowMarshal=function(){var t=rtl.createIntfRefs();try{t.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Trace("Marshal Show - options nil"),this.TryShowMarshal()}finally{t.free()}},this.LoadDockedForm=function(t){var e=null;pas["WEBLib.Forms"].Application.CreateForm$3(pas["WebLib.SERTTK.MarshalTypes"].TSERTTKMarshalForm,t,{get:function(){return e},set:function(t){e=t}},(function(t){window.console.log("created dock form"),e.WebFormCreate(null)}),!1)}}))}),["WEBLib.ExtCtrls","WEBLib.Forms","WEBLib.TMSFNCUtils","WebLib.SEFNC.Logger","SysUtils"]),rtl.module("frameMarshalDemoCardBlogVideoU",["System","SysUtils","Classes","WEBLib.Graphics","WEBLib.Controls","WEBLib.Forms","WEBLib.Dialogs","WEBLib.Controls","WEBLib.WebCtrls","JS","Web","dmMarshalDemoU"],(function(){"use strict";rtl.createClass(this,"TfrmCardBlogVideo",pas["WEBLib.Forms"].TFrame,(function(){this.$init=function(){pas["WEBLib.Forms"].TFrame.$init.call(this),this.WebYoutube1=null},this.$final=function(){this.WebYoutube1=void 0,pas["WEBLib.Forms"].TFrame.$final.call(this)},this.SetVideoID=function(t){this.WebYoutube1.SetVideoID(t)},this.LoadVideo=function(t){this.SetVideoID(t.VideoID)},this.LoadDFMValues=function(){pas["WEBLib.Forms"].TCustomFrame.LoadDFMValues.call(this),this.WebYoutube1=pas["WEBLib.WebCtrls"].TYoutube.$create("Create$1",[this]),this.WebYoutube1.BeforeLoadDFMValues();try{this.SetName("frmCardBlogVideo"),this.SetLeft(0),this.SetTop(0),this.SetWidth(427),this.SetHeight(320),this.SetAlign(5),this.SetTabOrder(0),this.WebYoutube1.SetParentComponent(this),this.WebYoutube1.SetName("WebYoutube1"),this.WebYoutube1.SetLeft(0),this.WebYoutube1.SetTop(0),this.WebYoutube1.SetWidth(427),this.WebYoutube1.SetHeight(320),this.WebYoutube1.SetHeightStyle(2),this.WebYoutube1.SetWidthStyle(2),this.WebYoutube1.SetAlign(5),this.WebYoutube1.SetAllowFullScreen(!1),this.WebYoutube1.FAutoPlay=!1}finally{this.WebYoutube1.AfterLoadDFMValues()}},rtl.addIntf(this,pas.System.IUnknown),this.$rtti.addField("WebYoutube1",pas["WEBLib.WebCtrls"].$rtti.TYoutube)}))})),rtl.module("frameMarshalDemoCardBlogRefU",["System","SysUtils","Classes","WEBLib.Graphics","WEBLib.Controls","WEBLib.Forms","WEBLib.Dialogs","WEBLib.Controls","WEBLib.WebCtrls","JS","Web","dmMarshalDemoU"],(function(){"use strict";rtl.createClass(this,"TfrmCardBlogRef",pas["WEBLib.Forms"].TFrame,(function(){this.$init=function(){pas["WEBLib.Forms"].TFrame.$init.call(this),this.wdivCardHeader=null,this.wdivCardBody=null,this.wdivCardFooter=null},this.$final=function(){this.wdivCardHeader=void 0,this.wdivCardBody=void 0,this.wdivCardFooter=void 0,pas["WEBLib.Forms"].TFrame.$final.call(this)},this.LoadVideoFrame=function(t){var e=null;try{(e=pas.frameMarshalDemoCardBlogVideoU.TfrmCardBlogVideo.$create("Create$1",[this])).SetAlign(5),e.SetParent(this.wdivCardBody),e.SetElementClassName("ratio ratio-16x9"),e.SetElementPosition(1),e.SetHeightStyle(2),e.SetWidthStyle(2),e.LoadFromForm(),e.LoadVideo(t)}catch(t){if(pas.SysUtils.Exception.isPrototypeOf(t)){var i=t;window.console.log(i.FMessage)}else window.console.log(""+t)}},this.LoadVideo=function(t){this.wdivCardHeader.FHTML.Clear(),this.wdivCardHeader.FHTML.Add(t.Title),this.wdivCardFooter.FHTML.Clear(),this.wdivCardFooter.FHTML.Add(t.Description),this.wdivCardBody.FHTML.Clear(),this.LoadVideoFrame(t)},this.LoadDFMValues=function(){pas["WEBLib.Forms"].TCustomFrame.LoadDFMValues.call(this),this.wdivCardHeader=pas["WEBLib.WebCtrls"].THTMLDiv.$create("Create$1",[this]),this.wdivCardBody=pas["WEBLib.WebCtrls"].THTMLDiv.$create("Create$1",[this]),this.wdivCardFooter=pas["WEBLib.WebCtrls"].THTMLDiv.$create("Create$1",[this]),this.wdivCardHeader.BeforeLoadDFMValues(),this.wdivCardBody.BeforeLoadDFMValues(),this.wdivCardFooter.BeforeLoadDFMValues();try{this.SetName("frmCardBlogRef"),this.SetLeft(0),this.SetTop(0),this.SetWidth(427),this.SetHeight(320),this.SetAlign(5),this.SetTabOrder(0),this.wdivCardHeader.SetParentComponent(this),this.wdivCardHeader.SetName("wdivCardHeader"),this.wdivCardHeader.SetLeft(0),this.wdivCardHeader.SetTop(0),this.wdivCardHeader.SetWidth(427),this.wdivCardHeader.SetHeight(27),this.wdivCardHeader.SetElementClassName("card-header"),this.wdivCardHeader.SetHeightStyle(2),this.wdivCardHeader.SetWidthStyle(2),this.wdivCardHeader.SetAlign(1),this.wdivCardHeader.SetElementPosition(1),this.wdivCardHeader.SetRole(""),this.wdivCardBody.SetParentComponent(this),this.wdivCardBody.SetName("wdivCardBody"),this.wdivCardBody.SetLeft(0),this.wdivCardBody.SetTop(27),this.wdivCardBody.SetWidth(427),this.wdivCardBody.SetHeight(267),this.wdivCardBody.SetElementClassName("card-body"),this.wdivCardBody.SetHeightStyle(2),this.wdivCardBody.SetWidthStyle(2),this.wdivCardBody.SetAlign(5),this.wdivCardBody.SetChildOrderEx(1),this.wdivCardBody.SetElementPosition(1),this.wdivCardBody.FHTML.BeginUpdate();try{this.wdivCardBody.FHTML.Clear(),this.wdivCardBody.FHTML.Add("Card Body")}finally{this.wdivCardBody.FHTML.EndUpdate()}this.wdivCardBody.SetRole(""),this.wdivCardFooter.SetParentComponent(this),this.wdivCardFooter.SetName("wdivCardFooter"),this.wdivCardFooter.SetLeft(0),this.wdivCardFooter.SetTop(293),this.wdivCardFooter.SetWidth(427),this.wdivCardFooter.SetHeight(27),this.wdivCardFooter.SetElementClassName("card-footer"),this.wdivCardFooter.SetHeightStyle(2),this.wdivCardFooter.SetWidthStyle(2),this.wdivCardFooter.SetAlign(2),this.wdivCardFooter.SetChildOrderEx(2),this.wdivCardFooter.SetElementPosition(1),this.wdivCardFooter.FHTML.BeginUpdate();try{this.wdivCardFooter.FHTML.Clear(),this.wdivCardFooter.FHTML.Add("Default Footer")}finally{this.wdivCardFooter.FHTML.EndUpdate()}this.wdivCardFooter.SetRole("")}finally{this.wdivCardHeader.AfterLoadDFMValues(),this.wdivCardBody.AfterLoadDFMValues(),this.wdivCardFooter.AfterLoadDFMValues()}},rtl.addIntf(this,pas.System.IUnknown);var t=this.$rtti;t.addField("wdivCardHeader",pas["WEBLib.WebCtrls"].$rtti.THTMLDiv),t.addField("wdivCardBody",pas["WEBLib.WebCtrls"].$rtti.THTMLDiv),t.addField("wdivCardFooter",pas["WEBLib.WebCtrls"].$rtti.THTMLDiv)}))}),["frameMarshalDemoCardBlogVideoU"]),rtl.module("frmMarshalExerciseU",["System","SysUtils","Classes","JS","Web","WEBLib.Graphics","WEBLib.Controls","WEBLib.Forms","WEBLib.Dialogs","WEBLib.Controls","WEBLib.WebCtrls","WEBLib.ExtCtrls","WEBLib.StdCtrls","WEBLib.StdCtrls"],(function(){"use strict";rtl.createClass(this,"TfrmMarshalExercise",pas["WEBLib.Forms"].TForm,(function(){this.$init=function(){pas["WEBLib.Forms"].TForm.$init.call(this),this.divTheme=null,this.divBody=null,this.pnlTop=null,this.btnMarshal=null,this.wdivVideoCards=null,this.wdivNotes=null,this.waNotes=null,this.wdivExercise=null,this.wDivMarshal=null,this.WebTimer1=null,this.wpMarshalTools=null,this.WebGridPanel1=null,this.WebHTMLDiv1=null,this.WebHTMLDiv2=null,this.WebHTMLDiv3=null},this.$final=function(){this.divTheme=void 0,this.divBody=void 0,this.pnlTop=void 0,this.btnMarshal=void 0,this.wdivVideoCards=void 0,this.wdivNotes=void 0,this.waNotes=void 0,this.wdivExercise=void 0,this.wDivMarshal=void 0,this.WebTimer1=void 0,this.wpMarshalTools=void 0,this.WebGridPanel1=void 0,this.WebHTMLDiv1=void 0,this.WebHTMLDiv2=void 0,this.WebHTMLDiv3=void 0,pas["WEBLib.Forms"].TForm.$final.call(this)},this.WebFormCreate=function(t){this.LoadBlogVideos(),this.LoadNotesAccordion(),this.WebTimer1.SetEnabled(!0),this.WebGridPanel1.FTag$1=23},this.btnMarshalClick=function(t){this.wDivMarshal.SetVisible(!1),pas["WebLib.SERTTK.Marshal"].TSERTTKMarshalAPI.ShowMarshal()},this.WebTimer1Timer=function(t){this.WebTimer1.SetEnabled(!1),this.LoadDockedMarshal()},this.LoadBlogVideos=function(){var t=null,e=0,i=null;for(pas.dmMarshalDemoU.dmMarshalDemo.cdsVideos.First(),e=0;!pas.dmMarshalDemoU.dmMarshalDemo.cdsVideos.FEOF;){try{(i=pas["WEBLib.WebCtrls"].THTMLDiv.$create("Create$1",[this])).SetChildOrderEx(e),i.SetParent(this.wdivVideoCards),i.SetElementPosition(1),i.SetHeightStyle(2),i.SetWidthStyle(2),i.FTag$1=5-e,i.SetElementClassName("col-sm-"+pas.SysUtils.TIntegerHelper.ToString$1.call({p:i,get:function(){return this.p.FTag$1},set:function(t){this.p.FTag$1=t}})),i.SetName("DivComp"+pas.SysUtils.TIntegerHelper.ToString$1.call({get:function(){return e},set:function(t){e=t}})),(t=pas.frameMarshalDemoCardBlogRefU.TfrmCardBlogRef.$create("Create$1",[this])).SetAlign(5),t.SetParent(i),t.SetElementClassName("card bg-info"),t.SetElementPosition(1),t.SetHeightStyle(2),t.SetWidthStyle(2),t.LoadFromForm(),t.BeginUpdate(),t.LoadVideo(pas.dmMarshalDemoU.dmMarshalDemo.CurrentVideo()),t.EndUpdate()}catch(t){if(pas.SysUtils.Exception.isPrototypeOf(t)){var s=t;window.console.log(s.FMessage)}else window.console.log(""+t)}pas.dmMarshalDemoU.dmMarshalDemo.cdsVideos.Next(),e+=1}};var t='class="list-group-item list-group-item-secondary"',e='class="list-group-item list-group-item-info"';this.LoadNotesAccordion=function(){var i=this,s=null,o=null;function n(t,e){i.waNotes.FSections.GetItem$1(t).SetContent(i.waNotes.FSections.GetItem$1(t).FContent+e)}function r(t,e){i.waNotes.FSections.GetItem$1(t).SetContent(e)}r(0,"<p>Marshal provides runtime inspection of the forms, controls and datamodules of this Delphi / TMS Web Core application. </p>"),n(0,"<ul ><li>Complete the exercises below as hands on learning for Marshal's debugging abilities for an application.</li>"),n(0,"<li>Optionally view the videos above to see Marshal in action, but the true purpose is for the learning exercise below.</li>"),n(0,'<li>Source code  <a href="https://github.com/SwiftExpat/RunTime-ToolKit/tree/main/Samples/web" class="card-link"> on GitHub</a> , to explore how this demo was built.</li>'),n(0,'<li>Purchase and product information available at <a href="https://swiftexpat.com" class="card-link"> SwiftExpat.com</a> .</li>'),n(0,"</ul> <p> Complete the exercises using Marshal docked here to the right --\x3e </p><ul>"),n(0,'<li>*Marshal is provided as a modal form, available via the <span class="mark">Show Marshal Modal</span> button. You can reposition and resize the modal window.</li>'),n(0,"<li>This demo uses a dock so that the modal window does not cover the instructions. </li>"),n(0,"<li>Marshal's goal is to not require extra design area, so a modal window is provided. </li>"),n(0,"</ul>"),r(1,"<p>2/16/2023 : Beta 4"),n(1,"<ul ><li>Seperate into 3 exercises - less scrolling </li>"),n(1,"<li>Marshal splash for UI notification</li></ul><p>"),n(1,"<p>2/16/2023 : Beta 3"),n(1,"<ul ><li>Improve exercise instructions</li>"),n(1,"<li>Defect on App tools duplicated on re-show</li></ul><p>"),n(1,"<p>2/14/2023 : Beta 2"),n(1,"<ul ><li>Fixed session view defect & added exercise</li>"),n(1,"<li>Performance improved for session view</li></ul><p>"),n(1,"<p>2/12/2023 : Beta 1"),n(1,"<ul ><li>Fixed long delay on Marshal display</li>"),n(1,"<li>Removed sections from application info for Web Core</li></ul><p>"),(o=this.waNotes.FSections.Insert$1(1)).SetCaption("Exercise 1 - Object Plus - Adjust ElementClassName"),o.SetContent("<ol><p>The videos above are in the vidCards row, use Object Plus to adjust them.</p> "),(s=this.waNotes.FSections.Insert$1(2)).SetCaption("Exercise 2 - Marshal Navigation - TDataset Inspection"),s.SetContent("<ol ><p>The videos above are displayed using bootstrap cards populated from data in a TDataset. </p>"),(s=this.waNotes.FSections.Insert$1(3)).SetCaption("Exercise 3 - Session Review - using Marshal's session"),s.SetContent("<ol >"),n(2,"<ol ><li>Navigation - Display Marshal using the blue button at the top left of the page."),n(2,'<ul class="list-group "><li '+t+' ><span class="mark">Structure View</span> contains your applications forms, datamodules and components.</li> '),n(2,"<li "+t+" >The application object is given the first tab and assigned dedicated inspectors. Inspectors are displayed in the client area and assigned by class type.</li></ul> "),n(2,"</li>"),n(2,'<li>Navigate Datamodule - Use the structure view tree to expand <span class="mark">dmMarshalDemo</span> and click on the <span class="mark">cdsVideos</span> .</li>'),n(2,'<ul class="list-group "><li '+t+' ><span class="mark">Object Plus</span> is the default inspector, it allows you to inspect and modify properties and events.</li> '),n(2,"<li "+t+' >A second inspector, <span class="mark">DataSet Grid</span>, is assigned because <span class="mark">cdsVideos</span> is a TDataset.</li></ul> '),n(2,"</li>"),n(2,'<li>TDataSet - Inspect <span class="mark">cdsVideos</span> to see the data populating the videos. </li>'),n(2,'<ul class="list-group "><li '+t+' >Select the Object Plus <span class="mark"> events </span> tab to notice the <span class="mark">AfterOpen</span> event is assigned to populate the data.</li> '),n(2,"<li "+t+' >Select the <span class="mark">Dataset Grid </span> inspector tab and you see a grid with the data used to populate the cards.</li></ul> '),n(2,"</li>"),n(2,"</ol>"),n(1,"<li>Form Navigation - Inspect the form to modify the videos displayed above.</li>"),n(1,'<ul class="list-group "><li '+t+' >Using the structure view, expand <span class="mark">frmMarshalExercise</span>, expand <span class="mark">divTheme</span>, expand <span class="mark">divBody</span> and select <span class="mark">wdivVideoCards</span>.</li> '),n(1,"<li "+t+' >Inspect the property <span class="mark">ElementClassName</span> , it is set to <span class="mark">row</span> from bootstrap. This is the row for the cards.</li> '),n(1,"<li "+e+' >The cards are Delphi frames created in a div tag to be the columns. The loop is based on the data in <span class="mark">cdsVideos</span> which will be explored in exercise 2.</li></ul> '),n(1,"</li>"),n(1,'<li>Row Inspection - Expand <span class="mark">wdivVideoCards</span> in the structure view and you will see the 3 THTMLDiv components that create the columns for the cards and control the width. </li>'),n(1,'<ul class="list-group "><li '+t+' >Select the <span class="mark">DivComp0</span> and use Object Plus to inspect the <span class="mark">ElementClassName</span>, it is set to <span class="mark">col-sm-5</span> to control the column width. </li> '),n(1,"<li "+e+' >Expand the frame to explore how the card is built using a header, body and footer.  Poistion is controlled using <span class="mark">ChildOrder</span> and relative positioning.</li></ul> '),n(1,"</li>"),n(1,'<li>Column Fix - The cards are horizontal based on a row with 3 grid columns of different sizes configured on the <span class="mark">DivComp#</span> component using the <span class="mark">ElementClassName</span> setting ex. <span class="mark">col-sm-#</span>. </li>'),n(1,'<ul class="list-group "><li '+e+" >The cards should be equal size, so the total of the columns must equal 12 to fill the row. Adjust the columns using Marshal to see the changes.</li> "),n(1,"<li "+t+' >Select <span class="mark">DivComp0</span> and use Object Plus to modify the <span class="mark">ElementClassName</span> property to <span class="mark">col-sm-4</span>. </li> '),n(1,"<li "+t+' >Select <span class="mark">DivComp2</span> and use Object Plus to modify the <span class="mark">ElementClassName</span> property to <span class="mark">col-sm-4</span>. </li> '),n(1,"<li "+e+' ><span class="mark">DivComp1</span> is already set to <span class="mark">col-sm-4</span> due to the math applied in the source code.</li></ul> '),n(1,"</ul> </li>"),n(1,"</ol>"),n(3,'<li>Marshal records changes in the session.  View the session using the <span class="mark">Show Session</span> button above the structure View.</li>'),n(3,'<ul class="list-group "><li '+t+" >The session contains the application info report and object modification details. Object plus records property modifications in the session.</li> "),n(3,"<li "+t+' >Review the object modification events which capture the <span class="mark">path</span> of the component, the <span class="mark">property</span> changed, <span class="mark">before value</span> and <span class="mark">after value</span>. </li> '),n(3,'<li class="list-group-item list-group-item-danger" >Currently the Web Core implmentation does not support screen capture.</li> '),n(3,"<li "+t+' >Bookmarks allow you to add a comment to the session, click the <span class="mark">Bookmark</span> button and enter: adjust the css class to col-sm-4. </li> '),n(3,"</ul> </li>"),n(3,"</ol>"),o.SetExpanded(!0),this.waNotes.FSections.GetItem$1(0).SetExpanded(!0)},this.LoadDockedMarshal=async function(){pas["WebLib.SERTTK.Marshal"].TSERTTKMarshalAPI.LoadDockedForm(this.wDivMarshal.GetID())},this.LoadDFMValues=function(){pas["WEBLib.Forms"].TCustomForm.LoadDFMValues.call(this),this.divTheme=pas["WEBLib.WebCtrls"].THTMLDiv.$create("Create$1",[this]),this.divBody=pas["WEBLib.ExtCtrls"].TScrollBox.$create("Create$1",[this]),this.pnlTop=pas["WEBLib.ExtCtrls"].TPanel.$create("Create$1",[this]),this.wdivVideoCards=pas["WEBLib.WebCtrls"].THTMLDiv.$create("Create$2",["vidcards"]),this.wdivNotes=pas["WEBLib.WebCtrls"].THTMLDiv.$create("Create$1",[this]),this.wdivExercise=pas["WEBLib.WebCtrls"].THTMLDiv.$create("Create$1",[this]),this.waNotes=pas["WEBLib.ExtCtrls"].TAccordion.$create("Create$1",[this]),this.WebHTMLDiv3=pas["WEBLib.WebCtrls"].THTMLDiv.$create("Create$1",[this]),this.WebGridPanel1=pas["WEBLib.ExtCtrls"].TGridPanel.$create("Create$1",[this]),this.wpMarshalTools=pas["WEBLib.ExtCtrls"].TPanel.$create("Create$2",["kkkkk"]),this.btnMarshal=pas["WEBLib.StdCtrls"].TButton.$create("Create$2",["marshal-btn"]),this.WebHTMLDiv1=pas["WEBLib.WebCtrls"].THTMLDiv.$create("Create$1",[this]),this.wDivMarshal=pas["WEBLib.WebCtrls"].THTMLDiv.$create("Create$2",["elMarshal"]),this.WebHTMLDiv2=pas["WEBLib.WebCtrls"].THTMLDiv.$create("Create$1",[this]),this.WebTimer1=pas["WEBLib.ExtCtrls"].TTimer.$create("Create$1",[this]),this.divTheme.BeforeLoadDFMValues(),this.divBody.BeforeLoadDFMValues(),this.pnlTop.BeforeLoadDFMValues(),this.wdivVideoCards.BeforeLoadDFMValues(),this.wdivNotes.BeforeLoadDFMValues(),this.wdivExercise.BeforeLoadDFMValues(),this.waNotes.BeforeLoadDFMValues(),this.WebHTMLDiv3.BeforeLoadDFMValues(),this.WebGridPanel1.BeforeLoadDFMValues(),this.wpMarshalTools.BeforeLoadDFMValues(),this.btnMarshal.BeforeLoadDFMValues(),this.WebHTMLDiv1.BeforeLoadDFMValues(),this.wDivMarshal.BeforeLoadDFMValues(),this.WebHTMLDiv2.BeforeLoadDFMValues(),this.WebTimer1.BeforeLoadDFMValues();try{this.SetName("frmMarshalExercise"),this.SetWidth(734),this.SetHeight(753),this.SetCaption("Marshal Demo Web 2023"),this.FCSSLibrary=1,this.SetElementFont(1),this.FFont.FCharset=1,this.FFont.SetColor(65793),this.FFont.SetHeight(-12),this.FFont.SetName("Tahoma"),this.FFont.SetStyle({}),this.SetParentFont(!1),this.SetEvent(this,"OnCreate","WebFormCreate"),this.divTheme.SetParentComponent(this),this.divTheme.SetName("divTheme"),this.divTheme.SetLeft(0),this.divTheme.SetTop(0),this.divTheme.SetWidth(734),this.divTheme.SetHeight(753),this.divTheme.SetElementClassName("theme1 bg-warning w-100 h-100 overflow-hidden"),this.divTheme.SetAlign(5),this.divTheme.SetRole(""),this.divBody.SetParentComponent(this.divTheme),this.divBody.SetName("divBody"),this.divBody.SetAlignWithMargins(!0),this.divBody.SetLeft(7),this.divBody.SetTop(7),this.divBody.SetWidth(721),this.divBody.SetHeight(739),this.divBody.FMargins.SetLeft(7),this.divBody.FMargins.SetTop(7),this.divBody.FMargins.SetRight(7),this.divBody.FMargins.SetBottom(7),this.divBody.SetElementClassName("bg-dark rounded"),this.divBody.SetAlign(5),this.divBody.SetBorderStyle(1),this.pnlTop.SetParentComponent(this.divBody),this.pnlTop.SetName("pnlTop"),this.pnlTop.SetAlignWithMargins(!0),this.pnlTop.SetLeft(3),this.pnlTop.SetTop(3),this.pnlTop.SetWidth(714),this.pnlTop.SetHeight(40),this.pnlTop.FMargins.SetLeft(3),this.pnlTop.FMargins.SetTop(3),this.pnlTop.FMargins.SetRight(3),this.pnlTop.FMargins.SetBottom(3),this.pnlTop.SetElementClassName("card  "),this.pnlTop.SetAlign(1),this.pnlTop.SetCaption("Marshal Web Core Demo :  Fix Stair-Step Videos"),this.pnlTop.FElementBodyClassName="card-body",this.pnlTop.SetElementFont(1),this.pnlTop.SetElementPosition(1),this.wdivVideoCards.SetParentComponent(this.divBody),this.wdivVideoCards.SetName("wdivVideoCards"),this.wdivVideoCards.SetAlignWithMargins(!0),this.wdivVideoCards.SetLeft(2),this.wdivVideoCards.SetTop(49),this.wdivVideoCards.SetWidth(717),this.wdivVideoCards.SetHeight(217),this.wdivVideoCards.SetElementClassName("row"),this.wdivVideoCards.SetHeightStyle(2),this.wdivVideoCards.SetAlign(1),this.wdivVideoCards.SetChildOrderEx(1),this.wdivVideoCards.SetElementPosition(1),this.wdivVideoCards.SetElementFont(1),this.wdivVideoCards.FHTML.BeginUpdate();try{this.wdivVideoCards.FHTML.Clear(),this.wdivVideoCards.FHTML.Add("")}finally{this.wdivVideoCards.FHTML.EndUpdate()}this.wdivVideoCards.SetRole(""),this.wdivNotes.SetParentComponent(this.divBody),this.wdivNotes.SetName("wdivNotes"),this.wdivNotes.SetAlignWithMargins(!0),this.wdivNotes.SetLeft(2),this.wdivNotes.SetTop(269),this.wdivNotes.SetWidth(717),this.wdivNotes.SetHeight(504),this.wdivNotes.SetElementClassName("bg-light rounded row"),this.wdivNotes.SetHeightStyle(2),this.wdivNotes.SetWidthStyle(2),this.wdivNotes.SetAlign(1),this.wdivNotes.SetChildOrderEx(2),this.wdivNotes.SetElementPosition(1),this.wdivNotes.SetElementFont(1),this.wdivNotes.SetRole(""),this.wdivExercise.SetParentComponent(this.wdivNotes),this.wdivExercise.SetName("wdivExercise"),this.wdivExercise.SetAlignWithMargins(!0),this.wdivExercise.SetLeft(5),this.wdivExercise.SetTop(5),this.wdivExercise.SetWidth(235),this.wdivExercise.SetHeight(493),this.wdivExercise.FMargins.SetLeft(5),this.wdivExercise.FMargins.SetTop(5),this.wdivExercise.FMargins.SetRight(5),this.wdivExercise.FMargins.SetBottom(5),this.wdivExercise.SetElementClassName("col-sm-6 rounded"),this.wdivExercise.SetHeightStyle(2),this.wdivExercise.SetWidthStyle(2),this.wdivExercise.SetAlign(3),this.wdivExercise.SetElementPosition(1),this.wdivExercise.SetElementFont(1),this.wdivExercise.SetRole(""),this.waNotes.SetParentComponent(this.wdivExercise),this.waNotes.SetName("waNotes"),this.waNotes.SetAlignWithMargins(!0),this.waNotes.SetLeft(5),this.waNotes.SetTop(5),this.waNotes.SetWidth(225),this.waNotes.SetHeight(483),this.waNotes.FMargins.SetLeft(5),this.waNotes.FMargins.SetTop(5),this.waNotes.FMargins.SetRight(5),this.waNotes.FMargins.SetBottom(5),this.waNotes.SetElementClassName("accordion rounded"),this.waNotes.SetHeightStyle(2),this.waNotes.SetWidthStyle(2),this.waNotes.SetAlign(5),this.waNotes.SetChildOrderEx(3),this.waNotes.SetElementFont(1),this.waNotes.FElementSectionClassName="accordion-item",this.waNotes.FElementContentClassName="accordion-body text-wrap",this.waNotes.SetElementPosition(2),this.waNotes.FSections.Clear();var t=this.waNotes.FSections.Add$1();t.SetCaption("Marshal Front End Inspection - Collapse after reading"),t.SetContent("Contenet for sectino 1"),t.FTag=0;var e=this.waNotes.FSections.Add$1();e.SetCaption("Release notes - updates to this demo"),e.SetContent("Contenet for section 2"),e.FTag=0,this.WebHTMLDiv3.SetParentComponent(this.wdivNotes),this.WebHTMLDiv3.SetName("WebHTMLDiv3"),this.WebHTMLDiv3.SetLeft(246),this.WebHTMLDiv3.SetTop(0),this.WebHTMLDiv3.SetWidth(471),this.WebHTMLDiv3.SetHeight(504),this.WebHTMLDiv3.SetElementClassName("col-sm-6 bg-info rounded"),this.WebHTMLDiv3.SetHeightStyle(2),this.WebHTMLDiv3.SetWidthStyle(2),this.WebHTMLDiv3.SetAlign(5),this.WebHTMLDiv3.SetChildOrderEx(2),this.WebHTMLDiv3.SetElementPosition(2),this.WebHTMLDiv3.SetElementFont(1),this.WebHTMLDiv3.SetRole(""),this.WebGridPanel1.SetParentComponent(this.WebHTMLDiv3),this.WebGridPanel1.SetName("WebGridPanel1"),this.WebGridPanel1.SetLeft(0),this.WebGridPanel1.SetTop(0),this.WebGridPanel1.SetWidth(471),this.WebGridPanel1.SetHeight(504),this.WebGridPanel1.SetElementClassName("bg-warning rounded"),this.WebGridPanel1.SetHeightStyle(2),this.WebGridPanel1.SetWidthStyle(2),this.WebGridPanel1.SetAlign(5),this.WebGridPanel1.FColumnCollection.Clear();var i=this.WebGridPanel1.FColumnCollection.Add$1();i.SetSizeStyle(2),i.SetValue(95);var s=this.WebGridPanel1.FColumnCollection.Add$1();s.SetSizeStyle(2),s.SetValue(5),this.WebGridPanel1.FControlCollection.Clear();var o=this.WebGridPanel1.FControlCollection.Add$1();o.FColumn=0,o.FRow=0,o.FControl=this.wpMarshalTools;var n=this.WebGridPanel1.FControlCollection.Add$1();n.FColumn=0,n.FRow=0,n.FControl=this.WebHTMLDiv1;var r=this.WebGridPanel1.FControlCollection.Add$1();r.FColumn=0,r.FRow=0,r.FControl=this.wDivMarshal;var a=this.WebGridPanel1.FControlCollection.Add$1();a.FColumn=0,a.FRow=0,a.FControl=this.WebHTMLDiv2,this.WebGridPanel1.SetColor(16777215),this.WebGridPanel1.SetElementPosition(2),this.WebGridPanel1.FGridLineColor=0,this.WebGridPanel1.FRowCollection.Clear(),this.WebGridPanel1.FRowCollection.Add$1().SetValue(5),this.WebGridPanel1.FRowCollection.Add$1().SetValue(95),this.wpMarshalTools.SetParentComponent(this.WebGridPanel1),this.wpMarshalTools.SetName("wpMarshalTools"),this.wpMarshalTools.SetLeft(1),this.wpMarshalTools.SetTop(1),this.wpMarshalTools.SetWidth(445),this.wpMarshalTools.SetHeight(23),this.wpMarshalTools.SetElementClassName("card  bg-info"),this.wpMarshalTools.SetHeightStyle(2),this.wpMarshalTools.SetWidthStyle(2),this.wpMarshalTools.SetAlign(5),this.wpMarshalTools.SetAlignment(1),this.wpMarshalTools.SetAnchors({}),this.wpMarshalTools.SetCaption(".                               Marshal Docked"),this.wpMarshalTools.FElementBodyClassName="text-end bg-info",this.wpMarshalTools.SetElementFont(1),this.wpMarshalTools.SetElementPosition(2),this.wpMarshalTools.SetShowCaption(!1),this.btnMarshal.SetParentComponent(this.wpMarshalTools),this.btnMarshal.SetName("btnMarshal"),this.btnMarshal.SetAlignWithMargins(!0),this.btnMarshal.SetLeft(2),this.btnMarshal.SetTop(2),this.btnMarshal.SetWidth(83),this.btnMarshal.SetHeight(19),this.btnMarshal.SetAlign(3),this.btnMarshal.SetCaption("Show Marshal Modal"),this.btnMarshal.SetElementClassName("btn btn-primary"),this.btnMarshal.SetElementFont(1),this.btnMarshal.SetElementPosition(1),this.btnMarshal.SetHeightStyle(2),this.btnMarshal.SetHeightPercent(100),this.btnMarshal.SetWidthStyle(2),this.btnMarshal.SetWidthPercent(100),this.SetEvent$1(this.btnMarshal,this,"OnClick","btnMarshalClick"),this.WebHTMLDiv1.SetParentComponent(this.WebGridPanel1),this.WebHTMLDiv1.SetName("WebHTMLDiv1"),this.WebHTMLDiv1.SetLeft(449),this.WebHTMLDiv1.SetTop(1),this.WebHTMLDiv1.SetWidth(67),this.WebHTMLDiv1.SetHeight(27),this.WebHTMLDiv1.SetHeightStyle(2),this.WebHTMLDiv1.SetWidthStyle(2),this.WebHTMLDiv1.SetAnchors({}),this.WebHTMLDiv1.SetChildOrderEx(1),this.WebHTMLDiv1.SetElementPosition(2),this.WebHTMLDiv1.SetElementFont(1),this.WebHTMLDiv1.SetRole(""),this.wDivMarshal.SetParentComponent(this.WebGridPanel1),this.wDivMarshal.SetName("wDivMarshal"),this.wDivMarshal.SetAlignWithMargins(!0),this.wDivMarshal.SetLeft(1),this.wDivMarshal.SetTop(27),this.wDivMarshal.SetWidth(445),this.wDivMarshal.SetHeight(476),this.wDivMarshal.FMargins.SetLeft(7),this.wDivMarshal.FMargins.SetTop(7),this.wDivMarshal.FMargins.SetRight(7),this.wDivMarshal.FMargins.SetBottom(7),this.wDivMarshal.SetHeightStyle(2),this.wDivMarshal.SetWidthStyle(2),this.wDivMarshal.SetAlign(5),this.wDivMarshal.SetAnchors({}),this.wDivMarshal.SetChildOrderEx(2),this.wDivMarshal.SetElementPosition(2),this.wDivMarshal.SetElementFont(1),this.wDivMarshal.SetRole(""),this.WebHTMLDiv2.SetParentComponent(this.WebGridPanel1),this.WebHTMLDiv2.SetName("WebHTMLDiv2"),this.WebHTMLDiv2.SetLeft(449),this.WebHTMLDiv2.SetTop(27),this.WebHTMLDiv2.SetWidth(67),this.WebHTMLDiv2.SetHeight(27),this.WebHTMLDiv2.SetHeightStyle(2),this.WebHTMLDiv2.SetWidthStyle(2),this.WebHTMLDiv2.SetAnchors({}),this.WebHTMLDiv2.SetChildOrderEx(3),this.WebHTMLDiv2.SetElementPosition(2),this.WebHTMLDiv2.SetElementFont(1),this.WebHTMLDiv2.SetRole(""),this.WebTimer1.SetParentComponent(this),this.WebTimer1.SetName("WebTimer1"),this.WebTimer1.SetEnabled(!1),this.WebTimer1.SetInterval(200),this.SetEvent$1(this.WebTimer1,this,"OnTimer","WebTimer1Timer"),this.WebTimer1.SetLeft(331),this.WebTimer1.SetTop(277)}finally{this.divTheme.AfterLoadDFMValues(),this.divBody.AfterLoadDFMValues(),this.pnlTop.AfterLoadDFMValues(),this.wdivVideoCards.AfterLoadDFMValues(),this.wdivNotes.AfterLoadDFMValues(),this.wdivExercise.AfterLoadDFMValues(),this.waNotes.AfterLoadDFMValues(),this.WebHTMLDiv3.AfterLoadDFMValues(),this.WebGridPanel1.AfterLoadDFMValues(),this.wpMarshalTools.AfterLoadDFMValues(),this.btnMarshal.AfterLoadDFMValues(),this.WebHTMLDiv1.AfterLoadDFMValues(),this.wDivMarshal.AfterLoadDFMValues(),this.WebHTMLDiv2.AfterLoadDFMValues(),this.WebTimer1.AfterLoadDFMValues()}},rtl.addIntf(this,pas.System.IUnknown);var i=this.$rtti;i.addField("divTheme",pas["WEBLib.WebCtrls"].$rtti.THTMLDiv),i.addField("divBody",pas["WEBLib.ExtCtrls"].$rtti.TScrollBox),i.addField("pnlTop",pas["WEBLib.ExtCtrls"].$rtti.TPanel),i.addField("btnMarshal",pas["WEBLib.StdCtrls"].$rtti.TButton),i.addField("wdivVideoCards",pas["WEBLib.WebCtrls"].$rtti.THTMLDiv),i.addField("wdivNotes",pas["WEBLib.WebCtrls"].$rtti.THTMLDiv),i.addField("waNotes",pas["WEBLib.ExtCtrls"].$rtti.TAccordion),i.addField("wdivExercise",pas["WEBLib.WebCtrls"].$rtti.THTMLDiv),i.addField("wDivMarshal",pas["WEBLib.WebCtrls"].$rtti.THTMLDiv),i.addField("WebTimer1",pas["WEBLib.ExtCtrls"].$rtti.TTimer),i.addMethod("WebFormCreate",0,[["Sender",pas.System.$rtti.TObject]]),i.addMethod("btnMarshalClick",0,[["Sender",pas.System.$rtti.TObject]]),i.addMethod("WebTimer1Timer",0,[["Sender",pas.System.$rtti.TObject]])})),this.frmMarshalExercise=null}),["WebLib.SERTTK.Marshal","dmMarshalDemoU","frameMarshalDemoCardBlogRefU"]),rtl.module("program",["System","WEBLib.Forms","WEBLib.Forms","dmMarshalDemoU","frmMarshalExerciseU","frameMarshalDemoCardBlogRefU","frameMarshalDemoCardBlogVideoU"],(function(){"use strict";this.$main=function(){pas["WEBLib.Forms"].Application.Initialize(),pas["WEBLib.Forms"].Application.FMainFormOnTaskBar=!0,pas["WEBLib.Forms"].Application.CreateFormDirect$1(pas.dmMarshalDemoU.TdmMarshalDemo,{p:pas.dmMarshalDemoU,get:function(){return this.p.dmMarshalDemo},set:function(t){this.p.dmMarshalDemo=t}}),pas["WEBLib.Forms"].Application.CreateForm(pas.frmMarshalExerciseU.TfrmMarshalExercise,{p:pas.frmMarshalExerciseU,get:function(){return this.p.frmMarshalExercise},set:function(t){this.p.frmMarshalExercise=t}}),pas["WEBLib.Forms"].Application.Run()}}));